<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization</title>
<!--Generated on Fri May 24 14:29:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.14377v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S1" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S1.SS0.SSS0.Px1" title="In 1 Introduction ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Paper Contributions.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.SS0.SSS0.Px1" title="In 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Tensor Contraction.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.SS0.SSS0.Px2" title="In 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Tensor Decomposition.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The CoMERA Training Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS1" title="In 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Multi-Objective Training Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS1.SSS0.Px1" title="In 3.1 Multi-Objective Training Model ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">A Modified TT Representation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS1.SSS0.Px2" title="In 3.1 Multi-Objective Training Model ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Multi-Objective Optimization.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS2" title="In 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Training Methods</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS2.SSS0.Px1" title="In 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Early Stage.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS2.SSS0.Px2" title="In 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Late Stage (Optional).</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Performance Optimization of CoMERA</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS1" title="In 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Performance Optimization of TTM Embedding Tables.</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS1.SSS0.Px1" title="In 4.1 Performance Optimization of TTM Embedding Tables. ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Performance.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS2" title="In 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Contraction Path Optimization for TT-Vector Multiplications</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS2.SSS0.Px1" title="In 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Large batch case.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS2.SSS0.Px2" title="In 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Analysis.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS3" title="In 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>GPU Performance Optimization via CUDA Graph</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>End-to-End Training Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1" title="In 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>A Medium-Size Transformer with Six Encoders</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1.SSS0.Px1" title="In 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">CoMERA Accuracy and Compression Performance.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1.SSS0.Px2" title="In 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Architecture Search Capability of CoMERA.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1.SSS0.Px3" title="In 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Training Time.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS2" title="In 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>A DLRM Model with 4-GB Model Size</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS2.SSS0.Px1" title="In 5.2 A DLRM Model with 4-GB Model Size ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Effect of Optimized TTM Embedding.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS2.SSS0.Px2" title="In 5.2 A DLRM Model with 4-GB Model Size ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Overall Performance of CoMERA.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS3" title="In 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Comparison with GaLore and LTE</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS3.SSS0.Px1" title="In 5.3 Comparison with GaLore and LTE ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Training Time Per Epoch.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS3.SSS0.Px2" title="In 5.3 Comparison with GaLore and LTE ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Memory Cost.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S6" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions and Future work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1" title="In CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Supplementary Material</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS1" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Proof of Proposition <span class="ltx_text ltx_ref_tag">3.1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS2" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Algorithm for Late Stage Optimization in Section <span class="ltx_text ltx_ref_tag">3.2</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS3" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Proof of Proposition <span class="ltx_text ltx_ref_tag">4.1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS4" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Algorithm for Contraction Path in Section <span class="ltx_text ltx_ref_tag">4.2</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS5" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Small Batch Case for Contraction Path in Section <span class="ltx_text ltx_ref_tag">4.2</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS5.SSS0.Px1" title="In A.5 Small Batch Case for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Small batch case.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS6" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Compression Settings for the Experiment in Section <span class="ltx_text ltx_ref_tag">5.1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS7" title="In Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.7 </span>Discussion: Mixed-Precision CoMERA</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS7.SSS0.Px1" title="In A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Runtime.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS7.SSS0.Px2" title="In A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_title">Convergence.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zi Yang 
<br class="ltx_break"/>University at Albany 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.1.id1">zyang8@albany.edu</span>
<br class="ltx_break"/>&amp;Samridhi Choudhary 
<br class="ltx_break"/>Amazon Alexa AI 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.2.id2">samridhc@amazon.com</span>
<br class="ltx_break"/>&amp;Xinfeng Xie 
<br class="ltx_break"/>Meta 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id6.3.id3">xinfeng@meta.com</span>
<br class="ltx_break"/>&amp;Cao Gao 
<br class="ltx_break"/>Meta 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.4.id4">caogao@meta.com
<br class="ltx_break"/></span>&amp;Siegfried Kunzmann 
<br class="ltx_break"/>Amazon Alexa AI 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id8.5.id5">kunzman@amazon.com
<br class="ltx_break"/></span>&amp;Zheng Zhang 
<br class="ltx_break"/>University of California at Santa Barbara 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id9.6.id6">zhengzhang@ece.ucsb.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.3">Training large AI models such as deep learning recommendation systems and foundation language (or multi-modal) models costs massive GPUs and computing time. The high training cost has become only affordable to big tech companies, meanwhile also causing increasing concerns about the environmental impact. This paper presents CoMERA, a <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id3.3.4">Co</span><span class="ltx_text ltx_font_bold" id="id3.3.3">mputing- and <span class="ltx_text ltx_framed ltx_framed_underline" id="id3.3.3.1">M</span>emory-<span class="ltx_text ltx_framed ltx_framed_underline" id="id3.3.3.2">E</span>fficient training method via <span class="ltx_text ltx_framed ltx_framed_underline" id="id3.3.3.3">R</span>ank-<span class="ltx_text ltx_framed ltx_framed_underline" id="id3.3.3.4">A</span>daptive tensor optimization. CoMERA achieves end-to-end rank-adaptive tensor-compressed training via a multi-objective optimization formulation, and improves the training to provide both a high compression ratio and excellent accuracy in the training process. Our optimized numerical computation (e.g., optimized tensorized embedding and tensor-network contractions) and GPU implementation eliminate part of the run-time overhead in the tensorized training on GPU. This leads to, for the first time, <math alttext="2-3\times" class="ltx_math_unparsed" display="inline" id="id1.1.1.m1.1"><semantics id="id1.1.1.m1.1a"><mrow id="id1.1.1.m1.1b"><mn id="id1.1.1.m1.1.1">2</mn><mo id="id1.1.1.m1.1.2">−</mo><mn id="id1.1.1.m1.1.3">3</mn><mo id="id1.1.1.m1.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">2-3\times</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.m1.1d">2 - 3 ×</annotation></semantics></math> speedup per training epoch compared with standard training. CoMERA also outperforms the recent GaLore in terms of both memory and computing efficiency. Specifically, CoMERA is <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="id2.2.2.m2.1"><semantics id="id2.2.2.m2.1a"><mrow id="id2.2.2.m2.1b"><mn id="id2.2.2.m2.1.1">2</mn><mo id="id2.2.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id2.2.2.m2.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="id2.2.2.m2.1d">2 ×</annotation></semantics></math> faster per training epoch and <math alttext="9\times" class="ltx_math_unparsed" display="inline" id="id3.3.3.m3.1"><semantics id="id3.3.3.m3.1a"><mrow id="id3.3.3.m3.1b"><mn id="id3.3.3.m3.1.1">9</mn><mo id="id3.3.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id3.3.3.m3.1c">9\times</annotation><annotation encoding="application/x-llamapun" id="id3.3.3.m3.1d">9 ×</annotation></semantics></math> more memory-efficient than GaLore on a tested six-encoder transformer with single-batch training.
With further HPC optimization, CoMERA may significantly reduce the training cost of large language models.</span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Deep neural networks have gained success in solving numerous engineering problems. These approaches usually use a huge number of variables to parametrize a network, and require massive hardware resources to train the model. For instance, the Deep Learning Recommendation Model (DLRM) released by Meta (which is smaller than the practical product) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib28" title="">28</a>]</cite> has 4.2 billion parameters; GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib4" title="">4</a>]</cite> has 175 billion parameters. OpenAI shows that the computing power required for key AI tasks has doubled every 3.4 months <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib1" title="">1</a>]</cite> since 2012. Training a large language model like ChatGPT and LLaMA from scratch often takes several weeks or months on thousands of GPUs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Large AI models often have much redundancy. Therefore, numerous methods have been developed to reduce the cost of AI inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib14" title="">14</a>]</cite>). However, training large AI models (especially from scratch) remains an extremely challenging task. Low-precision training <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib32" title="">32</a>]</cite> has been popular in on-device setting, but its memory reduction is quite limited. Furthermore, it is hard to utilize ultra low-precision training on GPU since current GPUs only support limited precision formats for truly quantized training. Chen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib6" title="">6</a>]</cite> employed the idea of robust matrix factorization to reduce the training cost. Similar low-rank matrix approximation techniques have been applied to train large AI models including large language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib17" title="">17</a>]</cite>. Among them, GaLore <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite> can train the 7B LLaMA model on a RTX 4090 GPU using a single-batch and layer-wise setting. However, this setting can lead to extremely long training time, which is infeasible in practical settings.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Compared with matrix compression, low-rank tensor compression has achieved much higher compression ratios on various neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib21" title="">21</a>]</cite>. This idea has been studied in fixed-rank training  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib20" title="">20</a>]</cite>, zeroth-order training <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib38" title="">38</a>]</cite> and parameter-efficient fine tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib35" title="">35</a>]</cite>. The recent work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib12" title="">12</a>]</cite> provides a rank-adaptive tensor-compressed training from a Bayesian perspective. However, to achieve a reduction in both memory and training time (especially on transformers), two open problems need to be addressed. Firstly, a more robust rank-adaptive tensor-compressed training model is desired, since the method in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib12" title="">12</a>]</cite> replies on a heuristic fixed-rank warm-up training. Secondly, while modern GPUs are well-optimized for large-size matrix computations, they are unfriendly for low-rank tensor-compressed training. Specifically, most operations in tensor-compressed training are small-size tensor contractions, which can cause significant runtime overhead on GPUs even though the theoretical computing FLOPS is very low. As a result, as far as we know no papers have reported real training speedup on GPU. This issue was also observed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib15" title="">15</a>]</cite>.</p>
</div>
<section class="ltx_paragraph" id="S1.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Paper Contributions.</h4>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p1.1">In this work, we propose CoMERA, a tensor-compressed training method that can achieve, for the first time, <span class="ltx_text ltx_font_italic" id="S1.SS0.SSS0.Px1.p1.1.1">simultaneous reduction of both memory and runtime on GPU</span>. Our specific contributions are summarized as follows.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Multi-Objective Optimization for Rank-Adaptive Tensor-Compressed Training</span>. We propose a multi-objective optimization formulation to balance the compression ratio and model accuracy and to customize the model for a specific resource requirement. One by-product of this method is the partial capability of automatic architecture search: some layers are identified as unnecessary and can be completely removed by rank-adaptive training.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Performance Optimization of Tensor-Compressed Training.</span> While tensor-compressed training greatly reduces the memory cost and computing FLOPS, it often slows down the practical training on GPU. We propose three approaches to achieve real training speedup: ① optimizing the lookup process of tensorized embedding tables, ② optimizing the tensor-network contractions in both forward and backward propagation, ③ eliminating the GPU backend overhead via CUDA Graph.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.3"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.3.1">Experimental Results.</span> We evaluate our method on the end-to-end training of a transformer with six encoders and the deep learning recommendation system model (DLRM). On these two benchmarks, our method achieves <math alttext="80\times" class="ltx_math_unparsed" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1b"><mn id="S1.I1.i3.p1.1.m1.1.1">80</mn><mo id="S1.I1.i3.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">80\times</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">80 ×</annotation></semantics></math> and <math alttext="99\times" class="ltx_math_unparsed" display="inline" id="S1.I1.i3.p1.2.m2.1"><semantics id="S1.I1.i3.p1.2.m2.1a"><mrow id="S1.I1.i3.p1.2.m2.1b"><mn id="S1.I1.i3.p1.2.m2.1.1">99</mn><mo id="S1.I1.i3.p1.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I1.i3.p1.2.m2.1c">99\times</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.2.m2.1d">99 ×</annotation></semantics></math> compression ratios respectively, while maintaining the testing accuracy of standard uncompressed training. CoMERA also achieves <math alttext="2-3\times" class="ltx_math_unparsed" display="inline" id="S1.I1.i3.p1.3.m3.1"><semantics id="S1.I1.i3.p1.3.m3.1a"><mrow id="S1.I1.i3.p1.3.m3.1b"><mn id="S1.I1.i3.p1.3.m3.1.1">2</mn><mo id="S1.I1.i3.p1.3.m3.1.2">−</mo><mn id="S1.I1.i3.p1.3.m3.1.3">3</mn><mo id="S1.I1.i3.p1.3.m3.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I1.i3.p1.3.m3.1c">2-3\times</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.3.m3.1d">2 - 3 ×</annotation></semantics></math> speedup per training epoch compared with standard training methods on the transformer model.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S1.F1.sf1.g1" src="extracted/2405.14377v1/figures/galore_LTE.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S1.F1.sf1.3.2" style="font-size:90%;">Training time per epoch.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S1.F1.sf2.g1" src="extracted/2405.14377v1/figures/galore_LTE_memory.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:90%;">Peak memory consumption.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Training time and total memory cost of CoMERA, GaLore <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite> and LTE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib17" title="">17</a>]</cite> on a six-encoder transformer with varying batch sizes. The experiment is done on Nvidia RTX 3090 GPU.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p2.2">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S1.F1" title="Figure 1 ‣ Paper Contributions. ‣ 1 Introduction ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a> compares our CoMERA with GaLore <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite> and the recent LoRA-based training method LTE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib17" title="">17</a>]</cite> on the six-encoder transformer. When data and back-end memory cost are considered, CoMERA’s memory consumption is <math alttext="9\times" class="ltx_math_unparsed" display="inline" id="S1.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S1.SS0.SSS0.Px1.p2.1.m1.1a"><mrow id="S1.SS0.SSS0.Px1.p2.1.m1.1b"><mn id="S1.SS0.SSS0.Px1.p2.1.m1.1.1">9</mn><mo id="S1.SS0.SSS0.Px1.p2.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.SS0.SSS0.Px1.p2.1.m1.1c">9\times</annotation><annotation encoding="application/x-llamapun" id="S1.SS0.SSS0.Px1.p2.1.m1.1d">9 ×</annotation></semantics></math> less than GaLore in the single-batch training as adopted in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite>, and it uses the least memory under all batch sizes. Our method is <math alttext="2-3\times" class="ltx_math_unparsed" display="inline" id="S1.SS0.SSS0.Px1.p2.2.m2.1"><semantics id="S1.SS0.SSS0.Px1.p2.2.m2.1a"><mrow id="S1.SS0.SSS0.Px1.p2.2.m2.1b"><mn id="S1.SS0.SSS0.Px1.p2.2.m2.1.1">2</mn><mo id="S1.SS0.SSS0.Px1.p2.2.m2.1.2">−</mo><mn id="S1.SS0.SSS0.Px1.p2.2.m2.1.3">3</mn><mo id="S1.SS0.SSS0.Px1.p2.2.m2.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.SS0.SSS0.Px1.p2.2.m2.1c">2-3\times</annotation><annotation encoding="application/x-llamapun" id="S1.SS0.SSS0.Px1.p2.2.m2.1d">2 - 3 ×</annotation></semantics></math> faster than GaLore and LTE in each training epoch, although CoMERA has not yet been fully optimized on GPU.</p>
</div>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p3.1">While this work focuses on reducing the memory and computing cost of training, it can also reduce the communication cost by orders of magnitude: only low-rank tensorized model parameters and gradients need to be communicated in a distributed setting. The CoMERA framework can also be implemented on resource-constraint edge devices to achieve energy-efficient on-device learning.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="150" id="S2.F2.g1" src="extracted/2405.14377v1/figures/tensor_and_contractions.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">(a) Tensors. (b) Tensor contractions.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.9">The tensor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib24" title="">24</a>]</cite> <math alttext="\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" mathvariant="normal" xref="S2.p1.1.m1.1.1.2.cmml">𝒜</mi><mo id="S2.p1.1.m1.1.1.1" xref="S2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml"><mi id="S2.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S2.p1.1.m1.1.1.3.3" xref="S2.p1.1.m1.1.1.3.3.cmml"><msub id="S2.p1.1.m1.1.1.3.3.2" xref="S2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.p1.1.m1.1.1.3.3.2.2" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.2.2.cmml">\</mi><mi id="S2.p1.1.m1.1.1.3.3.2.3" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.p1.1.m1.1.1.3.3.3" xref="S2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.p1.1.m1.1.1.3.3.3.2" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.3.2.cmml">\</mi><mi id="S2.p1.1.m1.1.1.3.3.3.3" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.3.3.cmml">∈</mi></msub><mo id="S2.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.1.m1.1.1.3.3.4" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.4.cmml">⋯</mi><mo id="S2.p1.1.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.p1.1.m1.1.1.3.3.5" xref="S2.p1.1.m1.1.1.3.3.5.cmml"><mi id="S2.p1.1.m1.1.1.3.3.5.2" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.5.2.cmml">\</mi><mi id="S2.p1.1.m1.1.1.3.3.5.3" mathvariant="normal" xref="S2.p1.1.m1.1.1.3.3.5.3.cmml">⌈</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><in id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1"></in><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝒜</ci><apply id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.1.cmml" xref="S2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.p1.1.m1.1.1.3.2.cmml" xref="S2.p1.1.m1.1.1.3.2">ℛ</ci><apply id="S2.p1.1.m1.1.1.3.3.cmml" xref="S2.p1.1.m1.1.1.3.3"><times id="S2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.p1.1.m1.1.1.3.3.1"></times><apply id="S2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.p1.1.m1.1.1.3.3.2.2">\</ci><ci id="S2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S2.p1.1.m1.1.1.3.3.2.3">∞</ci></apply><apply id="S2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.p1.1.m1.1.1.3.3.3.2">\</ci><ci id="S2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.p1.1.m1.1.1.3.3.3.3">∈</ci></apply><ci id="S2.p1.1.m1.1.1.3.3.4.cmml" xref="S2.p1.1.m1.1.1.3.3.4">⋯</ci><apply id="S2.p1.1.m1.1.1.3.3.5.cmml" xref="S2.p1.1.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.3.5.1.cmml" xref="S2.p1.1.m1.1.1.3.3.5">subscript</csymbol><ci id="S2.p1.1.m1.1.1.3.3.5.2.cmml" xref="S2.p1.1.m1.1.1.3.3.5.2">\</ci><ci id="S2.p1.1.m1.1.1.3.3.5.3.cmml" xref="S2.p1.1.m1.1.1.3.3.5.3">⌈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">roman_𝒜 ∈ roman_ℛ start_POSTSUPERSCRIPT \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × ⋯ × \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is indexed as <math alttext="\mathbfcal{A}=(a_{i_{1}\cdots i_{d}})_{1\leq i_{j}\leq n_{j}}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.2.cmml">𝒜</mi><mo id="S2.p1.2.m2.1.1.1" xref="S2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.p1.2.m2.1.1.3" mathvariant="normal" xref="S2.p1.2.m2.1.1.3.cmml">ℑ</mi><mo id="S2.p1.2.m2.1.1.1a" xref="S2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.p1.2.m2.1.1.4" mathvariant="normal" xref="S2.p1.2.m2.1.1.4.cmml">⇐</mi><mo id="S2.p1.2.m2.1.1.1b" xref="S2.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.p1.2.m2.1.1.5" xref="S2.p1.2.m2.1.1.5.cmml"><mi id="S2.p1.2.m2.1.1.5.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.2.cmml">⊣</mi><mrow id="S2.p1.2.m2.1.1.5.3" xref="S2.p1.2.m2.1.1.5.3.cmml"><msub id="S2.p1.2.m2.1.1.5.3.2" xref="S2.p1.2.m2.1.1.5.3.2.cmml"><mi id="S2.p1.2.m2.1.1.5.3.2.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.3.2.2.cmml">⟩</mi><mi id="S2.p1.2.m2.1.1.5.3.2.3" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.3.2.3.cmml">∞</mi></msub><mo id="S2.p1.2.m2.1.1.5.3.1" xref="S2.p1.2.m2.1.1.5.3.1.cmml">⁢</mo><mi id="S2.p1.2.m2.1.1.5.3.3" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.3.3.cmml">⋯</mi><mo id="S2.p1.2.m2.1.1.5.3.1a" xref="S2.p1.2.m2.1.1.5.3.1.cmml">⁢</mo><msub id="S2.p1.2.m2.1.1.5.3.4" xref="S2.p1.2.m2.1.1.5.3.4.cmml"><mi id="S2.p1.2.m2.1.1.5.3.4.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.3.4.2.cmml">⟩</mi><mi id="S2.p1.2.m2.1.1.5.3.4.3" mathvariant="normal" xref="S2.p1.2.m2.1.1.5.3.4.3.cmml">⌈</mi></msub></mrow></msub><mo id="S2.p1.2.m2.1.1.1c" xref="S2.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.p1.2.m2.1.1.6" xref="S2.p1.2.m2.1.1.6.cmml"><mi id="S2.p1.2.m2.1.1.6.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.6.2.cmml">⇒</mi><mrow id="S2.p1.2.m2.1.1.6.3" xref="S2.p1.2.m2.1.1.6.3.cmml"><mi id="S2.p1.2.m2.1.1.6.3.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.6.3.2.cmml">∞</mi><mo id="S2.p1.2.m2.1.1.6.3.3" xref="S2.p1.2.m2.1.1.6.3.3.cmml">≤</mo><msub id="S2.p1.2.m2.1.1.6.3.4" xref="S2.p1.2.m2.1.1.6.3.4.cmml"><mi id="S2.p1.2.m2.1.1.6.3.4.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.6.3.4.2.cmml">⟩</mi><mo fence="false" id="S2.p1.2.m2.1.1.6.3.4.3" stretchy="false" xref="S2.p1.2.m2.1.1.6.3.4.3.cmml">|</mo></msub><mo id="S2.p1.2.m2.1.1.6.3.5" xref="S2.p1.2.m2.1.1.6.3.5.cmml">≤</mo><msub id="S2.p1.2.m2.1.1.6.3.6" xref="S2.p1.2.m2.1.1.6.3.6.cmml"><mi id="S2.p1.2.m2.1.1.6.3.6.2" mathvariant="normal" xref="S2.p1.2.m2.1.1.6.3.6.2.cmml">\</mi><mo fence="false" id="S2.p1.2.m2.1.1.6.3.6.3" stretchy="false" xref="S2.p1.2.m2.1.1.6.3.6.3.cmml">|</mo></msub></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><times id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1"></times><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝒜</ci><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">ℑ</ci><ci id="S2.p1.2.m2.1.1.4.cmml" xref="S2.p1.2.m2.1.1.4">⇐</ci><apply id="S2.p1.2.m2.1.1.5.cmml" xref="S2.p1.2.m2.1.1.5"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.5.1.cmml" xref="S2.p1.2.m2.1.1.5">subscript</csymbol><ci id="S2.p1.2.m2.1.1.5.2.cmml" xref="S2.p1.2.m2.1.1.5.2">⊣</ci><apply id="S2.p1.2.m2.1.1.5.3.cmml" xref="S2.p1.2.m2.1.1.5.3"><times id="S2.p1.2.m2.1.1.5.3.1.cmml" xref="S2.p1.2.m2.1.1.5.3.1"></times><apply id="S2.p1.2.m2.1.1.5.3.2.cmml" xref="S2.p1.2.m2.1.1.5.3.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.5.3.2.1.cmml" xref="S2.p1.2.m2.1.1.5.3.2">subscript</csymbol><ci id="S2.p1.2.m2.1.1.5.3.2.2.cmml" xref="S2.p1.2.m2.1.1.5.3.2.2">⟩</ci><ci id="S2.p1.2.m2.1.1.5.3.2.3.cmml" xref="S2.p1.2.m2.1.1.5.3.2.3">∞</ci></apply><ci id="S2.p1.2.m2.1.1.5.3.3.cmml" xref="S2.p1.2.m2.1.1.5.3.3">⋯</ci><apply id="S2.p1.2.m2.1.1.5.3.4.cmml" xref="S2.p1.2.m2.1.1.5.3.4"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.5.3.4.1.cmml" xref="S2.p1.2.m2.1.1.5.3.4">subscript</csymbol><ci id="S2.p1.2.m2.1.1.5.3.4.2.cmml" xref="S2.p1.2.m2.1.1.5.3.4.2">⟩</ci><ci id="S2.p1.2.m2.1.1.5.3.4.3.cmml" xref="S2.p1.2.m2.1.1.5.3.4.3">⌈</ci></apply></apply></apply><apply id="S2.p1.2.m2.1.1.6.cmml" xref="S2.p1.2.m2.1.1.6"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.6.1.cmml" xref="S2.p1.2.m2.1.1.6">subscript</csymbol><ci id="S2.p1.2.m2.1.1.6.2.cmml" xref="S2.p1.2.m2.1.1.6.2">⇒</ci><apply id="S2.p1.2.m2.1.1.6.3.cmml" xref="S2.p1.2.m2.1.1.6.3"><and id="S2.p1.2.m2.1.1.6.3a.cmml" xref="S2.p1.2.m2.1.1.6.3"></and><apply id="S2.p1.2.m2.1.1.6.3b.cmml" xref="S2.p1.2.m2.1.1.6.3"><leq id="S2.p1.2.m2.1.1.6.3.3.cmml" xref="S2.p1.2.m2.1.1.6.3.3"></leq><ci id="S2.p1.2.m2.1.1.6.3.2.cmml" xref="S2.p1.2.m2.1.1.6.3.2">∞</ci><apply id="S2.p1.2.m2.1.1.6.3.4.cmml" xref="S2.p1.2.m2.1.1.6.3.4"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.6.3.4.1.cmml" xref="S2.p1.2.m2.1.1.6.3.4">subscript</csymbol><ci id="S2.p1.2.m2.1.1.6.3.4.2.cmml" xref="S2.p1.2.m2.1.1.6.3.4.2">⟩</ci><ci id="S2.p1.2.m2.1.1.6.3.4.3.cmml" xref="S2.p1.2.m2.1.1.6.3.4.3">|</ci></apply></apply><apply id="S2.p1.2.m2.1.1.6.3c.cmml" xref="S2.p1.2.m2.1.1.6.3"><leq id="S2.p1.2.m2.1.1.6.3.5.cmml" xref="S2.p1.2.m2.1.1.6.3.5"></leq><share href="https://arxiv.org/html/2405.14377v1#S2.p1.2.m2.1.1.6.3.4.cmml" id="S2.p1.2.m2.1.1.6.3d.cmml" xref="S2.p1.2.m2.1.1.6.3"></share><apply id="S2.p1.2.m2.1.1.6.3.6.cmml" xref="S2.p1.2.m2.1.1.6.3.6"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.6.3.6.1.cmml" xref="S2.p1.2.m2.1.1.6.3.6">subscript</csymbol><ci id="S2.p1.2.m2.1.1.6.3.6.2.cmml" xref="S2.p1.2.m2.1.1.6.3.6.2">\</ci><ci id="S2.p1.2.m2.1.1.6.3.6.3.cmml" xref="S2.p1.2.m2.1.1.6.3.6.3">|</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathbfcal{A}=(a_{i_{1}\cdots i_{d}})_{1\leq i_{j}\leq n_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">roman_𝒜 roman_ℑ ⇐ ⊣ start_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⋯ ⟩ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⇒ start_POSTSUBSCRIPT ∞ ≤ ⟩ start_POSTSUBSCRIPT | end_POSTSUBSCRIPT ≤ \ start_POSTSUBSCRIPT | end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and is said to have order <math alttext="d" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_d</annotation></semantics></math> and dimension <math alttext="n_{1},\ldots,n_{d}" class="ltx_Math" display="inline" id="S2.p1.4.m4.3"><semantics id="S2.p1.4.m4.3a"><mrow id="S2.p1.4.m4.3.3.2" xref="S2.p1.4.m4.3.3.3.cmml"><msub id="S2.p1.4.m4.2.2.1.1" xref="S2.p1.4.m4.2.2.1.1.cmml"><mi id="S2.p1.4.m4.2.2.1.1.2" xref="S2.p1.4.m4.2.2.1.1.2.cmml">n</mi><mn id="S2.p1.4.m4.2.2.1.1.3" xref="S2.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.4.m4.3.3.2.3" xref="S2.p1.4.m4.3.3.3.cmml">,</mo><mi id="S2.p1.4.m4.1.1" mathvariant="normal" xref="S2.p1.4.m4.1.1.cmml">…</mi><mo id="S2.p1.4.m4.3.3.2.4" xref="S2.p1.4.m4.3.3.3.cmml">,</mo><msub id="S2.p1.4.m4.3.3.2.2" xref="S2.p1.4.m4.3.3.2.2.cmml"><mi id="S2.p1.4.m4.3.3.2.2.2" xref="S2.p1.4.m4.3.3.2.2.2.cmml">n</mi><mi id="S2.p1.4.m4.3.3.2.2.3" xref="S2.p1.4.m4.3.3.2.2.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.3b"><list id="S2.p1.4.m4.3.3.3.cmml" xref="S2.p1.4.m4.3.3.2"><apply id="S2.p1.4.m4.2.2.1.1.cmml" xref="S2.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.2.2.1.1.1.cmml" xref="S2.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S2.p1.4.m4.2.2.1.1.2.cmml" xref="S2.p1.4.m4.2.2.1.1.2">𝑛</ci><cn id="S2.p1.4.m4.2.2.1.1.3.cmml" type="integer" xref="S2.p1.4.m4.2.2.1.1.3">1</cn></apply><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">…</ci><apply id="S2.p1.4.m4.3.3.2.2.cmml" xref="S2.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.3.3.2.2.1.cmml" xref="S2.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S2.p1.4.m4.3.3.2.2.2.cmml" xref="S2.p1.4.m4.3.3.2.2.2">𝑛</ci><ci id="S2.p1.4.m4.3.3.2.2.3.cmml" xref="S2.p1.4.m4.3.3.2.2.3">𝑑</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.3c">n_{1},\ldots,n_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.3d">italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. The Frobenius norm of tensor <math alttext="\mathbfcal{A}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" mathvariant="normal" xref="S2.p1.5.m5.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\mathbfcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">roman_𝒜</annotation></semantics></math> is defined as <math alttext="\|\mathbfcal{A}\|:=\sqrt{\sum_{i_{1},\ldots,i_{d}}^{n_{1},\ldots,n_{d}}a_{i_{1%
}\cdots i_{d}}^{2}}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.2" xref="S2.p1.6.m6.1.2.cmml"><mrow id="S2.p1.6.m6.1.2.2.2" xref="S2.p1.6.m6.1.2.2.1.cmml"><mo id="S2.p1.6.m6.1.2.2.2.1" stretchy="false" xref="S2.p1.6.m6.1.2.2.1.1.cmml">‖</mo><mi id="S2.p1.6.m6.1.1" mathvariant="normal" xref="S2.p1.6.m6.1.1.cmml">𝒜</mi><mo id="S2.p1.6.m6.1.2.2.2.2" stretchy="false" xref="S2.p1.6.m6.1.2.2.1.1.cmml">‖</mo></mrow><mo id="S2.p1.6.m6.1.2.1" xref="S2.p1.6.m6.1.2.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.3.cmml">¬</mi><mo id="S2.p1.6.m6.1.2.1a" xref="S2.p1.6.m6.1.2.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.4" mathvariant="normal" xref="S2.p1.6.m6.1.2.4.cmml">ℑ</mi><mo id="S2.p1.6.m6.1.2.1b" xref="S2.p1.6.m6.1.2.1.cmml">⁢</mo><msqrt id="S2.p1.6.m6.1.2.5" xref="S2.p1.6.m6.1.2.5.cmml"><mrow id="S2.p1.6.m6.1.2.5.2" xref="S2.p1.6.m6.1.2.5.2.cmml"><msubsup id="S2.p1.6.m6.1.2.5.2.1" xref="S2.p1.6.m6.1.2.5.2.1.cmml"><mo id="S2.p1.6.m6.1.2.5.2.1.2.2" xref="S2.p1.6.m6.1.2.5.2.1.2.2.cmml">∑</mo><mrow id="S2.p1.6.m6.1.2.5.2.1.2.3" xref="S2.p1.6.m6.1.2.5.2.1.2.3.cmml"><msub id="S2.p1.6.m6.1.2.5.2.1.2.3.2" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2.cmml"><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.2.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2.2.cmml">⟩</mi><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.2.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2.3.cmml">∞</mi></msub><mo id="S2.p1.6.m6.1.2.5.2.1.2.3.1" xref="S2.p1.6.m6.1.2.5.2.1.2.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.3.cmml">⇔</mi><mo id="S2.p1.6.m6.1.2.5.2.1.2.3.1a" xref="S2.p1.6.m6.1.2.5.2.1.2.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.4" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.4.cmml">…</mi><mo id="S2.p1.6.m6.1.2.5.2.1.2.3.1b" xref="S2.p1.6.m6.1.2.5.2.1.2.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.5" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.5.cmml">⇔</mi><mo id="S2.p1.6.m6.1.2.5.2.1.2.3.1c" xref="S2.p1.6.m6.1.2.5.2.1.2.3.1.cmml">⁢</mo><msub id="S2.p1.6.m6.1.2.5.2.1.2.3.6" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6.cmml"><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.6.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6.2.cmml">⟩</mi><mi id="S2.p1.6.m6.1.2.5.2.1.2.3.6.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6.3.cmml">⌈</mi></msub></mrow><mrow id="S2.p1.6.m6.1.2.5.2.1.3" xref="S2.p1.6.m6.1.2.5.2.1.3.cmml"><msub id="S2.p1.6.m6.1.2.5.2.1.3.2" xref="S2.p1.6.m6.1.2.5.2.1.3.2.cmml"><mi id="S2.p1.6.m6.1.2.5.2.1.3.2.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.2.2.cmml">\</mi><mi id="S2.p1.6.m6.1.2.5.2.1.3.2.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.2.3.cmml">∞</mi></msub><mo id="S2.p1.6.m6.1.2.5.2.1.3.1" xref="S2.p1.6.m6.1.2.5.2.1.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.3.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.3.cmml">⇔</mi><mo id="S2.p1.6.m6.1.2.5.2.1.3.1a" xref="S2.p1.6.m6.1.2.5.2.1.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.3.4" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.4.cmml">…</mi><mo id="S2.p1.6.m6.1.2.5.2.1.3.1b" xref="S2.p1.6.m6.1.2.5.2.1.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.1.3.5" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.5.cmml">⇔</mi><mo id="S2.p1.6.m6.1.2.5.2.1.3.1c" xref="S2.p1.6.m6.1.2.5.2.1.3.1.cmml">⁢</mo><msub id="S2.p1.6.m6.1.2.5.2.1.3.6" xref="S2.p1.6.m6.1.2.5.2.1.3.6.cmml"><mi id="S2.p1.6.m6.1.2.5.2.1.3.6.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.6.2.cmml">\</mi><mi id="S2.p1.6.m6.1.2.5.2.1.3.6.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.1.3.6.3.cmml">⌈</mi></msub></mrow></msubsup><msubsup id="S2.p1.6.m6.1.2.5.2.2" xref="S2.p1.6.m6.1.2.5.2.2.cmml"><mi id="S2.p1.6.m6.1.2.5.2.2.2.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.2.cmml">⊣</mi><mrow id="S2.p1.6.m6.1.2.5.2.2.2.3" xref="S2.p1.6.m6.1.2.5.2.2.2.3.cmml"><msub id="S2.p1.6.m6.1.2.5.2.2.2.3.2" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2.cmml"><mi id="S2.p1.6.m6.1.2.5.2.2.2.3.2.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2.2.cmml">⟩</mi><mi id="S2.p1.6.m6.1.2.5.2.2.2.3.2.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2.3.cmml">∞</mi></msub><mo id="S2.p1.6.m6.1.2.5.2.2.2.3.1" xref="S2.p1.6.m6.1.2.5.2.2.2.3.1.cmml">⁢</mo><mi id="S2.p1.6.m6.1.2.5.2.2.2.3.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.3.3.cmml">⋯</mi><mo id="S2.p1.6.m6.1.2.5.2.2.2.3.1a" xref="S2.p1.6.m6.1.2.5.2.2.2.3.1.cmml">⁢</mo><msub id="S2.p1.6.m6.1.2.5.2.2.2.3.4" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4.cmml"><mi id="S2.p1.6.m6.1.2.5.2.2.2.3.4.2" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4.2.cmml">⟩</mi><mi id="S2.p1.6.m6.1.2.5.2.2.2.3.4.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4.3.cmml">⌈</mi></msub></mrow><mi id="S2.p1.6.m6.1.2.5.2.2.3" mathvariant="normal" xref="S2.p1.6.m6.1.2.5.2.2.3.cmml">∈</mi></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.2.cmml" xref="S2.p1.6.m6.1.2"><times id="S2.p1.6.m6.1.2.1.cmml" xref="S2.p1.6.m6.1.2.1"></times><apply id="S2.p1.6.m6.1.2.2.1.cmml" xref="S2.p1.6.m6.1.2.2.2"><csymbol cd="latexml" id="S2.p1.6.m6.1.2.2.1.1.cmml" xref="S2.p1.6.m6.1.2.2.2.1">norm</csymbol><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">𝒜</ci></apply><ci id="S2.p1.6.m6.1.2.3.cmml" xref="S2.p1.6.m6.1.2.3">¬</ci><ci id="S2.p1.6.m6.1.2.4.cmml" xref="S2.p1.6.m6.1.2.4">ℑ</ci><apply id="S2.p1.6.m6.1.2.5.cmml" xref="S2.p1.6.m6.1.2.5"><root id="S2.p1.6.m6.1.2.5a.cmml" xref="S2.p1.6.m6.1.2.5"></root><apply id="S2.p1.6.m6.1.2.5.2.cmml" xref="S2.p1.6.m6.1.2.5.2"><apply id="S2.p1.6.m6.1.2.5.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1">superscript</csymbol><apply id="S2.p1.6.m6.1.2.5.2.1.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1">subscript</csymbol><sum id="S2.p1.6.m6.1.2.5.2.1.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.2"></sum><apply id="S2.p1.6.m6.1.2.5.2.1.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3"><times id="S2.p1.6.m6.1.2.5.2.1.2.3.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.1"></times><apply id="S2.p1.6.m6.1.2.5.2.1.2.3.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.2.3.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2.2">⟩</ci><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.2.3">∞</ci></apply><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.3">⇔</ci><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.4.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.4">…</ci><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.5.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.5">⇔</ci><apply id="S2.p1.6.m6.1.2.5.2.1.2.3.6.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.2.3.6.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.6.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6.2">⟩</ci><ci id="S2.p1.6.m6.1.2.5.2.1.2.3.6.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.2.3.6.3">⌈</ci></apply></apply></apply><apply id="S2.p1.6.m6.1.2.5.2.1.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3"><times id="S2.p1.6.m6.1.2.5.2.1.3.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.1"></times><apply id="S2.p1.6.m6.1.2.5.2.1.3.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.3.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.2">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.1.3.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.2.2">\</ci><ci id="S2.p1.6.m6.1.2.5.2.1.3.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.2.3">∞</ci></apply><ci id="S2.p1.6.m6.1.2.5.2.1.3.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.3">⇔</ci><ci id="S2.p1.6.m6.1.2.5.2.1.3.4.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.4">…</ci><ci id="S2.p1.6.m6.1.2.5.2.1.3.5.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.5">⇔</ci><apply id="S2.p1.6.m6.1.2.5.2.1.3.6.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.6"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.1.3.6.1.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.6">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.1.3.6.2.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.6.2">\</ci><ci id="S2.p1.6.m6.1.2.5.2.1.3.6.3.cmml" xref="S2.p1.6.m6.1.2.5.2.1.3.6.3">⌈</ci></apply></apply></apply><apply id="S2.p1.6.m6.1.2.5.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.2">superscript</csymbol><apply id="S2.p1.6.m6.1.2.5.2.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.2.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.2">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.2.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.2">⊣</ci><apply id="S2.p1.6.m6.1.2.5.2.2.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3"><times id="S2.p1.6.m6.1.2.5.2.2.2.3.1.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.1"></times><apply id="S2.p1.6.m6.1.2.5.2.2.2.3.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.2.2.3.2.1.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.2.2.3.2.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2.2">⟩</ci><ci id="S2.p1.6.m6.1.2.5.2.2.2.3.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.2.3">∞</ci></apply><ci id="S2.p1.6.m6.1.2.5.2.2.2.3.3.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.3">⋯</ci><apply id="S2.p1.6.m6.1.2.5.2.2.2.3.4.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.2.5.2.2.2.3.4.1.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4">subscript</csymbol><ci id="S2.p1.6.m6.1.2.5.2.2.2.3.4.2.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4.2">⟩</ci><ci id="S2.p1.6.m6.1.2.5.2.2.2.3.4.3.cmml" xref="S2.p1.6.m6.1.2.5.2.2.2.3.4.3">⌈</ci></apply></apply></apply><ci id="S2.p1.6.m6.1.2.5.2.2.3.cmml" xref="S2.p1.6.m6.1.2.5.2.2.3">∈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\|\mathbfcal{A}\|:=\sqrt{\sum_{i_{1},\ldots,i_{d}}^{n_{1},\ldots,n_{d}}a_{i_{1%
}\cdots i_{d}}^{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">∥ roman_𝒜 ∥ ¬ roman_ℑ square-root start_ARG ∑ start_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ ⟩ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ⊣ start_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⋯ ⟩ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>. In tensor networks, the order-<math alttext="d" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><mi id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">italic_d</annotation></semantics></math> tensor <math alttext="\mathbfcal{A}" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" mathvariant="normal" xref="S2.p1.8.m8.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">\mathbfcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">roman_𝒜</annotation></semantics></math> is represented as a node with <math alttext="d" class="ltx_Math" display="inline" id="S2.p1.9.m9.1"><semantics id="S2.p1.9.m9.1a"><mi id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><ci id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m9.1d">italic_d</annotation></semantics></math> edges. Some tensor network representations are illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.F2" title="Figure 2 ‣ 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a> (a).</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Tensor Contraction.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.5">Let <math alttext="\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝒜</mi><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.3.cmml">∈</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.3.cmml">⌈</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><in id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝒜</ci><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.2">ℛ</ci><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.2">\</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.3">∞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.2">\</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.3">∈</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.4">⋯</ci><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.2">\</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.5.3">⌈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">roman_𝒜 ∈ roman_ℛ start_POSTSUPERSCRIPT \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × ⋯ × \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{B}\in\mathbb{R}^{l_{1}\times l_{2}\times\cdots\times l_{m}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">ℬ</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.2.cmml">↕</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.2.cmml">↕</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.3.cmml">∈</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.4.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.2.cmml">↕</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.3.cmml">⇕</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1"><in id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"></in><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2">ℬ</ci><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">ℛ</ci><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3"><times id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1"></times><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.2">↕</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.3">∞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.2">↕</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.3">∈</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.4">⋯</ci><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.2">↕</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.5.3">⇕</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\mathbfcal{B}\in\mathbb{R}^{l_{1}\times l_{2}\times\cdots\times l_{m}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">roman_ℬ ∈ roman_ℛ start_POSTSUPERSCRIPT ↕ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × ↕ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × ⋯ × ↕ start_POSTSUBSCRIPT ⇕ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> be two tensors with <math alttext="n_{s}=l_{t}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">n</mi><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">s</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">=</mo><msub id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">l</mi><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1"><eq id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2">𝑛</ci><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3">𝑠</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.2">𝑙</ci><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">n_{s}=l_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_l start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The tensor contraction product <math alttext="\mathbfcal{C}=\mathbfcal{A}\times_{s,t}\mathbfcal{B}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml">𝒞</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml">ℑ</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1a" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.4.cmml">𝒜</mi></mrow><msub id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.2.cmml">×</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.2.cmml">∫</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.3.cmml">⇔</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1a" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.4.cmml">⊔</mi></mrow></msub><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1">subscript</csymbol><times id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.2"></times><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3"><times id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.2">∫</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.3">⇔</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.3.4">⊔</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2"><times id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.1"></times><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.2">𝒞</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.3">ℑ</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.4.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.4">𝒜</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">\mathbfcal{C}=\mathbfcal{A}\times_{s,t}\mathbfcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.1d">roman_𝒞 roman_ℑ roman_𝒜 × start_POSTSUBSCRIPT ∫ ⇔ ⊔ end_POSTSUBSCRIPT roman_ℬ</annotation></semantics></math> has dimension <math alttext="\Pi_{i\neq s}n_{i}\times\Pi_{j\neq t}l_{j}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.2.cmml">Π</mi><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.1.cmml">≠</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.3.cmml">s</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.2.cmml">n</mi><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml">Π</mi><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.2.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.1.cmml">≠</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.3.cmml">t</mi></mrow></msub></mrow><mo id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">l</mi><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1"><times id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2"><times id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2"><times id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.2">Π</ci><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3"><neq id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.1"></neq><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.2.3.3">𝑠</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.2">𝑛</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.2">Π</ci><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3"><neq id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.1"></neq><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.2">𝑗</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2">𝑙</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">\Pi_{i\neq s}n_{i}\times\Pi_{j\neq t}l_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m5.1d">roman_Π start_POSTSUBSCRIPT italic_i ≠ italic_s end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × roman_Π start_POSTSUBSCRIPT italic_j ≠ italic_t end_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and the entries are</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="c_{(i_{p})_{p\neq s},(j_{p})_{p\neq t}}=\sum_{i_{s}=j_{t}=1}^{n_{s}}a_{i_{1}%
\cdots i_{s}\cdots i_{m}}b_{j_{1}\cdots j_{t}\cdots j_{k}}." class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml">c</mi><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.3.cmml"><msub id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="S2.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.3.2.cmml">p</mi><mo id="S2.E1.m1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.3.1.cmml">≠</mo><mi id="S2.E1.m1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml"><mrow id="S2.E1.m1.2.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml"><mo id="S2.E1.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S2.E1.m1.2.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.2.cmml">j</mi><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.cmml">p</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.3.cmml"><mi id="S2.E1.m1.2.2.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.2.3.2.cmml">p</mi><mo id="S2.E1.m1.2.2.2.2.2.3.1" xref="S2.E1.m1.2.2.2.2.2.3.1.cmml">≠</mo><mi id="S2.E1.m1.2.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub></mrow></msub><mo id="S2.E1.m1.3.3.1.1.1" rspace="0.111em" xref="S2.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><munderover id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S2.E1.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.3.1.2.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.cmml"><msub id="S2.E1.m1.3.3.1.1.3.1.2.3.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.2.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.2.cmml">i</mi><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.2.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.3.cmml">s</mi></msub><mo id="S2.E1.m1.3.3.1.1.3.1.2.3.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml">=</mo><msub id="S2.E1.m1.3.3.1.1.3.1.2.3.4" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.4.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4.2.cmml">j</mi><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.4.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.3.1.2.3.5" xref="S2.E1.m1.3.3.1.1.3.1.2.3.5.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.3.1.2.3.6" xref="S2.E1.m1.3.3.1.1.3.1.2.3.6.cmml">1</mn></mrow><msub id="S2.E1.m1.3.3.1.1.3.1.3" xref="S2.E1.m1.3.3.1.1.3.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.3.2" xref="S2.E1.m1.3.3.1.1.3.1.3.2.cmml">n</mi><mi id="S2.E1.m1.3.3.1.1.3.1.3.3" xref="S2.E1.m1.3.3.1.1.3.1.3.3.cmml">s</mi></msub></munderover><mrow id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.cmml">a</mi><mrow id="S2.E1.m1.3.3.1.1.3.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.2.cmml">i</mi><mn id="S2.E1.m1.3.3.1.1.3.2.2.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.3.cmml">1</mn></msub><mo id="S2.E1.m1.3.3.1.1.3.2.2.3.1" xref="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.3" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.3.2.2.3.3.cmml">⋯</mi><mo id="S2.E1.m1.3.3.1.1.3.2.2.3.1a" xref="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml">⁢</mo><msub id="S2.E1.m1.3.3.1.1.3.2.2.3.4" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.4.2" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4.2.cmml">i</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.4.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4.3.cmml">s</mi></msub><mo id="S2.E1.m1.3.3.1.1.3.2.2.3.1b" xref="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.5" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.3.2.2.3.5.cmml">⋯</mi><mo id="S2.E1.m1.3.3.1.1.3.2.2.3.1c" xref="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml">⁢</mo><msub id="S2.E1.m1.3.3.1.1.3.2.2.3.6" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.6.2" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6.2.cmml">i</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.6.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6.3.cmml">m</mi></msub></mrow></msub><mo id="S2.E1.m1.3.3.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E1.m1.3.3.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.2.cmml">b</mi><mrow id="S2.E1.m1.3.3.1.1.3.2.3.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.3.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.2.cmml">j</mi><mn id="S2.E1.m1.3.3.1.1.3.2.3.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.3.cmml">1</mn></msub><mo id="S2.E1.m1.3.3.1.1.3.2.3.3.1" xref="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.3" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.3.2.3.3.3.cmml">⋯</mi><mo id="S2.E1.m1.3.3.1.1.3.2.3.3.1a" xref="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml">⁢</mo><msub id="S2.E1.m1.3.3.1.1.3.2.3.3.4" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.4.2" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4.2.cmml">j</mi><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.4.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.3.2.3.3.1b" xref="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.5" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.3.2.3.3.5.cmml">⋯</mi><mo id="S2.E1.m1.3.3.1.1.3.2.3.3.1c" xref="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml">⁢</mo><msub id="S2.E1.m1.3.3.1.1.3.2.3.3.6" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.6.2" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6.2.cmml">j</mi><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.6.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6.3.cmml">k</mi></msub></mrow></msub></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" lspace="0em" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"></eq><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2">𝑐</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2"><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><neq id="S2.E1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1"></neq><ci id="S2.E1.m1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.2">𝑝</ci><ci id="S2.E1.m1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2">subscript</csymbol><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.2">𝑗</ci><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3">𝑝</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3"><neq id="S2.E1.m1.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.2.3.1"></neq><ci id="S2.E1.m1.2.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.2.3.2">𝑝</ci><ci id="S2.E1.m1.2.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3.3">𝑡</ci></apply></apply></list></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><apply id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><and id="S2.E1.m1.3.3.1.1.3.1.2.3a.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"></and><apply id="S2.E1.m1.3.3.1.1.3.1.2.3b.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3"></eq><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.3">𝑠</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.4.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.3.4.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.4.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4.2">𝑗</ci><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.4.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.4.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.1.2.3c.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.1.2.3.5.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.5"></eq><share href="https://arxiv.org/html/2405.14377v1#S2.E1.m1.3.3.1.1.3.1.2.3.4.cmml" id="S2.E1.m1.3.3.1.1.3.1.2.3d.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"></share><cn id="S2.E1.m1.3.3.1.1.3.1.2.3.6.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.3.1.2.3.6">1</cn></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3.2">𝑛</ci><ci id="S2.E1.m1.3.3.1.1.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3.3">𝑠</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><times id="S2.E1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2">𝑎</ci><apply id="S2.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3"><times id="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.2">𝑖</ci><cn id="S2.E1.m1.3.3.1.1.3.2.2.3.2.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.3">1</cn></apply><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.3">⋯</ci><apply id="S2.E1.m1.3.3.1.1.3.2.2.3.4.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.3.4.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.4.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.4.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.4.3">𝑠</ci></apply><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.5.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.5">⋯</ci><apply id="S2.E1.m1.3.3.1.1.3.2.2.3.6.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.3.6.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.6.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.6.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.6.3">𝑚</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.2">𝑏</ci><apply id="S2.E1.m1.3.3.1.1.3.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3"><times id="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.2">𝑗</ci><cn id="S2.E1.m1.3.3.1.1.3.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.3">1</cn></apply><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.3">⋯</ci><apply id="S2.E1.m1.3.3.1.1.3.2.3.3.4.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.3.4.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.4.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4.2">𝑗</ci><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.4.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.4.3">𝑡</ci></apply><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.5.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.5">⋯</ci><apply id="S2.E1.m1.3.3.1.1.3.2.3.3.6.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.3.6.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.6.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6.2">𝑗</ci><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.6.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.6.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">c_{(i_{p})_{p\neq s},(j_{p})_{p\neq t}}=\sum_{i_{s}=j_{t}=1}^{n_{s}}a_{i_{1}%
\cdots i_{s}\cdots i_{m}}b_{j_{1}\cdots j_{t}\cdots j_{k}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">italic_c start_POSTSUBSCRIPT ( italic_i start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_p ≠ italic_s end_POSTSUBSCRIPT , ( italic_j start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_p ≠ italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_i start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ⋯ italic_i start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋯ italic_j start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.11">This definition can be naturally generalized to multiple pairs. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.F2" title="Figure 2 ‣ 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a>(b) illustrates some tensor contractions. For general operations among multiple tensors, we use PyTorch einsum in the following</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{B}=\mbox{\bf einsum}(S_{1},\ldots,S_{m}\Rightarrow T,[\mathbfcal{A}%
_{1},\ldots,\mathbfcal{A}_{m}])," class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mrow id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" mathvariant="normal" xref="S2.E2.m1.1.1.2.2.cmml">ℬ</mi><mo id="S2.E2.m1.1.1.2.1" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.3" mathvariant="normal" xref="S2.E2.m1.1.1.2.3.cmml">ℑ</mi><mo id="S2.E2.m1.1.1.2.1a" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.2.4" xref="S2.E2.m1.1.1.2.4a.cmml">einsum</mtext><mo id="S2.E2.m1.1.1.2.1b" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.5" mathvariant="normal" xref="S2.E2.m1.1.1.2.5.cmml">⇐</mi><mo id="S2.E2.m1.1.1.2.1c" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.2.6" xref="S2.E2.m1.1.1.2.6.cmml"><mi id="S2.E2.m1.1.1.2.6.2" mathvariant="normal" xref="S2.E2.m1.1.1.2.6.2.cmml">𝒮</mi><mi id="S2.E2.m1.1.1.2.6.3" mathvariant="normal" xref="S2.E2.m1.1.1.2.6.3.cmml">∞</mi></msub><mo id="S2.E2.m1.1.1.2.1d" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.7" mathvariant="normal" xref="S2.E2.m1.1.1.2.7.cmml">⇔</mi><mo id="S2.E2.m1.1.1.2.1e" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.8" mathvariant="normal" xref="S2.E2.m1.1.1.2.8.cmml">…</mi><mo id="S2.E2.m1.1.1.2.1f" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.9" mathvariant="normal" xref="S2.E2.m1.1.1.2.9.cmml">⇔</mi><mo id="S2.E2.m1.1.1.2.1g" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.2.10" xref="S2.E2.m1.1.1.2.10.cmml"><mi id="S2.E2.m1.1.1.2.10.2" mathvariant="normal" xref="S2.E2.m1.1.1.2.10.2.cmml">𝒮</mi><mi id="S2.E2.m1.1.1.2.10.3" mathvariant="normal" xref="S2.E2.m1.1.1.2.10.3.cmml">⇕</mi></msub></mrow><mo id="S2.E2.m1.1.1.1" stretchy="false" xref="S2.E2.m1.1.1.1.cmml">⇒</mo><mrow id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" mathvariant="normal" xref="S2.E2.m1.1.1.3.2.cmml">𝒯</mi><mo id="S2.E2.m1.1.1.3.1" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.3" mathvariant="normal" xref="S2.E2.m1.1.1.3.3.cmml">⇔</mi><mo id="S2.E2.m1.1.1.3.1a" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.4" mathvariant="normal" xref="S2.E2.m1.1.1.3.4.cmml">∪</mi><mo id="S2.E2.m1.1.1.3.1b" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.3.5" xref="S2.E2.m1.1.1.3.5.cmml"><mi id="S2.E2.m1.1.1.3.5.2" mathvariant="normal" xref="S2.E2.m1.1.1.3.5.2.cmml">𝒜</mi><mi id="S2.E2.m1.1.1.3.5.3" mathvariant="normal" xref="S2.E2.m1.1.1.3.5.3.cmml">∞</mi></msub><mo id="S2.E2.m1.1.1.3.1c" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.6" mathvariant="normal" xref="S2.E2.m1.1.1.3.6.cmml">⇔</mi><mo id="S2.E2.m1.1.1.3.1d" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.7" mathvariant="normal" xref="S2.E2.m1.1.1.3.7.cmml">…</mi><mo id="S2.E2.m1.1.1.3.1e" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.8" mathvariant="normal" xref="S2.E2.m1.1.1.3.8.cmml">⇔</mi><mo id="S2.E2.m1.1.1.3.1f" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.3.9" xref="S2.E2.m1.1.1.3.9.cmml"><mi id="S2.E2.m1.1.1.3.9.2" mathvariant="normal" xref="S2.E2.m1.1.1.3.9.2.cmml">𝒜</mi><mi id="S2.E2.m1.1.1.3.9.3" mathvariant="normal" xref="S2.E2.m1.1.1.3.9.3.cmml">⇕</mi></msub><mo id="S2.E2.m1.1.1.3.1g" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.10" mathvariant="normal" xref="S2.E2.m1.1.1.3.10.cmml">⊌</mi><mo id="S2.E2.m1.1.1.3.1h" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.11" mathvariant="normal" xref="S2.E2.m1.1.1.3.11.cmml">⇒</mi><mo id="S2.E2.m1.1.1.3.1i" xref="S2.E2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.12" mathvariant="normal" xref="S2.E2.m1.1.1.3.12.cmml">⇔</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><ci id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1">⇒</ci><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><times id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">ℬ</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">ℑ</ci><ci id="S2.E2.m1.1.1.2.4a.cmml" xref="S2.E2.m1.1.1.2.4"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.2.4.cmml" xref="S2.E2.m1.1.1.2.4">einsum</mtext></ci><ci id="S2.E2.m1.1.1.2.5.cmml" xref="S2.E2.m1.1.1.2.5">⇐</ci><apply id="S2.E2.m1.1.1.2.6.cmml" xref="S2.E2.m1.1.1.2.6"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.6.1.cmml" xref="S2.E2.m1.1.1.2.6">subscript</csymbol><ci id="S2.E2.m1.1.1.2.6.2.cmml" xref="S2.E2.m1.1.1.2.6.2">𝒮</ci><ci id="S2.E2.m1.1.1.2.6.3.cmml" xref="S2.E2.m1.1.1.2.6.3">∞</ci></apply><ci id="S2.E2.m1.1.1.2.7.cmml" xref="S2.E2.m1.1.1.2.7">⇔</ci><ci id="S2.E2.m1.1.1.2.8.cmml" xref="S2.E2.m1.1.1.2.8">…</ci><ci id="S2.E2.m1.1.1.2.9.cmml" xref="S2.E2.m1.1.1.2.9">⇔</ci><apply id="S2.E2.m1.1.1.2.10.cmml" xref="S2.E2.m1.1.1.2.10"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.10.1.cmml" xref="S2.E2.m1.1.1.2.10">subscript</csymbol><ci id="S2.E2.m1.1.1.2.10.2.cmml" xref="S2.E2.m1.1.1.2.10.2">𝒮</ci><ci id="S2.E2.m1.1.1.2.10.3.cmml" xref="S2.E2.m1.1.1.2.10.3">⇕</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><times id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3.1"></times><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">⇔</ci><ci id="S2.E2.m1.1.1.3.4.cmml" xref="S2.E2.m1.1.1.3.4">∪</ci><apply id="S2.E2.m1.1.1.3.5.cmml" xref="S2.E2.m1.1.1.3.5"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.5.1.cmml" xref="S2.E2.m1.1.1.3.5">subscript</csymbol><ci id="S2.E2.m1.1.1.3.5.2.cmml" xref="S2.E2.m1.1.1.3.5.2">𝒜</ci><ci id="S2.E2.m1.1.1.3.5.3.cmml" xref="S2.E2.m1.1.1.3.5.3">∞</ci></apply><ci id="S2.E2.m1.1.1.3.6.cmml" xref="S2.E2.m1.1.1.3.6">⇔</ci><ci id="S2.E2.m1.1.1.3.7.cmml" xref="S2.E2.m1.1.1.3.7">…</ci><ci id="S2.E2.m1.1.1.3.8.cmml" xref="S2.E2.m1.1.1.3.8">⇔</ci><apply id="S2.E2.m1.1.1.3.9.cmml" xref="S2.E2.m1.1.1.3.9"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.9.1.cmml" xref="S2.E2.m1.1.1.3.9">subscript</csymbol><ci id="S2.E2.m1.1.1.3.9.2.cmml" xref="S2.E2.m1.1.1.3.9.2">𝒜</ci><ci id="S2.E2.m1.1.1.3.9.3.cmml" xref="S2.E2.m1.1.1.3.9.3">⇕</ci></apply><ci id="S2.E2.m1.1.1.3.10.cmml" xref="S2.E2.m1.1.1.3.10">⊌</ci><ci id="S2.E2.m1.1.1.3.11.cmml" xref="S2.E2.m1.1.1.3.11">⇒</ci><ci id="S2.E2.m1.1.1.3.12.cmml" xref="S2.E2.m1.1.1.3.12">⇔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\mathbfcal{B}=\mbox{\bf einsum}(S_{1},\ldots,S_{m}\Rightarrow T,[\mathbfcal{A}%
_{1},\ldots,\mathbfcal{A}_{m}]),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">roman_ℬ roman_ℑ einsum ⇐ roman_𝒮 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒮 start_POSTSUBSCRIPT ⇕ end_POSTSUBSCRIPT ⇒ roman_𝒯 ⇔ ∪ roman_𝒜 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒜 start_POSTSUBSCRIPT ⇕ end_POSTSUBSCRIPT ⊌ ⇒ ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.9">where each <math alttext="S_{i}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.6.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.6.m1.1a"><msub id="S2.SS0.SSS0.Px1.p1.6.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.2.cmml">S</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.2">𝑆</ci><ci id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m1.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.6.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a string of characters that specifies the dimension of <math alttext="\mathbfcal{A}_{i}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.7.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.7.m2.1a"><msub id="S2.SS0.SSS0.Px1.p1.7.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.2.cmml">𝒜</mi><mi id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.7.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.2">𝒜</ci><ci id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.7.m2.1c">\mathbfcal{A}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.7.m2.1d">roman_𝒜 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math>. The output tensor <math alttext="\mathbfcal{B}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.8.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.8.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.8.m3.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.8.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.8.m3.1c">\mathbfcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.8.m3.1d">roman_ℬ</annotation></semantics></math> is obtained by summing over all other dimensions that are not in <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.9.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.9.m4.1a"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.9.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.9.m4.1b"><ci id="S2.SS0.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.9.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.9.m4.1d">italic_T</annotation></semantics></math>. In the following, we show a few commonly used einsum operations. The Tensor-Train decomposition as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.E3" title="In Tensor Decomposition. ‣ 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3</span></a>) is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{A}=\mbox{\bf einsum}(n_{1}r_{1},\ldots,r_{d-1}n_{d}\Rightarrow n_{1%
}n_{2}\cdots n_{d},[\mathbfcal{G}_{1},\mathbfcal{G}_{2}\ldots,\mathbfcal{G}_{d%
}])." class="ltx_Math" display="block" id="S2.Ex1.m1.1"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><mrow id="S2.Ex1.m1.1.1.2" xref="S2.Ex1.m1.1.1.2.cmml"><mi id="S2.Ex1.m1.1.1.2.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.2.cmml">𝒜</mi><mo id="S2.Ex1.m1.1.1.2.1" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.3.cmml">ℑ</mi><mo id="S2.Ex1.m1.1.1.2.1a" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.2.4" xref="S2.Ex1.m1.1.1.2.4a.cmml">einsum</mtext><mo id="S2.Ex1.m1.1.1.2.1b" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.5" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.5.cmml">⇐</mi><mo id="S2.Ex1.m1.1.1.2.1c" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.2.6" xref="S2.Ex1.m1.1.1.2.6.cmml"><mi id="S2.Ex1.m1.1.1.2.6.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.6.2.cmml">\</mi><mi id="S2.Ex1.m1.1.1.2.6.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.6.3.cmml">∞</mi></msub><mo id="S2.Ex1.m1.1.1.2.1d" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.2.7" xref="S2.Ex1.m1.1.1.2.7.cmml"><mi id="S2.Ex1.m1.1.1.2.7.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.7.2.cmml">∇</mi><mi id="S2.Ex1.m1.1.1.2.7.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.7.3.cmml">∞</mi></msub><mo id="S2.Ex1.m1.1.1.2.1e" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.8" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.8.cmml">⇔</mi><mo id="S2.Ex1.m1.1.1.2.1f" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.9" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.9.cmml">…</mi><mo id="S2.Ex1.m1.1.1.2.1g" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.10" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.10.cmml">⇔</mi><mo id="S2.Ex1.m1.1.1.2.1h" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.2.11" xref="S2.Ex1.m1.1.1.2.11.cmml"><mi id="S2.Ex1.m1.1.1.2.11.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.11.2.cmml">∇</mi><mrow id="S2.Ex1.m1.1.1.2.11.3" xref="S2.Ex1.m1.1.1.2.11.3.cmml"><mi id="S2.Ex1.m1.1.1.2.11.3.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.11.3.2.cmml">⌈</mi><mo id="S2.Ex1.m1.1.1.2.11.3.1" xref="S2.Ex1.m1.1.1.2.11.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.11.3.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.11.3.3.cmml">↖</mi><mo id="S2.Ex1.m1.1.1.2.11.3.1a" xref="S2.Ex1.m1.1.1.2.11.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.2.11.3.4" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.11.3.4.cmml">∞</mi></mrow></msub><mo id="S2.Ex1.m1.1.1.2.1i" xref="S2.Ex1.m1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.2.12" xref="S2.Ex1.m1.1.1.2.12.cmml"><mi id="S2.Ex1.m1.1.1.2.12.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.12.2.cmml">\</mi><mi id="S2.Ex1.m1.1.1.2.12.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.2.12.3.cmml">⌈</mi></msub></mrow><mo id="S2.Ex1.m1.1.1.1" stretchy="false" xref="S2.Ex1.m1.1.1.1.cmml">⇒</mo><mrow id="S2.Ex1.m1.1.1.3" xref="S2.Ex1.m1.1.1.3.cmml"><msub id="S2.Ex1.m1.1.1.3.2" xref="S2.Ex1.m1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.1.1.3.2.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.2.2.cmml">\</mi><mi id="S2.Ex1.m1.1.1.3.2.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.2.3.cmml">∞</mi></msub><mo id="S2.Ex1.m1.1.1.3.1" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.3.3" xref="S2.Ex1.m1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.3.2.cmml">\</mi><mi id="S2.Ex1.m1.1.1.3.3.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.3.3.cmml">∈</mi></msub><mo id="S2.Ex1.m1.1.1.3.1a" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.4" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.4.cmml">⋯</mi><mo id="S2.Ex1.m1.1.1.3.1b" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.3.5" xref="S2.Ex1.m1.1.1.3.5.cmml"><mi id="S2.Ex1.m1.1.1.3.5.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.5.2.cmml">\</mi><mi id="S2.Ex1.m1.1.1.3.5.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.5.3.cmml">⌈</mi></msub><mo id="S2.Ex1.m1.1.1.3.1c" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.6" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.6.cmml">⇔</mi><mo id="S2.Ex1.m1.1.1.3.1d" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.7" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.7.cmml">∪</mi><mo id="S2.Ex1.m1.1.1.3.1e" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.3.8" xref="S2.Ex1.m1.1.1.3.8.cmml"><mi id="S2.Ex1.m1.1.1.3.8.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.8.2.cmml">𝒢</mi><mi id="S2.Ex1.m1.1.1.3.8.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.8.3.cmml">∞</mi></msub><mo id="S2.Ex1.m1.1.1.3.1f" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.9" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.9.cmml">⇔</mi><mo id="S2.Ex1.m1.1.1.3.1g" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.3.10" xref="S2.Ex1.m1.1.1.3.10.cmml"><mi id="S2.Ex1.m1.1.1.3.10.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.10.2.cmml">𝒢</mi><mi id="S2.Ex1.m1.1.1.3.10.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.10.3.cmml">∈</mi></msub><mo id="S2.Ex1.m1.1.1.3.1h" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.11" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.11.cmml">…</mi><mo id="S2.Ex1.m1.1.1.3.1i" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.12" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.12.cmml">⇔</mi><mo id="S2.Ex1.m1.1.1.3.1j" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.1.1.3.13" xref="S2.Ex1.m1.1.1.3.13.cmml"><mi id="S2.Ex1.m1.1.1.3.13.2" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.13.2.cmml">𝒢</mi><mi id="S2.Ex1.m1.1.1.3.13.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.13.3.cmml">⌈</mi></msub><mo id="S2.Ex1.m1.1.1.3.1k" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.14" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.14.cmml">⊌</mi><mo id="S2.Ex1.m1.1.1.3.1l" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.15" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.15.cmml">⇒</mi><mo id="S2.Ex1.m1.1.1.3.1m" xref="S2.Ex1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.3.16" mathvariant="normal" xref="S2.Ex1.m1.1.1.3.16.cmml">↙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><ci id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1">⇒</ci><apply id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.2"><times id="S2.Ex1.m1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.2.1"></times><ci id="S2.Ex1.m1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.2.2">𝒜</ci><ci id="S2.Ex1.m1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.2.3">ℑ</ci><ci id="S2.Ex1.m1.1.1.2.4a.cmml" xref="S2.Ex1.m1.1.1.2.4"><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.2.4.cmml" xref="S2.Ex1.m1.1.1.2.4">einsum</mtext></ci><ci id="S2.Ex1.m1.1.1.2.5.cmml" xref="S2.Ex1.m1.1.1.2.5">⇐</ci><apply id="S2.Ex1.m1.1.1.2.6.cmml" xref="S2.Ex1.m1.1.1.2.6"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.2.6.1.cmml" xref="S2.Ex1.m1.1.1.2.6">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.6.2.cmml" xref="S2.Ex1.m1.1.1.2.6.2">\</ci><ci id="S2.Ex1.m1.1.1.2.6.3.cmml" xref="S2.Ex1.m1.1.1.2.6.3">∞</ci></apply><apply id="S2.Ex1.m1.1.1.2.7.cmml" xref="S2.Ex1.m1.1.1.2.7"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.2.7.1.cmml" xref="S2.Ex1.m1.1.1.2.7">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.7.2.cmml" xref="S2.Ex1.m1.1.1.2.7.2">∇</ci><ci id="S2.Ex1.m1.1.1.2.7.3.cmml" xref="S2.Ex1.m1.1.1.2.7.3">∞</ci></apply><ci id="S2.Ex1.m1.1.1.2.8.cmml" xref="S2.Ex1.m1.1.1.2.8">⇔</ci><ci id="S2.Ex1.m1.1.1.2.9.cmml" xref="S2.Ex1.m1.1.1.2.9">…</ci><ci id="S2.Ex1.m1.1.1.2.10.cmml" xref="S2.Ex1.m1.1.1.2.10">⇔</ci><apply id="S2.Ex1.m1.1.1.2.11.cmml" xref="S2.Ex1.m1.1.1.2.11"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.2.11.1.cmml" xref="S2.Ex1.m1.1.1.2.11">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.11.2.cmml" xref="S2.Ex1.m1.1.1.2.11.2">∇</ci><apply id="S2.Ex1.m1.1.1.2.11.3.cmml" xref="S2.Ex1.m1.1.1.2.11.3"><times id="S2.Ex1.m1.1.1.2.11.3.1.cmml" xref="S2.Ex1.m1.1.1.2.11.3.1"></times><ci id="S2.Ex1.m1.1.1.2.11.3.2.cmml" xref="S2.Ex1.m1.1.1.2.11.3.2">⌈</ci><ci id="S2.Ex1.m1.1.1.2.11.3.3.cmml" xref="S2.Ex1.m1.1.1.2.11.3.3">↖</ci><ci id="S2.Ex1.m1.1.1.2.11.3.4.cmml" xref="S2.Ex1.m1.1.1.2.11.3.4">∞</ci></apply></apply><apply id="S2.Ex1.m1.1.1.2.12.cmml" xref="S2.Ex1.m1.1.1.2.12"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.2.12.1.cmml" xref="S2.Ex1.m1.1.1.2.12">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.12.2.cmml" xref="S2.Ex1.m1.1.1.2.12.2">\</ci><ci id="S2.Ex1.m1.1.1.2.12.3.cmml" xref="S2.Ex1.m1.1.1.2.12.3">⌈</ci></apply></apply><apply id="S2.Ex1.m1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.3"><times id="S2.Ex1.m1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.3.1"></times><apply id="S2.Ex1.m1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.3.2.2">\</ci><ci id="S2.Ex1.m1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.1.1.3.2.3">∞</ci></apply><apply id="S2.Ex1.m1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.1.1.3.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.3.2.cmml" xref="S2.Ex1.m1.1.1.3.3.2">\</ci><ci id="S2.Ex1.m1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.1.1.3.3.3">∈</ci></apply><ci id="S2.Ex1.m1.1.1.3.4.cmml" xref="S2.Ex1.m1.1.1.3.4">⋯</ci><apply id="S2.Ex1.m1.1.1.3.5.cmml" xref="S2.Ex1.m1.1.1.3.5"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.5.1.cmml" xref="S2.Ex1.m1.1.1.3.5">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.5.2.cmml" xref="S2.Ex1.m1.1.1.3.5.2">\</ci><ci id="S2.Ex1.m1.1.1.3.5.3.cmml" xref="S2.Ex1.m1.1.1.3.5.3">⌈</ci></apply><ci id="S2.Ex1.m1.1.1.3.6.cmml" xref="S2.Ex1.m1.1.1.3.6">⇔</ci><ci id="S2.Ex1.m1.1.1.3.7.cmml" xref="S2.Ex1.m1.1.1.3.7">∪</ci><apply id="S2.Ex1.m1.1.1.3.8.cmml" xref="S2.Ex1.m1.1.1.3.8"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.8.1.cmml" xref="S2.Ex1.m1.1.1.3.8">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.8.2.cmml" xref="S2.Ex1.m1.1.1.3.8.2">𝒢</ci><ci id="S2.Ex1.m1.1.1.3.8.3.cmml" xref="S2.Ex1.m1.1.1.3.8.3">∞</ci></apply><ci id="S2.Ex1.m1.1.1.3.9.cmml" xref="S2.Ex1.m1.1.1.3.9">⇔</ci><apply id="S2.Ex1.m1.1.1.3.10.cmml" xref="S2.Ex1.m1.1.1.3.10"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.10.1.cmml" xref="S2.Ex1.m1.1.1.3.10">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.10.2.cmml" xref="S2.Ex1.m1.1.1.3.10.2">𝒢</ci><ci id="S2.Ex1.m1.1.1.3.10.3.cmml" xref="S2.Ex1.m1.1.1.3.10.3">∈</ci></apply><ci id="S2.Ex1.m1.1.1.3.11.cmml" xref="S2.Ex1.m1.1.1.3.11">…</ci><ci id="S2.Ex1.m1.1.1.3.12.cmml" xref="S2.Ex1.m1.1.1.3.12">⇔</ci><apply id="S2.Ex1.m1.1.1.3.13.cmml" xref="S2.Ex1.m1.1.1.3.13"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.13.1.cmml" xref="S2.Ex1.m1.1.1.3.13">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.13.2.cmml" xref="S2.Ex1.m1.1.1.3.13.2">𝒢</ci><ci id="S2.Ex1.m1.1.1.3.13.3.cmml" xref="S2.Ex1.m1.1.1.3.13.3">⌈</ci></apply><ci id="S2.Ex1.m1.1.1.3.14.cmml" xref="S2.Ex1.m1.1.1.3.14">⊌</ci><ci id="S2.Ex1.m1.1.1.3.15.cmml" xref="S2.Ex1.m1.1.1.3.15">⇒</ci><ci id="S2.Ex1.m1.1.1.3.16.cmml" xref="S2.Ex1.m1.1.1.3.16">↙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\mathbfcal{A}=\mbox{\bf einsum}(n_{1}r_{1},\ldots,r_{d-1}n_{d}\Rightarrow n_{1%
}n_{2}\cdots n_{d},[\mathbfcal{G}_{1},\mathbfcal{G}_{2}\ldots,\mathbfcal{G}_{d%
}]).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">roman_𝒜 roman_ℑ einsum ⇐ \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ ∇ start_POSTSUBSCRIPT ⌈ ↖ ∞ end_POSTSUBSCRIPT \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇒ \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT \ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⋯ \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ ∪ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT … ⇔ roman_𝒢 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.10">For the batched matrices <math alttext="\mathbfcal{A}\in\mathbb{R}^{b\times m\times k},\mathbfcal{B}\in\mathbb{R}^{b%
\times k\times n}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.10.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.10.m1.1a"><mrow id="S2.SS0.SSS0.Px1.p1.10.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.2.cmml">𝒜</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.3.cmml">∈</mo><mrow id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.cmml"><msup id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.2.cmml">⌊</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.3.cmml">⇕</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.4.cmml">∥</mi></mrow></msup><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.3.cmml">⇔</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1a" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.4.cmml">ℬ</mi></mrow><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.5" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.5.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.2.cmml">⌊</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.3.cmml">∥</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.4.cmml">\</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.10.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1"><and id="S2.SS0.SSS0.Px1.p1.10.m1.1.1a.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1"></and><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1b.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1"><in id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.3"></in><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.2">𝒜</ci><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4"><times id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.1"></times><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.2">ℛ</ci><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3"><times id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.2">⌊</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.3">⇕</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.2.3.4">∥</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.3">⇔</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.4.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.4">ℬ</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1c.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1"><in id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.5.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.5"></in><share href="https://arxiv.org/html/2405.14377v1#S2.SS0.SSS0.Px1.p1.10.m1.1.1.4.cmml" id="S2.SS0.SSS0.Px1.p1.10.m1.1.1d.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1"></share><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.2">ℛ</ci><apply id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3"><times id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.2">⌊</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.3">∥</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m1.1.1.6.3.4">\</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.10.m1.1c">\mathbfcal{A}\in\mathbb{R}^{b\times m\times k},\mathbfcal{B}\in\mathbb{R}^{b%
\times k\times n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.10.m1.1d">roman_𝒜 ∈ roman_ℛ start_POSTSUPERSCRIPT ⌊ × ⇕ × ∥ end_POSTSUPERSCRIPT ⇔ roman_ℬ ∈ roman_ℛ start_POSTSUPERSCRIPT ⌊ × ∥ × \ end_POSTSUPERSCRIPT</annotation></semantics></math>, the batched matrix multiplication is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{C}=\mathbfcal{A}\mathbfcal{B}=\mbox{\bf einsum}(bmk,bkn\Rightarrow
bmn%
,[\mathbfcal{A},\mathbfcal{B}]),\;\;\text{where}\;\mathbfcal{C}[i,:,:]=%
\mathbfcal{A}[i,:,:]\mathbfcal{B}[i,:,:]." class="ltx_Math" display="block" id="S2.Ex2.m1.1"><semantics id="S2.Ex2.m1.1a"><mrow id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml"><mrow id="S2.Ex2.m1.1.1.2" xref="S2.Ex2.m1.1.1.2.cmml"><mi id="S2.Ex2.m1.1.1.2.2" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.2.cmml">𝒞</mi><mo id="S2.Ex2.m1.1.1.2.1" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.3" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.3.cmml">ℑ</mi><mo id="S2.Ex2.m1.1.1.2.1a" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.4" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.4.cmml">𝒜</mi><mo id="S2.Ex2.m1.1.1.2.1b" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.5" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.5.cmml">ℬ</mi><mo id="S2.Ex2.m1.1.1.2.1c" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.6" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.6.cmml">ℑ</mi><mo id="S2.Ex2.m1.1.1.2.1d" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mtext class="ltx_mathvariant_bold" id="S2.Ex2.m1.1.1.2.7" xref="S2.Ex2.m1.1.1.2.7a.cmml">einsum</mtext><mo id="S2.Ex2.m1.1.1.2.1e" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.8" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.8.cmml">⇐</mi><mo id="S2.Ex2.m1.1.1.2.1f" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.9" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.9.cmml">⌊</mi><mo id="S2.Ex2.m1.1.1.2.1g" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.10" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.10.cmml">⇕</mi><mo id="S2.Ex2.m1.1.1.2.1h" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.11" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.11.cmml">∥</mi><mo id="S2.Ex2.m1.1.1.2.1i" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.12" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.12.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.2.1j" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.13" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.13.cmml">⌊</mi><mo id="S2.Ex2.m1.1.1.2.1k" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.14" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.14.cmml">∥</mi><mo id="S2.Ex2.m1.1.1.2.1l" xref="S2.Ex2.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.2.15" mathvariant="normal" xref="S2.Ex2.m1.1.1.2.15.cmml">\</mi></mrow><mo id="S2.Ex2.m1.1.1.1" stretchy="false" xref="S2.Ex2.m1.1.1.1.cmml">⇒</mo><mrow id="S2.Ex2.m1.1.1.3" xref="S2.Ex2.m1.1.1.3.cmml"><mi id="S2.Ex2.m1.1.1.3.2" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.2.cmml">⌊</mi><mo id="S2.Ex2.m1.1.1.3.1" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.3" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.3.cmml">⇕</mi><mo id="S2.Ex2.m1.1.1.3.1a" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.4" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.4.cmml">\</mi><mo id="S2.Ex2.m1.1.1.3.1b" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.5" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.5.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1c" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.6" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.6.cmml">∪</mi><mo id="S2.Ex2.m1.1.1.3.1d" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.7" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.7.cmml">𝒜</mi><mo id="S2.Ex2.m1.1.1.3.1e" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.8" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.8.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1f" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.9" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.9.cmml">ℬ</mi><mo id="S2.Ex2.m1.1.1.3.1g" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.10" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.10.cmml">⊌</mi><mo id="S2.Ex2.m1.1.1.3.1h" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.11" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.11.cmml">⇒</mi><mo id="S2.Ex2.m1.1.1.3.1i" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.12" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.12.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1j" lspace="0.560em" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mtext id="S2.Ex2.m1.1.1.3.13" xref="S2.Ex2.m1.1.1.3.13a.cmml">where</mtext><mo id="S2.Ex2.m1.1.1.3.1k" lspace="0.280em" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.14" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.14.cmml">𝒞</mi><mo id="S2.Ex2.m1.1.1.3.1l" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.15" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.15.cmml">∪</mi><mo id="S2.Ex2.m1.1.1.3.1m" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.16" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.16.cmml">⟩</mi><mo id="S2.Ex2.m1.1.1.3.1n" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.17" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.17.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1o" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.18" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.18.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1p" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.19" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.19.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1q" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.20" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.20.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1r" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.21" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.21.cmml">⊌</mi><mo id="S2.Ex2.m1.1.1.3.1s" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.22" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.22.cmml">ℑ</mi><mo id="S2.Ex2.m1.1.1.3.1t" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.23" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.23.cmml">𝒜</mi><mo id="S2.Ex2.m1.1.1.3.1u" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.24" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.24.cmml">∪</mi><mo id="S2.Ex2.m1.1.1.3.1v" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.25" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.25.cmml">⟩</mi><mo id="S2.Ex2.m1.1.1.3.1w" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.26" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.26.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1x" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.27" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.27.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1y" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.28" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.28.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1z" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.29" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.29.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1aa" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.30" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.30.cmml">⊌</mi><mo id="S2.Ex2.m1.1.1.3.1ab" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.31" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.31.cmml">ℬ</mi><mo id="S2.Ex2.m1.1.1.3.1ac" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.32" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.32.cmml">∪</mi><mo id="S2.Ex2.m1.1.1.3.1ad" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.33" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.33.cmml">⟩</mi><mo id="S2.Ex2.m1.1.1.3.1ae" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.34" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.34.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1af" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.35" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.35.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1ag" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.36" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.36.cmml">⇔</mi><mo id="S2.Ex2.m1.1.1.3.1ah" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.37" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.37.cmml">¬</mi><mo id="S2.Ex2.m1.1.1.3.1ai" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.38" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.38.cmml">⊌</mi><mo id="S2.Ex2.m1.1.1.3.1aj" xref="S2.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.1.1.3.39" mathvariant="normal" xref="S2.Ex2.m1.1.1.3.39.cmml">↙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.1b"><apply id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1"><ci id="S2.Ex2.m1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1">⇒</ci><apply id="S2.Ex2.m1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.2"><times id="S2.Ex2.m1.1.1.2.1.cmml" xref="S2.Ex2.m1.1.1.2.1"></times><ci id="S2.Ex2.m1.1.1.2.2.cmml" xref="S2.Ex2.m1.1.1.2.2">𝒞</ci><ci id="S2.Ex2.m1.1.1.2.3.cmml" xref="S2.Ex2.m1.1.1.2.3">ℑ</ci><ci id="S2.Ex2.m1.1.1.2.4.cmml" xref="S2.Ex2.m1.1.1.2.4">𝒜</ci><ci id="S2.Ex2.m1.1.1.2.5.cmml" xref="S2.Ex2.m1.1.1.2.5">ℬ</ci><ci id="S2.Ex2.m1.1.1.2.6.cmml" xref="S2.Ex2.m1.1.1.2.6">ℑ</ci><ci id="S2.Ex2.m1.1.1.2.7a.cmml" xref="S2.Ex2.m1.1.1.2.7"><mtext class="ltx_mathvariant_bold" id="S2.Ex2.m1.1.1.2.7.cmml" xref="S2.Ex2.m1.1.1.2.7">einsum</mtext></ci><ci id="S2.Ex2.m1.1.1.2.8.cmml" xref="S2.Ex2.m1.1.1.2.8">⇐</ci><ci id="S2.Ex2.m1.1.1.2.9.cmml" xref="S2.Ex2.m1.1.1.2.9">⌊</ci><ci id="S2.Ex2.m1.1.1.2.10.cmml" xref="S2.Ex2.m1.1.1.2.10">⇕</ci><ci id="S2.Ex2.m1.1.1.2.11.cmml" xref="S2.Ex2.m1.1.1.2.11">∥</ci><ci id="S2.Ex2.m1.1.1.2.12.cmml" xref="S2.Ex2.m1.1.1.2.12">⇔</ci><ci id="S2.Ex2.m1.1.1.2.13.cmml" xref="S2.Ex2.m1.1.1.2.13">⌊</ci><ci id="S2.Ex2.m1.1.1.2.14.cmml" xref="S2.Ex2.m1.1.1.2.14">∥</ci><ci id="S2.Ex2.m1.1.1.2.15.cmml" xref="S2.Ex2.m1.1.1.2.15">\</ci></apply><apply id="S2.Ex2.m1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.3"><times id="S2.Ex2.m1.1.1.3.1.cmml" xref="S2.Ex2.m1.1.1.3.1"></times><ci id="S2.Ex2.m1.1.1.3.2.cmml" xref="S2.Ex2.m1.1.1.3.2">⌊</ci><ci id="S2.Ex2.m1.1.1.3.3.cmml" xref="S2.Ex2.m1.1.1.3.3">⇕</ci><ci id="S2.Ex2.m1.1.1.3.4.cmml" xref="S2.Ex2.m1.1.1.3.4">\</ci><ci id="S2.Ex2.m1.1.1.3.5.cmml" xref="S2.Ex2.m1.1.1.3.5">⇔</ci><ci id="S2.Ex2.m1.1.1.3.6.cmml" xref="S2.Ex2.m1.1.1.3.6">∪</ci><ci id="S2.Ex2.m1.1.1.3.7.cmml" xref="S2.Ex2.m1.1.1.3.7">𝒜</ci><ci id="S2.Ex2.m1.1.1.3.8.cmml" xref="S2.Ex2.m1.1.1.3.8">⇔</ci><ci id="S2.Ex2.m1.1.1.3.9.cmml" xref="S2.Ex2.m1.1.1.3.9">ℬ</ci><ci id="S2.Ex2.m1.1.1.3.10.cmml" xref="S2.Ex2.m1.1.1.3.10">⊌</ci><ci id="S2.Ex2.m1.1.1.3.11.cmml" xref="S2.Ex2.m1.1.1.3.11">⇒</ci><ci id="S2.Ex2.m1.1.1.3.12.cmml" xref="S2.Ex2.m1.1.1.3.12">⇔</ci><ci id="S2.Ex2.m1.1.1.3.13a.cmml" xref="S2.Ex2.m1.1.1.3.13"><mtext id="S2.Ex2.m1.1.1.3.13.cmml" xref="S2.Ex2.m1.1.1.3.13">where</mtext></ci><ci id="S2.Ex2.m1.1.1.3.14.cmml" xref="S2.Ex2.m1.1.1.3.14">𝒞</ci><ci id="S2.Ex2.m1.1.1.3.15.cmml" xref="S2.Ex2.m1.1.1.3.15">∪</ci><ci id="S2.Ex2.m1.1.1.3.16.cmml" xref="S2.Ex2.m1.1.1.3.16">⟩</ci><ci id="S2.Ex2.m1.1.1.3.17.cmml" xref="S2.Ex2.m1.1.1.3.17">⇔</ci><ci id="S2.Ex2.m1.1.1.3.18.cmml" xref="S2.Ex2.m1.1.1.3.18">¬</ci><ci id="S2.Ex2.m1.1.1.3.19.cmml" xref="S2.Ex2.m1.1.1.3.19">⇔</ci><ci id="S2.Ex2.m1.1.1.3.20.cmml" xref="S2.Ex2.m1.1.1.3.20">¬</ci><ci id="S2.Ex2.m1.1.1.3.21.cmml" xref="S2.Ex2.m1.1.1.3.21">⊌</ci><ci id="S2.Ex2.m1.1.1.3.22.cmml" xref="S2.Ex2.m1.1.1.3.22">ℑ</ci><ci id="S2.Ex2.m1.1.1.3.23.cmml" xref="S2.Ex2.m1.1.1.3.23">𝒜</ci><ci id="S2.Ex2.m1.1.1.3.24.cmml" xref="S2.Ex2.m1.1.1.3.24">∪</ci><ci id="S2.Ex2.m1.1.1.3.25.cmml" xref="S2.Ex2.m1.1.1.3.25">⟩</ci><ci id="S2.Ex2.m1.1.1.3.26.cmml" xref="S2.Ex2.m1.1.1.3.26">⇔</ci><ci id="S2.Ex2.m1.1.1.3.27.cmml" xref="S2.Ex2.m1.1.1.3.27">¬</ci><ci id="S2.Ex2.m1.1.1.3.28.cmml" xref="S2.Ex2.m1.1.1.3.28">⇔</ci><ci id="S2.Ex2.m1.1.1.3.29.cmml" xref="S2.Ex2.m1.1.1.3.29">¬</ci><ci id="S2.Ex2.m1.1.1.3.30.cmml" xref="S2.Ex2.m1.1.1.3.30">⊌</ci><ci id="S2.Ex2.m1.1.1.3.31.cmml" xref="S2.Ex2.m1.1.1.3.31">ℬ</ci><ci id="S2.Ex2.m1.1.1.3.32.cmml" xref="S2.Ex2.m1.1.1.3.32">∪</ci><ci id="S2.Ex2.m1.1.1.3.33.cmml" xref="S2.Ex2.m1.1.1.3.33">⟩</ci><ci id="S2.Ex2.m1.1.1.3.34.cmml" xref="S2.Ex2.m1.1.1.3.34">⇔</ci><ci id="S2.Ex2.m1.1.1.3.35.cmml" xref="S2.Ex2.m1.1.1.3.35">¬</ci><ci id="S2.Ex2.m1.1.1.3.36.cmml" xref="S2.Ex2.m1.1.1.3.36">⇔</ci><ci id="S2.Ex2.m1.1.1.3.37.cmml" xref="S2.Ex2.m1.1.1.3.37">¬</ci><ci id="S2.Ex2.m1.1.1.3.38.cmml" xref="S2.Ex2.m1.1.1.3.38">⊌</ci><ci id="S2.Ex2.m1.1.1.3.39.cmml" xref="S2.Ex2.m1.1.1.3.39">↙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.1c">\mathbfcal{C}=\mathbfcal{A}\mathbfcal{B}=\mbox{\bf einsum}(bmk,bkn\Rightarrow
bmn%
,[\mathbfcal{A},\mathbfcal{B}]),\;\;\text{where}\;\mathbfcal{C}[i,:,:]=%
\mathbfcal{A}[i,:,:]\mathbfcal{B}[i,:,:].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.1d">roman_𝒞 roman_ℑ roman_𝒜 roman_ℬ roman_ℑ einsum ⇐ ⌊ ⇕ ∥ ⇔ ⌊ ∥ \ ⇒ ⌊ ⇕ \ ⇔ ∪ roman_𝒜 ⇔ roman_ℬ ⊌ ⇒ ⇔ where roman_𝒞 ∪ ⟩ ⇔ ¬ ⇔ ¬ ⊌ roman_ℑ roman_𝒜 ∪ ⟩ ⇔ ¬ ⇔ ¬ ⊌ roman_ℬ ∪ ⟩ ⇔ ¬ ⇔ ¬ ⊌ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Tensor Decomposition.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.3">In this paper, we will mainly use tensor-train (TT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib31" title="">31</a>]</cite> and tensor-train matrix (TTM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib30" title="">30</a>]</cite> decomposition for compressed neural network training. TT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib31" title="">31</a>]</cite> represents the tensor <math alttext="\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝒜</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><msub id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.3.cmml">∈</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.3.cmml">⌈</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1"><in id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1"></in><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝒜</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.2">ℛ</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.1"></times><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.2">\</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.2.3">∞</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.2">\</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.3.3">∈</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.4">⋯</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.2">\</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.3.3.5.3">⌈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">\mathbfcal{A}\in\mathbb{R}^{n_{1}\times n_{2}\times\cdots\times n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.1d">roman_𝒜 ∈ roman_ℛ start_POSTSUPERSCRIPT \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × ⋯ × \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as a set of small-size cores
<math alttext="\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">𝒢</mi><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml">∞</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">⇔</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1a" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.4" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.4.cmml">…</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1b" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.5" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.5.cmml">⇔</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1c" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.2.cmml">𝒢</mi><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.3.cmml">⌈</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1"><times id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1"></times><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2">𝒢</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3">∞</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3">⇔</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.4">…</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.5.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.5">⇔</ci><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.2">𝒢</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.6.3">⌈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="\mathbfcal{G}_{i}\in\mathbb{R}^{r_{i-1}\times n_{i}\times r_{i}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml">𝒢</mi><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml">⟩</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml"><msub id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.2.cmml">∇</mi><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.2.cmml">⟩</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.3.cmml">↖</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1a" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.4.cmml">∞</mi></mrow></msub><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.3.cmml">⟩</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.2.cmml">∇</mi><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.3.cmml">⟩</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1"><in id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1"></in><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.2">𝒢</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.3">⟩</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.2">ℛ</ci><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3"><times id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.1"></times><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.2">∇</ci><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3"><times id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.2">⟩</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.3">↖</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.2.3.4">∞</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.2">\</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.3.3">⟩</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.2">∇</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.4.3">⟩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m3.1c">\mathbfcal{G}_{i}\in\mathbb{R}^{r_{i-1}\times n_{i}\times r_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.3.m3.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ∈ roman_ℛ start_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT ⟩ ↖ ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT × ∇ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{A}=\mathbfcal{G}_{1}\times_{3,1}\mathbfcal{G}_{2}\times_{3,1}\cdots%
\times_{3,1}\mathbfcal{G}_{d}." class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mrow id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><mrow id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml"><mrow id="S2.E3.m1.1.1.2.2.2" xref="S2.E3.m1.1.1.2.2.2.cmml"><mrow id="S2.E3.m1.1.1.2.2.2.2" xref="S2.E3.m1.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.2.2.2.2.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.2.2.cmml">𝒜</mi><mo id="S2.E3.m1.1.1.2.2.2.2.1" xref="S2.E3.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.2.2.2.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.2.3.cmml">ℑ</mi><mo id="S2.E3.m1.1.1.2.2.2.2.1a" xref="S2.E3.m1.1.1.2.2.2.2.1.cmml">⁢</mo><msub id="S2.E3.m1.1.1.2.2.2.2.4" xref="S2.E3.m1.1.1.2.2.2.2.4.cmml"><mi id="S2.E3.m1.1.1.2.2.2.2.4.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.2.4.2.cmml">𝒢</mi><mi id="S2.E3.m1.1.1.2.2.2.2.4.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.2.4.3.cmml">∞</mi></msub></mrow><msub id="S2.E3.m1.1.1.2.2.2.1" xref="S2.E3.m1.1.1.2.2.2.1.cmml"><mo id="S2.E3.m1.1.1.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.1.1.2.2.2.1.2.cmml">×</mo><mrow id="S2.E3.m1.1.1.2.2.2.1.3" xref="S2.E3.m1.1.1.2.2.2.1.3.cmml"><mi id="S2.E3.m1.1.1.2.2.2.1.3.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.1.3.2.cmml">∋</mi><mo id="S2.E3.m1.1.1.2.2.2.1.3.1" xref="S2.E3.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.2.2.1.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.1.3.3.cmml">⇔</mi><mo id="S2.E3.m1.1.1.2.2.2.1.3.1a" xref="S2.E3.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.2.2.1.3.4" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S2.E3.m1.1.1.2.2.2.3" xref="S2.E3.m1.1.1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.2.2.2.3.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.3.2.cmml">𝒢</mi><mi id="S2.E3.m1.1.1.2.2.2.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.2.3.3.cmml">∈</mi></msub></mrow><msub id="S2.E3.m1.1.1.2.2.1" xref="S2.E3.m1.1.1.2.2.1.cmml"><mo id="S2.E3.m1.1.1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.1.1.2.2.1.2.cmml">×</mo><mrow id="S2.E3.m1.1.1.2.2.1.3" xref="S2.E3.m1.1.1.2.2.1.3.cmml"><mi id="S2.E3.m1.1.1.2.2.1.3.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.1.3.2.cmml">∋</mi><mo id="S2.E3.m1.1.1.2.2.1.3.1" xref="S2.E3.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.2.1.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.1.3.3.cmml">⇔</mi><mo id="S2.E3.m1.1.1.2.2.1.3.1a" xref="S2.E3.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.2.1.3.4" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.1.3.4.cmml">∞</mi></mrow></msub><mi id="S2.E3.m1.1.1.2.2.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.2.3.cmml">⋯</mi></mrow><msub id="S2.E3.m1.1.1.2.1" xref="S2.E3.m1.1.1.2.1.cmml"><mo id="S2.E3.m1.1.1.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.1.1.2.1.2.cmml">×</mo><mrow id="S2.E3.m1.1.1.2.1.3" xref="S2.E3.m1.1.1.2.1.3.cmml"><mi id="S2.E3.m1.1.1.2.1.3.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.1.3.2.cmml">∋</mi><mo id="S2.E3.m1.1.1.2.1.3.1" xref="S2.E3.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.1.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.1.3.3.cmml">⇔</mi><mo id="S2.E3.m1.1.1.2.1.3.1a" xref="S2.E3.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.1.3.4" mathvariant="normal" xref="S2.E3.m1.1.1.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2" mathvariant="normal" xref="S2.E3.m1.1.1.2.3.2.cmml">𝒢</mi><mi id="S2.E3.m1.1.1.2.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.2.3.3.cmml">⌈</mi></msub></mrow><mo id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.3.cmml">↙</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><times id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"></times><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><apply id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.1.1.cmml" xref="S2.E3.m1.1.1.2.1">subscript</csymbol><times id="S2.E3.m1.1.1.2.1.2.cmml" xref="S2.E3.m1.1.1.2.1.2"></times><apply id="S2.E3.m1.1.1.2.1.3.cmml" xref="S2.E3.m1.1.1.2.1.3"><times id="S2.E3.m1.1.1.2.1.3.1.cmml" xref="S2.E3.m1.1.1.2.1.3.1"></times><ci id="S2.E3.m1.1.1.2.1.3.2.cmml" xref="S2.E3.m1.1.1.2.1.3.2">∋</ci><ci id="S2.E3.m1.1.1.2.1.3.3.cmml" xref="S2.E3.m1.1.1.2.1.3.3">⇔</ci><ci id="S2.E3.m1.1.1.2.1.3.4.cmml" xref="S2.E3.m1.1.1.2.1.3.4">∞</ci></apply></apply><apply id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2"><apply id="S2.E3.m1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.1.1.cmml" xref="S2.E3.m1.1.1.2.2.1">subscript</csymbol><times id="S2.E3.m1.1.1.2.2.1.2.cmml" xref="S2.E3.m1.1.1.2.2.1.2"></times><apply id="S2.E3.m1.1.1.2.2.1.3.cmml" xref="S2.E3.m1.1.1.2.2.1.3"><times id="S2.E3.m1.1.1.2.2.1.3.1.cmml" xref="S2.E3.m1.1.1.2.2.1.3.1"></times><ci id="S2.E3.m1.1.1.2.2.1.3.2.cmml" xref="S2.E3.m1.1.1.2.2.1.3.2">∋</ci><ci id="S2.E3.m1.1.1.2.2.1.3.3.cmml" xref="S2.E3.m1.1.1.2.2.1.3.3">⇔</ci><ci id="S2.E3.m1.1.1.2.2.1.3.4.cmml" xref="S2.E3.m1.1.1.2.2.1.3.4">∞</ci></apply></apply><apply id="S2.E3.m1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2"><apply id="S2.E3.m1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.2.1.1.cmml" xref="S2.E3.m1.1.1.2.2.2.1">subscript</csymbol><times id="S2.E3.m1.1.1.2.2.2.1.2.cmml" xref="S2.E3.m1.1.1.2.2.2.1.2"></times><apply id="S2.E3.m1.1.1.2.2.2.1.3.cmml" xref="S2.E3.m1.1.1.2.2.2.1.3"><times id="S2.E3.m1.1.1.2.2.2.1.3.1.cmml" xref="S2.E3.m1.1.1.2.2.2.1.3.1"></times><ci id="S2.E3.m1.1.1.2.2.2.1.3.2.cmml" xref="S2.E3.m1.1.1.2.2.2.1.3.2">∋</ci><ci id="S2.E3.m1.1.1.2.2.2.1.3.3.cmml" xref="S2.E3.m1.1.1.2.2.2.1.3.3">⇔</ci><ci id="S2.E3.m1.1.1.2.2.2.1.3.4.cmml" xref="S2.E3.m1.1.1.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S2.E3.m1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2.2"><times id="S2.E3.m1.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2.2.2.1"></times><ci id="S2.E3.m1.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2.2.2">𝒜</ci><ci id="S2.E3.m1.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.2.2.3">ℑ</ci><apply id="S2.E3.m1.1.1.2.2.2.2.4.cmml" xref="S2.E3.m1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.2.2.4.1.cmml" xref="S2.E3.m1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.2.2.4.2.cmml" xref="S2.E3.m1.1.1.2.2.2.2.4.2">𝒢</ci><ci id="S2.E3.m1.1.1.2.2.2.2.4.3.cmml" xref="S2.E3.m1.1.1.2.2.2.2.4.3">∞</ci></apply></apply><apply id="S2.E3.m1.1.1.2.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.2.3.1.cmml" xref="S2.E3.m1.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.2.3.2.cmml" xref="S2.E3.m1.1.1.2.2.2.3.2">𝒢</ci><ci id="S2.E3.m1.1.1.2.2.2.3.3.cmml" xref="S2.E3.m1.1.1.2.2.2.3.3">∈</ci></apply></apply><ci id="S2.E3.m1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.3">⋯</ci></apply><apply id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2">𝒢</ci><ci id="S2.E3.m1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.3">⌈</ci></apply></apply><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">↙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\mathbfcal{A}=\mathbfcal{G}_{1}\times_{3,1}\mathbfcal{G}_{2}\times_{3,1}\cdots%
\times_{3,1}\mathbfcal{G}_{d}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">roman_𝒜 roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT ⋯ × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.9">The tuple <math alttext="(r_{0},r_{1},\ldots,r_{d})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.4.m1.4"><semantics id="S2.SS0.SSS0.Px2.p1.4.m1.4a"><mrow id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml"><mo id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.4" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml">(</mo><msub id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.2.cmml">r</mi><mn id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.3.cmml">0</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.5" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml">,</mo><msub id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.2.cmml">r</mi><mn id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.3.cmml">1</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.6" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.cmml">…</mi><mo id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.7" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml">,</mo><msub id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.2.cmml">r</mi><mi id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.3.cmml">d</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.8" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m1.4b"><vector id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.4.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3"><apply id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.2">𝑟</ci><cn id="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.4.m1.2.2.1.1.3">0</cn></apply><apply id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.2">𝑟</ci><cn id="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.4.m1.3.3.2.2.3">1</cn></apply><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1">…</ci><apply id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.2">𝑟</ci><ci id="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.4.4.3.3.3">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m1.4c">(r_{0},r_{1},\ldots,r_{d})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.4.m1.4d">( italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math> is the TT rank of the TT decomposition (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.E3" title="In Tensor Decomposition. ‣ 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3</span></a>) and must satisfy <math alttext="r_{0}=r_{d}=1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.5.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.5.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p1.5.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.2.cmml">r</mi><mn id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.3" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.3.cmml">=</mo><msub id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.2" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.2.cmml">r</mi><mi id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.3" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.3.cmml">d</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.5" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.5.cmml">=</mo><mn id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.6" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.5.m2.1b"><apply id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1"><and id="S2.SS0.SSS0.Px2.p1.5.m2.1.1a.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1"></and><apply id="S2.SS0.SSS0.Px2.p1.5.m2.1.1b.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1"><eq id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.3"></eq><apply id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.2">𝑟</ci><cn id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.2.3">0</cn></apply><apply id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.2">𝑟</ci><ci id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.3">𝑑</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p1.5.m2.1.1c.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1"><eq id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.5.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.5"></eq><share href="https://arxiv.org/html/2405.14377v1#S2.SS0.SSS0.Px2.p1.5.m2.1.1.4.cmml" id="S2.SS0.SSS0.Px2.p1.5.m2.1.1d.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1"></share><cn id="S2.SS0.SSS0.Px2.p1.5.m2.1.1.6.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.5.m2.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.5.m2.1c">r_{0}=r_{d}=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.5.m2.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 1</annotation></semantics></math>.
TTM considers an order-<math alttext="2d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.6.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.6.m3.1a"><mrow id="S2.SS0.SSS0.Px2.p1.6.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.cmml"><mn id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.2.cmml">2</mn><mo id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.1" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.6.m3.1b"><apply id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1"><times id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.1"></times><cn id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.2.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.2">2</cn><ci id="S2.SS0.SSS0.Px2.p1.6.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.6.m3.1c">2d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.6.m3.1d">2 italic_d</annotation></semantics></math> tensor <math alttext="\mathbfcal{B}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.7.m4.1"><semantics id="S2.SS0.SSS0.Px2.p1.7.m4.1a"><mi id="S2.SS0.SSS0.Px2.p1.7.m4.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.7.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.7.m4.1b"><ci id="S2.SS0.SSS0.Px2.p1.7.m4.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.7.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.7.m4.1c">\mathbfcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.7.m4.1d">roman_ℬ</annotation></semantics></math> of dimension <math alttext="m_{1}\times n_{2}\times\cdots\times m_{d}\times n_{d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.8.m5.1"><semantics id="S2.SS0.SSS0.Px2.p1.8.m5.1a"><mrow id="S2.SS0.SSS0.Px2.p1.8.m5.1.1" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.2.cmml">m</mi><mn id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.2" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.2.cmml">n</mi><mn id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.3.cmml">2</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.4" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.4.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.cmml"><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.2" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.2.cmml">m</mi><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.3" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.3.cmml">d</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1c" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.cmml"><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.2" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.2.cmml">n</mi><mi id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.3" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.8.m5.1b"><apply id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1"><times id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.1"></times><apply id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.2">𝑚</ci><cn id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.2.3">1</cn></apply><apply id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.2">𝑛</ci><cn id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.3.3">2</cn></apply><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.4">⋯</ci><apply id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.2.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.2">𝑚</ci><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.3.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.5.3">𝑑</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.1.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.2.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.2">𝑛</ci><ci id="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.3.cmml" xref="S2.SS0.SSS0.Px2.p1.8.m5.1.1.6.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.8.m5.1c">m_{1}\times n_{2}\times\cdots\times m_{d}\times n_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.8.m5.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT × ⋯ × italic_m start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, and represents <math alttext="\mathbfcal{B}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.9.m6.1"><semantics id="S2.SS0.SSS0.Px2.p1.9.m6.1a"><mi id="S2.SS0.SSS0.Px2.p1.9.m6.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.9.m6.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.9.m6.1b"><ci id="S2.SS0.SSS0.Px2.p1.9.m6.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.9.m6.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.9.m6.1c">\mathbfcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.9.m6.1d">roman_ℬ</annotation></semantics></math> as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{B}=\mathbfcal{F}_{1}\times_{4,1}\mathbfcal{F}_{2}\times_{4,1}\cdots%
\times_{4,1}\mathbfcal{F}_{d}," class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mrow id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml"><mrow id="S2.E4.m1.1.1.2.2" xref="S2.E4.m1.1.1.2.2.cmml"><mrow id="S2.E4.m1.1.1.2.2.2" xref="S2.E4.m1.1.1.2.2.2.cmml"><mrow id="S2.E4.m1.1.1.2.2.2.2" xref="S2.E4.m1.1.1.2.2.2.2.cmml"><mi id="S2.E4.m1.1.1.2.2.2.2.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.2.2.cmml">ℬ</mi><mo id="S2.E4.m1.1.1.2.2.2.2.1" xref="S2.E4.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.2.2.2.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.2.3.cmml">ℑ</mi><mo id="S2.E4.m1.1.1.2.2.2.2.1a" xref="S2.E4.m1.1.1.2.2.2.2.1.cmml">⁢</mo><msub id="S2.E4.m1.1.1.2.2.2.2.4" xref="S2.E4.m1.1.1.2.2.2.2.4.cmml"><mi id="S2.E4.m1.1.1.2.2.2.2.4.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.2.4.2.cmml">ℱ</mi><mi id="S2.E4.m1.1.1.2.2.2.2.4.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.2.4.3.cmml">∞</mi></msub></mrow><msub id="S2.E4.m1.1.1.2.2.2.1" xref="S2.E4.m1.1.1.2.2.2.1.cmml"><mo id="S2.E4.m1.1.1.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E4.m1.1.1.2.2.2.1.2.cmml">×</mo><mrow id="S2.E4.m1.1.1.2.2.2.1.3" xref="S2.E4.m1.1.1.2.2.2.1.3.cmml"><mi id="S2.E4.m1.1.1.2.2.2.1.3.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.1.3.2.cmml">△</mi><mo id="S2.E4.m1.1.1.2.2.2.1.3.1" xref="S2.E4.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.2.2.1.3.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.1.3.3.cmml">⇔</mi><mo id="S2.E4.m1.1.1.2.2.2.1.3.1a" xref="S2.E4.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.2.2.1.3.4" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S2.E4.m1.1.1.2.2.2.3" xref="S2.E4.m1.1.1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.2.2.2.3.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.3.2.cmml">ℱ</mi><mi id="S2.E4.m1.1.1.2.2.2.3.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.2.3.3.cmml">∈</mi></msub></mrow><msub id="S2.E4.m1.1.1.2.2.1" xref="S2.E4.m1.1.1.2.2.1.cmml"><mo id="S2.E4.m1.1.1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E4.m1.1.1.2.2.1.2.cmml">×</mo><mrow id="S2.E4.m1.1.1.2.2.1.3" xref="S2.E4.m1.1.1.2.2.1.3.cmml"><mi id="S2.E4.m1.1.1.2.2.1.3.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.1.3.2.cmml">△</mi><mo id="S2.E4.m1.1.1.2.2.1.3.1" xref="S2.E4.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.2.1.3.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.1.3.3.cmml">⇔</mi><mo id="S2.E4.m1.1.1.2.2.1.3.1a" xref="S2.E4.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.2.1.3.4" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.1.3.4.cmml">∞</mi></mrow></msub><mi id="S2.E4.m1.1.1.2.2.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.2.3.cmml">⋯</mi></mrow><msub id="S2.E4.m1.1.1.2.1" xref="S2.E4.m1.1.1.2.1.cmml"><mo id="S2.E4.m1.1.1.2.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E4.m1.1.1.2.1.2.cmml">×</mo><mrow id="S2.E4.m1.1.1.2.1.3" xref="S2.E4.m1.1.1.2.1.3.cmml"><mi id="S2.E4.m1.1.1.2.1.3.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.1.3.2.cmml">△</mi><mo id="S2.E4.m1.1.1.2.1.3.1" xref="S2.E4.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.1.3.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.1.3.3.cmml">⇔</mi><mo id="S2.E4.m1.1.1.2.1.3.1a" xref="S2.E4.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.2.1.3.4" mathvariant="normal" xref="S2.E4.m1.1.1.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S2.E4.m1.1.1.2.3" xref="S2.E4.m1.1.1.2.3.cmml"><mi id="S2.E4.m1.1.1.2.3.2" mathvariant="normal" xref="S2.E4.m1.1.1.2.3.2.cmml">ℱ</mi><mi id="S2.E4.m1.1.1.2.3.3" mathvariant="normal" xref="S2.E4.m1.1.1.2.3.3.cmml">⌈</mi></msub></mrow><mo id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3" mathvariant="normal" xref="S2.E4.m1.1.1.3.cmml">⇔</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><times id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"></times><apply id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2"><apply id="S2.E4.m1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.1.1.cmml" xref="S2.E4.m1.1.1.2.1">subscript</csymbol><times id="S2.E4.m1.1.1.2.1.2.cmml" xref="S2.E4.m1.1.1.2.1.2"></times><apply id="S2.E4.m1.1.1.2.1.3.cmml" xref="S2.E4.m1.1.1.2.1.3"><times id="S2.E4.m1.1.1.2.1.3.1.cmml" xref="S2.E4.m1.1.1.2.1.3.1"></times><ci id="S2.E4.m1.1.1.2.1.3.2.cmml" xref="S2.E4.m1.1.1.2.1.3.2">△</ci><ci id="S2.E4.m1.1.1.2.1.3.3.cmml" xref="S2.E4.m1.1.1.2.1.3.3">⇔</ci><ci id="S2.E4.m1.1.1.2.1.3.4.cmml" xref="S2.E4.m1.1.1.2.1.3.4">∞</ci></apply></apply><apply id="S2.E4.m1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.2.2"><apply id="S2.E4.m1.1.1.2.2.1.cmml" xref="S2.E4.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.2.1.1.cmml" xref="S2.E4.m1.1.1.2.2.1">subscript</csymbol><times id="S2.E4.m1.1.1.2.2.1.2.cmml" xref="S2.E4.m1.1.1.2.2.1.2"></times><apply id="S2.E4.m1.1.1.2.2.1.3.cmml" xref="S2.E4.m1.1.1.2.2.1.3"><times id="S2.E4.m1.1.1.2.2.1.3.1.cmml" xref="S2.E4.m1.1.1.2.2.1.3.1"></times><ci id="S2.E4.m1.1.1.2.2.1.3.2.cmml" xref="S2.E4.m1.1.1.2.2.1.3.2">△</ci><ci id="S2.E4.m1.1.1.2.2.1.3.3.cmml" xref="S2.E4.m1.1.1.2.2.1.3.3">⇔</ci><ci id="S2.E4.m1.1.1.2.2.1.3.4.cmml" xref="S2.E4.m1.1.1.2.2.1.3.4">∞</ci></apply></apply><apply id="S2.E4.m1.1.1.2.2.2.cmml" xref="S2.E4.m1.1.1.2.2.2"><apply id="S2.E4.m1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.2.2.1.1.cmml" xref="S2.E4.m1.1.1.2.2.2.1">subscript</csymbol><times id="S2.E4.m1.1.1.2.2.2.1.2.cmml" xref="S2.E4.m1.1.1.2.2.2.1.2"></times><apply id="S2.E4.m1.1.1.2.2.2.1.3.cmml" xref="S2.E4.m1.1.1.2.2.2.1.3"><times id="S2.E4.m1.1.1.2.2.2.1.3.1.cmml" xref="S2.E4.m1.1.1.2.2.2.1.3.1"></times><ci id="S2.E4.m1.1.1.2.2.2.1.3.2.cmml" xref="S2.E4.m1.1.1.2.2.2.1.3.2">△</ci><ci id="S2.E4.m1.1.1.2.2.2.1.3.3.cmml" xref="S2.E4.m1.1.1.2.2.2.1.3.3">⇔</ci><ci id="S2.E4.m1.1.1.2.2.2.1.3.4.cmml" xref="S2.E4.m1.1.1.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S2.E4.m1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.1.1.2.2.2.2"><times id="S2.E4.m1.1.1.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.2.2.2.2.1"></times><ci id="S2.E4.m1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.2.2.2.2.2">ℬ</ci><ci id="S2.E4.m1.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.2.2.2.2.3">ℑ</ci><apply id="S2.E4.m1.1.1.2.2.2.2.4.cmml" xref="S2.E4.m1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.2.2.2.4.1.cmml" xref="S2.E4.m1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S2.E4.m1.1.1.2.2.2.2.4.2.cmml" xref="S2.E4.m1.1.1.2.2.2.2.4.2">ℱ</ci><ci id="S2.E4.m1.1.1.2.2.2.2.4.3.cmml" xref="S2.E4.m1.1.1.2.2.2.2.4.3">∞</ci></apply></apply><apply id="S2.E4.m1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.2.2.3.1.cmml" xref="S2.E4.m1.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E4.m1.1.1.2.2.2.3.2.cmml" xref="S2.E4.m1.1.1.2.2.2.3.2">ℱ</ci><ci id="S2.E4.m1.1.1.2.2.2.3.3.cmml" xref="S2.E4.m1.1.1.2.2.2.3.3">∈</ci></apply></apply><ci id="S2.E4.m1.1.1.2.2.3.cmml" xref="S2.E4.m1.1.1.2.2.3">⋯</ci></apply><apply id="S2.E4.m1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.3.1.cmml" xref="S2.E4.m1.1.1.2.3">subscript</csymbol><ci id="S2.E4.m1.1.1.2.3.2.cmml" xref="S2.E4.m1.1.1.2.3.2">ℱ</ci><ci id="S2.E4.m1.1.1.2.3.3.cmml" xref="S2.E4.m1.1.1.2.3.3">⌈</ci></apply></apply><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">⇔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\mathbfcal{B}=\mathbfcal{F}_{1}\times_{4,1}\mathbfcal{F}_{2}\times_{4,1}\cdots%
\times_{4,1}\mathbfcal{F}_{d},</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">roman_ℬ roman_ℑ roman_ℱ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT roman_ℱ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT ⋯ × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT roman_ℱ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.12">where <math alttext="\mathbfcal{F}_{i}\in\mathbb{R}^{r_{i-1}\times m_{i}\times n_{i}\times r_{i}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.10.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.10.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p1.10.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.2.cmml">ℱ</mi><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.3.cmml">⟩</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.cmml"><msub id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.2.cmml">∇</mi><mrow id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.2.cmml">⟩</mi><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.3.cmml">↖</mi><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1a" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.4" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.4.cmml">∞</mi></mrow></msub><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.2.cmml">⇕</mi><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.3.cmml">⟩</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.2.cmml">\</mi><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.3.cmml">⟩</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.cmml"><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.2.cmml">∇</mi><mi id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.3.cmml">⟩</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.10.m1.1b"><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1"><in id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.1"></in><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.2">ℱ</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.2.3">⟩</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.2">ℛ</ci><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.1"></times><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.2">∇</ci><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3"><times id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.2">⟩</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.3">↖</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.2.3.4">∞</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.2">⇕</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.3.3">⟩</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.2">\</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.4.3">⟩</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.2.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.2">∇</ci><ci id="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.3.cmml" xref="S2.SS0.SSS0.Px2.p1.10.m1.1.1.3.3.5.3">⟩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.10.m1.1c">\mathbfcal{F}_{i}\in\mathbb{R}^{r_{i-1}\times m_{i}\times n_{i}\times r_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.10.m1.1d">roman_ℱ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ∈ roman_ℛ start_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT ⟩ ↖ ∞ end_POSTSUBSCRIPT × ⇕ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT × ∇ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="i=1,\ldots,d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.11.m2.3"><semantics id="S2.SS0.SSS0.Px2.p1.11.m2.3a"><mrow id="S2.SS0.SSS0.Px2.p1.11.m2.3.4" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.2" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.1" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.2" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.1.cmml"><mn id="S2.SS0.SSS0.Px2.p1.11.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.11.m2.1.1.cmml">1</mn><mo id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.2.1" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p1.11.m2.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.11.m2.2.2.cmml">…</mi><mo id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.2.2" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p1.11.m2.3.3" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.11.m2.3b"><apply id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4"><eq id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.1"></eq><ci id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.2">𝑖</ci><list id="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.4.3.2"><cn id="S2.SS0.SSS0.Px2.p1.11.m2.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.11.m2.1.1">1</cn><ci id="S2.SS0.SSS0.Px2.p1.11.m2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.2.2">…</ci><ci id="S2.SS0.SSS0.Px2.p1.11.m2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.11.m2.3.3">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.11.m2.3c">i=1,\ldots,d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.11.m2.3d">italic_i = 1 , … , italic_d</annotation></semantics></math> and <math alttext="r_{0}=r_{d}=1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.12.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.12.m3.1a"><mrow id="S2.SS0.SSS0.Px2.p1.12.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.2.cmml">r</mi><mn id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.3.cmml">=</mo><msub id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.2" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.2.cmml">r</mi><mi id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.3" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.3.cmml">d</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.5" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.5.cmml">=</mo><mn id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.6" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.12.m3.1b"><apply id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1"><and id="S2.SS0.SSS0.Px2.p1.12.m3.1.1a.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1"></and><apply id="S2.SS0.SSS0.Px2.p1.12.m3.1.1b.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1"><eq id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.3"></eq><apply id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.2">𝑟</ci><cn id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.2.3">0</cn></apply><apply id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.2">𝑟</ci><ci id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.3">𝑑</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p1.12.m3.1.1c.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1"><eq id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.5.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.5"></eq><share href="https://arxiv.org/html/2405.14377v1#S2.SS0.SSS0.Px2.p1.12.m3.1.1.4.cmml" id="S2.SS0.SSS0.Px2.p1.12.m3.1.1d.cmml" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1"></share><cn id="S2.SS0.SSS0.Px2.p1.12.m3.1.1.6.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.12.m3.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.12.m3.1c">r_{0}=r_{d}=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.12.m3.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 1</annotation></semantics></math>.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S2.F3" title="Figure 3 ‣ Tensor Decomposition. ‣ 2 Background ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3</span></a> shows the tensor-network representations of TT and TTM decomposition.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="100" id="S2.F3.g1" src="extracted/2405.14377v1/figures/TT_TTM_contractions_new.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S2.F3.3.2" style="font-size:90%;">Tensor networks for (a) tensor-train and (b) tensor-train-matrix decompositions.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">In tensor-compressed neural networks, large weight matrices are reshaped to high-order tensors and compressed into small tensor cores in TT or TTM format. The weights of linear layers are often compressed into the TT format due to its efficiency in tensor-vector multiplications. The TTM format is more suitable for embedding tables whose dimension is highly unbalanced.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The CoMERA Training Framework</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The size of the tensor-compressed neural networks can be adjusted by modifying the tensor ranks. However, it also brings in an important problem: <span class="ltx_text ltx_font_italic" id="S3.p1.1.1">how can we determine the tensor ranks automatically for a given resource limit?</span> We propose a multi-objective optimization to address this issue.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Multi-Objective Training Model</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">A Modified TT Representation.</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.5">We consider the tensor-compressed training for a generic neural network. Suppose that the neural network is parameterized as <math alttext="f(\mathbf{x}|\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^%
{P})" class="ltx_math_unparsed" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1">f</mi><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.2"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.1" stretchy="false">(</mo><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.2">𝐱</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><msubsup id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.1" stretchy="false">{</mo><msubsup id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.2"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.2.2.2" mathvariant="normal">𝒢</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.2.3" mathvariant="normal">∞</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.2.2.3" mathvariant="normal">⟩</mi></msubsup><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.3" mathvariant="normal">⇔</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.4" mathvariant="normal">…</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.5" mathvariant="normal">⇔</mi><msubsup id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6.2.2" mathvariant="normal">𝒢</mi><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6.3"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6.3.2" mathvariant="normal">⌈</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6.3.3" mathvariant="normal">⟩</mi></msub><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.6.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.2.7" stretchy="false">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3.2" mathvariant="normal">⟩</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3.1">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3.3" mathvariant="normal">ℑ</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3.1a">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.2.3.4" mathvariant="normal">∞</mi></mrow><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.4.3" mathvariant="normal">𝒫</mi></msubsup><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.2.5" mathvariant="normal">⇒</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">f(\mathbf{x}|\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^%
{P})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.1d">italic_f ( bold_x | { roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_𝒫 end_POSTSUPERSCRIPT ⇒</annotation></semantics></math>, where <math alttext="\{\mathbfcal{G}^{i}_{j}\in\mathbb{R}^{r^{i}_{j-1}\times n^{i}_{j}\times r^{i}_%
{j}}\}_{j=1}^{d_{i}}" class="ltx_math_unparsed" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><msubsup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1"><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" stretchy="false">{</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"><msubsup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2.2.2" mathvariant="normal">𝒢</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2.3" stretchy="false">|</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.2" mathvariant="normal">ℛ</mi><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3"><msubsup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.2.2" mathvariant="normal">∇</mi><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.3"><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.3.1" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.3.2" mathvariant="normal">↖</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.3.3" mathvariant="normal">∞</mi></mrow><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.2.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em">×</mo><msubsup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.3"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.3.2.2" mathvariant="normal">\</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.3.3" stretchy="false">|</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.3.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em">×</mo><msubsup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.4"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.4.2.2" mathvariant="normal">∇</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.4.3" stretchy="false">|</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3.3.4.2.3" mathvariant="normal">⟩</mi></msubsup></mrow></msup></mrow><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" stretchy="false">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.3"><mo fence="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.3.1" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.3.2" mathvariant="normal">ℑ</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.3.3" mathvariant="normal">∞</mi></mrow><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.2" mathvariant="normal">⌈</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3" mathvariant="normal">⟩</mi></msub></msubsup><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1b">\{\mathbfcal{G}^{i}_{j}\in\mathbb{R}^{r^{i}_{j-1}\times n^{i}_{j}\times r^{i}_%
{j}}\}_{j=1}^{d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">{ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | end_POSTSUBSCRIPT ∈ roman_ℛ start_POSTSUPERSCRIPT ∇ start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | ↖ ∞ end_POSTSUBSCRIPT × \ start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | end_POSTSUBSCRIPT × ∇ start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | end_POSTSUBSCRIPT end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT | roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> compress the original weight <math alttext="\mathbf{W}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2">𝐖</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">\mathbf{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="\{\mathbf{x}_{k},y_{k}\}_{k=1}^{N}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.2"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.2a"><msubsup id="S3.SS1.SSS0.Px1.p1.4.m4.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.3.cmml">{</mo><msub id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.5" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.2.cmml">k</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.1.cmml">=</mo><mn id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.4.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.2b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2">subscript</csymbol><set id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.2.2.2.3">𝑘</ci></apply></set><apply id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4"><eq id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.1"></eq><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.2">𝑘</ci><cn id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.2.4.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.2c">\{\mathbf{x}_{k},y_{k}\}_{k=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.2d">{ bold_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> be training data and <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.5.m5.1d">caligraphic_L</annotation></semantics></math> be the loss function. The training is to minimize the following objective function</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^{P}}L:=%
\sum_{k=1}^{N}\mathcal{L}(y_{k},f(\mathbf{x}_{k}|\{\mathbfcal{G}^{i}_{1},%
\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^{P}))." class="ltx_math_unparsed" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2b"><munder id="S3.E5.m1.2.3"><mi id="S3.E5.m1.2.3.2">min</mi><msubsup id="S3.E5.m1.1.1.1"><mrow id="S3.E5.m1.1.1.1.1.1.1"><mo id="S3.E5.m1.1.1.1.1.1.1.2" stretchy="false">{</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1"><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.2"><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.2.2" mathvariant="normal">𝒢</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.3" mathvariant="normal">∞</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.1.1.1.1">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.3" mathvariant="normal">⇔</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1a">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.4" mathvariant="normal">…</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1b">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.5" mathvariant="normal">⇔</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1c">⁢</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.6"><mi id="S3.E5.m1.1.1.1.1.1.1.1.6.2.2" mathvariant="normal">𝒢</mi><msub id="S3.E5.m1.1.1.1.1.1.1.1.6.3"><mi id="S3.E5.m1.1.1.1.1.1.1.1.6.3.2" mathvariant="normal">⌈</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.6.3.3" mathvariant="normal">⟩</mi></msub><mi id="S3.E5.m1.1.1.1.1.1.1.1.6.2.3" mathvariant="normal">⟩</mi></msubsup></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.3" stretchy="false">}</mo></mrow><mrow id="S3.E5.m1.1.1.1.1.3"><mi id="S3.E5.m1.1.1.1.1.3.2" mathvariant="normal">⟩</mi><mo id="S3.E5.m1.1.1.1.1.3.1">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.3" mathvariant="normal">ℑ</mi><mo id="S3.E5.m1.1.1.1.1.3.1a">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.4" mathvariant="normal">∞</mi></mrow><mi id="S3.E5.m1.1.1.1.3" mathvariant="normal">𝒫</mi></msubsup></munder><mi id="S3.E5.m1.2.4">L</mi><mo id="S3.E5.m1.2.5" lspace="0.278em" rspace="0.111em">:=</mo><munderover id="S3.E5.m1.2.6"><mo id="S3.E5.m1.2.6.2.2" movablelimits="false">∑</mo><mrow id="S3.E5.m1.2.6.2.3"><mi id="S3.E5.m1.2.6.2.3.2">k</mi><mo id="S3.E5.m1.2.6.2.3.1">=</mo><mn id="S3.E5.m1.2.6.2.3.3">1</mn></mrow><mi id="S3.E5.m1.2.6.3">N</mi></munderover><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.7">ℒ</mi><mrow id="S3.E5.m1.2.8"><mo id="S3.E5.m1.2.8.1" stretchy="false">(</mo><msub id="S3.E5.m1.2.8.2"><mi id="S3.E5.m1.2.8.2.2">y</mi><mi id="S3.E5.m1.2.8.2.3">k</mi></msub><mo id="S3.E5.m1.2.8.3">,</mo><mi id="S3.E5.m1.2.2">f</mi><mrow id="S3.E5.m1.2.8.4"><mo id="S3.E5.m1.2.8.4.1" stretchy="false">(</mo><msub id="S3.E5.m1.2.8.4.2"><mi id="S3.E5.m1.2.8.4.2.2">𝐱</mi><mi id="S3.E5.m1.2.8.4.2.3">k</mi></msub><mo fence="false" id="S3.E5.m1.2.8.4.3" rspace="0.167em" stretchy="false">|</mo><msubsup id="S3.E5.m1.2.8.4.4"><mrow id="S3.E5.m1.2.8.4.4.2.2"><mo id="S3.E5.m1.2.8.4.4.2.2.1" stretchy="false">{</mo><msubsup id="S3.E5.m1.2.8.4.4.2.2.2"><mi id="S3.E5.m1.2.8.4.4.2.2.2.2.2" mathvariant="normal">𝒢</mi><mi id="S3.E5.m1.2.8.4.4.2.2.2.3" mathvariant="normal">∞</mi><mi id="S3.E5.m1.2.8.4.4.2.2.2.2.3" mathvariant="normal">⟩</mi></msubsup><mi id="S3.E5.m1.2.8.4.4.2.2.3" mathvariant="normal">⇔</mi><mi id="S3.E5.m1.2.8.4.4.2.2.4" mathvariant="normal">…</mi><mi id="S3.E5.m1.2.8.4.4.2.2.5" mathvariant="normal">⇔</mi><msubsup id="S3.E5.m1.2.8.4.4.2.2.6"><mi id="S3.E5.m1.2.8.4.4.2.2.6.2.2" mathvariant="normal">𝒢</mi><msub id="S3.E5.m1.2.8.4.4.2.2.6.3"><mi id="S3.E5.m1.2.8.4.4.2.2.6.3.2" mathvariant="normal">⌈</mi><mi id="S3.E5.m1.2.8.4.4.2.2.6.3.3" mathvariant="normal">⟩</mi></msub><mi id="S3.E5.m1.2.8.4.4.2.2.6.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.E5.m1.2.8.4.4.2.2.7" stretchy="false">}</mo></mrow><mrow id="S3.E5.m1.2.8.4.4.2.3"><mi id="S3.E5.m1.2.8.4.4.2.3.2" mathvariant="normal">⟩</mi><mo id="S3.E5.m1.2.8.4.4.2.3.1">⁢</mo><mi id="S3.E5.m1.2.8.4.4.2.3.3" mathvariant="normal">ℑ</mi><mo id="S3.E5.m1.2.8.4.4.2.3.1a">⁢</mo><mi id="S3.E5.m1.2.8.4.4.2.3.4" mathvariant="normal">∞</mi></mrow><mi id="S3.E5.m1.2.8.4.4.3" mathvariant="normal">𝒫</mi></msubsup><mi id="S3.E5.m1.2.8.4.5" mathvariant="normal">⇒</mi><mi id="S3.E5.m1.2.8.4.6" mathvariant="normal">⇒</mi><mi id="S3.E5.m1.2.8.4.7" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\min_{\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^{P}}L:=%
\sum_{k=1}^{N}\mathcal{L}(y_{k},f(\mathbf{x}_{k}|\{\mathbfcal{G}^{i}_{1},%
\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1}^{P})).</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">roman_min start_POSTSUBSCRIPT { roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_𝒫 end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_L := ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT caligraphic_L ( italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_f ( bold_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | { roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_𝒫 end_POSTSUPERSCRIPT ⇒ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.10">We modify the TT compression and control the ranks of <math alttext="\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.6.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.6.m1.1a"><mrow id="S3.SS1.SSS0.Px1.p1.6.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.3.cmml">∞</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.3.cmml">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.3.cmml">⇔</mi><mo id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1a" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.4" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.4.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1b" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.5" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.5.cmml">⇔</mi><mo id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1c" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1.cmml">⁢</mo><msubsup id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.2.cmml">𝒢</mi><msub id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.2.cmml">⌈</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.3.cmml">⟩</mi></msub><mi id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.3.cmml">⟩</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.6.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1"><times id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.1"></times><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.2">𝒢</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.2.3">⟩</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.2.3">∞</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.3">⇔</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.4">…</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.5">⇔</ci><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.2">𝒢</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.2.3">⟩</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.2">⌈</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m1.1.1.6.3.3">⟩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.6.m1.1c">\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.6.m1.1d">roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> by a set of diagonal matrices <math alttext="\{\mathbf{D}^{i}_{j}\in\mathbb{R}^{r^{i}_{j}\times r^{i}_{j}}\}_{j=1}^{d-1}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.7.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.7.m2.1a"><msubsup id="S3.SS1.SSS0.Px1.p1.7.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.2.cmml">𝐃</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.1.cmml">×</mo><msubsup id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.3.cmml">i</mi></msubsup></mrow></msup></mrow><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.2.cmml">j</mi><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.1" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.7.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1">subscript</csymbol><set id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1"><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1"><in id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.1"></in><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.2">𝐃</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3"><times id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.1"></times><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.2">𝑟</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.2.3">𝑗</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.2">𝑟</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></set><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3"><eq id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.1"></eq><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.2">𝑗</ci><cn id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3"><minus id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.1"></minus><ci id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.2">𝑑</ci><cn id="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.7.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.7.m2.1c">\{\mathbf{D}^{i}_{j}\in\mathbb{R}^{r^{i}_{j}\times r^{i}_{j}}\}_{j=1}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.7.m2.1d">{ bold_D start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT × italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. Specifically, let <math alttext="\mathbfcal{W}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.8.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.8.m3.1a"><msub id="S3.SS1.SSS0.Px1.p1.8.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1.2.cmml">𝒲</mi><mi id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.8.m3.1b"><apply id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1.2">𝒲</ci><ci id="S3.SS1.SSS0.Px1.p1.8.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m3.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.8.m3.1c">\mathbfcal{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.8.m3.1d">roman_𝒲 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> be the reshape of <math alttext="\mathbf{W}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.9.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.9.m4.1a"><msub id="S3.SS1.SSS0.Px1.p1.9.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.9.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1.2">𝐖</ci><ci id="S3.SS1.SSS0.Px1.p1.9.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.9.m4.1c">\mathbf{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.9.m4.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and the compression of <math alttext="\mathbf{W}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.10.m5.1"><semantics id="S3.SS1.SSS0.Px1.p1.10.m5.1a"><msub id="S3.SS1.SSS0.Px1.p1.10.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.2" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.3" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.10.m5.1b"><apply id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1.2">𝐖</ci><ci id="S3.SS1.SSS0.Px1.p1.10.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.10.m5.1c">\mathbf{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.10.m5.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{W}_{i}=\mathbfcal{G}^{i}_{1}\times_{3,1}\mathbf{D}^{i}_{1}\times_{2%
,1}\mathbfcal{G}^{i}_{2}\times_{3,1}\cdots\times_{3,1}\mathbf{D}^{i}_{d_{i}-1}%
\times_{2,1}\mathbfcal{G}^{i}_{d_{i}}." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mrow id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml"><mrow id="S3.E6.m1.1.1.2.2.2" xref="S3.E6.m1.1.1.2.2.2.cmml"><mrow id="S3.E6.m1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.2.2.2.2.cmml"><mrow id="S3.E6.m1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.2.2.2.2.2.cmml"><mrow id="S3.E6.m1.1.1.2.2.2.2.2.2" xref="S3.E6.m1.1.1.2.2.2.2.2.2.cmml"><msub id="S3.E6.m1.1.1.2.2.2.2.2.2.2" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2.2.cmml">𝒲</mi><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2.3.cmml">⟩</mi></msub><mo id="S3.E6.m1.1.1.2.2.2.2.2.2.1" xref="S3.E6.m1.1.1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.3.cmml">ℑ</mi><mo id="S3.E6.m1.1.1.2.2.2.2.2.2.1a" xref="S3.E6.m1.1.1.2.2.2.2.2.2.1.cmml">⁢</mo><msubsup id="S3.E6.m1.1.1.2.2.2.2.2.2.4" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.2.cmml">𝒢</mi><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.4.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.3.cmml">∞</mi><mi id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.3.cmml">⟩</mi></msubsup></mrow><msub id="S3.E6.m1.1.1.2.2.2.2.2.1" xref="S3.E6.m1.1.1.2.2.2.2.2.1.cmml"><mo id="S3.E6.m1.1.1.2.2.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.2.2.2.2.2.1.2.cmml">×</mo><mrow id="S3.E6.m1.1.1.2.2.2.2.2.1.3" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.2.cmml">∋</mi><mo id="S3.E6.m1.1.1.2.2.2.2.2.1.3.1" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.2.2.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.3.cmml">⇔</mi><mo id="S3.E6.m1.1.1.2.2.2.2.2.1.3.1a" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.2.2.1.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><msubsup id="S3.E6.m1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.2.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.3.2.2.cmml">𝒟</mi><mi id="S3.E6.m1.1.1.2.2.2.2.2.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.3.3.cmml">∞</mi><mi id="S3.E6.m1.1.1.2.2.2.2.2.3.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.2.3.2.3.cmml">⟩</mi></msubsup></mrow><msub id="S3.E6.m1.1.1.2.2.2.2.1" xref="S3.E6.m1.1.1.2.2.2.2.1.cmml"><mo id="S3.E6.m1.1.1.2.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.2.2.2.2.1.2.cmml">×</mo><mrow id="S3.E6.m1.1.1.2.2.2.2.1.3" xref="S3.E6.m1.1.1.2.2.2.2.1.3.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.1.3.2.cmml">∈</mi><mo id="S3.E6.m1.1.1.2.2.2.2.1.3.1" xref="S3.E6.m1.1.1.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.2.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.1.3.3.cmml">⇔</mi><mo id="S3.E6.m1.1.1.2.2.2.2.1.3.1a" xref="S3.E6.m1.1.1.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.2.1.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><msubsup id="S3.E6.m1.1.1.2.2.2.2.3" xref="S3.E6.m1.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.2.2.2.2.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.3.2.2.cmml">𝒢</mi><mi id="S3.E6.m1.1.1.2.2.2.2.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.3.3.cmml">∈</mi><mi id="S3.E6.m1.1.1.2.2.2.2.3.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.2.3.2.3.cmml">⟩</mi></msubsup></mrow><msub id="S3.E6.m1.1.1.2.2.2.1" xref="S3.E6.m1.1.1.2.2.2.1.cmml"><mo id="S3.E6.m1.1.1.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.2.2.2.1.2.cmml">×</mo><mrow id="S3.E6.m1.1.1.2.2.2.1.3" xref="S3.E6.m1.1.1.2.2.2.1.3.cmml"><mi id="S3.E6.m1.1.1.2.2.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.1.3.2.cmml">∋</mi><mo id="S3.E6.m1.1.1.2.2.2.1.3.1" xref="S3.E6.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.1.3.3.cmml">⇔</mi><mo id="S3.E6.m1.1.1.2.2.2.1.3.1a" xref="S3.E6.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.2.1.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><mi id="S3.E6.m1.1.1.2.2.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.2.3.cmml">⋯</mi></mrow><msub id="S3.E6.m1.1.1.2.2.1" xref="S3.E6.m1.1.1.2.2.1.cmml"><mo id="S3.E6.m1.1.1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.2.2.1.2.cmml">×</mo><mrow id="S3.E6.m1.1.1.2.2.1.3" xref="S3.E6.m1.1.1.2.2.1.3.cmml"><mi id="S3.E6.m1.1.1.2.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.1.3.2.cmml">∋</mi><mo id="S3.E6.m1.1.1.2.2.1.3.1" xref="S3.E6.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.1.3.3.cmml">⇔</mi><mo id="S3.E6.m1.1.1.2.2.1.3.1a" xref="S3.E6.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.1.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.1.3.4.cmml">∞</mi></mrow></msub><msubsup id="S3.E6.m1.1.1.2.2.3" xref="S3.E6.m1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.2.2.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.2.2.cmml">𝒟</mi><mrow id="S3.E6.m1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.2.2.3.3.cmml"><msub id="S3.E6.m1.1.1.2.2.3.3.2" xref="S3.E6.m1.1.1.2.2.3.3.2.cmml"><mi id="S3.E6.m1.1.1.2.2.3.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.3.2.2.cmml">⌈</mi><mi id="S3.E6.m1.1.1.2.2.3.3.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.3.2.3.cmml">⟩</mi></msub><mo id="S3.E6.m1.1.1.2.2.3.3.1" xref="S3.E6.m1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.3.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.3.3.cmml">↖</mi><mo id="S3.E6.m1.1.1.2.2.3.3.1a" xref="S3.E6.m1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.2.3.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.3.4.cmml">∞</mi></mrow><mi id="S3.E6.m1.1.1.2.2.3.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.2.3.2.3.cmml">⟩</mi></msubsup></mrow><msub id="S3.E6.m1.1.1.2.1" xref="S3.E6.m1.1.1.2.1.cmml"><mo id="S3.E6.m1.1.1.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.2.1.2.cmml">×</mo><mrow id="S3.E6.m1.1.1.2.1.3" xref="S3.E6.m1.1.1.2.1.3.cmml"><mi id="S3.E6.m1.1.1.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.1.3.2.cmml">∈</mi><mo id="S3.E6.m1.1.1.2.1.3.1" xref="S3.E6.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.1.3.3.cmml">⇔</mi><mo id="S3.E6.m1.1.1.2.1.3.1a" xref="S3.E6.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.1.3.4" mathvariant="normal" xref="S3.E6.m1.1.1.2.1.3.4.cmml">∞</mi></mrow></msub><msubsup id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.2.3.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.3.2.2.cmml">𝒢</mi><msub id="S3.E6.m1.1.1.2.3.3" xref="S3.E6.m1.1.1.2.3.3.cmml"><mi id="S3.E6.m1.1.1.2.3.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.2.3.3.2.cmml">⌈</mi><mi id="S3.E6.m1.1.1.2.3.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.3.3.3.cmml">⟩</mi></msub><mi id="S3.E6.m1.1.1.2.3.2.3" mathvariant="normal" xref="S3.E6.m1.1.1.2.3.2.3.cmml">⟩</mi></msubsup></mrow><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3" mathvariant="normal" xref="S3.E6.m1.1.1.3.cmml">↙</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><times id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></times><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><apply id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.2.1.2.cmml" xref="S3.E6.m1.1.1.2.1.2"></times><apply id="S3.E6.m1.1.1.2.1.3.cmml" xref="S3.E6.m1.1.1.2.1.3"><times id="S3.E6.m1.1.1.2.1.3.1.cmml" xref="S3.E6.m1.1.1.2.1.3.1"></times><ci id="S3.E6.m1.1.1.2.1.3.2.cmml" xref="S3.E6.m1.1.1.2.1.3.2">∈</ci><ci id="S3.E6.m1.1.1.2.1.3.3.cmml" xref="S3.E6.m1.1.1.2.1.3.3">⇔</ci><ci id="S3.E6.m1.1.1.2.1.3.4.cmml" xref="S3.E6.m1.1.1.2.1.3.4">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2"><apply id="S3.E6.m1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.1.1.cmml" xref="S3.E6.m1.1.1.2.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.2.2.1.2.cmml" xref="S3.E6.m1.1.1.2.2.1.2"></times><apply id="S3.E6.m1.1.1.2.2.1.3.cmml" xref="S3.E6.m1.1.1.2.2.1.3"><times id="S3.E6.m1.1.1.2.2.1.3.1.cmml" xref="S3.E6.m1.1.1.2.2.1.3.1"></times><ci id="S3.E6.m1.1.1.2.2.1.3.2.cmml" xref="S3.E6.m1.1.1.2.2.1.3.2">∋</ci><ci id="S3.E6.m1.1.1.2.2.1.3.3.cmml" xref="S3.E6.m1.1.1.2.2.1.3.3">⇔</ci><ci id="S3.E6.m1.1.1.2.2.1.3.4.cmml" xref="S3.E6.m1.1.1.2.2.1.3.4">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2"><apply id="S3.E6.m1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.1.1.cmml" xref="S3.E6.m1.1.1.2.2.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.2.2.2.1.2.cmml" xref="S3.E6.m1.1.1.2.2.2.1.2"></times><apply id="S3.E6.m1.1.1.2.2.2.1.3.cmml" xref="S3.E6.m1.1.1.2.2.2.1.3"><times id="S3.E6.m1.1.1.2.2.2.1.3.1.cmml" xref="S3.E6.m1.1.1.2.2.2.1.3.1"></times><ci id="S3.E6.m1.1.1.2.2.2.1.3.2.cmml" xref="S3.E6.m1.1.1.2.2.2.1.3.2">∋</ci><ci id="S3.E6.m1.1.1.2.2.2.1.3.3.cmml" xref="S3.E6.m1.1.1.2.2.2.1.3.3">⇔</ci><ci id="S3.E6.m1.1.1.2.2.2.1.3.4.cmml" xref="S3.E6.m1.1.1.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2"><apply id="S3.E6.m1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.2.2.2.2.1.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.2"></times><apply id="S3.E6.m1.1.1.2.2.2.2.1.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.3"><times id="S3.E6.m1.1.1.2.2.2.2.1.3.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.3.1"></times><ci id="S3.E6.m1.1.1.2.2.2.2.1.3.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.3.2">∈</ci><ci id="S3.E6.m1.1.1.2.2.2.2.1.3.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.3.3">⇔</ci><ci id="S3.E6.m1.1.1.2.2.2.2.1.3.4.cmml" xref="S3.E6.m1.1.1.2.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2"><apply id="S3.E6.m1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.2"></times><apply id="S3.E6.m1.1.1.2.2.2.2.2.1.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3"><times id="S3.E6.m1.1.1.2.2.2.2.2.1.3.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.1"></times><ci id="S3.E6.m1.1.1.2.2.2.2.2.1.3.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.2">∋</ci><ci id="S3.E6.m1.1.1.2.2.2.2.2.1.3.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.3">⇔</ci><ci id="S3.E6.m1.1.1.2.2.2.2.2.1.3.4.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2"><times id="S3.E6.m1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.1"></times><apply id="S3.E6.m1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2.2">𝒲</ci><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.2.3">⟩</ci></apply><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.3">ℑ</ci><apply id="S3.E6.m1.1.1.2.2.2.2.2.2.4.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.2.4.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4">subscript</csymbol><apply id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4">superscript</csymbol><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.2">𝒢</ci><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.2.3">⟩</ci></apply><ci id="S3.E6.m1.1.1.2.2.2.2.2.2.4.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.2.4.3">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.2.2.2.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3.2.2">𝒟</ci><ci id="S3.E6.m1.1.1.2.2.2.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3.2.3">⟩</ci></apply><ci id="S3.E6.m1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.2.3.3">∞</ci></apply></apply><apply id="S3.E6.m1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3.2.2">𝒢</ci><ci id="S3.E6.m1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3.2.3">⟩</ci></apply><ci id="S3.E6.m1.1.1.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.2.2.2.2.3.3">∈</ci></apply></apply><ci id="S3.E6.m1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.2.3">⋯</ci></apply><apply id="S3.E6.m1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.2.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.2.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.2.2.3.2.2">𝒟</ci><ci id="S3.E6.m1.1.1.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.2.2.3.2.3">⟩</ci></apply><apply id="S3.E6.m1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.1.1.2.2.3.3"><times id="S3.E6.m1.1.1.2.2.3.3.1.cmml" xref="S3.E6.m1.1.1.2.2.3.3.1"></times><apply id="S3.E6.m1.1.1.2.2.3.3.2.cmml" xref="S3.E6.m1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.3.3.2.1.cmml" xref="S3.E6.m1.1.1.2.2.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.3.3.2.2.cmml" xref="S3.E6.m1.1.1.2.2.3.3.2.2">⌈</ci><ci id="S3.E6.m1.1.1.2.2.3.3.2.3.cmml" xref="S3.E6.m1.1.1.2.2.3.3.2.3">⟩</ci></apply><ci id="S3.E6.m1.1.1.2.2.3.3.3.cmml" xref="S3.E6.m1.1.1.2.2.3.3.3">↖</ci><ci id="S3.E6.m1.1.1.2.2.3.3.4.cmml" xref="S3.E6.m1.1.1.2.2.3.3.4">∞</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.3.2.1.cmml" xref="S3.E6.m1.1.1.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.2.3.2.2.cmml" xref="S3.E6.m1.1.1.2.3.2.2">𝒢</ci><ci id="S3.E6.m1.1.1.2.3.2.3.cmml" xref="S3.E6.m1.1.1.2.3.2.3">⟩</ci></apply><apply id="S3.E6.m1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.3.3.1.cmml" xref="S3.E6.m1.1.1.2.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.2.3.3.2.cmml" xref="S3.E6.m1.1.1.2.3.3.2">⌈</ci><ci id="S3.E6.m1.1.1.2.3.3.3.cmml" xref="S3.E6.m1.1.1.2.3.3.3">⟩</ci></apply></apply></apply><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">↙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathbfcal{W}_{i}=\mathbfcal{G}^{i}_{1}\times_{3,1}\mathbf{D}^{i}_{1}\times_{2%
,1}\mathbfcal{G}^{i}_{2}\times_{3,1}\cdots\times_{3,1}\mathbf{D}^{i}_{d_{i}-1}%
\times_{2,1}\mathbfcal{G}^{i}_{d_{i}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">roman_𝒲 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT roman_ℑ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒟 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∈ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT ⋯ × start_POSTSUBSCRIPT ∋ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒟 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ↖ ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT ∈ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.14">Now the tensor cores for <math alttext="\mathbfcal{W}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.11.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.11.m1.1a"><msub id="S3.SS1.SSS0.Px1.p1.11.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1.2.cmml">𝒲</mi><mi id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.11.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1.2">𝒲</ci><ci id="S3.SS1.SSS0.Px1.p1.11.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m1.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.11.m1.1c">\mathbfcal{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.11.m1.1d">roman_𝒲 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> have
<math alttext="S_{i}=n_{1}^{i}\|\mathbf{D}_{1}^{i}\|_{0}+n_{d_{i}}^{i}\|\mathbf{D}_{d_{i}-1}^%
{i}\|_{0}+\sum_{j=2}^{d_{i}-1}n^{i}_{j}\|\mathbf{D}_{j-1}^{i}\|_{0}\|\mathbf{D%
}_{j}^{i}\|_{0}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.12.m2.4"><semantics id="S3.SS1.SSS0.Px1.p1.12.m2.4a"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.cmml"><msub id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.2.cmml">S</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.5" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.5.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.2.cmml">n</mi><mn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.3.cmml">1</mn><mi id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.2.cmml">⁢</mo><msub id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐃</mi><mn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.3.cmml">0</mn></msub></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5.cmml">+</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.2.cmml">n</mi><msub id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.3.cmml">i</mi></msub><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.2.cmml">⁢</mo><msub id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.2.1.cmml">‖</mo><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.2.cmml">𝐃</mi><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.3.cmml">0</mn></msub></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5a" rspace="0.055em" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5.cmml">+</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.2.cmml">j</mi><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.3.cmml">2</mn></mrow><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.2.cmml">n</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3.cmml">⁢</mo><msub id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.2.cmml">𝐃</mi><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3a" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3.cmml">⁢</mo><msub id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.2.1.cmml">‖</mo><msubsup id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.2.cmml">𝐃</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.3.cmml">0</mn></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.12.m2.4b"><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4"><eq id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.5.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.5"></eq><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.2">𝑆</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.6.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4"><plus id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.5"></plus><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1"><times id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.2">𝑛</ci><cn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.2">𝐃</ci><cn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.1.1.1.1.1.3">0</cn></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2"><times id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.2"></times><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.2">𝑛</ci><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.3.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.2">norm</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.2">𝐃</ci><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3"><minus id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.1"></minus><apply id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.2.3">𝑖</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.2.2.2.2.1.3">0</cn></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4"><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3">subscript</csymbol><sum id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.2"></sum><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3"><eq id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.1"></eq><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.2">𝑗</ci><cn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.2.3.3">2</cn></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3"><minus id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.1"></minus><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.2.3">𝑖</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.3.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2"><times id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.3"></times><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.2">𝑛</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.4.3">𝑗</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.2">𝐃</ci><apply id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3"><minus id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.1"></minus><ci id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.3.3.3.3.1.1.3">0</cn></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.2">norm</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.2">𝐃</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m2.4.4.4.4.2.2.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.12.m2.4c">S_{i}=n_{1}^{i}\|\mathbf{D}_{1}^{i}\|_{0}+n_{d_{i}}^{i}\|\mathbf{D}_{d_{i}-1}^%
{i}\|_{0}+\sum_{j=2}^{d_{i}-1}n^{i}_{j}\|\mathbf{D}_{j-1}^{i}\|_{0}\|\mathbf{D%
}_{j}^{i}\|_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.12.m2.4d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ bold_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_j - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> variables.
For simplicity, we denote <math alttext="\mathbfcal{G}:=\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1%
}^{P}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.13.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.13.m3.1a"><mrow id="S3.SS1.SSS0.Px1.p1.13.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.3.cmml">𝒢</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.4" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.4.cmml">¬</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2a" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.5" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.5.cmml">ℑ</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2b" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2.cmml">⁢</mo><msubsup id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.3.cmml">∞</mi><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.3.cmml">⟩</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.3.cmml">⇔</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1a" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.4" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.4.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1b" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.5" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.5.cmml">⇔</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1c" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.2.cmml">𝒢</mi><msub id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.2.cmml">⌈</mi><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.3.cmml">⟩</mi></msub><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.3.cmml">⟩</mi></msubsup></mrow><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.2.cmml">⟩</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.3.cmml">ℑ</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1a" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.4" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.4.cmml">∞</mi></mrow><mi id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.3.cmml">𝒫</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.13.m3.1b"><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1"><times id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.2"></times><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.3">𝒢</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.4">¬</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.5">ℑ</ci><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1">subscript</csymbol><set id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1"><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1"><times id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.1"></times><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.2">𝒢</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.2.3">⟩</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.2.3">∞</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.3">⇔</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.4">…</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.5">⇔</ci><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.2">𝒢</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.2.3">⟩</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.2">⌈</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.1.1.1.6.3.3">⟩</ci></apply></apply></apply></set><apply id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3"><times id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.2">⟩</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.3">ℑ</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.4.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.1.3.4">∞</ci></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m3.1.1.1.3">𝒫</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.13.m3.1c">\mathbfcal{G}:=\{\mathbfcal{G}^{i}_{1},\ldots,\mathbfcal{G}^{i}_{d_{i}}\}_{i=1%
}^{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.13.m3.1d">roman_𝒢 ¬ roman_ℑ { roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_𝒫 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{D}:=\{\mathbf{D}_{1}^{i},\ldots,\mathbf{D}_{d_{i}-1}^{i}\}_{i=1}^{P}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.14.m4.3"><semantics id="S3.SS1.SSS0.Px1.p1.14.m4.3a"><mrow id="S3.SS1.SSS0.Px1.p1.14.m4.3.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.4" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.4.cmml">𝐃</mi><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.3" lspace="0.278em" rspace="0.278em" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.3.cmml">:=</mo><msubsup id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml">{</mo><msubsup id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.2.cmml">𝐃</mi><mn id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p1.14.m4.1.1" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.14.m4.1.1.cmml">…</mi><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.5" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.2.cmml">𝐃</mi><mrow id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.1" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.6" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.2" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.1" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.1.cmml">=</mo><mn id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.3" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.4" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.4.cmml">P</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.14.m4.3b"><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.3">assign</csymbol><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.4.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.4">𝐃</ci><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2">subscript</csymbol><set id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2"><apply id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.2">𝐃</ci><cn id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.2.2.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.14.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.1.1">…</ci><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.2">𝐃</ci><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3"><minus id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.1"></minus><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.2.3">𝑖</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4"><eq id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.1"></eq><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.2">𝑖</ci><cn id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.2.4.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m4.3.3.2.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.14.m4.3c">\mathbf{D}:=\{\mathbf{D}_{1}^{i},\ldots,\mathbf{D}_{d_{i}-1}^{i}\}_{i=1}^{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.14.m4.3d">bold_D := { bold_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , … , bold_D start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Multi-Objective Optimization.</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.7">We intend to minimize both the loss and compressed network size, which can be formulated as a multi-objective optimization
<math alttext="\min_{\mathbfcal{G},\mathbf{D}}\left\{L(\mathbfcal{G},\mathbf{D}),S(\mathbf{D}%
)\right\}," class="ltx_math_unparsed" display="inline" id="S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><mrow id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">min</mi><mrow id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" mathvariant="normal">𝒢</mi><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.1">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.3" mathvariant="normal">⇔</mi><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.1a">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.4" mathvariant="normal">𝒟</mi></mrow></msub><mrow id="S3.SS1.SSS0.Px2.p1.1.m1.1.2"><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.1">{</mo><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.2">L</mi><mrow id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3"><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.1" stretchy="false">(</mo><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.2" mathvariant="normal">𝒢</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.3" mathvariant="normal">⇔</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.4" mathvariant="normal">𝒟</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.5" mathvariant="normal">⇒</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.6" mathvariant="normal">⇔</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.7" mathvariant="normal">𝒮</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.8" mathvariant="normal">⇐</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.9" mathvariant="normal">𝒟</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.10" mathvariant="normal">⇒</mi><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.3.11">}</mo></mrow><mo id="S3.SS1.SSS0.Px2.p1.1.m1.1.2.4">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\left\{L(\mathbfcal{G},\mathbf{D}),S(\mathbf{D}%
)\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.1.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT { italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇔ roman_𝒮 ⇐ roman_𝒟 ⇒ } ,</annotation></semantics></math>
where <math alttext="S(\mathbf{D}):=\sum_{i=1}^{P}S_{i}(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.2.m2.2"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.2a"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.cmml"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.2.cmml">S</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.cmml"><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.cmml">(</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">𝐃</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.3.2.2" rspace="0.278em" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.1" rspace="0.111em" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.1.cmml">:=</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.cmml"><msubsup id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.cmml"><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.3.cmml">P</mi></msubsup><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.cmml"><msub id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.2.cmml">S</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.cmml"><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.cmml">(</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.2.cmml">𝐃</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.2b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3"><csymbol cd="latexml" id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.1">assign</csymbol><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2"><times id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.1"></times><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.2.2">𝑆</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">𝐃</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1">subscript</csymbol><sum id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.2"></sum><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3"><eq id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.1"></eq><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.2">𝑖</ci><cn id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.1.3">𝑃</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2"><times id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.1"></times><apply id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.2">𝑆</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.2">𝐃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.2c">S(\mathbf{D}):=\sum_{i=1}^{P}S_{i}(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.2.m2.2d">italic_S ( bold_D ) := ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_D )</annotation></semantics></math>.
In most cases, we cannot find a point that minimizes the loss and model size simultaneously. Therefore, we look for a Pareto point <math alttext="(\mathbfcal{G}^{*},\mathbf{D}^{*})" class="ltx_math_unparsed" display="inline" id="S3.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mrow id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><mo id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" stretchy="false">(</mo><msup id="S3.SS1.SSS0.Px2.p1.3.m3.1.2"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.2.2" mathvariant="normal">𝒢</mi><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.2.3" mathvariant="normal">⇑</mi></msup><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.3" mathvariant="normal">⇔</mi><msup id="S3.SS1.SSS0.Px2.p1.3.m3.1.4"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.4.2" mathvariant="normal">𝒟</mi><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.4.3" mathvariant="normal">⇑</mi></msup><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.5" mathvariant="normal">⇒</mi></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">(\mathbfcal{G}^{*},\mathbf{D}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.3.m3.1d">( roman_𝒢 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇔ roman_𝒟 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇒</annotation></semantics></math>, meaning that there exist no <math alttext="\mathbfcal{G}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">\mathbfcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.4.m4.1d">roman_𝒢</annotation></semantics></math> and <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.5.m5.1d">bold_D</annotation></semantics></math> such that <math alttext="L(\mathbfcal{G},\mathbf{D})\leq L(\mathbfcal{G}^{*},\mathbf{D}^{*})" class="ltx_math_unparsed" display="inline" id="S3.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1">L</mi><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.2"><mo id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.1" stretchy="false">(</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.2" mathvariant="normal">𝒢</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.3" mathvariant="normal">⇔</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.4" mathvariant="normal">𝒟</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.5" mathvariant="normal">⇒</mi><mo id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.6">≤</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.7" mathvariant="normal">ℒ</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.8" mathvariant="normal">⇐</mi><msup id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.9"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.9.2" mathvariant="normal">𝒢</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.9.3" mathvariant="normal">⇑</mi></msup><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.10" mathvariant="normal">⇔</mi><msup id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.11"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.11.2" mathvariant="normal">𝒟</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.11.3" mathvariant="normal">⇑</mi></msup><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.2.12" mathvariant="normal">⇒</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">L(\mathbfcal{G},\mathbf{D})\leq L(\mathbfcal{G}^{*},\mathbf{D}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.6.m6.1d">italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ≤ roman_ℒ ⇐ roman_𝒢 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇔ roman_𝒟 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇒</annotation></semantics></math>, <math alttext="S(\mathbf{D})\leq S(\mathbf{D}^{*})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.7.m7.2"><semantics id="S3.SS1.SSS0.Px2.p1.7.m7.2a"><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.2.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.cmml"><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.2.cmml">S</mi><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.3.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.cmml">(</mo><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">𝐃</mi><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.2.cmml">≤</mo><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.3.cmml">S</mi><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.cmml">(</mo><msup id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.2.cmml">𝐃</mi><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.7.m7.2b"><apply id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2"><leq id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.2"></leq><apply id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3"><times id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.3.2">𝑆</ci><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1">𝐃</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1"><times id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.2"></times><ci id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.3">𝑆</ci><apply id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.2">𝐃</ci><times id="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.2.2.1.1.1.1.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.7.m7.2c">S(\mathbf{D})\leq S(\mathbf{D}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.7.m7.2d">italic_S ( bold_D ) ≤ italic_S ( bold_D start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math>, and at least one of inequalities is strict.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Training Methods</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We convert a mutli-objective optimization to a single-objective one via scalarization. We use different scalarization methods at the early and late stage of training. The late stage is optional, and it can further compress the model to enable efficient deployment on resource-constraint platforms.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Early Stage.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.11">At the early stage of CoMERA, aggressively pruning ranks dramatically hurts the convergence. Hence, we start the training with the following linear scalarization formulation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib8" title="">8</a>]</cite></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,L(\mathbfcal{G},\mathbf{D})+\gamma{S}(%
\mathbf{D})." class="ltx_math_unparsed" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1b"><munder id="S3.E7.m1.1.1"><mi id="S3.E7.m1.1.1.2">min</mi><mrow id="S3.E7.m1.1.1.3"><mi id="S3.E7.m1.1.1.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E7.m1.1.1.3.1">⁢</mo><mi id="S3.E7.m1.1.1.3.3" mathvariant="normal">⇔</mi><mo id="S3.E7.m1.1.1.3.1a">⁢</mo><mi id="S3.E7.m1.1.1.3.4" mathvariant="normal">𝒟</mi></mrow></munder><mi id="S3.E7.m1.1.2">L</mi><mrow id="S3.E7.m1.1.3"><mo id="S3.E7.m1.1.3.1" stretchy="false">(</mo><mi id="S3.E7.m1.1.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E7.m1.1.3.3" mathvariant="normal">⇔</mi><mi id="S3.E7.m1.1.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E7.m1.1.3.5" mathvariant="normal">⇒</mi><mi id="S3.E7.m1.1.3.6" mathvariant="normal">⇓</mi><mi id="S3.E7.m1.1.3.7">γ</mi><mi id="S3.E7.m1.1.3.8" mathvariant="normal">𝒮</mi><mi id="S3.E7.m1.1.3.9" mathvariant="normal">⇐</mi><mi id="S3.E7.m1.1.3.10" mathvariant="normal">𝒟</mi><mi id="S3.E7.m1.1.3.11" mathvariant="normal">⇒</mi><mi id="S3.E7.m1.1.3.12" mathvariant="normal">↙</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\,\,L(\mathbfcal{G},\mathbf{D})+\gamma{S}(%
\mathbf{D}).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ italic_γ roman_𝒮 ⇐ roman_𝒟 ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.5">It is still hard to solve (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E7" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">7</span></a>) since <math alttext="S(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2"><times id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.1"></times><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">S(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_S ( bold_D )</annotation></semantics></math> uses <math alttext="\|\cdot\|_{0}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><mo id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" rspace="0em">∥</mo><mo id="S3.SS2.SSS0.Px1.p1.2.m2.1.2" lspace="0em" rspace="0em">⋅</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.3"><mo id="S3.SS2.SSS0.Px1.p1.2.m2.1.3.2" lspace="0em">∥</mo><mn id="S3.SS2.SSS0.Px1.p1.2.m2.1.3.3">0</mn></msub></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">\|\cdot\|_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">∥ ⋅ ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> which is nonsmooth. Therefore, we replace <math alttext="\|\cdot\|_{0}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" rspace="0em">∥</mo><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.2" lspace="0em" rspace="0em">⋅</mo><msub id="S3.SS2.SSS0.Px1.p1.3.m3.1.3"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.1.3.2" lspace="0em">∥</mo><mn id="S3.SS2.SSS0.Px1.p1.3.m3.1.3.3">0</mn></msub></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">\|\cdot\|_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">∥ ⋅ ∥ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> by the <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><msub id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2">ℓ</ci><cn id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> norm <math alttext="\|\cdot\|_{1}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.1b"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" rspace="0em">∥</mo><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.2" lspace="0em" rspace="0em">⋅</mo><msub id="S3.SS2.SSS0.Px1.p1.5.m5.1.3"><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.3.2" lspace="0em">∥</mo><mn id="S3.SS2.SSS0.Px1.p1.5.m5.1.3.3">1</mn></msub></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.1c">\|\cdot\|_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.1d">∥ ⋅ ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and get the convex relaxation</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{S}(\mathbf{D}):=\sum_{i=1}^{P}\left(\sum_{i=1}^{P}n_{1}^{i}\|\mathbf{D}_{%
1}^{i}\|_{1}+n_{d_{i}}^{i}\|\mathbf{D}_{d_{i}-1}^{i}\|_{1}+\sum_{j=2}^{d_{i}-1%
}n^{i}_{j}\|\mathbf{D}_{j-1}^{i}\|_{1}\|\mathbf{D}_{j}^{i}\|_{1}\right)." class="ltx_Math" display="block" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2.2" xref="S3.E8.m1.2.2.1.1.3.2.2.cmml">S</mi><mo id="S3.E8.m1.2.2.1.1.3.2.1" xref="S3.E8.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.E8.m1.2.2.1.1.3.1" xref="S3.E8.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.3.3.2" xref="S3.E8.m1.2.2.1.1.3.cmml"><mo id="S3.E8.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝐃</mi><mo id="S3.E8.m1.2.2.1.1.3.3.2.2" rspace="0.278em" stretchy="false" xref="S3.E8.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.2" rspace="0.111em" xref="S3.E8.m1.2.2.1.1.2.cmml">:=</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><munderover id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.2.2.3.2" xref="S3.E8.m1.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.1.2.2.3.1" xref="S3.E8.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.1.2.2.3.3" xref="S3.E8.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.2.3.cmml">P</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml"><munderover id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.2" lspace="0em" movablelimits="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">P</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">n</mi><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐃</mi><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.5" xref="S3.E8.m1.2.2.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.2.cmml">n</mi><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.2.cmml">d</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.3.cmml">i</mi></msub><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">𝐃</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.2.cmml">d</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.3.cmml">1</mn></msub></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.5a" rspace="0.055em" xref="S3.E8.m1.2.2.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.4" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.cmml"><munderover id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.2" movablelimits="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.3.cmml">2</mn></mrow><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.2.cmml">d</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.1.cmml">−</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.cmml"><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.2.cmml">n</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.3.cmml">j</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.2.cmml">𝐃</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.3.cmml">1</mn></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3a" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.2.1.cmml">‖</mo><msubsup id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.2.cmml">𝐃</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.3.cmml">j</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.3.cmml">1</mn></msub></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.2" lspace="0em" xref="S3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2">assign</csymbol><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><times id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1"></times><apply id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><ci id="S3.E8.m1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2.1">^</ci><ci id="S3.E8.m1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2">𝑆</ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝐃</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><apply id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.2.2.3"><eq id="S3.E8.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E8.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.2.3">𝑃</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.5"></plus><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.3">𝑃</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">𝑛</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐃</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.2"></times><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.2">𝑛</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.2">𝑑</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.2">𝐃</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3"><minus id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.1"></minus><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.2">𝑑</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.2.3">𝑖</ci></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.3">1</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4"><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3"><eq id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.2">𝑗</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.2.3.3">2</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3"><minus id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.1"></minus><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.2">𝑑</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.2.3">𝑖</ci></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.3.3.3">1</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.3"></times><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.2">𝑛</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.2.3">𝑖</ci></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.4.3">𝑗</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.2">𝐃</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3"><minus id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.1"></minus><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.1.3">1</cn></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.2">norm</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.2">𝐃</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.4.2.2.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\hat{S}(\mathbf{D}):=\sum_{i=1}^{P}\left(\sum_{i=1}^{P}n_{1}^{i}\|\mathbf{D}_{%
1}^{i}\|_{1}+n_{d_{i}}^{i}\|\mathbf{D}_{d_{i}-1}^{i}\|_{1}+\sum_{j=2}^{d_{i}-1%
}n^{i}_{j}\|\mathbf{D}_{j-1}^{i}\|_{1}\|\mathbf{D}_{j}^{i}\|_{1}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">over^ start_ARG italic_S end_ARG ( bold_D ) := ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ bold_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_j - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ bold_D start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.10">We note that <math alttext="\hat{S}(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.6.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.1.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.1.cmml">^</mo></mover><mo id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.6.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2"><times id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2"><ci id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.2.2.2">𝑆</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m1.1c">\hat{S}(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m1.1d">over^ start_ARG italic_S end_ARG ( bold_D )</annotation></semantics></math> can be arbitrarily close to <math alttext="0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m2.1a"><mn id="S3.SS2.SSS0.Px1.p1.7.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m2.1b"><cn id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1">0</cn></annotation-xml></semantics></math> while keeping <math alttext="L(\mathbfcal{G},\mathbf{D})" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p1.8.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.8.m3.1a"><mrow id="S3.SS2.SSS0.Px1.p1.8.m3.1b"><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.1">L</mi><mrow id="S3.SS2.SSS0.Px1.p1.8.m3.1.2"><mo id="S3.SS2.SSS0.Px1.p1.8.m3.1.2.1" stretchy="false">(</mo><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.2.2" mathvariant="normal">𝒢</mi><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.2.3" mathvariant="normal">⇔</mi><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.2.4" mathvariant="normal">𝒟</mi><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.2.5" mathvariant="normal">⇒</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m3.1c">L(\mathbfcal{G},\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.8.m3.1d">italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒</annotation></semantics></math> unchangeable, since the corresponding slices of TT factors can be scaled accordingly. Therefore, a direct relaxation of the scalarization (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E11" title="In Late Stage (Optional). ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">11</span></a>) does not have a minimizer. To address this issue, we add an <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.9.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.9.m4.1a"><msub id="S3.SS2.SSS0.Px1.p1.9.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.2" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.9.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.2">ℓ</ci><cn id="S3.SS2.SSS0.Px1.p1.9.m4.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.9.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.9.m4.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.9.m4.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> regularization <math alttext="\|\mathbfcal{G}\|^{2}:=\sum_{i=1}^{P}\sum_{j=1}^{d_{i}}\|\mathbfcal{G}^{i}_{j}%
\|^{2}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p1.10.m5.2"><semantics id="S3.SS2.SSS0.Px1.p1.10.m5.2a"><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2"><msup id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.3"><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.3.2.2"><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.3.2.2.1" stretchy="false">‖</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.1.1" mathvariant="normal">𝒢</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.3.2.2.2" stretchy="false">‖</mo></mrow><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.3.3" mathvariant="normal">∈</mi></msup><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.2">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.4" mathvariant="normal">¬</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.2a">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.5" mathvariant="normal">ℑ</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.2b">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1"><msubsup id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2"><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.2" rspace="0em">∑</mo><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3"><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3.2" mathvariant="normal">⟩</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3.1">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3.3" mathvariant="normal">ℑ</mi><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3.1a">⁢</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.2.3.4" mathvariant="normal">∞</mi></mrow><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.2.3" mathvariant="normal">𝒫</mi></msubsup><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1"><msubsup id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2"><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.2.2" rspace="0em">∑</mo><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.2.3"><mo fence="false" id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.2.3.1" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.2.3.2" mathvariant="normal">ℑ</mi><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.2.3.3" mathvariant="normal">∞</mi></mrow><msub id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.3"><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.3.2" mathvariant="normal">⌈</mi><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.2.3.3" mathvariant="normal">⟩</mi></msub></msubsup><msup id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1"><mrow id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1"><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.2" stretchy="false">‖</mo><msubsup id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.1"><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.1.2.2" mathvariant="normal">𝒢</mi><mo fence="false" id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.1.3" stretchy="false">|</mo><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.1.2.3" mathvariant="normal">⟩</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.1.1.3" stretchy="false">‖</mo></mrow><mi id="S3.SS2.SSS0.Px1.p1.10.m5.2.2.1.1.1.3" mathvariant="normal">∈</mi></msup></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.10.m5.2b">\|\mathbfcal{G}\|^{2}:=\sum_{i=1}^{P}\sum_{j=1}^{d_{i}}\|\mathbfcal{G}^{i}_{j}%
\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.10.m5.2c">∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ¬ roman_ℑ ∑ start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_𝒫 end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT | roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⌈ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∥ roman_𝒢 start_POSTSUPERSCRIPT ⟩ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math> to the relaxation and get the formulation</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,L(\mathbfcal{G},\mathbf{D})+\gamma\hat{S}(%
\mathbf{D})+\beta\|\mathbfcal{G}\|^{2}." class="ltx_math_unparsed" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1b"><munder id="S3.E9.m1.1.2"><mi id="S3.E9.m1.1.2.2">min</mi><mrow id="S3.E9.m1.1.2.3"><mi id="S3.E9.m1.1.2.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E9.m1.1.2.3.1">⁢</mo><mi id="S3.E9.m1.1.2.3.3" mathvariant="normal">⇔</mi><mo id="S3.E9.m1.1.2.3.1a">⁢</mo><mi id="S3.E9.m1.1.2.3.4" mathvariant="normal">𝒟</mi></mrow></munder><mi id="S3.E9.m1.1.3">L</mi><mrow id="S3.E9.m1.1.4"><mo id="S3.E9.m1.1.4.1" stretchy="false">(</mo><mi id="S3.E9.m1.1.4.2" mathvariant="normal">𝒢</mi><mi id="S3.E9.m1.1.4.3" mathvariant="normal">⇔</mi><mi id="S3.E9.m1.1.4.4" mathvariant="normal">𝒟</mi><mi id="S3.E9.m1.1.4.5" mathvariant="normal">⇒</mi><mi id="S3.E9.m1.1.4.6" mathvariant="normal">⇓</mi><mi id="S3.E9.m1.1.4.7">γ</mi><mover accent="true" id="S3.E9.m1.1.4.8"><mi id="S3.E9.m1.1.4.8.2" mathvariant="normal">𝒮</mi><mo id="S3.E9.m1.1.4.8.1">^</mo></mover><mi id="S3.E9.m1.1.4.9" mathvariant="normal">⇐</mi><mi id="S3.E9.m1.1.4.10" mathvariant="normal">𝒟</mi><mi id="S3.E9.m1.1.4.11" mathvariant="normal">⇒</mi><mi id="S3.E9.m1.1.4.12" mathvariant="normal">⇓</mi><mi id="S3.E9.m1.1.4.13">β</mi><mo id="S3.E9.m1.1.4.14" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E9.m1.1.1" mathvariant="normal">𝒢</mi><msup id="S3.E9.m1.1.4.15"><mo id="S3.E9.m1.1.4.15.2" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E9.m1.1.4.15.3" mathvariant="normal">∈</mi></msup><mi id="S3.E9.m1.1.4.16" mathvariant="normal">↙</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\,\,L(\mathbfcal{G},\mathbf{D})+\gamma\hat{S}(%
\mathbf{D})+\beta\|\mathbfcal{G}\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ italic_γ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇓ italic_β ∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.12">The optimizer of Problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) is a Pareto point for a constrained problem, shown in the following.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.1.1.1">Proposition 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.2"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.2.2">For all <math alttext="\gamma&gt;0,\beta&gt;0" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.1.m1.2"><semantics id="S3.Thmtheorem1.p1.1.1.m1.2a"><mrow id="S3.Thmtheorem1.p1.1.1.m1.2.2.2" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.3.cmml"><mrow id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.2.cmml">γ</mi><mo id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml">&gt;</mo><mn id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.3" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.3a.cmml">,</mo><mrow id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.2" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.2.cmml">β</mi><mo id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.1" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.1.cmml">&gt;</mo><mn id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.3" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.2b"><apply id="S3.Thmtheorem1.p1.1.1.m1.2.2.3.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.1.m1.2.2.3a.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1"><gt id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.1"></gt><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.2">𝛾</ci><cn id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.1.1.3">0</cn></apply><apply id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2"><gt id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.1"></gt><ci id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.2">𝛽</ci><cn id="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.3.cmml" type="integer" xref="S3.Thmtheorem1.p1.1.1.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.2c">\gamma&gt;0,\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.1.m1.2d">italic_γ &gt; 0 , italic_β &gt; 0</annotation></semantics></math>, there exists some constant <math alttext="C&gt;0" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mrow id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">C</mi><mo id="S3.Thmtheorem1.p1.2.2.m2.1.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.1.cmml">&gt;</mo><mn id="S3.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><apply id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1"><gt id="S3.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.1"></gt><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2">𝐶</ci><cn id="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" type="integer" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">C&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.2.m2.1d">italic_C &gt; 0</annotation></semantics></math> such that the solution to the problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) is a Pareto point of the following multi-objective optimization problem</span></p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\mathbfcal{G},\mathbf{D}}" class="ltx_Math" display="inline" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><munder id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mi id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">min</mi><mrow id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.3.2" mathvariant="normal" xref="S3.E10.m1.1.1.3.2.cmml">𝒢</mi><mo id="S3.E10.m1.1.1.3.1" xref="S3.E10.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.1.1.3.3" mathvariant="normal" xref="S3.E10.m1.1.1.3.3.cmml">⇔</mi><mo id="S3.E10.m1.1.1.3.1a" xref="S3.E10.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.1.1.3.4" mathvariant="normal" xref="S3.E10.m1.1.1.3.4.cmml">𝒟</mi></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1">subscript</csymbol><min id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></min><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><times id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1"></times><ci id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2">𝒢</ci><ci id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">⇔</ci><ci id="S3.E10.m1.1.1.3.4.cmml" xref="S3.E10.m1.1.1.3.4">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle\min_{\mathbfcal{G},\mathbf{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle(L(\mathbfcal{G},\mathbf{D}),\hat{S}(\mathbf{D}))" class="ltx_math_unparsed" display="inline" id="S3.E10.m2.1"><semantics id="S3.E10.m2.1a"><mrow id="S3.E10.m2.1b"><mo id="S3.E10.m2.1.1" stretchy="false">(</mo><mi id="S3.E10.m2.1.2">L</mi><mrow id="S3.E10.m2.1.3"><mo id="S3.E10.m2.1.3.1" stretchy="false">(</mo><mi id="S3.E10.m2.1.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E10.m2.1.3.3" mathvariant="normal">⇔</mi><mi id="S3.E10.m2.1.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E10.m2.1.3.5" mathvariant="normal">⇒</mi><mi id="S3.E10.m2.1.3.6" mathvariant="normal">⇔</mi><mover accent="true" id="S3.E10.m2.1.3.7"><mi id="S3.E10.m2.1.3.7.2" mathvariant="normal">𝒮</mi><mo id="S3.E10.m2.1.3.7.1">^</mo></mover><mi id="S3.E10.m2.1.3.8" mathvariant="normal">⇐</mi><mi id="S3.E10.m2.1.3.9" mathvariant="normal">𝒟</mi><mi id="S3.E10.m2.1.3.10" mathvariant="normal">⇒</mi><mi id="S3.E10.m2.1.3.11" mathvariant="normal">⇒</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.E10.m2.1c">\displaystyle(L(\mathbfcal{G},\mathbf{D}),\hat{S}(\mathbf{D}))</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m2.1d">( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇔ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇒</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{subject to}\,\|\mathbfcal{G}\|^{2}\leq C." class="ltx_Math" display="inline" id="S3.E10.m3.1"><semantics id="S3.E10.m3.1a"><mrow id="S3.E10.m3.1.2" xref="S3.E10.m3.1.2.cmml"><mrow id="S3.E10.m3.1.2.2" xref="S3.E10.m3.1.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E10.m3.1.2.2.2" xref="S3.E10.m3.1.2.2.2a.cmml">subject to</mtext><mo id="S3.E10.m3.1.2.2.1" lspace="0.170em" xref="S3.E10.m3.1.2.2.1.cmml">⁢</mo><msup id="S3.E10.m3.1.2.2.3" xref="S3.E10.m3.1.2.2.3.cmml"><mrow id="S3.E10.m3.1.2.2.3.2.2" xref="S3.E10.m3.1.2.2.3.2.1.cmml"><mo id="S3.E10.m3.1.2.2.3.2.2.1" stretchy="false" xref="S3.E10.m3.1.2.2.3.2.1.1.cmml">‖</mo><mi id="S3.E10.m3.1.1" mathvariant="normal" xref="S3.E10.m3.1.1.cmml">𝒢</mi><mo id="S3.E10.m3.1.2.2.3.2.2.2" stretchy="false" xref="S3.E10.m3.1.2.2.3.2.1.1.cmml">‖</mo></mrow><mi id="S3.E10.m3.1.2.2.3.3" mathvariant="normal" xref="S3.E10.m3.1.2.2.3.3.cmml">∈</mi></msup></mrow><mo id="S3.E10.m3.1.2.1" xref="S3.E10.m3.1.2.1.cmml">≤</mo><mrow id="S3.E10.m3.1.2.3" xref="S3.E10.m3.1.2.3.cmml"><mi id="S3.E10.m3.1.2.3.2" mathvariant="normal" xref="S3.E10.m3.1.2.3.2.cmml">𝒞</mi><mo id="S3.E10.m3.1.2.3.1" xref="S3.E10.m3.1.2.3.1.cmml">⁢</mo><mi id="S3.E10.m3.1.2.3.3" mathvariant="normal" xref="S3.E10.m3.1.2.3.3.cmml">↙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m3.1b"><apply id="S3.E10.m3.1.2.cmml" xref="S3.E10.m3.1.2"><leq id="S3.E10.m3.1.2.1.cmml" xref="S3.E10.m3.1.2.1"></leq><apply id="S3.E10.m3.1.2.2.cmml" xref="S3.E10.m3.1.2.2"><times id="S3.E10.m3.1.2.2.1.cmml" xref="S3.E10.m3.1.2.2.1"></times><ci id="S3.E10.m3.1.2.2.2a.cmml" xref="S3.E10.m3.1.2.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E10.m3.1.2.2.2.cmml" xref="S3.E10.m3.1.2.2.2">subject to</mtext></ci><apply id="S3.E10.m3.1.2.2.3.cmml" xref="S3.E10.m3.1.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m3.1.2.2.3.1.cmml" xref="S3.E10.m3.1.2.2.3">superscript</csymbol><apply id="S3.E10.m3.1.2.2.3.2.1.cmml" xref="S3.E10.m3.1.2.2.3.2.2"><csymbol cd="latexml" id="S3.E10.m3.1.2.2.3.2.1.1.cmml" xref="S3.E10.m3.1.2.2.3.2.2.1">norm</csymbol><ci id="S3.E10.m3.1.1.cmml" xref="S3.E10.m3.1.1">𝒢</ci></apply><ci id="S3.E10.m3.1.2.2.3.3.cmml" xref="S3.E10.m3.1.2.2.3.3">∈</ci></apply></apply><apply id="S3.E10.m3.1.2.3.cmml" xref="S3.E10.m3.1.2.3"><times id="S3.E10.m3.1.2.3.1.cmml" xref="S3.E10.m3.1.2.3.1"></times><ci id="S3.E10.m3.1.2.3.2.cmml" xref="S3.E10.m3.1.2.3.2">𝒞</ci><ci id="S3.E10.m3.1.2.3.3.cmml" xref="S3.E10.m3.1.2.3.3">↙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m3.1c">\displaystyle\text{subject to}\,\|\mathbfcal{G}\|^{2}\leq C.</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m3.1d">subject to ∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ≤ roman_𝒞 ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S3.SS2.SSS0.Px1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.1.p1.1">See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS1" title="A.1 Proof of Proposition 3.1 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.1</span></a> for the complete proof.
∎</p>
</div>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Late Stage (Optional).</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.3">In the late stage of CoMERA, we may continue training the model towards a preferred loss <math alttext="L_{0}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mn id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><cn id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">L_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and a preferred model size <math alttext="S_{0}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">S</mi><mn id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑆</ci><cn id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">S_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for deployment requirements. This can be achieved by using an achievement scalarization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib8" title="">8</a>]</cite> that leads to a Pareto point close to <math alttext="(L_{0},S_{0})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.2"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.2a"><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml">L</mi><mn id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.4" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml">S</mi><mn id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.2b"><interval closure="open" id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.2">𝐿</ci><cn id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.2">𝑆</ci><cn id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.2.2.3">0</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.2c">(L_{0},S_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.2d">( italic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,\max\left\{w_{1}(L(\mathbfcal{G},\mathbf{D}%
)-L_{0}),w_{2}(S(\mathbf{D})-S_{0})\right\}+\rho(L(\mathbfcal{G},\mathbf{D})+S%
(\mathbf{D}))." class="ltx_math_unparsed" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1b"><munder id="S3.E11.m1.1.1"><mi id="S3.E11.m1.1.1.2">min</mi><mrow id="S3.E11.m1.1.1.3"><mi id="S3.E11.m1.1.1.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E11.m1.1.1.3.1">⁢</mo><mi id="S3.E11.m1.1.1.3.3" mathvariant="normal">⇔</mi><mo id="S3.E11.m1.1.1.3.1a">⁢</mo><mi id="S3.E11.m1.1.1.3.4" mathvariant="normal">𝒟</mi></mrow></munder><mi id="S3.E11.m1.1.2">max</mi><mrow id="S3.E11.m1.1.3"><mo id="S3.E11.m1.1.3.1">{</mo><msub id="S3.E11.m1.1.3.2"><mi id="S3.E11.m1.1.3.2.2">w</mi><mn id="S3.E11.m1.1.3.2.3">1</mn></msub><mrow id="S3.E11.m1.1.3.3"><mo id="S3.E11.m1.1.3.3.1" stretchy="false">(</mo><mi id="S3.E11.m1.1.3.3.2">L</mi><mrow id="S3.E11.m1.1.3.3.3"><mo id="S3.E11.m1.1.3.3.3.1" stretchy="false">(</mo><mi id="S3.E11.m1.1.3.3.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E11.m1.1.3.3.3.3" mathvariant="normal">⇔</mi><mi id="S3.E11.m1.1.3.3.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E11.m1.1.3.3.3.5" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.3.6" mathvariant="normal">↖</mi><msub id="S3.E11.m1.1.3.3.3.7"><mi id="S3.E11.m1.1.3.3.3.7.2" mathvariant="normal">ℒ</mi><mi id="S3.E11.m1.1.3.3.3.7.3" mathvariant="normal">′</mi></msub><mi id="S3.E11.m1.1.3.3.3.8" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.3.9" mathvariant="normal">⇔</mi><msub id="S3.E11.m1.1.3.3.3.10"><mi id="S3.E11.m1.1.3.3.3.10.2" mathvariant="normal">⊒</mi><mi id="S3.E11.m1.1.3.3.3.10.3" mathvariant="normal">∈</mi></msub><mi id="S3.E11.m1.1.3.3.3.11" mathvariant="normal">⇐</mi><mi id="S3.E11.m1.1.3.3.3.12" mathvariant="normal">𝒮</mi><mi id="S3.E11.m1.1.3.3.3.13" mathvariant="normal">⇐</mi><mi id="S3.E11.m1.1.3.3.3.14" mathvariant="normal">𝒟</mi><mi id="S3.E11.m1.1.3.3.3.15" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.3.16" mathvariant="normal">↖</mi><msub id="S3.E11.m1.1.3.3.3.17"><mi id="S3.E11.m1.1.3.3.3.17.2" mathvariant="normal">𝒮</mi><mi id="S3.E11.m1.1.3.3.3.17.3" mathvariant="normal">′</mi></msub><mi id="S3.E11.m1.1.3.3.3.18" mathvariant="normal">⇒</mi><mo id="S3.E11.m1.1.3.3.3.19">}</mo></mrow><mo id="S3.E11.m1.1.3.3.4">+</mo><mi id="S3.E11.m1.1.3.3.5">ρ</mi><mrow id="S3.E11.m1.1.3.3.6"><mo id="S3.E11.m1.1.3.3.6.1" stretchy="false">(</mo><mi id="S3.E11.m1.1.3.3.6.2">L</mi><mrow id="S3.E11.m1.1.3.3.6.3"><mo id="S3.E11.m1.1.3.3.6.3.1" stretchy="false">(</mo><mi id="S3.E11.m1.1.3.3.6.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E11.m1.1.3.3.6.3.3" mathvariant="normal">⇔</mi><mi id="S3.E11.m1.1.3.3.6.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E11.m1.1.3.3.6.3.5" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.6.3.6" mathvariant="normal">⇓</mi><mi id="S3.E11.m1.1.3.3.6.3.7" mathvariant="normal">𝒮</mi><mi id="S3.E11.m1.1.3.3.6.3.8" mathvariant="normal">⇐</mi><mi id="S3.E11.m1.1.3.3.6.3.9" mathvariant="normal">𝒟</mi><mi id="S3.E11.m1.1.3.3.6.3.10" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.6.3.11" mathvariant="normal">⇒</mi><mi id="S3.E11.m1.1.3.3.6.3.12" mathvariant="normal">↙</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\,\,\max\left\{w_{1}(L(\mathbfcal{G},\mathbf{D}%
)-L_{0}),w_{2}(S(\mathbf{D})-S_{0})\right\}+\rho(L(\mathbfcal{G},\mathbf{D})+S%
(\mathbf{D})).</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT roman_max { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ ⇔ ⊒ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇐ roman_𝒮 ⇐ roman_𝒟 ⇒ ↖ roman_𝒮 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ } + italic_ρ ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ roman_𝒮 ⇐ roman_𝒟 ⇒ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.7">Here <math alttext="w_{1},w_{2}&gt;0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m1.2"><semantics id="S3.SS2.SSS0.Px2.p1.4.m1.2a"><mrow id="S3.SS2.SSS0.Px2.p1.4.m1.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.cmml"><mrow id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.3.cmml"><msub id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.3.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.4" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m1.2b"><apply id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2"><gt id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.3"></gt><list id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2"><apply id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.2">𝑤</ci><cn id="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.4.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.2.2.2.3">2</cn></apply></list><cn id="S3.SS2.SSS0.Px2.p1.4.m1.2.2.4.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.4.m1.2.2.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m1.2c">w_{1},w_{2}&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m1.2d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math> scale the objectives into proper ranges, and <math alttext="\rho&gt;0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.5.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.2.cmml">ρ</mi><mo id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1"><gt id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.1"></gt><ci id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.2">𝜌</ci><cn id="S3.SS2.SSS0.Px2.p1.5.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m2.1c">\rho&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m2.1d">italic_ρ &gt; 0</annotation></semantics></math> is a small constant. After relaxing <math alttext="S(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.6.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.6.m3.1a"><mrow id="S3.SS2.SSS0.Px2.p1.6.m3.1.2" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.2" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.1" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.6.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.6.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2"><times id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.1"></times><ci id="S3.SS2.SSS0.Px2.p1.6.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px2.p1.6.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m3.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.6.m3.1c">S(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.6.m3.1d">italic_S ( bold_D )</annotation></semantics></math> to <math alttext="\hat{S}(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.7.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.7.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p1.7.m4.1.2" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.2" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.1" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.1.cmml">^</mo></mover><mo id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.1" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.7.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.7.m4.1b"><apply id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2"><times id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.1"></times><apply id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2"><ci id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.2.2.2">𝑆</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.7.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m4.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.7.m4.1c">\hat{S}(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.7.m4.1d">over^ start_ARG italic_S end_ARG ( bold_D )</annotation></semantics></math> and adding the regularization term, we get the following problem</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,\max\left\{w_{1}(L(\mathbfcal{G},\mathbf{D}%
)-L_{0}),w_{2}({S}(\mathbf{D})-S_{0})\right\}+\rho(L(\mathbfcal{G},\mathbf{D})%
+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{2}," class="ltx_math_unparsed" display="block" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1b"><munder id="S3.E12.m1.1.1"><mi id="S3.E12.m1.1.1.2">min</mi><mrow id="S3.E12.m1.1.1.3"><mi id="S3.E12.m1.1.1.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E12.m1.1.1.3.1">⁢</mo><mi id="S3.E12.m1.1.1.3.3" mathvariant="normal">⇔</mi><mo id="S3.E12.m1.1.1.3.1a">⁢</mo><mi id="S3.E12.m1.1.1.3.4" mathvariant="normal">𝒟</mi></mrow></munder><mi id="S3.E12.m1.1.2">max</mi><mrow id="S3.E12.m1.1.3"><mo id="S3.E12.m1.1.3.1">{</mo><msub id="S3.E12.m1.1.3.2"><mi id="S3.E12.m1.1.3.2.2">w</mi><mn id="S3.E12.m1.1.3.2.3">1</mn></msub><mrow id="S3.E12.m1.1.3.3"><mo id="S3.E12.m1.1.3.3.1" stretchy="false">(</mo><mi id="S3.E12.m1.1.3.3.2">L</mi><mrow id="S3.E12.m1.1.3.3.3"><mo id="S3.E12.m1.1.3.3.3.1" stretchy="false">(</mo><mi id="S3.E12.m1.1.3.3.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E12.m1.1.3.3.3.3" mathvariant="normal">⇔</mi><mi id="S3.E12.m1.1.3.3.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E12.m1.1.3.3.3.5" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.3.6" mathvariant="normal">↖</mi><msub id="S3.E12.m1.1.3.3.3.7"><mi id="S3.E12.m1.1.3.3.3.7.2" mathvariant="normal">ℒ</mi><mi id="S3.E12.m1.1.3.3.3.7.3" mathvariant="normal">′</mi></msub><mi id="S3.E12.m1.1.3.3.3.8" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.3.9" mathvariant="normal">⇔</mi><msub id="S3.E12.m1.1.3.3.3.10"><mi id="S3.E12.m1.1.3.3.3.10.2" mathvariant="normal">⊒</mi><mi id="S3.E12.m1.1.3.3.3.10.3" mathvariant="normal">∈</mi></msub><mi id="S3.E12.m1.1.3.3.3.11" mathvariant="normal">⇐</mi><mi id="S3.E12.m1.1.3.3.3.12" mathvariant="normal">𝒮</mi><mi id="S3.E12.m1.1.3.3.3.13" mathvariant="normal">⇐</mi><mi id="S3.E12.m1.1.3.3.3.14" mathvariant="normal">𝒟</mi><mi id="S3.E12.m1.1.3.3.3.15" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.3.16" mathvariant="normal">↖</mi><msub id="S3.E12.m1.1.3.3.3.17"><mi id="S3.E12.m1.1.3.3.3.17.2" mathvariant="normal">𝒮</mi><mi id="S3.E12.m1.1.3.3.3.17.3" mathvariant="normal">′</mi></msub><mi id="S3.E12.m1.1.3.3.3.18" mathvariant="normal">⇒</mi><mo id="S3.E12.m1.1.3.3.3.19">}</mo></mrow><mo id="S3.E12.m1.1.3.3.4">+</mo><mi id="S3.E12.m1.1.3.3.5">ρ</mi><mrow id="S3.E12.m1.1.3.3.6"><mo id="S3.E12.m1.1.3.3.6.1" stretchy="false">(</mo><mi id="S3.E12.m1.1.3.3.6.2">L</mi><mrow id="S3.E12.m1.1.3.3.6.3"><mo id="S3.E12.m1.1.3.3.6.3.1" stretchy="false">(</mo><mi id="S3.E12.m1.1.3.3.6.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E12.m1.1.3.3.6.3.3" mathvariant="normal">⇔</mi><mi id="S3.E12.m1.1.3.3.6.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E12.m1.1.3.3.6.3.5" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.6.3.6" mathvariant="normal">⇓</mi><mover accent="true" id="S3.E12.m1.1.3.3.6.3.7"><mi id="S3.E12.m1.1.3.3.6.3.7.2" mathvariant="normal">𝒮</mi><mo id="S3.E12.m1.1.3.3.6.3.7.1">^</mo></mover><mi id="S3.E12.m1.1.3.3.6.3.8" mathvariant="normal">⇐</mi><mi id="S3.E12.m1.1.3.3.6.3.9" mathvariant="normal">𝒟</mi><mi id="S3.E12.m1.1.3.3.6.3.10" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.6.3.11" mathvariant="normal">⇒</mi><mi id="S3.E12.m1.1.3.3.6.3.12" mathvariant="normal">⇓</mi><mi id="S3.E12.m1.1.3.3.6.3.13">β</mi><mo id="S3.E12.m1.1.3.3.6.3.14" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E12.m1.1.3.3.6.3.15" mathvariant="normal">𝒢</mi><msup id="S3.E12.m1.1.3.3.6.3.16"><mo id="S3.E12.m1.1.3.3.6.3.16.2" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E12.m1.1.3.3.6.3.16.3" mathvariant="normal">∈</mi></msup><mi id="S3.E12.m1.1.3.3.6.3.17" mathvariant="normal">⇔</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\,\,\max\left\{w_{1}(L(\mathbfcal{G},\mathbf{D}%
)-L_{0}),w_{2}({S}(\mathbf{D})-S_{0})\right\}+\rho(L(\mathbfcal{G},\mathbf{D})%
+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT roman_max { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ ⇔ ⊒ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇐ roman_𝒮 ⇐ roman_𝒟 ⇒ ↖ roman_𝒮 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ } + italic_ρ ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇒ ⇓ italic_β ∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.11">where <math alttext="\beta&gt;0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.8.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.8.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p1.8.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.2.cmml">β</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.8.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1"><gt id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.1"></gt><ci id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.2">𝛽</ci><cn id="S3.SS2.SSS0.Px2.p1.8.m1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.8.m1.1c">\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.8.m1.1d">italic_β &gt; 0</annotation></semantics></math> is a positive constant. Note that the <math alttext="{S}(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.9.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.9.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.9.m2.1.2" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.2" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.1" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.9.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.9.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2"><times id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.1"></times><ci id="S3.SS2.SSS0.Px2.p1.9.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px2.p1.9.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m2.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.9.m2.1c">{S}(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.9.m2.1d">italic_S ( bold_D )</annotation></semantics></math> inside <math alttext="\max" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.10.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.10.m3.1a"><mi id="S3.SS2.SSS0.Px2.p1.10.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.10.m3.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.10.m3.1b"><max id="S3.SS2.SSS0.Px2.p1.10.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.10.m3.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.10.m3.1c">\max</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.10.m3.1d">roman_max</annotation></semantics></math> is not relaxed now for accurate comparisons. When <math alttext="w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})\geq w_{2}({S}(\mathbf{D})-S_{0})" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px2.p1.11.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.11.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p1.11.m4.1b"><msub id="S3.SS2.SSS0.Px2.p1.11.m4.1.1"><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.1.2">w</mi><mn id="S3.SS2.SSS0.Px2.p1.11.m4.1.1.3">1</mn></msub><mrow id="S3.SS2.SSS0.Px2.p1.11.m4.1.2"><mo id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.1" stretchy="false">(</mo><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.2">L</mi><mrow id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3"><mo id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.1" stretchy="false">(</mo><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.2" mathvariant="normal">𝒢</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.3" mathvariant="normal">⇔</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.4" mathvariant="normal">𝒟</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.5" mathvariant="normal">⇒</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.6" mathvariant="normal">↖</mi><msub id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.7"><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.7.2" mathvariant="normal">ℒ</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.7.3" mathvariant="normal">′</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.8" mathvariant="normal">⇒</mi><mo id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.9">≥</mo><msub id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.10"><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.10.2" mathvariant="normal">⊒</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.10.3" mathvariant="normal">∈</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.11" mathvariant="normal">⇐</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.12" mathvariant="normal">𝒮</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.13" mathvariant="normal">⇐</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.14" mathvariant="normal">𝒟</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.15" mathvariant="normal">⇒</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.16" mathvariant="normal">↖</mi><msub id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.17"><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.17.2" mathvariant="normal">𝒮</mi><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.17.3" mathvariant="normal">′</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.11.m4.1.2.3.18" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.11.m4.1c">w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})\geq w_{2}({S}(\mathbf{D})-S_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.11.m4.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ ≥ ⊒ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇐ roman_𝒮 ⇐ roman_𝒟 ⇒ ↖ roman_𝒮 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒</annotation></semantics></math>, we consider the following problem</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})+%
\rho(L(\mathbfcal{G},\mathbf{D})+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{%
2}." class="ltx_math_unparsed" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1b"><munder id="S3.E13.m1.1.2"><mi id="S3.E13.m1.1.2.2">min</mi><mrow id="S3.E13.m1.1.2.3"><mi id="S3.E13.m1.1.2.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E13.m1.1.2.3.1">⁢</mo><mi id="S3.E13.m1.1.2.3.3" mathvariant="normal">⇔</mi><mo id="S3.E13.m1.1.2.3.1a">⁢</mo><mi id="S3.E13.m1.1.2.3.4" mathvariant="normal">𝒟</mi></mrow></munder><msub id="S3.E13.m1.1.3"><mi id="S3.E13.m1.1.3.2">w</mi><mn id="S3.E13.m1.1.3.3">1</mn></msub><mrow id="S3.E13.m1.1.4"><mo id="S3.E13.m1.1.4.1" stretchy="false">(</mo><mi id="S3.E13.m1.1.4.2">L</mi><mrow id="S3.E13.m1.1.4.3"><mo id="S3.E13.m1.1.4.3.1" stretchy="false">(</mo><mi id="S3.E13.m1.1.4.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E13.m1.1.4.3.3" mathvariant="normal">⇔</mi><mi id="S3.E13.m1.1.4.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E13.m1.1.4.3.5" mathvariant="normal">⇒</mi><mi id="S3.E13.m1.1.4.3.6" mathvariant="normal">↖</mi><msub id="S3.E13.m1.1.4.3.7"><mi id="S3.E13.m1.1.4.3.7.2" mathvariant="normal">ℒ</mi><mi id="S3.E13.m1.1.4.3.7.3" mathvariant="normal">′</mi></msub><mi id="S3.E13.m1.1.4.3.8" mathvariant="normal">⇒</mi><mi id="S3.E13.m1.1.4.3.9" mathvariant="normal">⇓</mi><mi id="S3.E13.m1.1.4.3.10">ρ</mi><mi id="S3.E13.m1.1.4.3.11" mathvariant="normal">⇐</mi><mi id="S3.E13.m1.1.4.3.12" mathvariant="normal">ℒ</mi><mi id="S3.E13.m1.1.4.3.13" mathvariant="normal">⇐</mi><mi id="S3.E13.m1.1.4.3.14" mathvariant="normal">𝒢</mi><mi id="S3.E13.m1.1.4.3.15" mathvariant="normal">⇔</mi><mi id="S3.E13.m1.1.4.3.16" mathvariant="normal">𝒟</mi><mi id="S3.E13.m1.1.4.3.17" mathvariant="normal">⇒</mi><mi id="S3.E13.m1.1.4.3.18" mathvariant="normal">⇓</mi><mover accent="true" id="S3.E13.m1.1.4.3.19"><mi id="S3.E13.m1.1.4.3.19.2" mathvariant="normal">𝒮</mi><mo id="S3.E13.m1.1.4.3.19.1">^</mo></mover><mi id="S3.E13.m1.1.4.3.20" mathvariant="normal">⇐</mi><mi id="S3.E13.m1.1.4.3.21" mathvariant="normal">𝒟</mi><mi id="S3.E13.m1.1.4.3.22" mathvariant="normal">⇒</mi><mi id="S3.E13.m1.1.4.3.23" mathvariant="normal">⇒</mi><mi id="S3.E13.m1.1.4.3.24" mathvariant="normal">⇓</mi><mi id="S3.E13.m1.1.4.3.25">β</mi><mo id="S3.E13.m1.1.4.3.26" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E13.m1.1.1" mathvariant="normal">𝒢</mi><msup id="S3.E13.m1.1.4.3.27"><mo id="S3.E13.m1.1.4.3.27.2" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E13.m1.1.4.3.27.3" mathvariant="normal">∈</mi></msup><mi id="S3.E13.m1.1.4.3.28" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}\,\,w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})+%
\rho(L(\mathbfcal{G},\mathbf{D})+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{%
2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ ⇓ italic_ρ ⇐ roman_ℒ ⇐ roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇒ ⇓ italic_β ∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.13">We run a step of a gradient-based algorithm on this problem.
When <math alttext="w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})&lt;w_{2}({S}(\mathbf{D})-S_{0})" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px2.p1.12.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.12.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p1.12.m1.1b"><msub id="S3.SS2.SSS0.Px2.p1.12.m1.1.1"><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.1.2">w</mi><mn id="S3.SS2.SSS0.Px2.p1.12.m1.1.1.3">1</mn></msub><mrow id="S3.SS2.SSS0.Px2.p1.12.m1.1.2"><mo id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.1" stretchy="false">(</mo><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.2">L</mi><mrow id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3"><mo id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.1" stretchy="false">(</mo><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.2" mathvariant="normal">𝒢</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.3" mathvariant="normal">⇔</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.4" mathvariant="normal">𝒟</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.5" mathvariant="normal">⇒</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.6" mathvariant="normal">↖</mi><msub id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.7"><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.7.2" mathvariant="normal">ℒ</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.7.3" mathvariant="normal">′</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.8" mathvariant="normal">⇒</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.9" mathvariant="normal">ℜ</mi><msub id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.10"><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.10.2" mathvariant="normal">⊒</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.10.3" mathvariant="normal">∈</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.11" mathvariant="normal">⇐</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.12" mathvariant="normal">𝒮</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.13" mathvariant="normal">⇐</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.14" mathvariant="normal">𝒟</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.15" mathvariant="normal">⇒</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.16" mathvariant="normal">↖</mi><msub id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.17"><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.17.2" mathvariant="normal">𝒮</mi><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.17.3" mathvariant="normal">′</mi></msub><mi id="S3.SS2.SSS0.Px2.p1.12.m1.1.2.3.18" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.12.m1.1c">w_{1}(L(\mathbfcal{G},\mathbf{D})-L_{0})&lt;w_{2}({S}(\mathbf{D})-S_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.12.m1.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ roman_ℜ ⊒ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇐ roman_𝒮 ⇐ roman_𝒟 ⇒ ↖ roman_𝒮 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒</annotation></semantics></math>, we relax the <math alttext="S(\mathbf{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.13.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.13.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.13.m2.1.2" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.2" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.1" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.13.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.1.cmml">𝐃</mi><mo id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.13.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2"><times id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.1"></times><ci id="S3.SS2.SSS0.Px2.p1.13.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px2.p1.13.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.13.m2.1.1">𝐃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.13.m2.1c">S(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.13.m2.1d">italic_S ( bold_D )</annotation></semantics></math> again and get the following problem</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbfcal{G},\mathbf{D}}\,\,w_{2}(\hat{S}(\mathbf{D})-S_{0})+\rho(L(%
\mathbfcal{G},\mathbf{D})+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{2}," class="ltx_math_unparsed" display="block" id="S3.E14.m1.2"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2b"><munder id="S3.E14.m1.2.3"><mi id="S3.E14.m1.2.3.2">min</mi><mrow id="S3.E14.m1.2.3.3"><mi id="S3.E14.m1.2.3.3.2" mathvariant="normal">𝒢</mi><mo id="S3.E14.m1.2.3.3.1">⁢</mo><mi id="S3.E14.m1.2.3.3.3" mathvariant="normal">⇔</mi><mo id="S3.E14.m1.2.3.3.1a">⁢</mo><mi id="S3.E14.m1.2.3.3.4" mathvariant="normal">𝒟</mi></mrow></munder><msub id="S3.E14.m1.2.4"><mi id="S3.E14.m1.2.4.2">w</mi><mn id="S3.E14.m1.2.4.3">2</mn></msub><mrow id="S3.E14.m1.2.5"><mo id="S3.E14.m1.2.5.1" stretchy="false">(</mo><mover accent="true" id="S3.E14.m1.2.5.2"><mi id="S3.E14.m1.2.5.2.2">S</mi><mo id="S3.E14.m1.2.5.2.1">^</mo></mover><mrow id="S3.E14.m1.2.5.3"><mo id="S3.E14.m1.2.5.3.1" stretchy="false">(</mo><mi id="S3.E14.m1.1.1">𝐃</mi><mo id="S3.E14.m1.2.5.3.2" stretchy="false">)</mo></mrow><mo id="S3.E14.m1.2.5.4">−</mo><msub id="S3.E14.m1.2.5.5"><mi id="S3.E14.m1.2.5.5.2">S</mi><mn id="S3.E14.m1.2.5.5.3">0</mn></msub><mo id="S3.E14.m1.2.5.6" stretchy="false">)</mo></mrow><mo id="S3.E14.m1.2.6">+</mo><mi id="S3.E14.m1.2.7">ρ</mi><mrow id="S3.E14.m1.2.8"><mo id="S3.E14.m1.2.8.1" stretchy="false">(</mo><mi id="S3.E14.m1.2.8.2">L</mi><mrow id="S3.E14.m1.2.8.3"><mo id="S3.E14.m1.2.8.3.1" stretchy="false">(</mo><mi id="S3.E14.m1.2.8.3.2" mathvariant="normal">𝒢</mi><mi id="S3.E14.m1.2.8.3.3" mathvariant="normal">⇔</mi><mi id="S3.E14.m1.2.8.3.4" mathvariant="normal">𝒟</mi><mi id="S3.E14.m1.2.8.3.5" mathvariant="normal">⇒</mi><mi id="S3.E14.m1.2.8.3.6" mathvariant="normal">⇓</mi><mover accent="true" id="S3.E14.m1.2.8.3.7"><mi id="S3.E14.m1.2.8.3.7.2" mathvariant="normal">𝒮</mi><mo id="S3.E14.m1.2.8.3.7.1">^</mo></mover><mi id="S3.E14.m1.2.8.3.8" mathvariant="normal">⇐</mi><mi id="S3.E14.m1.2.8.3.9" mathvariant="normal">𝒟</mi><mi id="S3.E14.m1.2.8.3.10" mathvariant="normal">⇒</mi><mi id="S3.E14.m1.2.8.3.11" mathvariant="normal">⇒</mi><mi id="S3.E14.m1.2.8.3.12" mathvariant="normal">⇓</mi><mi id="S3.E14.m1.2.8.3.13">β</mi><mo id="S3.E14.m1.2.8.3.14" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E14.m1.2.2" mathvariant="normal">𝒢</mi><msup id="S3.E14.m1.2.8.3.15"><mo id="S3.E14.m1.2.8.3.15.2" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E14.m1.2.8.3.15.3" mathvariant="normal">∈</mi></msup><mi id="S3.E14.m1.2.8.3.16" mathvariant="normal">⇔</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\min_{\mathbfcal{G},\mathbf{D}}\,\,w_{2}(\hat{S}(\mathbf{D})-S_{0})+\rho(L(%
\mathbfcal{G},\mathbf{D})+\hat{S}(\mathbf{D}))+\beta\|\mathbfcal{G}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.2d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( over^ start_ARG italic_S end_ARG ( bold_D ) - italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + italic_ρ ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇒ ⇓ italic_β ∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.14">and run a step of a gradient-based algorithm on this problem. The Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg1" title="Algorithm 1 ‣ A.2 Algorithm for Late Stage Optimization in Section 3.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a> is summarized in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS2" title="A.2 Algorithm for Late Stage Optimization in Section 3.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.2</span></a>. The late stage optimization can be independently applied to a trained tensor-compressed model for further model size reductions.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Performance Optimization of CoMERA</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">While CoMERA can greatly reduce training variables and memory cost, the low-rank and small-size tensor operations in CoMERA are not efficiently supported by GPU. This often slows the training process. This section presents three methods to achieve real training speedup on GPU.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Performance Optimization of TTM Embedding Tables.</h3>
<figure class="ltx_figure ltx_align_floatright" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="140" id="S4.F4.g1" src="extracted/2405.14377v1/figures/TTM_emb_new.png" width="250"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Optimized TTM embedding lookup.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Embedding tables are widely used to transfer discrete features into continuous hidden space. The row size of embedding tables is usually much larger than the column size, making TTM compression more suitable than the TT format. In the following, we use an order-4 TTM embedding table to illustrate how to accelerate the lookup process.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.6">We consider an embedding table <math alttext="\mathbf{T}\in\mathbb{R}^{m\times n}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">𝐓</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.3.2" xref="S4.SS1.p2.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S4.SS1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><in id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></in><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝐓</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3"><times id="S4.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2">𝑚</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathbf{T}\in\mathbb{R}^{m\times n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">bold_T ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>. A look-up operation selects the submatrix <math alttext="\mathbf{T}[\mathcal{I},:]\in\mathbb{R}^{b\times n}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.2"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.3" xref="S4.SS1.p2.2.m2.2.3.cmml"><mrow id="S4.SS1.p2.2.m2.2.3.2" xref="S4.SS1.p2.2.m2.2.3.2.cmml"><mi id="S4.SS1.p2.2.m2.2.3.2.2" xref="S4.SS1.p2.2.m2.2.3.2.2.cmml">𝐓</mi><mo id="S4.SS1.p2.2.m2.2.3.2.1" xref="S4.SS1.p2.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.2.m2.2.3.2.3.2" xref="S4.SS1.p2.2.m2.2.3.2.3.1.cmml"><mo id="S4.SS1.p2.2.m2.2.3.2.3.2.1" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.2.3.1.cmml">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">ℐ</mi><mo id="S4.SS1.p2.2.m2.2.3.2.3.2.2" xref="S4.SS1.p2.2.m2.2.3.2.3.1.cmml">,</mo><mo id="S4.SS1.p2.2.m2.2.2" rspace="0em" xref="S4.SS1.p2.2.m2.2.2.cmml">:</mo><mo id="S4.SS1.p2.2.m2.2.3.2.3.2.3" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S4.SS1.p2.2.m2.2.3.1" xref="S4.SS1.p2.2.m2.2.3.1.cmml">∈</mo><msup id="S4.SS1.p2.2.m2.2.3.3" xref="S4.SS1.p2.2.m2.2.3.3.cmml"><mi id="S4.SS1.p2.2.m2.2.3.3.2" xref="S4.SS1.p2.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.2.m2.2.3.3.3" xref="S4.SS1.p2.2.m2.2.3.3.3.cmml"><mi id="S4.SS1.p2.2.m2.2.3.3.3.2" xref="S4.SS1.p2.2.m2.2.3.3.3.2.cmml">b</mi><mo id="S4.SS1.p2.2.m2.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.2.m2.2.3.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.2.m2.2.3.3.3.3" xref="S4.SS1.p2.2.m2.2.3.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><apply id="S4.SS1.p2.2.m2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.3"><in id="S4.SS1.p2.2.m2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.1"></in><apply id="S4.SS1.p2.2.m2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.2.3.2"><times id="S4.SS1.p2.2.m2.2.3.2.1.cmml" xref="S4.SS1.p2.2.m2.2.3.2.1"></times><ci id="S4.SS1.p2.2.m2.2.3.2.2.cmml" xref="S4.SS1.p2.2.m2.2.3.2.2">𝐓</ci><interval closure="closed" id="S4.SS1.p2.2.m2.2.3.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.2.3.2"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">ℐ</ci><ci id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2">:</ci></interval></apply><apply id="S4.SS1.p2.2.m2.2.3.3.cmml" xref="S4.SS1.p2.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.3.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.3">superscript</csymbol><ci id="S4.SS1.p2.2.m2.2.3.3.2.cmml" xref="S4.SS1.p2.2.m2.2.3.3.2">ℝ</ci><apply id="S4.SS1.p2.2.m2.2.3.3.3.cmml" xref="S4.SS1.p2.2.m2.2.3.3.3"><times id="S4.SS1.p2.2.m2.2.3.3.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.3.3.1"></times><ci id="S4.SS1.p2.2.m2.2.3.3.3.2.cmml" xref="S4.SS1.p2.2.m2.2.3.3.3.2">𝑏</ci><ci id="S4.SS1.p2.2.m2.2.3.3.3.3.cmml" xref="S4.SS1.p2.2.m2.2.3.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">\mathbf{T}[\mathcal{I},:]\in\mathbb{R}^{b\times n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.2d">bold_T [ caligraphic_I , : ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_b × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> for the index set <math alttext="\mathcal{I}=\{i_{k}\}_{k=1}^{b}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">ℐ</mi><mo id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml"><mrow id="S4.SS1.p2.3.m3.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p2.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.p2.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.3.m3.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p2.3.m3.1.1.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.3.m3.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.3.cmml">b</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2"></eq><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">ℐ</ci><apply id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.3.m3.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1">subscript</csymbol><set id="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1"><apply id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.p2.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.3"><eq id="S4.SS1.p2.3.m3.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.3.1"></eq><ci id="S4.SS1.p2.3.m3.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS1.p2.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p2.3.m3.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathcal{I}=\{i_{k}\}_{k=1}^{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">caligraphic_I = { italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math>. This operation is fast and inexpensive. However, the full embedding table itself is extremely memory-consuming. Suppose that <math alttext="m=m_{1}m_{2}m_{3}m_{4},n=n_{1}n_{2}n_{3}n_{4}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.2"><semantics id="S4.SS1.p2.4.m4.2a"><mrow id="S4.SS1.p2.4.m4.2.2.2" xref="S4.SS1.p2.4.m4.2.2.3.cmml"><mrow id="S4.SS1.p2.4.m4.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml">m</mi><mo id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.cmml"><msub id="S4.SS1.p2.4.m4.1.1.1.1.3.2" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.3.2.2" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2.2.cmml">m</mi><mn id="S4.SS1.p2.4.m4.1.1.1.1.3.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.3.1" xref="S4.SS1.p2.4.m4.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.1.1.1.1.3.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.3.3.2" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3.2.cmml">m</mi><mn id="S4.SS1.p2.4.m4.1.1.1.1.3.3.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3.3.cmml">2</mn></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.3.1a" xref="S4.SS1.p2.4.m4.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.1.1.1.1.3.4" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.3.4.2" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4.2.cmml">m</mi><mn id="S4.SS1.p2.4.m4.1.1.1.1.3.4.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4.3.cmml">3</mn></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.3.1b" xref="S4.SS1.p2.4.m4.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.1.1.1.1.3.5" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.3.5.2" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5.2.cmml">m</mi><mn id="S4.SS1.p2.4.m4.1.1.1.1.3.5.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5.3.cmml">4</mn></msub></mrow></mrow><mo id="S4.SS1.p2.4.m4.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.3a.cmml">,</mo><mrow id="S4.SS1.p2.4.m4.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.2.cmml">n</mi><mo id="S4.SS1.p2.4.m4.2.2.2.2.1" xref="S4.SS1.p2.4.m4.2.2.2.2.1.cmml">=</mo><mrow id="S4.SS1.p2.4.m4.2.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.cmml"><msub id="S4.SS1.p2.4.m4.2.2.2.2.3.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.3.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.2.cmml">n</mi><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.2.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.3.cmml">1</mn></msub><mo id="S4.SS1.p2.4.m4.2.2.2.2.3.1" xref="S4.SS1.p2.4.m4.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.2.2.2.2.3.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.3.3.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.2.cmml">n</mi><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.3.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.3.cmml">2</mn></msub><mo id="S4.SS1.p2.4.m4.2.2.2.2.3.1a" xref="S4.SS1.p2.4.m4.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.2.2.2.2.3.4" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.3.4.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4.2.cmml">n</mi><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.4.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4.3.cmml">3</mn></msub><mo id="S4.SS1.p2.4.m4.2.2.2.2.3.1b" xref="S4.SS1.p2.4.m4.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.SS1.p2.4.m4.2.2.2.2.3.5" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.3.5.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5.2.cmml">n</mi><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.5.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5.3.cmml">4</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.2b"><apply id="S4.SS1.p2.4.m4.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.3a.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"></eq><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2">𝑚</ci><apply id="S4.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3"><times id="S4.SS1.p2.4.m4.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.1"></times><apply id="S4.SS1.p2.4.m4.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.3.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.3.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2.2">𝑚</ci><cn id="S4.SS1.p2.4.m4.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.3.2.3">1</cn></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.3.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.3.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3.2">𝑚</ci><cn id="S4.SS1.p2.4.m4.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.3.3.3">2</cn></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1.3.4.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.3.4.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.3.4.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4.2">𝑚</ci><cn id="S4.SS1.p2.4.m4.1.1.1.1.3.4.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.3.4.3">3</cn></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1.3.5.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.3.5.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.3.5.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5.2">𝑚</ci><cn id="S4.SS1.p2.4.m4.1.1.1.1.3.5.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.3.5.3">4</cn></apply></apply></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2"><eq id="S4.SS1.p2.4.m4.2.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.1"></eq><ci id="S4.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2">𝑛</ci><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3"><times id="S4.SS1.p2.4.m4.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.1"></times><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.3.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.3.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.2">𝑛</ci><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.2.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.3">1</cn></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.3.3.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.2">𝑛</ci><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.3">2</cn></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.4.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.3.4.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.3.4.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4.2">𝑛</ci><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.4.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.4.3">3</cn></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.5.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.3.5.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.3.5.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5.2">𝑛</ci><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.5.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.5.3">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.2c">m=m_{1}m_{2}m_{3}m_{4},n=n_{1}n_{2}n_{3}n_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.2d">italic_m = italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_n = italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, then we reshape <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">bold_T</annotation></semantics></math> into tensor <math alttext="\mathbfcal{T}\in\mathbb{R}^{m_{1}\times n_{1}\times\cdots\times m_{4}\times n_%
{4}}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.2.cmml">𝒯</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.2.cmml">ℛ</mi><mrow id="S4.SS1.p2.6.m6.1.1.3.3" xref="S4.SS1.p2.6.m6.1.1.3.3.cmml"><msub id="S4.SS1.p2.6.m6.1.1.3.3.2" xref="S4.SS1.p2.6.m6.1.1.3.3.2.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.3.2.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.2.2.cmml">⇕</mi><mi id="S4.SS1.p2.6.m6.1.1.3.3.2.3" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S4.SS1.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p2.6.m6.1.1.3.3.3" xref="S4.SS1.p2.6.m6.1.1.3.3.3.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.3.3.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.3.2.cmml">\</mi><mi id="S4.SS1.p2.6.m6.1.1.3.3.3.3" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.3.3.cmml">∞</mi></msub><mo id="S4.SS1.p2.6.m6.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.6.m6.1.1.3.3.4" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.4.cmml">⋯</mi><mo id="S4.SS1.p2.6.m6.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p2.6.m6.1.1.3.3.5" xref="S4.SS1.p2.6.m6.1.1.3.3.5.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.3.5.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.5.2.cmml">⇕</mi><mi id="S4.SS1.p2.6.m6.1.1.3.3.5.3" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.5.3.cmml">△</mi></msub><mo id="S4.SS1.p2.6.m6.1.1.3.3.1c" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p2.6.m6.1.1.3.3.6" xref="S4.SS1.p2.6.m6.1.1.3.3.6.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.3.6.2" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.6.2.cmml">\</mi><mi id="S4.SS1.p2.6.m6.1.1.3.3.6.3" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.3.3.6.3.cmml">△</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><in id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></in><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝒯</ci><apply id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.2">ℛ</ci><apply id="S4.SS1.p2.6.m6.1.1.3.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3"><times id="S4.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.1"></times><apply id="S4.SS1.p2.6.m6.1.1.3.3.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.3.2.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.3.2.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.2.2">⇕</ci><ci id="S4.SS1.p2.6.m6.1.1.3.3.2.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.2.3">∞</ci></apply><apply id="S4.SS1.p2.6.m6.1.1.3.3.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.3.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.3.3.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.3.2">\</ci><ci id="S4.SS1.p2.6.m6.1.1.3.3.3.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.3.3">∞</ci></apply><ci id="S4.SS1.p2.6.m6.1.1.3.3.4.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.4">⋯</ci><apply id="S4.SS1.p2.6.m6.1.1.3.3.5.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.5"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.3.5.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.5">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.3.5.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.5.2">⇕</ci><ci id="S4.SS1.p2.6.m6.1.1.3.3.5.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.5.3">△</ci></apply><apply id="S4.SS1.p2.6.m6.1.1.3.3.6.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.6"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.3.6.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.6">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.3.6.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.6.2">\</ci><ci id="S4.SS1.p2.6.m6.1.1.3.3.6.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.6.3">△</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\mathbfcal{T}\in\mathbb{R}^{m_{1}\times n_{1}\times\cdots\times m_{4}\times n_%
{4}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">roman_𝒯 ∈ roman_ℛ start_POSTSUPERSCRIPT ⇕ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × ⋯ × ⇕ start_POSTSUBSCRIPT △ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT △ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and represent it in TTM format</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbfcal{T}=\mathbfcal{G}_{1}\times_{4,1}\mathbfcal{G}_{2}\times_{4,1}%
\mathbfcal{G}_{3}\times_{4,1}\mathbfcal{G}_{4}." class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><mrow id="S4.E15.m1.1.1.2" xref="S4.E15.m1.1.1.2.cmml"><mrow id="S4.E15.m1.1.1.2.2" xref="S4.E15.m1.1.1.2.2.cmml"><mrow id="S4.E15.m1.1.1.2.2.2" xref="S4.E15.m1.1.1.2.2.2.cmml"><mrow id="S4.E15.m1.1.1.2.2.2.2" xref="S4.E15.m1.1.1.2.2.2.2.cmml"><mi id="S4.E15.m1.1.1.2.2.2.2.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.2.2.cmml">𝒯</mi><mo id="S4.E15.m1.1.1.2.2.2.2.1" xref="S4.E15.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.2.2.2.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.2.3.cmml">ℑ</mi><mo id="S4.E15.m1.1.1.2.2.2.2.1a" xref="S4.E15.m1.1.1.2.2.2.2.1.cmml">⁢</mo><msub id="S4.E15.m1.1.1.2.2.2.2.4" xref="S4.E15.m1.1.1.2.2.2.2.4.cmml"><mi id="S4.E15.m1.1.1.2.2.2.2.4.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.2.4.2.cmml">𝒢</mi><mi id="S4.E15.m1.1.1.2.2.2.2.4.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.2.4.3.cmml">∞</mi></msub></mrow><msub id="S4.E15.m1.1.1.2.2.2.1" xref="S4.E15.m1.1.1.2.2.2.1.cmml"><mo id="S4.E15.m1.1.1.2.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E15.m1.1.1.2.2.2.1.2.cmml">×</mo><mrow id="S4.E15.m1.1.1.2.2.2.1.3" xref="S4.E15.m1.1.1.2.2.2.1.3.cmml"><mi id="S4.E15.m1.1.1.2.2.2.1.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.1.3.2.cmml">△</mi><mo id="S4.E15.m1.1.1.2.2.2.1.3.1" xref="S4.E15.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.2.2.1.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.1.3.3.cmml">⇔</mi><mo id="S4.E15.m1.1.1.2.2.2.1.3.1a" xref="S4.E15.m1.1.1.2.2.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.2.2.1.3.4" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S4.E15.m1.1.1.2.2.2.3" xref="S4.E15.m1.1.1.2.2.2.3.cmml"><mi id="S4.E15.m1.1.1.2.2.2.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.3.2.cmml">𝒢</mi><mi id="S4.E15.m1.1.1.2.2.2.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.2.3.3.cmml">∈</mi></msub></mrow><msub id="S4.E15.m1.1.1.2.2.1" xref="S4.E15.m1.1.1.2.2.1.cmml"><mo id="S4.E15.m1.1.1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E15.m1.1.1.2.2.1.2.cmml">×</mo><mrow id="S4.E15.m1.1.1.2.2.1.3" xref="S4.E15.m1.1.1.2.2.1.3.cmml"><mi id="S4.E15.m1.1.1.2.2.1.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.1.3.2.cmml">△</mi><mo id="S4.E15.m1.1.1.2.2.1.3.1" xref="S4.E15.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.2.1.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.1.3.3.cmml">⇔</mi><mo id="S4.E15.m1.1.1.2.2.1.3.1a" xref="S4.E15.m1.1.1.2.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.2.1.3.4" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S4.E15.m1.1.1.2.2.3" xref="S4.E15.m1.1.1.2.2.3.cmml"><mi id="S4.E15.m1.1.1.2.2.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.3.2.cmml">𝒢</mi><mi id="S4.E15.m1.1.1.2.2.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.2.3.3.cmml">∋</mi></msub></mrow><msub id="S4.E15.m1.1.1.2.1" xref="S4.E15.m1.1.1.2.1.cmml"><mo id="S4.E15.m1.1.1.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E15.m1.1.1.2.1.2.cmml">×</mo><mrow id="S4.E15.m1.1.1.2.1.3" xref="S4.E15.m1.1.1.2.1.3.cmml"><mi id="S4.E15.m1.1.1.2.1.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.1.3.2.cmml">△</mi><mo id="S4.E15.m1.1.1.2.1.3.1" xref="S4.E15.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.1.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.1.3.3.cmml">⇔</mi><mo id="S4.E15.m1.1.1.2.1.3.1a" xref="S4.E15.m1.1.1.2.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.2.1.3.4" mathvariant="normal" xref="S4.E15.m1.1.1.2.1.3.4.cmml">∞</mi></mrow></msub><msub id="S4.E15.m1.1.1.2.3" xref="S4.E15.m1.1.1.2.3.cmml"><mi id="S4.E15.m1.1.1.2.3.2" mathvariant="normal" xref="S4.E15.m1.1.1.2.3.2.cmml">𝒢</mi><mi id="S4.E15.m1.1.1.2.3.3" mathvariant="normal" xref="S4.E15.m1.1.1.2.3.3.cmml">△</mi></msub></mrow><mo id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.3" mathvariant="normal" xref="S4.E15.m1.1.1.3.cmml">↙</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><times id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"></times><apply id="S4.E15.m1.1.1.2.cmml" xref="S4.E15.m1.1.1.2"><apply id="S4.E15.m1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.1.1.cmml" xref="S4.E15.m1.1.1.2.1">subscript</csymbol><times id="S4.E15.m1.1.1.2.1.2.cmml" xref="S4.E15.m1.1.1.2.1.2"></times><apply id="S4.E15.m1.1.1.2.1.3.cmml" xref="S4.E15.m1.1.1.2.1.3"><times id="S4.E15.m1.1.1.2.1.3.1.cmml" xref="S4.E15.m1.1.1.2.1.3.1"></times><ci id="S4.E15.m1.1.1.2.1.3.2.cmml" xref="S4.E15.m1.1.1.2.1.3.2">△</ci><ci id="S4.E15.m1.1.1.2.1.3.3.cmml" xref="S4.E15.m1.1.1.2.1.3.3">⇔</ci><ci id="S4.E15.m1.1.1.2.1.3.4.cmml" xref="S4.E15.m1.1.1.2.1.3.4">∞</ci></apply></apply><apply id="S4.E15.m1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.2.2"><apply id="S4.E15.m1.1.1.2.2.1.cmml" xref="S4.E15.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.2.1.1.cmml" xref="S4.E15.m1.1.1.2.2.1">subscript</csymbol><times id="S4.E15.m1.1.1.2.2.1.2.cmml" xref="S4.E15.m1.1.1.2.2.1.2"></times><apply id="S4.E15.m1.1.1.2.2.1.3.cmml" xref="S4.E15.m1.1.1.2.2.1.3"><times id="S4.E15.m1.1.1.2.2.1.3.1.cmml" xref="S4.E15.m1.1.1.2.2.1.3.1"></times><ci id="S4.E15.m1.1.1.2.2.1.3.2.cmml" xref="S4.E15.m1.1.1.2.2.1.3.2">△</ci><ci id="S4.E15.m1.1.1.2.2.1.3.3.cmml" xref="S4.E15.m1.1.1.2.2.1.3.3">⇔</ci><ci id="S4.E15.m1.1.1.2.2.1.3.4.cmml" xref="S4.E15.m1.1.1.2.2.1.3.4">∞</ci></apply></apply><apply id="S4.E15.m1.1.1.2.2.2.cmml" xref="S4.E15.m1.1.1.2.2.2"><apply id="S4.E15.m1.1.1.2.2.2.1.cmml" xref="S4.E15.m1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.2.2.1.1.cmml" xref="S4.E15.m1.1.1.2.2.2.1">subscript</csymbol><times id="S4.E15.m1.1.1.2.2.2.1.2.cmml" xref="S4.E15.m1.1.1.2.2.2.1.2"></times><apply id="S4.E15.m1.1.1.2.2.2.1.3.cmml" xref="S4.E15.m1.1.1.2.2.2.1.3"><times id="S4.E15.m1.1.1.2.2.2.1.3.1.cmml" xref="S4.E15.m1.1.1.2.2.2.1.3.1"></times><ci id="S4.E15.m1.1.1.2.2.2.1.3.2.cmml" xref="S4.E15.m1.1.1.2.2.2.1.3.2">△</ci><ci id="S4.E15.m1.1.1.2.2.2.1.3.3.cmml" xref="S4.E15.m1.1.1.2.2.2.1.3.3">⇔</ci><ci id="S4.E15.m1.1.1.2.2.2.1.3.4.cmml" xref="S4.E15.m1.1.1.2.2.2.1.3.4">∞</ci></apply></apply><apply id="S4.E15.m1.1.1.2.2.2.2.cmml" xref="S4.E15.m1.1.1.2.2.2.2"><times id="S4.E15.m1.1.1.2.2.2.2.1.cmml" xref="S4.E15.m1.1.1.2.2.2.2.1"></times><ci id="S4.E15.m1.1.1.2.2.2.2.2.cmml" xref="S4.E15.m1.1.1.2.2.2.2.2">𝒯</ci><ci id="S4.E15.m1.1.1.2.2.2.2.3.cmml" xref="S4.E15.m1.1.1.2.2.2.2.3">ℑ</ci><apply id="S4.E15.m1.1.1.2.2.2.2.4.cmml" xref="S4.E15.m1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.2.2.2.4.1.cmml" xref="S4.E15.m1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S4.E15.m1.1.1.2.2.2.2.4.2.cmml" xref="S4.E15.m1.1.1.2.2.2.2.4.2">𝒢</ci><ci id="S4.E15.m1.1.1.2.2.2.2.4.3.cmml" xref="S4.E15.m1.1.1.2.2.2.2.4.3">∞</ci></apply></apply><apply id="S4.E15.m1.1.1.2.2.2.3.cmml" xref="S4.E15.m1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.2.2.3.1.cmml" xref="S4.E15.m1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.E15.m1.1.1.2.2.2.3.2.cmml" xref="S4.E15.m1.1.1.2.2.2.3.2">𝒢</ci><ci id="S4.E15.m1.1.1.2.2.2.3.3.cmml" xref="S4.E15.m1.1.1.2.2.2.3.3">∈</ci></apply></apply><apply id="S4.E15.m1.1.1.2.2.3.cmml" xref="S4.E15.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.2.3.1.cmml" xref="S4.E15.m1.1.1.2.2.3">subscript</csymbol><ci id="S4.E15.m1.1.1.2.2.3.2.cmml" xref="S4.E15.m1.1.1.2.2.3.2">𝒢</ci><ci id="S4.E15.m1.1.1.2.2.3.3.cmml" xref="S4.E15.m1.1.1.2.2.3.3">∋</ci></apply></apply><apply id="S4.E15.m1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.2.3.1.cmml" xref="S4.E15.m1.1.1.2.3">subscript</csymbol><ci id="S4.E15.m1.1.1.2.3.2.cmml" xref="S4.E15.m1.1.1.2.3.2">𝒢</ci><ci id="S4.E15.m1.1.1.2.3.3.cmml" xref="S4.E15.m1.1.1.2.3.3">△</ci></apply></apply><ci id="S4.E15.m1.1.1.3.cmml" xref="S4.E15.m1.1.1.3">↙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\mathbfcal{T}=\mathbfcal{G}_{1}\times_{4,1}\mathbfcal{G}_{2}\times_{4,1}%
\mathbfcal{G}_{3}\times_{4,1}\mathbfcal{G}_{4}.</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">roman_𝒯 roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ∋ end_POSTSUBSCRIPT × start_POSTSUBSCRIPT △ ⇔ ∞ end_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT △ end_POSTSUBSCRIPT ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.15">The compressed embedding table does not have the matrix <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m1.1"><semantics id="S4.SS1.p2.7.m1.1a"><mi id="S4.SS1.p2.7.m1.1.1" xref="S4.SS1.p2.7.m1.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m1.1b"><ci id="S4.SS1.p2.7.m1.1.1.cmml" xref="S4.SS1.p2.7.m1.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m1.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m1.1d">bold_T</annotation></semantics></math> explicitly. We convert each row index <math alttext="i_{k}\in\mathcal{I}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m2.1"><semantics id="S4.SS1.p2.8.m2.1a"><mrow id="S4.SS1.p2.8.m2.1.1" xref="S4.SS1.p2.8.m2.1.1.cmml"><msub id="S4.SS1.p2.8.m2.1.1.2" xref="S4.SS1.p2.8.m2.1.1.2.cmml"><mi id="S4.SS1.p2.8.m2.1.1.2.2" xref="S4.SS1.p2.8.m2.1.1.2.2.cmml">i</mi><mi id="S4.SS1.p2.8.m2.1.1.2.3" xref="S4.SS1.p2.8.m2.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p2.8.m2.1.1.1" xref="S4.SS1.p2.8.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.8.m2.1.1.3" xref="S4.SS1.p2.8.m2.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m2.1b"><apply id="S4.SS1.p2.8.m2.1.1.cmml" xref="S4.SS1.p2.8.m2.1.1"><in id="S4.SS1.p2.8.m2.1.1.1.cmml" xref="S4.SS1.p2.8.m2.1.1.1"></in><apply id="S4.SS1.p2.8.m2.1.1.2.cmml" xref="S4.SS1.p2.8.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m2.1.1.2.1.cmml" xref="S4.SS1.p2.8.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.8.m2.1.1.2.2.cmml" xref="S4.SS1.p2.8.m2.1.1.2.2">𝑖</ci><ci id="S4.SS1.p2.8.m2.1.1.2.3.cmml" xref="S4.SS1.p2.8.m2.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.p2.8.m2.1.1.3.cmml" xref="S4.SS1.p2.8.m2.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m2.1c">i_{k}\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m2.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_I</annotation></semantics></math> to a tensor index vector <math alttext="(z_{1}^{k},z_{2}^{k},z_{3}^{k},z_{4}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m3.4"><semantics id="S4.SS1.p2.9.m3.4a"><mrow id="S4.SS1.p2.9.m3.4.4.4" xref="S4.SS1.p2.9.m3.4.4.5.cmml"><mo id="S4.SS1.p2.9.m3.4.4.4.5" stretchy="false" xref="S4.SS1.p2.9.m3.4.4.5.cmml">(</mo><msubsup id="S4.SS1.p2.9.m3.1.1.1.1" xref="S4.SS1.p2.9.m3.1.1.1.1.cmml"><mi id="S4.SS1.p2.9.m3.1.1.1.1.2.2" xref="S4.SS1.p2.9.m3.1.1.1.1.2.2.cmml">z</mi><mn id="S4.SS1.p2.9.m3.1.1.1.1.2.3" xref="S4.SS1.p2.9.m3.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p2.9.m3.1.1.1.1.3" xref="S4.SS1.p2.9.m3.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p2.9.m3.4.4.4.6" xref="S4.SS1.p2.9.m3.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p2.9.m3.2.2.2.2" xref="S4.SS1.p2.9.m3.2.2.2.2.cmml"><mi id="S4.SS1.p2.9.m3.2.2.2.2.2.2" xref="S4.SS1.p2.9.m3.2.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p2.9.m3.2.2.2.2.2.3" xref="S4.SS1.p2.9.m3.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p2.9.m3.2.2.2.2.3" xref="S4.SS1.p2.9.m3.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p2.9.m3.4.4.4.7" xref="S4.SS1.p2.9.m3.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p2.9.m3.3.3.3.3" xref="S4.SS1.p2.9.m3.3.3.3.3.cmml"><mi id="S4.SS1.p2.9.m3.3.3.3.3.2.2" xref="S4.SS1.p2.9.m3.3.3.3.3.2.2.cmml">z</mi><mn id="S4.SS1.p2.9.m3.3.3.3.3.2.3" xref="S4.SS1.p2.9.m3.3.3.3.3.2.3.cmml">3</mn><mi id="S4.SS1.p2.9.m3.3.3.3.3.3" xref="S4.SS1.p2.9.m3.3.3.3.3.3.cmml">k</mi></msubsup><mo id="S4.SS1.p2.9.m3.4.4.4.8" xref="S4.SS1.p2.9.m3.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p2.9.m3.4.4.4.4" xref="S4.SS1.p2.9.m3.4.4.4.4.cmml"><mi id="S4.SS1.p2.9.m3.4.4.4.4.2.2" xref="S4.SS1.p2.9.m3.4.4.4.4.2.2.cmml">z</mi><mn id="S4.SS1.p2.9.m3.4.4.4.4.2.3" xref="S4.SS1.p2.9.m3.4.4.4.4.2.3.cmml">4</mn><mi id="S4.SS1.p2.9.m3.4.4.4.4.3" xref="S4.SS1.p2.9.m3.4.4.4.4.3.cmml">k</mi></msubsup><mo id="S4.SS1.p2.9.m3.4.4.4.9" stretchy="false" xref="S4.SS1.p2.9.m3.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m3.4b"><vector id="S4.SS1.p2.9.m3.4.4.5.cmml" xref="S4.SS1.p2.9.m3.4.4.4"><apply id="S4.SS1.p2.9.m3.1.1.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.1.1.1.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.9.m3.1.1.1.1.2.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.9.m3.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1.2.2">𝑧</ci><cn id="S4.SS1.p2.9.m3.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p2.9.m3.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p2.9.m3.1.1.1.1.3.cmml" xref="S4.SS1.p2.9.m3.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p2.9.m3.2.2.2.2.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.2.2.2.2.1.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p2.9.m3.2.2.2.2.2.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.9.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p2.9.m3.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p2.9.m3.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS1.p2.9.m3.2.2.2.2.3.cmml" xref="S4.SS1.p2.9.m3.2.2.2.2.3">𝑘</ci></apply><apply id="S4.SS1.p2.9.m3.3.3.3.3.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.3.3.3.3.1.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3">superscript</csymbol><apply id="S4.SS1.p2.9.m3.3.3.3.3.2.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.3.3.3.3.2.1.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p2.9.m3.3.3.3.3.2.2.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3.2.2">𝑧</ci><cn id="S4.SS1.p2.9.m3.3.3.3.3.2.3.cmml" type="integer" xref="S4.SS1.p2.9.m3.3.3.3.3.2.3">3</cn></apply><ci id="S4.SS1.p2.9.m3.3.3.3.3.3.cmml" xref="S4.SS1.p2.9.m3.3.3.3.3.3">𝑘</ci></apply><apply id="S4.SS1.p2.9.m3.4.4.4.4.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.4.4.4.4.1.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4">superscript</csymbol><apply id="S4.SS1.p2.9.m3.4.4.4.4.2.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.4.4.4.4.2.1.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p2.9.m3.4.4.4.4.2.2.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4.2.2">𝑧</ci><cn id="S4.SS1.p2.9.m3.4.4.4.4.2.3.cmml" type="integer" xref="S4.SS1.p2.9.m3.4.4.4.4.2.3">4</cn></apply><ci id="S4.SS1.p2.9.m3.4.4.4.4.3.cmml" xref="S4.SS1.p2.9.m3.4.4.4.4.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m3.4c">(z_{1}^{k},z_{2}^{k},z_{3}^{k},z_{4}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m3.4d">( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math> and denote <math alttext="\mathcal{Z}_{t}=\{z_{t}^{k}\}_{k=1}^{b}" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m4.1"><semantics id="S4.SS1.p2.10.m4.1a"><mrow id="S4.SS1.p2.10.m4.1.1" xref="S4.SS1.p2.10.m4.1.1.cmml"><msub id="S4.SS1.p2.10.m4.1.1.3" xref="S4.SS1.p2.10.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.10.m4.1.1.3.2" xref="S4.SS1.p2.10.m4.1.1.3.2.cmml">𝒵</mi><mi id="S4.SS1.p2.10.m4.1.1.3.3" xref="S4.SS1.p2.10.m4.1.1.3.3.cmml">t</mi></msub><mo id="S4.SS1.p2.10.m4.1.1.2" xref="S4.SS1.p2.10.m4.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p2.10.m4.1.1.1" xref="S4.SS1.p2.10.m4.1.1.1.cmml"><mrow id="S4.SS1.p2.10.m4.1.1.1.1.1.1" xref="S4.SS1.p2.10.m4.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p2.10.m4.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.10.m4.1.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p2.10.m4.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.10.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.10.m4.1.1.1.1.3" xref="S4.SS1.p2.10.m4.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.10.m4.1.1.1.1.3.2" xref="S4.SS1.p2.10.m4.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p2.10.m4.1.1.1.1.3.1" xref="S4.SS1.p2.10.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p2.10.m4.1.1.1.1.3.3" xref="S4.SS1.p2.10.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.10.m4.1.1.1.3" xref="S4.SS1.p2.10.m4.1.1.1.3.cmml">b</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m4.1b"><apply id="S4.SS1.p2.10.m4.1.1.cmml" xref="S4.SS1.p2.10.m4.1.1"><eq id="S4.SS1.p2.10.m4.1.1.2.cmml" xref="S4.SS1.p2.10.m4.1.1.2"></eq><apply id="S4.SS1.p2.10.m4.1.1.3.cmml" xref="S4.SS1.p2.10.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m4.1.1.3.1.cmml" xref="S4.SS1.p2.10.m4.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.10.m4.1.1.3.2.cmml" xref="S4.SS1.p2.10.m4.1.1.3.2">𝒵</ci><ci id="S4.SS1.p2.10.m4.1.1.3.3.cmml" xref="S4.SS1.p2.10.m4.1.1.3.3">𝑡</ci></apply><apply id="S4.SS1.p2.10.m4.1.1.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m4.1.1.1.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.10.m4.1.1.1.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1">subscript</csymbol><set id="S4.SS1.p2.10.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1"><apply id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.p2.10.m4.1.1.1.1.3.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.3"><eq id="S4.SS1.p2.10.m4.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.3.1"></eq><ci id="S4.SS1.p2.10.m4.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.10.m4.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS1.p2.10.m4.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.10.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p2.10.m4.1.1.1.3.cmml" xref="S4.SS1.p2.10.m4.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m4.1c">\mathcal{Z}_{t}=\{z_{t}^{k}\}_{k=1}^{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.10.m4.1d">caligraphic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math>, then <math alttext="\mathbf{T}[\mathcal{I},:]" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m5.2"><semantics id="S4.SS1.p2.11.m5.2a"><mrow id="S4.SS1.p2.11.m5.2.3" xref="S4.SS1.p2.11.m5.2.3.cmml"><mi id="S4.SS1.p2.11.m5.2.3.2" xref="S4.SS1.p2.11.m5.2.3.2.cmml">𝐓</mi><mo id="S4.SS1.p2.11.m5.2.3.1" xref="S4.SS1.p2.11.m5.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p2.11.m5.2.3.3.2" xref="S4.SS1.p2.11.m5.2.3.3.1.cmml"><mo id="S4.SS1.p2.11.m5.2.3.3.2.1" stretchy="false" xref="S4.SS1.p2.11.m5.2.3.3.1.cmml">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.11.m5.1.1" xref="S4.SS1.p2.11.m5.1.1.cmml">ℐ</mi><mo id="S4.SS1.p2.11.m5.2.3.3.2.2" xref="S4.SS1.p2.11.m5.2.3.3.1.cmml">,</mo><mo id="S4.SS1.p2.11.m5.2.2" rspace="0em" xref="S4.SS1.p2.11.m5.2.2.cmml">:</mo><mo id="S4.SS1.p2.11.m5.2.3.3.2.3" stretchy="false" xref="S4.SS1.p2.11.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m5.2b"><apply id="S4.SS1.p2.11.m5.2.3.cmml" xref="S4.SS1.p2.11.m5.2.3"><times id="S4.SS1.p2.11.m5.2.3.1.cmml" xref="S4.SS1.p2.11.m5.2.3.1"></times><ci id="S4.SS1.p2.11.m5.2.3.2.cmml" xref="S4.SS1.p2.11.m5.2.3.2">𝐓</ci><interval closure="closed" id="S4.SS1.p2.11.m5.2.3.3.1.cmml" xref="S4.SS1.p2.11.m5.2.3.3.2"><ci id="S4.SS1.p2.11.m5.1.1.cmml" xref="S4.SS1.p2.11.m5.1.1">ℐ</ci><ci id="S4.SS1.p2.11.m5.2.2.cmml" xref="S4.SS1.p2.11.m5.2.2">:</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m5.2c">\mathbf{T}[\mathcal{I},:]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m5.2d">bold_T [ caligraphic_I , : ]</annotation></semantics></math> can be computed by contracting the tensors <math alttext="\{\mathbfcal{G}_{t}[:,\mathcal{Z}_{t},:,:]\}_{t=1}^{4}" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m6.1"><semantics id="S4.SS1.p2.12.m6.1a"><msubsup id="S4.SS1.p2.12.m6.1.1" xref="S4.SS1.p2.12.m6.1.1.cmml"><mrow id="S4.SS1.p2.12.m6.1.1.1.1.1" xref="S4.SS1.p2.12.m6.1.1.1.1.2.cmml"><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.12.m6.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.p2.12.m6.1.1.1.1.1.1" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.cmml"><msub id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.2" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.3.cmml">⊔</mi></msub><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.3.cmml">∪</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1a" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.4" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.4.cmml">¬</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1b" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.5" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.5.cmml">⇔</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1c" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.cmml"><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.2" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.2.cmml">𝒵</mi><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.3" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.3.cmml">⊔</mi></msub><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1d" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.7" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.7.cmml">⇔</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1e" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.8" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.8.cmml">¬</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1f" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.9" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.9.cmml">⇔</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1g" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.10" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.10.cmml">¬</mi><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1h" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.1.1.1.11" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.11.cmml">⊌</mi></mrow><mo id="S4.SS1.p2.12.m6.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.12.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.12.m6.1.1.1.3" xref="S4.SS1.p2.12.m6.1.1.1.3.cmml"><mi id="S4.SS1.p2.12.m6.1.1.1.3.2" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.3.2.cmml">⊔</mi><mo id="S4.SS1.p2.12.m6.1.1.1.3.1" xref="S4.SS1.p2.12.m6.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.3.3" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.3.3.cmml">ℑ</mi><mo id="S4.SS1.p2.12.m6.1.1.1.3.1a" xref="S4.SS1.p2.12.m6.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.12.m6.1.1.1.3.4" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.1.3.4.cmml">∞</mi></mrow><mi id="S4.SS1.p2.12.m6.1.1.3" mathvariant="normal" xref="S4.SS1.p2.12.m6.1.1.3.cmml">△</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m6.1b"><apply id="S4.SS1.p2.12.m6.1.1.cmml" xref="S4.SS1.p2.12.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m6.1.1.2.cmml" xref="S4.SS1.p2.12.m6.1.1">superscript</csymbol><apply id="S4.SS1.p2.12.m6.1.1.1.cmml" xref="S4.SS1.p2.12.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m6.1.1.1.2.cmml" xref="S4.SS1.p2.12.m6.1.1">subscript</csymbol><set id="S4.SS1.p2.12.m6.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1"><apply id="S4.SS1.p2.12.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1"><times id="S4.SS1.p2.12.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.1"></times><apply id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.2">𝒢</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.2.3">⊔</ci></apply><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.3">∪</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.4.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.4">¬</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.5.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.5">⇔</ci><apply id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.1.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6">subscript</csymbol><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.2.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.2">𝒵</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.3.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.6.3">⊔</ci></apply><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.7.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.7">⇔</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.8.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.8">¬</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.9.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.9">⇔</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.10.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.10">¬</ci><ci id="S4.SS1.p2.12.m6.1.1.1.1.1.1.11.cmml" xref="S4.SS1.p2.12.m6.1.1.1.1.1.1.11">⊌</ci></apply></set><apply id="S4.SS1.p2.12.m6.1.1.1.3.cmml" xref="S4.SS1.p2.12.m6.1.1.1.3"><times id="S4.SS1.p2.12.m6.1.1.1.3.1.cmml" xref="S4.SS1.p2.12.m6.1.1.1.3.1"></times><ci id="S4.SS1.p2.12.m6.1.1.1.3.2.cmml" xref="S4.SS1.p2.12.m6.1.1.1.3.2">⊔</ci><ci id="S4.SS1.p2.12.m6.1.1.1.3.3.cmml" xref="S4.SS1.p2.12.m6.1.1.1.3.3">ℑ</ci><ci id="S4.SS1.p2.12.m6.1.1.1.3.4.cmml" xref="S4.SS1.p2.12.m6.1.1.1.3.4">∞</ci></apply></apply><ci id="S4.SS1.p2.12.m6.1.1.3.cmml" xref="S4.SS1.p2.12.m6.1.1.3">△</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m6.1c">\{\mathbfcal{G}_{t}[:,\mathcal{Z}_{t},:,:]\}_{t=1}^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.12.m6.1d">{ roman_𝒢 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ∪ ¬ ⇔ roman_𝒵 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ⇔ ¬ ⇔ ¬ ⊌ } start_POSTSUBSCRIPT ⊔ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT △ end_POSTSUPERSCRIPT</annotation></semantics></math> where each has size <math alttext="r_{t-1}\times b\times n_{i}\times n_{t}" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m7.1"><semantics id="S4.SS1.p2.13.m7.1a"><mrow id="S4.SS1.p2.13.m7.1.1" xref="S4.SS1.p2.13.m7.1.1.cmml"><msub id="S4.SS1.p2.13.m7.1.1.2" xref="S4.SS1.p2.13.m7.1.1.2.cmml"><mi id="S4.SS1.p2.13.m7.1.1.2.2" xref="S4.SS1.p2.13.m7.1.1.2.2.cmml">r</mi><mrow id="S4.SS1.p2.13.m7.1.1.2.3" xref="S4.SS1.p2.13.m7.1.1.2.3.cmml"><mi id="S4.SS1.p2.13.m7.1.1.2.3.2" xref="S4.SS1.p2.13.m7.1.1.2.3.2.cmml">t</mi><mo id="S4.SS1.p2.13.m7.1.1.2.3.1" xref="S4.SS1.p2.13.m7.1.1.2.3.1.cmml">−</mo><mn id="S4.SS1.p2.13.m7.1.1.2.3.3" xref="S4.SS1.p2.13.m7.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.p2.13.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.13.m7.1.1.1.cmml">×</mo><mi id="S4.SS1.p2.13.m7.1.1.3" xref="S4.SS1.p2.13.m7.1.1.3.cmml">b</mi><mo id="S4.SS1.p2.13.m7.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.13.m7.1.1.1.cmml">×</mo><msub id="S4.SS1.p2.13.m7.1.1.4" xref="S4.SS1.p2.13.m7.1.1.4.cmml"><mi id="S4.SS1.p2.13.m7.1.1.4.2" xref="S4.SS1.p2.13.m7.1.1.4.2.cmml">n</mi><mi id="S4.SS1.p2.13.m7.1.1.4.3" xref="S4.SS1.p2.13.m7.1.1.4.3.cmml">i</mi></msub><mo id="S4.SS1.p2.13.m7.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.13.m7.1.1.1.cmml">×</mo><msub id="S4.SS1.p2.13.m7.1.1.5" xref="S4.SS1.p2.13.m7.1.1.5.cmml"><mi id="S4.SS1.p2.13.m7.1.1.5.2" xref="S4.SS1.p2.13.m7.1.1.5.2.cmml">n</mi><mi id="S4.SS1.p2.13.m7.1.1.5.3" xref="S4.SS1.p2.13.m7.1.1.5.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m7.1b"><apply id="S4.SS1.p2.13.m7.1.1.cmml" xref="S4.SS1.p2.13.m7.1.1"><times id="S4.SS1.p2.13.m7.1.1.1.cmml" xref="S4.SS1.p2.13.m7.1.1.1"></times><apply id="S4.SS1.p2.13.m7.1.1.2.cmml" xref="S4.SS1.p2.13.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m7.1.1.2.1.cmml" xref="S4.SS1.p2.13.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.13.m7.1.1.2.2.cmml" xref="S4.SS1.p2.13.m7.1.1.2.2">𝑟</ci><apply id="S4.SS1.p2.13.m7.1.1.2.3.cmml" xref="S4.SS1.p2.13.m7.1.1.2.3"><minus id="S4.SS1.p2.13.m7.1.1.2.3.1.cmml" xref="S4.SS1.p2.13.m7.1.1.2.3.1"></minus><ci id="S4.SS1.p2.13.m7.1.1.2.3.2.cmml" xref="S4.SS1.p2.13.m7.1.1.2.3.2">𝑡</ci><cn id="S4.SS1.p2.13.m7.1.1.2.3.3.cmml" type="integer" xref="S4.SS1.p2.13.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p2.13.m7.1.1.3.cmml" xref="S4.SS1.p2.13.m7.1.1.3">𝑏</ci><apply id="S4.SS1.p2.13.m7.1.1.4.cmml" xref="S4.SS1.p2.13.m7.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m7.1.1.4.1.cmml" xref="S4.SS1.p2.13.m7.1.1.4">subscript</csymbol><ci id="S4.SS1.p2.13.m7.1.1.4.2.cmml" xref="S4.SS1.p2.13.m7.1.1.4.2">𝑛</ci><ci id="S4.SS1.p2.13.m7.1.1.4.3.cmml" xref="S4.SS1.p2.13.m7.1.1.4.3">𝑖</ci></apply><apply id="S4.SS1.p2.13.m7.1.1.5.cmml" xref="S4.SS1.p2.13.m7.1.1.5"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m7.1.1.5.1.cmml" xref="S4.SS1.p2.13.m7.1.1.5">subscript</csymbol><ci id="S4.SS1.p2.13.m7.1.1.5.2.cmml" xref="S4.SS1.p2.13.m7.1.1.5.2">𝑛</ci><ci id="S4.SS1.p2.13.m7.1.1.5.3.cmml" xref="S4.SS1.p2.13.m7.1.1.5.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m7.1c">r_{t-1}\times b\times n_{i}\times n_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.13.m7.1d">italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT × italic_b × italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The <math alttext="\mathbfcal{G}_{t}[:,\mathcal{Z}_{t},:,:]" class="ltx_Math" display="inline" id="S4.SS1.p2.14.m8.1"><semantics id="S4.SS1.p2.14.m8.1a"><mrow id="S4.SS1.p2.14.m8.1.1" xref="S4.SS1.p2.14.m8.1.1.cmml"><msub id="S4.SS1.p2.14.m8.1.1.2" xref="S4.SS1.p2.14.m8.1.1.2.cmml"><mi id="S4.SS1.p2.14.m8.1.1.2.2" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS1.p2.14.m8.1.1.2.3" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.2.3.cmml">⊔</mi></msub><mo id="S4.SS1.p2.14.m8.1.1.1" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.3" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.3.cmml">∪</mi><mo id="S4.SS1.p2.14.m8.1.1.1a" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.4" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.4.cmml">¬</mi><mo id="S4.SS1.p2.14.m8.1.1.1b" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.5" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.5.cmml">⇔</mi><mo id="S4.SS1.p2.14.m8.1.1.1c" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><msub id="S4.SS1.p2.14.m8.1.1.6" xref="S4.SS1.p2.14.m8.1.1.6.cmml"><mi id="S4.SS1.p2.14.m8.1.1.6.2" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.6.2.cmml">𝒵</mi><mi id="S4.SS1.p2.14.m8.1.1.6.3" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.6.3.cmml">⊔</mi></msub><mo id="S4.SS1.p2.14.m8.1.1.1d" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.7" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.7.cmml">⇔</mi><mo id="S4.SS1.p2.14.m8.1.1.1e" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.8" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.8.cmml">¬</mi><mo id="S4.SS1.p2.14.m8.1.1.1f" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.9" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.9.cmml">⇔</mi><mo id="S4.SS1.p2.14.m8.1.1.1g" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.10" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.10.cmml">¬</mi><mo id="S4.SS1.p2.14.m8.1.1.1h" xref="S4.SS1.p2.14.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.14.m8.1.1.11" mathvariant="normal" xref="S4.SS1.p2.14.m8.1.1.11.cmml">⊌</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m8.1b"><apply id="S4.SS1.p2.14.m8.1.1.cmml" xref="S4.SS1.p2.14.m8.1.1"><times id="S4.SS1.p2.14.m8.1.1.1.cmml" xref="S4.SS1.p2.14.m8.1.1.1"></times><apply id="S4.SS1.p2.14.m8.1.1.2.cmml" xref="S4.SS1.p2.14.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m8.1.1.2.1.cmml" xref="S4.SS1.p2.14.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.14.m8.1.1.2.2.cmml" xref="S4.SS1.p2.14.m8.1.1.2.2">𝒢</ci><ci id="S4.SS1.p2.14.m8.1.1.2.3.cmml" xref="S4.SS1.p2.14.m8.1.1.2.3">⊔</ci></apply><ci id="S4.SS1.p2.14.m8.1.1.3.cmml" xref="S4.SS1.p2.14.m8.1.1.3">∪</ci><ci id="S4.SS1.p2.14.m8.1.1.4.cmml" xref="S4.SS1.p2.14.m8.1.1.4">¬</ci><ci id="S4.SS1.p2.14.m8.1.1.5.cmml" xref="S4.SS1.p2.14.m8.1.1.5">⇔</ci><apply id="S4.SS1.p2.14.m8.1.1.6.cmml" xref="S4.SS1.p2.14.m8.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m8.1.1.6.1.cmml" xref="S4.SS1.p2.14.m8.1.1.6">subscript</csymbol><ci id="S4.SS1.p2.14.m8.1.1.6.2.cmml" xref="S4.SS1.p2.14.m8.1.1.6.2">𝒵</ci><ci id="S4.SS1.p2.14.m8.1.1.6.3.cmml" xref="S4.SS1.p2.14.m8.1.1.6.3">⊔</ci></apply><ci id="S4.SS1.p2.14.m8.1.1.7.cmml" xref="S4.SS1.p2.14.m8.1.1.7">⇔</ci><ci id="S4.SS1.p2.14.m8.1.1.8.cmml" xref="S4.SS1.p2.14.m8.1.1.8">¬</ci><ci id="S4.SS1.p2.14.m8.1.1.9.cmml" xref="S4.SS1.p2.14.m8.1.1.9">⇔</ci><ci id="S4.SS1.p2.14.m8.1.1.10.cmml" xref="S4.SS1.p2.14.m8.1.1.10">¬</ci><ci id="S4.SS1.p2.14.m8.1.1.11.cmml" xref="S4.SS1.p2.14.m8.1.1.11">⊌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m8.1c">\mathbfcal{G}_{t}[:,\mathcal{Z}_{t},:,:]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.14.m8.1d">roman_𝒢 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ∪ ¬ ⇔ roman_𝒵 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ⇔ ¬ ⇔ ¬ ⊌</annotation></semantics></math> stores many duplicated values especially when the set <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S4.SS1.p2.15.m9.1"><semantics id="S4.SS1.p2.15.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.15.m9.1.1" xref="S4.SS1.p2.15.m9.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m9.1b"><ci id="S4.SS1.p2.15.m9.1.1.cmml" xref="S4.SS1.p2.15.m9.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m9.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.15.m9.1d">caligraphic_I</annotation></semantics></math> is large. Therefore, directly computing the tensor contractions can cause much computing and memory overhead.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.13">We optimize the tensor contraction by eliminating the redundant computation at two levels. <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.13.1">Row-index level.</span> We construct the index set <math alttext="\mathcal{I}_{u}=\{i_{k}\}_{k=1}^{\hat{b}}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><msub id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">ℐ</mi><mi id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">u</mi></msub><mo id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml"><mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p3.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.p3.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p3.1.m1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p3.1.m1.1.1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p3.1.m1.1.1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mover accent="true" id="S4.SS1.p3.1.m1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.1.3.2.cmml">b</mi><mo id="S4.SS1.p3.1.m1.1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.1.3.1.cmml">^</mo></mover></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"></eq><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">ℐ</ci><ci id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">𝑢</ci></apply><apply id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1">subscript</csymbol><set id="S4.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1"><apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.3"><eq id="S4.SS1.p3.1.m1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.3.1"></eq><ci id="S4.SS1.p3.1.m1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS1.p3.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.p3.1.m1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.3"><ci id="S4.SS1.p3.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.3.1">^</ci><ci id="S4.SS1.p3.1.m1.1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.3.2">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathcal{I}_{u}=\{i_{k}\}_{k=1}^{\hat{b}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">caligraphic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_b end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> containing all unique indices in <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">caligraphic_I</annotation></semantics></math>. We can easily obtain <math alttext="\mathbf{T}[\mathcal{I},:]" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.2"><semantics id="S4.SS1.p3.3.m3.2a"><mrow id="S4.SS1.p3.3.m3.2.3" xref="S4.SS1.p3.3.m3.2.3.cmml"><mi id="S4.SS1.p3.3.m3.2.3.2" xref="S4.SS1.p3.3.m3.2.3.2.cmml">𝐓</mi><mo id="S4.SS1.p3.3.m3.2.3.1" xref="S4.SS1.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.3.m3.2.3.3.2" xref="S4.SS1.p3.3.m3.2.3.3.1.cmml"><mo id="S4.SS1.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.3.1.cmml">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">ℐ</mi><mo id="S4.SS1.p3.3.m3.2.3.3.2.2" xref="S4.SS1.p3.3.m3.2.3.3.1.cmml">,</mo><mo id="S4.SS1.p3.3.m3.2.2" rspace="0em" xref="S4.SS1.p3.3.m3.2.2.cmml">:</mo><mo id="S4.SS1.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.2b"><apply id="S4.SS1.p3.3.m3.2.3.cmml" xref="S4.SS1.p3.3.m3.2.3"><times id="S4.SS1.p3.3.m3.2.3.1.cmml" xref="S4.SS1.p3.3.m3.2.3.1"></times><ci id="S4.SS1.p3.3.m3.2.3.2.cmml" xref="S4.SS1.p3.3.m3.2.3.2">𝐓</ci><interval closure="closed" id="S4.SS1.p3.3.m3.2.3.3.1.cmml" xref="S4.SS1.p3.3.m3.2.3.3.2"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">ℐ</ci><ci id="S4.SS1.p3.3.m3.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2">:</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.2c">\mathbf{T}[\mathcal{I},:]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.2d">bold_T [ caligraphic_I , : ]</annotation></semantics></math> from <math alttext="\mathbf{T}[\mathcal{I}_{u},:]" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.2"><semantics id="S4.SS1.p3.4.m4.2a"><mrow id="S4.SS1.p3.4.m4.2.2" xref="S4.SS1.p3.4.m4.2.2.cmml"><mi id="S4.SS1.p3.4.m4.2.2.3" xref="S4.SS1.p3.4.m4.2.2.3.cmml">𝐓</mi><mo id="S4.SS1.p3.4.m4.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.2.2.1.1" xref="S4.SS1.p3.4.m4.2.2.1.2.cmml"><mo id="S4.SS1.p3.4.m4.2.2.1.1.2" stretchy="false" xref="S4.SS1.p3.4.m4.2.2.1.2.cmml">[</mo><msub id="S4.SS1.p3.4.m4.2.2.1.1.1" xref="S4.SS1.p3.4.m4.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.4.m4.2.2.1.1.1.2" xref="S4.SS1.p3.4.m4.2.2.1.1.1.2.cmml">ℐ</mi><mi id="S4.SS1.p3.4.m4.2.2.1.1.1.3" xref="S4.SS1.p3.4.m4.2.2.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p3.4.m4.2.2.1.1.3" xref="S4.SS1.p3.4.m4.2.2.1.2.cmml">,</mo><mo id="S4.SS1.p3.4.m4.1.1" rspace="0em" xref="S4.SS1.p3.4.m4.1.1.cmml">:</mo><mo id="S4.SS1.p3.4.m4.2.2.1.1.4" stretchy="false" xref="S4.SS1.p3.4.m4.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.2b"><apply id="S4.SS1.p3.4.m4.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2"><times id="S4.SS1.p3.4.m4.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2"></times><ci id="S4.SS1.p3.4.m4.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.3">𝐓</ci><interval closure="closed" id="S4.SS1.p3.4.m4.2.2.1.2.cmml" xref="S4.SS1.p3.4.m4.2.2.1.1"><apply id="S4.SS1.p3.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.2.2.1.1.1.2">ℐ</ci><ci id="S4.SS1.p3.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS1.p3.4.m4.2.2.1.1.1.3">𝑢</ci></apply><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">:</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.2c">\mathbf{T}[\mathcal{I}_{u},:]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.2d">bold_T [ caligraphic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , : ]</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.13.2">Tensor-index level.</span> The reduced row index set <math alttext="\mathcal{I}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">ℐ</mi><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">ℐ</ci><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">\mathcal{I}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">caligraphic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> leads to <math alttext="\hat{b}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mover accent="true" id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">b</mi><mo id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><ci id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1">^</ci><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">\hat{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">over^ start_ARG italic_b end_ARG</annotation></semantics></math> associated tensor index vectors <math alttext="(z_{1}^{k},z_{2}^{k},z_{3}^{k},z_{4}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.4"><semantics id="S4.SS1.p3.7.m7.4a"><mrow id="S4.SS1.p3.7.m7.4.4.4" xref="S4.SS1.p3.7.m7.4.4.5.cmml"><mo id="S4.SS1.p3.7.m7.4.4.4.5" stretchy="false" xref="S4.SS1.p3.7.m7.4.4.5.cmml">(</mo><msubsup id="S4.SS1.p3.7.m7.1.1.1.1" xref="S4.SS1.p3.7.m7.1.1.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.1.1.2.2" xref="S4.SS1.p3.7.m7.1.1.1.1.2.2.cmml">z</mi><mn id="S4.SS1.p3.7.m7.1.1.1.1.2.3" xref="S4.SS1.p3.7.m7.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p3.7.m7.1.1.1.1.3" xref="S4.SS1.p3.7.m7.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.7.m7.4.4.4.6" xref="S4.SS1.p3.7.m7.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p3.7.m7.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p3.7.m7.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p3.7.m7.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.7.m7.4.4.4.7" xref="S4.SS1.p3.7.m7.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p3.7.m7.3.3.3.3" xref="S4.SS1.p3.7.m7.3.3.3.3.cmml"><mi id="S4.SS1.p3.7.m7.3.3.3.3.2.2" xref="S4.SS1.p3.7.m7.3.3.3.3.2.2.cmml">z</mi><mn id="S4.SS1.p3.7.m7.3.3.3.3.2.3" xref="S4.SS1.p3.7.m7.3.3.3.3.2.3.cmml">3</mn><mi id="S4.SS1.p3.7.m7.3.3.3.3.3" xref="S4.SS1.p3.7.m7.3.3.3.3.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.7.m7.4.4.4.8" xref="S4.SS1.p3.7.m7.4.4.5.cmml">,</mo><msubsup id="S4.SS1.p3.7.m7.4.4.4.4" xref="S4.SS1.p3.7.m7.4.4.4.4.cmml"><mi id="S4.SS1.p3.7.m7.4.4.4.4.2.2" xref="S4.SS1.p3.7.m7.4.4.4.4.2.2.cmml">z</mi><mn id="S4.SS1.p3.7.m7.4.4.4.4.2.3" xref="S4.SS1.p3.7.m7.4.4.4.4.2.3.cmml">4</mn><mi id="S4.SS1.p3.7.m7.4.4.4.4.3" xref="S4.SS1.p3.7.m7.4.4.4.4.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.7.m7.4.4.4.9" stretchy="false" xref="S4.SS1.p3.7.m7.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.4b"><vector id="S4.SS1.p3.7.m7.4.4.5.cmml" xref="S4.SS1.p3.7.m7.4.4.4"><apply id="S4.SS1.p3.7.m7.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.2.2">𝑧</ci><cn id="S4.SS1.p3.7.m7.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p3.7.m7.1.1.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS1.p3.7.m7.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.3">𝑘</ci></apply><apply id="S4.SS1.p3.7.m7.3.3.3.3.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.3.3.3.3.1.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3">superscript</csymbol><apply id="S4.SS1.p3.7.m7.3.3.3.3.2.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.3.3.3.3.2.1.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p3.7.m7.3.3.3.3.2.2.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3.2.2">𝑧</ci><cn id="S4.SS1.p3.7.m7.3.3.3.3.2.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.3.3.3.3.2.3">3</cn></apply><ci id="S4.SS1.p3.7.m7.3.3.3.3.3.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3.3">𝑘</ci></apply><apply id="S4.SS1.p3.7.m7.4.4.4.4.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.4.4.4.4.1.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4">superscript</csymbol><apply id="S4.SS1.p3.7.m7.4.4.4.4.2.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.4.4.4.4.2.1.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p3.7.m7.4.4.4.4.2.2.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4.2.2">𝑧</ci><cn id="S4.SS1.p3.7.m7.4.4.4.4.2.3.cmml" type="integer" xref="S4.SS1.p3.7.m7.4.4.4.4.2.3">4</cn></apply><ci id="S4.SS1.p3.7.m7.4.4.4.4.3.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.4c">(z_{1}^{k},z_{2}^{k},z_{3}^{k},z_{4}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.4d">( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math>, but at most <math alttext="m_{1}m_{2}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m8.1"><semantics id="S4.SS1.p3.8.m8.1a"><mrow id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><msub id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2.2" xref="S4.SS1.p3.8.m8.1.1.2.2.cmml">m</mi><mn id="S4.SS1.p3.8.m8.1.1.2.3" xref="S4.SS1.p3.8.m8.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p3.8.m8.1.1.1" xref="S4.SS1.p3.8.m8.1.1.1.cmml">⁢</mo><msub id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3.cmml"><mi id="S4.SS1.p3.8.m8.1.1.3.2" xref="S4.SS1.p3.8.m8.1.1.3.2.cmml">m</mi><mn id="S4.SS1.p3.8.m8.1.1.3.3" xref="S4.SS1.p3.8.m8.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><times id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1.1"></times><apply id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.2.1.cmml" xref="S4.SS1.p3.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2.2">𝑚</ci><cn id="S4.SS1.p3.8.m8.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.8.m8.1.1.2.3">1</cn></apply><apply id="S4.SS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.3.1.cmml" xref="S4.SS1.p3.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.3.2.cmml" xref="S4.SS1.p3.8.m8.1.1.3.2">𝑚</ci><cn id="S4.SS1.p3.8.m8.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.8.m8.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">m_{1}m_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m8.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> pairs of <math alttext="(z_{1}^{k},z_{2}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p3.9.m9.2"><semantics id="S4.SS1.p3.9.m9.2a"><mrow id="S4.SS1.p3.9.m9.2.2.2" xref="S4.SS1.p3.9.m9.2.2.3.cmml"><mo id="S4.SS1.p3.9.m9.2.2.2.3" stretchy="false" xref="S4.SS1.p3.9.m9.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.9.m9.1.1.1.1" xref="S4.SS1.p3.9.m9.1.1.1.1.cmml"><mi id="S4.SS1.p3.9.m9.1.1.1.1.2.2" xref="S4.SS1.p3.9.m9.1.1.1.1.2.2.cmml">z</mi><mn id="S4.SS1.p3.9.m9.1.1.1.1.2.3" xref="S4.SS1.p3.9.m9.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p3.9.m9.1.1.1.1.3" xref="S4.SS1.p3.9.m9.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.9.m9.2.2.2.4" xref="S4.SS1.p3.9.m9.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.9.m9.2.2.2.2" xref="S4.SS1.p3.9.m9.2.2.2.2.cmml"><mi id="S4.SS1.p3.9.m9.2.2.2.2.2.2" xref="S4.SS1.p3.9.m9.2.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p3.9.m9.2.2.2.2.2.3" xref="S4.SS1.p3.9.m9.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p3.9.m9.2.2.2.2.3" xref="S4.SS1.p3.9.m9.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.9.m9.2.2.2.5" stretchy="false" xref="S4.SS1.p3.9.m9.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m9.2b"><interval closure="open" id="S4.SS1.p3.9.m9.2.2.3.cmml" xref="S4.SS1.p3.9.m9.2.2.2"><apply id="S4.SS1.p3.9.m9.1.1.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m9.1.1.1.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.9.m9.1.1.1.1.2.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m9.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m9.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1.2.2">𝑧</ci><cn id="S4.SS1.p3.9.m9.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.9.m9.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p3.9.m9.1.1.1.1.3.cmml" xref="S4.SS1.p3.9.m9.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p3.9.m9.2.2.2.2.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m9.2.2.2.2.1.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.9.m9.2.2.2.2.2.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m9.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.9.m9.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p3.9.m9.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.9.m9.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS1.p3.9.m9.2.2.2.2.3.cmml" xref="S4.SS1.p3.9.m9.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m9.2c">(z_{1}^{k},z_{2}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.9.m9.2d">( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="m_{3}m_{4}" class="ltx_Math" display="inline" id="S4.SS1.p3.10.m10.1"><semantics id="S4.SS1.p3.10.m10.1a"><mrow id="S4.SS1.p3.10.m10.1.1" xref="S4.SS1.p3.10.m10.1.1.cmml"><msub id="S4.SS1.p3.10.m10.1.1.2" xref="S4.SS1.p3.10.m10.1.1.2.cmml"><mi id="S4.SS1.p3.10.m10.1.1.2.2" xref="S4.SS1.p3.10.m10.1.1.2.2.cmml">m</mi><mn id="S4.SS1.p3.10.m10.1.1.2.3" xref="S4.SS1.p3.10.m10.1.1.2.3.cmml">3</mn></msub><mo id="S4.SS1.p3.10.m10.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.cmml">⁢</mo><msub id="S4.SS1.p3.10.m10.1.1.3" xref="S4.SS1.p3.10.m10.1.1.3.cmml"><mi id="S4.SS1.p3.10.m10.1.1.3.2" xref="S4.SS1.p3.10.m10.1.1.3.2.cmml">m</mi><mn id="S4.SS1.p3.10.m10.1.1.3.3" xref="S4.SS1.p3.10.m10.1.1.3.3.cmml">4</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m10.1b"><apply id="S4.SS1.p3.10.m10.1.1.cmml" xref="S4.SS1.p3.10.m10.1.1"><times id="S4.SS1.p3.10.m10.1.1.1.cmml" xref="S4.SS1.p3.10.m10.1.1.1"></times><apply id="S4.SS1.p3.10.m10.1.1.2.cmml" xref="S4.SS1.p3.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.2.1.cmml" xref="S4.SS1.p3.10.m10.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.10.m10.1.1.2.2.cmml" xref="S4.SS1.p3.10.m10.1.1.2.2">𝑚</ci><cn id="S4.SS1.p3.10.m10.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.10.m10.1.1.2.3">3</cn></apply><apply id="S4.SS1.p3.10.m10.1.1.3.cmml" xref="S4.SS1.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.3.1.cmml" xref="S4.SS1.p3.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.10.m10.1.1.3.2.cmml" xref="S4.SS1.p3.10.m10.1.1.3.2">𝑚</ci><cn id="S4.SS1.p3.10.m10.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.10.m10.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m10.1c">m_{3}m_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.10.m10.1d">italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> pairs of <math alttext="(z_{3}^{k},z_{4}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p3.11.m11.2"><semantics id="S4.SS1.p3.11.m11.2a"><mrow id="S4.SS1.p3.11.m11.2.2.2" xref="S4.SS1.p3.11.m11.2.2.3.cmml"><mo id="S4.SS1.p3.11.m11.2.2.2.3" stretchy="false" xref="S4.SS1.p3.11.m11.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.11.m11.1.1.1.1" xref="S4.SS1.p3.11.m11.1.1.1.1.cmml"><mi id="S4.SS1.p3.11.m11.1.1.1.1.2.2" xref="S4.SS1.p3.11.m11.1.1.1.1.2.2.cmml">z</mi><mn id="S4.SS1.p3.11.m11.1.1.1.1.2.3" xref="S4.SS1.p3.11.m11.1.1.1.1.2.3.cmml">3</mn><mi id="S4.SS1.p3.11.m11.1.1.1.1.3" xref="S4.SS1.p3.11.m11.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.11.m11.2.2.2.4" xref="S4.SS1.p3.11.m11.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.11.m11.2.2.2.2" xref="S4.SS1.p3.11.m11.2.2.2.2.cmml"><mi id="S4.SS1.p3.11.m11.2.2.2.2.2.2" xref="S4.SS1.p3.11.m11.2.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p3.11.m11.2.2.2.2.2.3" xref="S4.SS1.p3.11.m11.2.2.2.2.2.3.cmml">4</mn><mi id="S4.SS1.p3.11.m11.2.2.2.2.3" xref="S4.SS1.p3.11.m11.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.11.m11.2.2.2.5" stretchy="false" xref="S4.SS1.p3.11.m11.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m11.2b"><interval closure="open" id="S4.SS1.p3.11.m11.2.2.3.cmml" xref="S4.SS1.p3.11.m11.2.2.2"><apply id="S4.SS1.p3.11.m11.1.1.1.1.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m11.1.1.1.1.1.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.11.m11.1.1.1.1.2.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m11.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.11.m11.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1.2.2">𝑧</ci><cn id="S4.SS1.p3.11.m11.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.11.m11.1.1.1.1.2.3">3</cn></apply><ci id="S4.SS1.p3.11.m11.1.1.1.1.3.cmml" xref="S4.SS1.p3.11.m11.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p3.11.m11.2.2.2.2.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m11.2.2.2.2.1.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.11.m11.2.2.2.2.2.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m11.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.11.m11.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p3.11.m11.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.11.m11.2.2.2.2.2.3">4</cn></apply><ci id="S4.SS1.p3.11.m11.2.2.2.2.3.cmml" xref="S4.SS1.p3.11.m11.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m11.2c">(z_{3}^{k},z_{4}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.11.m11.2d">( italic_z start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math> are unique. Therefore, we can consider all unique pairs <math alttext="(z_{1}^{k},z_{2}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p3.12.m12.2"><semantics id="S4.SS1.p3.12.m12.2a"><mrow id="S4.SS1.p3.12.m12.2.2.2" xref="S4.SS1.p3.12.m12.2.2.3.cmml"><mo id="S4.SS1.p3.12.m12.2.2.2.3" stretchy="false" xref="S4.SS1.p3.12.m12.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.12.m12.1.1.1.1" xref="S4.SS1.p3.12.m12.1.1.1.1.cmml"><mi id="S4.SS1.p3.12.m12.1.1.1.1.2.2" xref="S4.SS1.p3.12.m12.1.1.1.1.2.2.cmml">z</mi><mn id="S4.SS1.p3.12.m12.1.1.1.1.2.3" xref="S4.SS1.p3.12.m12.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p3.12.m12.1.1.1.1.3" xref="S4.SS1.p3.12.m12.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.12.m12.2.2.2.4" xref="S4.SS1.p3.12.m12.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.12.m12.2.2.2.2" xref="S4.SS1.p3.12.m12.2.2.2.2.cmml"><mi id="S4.SS1.p3.12.m12.2.2.2.2.2.2" xref="S4.SS1.p3.12.m12.2.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p3.12.m12.2.2.2.2.2.3" xref="S4.SS1.p3.12.m12.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p3.12.m12.2.2.2.2.3" xref="S4.SS1.p3.12.m12.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.12.m12.2.2.2.5" stretchy="false" xref="S4.SS1.p3.12.m12.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m12.2b"><interval closure="open" id="S4.SS1.p3.12.m12.2.2.3.cmml" xref="S4.SS1.p3.12.m12.2.2.2"><apply id="S4.SS1.p3.12.m12.1.1.1.1.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m12.1.1.1.1.1.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.12.m12.1.1.1.1.2.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m12.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.12.m12.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1.2.2">𝑧</ci><cn id="S4.SS1.p3.12.m12.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.12.m12.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p3.12.m12.1.1.1.1.3.cmml" xref="S4.SS1.p3.12.m12.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p3.12.m12.2.2.2.2.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m12.2.2.2.2.1.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.12.m12.2.2.2.2.2.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m12.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.12.m12.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p3.12.m12.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.12.m12.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS1.p3.12.m12.2.2.2.2.3.cmml" xref="S4.SS1.p3.12.m12.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m12.2c">(z_{1}^{k},z_{2}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.12.m12.2d">( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="(z_{3},z_{4})" class="ltx_Math" display="inline" id="S4.SS1.p3.13.m13.2"><semantics id="S4.SS1.p3.13.m13.2a"><mrow id="S4.SS1.p3.13.m13.2.2.2" xref="S4.SS1.p3.13.m13.2.2.3.cmml"><mo id="S4.SS1.p3.13.m13.2.2.2.3" stretchy="false" xref="S4.SS1.p3.13.m13.2.2.3.cmml">(</mo><msub id="S4.SS1.p3.13.m13.1.1.1.1" xref="S4.SS1.p3.13.m13.1.1.1.1.cmml"><mi id="S4.SS1.p3.13.m13.1.1.1.1.2" xref="S4.SS1.p3.13.m13.1.1.1.1.2.cmml">z</mi><mn id="S4.SS1.p3.13.m13.1.1.1.1.3" xref="S4.SS1.p3.13.m13.1.1.1.1.3.cmml">3</mn></msub><mo id="S4.SS1.p3.13.m13.2.2.2.4" xref="S4.SS1.p3.13.m13.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.13.m13.2.2.2.2" xref="S4.SS1.p3.13.m13.2.2.2.2.cmml"><mi id="S4.SS1.p3.13.m13.2.2.2.2.2" xref="S4.SS1.p3.13.m13.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p3.13.m13.2.2.2.2.3" xref="S4.SS1.p3.13.m13.2.2.2.2.3.cmml">4</mn></msub><mo id="S4.SS1.p3.13.m13.2.2.2.5" stretchy="false" xref="S4.SS1.p3.13.m13.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.13.m13.2b"><interval closure="open" id="S4.SS1.p3.13.m13.2.2.3.cmml" xref="S4.SS1.p3.13.m13.2.2.2"><apply id="S4.SS1.p3.13.m13.1.1.1.1.cmml" xref="S4.SS1.p3.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m13.1.1.1.1.1.cmml" xref="S4.SS1.p3.13.m13.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.13.m13.1.1.1.1.2.cmml" xref="S4.SS1.p3.13.m13.1.1.1.1.2">𝑧</ci><cn id="S4.SS1.p3.13.m13.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.13.m13.1.1.1.1.3">3</cn></apply><apply id="S4.SS1.p3.13.m13.2.2.2.2.cmml" xref="S4.SS1.p3.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m13.2.2.2.2.1.cmml" xref="S4.SS1.p3.13.m13.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.13.m13.2.2.2.2.2.cmml" xref="S4.SS1.p3.13.m13.2.2.2.2.2">𝑧</ci><cn id="S4.SS1.p3.13.m13.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.13.m13.2.2.2.2.3">4</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.13.m13.2c">(z_{3},z_{4})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.13.m13.2d">( italic_z start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT )</annotation></semantics></math> and compute</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S4.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{A}_{1}=" class="ltx_Math" display="inline" id="S4.E16.m1.1"><semantics id="S4.E16.m1.1a"><mrow id="S4.E16.m1.1.1" xref="S4.E16.m1.1.1.cmml"><msub id="S4.E16.m1.1.1.2" xref="S4.E16.m1.1.1.2.cmml"><mi id="S4.E16.m1.1.1.2.2" mathvariant="normal" xref="S4.E16.m1.1.1.2.2.cmml">𝒜</mi><mi id="S4.E16.m1.1.1.2.3" mathvariant="normal" xref="S4.E16.m1.1.1.2.3.cmml">∞</mi></msub><mo id="S4.E16.m1.1.1.1" xref="S4.E16.m1.1.1.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.3" mathvariant="normal" xref="S4.E16.m1.1.1.3.cmml">ℑ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.1b"><apply id="S4.E16.m1.1.1.cmml" xref="S4.E16.m1.1.1"><times id="S4.E16.m1.1.1.1.cmml" xref="S4.E16.m1.1.1.1"></times><apply id="S4.E16.m1.1.1.2.cmml" xref="S4.E16.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.2">subscript</csymbol><ci id="S4.E16.m1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.2.2">𝒜</ci><ci id="S4.E16.m1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.2.3">∞</ci></apply><ci id="S4.E16.m1.1.1.3.cmml" xref="S4.E16.m1.1.1.3">ℑ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.1c">\displaystyle\mathbfcal{A}_{1}=</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.1d">roman_𝒜 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT roman_ℑ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(r_{0}m_{1}n_{1}r_{1},r_{1}m_{2}n_{2}r_{2}%
\Rightarrow(m_{1}m_{2})(n_{1}n_{2})r_{2},[\mathbfcal{G}_{1},\mathbfcal{G}_{2}])," class="ltx_math_unparsed" display="inline" id="S4.E16.m2.1"><semantics id="S4.E16.m2.1a"><mrow id="S4.E16.m2.1b"><mtext class="ltx_mathvariant_bold" id="S4.E16.m2.1.1">einsum</mtext><mrow id="S4.E16.m2.1.2"><mo id="S4.E16.m2.1.2.1" stretchy="false">(</mo><msub id="S4.E16.m2.1.2.2"><mi id="S4.E16.m2.1.2.2.2">r</mi><mn id="S4.E16.m2.1.2.2.3">0</mn></msub><msub id="S4.E16.m2.1.2.3"><mi id="S4.E16.m2.1.2.3.2">m</mi><mn id="S4.E16.m2.1.2.3.3">1</mn></msub><msub id="S4.E16.m2.1.2.4"><mi id="S4.E16.m2.1.2.4.2">n</mi><mn id="S4.E16.m2.1.2.4.3">1</mn></msub><msub id="S4.E16.m2.1.2.5"><mi id="S4.E16.m2.1.2.5.2">r</mi><mn id="S4.E16.m2.1.2.5.3">1</mn></msub><mo id="S4.E16.m2.1.2.6">,</mo><msub id="S4.E16.m2.1.2.7"><mi id="S4.E16.m2.1.2.7.2">r</mi><mn id="S4.E16.m2.1.2.7.3">1</mn></msub><msub id="S4.E16.m2.1.2.8"><mi id="S4.E16.m2.1.2.8.2">m</mi><mn id="S4.E16.m2.1.2.8.3">2</mn></msub><msub id="S4.E16.m2.1.2.9"><mi id="S4.E16.m2.1.2.9.2">n</mi><mn id="S4.E16.m2.1.2.9.3">2</mn></msub><msub id="S4.E16.m2.1.2.10"><mi id="S4.E16.m2.1.2.10.2">r</mi><mn id="S4.E16.m2.1.2.10.3">2</mn></msub><mo id="S4.E16.m2.1.2.11" stretchy="false">⇒</mo><mrow id="S4.E16.m2.1.2.12"><mo id="S4.E16.m2.1.2.12.1" stretchy="false">(</mo><msub id="S4.E16.m2.1.2.12.2"><mi id="S4.E16.m2.1.2.12.2.2">m</mi><mn id="S4.E16.m2.1.2.12.2.3">1</mn></msub><msub id="S4.E16.m2.1.2.12.3"><mi id="S4.E16.m2.1.2.12.3.2">m</mi><mn id="S4.E16.m2.1.2.12.3.3">2</mn></msub><mo id="S4.E16.m2.1.2.12.4" stretchy="false">)</mo></mrow><mrow id="S4.E16.m2.1.2.13"><mo id="S4.E16.m2.1.2.13.1" stretchy="false">(</mo><msub id="S4.E16.m2.1.2.13.2"><mi id="S4.E16.m2.1.2.13.2.2">n</mi><mn id="S4.E16.m2.1.2.13.2.3">1</mn></msub><msub id="S4.E16.m2.1.2.13.3"><mi id="S4.E16.m2.1.2.13.3.2">n</mi><mn id="S4.E16.m2.1.2.13.3.3">2</mn></msub><mo id="S4.E16.m2.1.2.13.4" stretchy="false">)</mo></mrow><msub id="S4.E16.m2.1.2.14"><mi id="S4.E16.m2.1.2.14.2">r</mi><mn id="S4.E16.m2.1.2.14.3">2</mn></msub><mo id="S4.E16.m2.1.2.15">,</mo><mrow id="S4.E16.m2.1.2.16"><mo id="S4.E16.m2.1.2.16.1" stretchy="false">[</mo><msub id="S4.E16.m2.1.2.16.2"><mi id="S4.E16.m2.1.2.16.2.2" mathvariant="normal">𝒢</mi><mi id="S4.E16.m2.1.2.16.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E16.m2.1.2.16.3" mathvariant="normal">⇔</mi><msub id="S4.E16.m2.1.2.16.4"><mi id="S4.E16.m2.1.2.16.4.2" mathvariant="normal">𝒢</mi><mi id="S4.E16.m2.1.2.16.4.3" mathvariant="normal">∈</mi></msub><mi id="S4.E16.m2.1.2.16.5" mathvariant="normal">⊌</mi><mi id="S4.E16.m2.1.2.16.6" mathvariant="normal">⇒</mi><mi id="S4.E16.m2.1.2.16.7" mathvariant="normal">⇔</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E16.m2.1c">\displaystyle\mbox{\bf einsum}(r_{0}m_{1}n_{1}r_{1},r_{1}m_{2}n_{2}r_{2}%
\Rightarrow(m_{1}m_{2})(n_{1}n_{2})r_{2},[\mathbfcal{G}_{1},\mathbfcal{G}_{2}]),</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m2.1d">einsum ( italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⇒ ( italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , [ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⊌ ⇒ ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S4.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{A}_{2}=" class="ltx_Math" display="inline" id="S4.E17.m1.1"><semantics id="S4.E17.m1.1a"><mrow id="S4.E17.m1.1.1" xref="S4.E17.m1.1.1.cmml"><msub id="S4.E17.m1.1.1.2" xref="S4.E17.m1.1.1.2.cmml"><mi id="S4.E17.m1.1.1.2.2" mathvariant="normal" xref="S4.E17.m1.1.1.2.2.cmml">𝒜</mi><mi id="S4.E17.m1.1.1.2.3" mathvariant="normal" xref="S4.E17.m1.1.1.2.3.cmml">∈</mi></msub><mo id="S4.E17.m1.1.1.1" xref="S4.E17.m1.1.1.1.cmml">⁢</mo><mi id="S4.E17.m1.1.1.3" mathvariant="normal" xref="S4.E17.m1.1.1.3.cmml">ℑ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.1b"><apply id="S4.E17.m1.1.1.cmml" xref="S4.E17.m1.1.1"><times id="S4.E17.m1.1.1.1.cmml" xref="S4.E17.m1.1.1.1"></times><apply id="S4.E17.m1.1.1.2.cmml" xref="S4.E17.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.2.1.cmml" xref="S4.E17.m1.1.1.2">subscript</csymbol><ci id="S4.E17.m1.1.1.2.2.cmml" xref="S4.E17.m1.1.1.2.2">𝒜</ci><ci id="S4.E17.m1.1.1.2.3.cmml" xref="S4.E17.m1.1.1.2.3">∈</ci></apply><ci id="S4.E17.m1.1.1.3.cmml" xref="S4.E17.m1.1.1.3">ℑ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.1c">\displaystyle\mathbfcal{A}_{2}=</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.1d">roman_𝒜 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT roman_ℑ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(r_{2}m_{3}n_{3}r_{3},r_{3}m_{4}n_{4}r_{4}%
\Rightarrow r_{2}(m_{3}m_{4})(n_{3}n_{4}),[\mathbfcal{G}_{3},\mathbfcal{G}_{4}%
])." class="ltx_math_unparsed" display="inline" id="S4.E17.m2.1"><semantics id="S4.E17.m2.1a"><mrow id="S4.E17.m2.1b"><mtext class="ltx_mathvariant_bold" id="S4.E17.m2.1.1">einsum</mtext><mrow id="S4.E17.m2.1.2"><mo id="S4.E17.m2.1.2.1" stretchy="false">(</mo><msub id="S4.E17.m2.1.2.2"><mi id="S4.E17.m2.1.2.2.2">r</mi><mn id="S4.E17.m2.1.2.2.3">2</mn></msub><msub id="S4.E17.m2.1.2.3"><mi id="S4.E17.m2.1.2.3.2">m</mi><mn id="S4.E17.m2.1.2.3.3">3</mn></msub><msub id="S4.E17.m2.1.2.4"><mi id="S4.E17.m2.1.2.4.2">n</mi><mn id="S4.E17.m2.1.2.4.3">3</mn></msub><msub id="S4.E17.m2.1.2.5"><mi id="S4.E17.m2.1.2.5.2">r</mi><mn id="S4.E17.m2.1.2.5.3">3</mn></msub><mo id="S4.E17.m2.1.2.6">,</mo><msub id="S4.E17.m2.1.2.7"><mi id="S4.E17.m2.1.2.7.2">r</mi><mn id="S4.E17.m2.1.2.7.3">3</mn></msub><msub id="S4.E17.m2.1.2.8"><mi id="S4.E17.m2.1.2.8.2">m</mi><mn id="S4.E17.m2.1.2.8.3">4</mn></msub><msub id="S4.E17.m2.1.2.9"><mi id="S4.E17.m2.1.2.9.2">n</mi><mn id="S4.E17.m2.1.2.9.3">4</mn></msub><msub id="S4.E17.m2.1.2.10"><mi id="S4.E17.m2.1.2.10.2">r</mi><mn id="S4.E17.m2.1.2.10.3">4</mn></msub><mo id="S4.E17.m2.1.2.11" stretchy="false">⇒</mo><msub id="S4.E17.m2.1.2.12"><mi id="S4.E17.m2.1.2.12.2">r</mi><mn id="S4.E17.m2.1.2.12.3">2</mn></msub><mrow id="S4.E17.m2.1.2.13"><mo id="S4.E17.m2.1.2.13.1" stretchy="false">(</mo><msub id="S4.E17.m2.1.2.13.2"><mi id="S4.E17.m2.1.2.13.2.2">m</mi><mn id="S4.E17.m2.1.2.13.2.3">3</mn></msub><msub id="S4.E17.m2.1.2.13.3"><mi id="S4.E17.m2.1.2.13.3.2">m</mi><mn id="S4.E17.m2.1.2.13.3.3">4</mn></msub><mo id="S4.E17.m2.1.2.13.4" stretchy="false">)</mo></mrow><mrow id="S4.E17.m2.1.2.14"><mo id="S4.E17.m2.1.2.14.1" stretchy="false">(</mo><msub id="S4.E17.m2.1.2.14.2"><mi id="S4.E17.m2.1.2.14.2.2">n</mi><mn id="S4.E17.m2.1.2.14.2.3">3</mn></msub><msub id="S4.E17.m2.1.2.14.3"><mi id="S4.E17.m2.1.2.14.3.2">n</mi><mn id="S4.E17.m2.1.2.14.3.3">4</mn></msub><mo id="S4.E17.m2.1.2.14.4" stretchy="false">)</mo></mrow><mo id="S4.E17.m2.1.2.15">,</mo><mrow id="S4.E17.m2.1.2.16"><mo id="S4.E17.m2.1.2.16.1" stretchy="false">[</mo><msub id="S4.E17.m2.1.2.16.2"><mi id="S4.E17.m2.1.2.16.2.2" mathvariant="normal">𝒢</mi><mi id="S4.E17.m2.1.2.16.2.3" mathvariant="normal">∋</mi></msub><mi id="S4.E17.m2.1.2.16.3" mathvariant="normal">⇔</mi><msub id="S4.E17.m2.1.2.16.4"><mi id="S4.E17.m2.1.2.16.4.2" mathvariant="normal">𝒢</mi><mi id="S4.E17.m2.1.2.16.4.3" mathvariant="normal">△</mi></msub><mi id="S4.E17.m2.1.2.16.5" mathvariant="normal">⊌</mi><mi id="S4.E17.m2.1.2.16.6" mathvariant="normal">⇒</mi><mi id="S4.E17.m2.1.2.16.7" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E17.m2.1c">\displaystyle\mbox{\bf einsum}(r_{2}m_{3}n_{3}r_{3},r_{3}m_{4}n_{4}r_{4}%
\Rightarrow r_{2}(m_{3}m_{4})(n_{3}n_{4}),[\mathbfcal{G}_{3},\mathbfcal{G}_{4}%
]).</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m2.1d">einsum ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ⇒ italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) ( italic_n start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) , [ roman_𝒢 start_POSTSUBSCRIPT ∋ end_POSTSUBSCRIPT ⇔ roman_𝒢 start_POSTSUBSCRIPT △ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.20">For each <math alttext="i_{k}\in\mathcal{I}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.14.m1.1"><semantics id="S4.SS1.p3.14.m1.1a"><mrow id="S4.SS1.p3.14.m1.1.1" xref="S4.SS1.p3.14.m1.1.1.cmml"><msub id="S4.SS1.p3.14.m1.1.1.2" xref="S4.SS1.p3.14.m1.1.1.2.cmml"><mi id="S4.SS1.p3.14.m1.1.1.2.2" xref="S4.SS1.p3.14.m1.1.1.2.2.cmml">i</mi><mi id="S4.SS1.p3.14.m1.1.1.2.3" xref="S4.SS1.p3.14.m1.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p3.14.m1.1.1.1" xref="S4.SS1.p3.14.m1.1.1.1.cmml">∈</mo><msub id="S4.SS1.p3.14.m1.1.1.3" xref="S4.SS1.p3.14.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.14.m1.1.1.3.2" xref="S4.SS1.p3.14.m1.1.1.3.2.cmml">ℐ</mi><mi id="S4.SS1.p3.14.m1.1.1.3.3" xref="S4.SS1.p3.14.m1.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.14.m1.1b"><apply id="S4.SS1.p3.14.m1.1.1.cmml" xref="S4.SS1.p3.14.m1.1.1"><in id="S4.SS1.p3.14.m1.1.1.1.cmml" xref="S4.SS1.p3.14.m1.1.1.1"></in><apply id="S4.SS1.p3.14.m1.1.1.2.cmml" xref="S4.SS1.p3.14.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.14.m1.1.1.2.1.cmml" xref="S4.SS1.p3.14.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.14.m1.1.1.2.2.cmml" xref="S4.SS1.p3.14.m1.1.1.2.2">𝑖</ci><ci id="S4.SS1.p3.14.m1.1.1.2.3.cmml" xref="S4.SS1.p3.14.m1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p3.14.m1.1.1.3.cmml" xref="S4.SS1.p3.14.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.14.m1.1.1.3.1.cmml" xref="S4.SS1.p3.14.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.14.m1.1.1.3.2.cmml" xref="S4.SS1.p3.14.m1.1.1.3.2">ℐ</ci><ci id="S4.SS1.p3.14.m1.1.1.3.3.cmml" xref="S4.SS1.p3.14.m1.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.14.m1.1c">i_{k}\in\mathcal{I}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.14.m1.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, let <math alttext="(j_{1}^{k},j_{2}^{k})" class="ltx_Math" display="inline" id="S4.SS1.p3.15.m2.2"><semantics id="S4.SS1.p3.15.m2.2a"><mrow id="S4.SS1.p3.15.m2.2.2.2" xref="S4.SS1.p3.15.m2.2.2.3.cmml"><mo id="S4.SS1.p3.15.m2.2.2.2.3" stretchy="false" xref="S4.SS1.p3.15.m2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.15.m2.1.1.1.1" xref="S4.SS1.p3.15.m2.1.1.1.1.cmml"><mi id="S4.SS1.p3.15.m2.1.1.1.1.2.2" xref="S4.SS1.p3.15.m2.1.1.1.1.2.2.cmml">j</mi><mn id="S4.SS1.p3.15.m2.1.1.1.1.2.3" xref="S4.SS1.p3.15.m2.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p3.15.m2.1.1.1.1.3" xref="S4.SS1.p3.15.m2.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.15.m2.2.2.2.4" xref="S4.SS1.p3.15.m2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.15.m2.2.2.2.2" xref="S4.SS1.p3.15.m2.2.2.2.2.cmml"><mi id="S4.SS1.p3.15.m2.2.2.2.2.2.2" xref="S4.SS1.p3.15.m2.2.2.2.2.2.2.cmml">j</mi><mn id="S4.SS1.p3.15.m2.2.2.2.2.2.3" xref="S4.SS1.p3.15.m2.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p3.15.m2.2.2.2.2.3" xref="S4.SS1.p3.15.m2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.15.m2.2.2.2.5" stretchy="false" xref="S4.SS1.p3.15.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.15.m2.2b"><interval closure="open" id="S4.SS1.p3.15.m2.2.2.3.cmml" xref="S4.SS1.p3.15.m2.2.2.2"><apply id="S4.SS1.p3.15.m2.1.1.1.1.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m2.1.1.1.1.1.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.15.m2.1.1.1.1.2.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m2.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.15.m2.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1.2.2">𝑗</ci><cn id="S4.SS1.p3.15.m2.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.15.m2.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p3.15.m2.1.1.1.1.3.cmml" xref="S4.SS1.p3.15.m2.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p3.15.m2.2.2.2.2.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m2.2.2.2.2.1.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.15.m2.2.2.2.2.2.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.15.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2.2.2">𝑗</ci><cn id="S4.SS1.p3.15.m2.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.15.m2.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS1.p3.15.m2.2.2.2.2.3.cmml" xref="S4.SS1.p3.15.m2.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.15.m2.2c">(j_{1}^{k},j_{2}^{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.15.m2.2d">( italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_j start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math> be the coordinate of <math alttext="i_{k}" class="ltx_Math" display="inline" id="S4.SS1.p3.16.m3.1"><semantics id="S4.SS1.p3.16.m3.1a"><msub id="S4.SS1.p3.16.m3.1.1" xref="S4.SS1.p3.16.m3.1.1.cmml"><mi id="S4.SS1.p3.16.m3.1.1.2" xref="S4.SS1.p3.16.m3.1.1.2.cmml">i</mi><mi id="S4.SS1.p3.16.m3.1.1.3" xref="S4.SS1.p3.16.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.16.m3.1b"><apply id="S4.SS1.p3.16.m3.1.1.cmml" xref="S4.SS1.p3.16.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.16.m3.1.1.1.cmml" xref="S4.SS1.p3.16.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.16.m3.1.1.2.cmml" xref="S4.SS1.p3.16.m3.1.1.2">𝑖</ci><ci id="S4.SS1.p3.16.m3.1.1.3.cmml" xref="S4.SS1.p3.16.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.16.m3.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.16.m3.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for size <math alttext="(m_{1}m_{2},m_{3}m_{4})" class="ltx_Math" display="inline" id="S4.SS1.p3.17.m4.2"><semantics id="S4.SS1.p3.17.m4.2a"><mrow id="S4.SS1.p3.17.m4.2.2.2" xref="S4.SS1.p3.17.m4.2.2.3.cmml"><mo id="S4.SS1.p3.17.m4.2.2.2.3" stretchy="false" xref="S4.SS1.p3.17.m4.2.2.3.cmml">(</mo><mrow id="S4.SS1.p3.17.m4.1.1.1.1" xref="S4.SS1.p3.17.m4.1.1.1.1.cmml"><msub id="S4.SS1.p3.17.m4.1.1.1.1.2" xref="S4.SS1.p3.17.m4.1.1.1.1.2.cmml"><mi id="S4.SS1.p3.17.m4.1.1.1.1.2.2" xref="S4.SS1.p3.17.m4.1.1.1.1.2.2.cmml">m</mi><mn id="S4.SS1.p3.17.m4.1.1.1.1.2.3" xref="S4.SS1.p3.17.m4.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p3.17.m4.1.1.1.1.1" xref="S4.SS1.p3.17.m4.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS1.p3.17.m4.1.1.1.1.3" xref="S4.SS1.p3.17.m4.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.17.m4.1.1.1.1.3.2" xref="S4.SS1.p3.17.m4.1.1.1.1.3.2.cmml">m</mi><mn id="S4.SS1.p3.17.m4.1.1.1.1.3.3" xref="S4.SS1.p3.17.m4.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S4.SS1.p3.17.m4.2.2.2.4" xref="S4.SS1.p3.17.m4.2.2.3.cmml">,</mo><mrow id="S4.SS1.p3.17.m4.2.2.2.2" xref="S4.SS1.p3.17.m4.2.2.2.2.cmml"><msub id="S4.SS1.p3.17.m4.2.2.2.2.2" xref="S4.SS1.p3.17.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.17.m4.2.2.2.2.2.2" xref="S4.SS1.p3.17.m4.2.2.2.2.2.2.cmml">m</mi><mn id="S4.SS1.p3.17.m4.2.2.2.2.2.3" xref="S4.SS1.p3.17.m4.2.2.2.2.2.3.cmml">3</mn></msub><mo id="S4.SS1.p3.17.m4.2.2.2.2.1" xref="S4.SS1.p3.17.m4.2.2.2.2.1.cmml">⁢</mo><msub id="S4.SS1.p3.17.m4.2.2.2.2.3" xref="S4.SS1.p3.17.m4.2.2.2.2.3.cmml"><mi id="S4.SS1.p3.17.m4.2.2.2.2.3.2" xref="S4.SS1.p3.17.m4.2.2.2.2.3.2.cmml">m</mi><mn id="S4.SS1.p3.17.m4.2.2.2.2.3.3" xref="S4.SS1.p3.17.m4.2.2.2.2.3.3.cmml">4</mn></msub></mrow><mo id="S4.SS1.p3.17.m4.2.2.2.5" stretchy="false" xref="S4.SS1.p3.17.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.17.m4.2b"><interval closure="open" id="S4.SS1.p3.17.m4.2.2.3.cmml" xref="S4.SS1.p3.17.m4.2.2.2"><apply id="S4.SS1.p3.17.m4.1.1.1.1.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1"><times id="S4.SS1.p3.17.m4.1.1.1.1.1.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.1"></times><apply id="S4.SS1.p3.17.m4.1.1.1.1.2.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.17.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.17.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.2.2">𝑚</ci><cn id="S4.SS1.p3.17.m4.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.17.m4.1.1.1.1.2.3">1</cn></apply><apply id="S4.SS1.p3.17.m4.1.1.1.1.3.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.17.m4.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.17.m4.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.17.m4.1.1.1.1.3.2">𝑚</ci><cn id="S4.SS1.p3.17.m4.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.17.m4.1.1.1.1.3.3">2</cn></apply></apply><apply id="S4.SS1.p3.17.m4.2.2.2.2.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2"><times id="S4.SS1.p3.17.m4.2.2.2.2.1.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.1"></times><apply id="S4.SS1.p3.17.m4.2.2.2.2.2.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.17.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.17.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.2.2">𝑚</ci><cn id="S4.SS1.p3.17.m4.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p3.17.m4.2.2.2.2.2.3">3</cn></apply><apply id="S4.SS1.p3.17.m4.2.2.2.2.3.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.17.m4.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p3.17.m4.2.2.2.2.3.2.cmml" xref="S4.SS1.p3.17.m4.2.2.2.2.3.2">𝑚</ci><cn id="S4.SS1.p3.17.m4.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.p3.17.m4.2.2.2.2.3.3">4</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.17.m4.2c">(m_{1}m_{2},m_{3}m_{4})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.17.m4.2d">( italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT )</annotation></semantics></math>. We denote <math alttext="\mathcal{J}_{1}=\{j_{1}^{k}\}_{k=1}^{\hat{b}}" class="ltx_Math" display="inline" id="S4.SS1.p3.18.m5.1"><semantics id="S4.SS1.p3.18.m5.1a"><mrow id="S4.SS1.p3.18.m5.1.1" xref="S4.SS1.p3.18.m5.1.1.cmml"><msub id="S4.SS1.p3.18.m5.1.1.3" xref="S4.SS1.p3.18.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.18.m5.1.1.3.2" xref="S4.SS1.p3.18.m5.1.1.3.2.cmml">𝒥</mi><mn id="S4.SS1.p3.18.m5.1.1.3.3" xref="S4.SS1.p3.18.m5.1.1.3.3.cmml">1</mn></msub><mo id="S4.SS1.p3.18.m5.1.1.2" xref="S4.SS1.p3.18.m5.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p3.18.m5.1.1.1" xref="S4.SS1.p3.18.m5.1.1.1.cmml"><mrow id="S4.SS1.p3.18.m5.1.1.1.1.1.1" xref="S4.SS1.p3.18.m5.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p3.18.m5.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.18.m5.1.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.2.cmml">j</mi><mn id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.18.m5.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.18.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p3.18.m5.1.1.1.1.3" xref="S4.SS1.p3.18.m5.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.18.m5.1.1.1.1.3.2" xref="S4.SS1.p3.18.m5.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p3.18.m5.1.1.1.1.3.1" xref="S4.SS1.p3.18.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p3.18.m5.1.1.1.1.3.3" xref="S4.SS1.p3.18.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mover accent="true" id="S4.SS1.p3.18.m5.1.1.1.3" xref="S4.SS1.p3.18.m5.1.1.1.3.cmml"><mi id="S4.SS1.p3.18.m5.1.1.1.3.2" xref="S4.SS1.p3.18.m5.1.1.1.3.2.cmml">b</mi><mo id="S4.SS1.p3.18.m5.1.1.1.3.1" xref="S4.SS1.p3.18.m5.1.1.1.3.1.cmml">^</mo></mover></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.18.m5.1b"><apply id="S4.SS1.p3.18.m5.1.1.cmml" xref="S4.SS1.p3.18.m5.1.1"><eq id="S4.SS1.p3.18.m5.1.1.2.cmml" xref="S4.SS1.p3.18.m5.1.1.2"></eq><apply id="S4.SS1.p3.18.m5.1.1.3.cmml" xref="S4.SS1.p3.18.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m5.1.1.3.1.cmml" xref="S4.SS1.p3.18.m5.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.18.m5.1.1.3.2.cmml" xref="S4.SS1.p3.18.m5.1.1.3.2">𝒥</ci><cn id="S4.SS1.p3.18.m5.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.18.m5.1.1.3.3">1</cn></apply><apply id="S4.SS1.p3.18.m5.1.1.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m5.1.1.1.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.18.m5.1.1.1.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m5.1.1.1.1.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1">subscript</csymbol><set id="S4.SS1.p3.18.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1"><apply id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.2">𝑗</ci><cn id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.p3.18.m5.1.1.1.1.3.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.3"><eq id="S4.SS1.p3.18.m5.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.3.1"></eq><ci id="S4.SS1.p3.18.m5.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS1.p3.18.m5.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.18.m5.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.p3.18.m5.1.1.1.3.cmml" xref="S4.SS1.p3.18.m5.1.1.1.3"><ci id="S4.SS1.p3.18.m5.1.1.1.3.1.cmml" xref="S4.SS1.p3.18.m5.1.1.1.3.1">^</ci><ci id="S4.SS1.p3.18.m5.1.1.1.3.2.cmml" xref="S4.SS1.p3.18.m5.1.1.1.3.2">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.18.m5.1c">\mathcal{J}_{1}=\{j_{1}^{k}\}_{k=1}^{\hat{b}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.18.m5.1d">caligraphic_J start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = { italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_b end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{J}_{2}=\{j_{2}^{k}\}_{k=1}^{\hat{b}}" class="ltx_Math" display="inline" id="S4.SS1.p3.19.m6.1"><semantics id="S4.SS1.p3.19.m6.1a"><mrow id="S4.SS1.p3.19.m6.1.1" xref="S4.SS1.p3.19.m6.1.1.cmml"><msub id="S4.SS1.p3.19.m6.1.1.3" xref="S4.SS1.p3.19.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.19.m6.1.1.3.2" xref="S4.SS1.p3.19.m6.1.1.3.2.cmml">𝒥</mi><mn id="S4.SS1.p3.19.m6.1.1.3.3" xref="S4.SS1.p3.19.m6.1.1.3.3.cmml">2</mn></msub><mo id="S4.SS1.p3.19.m6.1.1.2" xref="S4.SS1.p3.19.m6.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p3.19.m6.1.1.1" xref="S4.SS1.p3.19.m6.1.1.1.cmml"><mrow id="S4.SS1.p3.19.m6.1.1.1.1.1.1" xref="S4.SS1.p3.19.m6.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p3.19.m6.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.19.m6.1.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.2.cmml">j</mi><mn id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.3.cmml">2</mn><mi id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS1.p3.19.m6.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.19.m6.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p3.19.m6.1.1.1.1.3" xref="S4.SS1.p3.19.m6.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.19.m6.1.1.1.1.3.2" xref="S4.SS1.p3.19.m6.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p3.19.m6.1.1.1.1.3.1" xref="S4.SS1.p3.19.m6.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p3.19.m6.1.1.1.1.3.3" xref="S4.SS1.p3.19.m6.1.1.1.1.3.3.cmml">1</mn></mrow><mover accent="true" id="S4.SS1.p3.19.m6.1.1.1.3" xref="S4.SS1.p3.19.m6.1.1.1.3.cmml"><mi id="S4.SS1.p3.19.m6.1.1.1.3.2" xref="S4.SS1.p3.19.m6.1.1.1.3.2.cmml">b</mi><mo id="S4.SS1.p3.19.m6.1.1.1.3.1" xref="S4.SS1.p3.19.m6.1.1.1.3.1.cmml">^</mo></mover></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.19.m6.1b"><apply id="S4.SS1.p3.19.m6.1.1.cmml" xref="S4.SS1.p3.19.m6.1.1"><eq id="S4.SS1.p3.19.m6.1.1.2.cmml" xref="S4.SS1.p3.19.m6.1.1.2"></eq><apply id="S4.SS1.p3.19.m6.1.1.3.cmml" xref="S4.SS1.p3.19.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m6.1.1.3.1.cmml" xref="S4.SS1.p3.19.m6.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.19.m6.1.1.3.2.cmml" xref="S4.SS1.p3.19.m6.1.1.3.2">𝒥</ci><cn id="S4.SS1.p3.19.m6.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.19.m6.1.1.3.3">2</cn></apply><apply id="S4.SS1.p3.19.m6.1.1.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m6.1.1.1.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.19.m6.1.1.1.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m6.1.1.1.1.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1">subscript</csymbol><set id="S4.SS1.p3.19.m6.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1"><apply id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.2">𝑗</ci><cn id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.p3.19.m6.1.1.1.1.3.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.3"><eq id="S4.SS1.p3.19.m6.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.3.1"></eq><ci id="S4.SS1.p3.19.m6.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS1.p3.19.m6.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.19.m6.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.p3.19.m6.1.1.1.3.cmml" xref="S4.SS1.p3.19.m6.1.1.1.3"><ci id="S4.SS1.p3.19.m6.1.1.1.3.1.cmml" xref="S4.SS1.p3.19.m6.1.1.1.3.1">^</ci><ci id="S4.SS1.p3.19.m6.1.1.1.3.2.cmml" xref="S4.SS1.p3.19.m6.1.1.1.3.2">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.19.m6.1c">\mathcal{J}_{2}=\{j_{2}^{k}\}_{k=1}^{\hat{b}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.19.m6.1d">caligraphic_J start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = { italic_j start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_b end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math>, then compute the unique rows of <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS1.p3.20.m7.1"><semantics id="S4.SS1.p3.20.m7.1a"><mi id="S4.SS1.p3.20.m7.1.1" xref="S4.SS1.p3.20.m7.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.20.m7.1b"><ci id="S4.SS1.p3.20.m7.1.1.cmml" xref="S4.SS1.p3.20.m7.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.20.m7.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.20.m7.1d">bold_T</annotation></semantics></math> as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{T}[\mathcal{I}_{u},:]=\mbox{\bf einsum}(\hat{b}(n_{1}n_{2})r_{2},r_{2}%
\hat{b}(n_{3}n_{4})\Rightarrow\hat{b}(n_{1}n_{2}n_{3}n_{4}),[\mathbfcal{A}_{1}%
[\mathcal{J}_{1},:,:],\mathbfcal{A}_{1}[:,\mathcal{J}_{2},:]])." class="ltx_math_unparsed" display="block" id="S4.E18.m1.1"><semantics id="S4.E18.m1.1a"><mrow id="S4.E18.m1.1b"><mi id="S4.E18.m1.1.2">𝐓</mi><mrow id="S4.E18.m1.1.3"><mo id="S4.E18.m1.1.3.1" stretchy="false">[</mo><msub id="S4.E18.m1.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.3.2.2">ℐ</mi><mi id="S4.E18.m1.1.3.2.3">u</mi></msub><mo id="S4.E18.m1.1.3.3">,</mo><mo id="S4.E18.m1.1.1" rspace="0em">:</mo><mo id="S4.E18.m1.1.3.4" stretchy="false">]</mo></mrow><mo id="S4.E18.m1.1.4">=</mo><mtext class="ltx_mathvariant_bold" id="S4.E18.m1.1.5">einsum</mtext><mrow id="S4.E18.m1.1.6"><mo id="S4.E18.m1.1.6.1" stretchy="false">(</mo><mover accent="true" id="S4.E18.m1.1.6.2"><mi id="S4.E18.m1.1.6.2.2">b</mi><mo id="S4.E18.m1.1.6.2.1">^</mo></mover><mrow id="S4.E18.m1.1.6.3"><mo id="S4.E18.m1.1.6.3.1" stretchy="false">(</mo><msub id="S4.E18.m1.1.6.3.2"><mi id="S4.E18.m1.1.6.3.2.2">n</mi><mn id="S4.E18.m1.1.6.3.2.3">1</mn></msub><msub id="S4.E18.m1.1.6.3.3"><mi id="S4.E18.m1.1.6.3.3.2">n</mi><mn id="S4.E18.m1.1.6.3.3.3">2</mn></msub><mo id="S4.E18.m1.1.6.3.4" stretchy="false">)</mo></mrow><msub id="S4.E18.m1.1.6.4"><mi id="S4.E18.m1.1.6.4.2">r</mi><mn id="S4.E18.m1.1.6.4.3">2</mn></msub><mo id="S4.E18.m1.1.6.5">,</mo><msub id="S4.E18.m1.1.6.6"><mi id="S4.E18.m1.1.6.6.2">r</mi><mn id="S4.E18.m1.1.6.6.3">2</mn></msub><mover accent="true" id="S4.E18.m1.1.6.7"><mi id="S4.E18.m1.1.6.7.2">b</mi><mo id="S4.E18.m1.1.6.7.1">^</mo></mover><mrow id="S4.E18.m1.1.6.8"><mo id="S4.E18.m1.1.6.8.1" stretchy="false">(</mo><msub id="S4.E18.m1.1.6.8.2"><mi id="S4.E18.m1.1.6.8.2.2">n</mi><mn id="S4.E18.m1.1.6.8.2.3">3</mn></msub><msub id="S4.E18.m1.1.6.8.3"><mi id="S4.E18.m1.1.6.8.3.2">n</mi><mn id="S4.E18.m1.1.6.8.3.3">4</mn></msub><mo id="S4.E18.m1.1.6.8.4" stretchy="false">)</mo></mrow><mo id="S4.E18.m1.1.6.9" stretchy="false">⇒</mo><mover accent="true" id="S4.E18.m1.1.6.10"><mi id="S4.E18.m1.1.6.10.2">b</mi><mo id="S4.E18.m1.1.6.10.1">^</mo></mover><mrow id="S4.E18.m1.1.6.11"><mo id="S4.E18.m1.1.6.11.1" stretchy="false">(</mo><msub id="S4.E18.m1.1.6.11.2"><mi id="S4.E18.m1.1.6.11.2.2">n</mi><mn id="S4.E18.m1.1.6.11.2.3">1</mn></msub><msub id="S4.E18.m1.1.6.11.3"><mi id="S4.E18.m1.1.6.11.3.2">n</mi><mn id="S4.E18.m1.1.6.11.3.3">2</mn></msub><msub id="S4.E18.m1.1.6.11.4"><mi id="S4.E18.m1.1.6.11.4.2">n</mi><mn id="S4.E18.m1.1.6.11.4.3">3</mn></msub><msub id="S4.E18.m1.1.6.11.5"><mi id="S4.E18.m1.1.6.11.5.2">n</mi><mn id="S4.E18.m1.1.6.11.5.3">4</mn></msub><mo id="S4.E18.m1.1.6.11.6" stretchy="false">)</mo></mrow><mo id="S4.E18.m1.1.6.12">,</mo><mrow id="S4.E18.m1.1.6.13"><mo id="S4.E18.m1.1.6.13.1" stretchy="false">[</mo><msub id="S4.E18.m1.1.6.13.2"><mi id="S4.E18.m1.1.6.13.2.2" mathvariant="normal">𝒜</mi><mi id="S4.E18.m1.1.6.13.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E18.m1.1.6.13.3" mathvariant="normal">∪</mi><msub id="S4.E18.m1.1.6.13.4"><mi id="S4.E18.m1.1.6.13.4.2" mathvariant="normal">𝒥</mi><mi id="S4.E18.m1.1.6.13.4.3" mathvariant="normal">∞</mi></msub><mi id="S4.E18.m1.1.6.13.5" mathvariant="normal">⇔</mi><mi id="S4.E18.m1.1.6.13.6" mathvariant="normal">¬</mi><mi id="S4.E18.m1.1.6.13.7" mathvariant="normal">⇔</mi><mi id="S4.E18.m1.1.6.13.8" mathvariant="normal">¬</mi><mi id="S4.E18.m1.1.6.13.9" mathvariant="normal">⊌</mi><mi id="S4.E18.m1.1.6.13.10" mathvariant="normal">⇔</mi><msub id="S4.E18.m1.1.6.13.11"><mi id="S4.E18.m1.1.6.13.11.2" mathvariant="normal">𝒜</mi><mi id="S4.E18.m1.1.6.13.11.3" mathvariant="normal">∞</mi></msub><mi id="S4.E18.m1.1.6.13.12" mathvariant="normal">∪</mi><mi id="S4.E18.m1.1.6.13.13" mathvariant="normal">¬</mi><mi id="S4.E18.m1.1.6.13.14" mathvariant="normal">⇔</mi><msub id="S4.E18.m1.1.6.13.15"><mi id="S4.E18.m1.1.6.13.15.2" mathvariant="normal">𝒥</mi><mi id="S4.E18.m1.1.6.13.15.3" mathvariant="normal">∈</mi></msub><mi id="S4.E18.m1.1.6.13.16" mathvariant="normal">⇔</mi><mi id="S4.E18.m1.1.6.13.17" mathvariant="normal">¬</mi><mi id="S4.E18.m1.1.6.13.18" mathvariant="normal">⊌</mi><mi id="S4.E18.m1.1.6.13.19" mathvariant="normal">⊌</mi><mi id="S4.E18.m1.1.6.13.20" mathvariant="normal">⇒</mi><mi id="S4.E18.m1.1.6.13.21" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E18.m1.1c">\mathbf{T}[\mathcal{I}_{u},:]=\mbox{\bf einsum}(\hat{b}(n_{1}n_{2})r_{2},r_{2}%
\hat{b}(n_{3}n_{4})\Rightarrow\hat{b}(n_{1}n_{2}n_{3}n_{4}),[\mathbfcal{A}_{1}%
[\mathcal{J}_{1},:,:],\mathbfcal{A}_{1}[:,\mathcal{J}_{2},:]]).</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.1d">bold_T [ caligraphic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , : ] = einsum ( over^ start_ARG italic_b end_ARG ( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT over^ start_ARG italic_b end_ARG ( italic_n start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) ⇒ over^ start_ARG italic_b end_ARG ( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) , [ roman_𝒜 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ∪ roman_𝒥 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ ¬ ⇔ ¬ ⊌ ⇔ roman_𝒜 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ∪ ¬ ⇔ roman_𝒥 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇔ ¬ ⊌ ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.21">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.F4" title="Figure 4 ‣ 4.1 Performance Optimization of TTM Embedding Tables. ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4</span></a> summarizes the whole process of TTM embedding table look up. This approach can be easily applied to higher-order embedding tables by first grouping some small tensor cores to obtain intermediate tensors and then utilizing them to compute unique row vectors.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Performance.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.4">We demonstrate the optimized TTM embedding tables on a single RTX 3090 GPU. We consider an embedding table of TTM shape <math alttext="[[80,50,54,50],[4,4,6,8]]" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.10"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.10a"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.3.cmml"><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.3.cmml">[</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml">[</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">80</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.cmml">50</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.cmml">54</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2.4" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.4.4" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.cmml">50</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml">]</mo></mrow><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.4" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.3.cmml">,</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml"><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml">[</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.5.5" xref="S4.SS1.SSS0.Px1.p1.1.m1.5.5.cmml">4</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.6.6" xref="S4.SS1.SSS0.Px1.p1.1.m1.6.6.cmml">4</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.7.7" xref="S4.SS1.SSS0.Px1.p1.1.m1.7.7.cmml">6</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2.4" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.1.m1.8.8" xref="S4.SS1.SSS0.Px1.p1.1.m1.8.8.cmml">8</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml">]</mo></mrow><mo id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.10b"><interval closure="closed" id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2"><list id="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.9.9.1.1.2"><cn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">80</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2">50</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3">54</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4">50</cn></list><list id="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.10.10.2.2.2"><cn id="S4.SS1.SSS0.Px1.p1.1.m1.5.5.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.5.5">4</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.6.6.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.6.6">4</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.7.7.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.7.7">6</cn><cn id="S4.SS1.SSS0.Px1.p1.1.m1.8.8.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.8.8">8</cn></list></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.10c">[[80,50,54,50],[4,4,6,8]]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.10d">[ [ 80 , 50 , 54 , 50 ] , [ 4 , 4 , 6 , 8 ] ]</annotation></semantics></math> and rank <math alttext="32" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><cn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">32</annotation></semantics></math>, extracted from a practical DLRM model. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.F5" title="Figure 5 ‣ Performance. ‣ 4.1 Performance Optimization of TTM Embedding Tables. ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">5</span></a>, our proposed method achieves about <math alttext="4-5\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><mn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1">4</mn><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.2">−</mo><mn id="S4.SS1.SSS0.Px1.p1.3.m3.1.3">5</mn><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">4-5\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.1d">4 - 5 ×</annotation></semantics></math> speed-up and <math alttext="2-3\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><mn id="S4.SS1.SSS0.Px1.p1.4.m4.1.1">2</mn><mo id="S4.SS1.SSS0.Px1.p1.4.m4.1.2">−</mo><mn id="S4.SS1.SSS0.Px1.p1.4.m4.1.3">3</mn><mo id="S4.SS1.SSS0.Px1.p1.4.m4.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">2-3\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.4.m4.1d">2 - 3 ×</annotation></semantics></math> memory saving than the standard TTM embedding without any optimization.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S4.F5.sf1.g1" src="extracted/2405.14377v1/figures/TTM_emb_time_new.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F5.sf1.3.2" style="font-size:90%;">Speed-up</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S4.F5.sf2.g1" src="extracted/2405.14377v1/figures/TTM_emb_memory_new.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F5.sf2.3.2" style="font-size:90%;">Memory reduction</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.4.2" style="font-size:90%;">Performance of optimized TTM embedding table lookup. The labels <span class="ltx_text ltx_font_italic" id="S4.F5.4.2.1">proposed approach, optimized order, unique indices, without optimization</span> represent the new method in <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS1" title="4.1 Performance Optimization of TTM Embedding Tables. ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.1</span></a>, the method that only uses the unique order, the method that only uses the unique indices, and the method without optimization, respectively.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Contraction Path Optimization for TT-Vector Multiplications</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.6">Next, we optimize the forward- and back- propagation of linear layers in the TT format. We consider the linear layer <math alttext="\mathbf{Y}=\mathbf{X}\mathbf{W}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">𝐘</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">𝐗𝐖</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐘</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝐗𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathbf{Y}=\mathbf{X}\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">bold_Y = bold_XW</annotation></semantics></math>, where <math alttext="\mathbf{Y}\in\mathbb{R}^{b\times N_{2}},\mathbf{W}\in\mathbb{R}^{N_{1}\times N%
_{2}},\mathbf{X}\in\mathbb{R}^{b\times N_{1}}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.2"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.3.cmml"><mrow id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.1.1.2.cmml">𝐘</mi><mo id="S4.SS2.p1.2.m2.1.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.2.m2.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.2.m2.1.1.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.3.3.2" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.2.cmml">b</mi><mo id="S4.SS2.p1.2.m2.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.2" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.2.cmml">N</mi><mn id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><mo id="S4.SS2.p1.2.m2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.2.m2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.3.cmml"><mrow id="S4.SS2.p1.2.m2.2.2.2.2.1.1" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.1.1.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.2.cmml">𝐖</mi><mo id="S4.SS2.p1.2.m2.2.2.2.2.1.1.1" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.cmml"><msub id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.2.cmml">N</mi><mn id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.2.cmml">N</mi><mn id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><mo id="S4.SS2.p1.2.m2.2.2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.2.m2.2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.2.cmml">𝐗</mi><mo id="S4.SS2.p1.2.m2.2.2.2.2.2.2.1" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.2.cmml">b</mi><mo id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.2.cmml">N</mi><mn id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.3" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><apply id="S4.SS2.p1.2.m2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.3a.cmml" xref="S4.SS2.p1.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1"><in id="S4.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1"></in><ci id="S4.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2">𝐘</ci><apply id="S4.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.2.m2.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3"><times id="S4.SS2.p1.2.m2.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.1"></times><ci id="S4.SS2.p1.2.m2.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.2">𝑏</ci><apply id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.2">𝑁</ci><cn id="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.3a.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1"><in id="S4.SS2.p1.2.m2.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.1"></in><ci id="S4.SS2.p1.2.m2.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.2">𝐖</ci><apply id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3"><times id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.1"></times><apply id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.2">𝑁</ci><cn id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.2.3">1</cn></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.2">𝑁</ci><cn id="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.2.2.2.2.1.1.3.3.3.3">2</cn></apply></apply></apply></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2"><in id="S4.SS2.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.1"></in><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.2">𝐗</ci><apply id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.2">ℝ</ci><apply id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3"><times id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.1"></times><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.2">𝑏</ci><apply id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.2">𝑁</ci><cn id="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">\mathbf{Y}\in\mathbb{R}^{b\times N_{2}},\mathbf{W}\in\mathbb{R}^{N_{1}\times N%
_{2}},\mathbf{X}\in\mathbb{R}^{b\times N_{1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.2d">bold_Y ∈ blackboard_R start_POSTSUPERSCRIPT italic_b × italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_b × italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">bold_W</annotation></semantics></math> is compressed into the Tensor-Train format: <math alttext="\mathbfcal{W}=[\![\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{2d}]\!]\in\mathbb{R}%
^{n_{1}\times\cdots\times n_{2d}}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.2.cmml">𝒲</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.3.cmml">ℑ</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1a" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mpadded width="0.497em"><mi id="S4.SS2.p1.4.m4.1.1.2.4" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.4.cmml">∪</mi></mpadded><mo id="S4.SS2.p1.4.m4.1.1.2.1b" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.5" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.5.cmml">∪</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1c" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.p1.4.m4.1.1.2.6" xref="S4.SS2.p1.4.m4.1.1.2.6.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2.6.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.6.2.cmml">𝒢</mi><mi id="S4.SS2.p1.4.m4.1.1.2.6.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.6.3.cmml">∞</mi></msub><mo id="S4.SS2.p1.4.m4.1.1.2.1d" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.7" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.7.cmml">⇔</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1e" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.8" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.8.cmml">…</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1f" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.9" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.9.cmml">⇔</mi><mo id="S4.SS2.p1.4.m4.1.1.2.1g" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.p1.4.m4.1.1.2.10" xref="S4.SS2.p1.4.m4.1.1.2.10.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2.10.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.10.2.cmml">𝒢</mi><mrow id="S4.SS2.p1.4.m4.1.1.2.10.3" xref="S4.SS2.p1.4.m4.1.1.2.10.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2.10.3.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.10.3.2.cmml">∈</mi><mo id="S4.SS2.p1.4.m4.1.1.2.10.3.1" xref="S4.SS2.p1.4.m4.1.1.2.10.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.10.3.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.10.3.3.cmml">⌈</mi></mrow></msub><mo id="S4.SS2.p1.4.m4.1.1.2.1h" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mpadded width="0.497em"><mi id="S4.SS2.p1.4.m4.1.1.2.11" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.11.cmml">⊌</mi></mpadded><mo id="S4.SS2.p1.4.m4.1.1.2.1i" xref="S4.SS2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.2.12" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.2.12.cmml">⊌</mi></mrow><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">ℛ</mi><mrow id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml"><msub id="S4.SS2.p1.4.m4.1.1.3.3.2" xref="S4.SS2.p1.4.m4.1.1.3.3.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.3.2.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.2.2.cmml">\</mi><mi id="S4.SS2.p1.4.m4.1.1.3.3.2.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.2.3.cmml">∞</mi></msub><mo id="S4.SS2.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.3.cmml">⋯</mi><mo id="S4.SS2.p1.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.4.m4.1.1.3.3.4" xref="S4.SS2.p1.4.m4.1.1.3.3.4.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.3.4.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.4.2.cmml">\</mi><mrow id="S4.SS2.p1.4.m4.1.1.3.3.4.3" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.3.4.3.2" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.2.cmml">∈</mi><mo id="S4.SS2.p1.4.m4.1.1.3.3.4.3.1" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3.4.3.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.3.cmml">⌈</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><in id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></in><apply id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2"><times id="S4.SS2.p1.4.m4.1.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.2.1"></times><ci id="S4.SS2.p1.4.m4.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2.2">𝒲</ci><ci id="S4.SS2.p1.4.m4.1.1.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.2.3">ℑ</ci><ci id="S4.SS2.p1.4.m4.1.1.2.4.cmml" xref="S4.SS2.p1.4.m4.1.1.2.4">∪</ci><ci id="S4.SS2.p1.4.m4.1.1.2.5.cmml" xref="S4.SS2.p1.4.m4.1.1.2.5">∪</ci><apply id="S4.SS2.p1.4.m4.1.1.2.6.cmml" xref="S4.SS2.p1.4.m4.1.1.2.6"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.2.6.1.cmml" xref="S4.SS2.p1.4.m4.1.1.2.6">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.6.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2.6.2">𝒢</ci><ci id="S4.SS2.p1.4.m4.1.1.2.6.3.cmml" xref="S4.SS2.p1.4.m4.1.1.2.6.3">∞</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.2.7.cmml" xref="S4.SS2.p1.4.m4.1.1.2.7">⇔</ci><ci id="S4.SS2.p1.4.m4.1.1.2.8.cmml" xref="S4.SS2.p1.4.m4.1.1.2.8">…</ci><ci id="S4.SS2.p1.4.m4.1.1.2.9.cmml" xref="S4.SS2.p1.4.m4.1.1.2.9">⇔</ci><apply id="S4.SS2.p1.4.m4.1.1.2.10.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.2.10.1.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.10.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10.2">𝒢</ci><apply id="S4.SS2.p1.4.m4.1.1.2.10.3.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10.3"><times id="S4.SS2.p1.4.m4.1.1.2.10.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.2.10.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10.3.2">∈</ci><ci id="S4.SS2.p1.4.m4.1.1.2.10.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.2.10.3.3">⌈</ci></apply></apply><ci id="S4.SS2.p1.4.m4.1.1.2.11.cmml" xref="S4.SS2.p1.4.m4.1.1.2.11">⊌</ci><ci id="S4.SS2.p1.4.m4.1.1.2.12.cmml" xref="S4.SS2.p1.4.m4.1.1.2.12">⊌</ci></apply><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">ℛ</ci><apply id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3"><times id="S4.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.1"></times><apply id="S4.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.3.3.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.3.3.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.2.2">\</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.2.3">∞</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.3">⋯</ci><apply id="S4.SS2.p1.4.m4.1.1.3.3.4.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.3.3.4.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.3.3.4.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4.2">\</ci><apply id="S4.SS2.p1.4.m4.1.1.3.3.4.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3"><times id="S4.SS2.p1.4.m4.1.1.3.3.4.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.3.3.4.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.2">∈</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.4.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3.4.3.3">⌈</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathbfcal{W}=[\![\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{2d}]\!]\in\mathbb{R}%
^{n_{1}\times\cdots\times n_{2d}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">roman_𝒲 roman_ℑ ∪ ∪ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT ⊌ ⊌ ∈ roman_ℛ start_POSTSUPERSCRIPT \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × ⋯ × \ start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>,where <math alttext="\mathbfcal{G}_{i}\in\mathbb{R}^{r_{i-1}\times n_{i}\times r_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS2.p1.5.m5.1.1.2.3" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.2.3.cmml">⟩</mi></msub><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">ℛ</mi><mrow id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.cmml"><msub id="S4.SS2.p1.5.m5.1.1.3.3.2" xref="S4.SS2.p1.5.m5.1.1.3.3.2.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.2.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.2.2.cmml">∇</mi><mrow id="S4.SS2.p1.5.m5.1.1.3.3.2.3" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.2.3.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.2.cmml">⟩</mi><mo id="S4.SS2.p1.5.m5.1.1.3.3.2.3.1" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.2.3.3" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.3.cmml">↖</mi><mo id="S4.SS2.p1.5.m5.1.1.3.3.2.3.1a" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.2.3.4" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.4.cmml">∞</mi></mrow></msub><mo id="S4.SS2.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.5.m5.1.1.3.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.3.2.cmml">\</mi><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.3" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.cmml">⟩</mi></msub><mo id="S4.SS2.p1.5.m5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.5.m5.1.1.3.3.4" xref="S4.SS2.p1.5.m5.1.1.3.3.4.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.4.2" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.4.2.cmml">∇</mi><mi id="S4.SS2.p1.5.m5.1.1.3.3.4.3" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.3.3.4.3.cmml">⟩</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><in id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></in><apply id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.2">𝒢</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3">⟩</ci></apply><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">ℛ</ci><apply id="S4.SS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3"><times id="S4.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.1"></times><apply id="S4.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.3.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.2">∇</ci><apply id="S4.SS2.p1.5.m5.1.1.3.3.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3"><times id="S4.SS2.p1.5.m5.1.1.3.3.2.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.2">⟩</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.3">↖</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2.3.4">∞</ci></apply></apply><apply id="S4.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.2">\</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3">⟩</ci></apply><apply id="S4.SS2.p1.5.m5.1.1.3.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.3.4.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.4">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.3.4.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.4.2">∇</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.4.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.4.3">⟩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathbfcal{G}_{i}\in\mathbb{R}^{r_{i-1}\times n_{i}\times r_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ∈ roman_ℛ start_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT ⟩ ↖ ∞ end_POSTSUBSCRIPT × \ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT × ∇ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="N_{1}=n_{1}\cdots n_{d},N_{2}=n_{d+1}\cdots n_{2d}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.2"><semantics id="S4.SS2.p1.6.m6.2a"><mrow id="S4.SS2.p1.6.m6.2.2.2" xref="S4.SS2.p1.6.m6.2.2.3.cmml"><mrow id="S4.SS2.p1.6.m6.1.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.1.cmml"><msub id="S4.SS2.p1.6.m6.1.1.1.1.2" xref="S4.SS2.p1.6.m6.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.6.m6.1.1.1.1.2.2" xref="S4.SS2.p1.6.m6.1.1.1.1.2.2.cmml">N</mi><mn id="S4.SS2.p1.6.m6.1.1.1.1.2.3" xref="S4.SS2.p1.6.m6.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS2.p1.6.m6.1.1.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m6.1.1.1.1.3" xref="S4.SS2.p1.6.m6.1.1.1.1.3.cmml"><msub id="S4.SS2.p1.6.m6.1.1.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p1.6.m6.1.1.1.1.3.2.2" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2.2.cmml">n</mi><mn id="S4.SS2.p1.6.m6.1.1.1.1.3.2.3" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.SS2.p1.6.m6.1.1.1.1.3.1" xref="S4.SS2.p1.6.m6.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.1.1.1.1.3.3" mathvariant="normal" xref="S4.SS2.p1.6.m6.1.1.1.1.3.3.cmml">⋯</mi><mo id="S4.SS2.p1.6.m6.1.1.1.1.3.1a" xref="S4.SS2.p1.6.m6.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.p1.6.m6.1.1.1.1.3.4" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4.cmml"><mi id="S4.SS2.p1.6.m6.1.1.1.1.3.4.2" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4.2.cmml">n</mi><mi id="S4.SS2.p1.6.m6.1.1.1.1.3.4.3" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4.3.cmml">d</mi></msub></mrow></mrow><mo id="S4.SS2.p1.6.m6.2.2.2.3" xref="S4.SS2.p1.6.m6.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.6.m6.2.2.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.cmml"><msub id="S4.SS2.p1.6.m6.2.2.2.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.6.m6.2.2.2.2.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.2.2.cmml">N</mi><mn id="S4.SS2.p1.6.m6.2.2.2.2.2.3" xref="S4.SS2.p1.6.m6.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.p1.6.m6.2.2.2.2.1" xref="S4.SS2.p1.6.m6.2.2.2.2.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m6.2.2.2.2.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.cmml"><msub id="S4.SS2.p1.6.m6.2.2.2.2.3.2" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.cmml"><mi id="S4.SS2.p1.6.m6.2.2.2.2.3.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.2.cmml">n</mi><mrow id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.cmml"><mi id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.2" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.2.cmml">d</mi><mo id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.1" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.1.cmml">+</mo><mn id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p1.6.m6.2.2.2.2.3.1" xref="S4.SS2.p1.6.m6.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.2.2.2.2.3.3" mathvariant="normal" xref="S4.SS2.p1.6.m6.2.2.2.2.3.3.cmml">⋯</mi><mo id="S4.SS2.p1.6.m6.2.2.2.2.3.1a" xref="S4.SS2.p1.6.m6.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p1.6.m6.2.2.2.2.3.4" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.cmml"><mi id="S4.SS2.p1.6.m6.2.2.2.2.3.4.2" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.2.cmml">n</mi><mrow id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.cmml"><mn id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.2" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.2.cmml">2</mn><mo id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.1" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.3.cmml">d</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.2b"><apply id="S4.SS2.p1.6.m6.2.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.3a.cmml" xref="S4.SS2.p1.6.m6.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.6.m6.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1"><eq id="S4.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.1"></eq><apply id="S4.SS2.p1.6.m6.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.2.2">𝑁</ci><cn id="S4.SS2.p1.6.m6.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.1.1.1.1.2.3">1</cn></apply><apply id="S4.SS2.p1.6.m6.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3"><times id="S4.SS2.p1.6.m6.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.1"></times><apply id="S4.SS2.p1.6.m6.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2.2">𝑛</ci><cn id="S4.SS2.p1.6.m6.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.1.1.1.1.3.2.3">1</cn></apply><ci id="S4.SS2.p1.6.m6.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.3">⋯</ci><apply id="S4.SS2.p1.6.m6.1.1.1.1.3.4.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.1.3.4.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.1.1.3.4.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4.2">𝑛</ci><ci id="S4.SS2.p1.6.m6.1.1.1.1.3.4.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3.4.3">𝑑</ci></apply></apply></apply><apply id="S4.SS2.p1.6.m6.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2"><eq id="S4.SS2.p1.6.m6.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.1"></eq><apply id="S4.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.2.2">𝑁</ci><cn id="S4.SS2.p1.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.2.2.2.2.2.3">2</cn></apply><apply id="S4.SS2.p1.6.m6.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3"><times id="S4.SS2.p1.6.m6.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.1"></times><apply id="S4.SS2.p1.6.m6.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.2.2.3.2.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.2">𝑛</ci><apply id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3"><plus id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.1"></plus><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.2">𝑑</ci><cn id="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.3">⋯</ci><apply id="S4.SS2.p1.6.m6.2.2.2.2.3.4.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.2.2.3.4.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.4.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.2">𝑛</ci><apply id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3"><times id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.1"></times><cn id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.2.cmml" type="integer" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.2">2</cn><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3.4.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.2c">N_{1}=n_{1}\cdots n_{d},N_{2}=n_{d+1}\cdots n_{2d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.2d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. The forward-propagation in the einsum form is</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Y}=\mathbf{X}\mathbf{W}=\mbox{\bf einsum}(bn_{1}\ldots n_{d},S_{1},%
\ldots,S_{2d}\Rightarrow bn_{d+1}\ldots n_{2d},[\mathbfcal{X},\mathbfcal{G}_{1%
},\ldots,\mathbfcal{G}_{2d}])" class="ltx_math_unparsed" display="block" id="S4.E19.m1.1"><semantics id="S4.E19.m1.1a"><mrow id="S4.E19.m1.1b"><mi id="S4.E19.m1.1.2">𝐘</mi><mo id="S4.E19.m1.1.3">=</mo><mi id="S4.E19.m1.1.4">𝐗𝐖</mi><mo id="S4.E19.m1.1.5">=</mo><mtext class="ltx_mathvariant_bold" id="S4.E19.m1.1.6">einsum</mtext><mrow id="S4.E19.m1.1.7"><mo id="S4.E19.m1.1.7.1" stretchy="false">(</mo><mi id="S4.E19.m1.1.7.2">b</mi><msub id="S4.E19.m1.1.7.3"><mi id="S4.E19.m1.1.7.3.2">n</mi><mn id="S4.E19.m1.1.7.3.3">1</mn></msub><mi id="S4.E19.m1.1.7.4" mathvariant="normal">…</mi><msub id="S4.E19.m1.1.7.5"><mi id="S4.E19.m1.1.7.5.2">n</mi><mi id="S4.E19.m1.1.7.5.3">d</mi></msub><mo id="S4.E19.m1.1.7.6">,</mo><msub id="S4.E19.m1.1.7.7"><mi id="S4.E19.m1.1.7.7.2">S</mi><mn id="S4.E19.m1.1.7.7.3">1</mn></msub><mo id="S4.E19.m1.1.7.8">,</mo><mi id="S4.E19.m1.1.1" mathvariant="normal">…</mi><mo id="S4.E19.m1.1.7.9">,</mo><msub id="S4.E19.m1.1.7.10"><mi id="S4.E19.m1.1.7.10.2">S</mi><mrow id="S4.E19.m1.1.7.10.3"><mn id="S4.E19.m1.1.7.10.3.2">2</mn><mo id="S4.E19.m1.1.7.10.3.1">⁢</mo><mi id="S4.E19.m1.1.7.10.3.3">d</mi></mrow></msub><mo id="S4.E19.m1.1.7.11" stretchy="false">⇒</mo><mi id="S4.E19.m1.1.7.12">b</mi><msub id="S4.E19.m1.1.7.13"><mi id="S4.E19.m1.1.7.13.2">n</mi><mrow id="S4.E19.m1.1.7.13.3"><mi id="S4.E19.m1.1.7.13.3.2">d</mi><mo id="S4.E19.m1.1.7.13.3.1">+</mo><mn id="S4.E19.m1.1.7.13.3.3">1</mn></mrow></msub><mi id="S4.E19.m1.1.7.14" mathvariant="normal">…</mi><msub id="S4.E19.m1.1.7.15"><mi id="S4.E19.m1.1.7.15.2">n</mi><mrow id="S4.E19.m1.1.7.15.3"><mn id="S4.E19.m1.1.7.15.3.2">2</mn><mo id="S4.E19.m1.1.7.15.3.1">⁢</mo><mi id="S4.E19.m1.1.7.15.3.3">d</mi></mrow></msub><mo id="S4.E19.m1.1.7.16">,</mo><mrow id="S4.E19.m1.1.7.17"><mo id="S4.E19.m1.1.7.17.1" stretchy="false">[</mo><mi id="S4.E19.m1.1.7.17.2" mathvariant="normal">𝒳</mi><mi id="S4.E19.m1.1.7.17.3" mathvariant="normal">⇔</mi><msub id="S4.E19.m1.1.7.17.4"><mi id="S4.E19.m1.1.7.17.4.2" mathvariant="normal">𝒢</mi><mi id="S4.E19.m1.1.7.17.4.3" mathvariant="normal">∞</mi></msub><mi id="S4.E19.m1.1.7.17.5" mathvariant="normal">⇔</mi><mi id="S4.E19.m1.1.7.17.6" mathvariant="normal">…</mi><mi id="S4.E19.m1.1.7.17.7" mathvariant="normal">⇔</mi><msub id="S4.E19.m1.1.7.17.8"><mi id="S4.E19.m1.1.7.17.8.2" mathvariant="normal">𝒢</mi><mrow id="S4.E19.m1.1.7.17.8.3"><mi id="S4.E19.m1.1.7.17.8.3.2" mathvariant="normal">∈</mi><mo id="S4.E19.m1.1.7.17.8.3.1">⁢</mo><mi id="S4.E19.m1.1.7.17.8.3.3" mathvariant="normal">⌈</mi></mrow></msub><mi id="S4.E19.m1.1.7.17.9" mathvariant="normal">⊌</mi><mi id="S4.E19.m1.1.7.17.10" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E19.m1.1c">\mathbf{Y}=\mathbf{X}\mathbf{W}=\mbox{\bf einsum}(bn_{1}\ldots n_{d},S_{1},%
\ldots,S_{2d}\Rightarrow bn_{d+1}\ldots n_{2d},[\mathbfcal{X},\mathbfcal{G}_{1%
},\ldots,\mathbfcal{G}_{2d}])</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.1d">bold_Y = bold_XW = einsum ( italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_S start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , [ roman_𝒳 ⇔ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT ⊌ ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.14">where <math alttext="\mathbfcal{X}\in\mathbb{R}^{b\times n_{1}\times\cdots\times n_{d}}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m1.1"><semantics id="S4.SS2.p1.7.m1.1a"><mrow id="S4.SS2.p1.7.m1.1.1" xref="S4.SS2.p1.7.m1.1.1.cmml"><mi id="S4.SS2.p1.7.m1.1.1.2" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.2.cmml">𝒳</mi><mo id="S4.SS2.p1.7.m1.1.1.1" xref="S4.SS2.p1.7.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.7.m1.1.1.3" xref="S4.SS2.p1.7.m1.1.1.3.cmml"><mi id="S4.SS2.p1.7.m1.1.1.3.2" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S4.SS2.p1.7.m1.1.1.3.3" xref="S4.SS2.p1.7.m1.1.1.3.3.cmml"><mi id="S4.SS2.p1.7.m1.1.1.3.3.2" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.2.cmml">⌊</mi><mo id="S4.SS2.p1.7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.7.m1.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.7.m1.1.1.3.3.3" xref="S4.SS2.p1.7.m1.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.7.m1.1.1.3.3.3.2" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.3.2.cmml">\</mi><mi id="S4.SS2.p1.7.m1.1.1.3.3.3.3" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.3.3.cmml">∞</mi></msub><mo id="S4.SS2.p1.7.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.7.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.7.m1.1.1.3.3.4" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.4.cmml">⋯</mi><mo id="S4.SS2.p1.7.m1.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.7.m1.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.7.m1.1.1.3.3.5" xref="S4.SS2.p1.7.m1.1.1.3.3.5.cmml"><mi id="S4.SS2.p1.7.m1.1.1.3.3.5.2" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.5.2.cmml">\</mi><mi id="S4.SS2.p1.7.m1.1.1.3.3.5.3" mathvariant="normal" xref="S4.SS2.p1.7.m1.1.1.3.3.5.3.cmml">⌈</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m1.1b"><apply id="S4.SS2.p1.7.m1.1.1.cmml" xref="S4.SS2.p1.7.m1.1.1"><in id="S4.SS2.p1.7.m1.1.1.1.cmml" xref="S4.SS2.p1.7.m1.1.1.1"></in><ci id="S4.SS2.p1.7.m1.1.1.2.cmml" xref="S4.SS2.p1.7.m1.1.1.2">𝒳</ci><apply id="S4.SS2.p1.7.m1.1.1.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m1.1.1.3.1.cmml" xref="S4.SS2.p1.7.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.7.m1.1.1.3.2.cmml" xref="S4.SS2.p1.7.m1.1.1.3.2">ℛ</ci><apply id="S4.SS2.p1.7.m1.1.1.3.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3"><times id="S4.SS2.p1.7.m1.1.1.3.3.1.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.1"></times><ci id="S4.SS2.p1.7.m1.1.1.3.3.2.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.2">⌊</ci><apply id="S4.SS2.p1.7.m1.1.1.3.3.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m1.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.7.m1.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.3.2">\</ci><ci id="S4.SS2.p1.7.m1.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.3.3">∞</ci></apply><ci id="S4.SS2.p1.7.m1.1.1.3.3.4.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.4">⋯</ci><apply id="S4.SS2.p1.7.m1.1.1.3.3.5.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m1.1.1.3.3.5.1.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.5">subscript</csymbol><ci id="S4.SS2.p1.7.m1.1.1.3.3.5.2.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.5.2">\</ci><ci id="S4.SS2.p1.7.m1.1.1.3.3.5.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3.3.5.3">⌈</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m1.1c">\mathbfcal{X}\in\mathbb{R}^{b\times n_{1}\times\cdots\times n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m1.1d">roman_𝒳 ∈ roman_ℛ start_POSTSUPERSCRIPT ⌊ × \ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × ⋯ × \ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the reshaping of <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m2.1"><semantics id="S4.SS2.p1.8.m2.1a"><mi id="S4.SS2.p1.8.m2.1.1" xref="S4.SS2.p1.8.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m2.1b"><ci id="S4.SS2.p1.8.m2.1.1.cmml" xref="S4.SS2.p1.8.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m2.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m2.1d">bold_X</annotation></semantics></math> and <math alttext="S_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m3.1"><semantics id="S4.SS2.p1.9.m3.1a"><msub id="S4.SS2.p1.9.m3.1.1" xref="S4.SS2.p1.9.m3.1.1.cmml"><mi id="S4.SS2.p1.9.m3.1.1.2" xref="S4.SS2.p1.9.m3.1.1.2.cmml">S</mi><mi id="S4.SS2.p1.9.m3.1.1.3" xref="S4.SS2.p1.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m3.1b"><apply id="S4.SS2.p1.9.m3.1.1.cmml" xref="S4.SS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m3.1.1.1.cmml" xref="S4.SS2.p1.9.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m3.1.1.2.cmml" xref="S4.SS2.p1.9.m3.1.1.2">𝑆</ci><ci id="S4.SS2.p1.9.m3.1.1.3.cmml" xref="S4.SS2.p1.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m3.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m3.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes <math alttext="r_{i-1}n_{i}r_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.10.m4.1"><semantics id="S4.SS2.p1.10.m4.1a"><mrow id="S4.SS2.p1.10.m4.1.1" xref="S4.SS2.p1.10.m4.1.1.cmml"><msub id="S4.SS2.p1.10.m4.1.1.2" xref="S4.SS2.p1.10.m4.1.1.2.cmml"><mi id="S4.SS2.p1.10.m4.1.1.2.2" xref="S4.SS2.p1.10.m4.1.1.2.2.cmml">r</mi><mrow id="S4.SS2.p1.10.m4.1.1.2.3" xref="S4.SS2.p1.10.m4.1.1.2.3.cmml"><mi id="S4.SS2.p1.10.m4.1.1.2.3.2" xref="S4.SS2.p1.10.m4.1.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p1.10.m4.1.1.2.3.1" xref="S4.SS2.p1.10.m4.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p1.10.m4.1.1.2.3.3" xref="S4.SS2.p1.10.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p1.10.m4.1.1.1" xref="S4.SS2.p1.10.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p1.10.m4.1.1.3" xref="S4.SS2.p1.10.m4.1.1.3.cmml"><mi id="S4.SS2.p1.10.m4.1.1.3.2" xref="S4.SS2.p1.10.m4.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p1.10.m4.1.1.3.3" xref="S4.SS2.p1.10.m4.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.p1.10.m4.1.1.1a" xref="S4.SS2.p1.10.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p1.10.m4.1.1.4" xref="S4.SS2.p1.10.m4.1.1.4.cmml"><mi id="S4.SS2.p1.10.m4.1.1.4.2" xref="S4.SS2.p1.10.m4.1.1.4.2.cmml">r</mi><mi id="S4.SS2.p1.10.m4.1.1.4.3" xref="S4.SS2.p1.10.m4.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m4.1b"><apply id="S4.SS2.p1.10.m4.1.1.cmml" xref="S4.SS2.p1.10.m4.1.1"><times id="S4.SS2.p1.10.m4.1.1.1.cmml" xref="S4.SS2.p1.10.m4.1.1.1"></times><apply id="S4.SS2.p1.10.m4.1.1.2.cmml" xref="S4.SS2.p1.10.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m4.1.1.2.1.cmml" xref="S4.SS2.p1.10.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.10.m4.1.1.2.2.cmml" xref="S4.SS2.p1.10.m4.1.1.2.2">𝑟</ci><apply id="S4.SS2.p1.10.m4.1.1.2.3.cmml" xref="S4.SS2.p1.10.m4.1.1.2.3"><minus id="S4.SS2.p1.10.m4.1.1.2.3.1.cmml" xref="S4.SS2.p1.10.m4.1.1.2.3.1"></minus><ci id="S4.SS2.p1.10.m4.1.1.2.3.2.cmml" xref="S4.SS2.p1.10.m4.1.1.2.3.2">𝑖</ci><cn id="S4.SS2.p1.10.m4.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p1.10.m4.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p1.10.m4.1.1.3.cmml" xref="S4.SS2.p1.10.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m4.1.1.3.1.cmml" xref="S4.SS2.p1.10.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.10.m4.1.1.3.2.cmml" xref="S4.SS2.p1.10.m4.1.1.3.2">𝑛</ci><ci id="S4.SS2.p1.10.m4.1.1.3.3.cmml" xref="S4.SS2.p1.10.m4.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.p1.10.m4.1.1.4.cmml" xref="S4.SS2.p1.10.m4.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m4.1.1.4.1.cmml" xref="S4.SS2.p1.10.m4.1.1.4">subscript</csymbol><ci id="S4.SS2.p1.10.m4.1.1.4.2.cmml" xref="S4.SS2.p1.10.m4.1.1.4.2">𝑟</ci><ci id="S4.SS2.p1.10.m4.1.1.4.3.cmml" xref="S4.SS2.p1.10.m4.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m4.1c">r_{i-1}n_{i}r_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.10.m4.1d">italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Suppose that the gradient to <math alttext="\mathbf{Y}" class="ltx_Math" display="inline" id="S4.SS2.p1.11.m5.1"><semantics id="S4.SS2.p1.11.m5.1a"><mi id="S4.SS2.p1.11.m5.1.1" xref="S4.SS2.p1.11.m5.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m5.1b"><ci id="S4.SS2.p1.11.m5.1.1.cmml" xref="S4.SS2.p1.11.m5.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m5.1c">\mathbf{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.11.m5.1d">bold_Y</annotation></semantics></math> is <math alttext="\mathbf{g}_{\mathbf{Y}}" class="ltx_Math" display="inline" id="S4.SS2.p1.12.m6.1"><semantics id="S4.SS2.p1.12.m6.1a"><msub id="S4.SS2.p1.12.m6.1.1" xref="S4.SS2.p1.12.m6.1.1.cmml"><mi id="S4.SS2.p1.12.m6.1.1.2" xref="S4.SS2.p1.12.m6.1.1.2.cmml">𝐠</mi><mi id="S4.SS2.p1.12.m6.1.1.3" xref="S4.SS2.p1.12.m6.1.1.3.cmml">𝐘</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m6.1b"><apply id="S4.SS2.p1.12.m6.1.1.cmml" xref="S4.SS2.p1.12.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m6.1.1.1.cmml" xref="S4.SS2.p1.12.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.12.m6.1.1.2.cmml" xref="S4.SS2.p1.12.m6.1.1.2">𝐠</ci><ci id="S4.SS2.p1.12.m6.1.1.3.cmml" xref="S4.SS2.p1.12.m6.1.1.3">𝐘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m6.1c">\mathbf{g}_{\mathbf{Y}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.12.m6.1d">bold_g start_POSTSUBSCRIPT bold_Y end_POSTSUBSCRIPT</annotation></semantics></math>, then the gradients to <math alttext="\mathbfcal{G}_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.13.m7.1"><semantics id="S4.SS2.p1.13.m7.1a"><msub id="S4.SS2.p1.13.m7.1.1" xref="S4.SS2.p1.13.m7.1.1.cmml"><mi id="S4.SS2.p1.13.m7.1.1.2" mathvariant="normal" xref="S4.SS2.p1.13.m7.1.1.2.cmml">𝒢</mi><mi id="S4.SS2.p1.13.m7.1.1.3" mathvariant="normal" xref="S4.SS2.p1.13.m7.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m7.1b"><apply id="S4.SS2.p1.13.m7.1.1.cmml" xref="S4.SS2.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m7.1.1.1.cmml" xref="S4.SS2.p1.13.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.13.m7.1.1.2.cmml" xref="S4.SS2.p1.13.m7.1.1.2">𝒢</ci><ci id="S4.SS2.p1.13.m7.1.1.3.cmml" xref="S4.SS2.p1.13.m7.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m7.1c">\mathbfcal{G}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.13.m7.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="S4.SS2.p1.14.m8.1"><semantics id="S4.SS2.p1.14.m8.1a"><mi id="S4.SS2.p1.14.m8.1.1" mathvariant="normal" xref="S4.SS2.p1.14.m8.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m8.1b"><ci id="S4.SS2.p1.14.m8.1.1.cmml" xref="S4.SS2.p1.14.m8.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m8.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.14.m8.1d">roman_𝒳</annotation></semantics></math> can be computed as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.Ex3.m1.1"><semantics id="S4.Ex3.m1.1a"><msub id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.2" xref="S4.Ex3.m1.1.1.2.cmml">𝐠</mi><msub id="S4.Ex3.m1.1.1.3" xref="S4.Ex3.m1.1.1.3.cmml"><mi id="S4.Ex3.m1.1.1.3.2" mathvariant="normal" xref="S4.Ex3.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.Ex3.m1.1.1.3.3" mathvariant="normal" xref="S4.Ex3.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.cmml" xref="S4.Ex3.m1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.2">𝐠</ci><apply id="S4.Ex3.m1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.3.2">𝒢</ci><ci id="S4.Ex3.m1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mbox{\bf einsum}\big{(}bn_{1}\ldots n_{d},bn_{d+1}\ldots n_{2d}%
,S_{1},\ldots,S_{i-1},S_{i+1},\ldots,S_{2d}\Rightarrow S_{i}," class="ltx_math_unparsed" display="inline" id="S4.Ex3.m2.2"><semantics id="S4.Ex3.m2.2a"><mrow id="S4.Ex3.m2.2b"><mo id="S4.Ex3.m2.2.3">=</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.2.4">einsum</mtext><mrow id="S4.Ex3.m2.2.5"><mo id="S4.Ex3.m2.2.5.1" maxsize="120%" minsize="120%">(</mo><mi id="S4.Ex3.m2.2.5.2">b</mi><msub id="S4.Ex3.m2.2.5.3"><mi id="S4.Ex3.m2.2.5.3.2">n</mi><mn id="S4.Ex3.m2.2.5.3.3">1</mn></msub><mi id="S4.Ex3.m2.2.5.4" mathvariant="normal">…</mi><msub id="S4.Ex3.m2.2.5.5"><mi id="S4.Ex3.m2.2.5.5.2">n</mi><mi id="S4.Ex3.m2.2.5.5.3">d</mi></msub><mo id="S4.Ex3.m2.2.5.6">,</mo><mi id="S4.Ex3.m2.2.5.7">b</mi><msub id="S4.Ex3.m2.2.5.8"><mi id="S4.Ex3.m2.2.5.8.2">n</mi><mrow id="S4.Ex3.m2.2.5.8.3"><mi id="S4.Ex3.m2.2.5.8.3.2">d</mi><mo id="S4.Ex3.m2.2.5.8.3.1">+</mo><mn id="S4.Ex3.m2.2.5.8.3.3">1</mn></mrow></msub><mi id="S4.Ex3.m2.2.5.9" mathvariant="normal">…</mi><msub id="S4.Ex3.m2.2.5.10"><mi id="S4.Ex3.m2.2.5.10.2">n</mi><mrow id="S4.Ex3.m2.2.5.10.3"><mn id="S4.Ex3.m2.2.5.10.3.2">2</mn><mo id="S4.Ex3.m2.2.5.10.3.1">⁢</mo><mi id="S4.Ex3.m2.2.5.10.3.3">d</mi></mrow></msub><mo id="S4.Ex3.m2.2.5.11">,</mo><msub id="S4.Ex3.m2.2.5.12"><mi id="S4.Ex3.m2.2.5.12.2">S</mi><mn id="S4.Ex3.m2.2.5.12.3">1</mn></msub><mo id="S4.Ex3.m2.2.5.13">,</mo><mi id="S4.Ex3.m2.1.1" mathvariant="normal">…</mi><mo id="S4.Ex3.m2.2.5.14">,</mo><msub id="S4.Ex3.m2.2.5.15"><mi id="S4.Ex3.m2.2.5.15.2">S</mi><mrow id="S4.Ex3.m2.2.5.15.3"><mi id="S4.Ex3.m2.2.5.15.3.2">i</mi><mo id="S4.Ex3.m2.2.5.15.3.1">−</mo><mn id="S4.Ex3.m2.2.5.15.3.3">1</mn></mrow></msub><mo id="S4.Ex3.m2.2.5.16">,</mo><msub id="S4.Ex3.m2.2.5.17"><mi id="S4.Ex3.m2.2.5.17.2">S</mi><mrow id="S4.Ex3.m2.2.5.17.3"><mi id="S4.Ex3.m2.2.5.17.3.2">i</mi><mo id="S4.Ex3.m2.2.5.17.3.1">+</mo><mn id="S4.Ex3.m2.2.5.17.3.3">1</mn></mrow></msub><mo id="S4.Ex3.m2.2.5.18">,</mo><mi id="S4.Ex3.m2.2.2" mathvariant="normal">…</mi><mo id="S4.Ex3.m2.2.5.19">,</mo><msub id="S4.Ex3.m2.2.5.20"><mi id="S4.Ex3.m2.2.5.20.2">S</mi><mrow id="S4.Ex3.m2.2.5.20.3"><mn id="S4.Ex3.m2.2.5.20.3.2">2</mn><mo id="S4.Ex3.m2.2.5.20.3.1">⁢</mo><mi id="S4.Ex3.m2.2.5.20.3.3">d</mi></mrow></msub><mo id="S4.Ex3.m2.2.5.21" stretchy="false">⇒</mo><msub id="S4.Ex3.m2.2.5.22"><mi id="S4.Ex3.m2.2.5.22.2">S</mi><mi id="S4.Ex3.m2.2.5.22.3">i</mi></msub><mo id="S4.Ex3.m2.2.5.23">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex3.m2.2c">\displaystyle=\mbox{\bf einsum}\big{(}bn_{1}\ldots n_{d},bn_{d+1}\ldots n_{2d}%
,S_{1},\ldots,S_{i-1},S_{i+1},\ldots,S_{2d}\Rightarrow S_{i},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m2.2d">= einsum ( italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_S start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , … , italic_S start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\,[\mathbfcal{X},\mathbf{g}{Y},\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{i-1},%
\mathbfcal{G}_{i+1},\ldots,\mathbfcal{G}_{2d}])," class="ltx_math_unparsed" display="inline" id="S4.E20.m1.1"><semantics id="S4.E20.m1.1a"><mrow id="S4.E20.m1.1b"><mo id="S4.E20.m1.1.1" stretchy="false">[</mo><mi id="S4.E20.m1.1.2" mathvariant="normal">𝒳</mi><mi id="S4.E20.m1.1.3" mathvariant="normal">⇔</mi><mi id="S4.E20.m1.1.4" mathvariant="normal">}</mi><mi id="S4.E20.m1.1.5" mathvariant="normal">𝒴</mi><mi id="S4.E20.m1.1.6" mathvariant="normal">⇔</mi><msub id="S4.E20.m1.1.7"><mi id="S4.E20.m1.1.7.2" mathvariant="normal">𝒢</mi><mi id="S4.E20.m1.1.7.3" mathvariant="normal">∞</mi></msub><mi id="S4.E20.m1.1.8" mathvariant="normal">⇔</mi><mi id="S4.E20.m1.1.9" mathvariant="normal">…</mi><mi id="S4.E20.m1.1.10" mathvariant="normal">⇔</mi><msub id="S4.E20.m1.1.11"><mi id="S4.E20.m1.1.11.2" mathvariant="normal">𝒢</mi><mrow id="S4.E20.m1.1.11.3"><mi id="S4.E20.m1.1.11.3.2" mathvariant="normal">⟩</mi><mo id="S4.E20.m1.1.11.3.1">⁢</mo><mi id="S4.E20.m1.1.11.3.3" mathvariant="normal">↖</mi><mo id="S4.E20.m1.1.11.3.1a">⁢</mo><mi id="S4.E20.m1.1.11.3.4" mathvariant="normal">∞</mi></mrow></msub><mi id="S4.E20.m1.1.12" mathvariant="normal">⇔</mi><msub id="S4.E20.m1.1.13"><mi id="S4.E20.m1.1.13.2" mathvariant="normal">𝒢</mi><mrow id="S4.E20.m1.1.13.3"><mi id="S4.E20.m1.1.13.3.2" mathvariant="normal">⟩</mi><mo id="S4.E20.m1.1.13.3.1">⁢</mo><mi id="S4.E20.m1.1.13.3.3" mathvariant="normal">⇓</mi><mo id="S4.E20.m1.1.13.3.1a">⁢</mo><mi id="S4.E20.m1.1.13.3.4" mathvariant="normal">∞</mi></mrow></msub><mi id="S4.E20.m1.1.14" mathvariant="normal">⇔</mi><mi id="S4.E20.m1.1.15" mathvariant="normal">…</mi><mi id="S4.E20.m1.1.16" mathvariant="normal">⇔</mi><msub id="S4.E20.m1.1.17"><mi id="S4.E20.m1.1.17.2" mathvariant="normal">𝒢</mi><mrow id="S4.E20.m1.1.17.3"><mi id="S4.E20.m1.1.17.3.2" mathvariant="normal">∈</mi><mo id="S4.E20.m1.1.17.3.1">⁢</mo><mi id="S4.E20.m1.1.17.3.3" mathvariant="normal">⌈</mi></mrow></msub><mi id="S4.E20.m1.1.18" mathvariant="normal">⊌</mi><mi id="S4.E20.m1.1.19" mathvariant="normal">⇒</mi><mi id="S4.E20.m1.1.20" mathvariant="normal">⇔</mi></mrow><annotation encoding="application/x-tex" id="S4.E20.m1.1c">\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\,[\mathbfcal{X},\mathbf{g}{Y},\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{i-1},%
\mathbfcal{G}_{i+1},\ldots,\mathbfcal{G}_{2d}]),</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m1.1d">[ roman_𝒳 ⇔ } roman_𝒴 ⇔ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ⟩ ↖ ∞ end_POSTSUBSCRIPT ⇔ roman_𝒢 start_POSTSUBSCRIPT ⟩ ⇓ ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT ⊌ ⇒ ⇔</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="S4.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{g}_{\mathbfcal{X}}" class="ltx_Math" display="inline" id="S4.E21.m1.1"><semantics id="S4.E21.m1.1a"><msub id="S4.E21.m1.1.1" xref="S4.E21.m1.1.1.cmml"><mi id="S4.E21.m1.1.1.2" xref="S4.E21.m1.1.1.2.cmml">𝐠</mi><mi id="S4.E21.m1.1.1.3" mathvariant="normal" xref="S4.E21.m1.1.1.3.cmml">𝒳</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E21.m1.1b"><apply id="S4.E21.m1.1.1.cmml" xref="S4.E21.m1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.1.cmml" xref="S4.E21.m1.1.1">subscript</csymbol><ci id="S4.E21.m1.1.1.2.cmml" xref="S4.E21.m1.1.1.2">𝐠</ci><ci id="S4.E21.m1.1.1.3.cmml" xref="S4.E21.m1.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.1c">\displaystyle\mathbf{g}_{\mathbfcal{X}}</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒳 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mbox{\bf einsum}\big{(}bn_{d+1}\ldots n_{2d},S_{1},\ldots,S_{2d%
}\Rightarrow bn_{1}\ldots n_{d},[\mathbf{g}{Y},\mathbfcal{G}_{1},\ldots,%
\mathbfcal{G}_{2d}])." class="ltx_math_unparsed" display="inline" id="S4.E21.m2.1"><semantics id="S4.E21.m2.1a"><mrow id="S4.E21.m2.1b"><mo id="S4.E21.m2.1.2">=</mo><mtext class="ltx_mathvariant_bold" id="S4.E21.m2.1.3">einsum</mtext><mrow id="S4.E21.m2.1.4"><mo id="S4.E21.m2.1.4.1" maxsize="120%" minsize="120%">(</mo><mi id="S4.E21.m2.1.4.2">b</mi><msub id="S4.E21.m2.1.4.3"><mi id="S4.E21.m2.1.4.3.2">n</mi><mrow id="S4.E21.m2.1.4.3.3"><mi id="S4.E21.m2.1.4.3.3.2">d</mi><mo id="S4.E21.m2.1.4.3.3.1">+</mo><mn id="S4.E21.m2.1.4.3.3.3">1</mn></mrow></msub><mi id="S4.E21.m2.1.4.4" mathvariant="normal">…</mi><msub id="S4.E21.m2.1.4.5"><mi id="S4.E21.m2.1.4.5.2">n</mi><mrow id="S4.E21.m2.1.4.5.3"><mn id="S4.E21.m2.1.4.5.3.2">2</mn><mo id="S4.E21.m2.1.4.5.3.1">⁢</mo><mi id="S4.E21.m2.1.4.5.3.3">d</mi></mrow></msub><mo id="S4.E21.m2.1.4.6">,</mo><msub id="S4.E21.m2.1.4.7"><mi id="S4.E21.m2.1.4.7.2">S</mi><mn id="S4.E21.m2.1.4.7.3">1</mn></msub><mo id="S4.E21.m2.1.4.8">,</mo><mi id="S4.E21.m2.1.1" mathvariant="normal">…</mi><mo id="S4.E21.m2.1.4.9">,</mo><msub id="S4.E21.m2.1.4.10"><mi id="S4.E21.m2.1.4.10.2">S</mi><mrow id="S4.E21.m2.1.4.10.3"><mn id="S4.E21.m2.1.4.10.3.2">2</mn><mo id="S4.E21.m2.1.4.10.3.1">⁢</mo><mi id="S4.E21.m2.1.4.10.3.3">d</mi></mrow></msub><mo id="S4.E21.m2.1.4.11" stretchy="false">⇒</mo><mi id="S4.E21.m2.1.4.12">b</mi><msub id="S4.E21.m2.1.4.13"><mi id="S4.E21.m2.1.4.13.2">n</mi><mn id="S4.E21.m2.1.4.13.3">1</mn></msub><mi id="S4.E21.m2.1.4.14" mathvariant="normal">…</mi><msub id="S4.E21.m2.1.4.15"><mi id="S4.E21.m2.1.4.15.2">n</mi><mi id="S4.E21.m2.1.4.15.3">d</mi></msub><mo id="S4.E21.m2.1.4.16">,</mo><mrow id="S4.E21.m2.1.4.17"><mo id="S4.E21.m2.1.4.17.1" stretchy="false">[</mo><mi id="S4.E21.m2.1.4.17.2">𝐠</mi><mi id="S4.E21.m2.1.4.17.3">Y</mi><mo id="S4.E21.m2.1.4.17.4">,</mo><msub id="S4.E21.m2.1.4.17.5"><mi id="S4.E21.m2.1.4.17.5.2" mathvariant="normal">𝒢</mi><mi id="S4.E21.m2.1.4.17.5.3" mathvariant="normal">∞</mi></msub><mi id="S4.E21.m2.1.4.17.6" mathvariant="normal">⇔</mi><mi id="S4.E21.m2.1.4.17.7" mathvariant="normal">…</mi><mi id="S4.E21.m2.1.4.17.8" mathvariant="normal">⇔</mi><msub id="S4.E21.m2.1.4.17.9"><mi id="S4.E21.m2.1.4.17.9.2" mathvariant="normal">𝒢</mi><mrow id="S4.E21.m2.1.4.17.9.3"><mi id="S4.E21.m2.1.4.17.9.3.2" mathvariant="normal">∈</mi><mo id="S4.E21.m2.1.4.17.9.3.1">⁢</mo><mi id="S4.E21.m2.1.4.17.9.3.3" mathvariant="normal">⌈</mi></mrow></msub><mi id="S4.E21.m2.1.4.17.10" mathvariant="normal">⊌</mi><mi id="S4.E21.m2.1.4.17.11" mathvariant="normal">⇒</mi><mi id="S4.E21.m2.1.4.17.12" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E21.m2.1c">\displaystyle=\mbox{\bf einsum}\big{(}bn_{d+1}\ldots n_{2d},S_{1},\ldots,S_{2d%
}\Rightarrow bn_{1}\ldots n_{d},[\mathbf{g}{Y},\mathbfcal{G}_{1},\ldots,%
\mathbfcal{G}_{2d}]).</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m2.1d">= einsum ( italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_S start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ bold_g italic_Y , roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.15">In total, <math alttext="2d+2" class="ltx_Math" display="inline" id="S4.SS2.p1.15.m1.1"><semantics id="S4.SS2.p1.15.m1.1a"><mrow id="S4.SS2.p1.15.m1.1.1" xref="S4.SS2.p1.15.m1.1.1.cmml"><mrow id="S4.SS2.p1.15.m1.1.1.2" xref="S4.SS2.p1.15.m1.1.1.2.cmml"><mn id="S4.SS2.p1.15.m1.1.1.2.2" xref="S4.SS2.p1.15.m1.1.1.2.2.cmml">2</mn><mo id="S4.SS2.p1.15.m1.1.1.2.1" xref="S4.SS2.p1.15.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.15.m1.1.1.2.3" xref="S4.SS2.p1.15.m1.1.1.2.3.cmml">d</mi></mrow><mo id="S4.SS2.p1.15.m1.1.1.1" xref="S4.SS2.p1.15.m1.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.15.m1.1.1.3" xref="S4.SS2.p1.15.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m1.1b"><apply id="S4.SS2.p1.15.m1.1.1.cmml" xref="S4.SS2.p1.15.m1.1.1"><plus id="S4.SS2.p1.15.m1.1.1.1.cmml" xref="S4.SS2.p1.15.m1.1.1.1"></plus><apply id="S4.SS2.p1.15.m1.1.1.2.cmml" xref="S4.SS2.p1.15.m1.1.1.2"><times id="S4.SS2.p1.15.m1.1.1.2.1.cmml" xref="S4.SS2.p1.15.m1.1.1.2.1"></times><cn id="S4.SS2.p1.15.m1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p1.15.m1.1.1.2.2">2</cn><ci id="S4.SS2.p1.15.m1.1.1.2.3.cmml" xref="S4.SS2.p1.15.m1.1.1.2.3">𝑑</ci></apply><cn id="S4.SS2.p1.15.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.15.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m1.1c">2d+2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.15.m1.1d">2 italic_d + 2</annotation></semantics></math> contraction sequences are needed for the TT-format forward- and back- propagation. To reduce the computational costs, it is critical to find an optimal or near-optimal contraction path.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Large batch case.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.2">We denote <math alttext="\mathbfcal{A}_{i}:=\mathbfcal{G}_{1}\times\cdots\times\mathbfcal{G}_{i},%
\mathbfcal{A}_{-i}=\mathbfcal{G}_{d-i+1}\times\cdots\times\mathbfcal{G}_{d},%
\mathbfcal{B}_{i}:=\mathbfcal{G}_{d+1}\times\cdots\times\mathbfcal{G}_{d+i},%
\mathbfcal{B}_{-i}=\mathbfcal{G}_{2d-i+1}\times\cdots\times\mathbfcal{G}_{2d}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.cmml"><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.2.cmml">𝒜</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.3.cmml">⟩</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.3.cmml">¬</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.4" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.4.cmml">ℑ</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.3.cmml">∞</mi></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1.cmml">×</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.3.cmml">⟩</mi></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.3.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.2.cmml">𝒜</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.2.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.3.cmml">⟩</mi></mrow></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.5.cmml">ℑ</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1c" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.2.cmml">𝒢</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.2.cmml">⌈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.3.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.4" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.4.cmml">⟩</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.5.cmml">⇓</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1c" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.6" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.6.cmml">∞</mi></mrow></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1.cmml">×</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.2.cmml">𝒢</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.3.cmml">⌈</mi></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.3.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.2.cmml">ℬ</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.3.cmml">⟩</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.5.cmml">¬</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1c" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.6" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.6.cmml">ℑ</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1d" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.2.cmml">𝒢</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.2.cmml">⌈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.3.cmml">⇓</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.4" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.4.cmml">∞</mi></mrow></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml">×</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.2.cmml">𝒢</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.2.cmml">⌈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.3.cmml">⇓</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.4" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.4.cmml">⟩</mi></mrow></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.2.cmml">ℬ</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.2.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.3.cmml">⟩</mi></mrow></msub><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.5.cmml">ℑ</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1c" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.2.cmml">𝒢</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.2.cmml">∈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.3.cmml">⌈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1a" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.4" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.4.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1b" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.5.cmml">⟩</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1c" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.6" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.6.cmml">⇓</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1d" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.7" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.7.cmml">∞</mi></mrow></msub></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.2.cmml">𝒢</mi><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.2.cmml">∈</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.3.cmml">⌈</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.2">𝒜</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.2.3">⟩</ci></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.3">¬</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.4">ℑ</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.2">𝒢</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.2.5.3">∞</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.3">⋯</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.2">𝒢</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.2.4.3">⟩</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.3">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.2">𝒜</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.2">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.4.3.3">⟩</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.5">ℑ</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.2">𝒢</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.2">⌈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.3">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.4">⟩</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.5">⇓</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.6.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.2.6.3.6">∞</ci></apply></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.3">⋯</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.2">𝒢</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.2.4.3">⌈</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.3">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.2">ℬ</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.4.3">⟩</ci></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.5">¬</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.6.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.6">ℑ</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.2">𝒢</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.2">⌈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.3">⇓</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.2.7.3.4">∞</ci></apply></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.3">⋯</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.2">𝒢</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.2">⌈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.3">⇓</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.4.3.4">⟩</ci></apply></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.3">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.2">ℬ</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.2">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.4.3.3">⟩</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.5">ℑ</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.2">𝒢</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.2">∈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.3">⌈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.4">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.5">⟩</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.6.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.6">⇓</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.7.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.6.3.7">∞</ci></apply></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3">⋯</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.2">𝒢</ci><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3"><times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.2">∈</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.3.3">⌈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">\mathbfcal{A}_{i}:=\mathbfcal{G}_{1}\times\cdots\times\mathbfcal{G}_{i},%
\mathbfcal{A}_{-i}=\mathbfcal{G}_{d-i+1}\times\cdots\times\mathbfcal{G}_{d},%
\mathbfcal{B}_{i}:=\mathbfcal{G}_{d+1}\times\cdots\times\mathbfcal{G}_{d+i},%
\mathbfcal{B}_{-i}=\mathbfcal{G}_{2d-i+1}\times\cdots\times\mathbfcal{G}_{2d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">roman_𝒜 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ¬ roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT × ⋯ × roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ↖ ⟩ end_POSTSUBSCRIPT roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ⌈ ↖ ⟩ ⇓ ∞ end_POSTSUBSCRIPT × ⋯ × roman_𝒢 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ¬ roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ⌈ ⇓ ∞ end_POSTSUBSCRIPT × ⋯ × roman_𝒢 start_POSTSUBSCRIPT ⌈ ⇓ ⟩ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ↖ ⟩ end_POSTSUBSCRIPT roman_ℑ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ ↖ ⟩ ⇓ ∞ end_POSTSUBSCRIPT × ⋯ × roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT</annotation></semantics></math>,
which are all computed sequentially. In practice, we only need to compute <math alttext="\mathbfcal{A}_{d},\mathbfcal{A}_{-d},\mathbfcal{B}_{d},\mathbfcal{B}_{-d}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">𝒜</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">⌈</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1a" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.2.cmml">𝒜</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.2.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.3.cmml">⌈</mi></mrow></msub><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1b" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.5" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.5.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1c" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.2.cmml">ℬ</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.3.cmml">⌈</mi></msub><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1d" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.7" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.7.cmml">⇔</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1e" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.2.cmml">ℬ</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.2" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.2.cmml">↖</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.3.cmml">⌈</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1"></times><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.2">𝒜</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.3">⌈</ci></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.2">𝒜</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3"><times id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.2">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.4.3.3">⌈</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.5.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.5">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.2">ℬ</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.6.3">⌈</ci></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.7.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.7">⇔</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.2">ℬ</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3"><times id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.2">↖</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.8.3.3">⌈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">\mathbfcal{A}_{d},\mathbfcal{A}_{-d},\mathbfcal{B}_{d},\mathbfcal{B}_{-d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">roman_𝒜 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ↖ ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ↖ ⌈ end_POSTSUBSCRIPT</annotation></semantics></math> and store the intermediate results. The forward-propagation (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E19" title="In 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">19</span></a>) is then computed in the following way</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx4">
<tbody id="S4.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{T}_{1}" class="ltx_Math" display="inline" id="S4.E22.m1.1"><semantics id="S4.E22.m1.1a"><msub id="S4.E22.m1.1.1" xref="S4.E22.m1.1.1.cmml"><mi id="S4.E22.m1.1.1.2" mathvariant="normal" xref="S4.E22.m1.1.1.2.cmml">𝒯</mi><mi id="S4.E22.m1.1.1.3" mathvariant="normal" xref="S4.E22.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E22.m1.1b"><apply id="S4.E22.m1.1.1.cmml" xref="S4.E22.m1.1.1"><csymbol cd="ambiguous" id="S4.E22.m1.1.1.1.cmml" xref="S4.E22.m1.1.1">subscript</csymbol><ci id="S4.E22.m1.1.1.2.cmml" xref="S4.E22.m1.1.1.2">𝒯</ci><ci id="S4.E22.m1.1.1.3.cmml" xref="S4.E22.m1.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m1.1c">\displaystyle\mathbfcal{T}_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m1.1d">roman_𝒯 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E22.m2.1"><semantics id="S4.E22.m2.1a"><mo id="S4.E22.m2.1.1" xref="S4.E22.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E22.m2.1b"><eq id="S4.E22.m2.1.1.cmml" xref="S4.E22.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(bn_{1}\ldots n_{d},n_{1}\ldots n_{d}r_{d}%
\Rightarrow br_{d},[\mathbfcal{X},\mathbfcal{A}_{d}])" class="ltx_math_unparsed" display="inline" id="S4.E22.m3.1"><semantics id="S4.E22.m3.1a"><mrow id="S4.E22.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E22.m3.1.1">einsum</mtext><mrow id="S4.E22.m3.1.2"><mo id="S4.E22.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E22.m3.1.2.2">b</mi><msub id="S4.E22.m3.1.2.3"><mi id="S4.E22.m3.1.2.3.2">n</mi><mn id="S4.E22.m3.1.2.3.3">1</mn></msub><mi id="S4.E22.m3.1.2.4" mathvariant="normal">…</mi><msub id="S4.E22.m3.1.2.5"><mi id="S4.E22.m3.1.2.5.2">n</mi><mi id="S4.E22.m3.1.2.5.3">d</mi></msub><mo id="S4.E22.m3.1.2.6">,</mo><msub id="S4.E22.m3.1.2.7"><mi id="S4.E22.m3.1.2.7.2">n</mi><mn id="S4.E22.m3.1.2.7.3">1</mn></msub><mi id="S4.E22.m3.1.2.8" mathvariant="normal">…</mi><msub id="S4.E22.m3.1.2.9"><mi id="S4.E22.m3.1.2.9.2">n</mi><mi id="S4.E22.m3.1.2.9.3">d</mi></msub><msub id="S4.E22.m3.1.2.10"><mi id="S4.E22.m3.1.2.10.2">r</mi><mi id="S4.E22.m3.1.2.10.3">d</mi></msub><mo id="S4.E22.m3.1.2.11" stretchy="false">⇒</mo><mi id="S4.E22.m3.1.2.12">b</mi><msub id="S4.E22.m3.1.2.13"><mi id="S4.E22.m3.1.2.13.2">r</mi><mi id="S4.E22.m3.1.2.13.3">d</mi></msub><mo id="S4.E22.m3.1.2.14">,</mo><mrow id="S4.E22.m3.1.2.15"><mo id="S4.E22.m3.1.2.15.1" stretchy="false">[</mo><mi id="S4.E22.m3.1.2.15.2" mathvariant="normal">𝒳</mi><mi id="S4.E22.m3.1.2.15.3" mathvariant="normal">⇔</mi><msub id="S4.E22.m3.1.2.15.4"><mi id="S4.E22.m3.1.2.15.4.2" mathvariant="normal">𝒜</mi><mi id="S4.E22.m3.1.2.15.4.3" mathvariant="normal">⌈</mi></msub><mi id="S4.E22.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E22.m3.1.2.15.6" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E22.m3.1c">\displaystyle\mbox{\bf einsum}(bn_{1}\ldots n_{d},n_{1}\ldots n_{d}r_{d}%
\Rightarrow br_{d},[\mathbfcal{X},\mathbfcal{A}_{d}])</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m3.1d">einsum ( italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ roman_𝒳 ⇔ roman_𝒜 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⊌ ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
<tbody id="S4.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{Y}" class="ltx_Math" display="inline" id="S4.E23.m1.1"><semantics id="S4.E23.m1.1a"><mi id="S4.E23.m1.1.1" mathvariant="normal" xref="S4.E23.m1.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S4.E23.m1.1b"><ci id="S4.E23.m1.1.1.cmml" xref="S4.E23.m1.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m1.1c">\displaystyle\mathbfcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m1.1d">roman_𝒴</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E23.m2.1"><semantics id="S4.E23.m2.1a"><mo id="S4.E23.m2.1.1" xref="S4.E23.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E23.m2.1b"><eq id="S4.E23.m2.1.1.cmml" xref="S4.E23.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(br_{d},r_{d}n_{d+1}\ldots n_{2d}\Rightarrow bn_%
{1}\ldots n_{d},[\mathbfcal{T}_{1},\mathbfcal{B}_{d}])." class="ltx_math_unparsed" display="inline" id="S4.E23.m3.1"><semantics id="S4.E23.m3.1a"><mrow id="S4.E23.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E23.m3.1.1">einsum</mtext><mrow id="S4.E23.m3.1.2"><mo id="S4.E23.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E23.m3.1.2.2">b</mi><msub id="S4.E23.m3.1.2.3"><mi id="S4.E23.m3.1.2.3.2">r</mi><mi id="S4.E23.m3.1.2.3.3">d</mi></msub><mo id="S4.E23.m3.1.2.4">,</mo><msub id="S4.E23.m3.1.2.5"><mi id="S4.E23.m3.1.2.5.2">r</mi><mi id="S4.E23.m3.1.2.5.3">d</mi></msub><msub id="S4.E23.m3.1.2.6"><mi id="S4.E23.m3.1.2.6.2">n</mi><mrow id="S4.E23.m3.1.2.6.3"><mi id="S4.E23.m3.1.2.6.3.2">d</mi><mo id="S4.E23.m3.1.2.6.3.1">+</mo><mn id="S4.E23.m3.1.2.6.3.3">1</mn></mrow></msub><mi id="S4.E23.m3.1.2.7" mathvariant="normal">…</mi><msub id="S4.E23.m3.1.2.8"><mi id="S4.E23.m3.1.2.8.2">n</mi><mrow id="S4.E23.m3.1.2.8.3"><mn id="S4.E23.m3.1.2.8.3.2">2</mn><mo id="S4.E23.m3.1.2.8.3.1">⁢</mo><mi id="S4.E23.m3.1.2.8.3.3">d</mi></mrow></msub><mo id="S4.E23.m3.1.2.9" stretchy="false">⇒</mo><mi id="S4.E23.m3.1.2.10">b</mi><msub id="S4.E23.m3.1.2.11"><mi id="S4.E23.m3.1.2.11.2">n</mi><mn id="S4.E23.m3.1.2.11.3">1</mn></msub><mi id="S4.E23.m3.1.2.12" mathvariant="normal">…</mi><msub id="S4.E23.m3.1.2.13"><mi id="S4.E23.m3.1.2.13.2">n</mi><mi id="S4.E23.m3.1.2.13.3">d</mi></msub><mo id="S4.E23.m3.1.2.14">,</mo><mrow id="S4.E23.m3.1.2.15"><mo id="S4.E23.m3.1.2.15.1" stretchy="false">[</mo><msub id="S4.E23.m3.1.2.15.2"><mi id="S4.E23.m3.1.2.15.2.2" mathvariant="normal">𝒯</mi><mi id="S4.E23.m3.1.2.15.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E23.m3.1.2.15.3" mathvariant="normal">⇔</mi><msub id="S4.E23.m3.1.2.15.4"><mi id="S4.E23.m3.1.2.15.4.2" mathvariant="normal">ℬ</mi><mi id="S4.E23.m3.1.2.15.4.3" mathvariant="normal">⌈</mi></msub><mi id="S4.E23.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E23.m3.1.2.15.6" mathvariant="normal">⇒</mi><mi id="S4.E23.m3.1.2.15.7" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E23.m3.1c">\displaystyle\mbox{\bf einsum}(br_{d},r_{d}n_{d+1}\ldots n_{2d}\Rightarrow bn_%
{1}\ldots n_{d},[\mathbfcal{T}_{1},\mathbfcal{B}_{d}]).</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m3.1d">einsum ( italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ roman_𝒯 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.3">In backward propagation, the gradients are computed in the following way:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">The gradient <math alttext="\mathbf{g}{X}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">𝐠</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><times id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1"></times><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝐠</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\mathbf{g}{X}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">bold_g italic_X</annotation></semantics></math> is computed as</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx5">
<tbody id="S4.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{U}_{1}" class="ltx_Math" display="inline" id="S4.E24.m1.1"><semantics id="S4.E24.m1.1a"><msub id="S4.E24.m1.1.1" xref="S4.E24.m1.1.1.cmml"><mi id="S4.E24.m1.1.1.2" mathvariant="normal" xref="S4.E24.m1.1.1.2.cmml">𝒰</mi><mi id="S4.E24.m1.1.1.3" mathvariant="normal" xref="S4.E24.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E24.m1.1b"><apply id="S4.E24.m1.1.1.cmml" xref="S4.E24.m1.1.1"><csymbol cd="ambiguous" id="S4.E24.m1.1.1.1.cmml" xref="S4.E24.m1.1.1">subscript</csymbol><ci id="S4.E24.m1.1.1.2.cmml" xref="S4.E24.m1.1.1.2">𝒰</ci><ci id="S4.E24.m1.1.1.3.cmml" xref="S4.E24.m1.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m1.1c">\displaystyle\mathbfcal{U}_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m1.1d">roman_𝒰 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E24.m2.1"><semantics id="S4.E24.m2.1a"><mo id="S4.E24.m2.1.1" xref="S4.E24.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E24.m2.1b"><eq id="S4.E24.m2.1.1.cmml" xref="S4.E24.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(bn_{d+1}\ldots n_{2d},r_{d}n_{d+1}\ldots n_{2d}%
\Rightarrow br_{d},[\mathbf{g}_{\mathbfcal{Y}},\mathbfcal{B}_{d}])" class="ltx_math_unparsed" display="inline" id="S4.E24.m3.1"><semantics id="S4.E24.m3.1a"><mrow id="S4.E24.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E24.m3.1.1">einsum</mtext><mrow id="S4.E24.m3.1.2"><mo id="S4.E24.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E24.m3.1.2.2">b</mi><msub id="S4.E24.m3.1.2.3"><mi id="S4.E24.m3.1.2.3.2">n</mi><mrow id="S4.E24.m3.1.2.3.3"><mi id="S4.E24.m3.1.2.3.3.2">d</mi><mo id="S4.E24.m3.1.2.3.3.1">+</mo><mn id="S4.E24.m3.1.2.3.3.3">1</mn></mrow></msub><mi id="S4.E24.m3.1.2.4" mathvariant="normal">…</mi><msub id="S4.E24.m3.1.2.5"><mi id="S4.E24.m3.1.2.5.2">n</mi><mrow id="S4.E24.m3.1.2.5.3"><mn id="S4.E24.m3.1.2.5.3.2">2</mn><mo id="S4.E24.m3.1.2.5.3.1">⁢</mo><mi id="S4.E24.m3.1.2.5.3.3">d</mi></mrow></msub><mo id="S4.E24.m3.1.2.6">,</mo><msub id="S4.E24.m3.1.2.7"><mi id="S4.E24.m3.1.2.7.2">r</mi><mi id="S4.E24.m3.1.2.7.3">d</mi></msub><msub id="S4.E24.m3.1.2.8"><mi id="S4.E24.m3.1.2.8.2">n</mi><mrow id="S4.E24.m3.1.2.8.3"><mi id="S4.E24.m3.1.2.8.3.2">d</mi><mo id="S4.E24.m3.1.2.8.3.1">+</mo><mn id="S4.E24.m3.1.2.8.3.3">1</mn></mrow></msub><mi id="S4.E24.m3.1.2.9" mathvariant="normal">…</mi><msub id="S4.E24.m3.1.2.10"><mi id="S4.E24.m3.1.2.10.2">n</mi><mrow id="S4.E24.m3.1.2.10.3"><mn id="S4.E24.m3.1.2.10.3.2">2</mn><mo id="S4.E24.m3.1.2.10.3.1">⁢</mo><mi id="S4.E24.m3.1.2.10.3.3">d</mi></mrow></msub><mo id="S4.E24.m3.1.2.11" stretchy="false">⇒</mo><mi id="S4.E24.m3.1.2.12">b</mi><msub id="S4.E24.m3.1.2.13"><mi id="S4.E24.m3.1.2.13.2">r</mi><mi id="S4.E24.m3.1.2.13.3">d</mi></msub><mo id="S4.E24.m3.1.2.14">,</mo><mrow id="S4.E24.m3.1.2.15"><mo id="S4.E24.m3.1.2.15.1" stretchy="false">[</mo><msub id="S4.E24.m3.1.2.15.2"><mi id="S4.E24.m3.1.2.15.2.2">𝐠</mi><mi id="S4.E24.m3.1.2.15.2.3" mathvariant="normal">𝒴</mi></msub><mo id="S4.E24.m3.1.2.15.3">,</mo><msub id="S4.E24.m3.1.2.15.4"><mi id="S4.E24.m3.1.2.15.4.2" mathvariant="normal">ℬ</mi><mi id="S4.E24.m3.1.2.15.4.3" mathvariant="normal">⌈</mi></msub><mi id="S4.E24.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E24.m3.1.2.15.6" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E24.m3.1c">\displaystyle\mbox{\bf einsum}(bn_{d+1}\ldots n_{2d},r_{d}n_{d+1}\ldots n_{2d}%
\Rightarrow br_{d},[\mathbf{g}_{\mathbfcal{Y}},\mathbfcal{B}_{d}])</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m3.1d">einsum ( italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ bold_g start_POSTSUBSCRIPT roman_𝒴 end_POSTSUBSCRIPT , roman_ℬ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⊌ ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="S4.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{g}{X}" class="ltx_Math" display="inline" id="S4.E25.m1.1"><semantics id="S4.E25.m1.1a"><mrow id="S4.E25.m1.1.1" xref="S4.E25.m1.1.1.cmml"><mi id="S4.E25.m1.1.1.2" xref="S4.E25.m1.1.1.2.cmml">𝐠</mi><mo id="S4.E25.m1.1.1.1" xref="S4.E25.m1.1.1.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.3" xref="S4.E25.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E25.m1.1b"><apply id="S4.E25.m1.1.1.cmml" xref="S4.E25.m1.1.1"><times id="S4.E25.m1.1.1.1.cmml" xref="S4.E25.m1.1.1.1"></times><ci id="S4.E25.m1.1.1.2.cmml" xref="S4.E25.m1.1.1.2">𝐠</ci><ci id="S4.E25.m1.1.1.3.cmml" xref="S4.E25.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m1.1c">\displaystyle\mathbf{g}{X}</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m1.1d">bold_g italic_X</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E25.m2.1"><semantics id="S4.E25.m2.1a"><mo id="S4.E25.m2.1.1" xref="S4.E25.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E25.m2.1b"><eq id="S4.E25.m2.1.1.cmml" xref="S4.E25.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(br_{d},n_{1}\ldots n_{d}r_{d}\Rightarrow bn_{1}%
\ldots n_{d},[\mathbfcal{U}_{1},\mathbfcal{A}_{d}])." class="ltx_math_unparsed" display="inline" id="S4.E25.m3.1"><semantics id="S4.E25.m3.1a"><mrow id="S4.E25.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E25.m3.1.1">einsum</mtext><mrow id="S4.E25.m3.1.2"><mo id="S4.E25.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E25.m3.1.2.2">b</mi><msub id="S4.E25.m3.1.2.3"><mi id="S4.E25.m3.1.2.3.2">r</mi><mi id="S4.E25.m3.1.2.3.3">d</mi></msub><mo id="S4.E25.m3.1.2.4">,</mo><msub id="S4.E25.m3.1.2.5"><mi id="S4.E25.m3.1.2.5.2">n</mi><mn id="S4.E25.m3.1.2.5.3">1</mn></msub><mi id="S4.E25.m3.1.2.6" mathvariant="normal">…</mi><msub id="S4.E25.m3.1.2.7"><mi id="S4.E25.m3.1.2.7.2">n</mi><mi id="S4.E25.m3.1.2.7.3">d</mi></msub><msub id="S4.E25.m3.1.2.8"><mi id="S4.E25.m3.1.2.8.2">r</mi><mi id="S4.E25.m3.1.2.8.3">d</mi></msub><mo id="S4.E25.m3.1.2.9" stretchy="false">⇒</mo><mi id="S4.E25.m3.1.2.10">b</mi><msub id="S4.E25.m3.1.2.11"><mi id="S4.E25.m3.1.2.11.2">n</mi><mn id="S4.E25.m3.1.2.11.3">1</mn></msub><mi id="S4.E25.m3.1.2.12" mathvariant="normal">…</mi><msub id="S4.E25.m3.1.2.13"><mi id="S4.E25.m3.1.2.13.2">n</mi><mi id="S4.E25.m3.1.2.13.3">d</mi></msub><mo id="S4.E25.m3.1.2.14">,</mo><mrow id="S4.E25.m3.1.2.15"><mo id="S4.E25.m3.1.2.15.1" stretchy="false">[</mo><msub id="S4.E25.m3.1.2.15.2"><mi id="S4.E25.m3.1.2.15.2.2" mathvariant="normal">𝒰</mi><mi id="S4.E25.m3.1.2.15.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E25.m3.1.2.15.3" mathvariant="normal">⇔</mi><msub id="S4.E25.m3.1.2.15.4"><mi id="S4.E25.m3.1.2.15.4.2" mathvariant="normal">𝒜</mi><mi id="S4.E25.m3.1.2.15.4.3" mathvariant="normal">⌈</mi></msub><mi id="S4.E25.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E25.m3.1.2.15.6" mathvariant="normal">⇒</mi><mi id="S4.E25.m3.1.2.15.7" mathvariant="normal">↙</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E25.m3.1c">\displaystyle\mbox{\bf einsum}(br_{d},n_{1}\ldots n_{d}r_{d}\Rightarrow bn_{1}%
\ldots n_{d},[\mathbfcal{U}_{1},\mathbfcal{A}_{d}]).</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m3.1d">einsum ( italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ⇒ italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ roman_𝒰 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.2">The gradients <math alttext="\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">𝐠</mi><msub id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S4.I1.i2.p1.1.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S4.I1.i2.p1.1.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝐠</ci><apply id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2">𝒢</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="i\geq d+1" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">i</mi><mo id="S4.I1.i2.p1.2.m2.1.1.1" xref="S4.I1.i2.p1.2.m2.1.1.1.cmml">≥</mo><mrow id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.2.cmml">d</mi><mo id="S4.I1.i2.p1.2.m2.1.1.3.1" xref="S4.I1.i2.p1.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.I1.i2.p1.2.m2.1.1.3.3" xref="S4.I1.i2.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><geq id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.1"></geq><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">𝑖</ci><apply id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3"><plus id="S4.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.1"></plus><ci id="S4.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2">𝑑</ci><cn id="S4.I1.i2.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S4.I1.i2.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">i\geq d+1</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_i ≥ italic_d + 1</annotation></semantics></math> can be computed as</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx6">
<tbody id="S4.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{T}_{2}" class="ltx_Math" display="inline" id="S4.E26.m1.1"><semantics id="S4.E26.m1.1a"><msub id="S4.E26.m1.1.1" xref="S4.E26.m1.1.1.cmml"><mi id="S4.E26.m1.1.1.2" mathvariant="normal" xref="S4.E26.m1.1.1.2.cmml">𝒯</mi><mi id="S4.E26.m1.1.1.3" mathvariant="normal" xref="S4.E26.m1.1.1.3.cmml">∈</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E26.m1.1b"><apply id="S4.E26.m1.1.1.cmml" xref="S4.E26.m1.1.1"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.1.cmml" xref="S4.E26.m1.1.1">subscript</csymbol><ci id="S4.E26.m1.1.1.2.cmml" xref="S4.E26.m1.1.1.2">𝒯</ci><ci id="S4.E26.m1.1.1.3.cmml" xref="S4.E26.m1.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m1.1c">\displaystyle\mathbfcal{T}_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m1.1d">roman_𝒯 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E26.m2.1"><semantics id="S4.E26.m2.1a"><mo id="S4.E26.m2.1.1" xref="S4.E26.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E26.m2.1b"><eq id="S4.E26.m2.1.1.cmml" xref="S4.E26.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(br_{d},bn_{d+1}\ldots n_{2d}\Rightarrow r_{d}n_%
{d+1}\ldots n_{2d},[\mathbfcal{T}_{1},\mathbf{g}_{\mathbfcal{Y}}])" class="ltx_math_unparsed" display="inline" id="S4.E26.m3.1"><semantics id="S4.E26.m3.1a"><mrow id="S4.E26.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E26.m3.1.1">einsum</mtext><mrow id="S4.E26.m3.1.2"><mo id="S4.E26.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E26.m3.1.2.2">b</mi><msub id="S4.E26.m3.1.2.3"><mi id="S4.E26.m3.1.2.3.2">r</mi><mi id="S4.E26.m3.1.2.3.3">d</mi></msub><mo id="S4.E26.m3.1.2.4">,</mo><mi id="S4.E26.m3.1.2.5">b</mi><msub id="S4.E26.m3.1.2.6"><mi id="S4.E26.m3.1.2.6.2">n</mi><mrow id="S4.E26.m3.1.2.6.3"><mi id="S4.E26.m3.1.2.6.3.2">d</mi><mo id="S4.E26.m3.1.2.6.3.1">+</mo><mn id="S4.E26.m3.1.2.6.3.3">1</mn></mrow></msub><mi id="S4.E26.m3.1.2.7" mathvariant="normal">…</mi><msub id="S4.E26.m3.1.2.8"><mi id="S4.E26.m3.1.2.8.2">n</mi><mrow id="S4.E26.m3.1.2.8.3"><mn id="S4.E26.m3.1.2.8.3.2">2</mn><mo id="S4.E26.m3.1.2.8.3.1">⁢</mo><mi id="S4.E26.m3.1.2.8.3.3">d</mi></mrow></msub><mo id="S4.E26.m3.1.2.9" stretchy="false">⇒</mo><msub id="S4.E26.m3.1.2.10"><mi id="S4.E26.m3.1.2.10.2">r</mi><mi id="S4.E26.m3.1.2.10.3">d</mi></msub><msub id="S4.E26.m3.1.2.11"><mi id="S4.E26.m3.1.2.11.2">n</mi><mrow id="S4.E26.m3.1.2.11.3"><mi id="S4.E26.m3.1.2.11.3.2">d</mi><mo id="S4.E26.m3.1.2.11.3.1">+</mo><mn id="S4.E26.m3.1.2.11.3.3">1</mn></mrow></msub><mi id="S4.E26.m3.1.2.12" mathvariant="normal">…</mi><msub id="S4.E26.m3.1.2.13"><mi id="S4.E26.m3.1.2.13.2">n</mi><mrow id="S4.E26.m3.1.2.13.3"><mn id="S4.E26.m3.1.2.13.3.2">2</mn><mo id="S4.E26.m3.1.2.13.3.1">⁢</mo><mi id="S4.E26.m3.1.2.13.3.3">d</mi></mrow></msub><mo id="S4.E26.m3.1.2.14">,</mo><mrow id="S4.E26.m3.1.2.15"><mo id="S4.E26.m3.1.2.15.1" stretchy="false">[</mo><msub id="S4.E26.m3.1.2.15.2"><mi id="S4.E26.m3.1.2.15.2.2" mathvariant="normal">𝒯</mi><mi id="S4.E26.m3.1.2.15.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E26.m3.1.2.15.3" mathvariant="normal">⇔</mi><msub id="S4.E26.m3.1.2.15.4"><mi id="S4.E26.m3.1.2.15.4.2" mathvariant="normal">}</mi><mi id="S4.E26.m3.1.2.15.4.3" mathvariant="normal">𝒴</mi></msub><mi id="S4.E26.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E26.m3.1.2.15.6" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E26.m3.1c">\displaystyle\mbox{\bf einsum}(br_{d},bn_{d+1}\ldots n_{2d}\Rightarrow r_{d}n_%
{d+1}\ldots n_{2d},[\mathbfcal{T}_{1},\mathbf{g}_{\mathbfcal{Y}}])</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m3.1d">einsum ( italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒ italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , [ roman_𝒯 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ } start_POSTSUBSCRIPT roman_𝒴 end_POSTSUBSCRIPT ⊌ ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
<tbody id="S4.Ex4">
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.E27.m1.1"><semantics id="S4.E27.m1.1a"><msub id="S4.E27.m1.1.1" xref="S4.E27.m1.1.1.cmml"><mi id="S4.E27.m1.1.1.2" xref="S4.E27.m1.1.1.2.cmml">𝐠</mi><msub id="S4.E27.m1.1.1.3" xref="S4.E27.m1.1.1.3.cmml"><mi id="S4.E27.m1.1.1.3.2" mathvariant="normal" xref="S4.E27.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.E27.m1.1.1.3.3" mathvariant="normal" xref="S4.E27.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.E27.m1.1b"><apply id="S4.E27.m1.1.1.cmml" xref="S4.E27.m1.1.1"><csymbol cd="ambiguous" id="S4.E27.m1.1.1.1.cmml" xref="S4.E27.m1.1.1">subscript</csymbol><ci id="S4.E27.m1.1.1.2.cmml" xref="S4.E27.m1.1.1.2">𝐠</ci><apply id="S4.E27.m1.1.1.3.cmml" xref="S4.E27.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E27.m1.1.1.3.1.cmml" xref="S4.E27.m1.1.1.3">subscript</csymbol><ci id="S4.E27.m1.1.1.3.2.cmml" xref="S4.E27.m1.1.1.3.2">𝒢</ci><ci id="S4.E27.m1.1.1.3.3.cmml" xref="S4.E27.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m1.1c">\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E27.m2.1"><semantics id="S4.E27.m2.1a"><mo id="S4.E27.m2.1.1" xref="S4.E27.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E27.m2.1b"><eq id="S4.E27.m2.1.1.cmml" xref="S4.E27.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(r_{d}n_{d+1}\ldots n_{2d},r_{d}n_{d+1}\ldots n_%
{i-1}r_{i-1},r_{i}n_{i+1}\ldots n_{2d}\Rightarrow" class="ltx_math_unparsed" display="inline" id="S4.E27.m3.1"><semantics id="S4.E27.m3.1a"><mrow id="S4.E27.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E27.m3.1.1">einsum</mtext><mrow id="S4.E27.m3.1.2"><mo id="S4.E27.m3.1.2.1" stretchy="false">(</mo><msub id="S4.E27.m3.1.2.2"><mi id="S4.E27.m3.1.2.2.2">r</mi><mi id="S4.E27.m3.1.2.2.3">d</mi></msub><msub id="S4.E27.m3.1.2.3"><mi id="S4.E27.m3.1.2.3.2">n</mi><mrow id="S4.E27.m3.1.2.3.3"><mi id="S4.E27.m3.1.2.3.3.2">d</mi><mo id="S4.E27.m3.1.2.3.3.1">+</mo><mn id="S4.E27.m3.1.2.3.3.3">1</mn></mrow></msub><mi id="S4.E27.m3.1.2.4" mathvariant="normal">…</mi><msub id="S4.E27.m3.1.2.5"><mi id="S4.E27.m3.1.2.5.2">n</mi><mrow id="S4.E27.m3.1.2.5.3"><mn id="S4.E27.m3.1.2.5.3.2">2</mn><mo id="S4.E27.m3.1.2.5.3.1">⁢</mo><mi id="S4.E27.m3.1.2.5.3.3">d</mi></mrow></msub><mo id="S4.E27.m3.1.2.6">,</mo><msub id="S4.E27.m3.1.2.7"><mi id="S4.E27.m3.1.2.7.2">r</mi><mi id="S4.E27.m3.1.2.7.3">d</mi></msub><msub id="S4.E27.m3.1.2.8"><mi id="S4.E27.m3.1.2.8.2">n</mi><mrow id="S4.E27.m3.1.2.8.3"><mi id="S4.E27.m3.1.2.8.3.2">d</mi><mo id="S4.E27.m3.1.2.8.3.1">+</mo><mn id="S4.E27.m3.1.2.8.3.3">1</mn></mrow></msub><mi id="S4.E27.m3.1.2.9" mathvariant="normal">…</mi><msub id="S4.E27.m3.1.2.10"><mi id="S4.E27.m3.1.2.10.2">n</mi><mrow id="S4.E27.m3.1.2.10.3"><mi id="S4.E27.m3.1.2.10.3.2">i</mi><mo id="S4.E27.m3.1.2.10.3.1">−</mo><mn id="S4.E27.m3.1.2.10.3.3">1</mn></mrow></msub><msub id="S4.E27.m3.1.2.11"><mi id="S4.E27.m3.1.2.11.2">r</mi><mrow id="S4.E27.m3.1.2.11.3"><mi id="S4.E27.m3.1.2.11.3.2">i</mi><mo id="S4.E27.m3.1.2.11.3.1">−</mo><mn id="S4.E27.m3.1.2.11.3.3">1</mn></mrow></msub><mo id="S4.E27.m3.1.2.12">,</mo><msub id="S4.E27.m3.1.2.13"><mi id="S4.E27.m3.1.2.13.2">r</mi><mi id="S4.E27.m3.1.2.13.3">i</mi></msub><msub id="S4.E27.m3.1.2.14"><mi id="S4.E27.m3.1.2.14.2">n</mi><mrow id="S4.E27.m3.1.2.14.3"><mi id="S4.E27.m3.1.2.14.3.2">i</mi><mo id="S4.E27.m3.1.2.14.3.1">+</mo><mn id="S4.E27.m3.1.2.14.3.3">1</mn></mrow></msub><mi id="S4.E27.m3.1.2.15" mathvariant="normal">…</mi><msub id="S4.E27.m3.1.2.16"><mi id="S4.E27.m3.1.2.16.2">n</mi><mrow id="S4.E27.m3.1.2.16.3"><mn id="S4.E27.m3.1.2.16.3.2">2</mn><mo id="S4.E27.m3.1.2.16.3.1">⁢</mo><mi id="S4.E27.m3.1.2.16.3.3">d</mi></mrow></msub><mo id="S4.E27.m3.1.2.17" stretchy="false">⇒</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E27.m3.1c">\displaystyle\mbox{\bf einsum}(r_{d}n_{d+1}\ldots n_{2d},r_{d}n_{d+1}\ldots n_%
{i-1}r_{i-1},r_{i}n_{i+1}\ldots n_{2d}\Rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m3.1d">einsum ( italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle r_{i-1}n_{i}r_{i},\;[\mathbfcal{T}_{2},\mathbfcal{B}_{i-1-d},%
\mathbfcal{B}_{-(2d-i)}])." class="ltx_math_unparsed" display="inline" id="S4.Ex4.m1.1"><semantics id="S4.Ex4.m1.1a"><mrow id="S4.Ex4.m1.1b"><msub id="S4.Ex4.m1.1.1"><mi id="S4.Ex4.m1.1.1.2">r</mi><mrow id="S4.Ex4.m1.1.1.3"><mi id="S4.Ex4.m1.1.1.3.2">i</mi><mo id="S4.Ex4.m1.1.1.3.1">−</mo><mn id="S4.Ex4.m1.1.1.3.3">1</mn></mrow></msub><msub id="S4.Ex4.m1.1.2"><mi id="S4.Ex4.m1.1.2.2">n</mi><mi id="S4.Ex4.m1.1.2.3">i</mi></msub><msub id="S4.Ex4.m1.1.3"><mi id="S4.Ex4.m1.1.3.2">r</mi><mi id="S4.Ex4.m1.1.3.3">i</mi></msub><mo id="S4.Ex4.m1.1.4" rspace="0.447em">,</mo><mrow id="S4.Ex4.m1.1.5"><mo id="S4.Ex4.m1.1.5.1" stretchy="false">[</mo><msub id="S4.Ex4.m1.1.5.2"><mi id="S4.Ex4.m1.1.5.2.2" mathvariant="normal">𝒯</mi><mi id="S4.Ex4.m1.1.5.2.3" mathvariant="normal">∈</mi></msub><mi id="S4.Ex4.m1.1.5.3" mathvariant="normal">⇔</mi><msub id="S4.Ex4.m1.1.5.4"><mi id="S4.Ex4.m1.1.5.4.2" mathvariant="normal">ℬ</mi><mrow id="S4.Ex4.m1.1.5.4.3"><mi id="S4.Ex4.m1.1.5.4.3.2" mathvariant="normal">⟩</mi><mo id="S4.Ex4.m1.1.5.4.3.1">⁢</mo><mi id="S4.Ex4.m1.1.5.4.3.3" mathvariant="normal">↖</mi><mo id="S4.Ex4.m1.1.5.4.3.1a">⁢</mo><mi id="S4.Ex4.m1.1.5.4.3.4" mathvariant="normal">∞</mi><mo id="S4.Ex4.m1.1.5.4.3.1b">⁢</mo><mi id="S4.Ex4.m1.1.5.4.3.5" mathvariant="normal">↖</mi><mo id="S4.Ex4.m1.1.5.4.3.1c">⁢</mo><mi id="S4.Ex4.m1.1.5.4.3.6" mathvariant="normal">⌈</mi></mrow></msub><mi id="S4.Ex4.m1.1.5.5" mathvariant="normal">⇔</mi><msub id="S4.Ex4.m1.1.5.6"><mi id="S4.Ex4.m1.1.5.6.2" mathvariant="normal">ℬ</mi><mrow id="S4.Ex4.m1.1.5.6.3"><mi id="S4.Ex4.m1.1.5.6.3.2" mathvariant="normal">↖</mi><mo id="S4.Ex4.m1.1.5.6.3.1">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.3" mathvariant="normal">⇐</mi><mo id="S4.Ex4.m1.1.5.6.3.1a">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.4" mathvariant="normal">∈</mi><mo id="S4.Ex4.m1.1.5.6.3.1b">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.5" mathvariant="normal">⌈</mi><mo id="S4.Ex4.m1.1.5.6.3.1c">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.6" mathvariant="normal">↖</mi><mo id="S4.Ex4.m1.1.5.6.3.1d">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.7" mathvariant="normal">⟩</mi><mo id="S4.Ex4.m1.1.5.6.3.1e">⁢</mo><mi id="S4.Ex4.m1.1.5.6.3.8" mathvariant="normal">⇒</mi></mrow></msub><mi id="S4.Ex4.m1.1.5.7" mathvariant="normal">⊌</mi><mi id="S4.Ex4.m1.1.5.8" mathvariant="normal">⇒</mi><mi id="S4.Ex4.m1.1.5.9" mathvariant="normal">↙</mi></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex4.m1.1c">\displaystyle r_{i-1}n_{i}r_{i},\;[\mathbfcal{T}_{2},\mathbfcal{B}_{i-1-d},%
\mathbfcal{B}_{-(2d-i)}]).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.1d">italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , [ roman_𝒯 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⟩ ↖ ∞ ↖ ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ↖ ⇐ ∈ ⌈ ↖ ⟩ ⇒ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.2">Similarly, the gradients <math alttext="\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><msub id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">𝐠</mi><msub id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S4.I1.i3.p1.1.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.I1.i3.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S4.I1.i3.p1.1.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝐠</ci><apply id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.2">𝒢</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="i\leq d" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><mrow id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml"><mi id="S4.I1.i3.p1.2.m2.1.1.2" xref="S4.I1.i3.p1.2.m2.1.1.2.cmml">i</mi><mo id="S4.I1.i3.p1.2.m2.1.1.1" xref="S4.I1.i3.p1.2.m2.1.1.1.cmml">≤</mo><mi id="S4.I1.i3.p1.2.m2.1.1.3" xref="S4.I1.i3.p1.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><apply id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1"><leq id="S4.I1.i3.p1.2.m2.1.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1.1"></leq><ci id="S4.I1.i3.p1.2.m2.1.1.2.cmml" xref="S4.I1.i3.p1.2.m2.1.1.2">𝑖</ci><ci id="S4.I1.i3.p1.2.m2.1.1.3.cmml" xref="S4.I1.i3.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">i\leq d</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_i ≤ italic_d</annotation></semantics></math> can be computed as</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx7">
<tbody id="S4.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbfcal{U}_{2}" class="ltx_Math" display="inline" id="S4.E28.m1.1"><semantics id="S4.E28.m1.1a"><msub id="S4.E28.m1.1.1" xref="S4.E28.m1.1.1.cmml"><mi id="S4.E28.m1.1.1.2" mathvariant="normal" xref="S4.E28.m1.1.1.2.cmml">𝒰</mi><mi id="S4.E28.m1.1.1.3" mathvariant="normal" xref="S4.E28.m1.1.1.3.cmml">∈</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E28.m1.1b"><apply id="S4.E28.m1.1.1.cmml" xref="S4.E28.m1.1.1"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.cmml" xref="S4.E28.m1.1.1">subscript</csymbol><ci id="S4.E28.m1.1.1.2.cmml" xref="S4.E28.m1.1.1.2">𝒰</ci><ci id="S4.E28.m1.1.1.3.cmml" xref="S4.E28.m1.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m1.1c">\displaystyle\mathbfcal{U}_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m1.1d">roman_𝒰 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E28.m2.1"><semantics id="S4.E28.m2.1a"><mo id="S4.E28.m2.1.1" xref="S4.E28.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E28.m2.1b"><eq id="S4.E28.m2.1.1.cmml" xref="S4.E28.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(br_{d},bn_{1}\ldots n_{d}\Rightarrow r_{d}n_{1}%
\ldots n_{d},[\mathbfcal{U}_{1},\mathbfcal{X}])" class="ltx_math_unparsed" display="inline" id="S4.E28.m3.1"><semantics id="S4.E28.m3.1a"><mrow id="S4.E28.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E28.m3.1.1">einsum</mtext><mrow id="S4.E28.m3.1.2"><mo id="S4.E28.m3.1.2.1" stretchy="false">(</mo><mi id="S4.E28.m3.1.2.2">b</mi><msub id="S4.E28.m3.1.2.3"><mi id="S4.E28.m3.1.2.3.2">r</mi><mi id="S4.E28.m3.1.2.3.3">d</mi></msub><mo id="S4.E28.m3.1.2.4">,</mo><mi id="S4.E28.m3.1.2.5">b</mi><msub id="S4.E28.m3.1.2.6"><mi id="S4.E28.m3.1.2.6.2">n</mi><mn id="S4.E28.m3.1.2.6.3">1</mn></msub><mi id="S4.E28.m3.1.2.7" mathvariant="normal">…</mi><msub id="S4.E28.m3.1.2.8"><mi id="S4.E28.m3.1.2.8.2">n</mi><mi id="S4.E28.m3.1.2.8.3">d</mi></msub><mo id="S4.E28.m3.1.2.9" stretchy="false">⇒</mo><msub id="S4.E28.m3.1.2.10"><mi id="S4.E28.m3.1.2.10.2">r</mi><mi id="S4.E28.m3.1.2.10.3">d</mi></msub><msub id="S4.E28.m3.1.2.11"><mi id="S4.E28.m3.1.2.11.2">n</mi><mn id="S4.E28.m3.1.2.11.3">1</mn></msub><mi id="S4.E28.m3.1.2.12" mathvariant="normal">…</mi><msub id="S4.E28.m3.1.2.13"><mi id="S4.E28.m3.1.2.13.2">n</mi><mi id="S4.E28.m3.1.2.13.3">d</mi></msub><mo id="S4.E28.m3.1.2.14">,</mo><mrow id="S4.E28.m3.1.2.15"><mo id="S4.E28.m3.1.2.15.1" stretchy="false">[</mo><msub id="S4.E28.m3.1.2.15.2"><mi id="S4.E28.m3.1.2.15.2.2" mathvariant="normal">𝒰</mi><mi id="S4.E28.m3.1.2.15.2.3" mathvariant="normal">∞</mi></msub><mi id="S4.E28.m3.1.2.15.3" mathvariant="normal">⇔</mi><mi id="S4.E28.m3.1.2.15.4" mathvariant="normal">𝒳</mi><mi id="S4.E28.m3.1.2.15.5" mathvariant="normal">⊌</mi><mi id="S4.E28.m3.1.2.15.6" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E28.m3.1c">\displaystyle\mbox{\bf einsum}(br_{d},bn_{1}\ldots n_{d}\Rightarrow r_{d}n_{1}%
\ldots n_{d},[\mathbfcal{U}_{1},\mathbfcal{X}])</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m3.1d">einsum ( italic_b italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ⇒ italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , [ roman_𝒰 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ roman_𝒳 ⊌ ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
<tbody id="S4.Ex5">
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.E29.m1.1"><semantics id="S4.E29.m1.1a"><msub id="S4.E29.m1.1.1" xref="S4.E29.m1.1.1.cmml"><mi id="S4.E29.m1.1.1.2" xref="S4.E29.m1.1.1.2.cmml">𝐠</mi><msub id="S4.E29.m1.1.1.3" xref="S4.E29.m1.1.1.3.cmml"><mi id="S4.E29.m1.1.1.3.2" mathvariant="normal" xref="S4.E29.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.E29.m1.1.1.3.3" mathvariant="normal" xref="S4.E29.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.E29.m1.1b"><apply id="S4.E29.m1.1.1.cmml" xref="S4.E29.m1.1.1"><csymbol cd="ambiguous" id="S4.E29.m1.1.1.1.cmml" xref="S4.E29.m1.1.1">subscript</csymbol><ci id="S4.E29.m1.1.1.2.cmml" xref="S4.E29.m1.1.1.2">𝐠</ci><apply id="S4.E29.m1.1.1.3.cmml" xref="S4.E29.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E29.m1.1.1.3.1.cmml" xref="S4.E29.m1.1.1.3">subscript</csymbol><ci id="S4.E29.m1.1.1.3.2.cmml" xref="S4.E29.m1.1.1.3.2">𝒢</ci><ci id="S4.E29.m1.1.1.3.3.cmml" xref="S4.E29.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m1.1c">\displaystyle\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E29.m2.1"><semantics id="S4.E29.m2.1a"><mo id="S4.E29.m2.1.1" xref="S4.E29.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E29.m2.1b"><eq id="S4.E29.m2.1.1.cmml" xref="S4.E29.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mbox{\bf einsum}(r_{d}n_{1}\ldots n_{d},n_{1}\ldots n_{i-1}r_{i-%
1},r_{i}n_{i+1}\ldots n_{d}r_{d}\Rightarrow" class="ltx_math_unparsed" display="inline" id="S4.E29.m3.1"><semantics id="S4.E29.m3.1a"><mrow id="S4.E29.m3.1b"><mtext class="ltx_mathvariant_bold" id="S4.E29.m3.1.1">einsum</mtext><mrow id="S4.E29.m3.1.2"><mo id="S4.E29.m3.1.2.1" stretchy="false">(</mo><msub id="S4.E29.m3.1.2.2"><mi id="S4.E29.m3.1.2.2.2">r</mi><mi id="S4.E29.m3.1.2.2.3">d</mi></msub><msub id="S4.E29.m3.1.2.3"><mi id="S4.E29.m3.1.2.3.2">n</mi><mn id="S4.E29.m3.1.2.3.3">1</mn></msub><mi id="S4.E29.m3.1.2.4" mathvariant="normal">…</mi><msub id="S4.E29.m3.1.2.5"><mi id="S4.E29.m3.1.2.5.2">n</mi><mi id="S4.E29.m3.1.2.5.3">d</mi></msub><mo id="S4.E29.m3.1.2.6">,</mo><msub id="S4.E29.m3.1.2.7"><mi id="S4.E29.m3.1.2.7.2">n</mi><mn id="S4.E29.m3.1.2.7.3">1</mn></msub><mi id="S4.E29.m3.1.2.8" mathvariant="normal">…</mi><msub id="S4.E29.m3.1.2.9"><mi id="S4.E29.m3.1.2.9.2">n</mi><mrow id="S4.E29.m3.1.2.9.3"><mi id="S4.E29.m3.1.2.9.3.2">i</mi><mo id="S4.E29.m3.1.2.9.3.1">−</mo><mn id="S4.E29.m3.1.2.9.3.3">1</mn></mrow></msub><msub id="S4.E29.m3.1.2.10"><mi id="S4.E29.m3.1.2.10.2">r</mi><mrow id="S4.E29.m3.1.2.10.3"><mi id="S4.E29.m3.1.2.10.3.2">i</mi><mo id="S4.E29.m3.1.2.10.3.1">−</mo><mn id="S4.E29.m3.1.2.10.3.3">1</mn></mrow></msub><mo id="S4.E29.m3.1.2.11">,</mo><msub id="S4.E29.m3.1.2.12"><mi id="S4.E29.m3.1.2.12.2">r</mi><mi id="S4.E29.m3.1.2.12.3">i</mi></msub><msub id="S4.E29.m3.1.2.13"><mi id="S4.E29.m3.1.2.13.2">n</mi><mrow id="S4.E29.m3.1.2.13.3"><mi id="S4.E29.m3.1.2.13.3.2">i</mi><mo id="S4.E29.m3.1.2.13.3.1">+</mo><mn id="S4.E29.m3.1.2.13.3.3">1</mn></mrow></msub><mi id="S4.E29.m3.1.2.14" mathvariant="normal">…</mi><msub id="S4.E29.m3.1.2.15"><mi id="S4.E29.m3.1.2.15.2">n</mi><mi id="S4.E29.m3.1.2.15.3">d</mi></msub><msub id="S4.E29.m3.1.2.16"><mi id="S4.E29.m3.1.2.16.2">r</mi><mi id="S4.E29.m3.1.2.16.3">d</mi></msub><mo id="S4.E29.m3.1.2.17" stretchy="false">⇒</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E29.m3.1c">\displaystyle\mbox{\bf einsum}(r_{d}n_{1}\ldots n_{d},n_{1}\ldots n_{i-1}r_{i-%
1},r_{i}n_{i+1}\ldots n_{d}r_{d}\Rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m3.1d">einsum ( italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT … italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ⇒</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle r_{i-1}n_{i}r_{i},\;[\mathbfcal{U}_{2},\mathbfcal{A}_{i},%
\mathbfcal{A}_{-(d-i)}])." class="ltx_math_unparsed" display="inline" id="S4.Ex5.m1.1"><semantics id="S4.Ex5.m1.1a"><mrow id="S4.Ex5.m1.1b"><msub id="S4.Ex5.m1.1.1"><mi id="S4.Ex5.m1.1.1.2">r</mi><mrow id="S4.Ex5.m1.1.1.3"><mi id="S4.Ex5.m1.1.1.3.2">i</mi><mo id="S4.Ex5.m1.1.1.3.1">−</mo><mn id="S4.Ex5.m1.1.1.3.3">1</mn></mrow></msub><msub id="S4.Ex5.m1.1.2"><mi id="S4.Ex5.m1.1.2.2">n</mi><mi id="S4.Ex5.m1.1.2.3">i</mi></msub><msub id="S4.Ex5.m1.1.3"><mi id="S4.Ex5.m1.1.3.2">r</mi><mi id="S4.Ex5.m1.1.3.3">i</mi></msub><mo id="S4.Ex5.m1.1.4" rspace="0.447em">,</mo><mrow id="S4.Ex5.m1.1.5"><mo id="S4.Ex5.m1.1.5.1" stretchy="false">[</mo><msub id="S4.Ex5.m1.1.5.2"><mi id="S4.Ex5.m1.1.5.2.2" mathvariant="normal">𝒰</mi><mi id="S4.Ex5.m1.1.5.2.3" mathvariant="normal">∈</mi></msub><mi id="S4.Ex5.m1.1.5.3" mathvariant="normal">⇔</mi><msub id="S4.Ex5.m1.1.5.4"><mi id="S4.Ex5.m1.1.5.4.2" mathvariant="normal">𝒜</mi><mi id="S4.Ex5.m1.1.5.4.3" mathvariant="normal">⟩</mi></msub><mi id="S4.Ex5.m1.1.5.5" mathvariant="normal">⇔</mi><msub id="S4.Ex5.m1.1.5.6"><mi id="S4.Ex5.m1.1.5.6.2" mathvariant="normal">𝒜</mi><mrow id="S4.Ex5.m1.1.5.6.3"><mi id="S4.Ex5.m1.1.5.6.3.2" mathvariant="normal">↖</mi><mo id="S4.Ex5.m1.1.5.6.3.1">⁢</mo><mi id="S4.Ex5.m1.1.5.6.3.3" mathvariant="normal">⇐</mi><mo id="S4.Ex5.m1.1.5.6.3.1a">⁢</mo><mi id="S4.Ex5.m1.1.5.6.3.4" mathvariant="normal">⌈</mi><mo id="S4.Ex5.m1.1.5.6.3.1b">⁢</mo><mi id="S4.Ex5.m1.1.5.6.3.5" mathvariant="normal">↖</mi><mo id="S4.Ex5.m1.1.5.6.3.1c">⁢</mo><mi id="S4.Ex5.m1.1.5.6.3.6" mathvariant="normal">⟩</mi><mo id="S4.Ex5.m1.1.5.6.3.1d">⁢</mo><mi id="S4.Ex5.m1.1.5.6.3.7" mathvariant="normal">⇒</mi></mrow></msub><mi id="S4.Ex5.m1.1.5.7" mathvariant="normal">⊌</mi><mi id="S4.Ex5.m1.1.5.8" mathvariant="normal">⇒</mi><mi id="S4.Ex5.m1.1.5.9" mathvariant="normal">↙</mi></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex5.m1.1c">\displaystyle r_{i-1}n_{i}r_{i},\;[\mathbfcal{U}_{2},\mathbfcal{A}_{i},%
\mathbfcal{A}_{-(d-i)}]).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex5.m1.1d">italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , [ roman_𝒰 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ↖ ⇐ ⌈ ↖ ⟩ ⇒ end_POSTSUBSCRIPT ⊌ ⇒ ↙</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.4">The contraction paths of forward- and back- propagation are summarized in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS4" title="A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.4</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Analysis.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">The proposed empirical path is near-optimal for large batch sizes. The following result analyzes the contraction path for forward-propagation.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.1.1.1">Proposition 4.1</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.10"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.10.10">Suppose that the TT ranks satisfy <math alttext="1=r_{0}&lt;r_{1}\leq\cdots\leq r_{d}\geq r_{d-1}&gt;\cdots\geq r_{2d}=1" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">1</mn><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">=</mo><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1.4" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4.2.cmml">r</mi><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4.3.cmml">0</mn></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.5" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.5.cmml">&lt;</mo><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1.6" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6.2.cmml">r</mi><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6.3.cmml">1</mn></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.7" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.7.cmml">≤</mo><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.8" mathvariant="normal" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.8.cmml">⋯</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.9" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.9.cmml">≤</mo><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1.10" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10.2.cmml">r</mi><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10.3.cmml">d</mi></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.11" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.11.cmml">≥</mo><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1.12" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.2.cmml">r</mi><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.2.cmml">d</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.1.cmml">−</mo><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.3.cmml">1</mn></mrow></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.13" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.13.cmml">&gt;</mo><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.14" mathvariant="normal" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.14.cmml">⋯</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.15" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.15.cmml">≥</mo><msub id="S4.Thmtheorem1.p1.1.1.m1.1.1.16" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.2.cmml">r</mi><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.cmml"><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.2.cmml">2</mn><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.3.cmml">d</mi></mrow></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.17" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.17.cmml">=</mo><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.18" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.18.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><and id="S4.Thmtheorem1.p1.1.1.m1.1.1a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></and><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1b.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><eq id="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3"></eq><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2">1</cn><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4.2">𝑟</ci><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.4.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.4.3">0</cn></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1c.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><lt id="S4.Thmtheorem1.p1.1.1.m1.1.1.5.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.5"></lt><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.4.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1d.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6.2">𝑟</ci><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.6.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.6.3">1</cn></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1e.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><leq id="S4.Thmtheorem1.p1.1.1.m1.1.1.7.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.7"></leq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.6.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1f.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.8.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.8">⋯</ci></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1g.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><leq id="S4.Thmtheorem1.p1.1.1.m1.1.1.9.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.9"></leq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.8.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1h.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10.2">𝑟</ci><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.10.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.10.3">𝑑</ci></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1i.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><geq id="S4.Thmtheorem1.p1.1.1.m1.1.1.11.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.11"></geq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.10.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1j.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.2">𝑟</ci><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3"><minus id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.1"></minus><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.2">𝑑</ci><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.12.3.3">1</cn></apply></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1k.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><gt id="S4.Thmtheorem1.p1.1.1.m1.1.1.13.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.13"></gt><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.12.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1l.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.14.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.14">⋯</ci></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1m.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><geq id="S4.Thmtheorem1.p1.1.1.m1.1.1.15.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.15"></geq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.14.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1n.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.2">𝑟</ci><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3"><times id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.1"></times><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.2">2</cn><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.16.3.3">𝑑</ci></apply></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1o.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><eq id="S4.Thmtheorem1.p1.1.1.m1.1.1.17.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.17"></eq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.1.1.m1.1.1.16.cmml" id="S4.Thmtheorem1.p1.1.1.m1.1.1p.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"></share><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.18.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.18">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">1=r_{0}&lt;r_{1}\leq\cdots\leq r_{d}\geq r_{d-1}&gt;\cdots\geq r_{2d}=1</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">1 = italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT &lt; italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ ⋯ ≤ italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ≥ italic_r start_POSTSUBSCRIPT italic_d - 1 end_POSTSUBSCRIPT &gt; ⋯ ≥ italic_r start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT = 1</annotation></semantics></math> and the batch size <math alttext="b" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.2.2.m2.1"><semantics id="S4.Thmtheorem1.p1.2.2.m2.1a"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.2.2.m2.1b"><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.2.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.2.2.m2.1d">italic_b</annotation></semantics></math> is large enough. There exist groups <math alttext="\{S_{i}\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.3.3.m3.1"><semantics id="S4.Thmtheorem1.p1.3.3.m3.1a"><msubsup id="S4.Thmtheorem1.p1.3.3.m3.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mrow id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.2.cmml"><mo id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.2.cmml">i</mi><mo id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.3.3.m3.1b"><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1">superscript</csymbol><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><set id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1"><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3"><eq id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.1"></eq><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.2">𝑖</ci><cn id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.3.3.m3.1c">\{S_{i}\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.3.3.m3.1d">{ italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="S_{i}=\{\mathbfcal{G}_{j_{i}+1},\ldots,\mathbfcal{G}_{j_{i+1}}\}" class="ltx_math_unparsed" display="inline" id="S4.Thmtheorem1.p1.4.4.m4.1"><semantics id="S4.Thmtheorem1.p1.4.4.m4.1a"><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1"><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1.3"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.2">S</mi><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.3">i</mi></msub><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.2">=</mo><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1"><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.2" stretchy="false">{</mo><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1"><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.2" mathvariant="normal">𝒢</mi><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3"><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3.1"><mo fence="false" id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3.1.2" stretchy="false">|</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3.1.3" mathvariant="normal">⟩</mi></msub><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3.2" mathvariant="normal">⇓</mi><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.2.3.3" mathvariant="normal">∞</mi></mrow></msub><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1">⁢</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.3" mathvariant="normal">⇔</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1a">⁢</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.4" mathvariant="normal">…</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1b">⁢</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.5" mathvariant="normal">⇔</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1c">⁢</mo><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.2" mathvariant="normal">𝒢</mi><msub id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1"><mo fence="false" id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.2" stretchy="false">|</mo><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3.2" mathvariant="normal">⟩</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3.1">⁢</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3.3" mathvariant="normal">⇓</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3.1a">⁢</mo><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.6.3.1.3.4" mathvariant="normal">∞</mi></mrow></msub></msub></mrow><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.1.3" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.4.4.m4.1b">S_{i}=\{\mathbfcal{G}_{j_{i}+1},\ldots,\mathbfcal{G}_{j_{i+1}}\}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.4.4.m4.1c">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { roman_𝒢 start_POSTSUBSCRIPT | start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ⇓ ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT | start_POSTSUBSCRIPT ⟩ ⇓ ∞ end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math> containing consecutive tensor cores for <math alttext="0=j_{1}&lt;\cdots&lt;j_{k}&lt;j_{k+1}=2d" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.5.5.m5.1"><semantics id="S4.Thmtheorem1.p1.5.5.m5.1a"><mrow id="S4.Thmtheorem1.p1.5.5.m5.1.1" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mn id="S4.Thmtheorem1.p1.5.5.m5.1.1.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">0</mn><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.cmml">=</mo><msub id="S4.Thmtheorem1.p1.5.5.m5.1.1.4" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4.2.cmml">j</mi><mn id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4.3.cmml">1</mn></msub><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.5" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.5.cmml">&lt;</mo><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.6" mathvariant="normal" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.6.cmml">⋯</mi><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.7" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.7.cmml">&lt;</mo><msub id="S4.Thmtheorem1.p1.5.5.m5.1.1.8" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8.2.cmml">j</mi><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8.3.cmml">k</mi></msub><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.9" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.9.cmml">&lt;</mo><msub id="S4.Thmtheorem1.p1.5.5.m5.1.1.10" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.2.cmml">j</mi><mrow id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.2.cmml">k</mi><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.1" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.1.cmml">+</mo><mn id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.3.cmml">1</mn></mrow></msub><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.11" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.11.cmml">=</mo><mrow id="S4.Thmtheorem1.p1.5.5.m5.1.1.12" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.cmml"><mn id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.2.cmml">2</mn><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.1" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.5.5.m5.1b"><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><and id="S4.Thmtheorem1.p1.5.5.m5.1.1a.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"></and><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1b.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><eq id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3"></eq><cn id="S4.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.2">0</cn><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4">subscript</csymbol><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4.2">𝑗</ci><cn id="S4.Thmtheorem1.p1.5.5.m5.1.1.4.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.4.3">1</cn></apply></apply><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1c.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><lt id="S4.Thmtheorem1.p1.5.5.m5.1.1.5.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.5"></lt><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.5.5.m5.1.1.4.cmml" id="S4.Thmtheorem1.p1.5.5.m5.1.1d.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"></share><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.6.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.6">⋯</ci></apply><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1e.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><lt id="S4.Thmtheorem1.p1.5.5.m5.1.1.7.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.7"></lt><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.5.5.m5.1.1.6.cmml" id="S4.Thmtheorem1.p1.5.5.m5.1.1f.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"></share><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8">subscript</csymbol><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8.2">𝑗</ci><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.8.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.8.3">𝑘</ci></apply></apply><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1g.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><lt id="S4.Thmtheorem1.p1.5.5.m5.1.1.9.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.9"></lt><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.5.5.m5.1.1.8.cmml" id="S4.Thmtheorem1.p1.5.5.m5.1.1h.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"></share><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10">subscript</csymbol><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.2">𝑗</ci><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3"><plus id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.1"></plus><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.2">𝑘</ci><cn id="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.10.3.3">1</cn></apply></apply></apply><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1i.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><eq id="S4.Thmtheorem1.p1.5.5.m5.1.1.11.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.11"></eq><share href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1.p1.5.5.m5.1.1.10.cmml" id="S4.Thmtheorem1.p1.5.5.m5.1.1j.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"></share><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12"><times id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.1"></times><cn id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.2">2</cn><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.12.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.12.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.5.5.m5.1c">0=j_{1}&lt;\cdots&lt;j_{k}&lt;j_{k+1}=2d</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.5.5.m5.1d">0 = italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; ⋯ &lt; italic_j start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT &lt; italic_j start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = 2 italic_d</annotation></semantics></math>. Then, the contraction path with the least number of flops for the forward-propagation (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E19" title="In 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">19</span></a>) first contracts the tensor cores in each <math alttext="S_{i}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.6.6.m6.1"><semantics id="S4.Thmtheorem1.p1.6.6.m6.1a"><msub id="S4.Thmtheorem1.p1.6.6.m6.1.1" xref="S4.Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="S4.Thmtheorem1.p1.6.6.m6.1.1.2" xref="S4.Thmtheorem1.p1.6.6.m6.1.1.2.cmml">S</mi><mi id="S4.Thmtheorem1.p1.6.6.m6.1.1.3" xref="S4.Thmtheorem1.p1.6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.6.6.m6.1b"><apply id="S4.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="S4.Thmtheorem1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="S4.Thmtheorem1.p1.6.6.m6.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="S4.Thmtheorem1.p1.6.6.m6.1.1.2">𝑆</ci><ci id="S4.Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="S4.Thmtheorem1.p1.6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.6.6.m6.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.6.6.m6.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to obtain <math alttext="\mathbfcal{V}_{i}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.7.7.m7.1"><semantics id="S4.Thmtheorem1.p1.7.7.m7.1a"><msub id="S4.Thmtheorem1.p1.7.7.m7.1.1" xref="S4.Thmtheorem1.p1.7.7.m7.1.1.cmml"><mi id="S4.Thmtheorem1.p1.7.7.m7.1.1.2" mathvariant="normal" xref="S4.Thmtheorem1.p1.7.7.m7.1.1.2.cmml">𝒱</mi><mi id="S4.Thmtheorem1.p1.7.7.m7.1.1.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.7.7.m7.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.7.7.m7.1b"><apply id="S4.Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="S4.Thmtheorem1.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.7.7.m7.1.1.1.cmml" xref="S4.Thmtheorem1.p1.7.7.m7.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.7.7.m7.1.1.2.cmml" xref="S4.Thmtheorem1.p1.7.7.m7.1.1.2">𝒱</ci><ci id="S4.Thmtheorem1.p1.7.7.m7.1.1.3.cmml" xref="S4.Thmtheorem1.p1.7.7.m7.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.7.7.m7.1c">\mathbfcal{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.7.7.m7.1d">roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> with dimension <math alttext="r_{j_{i}}\times n_{j_{i}+1}\times\cdots\times n_{j_{i+1}}\times r_{j_{i+1}}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.8.8.m8.1"><semantics id="S4.Thmtheorem1.p1.8.8.m8.1a"><mrow id="S4.Thmtheorem1.p1.8.8.m8.1.1" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.cmml"><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.2.cmml">r</mi><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.2.cmml">j</mi><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.3.cmml">i</mi></msub></msub><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.1.cmml">×</mo><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.2.cmml">n</mi><mrow id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.cmml"><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.2.cmml">j</mi><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.1" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.1.cmml">+</mo><mn id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.1.cmml">×</mo><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.4" mathvariant="normal" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.4.cmml">⋯</mi><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.1.cmml">×</mo><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.5" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.2.cmml">n</mi><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.2.cmml">j</mi><mrow id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.2.cmml">i</mi><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.1" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.1.cmml">+</mo><mn id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.1c" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.1.cmml">×</mo><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.6" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.2.cmml">r</mi><msub id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.2.cmml">j</mi><mrow id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.cmml"><mi id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.2" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.2.cmml">i</mi><mo id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.1" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.1.cmml">+</mo><mn id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.3" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.3.cmml">1</mn></mrow></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.8.8.m8.1b"><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1"><times id="S4.Thmtheorem1.p1.8.8.m8.1.1.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.1"></times><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.2">𝑟</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.2">𝑗</ci><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.2">𝑛</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3"><plus id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.1"></plus><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.2">𝑗</ci><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.2.3">𝑖</ci></apply><cn id="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.3.3.3">1</cn></apply></apply><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.4.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.4">⋯</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.2">𝑛</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.2">𝑗</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3"><plus id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.1"></plus><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.2">𝑖</ci><cn id="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.5.3.3.3">1</cn></apply></apply></apply><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.2">𝑟</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.2">𝑗</ci><apply id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3"><plus id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.1.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.1"></plus><ci id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.2.cmml" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.2">𝑖</ci><cn id="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.8.8.m8.1.1.6.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.8.8.m8.1c">r_{j_{i}}\times n_{j_{i}+1}\times\cdots\times n_{j_{i+1}}\times r_{j_{i+1}}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.8.8.m8.1d">italic_r start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT × ⋯ × italic_n start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT × italic_r start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and then contract the input tensor <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.9.9.m9.1"><semantics id="S4.Thmtheorem1.p1.9.9.m9.1a"><mi id="S4.Thmtheorem1.p1.9.9.m9.1.1" mathvariant="normal" xref="S4.Thmtheorem1.p1.9.9.m9.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.9.9.m9.1b"><ci id="S4.Thmtheorem1.p1.9.9.m9.1.1.cmml" xref="S4.Thmtheorem1.p1.9.9.m9.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.9.9.m9.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.9.9.m9.1d">roman_𝒳</annotation></semantics></math> with tensors <math alttext="\{\mathbfcal{V}_{i}\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.10.10.m10.1"><semantics id="S4.Thmtheorem1.p1.10.10.m10.1a"><msubsup id="S4.Thmtheorem1.p1.10.10.m10.1.1" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.cmml"><mrow id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.2.cmml"><mo id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.2" stretchy="false" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.2.cmml">{</mo><msub id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.3.cmml">⟩</mi></msub><mo id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.3" stretchy="false" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.2" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.2.cmml">⟩</mi><mo id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.3.cmml">ℑ</mi><mo id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1a" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.4" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.4.cmml">∞</mi></mrow><mi id="S4.Thmtheorem1.p1.10.10.m10.1.1.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.3.cmml">∥</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.10.10.m10.1b"><apply id="S4.Thmtheorem1.p1.10.10.m10.1.1.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.10.10.m10.1.1.2.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1">superscript</csymbol><apply id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1">subscript</csymbol><set id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1"><apply id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.2">𝒱</ci><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.1.1.1.3">⟩</ci></apply></set><apply id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3"><times id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.1"></times><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.2">⟩</ci><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.3">ℑ</ci><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.4.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.1.3.4">∞</ci></apply></apply><ci id="S4.Thmtheorem1.p1.10.10.m10.1.1.3.cmml" xref="S4.Thmtheorem1.p1.10.10.m10.1.1.3">∥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.10.10.m10.1c">\{\mathbfcal{V}_{i}\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.10.10.m10.1d">{ roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT</annotation></semantics></math> in the sequential order.</span></p>
</div>
</div>
<div class="ltx_proof" id="S4.SS2.SSS0.Px2.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.1.p1.1">See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS3" title="A.3 Proof of Proposition 4.1 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.3</span></a> for the complete proof.
∎</p>
</div>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.4">Proposition <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1" title="Proposition 4.1. ‣ Analysis. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.1</span></a> implies that the optimal path first contracts some consecutive tensor cores and then contracts obtained tensors with the input tensor sequentially. The groups <math alttext="\{S_{i}\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p2.1.m1.1a"><msubsup id="S4.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.3" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><set id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1"><apply id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3"><eq id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.1"></eq><ci id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.2">𝑖</ci><cn id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p2.1.m1.1c">\{S_{i}\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p2.1.m1.1d">{ italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> depend on the dimensions, ranks, and batch size. The proposed contraction path satisfies the property shown in Proposition <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1" title="Proposition 4.1. ‣ Analysis. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.1</span></a> and has flops roughly <math alttext="b(n_{1}\cdots n_{d}+n_{d+1}\cdots n_{2d})r_{d}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p2.2.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml">b</mi><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.cmml"><msub id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.cmml">n</mi><mn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1a" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.2.cmml">n</mi><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.3.cmml">d</mi></msub></mrow><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml"><msub id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.2.cmml">n</mi><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.2.cmml">d</mi><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.1.cmml">+</mo><mn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.3" mathvariant="normal" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.3.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1a" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.2.cmml">n</mi><mrow id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.cmml"><mn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.1" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.3.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2a" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.cmml"><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.2" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.2.cmml">r</mi><mi id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.3" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p2.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1"><times id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.2"></times><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.3">𝑏</ci><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1"><plus id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.1"></plus><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2"><times id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.1"></times><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.2">𝑛</ci><cn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.3">⋯</ci><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.2">𝑛</ci><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.4.3">𝑑</ci></apply></apply><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3"><times id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.1"></times><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.2">𝑛</ci><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3"><plus id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.1"></plus><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.2">𝑑</ci><cn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.3">⋯</ci><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.2">𝑛</ci><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3"><times id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.1"></times><cn id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.2.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.2">2</cn><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.4.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.1.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.2.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.2">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.3.cmml" xref="S4.SS2.SSS0.Px2.p2.2.m2.1.1.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p2.2.m2.1c">b(n_{1}\cdots n_{d}+n_{d+1}\cdots n_{2d})r_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p2.2.m2.1d">italic_b ( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT + italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT ) italic_r start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. The optimal contraction path has flops about <math alttext="bn_{1}\cdots n_{d}c_{1}+bn_{d+1}\cdots n_{2d}c_{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p2.3.m3.1a"><mrow id="S4.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.2.cmml">b</mi><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.2.cmml">n</mi><mn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.3.cmml">1</mn></msub><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1a" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.4" mathvariant="normal" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.4.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1b" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.2.cmml">n</mi><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.3.cmml">d</mi></msub><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1c" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.2.cmml">c</mi><mn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.3.cmml">1</mn></msub></mrow><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.2.cmml">b</mi><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2.cmml">n</mi><mrow id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.2.cmml">d</mi><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1a" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.4" mathvariant="normal" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.4.cmml">⋯</mi><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1b" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.2.cmml">n</mi><mrow id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.cmml"><mn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.1" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.3.cmml">d</mi></mrow></msub><mo id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1c" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.cmml"><mi id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.2" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.2.cmml">c</mi><mn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.3" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1"><plus id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.1"></plus><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2"><times id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.1"></times><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.2">𝑏</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.2">𝑛</ci><cn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.3.3">1</cn></apply><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.4.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.4">⋯</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.2">𝑛</ci><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.5.3">𝑑</ci></apply><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.2">𝑐</ci><cn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.2.6.3">1</cn></apply></apply><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3"><times id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.2">𝑏</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.2">𝑛</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3"><plus id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.1"></plus><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.2">𝑑</ci><cn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.3.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.4">⋯</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.2">𝑛</ci><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3"><times id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.1"></times><cn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.2.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.2">2</cn><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.3.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.5.3.3">𝑑</ci></apply></apply><apply id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.1.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.2.cmml" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.2">𝑐</ci><cn id="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.3.m3.1.1.3.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p2.3.m3.1c">bn_{1}\cdots n_{d}c_{1}+bn_{d+1}\cdots n_{2d}c_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p2.3.m3.1d">italic_b italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_b italic_n start_POSTSUBSCRIPT italic_d + 1 end_POSTSUBSCRIPT ⋯ italic_n start_POSTSUBSCRIPT 2 italic_d end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="c_{1},c_{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p2.4.m4.2"><semantics id="S4.SS2.SSS0.Px2.p2.4.m4.2a"><mrow id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.3.cmml"><msub id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2.cmml">c</mi><mn id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.3" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.cmml"><mi id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.2" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.2.cmml">c</mi><mn id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.3" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p2.4.m4.2b"><list id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2"><apply id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.2">𝑐</ci><cn id="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.3">1</cn></apply><apply id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.2">𝑐</ci><cn id="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p2.4.m4.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p2.4.m4.2c">c_{1},c_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p2.4.m4.2d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are some constants. Hence, the proposed is near-optimal and has a comparable complexity to the optimal path. Suppose the optimal path is different from the proposed empirical path. Then the optimal path will likely involve a few more large intermediate tensors, which pose more memory costs during training and inference especially for static computational graphs. The empirical path is a good choice to balance time and memory consumption. Similar arguments can be applied to the contractions for back-propagation.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p3.1">When the batch size is small, the optimal path may have much fewer flops. However, the execution time is almost the same as the proposed path since all the operations are too small. Hence, we can use the proposed path for most batch sizes. See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS5" title="A.5 Small Batch Case for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.5</span></a> for more analysis.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>GPU Performance Optimization via CUDA Graph</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">While CoMERA consumes much less computing FLOPS than standard uncompressed training, it can be slower on GPU if not implemented carefully. Therefore, it is crucial to optimize the GPU performance to achieve real speedup. Modern GPUs are highly optimized for large-size matrix multiplications. However, the small-size tensor contractions in CoMERA are not yet optimized on GPU and require many small-size GPU kernels, causing significant runtime overhead. During the training, Cuda Graph launches and executes the whole computing graph rather than launching a large number of kernels sequentially. This can eliminate lots of back-end overhead and lead to significant training speedup. We remark that this is just an initial step of GPU optimization. We expect that a more dedicated GPU optimization can achieve a more significant training speedup.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.12.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.13.2" style="font-size:90%;">Result of Transformer on MNLI of batch size 128.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.10.11.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.10.11.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.10.11.1.2"><span class="ltx_text" id="S4.T1.10.11.1.2.1" style="font-size:90%;">validation</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.10.11.1.3"><span class="ltx_text" id="S4.T1.10.11.1.3.1" style="font-size:90%;">total size (MB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.10.11.1.4"><span class="ltx_text" id="S4.T1.10.11.1.4.1" style="font-size:90%;">compressed size (MB)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.2.3"><span class="ltx_text" id="S4.T1.2.2.3.1" style="font-size:90%;">uncompressed training</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.2.2.4"><span class="ltx_text" id="S4.T1.2.2.4.1" style="font-size:90%;">62.2%</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1">
<span class="ltx_text" id="S4.T1.1.1.1.1" style="font-size:90%;">256 (</span><math alttext="1\times" class="ltx_math_unparsed" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1b"><mn id="S4.T1.1.1.1.m1.1.1" mathsize="90%">1</mn><mo id="S4.T1.1.1.1.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">1\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">1 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.1.1.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.2.2">
<span class="ltx_text" id="S4.T1.2.2.2.1" style="font-size:90%;">253 (</span><math alttext="1\times" class="ltx_math_unparsed" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.m1.1b"><mn id="S4.T1.2.2.2.m1.1.1" mathsize="90%">1</mn><mo id="S4.T1.2.2.2.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">1\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">1 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.2.2.2.2" style="font-size:90%;">)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.4.4.3"><span class="ltx_text" id="S4.T1.4.4.3.1" style="font-size:90%;">CoMERA (early stage)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.4.4"><span class="ltx_text" id="S4.T1.4.4.4.1" style="font-size:90%;">63.3%</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.1">
<span class="ltx_text" id="S4.T1.3.3.1.1" style="font-size:90%;">5.9 (</span><math alttext="43\times" class="ltx_math_unparsed" display="inline" id="S4.T1.3.3.1.m1.1"><semantics id="S4.T1.3.3.1.m1.1a"><mrow id="S4.T1.3.3.1.m1.1b"><mn id="S4.T1.3.3.1.m1.1.1" mathsize="90%">43</mn><mo id="S4.T1.3.3.1.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">43\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">43 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.3.3.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.2">
<span class="ltx_text" id="S4.T1.4.4.2.1" style="font-size:90%;">3.4 (</span><math alttext="74\times" class="ltx_math_unparsed" display="inline" id="S4.T1.4.4.2.m1.1"><semantics id="S4.T1.4.4.2.m1.1a"><mrow id="S4.T1.4.4.2.m1.1b"><mn id="S4.T1.4.4.2.m1.1.1" mathsize="90%">74</mn><mo id="S4.T1.4.4.2.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.4.4.2.m1.1c">74\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.2.m1.1d">74 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.4.4.2.2" style="font-size:90%;">)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.6.6.3"><span class="ltx_text" id="S4.T1.6.6.3.1" style="font-size:90%;">CoMERA (late stage), target ratio: 0.8</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.6.6.4"><span class="ltx_text" id="S4.T1.6.6.4.1" style="font-size:90%;">62.2%</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.1">
<span class="ltx_text" id="S4.T1.5.5.1.1" style="font-size:90%;">4.9 (</span><math alttext="52\times" class="ltx_math_unparsed" display="inline" id="S4.T1.5.5.1.m1.1"><semantics id="S4.T1.5.5.1.m1.1a"><mrow id="S4.T1.5.5.1.m1.1b"><mn id="S4.T1.5.5.1.m1.1.1" mathsize="90%">52</mn><mo id="S4.T1.5.5.1.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">52\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.1.m1.1d">52 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.5.5.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.6.2">
<span class="ltx_text" id="S4.T1.6.6.2.1" style="font-size:90%;">2.4 (</span><math alttext="105\times" class="ltx_math_unparsed" display="inline" id="S4.T1.6.6.2.m1.1"><semantics id="S4.T1.6.6.2.m1.1a"><mrow id="S4.T1.6.6.2.m1.1b"><mn id="S4.T1.6.6.2.m1.1.1" mathsize="90%">105</mn><mo id="S4.T1.6.6.2.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.6.6.2.m1.1c">105\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.2.m1.1d">105 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.6.6.2.2" style="font-size:90%;">)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.8.3"><span class="ltx_text" id="S4.T1.8.8.3.1" style="font-size:90%;">CoMERA (late stage), target ratio: 0.5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.8.4"><span class="ltx_text" id="S4.T1.8.8.4.1" style="font-size:90%;">62.1%</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.7.1">
<span class="ltx_text" id="S4.T1.7.7.1.1" style="font-size:90%;">3.9 (</span><math alttext="65\times" class="ltx_math_unparsed" display="inline" id="S4.T1.7.7.1.m1.1"><semantics id="S4.T1.7.7.1.m1.1a"><mrow id="S4.T1.7.7.1.m1.1b"><mn id="S4.T1.7.7.1.m1.1.1" mathsize="90%">65</mn><mo id="S4.T1.7.7.1.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">65\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.1.m1.1d">65 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.7.7.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.8.8.2">
<span class="ltx_text" id="S4.T1.8.8.2.1" style="font-size:90%;">1.4 (</span><math alttext="181\times" class="ltx_math_unparsed" display="inline" id="S4.T1.8.8.2.m1.1"><semantics id="S4.T1.8.8.2.m1.1a"><mrow id="S4.T1.8.8.2.m1.1b"><mn id="S4.T1.8.8.2.m1.1.1" mathsize="90%">181</mn><mo id="S4.T1.8.8.2.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.8.8.2.m1.1c">181\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.2.m1.1d">181 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.8.8.2.2" style="font-size:90%;">)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S4.T1.10.10.3"><span class="ltx_text" id="S4.T1.10.10.3.1" style="font-size:90%;">CoMERA (late stage), target ratio: 0.2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T1.10.10.4"><span class="ltx_text" id="S4.T1.10.10.4.1" style="font-size:90%;">61.5%</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T1.9.9.1">
<span class="ltx_text" id="S4.T1.9.9.1.1" style="font-size:90%;">3.2 (</span><math alttext="80\times" class="ltx_math_unparsed" display="inline" id="S4.T1.9.9.1.m1.1"><semantics id="S4.T1.9.9.1.m1.1a"><mrow id="S4.T1.9.9.1.m1.1b"><mn id="S4.T1.9.9.1.m1.1.1" mathsize="90%">80</mn><mo id="S4.T1.9.9.1.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.9.9.1.m1.1c">80\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.1.m1.1d">80 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.9.9.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T1.10.10.2">
<span class="ltx_text" id="S4.T1.10.10.2.1" style="font-size:90%;">0.7 (</span><math alttext="361\times" class="ltx_math_unparsed" display="inline" id="S4.T1.10.10.2.m1.1"><semantics id="S4.T1.10.10.2.m1.1a"><mrow id="S4.T1.10.10.2.m1.1b"><mn id="S4.T1.10.10.2.m1.1.1" mathsize="90%">361</mn><mo id="S4.T1.10.10.2.m1.1.2" lspace="0.222em" mathsize="90%">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T1.10.10.2.m1.1c">361\times</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.10.2.m1.1d">361 ×</annotation></semantics></math><span class="ltx_text" id="S4.T1.10.10.2.2" style="font-size:90%;">)</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>End-to-End Training Results</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we test the performance of CoMERA on a transformer and a DLRM benchmark. Our experiments are run on a Nvidia RTX 3090 GPU with 24GB RAM.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>A Medium-Size Transformer with Six Encoders</h3>
<figure class="ltx_figure ltx_align_floatright" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="S5.F6.g1" src="extracted/2405.14377v1/figures/MNLI_training.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">Behavior of early-stage CoMERA training on the MNLI dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We first consider a six-encoder transformer. The embedding tables and all linear layers are represented as tensor cores in the training process as detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS6" title="A.6 Compression Settings for the Experiment in Section 5.1 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.6</span></a>. We train this model on the MNLI dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib34" title="">34</a>]</cite> with the maximum sequence length <math alttext="128" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><cn id="S5.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">128</annotation></semantics></math> and compare the accuracy, resulting model size, and training time of CoMERA with the standard uncompressed training.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.20.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.21.2" style="font-size:90%;">The change of ranks of layers in the fifth encoder block.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.18">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.18.19.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.18.19.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T2.18.19.1.2"><span class="ltx_text" id="S5.T2.18.19.1.2.1" style="font-size:90%;">before training</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T2.18.19.1.3"><span class="ltx_text" id="S5.T2.18.19.1.3.1" style="font-size:90%;">early-stage rank</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T2.18.19.1.4"><span class="ltx_text" id="S5.T2.18.19.1.4.1" style="font-size:90%;">late-stage rank</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.3.3.4"><span class="ltx_text" id="S5.T2.3.3.4.1" style="font-size:90%;">Q-layer in attention</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.1.1"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.1.1.1.m1.5"><semantics id="S5.T2.1.1.1.m1.5a"><mrow id="S5.T2.1.1.1.m1.5.6.2" xref="S5.T2.1.1.1.m1.5.6.1.cmml"><mo id="S5.T2.1.1.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.1.1.1.m1.1.1" mathsize="90%" xref="S5.T2.1.1.1.m1.1.1.cmml">12</mn><mo id="S5.T2.1.1.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.1.1.1.m1.2.2" mathsize="90%" xref="S5.T2.1.1.1.m1.2.2.cmml">30</mn><mo id="S5.T2.1.1.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.1.1.1.m1.3.3" mathsize="90%" xref="S5.T2.1.1.1.m1.3.3.cmml">30</mn><mo id="S5.T2.1.1.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.1.1.1.m1.4.4" mathsize="90%" xref="S5.T2.1.1.1.m1.4.4.cmml">30</mn><mo id="S5.T2.1.1.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.1.1.1.m1.5.5" mathsize="90%" xref="S5.T2.1.1.1.m1.5.5.cmml">12</mn><mo id="S5.T2.1.1.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.1.1.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.5b"><vector id="S5.T2.1.1.1.m1.5.6.1.cmml" xref="S5.T2.1.1.1.m1.5.6.2"><cn id="S5.T2.1.1.1.m1.1.1.cmml" type="integer" xref="S5.T2.1.1.1.m1.1.1">12</cn><cn id="S5.T2.1.1.1.m1.2.2.cmml" type="integer" xref="S5.T2.1.1.1.m1.2.2">30</cn><cn id="S5.T2.1.1.1.m1.3.3.cmml" type="integer" xref="S5.T2.1.1.1.m1.3.3">30</cn><cn id="S5.T2.1.1.1.m1.4.4.cmml" type="integer" xref="S5.T2.1.1.1.m1.4.4">30</cn><cn id="S5.T2.1.1.1.m1.5.5.cmml" type="integer" xref="S5.T2.1.1.1.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.2"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.2.2.2.m1.5"><semantics id="S5.T2.2.2.2.m1.5a"><mrow id="S5.T2.2.2.2.m1.5.6.2" xref="S5.T2.2.2.2.m1.5.6.1.cmml"><mo id="S5.T2.2.2.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.2.2.2.m1.1.1" mathsize="90%" xref="S5.T2.2.2.2.m1.1.1.cmml">12</mn><mo id="S5.T2.2.2.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.2.2.2.m1.2.2" mathsize="90%" xref="S5.T2.2.2.2.m1.2.2.cmml">30</mn><mo id="S5.T2.2.2.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.2.2.2.m1.3.3" mathsize="90%" xref="S5.T2.2.2.2.m1.3.3.cmml">30</mn><mo id="S5.T2.2.2.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.2.2.2.m1.4.4" mathsize="90%" xref="S5.T2.2.2.2.m1.4.4.cmml">30</mn><mo id="S5.T2.2.2.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.2.2.2.m1.5.5" mathsize="90%" xref="S5.T2.2.2.2.m1.5.5.cmml">12</mn><mo id="S5.T2.2.2.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.2.2.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.5b"><vector id="S5.T2.2.2.2.m1.5.6.1.cmml" xref="S5.T2.2.2.2.m1.5.6.2"><cn id="S5.T2.2.2.2.m1.1.1.cmml" type="integer" xref="S5.T2.2.2.2.m1.1.1">12</cn><cn id="S5.T2.2.2.2.m1.2.2.cmml" type="integer" xref="S5.T2.2.2.2.m1.2.2">30</cn><cn id="S5.T2.2.2.2.m1.3.3.cmml" type="integer" xref="S5.T2.2.2.2.m1.3.3">30</cn><cn id="S5.T2.2.2.2.m1.4.4.cmml" type="integer" xref="S5.T2.2.2.2.m1.4.4">30</cn><cn id="S5.T2.2.2.2.m1.5.5.cmml" type="integer" xref="S5.T2.2.2.2.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.3.3"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.3.3.3.m1.5"><semantics id="S5.T2.3.3.3.m1.5a"><mrow id="S5.T2.3.3.3.m1.5.6.2" xref="S5.T2.3.3.3.m1.5.6.1.cmml"><mo id="S5.T2.3.3.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.3.3.3.m1.1.1" mathsize="90%" xref="S5.T2.3.3.3.m1.1.1.cmml">0</mn><mo id="S5.T2.3.3.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.3.3.3.m1.2.2" mathsize="90%" xref="S5.T2.3.3.3.m1.2.2.cmml">0</mn><mo id="S5.T2.3.3.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.3.3.3.m1.3.3" mathsize="90%" xref="S5.T2.3.3.3.m1.3.3.cmml">0</mn><mo id="S5.T2.3.3.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.3.3.3.m1.4.4" mathsize="90%" xref="S5.T2.3.3.3.m1.4.4.cmml">0</mn><mo id="S5.T2.3.3.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.3.3.3.m1.5.5" mathsize="90%" xref="S5.T2.3.3.3.m1.5.5.cmml">0</mn><mo id="S5.T2.3.3.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.3.3.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.5b"><vector id="S5.T2.3.3.3.m1.5.6.1.cmml" xref="S5.T2.3.3.3.m1.5.6.2"><cn id="S5.T2.3.3.3.m1.1.1.cmml" type="integer" xref="S5.T2.3.3.3.m1.1.1">0</cn><cn id="S5.T2.3.3.3.m1.2.2.cmml" type="integer" xref="S5.T2.3.3.3.m1.2.2">0</cn><cn id="S5.T2.3.3.3.m1.3.3.cmml" type="integer" xref="S5.T2.3.3.3.m1.3.3">0</cn><cn id="S5.T2.3.3.3.m1.4.4.cmml" type="integer" xref="S5.T2.3.3.3.m1.4.4">0</cn><cn id="S5.T2.3.3.3.m1.5.5.cmml" type="integer" xref="S5.T2.3.3.3.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.6.6.4"><span class="ltx_text" id="S5.T2.6.6.4.1" style="font-size:90%;">K-layer in attention</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.4.4.1"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.4.4.1.m1.5"><semantics id="S5.T2.4.4.1.m1.5a"><mrow id="S5.T2.4.4.1.m1.5.6.2" xref="S5.T2.4.4.1.m1.5.6.1.cmml"><mo id="S5.T2.4.4.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.4.4.1.m1.1.1" mathsize="90%" xref="S5.T2.4.4.1.m1.1.1.cmml">12</mn><mo id="S5.T2.4.4.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.4.4.1.m1.2.2" mathsize="90%" xref="S5.T2.4.4.1.m1.2.2.cmml">30</mn><mo id="S5.T2.4.4.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.4.4.1.m1.3.3" mathsize="90%" xref="S5.T2.4.4.1.m1.3.3.cmml">30</mn><mo id="S5.T2.4.4.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.4.4.1.m1.4.4" mathsize="90%" xref="S5.T2.4.4.1.m1.4.4.cmml">30</mn><mo id="S5.T2.4.4.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.4.4.1.m1.5.5" mathsize="90%" xref="S5.T2.4.4.1.m1.5.5.cmml">12</mn><mo id="S5.T2.4.4.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.4.4.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.1.m1.5b"><vector id="S5.T2.4.4.1.m1.5.6.1.cmml" xref="S5.T2.4.4.1.m1.5.6.2"><cn id="S5.T2.4.4.1.m1.1.1.cmml" type="integer" xref="S5.T2.4.4.1.m1.1.1">12</cn><cn id="S5.T2.4.4.1.m1.2.2.cmml" type="integer" xref="S5.T2.4.4.1.m1.2.2">30</cn><cn id="S5.T2.4.4.1.m1.3.3.cmml" type="integer" xref="S5.T2.4.4.1.m1.3.3">30</cn><cn id="S5.T2.4.4.1.m1.4.4.cmml" type="integer" xref="S5.T2.4.4.1.m1.4.4">30</cn><cn id="S5.T2.4.4.1.m1.5.5.cmml" type="integer" xref="S5.T2.4.4.1.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.1.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.1.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.5.5.2"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.5.5.2.m1.5"><semantics id="S5.T2.5.5.2.m1.5a"><mrow id="S5.T2.5.5.2.m1.5.6.2" xref="S5.T2.5.5.2.m1.5.6.1.cmml"><mo id="S5.T2.5.5.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.5.5.2.m1.1.1" mathsize="90%" xref="S5.T2.5.5.2.m1.1.1.cmml">12</mn><mo id="S5.T2.5.5.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.5.5.2.m1.2.2" mathsize="90%" xref="S5.T2.5.5.2.m1.2.2.cmml">30</mn><mo id="S5.T2.5.5.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.5.5.2.m1.3.3" mathsize="90%" xref="S5.T2.5.5.2.m1.3.3.cmml">30</mn><mo id="S5.T2.5.5.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.5.5.2.m1.4.4" mathsize="90%" xref="S5.T2.5.5.2.m1.4.4.cmml">30</mn><mo id="S5.T2.5.5.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.5.5.2.m1.5.5" mathsize="90%" xref="S5.T2.5.5.2.m1.5.5.cmml">12</mn><mo id="S5.T2.5.5.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.5.5.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.2.m1.5b"><vector id="S5.T2.5.5.2.m1.5.6.1.cmml" xref="S5.T2.5.5.2.m1.5.6.2"><cn id="S5.T2.5.5.2.m1.1.1.cmml" type="integer" xref="S5.T2.5.5.2.m1.1.1">12</cn><cn id="S5.T2.5.5.2.m1.2.2.cmml" type="integer" xref="S5.T2.5.5.2.m1.2.2">30</cn><cn id="S5.T2.5.5.2.m1.3.3.cmml" type="integer" xref="S5.T2.5.5.2.m1.3.3">30</cn><cn id="S5.T2.5.5.2.m1.4.4.cmml" type="integer" xref="S5.T2.5.5.2.m1.4.4">30</cn><cn id="S5.T2.5.5.2.m1.5.5.cmml" type="integer" xref="S5.T2.5.5.2.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.2.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.5.2.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.6.3"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.6.6.3.m1.5"><semantics id="S5.T2.6.6.3.m1.5a"><mrow id="S5.T2.6.6.3.m1.5.6.2" xref="S5.T2.6.6.3.m1.5.6.1.cmml"><mo id="S5.T2.6.6.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.6.6.3.m1.1.1" mathsize="90%" xref="S5.T2.6.6.3.m1.1.1.cmml">0</mn><mo id="S5.T2.6.6.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.6.6.3.m1.2.2" mathsize="90%" xref="S5.T2.6.6.3.m1.2.2.cmml">0</mn><mo id="S5.T2.6.6.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.6.6.3.m1.3.3" mathsize="90%" xref="S5.T2.6.6.3.m1.3.3.cmml">0</mn><mo id="S5.T2.6.6.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.6.6.3.m1.4.4" mathsize="90%" xref="S5.T2.6.6.3.m1.4.4.cmml">0</mn><mo id="S5.T2.6.6.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.6.6.3.m1.5.5" mathsize="90%" xref="S5.T2.6.6.3.m1.5.5.cmml">0</mn><mo id="S5.T2.6.6.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.6.6.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.3.m1.5b"><vector id="S5.T2.6.6.3.m1.5.6.1.cmml" xref="S5.T2.6.6.3.m1.5.6.2"><cn id="S5.T2.6.6.3.m1.1.1.cmml" type="integer" xref="S5.T2.6.6.3.m1.1.1">0</cn><cn id="S5.T2.6.6.3.m1.2.2.cmml" type="integer" xref="S5.T2.6.6.3.m1.2.2">0</cn><cn id="S5.T2.6.6.3.m1.3.3.cmml" type="integer" xref="S5.T2.6.6.3.m1.3.3">0</cn><cn id="S5.T2.6.6.3.m1.4.4.cmml" type="integer" xref="S5.T2.6.6.3.m1.4.4">0</cn><cn id="S5.T2.6.6.3.m1.5.5.cmml" type="integer" xref="S5.T2.6.6.3.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.3.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.6.3.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.9.9.4"><span class="ltx_text" id="S5.T2.9.9.4.1" style="font-size:90%;">V-layer in attention</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.7.7.1"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.7.7.1.m1.5"><semantics id="S5.T2.7.7.1.m1.5a"><mrow id="S5.T2.7.7.1.m1.5.6.2" xref="S5.T2.7.7.1.m1.5.6.1.cmml"><mo id="S5.T2.7.7.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.7.7.1.m1.1.1" mathsize="90%" xref="S5.T2.7.7.1.m1.1.1.cmml">12</mn><mo id="S5.T2.7.7.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.7.7.1.m1.2.2" mathsize="90%" xref="S5.T2.7.7.1.m1.2.2.cmml">30</mn><mo id="S5.T2.7.7.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.7.7.1.m1.3.3" mathsize="90%" xref="S5.T2.7.7.1.m1.3.3.cmml">30</mn><mo id="S5.T2.7.7.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.7.7.1.m1.4.4" mathsize="90%" xref="S5.T2.7.7.1.m1.4.4.cmml">30</mn><mo id="S5.T2.7.7.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.7.7.1.m1.5.5" mathsize="90%" xref="S5.T2.7.7.1.m1.5.5.cmml">12</mn><mo id="S5.T2.7.7.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.7.7.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.1.m1.5b"><vector id="S5.T2.7.7.1.m1.5.6.1.cmml" xref="S5.T2.7.7.1.m1.5.6.2"><cn id="S5.T2.7.7.1.m1.1.1.cmml" type="integer" xref="S5.T2.7.7.1.m1.1.1">12</cn><cn id="S5.T2.7.7.1.m1.2.2.cmml" type="integer" xref="S5.T2.7.7.1.m1.2.2">30</cn><cn id="S5.T2.7.7.1.m1.3.3.cmml" type="integer" xref="S5.T2.7.7.1.m1.3.3">30</cn><cn id="S5.T2.7.7.1.m1.4.4.cmml" type="integer" xref="S5.T2.7.7.1.m1.4.4">30</cn><cn id="S5.T2.7.7.1.m1.5.5.cmml" type="integer" xref="S5.T2.7.7.1.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.1.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.7.1.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.8.8.2"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.8.8.2.m1.5"><semantics id="S5.T2.8.8.2.m1.5a"><mrow id="S5.T2.8.8.2.m1.5.6.2" xref="S5.T2.8.8.2.m1.5.6.1.cmml"><mo id="S5.T2.8.8.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.8.8.2.m1.1.1" mathsize="90%" xref="S5.T2.8.8.2.m1.1.1.cmml">12</mn><mo id="S5.T2.8.8.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.8.8.2.m1.2.2" mathsize="90%" xref="S5.T2.8.8.2.m1.2.2.cmml">30</mn><mo id="S5.T2.8.8.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.8.8.2.m1.3.3" mathsize="90%" xref="S5.T2.8.8.2.m1.3.3.cmml">30</mn><mo id="S5.T2.8.8.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.8.8.2.m1.4.4" mathsize="90%" xref="S5.T2.8.8.2.m1.4.4.cmml">30</mn><mo id="S5.T2.8.8.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.8.8.2.m1.5.5" mathsize="90%" xref="S5.T2.8.8.2.m1.5.5.cmml">12</mn><mo id="S5.T2.8.8.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.8.8.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.2.m1.5b"><vector id="S5.T2.8.8.2.m1.5.6.1.cmml" xref="S5.T2.8.8.2.m1.5.6.2"><cn id="S5.T2.8.8.2.m1.1.1.cmml" type="integer" xref="S5.T2.8.8.2.m1.1.1">12</cn><cn id="S5.T2.8.8.2.m1.2.2.cmml" type="integer" xref="S5.T2.8.8.2.m1.2.2">30</cn><cn id="S5.T2.8.8.2.m1.3.3.cmml" type="integer" xref="S5.T2.8.8.2.m1.3.3">30</cn><cn id="S5.T2.8.8.2.m1.4.4.cmml" type="integer" xref="S5.T2.8.8.2.m1.4.4">30</cn><cn id="S5.T2.8.8.2.m1.5.5.cmml" type="integer" xref="S5.T2.8.8.2.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.2.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.8.2.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.9.9.3"><math alttext="(9,11,11,7,9)" class="ltx_Math" display="inline" id="S5.T2.9.9.3.m1.5"><semantics id="S5.T2.9.9.3.m1.5a"><mrow id="S5.T2.9.9.3.m1.5.6.2" xref="S5.T2.9.9.3.m1.5.6.1.cmml"><mo id="S5.T2.9.9.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.9.9.3.m1.1.1" mathsize="90%" xref="S5.T2.9.9.3.m1.1.1.cmml">9</mn><mo id="S5.T2.9.9.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.9.9.3.m1.2.2" mathsize="90%" xref="S5.T2.9.9.3.m1.2.2.cmml">11</mn><mo id="S5.T2.9.9.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.9.9.3.m1.3.3" mathsize="90%" xref="S5.T2.9.9.3.m1.3.3.cmml">11</mn><mo id="S5.T2.9.9.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.9.9.3.m1.4.4" mathsize="90%" xref="S5.T2.9.9.3.m1.4.4.cmml">7</mn><mo id="S5.T2.9.9.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.9.9.3.m1.5.5" mathsize="90%" xref="S5.T2.9.9.3.m1.5.5.cmml">9</mn><mo id="S5.T2.9.9.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.9.9.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.3.m1.5b"><vector id="S5.T2.9.9.3.m1.5.6.1.cmml" xref="S5.T2.9.9.3.m1.5.6.2"><cn id="S5.T2.9.9.3.m1.1.1.cmml" type="integer" xref="S5.T2.9.9.3.m1.1.1">9</cn><cn id="S5.T2.9.9.3.m1.2.2.cmml" type="integer" xref="S5.T2.9.9.3.m1.2.2">11</cn><cn id="S5.T2.9.9.3.m1.3.3.cmml" type="integer" xref="S5.T2.9.9.3.m1.3.3">11</cn><cn id="S5.T2.9.9.3.m1.4.4.cmml" type="integer" xref="S5.T2.9.9.3.m1.4.4">7</cn><cn id="S5.T2.9.9.3.m1.5.5.cmml" type="integer" xref="S5.T2.9.9.3.m1.5.5">9</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.3.m1.5c">(9,11,11,7,9)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.9.3.m1.5d">( 9 , 11 , 11 , 7 , 9 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.12.12.4"><span class="ltx_text" id="S5.T2.12.12.4.1" style="font-size:90%;">FC-layer in attention</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.10.10.1"><math alttext="(12,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.10.10.1.m1.5"><semantics id="S5.T2.10.10.1.m1.5a"><mrow id="S5.T2.10.10.1.m1.5.6.2" xref="S5.T2.10.10.1.m1.5.6.1.cmml"><mo id="S5.T2.10.10.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.10.10.1.m1.1.1" mathsize="90%" xref="S5.T2.10.10.1.m1.1.1.cmml">12</mn><mo id="S5.T2.10.10.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.10.10.1.m1.2.2" mathsize="90%" xref="S5.T2.10.10.1.m1.2.2.cmml">30</mn><mo id="S5.T2.10.10.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.10.10.1.m1.3.3" mathsize="90%" xref="S5.T2.10.10.1.m1.3.3.cmml">30</mn><mo id="S5.T2.10.10.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.10.10.1.m1.4.4" mathsize="90%" xref="S5.T2.10.10.1.m1.4.4.cmml">30</mn><mo id="S5.T2.10.10.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.10.10.1.m1.5.5" mathsize="90%" xref="S5.T2.10.10.1.m1.5.5.cmml">12</mn><mo id="S5.T2.10.10.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.10.10.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.1.m1.5b"><vector id="S5.T2.10.10.1.m1.5.6.1.cmml" xref="S5.T2.10.10.1.m1.5.6.2"><cn id="S5.T2.10.10.1.m1.1.1.cmml" type="integer" xref="S5.T2.10.10.1.m1.1.1">12</cn><cn id="S5.T2.10.10.1.m1.2.2.cmml" type="integer" xref="S5.T2.10.10.1.m1.2.2">30</cn><cn id="S5.T2.10.10.1.m1.3.3.cmml" type="integer" xref="S5.T2.10.10.1.m1.3.3">30</cn><cn id="S5.T2.10.10.1.m1.4.4.cmml" type="integer" xref="S5.T2.10.10.1.m1.4.4">30</cn><cn id="S5.T2.10.10.1.m1.5.5.cmml" type="integer" xref="S5.T2.10.10.1.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.1.m1.5c">(12,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.10.1.m1.5d">( 12 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.11.11.2"><math alttext="(12,30,29,30,12)" class="ltx_Math" display="inline" id="S5.T2.11.11.2.m1.5"><semantics id="S5.T2.11.11.2.m1.5a"><mrow id="S5.T2.11.11.2.m1.5.6.2" xref="S5.T2.11.11.2.m1.5.6.1.cmml"><mo id="S5.T2.11.11.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.11.11.2.m1.1.1" mathsize="90%" xref="S5.T2.11.11.2.m1.1.1.cmml">12</mn><mo id="S5.T2.11.11.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.11.11.2.m1.2.2" mathsize="90%" xref="S5.T2.11.11.2.m1.2.2.cmml">30</mn><mo id="S5.T2.11.11.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.11.11.2.m1.3.3" mathsize="90%" xref="S5.T2.11.11.2.m1.3.3.cmml">29</mn><mo id="S5.T2.11.11.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.11.11.2.m1.4.4" mathsize="90%" xref="S5.T2.11.11.2.m1.4.4.cmml">30</mn><mo id="S5.T2.11.11.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.11.11.2.m1.5.5" mathsize="90%" xref="S5.T2.11.11.2.m1.5.5.cmml">12</mn><mo id="S5.T2.11.11.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.11.11.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.2.m1.5b"><vector id="S5.T2.11.11.2.m1.5.6.1.cmml" xref="S5.T2.11.11.2.m1.5.6.2"><cn id="S5.T2.11.11.2.m1.1.1.cmml" type="integer" xref="S5.T2.11.11.2.m1.1.1">12</cn><cn id="S5.T2.11.11.2.m1.2.2.cmml" type="integer" xref="S5.T2.11.11.2.m1.2.2">30</cn><cn id="S5.T2.11.11.2.m1.3.3.cmml" type="integer" xref="S5.T2.11.11.2.m1.3.3">29</cn><cn id="S5.T2.11.11.2.m1.4.4.cmml" type="integer" xref="S5.T2.11.11.2.m1.4.4">30</cn><cn id="S5.T2.11.11.2.m1.5.5.cmml" type="integer" xref="S5.T2.11.11.2.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.2.m1.5c">(12,30,29,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.11.11.2.m1.5d">( 12 , 30 , 29 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.12.12.3"><math alttext="(9,8,10,8,8)" class="ltx_Math" display="inline" id="S5.T2.12.12.3.m1.5"><semantics id="S5.T2.12.12.3.m1.5a"><mrow id="S5.T2.12.12.3.m1.5.6.2" xref="S5.T2.12.12.3.m1.5.6.1.cmml"><mo id="S5.T2.12.12.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.12.12.3.m1.1.1" mathsize="90%" xref="S5.T2.12.12.3.m1.1.1.cmml">9</mn><mo id="S5.T2.12.12.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.12.12.3.m1.2.2" mathsize="90%" xref="S5.T2.12.12.3.m1.2.2.cmml">8</mn><mo id="S5.T2.12.12.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.12.12.3.m1.3.3" mathsize="90%" xref="S5.T2.12.12.3.m1.3.3.cmml">10</mn><mo id="S5.T2.12.12.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.12.12.3.m1.4.4" mathsize="90%" xref="S5.T2.12.12.3.m1.4.4.cmml">8</mn><mo id="S5.T2.12.12.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.12.12.3.m1.5.5" mathsize="90%" xref="S5.T2.12.12.3.m1.5.5.cmml">8</mn><mo id="S5.T2.12.12.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.12.12.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.3.m1.5b"><vector id="S5.T2.12.12.3.m1.5.6.1.cmml" xref="S5.T2.12.12.3.m1.5.6.2"><cn id="S5.T2.12.12.3.m1.1.1.cmml" type="integer" xref="S5.T2.12.12.3.m1.1.1">9</cn><cn id="S5.T2.12.12.3.m1.2.2.cmml" type="integer" xref="S5.T2.12.12.3.m1.2.2">8</cn><cn id="S5.T2.12.12.3.m1.3.3.cmml" type="integer" xref="S5.T2.12.12.3.m1.3.3">10</cn><cn id="S5.T2.12.12.3.m1.4.4.cmml" type="integer" xref="S5.T2.12.12.3.m1.4.4">8</cn><cn id="S5.T2.12.12.3.m1.5.5.cmml" type="integer" xref="S5.T2.12.12.3.m1.5.5">8</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.3.m1.5c">(9,8,10,8,8)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.12.12.3.m1.5d">( 9 , 8 , 10 , 8 , 8 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.15.15.4"><span class="ltx_text" id="S5.T2.15.15.4.1" style="font-size:90%;">#1 linear-layer in Feed-Forward</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.13.13.1"><math alttext="(12,30,30,30,16)" class="ltx_Math" display="inline" id="S5.T2.13.13.1.m1.5"><semantics id="S5.T2.13.13.1.m1.5a"><mrow id="S5.T2.13.13.1.m1.5.6.2" xref="S5.T2.13.13.1.m1.5.6.1.cmml"><mo id="S5.T2.13.13.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.13.13.1.m1.1.1" mathsize="90%" xref="S5.T2.13.13.1.m1.1.1.cmml">12</mn><mo id="S5.T2.13.13.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.13.13.1.m1.2.2" mathsize="90%" xref="S5.T2.13.13.1.m1.2.2.cmml">30</mn><mo id="S5.T2.13.13.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.13.13.1.m1.3.3" mathsize="90%" xref="S5.T2.13.13.1.m1.3.3.cmml">30</mn><mo id="S5.T2.13.13.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.13.13.1.m1.4.4" mathsize="90%" xref="S5.T2.13.13.1.m1.4.4.cmml">30</mn><mo id="S5.T2.13.13.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.13.13.1.m1.5.5" mathsize="90%" xref="S5.T2.13.13.1.m1.5.5.cmml">16</mn><mo id="S5.T2.13.13.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.13.13.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.5b"><vector id="S5.T2.13.13.1.m1.5.6.1.cmml" xref="S5.T2.13.13.1.m1.5.6.2"><cn id="S5.T2.13.13.1.m1.1.1.cmml" type="integer" xref="S5.T2.13.13.1.m1.1.1">12</cn><cn id="S5.T2.13.13.1.m1.2.2.cmml" type="integer" xref="S5.T2.13.13.1.m1.2.2">30</cn><cn id="S5.T2.13.13.1.m1.3.3.cmml" type="integer" xref="S5.T2.13.13.1.m1.3.3">30</cn><cn id="S5.T2.13.13.1.m1.4.4.cmml" type="integer" xref="S5.T2.13.13.1.m1.4.4">30</cn><cn id="S5.T2.13.13.1.m1.5.5.cmml" type="integer" xref="S5.T2.13.13.1.m1.5.5">16</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.5c">(12,30,30,30,16)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.13.13.1.m1.5d">( 12 , 30 , 30 , 30 , 16 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.14.14.2"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.14.14.2.m1.5"><semantics id="S5.T2.14.14.2.m1.5a"><mrow id="S5.T2.14.14.2.m1.5.6.2" xref="S5.T2.14.14.2.m1.5.6.1.cmml"><mo id="S5.T2.14.14.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.14.14.2.m1.1.1" mathsize="90%" xref="S5.T2.14.14.2.m1.1.1.cmml">0</mn><mo id="S5.T2.14.14.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.14.14.2.m1.2.2" mathsize="90%" xref="S5.T2.14.14.2.m1.2.2.cmml">0</mn><mo id="S5.T2.14.14.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.14.14.2.m1.3.3" mathsize="90%" xref="S5.T2.14.14.2.m1.3.3.cmml">0</mn><mo id="S5.T2.14.14.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.14.14.2.m1.4.4" mathsize="90%" xref="S5.T2.14.14.2.m1.4.4.cmml">0</mn><mo id="S5.T2.14.14.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.14.14.2.m1.5.5" mathsize="90%" xref="S5.T2.14.14.2.m1.5.5.cmml">0</mn><mo id="S5.T2.14.14.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.14.14.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.5b"><vector id="S5.T2.14.14.2.m1.5.6.1.cmml" xref="S5.T2.14.14.2.m1.5.6.2"><cn id="S5.T2.14.14.2.m1.1.1.cmml" type="integer" xref="S5.T2.14.14.2.m1.1.1">0</cn><cn id="S5.T2.14.14.2.m1.2.2.cmml" type="integer" xref="S5.T2.14.14.2.m1.2.2">0</cn><cn id="S5.T2.14.14.2.m1.3.3.cmml" type="integer" xref="S5.T2.14.14.2.m1.3.3">0</cn><cn id="S5.T2.14.14.2.m1.4.4.cmml" type="integer" xref="S5.T2.14.14.2.m1.4.4">0</cn><cn id="S5.T2.14.14.2.m1.5.5.cmml" type="integer" xref="S5.T2.14.14.2.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.14.14.2.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.15.15.3"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.15.15.3.m1.5"><semantics id="S5.T2.15.15.3.m1.5a"><mrow id="S5.T2.15.15.3.m1.5.6.2" xref="S5.T2.15.15.3.m1.5.6.1.cmml"><mo id="S5.T2.15.15.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.15.15.3.m1.1.1" mathsize="90%" xref="S5.T2.15.15.3.m1.1.1.cmml">0</mn><mo id="S5.T2.15.15.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.15.15.3.m1.2.2" mathsize="90%" xref="S5.T2.15.15.3.m1.2.2.cmml">0</mn><mo id="S5.T2.15.15.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.15.15.3.m1.3.3" mathsize="90%" xref="S5.T2.15.15.3.m1.3.3.cmml">0</mn><mo id="S5.T2.15.15.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.15.15.3.m1.4.4" mathsize="90%" xref="S5.T2.15.15.3.m1.4.4.cmml">0</mn><mo id="S5.T2.15.15.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.15.15.3.m1.5.5" mathsize="90%" xref="S5.T2.15.15.3.m1.5.5.cmml">0</mn><mo id="S5.T2.15.15.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.15.15.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.3.m1.5b"><vector id="S5.T2.15.15.3.m1.5.6.1.cmml" xref="S5.T2.15.15.3.m1.5.6.2"><cn id="S5.T2.15.15.3.m1.1.1.cmml" type="integer" xref="S5.T2.15.15.3.m1.1.1">0</cn><cn id="S5.T2.15.15.3.m1.2.2.cmml" type="integer" xref="S5.T2.15.15.3.m1.2.2">0</cn><cn id="S5.T2.15.15.3.m1.3.3.cmml" type="integer" xref="S5.T2.15.15.3.m1.3.3">0</cn><cn id="S5.T2.15.15.3.m1.4.4.cmml" type="integer" xref="S5.T2.15.15.3.m1.4.4">0</cn><cn id="S5.T2.15.15.3.m1.5.5.cmml" type="integer" xref="S5.T2.15.15.3.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.3.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.15.15.3.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.18.18.4"><span class="ltx_text" id="S5.T2.18.18.4.1" style="font-size:90%;">#2 linear-layer in Feed-Forward</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.16.16.1"><math alttext="(16,30,30,30,12)" class="ltx_Math" display="inline" id="S5.T2.16.16.1.m1.5"><semantics id="S5.T2.16.16.1.m1.5a"><mrow id="S5.T2.16.16.1.m1.5.6.2" xref="S5.T2.16.16.1.m1.5.6.1.cmml"><mo id="S5.T2.16.16.1.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">(</mo><mn id="S5.T2.16.16.1.m1.1.1" mathsize="90%" xref="S5.T2.16.16.1.m1.1.1.cmml">16</mn><mo id="S5.T2.16.16.1.m1.5.6.2.2" mathsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.16.16.1.m1.2.2" mathsize="90%" xref="S5.T2.16.16.1.m1.2.2.cmml">30</mn><mo id="S5.T2.16.16.1.m1.5.6.2.3" mathsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.16.16.1.m1.3.3" mathsize="90%" xref="S5.T2.16.16.1.m1.3.3.cmml">30</mn><mo id="S5.T2.16.16.1.m1.5.6.2.4" mathsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.16.16.1.m1.4.4" mathsize="90%" xref="S5.T2.16.16.1.m1.4.4.cmml">30</mn><mo id="S5.T2.16.16.1.m1.5.6.2.5" mathsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">,</mo><mn id="S5.T2.16.16.1.m1.5.5" mathsize="90%" xref="S5.T2.16.16.1.m1.5.5.cmml">12</mn><mo id="S5.T2.16.16.1.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.16.16.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.1.m1.5b"><vector id="S5.T2.16.16.1.m1.5.6.1.cmml" xref="S5.T2.16.16.1.m1.5.6.2"><cn id="S5.T2.16.16.1.m1.1.1.cmml" type="integer" xref="S5.T2.16.16.1.m1.1.1">16</cn><cn id="S5.T2.16.16.1.m1.2.2.cmml" type="integer" xref="S5.T2.16.16.1.m1.2.2">30</cn><cn id="S5.T2.16.16.1.m1.3.3.cmml" type="integer" xref="S5.T2.16.16.1.m1.3.3">30</cn><cn id="S5.T2.16.16.1.m1.4.4.cmml" type="integer" xref="S5.T2.16.16.1.m1.4.4">30</cn><cn id="S5.T2.16.16.1.m1.5.5.cmml" type="integer" xref="S5.T2.16.16.1.m1.5.5">12</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.1.m1.5c">(16,30,30,30,12)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.16.16.1.m1.5d">( 16 , 30 , 30 , 30 , 12 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.17.17.2"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.17.17.2.m1.5"><semantics id="S5.T2.17.17.2.m1.5a"><mrow id="S5.T2.17.17.2.m1.5.6.2" xref="S5.T2.17.17.2.m1.5.6.1.cmml"><mo id="S5.T2.17.17.2.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">(</mo><mn id="S5.T2.17.17.2.m1.1.1" mathsize="90%" xref="S5.T2.17.17.2.m1.1.1.cmml">0</mn><mo id="S5.T2.17.17.2.m1.5.6.2.2" mathsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.17.17.2.m1.2.2" mathsize="90%" xref="S5.T2.17.17.2.m1.2.2.cmml">0</mn><mo id="S5.T2.17.17.2.m1.5.6.2.3" mathsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.17.17.2.m1.3.3" mathsize="90%" xref="S5.T2.17.17.2.m1.3.3.cmml">0</mn><mo id="S5.T2.17.17.2.m1.5.6.2.4" mathsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.17.17.2.m1.4.4" mathsize="90%" xref="S5.T2.17.17.2.m1.4.4.cmml">0</mn><mo id="S5.T2.17.17.2.m1.5.6.2.5" mathsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">,</mo><mn id="S5.T2.17.17.2.m1.5.5" mathsize="90%" xref="S5.T2.17.17.2.m1.5.5.cmml">0</mn><mo id="S5.T2.17.17.2.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.17.17.2.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.2.m1.5b"><vector id="S5.T2.17.17.2.m1.5.6.1.cmml" xref="S5.T2.17.17.2.m1.5.6.2"><cn id="S5.T2.17.17.2.m1.1.1.cmml" type="integer" xref="S5.T2.17.17.2.m1.1.1">0</cn><cn id="S5.T2.17.17.2.m1.2.2.cmml" type="integer" xref="S5.T2.17.17.2.m1.2.2">0</cn><cn id="S5.T2.17.17.2.m1.3.3.cmml" type="integer" xref="S5.T2.17.17.2.m1.3.3">0</cn><cn id="S5.T2.17.17.2.m1.4.4.cmml" type="integer" xref="S5.T2.17.17.2.m1.4.4">0</cn><cn id="S5.T2.17.17.2.m1.5.5.cmml" type="integer" xref="S5.T2.17.17.2.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.2.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.17.17.2.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.18.18.3"><math alttext="(0,0,0,0,0)" class="ltx_Math" display="inline" id="S5.T2.18.18.3.m1.5"><semantics id="S5.T2.18.18.3.m1.5a"><mrow id="S5.T2.18.18.3.m1.5.6.2" xref="S5.T2.18.18.3.m1.5.6.1.cmml"><mo id="S5.T2.18.18.3.m1.5.6.2.1" maxsize="90%" minsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">(</mo><mn id="S5.T2.18.18.3.m1.1.1" mathsize="90%" xref="S5.T2.18.18.3.m1.1.1.cmml">0</mn><mo id="S5.T2.18.18.3.m1.5.6.2.2" mathsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.18.18.3.m1.2.2" mathsize="90%" xref="S5.T2.18.18.3.m1.2.2.cmml">0</mn><mo id="S5.T2.18.18.3.m1.5.6.2.3" mathsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.18.18.3.m1.3.3" mathsize="90%" xref="S5.T2.18.18.3.m1.3.3.cmml">0</mn><mo id="S5.T2.18.18.3.m1.5.6.2.4" mathsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.18.18.3.m1.4.4" mathsize="90%" xref="S5.T2.18.18.3.m1.4.4.cmml">0</mn><mo id="S5.T2.18.18.3.m1.5.6.2.5" mathsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">,</mo><mn id="S5.T2.18.18.3.m1.5.5" mathsize="90%" xref="S5.T2.18.18.3.m1.5.5.cmml">0</mn><mo id="S5.T2.18.18.3.m1.5.6.2.6" maxsize="90%" minsize="90%" xref="S5.T2.18.18.3.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.3.m1.5b"><vector id="S5.T2.18.18.3.m1.5.6.1.cmml" xref="S5.T2.18.18.3.m1.5.6.2"><cn id="S5.T2.18.18.3.m1.1.1.cmml" type="integer" xref="S5.T2.18.18.3.m1.1.1">0</cn><cn id="S5.T2.18.18.3.m1.2.2.cmml" type="integer" xref="S5.T2.18.18.3.m1.2.2">0</cn><cn id="S5.T2.18.18.3.m1.3.3.cmml" type="integer" xref="S5.T2.18.18.3.m1.3.3">0</cn><cn id="S5.T2.18.18.3.m1.4.4.cmml" type="integer" xref="S5.T2.18.18.3.m1.4.4">0</cn><cn id="S5.T2.18.18.3.m1.5.5.cmml" type="integer" xref="S5.T2.18.18.3.m1.5.5">0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.3.m1.5c">(0,0,0,0,0)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.18.18.3.m1.5d">( 0 , 0 , 0 , 0 , 0 )</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">CoMERA Accuracy and Compression Performance.</h4>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p1.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.T1" title="Table 1 ‣ 4.3 GPU Performance Optimization via CUDA Graph ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the training results. The <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS0.Px1.p1.3.1">early-stage training</span> of CoMERA achieves <math alttext="74\times" class="ltx_math_unparsed" display="inline" id="S5.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px1.p1.1.m1.1b"><mn id="S5.SS1.SSS0.Px1.p1.1.m1.1.1">74</mn><mo id="S5.SS1.SSS0.Px1.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.1.m1.1c">74\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px1.p1.1.m1.1d">74 ×</annotation></semantics></math> compression ratio on all tensorized layers, and the validation accuracy is even higher than the uncompressed training. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.F6" title="Figure 6 ‣ 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">6</span></a> shows the validation accuracy of CoMERA. In the <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS0.Px1.p1.3.2">late stage</span> of CoMERA, we set different target compression ratios for more aggressive rank pruning. The target compression ratios are for the tensorized layers rather than for the whole model. The late-stage training can reach the desired compression ratio with very little accuracy drop. The smallest model has a compression ratio of <math alttext="80\times" class="ltx_math_unparsed" display="inline" id="S5.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S5.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S5.SS1.SSS0.Px1.p1.2.m2.1b"><mn id="S5.SS1.SSS0.Px1.p1.2.m2.1.1">80</mn><mo id="S5.SS1.SSS0.Px1.p1.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.2.m2.1c">80\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px1.p1.2.m2.1d">80 ×</annotation></semantics></math> for the whole model due to a <math alttext="361\times" class="ltx_math_unparsed" display="inline" id="S5.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S5.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.1b"><mn id="S5.SS1.SSS0.Px1.p1.3.m3.1.1">361</mn><mo id="S5.SS1.SSS0.Px1.p1.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.3.m3.1c">361\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px1.p1.3.m3.1d">361 ×</annotation></semantics></math> compression on the tensorized layers with slightly worse accuracy.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S5.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="S5.F7.g1" src="extracted/2405.14377v1/figures/CoMERA_MNLI_time.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S5.F7.3.2" style="font-size:90%;">Training time per epoch for the six-encoder transformer model on the MNLI dataset.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Architecture Search Capability of CoMERA.</h4>
<div class="ltx_para" id="S5.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px2.p1.1">A major challenge in training is architecture search: shall we keep certain layers of a model? Interestingly, CoMERA has some capability of automatic architecture search. Specifically, the ranks of some layers become zero in the training, and thus the whole layer can be removed. For the target compression ratio <math alttext="0.2" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS1.SSS0.Px2.p1.1.m1.1a"><mn id="S5.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.1.m1.1b"><cn id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" type="float" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.1.m1.1c">0.2</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p1.1.m1.1d">0.2</annotation></semantics></math>, the whole second last encoder and some linear layers in other encoders are completely removed after late-stage rank-adaptive training. The change of ranks of layers in the 5th encoder is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.T2" title="Table 2 ‣ 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Training Time.</h4>
<div class="ltx_para" id="S5.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px3.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.F7" title="Figure 7 ‣ CoMERA Accuracy and Compression Performance. ‣ 5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">7</span></a>, CoMERA with CUDAGraph achieves around <math alttext="3\times" class="ltx_math_unparsed" display="inline" id="S5.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px3.p1.1.m1.1b"><mn id="S5.SS1.SSS0.Px3.p1.1.m1.1.1">3</mn><mo id="S5.SS1.SSS0.Px3.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.1.m1.1c">3\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px3.p1.1.m1.1d">3 ×</annotation></semantics></math> speed-up than uncompressed training. CoMERA without CUDAGraph can take much longer time in small batch-size setting due to the launching overhead of too many small kernels. The uncompressed training with CUDAGraph takes longer time than the one without CUDAGraph. This is because CUDAGraph requires all batches to have the same sequence length, and the consequent computing overhead is more than the time reduction of CUDAGraph. In contrary, CoMERA has much fewer computing FLOPS and the computing part accounts for a much smaller portion of the overall runtime.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>A DLRM Model with 4-GB Model Size</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We further test CoMERA on DLRM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib28" title="">28</a>]</cite> released by Meta on Criteo Ad Kaggle dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib19" title="">19</a>]</cite>. We compress the ten largest embedding tables into the TTM format as in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS1" title="4.1 Performance Optimization of TTM Embedding Tables. ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.1</span></a>. All fully connected layers with sizes <math alttext="&gt;128" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><gt id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">&gt;128</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">&gt; 128</annotation></semantics></math> are compressed into TT format. The model is trained for two epochs.</p>
</div>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Effect of Optimized TTM Embedding.</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.2">The training time per epoch and peak memory consumption are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.F8" title="Figure 8 ‣ Overall Performance of CoMERA. ‣ 5.2 A DLRM Model with 4-GB Model Size ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">8</span></a>. Our optimized TTM lookup speeds up the training process by around <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="S5.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px1.p1.1.m1.1b"><mn id="S5.SS2.SSS0.Px1.p1.1.m1.1.1">2</mn><mo id="S5.SS2.SSS0.Px1.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.1.m1.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px1.p1.1.m1.1d">2 ×</annotation></semantics></math> and remarkably reduces the memory cost by <math alttext="4-5\times" class="ltx_math_unparsed" display="inline" id="S5.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S5.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.1b"><mn id="S5.SS2.SSS0.Px1.p1.2.m2.1.1">4</mn><mo id="S5.SS2.SSS0.Px1.p1.2.m2.1.2">−</mo><mn id="S5.SS2.SSS0.Px1.p1.2.m2.1.3">5</mn><mo id="S5.SS2.SSS0.Px1.p1.2.m2.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.2.m2.1c">4-5\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px1.p1.2.m2.1d">4 - 5 ×</annotation></semantics></math>, especially for large batch training.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Overall Performance of CoMERA.</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.T3" title="Table 3 ‣ Overall Performance of CoMERA. ‣ 5.2 A DLRM Model with 4-GB Model Size ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3</span></a> shows the testing accuracy, testing loss (measured as normalized CE), memory costs, and model sizes of CoMERA and uncompressed training. CoMERA achieves similar accuracy as the uncompressed training. Furthermore, CoMERA compresses the whole DLRM model by <math alttext="99\times" class="ltx_math_unparsed" display="inline" id="S5.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><mn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1">99</mn><mo id="S5.SS2.SSS0.Px2.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">99\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px2.p1.1.m1.1d">99 ×</annotation></semantics></math> and saves <math alttext="7\times" class="ltx_math_unparsed" display="inline" id="S5.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S5.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px2.p1.2.m2.1b"><mn id="S5.SS2.SSS0.Px2.p1.2.m2.1.1">7</mn><mo id="S5.SS2.SSS0.Px2.p1.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.2.m2.1c">7\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px2.p1.2.m2.1d">7 ×</annotation></semantics></math> peak memory cost (with consideration of the data and backend overhead in a large-batch setting) in the training process. The reduction of model size and memory cost mainly comes from the compact TTM tensor representation of large embedding tables.</p>
</div>
<figure class="ltx_table ltx_align_floatright" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.6.2.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.2.1" style="font-size:90%;">Training results on the DLRM model with a batch size <math alttext="10,000" class="ltx_Math" display="inline" id="S5.T3.2.1.m1.2"><semantics id="S5.T3.2.1.m1.2b"><mrow id="S5.T3.2.1.m1.2.3.2" xref="S5.T3.2.1.m1.2.3.1.cmml"><mn id="S5.T3.2.1.m1.1.1" xref="S5.T3.2.1.m1.1.1.cmml">10</mn><mo id="S5.T3.2.1.m1.2.3.2.1" xref="S5.T3.2.1.m1.2.3.1.cmml">,</mo><mn id="S5.T3.2.1.m1.2.2" xref="S5.T3.2.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.1.m1.2c"><list id="S5.T3.2.1.m1.2.3.1.cmml" xref="S5.T3.2.1.m1.2.3.2"><cn id="S5.T3.2.1.m1.1.1.cmml" type="integer" xref="S5.T3.2.1.m1.1.1">10</cn><cn id="S5.T3.2.1.m1.2.2.cmml" type="integer" xref="S5.T3.2.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.1.m1.2d">10,000</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.1.m1.2e">10 , 000</annotation></semantics></math>. </span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.4.3.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.4.3.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.4.3.1.2"><span class="ltx_text" id="S5.T3.4.3.1.2.1" style="font-size:90%;">uncompressed</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.4.3.1.3"><span class="ltx_text" id="S5.T3.4.3.1.3.1" style="font-size:90%;">CoMERA</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.4.4.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.4.4.1.1"><span class="ltx_text" id="S5.T3.4.4.1.1.1" style="font-size:90%;">accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.4.1.2"><span class="ltx_text" id="S5.T3.4.4.1.2.1" style="font-size:90%;">78.68%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.4.1.3"><span class="ltx_text" id="S5.T3.4.4.1.3.1" style="font-size:90%;">78.76%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.5.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.4.5.2.1"><span class="ltx_text" id="S5.T3.4.5.2.1.1" style="font-size:90%;">normalized CE</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.5.2.2"><span class="ltx_text" id="S5.T3.4.5.2.2.1" style="font-size:90%;">0.793</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.5.2.3"><span class="ltx_text" id="S5.T3.4.5.2.3.1" style="font-size:90%;">0.792</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.3.1.2"><span class="ltx_text" id="S5.T3.3.1.2.1" style="font-size:90%;">model size (GB)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.1.3"><span class="ltx_text" id="S5.T3.3.1.3.1" style="font-size:90%;">4.081</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.1.1">
<span class="ltx_text" id="S5.T3.3.1.1.2" style="font-size:90%;">0.041 (</span><span class="ltx_text ltx_font_bold" id="S5.T3.3.1.1.1" style="font-size:90%;">99<math alttext="\times" class="ltx_Math" display="inline" id="S5.T3.3.1.1.1.m1.1"><semantics id="S5.T3.3.1.1.1.m1.1a"><mo id="S5.T3.3.1.1.1.m1.1.1" xref="S5.T3.3.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.1.m1.1b"><times id="S5.T3.3.1.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.1.1.1.m1.1d">×</annotation></semantics></math></span><span class="ltx_text" id="S5.T3.3.1.1.3" style="font-size:90%;">)</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.2">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S5.T3.4.2.2"><span class="ltx_text" id="S5.T3.4.2.2.1" style="font-size:90%;">peak memory (GB)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.4.2.3"><span class="ltx_text" id="S5.T3.4.2.3.1" style="font-size:90%;">18.275</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.4.2.1">
<span class="ltx_text" id="S5.T3.4.2.1.2" style="font-size:90%;">2.612 (</span><span class="ltx_text ltx_font_bold" id="S5.T3.4.2.1.1" style="font-size:90%;">7<math alttext="\times" class="ltx_Math" display="inline" id="S5.T3.4.2.1.1.m1.1"><semantics id="S5.T3.4.2.1.1.m1.1a"><mo id="S5.T3.4.2.1.1.m1.1.1" xref="S5.T3.4.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.1.1.m1.1b"><times id="S5.T3.4.2.1.1.m1.1.1.cmml" xref="S5.T3.4.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.2.1.1.m1.1d">×</annotation></semantics></math></span><span class="ltx_text" id="S5.T3.4.2.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S5.F8.sf1.g1" src="extracted/2405.14377v1/figures/CoMERA_DLRM_time.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F8.sf1.3.2" style="font-size:90%;">Training time per epoch.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S5.F8.sf2.g1" src="extracted/2405.14377v1/figures/CoMERA_DLRM_memory.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F8.sf2.3.2" style="font-size:90%;">Memory cost.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S5.F8.3.2" style="font-size:90%;">Performance of optimized CoMERA on training DLRM.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Comparison with GaLore and LTE</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We compare our method with two recent low-rank compressed training frameworks: GaLore  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite> and LTE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib17" title="">17</a>]</cite>. GaLore <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite> reduces the memory cost by performing SVD compression on the gradient, and LTE represents the weights as the sum of parallel low-rank matrix factorizations. We evaluate their memory costs and training times per epoch on the six-encoder transformer model under different batch sizes. We do not compare the total training time because the training epochs of various methods are highly case-dependent.</p>
</div>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Training Time Per Epoch.</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px1.p1.6">We use rank <math alttext="128" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS3.SSS0.Px1.p1.1.m1.1a"><mn id="S5.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p1.1.m1.1b"><cn id="S5.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.1.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.1.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.1.m1.1d">128</annotation></semantics></math> for the low-rank gradients in GoLore, and rank <math alttext="32" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S5.SS3.SSS0.Px1.p1.2.m2.1a"><mn id="S5.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p1.2.m2.1b"><cn id="S5.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.2.m2.1d">32</annotation></semantics></math> and head number <math alttext="16" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S5.SS3.SSS0.Px1.p1.3.m3.1a"><mn id="S5.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS3.SSS0.Px1.p1.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p1.3.m3.1b"><cn id="S5.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.3.m3.1c">16</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.3.m3.1d">16</annotation></semantics></math> for the low-rank adapters in LTE. For a fair comparison, all methods are executed with CUDA graph to reduce the overhead of launching CUDA kernels. The runtimes per training epochs are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S1.F1" title="Figure 1 ‣ Paper Contributions. ‣ 1 Introduction ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a>(a). For the LTE, we only report the results for batch sizes <math alttext="32,64,128" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px1.p1.4.m4.3"><semantics id="S5.SS3.SSS0.Px1.p1.4.m4.3a"><mrow id="S5.SS3.SSS0.Px1.p1.4.m4.3.4.2" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.4.1.cmml"><mn id="S5.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S5.SS3.SSS0.Px1.p1.4.m4.1.1.cmml">32</mn><mo id="S5.SS3.SSS0.Px1.p1.4.m4.3.4.2.1" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.4.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px1.p1.4.m4.2.2" xref="S5.SS3.SSS0.Px1.p1.4.m4.2.2.cmml">64</mn><mo id="S5.SS3.SSS0.Px1.p1.4.m4.3.4.2.2" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.4.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px1.p1.4.m4.3.3" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p1.4.m4.3b"><list id="S5.SS3.SSS0.Px1.p1.4.m4.3.4.1.cmml" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.4.2"><cn id="S5.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.4.m4.1.1">32</cn><cn id="S5.SS3.SSS0.Px1.p1.4.m4.2.2.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.4.m4.2.2">64</cn><cn id="S5.SS3.SSS0.Px1.p1.4.m4.3.3.cmml" type="integer" xref="S5.SS3.SSS0.Px1.p1.4.m4.3.3">128</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.4.m4.3c">32,64,128</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.4.m4.3d">32 , 64 , 128</annotation></semantics></math> since it requires the batch size to be a multiple of the head number. Overall, our CoMERA is about <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="S5.SS3.SSS0.Px1.p1.5.m5.1"><semantics id="S5.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S5.SS3.SSS0.Px1.p1.5.m5.1b"><mn id="S5.SS3.SSS0.Px1.p1.5.m5.1.1">2</mn><mo id="S5.SS3.SSS0.Px1.p1.5.m5.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.5.m5.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.5.m5.1d">2 ×</annotation></semantics></math> faster than GaLore and <math alttext="3\times" class="ltx_math_unparsed" display="inline" id="S5.SS3.SSS0.Px1.p1.6.m6.1"><semantics id="S5.SS3.SSS0.Px1.p1.6.m6.1a"><mrow id="S5.SS3.SSS0.Px1.p1.6.m6.1b"><mn id="S5.SS3.SSS0.Px1.p1.6.m6.1.1">3</mn><mo id="S5.SS3.SSS0.Px1.p1.6.m6.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.6.m6.1c">3\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px1.p1.6.m6.1d">3 ×</annotation></semantics></math> faster than LTE for all batch sizes, because the forward and backward propagation using low-rank tensor-network contractions dramatically reduce the computing FLOPS.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Memory Cost.</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S1.F1" title="Figure 1 ‣ Paper Contributions. ‣ 1 Introduction ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a> (b) shows the memory cost of all three training methods. In the single-batch setting as used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#bib.bib37" title="">37</a>]</cite>, our CoMERA method is <math alttext="9\times" class="ltx_math_unparsed" display="inline" id="S5.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS3.SSS0.Px2.p1.1.m1.1b"><mn id="S5.SS3.SSS0.Px2.p1.1.m1.1.1">9</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px2.p1.1.m1.1c">9\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px2.p1.1.m1.1d">9 ×</annotation></semantics></math> more memory-efficient than Galore on the tested case (with consideration of data and back-end cost). As the batch size increases, the memory overhead caused by data and activation functions becomes more significant, leading to less memory reduction ratios. However, our proposed CoMERA still uses the least memory.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions and Future work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.4">This work has presented CoMERA framework to reduce the memory and computing time of training AI models. We have investigated rank-adaptive training via multi-objective optimization to meet specific model sizes while maintaining model performance. We have achieved real training speedup on GPU via three optimizations: optimizing the tensorized embedding tables, optimizing the contraction path in tensorized forward and backward propagation, and optimizing the GPU latency via CUDAGraph. The experiments on a transformer model demonstrated that CoMERA can achieve <math alttext="2-3\times" class="ltx_math_unparsed" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mrow id="S6.p1.1.m1.1b"><mn id="S6.p1.1.m1.1.1">2</mn><mo id="S6.p1.1.m1.1.2">−</mo><mn id="S6.p1.1.m1.1.3">3</mn><mo id="S6.p1.1.m1.1.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">2-3\times</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">2 - 3 ×</annotation></semantics></math> speedup per training epoch. The model sizes of the transformer and a DLRM model have been reduced by <math alttext="43\times" class="ltx_math_unparsed" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mrow id="S6.p1.2.m2.1b"><mn id="S6.p1.2.m2.1.1">43</mn><mo id="S6.p1.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">43\times</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">43 ×</annotation></semantics></math> to <math alttext="99\times" class="ltx_math_unparsed" display="inline" id="S6.p1.3.m3.1"><semantics id="S6.p1.3.m3.1a"><mrow id="S6.p1.3.m3.1b"><mn id="S6.p1.3.m3.1.1">99</mn><mo id="S6.p1.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">99\times</annotation><annotation encoding="application/x-llamapun" id="S6.p1.3.m3.1d">99 ×</annotation></semantics></math> in the training process, leading to significant peak memory reduction (e.g., <math alttext="7\times" class="ltx_math_unparsed" display="inline" id="S6.p1.4.m4.1"><semantics id="S6.p1.4.m4.1a"><mrow id="S6.p1.4.m4.1b"><mn id="S6.p1.4.m4.1.1">7</mn><mo id="S6.p1.4.m4.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.p1.4.m4.1c">7\times</annotation><annotation encoding="application/x-llamapun" id="S6.p1.4.m4.1d">7 ×</annotation></semantics></math> total reduction in large-batch training of DLRM on a single GPU). Our method has also outperformed the latest GaLore and LTE frameworks in both memory and runtime efficiency. We have also observed further speedup by combining CoMERA with mixed-precision computation. The discussions and some preliminary results are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.SS7" title="A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">A.7</span></a>.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Unlike large-size matrix operations, the small low-rank tensor operations used in CoMERA are not yet well-supported by existing GPU kernels. The performance of CoMERA can be further boosted significantly after a comprehensive GPU optimization. The existing optimizers, e.g. Adam, are well-studied for uncompressed training. However, CoMERA has a very different optimization landscape due to the tensorized structure. Therefore, it is also worth studying the optimization algorithms specifically for CoMERA in the future.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
AI and compute.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/blog/ai-and-compute/" title="">https://openai.com/blog/ai-and-compute/</a>.

</span>
<span class="ltx_bibblock">OpenAI in 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
ChatGPT and generative AI are booming, but the costs can be extraordinary.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.cnbc.com/2023/03/13/chatgpt-and-generative-ai-are-booming-but-at-a-very-expensive-price.html" title="">https://www.cnbc.com/2023/03/13/chatgpt-and-generative-ai-are-booming-but-at-a-very-expensive-price.html</a>.

</span>
<span class="ltx_bibblock">Accessed: 2023-03-15.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Update: ChatGPT runs 10K Nvidia training GPUs with potential for thousands more.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.fierceelectronics.com/sensors/chatgpt-runs-10k-nvidia-training-gpus-potential-thousands-more" title="">https://www.fierceelectronics.com/sensors/chatgpt-runs-10k-nvidia-training-gpus-potential-thousands-more</a>.

</span>
<span class="ltx_bibblock">Accessed: 2023-03-15.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tom B Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2005.14165</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Giuseppe G Calvi, Ahmad Moniri, Mahmoud Mahfouz, Qibin Zhao, and Danilo P Mandic.

</span>
<span class="ltx_bibblock">Compression and interpretability of deep neural networks via tucker tensor layer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">arXiv:1903.06133</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Beidi Chen, Tri Dao, Kaizhao Liang, Jiaming Yang, Zhao Song, Atri Rudra, and Christopher Re.

</span>
<span class="ltx_bibblock">Pixelated Butterfly: Simple and efficient sparse training for neural network models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2112.00029</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Wenlin Chen, James Wilson, Stephen Tyree, Kilian Weinberger, and Yixin Chen.

</span>
<span class="ltx_bibblock">Compressing neural networks with the hashing trick.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">International Conference on Machine Learning</span>, pages 2285–2294, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Kalyanmoy Deb, Karthik Sindhya, and Jussi Hakanen.

</span>
<span class="ltx_bibblock">Multi-objective optimization.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Decision sciences</span>, pages 161–200. CRC Press, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Suyog Gupta, Ankur Agrawal, Kailash Gopalakrishnan, and Pritish Narayanan.

</span>
<span class="ltx_bibblock">Deep learning with limited numerical precision.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">International Conference on Machine Learning</span>, pages 1737–1746, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Song Han, Huizi Mao, and William J Dally.

</span>
<span class="ltx_bibblock">Deep compression: Compressing deep neural networks with pruning, trained quantization and huffman coding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1510.00149</span>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Cole Hawkins, Xing Liu, and Zheng Zhang.

</span>
<span class="ltx_bibblock">Towards compact neural networks via end-to-end training: A bayesian tensor approach with automatic rank determination.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">SIAM Journal on Mathematics of Data Science</span>, 4(1):46–71, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Cole Hawkins and Zheng Zhang.

</span>
<span class="ltx_bibblock">Bayesian tensorized neural networks with automatic rank selection.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Neurocomputing</span>, 453:172–180, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Qinyao He, He Wen, Shuchang Zhou, Yuxin Wu, Cong Yao, Xinyu Zhou, and Yuheng Zou.

</span>
<span class="ltx_bibblock">Effective quantization methods for recurrent neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1611.10176</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1503.02531</span>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Oleksii Hrinchuk, Valentin Khrulkov, Leyla Mirvakhabova, Elena Orlova, and Ivan Oseledets.

</span>
<span class="ltx_bibblock">Tensorized embedding layers for efficient model compression.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:1901.10787</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Itay Hubara, Matthieu Courbariaux, Daniel Soudry, Ran El-Yaniv, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Quantized neural networks: Training neural networks with low precision weights and activations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">The Journal of Machine Learning Research</span>, 18(1):6869–6898, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Minyoung Huh, Brian Cheung, Jeremy Bernstein, Phillip Isola, and Pulkit Agrawal.

</span>
<span class="ltx_bibblock">Training neural networks from scratch with parallel low-rank adapters.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2402.16828</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Max Jaderberg, Andrea Vedaldi, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Speeding up convolutional neural networks with low rank expansions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1405.3866</span>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Olivier Chapelle Jean-Baptiste Tien, joycenv.

</span>
<span class="ltx_bibblock">Display advertising challenge, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Valentin Khrulkov, Oleksii Hrinchuk, Leyla Mirvakhabova, and Ivan Oseledets.

</span>
<span class="ltx_bibblock">Tensorized embedding layers for efficient model compression.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1901.10787</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Yong-Deok Kim, Eunhyeok Park, Sungjoo Yoo, Taelim Choi, Lu Yang, and Dongjun Shin.

</span>
<span class="ltx_bibblock">Compression of deep convolutional neural networks for fast and low power mobile applications.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:1511.06530</span>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Tamara G. Kolda and Brett W. Bader.

</span>
<span class="ltx_bibblock">Tensor decompositions and applications.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">SIAM Review</span>, 51(3):455–500, Aug. 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Urs Köster, Tristan Webb, Xin Wang, Marcel Nassar, Arjun K Bansal, William Constable, Oguz Elibol, Scott Gray, Stewart Hall, Luke Hornof, et al.

</span>
<span class="ltx_bibblock">Flexpoint: An adaptive numerical format for efficient training of deep neural networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">NIPS</span>, pages 1742–1752, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Joseph M Landsberg.

</span>
<span class="ltx_bibblock">Tensors: geometry and applications.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Representation theory</span>, 381(402):3, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Vadim Lebedev, Yaroslav Ganin, Maksim Rakhuba, Ivan Oseledets, and Victor Lempitsky.

</span>
<span class="ltx_bibblock">Speeding-up convolutional neural networks using fine-tuned cp-decomposition.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:1412.6553</span>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Jian-Hao Luo, Jianxin Wu, and Weiyao Lin.

</span>
<span class="ltx_bibblock">Thinet: A filter level pruning method for deep neural network compression.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IEEE international conference on computer vision</span>, pages 5058–5066, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Pavlo Molchanov, Arun Mallya, Stephen Tyree, Iuri Frosio, and Jan Kautz.

</span>
<span class="ltx_bibblock">Importance estimation for neural network pruning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pages 11264–11272, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Maxim Naumov, Dheevatsa Mudigere, Hao-Jun Michael Shi, Jianyu Huang, Narayanan Sundaraman, Jongsoo Park, Xiaodong Wang, Udit Gupta, Carole-Jean Wu, Alisson G Azzolini, et al.

</span>
<span class="ltx_bibblock">Deep learning recommendation model for personalization and recommendation systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1906.00091</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Alexander Novikov, Dmitrii Podoprikhin, Anton Osokin, and Dmitry P Vetrov.

</span>
<span class="ltx_bibblock">Tensorizing neural networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Advances in neural information processing systems</span>, pages 442–450, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Alexander Novikov, Dmitrii Podoprikhin, Anton Osokin, and Dmitry P Vetrov.

</span>
<span class="ltx_bibblock">Tensorizing neural networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems 28</span>, pages 442–450, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Ivan V Oseledets.

</span>
<span class="ltx_bibblock">Tensor-train decomposition.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">SIAM Journal on Scientific Computing</span>, 33(5):2295–2317, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Xiao Sun, Naigang Wang, Chia-Yu Chen, Jiamin Ni, Ankur Agrawal, Xiaodong Cui, Swagath Venkataramani, Kaoutar El Maghraoui, Vijayalakshmi Viji Srinivasan, and Kailash Gopalakrishnan.

</span>
<span class="ltx_bibblock">Ultra-low precision 4-bit training of deep neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">NIPS</span>, 33, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Andros Tjandra, Sakriani Sakti, and Satoshi Nakamura.

</span>
<span class="ltx_bibblock">Compressing recurrent neural network with tensor train.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">CoRR</span>, abs/1705.08052, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Adina Williams, Nikita Nangia, and Samuel Bowman.

</span>
<span class="ltx_bibblock">A broad-coverage challenge corpus for sentence understanding through inference.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers)</span>, pages 1112–1122. Association for Computational Linguistics, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Yifan Yang, Jiajun Zhou, Ngai Wong, and Zheng Zhang.

</span>
<span class="ltx_bibblock">LoRETTA: Low-rank economic tensor-train adaptation for ultra-low-parameter fine-tuning of large language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2402.11417</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Yinchong Yang, Denis Krompass, and Volker Tresp.

</span>
<span class="ltx_bibblock">Tensor-train recurrent neural networks for video classification.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Proc. the 34th International Conference on Machine Learning</span>, volume 70, pages 3891–3900, Sydney, Australia, 06–11 Aug 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Jiawei Zhao, Zhenyu Zhang, Beidi Chen, Zhangyang Wang, Anima Anandkumar, and Yuandong Tian.

</span>
<span class="ltx_bibblock">Galore: Memory-efficient LLM training by gradient low-rank projection, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Yequan Zhao, Xinling Yu, Zhixiong Chen, Ziyue Liu, Sijia Liu, and Zheng Zhang.

</span>
<span class="ltx_bibblock">Tensor-compressed back-propagation-free training for (physics-informed) neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2308.09858</span>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Supplementary Material</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof of Proposition <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.Thmtheorem1" title="Proposition 3.1. ‣ Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3.1</span></a>
</h3>
<div class="ltx_proof" id="A1.SS1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.SS1.1.p1">
<p class="ltx_p" id="A1.SS1.1.p1.10">The objective function in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) is bounded below by <math alttext="0" class="ltx_Math" display="inline" id="A1.SS1.1.p1.1.m1.1"><semantics id="A1.SS1.1.p1.1.m1.1a"><mn id="A1.SS1.1.p1.1.m1.1.1" xref="A1.SS1.1.p1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.1.m1.1b"><cn id="A1.SS1.1.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS1.1.p1.1.m1.1.1">0</cn></annotation-xml></semantics></math>. Hence, the problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) has a finite infimum value <math alttext="f^{*}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.2.m2.1"><semantics id="A1.SS1.1.p1.2.m2.1a"><msup id="A1.SS1.1.p1.2.m2.1.1" xref="A1.SS1.1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.1.p1.2.m2.1.1.2" xref="A1.SS1.1.p1.2.m2.1.1.2.cmml">f</mi><mo id="A1.SS1.1.p1.2.m2.1.1.3" xref="A1.SS1.1.p1.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.2.m2.1b"><apply id="A1.SS1.1.p1.2.m2.1.1.cmml" xref="A1.SS1.1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.1.p1.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.1.p1.2.m2.1.1.2">𝑓</ci><times id="A1.SS1.1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.1.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.2.m2.1c">f^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.2.m2.1d">italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. Let <math alttext="\{\mathbfcal{G}^{k},\mathbf{D}^{k}\}_{k=1}^{\infty}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.3.m3.1"><semantics id="A1.SS1.1.p1.3.m3.1a"><msubsup id="A1.SS1.1.p1.3.m3.1.1" xref="A1.SS1.1.p1.3.m3.1.1.cmml"><mrow id="A1.SS1.1.p1.3.m3.1.1.1.1.1" xref="A1.SS1.1.p1.3.m3.1.1.1.1.2.cmml"><mo id="A1.SS1.1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.1.p1.3.m3.1.1.1.1.2.cmml">{</mo><mrow id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.cmml"><msup id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.cmml"><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.2" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.2.cmml">𝒢</mi><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.3" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.3.cmml">∥</mi></msup><mo id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.3" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.3.cmml">⇔</mi><mo id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1a" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.cmml"><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.2" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.2.cmml">𝒟</mi><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.3" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.3.cmml">∥</mi></msup></mrow><mo id="A1.SS1.1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.1.p1.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS1.1.p1.3.m3.1.1.1.3" xref="A1.SS1.1.p1.3.m3.1.1.1.3.cmml"><mi id="A1.SS1.1.p1.3.m3.1.1.1.3.2" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.3.2.cmml">∥</mi><mo id="A1.SS1.1.p1.3.m3.1.1.1.3.1" xref="A1.SS1.1.p1.3.m3.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.1.p1.3.m3.1.1.1.3.3" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.3.3.cmml">ℑ</mi><mo id="A1.SS1.1.p1.3.m3.1.1.1.3.1a" xref="A1.SS1.1.p1.3.m3.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.1.p1.3.m3.1.1.1.3.4" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.1.3.4.cmml">∞</mi></mrow><mi id="A1.SS1.1.p1.3.m3.1.1.3" mathvariant="normal" xref="A1.SS1.1.p1.3.m3.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.3.m3.1b"><apply id="A1.SS1.1.p1.3.m3.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1">superscript</csymbol><apply id="A1.SS1.1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1">subscript</csymbol><set id="A1.SS1.1.p1.3.m3.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1"><apply id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1"><times id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.1"></times><apply id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.2">𝒢</ci><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.2.3">∥</ci></apply><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.3">⇔</ci><apply id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4">superscript</csymbol><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.2">𝒟</ci><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.4.3">∥</ci></apply></apply></set><apply id="A1.SS1.1.p1.3.m3.1.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.3"><times id="A1.SS1.1.p1.3.m3.1.1.1.3.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.3.1"></times><ci id="A1.SS1.1.p1.3.m3.1.1.1.3.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.3.2">∥</ci><ci id="A1.SS1.1.p1.3.m3.1.1.1.3.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.3.3">ℑ</ci><ci id="A1.SS1.1.p1.3.m3.1.1.1.3.4.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.3.4">∞</ci></apply></apply><infinity id="A1.SS1.1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.3.m3.1c">\{\mathbfcal{G}^{k},\mathbf{D}^{k}\}_{k=1}^{\infty}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.3.m3.1d">{ roman_𝒢 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ⇔ roman_𝒟 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT ∥ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> be a sequence such that <math alttext="\lim_{k\to\infty}L(\mathbfcal{G}^{k},\mathbf{D}^{k})+\gamma\hat{S}(\mathbf{D}^%
{k})+\beta\|\mathbfcal{G}^{k}\|^{2}=f^{*}" class="ltx_math_unparsed" display="inline" id="A1.SS1.1.p1.4.m4.1"><semantics id="A1.SS1.1.p1.4.m4.1a"><mrow id="A1.SS1.1.p1.4.m4.1b"><msub id="A1.SS1.1.p1.4.m4.1.1"><mo id="A1.SS1.1.p1.4.m4.1.1.2">lim</mo><mrow id="A1.SS1.1.p1.4.m4.1.1.3"><mi id="A1.SS1.1.p1.4.m4.1.1.3.2">k</mi><mo id="A1.SS1.1.p1.4.m4.1.1.3.1" stretchy="false">→</mo><mi id="A1.SS1.1.p1.4.m4.1.1.3.3" mathvariant="normal">∞</mi></mrow></msub><mi id="A1.SS1.1.p1.4.m4.1.2">L</mi><mrow id="A1.SS1.1.p1.4.m4.1.3"><mo id="A1.SS1.1.p1.4.m4.1.3.1" stretchy="false">(</mo><msup id="A1.SS1.1.p1.4.m4.1.3.2"><mi id="A1.SS1.1.p1.4.m4.1.3.2.2" mathvariant="normal">𝒢</mi><mi id="A1.SS1.1.p1.4.m4.1.3.2.3" mathvariant="normal">∥</mi></msup><mi id="A1.SS1.1.p1.4.m4.1.3.3" mathvariant="normal">⇔</mi><msup id="A1.SS1.1.p1.4.m4.1.3.4"><mi id="A1.SS1.1.p1.4.m4.1.3.4.2" mathvariant="normal">𝒟</mi><mi id="A1.SS1.1.p1.4.m4.1.3.4.3" mathvariant="normal">∥</mi></msup><mi id="A1.SS1.1.p1.4.m4.1.3.5" mathvariant="normal">⇒</mi><mi id="A1.SS1.1.p1.4.m4.1.3.6" mathvariant="normal">⇓</mi><mi id="A1.SS1.1.p1.4.m4.1.3.7">γ</mi><mover accent="true" id="A1.SS1.1.p1.4.m4.1.3.8"><mi id="A1.SS1.1.p1.4.m4.1.3.8.2" mathvariant="normal">𝒮</mi><mo id="A1.SS1.1.p1.4.m4.1.3.8.1">^</mo></mover><mi id="A1.SS1.1.p1.4.m4.1.3.9" mathvariant="normal">⇐</mi><msup id="A1.SS1.1.p1.4.m4.1.3.10"><mi id="A1.SS1.1.p1.4.m4.1.3.10.2" mathvariant="normal">𝒟</mi><mi id="A1.SS1.1.p1.4.m4.1.3.10.3" mathvariant="normal">∥</mi></msup><mi id="A1.SS1.1.p1.4.m4.1.3.11" mathvariant="normal">⇒</mi><mi id="A1.SS1.1.p1.4.m4.1.3.12" mathvariant="normal">⇓</mi><mi id="A1.SS1.1.p1.4.m4.1.3.13">β</mi><mo id="A1.SS1.1.p1.4.m4.1.3.14" lspace="0em" rspace="0.167em">∥</mo><msup id="A1.SS1.1.p1.4.m4.1.3.15"><mi id="A1.SS1.1.p1.4.m4.1.3.15.2" mathvariant="normal">𝒢</mi><mi id="A1.SS1.1.p1.4.m4.1.3.15.3" mathvariant="normal">∥</mi></msup><msup id="A1.SS1.1.p1.4.m4.1.3.16"><mo id="A1.SS1.1.p1.4.m4.1.3.16.2" lspace="0em" rspace="0.167em">∥</mo><mi id="A1.SS1.1.p1.4.m4.1.3.16.3" mathvariant="normal">∈</mi></msup><mi id="A1.SS1.1.p1.4.m4.1.3.17" mathvariant="normal">ℑ</mi><msup id="A1.SS1.1.p1.4.m4.1.3.18"><mi id="A1.SS1.1.p1.4.m4.1.3.18.2" mathvariant="normal">{</mi><mi id="A1.SS1.1.p1.4.m4.1.3.18.3" mathvariant="normal">⇑</mi></msup></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS1.1.p1.4.m4.1c">\lim_{k\to\infty}L(\mathbfcal{G}^{k},\mathbf{D}^{k})+\gamma\hat{S}(\mathbf{D}^%
{k})+\beta\|\mathbfcal{G}^{k}\|^{2}=f^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.4.m4.1d">roman_lim start_POSTSUBSCRIPT italic_k → ∞ end_POSTSUBSCRIPT italic_L ( roman_𝒢 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ⇔ roman_𝒟 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ⇒ ⇓ italic_γ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ⇒ ⇓ italic_β ∥ roman_𝒢 start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT roman_ℑ { start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT</annotation></semantics></math>. The sequence must be bounded because of the <math alttext="l_{1}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.5.m5.1"><semantics id="A1.SS1.1.p1.5.m5.1a"><msub id="A1.SS1.1.p1.5.m5.1.1" xref="A1.SS1.1.p1.5.m5.1.1.cmml"><mi id="A1.SS1.1.p1.5.m5.1.1.2" xref="A1.SS1.1.p1.5.m5.1.1.2.cmml">l</mi><mn id="A1.SS1.1.p1.5.m5.1.1.3" xref="A1.SS1.1.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.5.m5.1b"><apply id="A1.SS1.1.p1.5.m5.1.1.cmml" xref="A1.SS1.1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.5.m5.1.1.1.cmml" xref="A1.SS1.1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.5.m5.1.1.2.cmml" xref="A1.SS1.1.p1.5.m5.1.1.2">𝑙</ci><cn id="A1.SS1.1.p1.5.m5.1.1.3.cmml" type="integer" xref="A1.SS1.1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.5.m5.1c">l_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.5.m5.1d">italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> regularization of <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.6.m6.1"><semantics id="A1.SS1.1.p1.6.m6.1a"><mi id="A1.SS1.1.p1.6.m6.1.1" xref="A1.SS1.1.p1.6.m6.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.6.m6.1b"><ci id="A1.SS1.1.p1.6.m6.1.1.cmml" xref="A1.SS1.1.p1.6.m6.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.6.m6.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.6.m6.1d">bold_D</annotation></semantics></math> and the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.7.m7.1"><semantics id="A1.SS1.1.p1.7.m7.1a"><msub id="A1.SS1.1.p1.7.m7.1.1" xref="A1.SS1.1.p1.7.m7.1.1.cmml"><mi id="A1.SS1.1.p1.7.m7.1.1.2" mathvariant="normal" xref="A1.SS1.1.p1.7.m7.1.1.2.cmml">ℓ</mi><mn id="A1.SS1.1.p1.7.m7.1.1.3" xref="A1.SS1.1.p1.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.7.m7.1b"><apply id="A1.SS1.1.p1.7.m7.1.1.cmml" xref="A1.SS1.1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.7.m7.1.1.1.cmml" xref="A1.SS1.1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.7.m7.1.1.2.cmml" xref="A1.SS1.1.p1.7.m7.1.1.2">ℓ</ci><cn id="A1.SS1.1.p1.7.m7.1.1.3.cmml" type="integer" xref="A1.SS1.1.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.7.m7.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.7.m7.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> regularization of <math alttext="\mathbfcal{G}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.8.m8.1"><semantics id="A1.SS1.1.p1.8.m8.1a"><mi id="A1.SS1.1.p1.8.m8.1.1" mathvariant="normal" xref="A1.SS1.1.p1.8.m8.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.8.m8.1b"><ci id="A1.SS1.1.p1.8.m8.1.1.cmml" xref="A1.SS1.1.p1.8.m8.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.8.m8.1c">\mathbfcal{G}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.8.m8.1d">roman_𝒢</annotation></semantics></math>. As a result, the sequence has a cluster point <math alttext="(\mathbfcal{G}^{*},\mathbf{D}^{*})" class="ltx_math_unparsed" display="inline" id="A1.SS1.1.p1.9.m9.1"><semantics id="A1.SS1.1.p1.9.m9.1a"><mrow id="A1.SS1.1.p1.9.m9.1b"><mo id="A1.SS1.1.p1.9.m9.1.1" stretchy="false">(</mo><msup id="A1.SS1.1.p1.9.m9.1.2"><mi id="A1.SS1.1.p1.9.m9.1.2.2" mathvariant="normal">𝒢</mi><mi id="A1.SS1.1.p1.9.m9.1.2.3" mathvariant="normal">⇑</mi></msup><mi id="A1.SS1.1.p1.9.m9.1.3" mathvariant="normal">⇔</mi><msup id="A1.SS1.1.p1.9.m9.1.4"><mi id="A1.SS1.1.p1.9.m9.1.4.2" mathvariant="normal">𝒟</mi><mi id="A1.SS1.1.p1.9.m9.1.4.3" mathvariant="normal">⇑</mi></msup><mi id="A1.SS1.1.p1.9.m9.1.5" mathvariant="normal">⇒</mi></mrow><annotation encoding="application/x-tex" id="A1.SS1.1.p1.9.m9.1c">(\mathbfcal{G}^{*},\mathbf{D}^{*})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.9.m9.1d">( roman_𝒢 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇔ roman_𝒟 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ⇒</annotation></semantics></math> which is a minimizer of the (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>). Let <math alttext="C:=\|\mathbfcal{G}^{*}\|^{2}" class="ltx_Math" display="inline" id="A1.SS1.1.p1.10.m10.1"><semantics id="A1.SS1.1.p1.10.m10.1a"><mrow id="A1.SS1.1.p1.10.m10.1.1" xref="A1.SS1.1.p1.10.m10.1.1.cmml"><mi id="A1.SS1.1.p1.10.m10.1.1.3" xref="A1.SS1.1.p1.10.m10.1.1.3.cmml">C</mi><mo id="A1.SS1.1.p1.10.m10.1.1.2" lspace="0.278em" rspace="0.278em" xref="A1.SS1.1.p1.10.m10.1.1.2.cmml">:=</mo><msup id="A1.SS1.1.p1.10.m10.1.1.1" xref="A1.SS1.1.p1.10.m10.1.1.1.cmml"><mrow id="A1.SS1.1.p1.10.m10.1.1.1.1.1" xref="A1.SS1.1.p1.10.m10.1.1.1.1.2.cmml"><mo id="A1.SS1.1.p1.10.m10.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.1.p1.10.m10.1.1.1.1.2.1.cmml">‖</mo><msup id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.2" mathvariant="normal" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.2.cmml">𝒢</mi><mi id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.3" mathvariant="normal" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.3.cmml">⇑</mi></msup><mo id="A1.SS1.1.p1.10.m10.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.1.p1.10.m10.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="A1.SS1.1.p1.10.m10.1.1.1.3" mathvariant="normal" xref="A1.SS1.1.p1.10.m10.1.1.1.3.cmml">∈</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.10.m10.1b"><apply id="A1.SS1.1.p1.10.m10.1.1.cmml" xref="A1.SS1.1.p1.10.m10.1.1"><csymbol cd="latexml" id="A1.SS1.1.p1.10.m10.1.1.2.cmml" xref="A1.SS1.1.p1.10.m10.1.1.2">assign</csymbol><ci id="A1.SS1.1.p1.10.m10.1.1.3.cmml" xref="A1.SS1.1.p1.10.m10.1.1.3">𝐶</ci><apply id="A1.SS1.1.p1.10.m10.1.1.1.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.10.m10.1.1.1.2.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1">superscript</csymbol><apply id="A1.SS1.1.p1.10.m10.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.1.p1.10.m10.1.1.1.1.2.1.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.2">norm</csymbol><apply id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1">superscript</csymbol><ci id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.2">𝒢</ci><ci id="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.1.1.1.3">⇑</ci></apply></apply><ci id="A1.SS1.1.p1.10.m10.1.1.1.3.cmml" xref="A1.SS1.1.p1.10.m10.1.1.1.3">∈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.10.m10.1c">C:=\|\mathbfcal{G}^{*}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.10.m10.1d">italic_C := ∥ roman_𝒢 start_POSTSUPERSCRIPT ⇑ end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math>. The relaxation (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) is equivalent to the constrained optimization problem.</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="A1.EGx8">
<tbody id="A1.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\mathbfcal{G},\mathbf{D}}" class="ltx_Math" display="inline" id="A1.E30.m1.1"><semantics id="A1.E30.m1.1a"><munder id="A1.E30.m1.1.1" xref="A1.E30.m1.1.1.cmml"><mi id="A1.E30.m1.1.1.2" xref="A1.E30.m1.1.1.2.cmml">min</mi><mrow id="A1.E30.m1.1.1.3" xref="A1.E30.m1.1.1.3.cmml"><mi id="A1.E30.m1.1.1.3.2" mathvariant="normal" xref="A1.E30.m1.1.1.3.2.cmml">𝒢</mi><mo id="A1.E30.m1.1.1.3.1" xref="A1.E30.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.E30.m1.1.1.3.3" mathvariant="normal" xref="A1.E30.m1.1.1.3.3.cmml">⇔</mi><mo id="A1.E30.m1.1.1.3.1a" xref="A1.E30.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.E30.m1.1.1.3.4" mathvariant="normal" xref="A1.E30.m1.1.1.3.4.cmml">𝒟</mi></mrow></munder><annotation-xml encoding="MathML-Content" id="A1.E30.m1.1b"><apply id="A1.E30.m1.1.1.cmml" xref="A1.E30.m1.1.1"><csymbol cd="ambiguous" id="A1.E30.m1.1.1.1.cmml" xref="A1.E30.m1.1.1">subscript</csymbol><min id="A1.E30.m1.1.1.2.cmml" xref="A1.E30.m1.1.1.2"></min><apply id="A1.E30.m1.1.1.3.cmml" xref="A1.E30.m1.1.1.3"><times id="A1.E30.m1.1.1.3.1.cmml" xref="A1.E30.m1.1.1.3.1"></times><ci id="A1.E30.m1.1.1.3.2.cmml" xref="A1.E30.m1.1.1.3.2">𝒢</ci><ci id="A1.E30.m1.1.1.3.3.cmml" xref="A1.E30.m1.1.1.3.3">⇔</ci><ci id="A1.E30.m1.1.1.3.4.cmml" xref="A1.E30.m1.1.1.3.4">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E30.m1.1c">\displaystyle\min_{\mathbfcal{G},\mathbf{D}}</annotation><annotation encoding="application/x-llamapun" id="A1.E30.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle L(\mathbfcal{G},\mathbf{D})+\gamma\hat{S}(\mathbf{D})" class="ltx_math_unparsed" display="inline" id="A1.E30.m2.1"><semantics id="A1.E30.m2.1a"><mrow id="A1.E30.m2.1b"><mi id="A1.E30.m2.1.1">L</mi><mrow id="A1.E30.m2.1.2"><mo id="A1.E30.m2.1.2.1" stretchy="false">(</mo><mi id="A1.E30.m2.1.2.2" mathvariant="normal">𝒢</mi><mi id="A1.E30.m2.1.2.3" mathvariant="normal">⇔</mi><mi id="A1.E30.m2.1.2.4" mathvariant="normal">𝒟</mi><mi id="A1.E30.m2.1.2.5" mathvariant="normal">⇒</mi><mi id="A1.E30.m2.1.2.6" mathvariant="normal">⇓</mi><mi id="A1.E30.m2.1.2.7">γ</mi><mover accent="true" id="A1.E30.m2.1.2.8"><mi id="A1.E30.m2.1.2.8.2" mathvariant="normal">𝒮</mi><mo id="A1.E30.m2.1.2.8.1">^</mo></mover><mi id="A1.E30.m2.1.2.9" mathvariant="normal">⇐</mi><mi id="A1.E30.m2.1.2.10" mathvariant="normal">𝒟</mi><mi id="A1.E30.m2.1.2.11" mathvariant="normal">⇒</mi></mrow></mrow><annotation encoding="application/x-tex" id="A1.E30.m2.1c">\displaystyle L(\mathbfcal{G},\mathbf{D})+\gamma\hat{S}(\mathbf{D})</annotation><annotation encoding="application/x-llamapun" id="A1.E30.m2.1d">italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇓ italic_γ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="A1.Ex6.2.1.1.1.1">s.t.</span></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle\|\mathbfcal{G}\|^{2}\leq C." class="ltx_Math" display="inline" id="A1.Ex6.m2.1"><semantics id="A1.Ex6.m2.1a"><mrow id="A1.Ex6.m2.1.2" xref="A1.Ex6.m2.1.2.cmml"><msup id="A1.Ex6.m2.1.2.2" xref="A1.Ex6.m2.1.2.2.cmml"><mrow id="A1.Ex6.m2.1.2.2.2.2" xref="A1.Ex6.m2.1.2.2.2.1.cmml"><mo id="A1.Ex6.m2.1.2.2.2.2.1" stretchy="false" xref="A1.Ex6.m2.1.2.2.2.1.1.cmml">‖</mo><mi id="A1.Ex6.m2.1.1" mathvariant="normal" xref="A1.Ex6.m2.1.1.cmml">𝒢</mi><mo id="A1.Ex6.m2.1.2.2.2.2.2" stretchy="false" xref="A1.Ex6.m2.1.2.2.2.1.1.cmml">‖</mo></mrow><mi id="A1.Ex6.m2.1.2.2.3" mathvariant="normal" xref="A1.Ex6.m2.1.2.2.3.cmml">∈</mi></msup><mo id="A1.Ex6.m2.1.2.1" xref="A1.Ex6.m2.1.2.1.cmml">≤</mo><mrow id="A1.Ex6.m2.1.2.3" xref="A1.Ex6.m2.1.2.3.cmml"><mi id="A1.Ex6.m2.1.2.3.2" mathvariant="normal" xref="A1.Ex6.m2.1.2.3.2.cmml">𝒞</mi><mo id="A1.Ex6.m2.1.2.3.1" xref="A1.Ex6.m2.1.2.3.1.cmml">⁢</mo><mi id="A1.Ex6.m2.1.2.3.3" mathvariant="normal" xref="A1.Ex6.m2.1.2.3.3.cmml">↙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m2.1b"><apply id="A1.Ex6.m2.1.2.cmml" xref="A1.Ex6.m2.1.2"><leq id="A1.Ex6.m2.1.2.1.cmml" xref="A1.Ex6.m2.1.2.1"></leq><apply id="A1.Ex6.m2.1.2.2.cmml" xref="A1.Ex6.m2.1.2.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.1.2.2.1.cmml" xref="A1.Ex6.m2.1.2.2">superscript</csymbol><apply id="A1.Ex6.m2.1.2.2.2.1.cmml" xref="A1.Ex6.m2.1.2.2.2.2"><csymbol cd="latexml" id="A1.Ex6.m2.1.2.2.2.1.1.cmml" xref="A1.Ex6.m2.1.2.2.2.2.1">norm</csymbol><ci id="A1.Ex6.m2.1.1.cmml" xref="A1.Ex6.m2.1.1">𝒢</ci></apply><ci id="A1.Ex6.m2.1.2.2.3.cmml" xref="A1.Ex6.m2.1.2.2.3">∈</ci></apply><apply id="A1.Ex6.m2.1.2.3.cmml" xref="A1.Ex6.m2.1.2.3"><times id="A1.Ex6.m2.1.2.3.1.cmml" xref="A1.Ex6.m2.1.2.3.1"></times><ci id="A1.Ex6.m2.1.2.3.2.cmml" xref="A1.Ex6.m2.1.2.3.2">𝒞</ci><ci id="A1.Ex6.m2.1.2.3.3.cmml" xref="A1.Ex6.m2.1.2.3.3">↙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m2.1c">\displaystyle\|\mathbfcal{G}\|^{2}\leq C.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m2.1d">∥ roman_𝒢 ∥ start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT ≤ roman_𝒞 ↙</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.1.p1.11">It implies that the solution to the training problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E9" title="In Early Stage. ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>) is a Pareto point of the multi-objective optimization problem <math alttext="\min_{\mathbfcal{G},\mathbf{D}}(L(\mathbfcal{G},\mathbf{D}),\hat{S}(\mathbf{D}))" class="ltx_math_unparsed" display="inline" id="A1.SS1.1.p1.11.m1.1"><semantics id="A1.SS1.1.p1.11.m1.1a"><mrow id="A1.SS1.1.p1.11.m1.1b"><msub id="A1.SS1.1.p1.11.m1.1.1"><mi id="A1.SS1.1.p1.11.m1.1.1.2">min</mi><mrow id="A1.SS1.1.p1.11.m1.1.1.3"><mi id="A1.SS1.1.p1.11.m1.1.1.3.2" mathvariant="normal">𝒢</mi><mo id="A1.SS1.1.p1.11.m1.1.1.3.1">⁢</mo><mi id="A1.SS1.1.p1.11.m1.1.1.3.3" mathvariant="normal">⇔</mi><mo id="A1.SS1.1.p1.11.m1.1.1.3.1a">⁢</mo><mi id="A1.SS1.1.p1.11.m1.1.1.3.4" mathvariant="normal">𝒟</mi></mrow></msub><mrow id="A1.SS1.1.p1.11.m1.1.2"><mo id="A1.SS1.1.p1.11.m1.1.2.1" stretchy="false">(</mo><mi id="A1.SS1.1.p1.11.m1.1.2.2">L</mi><mrow id="A1.SS1.1.p1.11.m1.1.2.3"><mo id="A1.SS1.1.p1.11.m1.1.2.3.1" stretchy="false">(</mo><mi id="A1.SS1.1.p1.11.m1.1.2.3.2" mathvariant="normal">𝒢</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.3" mathvariant="normal">⇔</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.4" mathvariant="normal">𝒟</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.5" mathvariant="normal">⇒</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.6" mathvariant="normal">⇔</mi><mover accent="true" id="A1.SS1.1.p1.11.m1.1.2.3.7"><mi id="A1.SS1.1.p1.11.m1.1.2.3.7.2" mathvariant="normal">𝒮</mi><mo id="A1.SS1.1.p1.11.m1.1.2.3.7.1">^</mo></mover><mi id="A1.SS1.1.p1.11.m1.1.2.3.8" mathvariant="normal">⇐</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.9" mathvariant="normal">𝒟</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.10" mathvariant="normal">⇒</mi><mi id="A1.SS1.1.p1.11.m1.1.2.3.11" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS1.1.p1.11.m1.1c">\min_{\mathbfcal{G},\mathbf{D}}(L(\mathbfcal{G},\mathbf{D}),\hat{S}(\mathbf{D}))</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.11.m1.1d">roman_min start_POSTSUBSCRIPT roman_𝒢 ⇔ roman_𝒟 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 ⇔ roman_𝒟 ⇒ ⇔ over^ start_ARG roman_𝒮 end_ARG ⇐ roman_𝒟 ⇒ ⇒</annotation></semantics></math>.
∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Algorithm for Late Stage Optimization in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS2" title="3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3.2</span></a>
</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">The algorithm for the late stage optimization in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.SS2" title="3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">3.2</span></a> is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg1" title="Algorithm 1 ‣ A.2 Algorithm for Late Stage Optimization in Section 3.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.7.1.1">Algorithm 1</span> </span> Solve relaxed scalarization problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E12" title="In Late Stage (Optional). ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">12</span></a>)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg1.5"><span class="ltx_text ltx_font_bold" id="alg1.5.1">Input:</span> Initializations <math alttext="\mathbfcal{G}_{0},\mathbf{D}_{0}" class="ltx_Math" display="inline" id="alg1.1.m1.1"><semantics id="alg1.1.m1.1a"><mrow id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml"><msub id="alg1.1.m1.1.1.2" xref="alg1.1.m1.1.1.2.cmml"><mi id="alg1.1.m1.1.1.2.2" mathvariant="normal" xref="alg1.1.m1.1.1.2.2.cmml">𝒢</mi><mi id="alg1.1.m1.1.1.2.3" mathvariant="normal" xref="alg1.1.m1.1.1.2.3.cmml">′</mi></msub><mo id="alg1.1.m1.1.1.1" xref="alg1.1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.1.m1.1.1.3" mathvariant="normal" xref="alg1.1.m1.1.1.3.cmml">⇔</mi><mo id="alg1.1.m1.1.1.1a" xref="alg1.1.m1.1.1.1.cmml">⁢</mo><msub id="alg1.1.m1.1.1.4" xref="alg1.1.m1.1.1.4.cmml"><mi id="alg1.1.m1.1.1.4.2" mathvariant="normal" xref="alg1.1.m1.1.1.4.2.cmml">𝒟</mi><mi id="alg1.1.m1.1.1.4.3" mathvariant="normal" xref="alg1.1.m1.1.1.4.3.cmml">′</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><apply id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1"><times id="alg1.1.m1.1.1.1.cmml" xref="alg1.1.m1.1.1.1"></times><apply id="alg1.1.m1.1.1.2.cmml" xref="alg1.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.1.m1.1.1.2.1.cmml" xref="alg1.1.m1.1.1.2">subscript</csymbol><ci id="alg1.1.m1.1.1.2.2.cmml" xref="alg1.1.m1.1.1.2.2">𝒢</ci><ci id="alg1.1.m1.1.1.2.3.cmml" xref="alg1.1.m1.1.1.2.3">′</ci></apply><ci id="alg1.1.m1.1.1.3.cmml" xref="alg1.1.m1.1.1.3">⇔</ci><apply id="alg1.1.m1.1.1.4.cmml" xref="alg1.1.m1.1.1.4"><csymbol cd="ambiguous" id="alg1.1.m1.1.1.4.1.cmml" xref="alg1.1.m1.1.1.4">subscript</csymbol><ci id="alg1.1.m1.1.1.4.2.cmml" xref="alg1.1.m1.1.1.4.2">𝒟</ci><ci id="alg1.1.m1.1.1.4.3.cmml" xref="alg1.1.m1.1.1.4.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">\mathbfcal{G}_{0},\mathbf{D}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.m1.1d">roman_𝒢 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇔ roman_𝒟 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT</annotation></semantics></math>, constants <math alttext="L_{0},S_{0},w_{1},w_{2},\rho,\beta" class="ltx_Math" display="inline" id="alg1.2.m2.6"><semantics id="alg1.2.m2.6a"><mrow id="alg1.2.m2.6.6.4" xref="alg1.2.m2.6.6.5.cmml"><msub id="alg1.2.m2.3.3.1.1" xref="alg1.2.m2.3.3.1.1.cmml"><mi id="alg1.2.m2.3.3.1.1.2" xref="alg1.2.m2.3.3.1.1.2.cmml">L</mi><mn id="alg1.2.m2.3.3.1.1.3" xref="alg1.2.m2.3.3.1.1.3.cmml">0</mn></msub><mo id="alg1.2.m2.6.6.4.5" xref="alg1.2.m2.6.6.5.cmml">,</mo><msub id="alg1.2.m2.4.4.2.2" xref="alg1.2.m2.4.4.2.2.cmml"><mi id="alg1.2.m2.4.4.2.2.2" xref="alg1.2.m2.4.4.2.2.2.cmml">S</mi><mn id="alg1.2.m2.4.4.2.2.3" xref="alg1.2.m2.4.4.2.2.3.cmml">0</mn></msub><mo id="alg1.2.m2.6.6.4.6" xref="alg1.2.m2.6.6.5.cmml">,</mo><msub id="alg1.2.m2.5.5.3.3" xref="alg1.2.m2.5.5.3.3.cmml"><mi id="alg1.2.m2.5.5.3.3.2" xref="alg1.2.m2.5.5.3.3.2.cmml">w</mi><mn id="alg1.2.m2.5.5.3.3.3" xref="alg1.2.m2.5.5.3.3.3.cmml">1</mn></msub><mo id="alg1.2.m2.6.6.4.7" xref="alg1.2.m2.6.6.5.cmml">,</mo><msub id="alg1.2.m2.6.6.4.4" xref="alg1.2.m2.6.6.4.4.cmml"><mi id="alg1.2.m2.6.6.4.4.2" xref="alg1.2.m2.6.6.4.4.2.cmml">w</mi><mn id="alg1.2.m2.6.6.4.4.3" xref="alg1.2.m2.6.6.4.4.3.cmml">2</mn></msub><mo id="alg1.2.m2.6.6.4.8" xref="alg1.2.m2.6.6.5.cmml">,</mo><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">ρ</mi><mo id="alg1.2.m2.6.6.4.9" xref="alg1.2.m2.6.6.5.cmml">,</mo><mi id="alg1.2.m2.2.2" xref="alg1.2.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m2.6b"><list id="alg1.2.m2.6.6.5.cmml" xref="alg1.2.m2.6.6.4"><apply id="alg1.2.m2.3.3.1.1.cmml" xref="alg1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.3.3.1.1.1.cmml" xref="alg1.2.m2.3.3.1.1">subscript</csymbol><ci id="alg1.2.m2.3.3.1.1.2.cmml" xref="alg1.2.m2.3.3.1.1.2">𝐿</ci><cn id="alg1.2.m2.3.3.1.1.3.cmml" type="integer" xref="alg1.2.m2.3.3.1.1.3">0</cn></apply><apply id="alg1.2.m2.4.4.2.2.cmml" xref="alg1.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.2.m2.4.4.2.2.1.cmml" xref="alg1.2.m2.4.4.2.2">subscript</csymbol><ci id="alg1.2.m2.4.4.2.2.2.cmml" xref="alg1.2.m2.4.4.2.2.2">𝑆</ci><cn id="alg1.2.m2.4.4.2.2.3.cmml" type="integer" xref="alg1.2.m2.4.4.2.2.3">0</cn></apply><apply id="alg1.2.m2.5.5.3.3.cmml" xref="alg1.2.m2.5.5.3.3"><csymbol cd="ambiguous" id="alg1.2.m2.5.5.3.3.1.cmml" xref="alg1.2.m2.5.5.3.3">subscript</csymbol><ci id="alg1.2.m2.5.5.3.3.2.cmml" xref="alg1.2.m2.5.5.3.3.2">𝑤</ci><cn id="alg1.2.m2.5.5.3.3.3.cmml" type="integer" xref="alg1.2.m2.5.5.3.3.3">1</cn></apply><apply id="alg1.2.m2.6.6.4.4.cmml" xref="alg1.2.m2.6.6.4.4"><csymbol cd="ambiguous" id="alg1.2.m2.6.6.4.4.1.cmml" xref="alg1.2.m2.6.6.4.4">subscript</csymbol><ci id="alg1.2.m2.6.6.4.4.2.cmml" xref="alg1.2.m2.6.6.4.4.2">𝑤</ci><cn id="alg1.2.m2.6.6.4.4.3.cmml" type="integer" xref="alg1.2.m2.6.6.4.4.3">2</cn></apply><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝜌</ci><ci id="alg1.2.m2.2.2.cmml" xref="alg1.2.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.6c">L_{0},S_{0},w_{1},w_{2},\rho,\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m2.6d">italic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_ρ , italic_β</annotation></semantics></math>, and an optimization algorithm <math alttext="\mathcal{O}" class="ltx_Math" display="inline" id="alg1.3.m3.1"><semantics id="alg1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">\mathcal{O}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m3.1d">caligraphic_O</annotation></semantics></math>.
<br class="ltx_break"/>      <span class="ltx_text ltx_font_bold" id="alg1.5.2">Output:</span> Tensor cores <math alttext="\mathbfcal{G}_{T}" class="ltx_Math" display="inline" id="alg1.4.m4.1"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" mathvariant="normal" xref="alg1.4.m4.1.1.2.cmml">𝒢</mi><mi id="alg1.4.m4.1.1.3" mathvariant="normal" xref="alg1.4.m4.1.1.3.cmml">𝒯</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝒢</ci><ci id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\mathbfcal{G}_{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m4.1d">roman_𝒢 start_POSTSUBSCRIPT roman_𝒯 end_POSTSUBSCRIPT</annotation></semantics></math> and rank-control parameters <math alttext="\mathbf{D}_{T}" class="ltx_Math" display="inline" id="alg1.5.m5.1"><semantics id="alg1.5.m5.1a"><msub id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml"><mi id="alg1.5.m5.1.1.2" xref="alg1.5.m5.1.1.2.cmml">𝐃</mi><mi id="alg1.5.m5.1.1.3" xref="alg1.5.m5.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.1.1.cmml" xref="alg1.5.m5.1.1">subscript</csymbol><ci id="alg1.5.m5.1.1.2.cmml" xref="alg1.5.m5.1.1.2">𝐃</ci><ci id="alg1.5.m5.1.1.3.cmml" xref="alg1.5.m5.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\mathbf{D}_{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.m5.1d">bold_D start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg1.8">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_text ltx_font_bold" id="alg1.l1.1">for</span> <math alttext="t=0,\ldots,T-1" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mi id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml">t</mi><mo id="alg1.l1.m1.3.3.2" xref="alg1.l1.m1.3.3.2.cmml">=</mo><mrow id="alg1.l1.m1.3.3.1.1" xref="alg1.l1.m1.3.3.1.2.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">0</mn><mo id="alg1.l1.m1.3.3.1.1.2" xref="alg1.l1.m1.3.3.1.2.cmml">,</mo><mi id="alg1.l1.m1.2.2" mathvariant="normal" xref="alg1.l1.m1.2.2.cmml">…</mi><mo id="alg1.l1.m1.3.3.1.1.3" xref="alg1.l1.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l1.m1.3.3.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.cmml"><mi id="alg1.l1.m1.3.3.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.2.cmml">T</mi><mo id="alg1.l1.m1.3.3.1.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg1.l1.m1.3.3.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.2.cmml" xref="alg1.l1.m1.3.3.2"></eq><ci id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3">𝑡</ci><list id="alg1.l1.m1.3.3.1.2.cmml" xref="alg1.l1.m1.3.3.1.1"><cn id="alg1.l1.m1.1.1.cmml" type="integer" xref="alg1.l1.m1.1.1">0</cn><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">…</ci><apply id="alg1.l1.m1.3.3.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1"><minus id="alg1.l1.m1.3.3.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1"></minus><ci id="alg1.l1.m1.3.3.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.2">𝑇</ci><cn id="alg1.l1.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg1.l1.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">t=0,\ldots,T-1</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_t = 0 , … , italic_T - 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l1.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">     <span class="ltx_text ltx_font_bold" id="alg1.l2.1">if</span> <math alttext="w_{1}(L(\mathbfcal{G}_{t},\mathbf{D}_{t})-L_{0})\geq w_{2}({S}(\mathbf{D}_{t})%
-S_{0})" class="ltx_math_unparsed" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1b"><msub id="alg1.l2.m1.1.1"><mi id="alg1.l2.m1.1.1.2">w</mi><mn id="alg1.l2.m1.1.1.3">1</mn></msub><mrow id="alg1.l2.m1.1.2"><mo id="alg1.l2.m1.1.2.1" stretchy="false">(</mo><mi id="alg1.l2.m1.1.2.2">L</mi><mrow id="alg1.l2.m1.1.2.3"><mo id="alg1.l2.m1.1.2.3.1" stretchy="false">(</mo><msub id="alg1.l2.m1.1.2.3.2"><mi id="alg1.l2.m1.1.2.3.2.2" mathvariant="normal">𝒢</mi><mi id="alg1.l2.m1.1.2.3.2.3" mathvariant="normal">⊔</mi></msub><mi id="alg1.l2.m1.1.2.3.3" mathvariant="normal">⇔</mi><msub id="alg1.l2.m1.1.2.3.4"><mi id="alg1.l2.m1.1.2.3.4.2" mathvariant="normal">𝒟</mi><mi id="alg1.l2.m1.1.2.3.4.3" mathvariant="normal">⊔</mi></msub><mi id="alg1.l2.m1.1.2.3.5" mathvariant="normal">⇒</mi><mi id="alg1.l2.m1.1.2.3.6" mathvariant="normal">↖</mi><msub id="alg1.l2.m1.1.2.3.7"><mi id="alg1.l2.m1.1.2.3.7.2" mathvariant="normal">ℒ</mi><mi id="alg1.l2.m1.1.2.3.7.3" mathvariant="normal">′</mi></msub><mi id="alg1.l2.m1.1.2.3.8" mathvariant="normal">⇒</mi><mo id="alg1.l2.m1.1.2.3.9">≥</mo><msub id="alg1.l2.m1.1.2.3.10"><mi id="alg1.l2.m1.1.2.3.10.2" mathvariant="normal">⊒</mi><mi id="alg1.l2.m1.1.2.3.10.3" mathvariant="normal">∈</mi></msub><mi id="alg1.l2.m1.1.2.3.11" mathvariant="normal">⇐</mi><mi id="alg1.l2.m1.1.2.3.12" mathvariant="normal">𝒮</mi><mi id="alg1.l2.m1.1.2.3.13" mathvariant="normal">⇐</mi><msub id="alg1.l2.m1.1.2.3.14"><mi id="alg1.l2.m1.1.2.3.14.2" mathvariant="normal">𝒟</mi><mi id="alg1.l2.m1.1.2.3.14.3" mathvariant="normal">⊔</mi></msub><mi id="alg1.l2.m1.1.2.3.15" mathvariant="normal">⇒</mi><mi id="alg1.l2.m1.1.2.3.16" mathvariant="normal">↖</mi><msub id="alg1.l2.m1.1.2.3.17"><mi id="alg1.l2.m1.1.2.3.17.2" mathvariant="normal">𝒮</mi><mi id="alg1.l2.m1.1.2.3.17.3" mathvariant="normal">′</mi></msub><mi id="alg1.l2.m1.1.2.3.18" mathvariant="normal">⇒</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w_{1}(L(\mathbfcal{G}_{t},\mathbf{D}_{t})-L_{0})\geq w_{2}({S}(\mathbf{D}_{t})%
-S_{0})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_L ( roman_𝒢 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ⇔ roman_𝒟 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ⇒ ↖ roman_ℒ start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒ ≥ ⊒ start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT ⇐ roman_𝒮 ⇐ roman_𝒟 start_POSTSUBSCRIPT ⊔ end_POSTSUBSCRIPT ⇒ ↖ roman_𝒮 start_POSTSUBSCRIPT ′ end_POSTSUBSCRIPT ⇒</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l3">         The optimization algorithm <math alttext="\mathcal{O}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{O}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_O</annotation></semantics></math> runs one step on the problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E13" title="In Late Stage (Optional). ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">13</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l4">     <span class="ltx_text ltx_font_bold" id="alg1.l4.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l5">         The optimization algorithm <math alttext="\mathcal{O}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{O}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">caligraphic_O</annotation></semantics></math> runs one step on the problem (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S3.E14" title="In Late Stage (Optional). ‣ 3.2 Training Methods ‣ 3 The CoMERA Training Framework ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">14</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l6">     <span class="ltx_text ltx_font_bold" id="alg1.l6.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l6.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
</div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Proof of Proposition <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.Thmtheorem1" title="Proposition 4.1. ‣ Analysis. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.1</span></a>
</h3>
<div class="ltx_proof" id="A1.SS3.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.SS3.1.p1">
<p class="ltx_p" id="A1.SS3.1.p1.8">For convenience, let <math alttext="V_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.1.m1.1"><semantics id="A1.SS3.1.p1.1.m1.1a"><msub id="A1.SS3.1.p1.1.m1.1.1" xref="A1.SS3.1.p1.1.m1.1.1.cmml"><mi id="A1.SS3.1.p1.1.m1.1.1.2" xref="A1.SS3.1.p1.1.m1.1.1.2.cmml">V</mi><mi id="A1.SS3.1.p1.1.m1.1.1.3" xref="A1.SS3.1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.1.m1.1b"><apply id="A1.SS3.1.p1.1.m1.1.1.cmml" xref="A1.SS3.1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.1.m1.1.1.1.cmml" xref="A1.SS3.1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.1.m1.1.1.2.cmml" xref="A1.SS3.1.p1.1.m1.1.1.2">𝑉</ci><ci id="A1.SS3.1.p1.1.m1.1.1.3.cmml" xref="A1.SS3.1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.1.m1.1c">V_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.1.m1.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> be a string of characters to specify the dimension of <math alttext="\mathbfcal{V}_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.2.m2.1"><semantics id="A1.SS3.1.p1.2.m2.1a"><msub id="A1.SS3.1.p1.2.m2.1.1" xref="A1.SS3.1.p1.2.m2.1.1.cmml"><mi id="A1.SS3.1.p1.2.m2.1.1.2" mathvariant="normal" xref="A1.SS3.1.p1.2.m2.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.1.p1.2.m2.1.1.3" mathvariant="normal" xref="A1.SS3.1.p1.2.m2.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.2.m2.1b"><apply id="A1.SS3.1.p1.2.m2.1.1.cmml" xref="A1.SS3.1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.2.m2.1.1.1.cmml" xref="A1.SS3.1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.2.m2.1.1.2.cmml" xref="A1.SS3.1.p1.2.m2.1.1.2">𝒱</ci><ci id="A1.SS3.1.p1.2.m2.1.1.3.cmml" xref="A1.SS3.1.p1.2.m2.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.2.m2.1c">\mathbfcal{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.2.m2.1d">roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="C_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.3.m3.1"><semantics id="A1.SS3.1.p1.3.m3.1a"><msub id="A1.SS3.1.p1.3.m3.1.1" xref="A1.SS3.1.p1.3.m3.1.1.cmml"><mi id="A1.SS3.1.p1.3.m3.1.1.2" xref="A1.SS3.1.p1.3.m3.1.1.2.cmml">C</mi><mi id="A1.SS3.1.p1.3.m3.1.1.3" xref="A1.SS3.1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.3.m3.1b"><apply id="A1.SS3.1.p1.3.m3.1.1.cmml" xref="A1.SS3.1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.3.m3.1.1.1.cmml" xref="A1.SS3.1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.3.m3.1.1.2.cmml" xref="A1.SS3.1.p1.3.m3.1.1.2">𝐶</ci><ci id="A1.SS3.1.p1.3.m3.1.1.3.cmml" xref="A1.SS3.1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.3.m3.1c">C_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.3.m3.1d">italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> be the set of tensor cores used to obtain <math alttext="\mathbfcal{V}_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.4.m4.1"><semantics id="A1.SS3.1.p1.4.m4.1a"><msub id="A1.SS3.1.p1.4.m4.1.1" xref="A1.SS3.1.p1.4.m4.1.1.cmml"><mi id="A1.SS3.1.p1.4.m4.1.1.2" mathvariant="normal" xref="A1.SS3.1.p1.4.m4.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.1.p1.4.m4.1.1.3" mathvariant="normal" xref="A1.SS3.1.p1.4.m4.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.4.m4.1b"><apply id="A1.SS3.1.p1.4.m4.1.1.cmml" xref="A1.SS3.1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.4.m4.1.1.1.cmml" xref="A1.SS3.1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.4.m4.1.1.2.cmml" xref="A1.SS3.1.p1.4.m4.1.1.2">𝒱</ci><ci id="A1.SS3.1.p1.4.m4.1.1.3.cmml" xref="A1.SS3.1.p1.4.m4.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.4.m4.1c">\mathbfcal{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.4.m4.1d">roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbfcal{X}_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.5.m5.1"><semantics id="A1.SS3.1.p1.5.m5.1a"><msub id="A1.SS3.1.p1.5.m5.1.1" xref="A1.SS3.1.p1.5.m5.1.1.cmml"><mi id="A1.SS3.1.p1.5.m5.1.1.2" mathvariant="normal" xref="A1.SS3.1.p1.5.m5.1.1.2.cmml">𝒳</mi><mi id="A1.SS3.1.p1.5.m5.1.1.3" mathvariant="normal" xref="A1.SS3.1.p1.5.m5.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.5.m5.1b"><apply id="A1.SS3.1.p1.5.m5.1.1.cmml" xref="A1.SS3.1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.5.m5.1.1.1.cmml" xref="A1.SS3.1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.5.m5.1.1.2.cmml" xref="A1.SS3.1.p1.5.m5.1.1.2">𝒳</ci><ci id="A1.SS3.1.p1.5.m5.1.1.3.cmml" xref="A1.SS3.1.p1.5.m5.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.5.m5.1c">\mathbfcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.5.m5.1d">roman_𝒳 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> be the tensor by contracting <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.6.m6.1"><semantics id="A1.SS3.1.p1.6.m6.1a"><mi id="A1.SS3.1.p1.6.m6.1.1" mathvariant="normal" xref="A1.SS3.1.p1.6.m6.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.6.m6.1b"><ci id="A1.SS3.1.p1.6.m6.1.1.cmml" xref="A1.SS3.1.p1.6.m6.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.6.m6.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.6.m6.1d">roman_𝒳</annotation></semantics></math> with <math alttext="\mathbfcal{V}_{1},\ldots.\mathbfcal{V}_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.7.m7.1"><semantics id="A1.SS3.1.p1.7.m7.1a"><mrow id="A1.SS3.1.p1.7.m7.1.1" xref="A1.SS3.1.p1.7.m7.1.1.cmml"><msub id="A1.SS3.1.p1.7.m7.1.1.2" xref="A1.SS3.1.p1.7.m7.1.1.2.cmml"><mi id="A1.SS3.1.p1.7.m7.1.1.2.2" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.1.p1.7.m7.1.1.2.3" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.2.3.cmml">∞</mi></msub><mo id="A1.SS3.1.p1.7.m7.1.1.1" xref="A1.SS3.1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="A1.SS3.1.p1.7.m7.1.1.3" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.3.cmml">⇔</mi><mo id="A1.SS3.1.p1.7.m7.1.1.1a" xref="A1.SS3.1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="A1.SS3.1.p1.7.m7.1.1.4" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.4.cmml">…</mi><mo id="A1.SS3.1.p1.7.m7.1.1.1b" xref="A1.SS3.1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="A1.SS3.1.p1.7.m7.1.1.5" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.5.cmml">↙</mi><mo id="A1.SS3.1.p1.7.m7.1.1.1c" xref="A1.SS3.1.p1.7.m7.1.1.1.cmml">⁢</mo><msub id="A1.SS3.1.p1.7.m7.1.1.6" xref="A1.SS3.1.p1.7.m7.1.1.6.cmml"><mi id="A1.SS3.1.p1.7.m7.1.1.6.2" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.6.2.cmml">𝒱</mi><mi id="A1.SS3.1.p1.7.m7.1.1.6.3" mathvariant="normal" xref="A1.SS3.1.p1.7.m7.1.1.6.3.cmml">⟩</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.7.m7.1b"><apply id="A1.SS3.1.p1.7.m7.1.1.cmml" xref="A1.SS3.1.p1.7.m7.1.1"><times id="A1.SS3.1.p1.7.m7.1.1.1.cmml" xref="A1.SS3.1.p1.7.m7.1.1.1"></times><apply id="A1.SS3.1.p1.7.m7.1.1.2.cmml" xref="A1.SS3.1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.1.p1.7.m7.1.1.2.1.cmml" xref="A1.SS3.1.p1.7.m7.1.1.2">subscript</csymbol><ci id="A1.SS3.1.p1.7.m7.1.1.2.2.cmml" xref="A1.SS3.1.p1.7.m7.1.1.2.2">𝒱</ci><ci id="A1.SS3.1.p1.7.m7.1.1.2.3.cmml" xref="A1.SS3.1.p1.7.m7.1.1.2.3">∞</ci></apply><ci id="A1.SS3.1.p1.7.m7.1.1.3.cmml" xref="A1.SS3.1.p1.7.m7.1.1.3">⇔</ci><ci id="A1.SS3.1.p1.7.m7.1.1.4.cmml" xref="A1.SS3.1.p1.7.m7.1.1.4">…</ci><ci id="A1.SS3.1.p1.7.m7.1.1.5.cmml" xref="A1.SS3.1.p1.7.m7.1.1.5">↙</ci><apply id="A1.SS3.1.p1.7.m7.1.1.6.cmml" xref="A1.SS3.1.p1.7.m7.1.1.6"><csymbol cd="ambiguous" id="A1.SS3.1.p1.7.m7.1.1.6.1.cmml" xref="A1.SS3.1.p1.7.m7.1.1.6">subscript</csymbol><ci id="A1.SS3.1.p1.7.m7.1.1.6.2.cmml" xref="A1.SS3.1.p1.7.m7.1.1.6.2">𝒱</ci><ci id="A1.SS3.1.p1.7.m7.1.1.6.3.cmml" xref="A1.SS3.1.p1.7.m7.1.1.6.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.7.m7.1c">\mathbfcal{V}_{1},\ldots.\mathbfcal{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.7.m7.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ↙ roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math>, denoted by the string <math alttext="X_{i}" class="ltx_Math" display="inline" id="A1.SS3.1.p1.8.m8.1"><semantics id="A1.SS3.1.p1.8.m8.1a"><msub id="A1.SS3.1.p1.8.m8.1.1" xref="A1.SS3.1.p1.8.m8.1.1.cmml"><mi id="A1.SS3.1.p1.8.m8.1.1.2" xref="A1.SS3.1.p1.8.m8.1.1.2.cmml">X</mi><mi id="A1.SS3.1.p1.8.m8.1.1.3" xref="A1.SS3.1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.1.p1.8.m8.1b"><apply id="A1.SS3.1.p1.8.m8.1.1.cmml" xref="A1.SS3.1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS3.1.p1.8.m8.1.1.1.cmml" xref="A1.SS3.1.p1.8.m8.1.1">subscript</csymbol><ci id="A1.SS3.1.p1.8.m8.1.1.2.cmml" xref="A1.SS3.1.p1.8.m8.1.1.2">𝑋</ci><ci id="A1.SS3.1.p1.8.m8.1.1.3.cmml" xref="A1.SS3.1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.1.p1.8.m8.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.1.p1.8.m8.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS3.2.p2">
<p class="ltx_p" id="A1.SS3.2.p2.69">We first show that <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.1.m1.1"><semantics id="A1.SS3.2.p2.1.m1.1a"><msub id="A1.SS3.2.p2.1.m1.1.1" xref="A1.SS3.2.p2.1.m1.1.1.cmml"><mi id="A1.SS3.2.p2.1.m1.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.1.m1.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.1.m1.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.1.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.1.m1.1b"><apply id="A1.SS3.2.p2.1.m1.1.1.cmml" xref="A1.SS3.2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.1.m1.1.1.1.cmml" xref="A1.SS3.2.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.1.m1.1.1.2.cmml" xref="A1.SS3.2.p2.1.m1.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.1.m1.1.1.3.cmml" xref="A1.SS3.2.p2.1.m1.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.1.m1.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.1.m1.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> must be in the proposed format. Suppose otherwise for contradiction. Let <math alttext="\mathbfcal{G}_{i}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.2.m2.1"><semantics id="A1.SS3.2.p2.2.m2.1a"><msub id="A1.SS3.2.p2.2.m2.1.1" xref="A1.SS3.2.p2.2.m2.1.1.cmml"><mi id="A1.SS3.2.p2.2.m2.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.2.m2.1.1.2.cmml">𝒢</mi><mi id="A1.SS3.2.p2.2.m2.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.2.m2.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.2.m2.1b"><apply id="A1.SS3.2.p2.2.m2.1.1.cmml" xref="A1.SS3.2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.2.m2.1.1.1.cmml" xref="A1.SS3.2.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.2.m2.1.1.2.cmml" xref="A1.SS3.2.p2.2.m2.1.1.2">𝒢</ci><ci id="A1.SS3.2.p2.2.m2.1.1.3.cmml" xref="A1.SS3.2.p2.2.m2.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.2.m2.1c">\mathbfcal{G}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.2.m2.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> be the first tensor core used to obtain <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.3.m3.1"><semantics id="A1.SS3.2.p2.3.m3.1a"><msub id="A1.SS3.2.p2.3.m3.1.1" xref="A1.SS3.2.p2.3.m3.1.1.cmml"><mi id="A1.SS3.2.p2.3.m3.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.3.m3.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.3.m3.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.3.m3.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.3.m3.1b"><apply id="A1.SS3.2.p2.3.m3.1.1.cmml" xref="A1.SS3.2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.3.m3.1.1.1.cmml" xref="A1.SS3.2.p2.3.m3.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.3.m3.1.1.2.cmml" xref="A1.SS3.2.p2.3.m3.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.3.m3.1.1.3.cmml" xref="A1.SS3.2.p2.3.m3.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.3.m3.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.3.m3.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math>. If <math alttext="i=1" class="ltx_Math" display="inline" id="A1.SS3.2.p2.4.m4.1"><semantics id="A1.SS3.2.p2.4.m4.1a"><mrow id="A1.SS3.2.p2.4.m4.1.1" xref="A1.SS3.2.p2.4.m4.1.1.cmml"><mi id="A1.SS3.2.p2.4.m4.1.1.2" xref="A1.SS3.2.p2.4.m4.1.1.2.cmml">i</mi><mo id="A1.SS3.2.p2.4.m4.1.1.1" xref="A1.SS3.2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS3.2.p2.4.m4.1.1.3" xref="A1.SS3.2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.4.m4.1b"><apply id="A1.SS3.2.p2.4.m4.1.1.cmml" xref="A1.SS3.2.p2.4.m4.1.1"><eq id="A1.SS3.2.p2.4.m4.1.1.1.cmml" xref="A1.SS3.2.p2.4.m4.1.1.1"></eq><ci id="A1.SS3.2.p2.4.m4.1.1.2.cmml" xref="A1.SS3.2.p2.4.m4.1.1.2">𝑖</ci><cn id="A1.SS3.2.p2.4.m4.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.4.m4.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.4.m4.1d">italic_i = 1</annotation></semantics></math>, then we write <math alttext="V_{1}={V}_{1}^{1}{V}_{1}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.5.m5.1"><semantics id="A1.SS3.2.p2.5.m5.1a"><mrow id="A1.SS3.2.p2.5.m5.1.1" xref="A1.SS3.2.p2.5.m5.1.1.cmml"><msub id="A1.SS3.2.p2.5.m5.1.1.2" xref="A1.SS3.2.p2.5.m5.1.1.2.cmml"><mi id="A1.SS3.2.p2.5.m5.1.1.2.2" xref="A1.SS3.2.p2.5.m5.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.5.m5.1.1.2.3" xref="A1.SS3.2.p2.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.5.m5.1.1.1" xref="A1.SS3.2.p2.5.m5.1.1.1.cmml">=</mo><mrow id="A1.SS3.2.p2.5.m5.1.1.3" xref="A1.SS3.2.p2.5.m5.1.1.3.cmml"><msubsup id="A1.SS3.2.p2.5.m5.1.1.3.2" xref="A1.SS3.2.p2.5.m5.1.1.3.2.cmml"><mi id="A1.SS3.2.p2.5.m5.1.1.3.2.2.2" xref="A1.SS3.2.p2.5.m5.1.1.3.2.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.5.m5.1.1.3.2.2.3" xref="A1.SS3.2.p2.5.m5.1.1.3.2.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.5.m5.1.1.3.2.3" xref="A1.SS3.2.p2.5.m5.1.1.3.2.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.5.m5.1.1.3.1" xref="A1.SS3.2.p2.5.m5.1.1.3.1.cmml">⁢</mo><msubsup id="A1.SS3.2.p2.5.m5.1.1.3.3" xref="A1.SS3.2.p2.5.m5.1.1.3.3.cmml"><mi id="A1.SS3.2.p2.5.m5.1.1.3.3.2.2" xref="A1.SS3.2.p2.5.m5.1.1.3.3.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.5.m5.1.1.3.3.2.3" xref="A1.SS3.2.p2.5.m5.1.1.3.3.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.5.m5.1.1.3.3.3" xref="A1.SS3.2.p2.5.m5.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.5.m5.1b"><apply id="A1.SS3.2.p2.5.m5.1.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1"><eq id="A1.SS3.2.p2.5.m5.1.1.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.1"></eq><apply id="A1.SS3.2.p2.5.m5.1.1.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.5.m5.1.1.2.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS3.2.p2.5.m5.1.1.2.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.5.m5.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.5.m5.1.1.2.3">1</cn></apply><apply id="A1.SS3.2.p2.5.m5.1.1.3.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3"><times id="A1.SS3.2.p2.5.m5.1.1.3.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.1"></times><apply id="A1.SS3.2.p2.5.m5.1.1.3.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.5.m5.1.1.3.2.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.2">superscript</csymbol><apply id="A1.SS3.2.p2.5.m5.1.1.3.2.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.5.m5.1.1.3.2.2.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.2">subscript</csymbol><ci id="A1.SS3.2.p2.5.m5.1.1.3.2.2.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.2.2.2">𝑉</ci><cn id="A1.SS3.2.p2.5.m5.1.1.3.2.2.3.cmml" type="integer" xref="A1.SS3.2.p2.5.m5.1.1.3.2.2.3">1</cn></apply><cn id="A1.SS3.2.p2.5.m5.1.1.3.2.3.cmml" type="integer" xref="A1.SS3.2.p2.5.m5.1.1.3.2.3">1</cn></apply><apply id="A1.SS3.2.p2.5.m5.1.1.3.3.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS3.2.p2.5.m5.1.1.3.3.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.3">superscript</csymbol><apply id="A1.SS3.2.p2.5.m5.1.1.3.3.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS3.2.p2.5.m5.1.1.3.3.2.1.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.3">subscript</csymbol><ci id="A1.SS3.2.p2.5.m5.1.1.3.3.2.2.cmml" xref="A1.SS3.2.p2.5.m5.1.1.3.3.2.2">𝑉</ci><cn id="A1.SS3.2.p2.5.m5.1.1.3.3.2.3.cmml" type="integer" xref="A1.SS3.2.p2.5.m5.1.1.3.3.2.3">1</cn></apply><cn id="A1.SS3.2.p2.5.m5.1.1.3.3.3.cmml" type="integer" xref="A1.SS3.2.p2.5.m5.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.5.m5.1c">V_{1}={V}_{1}^{1}{V}_{1}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.5.m5.1d">italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> where the tensor <math alttext="\mathbfcal{V}_{1}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.6.m6.1"><semantics id="A1.SS3.2.p2.6.m6.1a"><msubsup id="A1.SS3.2.p2.6.m6.1.1" xref="A1.SS3.2.p2.6.m6.1.1.cmml"><mi id="A1.SS3.2.p2.6.m6.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.6.m6.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.6.m6.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.6.m6.1.1.2.3.cmml">∞</mi><mi id="A1.SS3.2.p2.6.m6.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.6.m6.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.6.m6.1b"><apply id="A1.SS3.2.p2.6.m6.1.1.cmml" xref="A1.SS3.2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.6.m6.1.1.1.cmml" xref="A1.SS3.2.p2.6.m6.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.6.m6.1.1.2.cmml" xref="A1.SS3.2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.6.m6.1.1.2.1.cmml" xref="A1.SS3.2.p2.6.m6.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.6.m6.1.1.2.2.cmml" xref="A1.SS3.2.p2.6.m6.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.6.m6.1.1.2.3.cmml" xref="A1.SS3.2.p2.6.m6.1.1.2.3">∞</ci></apply><ci id="A1.SS3.2.p2.6.m6.1.1.3.cmml" xref="A1.SS3.2.p2.6.m6.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.6.m6.1c">\mathbfcal{V}_{1}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.6.m6.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> corresponding to <math alttext="V_{1}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.7.m7.1"><semantics id="A1.SS3.2.p2.7.m7.1a"><msubsup id="A1.SS3.2.p2.7.m7.1.1" xref="A1.SS3.2.p2.7.m7.1.1.cmml"><mi id="A1.SS3.2.p2.7.m7.1.1.2.2" xref="A1.SS3.2.p2.7.m7.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.7.m7.1.1.2.3" xref="A1.SS3.2.p2.7.m7.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.7.m7.1.1.3" xref="A1.SS3.2.p2.7.m7.1.1.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.7.m7.1b"><apply id="A1.SS3.2.p2.7.m7.1.1.cmml" xref="A1.SS3.2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.7.m7.1.1.1.cmml" xref="A1.SS3.2.p2.7.m7.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.7.m7.1.1.2.cmml" xref="A1.SS3.2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.7.m7.1.1.2.1.cmml" xref="A1.SS3.2.p2.7.m7.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.7.m7.1.1.2.2.cmml" xref="A1.SS3.2.p2.7.m7.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.7.m7.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.7.m7.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.7.m7.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.7.m7.1c">V_{1}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.7.m7.1d">italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is obtained by contractions of longest consecutive tensor cores containing <math alttext="\mathbfcal{G}_{i}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.8.m8.1"><semantics id="A1.SS3.2.p2.8.m8.1a"><msub id="A1.SS3.2.p2.8.m8.1.1" xref="A1.SS3.2.p2.8.m8.1.1.cmml"><mi id="A1.SS3.2.p2.8.m8.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.8.m8.1.1.2.cmml">𝒢</mi><mi id="A1.SS3.2.p2.8.m8.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.8.m8.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.8.m8.1b"><apply id="A1.SS3.2.p2.8.m8.1.1.cmml" xref="A1.SS3.2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.8.m8.1.1.1.cmml" xref="A1.SS3.2.p2.8.m8.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.8.m8.1.1.2.cmml" xref="A1.SS3.2.p2.8.m8.1.1.2">𝒢</ci><ci id="A1.SS3.2.p2.8.m8.1.1.3.cmml" xref="A1.SS3.2.p2.8.m8.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.8.m8.1c">\mathbfcal{G}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.8.m8.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> in the set <math alttext="C_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.9.m9.1"><semantics id="A1.SS3.2.p2.9.m9.1a"><msub id="A1.SS3.2.p2.9.m9.1.1" xref="A1.SS3.2.p2.9.m9.1.1.cmml"><mi id="A1.SS3.2.p2.9.m9.1.1.2" xref="A1.SS3.2.p2.9.m9.1.1.2.cmml">C</mi><mn id="A1.SS3.2.p2.9.m9.1.1.3" xref="A1.SS3.2.p2.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.9.m9.1b"><apply id="A1.SS3.2.p2.9.m9.1.1.cmml" xref="A1.SS3.2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.9.m9.1.1.1.cmml" xref="A1.SS3.2.p2.9.m9.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.9.m9.1.1.2.cmml" xref="A1.SS3.2.p2.9.m9.1.1.2">𝐶</ci><cn id="A1.SS3.2.p2.9.m9.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.9.m9.1c">C_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.9.m9.1d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="Z_{1}={V}_{i}^{1}\cap\tilde{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.10.m10.1"><semantics id="A1.SS3.2.p2.10.m10.1a"><mrow id="A1.SS3.2.p2.10.m10.1.1" xref="A1.SS3.2.p2.10.m10.1.1.cmml"><msub id="A1.SS3.2.p2.10.m10.1.1.2" xref="A1.SS3.2.p2.10.m10.1.1.2.cmml"><mi id="A1.SS3.2.p2.10.m10.1.1.2.2" xref="A1.SS3.2.p2.10.m10.1.1.2.2.cmml">Z</mi><mn id="A1.SS3.2.p2.10.m10.1.1.2.3" xref="A1.SS3.2.p2.10.m10.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.10.m10.1.1.1" xref="A1.SS3.2.p2.10.m10.1.1.1.cmml">=</mo><mrow id="A1.SS3.2.p2.10.m10.1.1.3" xref="A1.SS3.2.p2.10.m10.1.1.3.cmml"><msubsup id="A1.SS3.2.p2.10.m10.1.1.3.2" xref="A1.SS3.2.p2.10.m10.1.1.3.2.cmml"><mi id="A1.SS3.2.p2.10.m10.1.1.3.2.2.2" xref="A1.SS3.2.p2.10.m10.1.1.3.2.2.2.cmml">V</mi><mi id="A1.SS3.2.p2.10.m10.1.1.3.2.2.3" xref="A1.SS3.2.p2.10.m10.1.1.3.2.2.3.cmml">i</mi><mn id="A1.SS3.2.p2.10.m10.1.1.3.2.3" xref="A1.SS3.2.p2.10.m10.1.1.3.2.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.10.m10.1.1.3.1" xref="A1.SS3.2.p2.10.m10.1.1.3.1.cmml">∩</mo><mover accent="true" id="A1.SS3.2.p2.10.m10.1.1.3.3" xref="A1.SS3.2.p2.10.m10.1.1.3.3.cmml"><mi id="A1.SS3.2.p2.10.m10.1.1.3.3.2" xref="A1.SS3.2.p2.10.m10.1.1.3.3.2.cmml">X</mi><mo id="A1.SS3.2.p2.10.m10.1.1.3.3.1" xref="A1.SS3.2.p2.10.m10.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.10.m10.1b"><apply id="A1.SS3.2.p2.10.m10.1.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1"><eq id="A1.SS3.2.p2.10.m10.1.1.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.1"></eq><apply id="A1.SS3.2.p2.10.m10.1.1.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.10.m10.1.1.2.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.2">subscript</csymbol><ci id="A1.SS3.2.p2.10.m10.1.1.2.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.2.2">𝑍</ci><cn id="A1.SS3.2.p2.10.m10.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.10.m10.1.1.2.3">1</cn></apply><apply id="A1.SS3.2.p2.10.m10.1.1.3.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3"><intersect id="A1.SS3.2.p2.10.m10.1.1.3.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.1"></intersect><apply id="A1.SS3.2.p2.10.m10.1.1.3.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.10.m10.1.1.3.2.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2">superscript</csymbol><apply id="A1.SS3.2.p2.10.m10.1.1.3.2.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.10.m10.1.1.3.2.2.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2">subscript</csymbol><ci id="A1.SS3.2.p2.10.m10.1.1.3.2.2.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2.2.2">𝑉</ci><ci id="A1.SS3.2.p2.10.m10.1.1.3.2.2.3.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.2.2.3">𝑖</ci></apply><cn id="A1.SS3.2.p2.10.m10.1.1.3.2.3.cmml" type="integer" xref="A1.SS3.2.p2.10.m10.1.1.3.2.3">1</cn></apply><apply id="A1.SS3.2.p2.10.m10.1.1.3.3.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.3"><ci id="A1.SS3.2.p2.10.m10.1.1.3.3.1.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.3.1">~</ci><ci id="A1.SS3.2.p2.10.m10.1.1.3.3.2.cmml" xref="A1.SS3.2.p2.10.m10.1.1.3.3.2">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.10.m10.1c">Z_{1}={V}_{i}^{1}\cap\tilde{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.10.m10.1d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∩ over~ start_ARG italic_X end_ARG</annotation></semantics></math>, <math alttext="Z_{2}={V}_{i}^{2}\cap\tilde{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.11.m11.1"><semantics id="A1.SS3.2.p2.11.m11.1a"><mrow id="A1.SS3.2.p2.11.m11.1.1" xref="A1.SS3.2.p2.11.m11.1.1.cmml"><msub id="A1.SS3.2.p2.11.m11.1.1.2" xref="A1.SS3.2.p2.11.m11.1.1.2.cmml"><mi id="A1.SS3.2.p2.11.m11.1.1.2.2" xref="A1.SS3.2.p2.11.m11.1.1.2.2.cmml">Z</mi><mn id="A1.SS3.2.p2.11.m11.1.1.2.3" xref="A1.SS3.2.p2.11.m11.1.1.2.3.cmml">2</mn></msub><mo id="A1.SS3.2.p2.11.m11.1.1.1" xref="A1.SS3.2.p2.11.m11.1.1.1.cmml">=</mo><mrow id="A1.SS3.2.p2.11.m11.1.1.3" xref="A1.SS3.2.p2.11.m11.1.1.3.cmml"><msubsup id="A1.SS3.2.p2.11.m11.1.1.3.2" xref="A1.SS3.2.p2.11.m11.1.1.3.2.cmml"><mi id="A1.SS3.2.p2.11.m11.1.1.3.2.2.2" xref="A1.SS3.2.p2.11.m11.1.1.3.2.2.2.cmml">V</mi><mi id="A1.SS3.2.p2.11.m11.1.1.3.2.2.3" xref="A1.SS3.2.p2.11.m11.1.1.3.2.2.3.cmml">i</mi><mn id="A1.SS3.2.p2.11.m11.1.1.3.2.3" xref="A1.SS3.2.p2.11.m11.1.1.3.2.3.cmml">2</mn></msubsup><mo id="A1.SS3.2.p2.11.m11.1.1.3.1" xref="A1.SS3.2.p2.11.m11.1.1.3.1.cmml">∩</mo><mover accent="true" id="A1.SS3.2.p2.11.m11.1.1.3.3" xref="A1.SS3.2.p2.11.m11.1.1.3.3.cmml"><mi id="A1.SS3.2.p2.11.m11.1.1.3.3.2" xref="A1.SS3.2.p2.11.m11.1.1.3.3.2.cmml">X</mi><mo id="A1.SS3.2.p2.11.m11.1.1.3.3.1" xref="A1.SS3.2.p2.11.m11.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.11.m11.1b"><apply id="A1.SS3.2.p2.11.m11.1.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1"><eq id="A1.SS3.2.p2.11.m11.1.1.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.1"></eq><apply id="A1.SS3.2.p2.11.m11.1.1.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.11.m11.1.1.2.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.2">subscript</csymbol><ci id="A1.SS3.2.p2.11.m11.1.1.2.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.2.2">𝑍</ci><cn id="A1.SS3.2.p2.11.m11.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.11.m11.1.1.2.3">2</cn></apply><apply id="A1.SS3.2.p2.11.m11.1.1.3.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3"><intersect id="A1.SS3.2.p2.11.m11.1.1.3.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.1"></intersect><apply id="A1.SS3.2.p2.11.m11.1.1.3.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.11.m11.1.1.3.2.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2">superscript</csymbol><apply id="A1.SS3.2.p2.11.m11.1.1.3.2.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.11.m11.1.1.3.2.2.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2">subscript</csymbol><ci id="A1.SS3.2.p2.11.m11.1.1.3.2.2.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2.2.2">𝑉</ci><ci id="A1.SS3.2.p2.11.m11.1.1.3.2.2.3.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.2.2.3">𝑖</ci></apply><cn id="A1.SS3.2.p2.11.m11.1.1.3.2.3.cmml" type="integer" xref="A1.SS3.2.p2.11.m11.1.1.3.2.3">2</cn></apply><apply id="A1.SS3.2.p2.11.m11.1.1.3.3.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.3"><ci id="A1.SS3.2.p2.11.m11.1.1.3.3.1.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.3.1">~</ci><ci id="A1.SS3.2.p2.11.m11.1.1.3.3.2.cmml" xref="A1.SS3.2.p2.11.m11.1.1.3.3.2">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.11.m11.1c">Z_{2}={V}_{i}^{2}\cap\tilde{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.11.m11.1d">italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∩ over~ start_ARG italic_X end_ARG</annotation></semantics></math>. The number of flops for the contraction between <math alttext="\mathbfcal{\widetilde{X}}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.12.m12.1"><semantics id="A1.SS3.2.p2.12.m12.1a"><mover accent="true" id="A1.SS3.2.p2.12.m12.1.1" xref="A1.SS3.2.p2.12.m12.1.1.cmml"><mi id="A1.SS3.2.p2.12.m12.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.12.m12.1.1.2.cmml">𝒳</mi><mo id="A1.SS3.2.p2.12.m12.1.1.1" xref="A1.SS3.2.p2.12.m12.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.12.m12.1b"><apply id="A1.SS3.2.p2.12.m12.1.1.cmml" xref="A1.SS3.2.p2.12.m12.1.1"><ci id="A1.SS3.2.p2.12.m12.1.1.1.cmml" xref="A1.SS3.2.p2.12.m12.1.1.1">~</ci><ci id="A1.SS3.2.p2.12.m12.1.1.2.cmml" xref="A1.SS3.2.p2.12.m12.1.1.2">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.12.m12.1c">\mathbfcal{\widetilde{X}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.12.m12.1d">over~ start_ARG roman_𝒳 end_ARG</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.13.m13.1"><semantics id="A1.SS3.2.p2.13.m13.1a"><msub id="A1.SS3.2.p2.13.m13.1.1" xref="A1.SS3.2.p2.13.m13.1.1.cmml"><mi id="A1.SS3.2.p2.13.m13.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.13.m13.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.13.m13.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.13.m13.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.13.m13.1b"><apply id="A1.SS3.2.p2.13.m13.1.1.cmml" xref="A1.SS3.2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.13.m13.1.1.1.cmml" xref="A1.SS3.2.p2.13.m13.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.13.m13.1.1.2.cmml" xref="A1.SS3.2.p2.13.m13.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.13.m13.1.1.3.cmml" xref="A1.SS3.2.p2.13.m13.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.13.m13.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.13.m13.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2})}{\pi(Z_{1})\pi(Z_{2})}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.14.m14.5"><semantics id="A1.SS3.2.p2.14.m14.5a"><mfrac id="A1.SS3.2.p2.14.m14.5.5" xref="A1.SS3.2.p2.14.m14.5.5.cmml"><mrow id="A1.SS3.2.p2.14.m14.3.3.3" xref="A1.SS3.2.p2.14.m14.3.3.3.cmml"><mi id="A1.SS3.2.p2.14.m14.3.3.3.5" xref="A1.SS3.2.p2.14.m14.3.3.3.5.cmml">π</mi><mo id="A1.SS3.2.p2.14.m14.3.3.3.4" xref="A1.SS3.2.p2.14.m14.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.14.m14.3.3.3.6.2" xref="A1.SS3.2.p2.14.m14.3.3.3.cmml"><mo id="A1.SS3.2.p2.14.m14.3.3.3.6.2.1" stretchy="false" xref="A1.SS3.2.p2.14.m14.3.3.3.cmml">(</mo><mi id="A1.SS3.2.p2.14.m14.1.1.1.1" xref="A1.SS3.2.p2.14.m14.1.1.1.1.cmml">X</mi><mo id="A1.SS3.2.p2.14.m14.3.3.3.6.2.2" stretchy="false" xref="A1.SS3.2.p2.14.m14.3.3.3.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.14.m14.3.3.3.4a" xref="A1.SS3.2.p2.14.m14.3.3.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.14.m14.3.3.3.7" xref="A1.SS3.2.p2.14.m14.3.3.3.7.cmml">π</mi><mo id="A1.SS3.2.p2.14.m14.3.3.3.4b" xref="A1.SS3.2.p2.14.m14.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.14.m14.2.2.2.2.1" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.cmml"><mo id="A1.SS3.2.p2.14.m14.2.2.2.2.1.2" stretchy="false" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.cmml"><mi id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.2" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.3" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.3" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.14.m14.2.2.2.2.1.3" stretchy="false" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.14.m14.3.3.3.4c" xref="A1.SS3.2.p2.14.m14.3.3.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.14.m14.3.3.3.8" xref="A1.SS3.2.p2.14.m14.3.3.3.8.cmml">π</mi><mo id="A1.SS3.2.p2.14.m14.3.3.3.4d" xref="A1.SS3.2.p2.14.m14.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.14.m14.3.3.3.3.1" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.cmml"><mo id="A1.SS3.2.p2.14.m14.3.3.3.3.1.2" stretchy="false" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.cmml"><mi id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.2" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.3" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.3" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.3.cmml">2</mn></msubsup><mo id="A1.SS3.2.p2.14.m14.3.3.3.3.1.3" stretchy="false" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS3.2.p2.14.m14.5.5.5" xref="A1.SS3.2.p2.14.m14.5.5.5.cmml"><mi id="A1.SS3.2.p2.14.m14.5.5.5.4" xref="A1.SS3.2.p2.14.m14.5.5.5.4.cmml">π</mi><mo id="A1.SS3.2.p2.14.m14.5.5.5.3" xref="A1.SS3.2.p2.14.m14.5.5.5.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.14.m14.4.4.4.1.1" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.cmml"><mo id="A1.SS3.2.p2.14.m14.4.4.4.1.1.2" stretchy="false" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.cmml"><mi id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.2" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.3" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.14.m14.4.4.4.1.1.3" stretchy="false" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.14.m14.5.5.5.3a" xref="A1.SS3.2.p2.14.m14.5.5.5.3.cmml">⁢</mo><mi id="A1.SS3.2.p2.14.m14.5.5.5.5" xref="A1.SS3.2.p2.14.m14.5.5.5.5.cmml">π</mi><mo id="A1.SS3.2.p2.14.m14.5.5.5.3b" xref="A1.SS3.2.p2.14.m14.5.5.5.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.14.m14.5.5.5.2.1" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.cmml"><mo id="A1.SS3.2.p2.14.m14.5.5.5.2.1.2" stretchy="false" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.cmml"><mi id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.2" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.3" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.3.cmml">2</mn></msub><mo id="A1.SS3.2.p2.14.m14.5.5.5.2.1.3" stretchy="false" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.14.m14.5b"><apply id="A1.SS3.2.p2.14.m14.5.5.cmml" xref="A1.SS3.2.p2.14.m14.5.5"><divide id="A1.SS3.2.p2.14.m14.5.5.6.cmml" xref="A1.SS3.2.p2.14.m14.5.5"></divide><apply id="A1.SS3.2.p2.14.m14.3.3.3.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3"><times id="A1.SS3.2.p2.14.m14.3.3.3.4.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.4"></times><ci id="A1.SS3.2.p2.14.m14.3.3.3.5.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.5">𝜋</ci><ci id="A1.SS3.2.p2.14.m14.1.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.1.1.1.1">𝑋</ci><ci id="A1.SS3.2.p2.14.m14.3.3.3.7.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.7">𝜋</ci><apply id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.cmml" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1">superscript</csymbol><apply id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.cmml" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.2.2.2.2.1.1.3">1</cn></apply><ci id="A1.SS3.2.p2.14.m14.3.3.3.8.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.8">𝜋</ci><apply id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1">superscript</csymbol><apply id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.1.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1">subscript</csymbol><ci id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.2.cmml" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.3.3.3.3.1.1.3">2</cn></apply></apply><apply id="A1.SS3.2.p2.14.m14.5.5.5.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5"><times id="A1.SS3.2.p2.14.m14.5.5.5.3.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.3"></times><ci id="A1.SS3.2.p2.14.m14.5.5.5.4.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.4">𝜋</ci><apply id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.2.cmml" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.4.4.4.1.1.1.3">1</cn></apply><ci id="A1.SS3.2.p2.14.m14.5.5.5.5.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.5">𝜋</ci><apply id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.1.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.2.cmml" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.14.m14.5.5.5.2.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.14.m14.5c">\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2})}{\pi(Z_{1})\pi(Z_{2})}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.14.m14.5d">divide start_ARG italic_π ( italic_X ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_π ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) italic_π ( italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math>. If we first contract <math alttext="\mathbfcal{\widetilde{X}}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.15.m15.1"><semantics id="A1.SS3.2.p2.15.m15.1a"><mover accent="true" id="A1.SS3.2.p2.15.m15.1.1" xref="A1.SS3.2.p2.15.m15.1.1.cmml"><mi id="A1.SS3.2.p2.15.m15.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.15.m15.1.1.2.cmml">𝒳</mi><mo id="A1.SS3.2.p2.15.m15.1.1.1" xref="A1.SS3.2.p2.15.m15.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.15.m15.1b"><apply id="A1.SS3.2.p2.15.m15.1.1.cmml" xref="A1.SS3.2.p2.15.m15.1.1"><ci id="A1.SS3.2.p2.15.m15.1.1.1.cmml" xref="A1.SS3.2.p2.15.m15.1.1.1">~</ci><ci id="A1.SS3.2.p2.15.m15.1.1.2.cmml" xref="A1.SS3.2.p2.15.m15.1.1.2">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.15.m15.1c">\mathbfcal{\widetilde{X}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.15.m15.1d">over~ start_ARG roman_𝒳 end_ARG</annotation></semantics></math> with <math alttext="\mathbfcal{V}_{1}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.16.m16.1"><semantics id="A1.SS3.2.p2.16.m16.1a"><msubsup id="A1.SS3.2.p2.16.m16.1.1" xref="A1.SS3.2.p2.16.m16.1.1.cmml"><mi id="A1.SS3.2.p2.16.m16.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.16.m16.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.16.m16.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.16.m16.1.1.2.3.cmml">∞</mi><mi id="A1.SS3.2.p2.16.m16.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.16.m16.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.16.m16.1b"><apply id="A1.SS3.2.p2.16.m16.1.1.cmml" xref="A1.SS3.2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.16.m16.1.1.1.cmml" xref="A1.SS3.2.p2.16.m16.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.16.m16.1.1.2.cmml" xref="A1.SS3.2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.16.m16.1.1.2.1.cmml" xref="A1.SS3.2.p2.16.m16.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.16.m16.1.1.2.2.cmml" xref="A1.SS3.2.p2.16.m16.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.16.m16.1.1.2.3.cmml" xref="A1.SS3.2.p2.16.m16.1.1.2.3">∞</ci></apply><ci id="A1.SS3.2.p2.16.m16.1.1.3.cmml" xref="A1.SS3.2.p2.16.m16.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.16.m16.1c">\mathbfcal{V}_{1}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.16.m16.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> and then contract the obtained tensor with <math alttext="\mathbfcal{V}_{1}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.17.m17.1"><semantics id="A1.SS3.2.p2.17.m17.1a"><msubsup id="A1.SS3.2.p2.17.m17.1.1" xref="A1.SS3.2.p2.17.m17.1.1.cmml"><mi id="A1.SS3.2.p2.17.m17.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.17.m17.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.17.m17.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.17.m17.1.1.2.3.cmml">∞</mi><mi id="A1.SS3.2.p2.17.m17.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.17.m17.1.1.3.cmml">∈</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.17.m17.1b"><apply id="A1.SS3.2.p2.17.m17.1.1.cmml" xref="A1.SS3.2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.17.m17.1.1.1.cmml" xref="A1.SS3.2.p2.17.m17.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.17.m17.1.1.2.cmml" xref="A1.SS3.2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.17.m17.1.1.2.1.cmml" xref="A1.SS3.2.p2.17.m17.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.17.m17.1.1.2.2.cmml" xref="A1.SS3.2.p2.17.m17.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.17.m17.1.1.2.3.cmml" xref="A1.SS3.2.p2.17.m17.1.1.2.3">∞</ci></apply><ci id="A1.SS3.2.p2.17.m17.1.1.3.cmml" xref="A1.SS3.2.p2.17.m17.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.17.m17.1c">\mathbfcal{V}_{1}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.17.m17.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math>, the number of flops is <math alttext="\frac{\pi(X)\pi(V_{1}^{1})}{\pi(Z_{1})}+\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2%
})}{\pi(Z_{1})^{2}\pi(Z_{2})}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.18.m18.8"><semantics id="A1.SS3.2.p2.18.m18.8a"><mrow id="A1.SS3.2.p2.18.m18.8.9" xref="A1.SS3.2.p2.18.m18.8.9.cmml"><mfrac id="A1.SS3.2.p2.18.m18.3.3" xref="A1.SS3.2.p2.18.m18.3.3.cmml"><mrow id="A1.SS3.2.p2.18.m18.2.2.2" xref="A1.SS3.2.p2.18.m18.2.2.2.cmml"><mi id="A1.SS3.2.p2.18.m18.2.2.2.4" xref="A1.SS3.2.p2.18.m18.2.2.2.4.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.2.2.2.3" xref="A1.SS3.2.p2.18.m18.2.2.2.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.2.2.2.5.2" xref="A1.SS3.2.p2.18.m18.2.2.2.cmml"><mo id="A1.SS3.2.p2.18.m18.2.2.2.5.2.1" stretchy="false" xref="A1.SS3.2.p2.18.m18.2.2.2.cmml">(</mo><mi id="A1.SS3.2.p2.18.m18.1.1.1.1" xref="A1.SS3.2.p2.18.m18.1.1.1.1.cmml">X</mi><mo id="A1.SS3.2.p2.18.m18.2.2.2.5.2.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.2.2.2.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.18.m18.2.2.2.3a" xref="A1.SS3.2.p2.18.m18.2.2.2.3.cmml">⁢</mo><mi id="A1.SS3.2.p2.18.m18.2.2.2.6" xref="A1.SS3.2.p2.18.m18.2.2.2.6.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.2.2.2.3b" xref="A1.SS3.2.p2.18.m18.2.2.2.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.2.2.2.2.1" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.2.2.2.2.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.2" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.3" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.3" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.18.m18.2.2.2.2.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS3.2.p2.18.m18.3.3.3" xref="A1.SS3.2.p2.18.m18.3.3.3.cmml"><mi id="A1.SS3.2.p2.18.m18.3.3.3.3" xref="A1.SS3.2.p2.18.m18.3.3.3.3.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.3.3.3.2" xref="A1.SS3.2.p2.18.m18.3.3.3.2.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.3.3.3.1.1" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.3.3.3.1.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.2" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.3" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.18.m18.3.3.3.1.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.SS3.2.p2.18.m18.8.9.1" xref="A1.SS3.2.p2.18.m18.8.9.1.cmml">+</mo><mfrac id="A1.SS3.2.p2.18.m18.8.8" xref="A1.SS3.2.p2.18.m18.8.8.cmml"><mrow id="A1.SS3.2.p2.18.m18.6.6.3" xref="A1.SS3.2.p2.18.m18.6.6.3.cmml"><mi id="A1.SS3.2.p2.18.m18.6.6.3.5" xref="A1.SS3.2.p2.18.m18.6.6.3.5.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.6.6.3.4" xref="A1.SS3.2.p2.18.m18.6.6.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.6.6.3.6.2" xref="A1.SS3.2.p2.18.m18.6.6.3.cmml"><mo id="A1.SS3.2.p2.18.m18.6.6.3.6.2.1" stretchy="false" xref="A1.SS3.2.p2.18.m18.6.6.3.cmml">(</mo><mi id="A1.SS3.2.p2.18.m18.4.4.1.1" xref="A1.SS3.2.p2.18.m18.4.4.1.1.cmml">X</mi><mo id="A1.SS3.2.p2.18.m18.6.6.3.6.2.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.6.6.3.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.18.m18.6.6.3.4a" xref="A1.SS3.2.p2.18.m18.6.6.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.18.m18.6.6.3.7" xref="A1.SS3.2.p2.18.m18.6.6.3.7.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.6.6.3.4b" xref="A1.SS3.2.p2.18.m18.6.6.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.5.5.2.2.1" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.5.5.2.2.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.2" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.3" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.3" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.18.m18.5.5.2.2.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.18.m18.6.6.3.4c" xref="A1.SS3.2.p2.18.m18.6.6.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.18.m18.6.6.3.8" xref="A1.SS3.2.p2.18.m18.6.6.3.8.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.6.6.3.4d" xref="A1.SS3.2.p2.18.m18.6.6.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.6.6.3.3.1" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.6.6.3.3.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.2" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.3" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.3" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.3.cmml">2</mn></msubsup><mo id="A1.SS3.2.p2.18.m18.6.6.3.3.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS3.2.p2.18.m18.8.8.5" xref="A1.SS3.2.p2.18.m18.8.8.5.cmml"><mi id="A1.SS3.2.p2.18.m18.8.8.5.4" xref="A1.SS3.2.p2.18.m18.8.8.5.4.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.8.8.5.3" xref="A1.SS3.2.p2.18.m18.8.8.5.3.cmml">⁢</mo><msup id="A1.SS3.2.p2.18.m18.7.7.4.1" xref="A1.SS3.2.p2.18.m18.7.7.4.1.cmml"><mrow id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.2" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.3" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.cmml">)</mo></mrow><mn id="A1.SS3.2.p2.18.m18.7.7.4.1.3" xref="A1.SS3.2.p2.18.m18.7.7.4.1.3.cmml">2</mn></msup><mo id="A1.SS3.2.p2.18.m18.8.8.5.3a" xref="A1.SS3.2.p2.18.m18.8.8.5.3.cmml">⁢</mo><mi id="A1.SS3.2.p2.18.m18.8.8.5.5" xref="A1.SS3.2.p2.18.m18.8.8.5.5.cmml">π</mi><mo id="A1.SS3.2.p2.18.m18.8.8.5.3b" xref="A1.SS3.2.p2.18.m18.8.8.5.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.18.m18.8.8.5.2.1" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.cmml"><mo id="A1.SS3.2.p2.18.m18.8.8.5.2.1.2" stretchy="false" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.cmml"><mi id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.2" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.3" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.3.cmml">2</mn></msub><mo id="A1.SS3.2.p2.18.m18.8.8.5.2.1.3" stretchy="false" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.18.m18.8b"><apply id="A1.SS3.2.p2.18.m18.8.9.cmml" xref="A1.SS3.2.p2.18.m18.8.9"><plus id="A1.SS3.2.p2.18.m18.8.9.1.cmml" xref="A1.SS3.2.p2.18.m18.8.9.1"></plus><apply id="A1.SS3.2.p2.18.m18.3.3.cmml" xref="A1.SS3.2.p2.18.m18.3.3"><divide id="A1.SS3.2.p2.18.m18.3.3.4.cmml" xref="A1.SS3.2.p2.18.m18.3.3"></divide><apply id="A1.SS3.2.p2.18.m18.2.2.2.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2"><times id="A1.SS3.2.p2.18.m18.2.2.2.3.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.3"></times><ci id="A1.SS3.2.p2.18.m18.2.2.2.4.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.4">𝜋</ci><ci id="A1.SS3.2.p2.18.m18.1.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.1.1.1.1">𝑋</ci><ci id="A1.SS3.2.p2.18.m18.2.2.2.6.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.6">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1">superscript</csymbol><apply id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.2.2.2.2.1.1.3">1</cn></apply></apply><apply id="A1.SS3.2.p2.18.m18.3.3.3.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3"><times id="A1.SS3.2.p2.18.m18.3.3.3.2.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3.2"></times><ci id="A1.SS3.2.p2.18.m18.3.3.3.3.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3.3">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.3.3.3.1.1.1.3">1</cn></apply></apply></apply><apply id="A1.SS3.2.p2.18.m18.8.8.cmml" xref="A1.SS3.2.p2.18.m18.8.8"><divide id="A1.SS3.2.p2.18.m18.8.8.6.cmml" xref="A1.SS3.2.p2.18.m18.8.8"></divide><apply id="A1.SS3.2.p2.18.m18.6.6.3.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3"><times id="A1.SS3.2.p2.18.m18.6.6.3.4.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.4"></times><ci id="A1.SS3.2.p2.18.m18.6.6.3.5.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.5">𝜋</ci><ci id="A1.SS3.2.p2.18.m18.4.4.1.1.cmml" xref="A1.SS3.2.p2.18.m18.4.4.1.1">𝑋</ci><ci id="A1.SS3.2.p2.18.m18.6.6.3.7.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.7">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.cmml" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1">superscript</csymbol><apply id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.1.cmml" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.2.cmml" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.5.5.2.2.1.1.3">1</cn></apply><ci id="A1.SS3.2.p2.18.m18.6.6.3.8.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.8">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1">superscript</csymbol><apply id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.1.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.2.cmml" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.6.6.3.3.1.1.3">2</cn></apply></apply><apply id="A1.SS3.2.p2.18.m18.8.8.5.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5"><times id="A1.SS3.2.p2.18.m18.8.8.5.3.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.3"></times><ci id="A1.SS3.2.p2.18.m18.8.8.5.4.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.4">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.7.7.4.1.cmml" xref="A1.SS3.2.p2.18.m18.7.7.4.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.7.7.4.1.2.cmml" xref="A1.SS3.2.p2.18.m18.7.7.4.1">superscript</csymbol><apply id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.7.7.4.1.1.1.1.3">1</cn></apply><cn id="A1.SS3.2.p2.18.m18.7.7.4.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.7.7.4.1.3">2</cn></apply><ci id="A1.SS3.2.p2.18.m18.8.8.5.5.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.5">𝜋</ci><apply id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.1.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.2.cmml" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.18.m18.8.8.5.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.18.m18.8c">\frac{\pi(X)\pi(V_{1}^{1})}{\pi(Z_{1})}+\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2%
})}{\pi(Z_{1})^{2}\pi(Z_{2})}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.18.m18.8d">divide start_ARG italic_π ( italic_X ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_π ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) end_ARG + divide start_ARG italic_π ( italic_X ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_π ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_π ( italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math> which is less than <math alttext="\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2})}{\pi(Z_{1})\pi(Z_{2})}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.19.m19.5"><semantics id="A1.SS3.2.p2.19.m19.5a"><mfrac id="A1.SS3.2.p2.19.m19.5.5" xref="A1.SS3.2.p2.19.m19.5.5.cmml"><mrow id="A1.SS3.2.p2.19.m19.3.3.3" xref="A1.SS3.2.p2.19.m19.3.3.3.cmml"><mi id="A1.SS3.2.p2.19.m19.3.3.3.5" xref="A1.SS3.2.p2.19.m19.3.3.3.5.cmml">π</mi><mo id="A1.SS3.2.p2.19.m19.3.3.3.4" xref="A1.SS3.2.p2.19.m19.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.19.m19.3.3.3.6.2" xref="A1.SS3.2.p2.19.m19.3.3.3.cmml"><mo id="A1.SS3.2.p2.19.m19.3.3.3.6.2.1" stretchy="false" xref="A1.SS3.2.p2.19.m19.3.3.3.cmml">(</mo><mi id="A1.SS3.2.p2.19.m19.1.1.1.1" xref="A1.SS3.2.p2.19.m19.1.1.1.1.cmml">X</mi><mo id="A1.SS3.2.p2.19.m19.3.3.3.6.2.2" stretchy="false" xref="A1.SS3.2.p2.19.m19.3.3.3.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.19.m19.3.3.3.4a" xref="A1.SS3.2.p2.19.m19.3.3.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.19.m19.3.3.3.7" xref="A1.SS3.2.p2.19.m19.3.3.3.7.cmml">π</mi><mo id="A1.SS3.2.p2.19.m19.3.3.3.4b" xref="A1.SS3.2.p2.19.m19.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.19.m19.2.2.2.2.1" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.cmml"><mo id="A1.SS3.2.p2.19.m19.2.2.2.2.1.2" stretchy="false" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.cmml"><mi id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.2" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.3" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.3" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="A1.SS3.2.p2.19.m19.2.2.2.2.1.3" stretchy="false" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.19.m19.3.3.3.4c" xref="A1.SS3.2.p2.19.m19.3.3.3.4.cmml">⁢</mo><mi id="A1.SS3.2.p2.19.m19.3.3.3.8" xref="A1.SS3.2.p2.19.m19.3.3.3.8.cmml">π</mi><mo id="A1.SS3.2.p2.19.m19.3.3.3.4d" xref="A1.SS3.2.p2.19.m19.3.3.3.4.cmml">⁢</mo><mrow id="A1.SS3.2.p2.19.m19.3.3.3.3.1" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.cmml"><mo id="A1.SS3.2.p2.19.m19.3.3.3.3.1.2" stretchy="false" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.cmml">(</mo><msubsup id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.cmml"><mi id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.2" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.3" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.3" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.3.cmml">2</mn></msubsup><mo id="A1.SS3.2.p2.19.m19.3.3.3.3.1.3" stretchy="false" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS3.2.p2.19.m19.5.5.5" xref="A1.SS3.2.p2.19.m19.5.5.5.cmml"><mi id="A1.SS3.2.p2.19.m19.5.5.5.4" xref="A1.SS3.2.p2.19.m19.5.5.5.4.cmml">π</mi><mo id="A1.SS3.2.p2.19.m19.5.5.5.3" xref="A1.SS3.2.p2.19.m19.5.5.5.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.19.m19.4.4.4.1.1" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.cmml"><mo id="A1.SS3.2.p2.19.m19.4.4.4.1.1.2" stretchy="false" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.cmml"><mi id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.2" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.3" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.2.p2.19.m19.4.4.4.1.1.3" stretchy="false" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="A1.SS3.2.p2.19.m19.5.5.5.3a" xref="A1.SS3.2.p2.19.m19.5.5.5.3.cmml">⁢</mo><mi id="A1.SS3.2.p2.19.m19.5.5.5.5" xref="A1.SS3.2.p2.19.m19.5.5.5.5.cmml">π</mi><mo id="A1.SS3.2.p2.19.m19.5.5.5.3b" xref="A1.SS3.2.p2.19.m19.5.5.5.3.cmml">⁢</mo><mrow id="A1.SS3.2.p2.19.m19.5.5.5.2.1" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.cmml"><mo id="A1.SS3.2.p2.19.m19.5.5.5.2.1.2" stretchy="false" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.cmml">(</mo><msub id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.cmml"><mi id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.2" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.2.cmml">Z</mi><mn id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.3" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.3.cmml">2</mn></msub><mo id="A1.SS3.2.p2.19.m19.5.5.5.2.1.3" stretchy="false" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.19.m19.5b"><apply id="A1.SS3.2.p2.19.m19.5.5.cmml" xref="A1.SS3.2.p2.19.m19.5.5"><divide id="A1.SS3.2.p2.19.m19.5.5.6.cmml" xref="A1.SS3.2.p2.19.m19.5.5"></divide><apply id="A1.SS3.2.p2.19.m19.3.3.3.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3"><times id="A1.SS3.2.p2.19.m19.3.3.3.4.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.4"></times><ci id="A1.SS3.2.p2.19.m19.3.3.3.5.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.5">𝜋</ci><ci id="A1.SS3.2.p2.19.m19.1.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.1.1.1.1">𝑋</ci><ci id="A1.SS3.2.p2.19.m19.3.3.3.7.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.7">𝜋</ci><apply id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.cmml" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1">superscript</csymbol><apply id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.cmml" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.2.2.2.2.1.1.3">1</cn></apply><ci id="A1.SS3.2.p2.19.m19.3.3.3.8.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.8">𝜋</ci><apply id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1">superscript</csymbol><apply id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.1.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1">subscript</csymbol><ci id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.2.cmml" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.2">𝑉</ci><cn id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.2.3">1</cn></apply><cn id="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.3.3.3.3.1.1.3">2</cn></apply></apply><apply id="A1.SS3.2.p2.19.m19.5.5.5.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5"><times id="A1.SS3.2.p2.19.m19.5.5.5.3.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.3"></times><ci id="A1.SS3.2.p2.19.m19.5.5.5.4.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.4">𝜋</ci><apply id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.2.cmml" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.4.4.4.1.1.1.3">1</cn></apply><ci id="A1.SS3.2.p2.19.m19.5.5.5.5.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.5">𝜋</ci><apply id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.1.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1">subscript</csymbol><ci id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.2.cmml" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.2">𝑍</ci><cn id="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.19.m19.5.5.5.2.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.19.m19.5c">\frac{\pi(X)\pi(V_{1}^{1})\pi(V_{1}^{2})}{\pi(Z_{1})\pi(Z_{2})}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.19.m19.5d">divide start_ARG italic_π ( italic_X ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) italic_π ( italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_π ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) italic_π ( italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math> since <math alttext="Z_{2}\neq V_{1}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.20.m20.1"><semantics id="A1.SS3.2.p2.20.m20.1a"><mrow id="A1.SS3.2.p2.20.m20.1.1" xref="A1.SS3.2.p2.20.m20.1.1.cmml"><msub id="A1.SS3.2.p2.20.m20.1.1.2" xref="A1.SS3.2.p2.20.m20.1.1.2.cmml"><mi id="A1.SS3.2.p2.20.m20.1.1.2.2" xref="A1.SS3.2.p2.20.m20.1.1.2.2.cmml">Z</mi><mn id="A1.SS3.2.p2.20.m20.1.1.2.3" xref="A1.SS3.2.p2.20.m20.1.1.2.3.cmml">2</mn></msub><mo id="A1.SS3.2.p2.20.m20.1.1.1" xref="A1.SS3.2.p2.20.m20.1.1.1.cmml">≠</mo><msubsup id="A1.SS3.2.p2.20.m20.1.1.3" xref="A1.SS3.2.p2.20.m20.1.1.3.cmml"><mi id="A1.SS3.2.p2.20.m20.1.1.3.2.2" xref="A1.SS3.2.p2.20.m20.1.1.3.2.2.cmml">V</mi><mn id="A1.SS3.2.p2.20.m20.1.1.3.2.3" xref="A1.SS3.2.p2.20.m20.1.1.3.2.3.cmml">1</mn><mn id="A1.SS3.2.p2.20.m20.1.1.3.3" xref="A1.SS3.2.p2.20.m20.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.20.m20.1b"><apply id="A1.SS3.2.p2.20.m20.1.1.cmml" xref="A1.SS3.2.p2.20.m20.1.1"><neq id="A1.SS3.2.p2.20.m20.1.1.1.cmml" xref="A1.SS3.2.p2.20.m20.1.1.1"></neq><apply id="A1.SS3.2.p2.20.m20.1.1.2.cmml" xref="A1.SS3.2.p2.20.m20.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.20.m20.1.1.2.1.cmml" xref="A1.SS3.2.p2.20.m20.1.1.2">subscript</csymbol><ci id="A1.SS3.2.p2.20.m20.1.1.2.2.cmml" xref="A1.SS3.2.p2.20.m20.1.1.2.2">𝑍</ci><cn id="A1.SS3.2.p2.20.m20.1.1.2.3.cmml" type="integer" xref="A1.SS3.2.p2.20.m20.1.1.2.3">2</cn></apply><apply id="A1.SS3.2.p2.20.m20.1.1.3.cmml" xref="A1.SS3.2.p2.20.m20.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.2.p2.20.m20.1.1.3.1.cmml" xref="A1.SS3.2.p2.20.m20.1.1.3">superscript</csymbol><apply id="A1.SS3.2.p2.20.m20.1.1.3.2.cmml" xref="A1.SS3.2.p2.20.m20.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.2.p2.20.m20.1.1.3.2.1.cmml" xref="A1.SS3.2.p2.20.m20.1.1.3">subscript</csymbol><ci id="A1.SS3.2.p2.20.m20.1.1.3.2.2.cmml" xref="A1.SS3.2.p2.20.m20.1.1.3.2.2">𝑉</ci><cn id="A1.SS3.2.p2.20.m20.1.1.3.2.3.cmml" type="integer" xref="A1.SS3.2.p2.20.m20.1.1.3.2.3">1</cn></apply><cn id="A1.SS3.2.p2.20.m20.1.1.3.3.cmml" type="integer" xref="A1.SS3.2.p2.20.m20.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.20.m20.1c">Z_{2}\neq V_{1}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.20.m20.1d">italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≠ italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. It contradicts our assumption that this is the optimal path. If <math alttext="d\geq i&gt;1" class="ltx_Math" display="inline" id="A1.SS3.2.p2.21.m21.1"><semantics id="A1.SS3.2.p2.21.m21.1a"><mrow id="A1.SS3.2.p2.21.m21.1.1" xref="A1.SS3.2.p2.21.m21.1.1.cmml"><mi id="A1.SS3.2.p2.21.m21.1.1.2" xref="A1.SS3.2.p2.21.m21.1.1.2.cmml">d</mi><mo id="A1.SS3.2.p2.21.m21.1.1.3" xref="A1.SS3.2.p2.21.m21.1.1.3.cmml">≥</mo><mi id="A1.SS3.2.p2.21.m21.1.1.4" xref="A1.SS3.2.p2.21.m21.1.1.4.cmml">i</mi><mo id="A1.SS3.2.p2.21.m21.1.1.5" xref="A1.SS3.2.p2.21.m21.1.1.5.cmml">&gt;</mo><mn id="A1.SS3.2.p2.21.m21.1.1.6" xref="A1.SS3.2.p2.21.m21.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.21.m21.1b"><apply id="A1.SS3.2.p2.21.m21.1.1.cmml" xref="A1.SS3.2.p2.21.m21.1.1"><and id="A1.SS3.2.p2.21.m21.1.1a.cmml" xref="A1.SS3.2.p2.21.m21.1.1"></and><apply id="A1.SS3.2.p2.21.m21.1.1b.cmml" xref="A1.SS3.2.p2.21.m21.1.1"><geq id="A1.SS3.2.p2.21.m21.1.1.3.cmml" xref="A1.SS3.2.p2.21.m21.1.1.3"></geq><ci id="A1.SS3.2.p2.21.m21.1.1.2.cmml" xref="A1.SS3.2.p2.21.m21.1.1.2">𝑑</ci><ci id="A1.SS3.2.p2.21.m21.1.1.4.cmml" xref="A1.SS3.2.p2.21.m21.1.1.4">𝑖</ci></apply><apply id="A1.SS3.2.p2.21.m21.1.1c.cmml" xref="A1.SS3.2.p2.21.m21.1.1"><gt id="A1.SS3.2.p2.21.m21.1.1.5.cmml" xref="A1.SS3.2.p2.21.m21.1.1.5"></gt><share href="https://arxiv.org/html/2405.14377v1#A1.SS3.2.p2.21.m21.1.1.4.cmml" id="A1.SS3.2.p2.21.m21.1.1d.cmml" xref="A1.SS3.2.p2.21.m21.1.1"></share><cn id="A1.SS3.2.p2.21.m21.1.1.6.cmml" type="integer" xref="A1.SS3.2.p2.21.m21.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.21.m21.1c">d\geq i&gt;1</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.21.m21.1d">italic_d ≥ italic_i &gt; 1</annotation></semantics></math>, let <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.22.m22.1"><semantics id="A1.SS3.2.p2.22.m22.1a"><mi id="A1.SS3.2.p2.22.m22.1.1" mathvariant="normal" xref="A1.SS3.2.p2.22.m22.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.22.m22.1b"><ci id="A1.SS3.2.p2.22.m22.1.1.cmml" xref="A1.SS3.2.p2.22.m22.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.22.m22.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.22.m22.1d">roman_𝒮</annotation></semantics></math> be the tensor generated by the longest consecutive tensor cores containing <math alttext="\mathbfcal{G}_{i-1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.23.m23.1"><semantics id="A1.SS3.2.p2.23.m23.1a"><msub id="A1.SS3.2.p2.23.m23.1.1" xref="A1.SS3.2.p2.23.m23.1.1.cmml"><mi id="A1.SS3.2.p2.23.m23.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.23.m23.1.1.2.cmml">𝒢</mi><mrow id="A1.SS3.2.p2.23.m23.1.1.3" xref="A1.SS3.2.p2.23.m23.1.1.3.cmml"><mi id="A1.SS3.2.p2.23.m23.1.1.3.2" mathvariant="normal" xref="A1.SS3.2.p2.23.m23.1.1.3.2.cmml">⟩</mi><mo id="A1.SS3.2.p2.23.m23.1.1.3.1" xref="A1.SS3.2.p2.23.m23.1.1.3.1.cmml">⁢</mo><mi id="A1.SS3.2.p2.23.m23.1.1.3.3" mathvariant="normal" xref="A1.SS3.2.p2.23.m23.1.1.3.3.cmml">↖</mi><mo id="A1.SS3.2.p2.23.m23.1.1.3.1a" xref="A1.SS3.2.p2.23.m23.1.1.3.1.cmml">⁢</mo><mi id="A1.SS3.2.p2.23.m23.1.1.3.4" mathvariant="normal" xref="A1.SS3.2.p2.23.m23.1.1.3.4.cmml">∞</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.23.m23.1b"><apply id="A1.SS3.2.p2.23.m23.1.1.cmml" xref="A1.SS3.2.p2.23.m23.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.23.m23.1.1.1.cmml" xref="A1.SS3.2.p2.23.m23.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.23.m23.1.1.2.cmml" xref="A1.SS3.2.p2.23.m23.1.1.2">𝒢</ci><apply id="A1.SS3.2.p2.23.m23.1.1.3.cmml" xref="A1.SS3.2.p2.23.m23.1.1.3"><times id="A1.SS3.2.p2.23.m23.1.1.3.1.cmml" xref="A1.SS3.2.p2.23.m23.1.1.3.1"></times><ci id="A1.SS3.2.p2.23.m23.1.1.3.2.cmml" xref="A1.SS3.2.p2.23.m23.1.1.3.2">⟩</ci><ci id="A1.SS3.2.p2.23.m23.1.1.3.3.cmml" xref="A1.SS3.2.p2.23.m23.1.1.3.3">↖</ci><ci id="A1.SS3.2.p2.23.m23.1.1.3.4.cmml" xref="A1.SS3.2.p2.23.m23.1.1.3.4">∞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.23.m23.1c">\mathbfcal{G}_{i-1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.23.m23.1d">roman_𝒢 start_POSTSUBSCRIPT ⟩ ↖ ∞ end_POSTSUBSCRIPT</annotation></semantics></math> and used in the optimal path. A better path is to first contract <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.24.m24.1"><semantics id="A1.SS3.2.p2.24.m24.1a"><msub id="A1.SS3.2.p2.24.m24.1.1" xref="A1.SS3.2.p2.24.m24.1.1.cmml"><mi id="A1.SS3.2.p2.24.m24.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.24.m24.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.24.m24.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.24.m24.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.24.m24.1b"><apply id="A1.SS3.2.p2.24.m24.1.1.cmml" xref="A1.SS3.2.p2.24.m24.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.24.m24.1.1.1.cmml" xref="A1.SS3.2.p2.24.m24.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.24.m24.1.1.2.cmml" xref="A1.SS3.2.p2.24.m24.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.24.m24.1.1.3.cmml" xref="A1.SS3.2.p2.24.m24.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.24.m24.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.24.m24.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.25.m25.1"><semantics id="A1.SS3.2.p2.25.m25.1a"><mi id="A1.SS3.2.p2.25.m25.1.1" mathvariant="normal" xref="A1.SS3.2.p2.25.m25.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.25.m25.1b"><ci id="A1.SS3.2.p2.25.m25.1.1.cmml" xref="A1.SS3.2.p2.25.m25.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.25.m25.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.25.m25.1d">roman_𝒮</annotation></semantics></math> to obtain <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.26.m26.1"><semantics id="A1.SS3.2.p2.26.m26.1a"><mi id="A1.SS3.2.p2.26.m26.1.1" mathvariant="normal" xref="A1.SS3.2.p2.26.m26.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.26.m26.1b"><ci id="A1.SS3.2.p2.26.m26.1.1.cmml" xref="A1.SS3.2.p2.26.m26.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.26.m26.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.26.m26.1d">roman_𝒲</annotation></semantics></math>, then contract <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.27.m27.1"><semantics id="A1.SS3.2.p2.27.m27.1a"><mi id="A1.SS3.2.p2.27.m27.1.1" mathvariant="normal" xref="A1.SS3.2.p2.27.m27.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.27.m27.1b"><ci id="A1.SS3.2.p2.27.m27.1.1.cmml" xref="A1.SS3.2.p2.27.m27.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.27.m27.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.27.m27.1d">roman_𝒲</annotation></semantics></math> with <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.28.m28.1"><semantics id="A1.SS3.2.p2.28.m28.1a"><mi id="A1.SS3.2.p2.28.m28.1.1" mathvariant="normal" xref="A1.SS3.2.p2.28.m28.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.28.m28.1b"><ci id="A1.SS3.2.p2.28.m28.1.1.cmml" xref="A1.SS3.2.p2.28.m28.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.28.m28.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.28.m28.1d">roman_𝒳</annotation></semantics></math> and all other unused parts in the optimal path. It is better because the number of flops for contracting <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.29.m29.1"><semantics id="A1.SS3.2.p2.29.m29.1a"><mi id="A1.SS3.2.p2.29.m29.1.1" mathvariant="normal" xref="A1.SS3.2.p2.29.m29.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.29.m29.1b"><ci id="A1.SS3.2.p2.29.m29.1.1.cmml" xref="A1.SS3.2.p2.29.m29.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.29.m29.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.29.m29.1d">roman_𝒲</annotation></semantics></math> and <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.30.m30.1"><semantics id="A1.SS3.2.p2.30.m30.1a"><mi id="A1.SS3.2.p2.30.m30.1.1" mathvariant="normal" xref="A1.SS3.2.p2.30.m30.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.30.m30.1b"><ci id="A1.SS3.2.p2.30.m30.1.1.cmml" xref="A1.SS3.2.p2.30.m30.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.30.m30.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.30.m30.1d">roman_𝒳</annotation></semantics></math> is no greater than that for contracting <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.31.m31.1"><semantics id="A1.SS3.2.p2.31.m31.1a"><msub id="A1.SS3.2.p2.31.m31.1.1" xref="A1.SS3.2.p2.31.m31.1.1.cmml"><mi id="A1.SS3.2.p2.31.m31.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.31.m31.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.31.m31.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.31.m31.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.31.m31.1b"><apply id="A1.SS3.2.p2.31.m31.1.1.cmml" xref="A1.SS3.2.p2.31.m31.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.31.m31.1.1.1.cmml" xref="A1.SS3.2.p2.31.m31.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.31.m31.1.1.2.cmml" xref="A1.SS3.2.p2.31.m31.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.31.m31.1.1.3.cmml" xref="A1.SS3.2.p2.31.m31.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.31.m31.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.31.m31.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.32.m32.1"><semantics id="A1.SS3.2.p2.32.m32.1a"><mi id="A1.SS3.2.p2.32.m32.1.1" mathvariant="normal" xref="A1.SS3.2.p2.32.m32.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.32.m32.1b"><ci id="A1.SS3.2.p2.32.m32.1.1.cmml" xref="A1.SS3.2.p2.32.m32.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.32.m32.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.32.m32.1d">roman_𝒳</annotation></semantics></math> and the new path reduces the number of flops in the remaining contractions. The reduction in the remaining contractions is more than the potential flop increase in obtaining <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.33.m33.1"><semantics id="A1.SS3.2.p2.33.m33.1a"><mi id="A1.SS3.2.p2.33.m33.1.1" mathvariant="normal" xref="A1.SS3.2.p2.33.m33.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.33.m33.1b"><ci id="A1.SS3.2.p2.33.m33.1.1.cmml" xref="A1.SS3.2.p2.33.m33.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.33.m33.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.33.m33.1d">roman_𝒲</annotation></semantics></math> when the batch size <math alttext="b" class="ltx_Math" display="inline" id="A1.SS3.2.p2.34.m34.1"><semantics id="A1.SS3.2.p2.34.m34.1a"><mi id="A1.SS3.2.p2.34.m34.1.1" xref="A1.SS3.2.p2.34.m34.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.34.m34.1b"><ci id="A1.SS3.2.p2.34.m34.1.1.cmml" xref="A1.SS3.2.p2.34.m34.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.34.m34.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.34.m34.1d">italic_b</annotation></semantics></math> is big enough. Finally, we consider the case that <math alttext="i&gt;d" class="ltx_Math" display="inline" id="A1.SS3.2.p2.35.m35.1"><semantics id="A1.SS3.2.p2.35.m35.1a"><mrow id="A1.SS3.2.p2.35.m35.1.1" xref="A1.SS3.2.p2.35.m35.1.1.cmml"><mi id="A1.SS3.2.p2.35.m35.1.1.2" xref="A1.SS3.2.p2.35.m35.1.1.2.cmml">i</mi><mo id="A1.SS3.2.p2.35.m35.1.1.1" xref="A1.SS3.2.p2.35.m35.1.1.1.cmml">&gt;</mo><mi id="A1.SS3.2.p2.35.m35.1.1.3" xref="A1.SS3.2.p2.35.m35.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.35.m35.1b"><apply id="A1.SS3.2.p2.35.m35.1.1.cmml" xref="A1.SS3.2.p2.35.m35.1.1"><gt id="A1.SS3.2.p2.35.m35.1.1.1.cmml" xref="A1.SS3.2.p2.35.m35.1.1.1"></gt><ci id="A1.SS3.2.p2.35.m35.1.1.2.cmml" xref="A1.SS3.2.p2.35.m35.1.1.2">𝑖</ci><ci id="A1.SS3.2.p2.35.m35.1.1.3.cmml" xref="A1.SS3.2.p2.35.m35.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.35.m35.1c">i&gt;d</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.35.m35.1d">italic_i &gt; italic_d</annotation></semantics></math>. Let <math alttext="\mathbfcal{G}_{j}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.36.m36.1"><semantics id="A1.SS3.2.p2.36.m36.1a"><msub id="A1.SS3.2.p2.36.m36.1.1" xref="A1.SS3.2.p2.36.m36.1.1.cmml"><mi id="A1.SS3.2.p2.36.m36.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.36.m36.1.1.2.cmml">𝒢</mi><mo fence="false" id="A1.SS3.2.p2.36.m36.1.1.3" stretchy="false" xref="A1.SS3.2.p2.36.m36.1.1.3.cmml">|</mo></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.36.m36.1b"><apply id="A1.SS3.2.p2.36.m36.1.1.cmml" xref="A1.SS3.2.p2.36.m36.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.36.m36.1.1.1.cmml" xref="A1.SS3.2.p2.36.m36.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.36.m36.1.1.2.cmml" xref="A1.SS3.2.p2.36.m36.1.1.2">𝒢</ci><ci id="A1.SS3.2.p2.36.m36.1.1.3.cmml" xref="A1.SS3.2.p2.36.m36.1.1.3">|</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.36.m36.1c">\mathbfcal{G}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.36.m36.1d">roman_𝒢 start_POSTSUBSCRIPT | end_POSTSUBSCRIPT</annotation></semantics></math> be the first tensor core used to obtain <math alttext="\mathbfcal{V}_{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.37.m37.1"><semantics id="A1.SS3.2.p2.37.m37.1a"><msub id="A1.SS3.2.p2.37.m37.1.1" xref="A1.SS3.2.p2.37.m37.1.1.cmml"><mi id="A1.SS3.2.p2.37.m37.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.37.m37.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.37.m37.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.37.m37.1.1.3.cmml">∈</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.37.m37.1b"><apply id="A1.SS3.2.p2.37.m37.1.1.cmml" xref="A1.SS3.2.p2.37.m37.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.37.m37.1.1.1.cmml" xref="A1.SS3.2.p2.37.m37.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.37.m37.1.1.2.cmml" xref="A1.SS3.2.p2.37.m37.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.37.m37.1.1.3.cmml" xref="A1.SS3.2.p2.37.m37.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.37.m37.1c">\mathbfcal{V}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.37.m37.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT</annotation></semantics></math>. If <math alttext="j&gt;d" class="ltx_Math" display="inline" id="A1.SS3.2.p2.38.m38.1"><semantics id="A1.SS3.2.p2.38.m38.1a"><mrow id="A1.SS3.2.p2.38.m38.1.1" xref="A1.SS3.2.p2.38.m38.1.1.cmml"><mi id="A1.SS3.2.p2.38.m38.1.1.2" xref="A1.SS3.2.p2.38.m38.1.1.2.cmml">j</mi><mo id="A1.SS3.2.p2.38.m38.1.1.1" xref="A1.SS3.2.p2.38.m38.1.1.1.cmml">&gt;</mo><mi id="A1.SS3.2.p2.38.m38.1.1.3" xref="A1.SS3.2.p2.38.m38.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.38.m38.1b"><apply id="A1.SS3.2.p2.38.m38.1.1.cmml" xref="A1.SS3.2.p2.38.m38.1.1"><gt id="A1.SS3.2.p2.38.m38.1.1.1.cmml" xref="A1.SS3.2.p2.38.m38.1.1.1"></gt><ci id="A1.SS3.2.p2.38.m38.1.1.2.cmml" xref="A1.SS3.2.p2.38.m38.1.1.2">𝑗</ci><ci id="A1.SS3.2.p2.38.m38.1.1.3.cmml" xref="A1.SS3.2.p2.38.m38.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.38.m38.1c">j&gt;d</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.38.m38.1d">italic_j &gt; italic_d</annotation></semantics></math>, then first contracting <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.39.m39.1"><semantics id="A1.SS3.2.p2.39.m39.1a"><msub id="A1.SS3.2.p2.39.m39.1.1" xref="A1.SS3.2.p2.39.m39.1.1.cmml"><mi id="A1.SS3.2.p2.39.m39.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.39.m39.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.39.m39.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.39.m39.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.39.m39.1b"><apply id="A1.SS3.2.p2.39.m39.1.1.cmml" xref="A1.SS3.2.p2.39.m39.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.39.m39.1.1.1.cmml" xref="A1.SS3.2.p2.39.m39.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.39.m39.1.1.2.cmml" xref="A1.SS3.2.p2.39.m39.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.39.m39.1.1.3.cmml" xref="A1.SS3.2.p2.39.m39.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.39.m39.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.39.m39.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.40.m40.1"><semantics id="A1.SS3.2.p2.40.m40.1a"><msub id="A1.SS3.2.p2.40.m40.1.1" xref="A1.SS3.2.p2.40.m40.1.1.cmml"><mi id="A1.SS3.2.p2.40.m40.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.40.m40.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.40.m40.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.40.m40.1.1.3.cmml">∈</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.40.m40.1b"><apply id="A1.SS3.2.p2.40.m40.1.1.cmml" xref="A1.SS3.2.p2.40.m40.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.40.m40.1.1.1.cmml" xref="A1.SS3.2.p2.40.m40.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.40.m40.1.1.2.cmml" xref="A1.SS3.2.p2.40.m40.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.40.m40.1.1.3.cmml" xref="A1.SS3.2.p2.40.m40.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.40.m40.1c">\mathbfcal{V}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.40.m40.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT</annotation></semantics></math> and then all other parts is a better choice. Otherwise, if <math alttext="j\leq d" class="ltx_Math" display="inline" id="A1.SS3.2.p2.41.m41.1"><semantics id="A1.SS3.2.p2.41.m41.1a"><mrow id="A1.SS3.2.p2.41.m41.1.1" xref="A1.SS3.2.p2.41.m41.1.1.cmml"><mi id="A1.SS3.2.p2.41.m41.1.1.2" xref="A1.SS3.2.p2.41.m41.1.1.2.cmml">j</mi><mo id="A1.SS3.2.p2.41.m41.1.1.1" xref="A1.SS3.2.p2.41.m41.1.1.1.cmml">≤</mo><mi id="A1.SS3.2.p2.41.m41.1.1.3" xref="A1.SS3.2.p2.41.m41.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.41.m41.1b"><apply id="A1.SS3.2.p2.41.m41.1.1.cmml" xref="A1.SS3.2.p2.41.m41.1.1"><leq id="A1.SS3.2.p2.41.m41.1.1.1.cmml" xref="A1.SS3.2.p2.41.m41.1.1.1"></leq><ci id="A1.SS3.2.p2.41.m41.1.1.2.cmml" xref="A1.SS3.2.p2.41.m41.1.1.2">𝑗</ci><ci id="A1.SS3.2.p2.41.m41.1.1.3.cmml" xref="A1.SS3.2.p2.41.m41.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.41.m41.1c">j\leq d</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.41.m41.1d">italic_j ≤ italic_d</annotation></semantics></math>, let <math alttext="\mathbfcal{V}_{2}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.42.m42.1"><semantics id="A1.SS3.2.p2.42.m42.1a"><msubsup id="A1.SS3.2.p2.42.m42.1.1" xref="A1.SS3.2.p2.42.m42.1.1.cmml"><mi id="A1.SS3.2.p2.42.m42.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.42.m42.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.42.m42.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.42.m42.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.42.m42.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.42.m42.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.42.m42.1b"><apply id="A1.SS3.2.p2.42.m42.1.1.cmml" xref="A1.SS3.2.p2.42.m42.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.42.m42.1.1.1.cmml" xref="A1.SS3.2.p2.42.m42.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.42.m42.1.1.2.cmml" xref="A1.SS3.2.p2.42.m42.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.42.m42.1.1.2.1.cmml" xref="A1.SS3.2.p2.42.m42.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.42.m42.1.1.2.2.cmml" xref="A1.SS3.2.p2.42.m42.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.42.m42.1.1.2.3.cmml" xref="A1.SS3.2.p2.42.m42.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.42.m42.1.1.3.cmml" xref="A1.SS3.2.p2.42.m42.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.42.m42.1c">\mathbfcal{V}_{2}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.42.m42.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> be the tensor contracted by the consecutive tensors containing <math alttext="\mathbfcal{G}_{j}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.43.m43.1"><semantics id="A1.SS3.2.p2.43.m43.1a"><msub id="A1.SS3.2.p2.43.m43.1.1" xref="A1.SS3.2.p2.43.m43.1.1.cmml"><mi id="A1.SS3.2.p2.43.m43.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.43.m43.1.1.2.cmml">𝒢</mi><mo fence="false" id="A1.SS3.2.p2.43.m43.1.1.3" stretchy="false" xref="A1.SS3.2.p2.43.m43.1.1.3.cmml">|</mo></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.43.m43.1b"><apply id="A1.SS3.2.p2.43.m43.1.1.cmml" xref="A1.SS3.2.p2.43.m43.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.43.m43.1.1.1.cmml" xref="A1.SS3.2.p2.43.m43.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.43.m43.1.1.2.cmml" xref="A1.SS3.2.p2.43.m43.1.1.2">𝒢</ci><ci id="A1.SS3.2.p2.43.m43.1.1.3.cmml" xref="A1.SS3.2.p2.43.m43.1.1.3">|</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.43.m43.1c">\mathbfcal{G}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.43.m43.1d">roman_𝒢 start_POSTSUBSCRIPT | end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="C_{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.44.m44.1"><semantics id="A1.SS3.2.p2.44.m44.1a"><msub id="A1.SS3.2.p2.44.m44.1.1" xref="A1.SS3.2.p2.44.m44.1.1.cmml"><mi id="A1.SS3.2.p2.44.m44.1.1.2" xref="A1.SS3.2.p2.44.m44.1.1.2.cmml">C</mi><mn id="A1.SS3.2.p2.44.m44.1.1.3" xref="A1.SS3.2.p2.44.m44.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.44.m44.1b"><apply id="A1.SS3.2.p2.44.m44.1.1.cmml" xref="A1.SS3.2.p2.44.m44.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.44.m44.1.1.1.cmml" xref="A1.SS3.2.p2.44.m44.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.44.m44.1.1.2.cmml" xref="A1.SS3.2.p2.44.m44.1.1.2">𝐶</ci><cn id="A1.SS3.2.p2.44.m44.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.44.m44.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.44.m44.1c">C_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.44.m44.1d">italic_C start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. The tensor <math alttext="\mathbfcal{V}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.45.m45.1"><semantics id="A1.SS3.2.p2.45.m45.1a"><mi id="A1.SS3.2.p2.45.m45.1.1" mathvariant="normal" xref="A1.SS3.2.p2.45.m45.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.45.m45.1b"><ci id="A1.SS3.2.p2.45.m45.1.1.cmml" xref="A1.SS3.2.p2.45.m45.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.45.m45.1c">\mathbfcal{V}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.45.m45.1d">roman_𝒱</annotation></semantics></math> can be represented by the contraction of <math alttext="\mathbfcal{V}_{2}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.46.m46.1"><semantics id="A1.SS3.2.p2.46.m46.1a"><msubsup id="A1.SS3.2.p2.46.m46.1.1" xref="A1.SS3.2.p2.46.m46.1.1.cmml"><mi id="A1.SS3.2.p2.46.m46.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.46.m46.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.46.m46.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.46.m46.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.46.m46.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.46.m46.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.46.m46.1b"><apply id="A1.SS3.2.p2.46.m46.1.1.cmml" xref="A1.SS3.2.p2.46.m46.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.46.m46.1.1.1.cmml" xref="A1.SS3.2.p2.46.m46.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.46.m46.1.1.2.cmml" xref="A1.SS3.2.p2.46.m46.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.46.m46.1.1.2.1.cmml" xref="A1.SS3.2.p2.46.m46.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.46.m46.1.1.2.2.cmml" xref="A1.SS3.2.p2.46.m46.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.46.m46.1.1.2.3.cmml" xref="A1.SS3.2.p2.46.m46.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.46.m46.1.1.3.cmml" xref="A1.SS3.2.p2.46.m46.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.46.m46.1c">\mathbfcal{V}_{2}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.46.m46.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> and another tensor <math alttext="\mathbfcal{V}_{2}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.47.m47.1"><semantics id="A1.SS3.2.p2.47.m47.1a"><msubsup id="A1.SS3.2.p2.47.m47.1.1" xref="A1.SS3.2.p2.47.m47.1.1.cmml"><mi id="A1.SS3.2.p2.47.m47.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.47.m47.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.47.m47.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.47.m47.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.47.m47.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.47.m47.1.1.3.cmml">∈</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.47.m47.1b"><apply id="A1.SS3.2.p2.47.m47.1.1.cmml" xref="A1.SS3.2.p2.47.m47.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.47.m47.1.1.1.cmml" xref="A1.SS3.2.p2.47.m47.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.47.m47.1.1.2.cmml" xref="A1.SS3.2.p2.47.m47.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.47.m47.1.1.2.1.cmml" xref="A1.SS3.2.p2.47.m47.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.47.m47.1.1.2.2.cmml" xref="A1.SS3.2.p2.47.m47.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.47.m47.1.1.2.3.cmml" xref="A1.SS3.2.p2.47.m47.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.47.m47.1.1.3.cmml" xref="A1.SS3.2.p2.47.m47.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.47.m47.1c">\mathbfcal{V}_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.47.m47.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math> generated by the remaining tensor cores in <math alttext="C_{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.48.m48.1"><semantics id="A1.SS3.2.p2.48.m48.1a"><msub id="A1.SS3.2.p2.48.m48.1.1" xref="A1.SS3.2.p2.48.m48.1.1.cmml"><mi id="A1.SS3.2.p2.48.m48.1.1.2" xref="A1.SS3.2.p2.48.m48.1.1.2.cmml">C</mi><mn id="A1.SS3.2.p2.48.m48.1.1.3" xref="A1.SS3.2.p2.48.m48.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.48.m48.1b"><apply id="A1.SS3.2.p2.48.m48.1.1.cmml" xref="A1.SS3.2.p2.48.m48.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.48.m48.1.1.1.cmml" xref="A1.SS3.2.p2.48.m48.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.48.m48.1.1.2.cmml" xref="A1.SS3.2.p2.48.m48.1.1.2">𝐶</ci><cn id="A1.SS3.2.p2.48.m48.1.1.3.cmml" type="integer" xref="A1.SS3.2.p2.48.m48.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.48.m48.1c">C_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.48.m48.1d">italic_C start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. In this scenario, we can contract <math alttext="\mathbfcal{V}_{2}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.49.m49.1"><semantics id="A1.SS3.2.p2.49.m49.1a"><msubsup id="A1.SS3.2.p2.49.m49.1.1" xref="A1.SS3.2.p2.49.m49.1.1.cmml"><mi id="A1.SS3.2.p2.49.m49.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.49.m49.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.49.m49.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.49.m49.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.49.m49.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.49.m49.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.49.m49.1b"><apply id="A1.SS3.2.p2.49.m49.1.1.cmml" xref="A1.SS3.2.p2.49.m49.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.49.m49.1.1.1.cmml" xref="A1.SS3.2.p2.49.m49.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.49.m49.1.1.2.cmml" xref="A1.SS3.2.p2.49.m49.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.49.m49.1.1.2.1.cmml" xref="A1.SS3.2.p2.49.m49.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.49.m49.1.1.2.2.cmml" xref="A1.SS3.2.p2.49.m49.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.49.m49.1.1.2.3.cmml" xref="A1.SS3.2.p2.49.m49.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.49.m49.1.1.3.cmml" xref="A1.SS3.2.p2.49.m49.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.49.m49.1c">\mathbfcal{V}_{2}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.49.m49.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.50.m50.1"><semantics id="A1.SS3.2.p2.50.m50.1a"><msub id="A1.SS3.2.p2.50.m50.1.1" xref="A1.SS3.2.p2.50.m50.1.1.cmml"><mi id="A1.SS3.2.p2.50.m50.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.50.m50.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.50.m50.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.50.m50.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.50.m50.1b"><apply id="A1.SS3.2.p2.50.m50.1.1.cmml" xref="A1.SS3.2.p2.50.m50.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.50.m50.1.1.1.cmml" xref="A1.SS3.2.p2.50.m50.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.50.m50.1.1.2.cmml" xref="A1.SS3.2.p2.50.m50.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.50.m50.1.1.3.cmml" xref="A1.SS3.2.p2.50.m50.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.50.m50.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.50.m50.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> to get <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.51.m51.1"><semantics id="A1.SS3.2.p2.51.m51.1a"><mi id="A1.SS3.2.p2.51.m51.1.1" mathvariant="normal" xref="A1.SS3.2.p2.51.m51.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.51.m51.1b"><ci id="A1.SS3.2.p2.51.m51.1.1.cmml" xref="A1.SS3.2.p2.51.m51.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.51.m51.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.51.m51.1d">roman_𝒮</annotation></semantics></math>, then <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.52.m52.1"><semantics id="A1.SS3.2.p2.52.m52.1a"><mi id="A1.SS3.2.p2.52.m52.1.1" mathvariant="normal" xref="A1.SS3.2.p2.52.m52.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.52.m52.1b"><ci id="A1.SS3.2.p2.52.m52.1.1.cmml" xref="A1.SS3.2.p2.52.m52.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.52.m52.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.52.m52.1d">roman_𝒮</annotation></semantics></math> with <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.53.m53.1"><semantics id="A1.SS3.2.p2.53.m53.1a"><mi id="A1.SS3.2.p2.53.m53.1.1" mathvariant="normal" xref="A1.SS3.2.p2.53.m53.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.53.m53.1b"><ci id="A1.SS3.2.p2.53.m53.1.1.cmml" xref="A1.SS3.2.p2.53.m53.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.53.m53.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.53.m53.1d">roman_𝒳</annotation></semantics></math> to get <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.54.m54.1"><semantics id="A1.SS3.2.p2.54.m54.1a"><mi id="A1.SS3.2.p2.54.m54.1.1" mathvariant="normal" xref="A1.SS3.2.p2.54.m54.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.54.m54.1b"><ci id="A1.SS3.2.p2.54.m54.1.1.cmml" xref="A1.SS3.2.p2.54.m54.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.54.m54.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.54.m54.1d">roman_𝒲</annotation></semantics></math>, then <math alttext="\mathbfcal{V}_{2}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.55.m55.1"><semantics id="A1.SS3.2.p2.55.m55.1a"><msubsup id="A1.SS3.2.p2.55.m55.1.1" xref="A1.SS3.2.p2.55.m55.1.1.cmml"><mi id="A1.SS3.2.p2.55.m55.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.55.m55.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.55.m55.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.55.m55.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.55.m55.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.55.m55.1.1.3.cmml">∈</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.55.m55.1b"><apply id="A1.SS3.2.p2.55.m55.1.1.cmml" xref="A1.SS3.2.p2.55.m55.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.55.m55.1.1.1.cmml" xref="A1.SS3.2.p2.55.m55.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.55.m55.1.1.2.cmml" xref="A1.SS3.2.p2.55.m55.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.55.m55.1.1.2.1.cmml" xref="A1.SS3.2.p2.55.m55.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.55.m55.1.1.2.2.cmml" xref="A1.SS3.2.p2.55.m55.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.55.m55.1.1.2.3.cmml" xref="A1.SS3.2.p2.55.m55.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.55.m55.1.1.3.cmml" xref="A1.SS3.2.p2.55.m55.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.55.m55.1c">\mathbfcal{V}_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.55.m55.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.56.m56.1"><semantics id="A1.SS3.2.p2.56.m56.1a"><mi id="A1.SS3.2.p2.56.m56.1.1" mathvariant="normal" xref="A1.SS3.2.p2.56.m56.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.56.m56.1b"><ci id="A1.SS3.2.p2.56.m56.1.1.cmml" xref="A1.SS3.2.p2.56.m56.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.56.m56.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.56.m56.1d">roman_𝒲</annotation></semantics></math>, and finally the obtained tensor with <math alttext="\mathbfcal{V}_{3},\ldots,\mathbfcal{V}_{k}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.57.m57.1"><semantics id="A1.SS3.2.p2.57.m57.1a"><mrow id="A1.SS3.2.p2.57.m57.1.1" xref="A1.SS3.2.p2.57.m57.1.1.cmml"><msub id="A1.SS3.2.p2.57.m57.1.1.2" xref="A1.SS3.2.p2.57.m57.1.1.2.cmml"><mi id="A1.SS3.2.p2.57.m57.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.57.m57.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.2.3.cmml">∋</mi></msub><mo id="A1.SS3.2.p2.57.m57.1.1.1" xref="A1.SS3.2.p2.57.m57.1.1.1.cmml">⁢</mo><mi id="A1.SS3.2.p2.57.m57.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.3.cmml">⇔</mi><mo id="A1.SS3.2.p2.57.m57.1.1.1a" xref="A1.SS3.2.p2.57.m57.1.1.1.cmml">⁢</mo><mi id="A1.SS3.2.p2.57.m57.1.1.4" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.4.cmml">…</mi><mo id="A1.SS3.2.p2.57.m57.1.1.1b" xref="A1.SS3.2.p2.57.m57.1.1.1.cmml">⁢</mo><mi id="A1.SS3.2.p2.57.m57.1.1.5" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.5.cmml">⇔</mi><mo id="A1.SS3.2.p2.57.m57.1.1.1c" xref="A1.SS3.2.p2.57.m57.1.1.1.cmml">⁢</mo><msub id="A1.SS3.2.p2.57.m57.1.1.6" xref="A1.SS3.2.p2.57.m57.1.1.6.cmml"><mi id="A1.SS3.2.p2.57.m57.1.1.6.2" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.6.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.57.m57.1.1.6.3" mathvariant="normal" xref="A1.SS3.2.p2.57.m57.1.1.6.3.cmml">∥</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.57.m57.1b"><apply id="A1.SS3.2.p2.57.m57.1.1.cmml" xref="A1.SS3.2.p2.57.m57.1.1"><times id="A1.SS3.2.p2.57.m57.1.1.1.cmml" xref="A1.SS3.2.p2.57.m57.1.1.1"></times><apply id="A1.SS3.2.p2.57.m57.1.1.2.cmml" xref="A1.SS3.2.p2.57.m57.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.2.p2.57.m57.1.1.2.1.cmml" xref="A1.SS3.2.p2.57.m57.1.1.2">subscript</csymbol><ci id="A1.SS3.2.p2.57.m57.1.1.2.2.cmml" xref="A1.SS3.2.p2.57.m57.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.57.m57.1.1.2.3.cmml" xref="A1.SS3.2.p2.57.m57.1.1.2.3">∋</ci></apply><ci id="A1.SS3.2.p2.57.m57.1.1.3.cmml" xref="A1.SS3.2.p2.57.m57.1.1.3">⇔</ci><ci id="A1.SS3.2.p2.57.m57.1.1.4.cmml" xref="A1.SS3.2.p2.57.m57.1.1.4">…</ci><ci id="A1.SS3.2.p2.57.m57.1.1.5.cmml" xref="A1.SS3.2.p2.57.m57.1.1.5">⇔</ci><apply id="A1.SS3.2.p2.57.m57.1.1.6.cmml" xref="A1.SS3.2.p2.57.m57.1.1.6"><csymbol cd="ambiguous" id="A1.SS3.2.p2.57.m57.1.1.6.1.cmml" xref="A1.SS3.2.p2.57.m57.1.1.6">subscript</csymbol><ci id="A1.SS3.2.p2.57.m57.1.1.6.2.cmml" xref="A1.SS3.2.p2.57.m57.1.1.6.2">𝒱</ci><ci id="A1.SS3.2.p2.57.m57.1.1.6.3.cmml" xref="A1.SS3.2.p2.57.m57.1.1.6.3">∥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.57.m57.1c">\mathbfcal{V}_{3},\ldots,\mathbfcal{V}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.57.m57.1d">roman_𝒱 start_POSTSUBSCRIPT ∋ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒱 start_POSTSUBSCRIPT ∥ end_POSTSUBSCRIPT</annotation></semantics></math>. It is not hard to verify contracting <math alttext="\mathbfcal{V}_{2}^{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.58.m58.1"><semantics id="A1.SS3.2.p2.58.m58.1a"><msubsup id="A1.SS3.2.p2.58.m58.1.1" xref="A1.SS3.2.p2.58.m58.1.1.cmml"><mi id="A1.SS3.2.p2.58.m58.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.58.m58.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.58.m58.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.58.m58.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.58.m58.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.58.m58.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.58.m58.1b"><apply id="A1.SS3.2.p2.58.m58.1.1.cmml" xref="A1.SS3.2.p2.58.m58.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.58.m58.1.1.1.cmml" xref="A1.SS3.2.p2.58.m58.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.58.m58.1.1.2.cmml" xref="A1.SS3.2.p2.58.m58.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.58.m58.1.1.2.1.cmml" xref="A1.SS3.2.p2.58.m58.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.58.m58.1.1.2.2.cmml" xref="A1.SS3.2.p2.58.m58.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.58.m58.1.1.2.3.cmml" xref="A1.SS3.2.p2.58.m58.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.58.m58.1.1.3.cmml" xref="A1.SS3.2.p2.58.m58.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.58.m58.1c">\mathbfcal{V}_{2}^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.58.m58.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.59.m59.1"><semantics id="A1.SS3.2.p2.59.m59.1a"><msub id="A1.SS3.2.p2.59.m59.1.1" xref="A1.SS3.2.p2.59.m59.1.1.cmml"><mi id="A1.SS3.2.p2.59.m59.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.59.m59.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.59.m59.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.59.m59.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.59.m59.1b"><apply id="A1.SS3.2.p2.59.m59.1.1.cmml" xref="A1.SS3.2.p2.59.m59.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.59.m59.1.1.1.cmml" xref="A1.SS3.2.p2.59.m59.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.59.m59.1.1.2.cmml" xref="A1.SS3.2.p2.59.m59.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.59.m59.1.1.3.cmml" xref="A1.SS3.2.p2.59.m59.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.59.m59.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.59.m59.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.60.m60.1"><semantics id="A1.SS3.2.p2.60.m60.1a"><mi id="A1.SS3.2.p2.60.m60.1.1" mathvariant="normal" xref="A1.SS3.2.p2.60.m60.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.60.m60.1b"><ci id="A1.SS3.2.p2.60.m60.1.1.cmml" xref="A1.SS3.2.p2.60.m60.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.60.m60.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.60.m60.1d">roman_𝒮</annotation></semantics></math> and <math alttext="\mathbfcal{S}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.61.m61.1"><semantics id="A1.SS3.2.p2.61.m61.1a"><mi id="A1.SS3.2.p2.61.m61.1.1" mathvariant="normal" xref="A1.SS3.2.p2.61.m61.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.61.m61.1b"><ci id="A1.SS3.2.p2.61.m61.1.1.cmml" xref="A1.SS3.2.p2.61.m61.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.61.m61.1c">\mathbfcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.61.m61.1d">roman_𝒮</annotation></semantics></math> and <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.62.m62.1"><semantics id="A1.SS3.2.p2.62.m62.1a"><mi id="A1.SS3.2.p2.62.m62.1.1" mathvariant="normal" xref="A1.SS3.2.p2.62.m62.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.62.m62.1b"><ci id="A1.SS3.2.p2.62.m62.1.1.cmml" xref="A1.SS3.2.p2.62.m62.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.62.m62.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.62.m62.1d">roman_𝒳</annotation></semantics></math>, and <math alttext="\mathbfcal{W}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.63.m63.1"><semantics id="A1.SS3.2.p2.63.m63.1a"><mi id="A1.SS3.2.p2.63.m63.1.1" mathvariant="normal" xref="A1.SS3.2.p2.63.m63.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.63.m63.1b"><ci id="A1.SS3.2.p2.63.m63.1.1.cmml" xref="A1.SS3.2.p2.63.m63.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.63.m63.1c">\mathbfcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.63.m63.1d">roman_𝒲</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{2}^{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.64.m64.1"><semantics id="A1.SS3.2.p2.64.m64.1a"><msubsup id="A1.SS3.2.p2.64.m64.1.1" xref="A1.SS3.2.p2.64.m64.1.1.cmml"><mi id="A1.SS3.2.p2.64.m64.1.1.2.2" mathvariant="normal" xref="A1.SS3.2.p2.64.m64.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.64.m64.1.1.2.3" mathvariant="normal" xref="A1.SS3.2.p2.64.m64.1.1.2.3.cmml">∈</mi><mi id="A1.SS3.2.p2.64.m64.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.64.m64.1.1.3.cmml">∈</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.64.m64.1b"><apply id="A1.SS3.2.p2.64.m64.1.1.cmml" xref="A1.SS3.2.p2.64.m64.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.64.m64.1.1.1.cmml" xref="A1.SS3.2.p2.64.m64.1.1">superscript</csymbol><apply id="A1.SS3.2.p2.64.m64.1.1.2.cmml" xref="A1.SS3.2.p2.64.m64.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.64.m64.1.1.2.1.cmml" xref="A1.SS3.2.p2.64.m64.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.64.m64.1.1.2.2.cmml" xref="A1.SS3.2.p2.64.m64.1.1.2.2">𝒱</ci><ci id="A1.SS3.2.p2.64.m64.1.1.2.3.cmml" xref="A1.SS3.2.p2.64.m64.1.1.2.3">∈</ci></apply><ci id="A1.SS3.2.p2.64.m64.1.1.3.cmml" xref="A1.SS3.2.p2.64.m64.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.64.m64.1c">\mathbfcal{V}_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.64.m64.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∈ end_POSTSUPERSCRIPT</annotation></semantics></math> uses less flops than directly contracting <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.65.m65.1"><semantics id="A1.SS3.2.p2.65.m65.1a"><mi id="A1.SS3.2.p2.65.m65.1.1" mathvariant="normal" xref="A1.SS3.2.p2.65.m65.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.65.m65.1b"><ci id="A1.SS3.2.p2.65.m65.1.1.cmml" xref="A1.SS3.2.p2.65.m65.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.65.m65.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.65.m65.1d">roman_𝒳</annotation></semantics></math> with <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.66.m66.1"><semantics id="A1.SS3.2.p2.66.m66.1a"><msub id="A1.SS3.2.p2.66.m66.1.1" xref="A1.SS3.2.p2.66.m66.1.1.cmml"><mi id="A1.SS3.2.p2.66.m66.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.66.m66.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.66.m66.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.66.m66.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.66.m66.1b"><apply id="A1.SS3.2.p2.66.m66.1.1.cmml" xref="A1.SS3.2.p2.66.m66.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.66.m66.1.1.1.cmml" xref="A1.SS3.2.p2.66.m66.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.66.m66.1.1.2.cmml" xref="A1.SS3.2.p2.66.m66.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.66.m66.1.1.3.cmml" xref="A1.SS3.2.p2.66.m66.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.66.m66.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.66.m66.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{2}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.67.m67.1"><semantics id="A1.SS3.2.p2.67.m67.1a"><msub id="A1.SS3.2.p2.67.m67.1.1" xref="A1.SS3.2.p2.67.m67.1.1.cmml"><mi id="A1.SS3.2.p2.67.m67.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.67.m67.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.67.m67.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.67.m67.1.1.3.cmml">∈</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.67.m67.1b"><apply id="A1.SS3.2.p2.67.m67.1.1.cmml" xref="A1.SS3.2.p2.67.m67.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.67.m67.1.1.1.cmml" xref="A1.SS3.2.p2.67.m67.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.67.m67.1.1.2.cmml" xref="A1.SS3.2.p2.67.m67.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.67.m67.1.1.3.cmml" xref="A1.SS3.2.p2.67.m67.1.1.3">∈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.67.m67.1c">\mathbfcal{V}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.67.m67.1d">roman_𝒱 start_POSTSUBSCRIPT ∈ end_POSTSUBSCRIPT</annotation></semantics></math> directly when the batch size <math alttext="b" class="ltx_Math" display="inline" id="A1.SS3.2.p2.68.m68.1"><semantics id="A1.SS3.2.p2.68.m68.1a"><mi id="A1.SS3.2.p2.68.m68.1.1" xref="A1.SS3.2.p2.68.m68.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.68.m68.1b"><ci id="A1.SS3.2.p2.68.m68.1.1.cmml" xref="A1.SS3.2.p2.68.m68.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.68.m68.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.68.m68.1d">italic_b</annotation></semantics></math> is large. Summarizing everything above, we can conclude that <math alttext="\mathbfcal{V}_{1}" class="ltx_Math" display="inline" id="A1.SS3.2.p2.69.m69.1"><semantics id="A1.SS3.2.p2.69.m69.1a"><msub id="A1.SS3.2.p2.69.m69.1.1" xref="A1.SS3.2.p2.69.m69.1.1.cmml"><mi id="A1.SS3.2.p2.69.m69.1.1.2" mathvariant="normal" xref="A1.SS3.2.p2.69.m69.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.2.p2.69.m69.1.1.3" mathvariant="normal" xref="A1.SS3.2.p2.69.m69.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.2.p2.69.m69.1b"><apply id="A1.SS3.2.p2.69.m69.1.1.cmml" xref="A1.SS3.2.p2.69.m69.1.1"><csymbol cd="ambiguous" id="A1.SS3.2.p2.69.m69.1.1.1.cmml" xref="A1.SS3.2.p2.69.m69.1.1">subscript</csymbol><ci id="A1.SS3.2.p2.69.m69.1.1.2.cmml" xref="A1.SS3.2.p2.69.m69.1.1.2">𝒱</ci><ci id="A1.SS3.2.p2.69.m69.1.1.3.cmml" xref="A1.SS3.2.p2.69.m69.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.2.p2.69.m69.1c">\mathbfcal{V}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.2.p2.69.m69.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> must be in the proposed format.</p>
</div>
<div class="ltx_para" id="A1.SS3.3.p3">
<p class="ltx_p" id="A1.SS3.3.p3.7">The contraction of <math alttext="\mathbfcal{X}_{i}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.1.m1.1"><semantics id="A1.SS3.3.p3.1.m1.1a"><msub id="A1.SS3.3.p3.1.m1.1.1" xref="A1.SS3.3.p3.1.m1.1.1.cmml"><mi id="A1.SS3.3.p3.1.m1.1.1.2" mathvariant="normal" xref="A1.SS3.3.p3.1.m1.1.1.2.cmml">𝒳</mi><mi id="A1.SS3.3.p3.1.m1.1.1.3" mathvariant="normal" xref="A1.SS3.3.p3.1.m1.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.1.m1.1b"><apply id="A1.SS3.3.p3.1.m1.1.1.cmml" xref="A1.SS3.3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.3.p3.1.m1.1.1.1.cmml" xref="A1.SS3.3.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.3.p3.1.m1.1.1.2.cmml" xref="A1.SS3.3.p3.1.m1.1.1.2">𝒳</ci><ci id="A1.SS3.3.p3.1.m1.1.1.3.cmml" xref="A1.SS3.3.p3.1.m1.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.1.m1.1c">\mathbfcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.1.m1.1d">roman_𝒳 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{i+1},\ldots,\mathbfcal{V}_{k}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.2.m2.1"><semantics id="A1.SS3.3.p3.2.m2.1a"><mrow id="A1.SS3.3.p3.2.m2.1.1" xref="A1.SS3.3.p3.2.m2.1.1.cmml"><msub id="A1.SS3.3.p3.2.m2.1.1.2" xref="A1.SS3.3.p3.2.m2.1.1.2.cmml"><mi id="A1.SS3.3.p3.2.m2.1.1.2.2" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.2.2.cmml">𝒱</mi><mrow id="A1.SS3.3.p3.2.m2.1.1.2.3" xref="A1.SS3.3.p3.2.m2.1.1.2.3.cmml"><mi id="A1.SS3.3.p3.2.m2.1.1.2.3.2" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.2.3.2.cmml">⟩</mi><mo id="A1.SS3.3.p3.2.m2.1.1.2.3.1" xref="A1.SS3.3.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.2.m2.1.1.2.3.3" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.2.3.3.cmml">⇓</mi><mo id="A1.SS3.3.p3.2.m2.1.1.2.3.1a" xref="A1.SS3.3.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.2.m2.1.1.2.3.4" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.2.3.4.cmml">∞</mi></mrow></msub><mo id="A1.SS3.3.p3.2.m2.1.1.1" xref="A1.SS3.3.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.2.m2.1.1.3" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.3.cmml">⇔</mi><mo id="A1.SS3.3.p3.2.m2.1.1.1a" xref="A1.SS3.3.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.2.m2.1.1.4" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.4.cmml">…</mi><mo id="A1.SS3.3.p3.2.m2.1.1.1b" xref="A1.SS3.3.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.2.m2.1.1.5" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.5.cmml">⇔</mi><mo id="A1.SS3.3.p3.2.m2.1.1.1c" xref="A1.SS3.3.p3.2.m2.1.1.1.cmml">⁢</mo><msub id="A1.SS3.3.p3.2.m2.1.1.6" xref="A1.SS3.3.p3.2.m2.1.1.6.cmml"><mi id="A1.SS3.3.p3.2.m2.1.1.6.2" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.6.2.cmml">𝒱</mi><mi id="A1.SS3.3.p3.2.m2.1.1.6.3" mathvariant="normal" xref="A1.SS3.3.p3.2.m2.1.1.6.3.cmml">∥</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.2.m2.1b"><apply id="A1.SS3.3.p3.2.m2.1.1.cmml" xref="A1.SS3.3.p3.2.m2.1.1"><times id="A1.SS3.3.p3.2.m2.1.1.1.cmml" xref="A1.SS3.3.p3.2.m2.1.1.1"></times><apply id="A1.SS3.3.p3.2.m2.1.1.2.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.3.p3.2.m2.1.1.2.1.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS3.3.p3.2.m2.1.1.2.2.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.2">𝒱</ci><apply id="A1.SS3.3.p3.2.m2.1.1.2.3.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.3"><times id="A1.SS3.3.p3.2.m2.1.1.2.3.1.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.3.1"></times><ci id="A1.SS3.3.p3.2.m2.1.1.2.3.2.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.3.2">⟩</ci><ci id="A1.SS3.3.p3.2.m2.1.1.2.3.3.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.3.3">⇓</ci><ci id="A1.SS3.3.p3.2.m2.1.1.2.3.4.cmml" xref="A1.SS3.3.p3.2.m2.1.1.2.3.4">∞</ci></apply></apply><ci id="A1.SS3.3.p3.2.m2.1.1.3.cmml" xref="A1.SS3.3.p3.2.m2.1.1.3">⇔</ci><ci id="A1.SS3.3.p3.2.m2.1.1.4.cmml" xref="A1.SS3.3.p3.2.m2.1.1.4">…</ci><ci id="A1.SS3.3.p3.2.m2.1.1.5.cmml" xref="A1.SS3.3.p3.2.m2.1.1.5">⇔</ci><apply id="A1.SS3.3.p3.2.m2.1.1.6.cmml" xref="A1.SS3.3.p3.2.m2.1.1.6"><csymbol cd="ambiguous" id="A1.SS3.3.p3.2.m2.1.1.6.1.cmml" xref="A1.SS3.3.p3.2.m2.1.1.6">subscript</csymbol><ci id="A1.SS3.3.p3.2.m2.1.1.6.2.cmml" xref="A1.SS3.3.p3.2.m2.1.1.6.2">𝒱</ci><ci id="A1.SS3.3.p3.2.m2.1.1.6.3.cmml" xref="A1.SS3.3.p3.2.m2.1.1.6.3">∥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.2.m2.1c">\mathbfcal{V}_{i+1},\ldots,\mathbfcal{V}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.2.m2.1d">roman_𝒱 start_POSTSUBSCRIPT ⟩ ⇓ ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒱 start_POSTSUBSCRIPT ∥ end_POSTSUBSCRIPT</annotation></semantics></math> has the similar structure to the contraction of <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.3.m3.1"><semantics id="A1.SS3.3.p3.3.m3.1a"><mi id="A1.SS3.3.p3.3.m3.1.1" mathvariant="normal" xref="A1.SS3.3.p3.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.3.m3.1b"><ci id="A1.SS3.3.p3.3.m3.1.1.cmml" xref="A1.SS3.3.p3.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.3.m3.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.3.m3.1d">roman_𝒳</annotation></semantics></math> and <math alttext="\mathbfcal{V}_{1},\ldots,\mathbfcal{V}_{k}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.4.m4.1"><semantics id="A1.SS3.3.p3.4.m4.1a"><mrow id="A1.SS3.3.p3.4.m4.1.1" xref="A1.SS3.3.p3.4.m4.1.1.cmml"><msub id="A1.SS3.3.p3.4.m4.1.1.2" xref="A1.SS3.3.p3.4.m4.1.1.2.cmml"><mi id="A1.SS3.3.p3.4.m4.1.1.2.2" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.2.2.cmml">𝒱</mi><mi id="A1.SS3.3.p3.4.m4.1.1.2.3" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.2.3.cmml">∞</mi></msub><mo id="A1.SS3.3.p3.4.m4.1.1.1" xref="A1.SS3.3.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.4.m4.1.1.3" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.3.cmml">⇔</mi><mo id="A1.SS3.3.p3.4.m4.1.1.1a" xref="A1.SS3.3.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.4.m4.1.1.4" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.4.cmml">…</mi><mo id="A1.SS3.3.p3.4.m4.1.1.1b" xref="A1.SS3.3.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.4.m4.1.1.5" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.5.cmml">⇔</mi><mo id="A1.SS3.3.p3.4.m4.1.1.1c" xref="A1.SS3.3.p3.4.m4.1.1.1.cmml">⁢</mo><msub id="A1.SS3.3.p3.4.m4.1.1.6" xref="A1.SS3.3.p3.4.m4.1.1.6.cmml"><mi id="A1.SS3.3.p3.4.m4.1.1.6.2" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.6.2.cmml">𝒱</mi><mi id="A1.SS3.3.p3.4.m4.1.1.6.3" mathvariant="normal" xref="A1.SS3.3.p3.4.m4.1.1.6.3.cmml">∥</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.4.m4.1b"><apply id="A1.SS3.3.p3.4.m4.1.1.cmml" xref="A1.SS3.3.p3.4.m4.1.1"><times id="A1.SS3.3.p3.4.m4.1.1.1.cmml" xref="A1.SS3.3.p3.4.m4.1.1.1"></times><apply id="A1.SS3.3.p3.4.m4.1.1.2.cmml" xref="A1.SS3.3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.3.p3.4.m4.1.1.2.1.cmml" xref="A1.SS3.3.p3.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS3.3.p3.4.m4.1.1.2.2.cmml" xref="A1.SS3.3.p3.4.m4.1.1.2.2">𝒱</ci><ci id="A1.SS3.3.p3.4.m4.1.1.2.3.cmml" xref="A1.SS3.3.p3.4.m4.1.1.2.3">∞</ci></apply><ci id="A1.SS3.3.p3.4.m4.1.1.3.cmml" xref="A1.SS3.3.p3.4.m4.1.1.3">⇔</ci><ci id="A1.SS3.3.p3.4.m4.1.1.4.cmml" xref="A1.SS3.3.p3.4.m4.1.1.4">…</ci><ci id="A1.SS3.3.p3.4.m4.1.1.5.cmml" xref="A1.SS3.3.p3.4.m4.1.1.5">⇔</ci><apply id="A1.SS3.3.p3.4.m4.1.1.6.cmml" xref="A1.SS3.3.p3.4.m4.1.1.6"><csymbol cd="ambiguous" id="A1.SS3.3.p3.4.m4.1.1.6.1.cmml" xref="A1.SS3.3.p3.4.m4.1.1.6">subscript</csymbol><ci id="A1.SS3.3.p3.4.m4.1.1.6.2.cmml" xref="A1.SS3.3.p3.4.m4.1.1.6.2">𝒱</ci><ci id="A1.SS3.3.p3.4.m4.1.1.6.3.cmml" xref="A1.SS3.3.p3.4.m4.1.1.6.3">∥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.4.m4.1c">\mathbfcal{V}_{1},\ldots,\mathbfcal{V}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.4.m4.1d">roman_𝒱 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒱 start_POSTSUBSCRIPT ∥ end_POSTSUBSCRIPT</annotation></semantics></math>. By applying the same proof, we conclude that the tensors <math alttext="\mathbfcal{V}_{i}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.5.m5.1"><semantics id="A1.SS3.3.p3.5.m5.1a"><msub id="A1.SS3.3.p3.5.m5.1.1" xref="A1.SS3.3.p3.5.m5.1.1.cmml"><mi id="A1.SS3.3.p3.5.m5.1.1.2" mathvariant="normal" xref="A1.SS3.3.p3.5.m5.1.1.2.cmml">𝒱</mi><mi id="A1.SS3.3.p3.5.m5.1.1.3" mathvariant="normal" xref="A1.SS3.3.p3.5.m5.1.1.3.cmml">⟩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.5.m5.1b"><apply id="A1.SS3.3.p3.5.m5.1.1.cmml" xref="A1.SS3.3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.3.p3.5.m5.1.1.1.cmml" xref="A1.SS3.3.p3.5.m5.1.1">subscript</csymbol><ci id="A1.SS3.3.p3.5.m5.1.1.2.cmml" xref="A1.SS3.3.p3.5.m5.1.1.2">𝒱</ci><ci id="A1.SS3.3.p3.5.m5.1.1.3.cmml" xref="A1.SS3.3.p3.5.m5.1.1.3">⟩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.5.m5.1c">\mathbfcal{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.5.m5.1d">roman_𝒱 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT</annotation></semantics></math>’s must be in the format stated in the proposition and we will contract the input tensor <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.6.m6.1"><semantics id="A1.SS3.3.p3.6.m6.1a"><mi id="A1.SS3.3.p3.6.m6.1.1" mathvariant="normal" xref="A1.SS3.3.p3.6.m6.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.6.m6.1b"><ci id="A1.SS3.3.p3.6.m6.1.1.cmml" xref="A1.SS3.3.p3.6.m6.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.6.m6.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.6.m6.1d">roman_𝒳</annotation></semantics></math> with the tensors <math alttext="ten{V}_{1},\ldots,\mathbfcal{V}_{k}" class="ltx_Math" display="inline" id="A1.SS3.3.p3.7.m7.3"><semantics id="A1.SS3.3.p3.7.m7.3a"><mrow id="A1.SS3.3.p3.7.m7.3.3.2" xref="A1.SS3.3.p3.7.m7.3.3.3.cmml"><mrow id="A1.SS3.3.p3.7.m7.2.2.1.1" xref="A1.SS3.3.p3.7.m7.2.2.1.1.cmml"><mi id="A1.SS3.3.p3.7.m7.2.2.1.1.2" xref="A1.SS3.3.p3.7.m7.2.2.1.1.2.cmml">t</mi><mo id="A1.SS3.3.p3.7.m7.2.2.1.1.1" xref="A1.SS3.3.p3.7.m7.2.2.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.7.m7.2.2.1.1.3" xref="A1.SS3.3.p3.7.m7.2.2.1.1.3.cmml">e</mi><mo id="A1.SS3.3.p3.7.m7.2.2.1.1.1a" xref="A1.SS3.3.p3.7.m7.2.2.1.1.1.cmml">⁢</mo><mi id="A1.SS3.3.p3.7.m7.2.2.1.1.4" xref="A1.SS3.3.p3.7.m7.2.2.1.1.4.cmml">n</mi><mo id="A1.SS3.3.p3.7.m7.2.2.1.1.1b" xref="A1.SS3.3.p3.7.m7.2.2.1.1.1.cmml">⁢</mo><msub id="A1.SS3.3.p3.7.m7.2.2.1.1.5" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5.cmml"><mi id="A1.SS3.3.p3.7.m7.2.2.1.1.5.2" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5.2.cmml">V</mi><mn id="A1.SS3.3.p3.7.m7.2.2.1.1.5.3" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5.3.cmml">1</mn></msub></mrow><mo id="A1.SS3.3.p3.7.m7.3.3.2.3" xref="A1.SS3.3.p3.7.m7.3.3.3.cmml">,</mo><mi id="A1.SS3.3.p3.7.m7.1.1" mathvariant="normal" xref="A1.SS3.3.p3.7.m7.1.1.cmml">…</mi><mo id="A1.SS3.3.p3.7.m7.3.3.2.4" xref="A1.SS3.3.p3.7.m7.3.3.3.cmml">,</mo><msub id="A1.SS3.3.p3.7.m7.3.3.2.2" xref="A1.SS3.3.p3.7.m7.3.3.2.2.cmml"><mi id="A1.SS3.3.p3.7.m7.3.3.2.2.2" mathvariant="normal" xref="A1.SS3.3.p3.7.m7.3.3.2.2.2.cmml">𝒱</mi><mi id="A1.SS3.3.p3.7.m7.3.3.2.2.3" mathvariant="normal" xref="A1.SS3.3.p3.7.m7.3.3.2.2.3.cmml">∥</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.3.p3.7.m7.3b"><list id="A1.SS3.3.p3.7.m7.3.3.3.cmml" xref="A1.SS3.3.p3.7.m7.3.3.2"><apply id="A1.SS3.3.p3.7.m7.2.2.1.1.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1"><times id="A1.SS3.3.p3.7.m7.2.2.1.1.1.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.1"></times><ci id="A1.SS3.3.p3.7.m7.2.2.1.1.2.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.2">𝑡</ci><ci id="A1.SS3.3.p3.7.m7.2.2.1.1.3.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.3">𝑒</ci><ci id="A1.SS3.3.p3.7.m7.2.2.1.1.4.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.4">𝑛</ci><apply id="A1.SS3.3.p3.7.m7.2.2.1.1.5.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5"><csymbol cd="ambiguous" id="A1.SS3.3.p3.7.m7.2.2.1.1.5.1.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5">subscript</csymbol><ci id="A1.SS3.3.p3.7.m7.2.2.1.1.5.2.cmml" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5.2">𝑉</ci><cn id="A1.SS3.3.p3.7.m7.2.2.1.1.5.3.cmml" type="integer" xref="A1.SS3.3.p3.7.m7.2.2.1.1.5.3">1</cn></apply></apply><ci id="A1.SS3.3.p3.7.m7.1.1.cmml" xref="A1.SS3.3.p3.7.m7.1.1">…</ci><apply id="A1.SS3.3.p3.7.m7.3.3.2.2.cmml" xref="A1.SS3.3.p3.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS3.3.p3.7.m7.3.3.2.2.1.cmml" xref="A1.SS3.3.p3.7.m7.3.3.2.2">subscript</csymbol><ci id="A1.SS3.3.p3.7.m7.3.3.2.2.2.cmml" xref="A1.SS3.3.p3.7.m7.3.3.2.2.2">𝒱</ci><ci id="A1.SS3.3.p3.7.m7.3.3.2.2.3.cmml" xref="A1.SS3.3.p3.7.m7.3.3.2.2.3">∥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.3.p3.7.m7.3c">ten{V}_{1},\ldots,\mathbfcal{V}_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.3.p3.7.m7.3d">italic_t italic_e italic_n italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , roman_𝒱 start_POSTSUBSCRIPT ∥ end_POSTSUBSCRIPT</annotation></semantics></math> in the sequential order.
∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Algorithm for Contraction Path in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS2" title="4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.2</span></a>
</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">The empirical near-optimal contraction path for tensor-compressed training is in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg2" title="Algorithm 2 ‣ A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.7.1.1">Algorithm 2</span> </span> Empirical path for tensor-compressed forward- and back- propagation</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg2.3"><span class="ltx_text ltx_font_bold" id="alg2.3.1">Forward Input:</span> Tensor cores <math alttext="\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{2d}" class="ltx_Math" display="inline" id="alg2.1.m1.1"><semantics id="alg2.1.m1.1a"><mrow id="alg2.1.m1.1.1" xref="alg2.1.m1.1.1.cmml"><msub id="alg2.1.m1.1.1.2" xref="alg2.1.m1.1.1.2.cmml"><mi id="alg2.1.m1.1.1.2.2" mathvariant="normal" xref="alg2.1.m1.1.1.2.2.cmml">𝒢</mi><mi id="alg2.1.m1.1.1.2.3" mathvariant="normal" xref="alg2.1.m1.1.1.2.3.cmml">∞</mi></msub><mo id="alg2.1.m1.1.1.1" xref="alg2.1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.1.m1.1.1.3" mathvariant="normal" xref="alg2.1.m1.1.1.3.cmml">⇔</mi><mo id="alg2.1.m1.1.1.1a" xref="alg2.1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.1.m1.1.1.4" mathvariant="normal" xref="alg2.1.m1.1.1.4.cmml">…</mi><mo id="alg2.1.m1.1.1.1b" xref="alg2.1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.1.m1.1.1.5" mathvariant="normal" xref="alg2.1.m1.1.1.5.cmml">⇔</mi><mo id="alg2.1.m1.1.1.1c" xref="alg2.1.m1.1.1.1.cmml">⁢</mo><msub id="alg2.1.m1.1.1.6" xref="alg2.1.m1.1.1.6.cmml"><mi id="alg2.1.m1.1.1.6.2" mathvariant="normal" xref="alg2.1.m1.1.1.6.2.cmml">𝒢</mi><mrow id="alg2.1.m1.1.1.6.3" xref="alg2.1.m1.1.1.6.3.cmml"><mi id="alg2.1.m1.1.1.6.3.2" mathvariant="normal" xref="alg2.1.m1.1.1.6.3.2.cmml">∈</mi><mo id="alg2.1.m1.1.1.6.3.1" xref="alg2.1.m1.1.1.6.3.1.cmml">⁢</mo><mi id="alg2.1.m1.1.1.6.3.3" mathvariant="normal" xref="alg2.1.m1.1.1.6.3.3.cmml">⌈</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.m1.1b"><apply id="alg2.1.m1.1.1.cmml" xref="alg2.1.m1.1.1"><times id="alg2.1.m1.1.1.1.cmml" xref="alg2.1.m1.1.1.1"></times><apply id="alg2.1.m1.1.1.2.cmml" xref="alg2.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.1.m1.1.1.2.1.cmml" xref="alg2.1.m1.1.1.2">subscript</csymbol><ci id="alg2.1.m1.1.1.2.2.cmml" xref="alg2.1.m1.1.1.2.2">𝒢</ci><ci id="alg2.1.m1.1.1.2.3.cmml" xref="alg2.1.m1.1.1.2.3">∞</ci></apply><ci id="alg2.1.m1.1.1.3.cmml" xref="alg2.1.m1.1.1.3">⇔</ci><ci id="alg2.1.m1.1.1.4.cmml" xref="alg2.1.m1.1.1.4">…</ci><ci id="alg2.1.m1.1.1.5.cmml" xref="alg2.1.m1.1.1.5">⇔</ci><apply id="alg2.1.m1.1.1.6.cmml" xref="alg2.1.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.1.m1.1.1.6.1.cmml" xref="alg2.1.m1.1.1.6">subscript</csymbol><ci id="alg2.1.m1.1.1.6.2.cmml" xref="alg2.1.m1.1.1.6.2">𝒢</ci><apply id="alg2.1.m1.1.1.6.3.cmml" xref="alg2.1.m1.1.1.6.3"><times id="alg2.1.m1.1.1.6.3.1.cmml" xref="alg2.1.m1.1.1.6.3.1"></times><ci id="alg2.1.m1.1.1.6.3.2.cmml" xref="alg2.1.m1.1.1.6.3.2">∈</ci><ci id="alg2.1.m1.1.1.6.3.3.cmml" xref="alg2.1.m1.1.1.6.3.3">⌈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.1c">\mathbfcal{G}_{1},\ldots,\mathbfcal{G}_{2d}</annotation><annotation encoding="application/x-llamapun" id="alg2.1.m1.1d">roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT ⇔ … ⇔ roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT</annotation></semantics></math> and input matrix <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="alg2.2.m2.1"><semantics id="alg2.2.m2.1a"><mi id="alg2.2.m2.1.1" xref="alg2.2.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m2.1b"><ci id="alg2.2.m2.1.1.cmml" xref="alg2.2.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m2.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m2.1d">bold_X</annotation></semantics></math>.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="alg2.3.2">Forward Output:</span> Output matrix <math alttext="\mathbf{Y}" class="ltx_Math" display="inline" id="alg2.3.m3.1"><semantics id="alg2.3.m3.1a"><mi id="alg2.3.m3.1.1" xref="alg2.3.m3.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="alg2.3.m3.1b"><ci id="alg2.3.m3.1.1.cmml" xref="alg2.3.m3.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m3.1c">\mathbf{Y}</annotation><annotation encoding="application/x-llamapun" id="alg2.3.m3.1d">bold_Y</annotation></semantics></math>, and intermediate results.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg2.8">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>Reshape the matrix <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">bold_X</annotation></semantics></math> to the tensor <math alttext="\mathbfcal{X}" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" mathvariant="normal" xref="alg2.l1.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\mathbfcal{X}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">roman_𝒳</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>Compute <math alttext="\mathbfcal{A}_{d},\mathbfcal{A}_{-d},\mathbfcal{B}_{d},\mathbfcal{B}_{-d}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><msub id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml"><mi id="alg2.l2.m1.1.1.2.2" mathvariant="normal" xref="alg2.l2.m1.1.1.2.2.cmml">𝒜</mi><mi id="alg2.l2.m1.1.1.2.3" mathvariant="normal" xref="alg2.l2.m1.1.1.2.3.cmml">⌈</mi></msub><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.3" mathvariant="normal" xref="alg2.l2.m1.1.1.3.cmml">⇔</mi><mo id="alg2.l2.m1.1.1.1a" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m1.1.1.4" xref="alg2.l2.m1.1.1.4.cmml"><mi id="alg2.l2.m1.1.1.4.2" mathvariant="normal" xref="alg2.l2.m1.1.1.4.2.cmml">𝒜</mi><mrow id="alg2.l2.m1.1.1.4.3" xref="alg2.l2.m1.1.1.4.3.cmml"><mi id="alg2.l2.m1.1.1.4.3.2" mathvariant="normal" xref="alg2.l2.m1.1.1.4.3.2.cmml">↖</mi><mo id="alg2.l2.m1.1.1.4.3.1" xref="alg2.l2.m1.1.1.4.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.4.3.3" mathvariant="normal" xref="alg2.l2.m1.1.1.4.3.3.cmml">⌈</mi></mrow></msub><mo id="alg2.l2.m1.1.1.1b" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.5" mathvariant="normal" xref="alg2.l2.m1.1.1.5.cmml">⇔</mi><mo id="alg2.l2.m1.1.1.1c" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m1.1.1.6" xref="alg2.l2.m1.1.1.6.cmml"><mi id="alg2.l2.m1.1.1.6.2" mathvariant="normal" xref="alg2.l2.m1.1.1.6.2.cmml">ℬ</mi><mi id="alg2.l2.m1.1.1.6.3" mathvariant="normal" xref="alg2.l2.m1.1.1.6.3.cmml">⌈</mi></msub><mo id="alg2.l2.m1.1.1.1d" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.7" mathvariant="normal" xref="alg2.l2.m1.1.1.7.cmml">⇔</mi><mo id="alg2.l2.m1.1.1.1e" xref="alg2.l2.m1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m1.1.1.8" xref="alg2.l2.m1.1.1.8.cmml"><mi id="alg2.l2.m1.1.1.8.2" mathvariant="normal" xref="alg2.l2.m1.1.1.8.2.cmml">ℬ</mi><mrow id="alg2.l2.m1.1.1.8.3" xref="alg2.l2.m1.1.1.8.3.cmml"><mi id="alg2.l2.m1.1.1.8.3.2" mathvariant="normal" xref="alg2.l2.m1.1.1.8.3.2.cmml">↖</mi><mo id="alg2.l2.m1.1.1.8.3.1" xref="alg2.l2.m1.1.1.8.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.8.3.3" mathvariant="normal" xref="alg2.l2.m1.1.1.8.3.3.cmml">⌈</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><times id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></times><apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">𝒜</ci><ci id="alg2.l2.m1.1.1.2.3.cmml" xref="alg2.l2.m1.1.1.2.3">⌈</ci></apply><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">⇔</ci><apply id="alg2.l2.m1.1.1.4.cmml" xref="alg2.l2.m1.1.1.4"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.4.1.cmml" xref="alg2.l2.m1.1.1.4">subscript</csymbol><ci id="alg2.l2.m1.1.1.4.2.cmml" xref="alg2.l2.m1.1.1.4.2">𝒜</ci><apply id="alg2.l2.m1.1.1.4.3.cmml" xref="alg2.l2.m1.1.1.4.3"><times id="alg2.l2.m1.1.1.4.3.1.cmml" xref="alg2.l2.m1.1.1.4.3.1"></times><ci id="alg2.l2.m1.1.1.4.3.2.cmml" xref="alg2.l2.m1.1.1.4.3.2">↖</ci><ci id="alg2.l2.m1.1.1.4.3.3.cmml" xref="alg2.l2.m1.1.1.4.3.3">⌈</ci></apply></apply><ci id="alg2.l2.m1.1.1.5.cmml" xref="alg2.l2.m1.1.1.5">⇔</ci><apply id="alg2.l2.m1.1.1.6.cmml" xref="alg2.l2.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.6.1.cmml" xref="alg2.l2.m1.1.1.6">subscript</csymbol><ci id="alg2.l2.m1.1.1.6.2.cmml" xref="alg2.l2.m1.1.1.6.2">ℬ</ci><ci id="alg2.l2.m1.1.1.6.3.cmml" xref="alg2.l2.m1.1.1.6.3">⌈</ci></apply><ci id="alg2.l2.m1.1.1.7.cmml" xref="alg2.l2.m1.1.1.7">⇔</ci><apply id="alg2.l2.m1.1.1.8.cmml" xref="alg2.l2.m1.1.1.8"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.8.1.cmml" xref="alg2.l2.m1.1.1.8">subscript</csymbol><ci id="alg2.l2.m1.1.1.8.2.cmml" xref="alg2.l2.m1.1.1.8.2">ℬ</ci><apply id="alg2.l2.m1.1.1.8.3.cmml" xref="alg2.l2.m1.1.1.8.3"><times id="alg2.l2.m1.1.1.8.3.1.cmml" xref="alg2.l2.m1.1.1.8.3.1"></times><ci id="alg2.l2.m1.1.1.8.3.2.cmml" xref="alg2.l2.m1.1.1.8.3.2">↖</ci><ci id="alg2.l2.m1.1.1.8.3.3.cmml" xref="alg2.l2.m1.1.1.8.3.3">⌈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\mathbfcal{A}_{d},\mathbfcal{A}_{-d},\mathbfcal{B}_{d},\mathbfcal{B}_{-d}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">roman_𝒜 start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ↖ ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⌈ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ↖ ⌈ end_POSTSUBSCRIPT</annotation></semantics></math> in the sequential order and store intermediate results of <math alttext="\{\mathbfcal{A}_{i},\mathbfcal{A}_{-i},\mathbfcal{B}_{i},\mathbfcal{B}_{-i}\}_%
{i=1}^{d}" class="ltx_Math" display="inline" id="alg2.l2.m2.1"><semantics id="alg2.l2.m2.1a"><msubsup id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mrow id="alg2.l2.m2.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.2.cmml"><mo id="alg2.l2.m2.1.1.1.1.1.2" stretchy="false" xref="alg2.l2.m2.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l2.m2.1.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.1.cmml"><msub id="alg2.l2.m2.1.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.1.1.2.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.2.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.2.2.cmml">𝒜</mi><mi id="alg2.l2.m2.1.1.1.1.1.1.2.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.2.3.cmml">⟩</mi></msub><mo id="alg2.l2.m2.1.1.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.1.1.1.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.3.cmml">⇔</mi><mo id="alg2.l2.m2.1.1.1.1.1.1.1a" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m2.1.1.1.1.1.1.4" xref="alg2.l2.m2.1.1.1.1.1.1.4.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.4.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.4.2.cmml">𝒜</mi><mrow id="alg2.l2.m2.1.1.1.1.1.1.4.3" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.4.3.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.2.cmml">↖</mi><mo id="alg2.l2.m2.1.1.1.1.1.1.4.3.1" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.1.1.1.4.3.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.3.cmml">⟩</mi></mrow></msub><mo id="alg2.l2.m2.1.1.1.1.1.1.1b" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.1.1.1.5" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.5.cmml">⇔</mi><mo id="alg2.l2.m2.1.1.1.1.1.1.1c" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m2.1.1.1.1.1.1.6" xref="alg2.l2.m2.1.1.1.1.1.1.6.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.6.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.6.2.cmml">ℬ</mi><mi id="alg2.l2.m2.1.1.1.1.1.1.6.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.6.3.cmml">⟩</mi></msub><mo id="alg2.l2.m2.1.1.1.1.1.1.1d" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.1.1.1.7" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.7.cmml">⇔</mi><mo id="alg2.l2.m2.1.1.1.1.1.1.1e" xref="alg2.l2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg2.l2.m2.1.1.1.1.1.1.8" xref="alg2.l2.m2.1.1.1.1.1.1.8.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.8.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.8.2.cmml">ℬ</mi><mrow id="alg2.l2.m2.1.1.1.1.1.1.8.3" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.8.3.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.2.cmml">↖</mi><mo id="alg2.l2.m2.1.1.1.1.1.1.8.3.1" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.1.1.1.8.3.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.3.cmml">⟩</mi></mrow></msub></mrow><mo id="alg2.l2.m2.1.1.1.1.1.3" stretchy="false" xref="alg2.l2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m2.1.1.1.3" xref="alg2.l2.m2.1.1.1.3.cmml"><mi id="alg2.l2.m2.1.1.1.3.2" mathvariant="normal" xref="alg2.l2.m2.1.1.1.3.2.cmml">⟩</mi><mo id="alg2.l2.m2.1.1.1.3.1" xref="alg2.l2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.3.3" mathvariant="normal" xref="alg2.l2.m2.1.1.1.3.3.cmml">ℑ</mi><mo id="alg2.l2.m2.1.1.1.3.1a" xref="alg2.l2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l2.m2.1.1.1.3.4" mathvariant="normal" xref="alg2.l2.m2.1.1.1.3.4.cmml">∞</mi></mrow><mi id="alg2.l2.m2.1.1.3" mathvariant="normal" xref="alg2.l2.m2.1.1.3.cmml">⌈</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1">superscript</csymbol><apply id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.2.cmml" xref="alg2.l2.m2.1.1">subscript</csymbol><set id="alg2.l2.m2.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1"><apply id="alg2.l2.m2.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1"><times id="alg2.l2.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.1"></times><apply id="alg2.l2.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.2.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.2.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2.2">𝒜</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.2.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2.3">⟩</ci></apply><ci id="alg2.l2.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.3">⇔</ci><apply id="alg2.l2.m2.1.1.1.1.1.1.4.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.4.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.4.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4.2">𝒜</ci><apply id="alg2.l2.m2.1.1.1.1.1.1.4.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4.3"><times id="alg2.l2.m2.1.1.1.1.1.1.4.3.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.1"></times><ci id="alg2.l2.m2.1.1.1.1.1.1.4.3.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.2">↖</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.4.3.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.4.3.3">⟩</ci></apply></apply><ci id="alg2.l2.m2.1.1.1.1.1.1.5.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.5">⇔</ci><apply id="alg2.l2.m2.1.1.1.1.1.1.6.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.6.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.6">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.6.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.6.2">ℬ</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.6.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.6.3">⟩</ci></apply><ci id="alg2.l2.m2.1.1.1.1.1.1.7.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.7">⇔</ci><apply id="alg2.l2.m2.1.1.1.1.1.1.8.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.8.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.8.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8.2">ℬ</ci><apply id="alg2.l2.m2.1.1.1.1.1.1.8.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8.3"><times id="alg2.l2.m2.1.1.1.1.1.1.8.3.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.1"></times><ci id="alg2.l2.m2.1.1.1.1.1.1.8.3.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.2">↖</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.8.3.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.8.3.3">⟩</ci></apply></apply></apply></set><apply id="alg2.l2.m2.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.3"><times id="alg2.l2.m2.1.1.1.3.1.cmml" xref="alg2.l2.m2.1.1.1.3.1"></times><ci id="alg2.l2.m2.1.1.1.3.2.cmml" xref="alg2.l2.m2.1.1.1.3.2">⟩</ci><ci id="alg2.l2.m2.1.1.1.3.3.cmml" xref="alg2.l2.m2.1.1.1.3.3">ℑ</ci><ci id="alg2.l2.m2.1.1.1.3.4.cmml" xref="alg2.l2.m2.1.1.1.3.4">∞</ci></apply></apply><ci id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">⌈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\{\mathbfcal{A}_{i},\mathbfcal{A}_{-i},\mathbfcal{B}_{i},\mathbfcal{B}_{-i}\}_%
{i=1}^{d}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m2.1d">{ roman_𝒜 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ⇔ roman_𝒜 start_POSTSUBSCRIPT ↖ ⟩ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT ⇔ roman_ℬ start_POSTSUBSCRIPT ↖ ⟩ end_POSTSUBSCRIPT } start_POSTSUBSCRIPT ⟩ roman_ℑ ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⌈ end_POSTSUPERSCRIPT</annotation></semantics></math> for back-propagation.

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>Compute <math alttext="\mathbfcal{T}_{1}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><msub id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" mathvariant="normal" xref="alg2.l3.m1.1.1.2.cmml">𝒯</mi><mi id="alg2.l3.m1.1.1.3" mathvariant="normal" xref="alg2.l3.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝒯</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\mathbfcal{T}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">roman_𝒯 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E22" title="In Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">22</span></a>) to store it for back-propagation.

</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>Compute <math alttext="\mathbfcal{Y}" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" mathvariant="normal" xref="alg2.l4.m1.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathbfcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">roman_𝒴</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E23" title="In Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">23</span></a>) and reshape it to the appropriate matrix <math alttext="\mathbf{Y}" class="ltx_Math" display="inline" id="alg2.l4.m2.1"><semantics id="alg2.l4.m2.1a"><mi id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><ci id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\mathbf{Y}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.1d">bold_Y</annotation></semantics></math>.

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg2.5"><span class="ltx_text ltx_font_bold" id="alg2.5.1">Backward Input:</span> Inputs of <span class="ltx_text ltx_font_bold" id="alg2.5.2">Forward</span>, stored results from <span class="ltx_text ltx_font_bold" id="alg2.5.3">Forward</span>, and output gradient <math alttext="\mathbf{g}_{\mathbf{Y}}" class="ltx_Math" display="inline" id="alg2.4.m1.1"><semantics id="alg2.4.m1.1a"><msub id="alg2.4.m1.1.1" xref="alg2.4.m1.1.1.cmml"><mi id="alg2.4.m1.1.1.2" xref="alg2.4.m1.1.1.2.cmml">𝐠</mi><mi id="alg2.4.m1.1.1.3" xref="alg2.4.m1.1.1.3.cmml">𝐘</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.4.m1.1b"><apply id="alg2.4.m1.1.1.cmml" xref="alg2.4.m1.1.1"><csymbol cd="ambiguous" id="alg2.4.m1.1.1.1.cmml" xref="alg2.4.m1.1.1">subscript</csymbol><ci id="alg2.4.m1.1.1.2.cmml" xref="alg2.4.m1.1.1.2">𝐠</ci><ci id="alg2.4.m1.1.1.3.cmml" xref="alg2.4.m1.1.1.3">𝐘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m1.1c">\mathbf{g}_{\mathbf{Y}}</annotation><annotation encoding="application/x-llamapun" id="alg2.4.m1.1d">bold_g start_POSTSUBSCRIPT bold_Y end_POSTSUBSCRIPT</annotation></semantics></math>.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="alg2.5.4">Backward Output:</span> Gradients <math alttext="\mathbf{g}_{\mathbf{X}},\mathbf{g}_{\mathbfcal{G}_{1}},\ldots,\mathbf{g}_{%
\mathbfcal{G}_{2d}}" class="ltx_Math" display="inline" id="alg2.5.m2.4"><semantics id="alg2.5.m2.4a"><mrow id="alg2.5.m2.4.4.3" xref="alg2.5.m2.4.4.4.cmml"><msub id="alg2.5.m2.2.2.1.1" xref="alg2.5.m2.2.2.1.1.cmml"><mi id="alg2.5.m2.2.2.1.1.2" xref="alg2.5.m2.2.2.1.1.2.cmml">𝐠</mi><mi id="alg2.5.m2.2.2.1.1.3" xref="alg2.5.m2.2.2.1.1.3.cmml">𝐗</mi></msub><mo id="alg2.5.m2.4.4.3.4" xref="alg2.5.m2.4.4.4.cmml">,</mo><msub id="alg2.5.m2.3.3.2.2" xref="alg2.5.m2.3.3.2.2.cmml"><mi id="alg2.5.m2.3.3.2.2.2" xref="alg2.5.m2.3.3.2.2.2.cmml">𝐠</mi><msub id="alg2.5.m2.3.3.2.2.3" xref="alg2.5.m2.3.3.2.2.3.cmml"><mi id="alg2.5.m2.3.3.2.2.3.2" mathvariant="normal" xref="alg2.5.m2.3.3.2.2.3.2.cmml">𝒢</mi><mi id="alg2.5.m2.3.3.2.2.3.3" mathvariant="normal" xref="alg2.5.m2.3.3.2.2.3.3.cmml">∞</mi></msub></msub><mo id="alg2.5.m2.4.4.3.5" xref="alg2.5.m2.4.4.4.cmml">,</mo><mi id="alg2.5.m2.1.1" mathvariant="normal" xref="alg2.5.m2.1.1.cmml">…</mi><mo id="alg2.5.m2.4.4.3.6" xref="alg2.5.m2.4.4.4.cmml">,</mo><msub id="alg2.5.m2.4.4.3.3" xref="alg2.5.m2.4.4.3.3.cmml"><mi id="alg2.5.m2.4.4.3.3.2" xref="alg2.5.m2.4.4.3.3.2.cmml">𝐠</mi><msub id="alg2.5.m2.4.4.3.3.3" xref="alg2.5.m2.4.4.3.3.3.cmml"><mi id="alg2.5.m2.4.4.3.3.3.2" mathvariant="normal" xref="alg2.5.m2.4.4.3.3.3.2.cmml">𝒢</mi><mrow id="alg2.5.m2.4.4.3.3.3.3" xref="alg2.5.m2.4.4.3.3.3.3.cmml"><mi id="alg2.5.m2.4.4.3.3.3.3.2" mathvariant="normal" xref="alg2.5.m2.4.4.3.3.3.3.2.cmml">∈</mi><mo id="alg2.5.m2.4.4.3.3.3.3.1" xref="alg2.5.m2.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.5.m2.4.4.3.3.3.3.3" mathvariant="normal" xref="alg2.5.m2.4.4.3.3.3.3.3.cmml">⌈</mi></mrow></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.m2.4b"><list id="alg2.5.m2.4.4.4.cmml" xref="alg2.5.m2.4.4.3"><apply id="alg2.5.m2.2.2.1.1.cmml" xref="alg2.5.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.5.m2.2.2.1.1.1.cmml" xref="alg2.5.m2.2.2.1.1">subscript</csymbol><ci id="alg2.5.m2.2.2.1.1.2.cmml" xref="alg2.5.m2.2.2.1.1.2">𝐠</ci><ci id="alg2.5.m2.2.2.1.1.3.cmml" xref="alg2.5.m2.2.2.1.1.3">𝐗</ci></apply><apply id="alg2.5.m2.3.3.2.2.cmml" xref="alg2.5.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg2.5.m2.3.3.2.2.1.cmml" xref="alg2.5.m2.3.3.2.2">subscript</csymbol><ci id="alg2.5.m2.3.3.2.2.2.cmml" xref="alg2.5.m2.3.3.2.2.2">𝐠</ci><apply id="alg2.5.m2.3.3.2.2.3.cmml" xref="alg2.5.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg2.5.m2.3.3.2.2.3.1.cmml" xref="alg2.5.m2.3.3.2.2.3">subscript</csymbol><ci id="alg2.5.m2.3.3.2.2.3.2.cmml" xref="alg2.5.m2.3.3.2.2.3.2">𝒢</ci><ci id="alg2.5.m2.3.3.2.2.3.3.cmml" xref="alg2.5.m2.3.3.2.2.3.3">∞</ci></apply></apply><ci id="alg2.5.m2.1.1.cmml" xref="alg2.5.m2.1.1">…</ci><apply id="alg2.5.m2.4.4.3.3.cmml" xref="alg2.5.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg2.5.m2.4.4.3.3.1.cmml" xref="alg2.5.m2.4.4.3.3">subscript</csymbol><ci id="alg2.5.m2.4.4.3.3.2.cmml" xref="alg2.5.m2.4.4.3.3.2">𝐠</ci><apply id="alg2.5.m2.4.4.3.3.3.cmml" xref="alg2.5.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.5.m2.4.4.3.3.3.1.cmml" xref="alg2.5.m2.4.4.3.3.3">subscript</csymbol><ci id="alg2.5.m2.4.4.3.3.3.2.cmml" xref="alg2.5.m2.4.4.3.3.3.2">𝒢</ci><apply id="alg2.5.m2.4.4.3.3.3.3.cmml" xref="alg2.5.m2.4.4.3.3.3.3"><times id="alg2.5.m2.4.4.3.3.3.3.1.cmml" xref="alg2.5.m2.4.4.3.3.3.3.1"></times><ci id="alg2.5.m2.4.4.3.3.3.3.2.cmml" xref="alg2.5.m2.4.4.3.3.3.3.2">∈</ci><ci id="alg2.5.m2.4.4.3.3.3.3.3.cmml" xref="alg2.5.m2.4.4.3.3.3.3.3">⌈</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m2.4c">\mathbf{g}_{\mathbf{X}},\mathbf{g}_{\mathbfcal{G}_{1}},\ldots,\mathbf{g}_{%
\mathbfcal{G}_{2d}}</annotation><annotation encoding="application/x-llamapun" id="alg2.5.m2.4d">bold_g start_POSTSUBSCRIPT bold_X end_POSTSUBSCRIPT , bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ∈ ⌈ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_listing" id="alg2.9">
<div class="ltx_listingline" id="alg2.l1a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1a.1.1.1" style="font-size:80%;">1:</span></span>Reshape the gradient <math alttext="\mathbf{g}_{\mathbf{Y}}" class="ltx_Math" display="inline" id="alg2.l1a.m1.1"><semantics id="alg2.l1a.m1.1a"><msub id="alg2.l1a.m1.1.1" xref="alg2.l1a.m1.1.1.cmml"><mi id="alg2.l1a.m1.1.1.2" xref="alg2.l1a.m1.1.1.2.cmml">𝐠</mi><mi id="alg2.l1a.m1.1.1.3" xref="alg2.l1a.m1.1.1.3.cmml">𝐘</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1a.m1.1b"><apply id="alg2.l1a.m1.1.1.cmml" xref="alg2.l1a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1a.m1.1.1.1.cmml" xref="alg2.l1a.m1.1.1">subscript</csymbol><ci id="alg2.l1a.m1.1.1.2.cmml" xref="alg2.l1a.m1.1.1.2">𝐠</ci><ci id="alg2.l1a.m1.1.1.3.cmml" xref="alg2.l1a.m1.1.1.3">𝐘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1a.m1.1c">\mathbf{g}_{\mathbf{Y}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1a.m1.1d">bold_g start_POSTSUBSCRIPT bold_Y end_POSTSUBSCRIPT</annotation></semantics></math> to the tensor <math alttext="\mathbf{g}_{\mathbfcal{Y}}" class="ltx_Math" display="inline" id="alg2.l1a.m2.1"><semantics id="alg2.l1a.m2.1a"><msub id="alg2.l1a.m2.1.1" xref="alg2.l1a.m2.1.1.cmml"><mi id="alg2.l1a.m2.1.1.2" xref="alg2.l1a.m2.1.1.2.cmml">𝐠</mi><mi id="alg2.l1a.m2.1.1.3" mathvariant="normal" xref="alg2.l1a.m2.1.1.3.cmml">𝒴</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1a.m2.1b"><apply id="alg2.l1a.m2.1.1.cmml" xref="alg2.l1a.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1a.m2.1.1.1.cmml" xref="alg2.l1a.m2.1.1">subscript</csymbol><ci id="alg2.l1a.m2.1.1.2.cmml" xref="alg2.l1a.m2.1.1.2">𝐠</ci><ci id="alg2.l1a.m2.1.1.3.cmml" xref="alg2.l1a.m2.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1a.m2.1c">\mathbf{g}_{\mathbfcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1a.m2.1d">bold_g start_POSTSUBSCRIPT roman_𝒴 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2a.1.1.1" style="font-size:80%;">2:</span></span>Compute <math alttext="\mathbfcal{U}_{1}" class="ltx_Math" display="inline" id="alg2.l2a.m1.1"><semantics id="alg2.l2a.m1.1a"><msub id="alg2.l2a.m1.1.1" xref="alg2.l2a.m1.1.1.cmml"><mi id="alg2.l2a.m1.1.1.2" mathvariant="normal" xref="alg2.l2a.m1.1.1.2.cmml">𝒰</mi><mi id="alg2.l2a.m1.1.1.3" mathvariant="normal" xref="alg2.l2a.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l2a.m1.1b"><apply id="alg2.l2a.m1.1.1.cmml" xref="alg2.l2a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2a.m1.1.1.1.cmml" xref="alg2.l2a.m1.1.1">subscript</csymbol><ci id="alg2.l2a.m1.1.1.2.cmml" xref="alg2.l2a.m1.1.1.2">𝒰</ci><ci id="alg2.l2a.m1.1.1.3.cmml" xref="alg2.l2a.m1.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2a.m1.1c">\mathbfcal{U}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2a.m1.1d">roman_𝒰 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{g}_{\mathbfcal{X}}" class="ltx_Math" display="inline" id="alg2.l2a.m2.1"><semantics id="alg2.l2a.m2.1a"><msub id="alg2.l2a.m2.1.1" xref="alg2.l2a.m2.1.1.cmml"><mi id="alg2.l2a.m2.1.1.2" xref="alg2.l2a.m2.1.1.2.cmml">𝐠</mi><mi id="alg2.l2a.m2.1.1.3" mathvariant="normal" xref="alg2.l2a.m2.1.1.3.cmml">𝒳</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l2a.m2.1b"><apply id="alg2.l2a.m2.1.1.cmml" xref="alg2.l2a.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2a.m2.1.1.1.cmml" xref="alg2.l2a.m2.1.1">subscript</csymbol><ci id="alg2.l2a.m2.1.1.2.cmml" xref="alg2.l2a.m2.1.1.2">𝐠</ci><ci id="alg2.l2a.m2.1.1.3.cmml" xref="alg2.l2a.m2.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2a.m2.1c">\mathbf{g}_{\mathbfcal{X}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2a.m2.1d">bold_g start_POSTSUBSCRIPT roman_𝒳 end_POSTSUBSCRIPT</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E24" title="In 1st item ‣ Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">24</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E25" title="In 1st item ‣ Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">25</span></a>) and store <math alttext="\mathbfcal{U}_{1}" class="ltx_Math" display="inline" id="alg2.l2a.m3.1"><semantics id="alg2.l2a.m3.1a"><msub id="alg2.l2a.m3.1.1" xref="alg2.l2a.m3.1.1.cmml"><mi id="alg2.l2a.m3.1.1.2" mathvariant="normal" xref="alg2.l2a.m3.1.1.2.cmml">𝒰</mi><mi id="alg2.l2a.m3.1.1.3" mathvariant="normal" xref="alg2.l2a.m3.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l2a.m3.1b"><apply id="alg2.l2a.m3.1.1.cmml" xref="alg2.l2a.m3.1.1"><csymbol cd="ambiguous" id="alg2.l2a.m3.1.1.1.cmml" xref="alg2.l2a.m3.1.1">subscript</csymbol><ci id="alg2.l2a.m3.1.1.2.cmml" xref="alg2.l2a.m3.1.1.2">𝒰</ci><ci id="alg2.l2a.m3.1.1.3.cmml" xref="alg2.l2a.m3.1.1.3">∞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2a.m3.1c">\mathbfcal{U}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2a.m3.1d">roman_𝒰 start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math> for future use.

</div>
<div class="ltx_listingline" id="alg2.l3a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3a.1.1.1" style="font-size:80%;">3:</span></span>Compute <math alttext="\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="alg2.l3a.m1.1"><semantics id="alg2.l3a.m1.1a"><msub id="alg2.l3a.m1.1.1" xref="alg2.l3a.m1.1.1.cmml"><mi id="alg2.l3a.m1.1.1.2" xref="alg2.l3a.m1.1.1.2.cmml">𝐠</mi><msub id="alg2.l3a.m1.1.1.3" xref="alg2.l3a.m1.1.1.3.cmml"><mi id="alg2.l3a.m1.1.1.3.2" mathvariant="normal" xref="alg2.l3a.m1.1.1.3.2.cmml">𝒢</mi><mi id="alg2.l3a.m1.1.1.3.3" mathvariant="normal" xref="alg2.l3a.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l3a.m1.1b"><apply id="alg2.l3a.m1.1.1.cmml" xref="alg2.l3a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3a.m1.1.1.1.cmml" xref="alg2.l3a.m1.1.1">subscript</csymbol><ci id="alg2.l3a.m1.1.1.2.cmml" xref="alg2.l3a.m1.1.1.2">𝐠</ci><apply id="alg2.l3a.m1.1.1.3.cmml" xref="alg2.l3a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.1.1.3.1.cmml" xref="alg2.l3a.m1.1.1.3">subscript</csymbol><ci id="alg2.l3a.m1.1.1.3.2.cmml" xref="alg2.l3a.m1.1.1.3.2">𝒢</ci><ci id="alg2.l3a.m1.1.1.3.3.cmml" xref="alg2.l3a.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3a.m1.1c">\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3a.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="i\geq d+1" class="ltx_Math" display="inline" id="alg2.l3a.m2.1"><semantics id="alg2.l3a.m2.1a"><mrow id="alg2.l3a.m2.1.1" xref="alg2.l3a.m2.1.1.cmml"><mi id="alg2.l3a.m2.1.1.2" xref="alg2.l3a.m2.1.1.2.cmml">i</mi><mo id="alg2.l3a.m2.1.1.1" xref="alg2.l3a.m2.1.1.1.cmml">≥</mo><mrow id="alg2.l3a.m2.1.1.3" xref="alg2.l3a.m2.1.1.3.cmml"><mi id="alg2.l3a.m2.1.1.3.2" xref="alg2.l3a.m2.1.1.3.2.cmml">d</mi><mo id="alg2.l3a.m2.1.1.3.1" xref="alg2.l3a.m2.1.1.3.1.cmml">+</mo><mn id="alg2.l3a.m2.1.1.3.3" xref="alg2.l3a.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3a.m2.1b"><apply id="alg2.l3a.m2.1.1.cmml" xref="alg2.l3a.m2.1.1"><geq id="alg2.l3a.m2.1.1.1.cmml" xref="alg2.l3a.m2.1.1.1"></geq><ci id="alg2.l3a.m2.1.1.2.cmml" xref="alg2.l3a.m2.1.1.2">𝑖</ci><apply id="alg2.l3a.m2.1.1.3.cmml" xref="alg2.l3a.m2.1.1.3"><plus id="alg2.l3a.m2.1.1.3.1.cmml" xref="alg2.l3a.m2.1.1.3.1"></plus><ci id="alg2.l3a.m2.1.1.3.2.cmml" xref="alg2.l3a.m2.1.1.3.2">𝑑</ci><cn id="alg2.l3a.m2.1.1.3.3.cmml" type="integer" xref="alg2.l3a.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3a.m2.1c">i\geq d+1</annotation><annotation encoding="application/x-llamapun" id="alg2.l3a.m2.1d">italic_i ≥ italic_d + 1</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E26" title="In 2nd item ‣ Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">26</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.Ex4" title="2nd item ‣ Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">•</span> ‣ <span class="ltx_text ltx_ref_tag">4.2</span></a>) using stored tensors.

</div>
<div class="ltx_listingline" id="alg2.l4a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4a.1.1.1" style="font-size:80%;">4:</span></span>Compute <math alttext="\mathbf{g}_{\mathbfcal{G}_{i}}" class="ltx_Math" display="inline" id="alg2.l4a.m1.1"><semantics id="alg2.l4a.m1.1a"><msub id="alg2.l4a.m1.1.1" xref="alg2.l4a.m1.1.1.cmml"><mi id="alg2.l4a.m1.1.1.2" xref="alg2.l4a.m1.1.1.2.cmml">𝐠</mi><msub id="alg2.l4a.m1.1.1.3" xref="alg2.l4a.m1.1.1.3.cmml"><mi id="alg2.l4a.m1.1.1.3.2" mathvariant="normal" xref="alg2.l4a.m1.1.1.3.2.cmml">𝒢</mi><mi id="alg2.l4a.m1.1.1.3.3" mathvariant="normal" xref="alg2.l4a.m1.1.1.3.3.cmml">⟩</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l4a.m1.1b"><apply id="alg2.l4a.m1.1.1.cmml" xref="alg2.l4a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.cmml" xref="alg2.l4a.m1.1.1">subscript</csymbol><ci id="alg2.l4a.m1.1.1.2.cmml" xref="alg2.l4a.m1.1.1.2">𝐠</ci><apply id="alg2.l4a.m1.1.1.3.cmml" xref="alg2.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.3.1.cmml" xref="alg2.l4a.m1.1.1.3">subscript</csymbol><ci id="alg2.l4a.m1.1.1.3.2.cmml" xref="alg2.l4a.m1.1.1.3.2">𝒢</ci><ci id="alg2.l4a.m1.1.1.3.3.cmml" xref="alg2.l4a.m1.1.1.3.3">⟩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4a.m1.1c">\mathbf{g}_{\mathbfcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4a.m1.1d">bold_g start_POSTSUBSCRIPT roman_𝒢 start_POSTSUBSCRIPT ⟩ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="i\leq d" class="ltx_Math" display="inline" id="alg2.l4a.m2.1"><semantics id="alg2.l4a.m2.1a"><mrow id="alg2.l4a.m2.1.1" xref="alg2.l4a.m2.1.1.cmml"><mi id="alg2.l4a.m2.1.1.2" xref="alg2.l4a.m2.1.1.2.cmml">i</mi><mo id="alg2.l4a.m2.1.1.1" xref="alg2.l4a.m2.1.1.1.cmml">≤</mo><mi id="alg2.l4a.m2.1.1.3" xref="alg2.l4a.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4a.m2.1b"><apply id="alg2.l4a.m2.1.1.cmml" xref="alg2.l4a.m2.1.1"><leq id="alg2.l4a.m2.1.1.1.cmml" xref="alg2.l4a.m2.1.1.1"></leq><ci id="alg2.l4a.m2.1.1.2.cmml" xref="alg2.l4a.m2.1.1.2">𝑖</ci><ci id="alg2.l4a.m2.1.1.3.cmml" xref="alg2.l4a.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4a.m2.1c">i\leq d</annotation><annotation encoding="application/x-llamapun" id="alg2.l4a.m2.1d">italic_i ≤ italic_d</annotation></semantics></math> as in (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.E22" title="In Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">22</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.Ex5" title="3rd item ‣ Large batch case. ‣ 4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">•</span> ‣ <span class="ltx_text ltx_ref_tag">4.2</span></a>) using stored tensors.

</div>
</div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Small Batch Case for Contraction Path in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S4.SS2" title="4.2 Contraction Path Optimization for TT-Vector Multiplications ‣ 4 Performance Optimization of CoMERA ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4.2</span></a>
</h3>
<section class="ltx_paragraph" id="A1.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Small batch case.</h4>
<div class="ltx_para" id="A1.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS5.SSS0.Px1.p1.2">The empirical contraction path in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg2" title="Algorithm 2 ‣ A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a> eliminates the batch size dimension <math alttext="b" class="ltx_Math" display="inline" id="A1.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="A1.SS5.SSS0.Px1.p1.1.m1.1a"><mi id="A1.SS5.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.1.m1.1b"><ci id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS0.Px1.p1.1.m1.1d">italic_b</annotation></semantics></math> early, so it is nearly optimal when the batch size is large.
We may search for a better path using a greedy search algorithm to minimize the total operations. In each iteration, we prioritize the pairs that output the smallest tensors. Such a choice can quickly eliminate large intermediate dimensions to reduce the total number of operations. When the batch size is large, the searched path is almost identical to the empirical path in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg2" title="Algorithm 2 ‣ A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a> which eliminates the batch size dimension <math alttext="b" class="ltx_Math" display="inline" id="A1.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="A1.SS5.SSS0.Px1.p1.2.m2.1a"><mi id="A1.SS5.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS5.SSS0.Px1.p1.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.2.m2.1b"><ci id="A1.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.SSS0.Px1.p1.2.m2.1d">italic_b</annotation></semantics></math> early. The searched path may differ from Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg2" title="Algorithm 2 ‣ A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a> for small batch sizes, but their execution times on GPU are almost the same. This is because the tensor contractions for smaller batch sizes have a minor impact on the GPU running times. Consequently, despite certain tensor contractions in the empirical path being larger than those in the optimal path, the actual GPU execution times between them exhibit only negligible differences. Therefore, the empirical contraction path in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#alg2" title="Algorithm 2 ‣ A.4 Algorithm for Contraction Path in Section 4.2 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">2</span></a> is adopted for all batch sizes in CoMERA.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Compression Settings for the Experiment in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1" title="5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">5.1</span></a>
</h3>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1">The compression settings for the experiment in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#S5.SS1" title="5.1 A Medium-Size Transformer with Six Encoders ‣ 5 End-to-End Training Results ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">5.1</span></a> are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.T4" title="Table 4 ‣ A.6 Compression Settings for the Experiment in Section 5.1 ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T4.4.1.1" style="font-size:113%;">Table 4</span>: </span><span class="ltx_text" id="A1.T4.5.2" style="font-size:113%;">Tensorized setting for the Transformer model in CoMERA.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.6.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.6.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.6.1.1.2"><span class="ltx_text" id="A1.T4.6.1.1.2.1" style="font-size:80%;">format</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.6.1.1.3"><span class="ltx_text" id="A1.T4.6.1.1.3.1" style="font-size:80%;">linear shape</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.6.1.1.4"><span class="ltx_text" id="A1.T4.6.1.1.4.1" style="font-size:80%;">tensor shape</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.6.1.1.5"><span class="ltx_text" id="A1.T4.6.1.1.5.1" style="font-size:80%;">rank</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.6.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.6.2.1.1"><span class="ltx_text" id="A1.T4.6.2.1.1.1" style="font-size:80%;">embedding</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.6.2.1.2"><span class="ltx_text" id="A1.T4.6.2.1.2.1" style="font-size:80%;">TTM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.6.2.1.3"><span class="ltx_text" id="A1.T4.6.2.1.3.1" style="font-size:80%;">(30527,768)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.6.2.1.4"><span class="ltx_text" id="A1.T4.6.2.1.4.1" style="font-size:80%;">(64,80,80,60)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.6.2.1.5"><span class="ltx_text" id="A1.T4.6.2.1.5.1" style="font-size:80%;">30</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.6.3.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="A1.T4.6.3.2.1"><span class="ltx_text" id="A1.T4.6.3.2.1.1" style="font-size:80%;">attention</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.6.3.2.2"><span class="ltx_text" id="A1.T4.6.3.2.2.1" style="font-size:80%;">TT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.6.3.2.3"><span class="ltx_text" id="A1.T4.6.3.2.3.1" style="font-size:80%;">(768,768)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.6.3.2.4"><span class="ltx_text" id="A1.T4.6.3.2.4.1" style="font-size:80%;">(12,8,8,8,8,12)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.6.3.2.5"><span class="ltx_text" id="A1.T4.6.3.2.5.1" style="font-size:80%;">30</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.6.4.3">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="A1.T4.6.4.3.1"><span class="ltx_text" id="A1.T4.6.4.3.1.1" style="font-size:80%;">feed-forward</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T4.6.4.3.2"><span class="ltx_text" id="A1.T4.6.4.3.2.1" style="font-size:80%;">TT</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T4.6.4.3.3"><span class="ltx_text" id="A1.T4.6.4.3.3.1" style="font-size:80%;">(768,3072)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T4.6.4.3.4"><span class="ltx_text" id="A1.T4.6.4.3.4.1" style="font-size:80%;">(12,8,8,12,16,16)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T4.6.4.3.5"><span class="ltx_text" id="A1.T4.6.4.3.5.1" style="font-size:80%;">30</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Discussion: Mixed-Precision CoMERA</h3>
<div class="ltx_para" id="A1.SS7.p1">
<p class="ltx_p" id="A1.SS7.p1.1">Modern GPUs offer low-precision computation to speed up the training and inference. It is natural to combine low-rank tensor compression and quantization to achieve the best training efficiency. However, CoMERA involves many small-size low-rank tensor contractions, and a naive low-precision implementation may even slow down the training due to the overhead caused by precision conversions.</p>
</div>
<div class="ltx_para" id="A1.SS7.p2">
<p class="ltx_p" id="A1.SS7.p2.2">To resolve the above issue, we implement mixed-precision computation in CoMERA based on one simple observation: large-size contractions enjoy much more benefits of low-precision computation than small-size ones. This is because the overhead caused by precision conversions can dominate the runtime in small-size contractions. In large-batch tensor-compressed training, small- and large-size tensor contractions can be distinguished by whether the batch size dimension <math alttext="b" class="ltx_Math" display="inline" id="A1.SS7.p2.1.m1.1"><semantics id="A1.SS7.p2.1.m1.1a"><mi id="A1.SS7.p2.1.m1.1.1" xref="A1.SS7.p2.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.p2.1.m1.1b"><ci id="A1.SS7.p2.1.m1.1.1.cmml" xref="A1.SS7.p2.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.p2.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.p2.1.m1.1d">italic_b</annotation></semantics></math> is involved. In general, a contraction with the batch <math alttext="b" class="ltx_Math" display="inline" id="A1.SS7.p2.2.m2.1"><semantics id="A1.SS7.p2.2.m2.1a"><mi id="A1.SS7.p2.2.m2.1.1" xref="A1.SS7.p2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.p2.2.m2.1b"><ci id="A1.SS7.p2.2.m2.1.1.cmml" xref="A1.SS7.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.p2.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.p2.2.m2.1d">italic_b</annotation></semantics></math> is regarded as large and is computed in a low precision. Otherwise, it is regarded small and is computed in full-precision. The actual mixed-precision algorithm depends on the contraction path used in the forward- and back- propagations of CoMERA.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="136" id="A1.F9.g1" src="extracted/2405.14377v1/figures/MNLI_FP8.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F9.2.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="A1.F9.3.2" style="font-size:90%;">Convergence of mixed-precision CoMERA on the six-encoder transformer.</span></figcaption>
</figure>
<section class="ltx_paragraph" id="A1.SS7.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Runtime.</h4>
<div class="ltx_para" id="A1.SS7.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS7.SSS0.Px1.p1.7">We evaluate the mixed-precision forward and backward propagations of CoMERA in a FP8 precision on the NVIDIA L4 GPU. We consider a single linear layer. The shapes <math alttext="(1024,1024)" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.1.m1.2"><semantics id="A1.SS7.SSS0.Px1.p1.1.m1.2a"><mrow id="A1.SS7.SSS0.Px1.p1.1.m1.2.3.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.3.1.cmml"><mo id="A1.SS7.SSS0.Px1.p1.1.m1.2.3.2.1" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.3.1.cmml">(</mo><mn id="A1.SS7.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1.cmml">1024</mn><mo id="A1.SS7.SSS0.Px1.p1.1.m1.2.3.2.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.1.m1.2.2" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.2.cmml">1024</mn><mo id="A1.SS7.SSS0.Px1.p1.1.m1.2.3.2.3" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.1.m1.2b"><interval closure="open" id="A1.SS7.SSS0.Px1.p1.1.m1.2.3.1.cmml" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.3.2"><cn id="A1.SS7.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.1.m1.1.1">1024</cn><cn id="A1.SS7.SSS0.Px1.p1.1.m1.2.2.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.1.m1.2.2">1024</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.1.m1.2c">(1024,1024)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.1.m1.2d">( 1024 , 1024 )</annotation></semantics></math> and <math alttext="(1024,4096)" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.2.m2.2"><semantics id="A1.SS7.SSS0.Px1.p1.2.m2.2a"><mrow id="A1.SS7.SSS0.Px1.p1.2.m2.2.3.2" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.3.1.cmml"><mo id="A1.SS7.SSS0.Px1.p1.2.m2.2.3.2.1" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.3.1.cmml">(</mo><mn id="A1.SS7.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS7.SSS0.Px1.p1.2.m2.1.1.cmml">1024</mn><mo id="A1.SS7.SSS0.Px1.p1.2.m2.2.3.2.2" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.3.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.2.m2.2.2" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.2.cmml">4096</mn><mo id="A1.SS7.SSS0.Px1.p1.2.m2.2.3.2.3" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.2.m2.2b"><interval closure="open" id="A1.SS7.SSS0.Px1.p1.2.m2.2.3.1.cmml" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.3.2"><cn id="A1.SS7.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.2.m2.1.1">1024</cn><cn id="A1.SS7.SSS0.Px1.p1.2.m2.2.2.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.2.m2.2.2">4096</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.2.m2.2c">(1024,4096)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.2.m2.2d">( 1024 , 4096 )</annotation></semantics></math> are converted to the TT shapes <math alttext="(16,8,8,8,8,16)" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.3.m3.6"><semantics id="A1.SS7.SSS0.Px1.p1.3.m3.6a"><mrow id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml"><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.1" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">(</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.1.1" xref="A1.SS7.SSS0.Px1.p1.3.m3.1.1.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.2" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.2.2" xref="A1.SS7.SSS0.Px1.p1.3.m3.2.2.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.3" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.3.3" xref="A1.SS7.SSS0.Px1.p1.3.m3.3.3.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.4" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.4.4" xref="A1.SS7.SSS0.Px1.p1.3.m3.4.4.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.5" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.5.5" xref="A1.SS7.SSS0.Px1.p1.3.m3.5.5.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.6" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.3.m3.6.6" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.6.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2.7" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.3.m3.6b"><vector id="A1.SS7.SSS0.Px1.p1.3.m3.6.7.1.cmml" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.7.2"><cn id="A1.SS7.SSS0.Px1.p1.3.m3.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.1.1">16</cn><cn id="A1.SS7.SSS0.Px1.p1.3.m3.2.2.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.2.2">8</cn><cn id="A1.SS7.SSS0.Px1.p1.3.m3.3.3.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.3.3">8</cn><cn id="A1.SS7.SSS0.Px1.p1.3.m3.4.4.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.4.4">8</cn><cn id="A1.SS7.SSS0.Px1.p1.3.m3.5.5.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.5.5">8</cn><cn id="A1.SS7.SSS0.Px1.p1.3.m3.6.6.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.3.m3.6.6">16</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.3.m3.6c">(16,8,8,8,8,16)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.3.m3.6d">( 16 , 8 , 8 , 8 , 8 , 16 )</annotation></semantics></math> and <math alttext="(16,8,8,16,16,16)" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.4.m4.6"><semantics id="A1.SS7.SSS0.Px1.p1.4.m4.6a"><mrow id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml"><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.1" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">(</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.1.1" xref="A1.SS7.SSS0.Px1.p1.4.m4.1.1.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.2" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.2.2" xref="A1.SS7.SSS0.Px1.p1.4.m4.2.2.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.3" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.3.3" xref="A1.SS7.SSS0.Px1.p1.4.m4.3.3.cmml">8</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.4" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.4.4" xref="A1.SS7.SSS0.Px1.p1.4.m4.4.4.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.5" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.5.5" xref="A1.SS7.SSS0.Px1.p1.4.m4.5.5.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.6" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">,</mo><mn id="A1.SS7.SSS0.Px1.p1.4.m4.6.6" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.6.cmml">16</mn><mo id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2.7" stretchy="false" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.4.m4.6b"><vector id="A1.SS7.SSS0.Px1.p1.4.m4.6.7.1.cmml" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.7.2"><cn id="A1.SS7.SSS0.Px1.p1.4.m4.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.1.1">16</cn><cn id="A1.SS7.SSS0.Px1.p1.4.m4.2.2.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.2.2">8</cn><cn id="A1.SS7.SSS0.Px1.p1.4.m4.3.3.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.3.3">8</cn><cn id="A1.SS7.SSS0.Px1.p1.4.m4.4.4.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.4.4">16</cn><cn id="A1.SS7.SSS0.Px1.p1.4.m4.5.5.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.5.5">16</cn><cn id="A1.SS7.SSS0.Px1.p1.4.m4.6.6.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.4.m4.6.6">16</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.4.m4.6c">(16,8,8,16,16,16)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.4.m4.6d">( 16 , 8 , 8 , 16 , 16 , 16 )</annotation></semantics></math> respectively, and the ranks are both <math alttext="32" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.5.m5.1"><semantics id="A1.SS7.SSS0.Px1.p1.5.m5.1a"><mn id="A1.SS7.SSS0.Px1.p1.5.m5.1.1" xref="A1.SS7.SSS0.Px1.p1.5.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.5.m5.1b"><cn id="A1.SS7.SSS0.Px1.p1.5.m5.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.5.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.5.m5.1c">32</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.5.m5.1d">32</annotation></semantics></math>. The total execution time for <math alttext="1000" class="ltx_Math" display="inline" id="A1.SS7.SSS0.Px1.p1.6.m6.1"><semantics id="A1.SS7.SSS0.Px1.p1.6.m6.1a"><mn id="A1.SS7.SSS0.Px1.p1.6.m6.1.1" xref="A1.SS7.SSS0.Px1.p1.6.m6.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px1.p1.6.m6.1b"><cn id="A1.SS7.SSS0.Px1.p1.6.m6.1.1.cmml" type="integer" xref="A1.SS7.SSS0.Px1.p1.6.m6.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.6.m6.1c">1000</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.6.m6.1d">1000</annotation></semantics></math> forward and backward propagations are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.T5" title="Table 5 ‣ Runtime. ‣ A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">5</span></a>. The FP8 tensor-compressed linear layer has about <math alttext="3\times" class="ltx_math_unparsed" display="inline" id="A1.SS7.SSS0.Px1.p1.7.m7.1"><semantics id="A1.SS7.SSS0.Px1.p1.7.m7.1a"><mrow id="A1.SS7.SSS0.Px1.p1.7.m7.1b"><mn id="A1.SS7.SSS0.Px1.p1.7.m7.1.1">3</mn><mo id="A1.SS7.SSS0.Px1.p1.7.m7.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px1.p1.7.m7.1c">3\times</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px1.p1.7.m7.1d">3 ×</annotation></semantics></math> speed-up compared to the FP8 vanilla linear layer when the batch size and layer size are large. When the batch size is small, the FP8 vanilla linear layer is even faster. This is because the tensor-compressed linear layer consists of a few sequential computations that are not well supported by current GPU kernels. We expect to see a more significant acceleration after optimizing the GPU kernels.</p>
</div>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T5.2.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A1.T5.3.2" style="font-size:90%;">Speed-up of mixed-precision computation on tensor-compressed linear layers.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T5.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.4.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.4.1.1.1" rowspan="2"><span class="ltx_text" id="A1.T5.4.1.1.1.1">shape (b,m,n)</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="A1.T5.4.1.1.2">tensor-vector</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="A1.T5.4.1.1.3">matrix-vector</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.2.2.1">FP8-mix</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.2.2.2">FP32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.2.2.3">FP8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.2.2.4">FP32</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.4.3.3.1">(10000,1024,1024)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.3.3.2">1.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.3.3.3">1.63</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.3.3.4">1.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T5.4.3.3.5">2.82</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="A1.T5.4.4.4.1">(20000,1024,1024)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.4.4.2">2.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.4.4.3">3.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.4.4.4">1.93</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.4.4.5">5.41</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.5.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="A1.T5.4.5.5.1">(40000,1024,1024)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.5.5.2">2.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.5.5.3">6.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.5.5.4">4.27</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.5.5.5">10.93</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.6.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="A1.T5.4.6.6.1">(10000,1024,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.6.6.2">1.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.6.6.3">3.96</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.6.6.4">3.69</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.6.6.5">10.28</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="A1.T5.4.7.7.1">(20000,1024,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.7.7.2">2.96</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.7.7.3">8.32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.7.7.4">7.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T5.4.7.7.5">20.93</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.8.8">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="A1.T5.4.8.8.1">(40000,1024,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T5.4.8.8.2">5.47</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T5.4.8.8.3">17.13</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T5.4.8.8.4">15.27</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T5.4.8.8.5">45.60</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T6.2.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="A1.T6.3.2" style="font-size:90%;">Training results of mixed-precision CoMERA on DLRM (batch size=10,000).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.4.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.2">accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.3">normalized CE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.4.2.1.1">FP32 CoMERA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.2.1.2">78.76%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.2.1.3">0.792</td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.3.2">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="A1.T6.4.3.2.1">FP8/FP32 mixed-precision CoMERA</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.3.2.2">78.88%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.3.2.3">0.793</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="A1.SS7.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Convergence.</h4>
<div class="ltx_para" id="A1.SS7.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS7.SSS0.Px2.p1.1">We use the mixed-precision CoMERA to train the DLRM model and the six-encoder transformer. The result on DLRM is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.T6" title="Table 6 ‣ Runtime. ‣ A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">6</span></a>. The convergence curve of the six-encoder transformer is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.14377v1#A1.F9" title="Figure 9 ‣ A.7 Discussion: Mixed-Precision CoMERA ‣ Appendix A Supplementary Material ‣ CoMERA: Computing- and Memory-Efficient Training via Rank-Adaptive Tensor Optimization"><span class="ltx_text ltx_ref_tag">9</span></a>. The experiments demonstrate that the accuracy of FP8 training is similar to FP32 training. However, we did not see much acceleration of using FP8 in the experiments. This is mainly because of ① the computation overhead of slow data type casting between FP32 and FP8; ② the sequential execution of small tensor contractions that are not well supported by current GPUs; ③ the relatively small sizes of linear layers in the tested models. We will investigate these problems in the future, and are optimistic to see significant acceleration on larger models.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri May 24 14:29:22 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
