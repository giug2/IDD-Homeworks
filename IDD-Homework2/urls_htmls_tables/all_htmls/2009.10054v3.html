<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2009.10054] Regularizing Attention Networks for Anomaly Detection in Visual Question Answering</title><meta property="og:description" content="For stability and reliability of real-world applications, the robustness of DNNs in unimodal tasks has been evaluated.
However, few studies consider abnormal situations that a visual question answering (VQA) model migh…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Regularizing Attention Networks for Anomaly Detection in Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Regularizing Attention Networks for Anomaly Detection in Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2009.10054">

<!--Generated on Thu Mar 14 11:18:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Regularizing Attention Networks for Anomaly Detection in Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.id1" class="ltx_text ltx_font_bold">Doyup Lee<sup id="id1.1.id1.1" class="ltx_sup"><span id="id1.1.id1.1.1" class="ltx_text ltx_font_medium">1</span></sup>,
Yeongjae Cheon<sup id="id1.1.id1.2" class="ltx_sup"><span id="id1.1.id1.2.1" class="ltx_text ltx_font_medium">2</span></sup>,
Wook-Shin Han<sup id="id1.1.id1.3" class="ltx_sup"><span id="id1.1.id1.3.1" class="ltx_text ltx_font_medium">1</span></sup></span> 
<br class="ltx_break">
</span><span class="ltx_author_notes"><span id="id2.2.id1" class="ltx_text ltx_font_bold">Corresponding Author</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">For stability and reliability of real-world applications, the robustness of DNNs in unimodal tasks has been evaluated.
However, few studies consider abnormal situations that a visual question answering (VQA) model might encounter at test time after deployment in the real-world.
In this study, we evaluate the robustness of state-of-the-art VQA models to five different anomalies, including worst-case scenarios, the most frequent scenarios, and the current limitation of VQA models.
Different from the results in unimodal tasks, the maximum confidence of answers in VQA models cannot detect anomalous inputs, and post-training of the outputs, such as outlier exposure, is ineffective for VQA models.
Thus, we propose an attention-based method, which uses <span id="id3.id1.1" class="ltx_text ltx_font_italic">confidence of reasoning</span> between input images and questions and shows much more promising results than the previous methods in unimodal tasks.
In addition, we show that a maximum entropy regularization of attention networks can significantly improve the attention-based anomaly detection of the VQA models.
Thanks to the simplicity, attention-based anomaly detection and the regularization are model-agnostic methods, which can be used for various cross-modal attentions in the state-of-the-art VQA models.
The results imply that cross-modal attention in VQA is important to improve not only VQA accuracy, but also the robustness to various anomalies.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Visual question answering (VQA) is a challenging task that requires a comprehensive understanding of vision, language, and commonsense knowledge <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib2" title="" class="ltx_ref">2015</a>; Goyal et al. <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>.
Despite the difficulty, the accuracy of VQA has constantly improved by deep neural networks (DNNs) showing great potential for real-world applications <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Kim, Jun, and Zhang <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>, <a href="#bib.bib37" title="" class="ltx_ref">2018</a>, <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>.
For example, a VQA system can assist the blind, allowing them to use smartphone to take pictures and pose natural language questions about their images <cite class="ltx_cite ltx_citemacro_citep">(Gurari et al. <a href="#bib.bib11" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Orthogonal to answer accuracy, the capability to recognize abnormal situations is essential for stability and reliability, because there is little control of the test input after deployment of the model in practice.
In the example of blind users, if a VQA model fails to detect anomalous situations and returns wrong answer, then the incorrect answers on abnormal situations will lead to fatal accidents.
However, evaluating robustness of VQA models is only limited to irrelevant questions in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Mahendru et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Many studies focus on how DNN classifiers can detect anomalies, such as the unrecognizable <cite class="ltx_cite ltx_citemacro_citep">(Nguyen, Yosinski, and Clune <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite>, the irrelevant <cite class="ltx_cite ltx_citemacro_citep">(Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>, or the out-of-distribution (OOD) inputs <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>.
They commonly calibrate a <span id="Sx1.p3.1.1" class="ltx_text ltx_font_italic">predictive confidence</span> by maximum softmax probability (MSP) in the output predictions <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Liang, Li, and Srikant <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite> and detect OOD inputs.
In addition, <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Hein, Andriushchenko, and Bitterwolf <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> use post-training to make the predictions have a uniform distribution on anomalies, and show that the robustness of DNNs is significantly improved.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">However, previous studies have focused only on anomaly detection in unimodal tasks such as image or text classification, rather than on tasks with multimodal inputs, such as VQA.
Furthermore, extending anomaly detection to VQA has not been discussed, although it is not trivial and must be carefully conducted because of the bimodality of VQA inputs.
In this study, we categorize various anomalies in VQA into five types according to two criteria: 1) whether the images and/or questions are from OOD or not and 2) whether the pairs of in-distribution (ID) images and questions are answerable by VQA models.
From a distributional perspective, our categorization is a disjoint and complete partition of all possible anomalies in VQA and includes worst-case scenarios, the most frequent scenarios, and the current limitation of VQA models.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">Then, we propose a simple attention-based method to calibrate predictive confidences and detect various anomalies in VQA.
We find that MSP, which is the most common in unimodal tasks, can only detect samples with undefined answers, whose answers are not among the answer candidates due to the current limitation of VQA models.
However, MSP cannot detect the worst-case and the most frequent scenarios, which are OOD images/questions and irrelevant pairs of images and questions respectively.
Thus, we use cross-modal attention of VQA models, which associate most related visual objects and question tokens in an input pair.
When an input of VQA models is an anomaly, cross-modal attention networks cannot associate the given image and question, and the anomaly can be detected simply by maximum attention probability (MAP) with low confidence.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p id="Sx1.p6.1" class="ltx_p">To enhance the robustness of VQA models to various anomalies, we also propose a maximum entropy regularization of a cross-modal attention distribution in VQA models.
We find that post-training by outlier exposure <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite> in unimodal tasks also fails to enhance the robustness of VQA models and causes severe accuracy degradation of a VQA model.
Instead, we show that post-training with a maximum entropy regularization of a cross-modal attention in VQA models can significantly improve anomaly detection by MAP, keeping the accuracy of VQA models.
As the choice of anomalies for post-training is directly related to anomaly detection results <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>, we also discuss how to select training anomalies to enhance the robustness of VQA models, considering the bimodality of the inputs and characteristics of VQA.</p>
</div>
<div id="Sx1.p7" class="ltx_para">
<p id="Sx1.p7.1" class="ltx_p">Our main contributions include:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">This is the first study to define various anomalies in VQA and evaluate the robustness of recent VQA models to those anomalies. In addition, we show that anomaly detection methods in unimodal tasks cannot be simply generalized in multimodal tasks such as VQA.</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">Our attention-based anomaly detection is technically simple yet powerful. Thanks to the simplicity, our approach is a model-agnostic method, which can be used for various attention modules in the state-of-the-art VQA models. In addition, our maximum entropy regularization of a cross-modal attention distribution can significantly improve the robustness of VQA models and keep the VQA accuracy.</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">We claim that cross-modal attention modules are the key to detecting various anomalies for DNNs with multimodal inputs, including VQA models.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">The Framework of VQA Models</h2>

<figure id="Sx2.F1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2009.10054/assets/x1.png" id="Sx2.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="211" height="87" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The framework of VQA models contains attention modules and multimodal feature fusion to predict the answer, given an image and a question.</figcaption>
</figure>
<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.4" class="ltx_p">A VQA dataset contains a set of triples of answer, image, and question <math id="Sx2.p1.1.m1.4" class="ltx_Math" alttext="\mathcal{D}=\left\{(\mathcal{A},\mathcal{V},\mathcal{Q})\right\}" display="inline"><semantics id="Sx2.p1.1.m1.4a"><mrow id="Sx2.p1.1.m1.4.4" xref="Sx2.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx2.p1.1.m1.4.4.3" xref="Sx2.p1.1.m1.4.4.3.cmml">𝒟</mi><mo id="Sx2.p1.1.m1.4.4.2" xref="Sx2.p1.1.m1.4.4.2.cmml">=</mo><mrow id="Sx2.p1.1.m1.4.4.1.1" xref="Sx2.p1.1.m1.4.4.1.2.cmml"><mo id="Sx2.p1.1.m1.4.4.1.1.2" xref="Sx2.p1.1.m1.4.4.1.2.cmml">{</mo><mrow id="Sx2.p1.1.m1.4.4.1.1.1.2" xref="Sx2.p1.1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="Sx2.p1.1.m1.4.4.1.1.1.2.1" xref="Sx2.p1.1.m1.4.4.1.1.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Sx2.p1.1.m1.1.1" xref="Sx2.p1.1.m1.1.1.cmml">𝒜</mi><mo id="Sx2.p1.1.m1.4.4.1.1.1.2.2" xref="Sx2.p1.1.m1.4.4.1.1.1.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="Sx2.p1.1.m1.2.2" xref="Sx2.p1.1.m1.2.2.cmml">𝒱</mi><mo id="Sx2.p1.1.m1.4.4.1.1.1.2.3" xref="Sx2.p1.1.m1.4.4.1.1.1.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="Sx2.p1.1.m1.3.3" xref="Sx2.p1.1.m1.3.3.cmml">𝒬</mi><mo stretchy="false" id="Sx2.p1.1.m1.4.4.1.1.1.2.4" xref="Sx2.p1.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="Sx2.p1.1.m1.4.4.1.1.3" xref="Sx2.p1.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.p1.1.m1.4b"><apply id="Sx2.p1.1.m1.4.4.cmml" xref="Sx2.p1.1.m1.4.4"><eq id="Sx2.p1.1.m1.4.4.2.cmml" xref="Sx2.p1.1.m1.4.4.2"></eq><ci id="Sx2.p1.1.m1.4.4.3.cmml" xref="Sx2.p1.1.m1.4.4.3">𝒟</ci><set id="Sx2.p1.1.m1.4.4.1.2.cmml" xref="Sx2.p1.1.m1.4.4.1.1"><vector id="Sx2.p1.1.m1.4.4.1.1.1.1.cmml" xref="Sx2.p1.1.m1.4.4.1.1.1.2"><ci id="Sx2.p1.1.m1.1.1.cmml" xref="Sx2.p1.1.m1.1.1">𝒜</ci><ci id="Sx2.p1.1.m1.2.2.cmml" xref="Sx2.p1.1.m1.2.2">𝒱</ci><ci id="Sx2.p1.1.m1.3.3.cmml" xref="Sx2.p1.1.m1.3.3">𝒬</ci></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p1.1.m1.4c">\mathcal{D}=\left\{(\mathcal{A},\mathcal{V},\mathcal{Q})\right\}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib2" title="" class="ltx_ref">2015</a>; Goyal et al. <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>.
A VQA model predicts the answer about a given real-world image and an open-ended question (Fig. <a href="#Sx2.F1" title="Figure 1 ‣ The Framework of VQA Models ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
The hidden features of <math id="Sx2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx2.p1.2.m2.1a"><mi id="Sx2.p1.2.m2.1.1" xref="Sx2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx2.p1.2.m2.1b"><ci id="Sx2.p1.2.m2.1.1.cmml" xref="Sx2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p1.2.m2.1c">K</annotation></semantics></math> objects (regions) in the image and question (tokens) are extracted by pretrained models <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib28" title="" class="ltx_ref">2014</a>; Ren et al. <a href="#bib.bib31" title="" class="ltx_ref">2015</a>; He et al. <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite>.
Then, the two kinds of features from two modalities are integrated by feature fusion such as element-wise product <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, bilinear pooling <cite class="ltx_cite ltx_citemacro_citep">(Fukui et al. <a href="#bib.bib7" title="" class="ltx_ref">2016</a>)</cite>, or multi-modal factorized bilinear (MFB) pooling <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>.
Before the integration, attention modules are commonly used to increase the accuracy by cross-modal reasoning between visual objects in the image and the question <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite>, or between every pair of visual objects and question tokens <cite class="ltx_cite ltx_citemacro_citep">(Kim, Jun, and Zhang <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>.
In this paper, we consider VQA models with various types of attention modules.
Finally, the answer is predicted by the joint features of image and question.
The model parameters <math id="Sx2.p1.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx2.p1.3.m3.1a"><mi id="Sx2.p1.3.m3.1.1" xref="Sx2.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx2.p1.3.m3.1b"><ci id="Sx2.p1.3.m3.1.1.cmml" xref="Sx2.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p1.3.m3.1c">\theta</annotation></semantics></math> are trained to maximize expected log likelihood, where <math id="Sx2.p1.4.m4.3" class="ltx_Math" alttext="(\mathbf{a},\mathbf{v},\mathbf{q})\in\mathcal{D}" display="inline"><semantics id="Sx2.p1.4.m4.3a"><mrow id="Sx2.p1.4.m4.3.4" xref="Sx2.p1.4.m4.3.4.cmml"><mrow id="Sx2.p1.4.m4.3.4.2.2" xref="Sx2.p1.4.m4.3.4.2.1.cmml"><mo stretchy="false" id="Sx2.p1.4.m4.3.4.2.2.1" xref="Sx2.p1.4.m4.3.4.2.1.cmml">(</mo><mi id="Sx2.p1.4.m4.1.1" xref="Sx2.p1.4.m4.1.1.cmml">𝐚</mi><mo id="Sx2.p1.4.m4.3.4.2.2.2" xref="Sx2.p1.4.m4.3.4.2.1.cmml">,</mo><mi id="Sx2.p1.4.m4.2.2" xref="Sx2.p1.4.m4.2.2.cmml">𝐯</mi><mo id="Sx2.p1.4.m4.3.4.2.2.3" xref="Sx2.p1.4.m4.3.4.2.1.cmml">,</mo><mi id="Sx2.p1.4.m4.3.3" xref="Sx2.p1.4.m4.3.3.cmml">𝐪</mi><mo stretchy="false" id="Sx2.p1.4.m4.3.4.2.2.4" xref="Sx2.p1.4.m4.3.4.2.1.cmml">)</mo></mrow><mo id="Sx2.p1.4.m4.3.4.1" xref="Sx2.p1.4.m4.3.4.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx2.p1.4.m4.3.4.3" xref="Sx2.p1.4.m4.3.4.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.p1.4.m4.3b"><apply id="Sx2.p1.4.m4.3.4.cmml" xref="Sx2.p1.4.m4.3.4"><in id="Sx2.p1.4.m4.3.4.1.cmml" xref="Sx2.p1.4.m4.3.4.1"></in><vector id="Sx2.p1.4.m4.3.4.2.1.cmml" xref="Sx2.p1.4.m4.3.4.2.2"><ci id="Sx2.p1.4.m4.1.1.cmml" xref="Sx2.p1.4.m4.1.1">𝐚</ci><ci id="Sx2.p1.4.m4.2.2.cmml" xref="Sx2.p1.4.m4.2.2">𝐯</ci><ci id="Sx2.p1.4.m4.3.3.cmml" xref="Sx2.p1.4.m4.3.3">𝐪</ci></vector><ci id="Sx2.p1.4.m4.3.4.3.cmml" xref="Sx2.p1.4.m4.3.4.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p1.4.m4.3c">(\mathbf{a},\mathbf{v},\mathbf{q})\in\mathcal{D}</annotation></semantics></math>,</p>
<table id="Sx2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx2.E1.m1.3" class="ltx_Math" alttext="\theta^{*}=\underset{\theta}{\operatorname{argmax}}\mathbb{E}_{p_{\mathcal{D}}}\left[\log p_{\theta}\left(\mathbf{a}|\mathbf{v},\mathbf{q}\right)\right]." display="block"><semantics id="Sx2.E1.m1.3a"><mrow id="Sx2.E1.m1.3.3.1" xref="Sx2.E1.m1.3.3.1.1.cmml"><mrow id="Sx2.E1.m1.3.3.1.1" xref="Sx2.E1.m1.3.3.1.1.cmml"><msup id="Sx2.E1.m1.3.3.1.1.3" xref="Sx2.E1.m1.3.3.1.1.3.cmml"><mi id="Sx2.E1.m1.3.3.1.1.3.2" xref="Sx2.E1.m1.3.3.1.1.3.2.cmml">θ</mi><mo id="Sx2.E1.m1.3.3.1.1.3.3" xref="Sx2.E1.m1.3.3.1.1.3.3.cmml">∗</mo></msup><mo id="Sx2.E1.m1.3.3.1.1.2" xref="Sx2.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="Sx2.E1.m1.3.3.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.cmml"><munder accentunder="true" id="Sx2.E1.m1.3.3.1.1.1.3" xref="Sx2.E1.m1.3.3.1.1.1.3.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.3.2" xref="Sx2.E1.m1.3.3.1.1.1.3.2.cmml">argmax</mi><mo id="Sx2.E1.m1.3.3.1.1.1.3.1" xref="Sx2.E1.m1.3.3.1.1.1.3.1.cmml">𝜃</mo></munder><mo lspace="0.167em" rspace="0em" id="Sx2.E1.m1.3.3.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.2.cmml">​</mo><msub id="Sx2.E1.m1.3.3.1.1.1.4" xref="Sx2.E1.m1.3.3.1.1.1.4.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.4.2" xref="Sx2.E1.m1.3.3.1.1.1.4.2.cmml">𝔼</mi><msub id="Sx2.E1.m1.3.3.1.1.1.4.3" xref="Sx2.E1.m1.3.3.1.1.1.4.3.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.4.3.2" xref="Sx2.E1.m1.3.3.1.1.1.4.3.2.cmml">p</mi><mi class="ltx_font_mathcaligraphic" id="Sx2.E1.m1.3.3.1.1.1.4.3.3" xref="Sx2.E1.m1.3.3.1.1.1.4.3.3.cmml">𝒟</mi></msub></msub><mo lspace="0em" rspace="0em" id="Sx2.E1.m1.3.3.1.1.1.2a" xref="Sx2.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3a" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.3" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx2.E1.m1.3.3.1.1.1.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐚</mi><mo fence="false" id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="Sx2.E1.m1.1.1" xref="Sx2.E1.m1.1.1.cmml">𝐯</mi><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx2.E1.m1.2.2" xref="Sx2.E1.m1.2.2.cmml">𝐪</mi></mrow></mrow><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.3" xref="Sx2.E1.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx2.E1.m1.3.3.1.2" xref="Sx2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E1.m1.3b"><apply id="Sx2.E1.m1.3.3.1.1.cmml" xref="Sx2.E1.m1.3.3.1"><eq id="Sx2.E1.m1.3.3.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.2"></eq><apply id="Sx2.E1.m1.3.3.1.1.3.cmml" xref="Sx2.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.3.3.1.1.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.3">superscript</csymbol><ci id="Sx2.E1.m1.3.3.1.1.3.2.cmml" xref="Sx2.E1.m1.3.3.1.1.3.2">𝜃</ci><times id="Sx2.E1.m1.3.3.1.1.3.3.cmml" xref="Sx2.E1.m1.3.3.1.1.3.3"></times></apply><apply id="Sx2.E1.m1.3.3.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1"><times id="Sx2.E1.m1.3.3.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.2"></times><apply id="Sx2.E1.m1.3.3.1.1.1.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.3"><ci id="Sx2.E1.m1.3.3.1.1.1.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.3.1">𝜃</ci><ci id="Sx2.E1.m1.3.3.1.1.1.3.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.3.2">argmax</ci></apply><apply id="Sx2.E1.m1.3.3.1.1.1.4.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="Sx2.E1.m1.3.3.1.1.1.4.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4">subscript</csymbol><ci id="Sx2.E1.m1.3.3.1.1.1.4.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4.2">𝔼</ci><apply id="Sx2.E1.m1.3.3.1.1.1.4.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.3.3.1.1.1.4.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4.3">subscript</csymbol><ci id="Sx2.E1.m1.3.3.1.1.1.4.3.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4.3.2">𝑝</ci><ci id="Sx2.E1.m1.3.3.1.1.1.4.3.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.4.3.3">𝒟</ci></apply></apply><apply id="Sx2.E1.m1.3.3.1.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1"><times id="Sx2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.2"></times><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3"><log id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.1"></log><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐚</ci><list id="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2"><ci id="Sx2.E1.m1.1.1.cmml" xref="Sx2.E1.m1.1.1">𝐯</ci><ci id="Sx2.E1.m1.2.2.cmml" xref="Sx2.E1.m1.2.2">𝐪</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E1.m1.3c">\theta^{*}=\underset{\theta}{\operatorname{argmax}}\mathbb{E}_{p_{\mathcal{D}}}\left[\log p_{\theta}\left(\mathbf{a}|\mathbf{v},\mathbf{q}\right)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<figure id="Sx2.F2" class="ltx_figure"><img src="/html/2009.10054/assets/x2.png" id="Sx2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="514" height="90" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of Anomalies in VQA: OOD images and questions, and unanswerable samples with irrelevant questions and undefined answers.</figcaption>
</figure>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Definition of Anomalies in VQA</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">We define and categorize the five anomaly types in VQA to evaluate the robustness of VQA models.
Considering 1) worst-case scenarios, 2) the most frequent scenarios, and 3) current limitation of VQA models, we divide anomalies in VQA into OOD images/questions and unanswerable pairs of images and questions (irrelevant questions and undefined answers).
Our categorization includes all possible anomalies of <math id="Sx3.p1.1.m1.3" class="ltx_Math" alttext="p(\mathbf{a},\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx3.p1.1.m1.3a"><mrow id="Sx3.p1.1.m1.3.4" xref="Sx3.p1.1.m1.3.4.cmml"><mi id="Sx3.p1.1.m1.3.4.2" xref="Sx3.p1.1.m1.3.4.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.p1.1.m1.3.4.1" xref="Sx3.p1.1.m1.3.4.1.cmml">​</mo><mrow id="Sx3.p1.1.m1.3.4.3.2" xref="Sx3.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="Sx3.p1.1.m1.3.4.3.2.1" xref="Sx3.p1.1.m1.3.4.3.1.cmml">(</mo><mi id="Sx3.p1.1.m1.1.1" xref="Sx3.p1.1.m1.1.1.cmml">𝐚</mi><mo id="Sx3.p1.1.m1.3.4.3.2.2" xref="Sx3.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="Sx3.p1.1.m1.2.2" xref="Sx3.p1.1.m1.2.2.cmml">𝐯</mi><mo id="Sx3.p1.1.m1.3.4.3.2.3" xref="Sx3.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="Sx3.p1.1.m1.3.3" xref="Sx3.p1.1.m1.3.3.cmml">𝐪</mi><mo stretchy="false" id="Sx3.p1.1.m1.3.4.3.2.4" xref="Sx3.p1.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p1.1.m1.3b"><apply id="Sx3.p1.1.m1.3.4.cmml" xref="Sx3.p1.1.m1.3.4"><times id="Sx3.p1.1.m1.3.4.1.cmml" xref="Sx3.p1.1.m1.3.4.1"></times><ci id="Sx3.p1.1.m1.3.4.2.cmml" xref="Sx3.p1.1.m1.3.4.2">𝑝</ci><vector id="Sx3.p1.1.m1.3.4.3.1.cmml" xref="Sx3.p1.1.m1.3.4.3.2"><ci id="Sx3.p1.1.m1.1.1.cmml" xref="Sx3.p1.1.m1.1.1">𝐚</ci><ci id="Sx3.p1.1.m1.2.2.cmml" xref="Sx3.p1.1.m1.2.2">𝐯</ci><ci id="Sx3.p1.1.m1.3.3.cmml" xref="Sx3.p1.1.m1.3.3">𝐪</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.1.m1.3c">p(\mathbf{a},\mathbf{v},\mathbf{q})</annotation></semantics></math> in a distributional approach, and satisfies disjoint and complete partition (Table <a href="#Sx3.T1" title="Table 1 ‣ Out-of-distribution Image &amp; Question ‣ Definition of Anomalies in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Fig. <a href="#Sx2.F2" title="Figure 2 ‣ The Framework of VQA Models ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the overview of anomalies in VQA and includes the most extreme case for ease of understanding.
The details of each anomaly are described in the remaining parts.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Out-of-distribution Image &amp; Question</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.1" class="ltx_p">The typical anomaly is a sample from OOD that differs from training data.
Although OOD samples seem to be unrealistic, worst, and extreme cases in real-world scenarios, detecting them is important because DNNs are not robust but rather over-confident on OOD <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Lee et al. <a href="#bib.bib21" title="" class="ltx_ref">2018</a>; Hein, Andriushchenko, and Bitterwolf <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<figure id="Sx3.F3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2009.10054/assets/x3.png" id="Sx3.SSx1.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="166" height="80" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Examples of unreliable and over-confident misclassification of BUTD for questions about an out-of-distribution MNIST image.</figcaption>
</figure>
<figure id="Sx3.T1" class="ltx_table">
<table id="Sx3.T1.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx3.T1.7.8.1" class="ltx_tr">
<th id="Sx3.T1.7.8.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Task</th>
<th id="Sx3.T1.7.8.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">V</th>
<th id="Sx3.T1.7.8.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Q</th>
<th id="Sx3.T1.7.8.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Abnormal Distribution</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx3.T1.1.1" class="ltx_tr">
<th id="Sx3.T1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">1</th>
<td id="Sx3.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">OOD</td>
<td id="Sx3.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ID</td>
<td id="Sx3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx3.T1.1.1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx3.T1.1.1.1.m1.1a"><mrow id="Sx3.T1.1.1.1.m1.1.1" xref="Sx3.T1.1.1.1.m1.1.1.cmml"><mi id="Sx3.T1.1.1.1.m1.1.1.3" xref="Sx3.T1.1.1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.T1.1.1.1.m1.1.1.2" xref="Sx3.T1.1.1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.T1.1.1.1.m1.1.1.1.1" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.1.1.1.m1.1.1.1.1.2" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.T1.1.1.1.m1.1.1.1.1.1" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.T1.1.1.1.m1.1.1.1.1.1.2" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.T1.1.1.1.m1.1.1.1.1.1.3" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.T1.1.1.1.m1.1.1.1.1.3" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.1.1.1.m1.1b"><apply id="Sx3.T1.1.1.1.m1.1.1.cmml" xref="Sx3.T1.1.1.1.m1.1.1"><times id="Sx3.T1.1.1.1.m1.1.1.2.cmml" xref="Sx3.T1.1.1.1.m1.1.1.2"></times><ci id="Sx3.T1.1.1.1.m1.1.1.3.cmml" xref="Sx3.T1.1.1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="Sx3.T1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.T1.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.T1.1.1.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.T1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.T1.1.1.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.1.1.1.m1.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math></td>
</tr>
<tr id="Sx3.T1.2.2" class="ltx_tr">
<th id="Sx3.T1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">2</th>
<td id="Sx3.T1.2.2.3" class="ltx_td ltx_align_center">ID</td>
<td id="Sx3.T1.2.2.4" class="ltx_td ltx_align_center ltx_border_r">OOD</td>
<td id="Sx3.T1.2.2.1" class="ltx_td ltx_align_center"><math id="Sx3.T1.2.2.1.m1.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx3.T1.2.2.1.m1.1a"><mrow id="Sx3.T1.2.2.1.m1.1.1" xref="Sx3.T1.2.2.1.m1.1.1.cmml"><mi id="Sx3.T1.2.2.1.m1.1.1.3" xref="Sx3.T1.2.2.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.T1.2.2.1.m1.1.1.2" xref="Sx3.T1.2.2.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.T1.2.2.1.m1.1.1.1.1" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.2.2.1.m1.1.1.1.1.2" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.T1.2.2.1.m1.1.1.1.1.1" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.T1.2.2.1.m1.1.1.1.1.1.2" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx3.T1.2.2.1.m1.1.1.1.1.1.3" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.T1.2.2.1.m1.1.1.1.1.3" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.2.2.1.m1.1b"><apply id="Sx3.T1.2.2.1.m1.1.1.cmml" xref="Sx3.T1.2.2.1.m1.1.1"><times id="Sx3.T1.2.2.1.m1.1.1.2.cmml" xref="Sx3.T1.2.2.1.m1.1.1.2"></times><ci id="Sx3.T1.2.2.1.m1.1.1.3.cmml" xref="Sx3.T1.2.2.1.m1.1.1.3">𝑝</ci><apply id="Sx3.T1.2.2.1.m1.1.1.1.1.1.cmml" xref="Sx3.T1.2.2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.T1.2.2.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.T1.2.2.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.T1.2.2.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.2">𝐪</ci><ci id="Sx3.T1.2.2.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.T1.2.2.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.T1.2.2.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.2.2.1.m1.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math></td>
</tr>
<tr id="Sx3.T1.4.4" class="ltx_tr">
<th id="Sx3.T1.4.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">3</th>
<td id="Sx3.T1.4.4.4" class="ltx_td ltx_align_center">OOD</td>
<td id="Sx3.T1.4.4.5" class="ltx_td ltx_align_center ltx_border_r">OOD</td>
<td id="Sx3.T1.4.4.2" class="ltx_td ltx_align_center">
<math id="Sx3.T1.3.3.1.m1.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx3.T1.3.3.1.m1.1a"><mrow id="Sx3.T1.3.3.1.m1.1.1" xref="Sx3.T1.3.3.1.m1.1.1.cmml"><mi id="Sx3.T1.3.3.1.m1.1.1.3" xref="Sx3.T1.3.3.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.T1.3.3.1.m1.1.1.2" xref="Sx3.T1.3.3.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.T1.3.3.1.m1.1.1.1.1" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.3.3.1.m1.1.1.1.1.2" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.T1.3.3.1.m1.1.1.1.1.1" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.T1.3.3.1.m1.1.1.1.1.1.2" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.T1.3.3.1.m1.1.1.1.1.1.3" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.T1.3.3.1.m1.1.1.1.1.3" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.3.3.1.m1.1b"><apply id="Sx3.T1.3.3.1.m1.1.1.cmml" xref="Sx3.T1.3.3.1.m1.1.1"><times id="Sx3.T1.3.3.1.m1.1.1.2.cmml" xref="Sx3.T1.3.3.1.m1.1.1.2"></times><ci id="Sx3.T1.3.3.1.m1.1.1.3.cmml" xref="Sx3.T1.3.3.1.m1.1.1.3">𝑝</ci><apply id="Sx3.T1.3.3.1.m1.1.1.1.1.1.cmml" xref="Sx3.T1.3.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.T1.3.3.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.T1.3.3.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.T1.3.3.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.T1.3.3.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.T1.3.3.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.T1.3.3.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.3.3.1.m1.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math> and <math id="Sx3.T1.4.4.2.m2.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx3.T1.4.4.2.m2.1a"><mrow id="Sx3.T1.4.4.2.m2.1.1" xref="Sx3.T1.4.4.2.m2.1.1.cmml"><mi id="Sx3.T1.4.4.2.m2.1.1.3" xref="Sx3.T1.4.4.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.T1.4.4.2.m2.1.1.2" xref="Sx3.T1.4.4.2.m2.1.1.2.cmml">​</mo><mrow id="Sx3.T1.4.4.2.m2.1.1.1.1" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.4.4.2.m2.1.1.1.1.2" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.cmml">(</mo><msub id="Sx3.T1.4.4.2.m2.1.1.1.1.1" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.cmml"><mi id="Sx3.T1.4.4.2.m2.1.1.1.1.1.2" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx3.T1.4.4.2.m2.1.1.1.1.1.3" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.T1.4.4.2.m2.1.1.1.1.3" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.4.4.2.m2.1b"><apply id="Sx3.T1.4.4.2.m2.1.1.cmml" xref="Sx3.T1.4.4.2.m2.1.1"><times id="Sx3.T1.4.4.2.m2.1.1.2.cmml" xref="Sx3.T1.4.4.2.m2.1.1.2"></times><ci id="Sx3.T1.4.4.2.m2.1.1.3.cmml" xref="Sx3.T1.4.4.2.m2.1.1.3">𝑝</ci><apply id="Sx3.T1.4.4.2.m2.1.1.1.1.1.cmml" xref="Sx3.T1.4.4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.T1.4.4.2.m2.1.1.1.1.1.1.cmml" xref="Sx3.T1.4.4.2.m2.1.1.1.1">subscript</csymbol><ci id="Sx3.T1.4.4.2.m2.1.1.1.1.1.2.cmml" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.2">𝐪</ci><ci id="Sx3.T1.4.4.2.m2.1.1.1.1.1.3a.cmml" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.T1.4.4.2.m2.1.1.1.1.1.3.cmml" xref="Sx3.T1.4.4.2.m2.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.4.4.2.m2.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math>
</td>
</tr>
<tr id="Sx3.T1.6.6" class="ltx_tr">
<th id="Sx3.T1.6.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">4</th>
<td id="Sx3.T1.6.6.4" class="ltx_td ltx_align_center">ID</td>
<td id="Sx3.T1.6.6.5" class="ltx_td ltx_align_center ltx_border_r">ID</td>
<td id="Sx3.T1.6.6.2" class="ltx_td ltx_align_center">
<math id="Sx3.T1.5.5.1.m1.1" class="ltx_Math" alttext="p_{\text{out}}(\mathbf{v}_{\text{in}}|\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx3.T1.5.5.1.m1.1a"><mrow id="Sx3.T1.5.5.1.m1.1.1" xref="Sx3.T1.5.5.1.m1.1.1.cmml"><msub id="Sx3.T1.5.5.1.m1.1.1.3" xref="Sx3.T1.5.5.1.m1.1.1.3.cmml"><mi id="Sx3.T1.5.5.1.m1.1.1.3.2" xref="Sx3.T1.5.5.1.m1.1.1.3.2.cmml">p</mi><mtext id="Sx3.T1.5.5.1.m1.1.1.3.3" xref="Sx3.T1.5.5.1.m1.1.1.3.3a.cmml">out</mtext></msub><mo lspace="0em" rspace="0em" id="Sx3.T1.5.5.1.m1.1.1.2" xref="Sx3.T1.5.5.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.T1.5.5.1.m1.1.1.1.1" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.5.5.1.m1.1.1.1.1.2" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.T1.5.5.1.m1.1.1.1.1.1" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.cmml"><msub id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.cmml"><mi id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.2" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml">𝐯</mi><mtext id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo fence="false" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.1" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.cmml"><mi id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.2" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml">𝐪</mi><mtext id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3a.cmml">in</mtext></msub></mrow><mo stretchy="false" id="Sx3.T1.5.5.1.m1.1.1.1.1.3" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.5.5.1.m1.1b"><apply id="Sx3.T1.5.5.1.m1.1.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1"><times id="Sx3.T1.5.5.1.m1.1.1.2.cmml" xref="Sx3.T1.5.5.1.m1.1.1.2"></times><apply id="Sx3.T1.5.5.1.m1.1.1.3.cmml" xref="Sx3.T1.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.T1.5.5.1.m1.1.1.3.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1.3">subscript</csymbol><ci id="Sx3.T1.5.5.1.m1.1.1.3.2.cmml" xref="Sx3.T1.5.5.1.m1.1.1.3.2">𝑝</ci><ci id="Sx3.T1.5.5.1.m1.1.1.3.3a.cmml" xref="Sx3.T1.5.5.1.m1.1.1.3.3"><mtext mathsize="70%" id="Sx3.T1.5.5.1.m1.1.1.3.3.cmml" xref="Sx3.T1.5.5.1.m1.1.1.3.3">out</mtext></ci></apply><apply id="Sx3.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.2">𝐯</ci><ci id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3a.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.2.3">in</mtext></ci></apply><apply id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.1.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.2">𝐪</ci><ci id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3a.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml" xref="Sx3.T1.5.5.1.m1.1.1.1.1.1.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.5.5.1.m1.1c">p_{\text{out}}(\mathbf{v}_{\text{in}}|\mathbf{q}_{\text{in}})</annotation></semantics></math> or <math id="Sx3.T1.6.6.2.m2.1" class="ltx_Math" alttext="p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})" display="inline"><semantics id="Sx3.T1.6.6.2.m2.1a"><mrow id="Sx3.T1.6.6.2.m2.1.1" xref="Sx3.T1.6.6.2.m2.1.1.cmml"><msub id="Sx3.T1.6.6.2.m2.1.1.3" xref="Sx3.T1.6.6.2.m2.1.1.3.cmml"><mi id="Sx3.T1.6.6.2.m2.1.1.3.2" xref="Sx3.T1.6.6.2.m2.1.1.3.2.cmml">p</mi><mtext id="Sx3.T1.6.6.2.m2.1.1.3.3" xref="Sx3.T1.6.6.2.m2.1.1.3.3a.cmml">out</mtext></msub><mo lspace="0em" rspace="0em" id="Sx3.T1.6.6.2.m2.1.1.2" xref="Sx3.T1.6.6.2.m2.1.1.2.cmml">​</mo><mrow id="Sx3.T1.6.6.2.m2.1.1.1.1" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.6.6.2.m2.1.1.1.1.2" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.T1.6.6.2.m2.1.1.1.1.1" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.cmml"><msub id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.cmml"><mi id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.2" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.2.cmml">𝐪</mi><mtext id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo fence="false" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.1" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.cmml"><mi id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.2" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.2.cmml">𝐯</mi><mtext id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3a.cmml">in</mtext></msub></mrow><mo stretchy="false" id="Sx3.T1.6.6.2.m2.1.1.1.1.3" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.6.6.2.m2.1b"><apply id="Sx3.T1.6.6.2.m2.1.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1"><times id="Sx3.T1.6.6.2.m2.1.1.2.cmml" xref="Sx3.T1.6.6.2.m2.1.1.2"></times><apply id="Sx3.T1.6.6.2.m2.1.1.3.cmml" xref="Sx3.T1.6.6.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.T1.6.6.2.m2.1.1.3.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1.3">subscript</csymbol><ci id="Sx3.T1.6.6.2.m2.1.1.3.2.cmml" xref="Sx3.T1.6.6.2.m2.1.1.3.2">𝑝</ci><ci id="Sx3.T1.6.6.2.m2.1.1.3.3a.cmml" xref="Sx3.T1.6.6.2.m2.1.1.3.3"><mtext mathsize="70%" id="Sx3.T1.6.6.2.m2.1.1.3.3.cmml" xref="Sx3.T1.6.6.2.m2.1.1.3.3">out</mtext></ci></apply><apply id="Sx3.T1.6.6.2.m2.1.1.1.1.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1"><csymbol cd="latexml" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.2.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.2">𝐪</ci><ci id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3a.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.2.3">in</mtext></ci></apply><apply id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.1.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.2.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.2">𝐯</ci><ci id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3a.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3"><mtext mathsize="70%" id="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3.cmml" xref="Sx3.T1.6.6.2.m2.1.1.1.1.1.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.6.6.2.m2.1c">p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})</annotation></semantics></math>
</td>
</tr>
<tr id="Sx3.T1.7.7" class="ltx_tr">
<th id="Sx3.T1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">5</th>
<td id="Sx3.T1.7.7.3" class="ltx_td ltx_align_center ltx_border_b">ID</td>
<td id="Sx3.T1.7.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">ID</td>
<td id="Sx3.T1.7.7.1" class="ltx_td ltx_align_center ltx_border_b"><math id="Sx3.T1.7.7.1.m1.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx3.T1.7.7.1.m1.1a"><mrow id="Sx3.T1.7.7.1.m1.1.1" xref="Sx3.T1.7.7.1.m1.1.1.cmml"><mi id="Sx3.T1.7.7.1.m1.1.1.3" xref="Sx3.T1.7.7.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.T1.7.7.1.m1.1.1.2" xref="Sx3.T1.7.7.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.T1.7.7.1.m1.1.1.1.1" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.T1.7.7.1.m1.1.1.1.1.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.T1.7.7.1.m1.1.1.1.1.1" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.cmml"><msub id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.cmml"><mi id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3a.cmml">out</mtext></msub><mo fence="false" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.3.cmml"><msub id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.2" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx3.T1.7.7.1.m1.1.1.1.1.3" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T1.7.7.1.m1.1b"><apply id="Sx3.T1.7.7.1.m1.1.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1"><times id="Sx3.T1.7.7.1.m1.1.1.2.cmml" xref="Sx3.T1.7.7.1.m1.1.1.2"></times><ci id="Sx3.T1.7.7.1.m1.1.1.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.3">𝑝</ci><apply id="Sx3.T1.7.7.1.m1.1.1.1.1.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.3">conditional</csymbol><apply id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.2.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3a.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.4.3">out</mtext></ci></apply><list id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2"><apply id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.T1.7.7.1.m1.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T1.7.7.1.m1.1c">p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Summary of anomalies in VQA according to ID (in-distribution), OOD (out-of-distribution), and abnormal distribution.</figcaption>
</figure>
<section id="Sx3.SSx1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Task 1: Image from Out-of-Distribution</h4>

<div id="Sx3.SSx1.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.SSSx1.p1.1" class="ltx_p">Task 1 detects the first type of anomalies whose images are from OOD, <math id="Sx3.SSx1.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx3.SSx1.SSSx1.p1.1.m1.1a"><mrow id="Sx3.SSx1.SSSx1.p1.1.m1.1.1" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.3" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.2" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.2" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx1.p1.1.m1.1b"><apply id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1"><times id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.2"></times><ci id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.SSSx1.p1.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx1.p1.1.m1.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math>.
Thus, they are different from images in the original VQA dataset <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al. <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>.
Then, OOD images can have different visual characteristics, such as different objects, colors, or resolutions.
VQA assumes that an input image contains visual objects in various contexts of the real-world <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib23" title="" class="ltx_ref">2014</a>)</cite>.
However, VQA models can encounter an OOD image when the image is highly corrupted or selected by users’ mistake.</p>
</div>
<div id="Sx3.SSx1.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx1.SSSx1.p2.1" class="ltx_p">Even though an input image is from OOD but answerable to its question, OOD images need to be detected regardless of the answerability.
In other words, VQA models are susceptible to OOD images and tend to provide arbitrary predictions with high confidence.
We observe that VQA models often predict unreliable and over-confident answers on an OOD image even if it has the correct answer to the question.
For example, the BUTD model <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite> always replies that there is no number in MNIST images regardless of the questions, and the confidences scores are high (Fig. <a href="#Sx3.F3" title="Figure 3 ‣ Out-of-distribution Image &amp; Question ‣ Definition of Anomalies in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
Including the examples in Fig. <a href="#Sx2.F2" title="Figure 2 ‣ The Framework of VQA Models ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#Sx3.F3" title="Figure 3 ‣ Out-of-distribution Image &amp; Question ‣ Definition of Anomalies in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our experiments also contain more realistic OOD images, such as real-world visual objects with low resolution.</p>
</div>
</section>
<section id="Sx3.SSx1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Task 2: Question from Out-of-distribution</h4>

<div id="Sx3.SSx1.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx1.SSSx2.p1.1" class="ltx_p">Task 2 detects the second type of anomalies whose questions are from OOD, <math id="Sx3.SSx1.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx3.SSx1.SSSx2.p1.1.m1.1a"><mrow id="Sx3.SSx1.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.2" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.2" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx2.p1.1.m1.1b"><apply id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1"><times id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.2"></times><ci id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.2">𝐪</ci><ci id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.SSSx2.p1.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx2.p1.1.m1.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math>.
An OOD question means a non-question sentence without interrogatives.
Questions, such as ”Is there a red sandal here?” or ”What color is the airliner?”, are expected in VQA.
However, after the deployment of the model, VQA models can encounter non-question sentences unconsidered at training time.
When VQA models take a non-question sentence, they have to detect and refuse to answer the input, since there is no right answer to the non-question sentence.
In this task, we evaluate whether a VQA model can distinguish such OOD questions from normal ones.</p>
</div>
</section>
<section id="Sx3.SSx1.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Task 3: Image/Question from Out-of-Distribution</h4>

<div id="Sx3.SSx1.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx1.SSSx3.p1.2" class="ltx_p">Task 3 detects the third type of anomalies where image and question are both from out-of-distribution, <math id="Sx3.SSx1.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx3.SSx1.SSSx3.p1.1.m1.1a"><mrow id="Sx3.SSx1.SSSx3.p1.1.m1.1.1" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.3" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.2" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.2" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx3.p1.1.m1.1b"><apply id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1"><times id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.2"></times><ci id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.SSSx3.p1.1.m1.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx3.p1.1.m1.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math> and <math id="Sx3.SSx1.SSSx3.p1.2.m2.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx3.SSx1.SSSx3.p1.2.m2.1a"><mrow id="Sx3.SSx1.SSSx3.p1.2.m2.1.1" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.3" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.2" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.2" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.2" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.3" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.SSSx3.p1.2.m2.1b"><apply id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1"><times id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.2"></times><ci id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.3">𝑝</ci><apply id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.2">𝐪</ci><ci id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3a.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.SSSx3.p1.2.m2.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.SSSx3.p1.2.m2.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math>.
Although this situation is rare in the real-world, including this task considers extreme cases, making our categorization of anomalies in VQA complete.</p>
</div>
</section>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Unanswerable Pair of Image &amp; Question</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.2" class="ltx_p">Although both image and question are from in-distribution, <math id="Sx3.SSx2.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{in}})" display="inline"><semantics id="Sx3.SSx2.p1.1.m1.1a"><mrow id="Sx3.SSx2.p1.1.m1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx2.p1.1.m1.1.1.3" xref="Sx3.SSx2.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.1.m1.1.1.2" xref="Sx3.SSx2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.p1.1.m1.1.1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx2.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.1.m1.1b"><apply id="Sx3.SSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1"><times id="Sx3.SSx2.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.2"></times><ci id="Sx3.SSx2.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3a.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.1.m1.1.1.1.1.1.3">in</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.1.m1.1c">p(\mathbf{v}_{\text{in}})</annotation></semantics></math> and <math id="Sx3.SSx2.p1.2.m2.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx3.SSx2.p1.2.m2.1a"><mrow id="Sx3.SSx2.p1.2.m2.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx2.p1.2.m2.1.1.3" xref="Sx3.SSx2.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.2.m2.1.1.2" xref="Sx3.SSx2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.p1.2.m2.1.1.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.2.m2.1.1.1.1.2" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx2.p1.2.m2.1.1.1.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.2" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3a.cmml">in</mtext></msub><mo stretchy="false" id="Sx3.SSx2.p1.2.m2.1.1.1.1.3" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.2.m2.1b"><apply id="Sx3.SSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1"><times id="Sx3.SSx2.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.2"></times><ci id="Sx3.SSx2.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.3">𝑝</ci><apply id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.2">𝐪</ci><ci id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3a.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.1.3">in</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.2.m2.1c">p(\mathbf{q}_{\text{in}})</annotation></semantics></math>, the pair of image and question can be an anomaly, which is unanswerable by a VQA model.
Unanswerable situations occur when the correct answer does not exist because of question irrelevance or the limited capability of the VQA model.
Note that unanswerable pairs are the most frequent and realistic anomalies, because each image and question is similar to training samples.</p>
</div>
<section id="Sx3.SSx2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Task 4: Irrelevant Question</h4>

<div id="Sx3.SSx2.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p1.1" class="ltx_p">Task 4 detects the fourth type of anomalies where each sample has a question irrelevant to the image.
Different from OOD questions, irrelevant questions are sentences with interrogatives.
However, the questions are unrelated to the given input images.
Out-of-domain questions <cite class="ltx_cite ltx_citemacro_citep">(Kamath, Jia, and Liang <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> are also included in this task, because we define out-of-distribution questions as non-question types of sentences.
Although both image and question are from in-distribution, an irrelevant pair of image and question is from out of joint distribution, <math id="Sx3.SSx2.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.1.m1.1a"><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.cmml"><msub id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2.cmml">p</mi><mtext id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3a.cmml">out</mtext></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml"><msub id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2.cmml">𝐪</mi><mtext id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo fence="false" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.2.cmml">𝐯</mi><mtext id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3a.cmml">in</mtext></msub></mrow><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.1.m1.1b"><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1"><times id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2"></times><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3">subscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2">𝑝</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3a.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3">out</mtext></ci></apply><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2">𝐪</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3a.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3">in</mtext></ci></apply><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.2">𝐯</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3a.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.1.m1.1c">p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx2.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p2.1" class="ltx_p">If the image and the question are unrelated to each other, the correct answer requires either external knowledge or does not exist <cite class="ltx_cite ltx_citemacro_citep">(Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>.
For example, a non-visual question, “Who is the president of the USA?,” requires general knowledge irrelevant to the input image.
Moreover, when a question has a visual false-promise, which means that an object implied by the question does not exist in the image, there is no correct answer for the given image and question pair.
In Fig. <a href="#Sx2.F2" title="Figure 2 ‣ The Framework of VQA Models ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the question asks about an airliner, but no airliner exists in the image.</p>
</div>
</section>
<section id="Sx3.SSx2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Task 5: Undefined Answer</h4>

<div id="Sx3.SSx2.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx2.p1.1" class="ltx_p">Task 5 detects the fifth type of anomalies where each sample has an undefined answer, which is not among the answer candidates of a VQA model and is from <math id="Sx3.SSx2.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.1.m1.1a"><mrow id="Sx3.SSx2.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.cmml"><msub id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.cmml"><mi id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3a.cmml">out</mtext></msub><mo fence="false" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.3.cmml"><msub id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.1.m1.1b"><apply id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1"><times id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.2"></times><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.3">conditional</csymbol><apply id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.2.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3a.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.4.3">out</mtext></ci></apply><list id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2"><apply id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.1.m1.1c">p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math>.
Considering VQA as a prediction task, answer candidates are predefined, and some answers that rarely appear in training data are excluded from answer candidates to improve training efficiency and accuracy <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>.
Thus, the unanswerability of samples with an undefined answer results not from any abnormality of the input pairs, but from the limited predefined answer candidates.
The main reasons for rare answers are ambiguous questions, synonyms, and granularity of answers <cite class="ltx_cite ltx_citemacro_citep">(Bhattacharya, Li, and Gurari <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>, reading numbers or texts.
For example, in Fig. <a href="#Sx2.F2" title="Figure 2 ‣ The Framework of VQA Models ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the correct answer is “reduce speed,” but that answer is not defined in the VQA model because of its rare occurrence.</p>
</div>
</section>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Anomaly Detection in VQA</h2>

<div id="Sx4.p1" class="ltx_para">
<p id="Sx4.p1.1" class="ltx_p">In this section, we show how VQA models detect various anomalies without the addition of an extra model or modification of the model architecture.
First, we introduce a confidence-based anomaly detector and its limitation to detect various anomalies in VQA.
Then, we propose the <span id="Sx4.p1.1.1" class="ltx_text ltx_font_italic">maximum attention score</span> as the confidence of reasoning to calibrate the predictive confidence of an input pair of an image and a question.
How to further classify the types of detected anomalies is interesting future work.</p>
</div>
<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Confidence-based Anomaly Detector</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.4" class="ltx_p">A confidence-based anomaly detector <math id="Sx4.SSx1.p1.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="Sx4.SSx1.p1.1.m1.1a"><mi id="Sx4.SSx1.p1.1.m1.1.1" xref="Sx4.SSx1.p1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.1.m1.1b"><ci id="Sx4.SSx1.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.p1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.1.m1.1c">g</annotation></semantics></math> determines an input pair <math id="Sx4.SSx1.p1.2.m2.2" class="ltx_Math" alttext="(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx1.p1.2.m2.2a"><mrow id="Sx4.SSx1.p1.2.m2.2.3.2" xref="Sx4.SSx1.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p1.2.m2.2.3.2.1" xref="Sx4.SSx1.p1.2.m2.2.3.1.cmml">(</mo><mi id="Sx4.SSx1.p1.2.m2.1.1" xref="Sx4.SSx1.p1.2.m2.1.1.cmml">𝐯</mi><mo id="Sx4.SSx1.p1.2.m2.2.3.2.2" xref="Sx4.SSx1.p1.2.m2.2.3.1.cmml">,</mo><mi id="Sx4.SSx1.p1.2.m2.2.2" xref="Sx4.SSx1.p1.2.m2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx1.p1.2.m2.2.3.2.3" xref="Sx4.SSx1.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.2.m2.2b"><interval closure="open" id="Sx4.SSx1.p1.2.m2.2.3.1.cmml" xref="Sx4.SSx1.p1.2.m2.2.3.2"><ci id="Sx4.SSx1.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.p1.2.m2.1.1">𝐯</ci><ci id="Sx4.SSx1.p1.2.m2.2.2.cmml" xref="Sx4.SSx1.p1.2.m2.2.2">𝐪</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.2.m2.2c">(\mathbf{v},\mathbf{q})</annotation></semantics></math> as anomalous if the predictive confidence <math id="Sx4.SSx1.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx4.SSx1.p1.3.m3.1a"><mi id="Sx4.SSx1.p1.3.m3.1.1" xref="Sx4.SSx1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.3.m3.1b"><ci id="Sx4.SSx1.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.3.m3.1c">S</annotation></semantics></math> is under threshold <math id="Sx4.SSx1.p1.4.m4.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="Sx4.SSx1.p1.4.m4.1a"><mi id="Sx4.SSx1.p1.4.m4.1.1" xref="Sx4.SSx1.p1.4.m4.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.4.m4.1b"><ci id="Sx4.SSx1.p1.4.m4.1.1.cmml" xref="Sx4.SSx1.p1.4.m4.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.4.m4.1c">\delta</annotation></semantics></math>:</p>
<table id="Sx4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E2.m1.4" class="ltx_Math" alttext="g(\mathbf{v},\mathbf{q})=\left\{\begin{array}[]{ll}{1}&{\text{ if }S({\mathbf{v},\mathbf{q}})\leq\delta}\\
{0}&{\text{else }}\end{array}\right." display="block"><semantics id="Sx4.E2.m1.4a"><mrow id="Sx4.E2.m1.4.5" xref="Sx4.E2.m1.4.5.cmml"><mrow id="Sx4.E2.m1.4.5.2" xref="Sx4.E2.m1.4.5.2.cmml"><mi id="Sx4.E2.m1.4.5.2.2" xref="Sx4.E2.m1.4.5.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx4.E2.m1.4.5.2.1" xref="Sx4.E2.m1.4.5.2.1.cmml">​</mo><mrow id="Sx4.E2.m1.4.5.2.3.2" xref="Sx4.E2.m1.4.5.2.3.1.cmml"><mo stretchy="false" id="Sx4.E2.m1.4.5.2.3.2.1" xref="Sx4.E2.m1.4.5.2.3.1.cmml">(</mo><mi id="Sx4.E2.m1.3.3" xref="Sx4.E2.m1.3.3.cmml">𝐯</mi><mo id="Sx4.E2.m1.4.5.2.3.2.2" xref="Sx4.E2.m1.4.5.2.3.1.cmml">,</mo><mi id="Sx4.E2.m1.4.4" xref="Sx4.E2.m1.4.4.cmml">𝐪</mi><mo stretchy="false" id="Sx4.E2.m1.4.5.2.3.2.3" xref="Sx4.E2.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E2.m1.4.5.1" xref="Sx4.E2.m1.4.5.1.cmml">=</mo><mrow id="Sx4.E2.m1.4.5.3.2" xref="Sx4.E2.m1.4.5.3.1.cmml"><mo id="Sx4.E2.m1.4.5.3.2.1" xref="Sx4.E2.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="Sx4.E2.m1.2.2" xref="Sx4.E2.m1.2.2.cmml"><mtr id="Sx4.E2.m1.2.2a" xref="Sx4.E2.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="Sx4.E2.m1.2.2b" xref="Sx4.E2.m1.2.2.cmml"><mn id="Sx4.E2.m1.2.2.2.3.1" xref="Sx4.E2.m1.2.2.2.3.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx4.E2.m1.2.2c" xref="Sx4.E2.m1.2.2.cmml"><mrow id="Sx4.E2.m1.2.2.2.2.2" xref="Sx4.E2.m1.2.2.2.2.2.cmml"><mrow id="Sx4.E2.m1.2.2.2.2.2.4" xref="Sx4.E2.m1.2.2.2.2.2.4.cmml"><mtext id="Sx4.E2.m1.2.2.2.2.2.4.2" xref="Sx4.E2.m1.2.2.2.2.2.4.2a.cmml"> if </mtext><mo lspace="0em" rspace="0em" id="Sx4.E2.m1.2.2.2.2.2.4.1" xref="Sx4.E2.m1.2.2.2.2.2.4.1.cmml">​</mo><mi id="Sx4.E2.m1.2.2.2.2.2.4.3" xref="Sx4.E2.m1.2.2.2.2.2.4.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx4.E2.m1.2.2.2.2.2.4.1a" xref="Sx4.E2.m1.2.2.2.2.2.4.1.cmml">​</mo><mrow id="Sx4.E2.m1.2.2.2.2.2.4.4.2" xref="Sx4.E2.m1.2.2.2.2.2.4.4.1.cmml"><mo stretchy="false" id="Sx4.E2.m1.2.2.2.2.2.4.4.2.1" xref="Sx4.E2.m1.2.2.2.2.2.4.4.1.cmml">(</mo><mi id="Sx4.E2.m1.1.1.1.1.1.1" xref="Sx4.E2.m1.1.1.1.1.1.1.cmml">𝐯</mi><mo id="Sx4.E2.m1.2.2.2.2.2.4.4.2.2" xref="Sx4.E2.m1.2.2.2.2.2.4.4.1.cmml">,</mo><mi id="Sx4.E2.m1.2.2.2.2.2.2" xref="Sx4.E2.m1.2.2.2.2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.E2.m1.2.2.2.2.2.4.4.2.3" xref="Sx4.E2.m1.2.2.2.2.2.4.4.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E2.m1.2.2.2.2.2.3" xref="Sx4.E2.m1.2.2.2.2.2.3.cmml">≤</mo><mi id="Sx4.E2.m1.2.2.2.2.2.5" xref="Sx4.E2.m1.2.2.2.2.2.5.cmml">δ</mi></mrow></mtd></mtr><mtr id="Sx4.E2.m1.2.2d" xref="Sx4.E2.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="Sx4.E2.m1.2.2e" xref="Sx4.E2.m1.2.2.cmml"><mn id="Sx4.E2.m1.2.2.3.1.1" xref="Sx4.E2.m1.2.2.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx4.E2.m1.2.2f" xref="Sx4.E2.m1.2.2.cmml"><mtext id="Sx4.E2.m1.2.2.3.2.1" xref="Sx4.E2.m1.2.2.3.2.1a.cmml">else </mtext></mtd></mtr></mtable><mi id="Sx4.E2.m1.4.5.3.2.2" xref="Sx4.E2.m1.4.5.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E2.m1.4b"><apply id="Sx4.E2.m1.4.5.cmml" xref="Sx4.E2.m1.4.5"><eq id="Sx4.E2.m1.4.5.1.cmml" xref="Sx4.E2.m1.4.5.1"></eq><apply id="Sx4.E2.m1.4.5.2.cmml" xref="Sx4.E2.m1.4.5.2"><times id="Sx4.E2.m1.4.5.2.1.cmml" xref="Sx4.E2.m1.4.5.2.1"></times><ci id="Sx4.E2.m1.4.5.2.2.cmml" xref="Sx4.E2.m1.4.5.2.2">𝑔</ci><interval closure="open" id="Sx4.E2.m1.4.5.2.3.1.cmml" xref="Sx4.E2.m1.4.5.2.3.2"><ci id="Sx4.E2.m1.3.3.cmml" xref="Sx4.E2.m1.3.3">𝐯</ci><ci id="Sx4.E2.m1.4.4.cmml" xref="Sx4.E2.m1.4.4">𝐪</ci></interval></apply><apply id="Sx4.E2.m1.4.5.3.1.cmml" xref="Sx4.E2.m1.4.5.3.2"><csymbol cd="latexml" id="Sx4.E2.m1.4.5.3.1.1.cmml" xref="Sx4.E2.m1.4.5.3.2.1">cases</csymbol><matrix id="Sx4.E2.m1.2.2.cmml" xref="Sx4.E2.m1.2.2"><matrixrow id="Sx4.E2.m1.2.2a.cmml" xref="Sx4.E2.m1.2.2"><cn type="integer" id="Sx4.E2.m1.2.2.2.3.1.cmml" xref="Sx4.E2.m1.2.2.2.3.1">1</cn><apply id="Sx4.E2.m1.2.2.2.2.2.cmml" xref="Sx4.E2.m1.2.2.2.2.2"><leq id="Sx4.E2.m1.2.2.2.2.2.3.cmml" xref="Sx4.E2.m1.2.2.2.2.2.3"></leq><apply id="Sx4.E2.m1.2.2.2.2.2.4.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4"><times id="Sx4.E2.m1.2.2.2.2.2.4.1.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4.1"></times><ci id="Sx4.E2.m1.2.2.2.2.2.4.2a.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4.2"><mtext id="Sx4.E2.m1.2.2.2.2.2.4.2.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4.2"> if </mtext></ci><ci id="Sx4.E2.m1.2.2.2.2.2.4.3.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4.3">𝑆</ci><interval closure="open" id="Sx4.E2.m1.2.2.2.2.2.4.4.1.cmml" xref="Sx4.E2.m1.2.2.2.2.2.4.4.2"><ci id="Sx4.E2.m1.1.1.1.1.1.1.cmml" xref="Sx4.E2.m1.1.1.1.1.1.1">𝐯</ci><ci id="Sx4.E2.m1.2.2.2.2.2.2.cmml" xref="Sx4.E2.m1.2.2.2.2.2.2">𝐪</ci></interval></apply><ci id="Sx4.E2.m1.2.2.2.2.2.5.cmml" xref="Sx4.E2.m1.2.2.2.2.2.5">𝛿</ci></apply></matrixrow><matrixrow id="Sx4.E2.m1.2.2b.cmml" xref="Sx4.E2.m1.2.2"><cn type="integer" id="Sx4.E2.m1.2.2.3.1.1.cmml" xref="Sx4.E2.m1.2.2.3.1.1">0</cn><ci id="Sx4.E2.m1.2.2.3.2.1a.cmml" xref="Sx4.E2.m1.2.2.3.2.1"><mtext id="Sx4.E2.m1.2.2.3.2.1.cmml" xref="Sx4.E2.m1.2.2.3.2.1">else </mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E2.m1.4c">g(\mathbf{v},\mathbf{q})=\left\{\begin{array}[]{ll}{1}&amp;{\text{ if }S({\mathbf{v},\mathbf{q}})\leq\delta}\\
{0}&amp;{\text{else }}\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx1.p1.5" class="ltx_p">To determine the threshold <math id="Sx4.SSx1.p1.5.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="Sx4.SSx1.p1.5.m1.1a"><mi id="Sx4.SSx1.p1.5.m1.1.1" xref="Sx4.SSx1.p1.5.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.5.m1.1b"><ci id="Sx4.SSx1.p1.5.m1.1.1.cmml" xref="Sx4.SSx1.p1.5.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.5.m1.1c">\delta</annotation></semantics></math> in this anomaly detector, an additional validation dataset can be used in practice.</p>
</div>
<div id="Sx4.SSx1.p2" class="ltx_para">
<p id="Sx4.SSx1.p2.1" class="ltx_p">To compute the confidence <math id="Sx4.SSx1.p2.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx4.SSx1.p2.1.m1.1a"><mi id="Sx4.SSx1.p2.1.m1.1.1" xref="Sx4.SSx1.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.1.m1.1b"><ci id="Sx4.SSx1.p2.1.m1.1.1.cmml" xref="Sx4.SSx1.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.1.m1.1c">S</annotation></semantics></math> in DNNs, the maximum value of softmax in the output layer (MSP) is commonly used <cite class="ltx_cite ltx_citemacro_citep">(Settles <a href="#bib.bib33" title="" class="ltx_ref">2009</a>; Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>.</p>
<table id="A5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx4.Ex1.m1.3" class="ltx_Math" alttext="\displaystyle S({\mathbf{v},\mathbf{q}};T)" display="inline"><semantics id="Sx4.Ex1.m1.3a"><mrow id="Sx4.Ex1.m1.3.4" xref="Sx4.Ex1.m1.3.4.cmml"><mi id="Sx4.Ex1.m1.3.4.2" xref="Sx4.Ex1.m1.3.4.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx4.Ex1.m1.3.4.1" xref="Sx4.Ex1.m1.3.4.1.cmml">​</mo><mrow id="Sx4.Ex1.m1.3.4.3.2" xref="Sx4.Ex1.m1.3.4.3.1.cmml"><mo stretchy="false" id="Sx4.Ex1.m1.3.4.3.2.1" xref="Sx4.Ex1.m1.3.4.3.1.cmml">(</mo><mi id="Sx4.Ex1.m1.1.1" xref="Sx4.Ex1.m1.1.1.cmml">𝐯</mi><mo id="Sx4.Ex1.m1.3.4.3.2.2" xref="Sx4.Ex1.m1.3.4.3.1.cmml">,</mo><mi id="Sx4.Ex1.m1.2.2" xref="Sx4.Ex1.m1.2.2.cmml">𝐪</mi><mo id="Sx4.Ex1.m1.3.4.3.2.3" xref="Sx4.Ex1.m1.3.4.3.1.cmml">;</mo><mi id="Sx4.Ex1.m1.3.3" xref="Sx4.Ex1.m1.3.3.cmml">T</mi><mo stretchy="false" id="Sx4.Ex1.m1.3.4.3.2.4" xref="Sx4.Ex1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex1.m1.3b"><apply id="Sx4.Ex1.m1.3.4.cmml" xref="Sx4.Ex1.m1.3.4"><times id="Sx4.Ex1.m1.3.4.1.cmml" xref="Sx4.Ex1.m1.3.4.1"></times><ci id="Sx4.Ex1.m1.3.4.2.cmml" xref="Sx4.Ex1.m1.3.4.2">𝑆</ci><vector id="Sx4.Ex1.m1.3.4.3.1.cmml" xref="Sx4.Ex1.m1.3.4.3.2"><ci id="Sx4.Ex1.m1.1.1.cmml" xref="Sx4.Ex1.m1.1.1">𝐯</ci><ci id="Sx4.Ex1.m1.2.2.cmml" xref="Sx4.Ex1.m1.2.2">𝐪</ci><ci id="Sx4.Ex1.m1.3.3.cmml" xref="Sx4.Ex1.m1.3.3">𝑇</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex1.m1.3c">\displaystyle S({\mathbf{v},\mathbf{q}};T)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx4.Ex1.m2.4" class="ltx_Math" alttext="\displaystyle=\max_{i}{p_{\theta}(\mathbf{a}_{i}|\mathbf{v},\mathbf{q};T)}" display="inline"><semantics id="Sx4.Ex1.m2.4a"><mrow id="Sx4.Ex1.m2.4.4" xref="Sx4.Ex1.m2.4.4.cmml"><mi id="Sx4.Ex1.m2.4.4.3" xref="Sx4.Ex1.m2.4.4.3.cmml"></mi><mo id="Sx4.Ex1.m2.4.4.2" xref="Sx4.Ex1.m2.4.4.2.cmml">=</mo><mrow id="Sx4.Ex1.m2.4.4.1" xref="Sx4.Ex1.m2.4.4.1.cmml"><mrow id="Sx4.Ex1.m2.4.4.1.3" xref="Sx4.Ex1.m2.4.4.1.3.cmml"><munder id="Sx4.Ex1.m2.4.4.1.3.1" xref="Sx4.Ex1.m2.4.4.1.3.1.cmml"><mi id="Sx4.Ex1.m2.4.4.1.3.1.2" xref="Sx4.Ex1.m2.4.4.1.3.1.2.cmml">max</mi><mi id="Sx4.Ex1.m2.4.4.1.3.1.3" xref="Sx4.Ex1.m2.4.4.1.3.1.3.cmml">i</mi></munder><mo lspace="0.167em" id="Sx4.Ex1.m2.4.4.1.3a" xref="Sx4.Ex1.m2.4.4.1.3.cmml">⁡</mo><msub id="Sx4.Ex1.m2.4.4.1.3.2" xref="Sx4.Ex1.m2.4.4.1.3.2.cmml"><mi id="Sx4.Ex1.m2.4.4.1.3.2.2" xref="Sx4.Ex1.m2.4.4.1.3.2.2.cmml">p</mi><mi id="Sx4.Ex1.m2.4.4.1.3.2.3" xref="Sx4.Ex1.m2.4.4.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx4.Ex1.m2.4.4.1.2" xref="Sx4.Ex1.m2.4.4.1.2.cmml">​</mo><mrow id="Sx4.Ex1.m2.4.4.1.1.1" xref="Sx4.Ex1.m2.4.4.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.Ex1.m2.4.4.1.1.1.2" xref="Sx4.Ex1.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="Sx4.Ex1.m2.4.4.1.1.1.1" xref="Sx4.Ex1.m2.4.4.1.1.1.1.cmml"><msub id="Sx4.Ex1.m2.4.4.1.1.1.1.2" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2.cmml"><mi id="Sx4.Ex1.m2.4.4.1.1.1.1.2.2" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2.2.cmml">𝐚</mi><mi id="Sx4.Ex1.m2.4.4.1.1.1.1.2.3" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="Sx4.Ex1.m2.4.4.1.1.1.1.1" xref="Sx4.Ex1.m2.4.4.1.1.1.1.1.cmml">|</mo><mrow id="Sx4.Ex1.m2.4.4.1.1.1.1.3.2" xref="Sx4.Ex1.m2.4.4.1.1.1.1.3.1.cmml"><mi id="Sx4.Ex1.m2.1.1" xref="Sx4.Ex1.m2.1.1.cmml">𝐯</mi><mo id="Sx4.Ex1.m2.4.4.1.1.1.1.3.2.1" xref="Sx4.Ex1.m2.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="Sx4.Ex1.m2.2.2" xref="Sx4.Ex1.m2.2.2.cmml">𝐪</mi><mo id="Sx4.Ex1.m2.4.4.1.1.1.1.3.2.2" xref="Sx4.Ex1.m2.4.4.1.1.1.1.3.1.cmml">;</mo><mi id="Sx4.Ex1.m2.3.3" xref="Sx4.Ex1.m2.3.3.cmml">T</mi></mrow></mrow><mo stretchy="false" id="Sx4.Ex1.m2.4.4.1.1.1.3" xref="Sx4.Ex1.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex1.m2.4b"><apply id="Sx4.Ex1.m2.4.4.cmml" xref="Sx4.Ex1.m2.4.4"><eq id="Sx4.Ex1.m2.4.4.2.cmml" xref="Sx4.Ex1.m2.4.4.2"></eq><csymbol cd="latexml" id="Sx4.Ex1.m2.4.4.3.cmml" xref="Sx4.Ex1.m2.4.4.3">absent</csymbol><apply id="Sx4.Ex1.m2.4.4.1.cmml" xref="Sx4.Ex1.m2.4.4.1"><times id="Sx4.Ex1.m2.4.4.1.2.cmml" xref="Sx4.Ex1.m2.4.4.1.2"></times><apply id="Sx4.Ex1.m2.4.4.1.3.cmml" xref="Sx4.Ex1.m2.4.4.1.3"><apply id="Sx4.Ex1.m2.4.4.1.3.1.cmml" xref="Sx4.Ex1.m2.4.4.1.3.1"><csymbol cd="ambiguous" id="Sx4.Ex1.m2.4.4.1.3.1.1.cmml" xref="Sx4.Ex1.m2.4.4.1.3.1">subscript</csymbol><max id="Sx4.Ex1.m2.4.4.1.3.1.2.cmml" xref="Sx4.Ex1.m2.4.4.1.3.1.2"></max><ci id="Sx4.Ex1.m2.4.4.1.3.1.3.cmml" xref="Sx4.Ex1.m2.4.4.1.3.1.3">𝑖</ci></apply><apply id="Sx4.Ex1.m2.4.4.1.3.2.cmml" xref="Sx4.Ex1.m2.4.4.1.3.2"><csymbol cd="ambiguous" id="Sx4.Ex1.m2.4.4.1.3.2.1.cmml" xref="Sx4.Ex1.m2.4.4.1.3.2">subscript</csymbol><ci id="Sx4.Ex1.m2.4.4.1.3.2.2.cmml" xref="Sx4.Ex1.m2.4.4.1.3.2.2">𝑝</ci><ci id="Sx4.Ex1.m2.4.4.1.3.2.3.cmml" xref="Sx4.Ex1.m2.4.4.1.3.2.3">𝜃</ci></apply></apply><apply id="Sx4.Ex1.m2.4.4.1.1.1.1.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1"><csymbol cd="latexml" id="Sx4.Ex1.m2.4.4.1.1.1.1.1.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.1">conditional</csymbol><apply id="Sx4.Ex1.m2.4.4.1.1.1.1.2.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.Ex1.m2.4.4.1.1.1.1.2.1.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2">subscript</csymbol><ci id="Sx4.Ex1.m2.4.4.1.1.1.1.2.2.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2.2">𝐚</ci><ci id="Sx4.Ex1.m2.4.4.1.1.1.1.2.3.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.2.3">𝑖</ci></apply><list id="Sx4.Ex1.m2.4.4.1.1.1.1.3.1.cmml" xref="Sx4.Ex1.m2.4.4.1.1.1.1.3.2"><ci id="Sx4.Ex1.m2.1.1.cmml" xref="Sx4.Ex1.m2.1.1">𝐯</ci><ci id="Sx4.Ex1.m2.2.2.cmml" xref="Sx4.Ex1.m2.2.2">𝐪</ci><ci id="Sx4.Ex1.m2.3.3.cmml" xref="Sx4.Ex1.m2.3.3">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex1.m2.4c">\displaystyle=\max_{i}{p_{\theta}(\mathbf{a}_{i}|\mathbf{v},\mathbf{q};T)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx4.E3.m1.7" class="ltx_Math" alttext="\displaystyle=\max_{i}{\frac{\text{exp}(f_{i}({\mathbf{v},\mathbf{q}})/T)}{\sum_{j=1}^{N}{\text{exp}(f_{j}({\mathbf{v},\mathbf{q}})/T)}}}," display="inline"><semantics id="Sx4.E3.m1.7a"><mrow id="Sx4.E3.m1.7.7.1" xref="Sx4.E3.m1.7.7.1.1.cmml"><mrow id="Sx4.E3.m1.7.7.1.1" xref="Sx4.E3.m1.7.7.1.1.cmml"><mi id="Sx4.E3.m1.7.7.1.1.2" xref="Sx4.E3.m1.7.7.1.1.2.cmml"></mi><mo id="Sx4.E3.m1.7.7.1.1.1" xref="Sx4.E3.m1.7.7.1.1.1.cmml">=</mo><mrow id="Sx4.E3.m1.7.7.1.1.3" xref="Sx4.E3.m1.7.7.1.1.3.cmml"><munder id="Sx4.E3.m1.7.7.1.1.3.1" xref="Sx4.E3.m1.7.7.1.1.3.1.cmml"><mi id="Sx4.E3.m1.7.7.1.1.3.1.2" xref="Sx4.E3.m1.7.7.1.1.3.1.2.cmml">max</mi><mi id="Sx4.E3.m1.7.7.1.1.3.1.3" xref="Sx4.E3.m1.7.7.1.1.3.1.3.cmml">i</mi></munder><mo lspace="0.167em" id="Sx4.E3.m1.7.7.1.1.3a" xref="Sx4.E3.m1.7.7.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="Sx4.E3.m1.6.6" xref="Sx4.E3.m1.6.6.cmml"><mfrac id="Sx4.E3.m1.6.6a" xref="Sx4.E3.m1.6.6.cmml"><mrow id="Sx4.E3.m1.3.3.3" xref="Sx4.E3.m1.3.3.3.cmml"><mtext id="Sx4.E3.m1.3.3.3.5" xref="Sx4.E3.m1.3.3.3.5a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="Sx4.E3.m1.3.3.3.4" xref="Sx4.E3.m1.3.3.3.4.cmml">​</mo><mrow id="Sx4.E3.m1.3.3.3.3.1" xref="Sx4.E3.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="Sx4.E3.m1.3.3.3.3.1.2" xref="Sx4.E3.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="Sx4.E3.m1.3.3.3.3.1.1" xref="Sx4.E3.m1.3.3.3.3.1.1.cmml"><mrow id="Sx4.E3.m1.3.3.3.3.1.1.2" xref="Sx4.E3.m1.3.3.3.3.1.1.2.cmml"><msub id="Sx4.E3.m1.3.3.3.3.1.1.2.2" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2.cmml"><mi id="Sx4.E3.m1.3.3.3.3.1.1.2.2.2" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2.2.cmml">f</mi><mi id="Sx4.E3.m1.3.3.3.3.1.1.2.2.3" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx4.E3.m1.3.3.3.3.1.1.2.1" xref="Sx4.E3.m1.3.3.3.3.1.1.2.1.cmml">​</mo><mrow id="Sx4.E3.m1.3.3.3.3.1.1.2.3.2" xref="Sx4.E3.m1.3.3.3.3.1.1.2.3.1.cmml"><mo stretchy="false" id="Sx4.E3.m1.3.3.3.3.1.1.2.3.2.1" xref="Sx4.E3.m1.3.3.3.3.1.1.2.3.1.cmml">(</mo><mi id="Sx4.E3.m1.1.1.1.1" xref="Sx4.E3.m1.1.1.1.1.cmml">𝐯</mi><mo id="Sx4.E3.m1.3.3.3.3.1.1.2.3.2.2" xref="Sx4.E3.m1.3.3.3.3.1.1.2.3.1.cmml">,</mo><mi id="Sx4.E3.m1.2.2.2.2" xref="Sx4.E3.m1.2.2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.E3.m1.3.3.3.3.1.1.2.3.2.3" xref="Sx4.E3.m1.3.3.3.3.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E3.m1.3.3.3.3.1.1.1" xref="Sx4.E3.m1.3.3.3.3.1.1.1.cmml">/</mo><mi id="Sx4.E3.m1.3.3.3.3.1.1.3" xref="Sx4.E3.m1.3.3.3.3.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="Sx4.E3.m1.3.3.3.3.1.3" xref="Sx4.E3.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="Sx4.E3.m1.6.6.6" xref="Sx4.E3.m1.6.6.6.cmml"><msubsup id="Sx4.E3.m1.6.6.6.4" xref="Sx4.E3.m1.6.6.6.4.cmml"><mo id="Sx4.E3.m1.6.6.6.4.2.2" xref="Sx4.E3.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="Sx4.E3.m1.6.6.6.4.2.3" xref="Sx4.E3.m1.6.6.6.4.2.3.cmml"><mi id="Sx4.E3.m1.6.6.6.4.2.3.2" xref="Sx4.E3.m1.6.6.6.4.2.3.2.cmml">j</mi><mo id="Sx4.E3.m1.6.6.6.4.2.3.1" xref="Sx4.E3.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="Sx4.E3.m1.6.6.6.4.2.3.3" xref="Sx4.E3.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E3.m1.6.6.6.4.3" xref="Sx4.E3.m1.6.6.6.4.3.cmml">N</mi></msubsup><mrow id="Sx4.E3.m1.6.6.6.3" xref="Sx4.E3.m1.6.6.6.3.cmml"><mtext id="Sx4.E3.m1.6.6.6.3.3" xref="Sx4.E3.m1.6.6.6.3.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="Sx4.E3.m1.6.6.6.3.2" xref="Sx4.E3.m1.6.6.6.3.2.cmml">​</mo><mrow id="Sx4.E3.m1.6.6.6.3.1.1" xref="Sx4.E3.m1.6.6.6.3.1.1.1.cmml"><mo stretchy="false" id="Sx4.E3.m1.6.6.6.3.1.1.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.cmml">(</mo><mrow id="Sx4.E3.m1.6.6.6.3.1.1.1" xref="Sx4.E3.m1.6.6.6.3.1.1.1.cmml"><mrow id="Sx4.E3.m1.6.6.6.3.1.1.1.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.cmml"><msub id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.cmml"><mi id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.2.cmml">f</mi><mi id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.3" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx4.E3.m1.6.6.6.3.1.1.1.2.1" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.1.cmml">​</mo><mrow id="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.1.cmml"><mo stretchy="false" id="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.2.1" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.1.cmml">(</mo><mi id="Sx4.E3.m1.4.4.4.1" xref="Sx4.E3.m1.4.4.4.1.cmml">𝐯</mi><mo id="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.2.2" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.1.cmml">,</mo><mi id="Sx4.E3.m1.5.5.5.2" xref="Sx4.E3.m1.5.5.5.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.2.3" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E3.m1.6.6.6.3.1.1.1.1" xref="Sx4.E3.m1.6.6.6.3.1.1.1.1.cmml">/</mo><mi id="Sx4.E3.m1.6.6.6.3.1.1.1.3" xref="Sx4.E3.m1.6.6.6.3.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="Sx4.E3.m1.6.6.6.3.1.1.3" xref="Sx4.E3.m1.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="Sx4.E3.m1.7.7.1.2" xref="Sx4.E3.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E3.m1.7b"><apply id="Sx4.E3.m1.7.7.1.1.cmml" xref="Sx4.E3.m1.7.7.1"><eq id="Sx4.E3.m1.7.7.1.1.1.cmml" xref="Sx4.E3.m1.7.7.1.1.1"></eq><csymbol cd="latexml" id="Sx4.E3.m1.7.7.1.1.2.cmml" xref="Sx4.E3.m1.7.7.1.1.2">absent</csymbol><apply id="Sx4.E3.m1.7.7.1.1.3.cmml" xref="Sx4.E3.m1.7.7.1.1.3"><apply id="Sx4.E3.m1.7.7.1.1.3.1.cmml" xref="Sx4.E3.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="Sx4.E3.m1.7.7.1.1.3.1.1.cmml" xref="Sx4.E3.m1.7.7.1.1.3.1">subscript</csymbol><max id="Sx4.E3.m1.7.7.1.1.3.1.2.cmml" xref="Sx4.E3.m1.7.7.1.1.3.1.2"></max><ci id="Sx4.E3.m1.7.7.1.1.3.1.3.cmml" xref="Sx4.E3.m1.7.7.1.1.3.1.3">𝑖</ci></apply><apply id="Sx4.E3.m1.6.6.cmml" xref="Sx4.E3.m1.6.6"><divide id="Sx4.E3.m1.6.6.7.cmml" xref="Sx4.E3.m1.6.6"></divide><apply id="Sx4.E3.m1.3.3.3.cmml" xref="Sx4.E3.m1.3.3.3"><times id="Sx4.E3.m1.3.3.3.4.cmml" xref="Sx4.E3.m1.3.3.3.4"></times><ci id="Sx4.E3.m1.3.3.3.5a.cmml" xref="Sx4.E3.m1.3.3.3.5"><mtext id="Sx4.E3.m1.3.3.3.5.cmml" xref="Sx4.E3.m1.3.3.3.5">exp</mtext></ci><apply id="Sx4.E3.m1.3.3.3.3.1.1.cmml" xref="Sx4.E3.m1.3.3.3.3.1"><divide id="Sx4.E3.m1.3.3.3.3.1.1.1.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.1"></divide><apply id="Sx4.E3.m1.3.3.3.3.1.1.2.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2"><times id="Sx4.E3.m1.3.3.3.3.1.1.2.1.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.1"></times><apply id="Sx4.E3.m1.3.3.3.3.1.1.2.2.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="Sx4.E3.m1.3.3.3.3.1.1.2.2.1.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2">subscript</csymbol><ci id="Sx4.E3.m1.3.3.3.3.1.1.2.2.2.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2.2">𝑓</ci><ci id="Sx4.E3.m1.3.3.3.3.1.1.2.2.3.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.2.3">𝑖</ci></apply><interval closure="open" id="Sx4.E3.m1.3.3.3.3.1.1.2.3.1.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.2.3.2"><ci id="Sx4.E3.m1.1.1.1.1.cmml" xref="Sx4.E3.m1.1.1.1.1">𝐯</ci><ci id="Sx4.E3.m1.2.2.2.2.cmml" xref="Sx4.E3.m1.2.2.2.2">𝐪</ci></interval></apply><ci id="Sx4.E3.m1.3.3.3.3.1.1.3.cmml" xref="Sx4.E3.m1.3.3.3.3.1.1.3">𝑇</ci></apply></apply><apply id="Sx4.E3.m1.6.6.6.cmml" xref="Sx4.E3.m1.6.6.6"><apply id="Sx4.E3.m1.6.6.6.4.cmml" xref="Sx4.E3.m1.6.6.6.4"><csymbol cd="ambiguous" id="Sx4.E3.m1.6.6.6.4.1.cmml" xref="Sx4.E3.m1.6.6.6.4">superscript</csymbol><apply id="Sx4.E3.m1.6.6.6.4.2.cmml" xref="Sx4.E3.m1.6.6.6.4"><csymbol cd="ambiguous" id="Sx4.E3.m1.6.6.6.4.2.1.cmml" xref="Sx4.E3.m1.6.6.6.4">subscript</csymbol><sum id="Sx4.E3.m1.6.6.6.4.2.2.cmml" xref="Sx4.E3.m1.6.6.6.4.2.2"></sum><apply id="Sx4.E3.m1.6.6.6.4.2.3.cmml" xref="Sx4.E3.m1.6.6.6.4.2.3"><eq id="Sx4.E3.m1.6.6.6.4.2.3.1.cmml" xref="Sx4.E3.m1.6.6.6.4.2.3.1"></eq><ci id="Sx4.E3.m1.6.6.6.4.2.3.2.cmml" xref="Sx4.E3.m1.6.6.6.4.2.3.2">𝑗</ci><cn type="integer" id="Sx4.E3.m1.6.6.6.4.2.3.3.cmml" xref="Sx4.E3.m1.6.6.6.4.2.3.3">1</cn></apply></apply><ci id="Sx4.E3.m1.6.6.6.4.3.cmml" xref="Sx4.E3.m1.6.6.6.4.3">𝑁</ci></apply><apply id="Sx4.E3.m1.6.6.6.3.cmml" xref="Sx4.E3.m1.6.6.6.3"><times id="Sx4.E3.m1.6.6.6.3.2.cmml" xref="Sx4.E3.m1.6.6.6.3.2"></times><ci id="Sx4.E3.m1.6.6.6.3.3a.cmml" xref="Sx4.E3.m1.6.6.6.3.3"><mtext id="Sx4.E3.m1.6.6.6.3.3.cmml" xref="Sx4.E3.m1.6.6.6.3.3">exp</mtext></ci><apply id="Sx4.E3.m1.6.6.6.3.1.1.1.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1"><divide id="Sx4.E3.m1.6.6.6.3.1.1.1.1.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.1"></divide><apply id="Sx4.E3.m1.6.6.6.3.1.1.1.2.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2"><times id="Sx4.E3.m1.6.6.6.3.1.1.1.2.1.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.1"></times><apply id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.1.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2">subscript</csymbol><ci id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.2.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.2">𝑓</ci><ci id="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.3.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.2.3">𝑗</ci></apply><interval closure="open" id="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.1.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.2.3.2"><ci id="Sx4.E3.m1.4.4.4.1.cmml" xref="Sx4.E3.m1.4.4.4.1">𝐯</ci><ci id="Sx4.E3.m1.5.5.5.2.cmml" xref="Sx4.E3.m1.5.5.5.2">𝐪</ci></interval></apply><ci id="Sx4.E3.m1.6.6.6.3.1.1.1.3.cmml" xref="Sx4.E3.m1.6.6.6.3.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E3.m1.7c">\displaystyle=\max_{i}{\frac{\text{exp}(f_{i}({\mathbf{v},\mathbf{q}})/T)}{\sum_{j=1}^{N}{\text{exp}(f_{j}({\mathbf{v},\mathbf{q}})/T)}}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx1.p2.6" class="ltx_p">where <math id="Sx4.SSx1.p2.2.m1.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="Sx4.SSx1.p2.2.m1.1a"><msub id="Sx4.SSx1.p2.2.m1.1.1" xref="Sx4.SSx1.p2.2.m1.1.1.cmml"><mi id="Sx4.SSx1.p2.2.m1.1.1.2" xref="Sx4.SSx1.p2.2.m1.1.1.2.cmml">f</mi><mi id="Sx4.SSx1.p2.2.m1.1.1.3" xref="Sx4.SSx1.p2.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.2.m1.1b"><apply id="Sx4.SSx1.p2.2.m1.1.1.cmml" xref="Sx4.SSx1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p2.2.m1.1.1.1.cmml" xref="Sx4.SSx1.p2.2.m1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p2.2.m1.1.1.2.cmml" xref="Sx4.SSx1.p2.2.m1.1.1.2">𝑓</ci><ci id="Sx4.SSx1.p2.2.m1.1.1.3.cmml" xref="Sx4.SSx1.p2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.2.m1.1c">f_{i}</annotation></semantics></math> returns the preactivated output for the <math id="Sx4.SSx1.p2.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.SSx1.p2.3.m2.1a"><mi id="Sx4.SSx1.p2.3.m2.1.1" xref="Sx4.SSx1.p2.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.3.m2.1b"><ci id="Sx4.SSx1.p2.3.m2.1.1.cmml" xref="Sx4.SSx1.p2.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.3.m2.1c">i</annotation></semantics></math>-th class in the output layer, <math id="Sx4.SSx1.p2.4.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx4.SSx1.p2.4.m3.1a"><mi id="Sx4.SSx1.p2.4.m3.1.1" xref="Sx4.SSx1.p2.4.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.4.m3.1b"><ci id="Sx4.SSx1.p2.4.m3.1.1.cmml" xref="Sx4.SSx1.p2.4.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.4.m3.1c">N</annotation></semantics></math> is the number of answer candidates, and <math id="Sx4.SSx1.p2.5.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx4.SSx1.p2.5.m4.1a"><mi id="Sx4.SSx1.p2.5.m4.1.1" xref="Sx4.SSx1.p2.5.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.5.m4.1b"><ci id="Sx4.SSx1.p2.5.m4.1.1.cmml" xref="Sx4.SSx1.p2.5.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.5.m4.1c">T</annotation></semantics></math> is a temperature parameter.
The temperature is 1.0 in training, and increasing <math id="Sx4.SSx1.p2.6.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx4.SSx1.p2.6.m5.1a"><mi id="Sx4.SSx1.p2.6.m5.1.1" xref="Sx4.SSx1.p2.6.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.6.m5.1b"><ci id="Sx4.SSx1.p2.6.m5.1.1.cmml" xref="Sx4.SSx1.p2.6.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.6.m5.1c">T</annotation></semantics></math> in test time is known to improve confidence calibration and OOD detection <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib10" title="" class="ltx_ref">2017</a>; Liang, Li, and Srikant <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite>.
Recent studies <cite class="ltx_cite ltx_citemacro_citep">(Liang, Li, and Srikant <a href="#bib.bib22" title="" class="ltx_ref">2018</a>; Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite> in <em id="Sx4.SSx1.p2.6.1" class="ltx_emph ltx_font_italic">unimodal</em> tasks show that MSP with temperature scaling can detect OOD samples well.
Meanwhile, MSP is still a sensible measure for calibrating predictive uncertainty of VQA models, which are trained with binary cross entropy for multiple correct answers, because the models still use MSP for inference at test time and evaluation of VQA accuracy.</p>
</div>
<div id="Sx4.SSx1.p3" class="ltx_para">
<p id="Sx4.SSx1.p3.7" class="ltx_p">Despite the simplicity and popularity of MSP, we emphasize that MSP fails to detect various anomalies in VQA for two main reasons.
First, MSP is not enough metric to detect whether an input is from abnormal distribution <cite class="ltx_cite ltx_citemacro_citep">(Meinke and Hein <a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite>.
MSP does not directly measure <math id="Sx4.SSx1.p3.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx4.SSx1.p3.1.m1.2a"><mrow id="Sx4.SSx1.p3.1.m1.2.2" xref="Sx4.SSx1.p3.1.m1.2.2.cmml"><mi id="Sx4.SSx1.p3.1.m1.2.2.4" xref="Sx4.SSx1.p3.1.m1.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.1.m1.2.2.3" xref="Sx4.SSx1.p3.1.m1.2.2.3.cmml">​</mo><mrow id="Sx4.SSx1.p3.1.m1.2.2.2.2" xref="Sx4.SSx1.p3.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.1.m1.2.2.2.2.3" xref="Sx4.SSx1.p3.1.m1.2.2.2.3.cmml">(</mo><msub id="Sx4.SSx1.p3.1.m1.1.1.1.1.1" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.cmml"><mi id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.2" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx4.SSx1.p3.1.m1.2.2.2.2.4" xref="Sx4.SSx1.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="Sx4.SSx1.p3.1.m1.2.2.2.2.2" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.cmml"><mi id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.2" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.2.cmml">𝐪</mi><mtext id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3a.cmml">in</mtext></msub><mo stretchy="false" id="Sx4.SSx1.p3.1.m1.2.2.2.2.5" xref="Sx4.SSx1.p3.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.1.m1.2b"><apply id="Sx4.SSx1.p3.1.m1.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.2.2"><times id="Sx4.SSx1.p3.1.m1.2.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.3"></times><ci id="Sx4.SSx1.p3.1.m1.2.2.4.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.4">𝑝</ci><interval closure="open" id="Sx4.SSx1.p3.1.m1.2.2.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2"><apply id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3a.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.1.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.2">𝐪</ci><ci id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3a.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.2.2.2.2.2.3">in</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.1.m1.2c">p(\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math>, but rather <math id="Sx4.SSx1.p3.2.m2.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{in}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx4.SSx1.p3.2.m2.1a"><mrow id="Sx4.SSx1.p3.2.m2.1.1" xref="Sx4.SSx1.p3.2.m2.1.1.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.3" xref="Sx4.SSx1.p3.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.2.m2.1.1.2" xref="Sx4.SSx1.p3.2.m2.1.1.2.cmml">​</mo><mrow id="Sx4.SSx1.p3.2.m2.1.1.1.1" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.2.m2.1.1.1.1.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.SSx1.p3.2.m2.1.1.1.1.1" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.cmml"><msub id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3a.cmml">in</mtext></msub><mo fence="false" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.3.cmml"><msub id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.2" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx4.SSx1.p3.2.m2.1.1.1.1.3" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.2.m2.1b"><apply id="Sx4.SSx1.p3.2.m2.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1"><times id="Sx4.SSx1.p3.2.m2.1.1.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.2"></times><ci id="Sx4.SSx1.p3.2.m2.1.1.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.3">𝑝</ci><apply id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.3">conditional</csymbol><apply id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4">subscript</csymbol><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3a.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.4.3">in</mtext></ci></apply><list id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2"><apply id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.2.m2.1c">p(\mathbf{a}_{\text{in}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math>.
Thus, MSP can detect a sample with <math id="Sx4.SSx1.p3.3.m3.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx4.SSx1.p3.3.m3.1a"><mrow id="Sx4.SSx1.p3.3.m3.1.1" xref="Sx4.SSx1.p3.3.m3.1.1.cmml"><mi id="Sx4.SSx1.p3.3.m3.1.1.3" xref="Sx4.SSx1.p3.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.3.m3.1.1.2" xref="Sx4.SSx1.p3.3.m3.1.1.2.cmml">​</mo><mrow id="Sx4.SSx1.p3.3.m3.1.1.1.1" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.3.m3.1.1.1.1.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.SSx1.p3.3.m3.1.1.1.1.1" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.cmml"><msub id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.cmml"><mi id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3a.cmml">out</mtext></msub><mo fence="false" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.3.cmml"><msub id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.cmml"><mi id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.2" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx4.SSx1.p3.3.m3.1.1.1.1.3" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.3.m3.1b"><apply id="Sx4.SSx1.p3.3.m3.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1"><times id="Sx4.SSx1.p3.3.m3.1.1.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.2"></times><ci id="Sx4.SSx1.p3.3.m3.1.1.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.3">𝑝</ci><apply id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1"><csymbol cd="latexml" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.3">conditional</csymbol><apply id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4">subscript</csymbol><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3a.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.4.3">out</mtext></ci></apply><list id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2"><apply id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.3.m3.1c">p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math>.
However, MSP can often fail to detect input pairs of images and questions, which are from abnormal <math id="Sx4.SSx1.p3.4.m4.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx1.p3.4.m4.2a"><mrow id="Sx4.SSx1.p3.4.m4.2.3" xref="Sx4.SSx1.p3.4.m4.2.3.cmml"><mi id="Sx4.SSx1.p3.4.m4.2.3.2" xref="Sx4.SSx1.p3.4.m4.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.4.m4.2.3.1" xref="Sx4.SSx1.p3.4.m4.2.3.1.cmml">​</mo><mrow id="Sx4.SSx1.p3.4.m4.2.3.3.2" xref="Sx4.SSx1.p3.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.4.m4.2.3.3.2.1" xref="Sx4.SSx1.p3.4.m4.2.3.3.1.cmml">(</mo><mi id="Sx4.SSx1.p3.4.m4.1.1" xref="Sx4.SSx1.p3.4.m4.1.1.cmml">𝐯</mi><mo id="Sx4.SSx1.p3.4.m4.2.3.3.2.2" xref="Sx4.SSx1.p3.4.m4.2.3.3.1.cmml">,</mo><mi id="Sx4.SSx1.p3.4.m4.2.2" xref="Sx4.SSx1.p3.4.m4.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx1.p3.4.m4.2.3.3.2.3" xref="Sx4.SSx1.p3.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.4.m4.2b"><apply id="Sx4.SSx1.p3.4.m4.2.3.cmml" xref="Sx4.SSx1.p3.4.m4.2.3"><times id="Sx4.SSx1.p3.4.m4.2.3.1.cmml" xref="Sx4.SSx1.p3.4.m4.2.3.1"></times><ci id="Sx4.SSx1.p3.4.m4.2.3.2.cmml" xref="Sx4.SSx1.p3.4.m4.2.3.2">𝑝</ci><interval closure="open" id="Sx4.SSx1.p3.4.m4.2.3.3.1.cmml" xref="Sx4.SSx1.p3.4.m4.2.3.3.2"><ci id="Sx4.SSx1.p3.4.m4.1.1.cmml" xref="Sx4.SSx1.p3.4.m4.1.1">𝐯</ci><ci id="Sx4.SSx1.p3.4.m4.2.2.cmml" xref="Sx4.SSx1.p3.4.m4.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.4.m4.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>, including <math id="Sx4.SSx1.p3.5.m5.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx4.SSx1.p3.5.m5.1a"><mrow id="Sx4.SSx1.p3.5.m5.1.1" xref="Sx4.SSx1.p3.5.m5.1.1.cmml"><mi id="Sx4.SSx1.p3.5.m5.1.1.3" xref="Sx4.SSx1.p3.5.m5.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.5.m5.1.1.2" xref="Sx4.SSx1.p3.5.m5.1.1.2.cmml">​</mo><mrow id="Sx4.SSx1.p3.5.m5.1.1.1.1" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.5.m5.1.1.1.1.2" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.cmml">(</mo><msub id="Sx4.SSx1.p3.5.m5.1.1.1.1.1" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.cmml"><mi id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.2" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx4.SSx1.p3.5.m5.1.1.1.1.3" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.5.m5.1b"><apply id="Sx4.SSx1.p3.5.m5.1.1.cmml" xref="Sx4.SSx1.p3.5.m5.1.1"><times id="Sx4.SSx1.p3.5.m5.1.1.2.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.2"></times><ci id="Sx4.SSx1.p3.5.m5.1.1.3.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.3">𝑝</ci><apply id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3a.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.5.m5.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math>, <math id="Sx4.SSx1.p3.6.m6.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx4.SSx1.p3.6.m6.1a"><mrow id="Sx4.SSx1.p3.6.m6.1.1" xref="Sx4.SSx1.p3.6.m6.1.1.cmml"><mi id="Sx4.SSx1.p3.6.m6.1.1.3" xref="Sx4.SSx1.p3.6.m6.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.6.m6.1.1.2" xref="Sx4.SSx1.p3.6.m6.1.1.2.cmml">​</mo><mrow id="Sx4.SSx1.p3.6.m6.1.1.1.1" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.6.m6.1.1.1.1.2" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.cmml">(</mo><msub id="Sx4.SSx1.p3.6.m6.1.1.1.1.1" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.cmml"><mi id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.2" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx4.SSx1.p3.6.m6.1.1.1.1.3" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.6.m6.1b"><apply id="Sx4.SSx1.p3.6.m6.1.1.cmml" xref="Sx4.SSx1.p3.6.m6.1.1"><times id="Sx4.SSx1.p3.6.m6.1.1.2.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.2"></times><ci id="Sx4.SSx1.p3.6.m6.1.1.3.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.3">𝑝</ci><apply id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.2">𝐪</ci><ci id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3a.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.6.m6.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.6.m6.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math>, and <math id="Sx4.SSx1.p3.7.m7.1" class="ltx_Math" alttext="p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})" display="inline"><semantics id="Sx4.SSx1.p3.7.m7.1a"><mrow id="Sx4.SSx1.p3.7.m7.1.1" xref="Sx4.SSx1.p3.7.m7.1.1.cmml"><msub id="Sx4.SSx1.p3.7.m7.1.1.3" xref="Sx4.SSx1.p3.7.m7.1.1.3.cmml"><mi id="Sx4.SSx1.p3.7.m7.1.1.3.2" xref="Sx4.SSx1.p3.7.m7.1.1.3.2.cmml">p</mi><mtext id="Sx4.SSx1.p3.7.m7.1.1.3.3" xref="Sx4.SSx1.p3.7.m7.1.1.3.3a.cmml">out</mtext></msub><mo lspace="0em" rspace="0em" id="Sx4.SSx1.p3.7.m7.1.1.2" xref="Sx4.SSx1.p3.7.m7.1.1.2.cmml">​</mo><mrow id="Sx4.SSx1.p3.7.m7.1.1.1.1" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx1.p3.7.m7.1.1.1.1.2" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.SSx1.p3.7.m7.1.1.1.1.1" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.cmml"><msub id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.cmml"><mi id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.2" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.2.cmml">𝐪</mi><mtext id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo fence="false" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.1" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.1.cmml">|</mo><msub id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.cmml"><mi id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.2" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.2.cmml">𝐯</mi><mtext id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3a.cmml">in</mtext></msub></mrow><mo stretchy="false" id="Sx4.SSx1.p3.7.m7.1.1.1.1.3" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.7.m7.1b"><apply id="Sx4.SSx1.p3.7.m7.1.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1"><times id="Sx4.SSx1.p3.7.m7.1.1.2.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.2"></times><apply id="Sx4.SSx1.p3.7.m7.1.1.3.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.7.m7.1.1.3.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.3">subscript</csymbol><ci id="Sx4.SSx1.p3.7.m7.1.1.3.2.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.3.2">𝑝</ci><ci id="Sx4.SSx1.p3.7.m7.1.1.3.3a.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.3.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.7.m7.1.1.3.3.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.3.3">out</mtext></ci></apply><apply id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1"><csymbol cd="latexml" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.1">conditional</csymbol><apply id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.2">𝐪</ci><ci id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3a.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.2.3">in</mtext></ci></apply><apply id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.1.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.2.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.2">𝐯</ci><ci id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3a.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3"><mtext mathsize="70%" id="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3.cmml" xref="Sx4.SSx1.p3.7.m7.1.1.1.1.1.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.7.m7.1c">p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})</annotation></semantics></math> (task 1-4).
Second, after the multimodal feature fusion, an abnormal source of a modality vanishes.
For example, although an input image and question are from OOD and ID respectively, the joint features after the feature fusion are hardly distinguishable from those of normal inputs.</p>
</div>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Attention-based Anomaly Detection</h3>

<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.2" class="ltx_p">If the joint density of inputs, <math id="Sx4.SSx2.p1.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx2.p1.1.m1.2a"><mrow id="Sx4.SSx2.p1.1.m1.2.3" xref="Sx4.SSx2.p1.1.m1.2.3.cmml"><mi id="Sx4.SSx2.p1.1.m1.2.3.2" xref="Sx4.SSx2.p1.1.m1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p1.1.m1.2.3.1" xref="Sx4.SSx2.p1.1.m1.2.3.1.cmml">​</mo><mrow id="Sx4.SSx2.p1.1.m1.2.3.3.2" xref="Sx4.SSx2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p1.1.m1.2.3.3.2.1" xref="Sx4.SSx2.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="Sx4.SSx2.p1.1.m1.1.1" xref="Sx4.SSx2.p1.1.m1.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p1.1.m1.2.3.3.2.2" xref="Sx4.SSx2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="Sx4.SSx2.p1.1.m1.2.2" xref="Sx4.SSx2.p1.1.m1.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx2.p1.1.m1.2.3.3.2.3" xref="Sx4.SSx2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.1.m1.2b"><apply id="Sx4.SSx2.p1.1.m1.2.3.cmml" xref="Sx4.SSx2.p1.1.m1.2.3"><times id="Sx4.SSx2.p1.1.m1.2.3.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.1"></times><ci id="Sx4.SSx2.p1.1.m1.2.3.2.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.2">𝑝</ci><interval closure="open" id="Sx4.SSx2.p1.1.m1.2.3.3.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.3.2"><ci id="Sx4.SSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1">𝐯</ci><ci id="Sx4.SSx2.p1.1.m1.2.2.cmml" xref="Sx4.SSx2.p1.1.m1.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.1.m1.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>, is explicitly estimated, we can predict the likelihood of an input pair <math id="Sx4.SSx2.p1.2.m2.2" class="ltx_Math" alttext="(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx2.p1.2.m2.2a"><mrow id="Sx4.SSx2.p1.2.m2.2.3.2" xref="Sx4.SSx2.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p1.2.m2.2.3.2.1" xref="Sx4.SSx2.p1.2.m2.2.3.1.cmml">(</mo><mi id="Sx4.SSx2.p1.2.m2.1.1" xref="Sx4.SSx2.p1.2.m2.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p1.2.m2.2.3.2.2" xref="Sx4.SSx2.p1.2.m2.2.3.1.cmml">,</mo><mi id="Sx4.SSx2.p1.2.m2.2.2" xref="Sx4.SSx2.p1.2.m2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx2.p1.2.m2.2.3.2.3" xref="Sx4.SSx2.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.2.m2.2b"><interval closure="open" id="Sx4.SSx2.p1.2.m2.2.3.1.cmml" xref="Sx4.SSx2.p1.2.m2.2.3.2"><ci id="Sx4.SSx2.p1.2.m2.1.1.cmml" xref="Sx4.SSx2.p1.2.m2.1.1">𝐯</ci><ci id="Sx4.SSx2.p1.2.m2.2.2.cmml" xref="Sx4.SSx2.p1.2.m2.2.2">𝐪</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.2.m2.2c">(\mathbf{v},\mathbf{q})</annotation></semantics></math> and decide whether the pair is from abnormal distribution.
However, the explicit density estimation of multimodal data is computationally expensive and hard to train <cite class="ltx_cite ltx_citemacro_citep">(Salimans et al. <a href="#bib.bib32" title="" class="ltx_ref">2017</a>; Kingma and Dhariwal <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="Sx4.SSx2.p2" class="ltx_para">
<p id="Sx4.SSx2.p2.3" class="ltx_p">In this study, we propose attention-based anomaly detection to detect various anomalies from <math id="Sx4.SSx2.p2.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx2.p2.1.m1.2a"><mrow id="Sx4.SSx2.p2.1.m1.2.3" xref="Sx4.SSx2.p2.1.m1.2.3.cmml"><mi id="Sx4.SSx2.p2.1.m1.2.3.2" xref="Sx4.SSx2.p2.1.m1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p2.1.m1.2.3.1" xref="Sx4.SSx2.p2.1.m1.2.3.1.cmml">​</mo><mrow id="Sx4.SSx2.p2.1.m1.2.3.3.2" xref="Sx4.SSx2.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p2.1.m1.2.3.3.2.1" xref="Sx4.SSx2.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="Sx4.SSx2.p2.1.m1.1.1" xref="Sx4.SSx2.p2.1.m1.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p2.1.m1.2.3.3.2.2" xref="Sx4.SSx2.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="Sx4.SSx2.p2.1.m1.2.2" xref="Sx4.SSx2.p2.1.m1.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx2.p2.1.m1.2.3.3.2.3" xref="Sx4.SSx2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.1.m1.2b"><apply id="Sx4.SSx2.p2.1.m1.2.3.cmml" xref="Sx4.SSx2.p2.1.m1.2.3"><times id="Sx4.SSx2.p2.1.m1.2.3.1.cmml" xref="Sx4.SSx2.p2.1.m1.2.3.1"></times><ci id="Sx4.SSx2.p2.1.m1.2.3.2.cmml" xref="Sx4.SSx2.p2.1.m1.2.3.2">𝑝</ci><interval closure="open" id="Sx4.SSx2.p2.1.m1.2.3.3.1.cmml" xref="Sx4.SSx2.p2.1.m1.2.3.3.2"><ci id="Sx4.SSx2.p2.1.m1.1.1.cmml" xref="Sx4.SSx2.p2.1.m1.1.1">𝐯</ci><ci id="Sx4.SSx2.p2.1.m1.2.2.cmml" xref="Sx4.SSx2.p2.1.m1.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.1.m1.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>.
Instead of using MSP for <math id="Sx4.SSx2.p2.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx4.SSx2.p2.2.m2.1a"><mi id="Sx4.SSx2.p2.2.m2.1.1" xref="Sx4.SSx2.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.2.m2.1b"><ci id="Sx4.SSx2.p2.2.m2.1.1.cmml" xref="Sx4.SSx2.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.2.m2.1c">S</annotation></semantics></math> in Eq (<a href="#Sx4.E2" title="In Confidence-based Anomaly Detector ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), we use maximum attention probability (MAP), <math id="Sx4.SSx2.p2.3.m3.3" class="ltx_Math" alttext="A({\mathbf{v},\mathbf{q}};T)" display="inline"><semantics id="Sx4.SSx2.p2.3.m3.3a"><mrow id="Sx4.SSx2.p2.3.m3.3.4" xref="Sx4.SSx2.p2.3.m3.3.4.cmml"><mi id="Sx4.SSx2.p2.3.m3.3.4.2" xref="Sx4.SSx2.p2.3.m3.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p2.3.m3.3.4.1" xref="Sx4.SSx2.p2.3.m3.3.4.1.cmml">​</mo><mrow id="Sx4.SSx2.p2.3.m3.3.4.3.2" xref="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p2.3.m3.3.4.3.2.1" xref="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml">(</mo><mi id="Sx4.SSx2.p2.3.m3.1.1" xref="Sx4.SSx2.p2.3.m3.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p2.3.m3.3.4.3.2.2" xref="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="Sx4.SSx2.p2.3.m3.2.2" xref="Sx4.SSx2.p2.3.m3.2.2.cmml">𝐪</mi><mo id="Sx4.SSx2.p2.3.m3.3.4.3.2.3" xref="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml">;</mo><mi id="Sx4.SSx2.p2.3.m3.3.3" xref="Sx4.SSx2.p2.3.m3.3.3.cmml">T</mi><mo stretchy="false" id="Sx4.SSx2.p2.3.m3.3.4.3.2.4" xref="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.3.m3.3b"><apply id="Sx4.SSx2.p2.3.m3.3.4.cmml" xref="Sx4.SSx2.p2.3.m3.3.4"><times id="Sx4.SSx2.p2.3.m3.3.4.1.cmml" xref="Sx4.SSx2.p2.3.m3.3.4.1"></times><ci id="Sx4.SSx2.p2.3.m3.3.4.2.cmml" xref="Sx4.SSx2.p2.3.m3.3.4.2">𝐴</ci><vector id="Sx4.SSx2.p2.3.m3.3.4.3.1.cmml" xref="Sx4.SSx2.p2.3.m3.3.4.3.2"><ci id="Sx4.SSx2.p2.3.m3.1.1.cmml" xref="Sx4.SSx2.p2.3.m3.1.1">𝐯</ci><ci id="Sx4.SSx2.p2.3.m3.2.2.cmml" xref="Sx4.SSx2.p2.3.m3.2.2">𝐪</ci><ci id="Sx4.SSx2.p2.3.m3.3.3.cmml" xref="Sx4.SSx2.p2.3.m3.3.3">𝑇</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.3.m3.3c">A({\mathbf{v},\mathbf{q}};T)</annotation></semantics></math> of a cross-modal attention:</p>
<table id="A5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx4.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle A({\mathbf{v},\mathbf{q}};T)" display="inline"><semantics id="Sx4.Ex2.m1.3a"><mrow id="Sx4.Ex2.m1.3.4" xref="Sx4.Ex2.m1.3.4.cmml"><mi id="Sx4.Ex2.m1.3.4.2" xref="Sx4.Ex2.m1.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx4.Ex2.m1.3.4.1" xref="Sx4.Ex2.m1.3.4.1.cmml">​</mo><mrow id="Sx4.Ex2.m1.3.4.3.2" xref="Sx4.Ex2.m1.3.4.3.1.cmml"><mo stretchy="false" id="Sx4.Ex2.m1.3.4.3.2.1" xref="Sx4.Ex2.m1.3.4.3.1.cmml">(</mo><mi id="Sx4.Ex2.m1.1.1" xref="Sx4.Ex2.m1.1.1.cmml">𝐯</mi><mo id="Sx4.Ex2.m1.3.4.3.2.2" xref="Sx4.Ex2.m1.3.4.3.1.cmml">,</mo><mi id="Sx4.Ex2.m1.2.2" xref="Sx4.Ex2.m1.2.2.cmml">𝐪</mi><mo id="Sx4.Ex2.m1.3.4.3.2.3" xref="Sx4.Ex2.m1.3.4.3.1.cmml">;</mo><mi id="Sx4.Ex2.m1.3.3" xref="Sx4.Ex2.m1.3.3.cmml">T</mi><mo stretchy="false" id="Sx4.Ex2.m1.3.4.3.2.4" xref="Sx4.Ex2.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex2.m1.3b"><apply id="Sx4.Ex2.m1.3.4.cmml" xref="Sx4.Ex2.m1.3.4"><times id="Sx4.Ex2.m1.3.4.1.cmml" xref="Sx4.Ex2.m1.3.4.1"></times><ci id="Sx4.Ex2.m1.3.4.2.cmml" xref="Sx4.Ex2.m1.3.4.2">𝐴</ci><vector id="Sx4.Ex2.m1.3.4.3.1.cmml" xref="Sx4.Ex2.m1.3.4.3.2"><ci id="Sx4.Ex2.m1.1.1.cmml" xref="Sx4.Ex2.m1.1.1">𝐯</ci><ci id="Sx4.Ex2.m1.2.2.cmml" xref="Sx4.Ex2.m1.2.2">𝐪</ci><ci id="Sx4.Ex2.m1.3.3.cmml" xref="Sx4.Ex2.m1.3.3">𝑇</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex2.m1.3c">\displaystyle A({\mathbf{v},\mathbf{q}};T)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx4.Ex2.m2.5" class="ltx_Math" alttext="\displaystyle=\underset{i,j}{\text{max}}A_{ij}(\mathbf{v},\mathbf{q};T)" display="inline"><semantics id="Sx4.Ex2.m2.5a"><mrow id="Sx4.Ex2.m2.5.6" xref="Sx4.Ex2.m2.5.6.cmml"><mi id="Sx4.Ex2.m2.5.6.2" xref="Sx4.Ex2.m2.5.6.2.cmml"></mi><mo id="Sx4.Ex2.m2.5.6.1" xref="Sx4.Ex2.m2.5.6.1.cmml">=</mo><mrow id="Sx4.Ex2.m2.5.6.3" xref="Sx4.Ex2.m2.5.6.3.cmml"><munder accentunder="true" id="Sx4.Ex2.m2.2.2" xref="Sx4.Ex2.m2.2.2.cmml"><mtext id="Sx4.Ex2.m2.2.2.3" xref="Sx4.Ex2.m2.2.2.3a.cmml">max</mtext><mrow id="Sx4.Ex2.m2.2.2.2.4" xref="Sx4.Ex2.m2.2.2.2.3.cmml"><mi id="Sx4.Ex2.m2.1.1.1.1" xref="Sx4.Ex2.m2.1.1.1.1.cmml">i</mi><mo id="Sx4.Ex2.m2.2.2.2.4.1" xref="Sx4.Ex2.m2.2.2.2.3.cmml">,</mo><mi id="Sx4.Ex2.m2.2.2.2.2" xref="Sx4.Ex2.m2.2.2.2.2.cmml">j</mi></mrow></munder><mo lspace="0em" rspace="0em" id="Sx4.Ex2.m2.5.6.3.1" xref="Sx4.Ex2.m2.5.6.3.1.cmml">​</mo><msub id="Sx4.Ex2.m2.5.6.3.2" xref="Sx4.Ex2.m2.5.6.3.2.cmml"><mi id="Sx4.Ex2.m2.5.6.3.2.2" xref="Sx4.Ex2.m2.5.6.3.2.2.cmml">A</mi><mrow id="Sx4.Ex2.m2.5.6.3.2.3" xref="Sx4.Ex2.m2.5.6.3.2.3.cmml"><mi id="Sx4.Ex2.m2.5.6.3.2.3.2" xref="Sx4.Ex2.m2.5.6.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.Ex2.m2.5.6.3.2.3.1" xref="Sx4.Ex2.m2.5.6.3.2.3.1.cmml">​</mo><mi id="Sx4.Ex2.m2.5.6.3.2.3.3" xref="Sx4.Ex2.m2.5.6.3.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx4.Ex2.m2.5.6.3.1a" xref="Sx4.Ex2.m2.5.6.3.1.cmml">​</mo><mrow id="Sx4.Ex2.m2.5.6.3.3.2" xref="Sx4.Ex2.m2.5.6.3.3.1.cmml"><mo stretchy="false" id="Sx4.Ex2.m2.5.6.3.3.2.1" xref="Sx4.Ex2.m2.5.6.3.3.1.cmml">(</mo><mi id="Sx4.Ex2.m2.3.3" xref="Sx4.Ex2.m2.3.3.cmml">𝐯</mi><mo id="Sx4.Ex2.m2.5.6.3.3.2.2" xref="Sx4.Ex2.m2.5.6.3.3.1.cmml">,</mo><mi id="Sx4.Ex2.m2.4.4" xref="Sx4.Ex2.m2.4.4.cmml">𝐪</mi><mo id="Sx4.Ex2.m2.5.6.3.3.2.3" xref="Sx4.Ex2.m2.5.6.3.3.1.cmml">;</mo><mi id="Sx4.Ex2.m2.5.5" xref="Sx4.Ex2.m2.5.5.cmml">T</mi><mo stretchy="false" id="Sx4.Ex2.m2.5.6.3.3.2.4" xref="Sx4.Ex2.m2.5.6.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex2.m2.5b"><apply id="Sx4.Ex2.m2.5.6.cmml" xref="Sx4.Ex2.m2.5.6"><eq id="Sx4.Ex2.m2.5.6.1.cmml" xref="Sx4.Ex2.m2.5.6.1"></eq><csymbol cd="latexml" id="Sx4.Ex2.m2.5.6.2.cmml" xref="Sx4.Ex2.m2.5.6.2">absent</csymbol><apply id="Sx4.Ex2.m2.5.6.3.cmml" xref="Sx4.Ex2.m2.5.6.3"><times id="Sx4.Ex2.m2.5.6.3.1.cmml" xref="Sx4.Ex2.m2.5.6.3.1"></times><apply id="Sx4.Ex2.m2.2.2.cmml" xref="Sx4.Ex2.m2.2.2"><list id="Sx4.Ex2.m2.2.2.2.3.cmml" xref="Sx4.Ex2.m2.2.2.2.4"><ci id="Sx4.Ex2.m2.1.1.1.1.cmml" xref="Sx4.Ex2.m2.1.1.1.1">𝑖</ci><ci id="Sx4.Ex2.m2.2.2.2.2.cmml" xref="Sx4.Ex2.m2.2.2.2.2">𝑗</ci></list><ci id="Sx4.Ex2.m2.2.2.3a.cmml" xref="Sx4.Ex2.m2.2.2.3"><mtext id="Sx4.Ex2.m2.2.2.3.cmml" xref="Sx4.Ex2.m2.2.2.3">max</mtext></ci></apply><apply id="Sx4.Ex2.m2.5.6.3.2.cmml" xref="Sx4.Ex2.m2.5.6.3.2"><csymbol cd="ambiguous" id="Sx4.Ex2.m2.5.6.3.2.1.cmml" xref="Sx4.Ex2.m2.5.6.3.2">subscript</csymbol><ci id="Sx4.Ex2.m2.5.6.3.2.2.cmml" xref="Sx4.Ex2.m2.5.6.3.2.2">𝐴</ci><apply id="Sx4.Ex2.m2.5.6.3.2.3.cmml" xref="Sx4.Ex2.m2.5.6.3.2.3"><times id="Sx4.Ex2.m2.5.6.3.2.3.1.cmml" xref="Sx4.Ex2.m2.5.6.3.2.3.1"></times><ci id="Sx4.Ex2.m2.5.6.3.2.3.2.cmml" xref="Sx4.Ex2.m2.5.6.3.2.3.2">𝑖</ci><ci id="Sx4.Ex2.m2.5.6.3.2.3.3.cmml" xref="Sx4.Ex2.m2.5.6.3.2.3.3">𝑗</ci></apply></apply><vector id="Sx4.Ex2.m2.5.6.3.3.1.cmml" xref="Sx4.Ex2.m2.5.6.3.3.2"><ci id="Sx4.Ex2.m2.3.3.cmml" xref="Sx4.Ex2.m2.3.3">𝐯</ci><ci id="Sx4.Ex2.m2.4.4.cmml" xref="Sx4.Ex2.m2.4.4">𝐪</ci><ci id="Sx4.Ex2.m2.5.5.cmml" xref="Sx4.Ex2.m2.5.5">𝑇</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex2.m2.5c">\displaystyle=\underset{i,j}{\text{max}}A_{ij}(\mathbf{v},\mathbf{q};T)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx4.E4.m1.5" class="ltx_Math" alttext="\displaystyle=\underset{i,j}{\text{max}}\frac{\text{exp}(a({\mathbf{v}_{i},\mathbf{q}_{j}})/T)}{\sum_{k=1}^{K}\sum_{m=1}^{M}{\text{exp}(a({\mathbf{v}_{k},\mathbf{q}_{m}})/T)}}," display="inline"><semantics id="Sx4.E4.m1.5a"><mrow id="Sx4.E4.m1.5.5.1" xref="Sx4.E4.m1.5.5.1.1.cmml"><mrow id="Sx4.E4.m1.5.5.1.1" xref="Sx4.E4.m1.5.5.1.1.cmml"><mi id="Sx4.E4.m1.5.5.1.1.2" xref="Sx4.E4.m1.5.5.1.1.2.cmml"></mi><mo id="Sx4.E4.m1.5.5.1.1.1" xref="Sx4.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="Sx4.E4.m1.5.5.1.1.3" xref="Sx4.E4.m1.5.5.1.1.3.cmml"><munder accentunder="true" id="Sx4.E4.m1.2.2" xref="Sx4.E4.m1.2.2.cmml"><mtext id="Sx4.E4.m1.2.2.3" xref="Sx4.E4.m1.2.2.3a.cmml">max</mtext><mrow id="Sx4.E4.m1.2.2.2.4" xref="Sx4.E4.m1.2.2.2.3.cmml"><mi id="Sx4.E4.m1.1.1.1.1" xref="Sx4.E4.m1.1.1.1.1.cmml">i</mi><mo id="Sx4.E4.m1.2.2.2.4.1" xref="Sx4.E4.m1.2.2.2.3.cmml">,</mo><mi id="Sx4.E4.m1.2.2.2.2" xref="Sx4.E4.m1.2.2.2.2.cmml">j</mi></mrow></munder><mo lspace="0em" rspace="0em" id="Sx4.E4.m1.5.5.1.1.3.1" xref="Sx4.E4.m1.5.5.1.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="Sx4.E4.m1.4.4" xref="Sx4.E4.m1.4.4.cmml"><mfrac id="Sx4.E4.m1.4.4a" xref="Sx4.E4.m1.4.4.cmml"><mrow id="Sx4.E4.m1.3.3.1" xref="Sx4.E4.m1.3.3.1.cmml"><mtext id="Sx4.E4.m1.3.3.1.3" xref="Sx4.E4.m1.3.3.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="Sx4.E4.m1.3.3.1.2" xref="Sx4.E4.m1.3.3.1.2.cmml">​</mo><mrow id="Sx4.E4.m1.3.3.1.1.1" xref="Sx4.E4.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E4.m1.3.3.1.1.1.2" xref="Sx4.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="Sx4.E4.m1.3.3.1.1.1.1" xref="Sx4.E4.m1.3.3.1.1.1.1.cmml"><mrow id="Sx4.E4.m1.3.3.1.1.1.1.2" xref="Sx4.E4.m1.3.3.1.1.1.1.2.cmml"><mi id="Sx4.E4.m1.3.3.1.1.1.1.2.4" xref="Sx4.E4.m1.3.3.1.1.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E4.m1.3.3.1.1.1.1.2.3" xref="Sx4.E4.m1.3.3.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.3" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.3" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.4" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.2" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">𝐪</mi><mi id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.3" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.5" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx4.E4.m1.3.3.1.1.1.1.3" xref="Sx4.E4.m1.3.3.1.1.1.1.3.cmml">/</mo><mi id="Sx4.E4.m1.3.3.1.1.1.1.4" xref="Sx4.E4.m1.3.3.1.1.1.1.4.cmml">T</mi></mrow><mo stretchy="false" id="Sx4.E4.m1.3.3.1.1.1.3" xref="Sx4.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="Sx4.E4.m1.4.4.2" xref="Sx4.E4.m1.4.4.2.cmml"><msubsup id="Sx4.E4.m1.4.4.2.2" xref="Sx4.E4.m1.4.4.2.2.cmml"><mo id="Sx4.E4.m1.4.4.2.2.2.2" xref="Sx4.E4.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="Sx4.E4.m1.4.4.2.2.2.3" xref="Sx4.E4.m1.4.4.2.2.2.3.cmml"><mi id="Sx4.E4.m1.4.4.2.2.2.3.2" xref="Sx4.E4.m1.4.4.2.2.2.3.2.cmml">k</mi><mo id="Sx4.E4.m1.4.4.2.2.2.3.1" xref="Sx4.E4.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="Sx4.E4.m1.4.4.2.2.2.3.3" xref="Sx4.E4.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E4.m1.4.4.2.2.3" xref="Sx4.E4.m1.4.4.2.2.3.cmml">K</mi></msubsup><mrow id="Sx4.E4.m1.4.4.2.1" xref="Sx4.E4.m1.4.4.2.1.cmml"><msubsup id="Sx4.E4.m1.4.4.2.1.2" xref="Sx4.E4.m1.4.4.2.1.2.cmml"><mo lspace="0.167em" id="Sx4.E4.m1.4.4.2.1.2.2.2" xref="Sx4.E4.m1.4.4.2.1.2.2.2.cmml">∑</mo><mrow id="Sx4.E4.m1.4.4.2.1.2.2.3" xref="Sx4.E4.m1.4.4.2.1.2.2.3.cmml"><mi id="Sx4.E4.m1.4.4.2.1.2.2.3.2" xref="Sx4.E4.m1.4.4.2.1.2.2.3.2.cmml">m</mi><mo id="Sx4.E4.m1.4.4.2.1.2.2.3.1" xref="Sx4.E4.m1.4.4.2.1.2.2.3.1.cmml">=</mo><mn id="Sx4.E4.m1.4.4.2.1.2.2.3.3" xref="Sx4.E4.m1.4.4.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E4.m1.4.4.2.1.2.3" xref="Sx4.E4.m1.4.4.2.1.2.3.cmml">M</mi></msubsup><mrow id="Sx4.E4.m1.4.4.2.1.1" xref="Sx4.E4.m1.4.4.2.1.1.cmml"><mtext id="Sx4.E4.m1.4.4.2.1.1.3" xref="Sx4.E4.m1.4.4.2.1.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="Sx4.E4.m1.4.4.2.1.1.2" xref="Sx4.E4.m1.4.4.2.1.1.2.cmml">​</mo><mrow id="Sx4.E4.m1.4.4.2.1.1.1.1" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E4.m1.4.4.2.1.1.1.1.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E4.m1.4.4.2.1.1.1.1.1" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.cmml"><mrow id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.cmml"><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.4" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.4" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.2" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.2.cmml">𝐪</mi><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.5" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx4.E4.m1.4.4.2.1.1.1.1.1.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.3.cmml">/</mo><mi id="Sx4.E4.m1.4.4.2.1.1.1.1.1.4" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.4.cmml">T</mi></mrow><mo stretchy="false" id="Sx4.E4.m1.4.4.2.1.1.1.1.3" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="Sx4.E4.m1.5.5.1.2" xref="Sx4.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E4.m1.5b"><apply id="Sx4.E4.m1.5.5.1.1.cmml" xref="Sx4.E4.m1.5.5.1"><eq id="Sx4.E4.m1.5.5.1.1.1.cmml" xref="Sx4.E4.m1.5.5.1.1.1"></eq><csymbol cd="latexml" id="Sx4.E4.m1.5.5.1.1.2.cmml" xref="Sx4.E4.m1.5.5.1.1.2">absent</csymbol><apply id="Sx4.E4.m1.5.5.1.1.3.cmml" xref="Sx4.E4.m1.5.5.1.1.3"><times id="Sx4.E4.m1.5.5.1.1.3.1.cmml" xref="Sx4.E4.m1.5.5.1.1.3.1"></times><apply id="Sx4.E4.m1.2.2.cmml" xref="Sx4.E4.m1.2.2"><list id="Sx4.E4.m1.2.2.2.3.cmml" xref="Sx4.E4.m1.2.2.2.4"><ci id="Sx4.E4.m1.1.1.1.1.cmml" xref="Sx4.E4.m1.1.1.1.1">𝑖</ci><ci id="Sx4.E4.m1.2.2.2.2.cmml" xref="Sx4.E4.m1.2.2.2.2">𝑗</ci></list><ci id="Sx4.E4.m1.2.2.3a.cmml" xref="Sx4.E4.m1.2.2.3"><mtext id="Sx4.E4.m1.2.2.3.cmml" xref="Sx4.E4.m1.2.2.3">max</mtext></ci></apply><apply id="Sx4.E4.m1.4.4.cmml" xref="Sx4.E4.m1.4.4"><divide id="Sx4.E4.m1.4.4.3.cmml" xref="Sx4.E4.m1.4.4"></divide><apply id="Sx4.E4.m1.3.3.1.cmml" xref="Sx4.E4.m1.3.3.1"><times id="Sx4.E4.m1.3.3.1.2.cmml" xref="Sx4.E4.m1.3.3.1.2"></times><ci id="Sx4.E4.m1.3.3.1.3a.cmml" xref="Sx4.E4.m1.3.3.1.3"><mtext id="Sx4.E4.m1.3.3.1.3.cmml" xref="Sx4.E4.m1.3.3.1.3">exp</mtext></ci><apply id="Sx4.E4.m1.3.3.1.1.1.1.cmml" xref="Sx4.E4.m1.3.3.1.1.1"><divide id="Sx4.E4.m1.3.3.1.1.1.1.3.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.3"></divide><apply id="Sx4.E4.m1.3.3.1.1.1.1.2.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2"><times id="Sx4.E4.m1.3.3.1.1.1.1.2.3.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.3"></times><ci id="Sx4.E4.m1.3.3.1.1.1.1.2.4.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.4">𝑎</ci><interval closure="open" id="Sx4.E4.m1.3.3.1.1.1.1.2.2.3.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2"><apply id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.2">𝐪</ci><ci id="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><ci id="Sx4.E4.m1.3.3.1.1.1.1.4.cmml" xref="Sx4.E4.m1.3.3.1.1.1.1.4">𝑇</ci></apply></apply><apply id="Sx4.E4.m1.4.4.2.cmml" xref="Sx4.E4.m1.4.4.2"><apply id="Sx4.E4.m1.4.4.2.2.cmml" xref="Sx4.E4.m1.4.4.2.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.2.1.cmml" xref="Sx4.E4.m1.4.4.2.2">superscript</csymbol><apply id="Sx4.E4.m1.4.4.2.2.2.cmml" xref="Sx4.E4.m1.4.4.2.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.2.2.1.cmml" xref="Sx4.E4.m1.4.4.2.2">subscript</csymbol><sum id="Sx4.E4.m1.4.4.2.2.2.2.cmml" xref="Sx4.E4.m1.4.4.2.2.2.2"></sum><apply id="Sx4.E4.m1.4.4.2.2.2.3.cmml" xref="Sx4.E4.m1.4.4.2.2.2.3"><eq id="Sx4.E4.m1.4.4.2.2.2.3.1.cmml" xref="Sx4.E4.m1.4.4.2.2.2.3.1"></eq><ci id="Sx4.E4.m1.4.4.2.2.2.3.2.cmml" xref="Sx4.E4.m1.4.4.2.2.2.3.2">𝑘</ci><cn type="integer" id="Sx4.E4.m1.4.4.2.2.2.3.3.cmml" xref="Sx4.E4.m1.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="Sx4.E4.m1.4.4.2.2.3.cmml" xref="Sx4.E4.m1.4.4.2.2.3">𝐾</ci></apply><apply id="Sx4.E4.m1.4.4.2.1.cmml" xref="Sx4.E4.m1.4.4.2.1"><apply id="Sx4.E4.m1.4.4.2.1.2.cmml" xref="Sx4.E4.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.1.2.1.cmml" xref="Sx4.E4.m1.4.4.2.1.2">superscript</csymbol><apply id="Sx4.E4.m1.4.4.2.1.2.2.cmml" xref="Sx4.E4.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.1.2.2.1.cmml" xref="Sx4.E4.m1.4.4.2.1.2">subscript</csymbol><sum id="Sx4.E4.m1.4.4.2.1.2.2.2.cmml" xref="Sx4.E4.m1.4.4.2.1.2.2.2"></sum><apply id="Sx4.E4.m1.4.4.2.1.2.2.3.cmml" xref="Sx4.E4.m1.4.4.2.1.2.2.3"><eq id="Sx4.E4.m1.4.4.2.1.2.2.3.1.cmml" xref="Sx4.E4.m1.4.4.2.1.2.2.3.1"></eq><ci id="Sx4.E4.m1.4.4.2.1.2.2.3.2.cmml" xref="Sx4.E4.m1.4.4.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="Sx4.E4.m1.4.4.2.1.2.2.3.3.cmml" xref="Sx4.E4.m1.4.4.2.1.2.2.3.3">1</cn></apply></apply><ci id="Sx4.E4.m1.4.4.2.1.2.3.cmml" xref="Sx4.E4.m1.4.4.2.1.2.3">𝑀</ci></apply><apply id="Sx4.E4.m1.4.4.2.1.1.cmml" xref="Sx4.E4.m1.4.4.2.1.1"><times id="Sx4.E4.m1.4.4.2.1.1.2.cmml" xref="Sx4.E4.m1.4.4.2.1.1.2"></times><ci id="Sx4.E4.m1.4.4.2.1.1.3a.cmml" xref="Sx4.E4.m1.4.4.2.1.1.3"><mtext id="Sx4.E4.m1.4.4.2.1.1.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.3">exp</mtext></ci><apply id="Sx4.E4.m1.4.4.2.1.1.1.1.1.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1"><divide id="Sx4.E4.m1.4.4.2.1.1.1.1.1.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.3"></divide><apply id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2"><times id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.3"></times><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.4.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.4">𝑎</ci><interval closure="open" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2"><apply id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.2">𝐪</ci><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.2.2.2.2.3">𝑚</ci></apply></interval></apply><ci id="Sx4.E4.m1.4.4.2.1.1.1.1.1.4.cmml" xref="Sx4.E4.m1.4.4.2.1.1.1.1.1.4">𝑇</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E4.m1.5c">\displaystyle=\underset{i,j}{\text{max}}\frac{\text{exp}(a({\mathbf{v}_{i},\mathbf{q}_{j}})/T)}{\sum_{k=1}^{K}\sum_{m=1}^{M}{\text{exp}(a({\mathbf{v}_{k},\mathbf{q}_{m}})/T)}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx2.p2.14" class="ltx_p">where <math id="Sx4.SSx2.p2.4.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="Sx4.SSx2.p2.4.m1.1a"><mi id="Sx4.SSx2.p2.4.m1.1.1" xref="Sx4.SSx2.p2.4.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.4.m1.1b"><ci id="Sx4.SSx2.p2.4.m1.1.1.cmml" xref="Sx4.SSx2.p2.4.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.4.m1.1c">a</annotation></semantics></math> is a cross-modal attention layer in a VQA model; <math id="Sx4.SSx2.p2.5.m2.1" class="ltx_Math" alttext="A_{ij}" display="inline"><semantics id="Sx4.SSx2.p2.5.m2.1a"><msub id="Sx4.SSx2.p2.5.m2.1.1" xref="Sx4.SSx2.p2.5.m2.1.1.cmml"><mi id="Sx4.SSx2.p2.5.m2.1.1.2" xref="Sx4.SSx2.p2.5.m2.1.1.2.cmml">A</mi><mrow id="Sx4.SSx2.p2.5.m2.1.1.3" xref="Sx4.SSx2.p2.5.m2.1.1.3.cmml"><mi id="Sx4.SSx2.p2.5.m2.1.1.3.2" xref="Sx4.SSx2.p2.5.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p2.5.m2.1.1.3.1" xref="Sx4.SSx2.p2.5.m2.1.1.3.1.cmml">​</mo><mi id="Sx4.SSx2.p2.5.m2.1.1.3.3" xref="Sx4.SSx2.p2.5.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.5.m2.1b"><apply id="Sx4.SSx2.p2.5.m2.1.1.cmml" xref="Sx4.SSx2.p2.5.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p2.5.m2.1.1.1.cmml" xref="Sx4.SSx2.p2.5.m2.1.1">subscript</csymbol><ci id="Sx4.SSx2.p2.5.m2.1.1.2.cmml" xref="Sx4.SSx2.p2.5.m2.1.1.2">𝐴</ci><apply id="Sx4.SSx2.p2.5.m2.1.1.3.cmml" xref="Sx4.SSx2.p2.5.m2.1.1.3"><times id="Sx4.SSx2.p2.5.m2.1.1.3.1.cmml" xref="Sx4.SSx2.p2.5.m2.1.1.3.1"></times><ci id="Sx4.SSx2.p2.5.m2.1.1.3.2.cmml" xref="Sx4.SSx2.p2.5.m2.1.1.3.2">𝑖</ci><ci id="Sx4.SSx2.p2.5.m2.1.1.3.3.cmml" xref="Sx4.SSx2.p2.5.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.5.m2.1c">A_{ij}</annotation></semantics></math> is the attention score between <math id="Sx4.SSx2.p2.6.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.SSx2.p2.6.m3.1a"><mi id="Sx4.SSx2.p2.6.m3.1.1" xref="Sx4.SSx2.p2.6.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.6.m3.1b"><ci id="Sx4.SSx2.p2.6.m3.1.1.cmml" xref="Sx4.SSx2.p2.6.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.6.m3.1c">i</annotation></semantics></math>-th visual object (region) and <math id="Sx4.SSx2.p2.7.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx4.SSx2.p2.7.m4.1a"><mi id="Sx4.SSx2.p2.7.m4.1.1" xref="Sx4.SSx2.p2.7.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.7.m4.1b"><ci id="Sx4.SSx2.p2.7.m4.1.1.cmml" xref="Sx4.SSx2.p2.7.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.7.m4.1c">j</annotation></semantics></math>-th question token; <math id="Sx4.SSx2.p2.8.m5.1" class="ltx_Math" alttext="\mathbf{v}_{i}" display="inline"><semantics id="Sx4.SSx2.p2.8.m5.1a"><msub id="Sx4.SSx2.p2.8.m5.1.1" xref="Sx4.SSx2.p2.8.m5.1.1.cmml"><mi id="Sx4.SSx2.p2.8.m5.1.1.2" xref="Sx4.SSx2.p2.8.m5.1.1.2.cmml">𝐯</mi><mi id="Sx4.SSx2.p2.8.m5.1.1.3" xref="Sx4.SSx2.p2.8.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.8.m5.1b"><apply id="Sx4.SSx2.p2.8.m5.1.1.cmml" xref="Sx4.SSx2.p2.8.m5.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p2.8.m5.1.1.1.cmml" xref="Sx4.SSx2.p2.8.m5.1.1">subscript</csymbol><ci id="Sx4.SSx2.p2.8.m5.1.1.2.cmml" xref="Sx4.SSx2.p2.8.m5.1.1.2">𝐯</ci><ci id="Sx4.SSx2.p2.8.m5.1.1.3.cmml" xref="Sx4.SSx2.p2.8.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.8.m5.1c">\mathbf{v}_{i}</annotation></semantics></math> and <math id="Sx4.SSx2.p2.9.m6.1" class="ltx_Math" alttext="\mathbf{q}_{j}" display="inline"><semantics id="Sx4.SSx2.p2.9.m6.1a"><msub id="Sx4.SSx2.p2.9.m6.1.1" xref="Sx4.SSx2.p2.9.m6.1.1.cmml"><mi id="Sx4.SSx2.p2.9.m6.1.1.2" xref="Sx4.SSx2.p2.9.m6.1.1.2.cmml">𝐪</mi><mi id="Sx4.SSx2.p2.9.m6.1.1.3" xref="Sx4.SSx2.p2.9.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.9.m6.1b"><apply id="Sx4.SSx2.p2.9.m6.1.1.cmml" xref="Sx4.SSx2.p2.9.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p2.9.m6.1.1.1.cmml" xref="Sx4.SSx2.p2.9.m6.1.1">subscript</csymbol><ci id="Sx4.SSx2.p2.9.m6.1.1.2.cmml" xref="Sx4.SSx2.p2.9.m6.1.1.2">𝐪</ci><ci id="Sx4.SSx2.p2.9.m6.1.1.3.cmml" xref="Sx4.SSx2.p2.9.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.9.m6.1c">\mathbf{q}_{j}</annotation></semantics></math> are the features of the <math id="Sx4.SSx2.p2.10.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.SSx2.p2.10.m7.1a"><mi id="Sx4.SSx2.p2.10.m7.1.1" xref="Sx4.SSx2.p2.10.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.10.m7.1b"><ci id="Sx4.SSx2.p2.10.m7.1.1.cmml" xref="Sx4.SSx2.p2.10.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.10.m7.1c">i</annotation></semantics></math>-th visual object and <math id="Sx4.SSx2.p2.11.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx4.SSx2.p2.11.m8.1a"><mi id="Sx4.SSx2.p2.11.m8.1.1" xref="Sx4.SSx2.p2.11.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.11.m8.1b"><ci id="Sx4.SSx2.p2.11.m8.1.1.cmml" xref="Sx4.SSx2.p2.11.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.11.m8.1c">j</annotation></semantics></math>-th question token; and <math id="Sx4.SSx2.p2.12.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx4.SSx2.p2.12.m9.1a"><mi id="Sx4.SSx2.p2.12.m9.1.1" xref="Sx4.SSx2.p2.12.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.12.m9.1b"><ci id="Sx4.SSx2.p2.12.m9.1.1.cmml" xref="Sx4.SSx2.p2.12.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.12.m9.1c">K</annotation></semantics></math> and <math id="Sx4.SSx2.p2.13.m10.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx4.SSx2.p2.13.m10.1a"><mi id="Sx4.SSx2.p2.13.m10.1.1" xref="Sx4.SSx2.p2.13.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.13.m10.1b"><ci id="Sx4.SSx2.p2.13.m10.1.1.cmml" xref="Sx4.SSx2.p2.13.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.13.m10.1c">M</annotation></semantics></math> are the numbers of visual objects and question tokens.
The temperature parameter is increased only when detecting anomalies, because increasing <math id="Sx4.SSx2.p2.14.m11.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx4.SSx2.p2.14.m11.1a"><mi id="Sx4.SSx2.p2.14.m11.1.1" xref="Sx4.SSx2.p2.14.m11.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.14.m11.1b"><ci id="Sx4.SSx2.p2.14.m11.1.1.cmml" xref="Sx4.SSx2.p2.14.m11.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.14.m11.1c">T</annotation></semantics></math> affects the prediction results.</p>
</div>
<div id="Sx4.SSx2.p3" class="ltx_para">
<p id="Sx4.SSx2.p3.9" class="ltx_p">We postulate that although MAP does not directly estimate <math id="Sx4.SSx2.p3.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx2.p3.1.m1.2a"><mrow id="Sx4.SSx2.p3.1.m1.2.3" xref="Sx4.SSx2.p3.1.m1.2.3.cmml"><mi id="Sx4.SSx2.p3.1.m1.2.3.2" xref="Sx4.SSx2.p3.1.m1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p3.1.m1.2.3.1" xref="Sx4.SSx2.p3.1.m1.2.3.1.cmml">​</mo><mrow id="Sx4.SSx2.p3.1.m1.2.3.3.2" xref="Sx4.SSx2.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.1.m1.2.3.3.2.1" xref="Sx4.SSx2.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="Sx4.SSx2.p3.1.m1.1.1" xref="Sx4.SSx2.p3.1.m1.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p3.1.m1.2.3.3.2.2" xref="Sx4.SSx2.p3.1.m1.2.3.3.1.cmml">,</mo><mi id="Sx4.SSx2.p3.1.m1.2.2" xref="Sx4.SSx2.p3.1.m1.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx2.p3.1.m1.2.3.3.2.3" xref="Sx4.SSx2.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.1.m1.2b"><apply id="Sx4.SSx2.p3.1.m1.2.3.cmml" xref="Sx4.SSx2.p3.1.m1.2.3"><times id="Sx4.SSx2.p3.1.m1.2.3.1.cmml" xref="Sx4.SSx2.p3.1.m1.2.3.1"></times><ci id="Sx4.SSx2.p3.1.m1.2.3.2.cmml" xref="Sx4.SSx2.p3.1.m1.2.3.2">𝑝</ci><interval closure="open" id="Sx4.SSx2.p3.1.m1.2.3.3.1.cmml" xref="Sx4.SSx2.p3.1.m1.2.3.3.2"><ci id="Sx4.SSx2.p3.1.m1.1.1.cmml" xref="Sx4.SSx2.p3.1.m1.1.1">𝐯</ci><ci id="Sx4.SSx2.p3.1.m1.2.2.cmml" xref="Sx4.SSx2.p3.1.m1.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.1.m1.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>, MAP can detect abnormal inputs from <math id="Sx4.SSx2.p3.2.m2.1" class="ltx_Math" alttext="p(\mathbf{v}_{\text{out}})" display="inline"><semantics id="Sx4.SSx2.p3.2.m2.1a"><mrow id="Sx4.SSx2.p3.2.m2.1.1" xref="Sx4.SSx2.p3.2.m2.1.1.cmml"><mi id="Sx4.SSx2.p3.2.m2.1.1.3" xref="Sx4.SSx2.p3.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p3.2.m2.1.1.2" xref="Sx4.SSx2.p3.2.m2.1.1.2.cmml">​</mo><mrow id="Sx4.SSx2.p3.2.m2.1.1.1.1" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.2.m2.1.1.1.1.2" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="Sx4.SSx2.p3.2.m2.1.1.1.1.1" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.cmml"><mi id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.2" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx4.SSx2.p3.2.m2.1.1.1.1.3" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.2.m2.1b"><apply id="Sx4.SSx2.p3.2.m2.1.1.cmml" xref="Sx4.SSx2.p3.2.m2.1.1"><times id="Sx4.SSx2.p3.2.m2.1.1.2.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.2"></times><ci id="Sx4.SSx2.p3.2.m2.1.1.3.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.3">𝑝</ci><apply id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.2.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3a.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3.cmml" xref="Sx4.SSx2.p3.2.m2.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.2.m2.1c">p(\mathbf{v}_{\text{out}})</annotation></semantics></math>, <math id="Sx4.SSx2.p3.3.m3.1" class="ltx_Math" alttext="p(\mathbf{q}_{\text{out}})" display="inline"><semantics id="Sx4.SSx2.p3.3.m3.1a"><mrow id="Sx4.SSx2.p3.3.m3.1.1" xref="Sx4.SSx2.p3.3.m3.1.1.cmml"><mi id="Sx4.SSx2.p3.3.m3.1.1.3" xref="Sx4.SSx2.p3.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p3.3.m3.1.1.2" xref="Sx4.SSx2.p3.3.m3.1.1.2.cmml">​</mo><mrow id="Sx4.SSx2.p3.3.m3.1.1.1.1" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.3.m3.1.1.1.1.2" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.cmml">(</mo><msub id="Sx4.SSx2.p3.3.m3.1.1.1.1.1" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.cmml"><mi id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.2" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.2.cmml">𝐪</mi><mtext id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3a.cmml">out</mtext></msub><mo stretchy="false" id="Sx4.SSx2.p3.3.m3.1.1.1.1.3" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.3.m3.1b"><apply id="Sx4.SSx2.p3.3.m3.1.1.cmml" xref="Sx4.SSx2.p3.3.m3.1.1"><times id="Sx4.SSx2.p3.3.m3.1.1.2.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.2"></times><ci id="Sx4.SSx2.p3.3.m3.1.1.3.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.3">𝑝</ci><apply id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.2.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.2">𝐪</ci><ci id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3a.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3.cmml" xref="Sx4.SSx2.p3.3.m3.1.1.1.1.1.3">out</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.3.m3.1c">p(\mathbf{q}_{\text{out}})</annotation></semantics></math>, and <math id="Sx4.SSx2.p3.4.m4.1" class="ltx_Math" alttext="p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})" display="inline"><semantics id="Sx4.SSx2.p3.4.m4.1a"><mrow id="Sx4.SSx2.p3.4.m4.1.1" xref="Sx4.SSx2.p3.4.m4.1.1.cmml"><msub id="Sx4.SSx2.p3.4.m4.1.1.3" xref="Sx4.SSx2.p3.4.m4.1.1.3.cmml"><mi id="Sx4.SSx2.p3.4.m4.1.1.3.2" xref="Sx4.SSx2.p3.4.m4.1.1.3.2.cmml">p</mi><mtext id="Sx4.SSx2.p3.4.m4.1.1.3.3" xref="Sx4.SSx2.p3.4.m4.1.1.3.3a.cmml">out</mtext></msub><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p3.4.m4.1.1.2" xref="Sx4.SSx2.p3.4.m4.1.1.2.cmml">​</mo><mrow id="Sx4.SSx2.p3.4.m4.1.1.1.1" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.4.m4.1.1.1.1.2" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.SSx2.p3.4.m4.1.1.1.1.1" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.cmml"><msub id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.cmml"><mi id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.2" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.2.cmml">𝐪</mi><mtext id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo fence="false" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.1" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.cmml"><mi id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.2" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.2.cmml">𝐯</mi><mtext id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3a.cmml">in</mtext></msub></mrow><mo stretchy="false" id="Sx4.SSx2.p3.4.m4.1.1.1.1.3" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.4.m4.1b"><apply id="Sx4.SSx2.p3.4.m4.1.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1"><times id="Sx4.SSx2.p3.4.m4.1.1.2.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.2"></times><apply id="Sx4.SSx2.p3.4.m4.1.1.3.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx2.p3.4.m4.1.1.3.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.3">subscript</csymbol><ci id="Sx4.SSx2.p3.4.m4.1.1.3.2.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.3.2">𝑝</ci><ci id="Sx4.SSx2.p3.4.m4.1.1.3.3a.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.3.3"><mtext mathsize="70%" id="Sx4.SSx2.p3.4.m4.1.1.3.3.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.3.3">out</mtext></ci></apply><apply id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1"><csymbol cd="latexml" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.2">𝐪</ci><ci id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3a.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.2.3">in</mtext></ci></apply><apply id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.2.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.2">𝐯</ci><ci id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3a.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3"><mtext mathsize="70%" id="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3.cmml" xref="Sx4.SSx2.p3.4.m4.1.1.1.1.1.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.4.m4.1c">p_{\text{out}}(\mathbf{q}_{\text{in}}|\mathbf{v}_{\text{in}})</annotation></semantics></math>.
For example, when the image <math id="Sx4.SSx2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="Sx4.SSx2.p3.5.m5.1a"><mi id="Sx4.SSx2.p3.5.m5.1.1" xref="Sx4.SSx2.p3.5.m5.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.5.m5.1b"><ci id="Sx4.SSx2.p3.5.m5.1.1.cmml" xref="Sx4.SSx2.p3.5.m5.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.5.m5.1c">\mathbf{v}</annotation></semantics></math> and question <math id="Sx4.SSx2.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="Sx4.SSx2.p3.6.m6.1a"><mi id="Sx4.SSx2.p3.6.m6.1.1" xref="Sx4.SSx2.p3.6.m6.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.6.m6.1b"><ci id="Sx4.SSx2.p3.6.m6.1.1.cmml" xref="Sx4.SSx2.p3.6.m6.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.6.m6.1c">\mathbf{q}</annotation></semantics></math> are both from in-distribution and relevant to each other, we can expect the joint density of the input pair <math id="Sx4.SSx2.p3.7.m7.2" class="ltx_Math" alttext="(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx4.SSx2.p3.7.m7.2a"><mrow id="Sx4.SSx2.p3.7.m7.2.3.2" xref="Sx4.SSx2.p3.7.m7.2.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.7.m7.2.3.2.1" xref="Sx4.SSx2.p3.7.m7.2.3.1.cmml">(</mo><mi id="Sx4.SSx2.p3.7.m7.1.1" xref="Sx4.SSx2.p3.7.m7.1.1.cmml">𝐯</mi><mo id="Sx4.SSx2.p3.7.m7.2.3.2.2" xref="Sx4.SSx2.p3.7.m7.2.3.1.cmml">,</mo><mi id="Sx4.SSx2.p3.7.m7.2.2" xref="Sx4.SSx2.p3.7.m7.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx4.SSx2.p3.7.m7.2.3.2.3" xref="Sx4.SSx2.p3.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.7.m7.2b"><interval closure="open" id="Sx4.SSx2.p3.7.m7.2.3.1.cmml" xref="Sx4.SSx2.p3.7.m7.2.3.2"><ci id="Sx4.SSx2.p3.7.m7.1.1.cmml" xref="Sx4.SSx2.p3.7.m7.1.1">𝐯</ci><ci id="Sx4.SSx2.p3.7.m7.2.2.cmml" xref="Sx4.SSx2.p3.7.m7.2.2">𝐪</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.7.m7.2c">(\mathbf{v},\mathbf{q})</annotation></semantics></math> to be high.
Together with the high input density, VQA models have high MAP on the input pair, creating a strong attention between a visual object in the image and corresponding question tokens in the question.
In contrast, when either <math id="Sx4.SSx2.p3.8.m8.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="Sx4.SSx2.p3.8.m8.1a"><mi id="Sx4.SSx2.p3.8.m8.1.1" xref="Sx4.SSx2.p3.8.m8.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.8.m8.1b"><ci id="Sx4.SSx2.p3.8.m8.1.1.cmml" xref="Sx4.SSx2.p3.8.m8.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.8.m8.1c">\mathbf{v}</annotation></semantics></math> or <math id="Sx4.SSx2.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="Sx4.SSx2.p3.9.m9.1a"><mi id="Sx4.SSx2.p3.9.m9.1.1" xref="Sx4.SSx2.p3.9.m9.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.9.m9.1b"><ci id="Sx4.SSx2.p3.9.m9.1.1.cmml" xref="Sx4.SSx2.p3.9.m9.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.9.m9.1c">\mathbf{q}</annotation></semantics></math> is from out-of-distribution, or they are irrelevant, we expect the density of the input pair to be low, and VQA models also have low MAP because they cannot find any strong association between the image and question.</p>
</div>
<div id="Sx4.SSx2.p4" class="ltx_para">
<p id="Sx4.SSx2.p4.2" class="ltx_p">Note that MAP is a model-agnostic metric so it can be used for various attention mechanisms in state-of-the-art VQA models.
If the attention layer does not take all question tokens, but rather uses the context vector of the question <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite>,
we can notate that <math id="Sx4.SSx2.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{q}_{m}" display="inline"><semantics id="Sx4.SSx2.p4.1.m1.1a"><msub id="Sx4.SSx2.p4.1.m1.1.1" xref="Sx4.SSx2.p4.1.m1.1.1.cmml"><mi id="Sx4.SSx2.p4.1.m1.1.1.2" xref="Sx4.SSx2.p4.1.m1.1.1.2.cmml">𝐪</mi><mi id="Sx4.SSx2.p4.1.m1.1.1.3" xref="Sx4.SSx2.p4.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p4.1.m1.1b"><apply id="Sx4.SSx2.p4.1.m1.1.1.cmml" xref="Sx4.SSx2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p4.1.m1.1.1.1.cmml" xref="Sx4.SSx2.p4.1.m1.1.1">subscript</csymbol><ci id="Sx4.SSx2.p4.1.m1.1.1.2.cmml" xref="Sx4.SSx2.p4.1.m1.1.1.2">𝐪</ci><ci id="Sx4.SSx2.p4.1.m1.1.1.3.cmml" xref="Sx4.SSx2.p4.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p4.1.m1.1c">\mathbf{q}_{m}</annotation></semantics></math> is the context vector and <math id="Sx4.SSx2.p4.2.m2.1" class="ltx_Math" alttext="M=1" display="inline"><semantics id="Sx4.SSx2.p4.2.m2.1a"><mrow id="Sx4.SSx2.p4.2.m2.1.1" xref="Sx4.SSx2.p4.2.m2.1.1.cmml"><mi id="Sx4.SSx2.p4.2.m2.1.1.2" xref="Sx4.SSx2.p4.2.m2.1.1.2.cmml">M</mi><mo id="Sx4.SSx2.p4.2.m2.1.1.1" xref="Sx4.SSx2.p4.2.m2.1.1.1.cmml">=</mo><mn id="Sx4.SSx2.p4.2.m2.1.1.3" xref="Sx4.SSx2.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p4.2.m2.1b"><apply id="Sx4.SSx2.p4.2.m2.1.1.cmml" xref="Sx4.SSx2.p4.2.m2.1.1"><eq id="Sx4.SSx2.p4.2.m2.1.1.1.cmml" xref="Sx4.SSx2.p4.2.m2.1.1.1"></eq><ci id="Sx4.SSx2.p4.2.m2.1.1.2.cmml" xref="Sx4.SSx2.p4.2.m2.1.1.2">𝑀</ci><cn type="integer" id="Sx4.SSx2.p4.2.m2.1.1.3.cmml" xref="Sx4.SSx2.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p4.2.m2.1c">M=1</annotation></semantics></math> in Eq (<a href="#Sx4.Ex2" title="Attention-based Anomaly Detection ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_title">Attention-based Anomaly Detection</span></a>).
When a VQA model uses multi-head attentions <cite class="ltx_cite ltx_citemacro_citep">(Kim, Jun, and Zhang <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>, we use the average of the maximum attention scores in each head over all attention heads.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Regularization of Attention Networks for Anomaly Detection</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">In unimodal tasks such as image and text classification, post-training of DNNs with known anomalies, such as outlier exposure (OE) <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>, has shown remarkable improvement of OOD detection <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Hein, Andriushchenko, and Bitterwolf <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>.
Unfortunately, we find that anomaly detection of VQA models does not improve much when we directly exploit OE.</p>
</div>
<div id="Sx4.SSx3.p2" class="ltx_para">
<p id="Sx4.SSx3.p2.4" class="ltx_p">In this section, we introduce how to regularize attention networks by post-training with additional anomalies for boosting anomaly detection of VQA models.
Similar to OE, we <span id="Sx4.SSx3.p2.4.1" class="ltx_text ltx_font_italic">explicitly</span> fine-tune VQA models to avoid strong attention to anomalies, adding a regularization of attention networks:</p>
<table id="A5.EGx3" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.Ex4.m1.5" class="ltx_Math" alttext="\displaystyle\mathbb{E}_{\left(\mathbf{v},\mathbf{q}\right)\sim P_{\text{in}}}\left[\log p_{\theta}\left(\mathbf{a}|\mathbf{v},\mathbf{q}\right)\right]" display="block"><semantics id="Sx4.Ex4.m1.5a"><mrow id="Sx4.Ex4.m1.5.5" xref="Sx4.Ex4.m1.5.5.cmml"><msub id="Sx4.Ex4.m1.5.5.3" xref="Sx4.Ex4.m1.5.5.3.cmml"><mi id="Sx4.Ex4.m1.5.5.3.2" xref="Sx4.Ex4.m1.5.5.3.2.cmml">𝔼</mi><mrow id="Sx4.Ex4.m1.2.2.2" xref="Sx4.Ex4.m1.2.2.2.cmml"><mrow id="Sx4.Ex4.m1.2.2.2.4.2" xref="Sx4.Ex4.m1.2.2.2.4.1.cmml"><mo id="Sx4.Ex4.m1.2.2.2.4.2.1" xref="Sx4.Ex4.m1.2.2.2.4.1.cmml">(</mo><mi id="Sx4.Ex4.m1.1.1.1.1" xref="Sx4.Ex4.m1.1.1.1.1.cmml">𝐯</mi><mo id="Sx4.Ex4.m1.2.2.2.4.2.2" xref="Sx4.Ex4.m1.2.2.2.4.1.cmml">,</mo><mi id="Sx4.Ex4.m1.2.2.2.2" xref="Sx4.Ex4.m1.2.2.2.2.cmml">𝐪</mi><mo id="Sx4.Ex4.m1.2.2.2.4.2.3" xref="Sx4.Ex4.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="Sx4.Ex4.m1.2.2.2.3" xref="Sx4.Ex4.m1.2.2.2.3.cmml">∼</mo><msub id="Sx4.Ex4.m1.2.2.2.5" xref="Sx4.Ex4.m1.2.2.2.5.cmml"><mi id="Sx4.Ex4.m1.2.2.2.5.2" xref="Sx4.Ex4.m1.2.2.2.5.2.cmml">P</mi><mtext id="Sx4.Ex4.m1.2.2.2.5.3" xref="Sx4.Ex4.m1.2.2.2.5.3a.cmml">in</mtext></msub></mrow></msub><mo lspace="0em" rspace="0em" id="Sx4.Ex4.m1.5.5.2" xref="Sx4.Ex4.m1.5.5.2.cmml">​</mo><mrow id="Sx4.Ex4.m1.5.5.1.1" xref="Sx4.Ex4.m1.5.5.1.2.cmml"><mo id="Sx4.Ex4.m1.5.5.1.1.2" xref="Sx4.Ex4.m1.5.5.1.2.1.cmml">[</mo><mrow id="Sx4.Ex4.m1.5.5.1.1.1" xref="Sx4.Ex4.m1.5.5.1.1.1.cmml"><mrow id="Sx4.Ex4.m1.5.5.1.1.1.3" xref="Sx4.Ex4.m1.5.5.1.1.1.3.cmml"><mi id="Sx4.Ex4.m1.5.5.1.1.1.3.1" xref="Sx4.Ex4.m1.5.5.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Sx4.Ex4.m1.5.5.1.1.1.3a" xref="Sx4.Ex4.m1.5.5.1.1.1.3.cmml">⁡</mo><msub id="Sx4.Ex4.m1.5.5.1.1.1.3.2" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2.cmml"><mi id="Sx4.Ex4.m1.5.5.1.1.1.3.2.2" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2.2.cmml">p</mi><mi id="Sx4.Ex4.m1.5.5.1.1.1.3.2.3" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx4.Ex4.m1.5.5.1.1.1.2" xref="Sx4.Ex4.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="Sx4.Ex4.m1.5.5.1.1.1.1.1" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.cmml"><mo id="Sx4.Ex4.m1.5.5.1.1.1.1.1.2" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.2" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.2.cmml">𝐚</mi><mo fence="false" id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.1" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><mrow id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.2" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mi id="Sx4.Ex4.m1.3.3" xref="Sx4.Ex4.m1.3.3.cmml">𝐯</mi><mo id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.2.1" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx4.Ex4.m1.4.4" xref="Sx4.Ex4.m1.4.4.cmml">𝐪</mi></mrow></mrow><mo id="Sx4.Ex4.m1.5.5.1.1.1.1.1.3" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx4.Ex4.m1.5.5.1.1.3" xref="Sx4.Ex4.m1.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex4.m1.5b"><apply id="Sx4.Ex4.m1.5.5.cmml" xref="Sx4.Ex4.m1.5.5"><times id="Sx4.Ex4.m1.5.5.2.cmml" xref="Sx4.Ex4.m1.5.5.2"></times><apply id="Sx4.Ex4.m1.5.5.3.cmml" xref="Sx4.Ex4.m1.5.5.3"><csymbol cd="ambiguous" id="Sx4.Ex4.m1.5.5.3.1.cmml" xref="Sx4.Ex4.m1.5.5.3">subscript</csymbol><ci id="Sx4.Ex4.m1.5.5.3.2.cmml" xref="Sx4.Ex4.m1.5.5.3.2">𝔼</ci><apply id="Sx4.Ex4.m1.2.2.2.cmml" xref="Sx4.Ex4.m1.2.2.2"><csymbol cd="latexml" id="Sx4.Ex4.m1.2.2.2.3.cmml" xref="Sx4.Ex4.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="Sx4.Ex4.m1.2.2.2.4.1.cmml" xref="Sx4.Ex4.m1.2.2.2.4.2"><ci id="Sx4.Ex4.m1.1.1.1.1.cmml" xref="Sx4.Ex4.m1.1.1.1.1">𝐯</ci><ci id="Sx4.Ex4.m1.2.2.2.2.cmml" xref="Sx4.Ex4.m1.2.2.2.2">𝐪</ci></interval><apply id="Sx4.Ex4.m1.2.2.2.5.cmml" xref="Sx4.Ex4.m1.2.2.2.5"><csymbol cd="ambiguous" id="Sx4.Ex4.m1.2.2.2.5.1.cmml" xref="Sx4.Ex4.m1.2.2.2.5">subscript</csymbol><ci id="Sx4.Ex4.m1.2.2.2.5.2.cmml" xref="Sx4.Ex4.m1.2.2.2.5.2">𝑃</ci><ci id="Sx4.Ex4.m1.2.2.2.5.3a.cmml" xref="Sx4.Ex4.m1.2.2.2.5.3"><mtext mathsize="50%" id="Sx4.Ex4.m1.2.2.2.5.3.cmml" xref="Sx4.Ex4.m1.2.2.2.5.3">in</mtext></ci></apply></apply></apply><apply id="Sx4.Ex4.m1.5.5.1.2.cmml" xref="Sx4.Ex4.m1.5.5.1.1"><csymbol cd="latexml" id="Sx4.Ex4.m1.5.5.1.2.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.2">delimited-[]</csymbol><apply id="Sx4.Ex4.m1.5.5.1.1.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1"><times id="Sx4.Ex4.m1.5.5.1.1.1.2.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.2"></times><apply id="Sx4.Ex4.m1.5.5.1.1.1.3.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3"><log id="Sx4.Ex4.m1.5.5.1.1.1.3.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3.1"></log><apply id="Sx4.Ex4.m1.5.5.1.1.1.3.2.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx4.Ex4.m1.5.5.1.1.1.3.2.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="Sx4.Ex4.m1.5.5.1.1.1.3.2.2.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2.2">𝑝</ci><ci id="Sx4.Ex4.m1.5.5.1.1.1.3.2.3.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.2">𝐚</ci><list id="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="Sx4.Ex4.m1.5.5.1.1.1.1.1.1.3.2"><ci id="Sx4.Ex4.m1.3.3.cmml" xref="Sx4.Ex4.m1.3.3">𝐯</ci><ci id="Sx4.Ex4.m1.4.4.cmml" xref="Sx4.Ex4.m1.4.4">𝐪</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex4.m1.5c">\displaystyle\mathbb{E}_{\left(\mathbf{v},\mathbf{q}\right)\sim P_{\text{in}}}\left[\log p_{\theta}\left(\mathbf{a}|\mathbf{v},\mathbf{q}\right)\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E5.m1.4" class="ltx_Math" alttext="\displaystyle+\lambda\mathbb{E}_{\left(\mathbf{v}^{\prime},\mathbf{q}^{\prime}\right)\sim P_{\text{anomaly}}}\left[\sum_{i=1}^{K}\sum_{j=1}^{M}\log\left(1-A_{ij}(\mathbf{v}^{\prime},\mathbf{q}^{\prime})\right)\right]" display="block"><semantics id="Sx4.E5.m1.4a"><mrow id="Sx4.E5.m1.4.4" xref="Sx4.E5.m1.4.4.cmml"><mo id="Sx4.E5.m1.4.4a" xref="Sx4.E5.m1.4.4.cmml">+</mo><mrow id="Sx4.E5.m1.4.4.1" xref="Sx4.E5.m1.4.4.1.cmml"><mi id="Sx4.E5.m1.4.4.1.3" xref="Sx4.E5.m1.4.4.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="Sx4.E5.m1.4.4.1.2" xref="Sx4.E5.m1.4.4.1.2.cmml">​</mo><msub id="Sx4.E5.m1.4.4.1.4" xref="Sx4.E5.m1.4.4.1.4.cmml"><mi id="Sx4.E5.m1.4.4.1.4.2" xref="Sx4.E5.m1.4.4.1.4.2.cmml">𝔼</mi><mrow id="Sx4.E5.m1.2.2.2" xref="Sx4.E5.m1.2.2.2.cmml"><mrow id="Sx4.E5.m1.2.2.2.2.2" xref="Sx4.E5.m1.2.2.2.2.3.cmml"><mo id="Sx4.E5.m1.2.2.2.2.2.3" xref="Sx4.E5.m1.2.2.2.2.3.cmml">(</mo><msup id="Sx4.E5.m1.1.1.1.1.1.1" xref="Sx4.E5.m1.1.1.1.1.1.1.cmml"><mi id="Sx4.E5.m1.1.1.1.1.1.1.2" xref="Sx4.E5.m1.1.1.1.1.1.1.2.cmml">𝐯</mi><mo id="Sx4.E5.m1.1.1.1.1.1.1.3" xref="Sx4.E5.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx4.E5.m1.2.2.2.2.2.4" xref="Sx4.E5.m1.2.2.2.2.3.cmml">,</mo><msup id="Sx4.E5.m1.2.2.2.2.2.2" xref="Sx4.E5.m1.2.2.2.2.2.2.cmml"><mi id="Sx4.E5.m1.2.2.2.2.2.2.2" xref="Sx4.E5.m1.2.2.2.2.2.2.2.cmml">𝐪</mi><mo id="Sx4.E5.m1.2.2.2.2.2.2.3" xref="Sx4.E5.m1.2.2.2.2.2.2.3.cmml">′</mo></msup><mo id="Sx4.E5.m1.2.2.2.2.2.5" xref="Sx4.E5.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="Sx4.E5.m1.2.2.2.3" xref="Sx4.E5.m1.2.2.2.3.cmml">∼</mo><msub id="Sx4.E5.m1.2.2.2.4" xref="Sx4.E5.m1.2.2.2.4.cmml"><mi id="Sx4.E5.m1.2.2.2.4.2" xref="Sx4.E5.m1.2.2.2.4.2.cmml">P</mi><mtext id="Sx4.E5.m1.2.2.2.4.3" xref="Sx4.E5.m1.2.2.2.4.3a.cmml">anomaly</mtext></msub></mrow></msub><mo lspace="0em" rspace="0em" id="Sx4.E5.m1.4.4.1.2a" xref="Sx4.E5.m1.4.4.1.2.cmml">​</mo><mrow id="Sx4.E5.m1.4.4.1.1.1" xref="Sx4.E5.m1.4.4.1.1.2.cmml"><mo id="Sx4.E5.m1.4.4.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.cmml"><munderover id="Sx4.E5.m1.4.4.1.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="Sx4.E5.m1.4.4.1.1.1.1.2.2.2" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.2" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.1" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.3" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E5.m1.4.4.1.1.1.1.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.cmml"><munderover id="Sx4.E5.m1.4.4.1.1.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.3.cmml">M</mi></munderover><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="Sx4.E5.m1.3.3" xref="Sx4.E5.m1.3.3.cmml">log</mi><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1a" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.4" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.4.cmml">1</mn><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.cmml">A</mi><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐪</mi><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">′</mo></msup><mo stretchy="false" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.5" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.3" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx4.E5.m1.4.4.1.1.1.3" xref="Sx4.E5.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E5.m1.4b"><apply id="Sx4.E5.m1.4.4.cmml" xref="Sx4.E5.m1.4.4"><plus id="Sx4.E5.m1.4.4.2.cmml" xref="Sx4.E5.m1.4.4"></plus><apply id="Sx4.E5.m1.4.4.1.cmml" xref="Sx4.E5.m1.4.4.1"><times id="Sx4.E5.m1.4.4.1.2.cmml" xref="Sx4.E5.m1.4.4.1.2"></times><ci id="Sx4.E5.m1.4.4.1.3.cmml" xref="Sx4.E5.m1.4.4.1.3">𝜆</ci><apply id="Sx4.E5.m1.4.4.1.4.cmml" xref="Sx4.E5.m1.4.4.1.4"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.4.1.cmml" xref="Sx4.E5.m1.4.4.1.4">subscript</csymbol><ci id="Sx4.E5.m1.4.4.1.4.2.cmml" xref="Sx4.E5.m1.4.4.1.4.2">𝔼</ci><apply id="Sx4.E5.m1.2.2.2.cmml" xref="Sx4.E5.m1.2.2.2"><csymbol cd="latexml" id="Sx4.E5.m1.2.2.2.3.cmml" xref="Sx4.E5.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="Sx4.E5.m1.2.2.2.2.3.cmml" xref="Sx4.E5.m1.2.2.2.2.2"><apply id="Sx4.E5.m1.1.1.1.1.1.1.cmml" xref="Sx4.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E5.m1.1.1.1.1.1.1.1.cmml" xref="Sx4.E5.m1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx4.E5.m1.1.1.1.1.1.1.2.cmml" xref="Sx4.E5.m1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.E5.m1.1.1.1.1.1.1.3.cmml" xref="Sx4.E5.m1.1.1.1.1.1.1.3">′</ci></apply><apply id="Sx4.E5.m1.2.2.2.2.2.2.cmml" xref="Sx4.E5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.2.2.2.2.2.2.1.cmml" xref="Sx4.E5.m1.2.2.2.2.2.2">superscript</csymbol><ci id="Sx4.E5.m1.2.2.2.2.2.2.2.cmml" xref="Sx4.E5.m1.2.2.2.2.2.2.2">𝐪</ci><ci id="Sx4.E5.m1.2.2.2.2.2.2.3.cmml" xref="Sx4.E5.m1.2.2.2.2.2.2.3">′</ci></apply></interval><apply id="Sx4.E5.m1.2.2.2.4.cmml" xref="Sx4.E5.m1.2.2.2.4"><csymbol cd="ambiguous" id="Sx4.E5.m1.2.2.2.4.1.cmml" xref="Sx4.E5.m1.2.2.2.4">subscript</csymbol><ci id="Sx4.E5.m1.2.2.2.4.2.cmml" xref="Sx4.E5.m1.2.2.2.4.2">𝑃</ci><ci id="Sx4.E5.m1.2.2.2.4.3a.cmml" xref="Sx4.E5.m1.2.2.2.4.3"><mtext mathsize="50%" id="Sx4.E5.m1.2.2.2.4.3.cmml" xref="Sx4.E5.m1.2.2.2.4.3">anomaly</mtext></ci></apply></apply></apply><apply id="Sx4.E5.m1.4.4.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1"><csymbol cd="latexml" id="Sx4.E5.m1.4.4.1.1.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="Sx4.E5.m1.4.4.1.1.1.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1"><apply id="Sx4.E5.m1.4.4.1.1.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="Sx4.E5.m1.4.4.1.1.1.1.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.2.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="Sx4.E5.m1.4.4.1.1.1.1.2.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.2"></sum><apply id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3"><eq id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.1"></eq><ci id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx4.E5.m1.4.4.1.1.1.1.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.2.3">𝐾</ci></apply><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1"><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.1.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3"><eq id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1"><log id="Sx4.E5.m1.3.3.cmml" xref="Sx4.E5.m1.3.3"></log><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1"><minus id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.3"></minus><cn type="integer" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.4">1</cn><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2"><times id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2">𝐴</ci><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3"><times id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1"></times><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2">𝑖</ci><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐪</ci><ci id="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.3">′</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E5.m1.4c">\displaystyle+\lambda\mathbb{E}_{\left(\mathbf{v}^{\prime},\mathbf{q}^{\prime}\right)\sim P_{\text{anomaly}}}\left[\sum_{i=1}^{K}\sum_{j=1}^{M}\log\left(1-A_{ij}(\mathbf{v}^{\prime},\mathbf{q}^{\prime})\right)\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx3.p2.3" class="ltx_p">where <math id="Sx4.SSx3.p2.1.m1.2" class="ltx_Math" alttext="(\mathbf{v}^{\prime},\mathbf{q}^{\prime})" display="inline"><semantics id="Sx4.SSx3.p2.1.m1.2a"><mrow id="Sx4.SSx3.p2.1.m1.2.2.2" xref="Sx4.SSx3.p2.1.m1.2.2.3.cmml"><mo stretchy="false" id="Sx4.SSx3.p2.1.m1.2.2.2.3" xref="Sx4.SSx3.p2.1.m1.2.2.3.cmml">(</mo><msup id="Sx4.SSx3.p2.1.m1.1.1.1.1" xref="Sx4.SSx3.p2.1.m1.1.1.1.1.cmml"><mi id="Sx4.SSx3.p2.1.m1.1.1.1.1.2" xref="Sx4.SSx3.p2.1.m1.1.1.1.1.2.cmml">𝐯</mi><mo id="Sx4.SSx3.p2.1.m1.1.1.1.1.3" xref="Sx4.SSx3.p2.1.m1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx4.SSx3.p2.1.m1.2.2.2.4" xref="Sx4.SSx3.p2.1.m1.2.2.3.cmml">,</mo><msup id="Sx4.SSx3.p2.1.m1.2.2.2.2" xref="Sx4.SSx3.p2.1.m1.2.2.2.2.cmml"><mi id="Sx4.SSx3.p2.1.m1.2.2.2.2.2" xref="Sx4.SSx3.p2.1.m1.2.2.2.2.2.cmml">𝐪</mi><mo id="Sx4.SSx3.p2.1.m1.2.2.2.2.3" xref="Sx4.SSx3.p2.1.m1.2.2.2.2.3.cmml">′</mo></msup><mo stretchy="false" id="Sx4.SSx3.p2.1.m1.2.2.2.5" xref="Sx4.SSx3.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.1.m1.2b"><interval closure="open" id="Sx4.SSx3.p2.1.m1.2.2.3.cmml" xref="Sx4.SSx3.p2.1.m1.2.2.2"><apply id="Sx4.SSx3.p2.1.m1.1.1.1.1.cmml" xref="Sx4.SSx3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p2.1.m1.1.1.1.1.1.cmml" xref="Sx4.SSx3.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="Sx4.SSx3.p2.1.m1.1.1.1.1.2.cmml" xref="Sx4.SSx3.p2.1.m1.1.1.1.1.2">𝐯</ci><ci id="Sx4.SSx3.p2.1.m1.1.1.1.1.3.cmml" xref="Sx4.SSx3.p2.1.m1.1.1.1.1.3">′</ci></apply><apply id="Sx4.SSx3.p2.1.m1.2.2.2.2.cmml" xref="Sx4.SSx3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx3.p2.1.m1.2.2.2.2.1.cmml" xref="Sx4.SSx3.p2.1.m1.2.2.2.2">superscript</csymbol><ci id="Sx4.SSx3.p2.1.m1.2.2.2.2.2.cmml" xref="Sx4.SSx3.p2.1.m1.2.2.2.2.2">𝐪</ci><ci id="Sx4.SSx3.p2.1.m1.2.2.2.2.3.cmml" xref="Sx4.SSx3.p2.1.m1.2.2.2.2.3">′</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.1.m1.2c">(\mathbf{v}^{\prime},\mathbf{q}^{\prime})</annotation></semantics></math> is sampled from selected anomaly datasets, <math id="Sx4.SSx3.p2.2.m2.1" class="ltx_Math" alttext="P_{\text{anomaly}}" display="inline"><semantics id="Sx4.SSx3.p2.2.m2.1a"><msub id="Sx4.SSx3.p2.2.m2.1.1" xref="Sx4.SSx3.p2.2.m2.1.1.cmml"><mi id="Sx4.SSx3.p2.2.m2.1.1.2" xref="Sx4.SSx3.p2.2.m2.1.1.2.cmml">P</mi><mtext id="Sx4.SSx3.p2.2.m2.1.1.3" xref="Sx4.SSx3.p2.2.m2.1.1.3a.cmml">anomaly</mtext></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.2.m2.1b"><apply id="Sx4.SSx3.p2.2.m2.1.1.cmml" xref="Sx4.SSx3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p2.2.m2.1.1.1.cmml" xref="Sx4.SSx3.p2.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx3.p2.2.m2.1.1.2.cmml" xref="Sx4.SSx3.p2.2.m2.1.1.2">𝑃</ci><ci id="Sx4.SSx3.p2.2.m2.1.1.3a.cmml" xref="Sx4.SSx3.p2.2.m2.1.1.3"><mtext mathsize="70%" id="Sx4.SSx3.p2.2.m2.1.1.3.cmml" xref="Sx4.SSx3.p2.2.m2.1.1.3">anomaly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.2.m2.1c">P_{\text{anomaly}}</annotation></semantics></math>, and <math id="Sx4.SSx3.p2.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Sx4.SSx3.p2.3.m3.1a"><mi id="Sx4.SSx3.p2.3.m3.1.1" xref="Sx4.SSx3.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.3.m3.1b"><ci id="Sx4.SSx3.p2.3.m3.1.1.cmml" xref="Sx4.SSx3.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.3.m3.1c">\lambda</annotation></semantics></math> is a hyperparameter.
If the high order attention is used, we also regularize all elements in the multi-order attention maps.</p>
</div>
<div id="Sx4.SSx3.p3" class="ltx_para">
<p id="Sx4.SSx3.p3.2" class="ltx_p">Note that a uniform distribution is the optimal solution for maximizing the regularization term in Eq (<a href="#Sx4.E5" title="In Regularization of Attention Networks for Anomaly Detection ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), which is a constraint on <math id="Sx4.SSx3.p3.1.m1.1" class="ltx_Math" alttext="\sum_{i=1}^{K}\sum_{j=1}^{M}{A_{ij}}=1" display="inline"><semantics id="Sx4.SSx3.p3.1.m1.1a"><mrow id="Sx4.SSx3.p3.1.m1.1.1" xref="Sx4.SSx3.p3.1.m1.1.1.cmml"><mrow id="Sx4.SSx3.p3.1.m1.1.1.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.cmml"><msubsup id="Sx4.SSx3.p3.1.m1.1.1.2.1" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.cmml"><mo id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.2.cmml">∑</mo><mrow id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.cmml"><mi id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.2.cmml">i</mi><mo id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.1" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.1.cmml">=</mo><mn id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="Sx4.SSx3.p3.1.m1.1.1.2.1.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.3.cmml">K</mi></msubsup><mrow id="Sx4.SSx3.p3.1.m1.1.1.2.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.cmml"><msubsup id="Sx4.SSx3.p3.1.m1.1.1.2.2.1" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.cmml"><mo lspace="0.167em" id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.cmml"><mi id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.2.cmml">j</mi><mo id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.1" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.1.cmml">=</mo><mn id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.3.cmml">M</mi></msubsup><msub id="Sx4.SSx3.p3.1.m1.1.1.2.2.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.cmml"><mi id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.2.cmml">A</mi><mrow id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.cmml"><mi id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.2" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.1" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.1.cmml">​</mo><mi id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.3" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="Sx4.SSx3.p3.1.m1.1.1.1" xref="Sx4.SSx3.p3.1.m1.1.1.1.cmml">=</mo><mn id="Sx4.SSx3.p3.1.m1.1.1.3" xref="Sx4.SSx3.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p3.1.m1.1b"><apply id="Sx4.SSx3.p3.1.m1.1.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1"><eq id="Sx4.SSx3.p3.1.m1.1.1.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.1"></eq><apply id="Sx4.SSx3.p3.1.m1.1.1.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2"><apply id="Sx4.SSx3.p3.1.m1.1.1.2.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.1.m1.1.1.2.1.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1">superscript</csymbol><apply id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1">subscript</csymbol><sum id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.2"></sum><apply id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3"><eq id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.1"></eq><ci id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="Sx4.SSx3.p3.1.m1.1.1.2.1.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.1.3">𝐾</ci></apply><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2"><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1">superscript</csymbol><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1">subscript</csymbol><sum id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.2"></sum><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3"><eq id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.1"></eq><ci id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.2">𝑗</ci><cn type="integer" id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="Sx4.SSx3.p3.1.m1.1.1.2.2.1.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.1.3">𝑀</ci></apply><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2">subscript</csymbol><ci id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.2">𝐴</ci><apply id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3"><times id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.1.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.1"></times><ci id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.2.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.2">𝑖</ci><ci id="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></apply></apply><cn type="integer" id="Sx4.SSx3.p3.1.m1.1.1.3.cmml" xref="Sx4.SSx3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p3.1.m1.1c">\sum_{i=1}^{K}\sum_{j=1}^{M}{A_{ij}}=1</annotation></semantics></math> such that <math id="Sx4.SSx3.p3.2.m2.2" class="ltx_Math" alttext="A_{ij}\in\left[0,1\right]" display="inline"><semantics id="Sx4.SSx3.p3.2.m2.2a"><mrow id="Sx4.SSx3.p3.2.m2.2.3" xref="Sx4.SSx3.p3.2.m2.2.3.cmml"><msub id="Sx4.SSx3.p3.2.m2.2.3.2" xref="Sx4.SSx3.p3.2.m2.2.3.2.cmml"><mi id="Sx4.SSx3.p3.2.m2.2.3.2.2" xref="Sx4.SSx3.p3.2.m2.2.3.2.2.cmml">A</mi><mrow id="Sx4.SSx3.p3.2.m2.2.3.2.3" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.cmml"><mi id="Sx4.SSx3.p3.2.m2.2.3.2.3.2" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p3.2.m2.2.3.2.3.1" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.1.cmml">​</mo><mi id="Sx4.SSx3.p3.2.m2.2.3.2.3.3" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.3.cmml">j</mi></mrow></msub><mo id="Sx4.SSx3.p3.2.m2.2.3.1" xref="Sx4.SSx3.p3.2.m2.2.3.1.cmml">∈</mo><mrow id="Sx4.SSx3.p3.2.m2.2.3.3.2" xref="Sx4.SSx3.p3.2.m2.2.3.3.1.cmml"><mo id="Sx4.SSx3.p3.2.m2.2.3.3.2.1" xref="Sx4.SSx3.p3.2.m2.2.3.3.1.cmml">[</mo><mn id="Sx4.SSx3.p3.2.m2.1.1" xref="Sx4.SSx3.p3.2.m2.1.1.cmml">0</mn><mo id="Sx4.SSx3.p3.2.m2.2.3.3.2.2" xref="Sx4.SSx3.p3.2.m2.2.3.3.1.cmml">,</mo><mn id="Sx4.SSx3.p3.2.m2.2.2" xref="Sx4.SSx3.p3.2.m2.2.2.cmml">1</mn><mo id="Sx4.SSx3.p3.2.m2.2.3.3.2.3" xref="Sx4.SSx3.p3.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p3.2.m2.2b"><apply id="Sx4.SSx3.p3.2.m2.2.3.cmml" xref="Sx4.SSx3.p3.2.m2.2.3"><in id="Sx4.SSx3.p3.2.m2.2.3.1.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.1"></in><apply id="Sx4.SSx3.p3.2.m2.2.3.2.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="Sx4.SSx3.p3.2.m2.2.3.2.1.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2">subscript</csymbol><ci id="Sx4.SSx3.p3.2.m2.2.3.2.2.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2.2">𝐴</ci><apply id="Sx4.SSx3.p3.2.m2.2.3.2.3.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2.3"><times id="Sx4.SSx3.p3.2.m2.2.3.2.3.1.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.1"></times><ci id="Sx4.SSx3.p3.2.m2.2.3.2.3.2.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.2">𝑖</ci><ci id="Sx4.SSx3.p3.2.m2.2.3.2.3.3.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.2.3.3">𝑗</ci></apply></apply><interval closure="closed" id="Sx4.SSx3.p3.2.m2.2.3.3.1.cmml" xref="Sx4.SSx3.p3.2.m2.2.3.3.2"><cn type="integer" id="Sx4.SSx3.p3.2.m2.1.1.cmml" xref="Sx4.SSx3.p3.2.m2.1.1">0</cn><cn type="integer" id="Sx4.SSx3.p3.2.m2.2.2.cmml" xref="Sx4.SSx3.p3.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p3.2.m2.2c">A_{ij}\in\left[0,1\right]</annotation></semantics></math>. Maximizing entropy of the attention distribution makes MAPs on anomalies close to zero, and the VQA models can easily distinguish anomalies from normal samples by the MAPs.</p>
</div>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<section id="Sx5.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Experimental Setup</h3>

<section id="Sx5.SSx1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">VQA Models</h4>

<div id="Sx5.SSx1.SSSx1.p1" class="ltx_para">
<p id="Sx5.SSx1.SSSx1.p1.1" class="ltx_p">We evaluate four VQA models, which have different attention networks and have shown promising results in recent VQA challenges: BUTD <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, MHB+ATT <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite>, BAN <cite class="ltx_cite ltx_citemacro_citep">(Kim, Jun, and Zhang <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>, and MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="Sx5.SSx1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Datasets</h4>

<div id="Sx5.SSx1.SSSx2.p1" class="ltx_para">
<p id="Sx5.SSx1.SSSx2.p1.1" class="ltx_p">The VQA v2 dataset <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al. <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> is used for training and is considered normal.
Test samples of MNIST, SVHN, FashionMNIST, CIFAR-10, and TinyImageNet are used for OOD images.
The 20 Newsgroup, Reuter 52, and IMDB movie review datasets are used for OOD questions.
For irrelevant question datasets, the two test datasets are used: 1) Visual vs. Non-visual Question (VNQ) <cite class="ltx_cite ltx_citemacro_citep">(Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite> contains general knowledge or philosophical questions.
2) Question Relevance Prediction and Explanation (QRPE) <cite class="ltx_cite ltx_citemacro_citep">(Mahendru et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> contains questions with false-premises about the existence of visual objects in the VQA v2 images.
We define answer candidates that occur in the training dataset over nine times, and 4303 samples in the VQA dataset have undefined answers, which occur in the training dataset fewer than nine times.</p>
</div>
</section>
<section id="Sx5.SSx1.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Training Setup</h4>

<div id="Sx5.SSx1.SSSx3.p1" class="ltx_para">
<p id="Sx5.SSx1.SSSx3.p1.1" class="ltx_p"><math id="Sx5.SSx1.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="K=36" display="inline"><semantics id="Sx5.SSx1.SSSx3.p1.1.m1.1a"><mrow id="Sx5.SSx1.SSSx3.p1.1.m1.1.1" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.cmml"><mi id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.2" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.2.cmml">K</mi><mo id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.1" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.1.cmml">=</mo><mn id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.3" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx3.p1.1.m1.1b"><apply id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.cmml" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1"><eq id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.1.cmml" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.1"></eq><ci id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.2.cmml" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="Sx5.SSx1.SSSx3.p1.1.m1.1.1.3.cmml" xref="Sx5.SSx1.SSSx3.p1.1.m1.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx3.p1.1.m1.1c">K=36</annotation></semantics></math> objects are detected by pretrained faster R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib31" title="" class="ltx_ref">2015</a>)</cite>, and a 2048 dimensional vector for each object is extracted by pretrained ResNet-152 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite>.
Question tokens are trimmed to a maximum of 14 words, and pretrained GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib28" title="" class="ltx_ref">2014</a>)</cite> is used for word embedding.
The batch size is 256.</p>
</div>
<div id="Sx5.SSx1.SSSx3.p2" class="ltx_para">
<p id="Sx5.SSx1.SSSx3.p2.4" class="ltx_p">For regularization of the attention network, we use training samples of TinyImage, VNQ, and QRPE for <math id="Sx5.SSx1.SSSx3.p2.1.m1.1" class="ltx_Math" alttext="P_{\text{anomaly}}" display="inline"><semantics id="Sx5.SSx1.SSSx3.p2.1.m1.1a"><msub id="Sx5.SSx1.SSSx3.p2.1.m1.1.1" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.cmml"><mi id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.2" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.2.cmml">P</mi><mtext id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3a.cmml">anomaly</mtext></msub><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx3.p2.1.m1.1b"><apply id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.cmml" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.1.cmml" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1">subscript</csymbol><ci id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.2.cmml" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.2">𝑃</ci><ci id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3a.cmml" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3"><mtext mathsize="70%" id="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3.cmml" xref="Sx5.SSx1.SSSx3.p2.1.m1.1.1.3">anomaly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx3.p2.1.m1.1c">P_{\text{anomaly}}</annotation></semantics></math> in Eq (<a href="#Sx4.E5" title="In Regularization of Attention Networks for Anomaly Detection ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
Note that there is no overlap of anomaly data between data for training and evaluation.
VQA models can be trained with the regularization from scratch, but we have found that they require a longer training time but have poor accuracy.
For example, a BUTD model has 44 % VQA accuracy when it is trained with the regularization from scratch.
Thus, we fine-tune the pretrained VQA models in 15 epochs, and the <math id="Sx5.SSx1.SSSx3.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Sx5.SSx1.SSSx3.p2.2.m2.1a"><mi id="Sx5.SSx1.SSSx3.p2.2.m2.1.1" xref="Sx5.SSx1.SSSx3.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx3.p2.2.m2.1b"><ci id="Sx5.SSx1.SSSx3.p2.2.m2.1.1.cmml" xref="Sx5.SSx1.SSSx3.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx3.p2.2.m2.1c">\lambda</annotation></semantics></math> in Eq (<a href="#Sx4.E5" title="In Regularization of Attention Networks for Anomaly Detection ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) is set to 0.00001.
We choose small value of <math id="Sx5.SSx1.SSSx3.p2.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Sx5.SSx1.SSSx3.p2.3.m3.1a"><mi id="Sx5.SSx1.SSSx3.p2.3.m3.1.1" xref="Sx5.SSx1.SSSx3.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx3.p2.3.m3.1b"><ci id="Sx5.SSx1.SSSx3.p2.3.m3.1.1.cmml" xref="Sx5.SSx1.SSSx3.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx3.p2.3.m3.1c">\lambda</annotation></semantics></math> to balance the magnitude of the original loss and the regularization loss.
At the first epoch of post-training, the regularization loss can have up to 100 times larger value than the original loss, and large <math id="Sx5.SSx1.SSSx3.p2.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Sx5.SSx1.SSSx3.p2.4.m4.1a"><mi id="Sx5.SSx1.SSSx3.p2.4.m4.1.1" xref="Sx5.SSx1.SSSx3.p2.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx3.p2.4.m4.1b"><ci id="Sx5.SSx1.SSSx3.p2.4.m4.1.1.cmml" xref="Sx5.SSx1.SSSx3.p2.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx3.p2.4.m4.1c">\lambda</annotation></semantics></math> can make the post-training unstable.</p>
</div>
</section>
<section id="Sx5.SSx1.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Evaluation</h4>

<div id="Sx5.SSx1.SSSx4.p1" class="ltx_para">
<p id="Sx5.SSx1.SSSx4.p1.2" class="ltx_p">We fuse the normal and abnormal datasets and evaluate whether VQA models can distinguish anomalies from normal samples.
We use a threshold-free metric, the area under the receiver operating characteristic curve (AUROC), for evaluating OOD and undefined answer detection.
The uninformative detector has 50.0 AUROC.
We use 10 % of training samples to determine the increased temperature <math id="Sx5.SSx1.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx5.SSx1.SSSx4.p1.1.m1.1a"><mi id="Sx5.SSx1.SSSx4.p1.1.m1.1.1" xref="Sx5.SSx1.SSSx4.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx4.p1.1.m1.1b"><ci id="Sx5.SSx1.SSSx4.p1.1.m1.1.1.cmml" xref="Sx5.SSx1.SSSx4.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx4.p1.1.m1.1c">T</annotation></semantics></math> and <math id="Sx5.SSx1.SSSx4.p1.2.m2.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="Sx5.SSx1.SSSx4.p1.2.m2.1a"><mi id="Sx5.SSx1.SSSx4.p1.2.m2.1.1" xref="Sx5.SSx1.SSSx4.p1.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx4.p1.2.m2.1b"><ci id="Sx5.SSx1.SSSx4.p1.2.m2.1.1.cmml" xref="Sx5.SSx1.SSSx4.p1.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx4.p1.2.m2.1c">\delta</annotation></semantics></math>, maximizing AUROC scores on the samples.</p>
</div>
</section>
<section id="Sx5.SSx1.SSSx5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Compared Methods for Anomaly Detection</h4>

<div id="Sx5.SSx1.SSSx5.p1" class="ltx_para">
<p id="Sx5.SSx1.SSSx5.p1.1" class="ltx_p">We use the two baselines of anomaly detection for VQA models: the MSP <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite> and the maximum attention probability (MAP, ours).
Then, we also compare the AUROCs of the three variants of MSP and MAP with increased temperature (T), outlier exposure (OE), and our regularizing attention networks (RA).
We exclude the results of RA-MSP and OE-MAP, since RA-MAP is significantly better than RA-MSP, and OE-MAP is worse than MAP.</p>
</div>
<figure id="Sx5.T2" class="ltx_table">
<table id="Sx5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx5.T2.1.1.1" class="ltx_tr">
<th id="Sx5.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Accuracy (%)</th>
<th id="Sx5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Baseline</th>
<th id="Sx5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">OE</th>
<th id="Sx5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Ours</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx5.T2.1.2.1" class="ltx_tr">
<th id="Sx5.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">BUTD</th>
<td id="Sx5.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">62.6</td>
<td id="Sx5.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">54.9(-7.7)</td>
<td id="Sx5.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">61.9(-0.5)</td>
</tr>
<tr id="Sx5.T2.1.3.2" class="ltx_tr">
<th id="Sx5.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MHB+ATT</th>
<td id="Sx5.T2.1.3.2.2" class="ltx_td ltx_align_center">63.3</td>
<td id="Sx5.T2.1.3.2.3" class="ltx_td ltx_align_center">62.4(-0.9)</td>
<td id="Sx5.T2.1.3.2.4" class="ltx_td ltx_align_center">62.8(-0.5)</td>
</tr>
<tr id="Sx5.T2.1.4.3" class="ltx_tr">
<th id="Sx5.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">BAN</th>
<td id="Sx5.T2.1.4.3.2" class="ltx_td ltx_align_center">63.8</td>
<td id="Sx5.T2.1.4.3.3" class="ltx_td ltx_align_center">61.9(-1.9)</td>
<td id="Sx5.T2.1.4.3.4" class="ltx_td ltx_align_center">63.7(-0.1)</td>
</tr>
<tr id="Sx5.T2.1.5.4" class="ltx_tr">
<th id="Sx5.T2.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">MCAN</th>
<td id="Sx5.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b">64.3</td>
<td id="Sx5.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b">62.0 (-2.3)</td>
<td id="Sx5.T2.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b">62.4 (-1.9)</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>VQA Accuracy and its degradation after post-training of VQA models</figcaption>
</figure>
<figure id="Sx5.T3" class="ltx_table">
<div id="Sx5.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:537.2pt;height:188.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-14.1pt,4.9pt) scale(0.95,0.95) ;">
<table id="Sx5.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx5.T3.1.1.1.1" class="ltx_tr">
<th id="Sx5.T3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AUROC</th>
<td id="Sx5.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">BUTD</td>
<td id="Sx5.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MHB+ATT</td>
<td id="Sx5.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">BAN</td>
<td id="Sx5.T3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">MCAN</td>
</tr>
<tr id="Sx5.T3.1.1.2.2" class="ltx_tr">
<th id="Sx5.T3.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Image</th>
<td id="Sx5.T3.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="Sx5.T3.1.1.3.3" class="ltx_tr">
<th id="Sx5.T3.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">MNIST</th>
<td id="Sx5.T3.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.3/71.5/75.0/89.0/<span id="Sx5.T3.1.1.3.3.2.1" class="ltx_text ltx_font_bold">97.8</span>
</td>
<td id="Sx5.T3.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.2/42.4/<span id="Sx5.T3.1.1.3.3.3.1" class="ltx_text ltx_font_bold">95.9</span>/89.9/94.7</td>
<td id="Sx5.T3.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.8/35.0/54.1/99.0/<span id="Sx5.T3.1.1.3.3.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="Sx5.T3.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">58.7/58.1/64.0/84.1/<span id="Sx5.T3.1.1.3.3.5.1" class="ltx_text ltx_font_bold">95.1</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.4.4" class="ltx_tr">
<th id="Sx5.T3.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SVHN</th>
<td id="Sx5.T3.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">60.5/72.8/75.2/90.3/<span id="Sx5.T3.1.1.4.4.2.1" class="ltx_text ltx_font_bold">97.9</span>
</td>
<td id="Sx5.T3.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">54.1/42.4/<span id="Sx5.T3.1.1.4.4.3.1" class="ltx_text ltx_font_bold">96.6</span>/89.7/96.2</td>
<td id="Sx5.T3.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r">55.0/35.2/55.5/100/<span id="Sx5.T3.1.1.4.4.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="Sx5.T3.1.1.4.4.5" class="ltx_td ltx_align_center">58.8/58.1/64.2/83.6/<span id="Sx5.T3.1.1.4.4.5.1" class="ltx_text ltx_font_bold">95.2</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.5.5" class="ltx_tr">
<th id="Sx5.T3.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FashionMNIST</th>
<td id="Sx5.T3.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">60.4/72.2/75.3/89.6/<span id="Sx5.T3.1.1.5.5.2.1" class="ltx_text ltx_font_bold">97.8</span>
</td>
<td id="Sx5.T3.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">53.9/42.0/<span id="Sx5.T3.1.1.5.5.3.1" class="ltx_text ltx_font_bold">96.4</span>/90.5/95.7</td>
<td id="Sx5.T3.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">54.9/35.0/55.4/99.9/<span id="Sx5.T3.1.1.5.5.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="Sx5.T3.1.1.5.5.5" class="ltx_td ltx_align_center">58.8/58.1/64.1/84.5/<span id="Sx5.T3.1.1.5.5.5.1" class="ltx_text ltx_font_bold">95.3</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.6.6" class="ltx_tr">
<th id="Sx5.T3.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">CIFAR10</th>
<td id="Sx5.T3.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r">60.7/73.5/75.5/90.5/<span id="Sx5.T3.1.1.6.6.2.1" class="ltx_text ltx_font_bold">98.0</span>
</td>
<td id="Sx5.T3.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">54.1/42.3/<span id="Sx5.T3.1.1.6.6.3.1" class="ltx_text ltx_font_bold">97.1</span>/89.9/96.9</td>
<td id="Sx5.T3.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r">55.0/35.3/56.1/100/<span id="Sx5.T3.1.1.6.6.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="Sx5.T3.1.1.6.6.5" class="ltx_td ltx_align_center">58.7/58.1/64.2/83.5/<span id="Sx5.T3.1.1.6.6.5.1" class="ltx_text ltx_font_bold">95.3</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.7.7" class="ltx_tr">
<th id="Sx5.T3.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">TinyImageNet</th>
<td id="Sx5.T3.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">61.4/75.6/75.5/92.7/<span id="Sx5.T3.1.1.7.7.2.1" class="ltx_text ltx_font_bold">99.7</span>
</td>
<td id="Sx5.T3.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">53.8/41.6/96.8/91.5/<span id="Sx5.T3.1.1.7.7.3.1" class="ltx_text ltx_font_bold">99.2</span>
</td>
<td id="Sx5.T3.1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r">54.8/34.8/59.7/100/<span id="Sx5.T3.1.1.7.7.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="Sx5.T3.1.1.7.7.5" class="ltx_td ltx_align_center">58.9/58.3/64.2/83.4/<span id="Sx5.T3.1.1.7.7.5.1" class="ltx_text ltx_font_bold">95.1</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.8.8" class="ltx_tr">
<th id="Sx5.T3.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Question</th>
<td id="Sx5.T3.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="Sx5.T3.1.1.9.9" class="ltx_tr">
<th id="Sx5.T3.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">20 Newsgroup</th>
<td id="Sx5.T3.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">69.3/79.8/47.1/78.2/<span id="Sx5.T3.1.1.9.9.2.1" class="ltx_text ltx_font_bold">95.5</span>
</td>
<td id="Sx5.T3.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.1/55.0/73.8/78.9/<span id="Sx5.T3.1.1.9.9.3.1" class="ltx_text ltx_font_bold">92.6</span>
</td>
<td id="Sx5.T3.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.0/81.5/62.6/81.7/<span id="Sx5.T3.1.1.9.9.4.1" class="ltx_text ltx_font_bold">87.3</span>
</td>
<td id="Sx5.T3.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">62.3/62.6/73.0/81.1/<span id="Sx5.T3.1.1.9.9.5.1" class="ltx_text ltx_font_bold">88.7</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.10.10" class="ltx_tr">
<th id="Sx5.T3.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Reuters52</th>
<td id="Sx5.T3.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r">70.2/81.5/47.5/76.4/<span id="Sx5.T3.1.1.10.10.2.1" class="ltx_text ltx_font_bold">97.0</span>
</td>
<td id="Sx5.T3.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">50.9/52.0/77.7/77.4/<span id="Sx5.T3.1.1.10.10.3.1" class="ltx_text ltx_font_bold">94.3</span>
</td>
<td id="Sx5.T3.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r">64.3/83.2/60.0/81.7/<span id="Sx5.T3.1.1.10.10.4.1" class="ltx_text ltx_font_bold">87.3</span>
</td>
<td id="Sx5.T3.1.1.10.10.5" class="ltx_td ltx_align_center">62.0/60.1/75.3/83.9/<span id="Sx5.T3.1.1.10.10.5.1" class="ltx_text ltx_font_bold">94.2</span>
</td>
</tr>
<tr id="Sx5.T3.1.1.11.11" class="ltx_tr">
<th id="Sx5.T3.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">IMDB</th>
<td id="Sx5.T3.1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">59.9/69.2/45.4/78.2/<span id="Sx5.T3.1.1.11.11.2.1" class="ltx_text ltx_font_bold">92.8</span>
</td>
<td id="Sx5.T3.1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">49.4/50.2/70.0/77.9/<span id="Sx5.T3.1.1.11.11.3.1" class="ltx_text ltx_font_bold">91.1</span>
</td>
<td id="Sx5.T3.1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">56.1/76.3/60.7/78.1/<span id="Sx5.T3.1.1.11.11.4.1" class="ltx_text ltx_font_bold">82.5</span>
</td>
<td id="Sx5.T3.1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_b">57.3/56.3/67.6/85.4/<span id="Sx5.T3.1.1.11.11.5.1" class="ltx_text ltx_font_bold">90.9</span>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Out-of-distribution detection performance of VQA models.</figcaption>
</figure>
</section>
</section>
<section id="Sx5.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Evaluation of VQA Accuracy</h3>

<div id="Sx5.SSx2.p1" class="ltx_para">
<p id="Sx5.SSx2.p1.1" class="ltx_p">Although post-training for a robust model is known to degrade the accuracy <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow, Shlens, and Szegedy <a href="#bib.bib8" title="" class="ltx_ref">2014</a>; Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>, we find that OE results in more degradation of VQA accuracy on the VQA v2 validation dataset than our regularization (Table <a href="#Sx5.T2" title="Table 2 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
OE affects all trainable parameters in the VQA models, easily making VQA models unstable, while our regularization affects parameters related to attention networks.
Note that OE severely degrades the accuracy of the BUTD model by 7.7%.</p>
</div>
</section>
<section id="Sx5.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Out-of-Distribution Detection (Task 1-3)</h3>

<div id="Sx5.SSx3.p1" class="ltx_para">
<p id="Sx5.SSx3.p1.1" class="ltx_p">We analyze the performance of VQA models and anomaly detection methods on various OOD datasets (Table <a href="#Sx5.T3" title="Table 3 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
Our experiments include two main results: 1) previous confidence-based approaches (MSP, OE-MSP) fail to detect OOD samples, and 2) our attention-based approaches (MAP, RA-MAP) significantly improve OOD detection in VQA.</p>
</div>
<section id="Sx5.SSx3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Attention-based Anomaly Detection</h4>

<div id="Sx5.SSx3.SSSx1.p1" class="ltx_para">
<p id="Sx5.SSx3.SSSx1.p1.2" class="ltx_p">In contrast to the results in unimodal tasks, Table <a href="#Sx5.T3" title="Table 3 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that MSP is not a proper metric for detecting images and questions from out-of-distribution.
Since MSP directly estimates <math id="Sx5.SSx3.SSSx1.p1.1.m1.3" class="ltx_Math" alttext="p(\mathbf{a}|\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx5.SSx3.SSSx1.p1.1.m1.3a"><mrow id="Sx5.SSx3.SSSx1.p1.1.m1.3.3" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.cmml"><mi id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.3" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.2" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.2.cmml">​</mo><mrow id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.2" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.cmml"><mi id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.2" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.2.cmml">𝐚</mi><mo fence="false" id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.1" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.2" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.1.cmml"><mi id="Sx5.SSx3.SSSx1.p1.1.m1.1.1" xref="Sx5.SSx3.SSSx1.p1.1.m1.1.1.cmml">𝐯</mi><mo id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.2.1" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="Sx5.SSx3.SSSx1.p1.1.m1.2.2" xref="Sx5.SSx3.SSSx1.p1.1.m1.2.2.cmml">𝐪</mi></mrow></mrow><mo stretchy="false" id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.3" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx3.SSSx1.p1.1.m1.3b"><apply id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3"><times id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.2.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.2"></times><ci id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.3.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.3">𝑝</ci><apply id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1"><csymbol cd="latexml" id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.1.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.2.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.2">𝐚</ci><list id="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.3.3.1.1.1.3.2"><ci id="Sx5.SSx3.SSSx1.p1.1.m1.1.1.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.1.1">𝐯</ci><ci id="Sx5.SSx3.SSSx1.p1.1.m1.2.2.cmml" xref="Sx5.SSx3.SSSx1.p1.1.m1.2.2">𝐪</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx3.SSSx1.p1.1.m1.3c">p(\mathbf{a}|\mathbf{v},\mathbf{q})</annotation></semantics></math>, not <math id="Sx5.SSx3.SSSx1.p1.2.m2.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx5.SSx3.SSSx1.p1.2.m2.2a"><mrow id="Sx5.SSx3.SSSx1.p1.2.m2.2.3" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.cmml"><mi id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.2" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.1" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.1.cmml">​</mo><mrow id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.2" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.2.1" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="Sx5.SSx3.SSSx1.p1.2.m2.1.1" xref="Sx5.SSx3.SSSx1.p1.2.m2.1.1.cmml">𝐯</mi><mo id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.2.2" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="Sx5.SSx3.SSSx1.p1.2.m2.2.2" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.2.3" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx3.SSSx1.p1.2.m2.2b"><apply id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3"><times id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.1.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.1"></times><ci id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.2.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.2">𝑝</ci><interval closure="open" id="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.1.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.3.3.2"><ci id="Sx5.SSx3.SSSx1.p1.2.m2.1.1.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.1.1">𝐯</ci><ci id="Sx5.SSx3.SSSx1.p1.2.m2.2.2.cmml" xref="Sx5.SSx3.SSSx1.p1.2.m2.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx3.SSSx1.p1.2.m2.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>, it fails to detect OOD images and questions.
For example, the AUROCs of MSP (T) in unimodal tasks are close to 100.0 <cite class="ltx_cite ltx_citemacro_citep">(Liang, Li, and Srikant <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite>, but the MSP and MSP(T) of the VQA models are fairly closed to the AUROC of the uninformative detector.
Furthermore, MHB+ATT and BAN rather have more confident predictions on OOD images than normal inputs.
The result is unintuitive, but a similar result, where the OOD samples have higher likelihood than ID samples, is also reported in <cite class="ltx_cite ltx_citemacro_citep">(Choi, Jang, and Alemi <a href="#bib.bib6" title="" class="ltx_ref">2018</a>; Ren et al. <a href="#bib.bib30" title="" class="ltx_ref">2019</a>)</cite>, when ID is more complex than OOD.</p>
</div>
<div id="Sx5.SSx3.SSSx1.p2" class="ltx_para">
<p id="Sx5.SSx3.SSSx1.p2.2" class="ltx_p">Our attention-based anomaly detection (MAP), however, shows superior results to MSP regardless of VQA models.
The AUROCs differ according to VQA models, but all results are promising with AUROCs (<math id="Sx5.SSx3.SSSx1.p2.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx5.SSx3.SSSx1.p2.1.m1.1a"><mo id="Sx5.SSx3.SSSx1.p2.1.m1.1.1" xref="Sx5.SSx3.SSSx1.p2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx5.SSx3.SSSx1.p2.1.m1.1b"><gt id="Sx5.SSx3.SSSx1.p2.1.m1.1.1.cmml" xref="Sx5.SSx3.SSSx1.p2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx3.SSSx1.p2.1.m1.1c">&gt;</annotation></semantics></math> 80.0).
The results show that VQA models do not make a strong attention between images and questions, when they are from OOD.
Furthermore, the promising results mean that instead of explicit estimation of the joint density of <math id="Sx5.SSx3.SSSx1.p2.2.m2.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx5.SSx3.SSSx1.p2.2.m2.2a"><mrow id="Sx5.SSx3.SSSx1.p2.2.m2.2.3" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.cmml"><mi id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.2" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.1" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.1.cmml">​</mo><mrow id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.2" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.2.1" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.1.cmml">(</mo><mi id="Sx5.SSx3.SSSx1.p2.2.m2.1.1" xref="Sx5.SSx3.SSSx1.p2.2.m2.1.1.cmml">𝐯</mi><mo id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.2.2" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.1.cmml">,</mo><mi id="Sx5.SSx3.SSSx1.p2.2.m2.2.2" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.2.3" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx3.SSSx1.p2.2.m2.2b"><apply id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3"><times id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.1.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.1"></times><ci id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.2.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.2">𝑝</ci><interval closure="open" id="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.1.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.3.3.2"><ci id="Sx5.SSx3.SSSx1.p2.2.m2.1.1.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.1.1">𝐯</ci><ci id="Sx5.SSx3.SSSx1.p2.2.m2.2.2.cmml" xref="Sx5.SSx3.SSSx1.p2.2.m2.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx3.SSSx1.p2.2.m2.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>, MAP can distinguish OOD samples from normal samples.</p>
</div>
</section>
<section id="Sx5.SSx3.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">The Effect of Regularization of Attention Networks</h4>

<div id="Sx5.SSx3.SSSx2.p1" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p1.1" class="ltx_p">OE-MSP in Table <a href="#Sx5.T3" title="Table 3 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that OE fails to improve OOD detection by MSP, in contrast to the results in unimodal tasks <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>.
After the multimodal feature fusion in VQA models, a source of abnormality in input images or questions vanishes, and the MSP, which exploit the fused features, can neither detect OOD inputs nor be improved by OE.
Only the OE-MSP(T) of MHB+ATT for Task 1 shows promising results, and we infer the reason from that MHB+ATT has five times larger dimensions of visual features than other VQA models and can remain the abnormality source after the feature fusion.</p>
</div>
<div id="Sx5.SSx3.SSSx2.p2" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p2.1" class="ltx_p">On the other hand, our maximum entropy regularization of cross-modal attention networks consistently improves the detection of OOD images and questions by MAP.
The results imply that our regularization can be successfully applied in VQA models, allowing them to avoid generating a strong attention when the input image or question is from OOD.
For example, after our regularization, the AUROCs of RA-MAP (T) for all VQA models increase and reach almost perfect OOD detection (<math id="Sx5.SSx3.SSSx2.p2.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx5.SSx3.SSSx2.p2.1.m1.1a"><mo id="Sx5.SSx3.SSSx2.p2.1.m1.1.1" xref="Sx5.SSx3.SSSx2.p2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx5.SSx3.SSSx2.p2.1.m1.1b"><gt id="Sx5.SSx3.SSSx2.p2.1.m1.1.1.cmml" xref="Sx5.SSx3.SSSx2.p2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx3.SSSx2.p2.1.m1.1c">&gt;</annotation></semantics></math> 90.0).</p>
</div>
<div id="Sx5.SSx3.SSSx2.p3" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p3.1" class="ltx_p">Note that our regularization does not use the OOD datasets, which are used in Table <a href="#Sx5.T3" title="Table 3 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for testing.
The VQA models can detect all OOD image datasets, although attention networks are regularized by the TinyImageNet training dataset only.
Furthermore, we do not use an OOD question in training, but the robustness of the VQA models is significantly improved by regularizing on irrelevant questions.
We emphasize that OOD datasets of task 1 and 2 are far from VQA tasks.
Nevertheless, MSP and OE fail to detect such easy anomalies, while our attention-based anomaly detection methods can easily detect them.</p>
</div>
<div id="Sx5.SSx3.SSSx2.p4" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p4.1" class="ltx_p">The results of Task 3 (both OOD image and question) are consistent with Table <a href="#Sx5.T3" title="Table 3 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We conclude that MSP and OE, which are the most common methods in unimodal tasks, cannot detect OOD images or questions in VQA, but the cross-modal attention with our regularization is the most appropriate to detect unseen OOD samples and improve the capability of the OOD robustness in VQA models.</p>
</div>
</section>
</section>
<section id="Sx5.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Irrelevant Question Detection (Task 4)</h3>

<figure id="Sx5.T4" class="ltx_table">
<table id="Sx5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx5.T4.1.1.1" class="ltx_tr">
<th id="Sx5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Accuracy (%)</th>
<th id="Sx5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">VNQ</th>
<th id="Sx5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">QRPE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx5.T4.1.2.1" class="ltx_tr">
<th id="Sx5.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Q-Q’ SIM <cite class="ltx_cite ltx_citemacro_citep">(Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>
</th>
<td id="Sx5.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">92.3</td>
<td id="Sx5.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">—</td>
</tr>
<tr id="Sx5.T4.1.3.2" class="ltx_tr">
<th id="Sx5.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">QPC-Sim <cite class="ltx_cite ltx_citemacro_citep">(Mahendru et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>
</th>
<td id="Sx5.T4.1.3.2.2" class="ltx_td ltx_align_center">—</td>
<td id="Sx5.T4.1.3.2.3" class="ltx_td ltx_align_center">76.7</td>
</tr>
<tr id="Sx5.T4.1.4.3" class="ltx_tr">
<th id="Sx5.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">RA-MAP (BUTD)</th>
<td id="Sx5.T4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx5.T4.1.4.3.2.1" class="ltx_text ltx_font_bold">93.8</span></td>
<td id="Sx5.T4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx5.T4.1.4.3.3.1" class="ltx_text ltx_font_bold">78.0</span></td>
</tr>
<tr id="Sx5.T4.1.5.4" class="ltx_tr">
<th id="Sx5.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">RA-MAP (MHB+ATT)</th>
<td id="Sx5.T4.1.5.4.2" class="ltx_td ltx_align_center"><span id="Sx5.T4.1.5.4.2.1" class="ltx_text ltx_font_bold">96.4</span></td>
<td id="Sx5.T4.1.5.4.3" class="ltx_td ltx_align_center"><span id="Sx5.T4.1.5.4.3.1" class="ltx_text ltx_font_bold">89.1</span></td>
</tr>
<tr id="Sx5.T4.1.6.5" class="ltx_tr">
<th id="Sx5.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">RA-MAP (BAN)</th>
<td id="Sx5.T4.1.6.5.2" class="ltx_td ltx_align_center">82.0</td>
<td id="Sx5.T4.1.6.5.3" class="ltx_td ltx_align_center">59.7</td>
</tr>
<tr id="Sx5.T4.1.7.6" class="ltx_tr">
<th id="Sx5.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">RA-MAP (MCAN)</th>
<td id="Sx5.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_b">72.1</td>
<td id="Sx5.T4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_b">56.6</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of irrelevant question detection models</figcaption>
</figure>
<div id="Sx5.SSx4.p1" class="ltx_para">
<p id="Sx5.SSx4.p1.1" class="ltx_p">In Table <a href="#Sx5.T4" title="Table 4 ‣ Irrelevant Question Detection (Task 4) ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the attention-based anomaly detection outperforms the previous methods with extra models for irrelevant question detection.
Q-Q’ SIM <cite class="ltx_cite ltx_citemacro_citep">(Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite> and QPC-Sim <cite class="ltx_cite ltx_citemacro_citep">(Mahendru et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> are the tailored methods, which build extra models, using captioning models <cite class="ltx_cite ltx_citemacro_citep">(Karpathy and Fei-Fei <a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite> to generate a question relevant to the image and compares it with the input question.
Even though our attention-based anomaly detector does not use additional models to detect irrelevant questions, RA-MAPs (T) of BUTD and MHB+ATT outperform the previous tailored methods.
Moreover, our method can also be applied to detect other types of anomalies, including irrelevant questions.</p>
</div>
<div id="Sx5.SSx4.p2" class="ltx_para">
<p id="Sx5.SSx4.p2.1" class="ltx_p">Compared to BUTD and MHB+ATT, BAN and MCAN have a room for improvement of irrelevant question detection.
BAN and MCAN use the pairwise relationship between all question tokens and visual objects in their cross-modal attention networks, along with multiple heads of attention.
Thus, one of the attention heads might pay strong attention to interrogatives in irrelevant questions.
In this study, we focus on the importance of cross-modal attention for anomaly detection in VQA.</p>
</div>
<figure id="Sx5.T5" class="ltx_table">
<table id="Sx5.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx5.T5.1.1.1" class="ltx_tr">
<th id="Sx5.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">MSP/MAP</th>
<td id="Sx5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">BUTD</td>
<td id="Sx5.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">MHB+ATT</td>
<td id="Sx5.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">BAN</td>
<td id="Sx5.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">MCAN</td>
</tr>
<tr id="Sx5.T5.1.2.2" class="ltx_tr">
<th id="Sx5.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">AUROC</th>
<td id="Sx5.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">87.2/51.5</td>
<td id="Sx5.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">90.7/51.3</td>
<td id="Sx5.T5.1.2.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">85.3/55.5</td>
<td id="Sx5.T5.1.2.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">81.3/71.5</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Undefined answers detection results</figcaption>
</figure>
</section>
<section id="Sx5.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Undefined Answer Detection (Task 5)</h3>

<div id="Sx5.SSx5.p1" class="ltx_para">
<p id="Sx5.SSx5.p1.2" class="ltx_p">Although MSP cannot detect OOD images and questions, and irrelevant questions, Table <a href="#Sx5.T5" title="Table 5 ‣ Irrelevant Question Detection (Task 4) ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that for detecting samples with undefined answers, MSP achieves higher accuracy than MAP.
MSP directly estimates <math id="Sx5.SSx5.p1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{in}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx5.SSx5.p1.1.m1.1a"><mrow id="Sx5.SSx5.p1.1.m1.1.1" xref="Sx5.SSx5.p1.1.m1.1.1.cmml"><mi id="Sx5.SSx5.p1.1.m1.1.1.3" xref="Sx5.SSx5.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx5.p1.1.m1.1.1.2" xref="Sx5.SSx5.p1.1.m1.1.1.2.cmml">​</mo><mrow id="Sx5.SSx5.p1.1.m1.1.1.1.1" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx5.SSx5.p1.1.m1.1.1.1.1.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx5.SSx5.p1.1.m1.1.1.1.1.1" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.cmml"><msub id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.cmml"><mi id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3a.cmml">in</mtext></msub><mo fence="false" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.3.cmml"><msub id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx5.SSx5.p1.1.m1.1.1.1.1.3" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx5.p1.1.m1.1b"><apply id="Sx5.SSx5.p1.1.m1.1.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1"><times id="Sx5.SSx5.p1.1.m1.1.1.2.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.2"></times><ci id="Sx5.SSx5.p1.1.m1.1.1.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.3">conditional</csymbol><apply id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.2.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3a.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.4.3">in</mtext></ci></apply><list id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2"><apply id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx5.SSx5.p1.1.m1.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx5.p1.1.m1.1c">p(\mathbf{a}_{\text{in}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math> and has low value on a sample with undefined answers from <math id="Sx5.SSx5.p1.2.m2.1" class="ltx_Math" alttext="p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})" display="inline"><semantics id="Sx5.SSx5.p1.2.m2.1a"><mrow id="Sx5.SSx5.p1.2.m2.1.1" xref="Sx5.SSx5.p1.2.m2.1.1.cmml"><mi id="Sx5.SSx5.p1.2.m2.1.1.3" xref="Sx5.SSx5.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx5.p1.2.m2.1.1.2" xref="Sx5.SSx5.p1.2.m2.1.1.2.cmml">​</mo><mrow id="Sx5.SSx5.p1.2.m2.1.1.1.1" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx5.SSx5.p1.2.m2.1.1.1.1.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Sx5.SSx5.p1.2.m2.1.1.1.1.1" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.cmml"><msub id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.cmml"><mi id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.2.cmml">𝐚</mi><mtext id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3a.cmml">out</mtext></msub><mo fence="false" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.3.cmml"><msub id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mtext id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.2" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml">𝐪</mi><mtext id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3a.cmml">in</mtext></msub></mrow></mrow><mo stretchy="false" id="Sx5.SSx5.p1.2.m2.1.1.1.1.3" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx5.p1.2.m2.1b"><apply id="Sx5.SSx5.p1.2.m2.1.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1"><times id="Sx5.SSx5.p1.2.m2.1.1.2.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.2"></times><ci id="Sx5.SSx5.p1.2.m2.1.1.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.3">𝑝</ci><apply id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.3">conditional</csymbol><apply id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4">subscript</csymbol><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.2.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.2">𝐚</ci><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3a.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.4.3">out</mtext></ci></apply><list id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2"><apply id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><apply id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.2">𝐪</ci><ci id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3a.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3"><mtext mathsize="70%" id="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="Sx5.SSx5.p1.2.m2.1.1.1.1.1.2.2.2.3">in</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx5.p1.2.m2.1c">p(\mathbf{a}_{\text{out}}|\mathbf{v}_{\text{in}},\mathbf{q}_{\text{in}})</annotation></semantics></math>.
Thus, MSP can successfully detect samples with undefined answers, but is limited to detect them.</p>
</div>
<div id="Sx5.SSx5.p2" class="ltx_para">
<p id="Sx5.SSx5.p2.1" class="ltx_p">MAP cannot detect samples with undefined answers, because the images and questions are not from abnormal <math id="Sx5.SSx5.p2.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx5.SSx5.p2.1.m1.2a"><mrow id="Sx5.SSx5.p2.1.m1.2.3" xref="Sx5.SSx5.p2.1.m1.2.3.cmml"><mi id="Sx5.SSx5.p2.1.m1.2.3.2" xref="Sx5.SSx5.p2.1.m1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx5.SSx5.p2.1.m1.2.3.1" xref="Sx5.SSx5.p2.1.m1.2.3.1.cmml">​</mo><mrow id="Sx5.SSx5.p2.1.m1.2.3.3.2" xref="Sx5.SSx5.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx5.SSx5.p2.1.m1.2.3.3.2.1" xref="Sx5.SSx5.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="Sx5.SSx5.p2.1.m1.1.1" xref="Sx5.SSx5.p2.1.m1.1.1.cmml">𝐯</mi><mo id="Sx5.SSx5.p2.1.m1.2.3.3.2.2" xref="Sx5.SSx5.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="Sx5.SSx5.p2.1.m1.2.2" xref="Sx5.SSx5.p2.1.m1.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx5.SSx5.p2.1.m1.2.3.3.2.3" xref="Sx5.SSx5.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx5.p2.1.m1.2b"><apply id="Sx5.SSx5.p2.1.m1.2.3.cmml" xref="Sx5.SSx5.p2.1.m1.2.3"><times id="Sx5.SSx5.p2.1.m1.2.3.1.cmml" xref="Sx5.SSx5.p2.1.m1.2.3.1"></times><ci id="Sx5.SSx5.p2.1.m1.2.3.2.cmml" xref="Sx5.SSx5.p2.1.m1.2.3.2">𝑝</ci><interval closure="open" id="Sx5.SSx5.p2.1.m1.2.3.3.1.cmml" xref="Sx5.SSx5.p2.1.m1.2.3.3.2"><ci id="Sx5.SSx5.p2.1.m1.1.1.cmml" xref="Sx5.SSx5.p2.1.m1.1.1">𝐯</ci><ci id="Sx5.SSx5.p2.1.m1.2.2.cmml" xref="Sx5.SSx5.p2.1.m1.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx5.p2.1.m1.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math>.
Although the correct answer is undefined among the answer candidates, there exists the correct answer between the input image and question.
Then, as in the case of normal samples, VQA models can generate proper attention between the correlated visual object and the word token as a confident reasoning of the answer.</p>
</div>
<figure id="Sx5.T6" class="ltx_table">
<table id="Sx5.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx5.T6.1.1.1" class="ltx_tr">
<th id="Sx5.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">AUROC</th>
<th id="Sx5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">CIFAR10</th>
<th id="Sx5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Reuters52</th>
<th id="Sx5.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">QRPE (test)</th>
</tr>
<tr id="Sx5.T6.1.2.2" class="ltx_tr">
<th id="Sx5.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">BUTD (MAP)</th>
<th id="Sx5.T6.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">90.5</th>
<th id="Sx5.T6.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">76.4</th>
<th id="Sx5.T6.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">49.6</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx5.T6.1.3.1" class="ltx_tr">
<th id="Sx5.T6.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">+Tiny</th>
<td id="Sx5.T6.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">99.9</td>
<td id="Sx5.T6.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">79.0</td>
<td id="Sx5.T6.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">47.1</td>
</tr>
<tr id="Sx5.T6.1.4.2" class="ltx_tr">
<th id="Sx5.T6.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">+IMDB</th>
<td id="Sx5.T6.1.4.2.2" class="ltx_td ltx_align_center">57.6</td>
<td id="Sx5.T6.1.4.2.3" class="ltx_td ltx_align_center">99.8</td>
<td id="Sx5.T6.1.4.2.4" class="ltx_td ltx_align_center">46.9</td>
</tr>
<tr id="Sx5.T6.1.5.3" class="ltx_tr">
<th id="Sx5.T6.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">+Tiny, IMDB</th>
<td id="Sx5.T6.1.5.3.2" class="ltx_td ltx_align_center">99.8</td>
<td id="Sx5.T6.1.5.3.3" class="ltx_td ltx_align_center">99.9</td>
<td id="Sx5.T6.1.5.3.4" class="ltx_td ltx_align_center">44.3</td>
</tr>
<tr id="Sx5.T6.1.6.4" class="ltx_tr">
<th id="Sx5.T6.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">+Tiny, QRPE</th>
<td id="Sx5.T6.1.6.4.2" class="ltx_td ltx_align_center">97.8</td>
<td id="Sx5.T6.1.6.4.3" class="ltx_td ltx_align_center">87.8</td>
<td id="Sx5.T6.1.6.4.4" class="ltx_td ltx_align_center">89.3</td>
</tr>
<tr id="Sx5.T6.1.7.5" class="ltx_tr">
<th id="Sx5.T6.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">+Tiny, VNQ, QRPE</th>
<td id="Sx5.T6.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b">98.0</td>
<td id="Sx5.T6.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b">97.0</td>
<td id="Sx5.T6.1.7.5.4" class="ltx_td ltx_align_center ltx_border_b">84.8</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>AUROCs of BUTD for detecting CIFAR10, Reuters52, and QRPE datasets. TinyImageNet, IMDB, VNQ, and QRPE datasets are used for our regularization</figcaption>
</figure>
</section>
<section id="Sx5.SSx6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Ablation Study</h3>

<section id="Sx5.SSx6.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Selection of Anomaly Datasets for Regularization</h4>

<div id="Sx5.SSx6.SSSx1.p1" class="ltx_para">
<p id="Sx5.SSx6.SSSx1.p1.2" class="ltx_p">The selection of abnormal datasets for the post-training, <math id="Sx5.SSx6.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="P_{\text{anomaly}}" display="inline"><semantics id="Sx5.SSx6.SSSx1.p1.1.m1.1a"><msub id="Sx5.SSx6.SSSx1.p1.1.m1.1.1" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.cmml"><mi id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.2" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.2.cmml">P</mi><mtext id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3a.cmml">anomaly</mtext></msub><annotation-xml encoding="MathML-Content" id="Sx5.SSx6.SSSx1.p1.1.m1.1b"><apply id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.cmml" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.1.cmml" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1">subscript</csymbol><ci id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.2">𝑃</ci><ci id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3a.cmml" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3.cmml" xref="Sx5.SSx6.SSSx1.p1.1.m1.1.1.3">anomaly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx6.SSSx1.p1.1.m1.1c">P_{\text{anomaly}}</annotation></semantics></math> in Eq (<a href="#Sx4.E5" title="In Regularization of Attention Networks for Anomaly Detection ‣ Anomaly Detection in VQA ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), is important because considering all possible anomalies at training time is impossible.
Thus, we compare the performance at detecting OOD images (CIFAR10), questions (Reuters52), and irrelevant questions (QRPE) ,according to the change of selection of <math id="Sx5.SSx6.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="P_{\text{anomaly}}" display="inline"><semantics id="Sx5.SSx6.SSSx1.p1.2.m2.1a"><msub id="Sx5.SSx6.SSSx1.p1.2.m2.1.1" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.cmml"><mi id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.2" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.2.cmml">P</mi><mtext id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3a.cmml">anomaly</mtext></msub><annotation-xml encoding="MathML-Content" id="Sx5.SSx6.SSSx1.p1.2.m2.1b"><apply id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.cmml" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.1.cmml" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1">subscript</csymbol><ci id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.2.cmml" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.2">𝑃</ci><ci id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3a.cmml" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3"><mtext mathsize="70%" id="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3.cmml" xref="Sx5.SSx6.SSSx1.p1.2.m2.1.1.3">anomaly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx6.SSSx1.p1.2.m2.1c">P_{\text{anomaly}}</annotation></semantics></math> (Table <a href="#Sx5.T6" title="Table 6 ‣ Undefined Answer Detection (Task 5) ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).</p>
</div>
<div id="Sx5.SSx6.SSSx1.p2" class="ltx_para">
<p id="Sx5.SSx6.SSSx1.p2.1" class="ltx_p">Using anomalies of only a certain modality for the regularization of VQA models does not improve detection of anomalies in the other modality.
Anomalies in one modality do not affect the encoder of another modality at the post-training.
For example, when we use only OOD images (Tiny) or questions (IMDB) for the regularization, unseen OOD images (CIFAR10) or questions (Reuters52) are well detected respectively.
However, the detection of abnormal inputs in the other modality is not improved.
Thus, regularizing both modalities is necessary for the robustness of VQA models to anomalies from both modalities.</p>
</div>
<div id="Sx5.SSx6.SSSx1.p3" class="ltx_para">
<p id="Sx5.SSx6.SSSx1.p3.1" class="ltx_p">For selecting abnormal questions, irrelevant questions allow VQA models to detect both OOD and irrelevant questions.
When IMDB sentences are selected instead of irrelevant questions, the regularization cannot remove the unconditional bias of attention networks on interrogatives regardless of the relevance of an input question and an image.
However, after regularizing with irrelevant questions (VNQ, QRPE), the model also detects OOD questions (Reuters52) because OOD questions are much easier to detect than irrelevant questions.
Note that OOD questions contain no interrogatives and are also irrelevant to the input images.</p>
</div>
</section>
<section id="Sx5.SSx6.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Scope of Post-Training for Outlier Exposure</h4>

<div id="Sx5.SSx6.SSSx2.p1" class="ltx_para">
<p id="Sx5.SSx6.SSSx2.p1.2" class="ltx_p">OE has shown severe degradation of VQA accuracy, and the scope of trainable parameters in post-training is related to unstable performance.
In post-training, OE updates all trainable parameters of VQA models to predict uniform scores over answer candidates.
Thus, OE can make attention modules unable to associate a question with visual objects and severely degrade the VQA accuracy (Table <a href="#Sx5.T2" title="Table 2 ‣ Compared Methods for Anomaly Detection ‣ Experimental Setup ‣ Experiments ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
For example, when OE updates parameters only after the feature fusion, the accuracy drop of BUTD has halved from <math id="Sx5.SSx6.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="-7.7" display="inline"><semantics id="Sx5.SSx6.SSSx2.p1.1.m1.1a"><mrow id="Sx5.SSx6.SSSx2.p1.1.m1.1.1" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1.cmml"><mo id="Sx5.SSx6.SSSx2.p1.1.m1.1.1a" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1.cmml">−</mo><mn id="Sx5.SSx6.SSSx2.p1.1.m1.1.1.2" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1.2.cmml">7.7</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx6.SSSx2.p1.1.m1.1b"><apply id="Sx5.SSx6.SSSx2.p1.1.m1.1.1.cmml" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1"><minus id="Sx5.SSx6.SSSx2.p1.1.m1.1.1.1.cmml" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1"></minus><cn type="float" id="Sx5.SSx6.SSSx2.p1.1.m1.1.1.2.cmml" xref="Sx5.SSx6.SSSx2.p1.1.m1.1.1.2">7.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx6.SSSx2.p1.1.m1.1c">-7.7</annotation></semantics></math> % to <math id="Sx5.SSx6.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="-3.7" display="inline"><semantics id="Sx5.SSx6.SSSx2.p1.2.m2.1a"><mrow id="Sx5.SSx6.SSSx2.p1.2.m2.1.1" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1.cmml"><mo id="Sx5.SSx6.SSSx2.p1.2.m2.1.1a" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1.cmml">−</mo><mn id="Sx5.SSx6.SSSx2.p1.2.m2.1.1.2" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1.2.cmml">3.7</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx5.SSx6.SSSx2.p1.2.m2.1b"><apply id="Sx5.SSx6.SSSx2.p1.2.m2.1.1.cmml" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1"><minus id="Sx5.SSx6.SSSx2.p1.2.m2.1.1.1.cmml" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1"></minus><cn type="float" id="Sx5.SSx6.SSSx2.p1.2.m2.1.1.2.cmml" xref="Sx5.SSx6.SSSx2.p1.2.m2.1.1.2">3.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx6.SSSx2.p1.2.m2.1c">-3.7</annotation></semantics></math> %, and the anomaly detection performance remains the same as in the paper.</p>
</div>
</section>
</section>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">MSP-based OOD detection has mainly been studied, and it shows promising results for unimodal tasks.
The MSP is a simple yet powerful method for OOD detection, when temperature scaling or input preprocessing is combined <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Liang, Li, and Srikant <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite>.
Moreover, <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Hein, Andriushchenko, and Bitterwolf <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> use the post-training of DNNS to predict uniform distribution on abnormal samples and enhance MSP to detect unseen OOD samples almost perfectly.
Meanwhile, <cite class="ltx_cite ltx_citemacro_citep">(Meinke and Hein <a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> show that MSP may not be a metric enough to detect OOD inputs.
Our study is the first on OOD detection in multimodal tasks such as VQA, and shows that MSP cannot detect OOD images and questions, or irrelevant questions.</p>
</div>
<div id="Sx6.p2" class="ltx_para">
<p id="Sx6.p2.1" class="ltx_p">Few studies consider abnormal situations in VQA, but are confined to limited tasks.
<cite class="ltx_cite ltx_citemacro_citep">(Bhattacharya, Li, and Gurari <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite> investigate why annotators provide different answers to the same visual question.
<cite class="ltx_cite ltx_citemacro_citep">(Mahendru et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Ray et al. <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite> mainly cover detection of irrelevant questions, but to quantify question relevance, they build an extra tailored model to generate a question relevant to the image and compare the input question with the generated questions.
We define anomaly detection in VQA more generally and show how VQA models can detect irrelevant questions by attention networks without any extra or tailored model.</p>
</div>
<div id="Sx6.p3" class="ltx_para">
<p id="Sx6.p3.1" class="ltx_p">Some studies regularize attention weight distribution for various purposes.
In machine translation, abstractive summarization, and query-driven multi-instance learning, the attention distribution is regularized to be sharp or uniform to increase their performance <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib38" title="" class="ltx_ref">2018</a>; Hsu et al. <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>.
In this study, we regularize attention networks to improve the robustness of VQA models to various anomalies.</p>
</div>
</section>
<section id="Sx7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusions</h2>

<div id="Sx7.p1" class="ltx_para">
<p id="Sx7.p1.1" class="ltx_p">For a VQA system to be safe in the real-world, the models have to be generalized on unseen abnormal samples, having low predictive confidence.
We have defined the five anomaly types in VQA according to out-of-distribution and answerability, and have evaluated the robustness of four VQA models to defined anomalies.
In contrast to the major results in unimodal classification, we find that MSP and OE are limited to detecting various anomalies from <math id="Sx7.p1.1.m1.2" class="ltx_Math" alttext="p(\mathbf{v},\mathbf{q})" display="inline"><semantics id="Sx7.p1.1.m1.2a"><mrow id="Sx7.p1.1.m1.2.3" xref="Sx7.p1.1.m1.2.3.cmml"><mi id="Sx7.p1.1.m1.2.3.2" xref="Sx7.p1.1.m1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx7.p1.1.m1.2.3.1" xref="Sx7.p1.1.m1.2.3.1.cmml">​</mo><mrow id="Sx7.p1.1.m1.2.3.3.2" xref="Sx7.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx7.p1.1.m1.2.3.3.2.1" xref="Sx7.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="Sx7.p1.1.m1.1.1" xref="Sx7.p1.1.m1.1.1.cmml">𝐯</mi><mo id="Sx7.p1.1.m1.2.3.3.2.2" xref="Sx7.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="Sx7.p1.1.m1.2.2" xref="Sx7.p1.1.m1.2.2.cmml">𝐪</mi><mo stretchy="false" id="Sx7.p1.1.m1.2.3.3.2.3" xref="Sx7.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx7.p1.1.m1.2b"><apply id="Sx7.p1.1.m1.2.3.cmml" xref="Sx7.p1.1.m1.2.3"><times id="Sx7.p1.1.m1.2.3.1.cmml" xref="Sx7.p1.1.m1.2.3.1"></times><ci id="Sx7.p1.1.m1.2.3.2.cmml" xref="Sx7.p1.1.m1.2.3.2">𝑝</ci><interval closure="open" id="Sx7.p1.1.m1.2.3.3.1.cmml" xref="Sx7.p1.1.m1.2.3.3.2"><ci id="Sx7.p1.1.m1.1.1.cmml" xref="Sx7.p1.1.m1.1.1">𝐯</ci><ci id="Sx7.p1.1.m1.2.2.cmml" xref="Sx7.p1.1.m1.2.2">𝐪</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx7.p1.1.m1.2c">p(\mathbf{v},\mathbf{q})</annotation></semantics></math></p>
</div>
<div id="Sx7.p2" class="ltx_para">
<p id="Sx7.p2.1" class="ltx_p">In this study, we propose the attention-based method and regularization of attention networks to significantly improve anomaly detection of VQA models.
Cross-modal reasoning (i.e., attention) improves not only VQA accuracy, but also the robustness to various abnormal situations in VQA.
Our method also conserves the VQA accuracy; detects OOD images and questions almost perfectly; and achieves a new state-of-the-art detection for irrelevant questions.</p>
</div>
<div id="Sx7.p3" class="ltx_para">
<p id="Sx7.p3.1" class="ltx_p">In future work, we believe that further classification of anomalies will offer promise for distinguishing various anomalies.
Furthermore, an analysis of anomaly detection on a range of distributional shifts would be an interesting future work.
Meanwhile, elaborating attention-based anomaly detection for pairwise and multiple heads attentions is worth exploration to improve irrelevant question detection.
We have observed that VQA accuracy is easily degraded in post-training when the VQA model contains many attention heads. Thus, finding an optimal architecture with multi-head attention for accurate and robust VQA models would be an interesting future work.
Moreover, user studies of anomaly detection in VQA for real-life scenarios would also be an interesting future work.</p>
</div>
</section>
<section id="Sx8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx8.p1" class="ltx_para">
<p id="Sx8.p1.1" class="ltx_p">The authors are grateful to Minsu Cho at POSTECH and the reviewers for their feedback and insightful discussions.
This work was supported by Institute of Information communications Technology Planning Evaluation(IITP) grant funded by the Korea government(MSIT) (No. 2018-0-01398, Development of a Conversational, Self-tuning DBMS).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2018)</span>
<span class="ltx_bibblock">
Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and
Zhang, L. 2018.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 6077–6086.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol et al. (2015)</span>
<span class="ltx_bibblock">
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Lawrence Zitnick, C.;
and Parikh, D. 2015.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, 2425–2433.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2018)</span>
<span class="ltx_bibblock">
Bai, Y.; Fu, J.; Zhao, T.; and Mei, T. 2018.

</span>
<span class="ltx_bibblock">Deep attention neural tensor network for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</em>, 20–35.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">BeSpecular (2020)</span>
<span class="ltx_bibblock">
BeSpecular. 2020.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_ref_self">https://www.bespecular.com</span>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhattacharya, Li, and Gurari (2019)</span>
<span class="ltx_bibblock">
Bhattacharya, N.; Li, Q.; and Gurari, D. 2019.

</span>
<span class="ltx_bibblock">Why Does a Visual Question Have Different Answers?

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</em>, 4271–4280.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi, Jang, and Alemi (2018)</span>
<span class="ltx_bibblock">
Choi, H.; Jang, E.; and Alemi, A. A. 2018.

</span>
<span class="ltx_bibblock">Waic, but why? generative ensembles for robust anomaly detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.01392</em> .

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fukui et al. (2016)</span>
<span class="ltx_bibblock">
Fukui, A.; Park, D. H.; Yang, D.; Rohrbach, A.; Darrell, T.; and Rohrbach, M.
2016.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.01847</em> .

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow, Shlens, and Szegedy (2014)</span>
<span class="ltx_bibblock">
Goodfellow, I. J.; Shlens, J.; and Szegedy, C. 2014.

</span>
<span class="ltx_bibblock">Explaining and harnessing adversarial examples.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6572</em> .

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Goyal, Y.; Khot, T.; Summers-Stay, D.; Batra, D.; and Parikh, D. 2017.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image understanding
in Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 6904–6913.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2017)</span>
<span class="ltx_bibblock">
Guo, C.; Pleiss, G.; Sun, Y.; and Weinberger, K. Q. 2017.

</span>
<span class="ltx_bibblock">On calibration of modern neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International Conference on Machine
Learning-Volume 70</em>, 1321–1330. JMLR. org.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gurari et al. (2018)</span>
<span class="ltx_bibblock">
Gurari, D.; Li, Q.; Stangl, A. J.; Guo, A.; Lin, C.; Grauman, K.; Luo, J.; and
Bigham, J. P. 2018.

</span>
<span class="ltx_bibblock">Vizwiz grand challenge: Answering visual questions from blind people.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 3608–3617.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 770–778.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hein, Andriushchenko, and Bitterwolf (2019)</span>
<span class="ltx_bibblock">
Hein, M.; Andriushchenko, M.; and Bitterwolf, J. 2019.

</span>
<span class="ltx_bibblock">Why ReLU networks yield high-confidence predictions far away from the
training data and how to mitigate the problem.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 41–50.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Gimpel (2017)</span>
<span class="ltx_bibblock">
Hendrycks, D.; and Gimpel, K. 2017.

</span>
<span class="ltx_bibblock">A Baseline for Detecting Misclassified and Out-of-Distribution
Examples in Neural Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks, Mazeika, and Dietterich (2019)</span>
<span class="ltx_bibblock">
Hendrycks, D.; Mazeika, M.; and Dietterich, T. 2019.

</span>
<span class="ltx_bibblock">Deep Anomaly Detection with Outlier Exposure.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2020)</span>
<span class="ltx_bibblock">
Hsu, Y.-C.; Hong, C.-Y.; Lee, M.-S.; and Liu, T.-L. 2020.

</span>
<span class="ltx_bibblock">Query-Driven Multi-Instance Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 34.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kamath, Jia, and Liang (2020)</span>
<span class="ltx_bibblock">
Kamath, A.; Jia, R.; and Liang, P. 2020.

</span>
<span class="ltx_bibblock">Selective question answering under domain shift.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.09462</em> .

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpathy and Fei-Fei (2015)</span>
<span class="ltx_bibblock">
Karpathy, A.; and Fei-Fei, L. 2015.

</span>
<span class="ltx_bibblock">Deep visual-semantic alignments for generating image descriptions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 3128–3137.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim, Jun, and Zhang (2018)</span>
<span class="ltx_bibblock">
Kim, J.-H.; Jun, J.; and Zhang, B.-T. 2018.

</span>
<span class="ltx_bibblock">Bilinear Attention Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 31</em>,
1571–1581.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Dhariwal (2018)</span>
<span class="ltx_bibblock">
Kingma, D. P.; and Dhariwal, P. 2018.

</span>
<span class="ltx_bibblock">Glow: Generative flow with invertible 1x1 convolutions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
10215–10224.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2018)</span>
<span class="ltx_bibblock">
Lee, K.; Lee, K.; Lee, H.; and Shin, J. 2018.

</span>
<span class="ltx_bibblock">A simple unified framework for detecting out-of-distribution samples
and adversarial attacks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
7167–7177.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang, Li, and Srikant (2018)</span>
<span class="ltx_bibblock">
Liang, S.; Li, Y.; and Srikant, R. 2018.

</span>
<span class="ltx_bibblock">Enhancing The Reliability of Out-of-distribution Image Detection in
Neural Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Lin, T.-Y.; Maire, M.; Belongie, S.; Hays, J.; Perona, P.; Ramanan, D.;
Dollár, P.; and Zitnick, C. L. 2014.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 740–755. Springer.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maaten and Hinton (2008)</span>
<span class="ltx_bibblock">
Maaten, L. v. d.; and Hinton, G. 2008.

</span>
<span class="ltx_bibblock">Visualizing data using t-SNE.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Journal of machine learning research</em> 9(Nov): 2579–2605.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahendru et al. (2017)</span>
<span class="ltx_bibblock">
Mahendru, A.; Prabhu, V.; Mohapatra, A.; Batra, D.; and Lee, S. 2017.

</span>
<span class="ltx_bibblock">The Promise of Premise: Harnessing Question Premises in Visual
Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 Conference on Empirical Methods in
Natural Language Processing</em>, 926–935.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meinke and Hein (2019)</span>
<span class="ltx_bibblock">
Meinke, A.; and Hein, M. 2019.

</span>
<span class="ltx_bibblock">Towards neural networks that provably know when they don’t know.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen, Yosinski, and Clune (2015)</span>
<span class="ltx_bibblock">
Nguyen, A.; Yosinski, J.; and Clune, J. 2015.

</span>
<span class="ltx_bibblock">Deep neural networks are easily fooled: High confidence predictions
for unrecognizable images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 427–436.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington, Socher, and Manning (2014)</span>
<span class="ltx_bibblock">
Pennington, J.; Socher, R.; and Manning, C. 2014.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2014 conference on empirical methods in
natural language processing (EMNLP)</em>, 1532–1543.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ray et al. (2016)</span>
<span class="ltx_bibblock">
Ray, A.; Christie, G.; Bansal, M.; Batra, D.; and Parikh, D. 2016.

</span>
<span class="ltx_bibblock">Question Relevance in VQA: Identifying Non-Visual And False-Premise
Questions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 Conference on Empirical Methods in
Natural Language Processing</em>, 919–924.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2019)</span>
<span class="ltx_bibblock">
Ren, J.; Liu, P. J.; Fertig, E.; Snoek, J.; Poplin, R.; Depristo, M.; Dillon,
J.; and Lakshminarayanan, B. 2019.

</span>
<span class="ltx_bibblock">Likelihood ratios for out-of-distribution detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
14680–14691.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2015)</span>
<span class="ltx_bibblock">
Ren, S.; He, K.; Girshick, R.; and Sun, J. 2015.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection with region proposal
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 91–99.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salimans et al. (2017)</span>
<span class="ltx_bibblock">
Salimans, T.; Karpathy, A.; Chen, X.; and Kingma, D. P. 2017.

</span>
<span class="ltx_bibblock">PixelCNN++: A PixelCNN Implementation with Discretized Logistic
Mixture Likelihood and Other Modifications.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Settles (2009)</span>
<span class="ltx_bibblock">
Settles, B. 2009.

</span>
<span class="ltx_bibblock">Active learning literature survey.

</span>
<span class="ltx_bibblock">Technical report, University of Wisconsin-Madison Department of
Computer Sciences.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al. (2019)</span>
<span class="ltx_bibblock">
Singh, A.; Natarjan, V.; Shah, M.; Jiang, Y.; Chen, X.; Parikh, D.; and
Rohrbach, M. 2019.

</span>
<span class="ltx_bibblock">Towards VQA Models That Can Read.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 8317–8326.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Cui, Y.; Tao, D.; and Tian, Q. 2019.

</span>
<span class="ltx_bibblock">Deep modular co-attention networks for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 6281–6290.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2017)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Fan, J.; and Tao, D. 2017.

</span>
<span class="ltx_bibblock">Multi-modal factorized bilinear pooling with co-attention learning
for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, 1821–1830.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2018)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Xiang, C.; Fan, J.; and Tao, D. 2018.

</span>
<span class="ltx_bibblock">Beyond bilinear: Generalized multimodal factorized high-order pooling
for visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>
29(12): 5947–5959.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, J.; Zhao, Y.; Li, H.; and Zong, C. 2018.

</span>
<span class="ltx_bibblock">Attention with sparsity regularization for neural machine translation
and summarization.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM Transactions on Audio, Speech, and Language
Processing</em> 27(3): 507–518.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>A.Visualization of Joint Feature Vectors</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">VQA models are known to have a bias on the questions than the images <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al. <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>.
In this study, we argue that if a VQA model has more bias on one modality, it is hard to detect anomalies of the other modality because the abnormal source vanishes after multimodal feature fusion.
When the joint features of anomalies cannot be distinguished from normal samples, the confidence of the answer is not the best way to detect various anomalies in VQA.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.1" class="ltx_p">We visualize the joint features of normal and abnormal samples by T-SNE <cite class="ltx_cite ltx_citemacro_citep">(Maaten and Hinton <a href="#bib.bib24" title="" class="ltx_ref">2008</a>)</cite> (Fig. <a href="#A1.F4" title="Figure 4 ‣ Appendix A A.Visualization of Joint Feature Vectors ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
We use the BUTD model and extract the joint features that integrate image and question features by element-wise multiplication <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>.
If a sample has an out-of-distribution question (red and yellow), the vectors of joint features are distinguishable from normal samples (green).
However, we cannot distinguish the joint features of abnormal samples, when the samples have an out-of-distribution image and in-distribution question (blue).
The results imply that the abnormality in input images can vanish after multimodal feature fusion because of the bias on the question input.</p>
</div>
<figure id="A1.F4" class="ltx_figure"><img src="/html/2009.10054/assets/x4.png" id="A1.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>T-SNE visualization of joint features: normal samples (green) and samples with out-of-distribution image (TinyImageNet, blue), question (IMDB, red), and both image and question (TinyImageNet and IMDB, yellow)</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>B. Optimality for Regularization of Attention Networks</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">In this section, we show that the optimal solution of our regularizing attention networks is uniform distribution.
Without loss of generality, we prove theorem 1.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.8" class="ltx_p"><span id="A2.p2.8.1" class="ltx_text ltx_font_bold">Theorem 1</span> Suppose <math id="A2.p2.1.m1.3" class="ltx_Math" alttext="\mathbf{x}=(x_{1},...,x_{K})" display="inline"><semantics id="A2.p2.1.m1.3a"><mrow id="A2.p2.1.m1.3.3" xref="A2.p2.1.m1.3.3.cmml"><mi id="A2.p2.1.m1.3.3.4" xref="A2.p2.1.m1.3.3.4.cmml">𝐱</mi><mo id="A2.p2.1.m1.3.3.3" xref="A2.p2.1.m1.3.3.3.cmml">=</mo><mrow id="A2.p2.1.m1.3.3.2.2" xref="A2.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="A2.p2.1.m1.3.3.2.2.3" xref="A2.p2.1.m1.3.3.2.3.cmml">(</mo><msub id="A2.p2.1.m1.2.2.1.1.1" xref="A2.p2.1.m1.2.2.1.1.1.cmml"><mi id="A2.p2.1.m1.2.2.1.1.1.2" xref="A2.p2.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="A2.p2.1.m1.2.2.1.1.1.3" xref="A2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A2.p2.1.m1.3.3.2.2.4" xref="A2.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">…</mi><mo id="A2.p2.1.m1.3.3.2.2.5" xref="A2.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="A2.p2.1.m1.3.3.2.2.2" xref="A2.p2.1.m1.3.3.2.2.2.cmml"><mi id="A2.p2.1.m1.3.3.2.2.2.2" xref="A2.p2.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="A2.p2.1.m1.3.3.2.2.2.3" xref="A2.p2.1.m1.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="A2.p2.1.m1.3.3.2.2.6" xref="A2.p2.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.3b"><apply id="A2.p2.1.m1.3.3.cmml" xref="A2.p2.1.m1.3.3"><eq id="A2.p2.1.m1.3.3.3.cmml" xref="A2.p2.1.m1.3.3.3"></eq><ci id="A2.p2.1.m1.3.3.4.cmml" xref="A2.p2.1.m1.3.3.4">𝐱</ci><vector id="A2.p2.1.m1.3.3.2.3.cmml" xref="A2.p2.1.m1.3.3.2.2"><apply id="A2.p2.1.m1.2.2.1.1.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.p2.1.m1.2.2.1.1.1.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="A2.p2.1.m1.2.2.1.1.1.2.cmml" xref="A2.p2.1.m1.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="A2.p2.1.m1.2.2.1.1.1.3.cmml" xref="A2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">…</ci><apply id="A2.p2.1.m1.3.3.2.2.2.cmml" xref="A2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.p2.1.m1.3.3.2.2.2.1.cmml" xref="A2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="A2.p2.1.m1.3.3.2.2.2.2.cmml" xref="A2.p2.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="A2.p2.1.m1.3.3.2.2.2.3.cmml" xref="A2.p2.1.m1.3.3.2.2.2.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.3c">\mathbf{x}=(x_{1},...,x_{K})</annotation></semantics></math> where <math id="A2.p2.2.m2.1" class="ltx_Math" alttext="0\leq x_{i}\leq 1" display="inline"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mn id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml">0</mn><mo id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">≤</mo><msub id="A2.p2.2.m2.1.1.4" xref="A2.p2.2.m2.1.1.4.cmml"><mi id="A2.p2.2.m2.1.1.4.2" xref="A2.p2.2.m2.1.1.4.2.cmml">x</mi><mi id="A2.p2.2.m2.1.1.4.3" xref="A2.p2.2.m2.1.1.4.3.cmml">i</mi></msub><mo id="A2.p2.2.m2.1.1.5" xref="A2.p2.2.m2.1.1.5.cmml">≤</mo><mn id="A2.p2.2.m2.1.1.6" xref="A2.p2.2.m2.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><and id="A2.p2.2.m2.1.1a.cmml" xref="A2.p2.2.m2.1.1"></and><apply id="A2.p2.2.m2.1.1b.cmml" xref="A2.p2.2.m2.1.1"><leq id="A2.p2.2.m2.1.1.3.cmml" xref="A2.p2.2.m2.1.1.3"></leq><cn type="integer" id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">0</cn><apply id="A2.p2.2.m2.1.1.4.cmml" xref="A2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="A2.p2.2.m2.1.1.4.1.cmml" xref="A2.p2.2.m2.1.1.4">subscript</csymbol><ci id="A2.p2.2.m2.1.1.4.2.cmml" xref="A2.p2.2.m2.1.1.4.2">𝑥</ci><ci id="A2.p2.2.m2.1.1.4.3.cmml" xref="A2.p2.2.m2.1.1.4.3">𝑖</ci></apply></apply><apply id="A2.p2.2.m2.1.1c.cmml" xref="A2.p2.2.m2.1.1"><leq id="A2.p2.2.m2.1.1.5.cmml" xref="A2.p2.2.m2.1.1.5"></leq><share href="#A2.p2.2.m2.1.1.4.cmml" id="A2.p2.2.m2.1.1d.cmml" xref="A2.p2.2.m2.1.1"></share><cn type="integer" id="A2.p2.2.m2.1.1.6.cmml" xref="A2.p2.2.m2.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">0\leq x_{i}\leq 1</annotation></semantics></math> for <math id="A2.p2.3.m3.3" class="ltx_Math" alttext="i=1,...,K" display="inline"><semantics id="A2.p2.3.m3.3a"><mrow id="A2.p2.3.m3.3.4" xref="A2.p2.3.m3.3.4.cmml"><mi id="A2.p2.3.m3.3.4.2" xref="A2.p2.3.m3.3.4.2.cmml">i</mi><mo id="A2.p2.3.m3.3.4.1" xref="A2.p2.3.m3.3.4.1.cmml">=</mo><mrow id="A2.p2.3.m3.3.4.3.2" xref="A2.p2.3.m3.3.4.3.1.cmml"><mn id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml">1</mn><mo id="A2.p2.3.m3.3.4.3.2.1" xref="A2.p2.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.p2.3.m3.2.2" xref="A2.p2.3.m3.2.2.cmml">…</mi><mo id="A2.p2.3.m3.3.4.3.2.2" xref="A2.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="A2.p2.3.m3.3.3" xref="A2.p2.3.m3.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.3b"><apply id="A2.p2.3.m3.3.4.cmml" xref="A2.p2.3.m3.3.4"><eq id="A2.p2.3.m3.3.4.1.cmml" xref="A2.p2.3.m3.3.4.1"></eq><ci id="A2.p2.3.m3.3.4.2.cmml" xref="A2.p2.3.m3.3.4.2">𝑖</ci><list id="A2.p2.3.m3.3.4.3.1.cmml" xref="A2.p2.3.m3.3.4.3.2"><cn type="integer" id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1">1</cn><ci id="A2.p2.3.m3.2.2.cmml" xref="A2.p2.3.m3.2.2">…</ci><ci id="A2.p2.3.m3.3.3.cmml" xref="A2.p2.3.m3.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.3c">i=1,...,K</annotation></semantics></math> and <math id="A2.p2.4.m4.1" class="ltx_Math" alttext="\sum_{i=1}^{K}x_{i}=1" display="inline"><semantics id="A2.p2.4.m4.1a"><mrow id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml"><mrow id="A2.p2.4.m4.1.1.2" xref="A2.p2.4.m4.1.1.2.cmml"><msubsup id="A2.p2.4.m4.1.1.2.1" xref="A2.p2.4.m4.1.1.2.1.cmml"><mo id="A2.p2.4.m4.1.1.2.1.2.2" xref="A2.p2.4.m4.1.1.2.1.2.2.cmml">∑</mo><mrow id="A2.p2.4.m4.1.1.2.1.2.3" xref="A2.p2.4.m4.1.1.2.1.2.3.cmml"><mi id="A2.p2.4.m4.1.1.2.1.2.3.2" xref="A2.p2.4.m4.1.1.2.1.2.3.2.cmml">i</mi><mo id="A2.p2.4.m4.1.1.2.1.2.3.1" xref="A2.p2.4.m4.1.1.2.1.2.3.1.cmml">=</mo><mn id="A2.p2.4.m4.1.1.2.1.2.3.3" xref="A2.p2.4.m4.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.p2.4.m4.1.1.2.1.3" xref="A2.p2.4.m4.1.1.2.1.3.cmml">K</mi></msubsup><msub id="A2.p2.4.m4.1.1.2.2" xref="A2.p2.4.m4.1.1.2.2.cmml"><mi id="A2.p2.4.m4.1.1.2.2.2" xref="A2.p2.4.m4.1.1.2.2.2.cmml">x</mi><mi id="A2.p2.4.m4.1.1.2.2.3" xref="A2.p2.4.m4.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="A2.p2.4.m4.1.1.1" xref="A2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A2.p2.4.m4.1.1.3" xref="A2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><apply id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1"><eq id="A2.p2.4.m4.1.1.1.cmml" xref="A2.p2.4.m4.1.1.1"></eq><apply id="A2.p2.4.m4.1.1.2.cmml" xref="A2.p2.4.m4.1.1.2"><apply id="A2.p2.4.m4.1.1.2.1.cmml" xref="A2.p2.4.m4.1.1.2.1"><csymbol cd="ambiguous" id="A2.p2.4.m4.1.1.2.1.1.cmml" xref="A2.p2.4.m4.1.1.2.1">superscript</csymbol><apply id="A2.p2.4.m4.1.1.2.1.2.cmml" xref="A2.p2.4.m4.1.1.2.1"><csymbol cd="ambiguous" id="A2.p2.4.m4.1.1.2.1.2.1.cmml" xref="A2.p2.4.m4.1.1.2.1">subscript</csymbol><sum id="A2.p2.4.m4.1.1.2.1.2.2.cmml" xref="A2.p2.4.m4.1.1.2.1.2.2"></sum><apply id="A2.p2.4.m4.1.1.2.1.2.3.cmml" xref="A2.p2.4.m4.1.1.2.1.2.3"><eq id="A2.p2.4.m4.1.1.2.1.2.3.1.cmml" xref="A2.p2.4.m4.1.1.2.1.2.3.1"></eq><ci id="A2.p2.4.m4.1.1.2.1.2.3.2.cmml" xref="A2.p2.4.m4.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="A2.p2.4.m4.1.1.2.1.2.3.3.cmml" xref="A2.p2.4.m4.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A2.p2.4.m4.1.1.2.1.3.cmml" xref="A2.p2.4.m4.1.1.2.1.3">𝐾</ci></apply><apply id="A2.p2.4.m4.1.1.2.2.cmml" xref="A2.p2.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="A2.p2.4.m4.1.1.2.2.1.cmml" xref="A2.p2.4.m4.1.1.2.2">subscript</csymbol><ci id="A2.p2.4.m4.1.1.2.2.2.cmml" xref="A2.p2.4.m4.1.1.2.2.2">𝑥</ci><ci id="A2.p2.4.m4.1.1.2.2.3.cmml" xref="A2.p2.4.m4.1.1.2.2.3">𝑖</ci></apply></apply><cn type="integer" id="A2.p2.4.m4.1.1.3.cmml" xref="A2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">\sum_{i=1}^{K}x_{i}=1</annotation></semantics></math>.
Consider the problem to maximize <math id="A2.p2.5.m5.3" class="ltx_Math" alttext="f(\mathbf{x})=\sum_{i=1}^{K}{\log(1-x_{i})}" display="inline"><semantics id="A2.p2.5.m5.3a"><mrow id="A2.p2.5.m5.3.3" xref="A2.p2.5.m5.3.3.cmml"><mrow id="A2.p2.5.m5.3.3.3" xref="A2.p2.5.m5.3.3.3.cmml"><mi id="A2.p2.5.m5.3.3.3.2" xref="A2.p2.5.m5.3.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A2.p2.5.m5.3.3.3.1" xref="A2.p2.5.m5.3.3.3.1.cmml">​</mo><mrow id="A2.p2.5.m5.3.3.3.3.2" xref="A2.p2.5.m5.3.3.3.cmml"><mo stretchy="false" id="A2.p2.5.m5.3.3.3.3.2.1" xref="A2.p2.5.m5.3.3.3.cmml">(</mo><mi id="A2.p2.5.m5.1.1" xref="A2.p2.5.m5.1.1.cmml">𝐱</mi><mo stretchy="false" id="A2.p2.5.m5.3.3.3.3.2.2" xref="A2.p2.5.m5.3.3.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A2.p2.5.m5.3.3.2" xref="A2.p2.5.m5.3.3.2.cmml">=</mo><mrow id="A2.p2.5.m5.3.3.1" xref="A2.p2.5.m5.3.3.1.cmml"><msubsup id="A2.p2.5.m5.3.3.1.2" xref="A2.p2.5.m5.3.3.1.2.cmml"><mo id="A2.p2.5.m5.3.3.1.2.2.2" xref="A2.p2.5.m5.3.3.1.2.2.2.cmml">∑</mo><mrow id="A2.p2.5.m5.3.3.1.2.2.3" xref="A2.p2.5.m5.3.3.1.2.2.3.cmml"><mi id="A2.p2.5.m5.3.3.1.2.2.3.2" xref="A2.p2.5.m5.3.3.1.2.2.3.2.cmml">i</mi><mo id="A2.p2.5.m5.3.3.1.2.2.3.1" xref="A2.p2.5.m5.3.3.1.2.2.3.1.cmml">=</mo><mn id="A2.p2.5.m5.3.3.1.2.2.3.3" xref="A2.p2.5.m5.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.p2.5.m5.3.3.1.2.3" xref="A2.p2.5.m5.3.3.1.2.3.cmml">K</mi></msubsup><mrow id="A2.p2.5.m5.3.3.1.1.1" xref="A2.p2.5.m5.3.3.1.1.2.cmml"><mi id="A2.p2.5.m5.2.2" xref="A2.p2.5.m5.2.2.cmml">log</mi><mo id="A2.p2.5.m5.3.3.1.1.1a" xref="A2.p2.5.m5.3.3.1.1.2.cmml">⁡</mo><mrow id="A2.p2.5.m5.3.3.1.1.1.1" xref="A2.p2.5.m5.3.3.1.1.2.cmml"><mo stretchy="false" id="A2.p2.5.m5.3.3.1.1.1.1.2" xref="A2.p2.5.m5.3.3.1.1.2.cmml">(</mo><mrow id="A2.p2.5.m5.3.3.1.1.1.1.1" xref="A2.p2.5.m5.3.3.1.1.1.1.1.cmml"><mn id="A2.p2.5.m5.3.3.1.1.1.1.1.2" xref="A2.p2.5.m5.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="A2.p2.5.m5.3.3.1.1.1.1.1.1" xref="A2.p2.5.m5.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="A2.p2.5.m5.3.3.1.1.1.1.1.3" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3.cmml"><mi id="A2.p2.5.m5.3.3.1.1.1.1.1.3.2" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3.2.cmml">x</mi><mi id="A2.p2.5.m5.3.3.1.1.1.1.1.3.3" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A2.p2.5.m5.3.3.1.1.1.1.3" xref="A2.p2.5.m5.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.5.m5.3b"><apply id="A2.p2.5.m5.3.3.cmml" xref="A2.p2.5.m5.3.3"><eq id="A2.p2.5.m5.3.3.2.cmml" xref="A2.p2.5.m5.3.3.2"></eq><apply id="A2.p2.5.m5.3.3.3.cmml" xref="A2.p2.5.m5.3.3.3"><times id="A2.p2.5.m5.3.3.3.1.cmml" xref="A2.p2.5.m5.3.3.3.1"></times><ci id="A2.p2.5.m5.3.3.3.2.cmml" xref="A2.p2.5.m5.3.3.3.2">𝑓</ci><ci id="A2.p2.5.m5.1.1.cmml" xref="A2.p2.5.m5.1.1">𝐱</ci></apply><apply id="A2.p2.5.m5.3.3.1.cmml" xref="A2.p2.5.m5.3.3.1"><apply id="A2.p2.5.m5.3.3.1.2.cmml" xref="A2.p2.5.m5.3.3.1.2"><csymbol cd="ambiguous" id="A2.p2.5.m5.3.3.1.2.1.cmml" xref="A2.p2.5.m5.3.3.1.2">superscript</csymbol><apply id="A2.p2.5.m5.3.3.1.2.2.cmml" xref="A2.p2.5.m5.3.3.1.2"><csymbol cd="ambiguous" id="A2.p2.5.m5.3.3.1.2.2.1.cmml" xref="A2.p2.5.m5.3.3.1.2">subscript</csymbol><sum id="A2.p2.5.m5.3.3.1.2.2.2.cmml" xref="A2.p2.5.m5.3.3.1.2.2.2"></sum><apply id="A2.p2.5.m5.3.3.1.2.2.3.cmml" xref="A2.p2.5.m5.3.3.1.2.2.3"><eq id="A2.p2.5.m5.3.3.1.2.2.3.1.cmml" xref="A2.p2.5.m5.3.3.1.2.2.3.1"></eq><ci id="A2.p2.5.m5.3.3.1.2.2.3.2.cmml" xref="A2.p2.5.m5.3.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="A2.p2.5.m5.3.3.1.2.2.3.3.cmml" xref="A2.p2.5.m5.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="A2.p2.5.m5.3.3.1.2.3.cmml" xref="A2.p2.5.m5.3.3.1.2.3">𝐾</ci></apply><apply id="A2.p2.5.m5.3.3.1.1.2.cmml" xref="A2.p2.5.m5.3.3.1.1.1"><log id="A2.p2.5.m5.2.2.cmml" xref="A2.p2.5.m5.2.2"></log><apply id="A2.p2.5.m5.3.3.1.1.1.1.1.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1"><minus id="A2.p2.5.m5.3.3.1.1.1.1.1.1.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="A2.p2.5.m5.3.3.1.1.1.1.1.2.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.2">1</cn><apply id="A2.p2.5.m5.3.3.1.1.1.1.1.3.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.p2.5.m5.3.3.1.1.1.1.1.3.1.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="A2.p2.5.m5.3.3.1.1.1.1.1.3.2.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3.2">𝑥</ci><ci id="A2.p2.5.m5.3.3.1.1.1.1.1.3.3.cmml" xref="A2.p2.5.m5.3.3.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.5.m5.3c">f(\mathbf{x})=\sum_{i=1}^{K}{\log(1-x_{i})}</annotation></semantics></math>.
Then, <math id="A2.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{x}^{*}" display="inline"><semantics id="A2.p2.6.m6.1a"><msup id="A2.p2.6.m6.1.1" xref="A2.p2.6.m6.1.1.cmml"><mi id="A2.p2.6.m6.1.1.2" xref="A2.p2.6.m6.1.1.2.cmml">𝐱</mi><mo id="A2.p2.6.m6.1.1.3" xref="A2.p2.6.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A2.p2.6.m6.1b"><apply id="A2.p2.6.m6.1.1.cmml" xref="A2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A2.p2.6.m6.1.1.1.cmml" xref="A2.p2.6.m6.1.1">superscript</csymbol><ci id="A2.p2.6.m6.1.1.2.cmml" xref="A2.p2.6.m6.1.1.2">𝐱</ci><times id="A2.p2.6.m6.1.1.3.cmml" xref="A2.p2.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.6.m6.1c">\mathbf{x}^{*}</annotation></semantics></math> is the optimal solution of this problem if and only if <math id="A2.p2.7.m7.1" class="ltx_Math" alttext="x_{i}^{*}=\frac{1}{K}" display="inline"><semantics id="A2.p2.7.m7.1a"><mrow id="A2.p2.7.m7.1.1" xref="A2.p2.7.m7.1.1.cmml"><msubsup id="A2.p2.7.m7.1.1.2" xref="A2.p2.7.m7.1.1.2.cmml"><mi id="A2.p2.7.m7.1.1.2.2.2" xref="A2.p2.7.m7.1.1.2.2.2.cmml">x</mi><mi id="A2.p2.7.m7.1.1.2.2.3" xref="A2.p2.7.m7.1.1.2.2.3.cmml">i</mi><mo id="A2.p2.7.m7.1.1.2.3" xref="A2.p2.7.m7.1.1.2.3.cmml">∗</mo></msubsup><mo id="A2.p2.7.m7.1.1.1" xref="A2.p2.7.m7.1.1.1.cmml">=</mo><mfrac id="A2.p2.7.m7.1.1.3" xref="A2.p2.7.m7.1.1.3.cmml"><mn id="A2.p2.7.m7.1.1.3.2" xref="A2.p2.7.m7.1.1.3.2.cmml">1</mn><mi id="A2.p2.7.m7.1.1.3.3" xref="A2.p2.7.m7.1.1.3.3.cmml">K</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.7.m7.1b"><apply id="A2.p2.7.m7.1.1.cmml" xref="A2.p2.7.m7.1.1"><eq id="A2.p2.7.m7.1.1.1.cmml" xref="A2.p2.7.m7.1.1.1"></eq><apply id="A2.p2.7.m7.1.1.2.cmml" xref="A2.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="A2.p2.7.m7.1.1.2.1.cmml" xref="A2.p2.7.m7.1.1.2">superscript</csymbol><apply id="A2.p2.7.m7.1.1.2.2.cmml" xref="A2.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="A2.p2.7.m7.1.1.2.2.1.cmml" xref="A2.p2.7.m7.1.1.2">subscript</csymbol><ci id="A2.p2.7.m7.1.1.2.2.2.cmml" xref="A2.p2.7.m7.1.1.2.2.2">𝑥</ci><ci id="A2.p2.7.m7.1.1.2.2.3.cmml" xref="A2.p2.7.m7.1.1.2.2.3">𝑖</ci></apply><times id="A2.p2.7.m7.1.1.2.3.cmml" xref="A2.p2.7.m7.1.1.2.3"></times></apply><apply id="A2.p2.7.m7.1.1.3.cmml" xref="A2.p2.7.m7.1.1.3"><divide id="A2.p2.7.m7.1.1.3.1.cmml" xref="A2.p2.7.m7.1.1.3"></divide><cn type="integer" id="A2.p2.7.m7.1.1.3.2.cmml" xref="A2.p2.7.m7.1.1.3.2">1</cn><ci id="A2.p2.7.m7.1.1.3.3.cmml" xref="A2.p2.7.m7.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.7.m7.1c">x_{i}^{*}=\frac{1}{K}</annotation></semantics></math> for <math id="A2.p2.8.m8.3" class="ltx_Math" alttext="i=1,...,K" display="inline"><semantics id="A2.p2.8.m8.3a"><mrow id="A2.p2.8.m8.3.4" xref="A2.p2.8.m8.3.4.cmml"><mi id="A2.p2.8.m8.3.4.2" xref="A2.p2.8.m8.3.4.2.cmml">i</mi><mo id="A2.p2.8.m8.3.4.1" xref="A2.p2.8.m8.3.4.1.cmml">=</mo><mrow id="A2.p2.8.m8.3.4.3.2" xref="A2.p2.8.m8.3.4.3.1.cmml"><mn id="A2.p2.8.m8.1.1" xref="A2.p2.8.m8.1.1.cmml">1</mn><mo id="A2.p2.8.m8.3.4.3.2.1" xref="A2.p2.8.m8.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.p2.8.m8.2.2" xref="A2.p2.8.m8.2.2.cmml">…</mi><mo id="A2.p2.8.m8.3.4.3.2.2" xref="A2.p2.8.m8.3.4.3.1.cmml">,</mo><mi id="A2.p2.8.m8.3.3" xref="A2.p2.8.m8.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.8.m8.3b"><apply id="A2.p2.8.m8.3.4.cmml" xref="A2.p2.8.m8.3.4"><eq id="A2.p2.8.m8.3.4.1.cmml" xref="A2.p2.8.m8.3.4.1"></eq><ci id="A2.p2.8.m8.3.4.2.cmml" xref="A2.p2.8.m8.3.4.2">𝑖</ci><list id="A2.p2.8.m8.3.4.3.1.cmml" xref="A2.p2.8.m8.3.4.3.2"><cn type="integer" id="A2.p2.8.m8.1.1.cmml" xref="A2.p2.8.m8.1.1">1</cn><ci id="A2.p2.8.m8.2.2.cmml" xref="A2.p2.8.m8.2.2">…</ci><ci id="A2.p2.8.m8.3.3.cmml" xref="A2.p2.8.m8.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.8.m8.3c">i=1,...,K</annotation></semantics></math>.</p>
</div>
<div id="A2.2" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A2.1.p1" class="ltx_para">
<p id="A2.1.p1.2" class="ltx_p">We use Lagrangian multiplier <math id="A2.1.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.1.p1.1.m1.1a"><mi id="A2.1.p1.1.m1.1.1" xref="A2.1.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.1.p1.1.m1.1b"><ci id="A2.1.p1.1.m1.1.1.cmml" xref="A2.1.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.1.m1.1c">\lambda</annotation></semantics></math> to solve above constrained optimization problem.
Suppose <math id="A2.1.p1.2.m2.1" class="ltx_Math" alttext="g(\mathbf{x})=\sum_{i=1}^{K}{x_{i}}" display="inline"><semantics id="A2.1.p1.2.m2.1a"><mrow id="A2.1.p1.2.m2.1.2" xref="A2.1.p1.2.m2.1.2.cmml"><mrow id="A2.1.p1.2.m2.1.2.2" xref="A2.1.p1.2.m2.1.2.2.cmml"><mi id="A2.1.p1.2.m2.1.2.2.2" xref="A2.1.p1.2.m2.1.2.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.1.p1.2.m2.1.2.2.1" xref="A2.1.p1.2.m2.1.2.2.1.cmml">​</mo><mrow id="A2.1.p1.2.m2.1.2.2.3.2" xref="A2.1.p1.2.m2.1.2.2.cmml"><mo stretchy="false" id="A2.1.p1.2.m2.1.2.2.3.2.1" xref="A2.1.p1.2.m2.1.2.2.cmml">(</mo><mi id="A2.1.p1.2.m2.1.1" xref="A2.1.p1.2.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="A2.1.p1.2.m2.1.2.2.3.2.2" xref="A2.1.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A2.1.p1.2.m2.1.2.1" xref="A2.1.p1.2.m2.1.2.1.cmml">=</mo><mrow id="A2.1.p1.2.m2.1.2.3" xref="A2.1.p1.2.m2.1.2.3.cmml"><msubsup id="A2.1.p1.2.m2.1.2.3.1" xref="A2.1.p1.2.m2.1.2.3.1.cmml"><mo id="A2.1.p1.2.m2.1.2.3.1.2.2" xref="A2.1.p1.2.m2.1.2.3.1.2.2.cmml">∑</mo><mrow id="A2.1.p1.2.m2.1.2.3.1.2.3" xref="A2.1.p1.2.m2.1.2.3.1.2.3.cmml"><mi id="A2.1.p1.2.m2.1.2.3.1.2.3.2" xref="A2.1.p1.2.m2.1.2.3.1.2.3.2.cmml">i</mi><mo id="A2.1.p1.2.m2.1.2.3.1.2.3.1" xref="A2.1.p1.2.m2.1.2.3.1.2.3.1.cmml">=</mo><mn id="A2.1.p1.2.m2.1.2.3.1.2.3.3" xref="A2.1.p1.2.m2.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="A2.1.p1.2.m2.1.2.3.1.3" xref="A2.1.p1.2.m2.1.2.3.1.3.cmml">K</mi></msubsup><msub id="A2.1.p1.2.m2.1.2.3.2" xref="A2.1.p1.2.m2.1.2.3.2.cmml"><mi id="A2.1.p1.2.m2.1.2.3.2.2" xref="A2.1.p1.2.m2.1.2.3.2.2.cmml">x</mi><mi id="A2.1.p1.2.m2.1.2.3.2.3" xref="A2.1.p1.2.m2.1.2.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.2.m2.1b"><apply id="A2.1.p1.2.m2.1.2.cmml" xref="A2.1.p1.2.m2.1.2"><eq id="A2.1.p1.2.m2.1.2.1.cmml" xref="A2.1.p1.2.m2.1.2.1"></eq><apply id="A2.1.p1.2.m2.1.2.2.cmml" xref="A2.1.p1.2.m2.1.2.2"><times id="A2.1.p1.2.m2.1.2.2.1.cmml" xref="A2.1.p1.2.m2.1.2.2.1"></times><ci id="A2.1.p1.2.m2.1.2.2.2.cmml" xref="A2.1.p1.2.m2.1.2.2.2">𝑔</ci><ci id="A2.1.p1.2.m2.1.1.cmml" xref="A2.1.p1.2.m2.1.1">𝐱</ci></apply><apply id="A2.1.p1.2.m2.1.2.3.cmml" xref="A2.1.p1.2.m2.1.2.3"><apply id="A2.1.p1.2.m2.1.2.3.1.cmml" xref="A2.1.p1.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="A2.1.p1.2.m2.1.2.3.1.1.cmml" xref="A2.1.p1.2.m2.1.2.3.1">superscript</csymbol><apply id="A2.1.p1.2.m2.1.2.3.1.2.cmml" xref="A2.1.p1.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="A2.1.p1.2.m2.1.2.3.1.2.1.cmml" xref="A2.1.p1.2.m2.1.2.3.1">subscript</csymbol><sum id="A2.1.p1.2.m2.1.2.3.1.2.2.cmml" xref="A2.1.p1.2.m2.1.2.3.1.2.2"></sum><apply id="A2.1.p1.2.m2.1.2.3.1.2.3.cmml" xref="A2.1.p1.2.m2.1.2.3.1.2.3"><eq id="A2.1.p1.2.m2.1.2.3.1.2.3.1.cmml" xref="A2.1.p1.2.m2.1.2.3.1.2.3.1"></eq><ci id="A2.1.p1.2.m2.1.2.3.1.2.3.2.cmml" xref="A2.1.p1.2.m2.1.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="A2.1.p1.2.m2.1.2.3.1.2.3.3.cmml" xref="A2.1.p1.2.m2.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="A2.1.p1.2.m2.1.2.3.1.3.cmml" xref="A2.1.p1.2.m2.1.2.3.1.3">𝐾</ci></apply><apply id="A2.1.p1.2.m2.1.2.3.2.cmml" xref="A2.1.p1.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="A2.1.p1.2.m2.1.2.3.2.1.cmml" xref="A2.1.p1.2.m2.1.2.3.2">subscript</csymbol><ci id="A2.1.p1.2.m2.1.2.3.2.2.cmml" xref="A2.1.p1.2.m2.1.2.3.2.2">𝑥</ci><ci id="A2.1.p1.2.m2.1.2.3.2.3.cmml" xref="A2.1.p1.2.m2.1.2.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.2.m2.1c">g(\mathbf{x})=\sum_{i=1}^{K}{x_{i}}</annotation></semantics></math>.
Then, the optimal solution solves the following equations.</p>
<table id="A5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\nabla f(\mathbf{x}^{*})" display="inline"><semantics id="A2.E6.m1.1a"><mrow id="A2.E6.m1.1.1" xref="A2.E6.m1.1.1.cmml"><mrow id="A2.E6.m1.1.1.3" xref="A2.E6.m1.1.1.3.cmml"><mo rspace="0.167em" id="A2.E6.m1.1.1.3.1" xref="A2.E6.m1.1.1.3.1.cmml">∇</mo><mi id="A2.E6.m1.1.1.3.2" xref="A2.E6.m1.1.1.3.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="A2.E6.m1.1.1.2" xref="A2.E6.m1.1.1.2.cmml">​</mo><mrow id="A2.E6.m1.1.1.1.1" xref="A2.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E6.m1.1.1.1.1.2" xref="A2.E6.m1.1.1.1.1.1.cmml">(</mo><msup id="A2.E6.m1.1.1.1.1.1" xref="A2.E6.m1.1.1.1.1.1.cmml"><mi id="A2.E6.m1.1.1.1.1.1.2" xref="A2.E6.m1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E6.m1.1.1.1.1.1.3" xref="A2.E6.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="A2.E6.m1.1.1.1.1.3" xref="A2.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E6.m1.1b"><apply id="A2.E6.m1.1.1.cmml" xref="A2.E6.m1.1.1"><times id="A2.E6.m1.1.1.2.cmml" xref="A2.E6.m1.1.1.2"></times><apply id="A2.E6.m1.1.1.3.cmml" xref="A2.E6.m1.1.1.3"><ci id="A2.E6.m1.1.1.3.1.cmml" xref="A2.E6.m1.1.1.3.1">∇</ci><ci id="A2.E6.m1.1.1.3.2.cmml" xref="A2.E6.m1.1.1.3.2">𝑓</ci></apply><apply id="A2.E6.m1.1.1.1.1.1.cmml" xref="A2.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E6.m1.1.1.1.1.1.1.cmml" xref="A2.E6.m1.1.1.1.1">superscript</csymbol><ci id="A2.E6.m1.1.1.1.1.1.2.cmml" xref="A2.E6.m1.1.1.1.1.1.2">𝐱</ci><times id="A2.E6.m1.1.1.1.1.1.3.cmml" xref="A2.E6.m1.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E6.m1.1c">\displaystyle\nabla f(\mathbf{x}^{*})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E6.m2.1" class="ltx_Math" alttext="\displaystyle=\lambda\nabla g(\mathbf{x}^{*})" display="inline"><semantics id="A2.E6.m2.1a"><mrow id="A2.E6.m2.1.1" xref="A2.E6.m2.1.1.cmml"><mi id="A2.E6.m2.1.1.3" xref="A2.E6.m2.1.1.3.cmml"></mi><mo id="A2.E6.m2.1.1.2" xref="A2.E6.m2.1.1.2.cmml">=</mo><mrow id="A2.E6.m2.1.1.1" xref="A2.E6.m2.1.1.1.cmml"><mi id="A2.E6.m2.1.1.1.3" xref="A2.E6.m2.1.1.1.3.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="A2.E6.m2.1.1.1.2" xref="A2.E6.m2.1.1.1.2.cmml">​</mo><mrow id="A2.E6.m2.1.1.1.4" xref="A2.E6.m2.1.1.1.4.cmml"><mo rspace="0.167em" id="A2.E6.m2.1.1.1.4.1" xref="A2.E6.m2.1.1.1.4.1.cmml">∇</mo><mi id="A2.E6.m2.1.1.1.4.2" xref="A2.E6.m2.1.1.1.4.2.cmml">g</mi></mrow><mo lspace="0em" rspace="0em" id="A2.E6.m2.1.1.1.2a" xref="A2.E6.m2.1.1.1.2.cmml">​</mo><mrow id="A2.E6.m2.1.1.1.1.1" xref="A2.E6.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E6.m2.1.1.1.1.1.2" xref="A2.E6.m2.1.1.1.1.1.1.cmml">(</mo><msup id="A2.E6.m2.1.1.1.1.1.1" xref="A2.E6.m2.1.1.1.1.1.1.cmml"><mi id="A2.E6.m2.1.1.1.1.1.1.2" xref="A2.E6.m2.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E6.m2.1.1.1.1.1.1.3" xref="A2.E6.m2.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="A2.E6.m2.1.1.1.1.1.3" xref="A2.E6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E6.m2.1b"><apply id="A2.E6.m2.1.1.cmml" xref="A2.E6.m2.1.1"><eq id="A2.E6.m2.1.1.2.cmml" xref="A2.E6.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.E6.m2.1.1.3.cmml" xref="A2.E6.m2.1.1.3">absent</csymbol><apply id="A2.E6.m2.1.1.1.cmml" xref="A2.E6.m2.1.1.1"><times id="A2.E6.m2.1.1.1.2.cmml" xref="A2.E6.m2.1.1.1.2"></times><ci id="A2.E6.m2.1.1.1.3.cmml" xref="A2.E6.m2.1.1.1.3">𝜆</ci><apply id="A2.E6.m2.1.1.1.4.cmml" xref="A2.E6.m2.1.1.1.4"><ci id="A2.E6.m2.1.1.1.4.1.cmml" xref="A2.E6.m2.1.1.1.4.1">∇</ci><ci id="A2.E6.m2.1.1.1.4.2.cmml" xref="A2.E6.m2.1.1.1.4.2">𝑔</ci></apply><apply id="A2.E6.m2.1.1.1.1.1.1.cmml" xref="A2.E6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E6.m2.1.1.1.1.1.1.1.cmml" xref="A2.E6.m2.1.1.1.1.1">superscript</csymbol><ci id="A2.E6.m2.1.1.1.1.1.1.2.cmml" xref="A2.E6.m2.1.1.1.1.1.1.2">𝐱</ci><times id="A2.E6.m2.1.1.1.1.1.1.3.cmml" xref="A2.E6.m2.1.1.1.1.1.1.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E6.m2.1c">\displaystyle=\lambda\nabla g(\mathbf{x}^{*})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="A2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E7.m1.1" class="ltx_Math" alttext="\displaystyle g(\mathbf{x}^{*})" display="inline"><semantics id="A2.E7.m1.1a"><mrow id="A2.E7.m1.1.1" xref="A2.E7.m1.1.1.cmml"><mi id="A2.E7.m1.1.1.3" xref="A2.E7.m1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A2.E7.m1.1.1.2" xref="A2.E7.m1.1.1.2.cmml">​</mo><mrow id="A2.E7.m1.1.1.1.1" xref="A2.E7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E7.m1.1.1.1.1.2" xref="A2.E7.m1.1.1.1.1.1.cmml">(</mo><msup id="A2.E7.m1.1.1.1.1.1" xref="A2.E7.m1.1.1.1.1.1.cmml"><mi id="A2.E7.m1.1.1.1.1.1.2" xref="A2.E7.m1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E7.m1.1.1.1.1.1.3" xref="A2.E7.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="A2.E7.m1.1.1.1.1.3" xref="A2.E7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E7.m1.1b"><apply id="A2.E7.m1.1.1.cmml" xref="A2.E7.m1.1.1"><times id="A2.E7.m1.1.1.2.cmml" xref="A2.E7.m1.1.1.2"></times><ci id="A2.E7.m1.1.1.3.cmml" xref="A2.E7.m1.1.1.3">𝑔</ci><apply id="A2.E7.m1.1.1.1.1.1.cmml" xref="A2.E7.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E7.m1.1.1.1.1.1.1.cmml" xref="A2.E7.m1.1.1.1.1">superscript</csymbol><ci id="A2.E7.m1.1.1.1.1.1.2.cmml" xref="A2.E7.m1.1.1.1.1.1.2">𝐱</ci><times id="A2.E7.m1.1.1.1.1.1.3.cmml" xref="A2.E7.m1.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E7.m1.1c">\displaystyle g(\mathbf{x}^{*})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E7.m2.1" class="ltx_Math" alttext="\displaystyle=1" display="inline"><semantics id="A2.E7.m2.1a"><mrow id="A2.E7.m2.1.1" xref="A2.E7.m2.1.1.cmml"><mi id="A2.E7.m2.1.1.2" xref="A2.E7.m2.1.1.2.cmml"></mi><mo id="A2.E7.m2.1.1.1" xref="A2.E7.m2.1.1.1.cmml">=</mo><mn id="A2.E7.m2.1.1.3" xref="A2.E7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.E7.m2.1b"><apply id="A2.E7.m2.1.1.cmml" xref="A2.E7.m2.1.1"><eq id="A2.E7.m2.1.1.1.cmml" xref="A2.E7.m2.1.1.1"></eq><csymbol cd="latexml" id="A2.E7.m2.1.1.2.cmml" xref="A2.E7.m2.1.1.2">absent</csymbol><cn type="integer" id="A2.E7.m2.1.1.3.cmml" xref="A2.E7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E7.m2.1c">\displaystyle=1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="A2.1.p1.5" class="ltx_p">Considering <math id="A2.1.p1.3.m1.4" class="ltx_Math" alttext="\nabla f(\mathbf{x})=(\frac{1}{x_{1}-1},...,\frac{1}{x_{K}-1})" display="inline"><semantics id="A2.1.p1.3.m1.4a"><mrow id="A2.1.p1.3.m1.4.5" xref="A2.1.p1.3.m1.4.5.cmml"><mrow id="A2.1.p1.3.m1.4.5.2" xref="A2.1.p1.3.m1.4.5.2.cmml"><mrow id="A2.1.p1.3.m1.4.5.2.2" xref="A2.1.p1.3.m1.4.5.2.2.cmml"><mo rspace="0.167em" id="A2.1.p1.3.m1.4.5.2.2.1" xref="A2.1.p1.3.m1.4.5.2.2.1.cmml">∇</mo><mi id="A2.1.p1.3.m1.4.5.2.2.2" xref="A2.1.p1.3.m1.4.5.2.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="A2.1.p1.3.m1.4.5.2.1" xref="A2.1.p1.3.m1.4.5.2.1.cmml">​</mo><mrow id="A2.1.p1.3.m1.4.5.2.3.2" xref="A2.1.p1.3.m1.4.5.2.cmml"><mo stretchy="false" id="A2.1.p1.3.m1.4.5.2.3.2.1" xref="A2.1.p1.3.m1.4.5.2.cmml">(</mo><mi id="A2.1.p1.3.m1.1.1" xref="A2.1.p1.3.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="A2.1.p1.3.m1.4.5.2.3.2.2" xref="A2.1.p1.3.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="A2.1.p1.3.m1.4.5.1" xref="A2.1.p1.3.m1.4.5.1.cmml">=</mo><mrow id="A2.1.p1.3.m1.4.5.3.2" xref="A2.1.p1.3.m1.4.5.3.1.cmml"><mo stretchy="false" id="A2.1.p1.3.m1.4.5.3.2.1" xref="A2.1.p1.3.m1.4.5.3.1.cmml">(</mo><mfrac id="A2.1.p1.3.m1.2.2" xref="A2.1.p1.3.m1.2.2.cmml"><mn id="A2.1.p1.3.m1.2.2.2" xref="A2.1.p1.3.m1.2.2.2.cmml">1</mn><mrow id="A2.1.p1.3.m1.2.2.3" xref="A2.1.p1.3.m1.2.2.3.cmml"><msub id="A2.1.p1.3.m1.2.2.3.2" xref="A2.1.p1.3.m1.2.2.3.2.cmml"><mi id="A2.1.p1.3.m1.2.2.3.2.2" xref="A2.1.p1.3.m1.2.2.3.2.2.cmml">x</mi><mn id="A2.1.p1.3.m1.2.2.3.2.3" xref="A2.1.p1.3.m1.2.2.3.2.3.cmml">1</mn></msub><mo id="A2.1.p1.3.m1.2.2.3.1" xref="A2.1.p1.3.m1.2.2.3.1.cmml">−</mo><mn id="A2.1.p1.3.m1.2.2.3.3" xref="A2.1.p1.3.m1.2.2.3.3.cmml">1</mn></mrow></mfrac><mo id="A2.1.p1.3.m1.4.5.3.2.2" xref="A2.1.p1.3.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.1.p1.3.m1.3.3" xref="A2.1.p1.3.m1.3.3.cmml">…</mi><mo id="A2.1.p1.3.m1.4.5.3.2.3" xref="A2.1.p1.3.m1.4.5.3.1.cmml">,</mo><mfrac id="A2.1.p1.3.m1.4.4" xref="A2.1.p1.3.m1.4.4.cmml"><mn id="A2.1.p1.3.m1.4.4.2" xref="A2.1.p1.3.m1.4.4.2.cmml">1</mn><mrow id="A2.1.p1.3.m1.4.4.3" xref="A2.1.p1.3.m1.4.4.3.cmml"><msub id="A2.1.p1.3.m1.4.4.3.2" xref="A2.1.p1.3.m1.4.4.3.2.cmml"><mi id="A2.1.p1.3.m1.4.4.3.2.2" xref="A2.1.p1.3.m1.4.4.3.2.2.cmml">x</mi><mi id="A2.1.p1.3.m1.4.4.3.2.3" xref="A2.1.p1.3.m1.4.4.3.2.3.cmml">K</mi></msub><mo id="A2.1.p1.3.m1.4.4.3.1" xref="A2.1.p1.3.m1.4.4.3.1.cmml">−</mo><mn id="A2.1.p1.3.m1.4.4.3.3" xref="A2.1.p1.3.m1.4.4.3.3.cmml">1</mn></mrow></mfrac><mo stretchy="false" id="A2.1.p1.3.m1.4.5.3.2.4" xref="A2.1.p1.3.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.3.m1.4b"><apply id="A2.1.p1.3.m1.4.5.cmml" xref="A2.1.p1.3.m1.4.5"><eq id="A2.1.p1.3.m1.4.5.1.cmml" xref="A2.1.p1.3.m1.4.5.1"></eq><apply id="A2.1.p1.3.m1.4.5.2.cmml" xref="A2.1.p1.3.m1.4.5.2"><times id="A2.1.p1.3.m1.4.5.2.1.cmml" xref="A2.1.p1.3.m1.4.5.2.1"></times><apply id="A2.1.p1.3.m1.4.5.2.2.cmml" xref="A2.1.p1.3.m1.4.5.2.2"><ci id="A2.1.p1.3.m1.4.5.2.2.1.cmml" xref="A2.1.p1.3.m1.4.5.2.2.1">∇</ci><ci id="A2.1.p1.3.m1.4.5.2.2.2.cmml" xref="A2.1.p1.3.m1.4.5.2.2.2">𝑓</ci></apply><ci id="A2.1.p1.3.m1.1.1.cmml" xref="A2.1.p1.3.m1.1.1">𝐱</ci></apply><vector id="A2.1.p1.3.m1.4.5.3.1.cmml" xref="A2.1.p1.3.m1.4.5.3.2"><apply id="A2.1.p1.3.m1.2.2.cmml" xref="A2.1.p1.3.m1.2.2"><divide id="A2.1.p1.3.m1.2.2.1.cmml" xref="A2.1.p1.3.m1.2.2"></divide><cn type="integer" id="A2.1.p1.3.m1.2.2.2.cmml" xref="A2.1.p1.3.m1.2.2.2">1</cn><apply id="A2.1.p1.3.m1.2.2.3.cmml" xref="A2.1.p1.3.m1.2.2.3"><minus id="A2.1.p1.3.m1.2.2.3.1.cmml" xref="A2.1.p1.3.m1.2.2.3.1"></minus><apply id="A2.1.p1.3.m1.2.2.3.2.cmml" xref="A2.1.p1.3.m1.2.2.3.2"><csymbol cd="ambiguous" id="A2.1.p1.3.m1.2.2.3.2.1.cmml" xref="A2.1.p1.3.m1.2.2.3.2">subscript</csymbol><ci id="A2.1.p1.3.m1.2.2.3.2.2.cmml" xref="A2.1.p1.3.m1.2.2.3.2.2">𝑥</ci><cn type="integer" id="A2.1.p1.3.m1.2.2.3.2.3.cmml" xref="A2.1.p1.3.m1.2.2.3.2.3">1</cn></apply><cn type="integer" id="A2.1.p1.3.m1.2.2.3.3.cmml" xref="A2.1.p1.3.m1.2.2.3.3">1</cn></apply></apply><ci id="A2.1.p1.3.m1.3.3.cmml" xref="A2.1.p1.3.m1.3.3">…</ci><apply id="A2.1.p1.3.m1.4.4.cmml" xref="A2.1.p1.3.m1.4.4"><divide id="A2.1.p1.3.m1.4.4.1.cmml" xref="A2.1.p1.3.m1.4.4"></divide><cn type="integer" id="A2.1.p1.3.m1.4.4.2.cmml" xref="A2.1.p1.3.m1.4.4.2">1</cn><apply id="A2.1.p1.3.m1.4.4.3.cmml" xref="A2.1.p1.3.m1.4.4.3"><minus id="A2.1.p1.3.m1.4.4.3.1.cmml" xref="A2.1.p1.3.m1.4.4.3.1"></minus><apply id="A2.1.p1.3.m1.4.4.3.2.cmml" xref="A2.1.p1.3.m1.4.4.3.2"><csymbol cd="ambiguous" id="A2.1.p1.3.m1.4.4.3.2.1.cmml" xref="A2.1.p1.3.m1.4.4.3.2">subscript</csymbol><ci id="A2.1.p1.3.m1.4.4.3.2.2.cmml" xref="A2.1.p1.3.m1.4.4.3.2.2">𝑥</ci><ci id="A2.1.p1.3.m1.4.4.3.2.3.cmml" xref="A2.1.p1.3.m1.4.4.3.2.3">𝐾</ci></apply><cn type="integer" id="A2.1.p1.3.m1.4.4.3.3.cmml" xref="A2.1.p1.3.m1.4.4.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.3.m1.4c">\nabla f(\mathbf{x})=(\frac{1}{x_{1}-1},...,\frac{1}{x_{K}-1})</annotation></semantics></math> and <math id="A2.1.p1.4.m2.4" class="ltx_Math" alttext="\nabla g(\mathbf{x})=(1,...,1)" display="inline"><semantics id="A2.1.p1.4.m2.4a"><mrow id="A2.1.p1.4.m2.4.5" xref="A2.1.p1.4.m2.4.5.cmml"><mrow id="A2.1.p1.4.m2.4.5.2" xref="A2.1.p1.4.m2.4.5.2.cmml"><mrow id="A2.1.p1.4.m2.4.5.2.2" xref="A2.1.p1.4.m2.4.5.2.2.cmml"><mo rspace="0.167em" id="A2.1.p1.4.m2.4.5.2.2.1" xref="A2.1.p1.4.m2.4.5.2.2.1.cmml">∇</mo><mi id="A2.1.p1.4.m2.4.5.2.2.2" xref="A2.1.p1.4.m2.4.5.2.2.2.cmml">g</mi></mrow><mo lspace="0em" rspace="0em" id="A2.1.p1.4.m2.4.5.2.1" xref="A2.1.p1.4.m2.4.5.2.1.cmml">​</mo><mrow id="A2.1.p1.4.m2.4.5.2.3.2" xref="A2.1.p1.4.m2.4.5.2.cmml"><mo stretchy="false" id="A2.1.p1.4.m2.4.5.2.3.2.1" xref="A2.1.p1.4.m2.4.5.2.cmml">(</mo><mi id="A2.1.p1.4.m2.1.1" xref="A2.1.p1.4.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="A2.1.p1.4.m2.4.5.2.3.2.2" xref="A2.1.p1.4.m2.4.5.2.cmml">)</mo></mrow></mrow><mo id="A2.1.p1.4.m2.4.5.1" xref="A2.1.p1.4.m2.4.5.1.cmml">=</mo><mrow id="A2.1.p1.4.m2.4.5.3.2" xref="A2.1.p1.4.m2.4.5.3.1.cmml"><mo stretchy="false" id="A2.1.p1.4.m2.4.5.3.2.1" xref="A2.1.p1.4.m2.4.5.3.1.cmml">(</mo><mn id="A2.1.p1.4.m2.2.2" xref="A2.1.p1.4.m2.2.2.cmml">1</mn><mo id="A2.1.p1.4.m2.4.5.3.2.2" xref="A2.1.p1.4.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.1.p1.4.m2.3.3" xref="A2.1.p1.4.m2.3.3.cmml">…</mi><mo id="A2.1.p1.4.m2.4.5.3.2.3" xref="A2.1.p1.4.m2.4.5.3.1.cmml">,</mo><mn id="A2.1.p1.4.m2.4.4" xref="A2.1.p1.4.m2.4.4.cmml">1</mn><mo stretchy="false" id="A2.1.p1.4.m2.4.5.3.2.4" xref="A2.1.p1.4.m2.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.4.m2.4b"><apply id="A2.1.p1.4.m2.4.5.cmml" xref="A2.1.p1.4.m2.4.5"><eq id="A2.1.p1.4.m2.4.5.1.cmml" xref="A2.1.p1.4.m2.4.5.1"></eq><apply id="A2.1.p1.4.m2.4.5.2.cmml" xref="A2.1.p1.4.m2.4.5.2"><times id="A2.1.p1.4.m2.4.5.2.1.cmml" xref="A2.1.p1.4.m2.4.5.2.1"></times><apply id="A2.1.p1.4.m2.4.5.2.2.cmml" xref="A2.1.p1.4.m2.4.5.2.2"><ci id="A2.1.p1.4.m2.4.5.2.2.1.cmml" xref="A2.1.p1.4.m2.4.5.2.2.1">∇</ci><ci id="A2.1.p1.4.m2.4.5.2.2.2.cmml" xref="A2.1.p1.4.m2.4.5.2.2.2">𝑔</ci></apply><ci id="A2.1.p1.4.m2.1.1.cmml" xref="A2.1.p1.4.m2.1.1">𝐱</ci></apply><vector id="A2.1.p1.4.m2.4.5.3.1.cmml" xref="A2.1.p1.4.m2.4.5.3.2"><cn type="integer" id="A2.1.p1.4.m2.2.2.cmml" xref="A2.1.p1.4.m2.2.2">1</cn><ci id="A2.1.p1.4.m2.3.3.cmml" xref="A2.1.p1.4.m2.3.3">…</ci><cn type="integer" id="A2.1.p1.4.m2.4.4.cmml" xref="A2.1.p1.4.m2.4.4">1</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.4.m2.4c">\nabla g(\mathbf{x})=(1,...,1)</annotation></semantics></math>, the optimal solution <math id="A2.1.p1.5.m3.1" class="ltx_Math" alttext="\mathbf{x}^{*}" display="inline"><semantics id="A2.1.p1.5.m3.1a"><msup id="A2.1.p1.5.m3.1.1" xref="A2.1.p1.5.m3.1.1.cmml"><mi id="A2.1.p1.5.m3.1.1.2" xref="A2.1.p1.5.m3.1.1.2.cmml">𝐱</mi><mo id="A2.1.p1.5.m3.1.1.3" xref="A2.1.p1.5.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A2.1.p1.5.m3.1b"><apply id="A2.1.p1.5.m3.1.1.cmml" xref="A2.1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A2.1.p1.5.m3.1.1.1.cmml" xref="A2.1.p1.5.m3.1.1">superscript</csymbol><ci id="A2.1.p1.5.m3.1.1.2.cmml" xref="A2.1.p1.5.m3.1.1.2">𝐱</ci><times id="A2.1.p1.5.m3.1.1.3.cmml" xref="A2.1.p1.5.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.5.m3.1c">\mathbf{x}^{*}</annotation></semantics></math> is an uniform distribution such that</p>
</div>
<div id="A2.2.p2" class="ltx_para">
<table id="A2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E8.m1.3" class="ltx_Math" alttext="\mathbf{x}^{*}=(1+\frac{1}{\lambda},...,1+\frac{1}{\lambda})" display="block"><semantics id="A2.E8.m1.3a"><mrow id="A2.E8.m1.3.3" xref="A2.E8.m1.3.3.cmml"><msup id="A2.E8.m1.3.3.4" xref="A2.E8.m1.3.3.4.cmml"><mi id="A2.E8.m1.3.3.4.2" xref="A2.E8.m1.3.3.4.2.cmml">𝐱</mi><mo id="A2.E8.m1.3.3.4.3" xref="A2.E8.m1.3.3.4.3.cmml">∗</mo></msup><mo id="A2.E8.m1.3.3.3" xref="A2.E8.m1.3.3.3.cmml">=</mo><mrow id="A2.E8.m1.3.3.2.2" xref="A2.E8.m1.3.3.2.3.cmml"><mo stretchy="false" id="A2.E8.m1.3.3.2.2.3" xref="A2.E8.m1.3.3.2.3.cmml">(</mo><mrow id="A2.E8.m1.2.2.1.1.1" xref="A2.E8.m1.2.2.1.1.1.cmml"><mn id="A2.E8.m1.2.2.1.1.1.2" xref="A2.E8.m1.2.2.1.1.1.2.cmml">1</mn><mo id="A2.E8.m1.2.2.1.1.1.1" xref="A2.E8.m1.2.2.1.1.1.1.cmml">+</mo><mfrac id="A2.E8.m1.2.2.1.1.1.3" xref="A2.E8.m1.2.2.1.1.1.3.cmml"><mn id="A2.E8.m1.2.2.1.1.1.3.2" xref="A2.E8.m1.2.2.1.1.1.3.2.cmml">1</mn><mi id="A2.E8.m1.2.2.1.1.1.3.3" xref="A2.E8.m1.2.2.1.1.1.3.3.cmml">λ</mi></mfrac></mrow><mo id="A2.E8.m1.3.3.2.2.4" xref="A2.E8.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A2.E8.m1.1.1" xref="A2.E8.m1.1.1.cmml">…</mi><mo id="A2.E8.m1.3.3.2.2.5" xref="A2.E8.m1.3.3.2.3.cmml">,</mo><mrow id="A2.E8.m1.3.3.2.2.2" xref="A2.E8.m1.3.3.2.2.2.cmml"><mn id="A2.E8.m1.3.3.2.2.2.2" xref="A2.E8.m1.3.3.2.2.2.2.cmml">1</mn><mo id="A2.E8.m1.3.3.2.2.2.1" xref="A2.E8.m1.3.3.2.2.2.1.cmml">+</mo><mfrac id="A2.E8.m1.3.3.2.2.2.3" xref="A2.E8.m1.3.3.2.2.2.3.cmml"><mn id="A2.E8.m1.3.3.2.2.2.3.2" xref="A2.E8.m1.3.3.2.2.2.3.2.cmml">1</mn><mi id="A2.E8.m1.3.3.2.2.2.3.3" xref="A2.E8.m1.3.3.2.2.2.3.3.cmml">λ</mi></mfrac></mrow><mo stretchy="false" id="A2.E8.m1.3.3.2.2.6" xref="A2.E8.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E8.m1.3b"><apply id="A2.E8.m1.3.3.cmml" xref="A2.E8.m1.3.3"><eq id="A2.E8.m1.3.3.3.cmml" xref="A2.E8.m1.3.3.3"></eq><apply id="A2.E8.m1.3.3.4.cmml" xref="A2.E8.m1.3.3.4"><csymbol cd="ambiguous" id="A2.E8.m1.3.3.4.1.cmml" xref="A2.E8.m1.3.3.4">superscript</csymbol><ci id="A2.E8.m1.3.3.4.2.cmml" xref="A2.E8.m1.3.3.4.2">𝐱</ci><times id="A2.E8.m1.3.3.4.3.cmml" xref="A2.E8.m1.3.3.4.3"></times></apply><vector id="A2.E8.m1.3.3.2.3.cmml" xref="A2.E8.m1.3.3.2.2"><apply id="A2.E8.m1.2.2.1.1.1.cmml" xref="A2.E8.m1.2.2.1.1.1"><plus id="A2.E8.m1.2.2.1.1.1.1.cmml" xref="A2.E8.m1.2.2.1.1.1.1"></plus><cn type="integer" id="A2.E8.m1.2.2.1.1.1.2.cmml" xref="A2.E8.m1.2.2.1.1.1.2">1</cn><apply id="A2.E8.m1.2.2.1.1.1.3.cmml" xref="A2.E8.m1.2.2.1.1.1.3"><divide id="A2.E8.m1.2.2.1.1.1.3.1.cmml" xref="A2.E8.m1.2.2.1.1.1.3"></divide><cn type="integer" id="A2.E8.m1.2.2.1.1.1.3.2.cmml" xref="A2.E8.m1.2.2.1.1.1.3.2">1</cn><ci id="A2.E8.m1.2.2.1.1.1.3.3.cmml" xref="A2.E8.m1.2.2.1.1.1.3.3">𝜆</ci></apply></apply><ci id="A2.E8.m1.1.1.cmml" xref="A2.E8.m1.1.1">…</ci><apply id="A2.E8.m1.3.3.2.2.2.cmml" xref="A2.E8.m1.3.3.2.2.2"><plus id="A2.E8.m1.3.3.2.2.2.1.cmml" xref="A2.E8.m1.3.3.2.2.2.1"></plus><cn type="integer" id="A2.E8.m1.3.3.2.2.2.2.cmml" xref="A2.E8.m1.3.3.2.2.2.2">1</cn><apply id="A2.E8.m1.3.3.2.2.2.3.cmml" xref="A2.E8.m1.3.3.2.2.2.3"><divide id="A2.E8.m1.3.3.2.2.2.3.1.cmml" xref="A2.E8.m1.3.3.2.2.2.3"></divide><cn type="integer" id="A2.E8.m1.3.3.2.2.2.3.2.cmml" xref="A2.E8.m1.3.3.2.2.2.3.2">1</cn><ci id="A2.E8.m1.3.3.2.2.2.3.3.cmml" xref="A2.E8.m1.3.3.2.2.2.3.3">𝜆</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E8.m1.3c">\mathbf{x}^{*}=(1+\frac{1}{\lambda},...,1+\frac{1}{\lambda})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="A2.2.p2.3" class="ltx_p">where <math id="A2.2.p2.1.m1.1" class="ltx_Math" alttext="\lambda\neq 0" display="inline"><semantics id="A2.2.p2.1.m1.1a"><mrow id="A2.2.p2.1.m1.1.1" xref="A2.2.p2.1.m1.1.1.cmml"><mi id="A2.2.p2.1.m1.1.1.2" xref="A2.2.p2.1.m1.1.1.2.cmml">λ</mi><mo id="A2.2.p2.1.m1.1.1.1" xref="A2.2.p2.1.m1.1.1.1.cmml">≠</mo><mn id="A2.2.p2.1.m1.1.1.3" xref="A2.2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.2.p2.1.m1.1b"><apply id="A2.2.p2.1.m1.1.1.cmml" xref="A2.2.p2.1.m1.1.1"><neq id="A2.2.p2.1.m1.1.1.1.cmml" xref="A2.2.p2.1.m1.1.1.1"></neq><ci id="A2.2.p2.1.m1.1.1.2.cmml" xref="A2.2.p2.1.m1.1.1.2">𝜆</ci><cn type="integer" id="A2.2.p2.1.m1.1.1.3.cmml" xref="A2.2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.2.p2.1.m1.1c">\lambda\neq 0</annotation></semantics></math>.
Then, we get <math id="A2.2.p2.2.m2.1" class="ltx_Math" alttext="\lambda=\frac{K}{1-K}" display="inline"><semantics id="A2.2.p2.2.m2.1a"><mrow id="A2.2.p2.2.m2.1.1" xref="A2.2.p2.2.m2.1.1.cmml"><mi id="A2.2.p2.2.m2.1.1.2" xref="A2.2.p2.2.m2.1.1.2.cmml">λ</mi><mo id="A2.2.p2.2.m2.1.1.1" xref="A2.2.p2.2.m2.1.1.1.cmml">=</mo><mfrac id="A2.2.p2.2.m2.1.1.3" xref="A2.2.p2.2.m2.1.1.3.cmml"><mi id="A2.2.p2.2.m2.1.1.3.2" xref="A2.2.p2.2.m2.1.1.3.2.cmml">K</mi><mrow id="A2.2.p2.2.m2.1.1.3.3" xref="A2.2.p2.2.m2.1.1.3.3.cmml"><mn id="A2.2.p2.2.m2.1.1.3.3.2" xref="A2.2.p2.2.m2.1.1.3.3.2.cmml">1</mn><mo id="A2.2.p2.2.m2.1.1.3.3.1" xref="A2.2.p2.2.m2.1.1.3.3.1.cmml">−</mo><mi id="A2.2.p2.2.m2.1.1.3.3.3" xref="A2.2.p2.2.m2.1.1.3.3.3.cmml">K</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.2.p2.2.m2.1b"><apply id="A2.2.p2.2.m2.1.1.cmml" xref="A2.2.p2.2.m2.1.1"><eq id="A2.2.p2.2.m2.1.1.1.cmml" xref="A2.2.p2.2.m2.1.1.1"></eq><ci id="A2.2.p2.2.m2.1.1.2.cmml" xref="A2.2.p2.2.m2.1.1.2">𝜆</ci><apply id="A2.2.p2.2.m2.1.1.3.cmml" xref="A2.2.p2.2.m2.1.1.3"><divide id="A2.2.p2.2.m2.1.1.3.1.cmml" xref="A2.2.p2.2.m2.1.1.3"></divide><ci id="A2.2.p2.2.m2.1.1.3.2.cmml" xref="A2.2.p2.2.m2.1.1.3.2">𝐾</ci><apply id="A2.2.p2.2.m2.1.1.3.3.cmml" xref="A2.2.p2.2.m2.1.1.3.3"><minus id="A2.2.p2.2.m2.1.1.3.3.1.cmml" xref="A2.2.p2.2.m2.1.1.3.3.1"></minus><cn type="integer" id="A2.2.p2.2.m2.1.1.3.3.2.cmml" xref="A2.2.p2.2.m2.1.1.3.3.2">1</cn><ci id="A2.2.p2.2.m2.1.1.3.3.3.cmml" xref="A2.2.p2.2.m2.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.2.p2.2.m2.1c">\lambda=\frac{K}{1-K}</annotation></semantics></math> and <math id="A2.2.p2.3.m3.3" class="ltx_Math" alttext="\mathbf{x}^{*}=(\frac{1}{K},...,\frac{1}{K})" display="inline"><semantics id="A2.2.p2.3.m3.3a"><mrow id="A2.2.p2.3.m3.3.4" xref="A2.2.p2.3.m3.3.4.cmml"><msup id="A2.2.p2.3.m3.3.4.2" xref="A2.2.p2.3.m3.3.4.2.cmml"><mi id="A2.2.p2.3.m3.3.4.2.2" xref="A2.2.p2.3.m3.3.4.2.2.cmml">𝐱</mi><mo id="A2.2.p2.3.m3.3.4.2.3" xref="A2.2.p2.3.m3.3.4.2.3.cmml">∗</mo></msup><mo id="A2.2.p2.3.m3.3.4.1" xref="A2.2.p2.3.m3.3.4.1.cmml">=</mo><mrow id="A2.2.p2.3.m3.3.4.3.2" xref="A2.2.p2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="A2.2.p2.3.m3.3.4.3.2.1" xref="A2.2.p2.3.m3.3.4.3.1.cmml">(</mo><mfrac id="A2.2.p2.3.m3.1.1" xref="A2.2.p2.3.m3.1.1.cmml"><mn id="A2.2.p2.3.m3.1.1.2" xref="A2.2.p2.3.m3.1.1.2.cmml">1</mn><mi id="A2.2.p2.3.m3.1.1.3" xref="A2.2.p2.3.m3.1.1.3.cmml">K</mi></mfrac><mo id="A2.2.p2.3.m3.3.4.3.2.2" xref="A2.2.p2.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.2.p2.3.m3.2.2" xref="A2.2.p2.3.m3.2.2.cmml">…</mi><mo id="A2.2.p2.3.m3.3.4.3.2.3" xref="A2.2.p2.3.m3.3.4.3.1.cmml">,</mo><mfrac id="A2.2.p2.3.m3.3.3" xref="A2.2.p2.3.m3.3.3.cmml"><mn id="A2.2.p2.3.m3.3.3.2" xref="A2.2.p2.3.m3.3.3.2.cmml">1</mn><mi id="A2.2.p2.3.m3.3.3.3" xref="A2.2.p2.3.m3.3.3.3.cmml">K</mi></mfrac><mo stretchy="false" id="A2.2.p2.3.m3.3.4.3.2.4" xref="A2.2.p2.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.2.p2.3.m3.3b"><apply id="A2.2.p2.3.m3.3.4.cmml" xref="A2.2.p2.3.m3.3.4"><eq id="A2.2.p2.3.m3.3.4.1.cmml" xref="A2.2.p2.3.m3.3.4.1"></eq><apply id="A2.2.p2.3.m3.3.4.2.cmml" xref="A2.2.p2.3.m3.3.4.2"><csymbol cd="ambiguous" id="A2.2.p2.3.m3.3.4.2.1.cmml" xref="A2.2.p2.3.m3.3.4.2">superscript</csymbol><ci id="A2.2.p2.3.m3.3.4.2.2.cmml" xref="A2.2.p2.3.m3.3.4.2.2">𝐱</ci><times id="A2.2.p2.3.m3.3.4.2.3.cmml" xref="A2.2.p2.3.m3.3.4.2.3"></times></apply><vector id="A2.2.p2.3.m3.3.4.3.1.cmml" xref="A2.2.p2.3.m3.3.4.3.2"><apply id="A2.2.p2.3.m3.1.1.cmml" xref="A2.2.p2.3.m3.1.1"><divide id="A2.2.p2.3.m3.1.1.1.cmml" xref="A2.2.p2.3.m3.1.1"></divide><cn type="integer" id="A2.2.p2.3.m3.1.1.2.cmml" xref="A2.2.p2.3.m3.1.1.2">1</cn><ci id="A2.2.p2.3.m3.1.1.3.cmml" xref="A2.2.p2.3.m3.1.1.3">𝐾</ci></apply><ci id="A2.2.p2.3.m3.2.2.cmml" xref="A2.2.p2.3.m3.2.2">…</ci><apply id="A2.2.p2.3.m3.3.3.cmml" xref="A2.2.p2.3.m3.3.3"><divide id="A2.2.p2.3.m3.3.3.1.cmml" xref="A2.2.p2.3.m3.3.3"></divide><cn type="integer" id="A2.2.p2.3.m3.3.3.2.cmml" xref="A2.2.p2.3.m3.3.3.2">1</cn><ci id="A2.2.p2.3.m3.3.3.3.cmml" xref="A2.2.p2.3.m3.3.3.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.2.p2.3.m3.3c">\mathbf{x}^{*}=(\frac{1}{K},...,\frac{1}{K})</annotation></semantics></math> to satisfy Eq (<a href="#A2.E7" title="In Proof. ‣ Appendix B B. Optimality for Regularization of Attention Networks ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).
∎</p>
</div>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">Thus, our regularization makes a VQA model have the uniform attention weight distribution on abnormal samples.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>C. Additional Experimental Results</h2>

<section id="A3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Experimental Setup</h3>

<div id="A3.SSx1.p1" class="ltx_para">
<p id="A3.SSx1.p1.1" class="ltx_p"><math id="A3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="K=36" display="inline"><semantics id="A3.SSx1.p1.1.m1.1a"><mrow id="A3.SSx1.p1.1.m1.1.1" xref="A3.SSx1.p1.1.m1.1.1.cmml"><mi id="A3.SSx1.p1.1.m1.1.1.2" xref="A3.SSx1.p1.1.m1.1.1.2.cmml">K</mi><mo id="A3.SSx1.p1.1.m1.1.1.1" xref="A3.SSx1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SSx1.p1.1.m1.1.1.3" xref="A3.SSx1.p1.1.m1.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SSx1.p1.1.m1.1b"><apply id="A3.SSx1.p1.1.m1.1.1.cmml" xref="A3.SSx1.p1.1.m1.1.1"><eq id="A3.SSx1.p1.1.m1.1.1.1.cmml" xref="A3.SSx1.p1.1.m1.1.1.1"></eq><ci id="A3.SSx1.p1.1.m1.1.1.2.cmml" xref="A3.SSx1.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="A3.SSx1.p1.1.m1.1.1.3.cmml" xref="A3.SSx1.p1.1.m1.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SSx1.p1.1.m1.1c">K=36</annotation></semantics></math> objects are detected by pretrained faster R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib31" title="" class="ltx_ref">2015</a>)</cite>, and a 2048 dimensional vector for each object is extracted by pretrained ResNet-152 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite>.
Question tokens are trimmed to a maximum of 14 words, and pretrained GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib28" title="" class="ltx_ref">2014</a>)</cite> is used for word embedding.
The batch size is 256.
For BAN, the dimension of fully connected layer is 1280, and, the size of glimpse is two.
Other models use 1024 dimensional vector for the fully connected layer.
The initial learning rate is 0.002 and all trainable parameters are updated by Adamax optimizer in Pytorch.
The parameters are updated in 30 epochs, and we use the best model to evaluate the robustness of the model to various anomalies.
We use two V100 GPUs for training VQA models with pretrained features, and the training is finished in 4 hours.
Other hyperparameters are the same as those in the original paper for each model.</p>
</div>
<div id="A3.SSx1.p2" class="ltx_para">
<p id="A3.SSx1.p2.2" class="ltx_p">For the regularization of the attention network, we use training samples of TinyImage, VNQ, and QRPE for <math id="A3.SSx1.p2.1.m1.1" class="ltx_Math" alttext="P_{\text{anomaly}}" display="inline"><semantics id="A3.SSx1.p2.1.m1.1a"><msub id="A3.SSx1.p2.1.m1.1.1" xref="A3.SSx1.p2.1.m1.1.1.cmml"><mi id="A3.SSx1.p2.1.m1.1.1.2" xref="A3.SSx1.p2.1.m1.1.1.2.cmml">P</mi><mtext id="A3.SSx1.p2.1.m1.1.1.3" xref="A3.SSx1.p2.1.m1.1.1.3a.cmml">anomaly</mtext></msub><annotation-xml encoding="MathML-Content" id="A3.SSx1.p2.1.m1.1b"><apply id="A3.SSx1.p2.1.m1.1.1.cmml" xref="A3.SSx1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SSx1.p2.1.m1.1.1.1.cmml" xref="A3.SSx1.p2.1.m1.1.1">subscript</csymbol><ci id="A3.SSx1.p2.1.m1.1.1.2.cmml" xref="A3.SSx1.p2.1.m1.1.1.2">𝑃</ci><ci id="A3.SSx1.p2.1.m1.1.1.3a.cmml" xref="A3.SSx1.p2.1.m1.1.1.3"><mtext mathsize="70%" id="A3.SSx1.p2.1.m1.1.1.3.cmml" xref="A3.SSx1.p2.1.m1.1.1.3">anomaly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SSx1.p2.1.m1.1c">P_{\text{anomaly}}</annotation></semantics></math> in Eq (5).
Each mini-batch for regularization consists of balanced samples, which equally contain TinyImage, VQA, and QRPE samples.
In addition, Note that there is no overlap of anomaly data between data for training and evaluation.
We fine-tune the pretrained VQA models in 15 epochs, and the <math id="A3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A3.SSx1.p2.2.m2.1a"><mi id="A3.SSx1.p2.2.m2.1.1" xref="A3.SSx1.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A3.SSx1.p2.2.m2.1b"><ci id="A3.SSx1.p2.2.m2.1.1.cmml" xref="A3.SSx1.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SSx1.p2.2.m2.1c">\lambda</annotation></semantics></math> in Eq (5) is set to 0.00001.</p>
</div>
<div id="A3.SSx1.p3" class="ltx_para">
<p id="A3.SSx1.p3.1" class="ltx_p">To compute the maximum attention score, we average the maximum attention scores of all heads in the attention network to consider all information in the multiple attention heads.
Some VQA models, such as MCAN, have multiple layers, and each layer has an attention module to extract hidden features for the input of the following layer.
Then, we use the first attention layer because it focuses on the most relevant information and filters out irrelevant information in a pair of images and questions, and the later layers repeatedly elaborate on the hidden features of the image and question.
All codes are implemented using Pytorch 0.4.1 and are available in public.</p>
</div>
</section>
<section id="A3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Results of Task 3: Out-of-distribution Image and Question</h3>

<div id="A3.SSx2.p1" class="ltx_para">
<p id="A3.SSx2.p1.1" class="ltx_p">The experimental results of task 3 (out-of-distribution image and question) is in Table <a href="#A3.T7" title="Table 7 ‣ Results of Task 3: Out-of-distribution Image and Question ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
All combinations of out-of-distribution images (MNIST, SVHN, FashionMNIST, CIFAR10, and TinyImageNet) and questions (20 Newsgroup, Reuter52, and IMDB) are considered in task 3.
This situation when both image and question are from out-of-distribution is an extreme case, but we contain task 3 to evaluate the robustness of VQA models on the extreme case that is expected to be detected more easily.</p>
</div>
<div id="A3.SSx2.p2" class="ltx_para">
<p id="A3.SSx2.p2.1" class="ltx_p">The results show that the attention-based approach and our regularization outperform compared methods.
For all VQA models and datasets, attention-based approach shows almost perfect detection of out-of-distribution samples.
When we consider that task 3 is rather extreme and easy than task 1 and 2, the superior results are acceptable.</p>
</div>
<figure id="A3.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Task 3 performances: out-of-distribution image &amp; question detection AUROCs of VQA models.</figcaption>
<table id="A3.T7.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T7.1.1.1" class="ltx_tr">
<td id="A3.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">AUROC</td>
<td id="A3.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">BUTD</td>
<td id="A3.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MHB+ATT</td>
<td id="A3.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">BAN</td>
</tr>
<tr id="A3.T7.1.2.2" class="ltx_tr">
<td id="A3.T7.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">20 Newsgroup</td>
<td id="A3.T7.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A3.T7.1.3.3" class="ltx_tr">
<td id="A3.T7.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MNIST</td>
<td id="A3.T7.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.9/94.3/71.5/<span id="A3.T7.1.3.3.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.8/38.1/<span id="A3.T7.1.3.3.3.1" class="ltx_text ltx_font_bold">97.0</span>/96.9/96.7</td>
<td id="A3.T7.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">51.9/52.5/57.1/99.9/<span id="A3.T7.1.3.3.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.4.4" class="ltx_tr">
<td id="A3.T7.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r">SVHN</td>
<td id="A3.T7.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">77.6/94.0/70.5/99.9/<span id="A3.T7.1.4.4.2.1" class="ltx_text ltx_font_bold">99.9</span>
</td>
<td id="A3.T7.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">49.8/38.1/96.8/<span id="A3.T7.1.4.4.3.1" class="ltx_text ltx_font_bold">97.2</span>/96.3</td>
<td id="A3.T7.1.4.4.4" class="ltx_td ltx_align_center">51.8/52.1/56.1/99.8/<span id="A3.T7.1.4.4.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.5.5" class="ltx_tr">
<td id="A3.T7.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r">FashionMNIST</td>
<td id="A3.T7.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">77.8/94.4/71.8/<span id="A3.T7.1.5.5.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">49.7/38.0/<span id="A3.T7.1.5.5.3.1" class="ltx_text ltx_font_bold">97.3</span>/97.1/97.2</td>
<td id="A3.T7.1.5.5.4" class="ltx_td ltx_align_center">51.9/52.4/57.5/99.9/<span id="A3.T7.1.5.5.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.6.6" class="ltx_tr">
<td id="A3.T7.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r">CIFAR10</td>
<td id="A3.T7.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r">77.9/94.1/69.4/99.9/<span id="A3.T7.1.6.6.2.1" class="ltx_text ltx_font_bold">99.9</span>
</td>
<td id="A3.T7.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">49.7/38.2/96.4/<span id="A3.T7.1.6.6.3.1" class="ltx_text ltx_font_bold">97.0</span>/95.6</td>
<td id="A3.T7.1.6.6.4" class="ltx_td ltx_align_center">51.7/52.2/54.9/99.8/<span id="A3.T7.1.6.6.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.7.7" class="ltx_tr">
<td id="A3.T7.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r">TinyImageNet</td>
<td id="A3.T7.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">76.6/93.3/73.8/100/<span id="A3.T7.1.7.7.2.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="A3.T7.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">49.5/37.6/96.9/<span id="A3.T7.1.7.7.3.1" class="ltx_text ltx_font_bold">97.6</span>/95.6</td>
<td id="A3.T7.1.7.7.4" class="ltx_td ltx_align_center">51.9/52.0/61.8/100/<span id="A3.T7.1.7.7.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.8.8" class="ltx_tr">
<td id="A3.T7.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Reuters52</td>
<td id="A3.T7.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A3.T7.1.9.9" class="ltx_tr">
<td id="A3.T7.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MNIST</td>
<td id="A3.T7.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.5/95.8/73.6/99.8/<span id="A3.T7.1.9.9.2.1" class="ltx_text ltx_font_bold">99.9</span>
</td>
<td id="A3.T7.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.3/33.8/<span id="A3.T7.1.9.9.3.1" class="ltx_text ltx_font_bold">97.7</span>/96.6/97.3</td>
<td id="A3.T7.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">51.4/52.8/56.5/99.9/<span id="A3.T7.1.9.9.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.10.10" class="ltx_tr">
<td id="A3.T7.1.10.10.1" class="ltx_td ltx_align_left ltx_border_r">SVHN</td>
<td id="A3.T7.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r">81.2/95.5/73.0/<span id="A3.T7.1.10.10.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">47.3/33.8/<span id="A3.T7.1.10.10.3.1" class="ltx_text ltx_font_bold">97.5</span>/96.8/97.0</td>
<td id="A3.T7.1.10.10.4" class="ltx_td ltx_align_center">51.4/52.6/56.0/99.8/<span id="A3.T7.1.10.10.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.11.11" class="ltx_tr">
<td id="A3.T7.1.11.11.1" class="ltx_td ltx_align_left ltx_border_r">FashionMNIST</td>
<td id="A3.T7.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r">81.4/95.8/73.9/<span id="A3.T7.1.11.11.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r">47.3/33.8/<span id="A3.T7.1.11.11.3.1" class="ltx_text ltx_font_bold">98.0</span>/96.8/97.7</td>
<td id="A3.T7.1.11.11.4" class="ltx_td ltx_align_center">51.5/52.9/57.2/99.9/<span id="A3.T7.1.11.11.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.12.12" class="ltx_tr">
<td id="A3.T7.1.12.12.1" class="ltx_td ltx_align_left ltx_border_r">CIFAR10</td>
<td id="A3.T7.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r">81.6/95.7/72.2/<span id="A3.T7.1.12.12.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r">47.4/34.2/<span id="A3.T7.1.12.12.3.1" class="ltx_text ltx_font_bold">97.3</span>/96.6/96.4</td>
<td id="A3.T7.1.12.12.4" class="ltx_td ltx_align_center">51.3/52.5/54.5/99.8/<span id="A3.T7.1.12.12.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.13.13" class="ltx_tr">
<td id="A3.T7.1.13.13.1" class="ltx_td ltx_align_left ltx_border_r">TinyImageNet</td>
<td id="A3.T7.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r">80.0/94.8/75.2/100/<span id="A3.T7.1.13.13.2.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="A3.T7.1.13.13.3" class="ltx_td ltx_align_center ltx_border_r">47.1/33.5/97.7/97.3/<span id="A3.T7.1.13.13.3.1" class="ltx_text ltx_font_bold">98.9</span>
</td>
<td id="A3.T7.1.13.13.4" class="ltx_td ltx_align_center">51.4/52.3/61.5/100/<span id="A3.T7.1.13.13.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.14.14" class="ltx_tr">
<td id="A3.T7.1.14.14.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">IMDB</td>
<td id="A3.T7.1.14.14.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A3.T7.1.15.15" class="ltx_tr">
<td id="A3.T7.1.15.15.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MNIST</td>
<td id="A3.T7.1.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.7/92.9/69.7/<span id="A3.T7.1.15.15.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.4/30.9/96.1/<span id="A3.T7.1.15.15.3.1" class="ltx_text ltx_font_bold">97.1</span>/96.6</td>
<td id="A3.T7.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t">44.1/40.2/57.6/99.7/<span id="A3.T7.1.15.15.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.16.16" class="ltx_tr">
<td id="A3.T7.1.16.16.1" class="ltx_td ltx_align_left ltx_border_r">SVHN</td>
<td id="A3.T7.1.16.16.2" class="ltx_td ltx_align_center ltx_border_r">73.5/92.5/68.4/<span id="A3.T7.1.16.16.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.16.16.3" class="ltx_td ltx_align_center ltx_border_r">44.3/30.8/95.9/<span id="A3.T7.1.16.16.3.1" class="ltx_text ltx_font_bold">97.4</span>/96.2</td>
<td id="A3.T7.1.16.16.4" class="ltx_td ltx_align_center">44.0/40.0/57.2/99.8/<span id="A3.T7.1.16.16.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.17.17" class="ltx_tr">
<td id="A3.T7.1.17.17.1" class="ltx_td ltx_align_left ltx_border_r">FashionMNIST</td>
<td id="A3.T7.1.17.17.2" class="ltx_td ltx_align_center ltx_border_r">73.7/93.0/70.2/<span id="A3.T7.1.17.17.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.17.17.3" class="ltx_td ltx_align_center ltx_border_r">44.2/30.7/96.5/<span id="A3.T7.1.17.17.3.1" class="ltx_text ltx_font_bold">97.2</span>/95.4</td>
<td id="A3.T7.1.17.17.4" class="ltx_td ltx_align_center">43.9/39.8/55.7/99.7/<span id="A3.T7.1.17.17.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.18.18" class="ltx_tr">
<td id="A3.T7.1.18.18.1" class="ltx_td ltx_align_left ltx_border_r">CIFAR10</td>
<td id="A3.T7.1.18.18.2" class="ltx_td ltx_align_center ltx_border_r">73.8/92.7/67.3/<span id="A3.T7.1.18.18.2.1" class="ltx_text ltx_font_bold">100</span>/99.9</td>
<td id="A3.T7.1.18.18.3" class="ltx_td ltx_align_center ltx_border_r">44.4/31.0/95.5/<span id="A3.T7.1.18.18.3.1" class="ltx_text ltx_font_bold">97.3</span>/95.4</td>
<td id="A3.T7.1.18.18.4" class="ltx_td ltx_align_center">43.9/39.8/55.7/99.7/<span id="A3.T7.1.18.18.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T7.1.19.19" class="ltx_tr">
<td id="A3.T7.1.19.19.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">TinyImageNet</td>
<td id="A3.T7.1.19.19.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">72.2/91.5/72.4/100/<span id="A3.T7.1.19.19.2.1" class="ltx_text ltx_font_bold">100</span>
</td>
<td id="A3.T7.1.19.19.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">43.9/30.3/96.0/97.7/<span id="A3.T7.1.19.19.3.1" class="ltx_text ltx_font_bold">98.8</span>
</td>
<td id="A3.T7.1.19.19.4" class="ltx_td ltx_align_center ltx_border_b">44.1/39.7/62.3/100/<span id="A3.T7.1.19.19.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Comparison with Minimization of Attention Variance</h3>

<div id="A3.SSx3.p1" class="ltx_para">
<p id="A3.SSx3.p1.1" class="ltx_p">Another alternative to make an attention weight uniform is minimization of variance of attention distribution.
When the variance of attention weights is minimized, the variance is zero and the all attention weights are same.</p>
</div>
<div id="A3.SSx3.p2" class="ltx_para">
<p id="A3.SSx3.p2.1" class="ltx_p">In Table <a href="#A3.T8" title="Table 8 ‣ Comparison with Minimization of Attention Variance ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we find that minimizing the variance of attention networks (RA-VAR) induces more degradation of VQA accuracy than maximization of our regularization <math id="A3.SSx3.p2.1.m1.2" class="ltx_Math" alttext="\sum_{i=1}^{K}\sum_{j=1}^{M}\log(1-A_{ij})" display="inline"><semantics id="A3.SSx3.p2.1.m1.2a"><mrow id="A3.SSx3.p2.1.m1.2.2" xref="A3.SSx3.p2.1.m1.2.2.cmml"><msubsup id="A3.SSx3.p2.1.m1.2.2.2" xref="A3.SSx3.p2.1.m1.2.2.2.cmml"><mo id="A3.SSx3.p2.1.m1.2.2.2.2.2" xref="A3.SSx3.p2.1.m1.2.2.2.2.2.cmml">∑</mo><mrow id="A3.SSx3.p2.1.m1.2.2.2.2.3" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.cmml"><mi id="A3.SSx3.p2.1.m1.2.2.2.2.3.2" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.2.cmml">i</mi><mo id="A3.SSx3.p2.1.m1.2.2.2.2.3.1" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.1.cmml">=</mo><mn id="A3.SSx3.p2.1.m1.2.2.2.2.3.3" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="A3.SSx3.p2.1.m1.2.2.2.3" xref="A3.SSx3.p2.1.m1.2.2.2.3.cmml">K</mi></msubsup><mrow id="A3.SSx3.p2.1.m1.2.2.1" xref="A3.SSx3.p2.1.m1.2.2.1.cmml"><msubsup id="A3.SSx3.p2.1.m1.2.2.1.2" xref="A3.SSx3.p2.1.m1.2.2.1.2.cmml"><mo lspace="0.167em" id="A3.SSx3.p2.1.m1.2.2.1.2.2.2" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="A3.SSx3.p2.1.m1.2.2.1.2.2.3" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.cmml"><mi id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.2" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.1" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.3" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A3.SSx3.p2.1.m1.2.2.1.2.3" xref="A3.SSx3.p2.1.m1.2.2.1.2.3.cmml">M</mi></msubsup><mrow id="A3.SSx3.p2.1.m1.2.2.1.1.1" xref="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml"><mi id="A3.SSx3.p2.1.m1.1.1" xref="A3.SSx3.p2.1.m1.1.1.cmml">log</mi><mo id="A3.SSx3.p2.1.m1.2.2.1.1.1a" xref="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="A3.SSx3.p2.1.m1.2.2.1.1.1.1" xref="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.2" xref="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml">(</mo><mrow id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.cmml"><mn id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.2" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.1" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.2" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.2.cmml">A</mi><mrow id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.2" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.1" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.3" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.3" xref="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SSx3.p2.1.m1.2b"><apply id="A3.SSx3.p2.1.m1.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2"><apply id="A3.SSx3.p2.1.m1.2.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A3.SSx3.p2.1.m1.2.2.2.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.2">superscript</csymbol><apply id="A3.SSx3.p2.1.m1.2.2.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A3.SSx3.p2.1.m1.2.2.2.2.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.2">subscript</csymbol><sum id="A3.SSx3.p2.1.m1.2.2.2.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.2.2"></sum><apply id="A3.SSx3.p2.1.m1.2.2.2.2.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.2.3"><eq id="A3.SSx3.p2.1.m1.2.2.2.2.3.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.1"></eq><ci id="A3.SSx3.p2.1.m1.2.2.2.2.3.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="A3.SSx3.p2.1.m1.2.2.2.2.3.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.2.3.3">1</cn></apply></apply><ci id="A3.SSx3.p2.1.m1.2.2.2.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.2.3">𝐾</ci></apply><apply id="A3.SSx3.p2.1.m1.2.2.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1"><apply id="A3.SSx3.p2.1.m1.2.2.1.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.SSx3.p2.1.m1.2.2.1.2.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2">superscript</csymbol><apply id="A3.SSx3.p2.1.m1.2.2.1.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.SSx3.p2.1.m1.2.2.1.2.2.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2">subscript</csymbol><sum id="A3.SSx3.p2.1.m1.2.2.1.2.2.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.2"></sum><apply id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3"><eq id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.1"></eq><ci id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="A3.SSx3.p2.1.m1.2.2.1.2.2.3.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="A3.SSx3.p2.1.m1.2.2.1.2.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.2.3">𝑀</ci></apply><apply id="A3.SSx3.p2.1.m1.2.2.1.1.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1"><log id="A3.SSx3.p2.1.m1.1.1.cmml" xref="A3.SSx3.p2.1.m1.1.1"></log><apply id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1"><minus id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.1"></minus><cn type="integer" id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.2">1</cn><apply id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.2">𝐴</ci><apply id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3"><times id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.2">𝑖</ci><ci id="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="A3.SSx3.p2.1.m1.2.2.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SSx3.p2.1.m1.2c">\sum_{i=1}^{K}\sum_{j=1}^{M}\log(1-A_{ij})</annotation></semantics></math> (RA-LOG).
In this study, we prefer to use RA-LOG because anomaly detection in VQA is useless if the VQA accuracy does not conserved.</p>
</div>
<div id="A3.SSx3.p3" class="ltx_para">
<p id="A3.SSx3.p3.1" class="ltx_p">Although the accuracy drop, RA-VAR is also effective to detect various abnormal samples in test time (Table <a href="#A3.T7" title="Table 7 ‣ Results of Task 3: Out-of-distribution Image and Question ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).
The results imply that our assumption of attention networks appropriates for anomaly detection in VQA regardless of its implementation.</p>
</div>
<figure id="A3.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Degradation of accuracy by additional training for anomaly detection</figcaption>
<table id="A3.T8.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T8.1.1.1" class="ltx_tr">
<th id="A3.T8.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Accuracy (%)</th>
<th id="A3.T8.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Base</th>
<th id="A3.T8.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">OE</th>
<th id="A3.T8.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RA-VAR</th>
<th id="A3.T8.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">RA-LOG</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T8.1.2.1" class="ltx_tr">
<th id="A3.T8.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">BUTD</th>
<td id="A3.T8.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">62.55</td>
<td id="A3.T8.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">54.87(-7.68)</td>
<td id="A3.T8.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">61.56(-0.99)</td>
<td id="A3.T8.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">61.91(-0.64)</td>
</tr>
<tr id="A3.T8.1.3.2" class="ltx_tr">
<th id="A3.T8.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MHB+ATT</th>
<td id="A3.T8.1.3.2.2" class="ltx_td ltx_align_center">63.33</td>
<td id="A3.T8.1.3.2.3" class="ltx_td ltx_align_center">62.38(-0.95)</td>
<td id="A3.T8.1.3.2.4" class="ltx_td ltx_align_center">62.54(-0.79)</td>
<td id="A3.T8.1.3.2.5" class="ltx_td ltx_align_center">62.77(-0.56)</td>
</tr>
<tr id="A3.T8.1.4.3" class="ltx_tr">
<th id="A3.T8.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">BAN</th>
<td id="A3.T8.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b">63.81</td>
<td id="A3.T8.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b">61.92(-1.89)</td>
<td id="A3.T8.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b">63.37(-0.44)</td>
<td id="A3.T8.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b">63.74(-0.07)</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A3.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Comparison of regularization implementations. RA-VAR: minimization of variance of attention networks. RA-LOG: original implementation in the paper: maximization of <math id="A3.T9.2.m1.2" class="ltx_Math" alttext="\sum_{i=1}^{K}\sum_{j=1}^{M}\log(1-A_{ij})" display="inline"><semantics id="A3.T9.2.m1.2b"><mrow id="A3.T9.2.m1.2.2" xref="A3.T9.2.m1.2.2.cmml"><msubsup id="A3.T9.2.m1.2.2.2" xref="A3.T9.2.m1.2.2.2.cmml"><mo id="A3.T9.2.m1.2.2.2.2.2" xref="A3.T9.2.m1.2.2.2.2.2.cmml">∑</mo><mrow id="A3.T9.2.m1.2.2.2.2.3" xref="A3.T9.2.m1.2.2.2.2.3.cmml"><mi id="A3.T9.2.m1.2.2.2.2.3.2" xref="A3.T9.2.m1.2.2.2.2.3.2.cmml">i</mi><mo id="A3.T9.2.m1.2.2.2.2.3.1" xref="A3.T9.2.m1.2.2.2.2.3.1.cmml">=</mo><mn id="A3.T9.2.m1.2.2.2.2.3.3" xref="A3.T9.2.m1.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="A3.T9.2.m1.2.2.2.3" xref="A3.T9.2.m1.2.2.2.3.cmml">K</mi></msubsup><mrow id="A3.T9.2.m1.2.2.1" xref="A3.T9.2.m1.2.2.1.cmml"><msubsup id="A3.T9.2.m1.2.2.1.2" xref="A3.T9.2.m1.2.2.1.2.cmml"><mo lspace="0.167em" id="A3.T9.2.m1.2.2.1.2.2.2" xref="A3.T9.2.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="A3.T9.2.m1.2.2.1.2.2.3" xref="A3.T9.2.m1.2.2.1.2.2.3.cmml"><mi id="A3.T9.2.m1.2.2.1.2.2.3.2" xref="A3.T9.2.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="A3.T9.2.m1.2.2.1.2.2.3.1" xref="A3.T9.2.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="A3.T9.2.m1.2.2.1.2.2.3.3" xref="A3.T9.2.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A3.T9.2.m1.2.2.1.2.3" xref="A3.T9.2.m1.2.2.1.2.3.cmml">M</mi></msubsup><mrow id="A3.T9.2.m1.2.2.1.1.1" xref="A3.T9.2.m1.2.2.1.1.2.cmml"><mi id="A3.T9.2.m1.1.1" xref="A3.T9.2.m1.1.1.cmml">log</mi><mo id="A3.T9.2.m1.2.2.1.1.1b" xref="A3.T9.2.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="A3.T9.2.m1.2.2.1.1.1.1" xref="A3.T9.2.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="A3.T9.2.m1.2.2.1.1.1.1.2" xref="A3.T9.2.m1.2.2.1.1.2.cmml">(</mo><mrow id="A3.T9.2.m1.2.2.1.1.1.1.1" xref="A3.T9.2.m1.2.2.1.1.1.1.1.cmml"><mn id="A3.T9.2.m1.2.2.1.1.1.1.1.2" xref="A3.T9.2.m1.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="A3.T9.2.m1.2.2.1.1.1.1.1.1" xref="A3.T9.2.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="A3.T9.2.m1.2.2.1.1.1.1.1.3" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A3.T9.2.m1.2.2.1.1.1.1.1.3.2" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.2.cmml">A</mi><mrow id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.2" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.1" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.3" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="A3.T9.2.m1.2.2.1.1.1.1.3" xref="A3.T9.2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.2.m1.2c"><apply id="A3.T9.2.m1.2.2.cmml" xref="A3.T9.2.m1.2.2"><apply id="A3.T9.2.m1.2.2.2.cmml" xref="A3.T9.2.m1.2.2.2"><csymbol cd="ambiguous" id="A3.T9.2.m1.2.2.2.1.cmml" xref="A3.T9.2.m1.2.2.2">superscript</csymbol><apply id="A3.T9.2.m1.2.2.2.2.cmml" xref="A3.T9.2.m1.2.2.2"><csymbol cd="ambiguous" id="A3.T9.2.m1.2.2.2.2.1.cmml" xref="A3.T9.2.m1.2.2.2">subscript</csymbol><sum id="A3.T9.2.m1.2.2.2.2.2.cmml" xref="A3.T9.2.m1.2.2.2.2.2"></sum><apply id="A3.T9.2.m1.2.2.2.2.3.cmml" xref="A3.T9.2.m1.2.2.2.2.3"><eq id="A3.T9.2.m1.2.2.2.2.3.1.cmml" xref="A3.T9.2.m1.2.2.2.2.3.1"></eq><ci id="A3.T9.2.m1.2.2.2.2.3.2.cmml" xref="A3.T9.2.m1.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="A3.T9.2.m1.2.2.2.2.3.3.cmml" xref="A3.T9.2.m1.2.2.2.2.3.3">1</cn></apply></apply><ci id="A3.T9.2.m1.2.2.2.3.cmml" xref="A3.T9.2.m1.2.2.2.3">𝐾</ci></apply><apply id="A3.T9.2.m1.2.2.1.cmml" xref="A3.T9.2.m1.2.2.1"><apply id="A3.T9.2.m1.2.2.1.2.cmml" xref="A3.T9.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.T9.2.m1.2.2.1.2.1.cmml" xref="A3.T9.2.m1.2.2.1.2">superscript</csymbol><apply id="A3.T9.2.m1.2.2.1.2.2.cmml" xref="A3.T9.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="A3.T9.2.m1.2.2.1.2.2.1.cmml" xref="A3.T9.2.m1.2.2.1.2">subscript</csymbol><sum id="A3.T9.2.m1.2.2.1.2.2.2.cmml" xref="A3.T9.2.m1.2.2.1.2.2.2"></sum><apply id="A3.T9.2.m1.2.2.1.2.2.3.cmml" xref="A3.T9.2.m1.2.2.1.2.2.3"><eq id="A3.T9.2.m1.2.2.1.2.2.3.1.cmml" xref="A3.T9.2.m1.2.2.1.2.2.3.1"></eq><ci id="A3.T9.2.m1.2.2.1.2.2.3.2.cmml" xref="A3.T9.2.m1.2.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="A3.T9.2.m1.2.2.1.2.2.3.3.cmml" xref="A3.T9.2.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="A3.T9.2.m1.2.2.1.2.3.cmml" xref="A3.T9.2.m1.2.2.1.2.3">𝑀</ci></apply><apply id="A3.T9.2.m1.2.2.1.1.2.cmml" xref="A3.T9.2.m1.2.2.1.1.1"><log id="A3.T9.2.m1.1.1.cmml" xref="A3.T9.2.m1.1.1"></log><apply id="A3.T9.2.m1.2.2.1.1.1.1.1.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1"><minus id="A3.T9.2.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.1"></minus><cn type="integer" id="A3.T9.2.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.2">1</cn><apply id="A3.T9.2.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.T9.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.2">𝐴</ci><apply id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3"><times id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.2">𝑖</ci><ci id="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="A3.T9.2.m1.2.2.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.2.m1.2d">\sum_{i=1}^{K}\sum_{j=1}^{M}\log(1-A_{ij})</annotation></semantics></math></figcaption>
<div id="A3.T9.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:277.1pt;height:226.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.4pt,12.6pt) scale(0.9,0.9) ;">
<table id="A3.T9.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T9.3.1.1.1" class="ltx_tr">
<th id="A3.T9.3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AUROC</th>
<td id="A3.T9.3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">BUTD</td>
<td id="A3.T9.3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MHB+ATT</td>
<td id="A3.T9.3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">BAN</td>
</tr>
<tr id="A3.T9.3.1.2.2" class="ltx_tr">
<th id="A3.T9.3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Image</th>
<td id="A3.T9.3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MAP(T)/RA-VAR/RA-LOG</td>
</tr>
<tr id="A3.T9.3.1.3.3" class="ltx_tr">
<th id="A3.T9.3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">MNIST</th>
<td id="A3.T9.3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.0/97.4/<span id="A3.T9.3.1.3.3.2.1" class="ltx_text ltx_font_bold">97.8</span>
</td>
<td id="A3.T9.3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.9/93.2/<span id="A3.T9.3.1.3.3.3.1" class="ltx_text ltx_font_bold">94.7</span>
</td>
<td id="A3.T9.3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">99.0/92.2/<span id="A3.T9.3.1.3.3.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T9.3.1.4.4" class="ltx_tr">
<th id="A3.T9.3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SVHN</th>
<td id="A3.T9.3.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">90.3/97.5/<span id="A3.T9.3.1.4.4.2.1" class="ltx_text ltx_font_bold">97.9</span>
</td>
<td id="A3.T9.3.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">89.7/95.4/<span id="A3.T9.3.1.4.4.3.1" class="ltx_text ltx_font_bold">96.2</span>
</td>
<td id="A3.T9.3.1.4.4.4" class="ltx_td ltx_align_center">100/93.4/<span id="A3.T9.3.1.4.4.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T9.3.1.5.5" class="ltx_tr">
<th id="A3.T9.3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FashionMNIST</th>
<td id="A3.T9.3.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">89.6/97.4/<span id="A3.T9.3.1.5.5.2.1" class="ltx_text ltx_font_bold">97.8</span>
</td>
<td id="A3.T9.3.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">90.5/94.6/<span id="A3.T9.3.1.5.5.3.1" class="ltx_text ltx_font_bold">95.7</span>
</td>
<td id="A3.T9.3.1.5.5.4" class="ltx_td ltx_align_center">99.9/93.0/<span id="A3.T9.3.1.5.5.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T9.3.1.6.6" class="ltx_tr">
<th id="A3.T9.3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">CIFAR10</th>
<td id="A3.T9.3.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r">90.5/97.5/<span id="A3.T9.3.1.6.6.2.1" class="ltx_text ltx_font_bold">98.0</span>
</td>
<td id="A3.T9.3.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">89.9/96.3/<span id="A3.T9.3.1.6.6.3.1" class="ltx_text ltx_font_bold">96.9</span>
</td>
<td id="A3.T9.3.1.6.6.4" class="ltx_td ltx_align_center">100/94.1/<span id="A3.T9.3.1.6.6.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T9.3.1.7.7" class="ltx_tr">
<th id="A3.T9.3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">TinyImageNet</th>
<td id="A3.T9.3.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">92.7/98.5/<span id="A3.T9.3.1.7.7.2.1" class="ltx_text ltx_font_bold">99.7</span>
</td>
<td id="A3.T9.3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">91.5/99.1/<span id="A3.T9.3.1.7.7.3.1" class="ltx_text ltx_font_bold">99.2</span>
</td>
<td id="A3.T9.3.1.7.7.4" class="ltx_td ltx_align_center">100/96.0/<span id="A3.T9.3.1.7.7.4.1" class="ltx_text ltx_font_bold">100</span>
</td>
</tr>
<tr id="A3.T9.3.1.8.8" class="ltx_tr">
<th id="A3.T9.3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Question</th>
<td id="A3.T9.3.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MAP(T)/RA-VAR/RA-LOG</td>
</tr>
<tr id="A3.T9.3.1.9.9" class="ltx_tr">
<th id="A3.T9.3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">20 Newsgroup</th>
<td id="A3.T9.3.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.2/<span id="A3.T9.3.1.9.9.2.1" class="ltx_text ltx_font_bold">97.1</span>/95.5</td>
<td id="A3.T9.3.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.9/<span id="A3.T9.3.1.9.9.3.1" class="ltx_text ltx_font_bold">97.4</span>/92.6</td>
<td id="A3.T9.3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">81.7/<span id="A3.T9.3.1.9.9.4.1" class="ltx_text ltx_font_bold">93.2</span>/87.3</td>
</tr>
<tr id="A3.T9.3.1.10.10" class="ltx_tr">
<th id="A3.T9.3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Reuters52</th>
<td id="A3.T9.3.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r">76.4/<span id="A3.T9.3.1.10.10.2.1" class="ltx_text ltx_font_bold">97.7</span>/97.0</td>
<td id="A3.T9.3.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">77.4/<span id="A3.T9.3.1.10.10.3.1" class="ltx_text ltx_font_bold">98.6</span>/94.3</td>
<td id="A3.T9.3.1.10.10.4" class="ltx_td ltx_align_center">81.7/<span id="A3.T9.3.1.10.10.4.1" class="ltx_text ltx_font_bold">93.9</span>/87.3</td>
</tr>
<tr id="A3.T9.3.1.11.11" class="ltx_tr">
<th id="A3.T9.3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">IMDB</th>
<td id="A3.T9.3.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r">78.2/<span id="A3.T9.3.1.11.11.2.1" class="ltx_text ltx_font_bold">95.1</span>/92.8</td>
<td id="A3.T9.3.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r">77.9/<span id="A3.T9.3.1.11.11.3.1" class="ltx_text ltx_font_bold">95.9</span>/91.1</td>
<td id="A3.T9.3.1.11.11.4" class="ltx_td ltx_align_center">78.1/<span id="A3.T9.3.1.11.11.4.1" class="ltx_text ltx_font_bold">89.4</span>/82.5</td>
</tr>
<tr id="A3.T9.3.1.12.12" class="ltx_tr">
<th id="A3.T9.3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Irrelevant Q</th>
<td id="A3.T9.3.1.12.12.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">MAP(T)/RA-VAR/RA-LOG</td>
</tr>
<tr id="A3.T9.3.1.13.13" class="ltx_tr">
<th id="A3.T9.3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">VNQ</th>
<td id="A3.T9.3.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.9/88.7/<span id="A3.T9.3.1.13.13.2.1" class="ltx_text ltx_font_bold">98.3</span>
</td>
<td id="A3.T9.3.1.13.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.8/<span id="A3.T9.3.1.13.13.3.1" class="ltx_text ltx_font_bold">99.7</span>/99.6</td>
<td id="A3.T9.3.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t">73.5/<span id="A3.T9.3.1.13.13.4.1" class="ltx_text ltx_font_bold">96.8</span>/90.0</td>
</tr>
<tr id="A3.T9.3.1.14.14" class="ltx_tr">
<th id="A3.T9.3.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">QRPE</th>
<td id="A3.T9.3.1.14.14.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">49.6/<span id="A3.T9.3.1.14.14.2.1" class="ltx_text ltx_font_bold">89.0</span>/84.8</td>
<td id="A3.T9.3.1.14.14.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">56.6/<span id="A3.T9.3.1.14.14.3.1" class="ltx_text ltx_font_bold">94.4</span>/94.0</td>
<td id="A3.T9.3.1.14.14.4" class="ltx_td ltx_align_center ltx_border_b">61.7/<span id="A3.T9.3.1.14.14.4.1" class="ltx_text ltx_font_bold">79.5</span>/63.6</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A3.F5" class="ltx_figure"><img src="/html/2009.10054/assets/irr_exp_1.png" id="A3.F5.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="550" height="765" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Results of top-1 attention on samples with irrelevant question (1). Baseline (BUTD), baseline + OE, and baseline + our regularization are compared.</figcaption>
</figure>
<figure id="A3.F6" class="ltx_figure"><img src="/html/2009.10054/assets/irr_exp_2.png" id="A3.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="550" height="719" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Results of top-1 attention on samples with irrelevant question (2). Baseline (BUTD), baseline + OE, and baseline + our regularization are compared.</figcaption>
</figure>
<figure id="A3.F7" class="ltx_figure"><img src="/html/2009.10054/assets/UNDEF_QUAL_ATALL.png" id="A3.F7.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="550" height="850" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Results of top-1 attention on samples with undefined answer (reading texts and numbers). Baseline (BUTD) makes a proper attention, but results in completely different output.</figcaption>
</figure>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>D. Qualitative Analysis of Unanswerable Samples</h2>

<section id="A4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Examples of Task 4: Irrelevant Question</h3>

<div id="A4.SSx1.p1" class="ltx_para">
<p id="A4.SSx1.p1.1" class="ltx_p">Experimental results of MAP (T) imply that attention networks in VQA have a bias of highly confident attention to a prominent object regardless of the question relevance. In Fig. <a href="#A3.F5" title="Figure 5 ‣ Comparison with Minimization of Attention Variance ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and  <a href="#A3.F6" title="Figure 6 ‣ Comparison with Minimization of Attention Variance ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, We attach examples of the results of maximum attention scores on samples with irrelevant questions before and after our regularization.
Considering the sum of the attention scores is 1.0 over 36 objects (each object has about 0.03 in a uniform distribution), baseline models without regularization or with outlier exposure <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks, Mazeika, and Dietterich <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite> still give strong attention on a prominent visual object, even though the questions are irrelevant and there is not related visual object in the images.
However, after regularization (ours), the attention networks avoid giving strong attention to any prominent object when the question is irrelevant to the image, and the attention scores become close to uniform.
Of course, if the question is relevant to the image, our model makes proper and strong attention to the visual object.</p>
</div>
</section>
<section id="A4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Examples of Task 5: Undefined Answer</h3>

<div id="A4.SSx2.p1" class="ltx_para">
<p id="A4.SSx2.p1.1" class="ltx_p">We further study the samples with undefined answers and attached various examples in Fig. <a href="#A3.F7" title="Figure 7 ‣ Comparison with Minimization of Attention Variance ‣ Appendix C C. Additional Experimental Results ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
We find that about 40% (1676/4303) of samples with undefined answers require to read texts or numbers in input images.
Note that the VQA model makes the right attention on the samples with undefined answers, but makes strange outputs because of their unanswerability by predefined answer candidates.
It is a common limitation of recent VQA models, which solve VQA as a prediction problem, such as classification or regression, because there are infinite combinations of text and numbers in the real-world <cite class="ltx_cite ltx_citemacro_citep">(Singh et al. <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<figure id="A4.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Anomaly Detection Performances (task 1, 2, and 4) of regression-based VQA model (NTN).</figcaption>
<table id="A4.T10.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A4.T10.1.1.1" class="ltx_tr">
<th id="A4.T10.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AUROC</th>
<td id="A4.T10.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">BUTD + NTN</td>
</tr>
<tr id="A4.T10.1.2.2" class="ltx_tr">
<th id="A4.T10.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Image</th>
<td id="A4.T10.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A4.T10.1.3.3" class="ltx_tr">
<th id="A4.T10.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">MNIST</th>
<td id="A4.T10.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">67.5/84.3/64.3/<span id="A4.T10.1.3.3.2.1" class="ltx_text ltx_font_bold">93.8</span>/92.3</td>
</tr>
<tr id="A4.T10.1.4.4" class="ltx_tr">
<th id="A4.T10.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SVHN</th>
<td id="A4.T10.1.4.4.2" class="ltx_td ltx_align_center">67.7/85.5/66.0/<span id="A4.T10.1.4.4.2.1" class="ltx_text ltx_font_bold">94.5</span>/92.9</td>
</tr>
<tr id="A4.T10.1.5.5" class="ltx_tr">
<th id="A4.T10.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FashionMNIST</th>
<td id="A4.T10.1.5.5.2" class="ltx_td ltx_align_center">67.6/85.1/66.3/<span id="A4.T10.1.5.5.2.1" class="ltx_text ltx_font_bold">94.3</span>/92.5</td>
</tr>
<tr id="A4.T10.1.6.6" class="ltx_tr">
<th id="A4.T10.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">CIFAR10</th>
<td id="A4.T10.1.6.6.2" class="ltx_td ltx_align_center">67.8/85.9/66.9/<span id="A4.T10.1.6.6.2.1" class="ltx_text ltx_font_bold">94.6</span>/93.1</td>
</tr>
<tr id="A4.T10.1.7.7" class="ltx_tr">
<th id="A4.T10.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Tiny</th>
<td id="A4.T10.1.7.7.2" class="ltx_td ltx_align_center">67.6/86.7/74.9/<span id="A4.T10.1.7.7.2.1" class="ltx_text ltx_font_bold">95.8</span>/94.1</td>
</tr>
<tr id="A4.T10.1.8.8" class="ltx_tr">
<th id="A4.T10.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Question</th>
<td id="A4.T10.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A4.T10.1.9.9" class="ltx_tr">
<th id="A4.T10.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">20 Newsgroup</th>
<td id="A4.T10.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t">68.9/83.4/70.3/78.1/<span id="A4.T10.1.9.9.2.1" class="ltx_text ltx_font_bold">92.7</span>
</td>
</tr>
<tr id="A4.T10.1.10.10" class="ltx_tr">
<th id="A4.T10.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Reuters52</th>
<td id="A4.T10.1.10.10.2" class="ltx_td ltx_align_center">69.9/83.5/68.4/77.4/<span id="A4.T10.1.10.10.2.1" class="ltx_text ltx_font_bold">94.0</span>
</td>
</tr>
<tr id="A4.T10.1.11.11" class="ltx_tr">
<th id="A4.T10.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">IMDB</th>
<td id="A4.T10.1.11.11.2" class="ltx_td ltx_align_center">63.3/80.6/66.9/77.5/<span id="A4.T10.1.11.11.2.1" class="ltx_text ltx_font_bold">89.1</span>
</td>
</tr>
<tr id="A4.T10.1.12.12" class="ltx_tr">
<th id="A4.T10.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Irrelevant Q</th>
<td id="A4.T10.1.12.12.2" class="ltx_td ltx_align_center ltx_border_t">MSP/MSP(T)/OE-MSP(T)/MAP(T)/RA-MAP(T)</td>
</tr>
<tr id="A4.T10.1.13.13" class="ltx_tr">
<th id="A4.T10.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">VNQ</th>
<td id="A4.T10.1.13.13.2" class="ltx_td ltx_align_center ltx_border_t">83.8/92.0/76.4/69.9/<span id="A4.T10.1.13.13.2.1" class="ltx_text ltx_font_bold">96.0</span> /</td>
</tr>
<tr id="A4.T10.1.14.14" class="ltx_tr">
<th id="A4.T10.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">QRPE</th>
<td id="A4.T10.1.14.14.2" class="ltx_td ltx_align_center ltx_border_b">67.3/70.8/79.8/45.4/<span id="A4.T10.1.14.14.2.1" class="ltx_text ltx_font_bold">89.1</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>E. Anomaly Detection of Regression-based VQA Models</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">Although classification-based VQA models show promising results on the VQA v2 challenge <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Kim, Jun, and Zhang <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Yu et al. <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>, regression-based VQA models are also feasible and important approaches in VQA studies.
The main differences between classification- and regression-based approaches are that regression-based VQA models take an answer candidate as the input together, compute likelihood <math id="A5.p1.1.m1.3" class="ltx_Math" alttext="p(\mathbf{a},\mathbf{v},\mathbf{q})" display="inline"><semantics id="A5.p1.1.m1.3a"><mrow id="A5.p1.1.m1.3.4" xref="A5.p1.1.m1.3.4.cmml"><mi id="A5.p1.1.m1.3.4.2" xref="A5.p1.1.m1.3.4.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A5.p1.1.m1.3.4.1" xref="A5.p1.1.m1.3.4.1.cmml">​</mo><mrow id="A5.p1.1.m1.3.4.3.2" xref="A5.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.1" xref="A5.p1.1.m1.3.4.3.1.cmml">(</mo><mi id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">𝐚</mi><mo id="A5.p1.1.m1.3.4.3.2.2" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">𝐯</mi><mo id="A5.p1.1.m1.3.4.3.2.3" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="A5.p1.1.m1.3.3" xref="A5.p1.1.m1.3.3.cmml">𝐪</mi><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.4" xref="A5.p1.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.3b"><apply id="A5.p1.1.m1.3.4.cmml" xref="A5.p1.1.m1.3.4"><times id="A5.p1.1.m1.3.4.1.cmml" xref="A5.p1.1.m1.3.4.1"></times><ci id="A5.p1.1.m1.3.4.2.cmml" xref="A5.p1.1.m1.3.4.2">𝑝</ci><vector id="A5.p1.1.m1.3.4.3.1.cmml" xref="A5.p1.1.m1.3.4.3.2"><ci id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1">𝐚</ci><ci id="A5.p1.1.m1.2.2.cmml" xref="A5.p1.1.m1.2.2">𝐯</ci><ci id="A5.p1.1.m1.3.3.cmml" xref="A5.p1.1.m1.3.3">𝐪</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.3c">p(\mathbf{a},\mathbf{v},\mathbf{q})</annotation></semantics></math> scores of all answer answer candidates, and select the most likely answer candidate as the prediction:</p>
<table id="A5.EGx5" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="A5.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A5.E9.m1.4" class="ltx_Math" alttext="\displaystyle\theta^{*}=\underset{\theta}{\operatorname{argmax}}\mathbb{E}_{p_{\mathcal{D}}}\left[\log p_{\theta}\left(\mathbf{a},\mathbf{v},\mathbf{q}\right)\right]," display="block"><semantics id="A5.E9.m1.4a"><mrow id="A5.E9.m1.4.4.1" xref="A5.E9.m1.4.4.1.1.cmml"><mrow id="A5.E9.m1.4.4.1.1" xref="A5.E9.m1.4.4.1.1.cmml"><msup id="A5.E9.m1.4.4.1.1.3" xref="A5.E9.m1.4.4.1.1.3.cmml"><mi id="A5.E9.m1.4.4.1.1.3.2" xref="A5.E9.m1.4.4.1.1.3.2.cmml">θ</mi><mo id="A5.E9.m1.4.4.1.1.3.3" xref="A5.E9.m1.4.4.1.1.3.3.cmml">∗</mo></msup><mo id="A5.E9.m1.4.4.1.1.2" xref="A5.E9.m1.4.4.1.1.2.cmml">=</mo><mrow id="A5.E9.m1.4.4.1.1.1" xref="A5.E9.m1.4.4.1.1.1.cmml"><munder accentunder="true" id="A5.E9.m1.4.4.1.1.1.3" xref="A5.E9.m1.4.4.1.1.1.3.cmml"><mi id="A5.E9.m1.4.4.1.1.1.3.2" xref="A5.E9.m1.4.4.1.1.1.3.2.cmml">argmax</mi><mo id="A5.E9.m1.4.4.1.1.1.3.1" xref="A5.E9.m1.4.4.1.1.1.3.1.cmml">𝜃</mo></munder><mo lspace="0.167em" rspace="0em" id="A5.E9.m1.4.4.1.1.1.2" xref="A5.E9.m1.4.4.1.1.1.2.cmml">​</mo><msub id="A5.E9.m1.4.4.1.1.1.4" xref="A5.E9.m1.4.4.1.1.1.4.cmml"><mi id="A5.E9.m1.4.4.1.1.1.4.2" xref="A5.E9.m1.4.4.1.1.1.4.2.cmml">𝔼</mi><msub id="A5.E9.m1.4.4.1.1.1.4.3" xref="A5.E9.m1.4.4.1.1.1.4.3.cmml"><mi id="A5.E9.m1.4.4.1.1.1.4.3.2" xref="A5.E9.m1.4.4.1.1.1.4.3.2.cmml">p</mi><mi class="ltx_font_mathcaligraphic" id="A5.E9.m1.4.4.1.1.1.4.3.3" xref="A5.E9.m1.4.4.1.1.1.4.3.3.cmml">𝒟</mi></msub></msub><mo lspace="0em" rspace="0em" id="A5.E9.m1.4.4.1.1.1.2a" xref="A5.E9.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="A5.E9.m1.4.4.1.1.1.1.1" xref="A5.E9.m1.4.4.1.1.1.1.2.cmml"><mo id="A5.E9.m1.4.4.1.1.1.1.1.2" xref="A5.E9.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.E9.m1.4.4.1.1.1.1.1.1" xref="A5.E9.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A5.E9.m1.4.4.1.1.1.1.1.1.2" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="A5.E9.m1.4.4.1.1.1.1.1.1.2.1" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="A5.E9.m1.4.4.1.1.1.1.1.1.2a" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><msub id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.2" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.3" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A5.E9.m1.4.4.1.1.1.1.1.1.1" xref="A5.E9.m1.4.4.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A5.E9.m1.4.4.1.1.1.1.1.1.3.2" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mo id="A5.E9.m1.4.4.1.1.1.1.1.1.3.2.1" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="A5.E9.m1.1.1" xref="A5.E9.m1.1.1.cmml">𝐚</mi><mo id="A5.E9.m1.4.4.1.1.1.1.1.1.3.2.2" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A5.E9.m1.2.2" xref="A5.E9.m1.2.2.cmml">𝐯</mi><mo id="A5.E9.m1.4.4.1.1.1.1.1.1.3.2.3" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A5.E9.m1.3.3" xref="A5.E9.m1.3.3.cmml">𝐪</mi><mo id="A5.E9.m1.4.4.1.1.1.1.1.1.3.2.4" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="A5.E9.m1.4.4.1.1.1.1.1.3" xref="A5.E9.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.E9.m1.4.4.1.2" xref="A5.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E9.m1.4b"><apply id="A5.E9.m1.4.4.1.1.cmml" xref="A5.E9.m1.4.4.1"><eq id="A5.E9.m1.4.4.1.1.2.cmml" xref="A5.E9.m1.4.4.1.1.2"></eq><apply id="A5.E9.m1.4.4.1.1.3.cmml" xref="A5.E9.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="A5.E9.m1.4.4.1.1.3.1.cmml" xref="A5.E9.m1.4.4.1.1.3">superscript</csymbol><ci id="A5.E9.m1.4.4.1.1.3.2.cmml" xref="A5.E9.m1.4.4.1.1.3.2">𝜃</ci><times id="A5.E9.m1.4.4.1.1.3.3.cmml" xref="A5.E9.m1.4.4.1.1.3.3"></times></apply><apply id="A5.E9.m1.4.4.1.1.1.cmml" xref="A5.E9.m1.4.4.1.1.1"><times id="A5.E9.m1.4.4.1.1.1.2.cmml" xref="A5.E9.m1.4.4.1.1.1.2"></times><apply id="A5.E9.m1.4.4.1.1.1.3.cmml" xref="A5.E9.m1.4.4.1.1.1.3"><ci id="A5.E9.m1.4.4.1.1.1.3.1.cmml" xref="A5.E9.m1.4.4.1.1.1.3.1">𝜃</ci><ci id="A5.E9.m1.4.4.1.1.1.3.2.cmml" xref="A5.E9.m1.4.4.1.1.1.3.2">argmax</ci></apply><apply id="A5.E9.m1.4.4.1.1.1.4.cmml" xref="A5.E9.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="A5.E9.m1.4.4.1.1.1.4.1.cmml" xref="A5.E9.m1.4.4.1.1.1.4">subscript</csymbol><ci id="A5.E9.m1.4.4.1.1.1.4.2.cmml" xref="A5.E9.m1.4.4.1.1.1.4.2">𝔼</ci><apply id="A5.E9.m1.4.4.1.1.1.4.3.cmml" xref="A5.E9.m1.4.4.1.1.1.4.3"><csymbol cd="ambiguous" id="A5.E9.m1.4.4.1.1.1.4.3.1.cmml" xref="A5.E9.m1.4.4.1.1.1.4.3">subscript</csymbol><ci id="A5.E9.m1.4.4.1.1.1.4.3.2.cmml" xref="A5.E9.m1.4.4.1.1.1.4.3.2">𝑝</ci><ci id="A5.E9.m1.4.4.1.1.1.4.3.3.cmml" xref="A5.E9.m1.4.4.1.1.1.4.3.3">𝒟</ci></apply></apply><apply id="A5.E9.m1.4.4.1.1.1.1.2.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="A5.E9.m1.4.4.1.1.1.1.2.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1"><times id="A5.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.1"></times><apply id="A5.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2"><log id="A5.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.1"></log><apply id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.2.2.3">𝜃</ci></apply></apply><vector id="A5.E9.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A5.E9.m1.4.4.1.1.1.1.1.1.3.2"><ci id="A5.E9.m1.1.1.cmml" xref="A5.E9.m1.1.1">𝐚</ci><ci id="A5.E9.m1.2.2.cmml" xref="A5.E9.m1.2.2">𝐯</ci><ci id="A5.E9.m1.3.3.cmml" xref="A5.E9.m1.3.3">𝐪</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E9.m1.4c">\displaystyle\theta^{*}=\underset{\theta}{\operatorname{argmax}}\mathbb{E}_{p_{\mathcal{D}}}\left[\log p_{\theta}\left(\mathbf{a},\mathbf{v},\mathbf{q}\right)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="A5.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A5.E10.m1.7" class="ltx_Math" alttext="\displaystyle S({\mathbf{v},\mathbf{q}};T)=\max_{i}{p_{\theta}(\mathbf{a}_{i},\mathbf{v},\mathbf{q};T)}." display="block"><semantics id="A5.E10.m1.7a"><mrow id="A5.E10.m1.7.7.1" xref="A5.E10.m1.7.7.1.1.cmml"><mrow id="A5.E10.m1.7.7.1.1" xref="A5.E10.m1.7.7.1.1.cmml"><mrow id="A5.E10.m1.7.7.1.1.3" xref="A5.E10.m1.7.7.1.1.3.cmml"><mi id="A5.E10.m1.7.7.1.1.3.2" xref="A5.E10.m1.7.7.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="A5.E10.m1.7.7.1.1.3.1" xref="A5.E10.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="A5.E10.m1.7.7.1.1.3.3.2" xref="A5.E10.m1.7.7.1.1.3.3.1.cmml"><mo stretchy="false" id="A5.E10.m1.7.7.1.1.3.3.2.1" xref="A5.E10.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="A5.E10.m1.1.1" xref="A5.E10.m1.1.1.cmml">𝐯</mi><mo id="A5.E10.m1.7.7.1.1.3.3.2.2" xref="A5.E10.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="A5.E10.m1.2.2" xref="A5.E10.m1.2.2.cmml">𝐪</mi><mo id="A5.E10.m1.7.7.1.1.3.3.2.3" xref="A5.E10.m1.7.7.1.1.3.3.1.cmml">;</mo><mi id="A5.E10.m1.3.3" xref="A5.E10.m1.3.3.cmml">T</mi><mo stretchy="false" id="A5.E10.m1.7.7.1.1.3.3.2.4" xref="A5.E10.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="A5.E10.m1.7.7.1.1.2" xref="A5.E10.m1.7.7.1.1.2.cmml">=</mo><mrow id="A5.E10.m1.7.7.1.1.1" xref="A5.E10.m1.7.7.1.1.1.cmml"><mrow id="A5.E10.m1.7.7.1.1.1.3" xref="A5.E10.m1.7.7.1.1.1.3.cmml"><munder id="A5.E10.m1.7.7.1.1.1.3.1" xref="A5.E10.m1.7.7.1.1.1.3.1.cmml"><mi id="A5.E10.m1.7.7.1.1.1.3.1.2" xref="A5.E10.m1.7.7.1.1.1.3.1.2.cmml">max</mi><mi id="A5.E10.m1.7.7.1.1.1.3.1.3" xref="A5.E10.m1.7.7.1.1.1.3.1.3.cmml">i</mi></munder><mo lspace="0.167em" id="A5.E10.m1.7.7.1.1.1.3a" xref="A5.E10.m1.7.7.1.1.1.3.cmml">⁡</mo><msub id="A5.E10.m1.7.7.1.1.1.3.2" xref="A5.E10.m1.7.7.1.1.1.3.2.cmml"><mi id="A5.E10.m1.7.7.1.1.1.3.2.2" xref="A5.E10.m1.7.7.1.1.1.3.2.2.cmml">p</mi><mi id="A5.E10.m1.7.7.1.1.1.3.2.3" xref="A5.E10.m1.7.7.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A5.E10.m1.7.7.1.1.1.2" xref="A5.E10.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="A5.E10.m1.7.7.1.1.1.1.1" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="A5.E10.m1.7.7.1.1.1.1.1.2" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml">(</mo><msub id="A5.E10.m1.7.7.1.1.1.1.1.1" xref="A5.E10.m1.7.7.1.1.1.1.1.1.cmml"><mi id="A5.E10.m1.7.7.1.1.1.1.1.1.2" xref="A5.E10.m1.7.7.1.1.1.1.1.1.2.cmml">𝐚</mi><mi id="A5.E10.m1.7.7.1.1.1.1.1.1.3" xref="A5.E10.m1.7.7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A5.E10.m1.7.7.1.1.1.1.1.3" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml">,</mo><mi id="A5.E10.m1.4.4" xref="A5.E10.m1.4.4.cmml">𝐯</mi><mo id="A5.E10.m1.7.7.1.1.1.1.1.4" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml">,</mo><mi id="A5.E10.m1.5.5" xref="A5.E10.m1.5.5.cmml">𝐪</mi><mo id="A5.E10.m1.7.7.1.1.1.1.1.5" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml">;</mo><mi id="A5.E10.m1.6.6" xref="A5.E10.m1.6.6.cmml">T</mi><mo stretchy="false" id="A5.E10.m1.7.7.1.1.1.1.1.6" xref="A5.E10.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A5.E10.m1.7.7.1.2" xref="A5.E10.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E10.m1.7b"><apply id="A5.E10.m1.7.7.1.1.cmml" xref="A5.E10.m1.7.7.1"><eq id="A5.E10.m1.7.7.1.1.2.cmml" xref="A5.E10.m1.7.7.1.1.2"></eq><apply id="A5.E10.m1.7.7.1.1.3.cmml" xref="A5.E10.m1.7.7.1.1.3"><times id="A5.E10.m1.7.7.1.1.3.1.cmml" xref="A5.E10.m1.7.7.1.1.3.1"></times><ci id="A5.E10.m1.7.7.1.1.3.2.cmml" xref="A5.E10.m1.7.7.1.1.3.2">𝑆</ci><vector id="A5.E10.m1.7.7.1.1.3.3.1.cmml" xref="A5.E10.m1.7.7.1.1.3.3.2"><ci id="A5.E10.m1.1.1.cmml" xref="A5.E10.m1.1.1">𝐯</ci><ci id="A5.E10.m1.2.2.cmml" xref="A5.E10.m1.2.2">𝐪</ci><ci id="A5.E10.m1.3.3.cmml" xref="A5.E10.m1.3.3">𝑇</ci></vector></apply><apply id="A5.E10.m1.7.7.1.1.1.cmml" xref="A5.E10.m1.7.7.1.1.1"><times id="A5.E10.m1.7.7.1.1.1.2.cmml" xref="A5.E10.m1.7.7.1.1.1.2"></times><apply id="A5.E10.m1.7.7.1.1.1.3.cmml" xref="A5.E10.m1.7.7.1.1.1.3"><apply id="A5.E10.m1.7.7.1.1.1.3.1.cmml" xref="A5.E10.m1.7.7.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.E10.m1.7.7.1.1.1.3.1.1.cmml" xref="A5.E10.m1.7.7.1.1.1.3.1">subscript</csymbol><max id="A5.E10.m1.7.7.1.1.1.3.1.2.cmml" xref="A5.E10.m1.7.7.1.1.1.3.1.2"></max><ci id="A5.E10.m1.7.7.1.1.1.3.1.3.cmml" xref="A5.E10.m1.7.7.1.1.1.3.1.3">𝑖</ci></apply><apply id="A5.E10.m1.7.7.1.1.1.3.2.cmml" xref="A5.E10.m1.7.7.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.E10.m1.7.7.1.1.1.3.2.1.cmml" xref="A5.E10.m1.7.7.1.1.1.3.2">subscript</csymbol><ci id="A5.E10.m1.7.7.1.1.1.3.2.2.cmml" xref="A5.E10.m1.7.7.1.1.1.3.2.2">𝑝</ci><ci id="A5.E10.m1.7.7.1.1.1.3.2.3.cmml" xref="A5.E10.m1.7.7.1.1.1.3.2.3">𝜃</ci></apply></apply><vector id="A5.E10.m1.7.7.1.1.1.1.2.cmml" xref="A5.E10.m1.7.7.1.1.1.1.1"><apply id="A5.E10.m1.7.7.1.1.1.1.1.1.cmml" xref="A5.E10.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E10.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A5.E10.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="A5.E10.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A5.E10.m1.7.7.1.1.1.1.1.1.2">𝐚</ci><ci id="A5.E10.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A5.E10.m1.7.7.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A5.E10.m1.4.4.cmml" xref="A5.E10.m1.4.4">𝐯</ci><ci id="A5.E10.m1.5.5.cmml" xref="A5.E10.m1.5.5">𝐪</ci><ci id="A5.E10.m1.6.6.cmml" xref="A5.E10.m1.6.6">𝑇</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E10.m1.7c">\displaystyle S({\mathbf{v},\mathbf{q}};T)=\max_{i}{p_{\theta}(\mathbf{a}_{i},\mathbf{v},\mathbf{q};T)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p">One can speculate that regression-based VQA models, which jointly consider an image, a question, and the answer, are free of anomaly detection.
Thus, we evaluate the robustness of regression-based anomaly detection methods.
We modify the model architecture of BUTD based on common approaches, neural tensor networks (NTN) <cite class="ltx_cite ltx_citemacro_citep">(Bai et al. <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>.
Note that although regression-based VQA models compute a likelihood on every answer candidate, cross-modal attention networks are located before the multi-modal feature fusion, and our attention-based anomaly detection can still be used (see the details in <cite class="ltx_cite ltx_citemacro_citep">(Bai et al. <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>).
The results in Table <a href="#A4.T10" title="Table 10 ‣ Examples of Task 5: Undefined Answer ‣ Appendix D D. Qualitative Analysis of Unanswerable Samples ‣ Regularizing Attention Networks for Anomaly Detection in Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> imply that the regression-based approach still suffers from various anomalies, and attention-based anomaly detection makes the VQA model robust to them.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2009.10053" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2009.10054" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2009.10054">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2009.10054" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2009.10055" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 11:18:59 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
