<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.17990] TabVFL: Improving Latent Representation in Vertical Federated Learning</title><meta property="og:description" content="Autoencoders are popular neural networks that are able to compress high dimensional data to extract relevant latent information. TabNet is a state-of-the-art neural network model designed for tabular data that utilizes…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TabVFL: Improving Latent Representation in Vertical Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="TabVFL: Improving Latent Representation in Vertical Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.17990">

<!--Generated on Sun May  5 15:00:44 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">TabVFL: Improving Latent Representation in Vertical Federated Learning
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Mohamed Rashad1
, Zilong Zhao23, Jeremie Decouchant1, Lydia Y. Chen1



</span><span class="ltx_author_notes">2 Contact: z.zhao@nus.edu.sg
<span class="ltx_contact ltx_role_affiliation">1TU Delft, Netherlands
</span>
<span class="ltx_contact ltx_role_affiliation">2National University of Singapore, Singapore
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Autoencoders are popular neural networks that are able to compress high dimensional data to extract relevant latent information. TabNet is a state-of-the-art neural network model designed for tabular data that utilizes an autoencoder architecture for training.
Vertical Federated Learning (VFL) is an emerging distributed machine learning paradigm that allows multiple parties to train a model collaboratively on vertically partitioned data while maintaining data privacy.
The existing design of training autoencoders in VFL is to train a separate autoencoder in each participant and aggregate the latent representation later. This design could potentially break important correlations between feature data of participating parties, as each autoencoder is trained on locally available features while disregarding the features of others.
In addition, traditional autoencoders are not specifically designed for tabular data, which is ubiquitous in VFL settings. Moreover, the impact of client failures during training on the model robustness is under-researched in the VFL scene.
In this paper, we propose TabVFL, a distributed framework designed to improve latent representation learning
using the joint features of participants.
The framework (i) preserves privacy by mitigating potential data leakage with the addition of a fully-connected layer, (ii) conserves feature correlations by learning one latent representation vector, and (iii) provides enhanced robustness against client failures during training phase. Extensive experiments on five classification datasets show that TabVFL can outperform the prior work design, with 26.12% of improvement on f1-score. </p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.17990/assets/x1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="294" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S1.F1.sf1.3.2" class="ltx_text" style="font-size:90%;">Classical SplitNN Architecture.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.17990/assets/x2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="225" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S1.F1.sf2.3.2" class="ltx_text" style="font-size:90%;">SplitNN U-Shape Architecture.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Predictive model designs using SplitNN: example with two clients.</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Autoencoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is a type of artificial neural network used for unsupervised learning of efficient codings. The main goal of an autoencoder is to learn a representation (encoding) for a set of data, typically for the purpose of dimensionality reduction or feature extraction. However, despite their success, traditional autoencoders are not specifically designed to handle tabular data effectively. Deep Neural Networks (DNNs) have achieved remarkable results in various domains, especially where data has inherent hierarchical or spatial structures, such as images, audio, and text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, when it comes to tabular data, DNNs often underperform compared to boosting-based methods like Gradient Boosted Trees (GBT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Tabular data often lacks the spatial or temporal hierarchies that DNNs particularly adapt at modeling. Additionally, DNNs can be more data-hungry and prone to overfitting, especially when the dataset is small, whereas boosting methods can be more robust and generalize better with fewer data points.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Innovative methods are needed to appropriately adapt DNNs to tabular data in order to address these issues. The incorporation of TabNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, a specialized neural network architecture created specifically for tabular data, is a noteworthy development in this domain. With the use of TabNet, tabular datasets can be handled effectively while utilizing the strength of deep learning. Its unique attention mechanism allows it to focus on relevant subsets of features, enabling the model to capture intricate patterns even in the absence of spatial or temporal properties of the data.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Vertical Federated Learning (VFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> describes situations where multiple clients have different features for the same set of individuals. This federated learning approach is especially beneficial when diverse stakeholders or institutions possess distinct data attributes. Consider a bank and an e-commerce platform: while the bank maintains comprehensive financial records, the e-commerce platform holds data on customers’ online shopping activities. Both parties aim to collaboratively develop a precise credit scoring model to gauge the risk of a customer defaulting on a loan or credit payment, without directly sharing customer data. In such scenarios, VFL becomes an invaluable tool.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Autoencoders in VFL are substantially under-researched. In the current designs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, each non-label holder is assumed to have a local autoencoder model which is trained only on local feature data. After local training, the learnt latent representation is sent to the label owner. Once received, the latent representations are concatenated and used for downstream tasks, e.g., for training a prediction model. The correlation between the isolated features among the non-label holders is not captured due to local latent representation learning of separate autoencoders. This lack of correlation could lead to the generation of irrelevant or noisy latent data, significantly impacting the prediction performance. To fill in this gap, we propose a joint latent representation learning design, TabVFL, that learns one latent representation from capturing feature dependencies across all parties involved in a privacy-preserving fashion. SplitNN  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> approach is leveraged to assimilate TabNet in the VFL context. This entails the devision of TabNet into independent model parts that are assigned to each participating party.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Splitting TabNet is not a trivial task due to various dependencies between components. Careful design choices needed to be made in order to protect against the exposure of raw feature data.
A fully-connected layer is added in each non-label owner model part to prevent the potential occurrence of a direct data leakage.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">One major challenge that any federated learning system can suffer from is the presence of failing clients  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. These failures may happen for a number of reasons, including network problems, hardware problems, or software crashes. Client failures can disrupt the training and hence the performance of the system. A naive solution to this problem is replacing missing values of failed clients with vectors of zeros <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. However, this adds bias to the training and can hinder the performance. We instead propose a caching mechanism for storing and reusing the communicated values to decrease performance degradation and enhance training stability.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">We conduct extensive evaluation on TabVFL using five classification datasets. The results are compared with three baselines.
The accuracy, f1-score and ROC-AUC metrics are reported. The evaluation results show that TabVFL performs considerably better than prior work for all the datasets. The highest improvement reached was 26.12% on f1-score.
TabVFL outperforms other designs in terms of runtime and memory utilization but it has higher communication overhead compared to the baselines.
The main contribution of this study can be summarized as follows:
</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We design the TabVFL distributed framework, which
incorporates the state-of-the-art tabular model TabNet into vertical federated learning (VFL) via a single latent representation of vertically partitioned data.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We incorporate an additional fully-connected layer into TabVFL to prevent potential data leakage.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We introduce a caching mechanism to mitigate the impact of client failures, enhance training process stability and minimize performance degradation</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Extensive experiments are conducted on five classification datasets. Results show that TabVFL demonstrates significant enhancement in latent quality, outperforming previous designs.
Additionally, TabVFL excels in runtime and memory efficiency, and only incurs a moderately increased network consumption compared to other designs.
</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Preliminaries</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Vertical Federated Learning (VFL)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is a distributed machine learning paradigm that focuses on collaborative model training between multiple parties that provide their locally available data while maintaining data privacy. The parties are distinguished into two types: guest clients and a host client. The host client acts as the server or the federator and the guests act as feature providers. It is generally assumed that the host is the label holder. The features and the corresponding target labels of the parties need to be aligned prior to the training process. Private Set Intersection (PSI) (<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>) is the usual algorithm applied for the cryptographic alignment of samples in VFL (<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>).
We assume that the samples among clients are already aligned and that each client owns distinct features.
Popular machine learning models for tabular data learning, such as gradient boosting decision trees (GBDTs) (<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>) and generative models (<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>), have been considered in VFL. Participants in tree-based models collaborate to collectively construct a prediction tree, while generative models like GANs are employed for synthesizing tabular data that mimics the patterns in participants’ original data.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">SplitNN</span> particularly focuses on the neural network based predictors 
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. SplitNN enables different and flexible split configurations of a model.
Typically, a splitNN model consists of a bottom and a top model as shown in <a href="#S1.F1.sf1" title="1(a) ‣ Figure 1 ‣ I Introduction ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>. Each guest client processes the local feature data through its bottom model. The generated intermediate results are sent by the guests to the host client. Aggregation takes place of the intermediate results which is further processed by the top model at the host. Finally, a prediction is made and compared to the true value for loss calculation. The acquired loss value is used to update the models by calculating the appropriate gradients.
A special kind of split learning design is the U-shaped design shown in <a href="#S1.F1.sf2" title="1(b) ‣ Figure 1 ‣ I Introduction ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>.
The parties are called server and client since they don’t adhere to the assumed guest and host roles.
Clients posses a front and bottom model parts, while the server holds the middle part. This naturally reduces computational cost for clients. The front model creates initial intermediate results from input data. Results from clients are sent to the server for processing. Server-generated results are then sent back to clients for prediction and loss calculation.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">TabNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> shown in <a href="#S2.F2" title="Figure 2 ‣ II Preliminaries ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 2</span></a> is a state-of-the-art deep neural network that is specifically designed for tabular data. It combines advanced ensembling concepts and novel sequential attention mechanisms. TabNet training phases consists of pretraining and finetuning. During pretraining, an autoencoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
structure is employed
to learn general latent feature representations. The encoder compresses input features, while the decoder reconstructs them, extracting valuable latent features.
For finetuning, the decoder is disregarded and a fully-connected (FC) layer is placed directly after the encoder for predictions. The goal is to specialize the latent representation on a downstream task.
TabNet dynamically learns to pick important features through the attentive layer by creating and applying feature masks
in each encoder decision step, filtering irrelevant features.
The encoder outputs sequential decisions that are processed by the decoder for predicting feature values. During finetuning, the encoder decision outputs are transformed into encoded representations instead.
</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2404.17990/assets/x3.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="230" height="137" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">Structure of TabNet.</span></figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we begin by introducing tree-based prediction models tailored for tabular data within the VFL training framework. Subsequently, we delve into the exploration of deep learning frameworks highlighted in the VFL literature. Finally, client failure handling methods in federated learning frameworks are discussed.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Tree-based Prediction Frameworks In VFL</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Pivot <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> introduced an enhanced communication protocol to mitigate data leakage from intermediate results for tree models. SecureBoost <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> is able to train a GBDT model, such as XGBoost, without sacrificing model utility by performing similar to non-federated settings. The mentioned frameworks are not efficient due to the sequential nature of training the trees. VF<sup id="S3.SS1.p1.1.1" class="ltx_sup"><span id="S3.SS1.p1.1.1.1" class="ltx_text ltx_font_italic">2</span></sup>Boost <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> proposed a scheduler-worker design to enable concurrent computations and an ad-hoc cryptography protocol for faster communication time. A random forest <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> has also been considered in VFL using a trusted third-party to build and achieve a lossless performing model.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">TabNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> shows superiority over tree-based model on tabular data predictions. We harness TabNet’s predictive prowess, integrating it with splitNN to undertake prediction tasks within the VFL training framework.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Deep Learning Prediction Frameworks In VFL</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">SplitNN
is applied in multiple VFL use cases, such as healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, advertisement <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and finance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, transfer learning is leveraged on overlapped and non-overlapped data among participants to alleviate the issue of missing features. Different configurations for split learning are proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> depending on different use cases and requirements. Different aggregation methods of intermediate results have been explored specifically in
VFL context <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Practical application of splitNN is employed in the PyVertical framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> where a hybrid approach is utilized to internalize split learning in VFL along with the PSI method for entity alignment. FDML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> is another VFL framework that also supports neural networks but assumes label availability for all parties.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">FedOnce framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> enforces one communication round between the guests and host clients using a splitNN design. This is achieved by locally pretraining guest models using a technique called <span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_italic">Noise As Targets</span> to generate latent representations once.
Khan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> follows the same procedure but a local autoencoder is assumed in each guest client for learning a compressed feature representation.
After completion, the latent data is aggregated and prepared for training a separate prediction model in the host side, e.g., using XGBoost <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> on the extracted features. A similar autoencoder design is employed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> with the only difference being that the autoencoder is encouraged to learn a higher dimensional representation of the data.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> a variational autoencoder is used for learning a latent representation that closely represents a Gaussian distribution in order to ensure statistical similarity between the latent data of different samples, hindering sample distinction by attackers.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Our proposed framework extends the current autoencoder design in VFL by unifying the latent data through training one autoencoder model during pretraining of TabNet. A U-shaped splitNN design (as shown in <a href="#S1.F1.sf2" title="1(b) ‣ Figure 1 ‣ I Introduction ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>) is utilized for joint learning of the feature representations across parties. To the best of our knowledge, none of the existing VFL frameworks considers the application of U-shaped splitNN in cases of feature reconstruction.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Client Failure Handling Methods</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Many client failure handling methods exist in the Horizontal Federated Learning (HFL) context where it is assumed that clients have overlapping feature space but distinct data samples. Existing techniques include alleviation of client failures by incorporating robust aggregation algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, increasing eligibility of participating devices in scalable environments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, preemptive client state prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> and by dynamically varying training round duration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. An empirical study has also shown that client failures have significant impact on convergence time and performance of an FL system <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. However, literature about this matter in VFL is scarce <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Iker Ceballos et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> demonstrated that quitting of clients leads to slower convergence rates and worse performance, amplified by simultaneous quitting of clients in a four-client splitNN configuration. Client failures in a two-party splitNN setting are also conducted where a dropout-based method is introduced to enforce robustness against a quitting client <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
Furthermore, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> achieves model robustness via dynamic client data re-indexing. In this study, we leverage a caching method to improve model robustness in cases of client failures within a two-party setup.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first delve into the architecture of TabVFL, elucidating its design and rationale. We then address crucial privacy aspects of the model. Lastly, we present the training specifics, highlighting a novel approach to manage client failures.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.6.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S4.T1.7.2" class="ltx_text" style="font-size:90%;">Notations</span></figcaption>
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.4.5.1" class="ltx_tr">
<th id="S4.T1.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.4.5.1.1.1" class="ltx_text ltx_font_bold">Symbol</span></th>
<td id="S4.T1.4.5.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T1.4.5.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.4.5.1.2.1.1" class="ltx_p" style="width:144.5pt;"><span id="S4.T1.4.5.1.2.1.1.1" class="ltx_text ltx_font_bold">Description</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.4.6.2" class="ltx_tr">
<th id="S4.T1.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.4.6.2.1.1" class="ltx_text ltx_font_italic">PartialEnc</span></th>
<td id="S4.T1.4.6.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T1.4.6.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.4.6.2.2.1.1" class="ltx_p" style="width:144.5pt;">The encoder module of TabNet without BN layer residing in the host client.</span>
</span>
</td>
</tr>
<tr id="S4.T1.4.7.3" class="ltx_tr">
<th id="S4.T1.4.7.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T1.4.7.3.1.1" class="ltx_text ltx_font_italic">PartialDec</span></th>
<td id="S4.T1.4.7.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T1.4.7.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.4.7.3.2.1.1" class="ltx_p" style="width:144.5pt;">The decoder module of TabNet without the FC layer residing in the host client.</span>
</span>
</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><msub id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">f</mi><mrow id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T1.1.1.1.m1.1.1.3.2" xref="S4.T1.1.1.1.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.T1.1.1.1.m1.1.1.3.1" xref="S4.T1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.T1.1.1.1.m1.1.1.3.3" xref="S4.T1.1.1.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.T1.1.1.1.m1.1.1.3.1a" xref="S4.T1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T1.1.1.1.m1.1.1.3.4" xref="S4.T1.1.1.1.m1.1.1.3.4.cmml">repr</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">𝑓</ci><apply id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3"><times id="S4.T1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T1.1.1.1.m1.1.1.3.2">bottom</ci><ci id="S4.T1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3.3">_</ci><ci id="S4.T1.1.1.1.m1.1.1.3.4.cmml" xref="S4.T1.1.1.1.m1.1.1.3.4">repr</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">f_{\mathrm{bottom\_repr}}</annotation></semantics></math></th>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.1.2.1.1" class="ltx_p" style="width:144.5pt;">The feature extractor containing a BN and a FC layer in the bottom model of guest clients.</span>
</span>
</td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<th id="S4.T1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><msub id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mi id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2.cmml">f</mi><mrow id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml"><mi id="S4.T1.2.2.1.m1.1.1.3.2" xref="S4.T1.2.2.1.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.T1.2.2.1.m1.1.1.3.1" xref="S4.T1.2.2.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.T1.2.2.1.m1.1.1.3.3" xref="S4.T1.2.2.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.T1.2.2.1.m1.1.1.3.1a" xref="S4.T1.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T1.2.2.1.m1.1.1.3.4" xref="S4.T1.2.2.1.m1.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="S4.T1.2.2.1.m1.1.1.3.1b" xref="S4.T1.2.2.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.T1.2.2.1.m1.1.1.3.5" xref="S4.T1.2.2.1.m1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.T1.2.2.1.m1.1.1.3.1c" xref="S4.T1.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T1.2.2.1.m1.1.1.3.6" xref="S4.T1.2.2.1.m1.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">subscript</csymbol><ci id="S4.T1.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.2">𝑓</ci><apply id="S4.T1.2.2.1.m1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3"><times id="S4.T1.2.2.1.m1.1.1.3.1.cmml" xref="S4.T1.2.2.1.m1.1.1.3.1"></times><ci id="S4.T1.2.2.1.m1.1.1.3.2.cmml" xref="S4.T1.2.2.1.m1.1.1.3.2">bottom</ci><ci id="S4.T1.2.2.1.m1.1.1.3.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3.3">_</ci><ci id="S4.T1.2.2.1.m1.1.1.3.4.cmml" xref="S4.T1.2.2.1.m1.1.1.3.4">repr</ci><ci id="S4.T1.2.2.1.m1.1.1.3.5.cmml" xref="S4.T1.2.2.1.m1.1.1.3.5">_</ci><ci id="S4.T1.2.2.1.m1.1.1.3.6.cmml" xref="S4.T1.2.2.1.m1.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math></th>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.2.2.2.1.1" class="ltx_p" style="width:144.5pt;">The feature extractor containing a BN, FC and RandomObfuscator layers in the bottom model of guest clients.</span>
</span>
</td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<th id="S4.T1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_rec}}" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><msub id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml"><mi id="S4.T1.3.3.1.m1.1.1.2" xref="S4.T1.3.3.1.m1.1.1.2.cmml">f</mi><mrow id="S4.T1.3.3.1.m1.1.1.3" xref="S4.T1.3.3.1.m1.1.1.3.cmml"><mi id="S4.T1.3.3.1.m1.1.1.3.2" xref="S4.T1.3.3.1.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.3.1.m1.1.1.3.1" xref="S4.T1.3.3.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.T1.3.3.1.m1.1.1.3.3" xref="S4.T1.3.3.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.3.1.m1.1.1.3.1a" xref="S4.T1.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T1.3.3.1.m1.1.1.3.4" xref="S4.T1.3.3.1.m1.1.1.3.4.cmml">rec</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T1.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.1.2">𝑓</ci><apply id="S4.T1.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3"><times id="S4.T1.3.3.1.m1.1.1.3.1.cmml" xref="S4.T1.3.3.1.m1.1.1.3.1"></times><ci id="S4.T1.3.3.1.m1.1.1.3.2.cmml" xref="S4.T1.3.3.1.m1.1.1.3.2">bottom</ci><ci id="S4.T1.3.3.1.m1.1.1.3.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3.3">_</ci><ci id="S4.T1.3.3.1.m1.1.1.3.4.cmml" xref="S4.T1.3.3.1.m1.1.1.3.4">rec</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">f_{\mathrm{bottom\_rec}}</annotation></semantics></math></th>
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.3.2.1.1" class="ltx_p" style="width:144.5pt;">FC layer used for feature reconstruction in the bottom model of guest clients.</span>
</span>
</td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<th id="S4.T1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b"><math id="S4.T1.4.4.1.m1.1" class="ltx_Math" alttext="final\_mapping" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml"><mi id="S4.T1.4.4.1.m1.1.1.2" xref="S4.T1.4.4.1.m1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.3" xref="S4.T1.4.4.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1a" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.4" xref="S4.T1.4.4.1.m1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1b" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.5" xref="S4.T1.4.4.1.m1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1c" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.6" xref="S4.T1.4.4.1.m1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1d" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.T1.4.4.1.m1.1.1.7" xref="S4.T1.4.4.1.m1.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1e" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.8" xref="S4.T1.4.4.1.m1.1.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1f" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.9" xref="S4.T1.4.4.1.m1.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1g" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.10" xref="S4.T1.4.4.1.m1.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1h" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.11" xref="S4.T1.4.4.1.m1.1.1.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1i" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.12" xref="S4.T1.4.4.1.m1.1.1.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1j" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.13" xref="S4.T1.4.4.1.m1.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.4.1.m1.1.1.1k" xref="S4.T1.4.4.1.m1.1.1.1.cmml">​</mo><mi id="S4.T1.4.4.1.m1.1.1.14" xref="S4.T1.4.4.1.m1.1.1.14.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"><times id="S4.T1.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1.1"></times><ci id="S4.T1.4.4.1.m1.1.1.2.cmml" xref="S4.T1.4.4.1.m1.1.1.2">𝑓</ci><ci id="S4.T1.4.4.1.m1.1.1.3.cmml" xref="S4.T1.4.4.1.m1.1.1.3">𝑖</ci><ci id="S4.T1.4.4.1.m1.1.1.4.cmml" xref="S4.T1.4.4.1.m1.1.1.4">𝑛</ci><ci id="S4.T1.4.4.1.m1.1.1.5.cmml" xref="S4.T1.4.4.1.m1.1.1.5">𝑎</ci><ci id="S4.T1.4.4.1.m1.1.1.6.cmml" xref="S4.T1.4.4.1.m1.1.1.6">𝑙</ci><ci id="S4.T1.4.4.1.m1.1.1.7.cmml" xref="S4.T1.4.4.1.m1.1.1.7">_</ci><ci id="S4.T1.4.4.1.m1.1.1.8.cmml" xref="S4.T1.4.4.1.m1.1.1.8">𝑚</ci><ci id="S4.T1.4.4.1.m1.1.1.9.cmml" xref="S4.T1.4.4.1.m1.1.1.9">𝑎</ci><ci id="S4.T1.4.4.1.m1.1.1.10.cmml" xref="S4.T1.4.4.1.m1.1.1.10">𝑝</ci><ci id="S4.T1.4.4.1.m1.1.1.11.cmml" xref="S4.T1.4.4.1.m1.1.1.11">𝑝</ci><ci id="S4.T1.4.4.1.m1.1.1.12.cmml" xref="S4.T1.4.4.1.m1.1.1.12">𝑖</ci><ci id="S4.T1.4.4.1.m1.1.1.13.cmml" xref="S4.T1.4.4.1.m1.1.1.13">𝑛</ci><ci id="S4.T1.4.4.1.m1.1.1.14.cmml" xref="S4.T1.4.4.1.m1.1.1.14">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">final\_mapping</annotation></semantics></math></th>
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b">
<span id="S4.T1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.4.4.2.1.1" class="ltx_p" style="width:144.5pt;">The final FC layer in the finetuning model of TabVFL used for making a prediction in the host client.</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.17990/assets/x4.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">TabVFL pretraining workflow.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.17990/assets/x5.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="327" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">TabVFL finetuning workflow. </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Overview of pretraining and finetuning workflow in TabVFL.</span></figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">TabVFL Architecture Overview</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">In <a href="#S4.F3" title="Figure 3 ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 3</span></a>, the structure of TabVFL is shown in a two client setup with an example dataset. Each guest client owns distinct feature data corresponding to the same samples. The novel design is introduced in the pretraining phase of TabVFL. The encoder and decoder components of the TabNet model are split into two parts: the top and bottom models. The majority of the model is retained in the host client. This is done to be consistent with the general model design of U-shaped neural network shown in <a href="#S1.F1.sf2" title="1(b) ‣ Figure 1 ‣ I Introduction ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Many components of the TabNet pretraining model are dependent due to the sequential attention structure which makes a proper splitting of the model among the parties difficult (<a href="#S2.F2" title="Figure 2 ‣ II Preliminaries ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 2</span></a>). Nonetheless, the encoder can be conveniently split by assigning the first batch normalization (BN) layer of the TabNet encoder to the guest clients and the remaining encoder components to the host client. The reason can be deduced from the valuable observation that the BN layer is the only part that every other component depends on since the normalized values are passed to each encoder decision step and to the initial split. Moreover, the decoder can be sufficiently divided by splitting it between the feature transformers and the fully-connected (FC) layer. The FC-layer is further split uniformly into partitions such that each partition corresponds to each guest client. The FC-layers are held locally in each guest. The host only instructs the guests to initialize their FC-layer with the partition dimension. The output dimension of the feature transformers blocks is equal to the latent dimension. Therefore, it should be ensured that the latent dimension is not set to a value that is lower than the number of participating guests. The top model consists of <span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_italic">PartialEnc</span> and <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_italic">PartialDec</span>. The TabVFL pretraining model is shown in <a href="#S4.F3.sf1" title="3(a) ‣ Figure 3 ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(a)</span></a>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">The bottom model is represented by two parts: the feature extractor (left part of the bottom model) and the feature reconstructor (right part of the bottom model). The feature extractor is used to transform the raw feature data into intermediate logits. The <span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_italic">RandomObfuscator</span> is a non-learnable component used to generate binary masks which are directly applied to the features. The reason for the additional FC-layer is to transform the outputs of the BN layer in case it behaves as an identity function. This is possible when the features are already standardized and follow a standard normal distribution, rendering the BN layer useless for protecting against direct data leakage.
The feature reconstructor is there to predict the actual feature values that were used as input. The split of the decoder is crucial for preventing the host client from reverse engineering the features of the guest clients. This is possible if the host client has a particular amount of feature samples of some or all the guest clients. The encoder split was done to allow general latent representation learning of one latent vector by aggregating the intermediate logits of all guest clients at the host. The concept of a label is absent during pretraining since the goal is to accurately reconstruct the masked features resulted from the <span id="S4.SS1.p3.1.2" class="ltx_text ltx_font_italic">RandomObfuscator</span>.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">In the finetuning design, the host is the label owner. The conventional splitNN procedure is followed in order to specialize the latent representation from the encoder to a specific task. As shown in <a href="#S4.F3.sf2" title="3(b) ‣ Figure 3 ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, the decoder components are disregarded including the <span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_italic">RandomObfuscator</span> component as they are not needed for finetuning.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Threat Model</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We assume honest-but-curious setting where all participants follow the framework protocol properly without any (malicious) deviation. Specifically, we assume that the guest and host clients are honest but curious, meaning that they adhere to the TabVFL protocol, but may seek to acquire additional information through the computation process  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. We do not consider colluding host and guests. Since the model weights are initialized locally and only intermediate results are exchanged, the models in each client are considered as black box to other clients.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">TabVFL Training Procedures</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Identical training steps as in the TabNet model are followed in TabVFL. In both training phases, the host client is responsible for federating the training process in mini-batch fashion. The training workflow for pretraining and finetuning are provided with an example dataset in <a href="#S4.F3" title="Figure 3 ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 3</span></a>. Similar step numbers indicate parallel computations/communications.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.7" class="ltx_p">During the pretraining phase, the first step entails the generation of the binary masks and the transformed representation of the raw data by the guest clients ( <svg id="S4.SS3.p2.1.pic1" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p2.1.pic1.1.1.1.1.1" class="ltx_text">1</span></foreignObject></g></g></svg>). The batch of raw features is first masked using the generated masks from <span id="S4.SS3.p2.7.1" class="ltx_text ltx_font_italic">RandomObfuscator</span> which are processed by a BN and a FC layer and transmitted to the host. The binary masks and intermediate results from the guest clients are aggregated by concatenating them ( <svg id="S4.SS3.p2.2.pic2" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p2.2.pic2.1.1.1.1.1" class="ltx_text">2</span></foreignObject></g></g></svg>,  <svg id="S4.SS3.p2.3.pic3" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p2.3.pic3.1.1.1.1.1" class="ltx_text">3</span></foreignObject></g></g></svg>). The concatenated values are processed by the <span id="S4.SS3.p2.7.2" class="ltx_text ltx_font_italic">PartialEnc</span> and passed to the <span id="S4.SS3.p2.7.3" class="ltx_text ltx_font_italic">PartialDec</span> to generate intermediate decoder representations by aggregating feature transformers outputs, which are then partitioned ( <svg id="S4.SS3.p2.4.pic4" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p2.4.pic4.1.1.1.1.1" class="ltx_text">4</span></foreignObject></g></g></svg>). Each partition result is sent to its corresponding guest client for reconstructing the masked feature values ( <svg id="S4.SS3.p2.5.pic5" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p2.5.pic5.1.1.1.1.1" class="ltx_text">5</span></foreignObject></g></g></svg>). The reconstruction values are used to calculate the gradients for updating <math id="S4.SS3.p2.6.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_rec}}" display="inline"><semantics id="S4.SS3.p2.6.m1.1a"><msub id="S4.SS3.p2.6.m1.1.1" xref="S4.SS3.p2.6.m1.1.1.cmml"><mi id="S4.SS3.p2.6.m1.1.1.2" xref="S4.SS3.p2.6.m1.1.1.2.cmml">f</mi><mrow id="S4.SS3.p2.6.m1.1.1.3" xref="S4.SS3.p2.6.m1.1.1.3.cmml"><mi id="S4.SS3.p2.6.m1.1.1.3.2" xref="S4.SS3.p2.6.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m1.1.1.3.1" xref="S4.SS3.p2.6.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p2.6.m1.1.1.3.3" xref="S4.SS3.p2.6.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m1.1.1.3.1a" xref="S4.SS3.p2.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.6.m1.1.1.3.4" xref="S4.SS3.p2.6.m1.1.1.3.4.cmml">rec</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m1.1b"><apply id="S4.SS3.p2.6.m1.1.1.cmml" xref="S4.SS3.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m1.1.1.1.cmml" xref="S4.SS3.p2.6.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m1.1.1.2.cmml" xref="S4.SS3.p2.6.m1.1.1.2">𝑓</ci><apply id="S4.SS3.p2.6.m1.1.1.3.cmml" xref="S4.SS3.p2.6.m1.1.1.3"><times id="S4.SS3.p2.6.m1.1.1.3.1.cmml" xref="S4.SS3.p2.6.m1.1.1.3.1"></times><ci id="S4.SS3.p2.6.m1.1.1.3.2.cmml" xref="S4.SS3.p2.6.m1.1.1.3.2">bottom</ci><ci id="S4.SS3.p2.6.m1.1.1.3.3.cmml" xref="S4.SS3.p2.6.m1.1.1.3.3">_</ci><ci id="S4.SS3.p2.6.m1.1.1.3.4.cmml" xref="S4.SS3.p2.6.m1.1.1.3.4">rec</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m1.1c">f_{\mathrm{bottom\_rec}}</annotation></semantics></math>, <span id="S4.SS3.p2.7.4" class="ltx_text ltx_font_italic">PartialDec</span>, <span id="S4.SS3.p2.7.5" class="ltx_text ltx_font_italic">PartialEnc</span> and <math id="S4.SS3.p2.7.m2.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="S4.SS3.p2.7.m2.1a"><msub id="S4.SS3.p2.7.m2.1.1" xref="S4.SS3.p2.7.m2.1.1.cmml"><mi id="S4.SS3.p2.7.m2.1.1.2" xref="S4.SS3.p2.7.m2.1.1.2.cmml">f</mi><mrow id="S4.SS3.p2.7.m2.1.1.3" xref="S4.SS3.p2.7.m2.1.1.3.cmml"><mi id="S4.SS3.p2.7.m2.1.1.3.2" xref="S4.SS3.p2.7.m2.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.7.m2.1.1.3.1" xref="S4.SS3.p2.7.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p2.7.m2.1.1.3.3" xref="S4.SS3.p2.7.m2.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.7.m2.1.1.3.1a" xref="S4.SS3.p2.7.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.7.m2.1.1.3.4" xref="S4.SS3.p2.7.m2.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.7.m2.1.1.3.1b" xref="S4.SS3.p2.7.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p2.7.m2.1.1.3.5" xref="S4.SS3.p2.7.m2.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.7.m2.1.1.3.1c" xref="S4.SS3.p2.7.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.7.m2.1.1.3.6" xref="S4.SS3.p2.7.m2.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m2.1b"><apply id="S4.SS3.p2.7.m2.1.1.cmml" xref="S4.SS3.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m2.1.1.1.cmml" xref="S4.SS3.p2.7.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m2.1.1.2.cmml" xref="S4.SS3.p2.7.m2.1.1.2">𝑓</ci><apply id="S4.SS3.p2.7.m2.1.1.3.cmml" xref="S4.SS3.p2.7.m2.1.1.3"><times id="S4.SS3.p2.7.m2.1.1.3.1.cmml" xref="S4.SS3.p2.7.m2.1.1.3.1"></times><ci id="S4.SS3.p2.7.m2.1.1.3.2.cmml" xref="S4.SS3.p2.7.m2.1.1.3.2">bottom</ci><ci id="S4.SS3.p2.7.m2.1.1.3.3.cmml" xref="S4.SS3.p2.7.m2.1.1.3.3">_</ci><ci id="S4.SS3.p2.7.m2.1.1.3.4.cmml" xref="S4.SS3.p2.7.m2.1.1.3.4">repr</ci><ci id="S4.SS3.p2.7.m2.1.1.3.5.cmml" xref="S4.SS3.p2.7.m2.1.1.3.5">_</ci><ci id="S4.SS3.p2.7.m2.1.1.3.6.cmml" xref="S4.SS3.p2.7.m2.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m2.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.6" class="ltx_p">During finetuning, the raw features are processed by each guest client through the pretrained BN and FC layers and communicated to the host ( <svg id="S4.SS3.p3.1.pic1" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p3.1.pic1.1.1.1.1.1" class="ltx_text">1</span></foreignObject></g></g></svg>). Subsequently, the intermediate results are gathered and concatenated ( <svg id="S4.SS3.p3.2.pic2" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p3.2.pic2.1.1.1.1.1" class="ltx_text">2</span></foreignObject></g></g></svg>). The concatenated results are fed through the <span id="S4.SS3.p3.6.1" class="ltx_text ltx_font_italic">PartialEnc</span> to generate the latent representations which are processed by the <math id="S4.SS3.p3.3.m1.1" class="ltx_Math" alttext="final\_mapping" display="inline"><semantics id="S4.SS3.p3.3.m1.1a"><mrow id="S4.SS3.p3.3.m1.1.1" xref="S4.SS3.p3.3.m1.1.1.cmml"><mi id="S4.SS3.p3.3.m1.1.1.2" xref="S4.SS3.p3.3.m1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.3" xref="S4.SS3.p3.3.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1a" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.4" xref="S4.SS3.p3.3.m1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1b" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.5" xref="S4.SS3.p3.3.m1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1c" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.6" xref="S4.SS3.p3.3.m1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1d" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p3.3.m1.1.1.7" xref="S4.SS3.p3.3.m1.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1e" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.8" xref="S4.SS3.p3.3.m1.1.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1f" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.9" xref="S4.SS3.p3.3.m1.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1g" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.10" xref="S4.SS3.p3.3.m1.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1h" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.11" xref="S4.SS3.p3.3.m1.1.1.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1i" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.12" xref="S4.SS3.p3.3.m1.1.1.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1j" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.13" xref="S4.SS3.p3.3.m1.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m1.1.1.1k" xref="S4.SS3.p3.3.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.3.m1.1.1.14" xref="S4.SS3.p3.3.m1.1.1.14.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m1.1b"><apply id="S4.SS3.p3.3.m1.1.1.cmml" xref="S4.SS3.p3.3.m1.1.1"><times id="S4.SS3.p3.3.m1.1.1.1.cmml" xref="S4.SS3.p3.3.m1.1.1.1"></times><ci id="S4.SS3.p3.3.m1.1.1.2.cmml" xref="S4.SS3.p3.3.m1.1.1.2">𝑓</ci><ci id="S4.SS3.p3.3.m1.1.1.3.cmml" xref="S4.SS3.p3.3.m1.1.1.3">𝑖</ci><ci id="S4.SS3.p3.3.m1.1.1.4.cmml" xref="S4.SS3.p3.3.m1.1.1.4">𝑛</ci><ci id="S4.SS3.p3.3.m1.1.1.5.cmml" xref="S4.SS3.p3.3.m1.1.1.5">𝑎</ci><ci id="S4.SS3.p3.3.m1.1.1.6.cmml" xref="S4.SS3.p3.3.m1.1.1.6">𝑙</ci><ci id="S4.SS3.p3.3.m1.1.1.7.cmml" xref="S4.SS3.p3.3.m1.1.1.7">_</ci><ci id="S4.SS3.p3.3.m1.1.1.8.cmml" xref="S4.SS3.p3.3.m1.1.1.8">𝑚</ci><ci id="S4.SS3.p3.3.m1.1.1.9.cmml" xref="S4.SS3.p3.3.m1.1.1.9">𝑎</ci><ci id="S4.SS3.p3.3.m1.1.1.10.cmml" xref="S4.SS3.p3.3.m1.1.1.10">𝑝</ci><ci id="S4.SS3.p3.3.m1.1.1.11.cmml" xref="S4.SS3.p3.3.m1.1.1.11">𝑝</ci><ci id="S4.SS3.p3.3.m1.1.1.12.cmml" xref="S4.SS3.p3.3.m1.1.1.12">𝑖</ci><ci id="S4.SS3.p3.3.m1.1.1.13.cmml" xref="S4.SS3.p3.3.m1.1.1.13">𝑛</ci><ci id="S4.SS3.p3.3.m1.1.1.14.cmml" xref="S4.SS3.p3.3.m1.1.1.14">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m1.1c">final\_mapping</annotation></semantics></math> for predicting the corresponding label for each sample ( <svg id="S4.SS3.p3.4.pic3" class="ltx_picture" height="13.74" overflow="visible" version="1.1" width="13.74"><g transform="translate(0,13.74) matrix(1 0 0 -1 0 0) translate(6.87,0) translate(0,6.87)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000"><path d="M 6.59 0 C 6.59 3.64 3.64 6.59 0 6.59 C -3.64 6.59 -6.59 3.64 -6.59 0 C -6.59 -3.64 -3.64 -6.59 0 -6.59 C 3.64 -6.59 6.59 -3.64 6.59 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)" fill="#FFFFFF" stroke="#FFFFFF"><foreignObject width="6.92" height="8.92" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF"><span id="S4.SS3.p3.4.pic3.1.1.1.1.1" class="ltx_text">3</span></foreignObject></g></g></svg>). The predicted value is used to calculate the gradients for updating <math id="S4.SS3.p3.5.m2.1" class="ltx_Math" alttext="final\_mapping" display="inline"><semantics id="S4.SS3.p3.5.m2.1a"><mrow id="S4.SS3.p3.5.m2.1.1" xref="S4.SS3.p3.5.m2.1.1.cmml"><mi id="S4.SS3.p3.5.m2.1.1.2" xref="S4.SS3.p3.5.m2.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.3" xref="S4.SS3.p3.5.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1a" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.4" xref="S4.SS3.p3.5.m2.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1b" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.5" xref="S4.SS3.p3.5.m2.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1c" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.6" xref="S4.SS3.p3.5.m2.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1d" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p3.5.m2.1.1.7" xref="S4.SS3.p3.5.m2.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1e" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.8" xref="S4.SS3.p3.5.m2.1.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1f" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.9" xref="S4.SS3.p3.5.m2.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1g" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.10" xref="S4.SS3.p3.5.m2.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1h" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.11" xref="S4.SS3.p3.5.m2.1.1.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1i" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.12" xref="S4.SS3.p3.5.m2.1.1.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1j" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.13" xref="S4.SS3.p3.5.m2.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m2.1.1.1k" xref="S4.SS3.p3.5.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p3.5.m2.1.1.14" xref="S4.SS3.p3.5.m2.1.1.14.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m2.1b"><apply id="S4.SS3.p3.5.m2.1.1.cmml" xref="S4.SS3.p3.5.m2.1.1"><times id="S4.SS3.p3.5.m2.1.1.1.cmml" xref="S4.SS3.p3.5.m2.1.1.1"></times><ci id="S4.SS3.p3.5.m2.1.1.2.cmml" xref="S4.SS3.p3.5.m2.1.1.2">𝑓</ci><ci id="S4.SS3.p3.5.m2.1.1.3.cmml" xref="S4.SS3.p3.5.m2.1.1.3">𝑖</ci><ci id="S4.SS3.p3.5.m2.1.1.4.cmml" xref="S4.SS3.p3.5.m2.1.1.4">𝑛</ci><ci id="S4.SS3.p3.5.m2.1.1.5.cmml" xref="S4.SS3.p3.5.m2.1.1.5">𝑎</ci><ci id="S4.SS3.p3.5.m2.1.1.6.cmml" xref="S4.SS3.p3.5.m2.1.1.6">𝑙</ci><ci id="S4.SS3.p3.5.m2.1.1.7.cmml" xref="S4.SS3.p3.5.m2.1.1.7">_</ci><ci id="S4.SS3.p3.5.m2.1.1.8.cmml" xref="S4.SS3.p3.5.m2.1.1.8">𝑚</ci><ci id="S4.SS3.p3.5.m2.1.1.9.cmml" xref="S4.SS3.p3.5.m2.1.1.9">𝑎</ci><ci id="S4.SS3.p3.5.m2.1.1.10.cmml" xref="S4.SS3.p3.5.m2.1.1.10">𝑝</ci><ci id="S4.SS3.p3.5.m2.1.1.11.cmml" xref="S4.SS3.p3.5.m2.1.1.11">𝑝</ci><ci id="S4.SS3.p3.5.m2.1.1.12.cmml" xref="S4.SS3.p3.5.m2.1.1.12">𝑖</ci><ci id="S4.SS3.p3.5.m2.1.1.13.cmml" xref="S4.SS3.p3.5.m2.1.1.13">𝑛</ci><ci id="S4.SS3.p3.5.m2.1.1.14.cmml" xref="S4.SS3.p3.5.m2.1.1.14">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m2.1c">final\_mapping</annotation></semantics></math>, <span id="S4.SS3.p3.6.2" class="ltx_text ltx_font_italic">PartialEnc</span> and <math id="S4.SS3.p3.6.m3.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}" display="inline"><semantics id="S4.SS3.p3.6.m3.1a"><msub id="S4.SS3.p3.6.m3.1.1" xref="S4.SS3.p3.6.m3.1.1.cmml"><mi id="S4.SS3.p3.6.m3.1.1.2" xref="S4.SS3.p3.6.m3.1.1.2.cmml">f</mi><mrow id="S4.SS3.p3.6.m3.1.1.3" xref="S4.SS3.p3.6.m3.1.1.3.cmml"><mi id="S4.SS3.p3.6.m3.1.1.3.2" xref="S4.SS3.p3.6.m3.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m3.1.1.3.1" xref="S4.SS3.p3.6.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p3.6.m3.1.1.3.3" xref="S4.SS3.p3.6.m3.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m3.1.1.3.1a" xref="S4.SS3.p3.6.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p3.6.m3.1.1.3.4" xref="S4.SS3.p3.6.m3.1.1.3.4.cmml">repr</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m3.1b"><apply id="S4.SS3.p3.6.m3.1.1.cmml" xref="S4.SS3.p3.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m3.1.1.1.cmml" xref="S4.SS3.p3.6.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.6.m3.1.1.2.cmml" xref="S4.SS3.p3.6.m3.1.1.2">𝑓</ci><apply id="S4.SS3.p3.6.m3.1.1.3.cmml" xref="S4.SS3.p3.6.m3.1.1.3"><times id="S4.SS3.p3.6.m3.1.1.3.1.cmml" xref="S4.SS3.p3.6.m3.1.1.3.1"></times><ci id="S4.SS3.p3.6.m3.1.1.3.2.cmml" xref="S4.SS3.p3.6.m3.1.1.3.2">bottom</ci><ci id="S4.SS3.p3.6.m3.1.1.3.3.cmml" xref="S4.SS3.p3.6.m3.1.1.3.3">_</ci><ci id="S4.SS3.p3.6.m3.1.1.3.4.cmml" xref="S4.SS3.p3.6.m3.1.1.3.4">repr</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m3.1c">f_{\mathrm{bottom\_repr}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">In each training phase, one epoch/iteration is finished once the weights are updated by executing the described workflow.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Training Details</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.4" class="ltx_p">The details of the training phases for pretraining and finetuning are presented in <a href="#alg1" title="1 ‣ IV-D Training Details ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 1</span></a> and <a href="#alg2" title="2 ‣ IV-E Client Failure Handling ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 2</span></a>. The training of TabVFL starts off with the pretraining phase. Each guest first initializes its own bottom models <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">f</mi><mrow id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1a" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.1.m1.1.1.3.4" xref="S4.SS4.p1.1.m1.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1b" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.1.m1.1.1.3.5" xref="S4.SS4.p1.1.m1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1c" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.1.m1.1.1.3.6" xref="S4.SS4.p1.1.m1.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝑓</ci><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><times id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3.1"></times><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">bottom</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3">_</ci><ci id="S4.SS4.p1.1.m1.1.1.3.4.cmml" xref="S4.SS4.p1.1.m1.1.1.3.4">repr</ci><ci id="S4.SS4.p1.1.m1.1.1.3.5.cmml" xref="S4.SS4.p1.1.m1.1.1.3.5">_</ci><ci id="S4.SS4.p1.1.m1.1.1.3.6.cmml" xref="S4.SS4.p1.1.m1.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math> and <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_rec}}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">f</mi><mrow id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.p1.2.m2.1.1.3.2" xref="S4.SS4.p1.2.m2.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.2.m2.1.1.3.3" xref="S4.SS4.p1.2.m2.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1a" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.4" xref="S4.SS4.p1.2.m2.1.1.3.4.cmml">rec</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑓</ci><apply id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><times id="S4.SS4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.p1.2.m2.1.1.3.1"></times><ci id="S4.SS4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.p1.2.m2.1.1.3.2">bottom</ci><ci id="S4.SS4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3.3">_</ci><ci id="S4.SS4.p1.2.m2.1.1.3.4.cmml" xref="S4.SS4.p1.2.m2.1.1.3.4">rec</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">f_{\mathrm{bottom\_rec}}</annotation></semantics></math> (line <span id="S4.SS4.p1.4.1" class="ltx_text ltx_font_bold">1</span>). Simultaneously, the host initializes the <span id="S4.SS4.p1.4.2" class="ltx_text ltx_font_italic">PartialEnc</span> and <span id="S4.SS4.p1.4.3" class="ltx_text ltx_font_italic">PartialDec</span> models (line <span id="S4.SS4.p1.4.4" class="ltx_text ltx_font_bold">7</span>). The guest clients start the forward propagation by generating binary masks and apply them to the raw feature data. The masked batch is processed by <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><msub id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">f</mi><mrow id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.3.1" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.3.1a" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.3.m3.1.1.3.4" xref="S4.SS4.p1.3.m3.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.3.1b" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.3.m3.1.1.3.5" xref="S4.SS4.p1.3.m3.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.3.1c" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.3.m3.1.1.3.6" xref="S4.SS4.p1.3.m3.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝑓</ci><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><times id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3.1"></times><ci id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">bottom</ci><ci id="S4.SS4.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3">_</ci><ci id="S4.SS4.p1.3.m3.1.1.3.4.cmml" xref="S4.SS4.p1.3.m3.1.1.3.4">repr</ci><ci id="S4.SS4.p1.3.m3.1.1.3.5.cmml" xref="S4.SS4.p1.3.m3.1.1.3.5">_</ci><ci id="S4.SS4.p1.3.m3.1.1.3.6.cmml" xref="S4.SS4.p1.3.m3.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math> model and sent to host (lines <span id="S4.SS4.p1.4.5" class="ltx_text ltx_font_bold">4</span>-<span id="S4.SS4.p1.4.6" class="ltx_text ltx_font_bold">6</span>). The host receives the intermediate results and the binary masks which are both concatenated into one vector separately (lines <span id="S4.SS4.p1.4.7" class="ltx_text ltx_font_bold">13</span>-<span id="S4.SS4.p1.4.8" class="ltx_text ltx_font_bold">16</span>). The results are also cached for the client handling method described in <a href="#S4.SS5" title="IV-E Client Failure Handling ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Sec. <span class="ltx_text">IV-E</span></span></a>. Although the host can generate random binary masks itself, the binary masks are cached instead as well to not break its correlation with the corresponding intermediate results. The concatenated values are fed to the <span id="S4.SS4.p1.4.9" class="ltx_text ltx_font_italic">PartialEnc</span> to generate the corresponding latent vector. The latent vector is in turn processed by the <span id="S4.SS4.p1.4.10" class="ltx_text ltx_font_italic">PartialDec</span> to create the intermediate decoder representations (lines <span id="S4.SS4.p1.4.11" class="ltx_text ltx_font_bold">17</span>-<span id="S4.SS4.p1.4.12" class="ltx_text ltx_font_bold">18</span>). The decoder results are split into uniform chunks where each chunk corresponds to one guest client. The chunks are sent to each guest for reconstruction (lines <span id="S4.SS4.p1.4.13" class="ltx_text ltx_font_bold">19</span>-<span id="S4.SS4.p1.4.14" class="ltx_text ltx_font_bold">21</span>). The guests receive their intermediate decoder results and reconstruct the masked features using <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_rec}}" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">f</mi><mrow id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml"><mi id="S4.SS4.p1.4.m4.1.1.3.2" xref="S4.SS4.p1.4.m4.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.1.1.3.1" xref="S4.SS4.p1.4.m4.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p1.4.m4.1.1.3.3" xref="S4.SS4.p1.4.m4.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.1.1.3.1a" xref="S4.SS4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.4.m4.1.1.3.4" xref="S4.SS4.p1.4.m4.1.1.3.4.cmml">rec</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝑓</ci><apply id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3"><times id="S4.SS4.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.p1.4.m4.1.1.3.1"></times><ci id="S4.SS4.p1.4.m4.1.1.3.2.cmml" xref="S4.SS4.p1.4.m4.1.1.3.2">bottom</ci><ci id="S4.SS4.p1.4.m4.1.1.3.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3.3">_</ci><ci id="S4.SS4.p1.4.m4.1.1.3.4.cmml" xref="S4.SS4.p1.4.m4.1.1.3.4">rec</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">f_{\mathrm{bottom\_rec}}</annotation></semantics></math>. The output is compared with the actual feature values for calculating the reconstruction loss (lines <span id="S4.SS4.p1.4.15" class="ltx_text ltx_font_bold">22</span>-<span id="S4.SS4.p1.4.16" class="ltx_text ltx_font_bold">24</span>). For backpropagation, one loss value is required. To achieve this, each guest client is ordered to send its loss to the host. The accumulation of the losses takes place and the result is used to calculate the gradients and update the weights of the top and bottom models (lines <span id="S4.SS4.p1.4.17" class="ltx_text ltx_font_bold">25</span>-<span id="S4.SS4.p1.4.18" class="ltx_text ltx_font_bold">32</span>). A modified version of the MSE function is used in TabNet to account for the binary mask and feature ranges for a more stable loss calculation.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.4" class="ltx_p">During finetuning, the weights of the FC and BN layers in <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><msub id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">f</mi><mrow id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.3.2" xref="S4.SS4.p2.1.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.3.1" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p2.1.m1.1.1.3.3" xref="S4.SS4.p2.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.3.1a" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.1.m1.1.1.3.4" xref="S4.SS4.p2.1.m1.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.3.1b" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p2.1.m1.1.1.3.5" xref="S4.SS4.p2.1.m1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.3.1c" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.1.m1.1.1.3.6" xref="S4.SS4.p2.1.m1.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑓</ci><apply id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3"><times id="S4.SS4.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.3.1"></times><ci id="S4.SS4.p2.1.m1.1.1.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.3.2">bottom</ci><ci id="S4.SS4.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3">_</ci><ci id="S4.SS4.p2.1.m1.1.1.3.4.cmml" xref="S4.SS4.p2.1.m1.1.1.3.4">repr</ci><ci id="S4.SS4.p2.1.m1.1.1.3.5.cmml" xref="S4.SS4.p2.1.m1.1.1.3.5">_</ci><ci id="S4.SS4.p2.1.m1.1.1.3.6.cmml" xref="S4.SS4.p2.1.m1.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math> are copied over in <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><msub id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">f</mi><mrow id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml"><mi id="S4.SS4.p2.2.m2.1.1.3.2" xref="S4.SS4.p2.2.m2.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.1.1.3.1" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p2.2.m2.1.1.3.3" xref="S4.SS4.p2.2.m2.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.1.1.3.1a" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.2.m2.1.1.3.4" xref="S4.SS4.p2.2.m2.1.1.3.4.cmml">repr</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝑓</ci><apply id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3"><times id="S4.SS4.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.1.1.3.1"></times><ci id="S4.SS4.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.p2.2.m2.1.1.3.2">bottom</ci><ci id="S4.SS4.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3.3">_</ci><ci id="S4.SS4.p2.2.m2.1.1.3.4.cmml" xref="S4.SS4.p2.2.m2.1.1.3.4">repr</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">f_{\mathrm{bottom\_repr}}</annotation></semantics></math> for further finetuning (line <span id="S4.SS4.p2.4.1" class="ltx_text ltx_font_bold">1</span>). The host now uses the pretrained <span id="S4.SS4.p2.4.2" class="ltx_text ltx_font_italic">PartialEnc</span> and initializes a <span id="S4.SS4.p2.4.3" class="ltx_text ltx_font_italic">final_mapping</span> containing an FC layer for prediction (line <span id="S4.SS4.p2.4.4" class="ltx_text ltx_font_bold">5</span>-<span id="S4.SS4.p2.4.5" class="ltx_text ltx_font_bold">6</span>). The first step of the forward pass is sending the intermediate results, from applying <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><msub id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">f</mi><mrow id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml"><mi id="S4.SS4.p2.3.m3.1.1.3.2" xref="S4.SS4.p2.3.m3.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.3.m3.1.1.3.1" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS4.p2.3.m3.1.1.3.3" xref="S4.SS4.p2.3.m3.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.3.m3.1.1.3.1a" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.3.m3.1.1.3.4" xref="S4.SS4.p2.3.m3.1.1.3.4.cmml">repr</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝑓</ci><apply id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3"><times id="S4.SS4.p2.3.m3.1.1.3.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3.1"></times><ci id="S4.SS4.p2.3.m3.1.1.3.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.2">bottom</ci><ci id="S4.SS4.p2.3.m3.1.1.3.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3">_</ci><ci id="S4.SS4.p2.3.m3.1.1.3.4.cmml" xref="S4.SS4.p2.3.m3.1.1.3.4">repr</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">f_{\mathrm{bottom\_repr}}</annotation></semantics></math> to the raw features, to the host (line <span id="S4.SS4.p2.4.6" class="ltx_text ltx_font_bold">4</span>). The host receives the transmitted data from each guest client and caches it to handle possible client failures (line <span id="S4.SS4.p2.4.7" class="ltx_text ltx_font_bold">11</span>). Similar to pretraining, a vector with concatenated intermediate results is created which is passed to the <span id="S4.SS4.p2.4.8" class="ltx_text ltx_font_italic">PartialEnc</span>. The <span id="S4.SS4.p2.4.9" class="ltx_text ltx_font_italic">PartialEnc</span> now also generates <span id="S4.SS4.p2.4.10" class="ltx_text ltx_font_italic">M_Loss</span> along with the latent vector (lines <span id="S4.SS4.p2.4.11" class="ltx_text ltx_font_bold">12</span>-<span id="S4.SS4.p2.4.12" class="ltx_text ltx_font_bold">13</span>). The final logits are created from passing the latent vector through the <span id="S4.SS4.p2.4.13" class="ltx_text ltx_font_italic">final_mapping</span> layer. Afterwards, the final logits are softmaxed to create normalized prediction probabilities from logits. The loss is calculated by comparing the prediction probabilities and the actual label values (lines <span id="S4.SS4.p2.4.14" class="ltx_text ltx_font_bold">14</span>-<span id="S4.SS4.p2.4.15" class="ltx_text ltx_font_bold">16</span>). Finally, the <span id="S4.SS4.p2.4.16" class="ltx_text ltx_font_italic">M_loss</span> is multiplied by the regularization parameter <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="\lambda_{sparse}" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><msub id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml"><mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">λ</mi><mrow id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml"><mi id="S4.SS4.p2.4.m4.1.1.3.2" xref="S4.SS4.p2.4.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.4.m4.1.1.3.1" xref="S4.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.4.m4.1.1.3.3" xref="S4.SS4.p2.4.m4.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.4.m4.1.1.3.1a" xref="S4.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.4.m4.1.1.3.4" xref="S4.SS4.p2.4.m4.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.4.m4.1.1.3.1b" xref="S4.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.4.m4.1.1.3.5" xref="S4.SS4.p2.4.m4.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.4.m4.1.1.3.1c" xref="S4.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.4.m4.1.1.3.6" xref="S4.SS4.p2.4.m4.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.4.m4.1.1.3.1d" xref="S4.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p2.4.m4.1.1.3.7" xref="S4.SS4.p2.4.m4.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">𝜆</ci><apply id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3"><times id="S4.SS4.p2.4.m4.1.1.3.1.cmml" xref="S4.SS4.p2.4.m4.1.1.3.1"></times><ci id="S4.SS4.p2.4.m4.1.1.3.2.cmml" xref="S4.SS4.p2.4.m4.1.1.3.2">𝑠</ci><ci id="S4.SS4.p2.4.m4.1.1.3.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3.3">𝑝</ci><ci id="S4.SS4.p2.4.m4.1.1.3.4.cmml" xref="S4.SS4.p2.4.m4.1.1.3.4">𝑎</ci><ci id="S4.SS4.p2.4.m4.1.1.3.5.cmml" xref="S4.SS4.p2.4.m4.1.1.3.5">𝑟</ci><ci id="S4.SS4.p2.4.m4.1.1.3.6.cmml" xref="S4.SS4.p2.4.m4.1.1.3.6">𝑠</ci><ci id="S4.SS4.p2.4.m4.1.1.3.7.cmml" xref="S4.SS4.p2.4.m4.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">\lambda_{sparse}</annotation></semantics></math>. The <span id="S4.SS4.p2.4.17" class="ltx_text ltx_font_italic">M_loss</span> is used for regularizing the sparsity of the feature selection made by the attentive layer of TabNet. This is to encourage the model to only pick important features for datasets that have few features that are relevant.
The final loss value is used to calculate gradients and update the weights accordingly (lines <span id="S4.SS4.p2.4.18" class="ltx_text ltx_font_bold">17</span>-<span id="S4.SS4.p2.4.19" class="ltx_text ltx_font_bold">18</span>). The classification loss represents the cross entropy.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">Note that the host is considered to be the federator which instructs the guest clients to send and receive data during training and inference.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.45" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.45.46" class="ltx_listingline">
<span id="alg1.45.46.1" class="ltx_text"><span id="alg1.45.46.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>

</div>
<div id="alg1.1.1" class="ltx_listingline">NumClients = <math id="alg1.1.1.m1.3" class="ltx_Math" alttext="\{1,2,...K\}" display="inline"><semantics id="alg1.1.1.m1.3a"><mrow id="alg1.1.1.m1.3.3.1" xref="alg1.1.1.m1.3.3.2.cmml"><mo stretchy="false" id="alg1.1.1.m1.3.3.1.2" xref="alg1.1.1.m1.3.3.2.cmml">{</mo><mn id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">1</mn><mo id="alg1.1.1.m1.3.3.1.3" xref="alg1.1.1.m1.3.3.2.cmml">,</mo><mn id="alg1.1.1.m1.2.2" xref="alg1.1.1.m1.2.2.cmml">2</mn><mo id="alg1.1.1.m1.3.3.1.4" xref="alg1.1.1.m1.3.3.2.cmml">,</mo><mrow id="alg1.1.1.m1.3.3.1.1" xref="alg1.1.1.m1.3.3.1.1.cmml"><mi mathvariant="normal" id="alg1.1.1.m1.3.3.1.1.2" xref="alg1.1.1.m1.3.3.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.1.1.m1.3.3.1.1.1" xref="alg1.1.1.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.1.1.m1.3.3.1.1.3" xref="alg1.1.1.m1.3.3.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="alg1.1.1.m1.3.3.1.5" xref="alg1.1.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.3b"><set id="alg1.1.1.m1.3.3.2.cmml" xref="alg1.1.1.m1.3.3.1"><cn type="integer" id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">1</cn><cn type="integer" id="alg1.1.1.m1.2.2.cmml" xref="alg1.1.1.m1.2.2">2</cn><apply id="alg1.1.1.m1.3.3.1.1.cmml" xref="alg1.1.1.m1.3.3.1.1"><times id="alg1.1.1.m1.3.3.1.1.1.cmml" xref="alg1.1.1.m1.3.3.1.1.1"></times><ci id="alg1.1.1.m1.3.3.1.1.2.cmml" xref="alg1.1.1.m1.3.3.1.1.2">…</ci><ci id="alg1.1.1.m1.3.3.1.1.3.cmml" xref="alg1.1.1.m1.3.3.1.1.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.3c">\{1,2,...K\}</annotation></semantics></math>

</div>
<div id="alg1.2.2" class="ltx_listingline">Epochs = <math id="alg1.2.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.2.2.m1.1a"><mi id="alg1.2.2.m1.1.1" xref="alg1.2.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.1b"><ci id="alg1.2.2.m1.1.1.cmml" xref="alg1.2.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.1c">E</annotation></semantics></math>

</div>
<div id="alg1.6.6" class="ltx_listingline">Feature Dataset <math id="alg1.3.3.m1.1" class="ltx_Math" alttext="X_{i}" display="inline"><semantics id="alg1.3.3.m1.1a"><msub id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml"><mi id="alg1.3.3.m1.1.1.2" xref="alg1.3.3.m1.1.1.2.cmml">X</mi><mi id="alg1.3.3.m1.1.1.3" xref="alg1.3.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><apply id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1"><csymbol cd="ambiguous" id="alg1.3.3.m1.1.1.1.cmml" xref="alg1.3.3.m1.1.1">subscript</csymbol><ci id="alg1.3.3.m1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.2">𝑋</ci><ci id="alg1.3.3.m1.1.1.3.cmml" xref="alg1.3.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">X_{i}</annotation></semantics></math> <span id="alg1.6.6.1" class="ltx_text">of party</span> <math id="alg1.4.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.4.4.m2.1a"><mi id="alg1.4.4.m2.1.1" xref="alg1.4.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.m2.1b"><ci id="alg1.4.4.m2.1.1.cmml" xref="alg1.4.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m2.1c">i</annotation></semantics></math> <math id="alg1.5.5.m3.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg1.5.5.m3.1a"><mo id="alg1.5.5.m3.1.1" xref="alg1.5.5.m3.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg1.5.5.m3.1b"><in id="alg1.5.5.m3.1.1.cmml" xref="alg1.5.5.m3.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m3.1c">\in</annotation></semantics></math> <math id="alg1.6.6.m4.3" class="ltx_Math" alttext="\{2,3,...K\}" display="inline"><semantics id="alg1.6.6.m4.3a"><mrow id="alg1.6.6.m4.3.3.1" xref="alg1.6.6.m4.3.3.2.cmml"><mo stretchy="false" id="alg1.6.6.m4.3.3.1.2" xref="alg1.6.6.m4.3.3.2.cmml">{</mo><mn id="alg1.6.6.m4.1.1" xref="alg1.6.6.m4.1.1.cmml">2</mn><mo id="alg1.6.6.m4.3.3.1.3" xref="alg1.6.6.m4.3.3.2.cmml">,</mo><mn id="alg1.6.6.m4.2.2" xref="alg1.6.6.m4.2.2.cmml">3</mn><mo id="alg1.6.6.m4.3.3.1.4" xref="alg1.6.6.m4.3.3.2.cmml">,</mo><mrow id="alg1.6.6.m4.3.3.1.1" xref="alg1.6.6.m4.3.3.1.1.cmml"><mi mathvariant="normal" id="alg1.6.6.m4.3.3.1.1.2" xref="alg1.6.6.m4.3.3.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.6.6.m4.3.3.1.1.1" xref="alg1.6.6.m4.3.3.1.1.1.cmml">​</mo><mi id="alg1.6.6.m4.3.3.1.1.3" xref="alg1.6.6.m4.3.3.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="alg1.6.6.m4.3.3.1.5" xref="alg1.6.6.m4.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.m4.3b"><set id="alg1.6.6.m4.3.3.2.cmml" xref="alg1.6.6.m4.3.3.1"><cn type="integer" id="alg1.6.6.m4.1.1.cmml" xref="alg1.6.6.m4.1.1">2</cn><cn type="integer" id="alg1.6.6.m4.2.2.cmml" xref="alg1.6.6.m4.2.2">3</cn><apply id="alg1.6.6.m4.3.3.1.1.cmml" xref="alg1.6.6.m4.3.3.1.1"><times id="alg1.6.6.m4.3.3.1.1.1.cmml" xref="alg1.6.6.m4.3.3.1.1.1"></times><ci id="alg1.6.6.m4.3.3.1.1.2.cmml" xref="alg1.6.6.m4.3.3.1.1.2">…</ci><ci id="alg1.6.6.m4.3.3.1.1.3.cmml" xref="alg1.6.6.m4.3.3.1.1.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m4.3c">\{2,3,...K\}</annotation></semantics></math>

</div>
<div id="alg1.45.47" class="ltx_listingline">
<span id="alg1.45.47.1" class="ltx_text">/* </span><span id="alg1.45.47.2" class="ltx_text ltx_font_bold">Guests:</span>  */
</div>
<div id="alg1.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="alg1.7.7.1" class="ltx_text ltx_font_bold">initialize</span> local models <math id="alg1.7.7.m1.2" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}},f_{\mathrm{bottom\_rec}}" display="inline"><semantics id="alg1.7.7.m1.2a"><mrow id="alg1.7.7.m1.2.2.2" xref="alg1.7.7.m1.2.2.3.cmml"><msub id="alg1.7.7.m1.1.1.1.1" xref="alg1.7.7.m1.1.1.1.1.cmml"><mi id="alg1.7.7.m1.1.1.1.1.2" xref="alg1.7.7.m1.1.1.1.1.2.cmml">f</mi><mrow id="alg1.7.7.m1.1.1.1.1.3" xref="alg1.7.7.m1.1.1.1.1.3.cmml"><mi id="alg1.7.7.m1.1.1.1.1.3.2" xref="alg1.7.7.m1.1.1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.1.1.1.1.3.1" xref="alg1.7.7.m1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.7.7.m1.1.1.1.1.3.3" xref="alg1.7.7.m1.1.1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.1.1.1.1.3.1a" xref="alg1.7.7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.7.7.m1.1.1.1.1.3.4" xref="alg1.7.7.m1.1.1.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.1.1.1.1.3.1b" xref="alg1.7.7.m1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.7.7.m1.1.1.1.1.3.5" xref="alg1.7.7.m1.1.1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.1.1.1.1.3.1c" xref="alg1.7.7.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.7.7.m1.1.1.1.1.3.6" xref="alg1.7.7.m1.1.1.1.1.3.6.cmml">bin</mi></mrow></msub><mo id="alg1.7.7.m1.2.2.2.3" xref="alg1.7.7.m1.2.2.3.cmml">,</mo><msub id="alg1.7.7.m1.2.2.2.2" xref="alg1.7.7.m1.2.2.2.2.cmml"><mi id="alg1.7.7.m1.2.2.2.2.2" xref="alg1.7.7.m1.2.2.2.2.2.cmml">f</mi><mrow id="alg1.7.7.m1.2.2.2.2.3" xref="alg1.7.7.m1.2.2.2.2.3.cmml"><mi id="alg1.7.7.m1.2.2.2.2.3.2" xref="alg1.7.7.m1.2.2.2.2.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.2.2.2.2.3.1" xref="alg1.7.7.m1.2.2.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.7.7.m1.2.2.2.2.3.3" xref="alg1.7.7.m1.2.2.2.2.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.7.7.m1.2.2.2.2.3.1a" xref="alg1.7.7.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.7.7.m1.2.2.2.2.3.4" xref="alg1.7.7.m1.2.2.2.2.3.4.cmml">rec</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.2b"><list id="alg1.7.7.m1.2.2.3.cmml" xref="alg1.7.7.m1.2.2.2"><apply id="alg1.7.7.m1.1.1.1.1.cmml" xref="alg1.7.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.7.7.m1.1.1.1.1.1.cmml" xref="alg1.7.7.m1.1.1.1.1">subscript</csymbol><ci id="alg1.7.7.m1.1.1.1.1.2.cmml" xref="alg1.7.7.m1.1.1.1.1.2">𝑓</ci><apply id="alg1.7.7.m1.1.1.1.1.3.cmml" xref="alg1.7.7.m1.1.1.1.1.3"><times id="alg1.7.7.m1.1.1.1.1.3.1.cmml" xref="alg1.7.7.m1.1.1.1.1.3.1"></times><ci id="alg1.7.7.m1.1.1.1.1.3.2.cmml" xref="alg1.7.7.m1.1.1.1.1.3.2">bottom</ci><ci id="alg1.7.7.m1.1.1.1.1.3.3.cmml" xref="alg1.7.7.m1.1.1.1.1.3.3">_</ci><ci id="alg1.7.7.m1.1.1.1.1.3.4.cmml" xref="alg1.7.7.m1.1.1.1.1.3.4">repr</ci><ci id="alg1.7.7.m1.1.1.1.1.3.5.cmml" xref="alg1.7.7.m1.1.1.1.1.3.5">_</ci><ci id="alg1.7.7.m1.1.1.1.1.3.6.cmml" xref="alg1.7.7.m1.1.1.1.1.3.6">bin</ci></apply></apply><apply id="alg1.7.7.m1.2.2.2.2.cmml" xref="alg1.7.7.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.7.7.m1.2.2.2.2.1.cmml" xref="alg1.7.7.m1.2.2.2.2">subscript</csymbol><ci id="alg1.7.7.m1.2.2.2.2.2.cmml" xref="alg1.7.7.m1.2.2.2.2.2">𝑓</ci><apply id="alg1.7.7.m1.2.2.2.2.3.cmml" xref="alg1.7.7.m1.2.2.2.2.3"><times id="alg1.7.7.m1.2.2.2.2.3.1.cmml" xref="alg1.7.7.m1.2.2.2.2.3.1"></times><ci id="alg1.7.7.m1.2.2.2.2.3.2.cmml" xref="alg1.7.7.m1.2.2.2.2.3.2">bottom</ci><ci id="alg1.7.7.m1.2.2.2.2.3.3.cmml" xref="alg1.7.7.m1.2.2.2.2.3.3">_</ci><ci id="alg1.7.7.m1.2.2.2.2.3.4.cmml" xref="alg1.7.7.m1.2.2.2.2.3.4">rec</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.2c">f_{\mathrm{bottom\_repr\_bin}},f_{\mathrm{bottom\_rec}}</annotation></semantics></math>

</div>
<div id="alg1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="alg1.8.8.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.8.8.1" class="ltx_emph ltx_font_italic"><math id="alg1.8.8.1.m1.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg1.8.8.1.m1.1a"><mrow id="alg1.8.8.1.m1.1.1" xref="alg1.8.8.1.m1.1.1.cmml"><mi id="alg1.8.8.1.m1.1.1.2" xref="alg1.8.8.1.m1.1.1.2.cmml">e</mi><mo id="alg1.8.8.1.m1.1.1.1" xref="alg1.8.8.1.m1.1.1.1.cmml">∈</mo><mi id="alg1.8.8.1.m1.1.1.3" xref="alg1.8.8.1.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.8.8.1.m1.1b"><apply id="alg1.8.8.1.m1.1.1.cmml" xref="alg1.8.8.1.m1.1.1"><in id="alg1.8.8.1.m1.1.1.1.cmml" xref="alg1.8.8.1.m1.1.1.1"></in><ci id="alg1.8.8.1.m1.1.1.2.cmml" xref="alg1.8.8.1.m1.1.1.2">𝑒</ci><ci id="alg1.8.8.1.m1.1.1.3.cmml" xref="alg1.8.8.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.1.m1.1c">e\in E</annotation></semantics></math></em> <span id="alg1.8.8.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.9.9.1" class="ltx_emph ltx_font_italic">each mini-batch <math id="alg1.9.9.1.m1.1" class="ltx_Math" alttext="X_{b}\in B" display="inline"><semantics id="alg1.9.9.1.m1.1a"><mrow id="alg1.9.9.1.m1.1.1" xref="alg1.9.9.1.m1.1.1.cmml"><msub id="alg1.9.9.1.m1.1.1.2" xref="alg1.9.9.1.m1.1.1.2.cmml"><mi id="alg1.9.9.1.m1.1.1.2.2" xref="alg1.9.9.1.m1.1.1.2.2.cmml">X</mi><mi id="alg1.9.9.1.m1.1.1.2.3" xref="alg1.9.9.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="alg1.9.9.1.m1.1.1.1" xref="alg1.9.9.1.m1.1.1.1.cmml">∈</mo><mi id="alg1.9.9.1.m1.1.1.3" xref="alg1.9.9.1.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.1.m1.1b"><apply id="alg1.9.9.1.m1.1.1.cmml" xref="alg1.9.9.1.m1.1.1"><in id="alg1.9.9.1.m1.1.1.1.cmml" xref="alg1.9.9.1.m1.1.1.1"></in><apply id="alg1.9.9.1.m1.1.1.2.cmml" xref="alg1.9.9.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.9.9.1.m1.1.1.2.1.cmml" xref="alg1.9.9.1.m1.1.1.2">subscript</csymbol><ci id="alg1.9.9.1.m1.1.1.2.2.cmml" xref="alg1.9.9.1.m1.1.1.2.2">𝑋</ci><ci id="alg1.9.9.1.m1.1.1.2.3.cmml" xref="alg1.9.9.1.m1.1.1.2.3">𝑏</ci></apply><ci id="alg1.9.9.1.m1.1.1.3.cmml" xref="alg1.9.9.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.1.m1.1c">X_{b}\in B</annotation></semantics></math></em> <span id="alg1.9.9.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.45.48" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Generate binary mask <math id="alg1.10.10.m1.1" class="ltx_Math" alttext="S_{b}" display="inline"><semantics id="alg1.10.10.m1.1a"><msub id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1.cmml"><mi id="alg1.10.10.m1.1.1.2" xref="alg1.10.10.m1.1.1.2.cmml">S</mi><mi id="alg1.10.10.m1.1.1.3" xref="alg1.10.10.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.1.1.cmml" xref="alg1.10.10.m1.1.1">subscript</csymbol><ci id="alg1.10.10.m1.1.1.2.cmml" xref="alg1.10.10.m1.1.1.2">𝑆</ci><ci id="alg1.10.10.m1.1.1.3.cmml" xref="alg1.10.10.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">S_{b}</annotation></semantics></math>

</div>
<div id="alg1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.11.11.m1.1" class="ltx_Math" alttext="X_{b}^{masked}" display="inline"><semantics id="alg1.11.11.m1.1a"><msubsup id="alg1.11.11.m1.1.1" xref="alg1.11.11.m1.1.1.cmml"><mi id="alg1.11.11.m1.1.1.2.2" xref="alg1.11.11.m1.1.1.2.2.cmml">X</mi><mi id="alg1.11.11.m1.1.1.2.3" xref="alg1.11.11.m1.1.1.2.3.cmml">b</mi><mrow id="alg1.11.11.m1.1.1.3" xref="alg1.11.11.m1.1.1.3.cmml"><mi id="alg1.11.11.m1.1.1.3.2" xref="alg1.11.11.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.11.11.m1.1.1.3.1" xref="alg1.11.11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.11.11.m1.1.1.3.3" xref="alg1.11.11.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.11.11.m1.1.1.3.1a" xref="alg1.11.11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.11.11.m1.1.1.3.4" xref="alg1.11.11.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.11.11.m1.1.1.3.1b" xref="alg1.11.11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.11.11.m1.1.1.3.5" xref="alg1.11.11.m1.1.1.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.11.11.m1.1.1.3.1c" xref="alg1.11.11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.11.11.m1.1.1.3.6" xref="alg1.11.11.m1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.11.11.m1.1.1.3.1d" xref="alg1.11.11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.11.11.m1.1.1.3.7" xref="alg1.11.11.m1.1.1.3.7.cmml">d</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.1b"><apply id="alg1.11.11.m1.1.1.cmml" xref="alg1.11.11.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.cmml" xref="alg1.11.11.m1.1.1">superscript</csymbol><apply id="alg1.11.11.m1.1.1.2.cmml" xref="alg1.11.11.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.2.1.cmml" xref="alg1.11.11.m1.1.1">subscript</csymbol><ci id="alg1.11.11.m1.1.1.2.2.cmml" xref="alg1.11.11.m1.1.1.2.2">𝑋</ci><ci id="alg1.11.11.m1.1.1.2.3.cmml" xref="alg1.11.11.m1.1.1.2.3">𝑏</ci></apply><apply id="alg1.11.11.m1.1.1.3.cmml" xref="alg1.11.11.m1.1.1.3"><times id="alg1.11.11.m1.1.1.3.1.cmml" xref="alg1.11.11.m1.1.1.3.1"></times><ci id="alg1.11.11.m1.1.1.3.2.cmml" xref="alg1.11.11.m1.1.1.3.2">𝑚</ci><ci id="alg1.11.11.m1.1.1.3.3.cmml" xref="alg1.11.11.m1.1.1.3.3">𝑎</ci><ci id="alg1.11.11.m1.1.1.3.4.cmml" xref="alg1.11.11.m1.1.1.3.4">𝑠</ci><ci id="alg1.11.11.m1.1.1.3.5.cmml" xref="alg1.11.11.m1.1.1.3.5">𝑘</ci><ci id="alg1.11.11.m1.1.1.3.6.cmml" xref="alg1.11.11.m1.1.1.3.6">𝑒</ci><ci id="alg1.11.11.m1.1.1.3.7.cmml" xref="alg1.11.11.m1.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.1c">X_{b}^{masked}</annotation></semantics></math> <math id="alg1.12.12.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.12.12.m2.1a"><mo stretchy="false" id="alg1.12.12.m2.1.1" xref="alg1.12.12.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.12.12.m2.1b"><ci id="alg1.12.12.m2.1.1.cmml" xref="alg1.12.12.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m2.1c">\leftarrow</annotation></semantics></math> Mask <math id="alg1.13.13.m3.1" class="ltx_Math" alttext="X_{b}" display="inline"><semantics id="alg1.13.13.m3.1a"><msub id="alg1.13.13.m3.1.1" xref="alg1.13.13.m3.1.1.cmml"><mi id="alg1.13.13.m3.1.1.2" xref="alg1.13.13.m3.1.1.2.cmml">X</mi><mi id="alg1.13.13.m3.1.1.3" xref="alg1.13.13.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.13.13.m3.1b"><apply id="alg1.13.13.m3.1.1.cmml" xref="alg1.13.13.m3.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m3.1.1.1.cmml" xref="alg1.13.13.m3.1.1">subscript</csymbol><ci id="alg1.13.13.m3.1.1.2.cmml" xref="alg1.13.13.m3.1.1.2">𝑋</ci><ci id="alg1.13.13.m3.1.1.3.cmml" xref="alg1.13.13.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m3.1c">X_{b}</annotation></semantics></math> using <math id="alg1.14.14.m4.1" class="ltx_Math" alttext="S_{b}" display="inline"><semantics id="alg1.14.14.m4.1a"><msub id="alg1.14.14.m4.1.1" xref="alg1.14.14.m4.1.1.cmml"><mi id="alg1.14.14.m4.1.1.2" xref="alg1.14.14.m4.1.1.2.cmml">S</mi><mi id="alg1.14.14.m4.1.1.3" xref="alg1.14.14.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.14.14.m4.1b"><apply id="alg1.14.14.m4.1.1.cmml" xref="alg1.14.14.m4.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m4.1.1.1.cmml" xref="alg1.14.14.m4.1.1">subscript</csymbol><ci id="alg1.14.14.m4.1.1.2.cmml" xref="alg1.14.14.m4.1.1.2">𝑆</ci><ci id="alg1.14.14.m4.1.1.3.cmml" xref="alg1.14.14.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m4.1c">S_{b}</annotation></semantics></math>

</div>
<div id="alg1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Send intermediate result <math id="alg1.15.15.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}(X_{b}^{masked})" display="inline"><semantics id="alg1.15.15.m1.1a"><mrow id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml"><msub id="alg1.15.15.m1.1.1.3" xref="alg1.15.15.m1.1.1.3.cmml"><mi id="alg1.15.15.m1.1.1.3.2" xref="alg1.15.15.m1.1.1.3.2.cmml">f</mi><mrow id="alg1.15.15.m1.1.1.3.3" xref="alg1.15.15.m1.1.1.3.3.cmml"><mi id="alg1.15.15.m1.1.1.3.3.2" xref="alg1.15.15.m1.1.1.3.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.3.3.1" xref="alg1.15.15.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.15.15.m1.1.1.3.3.3" xref="alg1.15.15.m1.1.1.3.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.3.3.1a" xref="alg1.15.15.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.3.3.4" xref="alg1.15.15.m1.1.1.3.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.3.3.1b" xref="alg1.15.15.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.15.15.m1.1.1.3.3.5" xref="alg1.15.15.m1.1.1.3.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.3.3.1c" xref="alg1.15.15.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.3.3.6" xref="alg1.15.15.m1.1.1.3.3.6.cmml">bin</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.2" xref="alg1.15.15.m1.1.1.2.cmml">​</mo><mrow id="alg1.15.15.m1.1.1.1.1" xref="alg1.15.15.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.15.15.m1.1.1.1.1.2" xref="alg1.15.15.m1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.15.15.m1.1.1.1.1.1" xref="alg1.15.15.m1.1.1.1.1.1.cmml"><mi id="alg1.15.15.m1.1.1.1.1.1.2.2" xref="alg1.15.15.m1.1.1.1.1.1.2.2.cmml">X</mi><mi id="alg1.15.15.m1.1.1.1.1.1.2.3" xref="alg1.15.15.m1.1.1.1.1.1.2.3.cmml">b</mi><mrow id="alg1.15.15.m1.1.1.1.1.1.3" xref="alg1.15.15.m1.1.1.1.1.1.3.cmml"><mi id="alg1.15.15.m1.1.1.1.1.1.3.2" xref="alg1.15.15.m1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.1.1.1.3.1" xref="alg1.15.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.1.1.1.3.3" xref="alg1.15.15.m1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.1.1.1.3.1a" xref="alg1.15.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.1.1.1.3.4" xref="alg1.15.15.m1.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.1.1.1.3.1b" xref="alg1.15.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.1.1.1.3.5" xref="alg1.15.15.m1.1.1.1.1.1.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.1.1.1.3.1c" xref="alg1.15.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.1.1.1.3.6" xref="alg1.15.15.m1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.15.15.m1.1.1.1.1.1.3.1d" xref="alg1.15.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.15.15.m1.1.1.1.1.1.3.7" xref="alg1.15.15.m1.1.1.1.1.1.3.7.cmml">d</mi></mrow></msubsup><mo stretchy="false" id="alg1.15.15.m1.1.1.1.1.3" xref="alg1.15.15.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><apply id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1"><times id="alg1.15.15.m1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.2"></times><apply id="alg1.15.15.m1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.3.1.cmml" xref="alg1.15.15.m1.1.1.3">subscript</csymbol><ci id="alg1.15.15.m1.1.1.3.2.cmml" xref="alg1.15.15.m1.1.1.3.2">𝑓</ci><apply id="alg1.15.15.m1.1.1.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3"><times id="alg1.15.15.m1.1.1.3.3.1.cmml" xref="alg1.15.15.m1.1.1.3.3.1"></times><ci id="alg1.15.15.m1.1.1.3.3.2.cmml" xref="alg1.15.15.m1.1.1.3.3.2">bottom</ci><ci id="alg1.15.15.m1.1.1.3.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3.3">_</ci><ci id="alg1.15.15.m1.1.1.3.3.4.cmml" xref="alg1.15.15.m1.1.1.3.3.4">repr</ci><ci id="alg1.15.15.m1.1.1.3.3.5.cmml" xref="alg1.15.15.m1.1.1.3.3.5">_</ci><ci id="alg1.15.15.m1.1.1.3.3.6.cmml" xref="alg1.15.15.m1.1.1.3.3.6">bin</ci></apply></apply><apply id="alg1.15.15.m1.1.1.1.1.1.cmml" xref="alg1.15.15.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.1.1.1.1.cmml" xref="alg1.15.15.m1.1.1.1.1">superscript</csymbol><apply id="alg1.15.15.m1.1.1.1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.1.1.1.2.1.cmml" xref="alg1.15.15.m1.1.1.1.1">subscript</csymbol><ci id="alg1.15.15.m1.1.1.1.1.1.2.2.cmml" xref="alg1.15.15.m1.1.1.1.1.1.2.2">𝑋</ci><ci id="alg1.15.15.m1.1.1.1.1.1.2.3.cmml" xref="alg1.15.15.m1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="alg1.15.15.m1.1.1.1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3"><times id="alg1.15.15.m1.1.1.1.1.1.3.1.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.1"></times><ci id="alg1.15.15.m1.1.1.1.1.1.3.2.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.2">𝑚</ci><ci id="alg1.15.15.m1.1.1.1.1.1.3.3.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.15.15.m1.1.1.1.1.1.3.4.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.4">𝑠</ci><ci id="alg1.15.15.m1.1.1.1.1.1.3.5.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.5">𝑘</ci><ci id="alg1.15.15.m1.1.1.1.1.1.3.6.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.15.15.m1.1.1.1.1.1.3.7.cmml" xref="alg1.15.15.m1.1.1.1.1.1.3.7">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">f_{\mathrm{bottom\_repr\_bin}}(X_{b}^{masked})</annotation></semantics></math> and <math id="alg1.16.16.m2.1" class="ltx_Math" alttext="S_{b}" display="inline"><semantics id="alg1.16.16.m2.1a"><msub id="alg1.16.16.m2.1.1" xref="alg1.16.16.m2.1.1.cmml"><mi id="alg1.16.16.m2.1.1.2" xref="alg1.16.16.m2.1.1.2.cmml">S</mi><mi id="alg1.16.16.m2.1.1.3" xref="alg1.16.16.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.16.16.m2.1b"><apply id="alg1.16.16.m2.1.1.cmml" xref="alg1.16.16.m2.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m2.1.1.1.cmml" xref="alg1.16.16.m2.1.1">subscript</csymbol><ci id="alg1.16.16.m2.1.1.2.cmml" xref="alg1.16.16.m2.1.1.2">𝑆</ci><ci id="alg1.16.16.m2.1.1.3.cmml" xref="alg1.16.16.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m2.1c">S_{b}</annotation></semantics></math> to host

</div>
<div id="alg1.45.49" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.45.49.1" class="ltx_text">/* </span><span id="alg1.45.49.2" class="ltx_text ltx_font_bold">Client 1 (Host)</span>  */
</div>
<div id="alg1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.17.17.1" class="ltx_text ltx_font_bold">initialize</span> <math id="alg1.17.17.m1.2" class="ltx_Math" alttext="PartialEnc,PartialDec" display="inline"><semantics id="alg1.17.17.m1.2a"><mrow id="alg1.17.17.m1.2.2.2" xref="alg1.17.17.m1.2.2.3.cmml"><mrow id="alg1.17.17.m1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.cmml"><mi id="alg1.17.17.m1.1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1a" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.4" xref="alg1.17.17.m1.1.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1b" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.5" xref="alg1.17.17.m1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1c" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.6" xref="alg1.17.17.m1.1.1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1d" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.7" xref="alg1.17.17.m1.1.1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1e" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.8" xref="alg1.17.17.m1.1.1.1.1.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1f" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.9" xref="alg1.17.17.m1.1.1.1.1.9.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1g" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.10" xref="alg1.17.17.m1.1.1.1.1.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.1.1.1.1.1h" xref="alg1.17.17.m1.1.1.1.1.1.cmml">​</mo><mi id="alg1.17.17.m1.1.1.1.1.11" xref="alg1.17.17.m1.1.1.1.1.11.cmml">c</mi></mrow><mo id="alg1.17.17.m1.2.2.2.3" xref="alg1.17.17.m1.2.2.3.cmml">,</mo><mrow id="alg1.17.17.m1.2.2.2.2" xref="alg1.17.17.m1.2.2.2.2.cmml"><mi id="alg1.17.17.m1.2.2.2.2.2" xref="alg1.17.17.m1.2.2.2.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.3" xref="alg1.17.17.m1.2.2.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1a" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.4" xref="alg1.17.17.m1.2.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1b" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.5" xref="alg1.17.17.m1.2.2.2.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1c" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.6" xref="alg1.17.17.m1.2.2.2.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1d" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.7" xref="alg1.17.17.m1.2.2.2.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1e" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.8" xref="alg1.17.17.m1.2.2.2.2.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1f" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.9" xref="alg1.17.17.m1.2.2.2.2.9.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1g" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.10" xref="alg1.17.17.m1.2.2.2.2.10.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.17.17.m1.2.2.2.2.1h" xref="alg1.17.17.m1.2.2.2.2.1.cmml">​</mo><mi id="alg1.17.17.m1.2.2.2.2.11" xref="alg1.17.17.m1.2.2.2.2.11.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.2b"><list id="alg1.17.17.m1.2.2.3.cmml" xref="alg1.17.17.m1.2.2.2"><apply id="alg1.17.17.m1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1"><times id="alg1.17.17.m1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1"></times><ci id="alg1.17.17.m1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.1.2">𝑃</ci><ci id="alg1.17.17.m1.1.1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.1.1.3">𝑎</ci><ci id="alg1.17.17.m1.1.1.1.1.4.cmml" xref="alg1.17.17.m1.1.1.1.1.4">𝑟</ci><ci id="alg1.17.17.m1.1.1.1.1.5.cmml" xref="alg1.17.17.m1.1.1.1.1.5">𝑡</ci><ci id="alg1.17.17.m1.1.1.1.1.6.cmml" xref="alg1.17.17.m1.1.1.1.1.6">𝑖</ci><ci id="alg1.17.17.m1.1.1.1.1.7.cmml" xref="alg1.17.17.m1.1.1.1.1.7">𝑎</ci><ci id="alg1.17.17.m1.1.1.1.1.8.cmml" xref="alg1.17.17.m1.1.1.1.1.8">𝑙</ci><ci id="alg1.17.17.m1.1.1.1.1.9.cmml" xref="alg1.17.17.m1.1.1.1.1.9">𝐸</ci><ci id="alg1.17.17.m1.1.1.1.1.10.cmml" xref="alg1.17.17.m1.1.1.1.1.10">𝑛</ci><ci id="alg1.17.17.m1.1.1.1.1.11.cmml" xref="alg1.17.17.m1.1.1.1.1.11">𝑐</ci></apply><apply id="alg1.17.17.m1.2.2.2.2.cmml" xref="alg1.17.17.m1.2.2.2.2"><times id="alg1.17.17.m1.2.2.2.2.1.cmml" xref="alg1.17.17.m1.2.2.2.2.1"></times><ci id="alg1.17.17.m1.2.2.2.2.2.cmml" xref="alg1.17.17.m1.2.2.2.2.2">𝑃</ci><ci id="alg1.17.17.m1.2.2.2.2.3.cmml" xref="alg1.17.17.m1.2.2.2.2.3">𝑎</ci><ci id="alg1.17.17.m1.2.2.2.2.4.cmml" xref="alg1.17.17.m1.2.2.2.2.4">𝑟</ci><ci id="alg1.17.17.m1.2.2.2.2.5.cmml" xref="alg1.17.17.m1.2.2.2.2.5">𝑡</ci><ci id="alg1.17.17.m1.2.2.2.2.6.cmml" xref="alg1.17.17.m1.2.2.2.2.6">𝑖</ci><ci id="alg1.17.17.m1.2.2.2.2.7.cmml" xref="alg1.17.17.m1.2.2.2.2.7">𝑎</ci><ci id="alg1.17.17.m1.2.2.2.2.8.cmml" xref="alg1.17.17.m1.2.2.2.2.8">𝑙</ci><ci id="alg1.17.17.m1.2.2.2.2.9.cmml" xref="alg1.17.17.m1.2.2.2.2.9">𝐷</ci><ci id="alg1.17.17.m1.2.2.2.2.10.cmml" xref="alg1.17.17.m1.2.2.2.2.10">𝑒</ci><ci id="alg1.17.17.m1.2.2.2.2.11.cmml" xref="alg1.17.17.m1.2.2.2.2.11">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.2c">PartialEnc,PartialDec</annotation></semantics></math>

</div>
<div id="alg1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.18.18.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.18.18.1" class="ltx_emph ltx_font_italic"><math id="alg1.18.18.1.m1.2" class="ltx_Math" alttext="c\in[2,K]" display="inline"><semantics id="alg1.18.18.1.m1.2a"><mrow id="alg1.18.18.1.m1.2.3" xref="alg1.18.18.1.m1.2.3.cmml"><mi id="alg1.18.18.1.m1.2.3.2" xref="alg1.18.18.1.m1.2.3.2.cmml">c</mi><mo id="alg1.18.18.1.m1.2.3.1" xref="alg1.18.18.1.m1.2.3.1.cmml">∈</mo><mrow id="alg1.18.18.1.m1.2.3.3.2" xref="alg1.18.18.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.18.18.1.m1.2.3.3.2.1" xref="alg1.18.18.1.m1.2.3.3.1.cmml">[</mo><mn id="alg1.18.18.1.m1.1.1" xref="alg1.18.18.1.m1.1.1.cmml">2</mn><mo id="alg1.18.18.1.m1.2.3.3.2.2" xref="alg1.18.18.1.m1.2.3.3.1.cmml">,</mo><mi id="alg1.18.18.1.m1.2.2" xref="alg1.18.18.1.m1.2.2.cmml">K</mi><mo stretchy="false" id="alg1.18.18.1.m1.2.3.3.2.3" xref="alg1.18.18.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.18.1.m1.2b"><apply id="alg1.18.18.1.m1.2.3.cmml" xref="alg1.18.18.1.m1.2.3"><in id="alg1.18.18.1.m1.2.3.1.cmml" xref="alg1.18.18.1.m1.2.3.1"></in><ci id="alg1.18.18.1.m1.2.3.2.cmml" xref="alg1.18.18.1.m1.2.3.2">𝑐</ci><interval closure="closed" id="alg1.18.18.1.m1.2.3.3.1.cmml" xref="alg1.18.18.1.m1.2.3.3.2"><cn type="integer" id="alg1.18.18.1.m1.1.1.cmml" xref="alg1.18.18.1.m1.1.1">2</cn><ci id="alg1.18.18.1.m1.2.2.cmml" xref="alg1.18.18.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.1.m1.2c">c\in[2,K]</annotation></semantics></math></em> <span id="alg1.18.18.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.45.50" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.45.50.1" class="ltx_text ltx_font_bold">if</span> <em id="alg1.45.50.2" class="ltx_emph ltx_font_italic">c is offline</em> <span id="alg1.45.50.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.19.19.m1.1" class="ltx_Math" alttext="\tilde{X}\leftarrow" display="inline"><semantics id="alg1.19.19.m1.1a"><mrow id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><mover accent="true" id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml"><mi id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">X</mi><mo id="alg1.19.19.m1.1.1.2.1" xref="alg1.19.19.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.19.19.m1.1.1.1" xref="alg1.19.19.m1.1.1.1.cmml">←</mo><mi id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><ci id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1">←</ci><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2"><ci id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1.2.1">~</ci><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">𝑋</ci></apply><csymbol cd="latexml" id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">\tilde{X}\leftarrow</annotation></semantics></math> reuse cached intermediate results

</div>
<div id="alg1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.20.20.m1.1" class="ltx_Math" alttext="\tilde{S}\leftarrow" display="inline"><semantics id="alg1.20.20.m1.1a"><mrow id="alg1.20.20.m1.1.1" xref="alg1.20.20.m1.1.1.cmml"><mover accent="true" id="alg1.20.20.m1.1.1.2" xref="alg1.20.20.m1.1.1.2.cmml"><mi id="alg1.20.20.m1.1.1.2.2" xref="alg1.20.20.m1.1.1.2.2.cmml">S</mi><mo id="alg1.20.20.m1.1.1.2.1" xref="alg1.20.20.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.20.20.m1.1.1.1" xref="alg1.20.20.m1.1.1.1.cmml">←</mo><mi id="alg1.20.20.m1.1.1.3" xref="alg1.20.20.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.1b"><apply id="alg1.20.20.m1.1.1.cmml" xref="alg1.20.20.m1.1.1"><ci id="alg1.20.20.m1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1">←</ci><apply id="alg1.20.20.m1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.2"><ci id="alg1.20.20.m1.1.1.2.1.cmml" xref="alg1.20.20.m1.1.1.2.1">~</ci><ci id="alg1.20.20.m1.1.1.2.2.cmml" xref="alg1.20.20.m1.1.1.2.2">𝑆</ci></apply><csymbol cd="latexml" id="alg1.20.20.m1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.1c">\tilde{S}\leftarrow</annotation></semantics></math> reuse cached binary masks

</div>
<div id="alg1.45.51" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.45.51.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.21.21.m1.1" class="ltx_Math" alttext="\tilde{X}\leftarrow" display="inline"><semantics id="alg1.21.21.m1.1a"><mrow id="alg1.21.21.m1.1.1" xref="alg1.21.21.m1.1.1.cmml"><mover accent="true" id="alg1.21.21.m1.1.1.2" xref="alg1.21.21.m1.1.1.2.cmml"><mi id="alg1.21.21.m1.1.1.2.2" xref="alg1.21.21.m1.1.1.2.2.cmml">X</mi><mo id="alg1.21.21.m1.1.1.2.1" xref="alg1.21.21.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.21.21.m1.1.1.1" xref="alg1.21.21.m1.1.1.1.cmml">←</mo><mi id="alg1.21.21.m1.1.1.3" xref="alg1.21.21.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><apply id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1"><ci id="alg1.21.21.m1.1.1.1.cmml" xref="alg1.21.21.m1.1.1.1">←</ci><apply id="alg1.21.21.m1.1.1.2.cmml" xref="alg1.21.21.m1.1.1.2"><ci id="alg1.21.21.m1.1.1.2.1.cmml" xref="alg1.21.21.m1.1.1.2.1">~</ci><ci id="alg1.21.21.m1.1.1.2.2.cmml" xref="alg1.21.21.m1.1.1.2.2">𝑋</ci></apply><csymbol cd="latexml" id="alg1.21.21.m1.1.1.3.cmml" xref="alg1.21.21.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">\tilde{X}\leftarrow</annotation></semantics></math> Receive and append intermediate results. Cache received results.

</div>
<div id="alg1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.22.22.m1.1" class="ltx_Math" alttext="\tilde{S}\leftarrow" display="inline"><semantics id="alg1.22.22.m1.1a"><mrow id="alg1.22.22.m1.1.1" xref="alg1.22.22.m1.1.1.cmml"><mover accent="true" id="alg1.22.22.m1.1.1.2" xref="alg1.22.22.m1.1.1.2.cmml"><mi id="alg1.22.22.m1.1.1.2.2" xref="alg1.22.22.m1.1.1.2.2.cmml">S</mi><mo id="alg1.22.22.m1.1.1.2.1" xref="alg1.22.22.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.22.22.m1.1.1.1" xref="alg1.22.22.m1.1.1.1.cmml">←</mo><mi id="alg1.22.22.m1.1.1.3" xref="alg1.22.22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.1b"><apply id="alg1.22.22.m1.1.1.cmml" xref="alg1.22.22.m1.1.1"><ci id="alg1.22.22.m1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1">←</ci><apply id="alg1.22.22.m1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.2"><ci id="alg1.22.22.m1.1.1.2.1.cmml" xref="alg1.22.22.m1.1.1.2.1">~</ci><ci id="alg1.22.22.m1.1.1.2.2.cmml" xref="alg1.22.22.m1.1.1.2.2">𝑆</ci></apply><csymbol cd="latexml" id="alg1.22.22.m1.1.1.3.cmml" xref="alg1.22.22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.1c">\tilde{S}\leftarrow</annotation></semantics></math> Receive and append partial binary masks. Cache received binary masks.

</div>
<div id="alg1.45.52" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.45.53" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.23.23.m1.1" class="ltx_Math" alttext="X_{intermediate}\leftarrow" display="inline"><semantics id="alg1.23.23.m1.1a"><mrow id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml"><msub id="alg1.23.23.m1.1.1.2" xref="alg1.23.23.m1.1.1.2.cmml"><mi id="alg1.23.23.m1.1.1.2.2" xref="alg1.23.23.m1.1.1.2.2.cmml">X</mi><mrow id="alg1.23.23.m1.1.1.2.3" xref="alg1.23.23.m1.1.1.2.3.cmml"><mi id="alg1.23.23.m1.1.1.2.3.2" xref="alg1.23.23.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.3" xref="alg1.23.23.m1.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1a" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.4" xref="alg1.23.23.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1b" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.5" xref="alg1.23.23.m1.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1c" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.6" xref="alg1.23.23.m1.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1d" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.7" xref="alg1.23.23.m1.1.1.2.3.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1e" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.8" xref="alg1.23.23.m1.1.1.2.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1f" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.9" xref="alg1.23.23.m1.1.1.2.3.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1g" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.10" xref="alg1.23.23.m1.1.1.2.3.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1h" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.11" xref="alg1.23.23.m1.1.1.2.3.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1i" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.12" xref="alg1.23.23.m1.1.1.2.3.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.1.1.2.3.1j" xref="alg1.23.23.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.23.23.m1.1.1.2.3.13" xref="alg1.23.23.m1.1.1.2.3.13.cmml">e</mi></mrow></msub><mo stretchy="false" id="alg1.23.23.m1.1.1.1" xref="alg1.23.23.m1.1.1.1.cmml">←</mo><mi id="alg1.23.23.m1.1.1.3" xref="alg1.23.23.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><apply id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1"><ci id="alg1.23.23.m1.1.1.1.cmml" xref="alg1.23.23.m1.1.1.1">←</ci><apply id="alg1.23.23.m1.1.1.2.cmml" xref="alg1.23.23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.2.1.cmml" xref="alg1.23.23.m1.1.1.2">subscript</csymbol><ci id="alg1.23.23.m1.1.1.2.2.cmml" xref="alg1.23.23.m1.1.1.2.2">𝑋</ci><apply id="alg1.23.23.m1.1.1.2.3.cmml" xref="alg1.23.23.m1.1.1.2.3"><times id="alg1.23.23.m1.1.1.2.3.1.cmml" xref="alg1.23.23.m1.1.1.2.3.1"></times><ci id="alg1.23.23.m1.1.1.2.3.2.cmml" xref="alg1.23.23.m1.1.1.2.3.2">𝑖</ci><ci id="alg1.23.23.m1.1.1.2.3.3.cmml" xref="alg1.23.23.m1.1.1.2.3.3">𝑛</ci><ci id="alg1.23.23.m1.1.1.2.3.4.cmml" xref="alg1.23.23.m1.1.1.2.3.4">𝑡</ci><ci id="alg1.23.23.m1.1.1.2.3.5.cmml" xref="alg1.23.23.m1.1.1.2.3.5">𝑒</ci><ci id="alg1.23.23.m1.1.1.2.3.6.cmml" xref="alg1.23.23.m1.1.1.2.3.6">𝑟</ci><ci id="alg1.23.23.m1.1.1.2.3.7.cmml" xref="alg1.23.23.m1.1.1.2.3.7">𝑚</ci><ci id="alg1.23.23.m1.1.1.2.3.8.cmml" xref="alg1.23.23.m1.1.1.2.3.8">𝑒</ci><ci id="alg1.23.23.m1.1.1.2.3.9.cmml" xref="alg1.23.23.m1.1.1.2.3.9">𝑑</ci><ci id="alg1.23.23.m1.1.1.2.3.10.cmml" xref="alg1.23.23.m1.1.1.2.3.10">𝑖</ci><ci id="alg1.23.23.m1.1.1.2.3.11.cmml" xref="alg1.23.23.m1.1.1.2.3.11">𝑎</ci><ci id="alg1.23.23.m1.1.1.2.3.12.cmml" xref="alg1.23.23.m1.1.1.2.3.12">𝑡</ci><ci id="alg1.23.23.m1.1.1.2.3.13.cmml" xref="alg1.23.23.m1.1.1.2.3.13">𝑒</ci></apply></apply><csymbol cd="latexml" id="alg1.23.23.m1.1.1.3.cmml" xref="alg1.23.23.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">X_{intermediate}\leftarrow</annotation></semantics></math> concatenate <math id="alg1.24.24.m2.1" class="ltx_Math" alttext="\tilde{X}" display="inline"><semantics id="alg1.24.24.m2.1a"><mover accent="true" id="alg1.24.24.m2.1.1" xref="alg1.24.24.m2.1.1.cmml"><mi id="alg1.24.24.m2.1.1.2" xref="alg1.24.24.m2.1.1.2.cmml">X</mi><mo id="alg1.24.24.m2.1.1.1" xref="alg1.24.24.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.24.24.m2.1b"><apply id="alg1.24.24.m2.1.1.cmml" xref="alg1.24.24.m2.1.1"><ci id="alg1.24.24.m2.1.1.1.cmml" xref="alg1.24.24.m2.1.1.1">~</ci><ci id="alg1.24.24.m2.1.1.2.cmml" xref="alg1.24.24.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m2.1c">\tilde{X}</annotation></semantics></math> column-wise

</div>
<div id="alg1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.25.25.m1.1" class="ltx_Math" alttext="S_{complete}\leftarrow" display="inline"><semantics id="alg1.25.25.m1.1a"><mrow id="alg1.25.25.m1.1.1" xref="alg1.25.25.m1.1.1.cmml"><msub id="alg1.25.25.m1.1.1.2" xref="alg1.25.25.m1.1.1.2.cmml"><mi id="alg1.25.25.m1.1.1.2.2" xref="alg1.25.25.m1.1.1.2.2.cmml">S</mi><mrow id="alg1.25.25.m1.1.1.2.3" xref="alg1.25.25.m1.1.1.2.3.cmml"><mi id="alg1.25.25.m1.1.1.2.3.2" xref="alg1.25.25.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.3" xref="alg1.25.25.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1a" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.4" xref="alg1.25.25.m1.1.1.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1b" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.5" xref="alg1.25.25.m1.1.1.2.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1c" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.6" xref="alg1.25.25.m1.1.1.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1d" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.7" xref="alg1.25.25.m1.1.1.2.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1e" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.8" xref="alg1.25.25.m1.1.1.2.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.25.25.m1.1.1.2.3.1f" xref="alg1.25.25.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.25.25.m1.1.1.2.3.9" xref="alg1.25.25.m1.1.1.2.3.9.cmml">e</mi></mrow></msub><mo stretchy="false" id="alg1.25.25.m1.1.1.1" xref="alg1.25.25.m1.1.1.1.cmml">←</mo><mi id="alg1.25.25.m1.1.1.3" xref="alg1.25.25.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.1b"><apply id="alg1.25.25.m1.1.1.cmml" xref="alg1.25.25.m1.1.1"><ci id="alg1.25.25.m1.1.1.1.cmml" xref="alg1.25.25.m1.1.1.1">←</ci><apply id="alg1.25.25.m1.1.1.2.cmml" xref="alg1.25.25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.25.25.m1.1.1.2.1.cmml" xref="alg1.25.25.m1.1.1.2">subscript</csymbol><ci id="alg1.25.25.m1.1.1.2.2.cmml" xref="alg1.25.25.m1.1.1.2.2">𝑆</ci><apply id="alg1.25.25.m1.1.1.2.3.cmml" xref="alg1.25.25.m1.1.1.2.3"><times id="alg1.25.25.m1.1.1.2.3.1.cmml" xref="alg1.25.25.m1.1.1.2.3.1"></times><ci id="alg1.25.25.m1.1.1.2.3.2.cmml" xref="alg1.25.25.m1.1.1.2.3.2">𝑐</ci><ci id="alg1.25.25.m1.1.1.2.3.3.cmml" xref="alg1.25.25.m1.1.1.2.3.3">𝑜</ci><ci id="alg1.25.25.m1.1.1.2.3.4.cmml" xref="alg1.25.25.m1.1.1.2.3.4">𝑚</ci><ci id="alg1.25.25.m1.1.1.2.3.5.cmml" xref="alg1.25.25.m1.1.1.2.3.5">𝑝</ci><ci id="alg1.25.25.m1.1.1.2.3.6.cmml" xref="alg1.25.25.m1.1.1.2.3.6">𝑙</ci><ci id="alg1.25.25.m1.1.1.2.3.7.cmml" xref="alg1.25.25.m1.1.1.2.3.7">𝑒</ci><ci id="alg1.25.25.m1.1.1.2.3.8.cmml" xref="alg1.25.25.m1.1.1.2.3.8">𝑡</ci><ci id="alg1.25.25.m1.1.1.2.3.9.cmml" xref="alg1.25.25.m1.1.1.2.3.9">𝑒</ci></apply></apply><csymbol cd="latexml" id="alg1.25.25.m1.1.1.3.cmml" xref="alg1.25.25.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m1.1c">S_{complete}\leftarrow</annotation></semantics></math> concatenate <math id="alg1.26.26.m2.1" class="ltx_Math" alttext="\tilde{S}" display="inline"><semantics id="alg1.26.26.m2.1a"><mover accent="true" id="alg1.26.26.m2.1.1" xref="alg1.26.26.m2.1.1.cmml"><mi id="alg1.26.26.m2.1.1.2" xref="alg1.26.26.m2.1.1.2.cmml">S</mi><mo id="alg1.26.26.m2.1.1.1" xref="alg1.26.26.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.26.26.m2.1b"><apply id="alg1.26.26.m2.1.1.cmml" xref="alg1.26.26.m2.1.1"><ci id="alg1.26.26.m2.1.1.1.cmml" xref="alg1.26.26.m2.1.1.1">~</ci><ci id="alg1.26.26.m2.1.1.2.cmml" xref="alg1.26.26.m2.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m2.1c">\tilde{S}</annotation></semantics></math> column-wise

</div>
<div id="alg1.27.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.27.27.m1.1" class="ltx_math_unparsed" alttext="Z_{latent}\leftarrow PartialEnc(X_{intermediate},S_{complete}" display="inline"><semantics id="alg1.27.27.m1.1a"><mrow id="alg1.27.27.m1.1b"><msub id="alg1.27.27.m1.1.1"><mi id="alg1.27.27.m1.1.1.2">Z</mi><mrow id="alg1.27.27.m1.1.1.3"><mi id="alg1.27.27.m1.1.1.3.2">l</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.1.3.1">​</mo><mi id="alg1.27.27.m1.1.1.3.3">a</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.1.3.1a">​</mo><mi id="alg1.27.27.m1.1.1.3.4">t</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.1.3.1b">​</mo><mi id="alg1.27.27.m1.1.1.3.5">e</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.1.3.1c">​</mo><mi id="alg1.27.27.m1.1.1.3.6">n</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.1.3.1d">​</mo><mi id="alg1.27.27.m1.1.1.3.7">t</mi></mrow></msub><mo stretchy="false" id="alg1.27.27.m1.1.2">←</mo><mi id="alg1.27.27.m1.1.3">P</mi><mi id="alg1.27.27.m1.1.4">a</mi><mi id="alg1.27.27.m1.1.5">r</mi><mi id="alg1.27.27.m1.1.6">t</mi><mi id="alg1.27.27.m1.1.7">i</mi><mi id="alg1.27.27.m1.1.8">a</mi><mi id="alg1.27.27.m1.1.9">l</mi><mi id="alg1.27.27.m1.1.10">E</mi><mi id="alg1.27.27.m1.1.11">n</mi><mi id="alg1.27.27.m1.1.12">c</mi><mrow id="alg1.27.27.m1.1.13"><mo stretchy="false" id="alg1.27.27.m1.1.13.1">(</mo><msub id="alg1.27.27.m1.1.13.2"><mi id="alg1.27.27.m1.1.13.2.2">X</mi><mrow id="alg1.27.27.m1.1.13.2.3"><mi id="alg1.27.27.m1.1.13.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1">​</mo><mi id="alg1.27.27.m1.1.13.2.3.3">n</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1a">​</mo><mi id="alg1.27.27.m1.1.13.2.3.4">t</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1b">​</mo><mi id="alg1.27.27.m1.1.13.2.3.5">e</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1c">​</mo><mi id="alg1.27.27.m1.1.13.2.3.6">r</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1d">​</mo><mi id="alg1.27.27.m1.1.13.2.3.7">m</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1e">​</mo><mi id="alg1.27.27.m1.1.13.2.3.8">e</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1f">​</mo><mi id="alg1.27.27.m1.1.13.2.3.9">d</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1g">​</mo><mi id="alg1.27.27.m1.1.13.2.3.10">i</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1h">​</mo><mi id="alg1.27.27.m1.1.13.2.3.11">a</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1i">​</mo><mi id="alg1.27.27.m1.1.13.2.3.12">t</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.2.3.1j">​</mo><mi id="alg1.27.27.m1.1.13.2.3.13">e</mi></mrow></msub><mo id="alg1.27.27.m1.1.13.3">,</mo><msub id="alg1.27.27.m1.1.13.4"><mi id="alg1.27.27.m1.1.13.4.2">S</mi><mrow id="alg1.27.27.m1.1.13.4.3"><mi id="alg1.27.27.m1.1.13.4.3.2">c</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1">​</mo><mi id="alg1.27.27.m1.1.13.4.3.3">o</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1a">​</mo><mi id="alg1.27.27.m1.1.13.4.3.4">m</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1b">​</mo><mi id="alg1.27.27.m1.1.13.4.3.5">p</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1c">​</mo><mi id="alg1.27.27.m1.1.13.4.3.6">l</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1d">​</mo><mi id="alg1.27.27.m1.1.13.4.3.7">e</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1e">​</mo><mi id="alg1.27.27.m1.1.13.4.3.8">t</mi><mo lspace="0em" rspace="0em" id="alg1.27.27.m1.1.13.4.3.1f">​</mo><mi id="alg1.27.27.m1.1.13.4.3.9">e</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg1.27.27.m1.1c">Z_{latent}\leftarrow PartialEnc(X_{intermediate},S_{complete}</annotation></semantics></math>)

</div>
<div id="alg1.28.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.28.28.m1.1" class="ltx_Math" alttext="out_{intermediate}\leftarrow PartialDec(Z_{latent})" display="inline"><semantics id="alg1.28.28.m1.1a"><mrow id="alg1.28.28.m1.1.1" xref="alg1.28.28.m1.1.1.cmml"><mrow id="alg1.28.28.m1.1.1.3" xref="alg1.28.28.m1.1.1.3.cmml"><mi id="alg1.28.28.m1.1.1.3.2" xref="alg1.28.28.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.1" xref="alg1.28.28.m1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.3" xref="alg1.28.28.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.1a" xref="alg1.28.28.m1.1.1.3.1.cmml">​</mo><msub id="alg1.28.28.m1.1.1.3.4" xref="alg1.28.28.m1.1.1.3.4.cmml"><mi id="alg1.28.28.m1.1.1.3.4.2" xref="alg1.28.28.m1.1.1.3.4.2.cmml">t</mi><mrow id="alg1.28.28.m1.1.1.3.4.3" xref="alg1.28.28.m1.1.1.3.4.3.cmml"><mi id="alg1.28.28.m1.1.1.3.4.3.2" xref="alg1.28.28.m1.1.1.3.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.3" xref="alg1.28.28.m1.1.1.3.4.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1a" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.4" xref="alg1.28.28.m1.1.1.3.4.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1b" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.5" xref="alg1.28.28.m1.1.1.3.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1c" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.6" xref="alg1.28.28.m1.1.1.3.4.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1d" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.7" xref="alg1.28.28.m1.1.1.3.4.3.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1e" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.8" xref="alg1.28.28.m1.1.1.3.4.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1f" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.9" xref="alg1.28.28.m1.1.1.3.4.3.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1g" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.10" xref="alg1.28.28.m1.1.1.3.4.3.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1h" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.11" xref="alg1.28.28.m1.1.1.3.4.3.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1i" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.12" xref="alg1.28.28.m1.1.1.3.4.3.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.3.4.3.1j" xref="alg1.28.28.m1.1.1.3.4.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.3.4.3.13" xref="alg1.28.28.m1.1.1.3.4.3.13.cmml">e</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.28.28.m1.1.1.2" xref="alg1.28.28.m1.1.1.2.cmml">←</mo><mrow id="alg1.28.28.m1.1.1.1" xref="alg1.28.28.m1.1.1.1.cmml"><mi id="alg1.28.28.m1.1.1.1.3" xref="alg1.28.28.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.4" xref="alg1.28.28.m1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2a" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.5" xref="alg1.28.28.m1.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2b" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.6" xref="alg1.28.28.m1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2c" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.7" xref="alg1.28.28.m1.1.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2d" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.8" xref="alg1.28.28.m1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2e" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.9" xref="alg1.28.28.m1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2f" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.10" xref="alg1.28.28.m1.1.1.1.10.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2g" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.11" xref="alg1.28.28.m1.1.1.1.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2h" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.12" xref="alg1.28.28.m1.1.1.1.12.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.2i" xref="alg1.28.28.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.28.28.m1.1.1.1.1.1" xref="alg1.28.28.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.28.28.m1.1.1.1.1.1.2" xref="alg1.28.28.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.28.28.m1.1.1.1.1.1.1" xref="alg1.28.28.m1.1.1.1.1.1.1.cmml"><mi id="alg1.28.28.m1.1.1.1.1.1.1.2" xref="alg1.28.28.m1.1.1.1.1.1.1.2.cmml">Z</mi><mrow id="alg1.28.28.m1.1.1.1.1.1.1.3" xref="alg1.28.28.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.2" xref="alg1.28.28.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.1.1.1.3.1" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.3" xref="alg1.28.28.m1.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.1.1.1.3.1a" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.4" xref="alg1.28.28.m1.1.1.1.1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.1.1.1.3.1b" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.5" xref="alg1.28.28.m1.1.1.1.1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.1.1.1.3.1c" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.6" xref="alg1.28.28.m1.1.1.1.1.1.1.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.28.28.m1.1.1.1.1.1.1.3.1d" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.28.28.m1.1.1.1.1.1.1.3.7" xref="alg1.28.28.m1.1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.28.28.m1.1.1.1.1.1.3" xref="alg1.28.28.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.28.28.m1.1b"><apply id="alg1.28.28.m1.1.1.cmml" xref="alg1.28.28.m1.1.1"><ci id="alg1.28.28.m1.1.1.2.cmml" xref="alg1.28.28.m1.1.1.2">←</ci><apply id="alg1.28.28.m1.1.1.3.cmml" xref="alg1.28.28.m1.1.1.3"><times id="alg1.28.28.m1.1.1.3.1.cmml" xref="alg1.28.28.m1.1.1.3.1"></times><ci id="alg1.28.28.m1.1.1.3.2.cmml" xref="alg1.28.28.m1.1.1.3.2">𝑜</ci><ci id="alg1.28.28.m1.1.1.3.3.cmml" xref="alg1.28.28.m1.1.1.3.3">𝑢</ci><apply id="alg1.28.28.m1.1.1.3.4.cmml" xref="alg1.28.28.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.28.28.m1.1.1.3.4.1.cmml" xref="alg1.28.28.m1.1.1.3.4">subscript</csymbol><ci id="alg1.28.28.m1.1.1.3.4.2.cmml" xref="alg1.28.28.m1.1.1.3.4.2">𝑡</ci><apply id="alg1.28.28.m1.1.1.3.4.3.cmml" xref="alg1.28.28.m1.1.1.3.4.3"><times id="alg1.28.28.m1.1.1.3.4.3.1.cmml" xref="alg1.28.28.m1.1.1.3.4.3.1"></times><ci id="alg1.28.28.m1.1.1.3.4.3.2.cmml" xref="alg1.28.28.m1.1.1.3.4.3.2">𝑖</ci><ci id="alg1.28.28.m1.1.1.3.4.3.3.cmml" xref="alg1.28.28.m1.1.1.3.4.3.3">𝑛</ci><ci id="alg1.28.28.m1.1.1.3.4.3.4.cmml" xref="alg1.28.28.m1.1.1.3.4.3.4">𝑡</ci><ci id="alg1.28.28.m1.1.1.3.4.3.5.cmml" xref="alg1.28.28.m1.1.1.3.4.3.5">𝑒</ci><ci id="alg1.28.28.m1.1.1.3.4.3.6.cmml" xref="alg1.28.28.m1.1.1.3.4.3.6">𝑟</ci><ci id="alg1.28.28.m1.1.1.3.4.3.7.cmml" xref="alg1.28.28.m1.1.1.3.4.3.7">𝑚</ci><ci id="alg1.28.28.m1.1.1.3.4.3.8.cmml" xref="alg1.28.28.m1.1.1.3.4.3.8">𝑒</ci><ci id="alg1.28.28.m1.1.1.3.4.3.9.cmml" xref="alg1.28.28.m1.1.1.3.4.3.9">𝑑</ci><ci id="alg1.28.28.m1.1.1.3.4.3.10.cmml" xref="alg1.28.28.m1.1.1.3.4.3.10">𝑖</ci><ci id="alg1.28.28.m1.1.1.3.4.3.11.cmml" xref="alg1.28.28.m1.1.1.3.4.3.11">𝑎</ci><ci id="alg1.28.28.m1.1.1.3.4.3.12.cmml" xref="alg1.28.28.m1.1.1.3.4.3.12">𝑡</ci><ci id="alg1.28.28.m1.1.1.3.4.3.13.cmml" xref="alg1.28.28.m1.1.1.3.4.3.13">𝑒</ci></apply></apply></apply><apply id="alg1.28.28.m1.1.1.1.cmml" xref="alg1.28.28.m1.1.1.1"><times id="alg1.28.28.m1.1.1.1.2.cmml" xref="alg1.28.28.m1.1.1.1.2"></times><ci id="alg1.28.28.m1.1.1.1.3.cmml" xref="alg1.28.28.m1.1.1.1.3">𝑃</ci><ci id="alg1.28.28.m1.1.1.1.4.cmml" xref="alg1.28.28.m1.1.1.1.4">𝑎</ci><ci id="alg1.28.28.m1.1.1.1.5.cmml" xref="alg1.28.28.m1.1.1.1.5">𝑟</ci><ci id="alg1.28.28.m1.1.1.1.6.cmml" xref="alg1.28.28.m1.1.1.1.6">𝑡</ci><ci id="alg1.28.28.m1.1.1.1.7.cmml" xref="alg1.28.28.m1.1.1.1.7">𝑖</ci><ci id="alg1.28.28.m1.1.1.1.8.cmml" xref="alg1.28.28.m1.1.1.1.8">𝑎</ci><ci id="alg1.28.28.m1.1.1.1.9.cmml" xref="alg1.28.28.m1.1.1.1.9">𝑙</ci><ci id="alg1.28.28.m1.1.1.1.10.cmml" xref="alg1.28.28.m1.1.1.1.10">𝐷</ci><ci id="alg1.28.28.m1.1.1.1.11.cmml" xref="alg1.28.28.m1.1.1.1.11">𝑒</ci><ci id="alg1.28.28.m1.1.1.1.12.cmml" xref="alg1.28.28.m1.1.1.1.12">𝑐</ci><apply id="alg1.28.28.m1.1.1.1.1.1.1.cmml" xref="alg1.28.28.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.28.28.m1.1.1.1.1.1.1.1.cmml" xref="alg1.28.28.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.28.28.m1.1.1.1.1.1.1.2.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.2">𝑍</ci><apply id="alg1.28.28.m1.1.1.1.1.1.1.3.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3"><times id="alg1.28.28.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.1"></times><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.4.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.4">𝑡</ci><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.5.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.5">𝑒</ci><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.6.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.6">𝑛</ci><ci id="alg1.28.28.m1.1.1.1.1.1.1.3.7.cmml" xref="alg1.28.28.m1.1.1.1.1.1.1.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.28.m1.1c">out_{intermediate}\leftarrow PartialDec(Z_{latent})</annotation></semantics></math>

</div>
<div id="alg1.31.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.29.29.m1.4" class="ltx_Math" alttext="[\tilde{out}_{1},\tilde{out}_{2},...,\tilde{out}_{K}]\leftarrow" display="inline"><semantics id="alg1.29.29.m1.4a"><mrow id="alg1.29.29.m1.4.4" xref="alg1.29.29.m1.4.4.cmml"><mrow id="alg1.29.29.m1.4.4.3.3" xref="alg1.29.29.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg1.29.29.m1.4.4.3.3.4" xref="alg1.29.29.m1.4.4.3.4.cmml">[</mo><msub id="alg1.29.29.m1.2.2.1.1.1" xref="alg1.29.29.m1.2.2.1.1.1.cmml"><mover accent="true" id="alg1.29.29.m1.2.2.1.1.1.2" xref="alg1.29.29.m1.2.2.1.1.1.2.cmml"><mrow id="alg1.29.29.m1.2.2.1.1.1.2.2" xref="alg1.29.29.m1.2.2.1.1.1.2.2.cmml"><mi id="alg1.29.29.m1.2.2.1.1.1.2.2.2" xref="alg1.29.29.m1.2.2.1.1.1.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.2.2.1.1.1.2.2.1" xref="alg1.29.29.m1.2.2.1.1.1.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.2.2.1.1.1.2.2.3" xref="alg1.29.29.m1.2.2.1.1.1.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.2.2.1.1.1.2.2.1a" xref="alg1.29.29.m1.2.2.1.1.1.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.2.2.1.1.1.2.2.4" xref="alg1.29.29.m1.2.2.1.1.1.2.2.4.cmml">t</mi></mrow><mo id="alg1.29.29.m1.2.2.1.1.1.2.1" xref="alg1.29.29.m1.2.2.1.1.1.2.1.cmml">~</mo></mover><mn id="alg1.29.29.m1.2.2.1.1.1.3" xref="alg1.29.29.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.29.29.m1.4.4.3.3.5" xref="alg1.29.29.m1.4.4.3.4.cmml">,</mo><msub id="alg1.29.29.m1.3.3.2.2.2" xref="alg1.29.29.m1.3.3.2.2.2.cmml"><mover accent="true" id="alg1.29.29.m1.3.3.2.2.2.2" xref="alg1.29.29.m1.3.3.2.2.2.2.cmml"><mrow id="alg1.29.29.m1.3.3.2.2.2.2.2" xref="alg1.29.29.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.29.29.m1.3.3.2.2.2.2.2.2" xref="alg1.29.29.m1.3.3.2.2.2.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.3.3.2.2.2.2.2.1" xref="alg1.29.29.m1.3.3.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.3.3.2.2.2.2.2.3" xref="alg1.29.29.m1.3.3.2.2.2.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.3.3.2.2.2.2.2.1a" xref="alg1.29.29.m1.3.3.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.3.3.2.2.2.2.2.4" xref="alg1.29.29.m1.3.3.2.2.2.2.2.4.cmml">t</mi></mrow><mo id="alg1.29.29.m1.3.3.2.2.2.2.1" xref="alg1.29.29.m1.3.3.2.2.2.2.1.cmml">~</mo></mover><mn id="alg1.29.29.m1.3.3.2.2.2.3" xref="alg1.29.29.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="alg1.29.29.m1.4.4.3.3.6" xref="alg1.29.29.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.29.29.m1.1.1" xref="alg1.29.29.m1.1.1.cmml">…</mi><mo id="alg1.29.29.m1.4.4.3.3.7" xref="alg1.29.29.m1.4.4.3.4.cmml">,</mo><msub id="alg1.29.29.m1.4.4.3.3.3" xref="alg1.29.29.m1.4.4.3.3.3.cmml"><mover accent="true" id="alg1.29.29.m1.4.4.3.3.3.2" xref="alg1.29.29.m1.4.4.3.3.3.2.cmml"><mrow id="alg1.29.29.m1.4.4.3.3.3.2.2" xref="alg1.29.29.m1.4.4.3.3.3.2.2.cmml"><mi id="alg1.29.29.m1.4.4.3.3.3.2.2.2" xref="alg1.29.29.m1.4.4.3.3.3.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.4.4.3.3.3.2.2.1" xref="alg1.29.29.m1.4.4.3.3.3.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.4.4.3.3.3.2.2.3" xref="alg1.29.29.m1.4.4.3.3.3.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.29.29.m1.4.4.3.3.3.2.2.1a" xref="alg1.29.29.m1.4.4.3.3.3.2.2.1.cmml">​</mo><mi id="alg1.29.29.m1.4.4.3.3.3.2.2.4" xref="alg1.29.29.m1.4.4.3.3.3.2.2.4.cmml">t</mi></mrow><mo id="alg1.29.29.m1.4.4.3.3.3.2.1" xref="alg1.29.29.m1.4.4.3.3.3.2.1.cmml">~</mo></mover><mi id="alg1.29.29.m1.4.4.3.3.3.3" xref="alg1.29.29.m1.4.4.3.3.3.3.cmml">K</mi></msub><mo stretchy="false" id="alg1.29.29.m1.4.4.3.3.8" xref="alg1.29.29.m1.4.4.3.4.cmml">]</mo></mrow><mo stretchy="false" id="alg1.29.29.m1.4.4.4" xref="alg1.29.29.m1.4.4.4.cmml">←</mo><mi id="alg1.29.29.m1.4.4.5" xref="alg1.29.29.m1.4.4.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.29.29.m1.4b"><apply id="alg1.29.29.m1.4.4.cmml" xref="alg1.29.29.m1.4.4"><ci id="alg1.29.29.m1.4.4.4.cmml" xref="alg1.29.29.m1.4.4.4">←</ci><list id="alg1.29.29.m1.4.4.3.4.cmml" xref="alg1.29.29.m1.4.4.3.3"><apply id="alg1.29.29.m1.2.2.1.1.1.cmml" xref="alg1.29.29.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.29.29.m1.2.2.1.1.1.1.cmml" xref="alg1.29.29.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.29.29.m1.2.2.1.1.1.2.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2"><ci id="alg1.29.29.m1.2.2.1.1.1.2.1.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.1">~</ci><apply id="alg1.29.29.m1.2.2.1.1.1.2.2.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.2"><times id="alg1.29.29.m1.2.2.1.1.1.2.2.1.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.2.1"></times><ci id="alg1.29.29.m1.2.2.1.1.1.2.2.2.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.2.2">𝑜</ci><ci id="alg1.29.29.m1.2.2.1.1.1.2.2.3.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.2.3">𝑢</ci><ci id="alg1.29.29.m1.2.2.1.1.1.2.2.4.cmml" xref="alg1.29.29.m1.2.2.1.1.1.2.2.4">𝑡</ci></apply></apply><cn type="integer" id="alg1.29.29.m1.2.2.1.1.1.3.cmml" xref="alg1.29.29.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg1.29.29.m1.3.3.2.2.2.cmml" xref="alg1.29.29.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.29.29.m1.3.3.2.2.2.1.cmml" xref="alg1.29.29.m1.3.3.2.2.2">subscript</csymbol><apply id="alg1.29.29.m1.3.3.2.2.2.2.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2"><ci id="alg1.29.29.m1.3.3.2.2.2.2.1.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.1">~</ci><apply id="alg1.29.29.m1.3.3.2.2.2.2.2.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.2"><times id="alg1.29.29.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.2.1"></times><ci id="alg1.29.29.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.2.2">𝑜</ci><ci id="alg1.29.29.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.2.3">𝑢</ci><ci id="alg1.29.29.m1.3.3.2.2.2.2.2.4.cmml" xref="alg1.29.29.m1.3.3.2.2.2.2.2.4">𝑡</ci></apply></apply><cn type="integer" id="alg1.29.29.m1.3.3.2.2.2.3.cmml" xref="alg1.29.29.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.29.29.m1.1.1.cmml" xref="alg1.29.29.m1.1.1">…</ci><apply id="alg1.29.29.m1.4.4.3.3.3.cmml" xref="alg1.29.29.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.29.29.m1.4.4.3.3.3.1.cmml" xref="alg1.29.29.m1.4.4.3.3.3">subscript</csymbol><apply id="alg1.29.29.m1.4.4.3.3.3.2.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2"><ci id="alg1.29.29.m1.4.4.3.3.3.2.1.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.1">~</ci><apply id="alg1.29.29.m1.4.4.3.3.3.2.2.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.2"><times id="alg1.29.29.m1.4.4.3.3.3.2.2.1.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.2.1"></times><ci id="alg1.29.29.m1.4.4.3.3.3.2.2.2.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.2.2">𝑜</ci><ci id="alg1.29.29.m1.4.4.3.3.3.2.2.3.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.2.3">𝑢</ci><ci id="alg1.29.29.m1.4.4.3.3.3.2.2.4.cmml" xref="alg1.29.29.m1.4.4.3.3.3.2.2.4">𝑡</ci></apply></apply><ci id="alg1.29.29.m1.4.4.3.3.3.3.cmml" xref="alg1.29.29.m1.4.4.3.3.3.3">𝐾</ci></apply></list><csymbol cd="latexml" id="alg1.29.29.m1.4.4.5.cmml" xref="alg1.29.29.m1.4.4.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.29.m1.4c">[\tilde{out}_{1},\tilde{out}_{2},...,\tilde{out}_{K}]\leftarrow</annotation></semantics></math> Split <math id="alg1.30.30.m2.1" class="ltx_Math" alttext="out_{intermediate}" display="inline"><semantics id="alg1.30.30.m2.1a"><mrow id="alg1.30.30.m2.1.1" xref="alg1.30.30.m2.1.1.cmml"><mi id="alg1.30.30.m2.1.1.2" xref="alg1.30.30.m2.1.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.1" xref="alg1.30.30.m2.1.1.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.3" xref="alg1.30.30.m2.1.1.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.1a" xref="alg1.30.30.m2.1.1.1.cmml">​</mo><msub id="alg1.30.30.m2.1.1.4" xref="alg1.30.30.m2.1.1.4.cmml"><mi id="alg1.30.30.m2.1.1.4.2" xref="alg1.30.30.m2.1.1.4.2.cmml">t</mi><mrow id="alg1.30.30.m2.1.1.4.3" xref="alg1.30.30.m2.1.1.4.3.cmml"><mi id="alg1.30.30.m2.1.1.4.3.2" xref="alg1.30.30.m2.1.1.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.3" xref="alg1.30.30.m2.1.1.4.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1a" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.4" xref="alg1.30.30.m2.1.1.4.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1b" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.5" xref="alg1.30.30.m2.1.1.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1c" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.6" xref="alg1.30.30.m2.1.1.4.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1d" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.7" xref="alg1.30.30.m2.1.1.4.3.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1e" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.8" xref="alg1.30.30.m2.1.1.4.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1f" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.9" xref="alg1.30.30.m2.1.1.4.3.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1g" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.10" xref="alg1.30.30.m2.1.1.4.3.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1h" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.11" xref="alg1.30.30.m2.1.1.4.3.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1i" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.12" xref="alg1.30.30.m2.1.1.4.3.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.30.30.m2.1.1.4.3.1j" xref="alg1.30.30.m2.1.1.4.3.1.cmml">​</mo><mi id="alg1.30.30.m2.1.1.4.3.13" xref="alg1.30.30.m2.1.1.4.3.13.cmml">e</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.30.30.m2.1b"><apply id="alg1.30.30.m2.1.1.cmml" xref="alg1.30.30.m2.1.1"><times id="alg1.30.30.m2.1.1.1.cmml" xref="alg1.30.30.m2.1.1.1"></times><ci id="alg1.30.30.m2.1.1.2.cmml" xref="alg1.30.30.m2.1.1.2">𝑜</ci><ci id="alg1.30.30.m2.1.1.3.cmml" xref="alg1.30.30.m2.1.1.3">𝑢</ci><apply id="alg1.30.30.m2.1.1.4.cmml" xref="alg1.30.30.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.30.30.m2.1.1.4.1.cmml" xref="alg1.30.30.m2.1.1.4">subscript</csymbol><ci id="alg1.30.30.m2.1.1.4.2.cmml" xref="alg1.30.30.m2.1.1.4.2">𝑡</ci><apply id="alg1.30.30.m2.1.1.4.3.cmml" xref="alg1.30.30.m2.1.1.4.3"><times id="alg1.30.30.m2.1.1.4.3.1.cmml" xref="alg1.30.30.m2.1.1.4.3.1"></times><ci id="alg1.30.30.m2.1.1.4.3.2.cmml" xref="alg1.30.30.m2.1.1.4.3.2">𝑖</ci><ci id="alg1.30.30.m2.1.1.4.3.3.cmml" xref="alg1.30.30.m2.1.1.4.3.3">𝑛</ci><ci id="alg1.30.30.m2.1.1.4.3.4.cmml" xref="alg1.30.30.m2.1.1.4.3.4">𝑡</ci><ci id="alg1.30.30.m2.1.1.4.3.5.cmml" xref="alg1.30.30.m2.1.1.4.3.5">𝑒</ci><ci id="alg1.30.30.m2.1.1.4.3.6.cmml" xref="alg1.30.30.m2.1.1.4.3.6">𝑟</ci><ci id="alg1.30.30.m2.1.1.4.3.7.cmml" xref="alg1.30.30.m2.1.1.4.3.7">𝑚</ci><ci id="alg1.30.30.m2.1.1.4.3.8.cmml" xref="alg1.30.30.m2.1.1.4.3.8">𝑒</ci><ci id="alg1.30.30.m2.1.1.4.3.9.cmml" xref="alg1.30.30.m2.1.1.4.3.9">𝑑</ci><ci id="alg1.30.30.m2.1.1.4.3.10.cmml" xref="alg1.30.30.m2.1.1.4.3.10">𝑖</ci><ci id="alg1.30.30.m2.1.1.4.3.11.cmml" xref="alg1.30.30.m2.1.1.4.3.11">𝑎</ci><ci id="alg1.30.30.m2.1.1.4.3.12.cmml" xref="alg1.30.30.m2.1.1.4.3.12">𝑡</ci><ci id="alg1.30.30.m2.1.1.4.3.13.cmml" xref="alg1.30.30.m2.1.1.4.3.13">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.30.m2.1c">out_{intermediate}</annotation></semantics></math> into uniform partitions for client <math id="alg1.31.31.m3.2" class="ltx_Math" alttext="c\in[2,K]" display="inline"><semantics id="alg1.31.31.m3.2a"><mrow id="alg1.31.31.m3.2.3" xref="alg1.31.31.m3.2.3.cmml"><mi id="alg1.31.31.m3.2.3.2" xref="alg1.31.31.m3.2.3.2.cmml">c</mi><mo id="alg1.31.31.m3.2.3.1" xref="alg1.31.31.m3.2.3.1.cmml">∈</mo><mrow id="alg1.31.31.m3.2.3.3.2" xref="alg1.31.31.m3.2.3.3.1.cmml"><mo stretchy="false" id="alg1.31.31.m3.2.3.3.2.1" xref="alg1.31.31.m3.2.3.3.1.cmml">[</mo><mn id="alg1.31.31.m3.1.1" xref="alg1.31.31.m3.1.1.cmml">2</mn><mo id="alg1.31.31.m3.2.3.3.2.2" xref="alg1.31.31.m3.2.3.3.1.cmml">,</mo><mi id="alg1.31.31.m3.2.2" xref="alg1.31.31.m3.2.2.cmml">K</mi><mo stretchy="false" id="alg1.31.31.m3.2.3.3.2.3" xref="alg1.31.31.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.31.31.m3.2b"><apply id="alg1.31.31.m3.2.3.cmml" xref="alg1.31.31.m3.2.3"><in id="alg1.31.31.m3.2.3.1.cmml" xref="alg1.31.31.m3.2.3.1"></in><ci id="alg1.31.31.m3.2.3.2.cmml" xref="alg1.31.31.m3.2.3.2">𝑐</ci><interval closure="closed" id="alg1.31.31.m3.2.3.3.1.cmml" xref="alg1.31.31.m3.2.3.3.2"><cn type="integer" id="alg1.31.31.m3.1.1.cmml" xref="alg1.31.31.m3.1.1">2</cn><ci id="alg1.31.31.m3.2.2.cmml" xref="alg1.31.31.m3.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.31.m3.2c">c\in[2,K]</annotation></semantics></math>

</div>
<div id="alg1.32.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.32.32.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.32.32.1" class="ltx_emph ltx_font_italic"><math id="alg1.32.32.1.m1.2" class="ltx_Math" alttext="c\in[2,K]" display="inline"><semantics id="alg1.32.32.1.m1.2a"><mrow id="alg1.32.32.1.m1.2.3" xref="alg1.32.32.1.m1.2.3.cmml"><mi id="alg1.32.32.1.m1.2.3.2" xref="alg1.32.32.1.m1.2.3.2.cmml">c</mi><mo id="alg1.32.32.1.m1.2.3.1" xref="alg1.32.32.1.m1.2.3.1.cmml">∈</mo><mrow id="alg1.32.32.1.m1.2.3.3.2" xref="alg1.32.32.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.32.32.1.m1.2.3.3.2.1" xref="alg1.32.32.1.m1.2.3.3.1.cmml">[</mo><mn id="alg1.32.32.1.m1.1.1" xref="alg1.32.32.1.m1.1.1.cmml">2</mn><mo id="alg1.32.32.1.m1.2.3.3.2.2" xref="alg1.32.32.1.m1.2.3.3.1.cmml">,</mo><mi id="alg1.32.32.1.m1.2.2" xref="alg1.32.32.1.m1.2.2.cmml">K</mi><mo stretchy="false" id="alg1.32.32.1.m1.2.3.3.2.3" xref="alg1.32.32.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.32.32.1.m1.2b"><apply id="alg1.32.32.1.m1.2.3.cmml" xref="alg1.32.32.1.m1.2.3"><in id="alg1.32.32.1.m1.2.3.1.cmml" xref="alg1.32.32.1.m1.2.3.1"></in><ci id="alg1.32.32.1.m1.2.3.2.cmml" xref="alg1.32.32.1.m1.2.3.2">𝑐</ci><interval closure="closed" id="alg1.32.32.1.m1.2.3.3.1.cmml" xref="alg1.32.32.1.m1.2.3.3.2"><cn type="integer" id="alg1.32.32.1.m1.1.1.cmml" xref="alg1.32.32.1.m1.1.1">2</cn><ci id="alg1.32.32.1.m1.2.2.cmml" xref="alg1.32.32.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.32.1.m1.2c">c\in[2,K]</annotation></semantics></math></em> <span id="alg1.32.32.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.34.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Send <math id="alg1.33.33.m1.1" class="ltx_Math" alttext="\tilde{out}_{c}" display="inline"><semantics id="alg1.33.33.m1.1a"><msub id="alg1.33.33.m1.1.1" xref="alg1.33.33.m1.1.1.cmml"><mover accent="true" id="alg1.33.33.m1.1.1.2" xref="alg1.33.33.m1.1.1.2.cmml"><mrow id="alg1.33.33.m1.1.1.2.2" xref="alg1.33.33.m1.1.1.2.2.cmml"><mi id="alg1.33.33.m1.1.1.2.2.2" xref="alg1.33.33.m1.1.1.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.33.33.m1.1.1.2.2.1" xref="alg1.33.33.m1.1.1.2.2.1.cmml">​</mo><mi id="alg1.33.33.m1.1.1.2.2.3" xref="alg1.33.33.m1.1.1.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.33.33.m1.1.1.2.2.1a" xref="alg1.33.33.m1.1.1.2.2.1.cmml">​</mo><mi id="alg1.33.33.m1.1.1.2.2.4" xref="alg1.33.33.m1.1.1.2.2.4.cmml">t</mi></mrow><mo id="alg1.33.33.m1.1.1.2.1" xref="alg1.33.33.m1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.33.33.m1.1.1.3" xref="alg1.33.33.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.33.33.m1.1b"><apply id="alg1.33.33.m1.1.1.cmml" xref="alg1.33.33.m1.1.1"><csymbol cd="ambiguous" id="alg1.33.33.m1.1.1.1.cmml" xref="alg1.33.33.m1.1.1">subscript</csymbol><apply id="alg1.33.33.m1.1.1.2.cmml" xref="alg1.33.33.m1.1.1.2"><ci id="alg1.33.33.m1.1.1.2.1.cmml" xref="alg1.33.33.m1.1.1.2.1">~</ci><apply id="alg1.33.33.m1.1.1.2.2.cmml" xref="alg1.33.33.m1.1.1.2.2"><times id="alg1.33.33.m1.1.1.2.2.1.cmml" xref="alg1.33.33.m1.1.1.2.2.1"></times><ci id="alg1.33.33.m1.1.1.2.2.2.cmml" xref="alg1.33.33.m1.1.1.2.2.2">𝑜</ci><ci id="alg1.33.33.m1.1.1.2.2.3.cmml" xref="alg1.33.33.m1.1.1.2.2.3">𝑢</ci><ci id="alg1.33.33.m1.1.1.2.2.4.cmml" xref="alg1.33.33.m1.1.1.2.2.4">𝑡</ci></apply></apply><ci id="alg1.33.33.m1.1.1.3.cmml" xref="alg1.33.33.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.33.33.m1.1c">\tilde{out}_{c}</annotation></semantics></math> to client <math id="alg1.34.34.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.34.34.m2.1a"><mi id="alg1.34.34.m2.1.1" xref="alg1.34.34.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.34.34.m2.1b"><ci id="alg1.34.34.m2.1.1.cmml" xref="alg1.34.34.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.34.34.m2.1c">c</annotation></semantics></math>

</div>
<div id="alg1.45.54" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.45.55" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.45.55.1" class="ltx_text">/* </span><span id="alg1.45.55.2" class="ltx_text ltx_font_bold">Guests:</span>  */
</div>
<div id="alg1.45.56" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.36.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.35.35.m1.1" class="ltx_Math" alttext="D_{b}\leftarrow" display="inline"><semantics id="alg1.35.35.m1.1a"><mrow id="alg1.35.35.m1.1.1" xref="alg1.35.35.m1.1.1.cmml"><msub id="alg1.35.35.m1.1.1.2" xref="alg1.35.35.m1.1.1.2.cmml"><mi id="alg1.35.35.m1.1.1.2.2" xref="alg1.35.35.m1.1.1.2.2.cmml">D</mi><mi id="alg1.35.35.m1.1.1.2.3" xref="alg1.35.35.m1.1.1.2.3.cmml">b</mi></msub><mo stretchy="false" id="alg1.35.35.m1.1.1.1" xref="alg1.35.35.m1.1.1.1.cmml">←</mo><mi id="alg1.35.35.m1.1.1.3" xref="alg1.35.35.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.35.35.m1.1b"><apply id="alg1.35.35.m1.1.1.cmml" xref="alg1.35.35.m1.1.1"><ci id="alg1.35.35.m1.1.1.1.cmml" xref="alg1.35.35.m1.1.1.1">←</ci><apply id="alg1.35.35.m1.1.1.2.cmml" xref="alg1.35.35.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.35.35.m1.1.1.2.1.cmml" xref="alg1.35.35.m1.1.1.2">subscript</csymbol><ci id="alg1.35.35.m1.1.1.2.2.cmml" xref="alg1.35.35.m1.1.1.2.2">𝐷</ci><ci id="alg1.35.35.m1.1.1.2.3.cmml" xref="alg1.35.35.m1.1.1.2.3">𝑏</ci></apply><csymbol cd="latexml" id="alg1.35.35.m1.1.1.3.cmml" xref="alg1.35.35.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.35.35.m1.1c">D_{b}\leftarrow</annotation></semantics></math> Receive mini-batch decoder intermediate result <math id="alg1.36.36.m2.1" class="ltx_Math" alttext="\tilde{out}_{c}" display="inline"><semantics id="alg1.36.36.m2.1a"><msub id="alg1.36.36.m2.1.1" xref="alg1.36.36.m2.1.1.cmml"><mover accent="true" id="alg1.36.36.m2.1.1.2" xref="alg1.36.36.m2.1.1.2.cmml"><mrow id="alg1.36.36.m2.1.1.2.2" xref="alg1.36.36.m2.1.1.2.2.cmml"><mi id="alg1.36.36.m2.1.1.2.2.2" xref="alg1.36.36.m2.1.1.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.36.36.m2.1.1.2.2.1" xref="alg1.36.36.m2.1.1.2.2.1.cmml">​</mo><mi id="alg1.36.36.m2.1.1.2.2.3" xref="alg1.36.36.m2.1.1.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.36.36.m2.1.1.2.2.1a" xref="alg1.36.36.m2.1.1.2.2.1.cmml">​</mo><mi id="alg1.36.36.m2.1.1.2.2.4" xref="alg1.36.36.m2.1.1.2.2.4.cmml">t</mi></mrow><mo id="alg1.36.36.m2.1.1.2.1" xref="alg1.36.36.m2.1.1.2.1.cmml">~</mo></mover><mi id="alg1.36.36.m2.1.1.3" xref="alg1.36.36.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.36.36.m2.1b"><apply id="alg1.36.36.m2.1.1.cmml" xref="alg1.36.36.m2.1.1"><csymbol cd="ambiguous" id="alg1.36.36.m2.1.1.1.cmml" xref="alg1.36.36.m2.1.1">subscript</csymbol><apply id="alg1.36.36.m2.1.1.2.cmml" xref="alg1.36.36.m2.1.1.2"><ci id="alg1.36.36.m2.1.1.2.1.cmml" xref="alg1.36.36.m2.1.1.2.1">~</ci><apply id="alg1.36.36.m2.1.1.2.2.cmml" xref="alg1.36.36.m2.1.1.2.2"><times id="alg1.36.36.m2.1.1.2.2.1.cmml" xref="alg1.36.36.m2.1.1.2.2.1"></times><ci id="alg1.36.36.m2.1.1.2.2.2.cmml" xref="alg1.36.36.m2.1.1.2.2.2">𝑜</ci><ci id="alg1.36.36.m2.1.1.2.2.3.cmml" xref="alg1.36.36.m2.1.1.2.2.3">𝑢</ci><ci id="alg1.36.36.m2.1.1.2.2.4.cmml" xref="alg1.36.36.m2.1.1.2.2.4">𝑡</ci></apply></apply><ci id="alg1.36.36.m2.1.1.3.cmml" xref="alg1.36.36.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.36.36.m2.1c">\tilde{out}_{c}</annotation></semantics></math>

</div>
<div id="alg1.38.38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.37.37.m1.1" class="ltx_Math" alttext="\hat{X_{b}}\leftarrow" display="inline"><semantics id="alg1.37.37.m1.1a"><mrow id="alg1.37.37.m1.1.1" xref="alg1.37.37.m1.1.1.cmml"><mover accent="true" id="alg1.37.37.m1.1.1.2" xref="alg1.37.37.m1.1.1.2.cmml"><msub id="alg1.37.37.m1.1.1.2.2" xref="alg1.37.37.m1.1.1.2.2.cmml"><mi id="alg1.37.37.m1.1.1.2.2.2" xref="alg1.37.37.m1.1.1.2.2.2.cmml">X</mi><mi id="alg1.37.37.m1.1.1.2.2.3" xref="alg1.37.37.m1.1.1.2.2.3.cmml">b</mi></msub><mo id="alg1.37.37.m1.1.1.2.1" xref="alg1.37.37.m1.1.1.2.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.37.37.m1.1.1.1" xref="alg1.37.37.m1.1.1.1.cmml">←</mo><mi id="alg1.37.37.m1.1.1.3" xref="alg1.37.37.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.37.37.m1.1b"><apply id="alg1.37.37.m1.1.1.cmml" xref="alg1.37.37.m1.1.1"><ci id="alg1.37.37.m1.1.1.1.cmml" xref="alg1.37.37.m1.1.1.1">←</ci><apply id="alg1.37.37.m1.1.1.2.cmml" xref="alg1.37.37.m1.1.1.2"><ci id="alg1.37.37.m1.1.1.2.1.cmml" xref="alg1.37.37.m1.1.1.2.1">^</ci><apply id="alg1.37.37.m1.1.1.2.2.cmml" xref="alg1.37.37.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.37.37.m1.1.1.2.2.1.cmml" xref="alg1.37.37.m1.1.1.2.2">subscript</csymbol><ci id="alg1.37.37.m1.1.1.2.2.2.cmml" xref="alg1.37.37.m1.1.1.2.2.2">𝑋</ci><ci id="alg1.37.37.m1.1.1.2.2.3.cmml" xref="alg1.37.37.m1.1.1.2.2.3">𝑏</ci></apply></apply><csymbol cd="latexml" id="alg1.37.37.m1.1.1.3.cmml" xref="alg1.37.37.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.37.37.m1.1c">\hat{X_{b}}\leftarrow</annotation></semantics></math> <math id="alg1.38.38.m2.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_rec}}(D_{b})" display="inline"><semantics id="alg1.38.38.m2.1a"><mrow id="alg1.38.38.m2.1.1" xref="alg1.38.38.m2.1.1.cmml"><msub id="alg1.38.38.m2.1.1.3" xref="alg1.38.38.m2.1.1.3.cmml"><mi id="alg1.38.38.m2.1.1.3.2" xref="alg1.38.38.m2.1.1.3.2.cmml">f</mi><mrow id="alg1.38.38.m2.1.1.3.3" xref="alg1.38.38.m2.1.1.3.3.cmml"><mi id="alg1.38.38.m2.1.1.3.3.2" xref="alg1.38.38.m2.1.1.3.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg1.38.38.m2.1.1.3.3.1" xref="alg1.38.38.m2.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.38.38.m2.1.1.3.3.3" xref="alg1.38.38.m2.1.1.3.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.38.38.m2.1.1.3.3.1a" xref="alg1.38.38.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.38.38.m2.1.1.3.3.4" xref="alg1.38.38.m2.1.1.3.3.4.cmml">rec</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.38.38.m2.1.1.2" xref="alg1.38.38.m2.1.1.2.cmml">​</mo><mrow id="alg1.38.38.m2.1.1.1.1" xref="alg1.38.38.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.38.38.m2.1.1.1.1.2" xref="alg1.38.38.m2.1.1.1.1.1.cmml">(</mo><msub id="alg1.38.38.m2.1.1.1.1.1" xref="alg1.38.38.m2.1.1.1.1.1.cmml"><mi id="alg1.38.38.m2.1.1.1.1.1.2" xref="alg1.38.38.m2.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.38.38.m2.1.1.1.1.1.3" xref="alg1.38.38.m2.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="alg1.38.38.m2.1.1.1.1.3" xref="alg1.38.38.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.38.38.m2.1b"><apply id="alg1.38.38.m2.1.1.cmml" xref="alg1.38.38.m2.1.1"><times id="alg1.38.38.m2.1.1.2.cmml" xref="alg1.38.38.m2.1.1.2"></times><apply id="alg1.38.38.m2.1.1.3.cmml" xref="alg1.38.38.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.38.38.m2.1.1.3.1.cmml" xref="alg1.38.38.m2.1.1.3">subscript</csymbol><ci id="alg1.38.38.m2.1.1.3.2.cmml" xref="alg1.38.38.m2.1.1.3.2">𝑓</ci><apply id="alg1.38.38.m2.1.1.3.3.cmml" xref="alg1.38.38.m2.1.1.3.3"><times id="alg1.38.38.m2.1.1.3.3.1.cmml" xref="alg1.38.38.m2.1.1.3.3.1"></times><ci id="alg1.38.38.m2.1.1.3.3.2.cmml" xref="alg1.38.38.m2.1.1.3.3.2">bottom</ci><ci id="alg1.38.38.m2.1.1.3.3.3.cmml" xref="alg1.38.38.m2.1.1.3.3.3">_</ci><ci id="alg1.38.38.m2.1.1.3.3.4.cmml" xref="alg1.38.38.m2.1.1.3.3.4">rec</ci></apply></apply><apply id="alg1.38.38.m2.1.1.1.1.1.cmml" xref="alg1.38.38.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.38.38.m2.1.1.1.1.1.1.cmml" xref="alg1.38.38.m2.1.1.1.1">subscript</csymbol><ci id="alg1.38.38.m2.1.1.1.1.1.2.cmml" xref="alg1.38.38.m2.1.1.1.1.1.2">𝐷</ci><ci id="alg1.38.38.m2.1.1.1.1.1.3.cmml" xref="alg1.38.38.m2.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.38.38.m2.1c">f_{\mathrm{bottom\_rec}}(D_{b})</annotation></semantics></math>

</div>
<div id="alg1.40.40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.39.39.m1.1" class="ltx_Math" alttext="loss_{b}\leftarrow" display="inline"><semantics id="alg1.39.39.m1.1a"><mrow id="alg1.39.39.m1.1.1" xref="alg1.39.39.m1.1.1.cmml"><mrow id="alg1.39.39.m1.1.1.2" xref="alg1.39.39.m1.1.1.2.cmml"><mi id="alg1.39.39.m1.1.1.2.2" xref="alg1.39.39.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.39.39.m1.1.1.2.1" xref="alg1.39.39.m1.1.1.2.1.cmml">​</mo><mi id="alg1.39.39.m1.1.1.2.3" xref="alg1.39.39.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.39.39.m1.1.1.2.1a" xref="alg1.39.39.m1.1.1.2.1.cmml">​</mo><mi id="alg1.39.39.m1.1.1.2.4" xref="alg1.39.39.m1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.39.39.m1.1.1.2.1b" xref="alg1.39.39.m1.1.1.2.1.cmml">​</mo><msub id="alg1.39.39.m1.1.1.2.5" xref="alg1.39.39.m1.1.1.2.5.cmml"><mi id="alg1.39.39.m1.1.1.2.5.2" xref="alg1.39.39.m1.1.1.2.5.2.cmml">s</mi><mi id="alg1.39.39.m1.1.1.2.5.3" xref="alg1.39.39.m1.1.1.2.5.3.cmml">b</mi></msub></mrow><mo stretchy="false" id="alg1.39.39.m1.1.1.1" xref="alg1.39.39.m1.1.1.1.cmml">←</mo><mi id="alg1.39.39.m1.1.1.3" xref="alg1.39.39.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.39.39.m1.1b"><apply id="alg1.39.39.m1.1.1.cmml" xref="alg1.39.39.m1.1.1"><ci id="alg1.39.39.m1.1.1.1.cmml" xref="alg1.39.39.m1.1.1.1">←</ci><apply id="alg1.39.39.m1.1.1.2.cmml" xref="alg1.39.39.m1.1.1.2"><times id="alg1.39.39.m1.1.1.2.1.cmml" xref="alg1.39.39.m1.1.1.2.1"></times><ci id="alg1.39.39.m1.1.1.2.2.cmml" xref="alg1.39.39.m1.1.1.2.2">𝑙</ci><ci id="alg1.39.39.m1.1.1.2.3.cmml" xref="alg1.39.39.m1.1.1.2.3">𝑜</ci><ci id="alg1.39.39.m1.1.1.2.4.cmml" xref="alg1.39.39.m1.1.1.2.4">𝑠</ci><apply id="alg1.39.39.m1.1.1.2.5.cmml" xref="alg1.39.39.m1.1.1.2.5"><csymbol cd="ambiguous" id="alg1.39.39.m1.1.1.2.5.1.cmml" xref="alg1.39.39.m1.1.1.2.5">subscript</csymbol><ci id="alg1.39.39.m1.1.1.2.5.2.cmml" xref="alg1.39.39.m1.1.1.2.5.2">𝑠</ci><ci id="alg1.39.39.m1.1.1.2.5.3.cmml" xref="alg1.39.39.m1.1.1.2.5.3">𝑏</ci></apply></apply><csymbol cd="latexml" id="alg1.39.39.m1.1.1.3.cmml" xref="alg1.39.39.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.39.39.m1.1c">loss_{b}\leftarrow</annotation></semantics></math> <math id="alg1.40.40.m2.3" class="ltx_Math" alttext="reconstruction\_loss(X_{b},\hat{X_{b}},S_{b})" display="inline"><semantics id="alg1.40.40.m2.3a"><mrow id="alg1.40.40.m2.3.3" xref="alg1.40.40.m2.3.3.cmml"><mi id="alg1.40.40.m2.3.3.4" xref="alg1.40.40.m2.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.5" xref="alg1.40.40.m2.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3a" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.6" xref="alg1.40.40.m2.3.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3b" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.7" xref="alg1.40.40.m2.3.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3c" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.8" xref="alg1.40.40.m2.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3d" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.9" xref="alg1.40.40.m2.3.3.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3e" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.10" xref="alg1.40.40.m2.3.3.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3f" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.11" xref="alg1.40.40.m2.3.3.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3g" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.12" xref="alg1.40.40.m2.3.3.12.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3h" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.13" xref="alg1.40.40.m2.3.3.13.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3i" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.14" xref="alg1.40.40.m2.3.3.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3j" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.15" xref="alg1.40.40.m2.3.3.15.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3k" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.16" xref="alg1.40.40.m2.3.3.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3l" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.17" xref="alg1.40.40.m2.3.3.17.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3m" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi mathvariant="normal" id="alg1.40.40.m2.3.3.18" xref="alg1.40.40.m2.3.3.18.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3n" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.19" xref="alg1.40.40.m2.3.3.19.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3o" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.20" xref="alg1.40.40.m2.3.3.20.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3p" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.21" xref="alg1.40.40.m2.3.3.21.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3q" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mi id="alg1.40.40.m2.3.3.22" xref="alg1.40.40.m2.3.3.22.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.40.40.m2.3.3.3r" xref="alg1.40.40.m2.3.3.3.cmml">​</mo><mrow id="alg1.40.40.m2.3.3.2.2" xref="alg1.40.40.m2.3.3.2.3.cmml"><mo stretchy="false" id="alg1.40.40.m2.3.3.2.2.3" xref="alg1.40.40.m2.3.3.2.3.cmml">(</mo><msub id="alg1.40.40.m2.2.2.1.1.1" xref="alg1.40.40.m2.2.2.1.1.1.cmml"><mi id="alg1.40.40.m2.2.2.1.1.1.2" xref="alg1.40.40.m2.2.2.1.1.1.2.cmml">X</mi><mi id="alg1.40.40.m2.2.2.1.1.1.3" xref="alg1.40.40.m2.2.2.1.1.1.3.cmml">b</mi></msub><mo id="alg1.40.40.m2.3.3.2.2.4" xref="alg1.40.40.m2.3.3.2.3.cmml">,</mo><mover accent="true" id="alg1.40.40.m2.1.1" xref="alg1.40.40.m2.1.1.cmml"><msub id="alg1.40.40.m2.1.1.2" xref="alg1.40.40.m2.1.1.2.cmml"><mi id="alg1.40.40.m2.1.1.2.2" xref="alg1.40.40.m2.1.1.2.2.cmml">X</mi><mi id="alg1.40.40.m2.1.1.2.3" xref="alg1.40.40.m2.1.1.2.3.cmml">b</mi></msub><mo id="alg1.40.40.m2.1.1.1" xref="alg1.40.40.m2.1.1.1.cmml">^</mo></mover><mo id="alg1.40.40.m2.3.3.2.2.5" xref="alg1.40.40.m2.3.3.2.3.cmml">,</mo><msub id="alg1.40.40.m2.3.3.2.2.2" xref="alg1.40.40.m2.3.3.2.2.2.cmml"><mi id="alg1.40.40.m2.3.3.2.2.2.2" xref="alg1.40.40.m2.3.3.2.2.2.2.cmml">S</mi><mi id="alg1.40.40.m2.3.3.2.2.2.3" xref="alg1.40.40.m2.3.3.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="alg1.40.40.m2.3.3.2.2.6" xref="alg1.40.40.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.40.40.m2.3b"><apply id="alg1.40.40.m2.3.3.cmml" xref="alg1.40.40.m2.3.3"><times id="alg1.40.40.m2.3.3.3.cmml" xref="alg1.40.40.m2.3.3.3"></times><ci id="alg1.40.40.m2.3.3.4.cmml" xref="alg1.40.40.m2.3.3.4">𝑟</ci><ci id="alg1.40.40.m2.3.3.5.cmml" xref="alg1.40.40.m2.3.3.5">𝑒</ci><ci id="alg1.40.40.m2.3.3.6.cmml" xref="alg1.40.40.m2.3.3.6">𝑐</ci><ci id="alg1.40.40.m2.3.3.7.cmml" xref="alg1.40.40.m2.3.3.7">𝑜</ci><ci id="alg1.40.40.m2.3.3.8.cmml" xref="alg1.40.40.m2.3.3.8">𝑛</ci><ci id="alg1.40.40.m2.3.3.9.cmml" xref="alg1.40.40.m2.3.3.9">𝑠</ci><ci id="alg1.40.40.m2.3.3.10.cmml" xref="alg1.40.40.m2.3.3.10">𝑡</ci><ci id="alg1.40.40.m2.3.3.11.cmml" xref="alg1.40.40.m2.3.3.11">𝑟</ci><ci id="alg1.40.40.m2.3.3.12.cmml" xref="alg1.40.40.m2.3.3.12">𝑢</ci><ci id="alg1.40.40.m2.3.3.13.cmml" xref="alg1.40.40.m2.3.3.13">𝑐</ci><ci id="alg1.40.40.m2.3.3.14.cmml" xref="alg1.40.40.m2.3.3.14">𝑡</ci><ci id="alg1.40.40.m2.3.3.15.cmml" xref="alg1.40.40.m2.3.3.15">𝑖</ci><ci id="alg1.40.40.m2.3.3.16.cmml" xref="alg1.40.40.m2.3.3.16">𝑜</ci><ci id="alg1.40.40.m2.3.3.17.cmml" xref="alg1.40.40.m2.3.3.17">𝑛</ci><ci id="alg1.40.40.m2.3.3.18.cmml" xref="alg1.40.40.m2.3.3.18">_</ci><ci id="alg1.40.40.m2.3.3.19.cmml" xref="alg1.40.40.m2.3.3.19">𝑙</ci><ci id="alg1.40.40.m2.3.3.20.cmml" xref="alg1.40.40.m2.3.3.20">𝑜</ci><ci id="alg1.40.40.m2.3.3.21.cmml" xref="alg1.40.40.m2.3.3.21">𝑠</ci><ci id="alg1.40.40.m2.3.3.22.cmml" xref="alg1.40.40.m2.3.3.22">𝑠</ci><vector id="alg1.40.40.m2.3.3.2.3.cmml" xref="alg1.40.40.m2.3.3.2.2"><apply id="alg1.40.40.m2.2.2.1.1.1.cmml" xref="alg1.40.40.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.40.40.m2.2.2.1.1.1.1.cmml" xref="alg1.40.40.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.40.40.m2.2.2.1.1.1.2.cmml" xref="alg1.40.40.m2.2.2.1.1.1.2">𝑋</ci><ci id="alg1.40.40.m2.2.2.1.1.1.3.cmml" xref="alg1.40.40.m2.2.2.1.1.1.3">𝑏</ci></apply><apply id="alg1.40.40.m2.1.1.cmml" xref="alg1.40.40.m2.1.1"><ci id="alg1.40.40.m2.1.1.1.cmml" xref="alg1.40.40.m2.1.1.1">^</ci><apply id="alg1.40.40.m2.1.1.2.cmml" xref="alg1.40.40.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.40.40.m2.1.1.2.1.cmml" xref="alg1.40.40.m2.1.1.2">subscript</csymbol><ci id="alg1.40.40.m2.1.1.2.2.cmml" xref="alg1.40.40.m2.1.1.2.2">𝑋</ci><ci id="alg1.40.40.m2.1.1.2.3.cmml" xref="alg1.40.40.m2.1.1.2.3">𝑏</ci></apply></apply><apply id="alg1.40.40.m2.3.3.2.2.2.cmml" xref="alg1.40.40.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.40.40.m2.3.3.2.2.2.1.cmml" xref="alg1.40.40.m2.3.3.2.2.2">subscript</csymbol><ci id="alg1.40.40.m2.3.3.2.2.2.2.cmml" xref="alg1.40.40.m2.3.3.2.2.2.2">𝑆</ci><ci id="alg1.40.40.m2.3.3.2.2.2.3.cmml" xref="alg1.40.40.m2.3.3.2.2.2.3">𝑏</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.40.40.m2.3c">reconstruction\_loss(X_{b},\hat{X_{b}},S_{b})</annotation></semantics></math>

</div>
<div id="alg1.41.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Send <math id="alg1.41.41.m1.1" class="ltx_Math" alttext="loss_{b}" display="inline"><semantics id="alg1.41.41.m1.1a"><mrow id="alg1.41.41.m1.1.1" xref="alg1.41.41.m1.1.1.cmml"><mi id="alg1.41.41.m1.1.1.2" xref="alg1.41.41.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.41.41.m1.1.1.1" xref="alg1.41.41.m1.1.1.1.cmml">​</mo><mi id="alg1.41.41.m1.1.1.3" xref="alg1.41.41.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.41.41.m1.1.1.1a" xref="alg1.41.41.m1.1.1.1.cmml">​</mo><mi id="alg1.41.41.m1.1.1.4" xref="alg1.41.41.m1.1.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.41.41.m1.1.1.1b" xref="alg1.41.41.m1.1.1.1.cmml">​</mo><msub id="alg1.41.41.m1.1.1.5" xref="alg1.41.41.m1.1.1.5.cmml"><mi id="alg1.41.41.m1.1.1.5.2" xref="alg1.41.41.m1.1.1.5.2.cmml">s</mi><mi id="alg1.41.41.m1.1.1.5.3" xref="alg1.41.41.m1.1.1.5.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.41.41.m1.1b"><apply id="alg1.41.41.m1.1.1.cmml" xref="alg1.41.41.m1.1.1"><times id="alg1.41.41.m1.1.1.1.cmml" xref="alg1.41.41.m1.1.1.1"></times><ci id="alg1.41.41.m1.1.1.2.cmml" xref="alg1.41.41.m1.1.1.2">𝑙</ci><ci id="alg1.41.41.m1.1.1.3.cmml" xref="alg1.41.41.m1.1.1.3">𝑜</ci><ci id="alg1.41.41.m1.1.1.4.cmml" xref="alg1.41.41.m1.1.1.4">𝑠</ci><apply id="alg1.41.41.m1.1.1.5.cmml" xref="alg1.41.41.m1.1.1.5"><csymbol cd="ambiguous" id="alg1.41.41.m1.1.1.5.1.cmml" xref="alg1.41.41.m1.1.1.5">subscript</csymbol><ci id="alg1.41.41.m1.1.1.5.2.cmml" xref="alg1.41.41.m1.1.1.5.2">𝑠</ci><ci id="alg1.41.41.m1.1.1.5.3.cmml" xref="alg1.41.41.m1.1.1.5.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.41.41.m1.1c">loss_{b}</annotation></semantics></math> to host

</div>
<div id="alg1.45.57" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.45.57.1" class="ltx_text">/* </span><span id="alg1.45.57.2" class="ltx_text ltx_font_bold">Client 1 (Host)</span>  */
</div>
<div id="alg1.42.42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.42.42.m1.1" class="ltx_Math" alttext="total\_loss" display="inline"><semantics id="alg1.42.42.m1.1a"><mrow id="alg1.42.42.m1.1.1" xref="alg1.42.42.m1.1.1.cmml"><mi id="alg1.42.42.m1.1.1.2" xref="alg1.42.42.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.3" xref="alg1.42.42.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1a" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.4" xref="alg1.42.42.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1b" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.5" xref="alg1.42.42.m1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1c" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.6" xref="alg1.42.42.m1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1d" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg1.42.42.m1.1.1.7" xref="alg1.42.42.m1.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1e" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.8" xref="alg1.42.42.m1.1.1.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1f" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.9" xref="alg1.42.42.m1.1.1.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1g" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.10" xref="alg1.42.42.m1.1.1.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.42.42.m1.1.1.1h" xref="alg1.42.42.m1.1.1.1.cmml">​</mo><mi id="alg1.42.42.m1.1.1.11" xref="alg1.42.42.m1.1.1.11.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.42.42.m1.1b"><apply id="alg1.42.42.m1.1.1.cmml" xref="alg1.42.42.m1.1.1"><times id="alg1.42.42.m1.1.1.1.cmml" xref="alg1.42.42.m1.1.1.1"></times><ci id="alg1.42.42.m1.1.1.2.cmml" xref="alg1.42.42.m1.1.1.2">𝑡</ci><ci id="alg1.42.42.m1.1.1.3.cmml" xref="alg1.42.42.m1.1.1.3">𝑜</ci><ci id="alg1.42.42.m1.1.1.4.cmml" xref="alg1.42.42.m1.1.1.4">𝑡</ci><ci id="alg1.42.42.m1.1.1.5.cmml" xref="alg1.42.42.m1.1.1.5">𝑎</ci><ci id="alg1.42.42.m1.1.1.6.cmml" xref="alg1.42.42.m1.1.1.6">𝑙</ci><ci id="alg1.42.42.m1.1.1.7.cmml" xref="alg1.42.42.m1.1.1.7">_</ci><ci id="alg1.42.42.m1.1.1.8.cmml" xref="alg1.42.42.m1.1.1.8">𝑙</ci><ci id="alg1.42.42.m1.1.1.9.cmml" xref="alg1.42.42.m1.1.1.9">𝑜</ci><ci id="alg1.42.42.m1.1.1.10.cmml" xref="alg1.42.42.m1.1.1.10">𝑠</ci><ci id="alg1.42.42.m1.1.1.11.cmml" xref="alg1.42.42.m1.1.1.11">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.42.42.m1.1c">total\_loss</annotation></semantics></math> = 0

</div>
<div id="alg1.43.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.43.43.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.43.43.1" class="ltx_emph ltx_font_italic"><math id="alg1.43.43.1.m1.2" class="ltx_Math" alttext="c\in[2,K]" display="inline"><semantics id="alg1.43.43.1.m1.2a"><mrow id="alg1.43.43.1.m1.2.3" xref="alg1.43.43.1.m1.2.3.cmml"><mi id="alg1.43.43.1.m1.2.3.2" xref="alg1.43.43.1.m1.2.3.2.cmml">c</mi><mo id="alg1.43.43.1.m1.2.3.1" xref="alg1.43.43.1.m1.2.3.1.cmml">∈</mo><mrow id="alg1.43.43.1.m1.2.3.3.2" xref="alg1.43.43.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.43.43.1.m1.2.3.3.2.1" xref="alg1.43.43.1.m1.2.3.3.1.cmml">[</mo><mn id="alg1.43.43.1.m1.1.1" xref="alg1.43.43.1.m1.1.1.cmml">2</mn><mo id="alg1.43.43.1.m1.2.3.3.2.2" xref="alg1.43.43.1.m1.2.3.3.1.cmml">,</mo><mi id="alg1.43.43.1.m1.2.2" xref="alg1.43.43.1.m1.2.2.cmml">K</mi><mo stretchy="false" id="alg1.43.43.1.m1.2.3.3.2.3" xref="alg1.43.43.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.43.43.1.m1.2b"><apply id="alg1.43.43.1.m1.2.3.cmml" xref="alg1.43.43.1.m1.2.3"><in id="alg1.43.43.1.m1.2.3.1.cmml" xref="alg1.43.43.1.m1.2.3.1"></in><ci id="alg1.43.43.1.m1.2.3.2.cmml" xref="alg1.43.43.1.m1.2.3.2">𝑐</ci><interval closure="closed" id="alg1.43.43.1.m1.2.3.3.1.cmml" xref="alg1.43.43.1.m1.2.3.3.2"><cn type="integer" id="alg1.43.43.1.m1.1.1.cmml" xref="alg1.43.43.1.m1.1.1">2</cn><ci id="alg1.43.43.1.m1.2.2.cmml" xref="alg1.43.43.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.43.43.1.m1.2c">c\in[2,K]</annotation></semantics></math></em> <span id="alg1.43.43.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.45.58" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.45.58.1" class="ltx_text ltx_font_bold">if</span> <em id="alg1.45.58.2" class="ltx_emph ltx_font_italic">client c is offline</em> <span id="alg1.45.58.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg1.45.59" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
continue

</div>
<div id="alg1.45.60" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.44.44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.44.44.m1.1" class="ltx_Math" alttext="loss_{c}\leftarrow" display="inline"><semantics id="alg1.44.44.m1.1a"><mrow id="alg1.44.44.m1.1.1" xref="alg1.44.44.m1.1.1.cmml"><mrow id="alg1.44.44.m1.1.1.2" xref="alg1.44.44.m1.1.1.2.cmml"><mi id="alg1.44.44.m1.1.1.2.2" xref="alg1.44.44.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.44.44.m1.1.1.2.1" xref="alg1.44.44.m1.1.1.2.1.cmml">​</mo><mi id="alg1.44.44.m1.1.1.2.3" xref="alg1.44.44.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.44.44.m1.1.1.2.1a" xref="alg1.44.44.m1.1.1.2.1.cmml">​</mo><mi id="alg1.44.44.m1.1.1.2.4" xref="alg1.44.44.m1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.44.44.m1.1.1.2.1b" xref="alg1.44.44.m1.1.1.2.1.cmml">​</mo><msub id="alg1.44.44.m1.1.1.2.5" xref="alg1.44.44.m1.1.1.2.5.cmml"><mi id="alg1.44.44.m1.1.1.2.5.2" xref="alg1.44.44.m1.1.1.2.5.2.cmml">s</mi><mi id="alg1.44.44.m1.1.1.2.5.3" xref="alg1.44.44.m1.1.1.2.5.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="alg1.44.44.m1.1.1.1" xref="alg1.44.44.m1.1.1.1.cmml">←</mo><mi id="alg1.44.44.m1.1.1.3" xref="alg1.44.44.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.44.44.m1.1b"><apply id="alg1.44.44.m1.1.1.cmml" xref="alg1.44.44.m1.1.1"><ci id="alg1.44.44.m1.1.1.1.cmml" xref="alg1.44.44.m1.1.1.1">←</ci><apply id="alg1.44.44.m1.1.1.2.cmml" xref="alg1.44.44.m1.1.1.2"><times id="alg1.44.44.m1.1.1.2.1.cmml" xref="alg1.44.44.m1.1.1.2.1"></times><ci id="alg1.44.44.m1.1.1.2.2.cmml" xref="alg1.44.44.m1.1.1.2.2">𝑙</ci><ci id="alg1.44.44.m1.1.1.2.3.cmml" xref="alg1.44.44.m1.1.1.2.3">𝑜</ci><ci id="alg1.44.44.m1.1.1.2.4.cmml" xref="alg1.44.44.m1.1.1.2.4">𝑠</ci><apply id="alg1.44.44.m1.1.1.2.5.cmml" xref="alg1.44.44.m1.1.1.2.5"><csymbol cd="ambiguous" id="alg1.44.44.m1.1.1.2.5.1.cmml" xref="alg1.44.44.m1.1.1.2.5">subscript</csymbol><ci id="alg1.44.44.m1.1.1.2.5.2.cmml" xref="alg1.44.44.m1.1.1.2.5.2">𝑠</ci><ci id="alg1.44.44.m1.1.1.2.5.3.cmml" xref="alg1.44.44.m1.1.1.2.5.3">𝑐</ci></apply></apply><csymbol cd="latexml" id="alg1.44.44.m1.1.1.3.cmml" xref="alg1.44.44.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.44.44.m1.1c">loss_{c}\leftarrow</annotation></semantics></math> Receive mini-batch unsupervised loss

</div>
<div id="alg1.45.45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.45.45.m1.1" class="ltx_Math" alttext="total\_loss=total\_loss+loss_{c}" display="inline"><semantics id="alg1.45.45.m1.1a"><mrow id="alg1.45.45.m1.1.1" xref="alg1.45.45.m1.1.1.cmml"><mrow id="alg1.45.45.m1.1.1.2" xref="alg1.45.45.m1.1.1.2.cmml"><mi id="alg1.45.45.m1.1.1.2.2" xref="alg1.45.45.m1.1.1.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.3" xref="alg1.45.45.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1a" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.4" xref="alg1.45.45.m1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1b" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.5" xref="alg1.45.45.m1.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1c" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.6" xref="alg1.45.45.m1.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1d" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.45.45.m1.1.1.2.7" xref="alg1.45.45.m1.1.1.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1e" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.8" xref="alg1.45.45.m1.1.1.2.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1f" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.9" xref="alg1.45.45.m1.1.1.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1g" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.10" xref="alg1.45.45.m1.1.1.2.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.2.1h" xref="alg1.45.45.m1.1.1.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.2.11" xref="alg1.45.45.m1.1.1.2.11.cmml">s</mi></mrow><mo id="alg1.45.45.m1.1.1.1" xref="alg1.45.45.m1.1.1.1.cmml">=</mo><mrow id="alg1.45.45.m1.1.1.3" xref="alg1.45.45.m1.1.1.3.cmml"><mrow id="alg1.45.45.m1.1.1.3.2" xref="alg1.45.45.m1.1.1.3.2.cmml"><mi id="alg1.45.45.m1.1.1.3.2.2" xref="alg1.45.45.m1.1.1.3.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.3" xref="alg1.45.45.m1.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1a" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.4" xref="alg1.45.45.m1.1.1.3.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1b" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.5" xref="alg1.45.45.m1.1.1.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1c" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.6" xref="alg1.45.45.m1.1.1.3.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1d" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.45.45.m1.1.1.3.2.7" xref="alg1.45.45.m1.1.1.3.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1e" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.8" xref="alg1.45.45.m1.1.1.3.2.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1f" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.9" xref="alg1.45.45.m1.1.1.3.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1g" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.10" xref="alg1.45.45.m1.1.1.3.2.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.2.1h" xref="alg1.45.45.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.2.11" xref="alg1.45.45.m1.1.1.3.2.11.cmml">s</mi></mrow><mo id="alg1.45.45.m1.1.1.3.1" xref="alg1.45.45.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.45.45.m1.1.1.3.3" xref="alg1.45.45.m1.1.1.3.3.cmml"><mi id="alg1.45.45.m1.1.1.3.3.2" xref="alg1.45.45.m1.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.3.1" xref="alg1.45.45.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.3.3" xref="alg1.45.45.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.3.1a" xref="alg1.45.45.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.45.45.m1.1.1.3.3.4" xref="alg1.45.45.m1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.45.45.m1.1.1.3.3.1b" xref="alg1.45.45.m1.1.1.3.3.1.cmml">​</mo><msub id="alg1.45.45.m1.1.1.3.3.5" xref="alg1.45.45.m1.1.1.3.3.5.cmml"><mi id="alg1.45.45.m1.1.1.3.3.5.2" xref="alg1.45.45.m1.1.1.3.3.5.2.cmml">s</mi><mi id="alg1.45.45.m1.1.1.3.3.5.3" xref="alg1.45.45.m1.1.1.3.3.5.3.cmml">c</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.45.45.m1.1b"><apply id="alg1.45.45.m1.1.1.cmml" xref="alg1.45.45.m1.1.1"><eq id="alg1.45.45.m1.1.1.1.cmml" xref="alg1.45.45.m1.1.1.1"></eq><apply id="alg1.45.45.m1.1.1.2.cmml" xref="alg1.45.45.m1.1.1.2"><times id="alg1.45.45.m1.1.1.2.1.cmml" xref="alg1.45.45.m1.1.1.2.1"></times><ci id="alg1.45.45.m1.1.1.2.2.cmml" xref="alg1.45.45.m1.1.1.2.2">𝑡</ci><ci id="alg1.45.45.m1.1.1.2.3.cmml" xref="alg1.45.45.m1.1.1.2.3">𝑜</ci><ci id="alg1.45.45.m1.1.1.2.4.cmml" xref="alg1.45.45.m1.1.1.2.4">𝑡</ci><ci id="alg1.45.45.m1.1.1.2.5.cmml" xref="alg1.45.45.m1.1.1.2.5">𝑎</ci><ci id="alg1.45.45.m1.1.1.2.6.cmml" xref="alg1.45.45.m1.1.1.2.6">𝑙</ci><ci id="alg1.45.45.m1.1.1.2.7.cmml" xref="alg1.45.45.m1.1.1.2.7">_</ci><ci id="alg1.45.45.m1.1.1.2.8.cmml" xref="alg1.45.45.m1.1.1.2.8">𝑙</ci><ci id="alg1.45.45.m1.1.1.2.9.cmml" xref="alg1.45.45.m1.1.1.2.9">𝑜</ci><ci id="alg1.45.45.m1.1.1.2.10.cmml" xref="alg1.45.45.m1.1.1.2.10">𝑠</ci><ci id="alg1.45.45.m1.1.1.2.11.cmml" xref="alg1.45.45.m1.1.1.2.11">𝑠</ci></apply><apply id="alg1.45.45.m1.1.1.3.cmml" xref="alg1.45.45.m1.1.1.3"><plus id="alg1.45.45.m1.1.1.3.1.cmml" xref="alg1.45.45.m1.1.1.3.1"></plus><apply id="alg1.45.45.m1.1.1.3.2.cmml" xref="alg1.45.45.m1.1.1.3.2"><times id="alg1.45.45.m1.1.1.3.2.1.cmml" xref="alg1.45.45.m1.1.1.3.2.1"></times><ci id="alg1.45.45.m1.1.1.3.2.2.cmml" xref="alg1.45.45.m1.1.1.3.2.2">𝑡</ci><ci id="alg1.45.45.m1.1.1.3.2.3.cmml" xref="alg1.45.45.m1.1.1.3.2.3">𝑜</ci><ci id="alg1.45.45.m1.1.1.3.2.4.cmml" xref="alg1.45.45.m1.1.1.3.2.4">𝑡</ci><ci id="alg1.45.45.m1.1.1.3.2.5.cmml" xref="alg1.45.45.m1.1.1.3.2.5">𝑎</ci><ci id="alg1.45.45.m1.1.1.3.2.6.cmml" xref="alg1.45.45.m1.1.1.3.2.6">𝑙</ci><ci id="alg1.45.45.m1.1.1.3.2.7.cmml" xref="alg1.45.45.m1.1.1.3.2.7">_</ci><ci id="alg1.45.45.m1.1.1.3.2.8.cmml" xref="alg1.45.45.m1.1.1.3.2.8">𝑙</ci><ci id="alg1.45.45.m1.1.1.3.2.9.cmml" xref="alg1.45.45.m1.1.1.3.2.9">𝑜</ci><ci id="alg1.45.45.m1.1.1.3.2.10.cmml" xref="alg1.45.45.m1.1.1.3.2.10">𝑠</ci><ci id="alg1.45.45.m1.1.1.3.2.11.cmml" xref="alg1.45.45.m1.1.1.3.2.11">𝑠</ci></apply><apply id="alg1.45.45.m1.1.1.3.3.cmml" xref="alg1.45.45.m1.1.1.3.3"><times id="alg1.45.45.m1.1.1.3.3.1.cmml" xref="alg1.45.45.m1.1.1.3.3.1"></times><ci id="alg1.45.45.m1.1.1.3.3.2.cmml" xref="alg1.45.45.m1.1.1.3.3.2">𝑙</ci><ci id="alg1.45.45.m1.1.1.3.3.3.cmml" xref="alg1.45.45.m1.1.1.3.3.3">𝑜</ci><ci id="alg1.45.45.m1.1.1.3.3.4.cmml" xref="alg1.45.45.m1.1.1.3.3.4">𝑠</ci><apply id="alg1.45.45.m1.1.1.3.3.5.cmml" xref="alg1.45.45.m1.1.1.3.3.5"><csymbol cd="ambiguous" id="alg1.45.45.m1.1.1.3.3.5.1.cmml" xref="alg1.45.45.m1.1.1.3.3.5">subscript</csymbol><ci id="alg1.45.45.m1.1.1.3.3.5.2.cmml" xref="alg1.45.45.m1.1.1.3.3.5.2">𝑠</ci><ci id="alg1.45.45.m1.1.1.3.3.5.3.cmml" xref="alg1.45.45.m1.1.1.3.3.5.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.45.45.m1.1c">total\_loss=total\_loss+loss_{c}</annotation></semantics></math>

</div>
<div id="alg1.45.61" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.45.62" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate gradients and update the weights

</div>
<div id="alg1.45.63" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.45.64" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.47.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>TabVFL Pretraining Process</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Client Failure Handling</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Usually in practical cases, variation in the systems of the guest clients can naturally lead to training errors during the training session. This error can occur when a guest client is unable to complete the training due to an unreliable channel or limited data transfer speed, resulting in a failed connection. We propose a caching method for handling abrupt failures of clients to improve robustness and stability during training. The method is implemented in the host client as that is where the intermediate results are handled of each guest client.
During training, if a client goes offline then its stored/cached batch of results are reused instead (code lines <span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_bold">10</span>-<span id="S4.SS5.p1.1.2" class="ltx_text ltx_font_bold">11</span> in <a href="#alg1" title="1 ‣ IV-D Training Details ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 1</span></a> and <span id="S4.SS5.p1.1.3" class="ltx_text ltx_font_bold">9</span> in <a href="#alg2" title="2 ‣ IV-E Client Failure Handling ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 2</span></a>). When a client is online again, the corresponding batches in the cache are replaced by the new intermediate results (code lines <span id="S4.SS5.p1.1.4" class="ltx_text ltx_font_bold">13</span>-<span id="S4.SS5.p1.1.5" class="ltx_text ltx_font_bold">14</span> in <a href="#alg1" title="1 ‣ IV-D Training Details ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 1</span></a> and <span id="S4.SS5.p1.1.6" class="ltx_text ltx_font_bold">11</span> in <a href="#alg2" title="2 ‣ IV-E Client Failure Handling ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Alg. 2</span></a>). Therefore, we enforce that the clients must be online during the initial epoch.
To simulate the failures using the proposed framework, the guest clients are given the same probability of being considered offline. Let <span id="S4.SS5.p1.1.7" class="ltx_text ltx_font_italic">M</span> be the number of guest clients. Each guest client <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="\textbf{{c}}\in M" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mrow id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2a.cmml">c</mtext><mo id="S4.SS5.p1.1.m1.1.1.1" xref="S4.SS5.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><in id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1"></in><ci id="S4.SS5.p1.1.m1.1.1.2a.cmml" xref="S4.SS5.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">c</mtext></ci><ci id="S4.SS5.p1.1.m1.1.1.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\textbf{{c}}\in M</annotation></semantics></math> follows a binary failure probability distribution:</p>
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex1.m1.2" class="ltx_Math" alttext="\textit{{p}}_{c}\sim Bernoulli(P\_{fail})\quad\forall c\in M" display="block"><semantics id="S4.Ex1.m1.2a"><mrow id="S4.Ex1.m1.2.2.2" xref="S4.Ex1.m1.2.2.3.cmml"><mrow id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml"><msub id="S4.Ex1.m1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.Ex1.m1.1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.1.3.2a.cmml">p</mtext><mi id="S4.Ex1.m1.1.1.1.1.3.3" xref="S4.Ex1.m1.1.1.1.1.3.3.cmml">c</mi></msub><mo id="S4.Ex1.m1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.2.cmml">∼</mo><mrow id="S4.Ex1.m1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.4" xref="S4.Ex1.m1.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2a" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.5" xref="S4.Ex1.m1.1.1.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2b" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.6" xref="S4.Ex1.m1.1.1.1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2c" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.7" xref="S4.Ex1.m1.1.1.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2d" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.8" xref="S4.Ex1.m1.1.1.1.1.1.8.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2e" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.9" xref="S4.Ex1.m1.1.1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2f" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.10" xref="S4.Ex1.m1.1.1.1.1.1.10.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2g" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.11" xref="S4.Ex1.m1.1.1.1.1.1.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.2h" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1a" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.4" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1b" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.5" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1c" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.6" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1d" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.7" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.7.cmml">l</mi></mrow><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace width="1.167em" id="S4.Ex1.m1.2.2.2.3" xref="S4.Ex1.m1.2.2.3a.cmml"></mspace><mrow id="S4.Ex1.m1.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.cmml"><mrow id="S4.Ex1.m1.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.cmml"><mo rspace="0.167em" id="S4.Ex1.m1.2.2.2.2.2.1" xref="S4.Ex1.m1.2.2.2.2.2.1.cmml">∀</mo><mi id="S4.Ex1.m1.2.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.2.cmml">c</mi></mrow><mo id="S4.Ex1.m1.2.2.2.2.1" xref="S4.Ex1.m1.2.2.2.2.1.cmml">∈</mo><mi id="S4.Ex1.m1.2.2.2.2.3" xref="S4.Ex1.m1.2.2.2.2.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.2b"><apply id="S4.Ex1.m1.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.3a.cmml" xref="S4.Ex1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.2">similar-to</csymbol><apply id="S4.Ex1.m1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.1.1.1.1.3.2a.cmml" xref="S4.Ex1.m1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.Ex1.m1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.1.1.3.2">p</mtext></ci><ci id="S4.Ex1.m1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m1.1.1.1.1.3.3">𝑐</ci></apply><apply id="S4.Ex1.m1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1"><times id="S4.Ex1.m1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.2"></times><ci id="S4.Ex1.m1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.3">𝐵</ci><ci id="S4.Ex1.m1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m1.1.1.1.1.1.4">𝑒</ci><ci id="S4.Ex1.m1.1.1.1.1.1.5.cmml" xref="S4.Ex1.m1.1.1.1.1.1.5">𝑟</ci><ci id="S4.Ex1.m1.1.1.1.1.1.6.cmml" xref="S4.Ex1.m1.1.1.1.1.1.6">𝑛</ci><ci id="S4.Ex1.m1.1.1.1.1.1.7.cmml" xref="S4.Ex1.m1.1.1.1.1.1.7">𝑜</ci><ci id="S4.Ex1.m1.1.1.1.1.1.8.cmml" xref="S4.Ex1.m1.1.1.1.1.1.8">𝑢</ci><ci id="S4.Ex1.m1.1.1.1.1.1.9.cmml" xref="S4.Ex1.m1.1.1.1.1.1.9">𝑙</ci><ci id="S4.Ex1.m1.1.1.1.1.1.10.cmml" xref="S4.Ex1.m1.1.1.1.1.1.10">𝑙</ci><ci id="S4.Ex1.m1.1.1.1.1.1.11.cmml" xref="S4.Ex1.m1.1.1.1.1.1.11">𝑖</ci><apply id="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1"><times id="S4.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.2">𝑃</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.3">_</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.4">𝑓</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.5">𝑎</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.6">𝑖</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.1.7.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.7">𝑙</ci></apply></apply></apply><apply id="S4.Ex1.m1.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2"><in id="S4.Ex1.m1.2.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.1"></in><apply id="S4.Ex1.m1.2.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2"><csymbol cd="latexml" id="S4.Ex1.m1.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1">for-all</csymbol><ci id="S4.Ex1.m1.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2">𝑐</ci></apply><ci id="S4.Ex1.m1.2.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.2.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.2c">\textit{{p}}_{c}\sim Bernoulli(P\_{fail})\quad\forall c\in M</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS5.p1.3" class="ltx_p">We simulate the setting by sampling a float value <span id="S4.SS5.p1.3.1" class="ltx_text ltx_font_bold ltx_font_italic">x</span> from a random variable that follows a uniform distribution for each client, i.e. <math id="S4.SS5.p1.2.m1.2" class="ltx_Math" alttext="\textbf{X}\sim U(0,1)" display="inline"><semantics id="S4.SS5.p1.2.m1.2a"><mrow id="S4.SS5.p1.2.m1.2.3" xref="S4.SS5.p1.2.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS5.p1.2.m1.2.3.2" xref="S4.SS5.p1.2.m1.2.3.2a.cmml">X</mtext><mo id="S4.SS5.p1.2.m1.2.3.1" xref="S4.SS5.p1.2.m1.2.3.1.cmml">∼</mo><mrow id="S4.SS5.p1.2.m1.2.3.3" xref="S4.SS5.p1.2.m1.2.3.3.cmml"><mi id="S4.SS5.p1.2.m1.2.3.3.2" xref="S4.SS5.p1.2.m1.2.3.3.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.2.m1.2.3.3.1" xref="S4.SS5.p1.2.m1.2.3.3.1.cmml">​</mo><mrow id="S4.SS5.p1.2.m1.2.3.3.3.2" xref="S4.SS5.p1.2.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS5.p1.2.m1.2.3.3.3.2.1" xref="S4.SS5.p1.2.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.SS5.p1.2.m1.1.1" xref="S4.SS5.p1.2.m1.1.1.cmml">0</mn><mo id="S4.SS5.p1.2.m1.2.3.3.3.2.2" xref="S4.SS5.p1.2.m1.2.3.3.3.1.cmml">,</mo><mn id="S4.SS5.p1.2.m1.2.2" xref="S4.SS5.p1.2.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS5.p1.2.m1.2.3.3.3.2.3" xref="S4.SS5.p1.2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m1.2b"><apply id="S4.SS5.p1.2.m1.2.3.cmml" xref="S4.SS5.p1.2.m1.2.3"><csymbol cd="latexml" id="S4.SS5.p1.2.m1.2.3.1.cmml" xref="S4.SS5.p1.2.m1.2.3.1">similar-to</csymbol><ci id="S4.SS5.p1.2.m1.2.3.2a.cmml" xref="S4.SS5.p1.2.m1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S4.SS5.p1.2.m1.2.3.2.cmml" xref="S4.SS5.p1.2.m1.2.3.2">X</mtext></ci><apply id="S4.SS5.p1.2.m1.2.3.3.cmml" xref="S4.SS5.p1.2.m1.2.3.3"><times id="S4.SS5.p1.2.m1.2.3.3.1.cmml" xref="S4.SS5.p1.2.m1.2.3.3.1"></times><ci id="S4.SS5.p1.2.m1.2.3.3.2.cmml" xref="S4.SS5.p1.2.m1.2.3.3.2">𝑈</ci><interval closure="open" id="S4.SS5.p1.2.m1.2.3.3.3.1.cmml" xref="S4.SS5.p1.2.m1.2.3.3.3.2"><cn type="integer" id="S4.SS5.p1.2.m1.1.1.cmml" xref="S4.SS5.p1.2.m1.1.1">0</cn><cn type="integer" id="S4.SS5.p1.2.m1.2.2.cmml" xref="S4.SS5.p1.2.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m1.2c">\textbf{X}\sim U(0,1)</annotation></semantics></math>. If the sampled value is less than a predefined threshold (<math id="S4.SS5.p1.3.m2.1" class="ltx_Math" alttext="P\_{fail}" display="inline"><semantics id="S4.SS5.p1.3.m2.1a"><mrow id="S4.SS5.p1.3.m2.1.1" xref="S4.SS5.p1.3.m2.1.1.cmml"><mi id="S4.SS5.p1.3.m2.1.1.2" xref="S4.SS5.p1.3.m2.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.3.m2.1.1.1" xref="S4.SS5.p1.3.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS5.p1.3.m2.1.1.3" xref="S4.SS5.p1.3.m2.1.1.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.3.m2.1.1.1a" xref="S4.SS5.p1.3.m2.1.1.1.cmml">​</mo><mi id="S4.SS5.p1.3.m2.1.1.4" xref="S4.SS5.p1.3.m2.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.3.m2.1.1.1b" xref="S4.SS5.p1.3.m2.1.1.1.cmml">​</mo><mi id="S4.SS5.p1.3.m2.1.1.5" xref="S4.SS5.p1.3.m2.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.3.m2.1.1.1c" xref="S4.SS5.p1.3.m2.1.1.1.cmml">​</mo><mi id="S4.SS5.p1.3.m2.1.1.6" xref="S4.SS5.p1.3.m2.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p1.3.m2.1.1.1d" xref="S4.SS5.p1.3.m2.1.1.1.cmml">​</mo><mi id="S4.SS5.p1.3.m2.1.1.7" xref="S4.SS5.p1.3.m2.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m2.1b"><apply id="S4.SS5.p1.3.m2.1.1.cmml" xref="S4.SS5.p1.3.m2.1.1"><times id="S4.SS5.p1.3.m2.1.1.1.cmml" xref="S4.SS5.p1.3.m2.1.1.1"></times><ci id="S4.SS5.p1.3.m2.1.1.2.cmml" xref="S4.SS5.p1.3.m2.1.1.2">𝑃</ci><ci id="S4.SS5.p1.3.m2.1.1.3.cmml" xref="S4.SS5.p1.3.m2.1.1.3">_</ci><ci id="S4.SS5.p1.3.m2.1.1.4.cmml" xref="S4.SS5.p1.3.m2.1.1.4">𝑓</ci><ci id="S4.SS5.p1.3.m2.1.1.5.cmml" xref="S4.SS5.p1.3.m2.1.1.5">𝑎</ci><ci id="S4.SS5.p1.3.m2.1.1.6.cmml" xref="S4.SS5.p1.3.m2.1.1.6">𝑖</ci><ci id="S4.SS5.p1.3.m2.1.1.7.cmml" xref="S4.SS5.p1.3.m2.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m2.1c">P\_{fail}</annotation></semantics></math>), then the client is skipped for one whole epoch iteration. The skipped clients would not be able to generate any new intermediate results.
In a practical setting, the client failures could be handled at the host by setting a certain timeout to wait a bit for a guest client to send its intermediate results. If a timeout occurs, then it is assumed that the guest client is offline or unresponsive. Furthermore, the correct batch index that is being processed by the host should also be communicated to the guest clients to keep the mini-batches aligned throughout the training process during a real deployment. This should be done to prevent offline clients from processing the wrong batch when they come online again.
</p>
</div>
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.23" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.23.24" class="ltx_listingline">
<span id="alg2.23.24.1" class="ltx_text"><span id="alg2.23.24.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>

</div>
<div id="alg2.1.1" class="ltx_listingline">NumClients = <math id="alg2.1.1.m1.3" class="ltx_Math" alttext="\{1,2,...K\}" display="inline"><semantics id="alg2.1.1.m1.3a"><mrow id="alg2.1.1.m1.3.3.1" xref="alg2.1.1.m1.3.3.2.cmml"><mo stretchy="false" id="alg2.1.1.m1.3.3.1.2" xref="alg2.1.1.m1.3.3.2.cmml">{</mo><mn id="alg2.1.1.m1.1.1" xref="alg2.1.1.m1.1.1.cmml">1</mn><mo id="alg2.1.1.m1.3.3.1.3" xref="alg2.1.1.m1.3.3.2.cmml">,</mo><mn id="alg2.1.1.m1.2.2" xref="alg2.1.1.m1.2.2.cmml">2</mn><mo id="alg2.1.1.m1.3.3.1.4" xref="alg2.1.1.m1.3.3.2.cmml">,</mo><mrow id="alg2.1.1.m1.3.3.1.1" xref="alg2.1.1.m1.3.3.1.1.cmml"><mi mathvariant="normal" id="alg2.1.1.m1.3.3.1.1.2" xref="alg2.1.1.m1.3.3.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.m1.3.3.1.1.1" xref="alg2.1.1.m1.3.3.1.1.1.cmml">​</mo><mi id="alg2.1.1.m1.3.3.1.1.3" xref="alg2.1.1.m1.3.3.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="alg2.1.1.m1.3.3.1.5" xref="alg2.1.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.3b"><set id="alg2.1.1.m1.3.3.2.cmml" xref="alg2.1.1.m1.3.3.1"><cn type="integer" id="alg2.1.1.m1.1.1.cmml" xref="alg2.1.1.m1.1.1">1</cn><cn type="integer" id="alg2.1.1.m1.2.2.cmml" xref="alg2.1.1.m1.2.2">2</cn><apply id="alg2.1.1.m1.3.3.1.1.cmml" xref="alg2.1.1.m1.3.3.1.1"><times id="alg2.1.1.m1.3.3.1.1.1.cmml" xref="alg2.1.1.m1.3.3.1.1.1"></times><ci id="alg2.1.1.m1.3.3.1.1.2.cmml" xref="alg2.1.1.m1.3.3.1.1.2">…</ci><ci id="alg2.1.1.m1.3.3.1.1.3.cmml" xref="alg2.1.1.m1.3.3.1.1.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.3c">\{1,2,...K\}</annotation></semantics></math>

</div>
<div id="alg2.2.2" class="ltx_listingline">Epochs = <math id="alg2.2.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.2.2.m1.1a"><mi id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.1b"><ci id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.1c">E</annotation></semantics></math>

</div>
<div id="alg2.6.6" class="ltx_listingline">Feature Dataset <math id="alg2.3.3.m1.1" class="ltx_Math" alttext="X_{i}" display="inline"><semantics id="alg2.3.3.m1.1a"><msub id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml"><mi id="alg2.3.3.m1.1.1.2" xref="alg2.3.3.m1.1.1.2.cmml">X</mi><mi id="alg2.3.3.m1.1.1.3" xref="alg2.3.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><apply id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1"><csymbol cd="ambiguous" id="alg2.3.3.m1.1.1.1.cmml" xref="alg2.3.3.m1.1.1">subscript</csymbol><ci id="alg2.3.3.m1.1.1.2.cmml" xref="alg2.3.3.m1.1.1.2">𝑋</ci><ci id="alg2.3.3.m1.1.1.3.cmml" xref="alg2.3.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">X_{i}</annotation></semantics></math> <span id="alg2.6.6.1" class="ltx_text">of party</span> <math id="alg2.4.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.4.4.m2.1a"><mi id="alg2.4.4.m2.1.1" xref="alg2.4.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.4.4.m2.1b"><ci id="alg2.4.4.m2.1.1.cmml" xref="alg2.4.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m2.1c">i</annotation></semantics></math> <math id="alg2.5.5.m3.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg2.5.5.m3.1a"><mo id="alg2.5.5.m3.1.1" xref="alg2.5.5.m3.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg2.5.5.m3.1b"><in id="alg2.5.5.m3.1.1.cmml" xref="alg2.5.5.m3.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m3.1c">\in</annotation></semantics></math> <math id="alg2.6.6.m4.3" class="ltx_Math" alttext="\{2,3,...K\}" display="inline"><semantics id="alg2.6.6.m4.3a"><mrow id="alg2.6.6.m4.3.3.1" xref="alg2.6.6.m4.3.3.2.cmml"><mo stretchy="false" id="alg2.6.6.m4.3.3.1.2" xref="alg2.6.6.m4.3.3.2.cmml">{</mo><mn id="alg2.6.6.m4.1.1" xref="alg2.6.6.m4.1.1.cmml">2</mn><mo id="alg2.6.6.m4.3.3.1.3" xref="alg2.6.6.m4.3.3.2.cmml">,</mo><mn id="alg2.6.6.m4.2.2" xref="alg2.6.6.m4.2.2.cmml">3</mn><mo id="alg2.6.6.m4.3.3.1.4" xref="alg2.6.6.m4.3.3.2.cmml">,</mo><mrow id="alg2.6.6.m4.3.3.1.1" xref="alg2.6.6.m4.3.3.1.1.cmml"><mi mathvariant="normal" id="alg2.6.6.m4.3.3.1.1.2" xref="alg2.6.6.m4.3.3.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m4.3.3.1.1.1" xref="alg2.6.6.m4.3.3.1.1.1.cmml">​</mo><mi id="alg2.6.6.m4.3.3.1.1.3" xref="alg2.6.6.m4.3.3.1.1.3.cmml">K</mi></mrow><mo stretchy="false" id="alg2.6.6.m4.3.3.1.5" xref="alg2.6.6.m4.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.6.m4.3b"><set id="alg2.6.6.m4.3.3.2.cmml" xref="alg2.6.6.m4.3.3.1"><cn type="integer" id="alg2.6.6.m4.1.1.cmml" xref="alg2.6.6.m4.1.1">2</cn><cn type="integer" id="alg2.6.6.m4.2.2.cmml" xref="alg2.6.6.m4.2.2">3</cn><apply id="alg2.6.6.m4.3.3.1.1.cmml" xref="alg2.6.6.m4.3.3.1.1"><times id="alg2.6.6.m4.3.3.1.1.1.cmml" xref="alg2.6.6.m4.3.3.1.1.1"></times><ci id="alg2.6.6.m4.3.3.1.1.2.cmml" xref="alg2.6.6.m4.3.3.1.1.2">…</ci><ci id="alg2.6.6.m4.3.3.1.1.3.cmml" xref="alg2.6.6.m4.3.3.1.1.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m4.3c">\{2,3,...K\}</annotation></semantics></math>

</div>
<div id="alg2.23.25" class="ltx_listingline">
<span id="alg2.23.25.1" class="ltx_text">/* </span><span id="alg2.23.25.2" class="ltx_text ltx_font_bold">Guests:</span>  */
</div>
<div id="alg2.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="alg2.8.8.1" class="ltx_text ltx_font_bold">set</span> weights of <math id="alg2.7.7.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}" display="inline"><semantics id="alg2.7.7.m1.1a"><msub id="alg2.7.7.m1.1.1" xref="alg2.7.7.m1.1.1.cmml"><mi id="alg2.7.7.m1.1.1.2" xref="alg2.7.7.m1.1.1.2.cmml">f</mi><mrow id="alg2.7.7.m1.1.1.3" xref="alg2.7.7.m1.1.1.3.cmml"><mi id="alg2.7.7.m1.1.1.3.2" xref="alg2.7.7.m1.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.m1.1.1.3.1" xref="alg2.7.7.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.7.7.m1.1.1.3.3" xref="alg2.7.7.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.m1.1.1.3.1a" xref="alg2.7.7.m1.1.1.3.1.cmml">​</mo><mi id="alg2.7.7.m1.1.1.3.4" xref="alg2.7.7.m1.1.1.3.4.cmml">repr</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.7.7.m1.1b"><apply id="alg2.7.7.m1.1.1.cmml" xref="alg2.7.7.m1.1.1"><csymbol cd="ambiguous" id="alg2.7.7.m1.1.1.1.cmml" xref="alg2.7.7.m1.1.1">subscript</csymbol><ci id="alg2.7.7.m1.1.1.2.cmml" xref="alg2.7.7.m1.1.1.2">𝑓</ci><apply id="alg2.7.7.m1.1.1.3.cmml" xref="alg2.7.7.m1.1.1.3"><times id="alg2.7.7.m1.1.1.3.1.cmml" xref="alg2.7.7.m1.1.1.3.1"></times><ci id="alg2.7.7.m1.1.1.3.2.cmml" xref="alg2.7.7.m1.1.1.3.2">bottom</ci><ci id="alg2.7.7.m1.1.1.3.3.cmml" xref="alg2.7.7.m1.1.1.3.3">_</ci><ci id="alg2.7.7.m1.1.1.3.4.cmml" xref="alg2.7.7.m1.1.1.3.4">repr</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m1.1c">f_{\mathrm{bottom\_repr}}</annotation></semantics></math> to the pretrained BN and FC layers <math id="alg2.8.8.m2.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr\_bin}}" display="inline"><semantics id="alg2.8.8.m2.1a"><msub id="alg2.8.8.m2.1.1" xref="alg2.8.8.m2.1.1.cmml"><mi id="alg2.8.8.m2.1.1.2" xref="alg2.8.8.m2.1.1.2.cmml">f</mi><mrow id="alg2.8.8.m2.1.1.3" xref="alg2.8.8.m2.1.1.3.cmml"><mi id="alg2.8.8.m2.1.1.3.2" xref="alg2.8.8.m2.1.1.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.8.8.m2.1.1.3.3" xref="alg2.8.8.m2.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1a" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi id="alg2.8.8.m2.1.1.3.4" xref="alg2.8.8.m2.1.1.3.4.cmml">repr</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1b" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.8.8.m2.1.1.3.5" xref="alg2.8.8.m2.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1c" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi id="alg2.8.8.m2.1.1.3.6" xref="alg2.8.8.m2.1.1.3.6.cmml">bin</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.8.8.m2.1b"><apply id="alg2.8.8.m2.1.1.cmml" xref="alg2.8.8.m2.1.1"><csymbol cd="ambiguous" id="alg2.8.8.m2.1.1.1.cmml" xref="alg2.8.8.m2.1.1">subscript</csymbol><ci id="alg2.8.8.m2.1.1.2.cmml" xref="alg2.8.8.m2.1.1.2">𝑓</ci><apply id="alg2.8.8.m2.1.1.3.cmml" xref="alg2.8.8.m2.1.1.3"><times id="alg2.8.8.m2.1.1.3.1.cmml" xref="alg2.8.8.m2.1.1.3.1"></times><ci id="alg2.8.8.m2.1.1.3.2.cmml" xref="alg2.8.8.m2.1.1.3.2">bottom</ci><ci id="alg2.8.8.m2.1.1.3.3.cmml" xref="alg2.8.8.m2.1.1.3.3">_</ci><ci id="alg2.8.8.m2.1.1.3.4.cmml" xref="alg2.8.8.m2.1.1.3.4">repr</ci><ci id="alg2.8.8.m2.1.1.3.5.cmml" xref="alg2.8.8.m2.1.1.3.5">_</ci><ci id="alg2.8.8.m2.1.1.3.6.cmml" xref="alg2.8.8.m2.1.1.3.6">bin</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.m2.1c">f_{\mathrm{bottom\_repr\_bin}}</annotation></semantics></math>

</div>
<div id="alg2.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="alg2.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="alg2.9.9.1" class="ltx_emph ltx_font_italic"><math id="alg2.9.9.1.m1.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg2.9.9.1.m1.1a"><mrow id="alg2.9.9.1.m1.1.1" xref="alg2.9.9.1.m1.1.1.cmml"><mi id="alg2.9.9.1.m1.1.1.2" xref="alg2.9.9.1.m1.1.1.2.cmml">e</mi><mo id="alg2.9.9.1.m1.1.1.1" xref="alg2.9.9.1.m1.1.1.1.cmml">∈</mo><mi id="alg2.9.9.1.m1.1.1.3" xref="alg2.9.9.1.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.1.m1.1b"><apply id="alg2.9.9.1.m1.1.1.cmml" xref="alg2.9.9.1.m1.1.1"><in id="alg2.9.9.1.m1.1.1.1.cmml" xref="alg2.9.9.1.m1.1.1.1"></in><ci id="alg2.9.9.1.m1.1.1.2.cmml" xref="alg2.9.9.1.m1.1.1.2">𝑒</ci><ci id="alg2.9.9.1.m1.1.1.3.cmml" xref="alg2.9.9.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.1.m1.1c">e\in E</annotation></semantics></math></em> <span id="alg2.9.9.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg2.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.10.10.2" class="ltx_text ltx_font_bold">for</span> <em id="alg2.10.10.1" class="ltx_emph ltx_font_italic">each mini-batch <math id="alg2.10.10.1.m1.1" class="ltx_Math" alttext="X_{b}\in B" display="inline"><semantics id="alg2.10.10.1.m1.1a"><mrow id="alg2.10.10.1.m1.1.1" xref="alg2.10.10.1.m1.1.1.cmml"><msub id="alg2.10.10.1.m1.1.1.2" xref="alg2.10.10.1.m1.1.1.2.cmml"><mi id="alg2.10.10.1.m1.1.1.2.2" xref="alg2.10.10.1.m1.1.1.2.2.cmml">X</mi><mi id="alg2.10.10.1.m1.1.1.2.3" xref="alg2.10.10.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="alg2.10.10.1.m1.1.1.1" xref="alg2.10.10.1.m1.1.1.1.cmml">∈</mo><mi id="alg2.10.10.1.m1.1.1.3" xref="alg2.10.10.1.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.1.m1.1b"><apply id="alg2.10.10.1.m1.1.1.cmml" xref="alg2.10.10.1.m1.1.1"><in id="alg2.10.10.1.m1.1.1.1.cmml" xref="alg2.10.10.1.m1.1.1.1"></in><apply id="alg2.10.10.1.m1.1.1.2.cmml" xref="alg2.10.10.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.10.10.1.m1.1.1.2.1.cmml" xref="alg2.10.10.1.m1.1.1.2">subscript</csymbol><ci id="alg2.10.10.1.m1.1.1.2.2.cmml" xref="alg2.10.10.1.m1.1.1.2.2">𝑋</ci><ci id="alg2.10.10.1.m1.1.1.2.3.cmml" xref="alg2.10.10.1.m1.1.1.2.3">𝑏</ci></apply><ci id="alg2.10.10.1.m1.1.1.3.cmml" xref="alg2.10.10.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.1.m1.1c">X_{b}\in B</annotation></semantics></math></em> <span id="alg2.10.10.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg2.23.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Send intermediate result <math id="alg2.11.11.m1.1" class="ltx_Math" alttext="f_{\mathrm{bottom\_repr}}(X_{b})" display="inline"><semantics id="alg2.11.11.m1.1a"><mrow id="alg2.11.11.m1.1.1" xref="alg2.11.11.m1.1.1.cmml"><msub id="alg2.11.11.m1.1.1.3" xref="alg2.11.11.m1.1.1.3.cmml"><mi id="alg2.11.11.m1.1.1.3.2" xref="alg2.11.11.m1.1.1.3.2.cmml">f</mi><mrow id="alg2.11.11.m1.1.1.3.3" xref="alg2.11.11.m1.1.1.3.3.cmml"><mi id="alg2.11.11.m1.1.1.3.3.2" xref="alg2.11.11.m1.1.1.3.3.2.cmml">bottom</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.3.3.1" xref="alg2.11.11.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.11.11.m1.1.1.3.3.3" xref="alg2.11.11.m1.1.1.3.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.3.3.1a" xref="alg2.11.11.m1.1.1.3.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.3.3.4" xref="alg2.11.11.m1.1.1.3.3.4.cmml">repr</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.2" xref="alg2.11.11.m1.1.1.2.cmml">​</mo><mrow id="alg2.11.11.m1.1.1.1.1" xref="alg2.11.11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.11.11.m1.1.1.1.1.2" xref="alg2.11.11.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.11.11.m1.1.1.1.1.1" xref="alg2.11.11.m1.1.1.1.1.1.cmml"><mi id="alg2.11.11.m1.1.1.1.1.1.2" xref="alg2.11.11.m1.1.1.1.1.1.2.cmml">X</mi><mi id="alg2.11.11.m1.1.1.1.1.1.3" xref="alg2.11.11.m1.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="alg2.11.11.m1.1.1.1.1.3" xref="alg2.11.11.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.m1.1b"><apply id="alg2.11.11.m1.1.1.cmml" xref="alg2.11.11.m1.1.1"><times id="alg2.11.11.m1.1.1.2.cmml" xref="alg2.11.11.m1.1.1.2"></times><apply id="alg2.11.11.m1.1.1.3.cmml" xref="alg2.11.11.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.11.11.m1.1.1.3.1.cmml" xref="alg2.11.11.m1.1.1.3">subscript</csymbol><ci id="alg2.11.11.m1.1.1.3.2.cmml" xref="alg2.11.11.m1.1.1.3.2">𝑓</ci><apply id="alg2.11.11.m1.1.1.3.3.cmml" xref="alg2.11.11.m1.1.1.3.3"><times id="alg2.11.11.m1.1.1.3.3.1.cmml" xref="alg2.11.11.m1.1.1.3.3.1"></times><ci id="alg2.11.11.m1.1.1.3.3.2.cmml" xref="alg2.11.11.m1.1.1.3.3.2">bottom</ci><ci id="alg2.11.11.m1.1.1.3.3.3.cmml" xref="alg2.11.11.m1.1.1.3.3.3">_</ci><ci id="alg2.11.11.m1.1.1.3.3.4.cmml" xref="alg2.11.11.m1.1.1.3.3.4">repr</ci></apply></apply><apply id="alg2.11.11.m1.1.1.1.1.1.cmml" xref="alg2.11.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.11.11.m1.1.1.1.1.1.1.cmml" xref="alg2.11.11.m1.1.1.1.1">subscript</csymbol><ci id="alg2.11.11.m1.1.1.1.1.1.2.cmml" xref="alg2.11.11.m1.1.1.1.1.1.2">𝑋</ci><ci id="alg2.11.11.m1.1.1.1.1.1.3.cmml" xref="alg2.11.11.m1.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m1.1c">f_{\mathrm{bottom\_repr}}(X_{b})</annotation></semantics></math> to host

</div>
<div id="alg2.23.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.23.27.1" class="ltx_text">/* </span><span id="alg2.23.27.2" class="ltx_text ltx_font_bold">Client 1 (Host)</span>  */
</div>
<div id="alg2.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.12.12.1" class="ltx_text ltx_font_bold">use pretrained</span> <math id="alg2.12.12.m1.1" class="ltx_Math" alttext="PartialEnc" display="inline"><semantics id="alg2.12.12.m1.1a"><mrow id="alg2.12.12.m1.1.1" xref="alg2.12.12.m1.1.1.cmml"><mi id="alg2.12.12.m1.1.1.2" xref="alg2.12.12.m1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.3" xref="alg2.12.12.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1a" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.4" xref="alg2.12.12.m1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1b" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.5" xref="alg2.12.12.m1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1c" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.6" xref="alg2.12.12.m1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1d" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.7" xref="alg2.12.12.m1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1e" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.8" xref="alg2.12.12.m1.1.1.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1f" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.9" xref="alg2.12.12.m1.1.1.9.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1g" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.10" xref="alg2.12.12.m1.1.1.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1h" xref="alg2.12.12.m1.1.1.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.11" xref="alg2.12.12.m1.1.1.11.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.12.m1.1b"><apply id="alg2.12.12.m1.1.1.cmml" xref="alg2.12.12.m1.1.1"><times id="alg2.12.12.m1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1"></times><ci id="alg2.12.12.m1.1.1.2.cmml" xref="alg2.12.12.m1.1.1.2">𝑃</ci><ci id="alg2.12.12.m1.1.1.3.cmml" xref="alg2.12.12.m1.1.1.3">𝑎</ci><ci id="alg2.12.12.m1.1.1.4.cmml" xref="alg2.12.12.m1.1.1.4">𝑟</ci><ci id="alg2.12.12.m1.1.1.5.cmml" xref="alg2.12.12.m1.1.1.5">𝑡</ci><ci id="alg2.12.12.m1.1.1.6.cmml" xref="alg2.12.12.m1.1.1.6">𝑖</ci><ci id="alg2.12.12.m1.1.1.7.cmml" xref="alg2.12.12.m1.1.1.7">𝑎</ci><ci id="alg2.12.12.m1.1.1.8.cmml" xref="alg2.12.12.m1.1.1.8">𝑙</ci><ci id="alg2.12.12.m1.1.1.9.cmml" xref="alg2.12.12.m1.1.1.9">𝐸</ci><ci id="alg2.12.12.m1.1.1.10.cmml" xref="alg2.12.12.m1.1.1.10">𝑛</ci><ci id="alg2.12.12.m1.1.1.11.cmml" xref="alg2.12.12.m1.1.1.11">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m1.1c">PartialEnc</annotation></semantics></math>

</div>
<div id="alg2.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.13.13.1" class="ltx_text ltx_font_bold">initialize</span> <math id="alg2.13.13.m1.1" class="ltx_Math" alttext="final\_mapping" display="inline"><semantics id="alg2.13.13.m1.1a"><mrow id="alg2.13.13.m1.1.1" xref="alg2.13.13.m1.1.1.cmml"><mi id="alg2.13.13.m1.1.1.2" xref="alg2.13.13.m1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.3" xref="alg2.13.13.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1a" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.4" xref="alg2.13.13.m1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1b" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.5" xref="alg2.13.13.m1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1c" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.6" xref="alg2.13.13.m1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1d" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg2.13.13.m1.1.1.7" xref="alg2.13.13.m1.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1e" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.8" xref="alg2.13.13.m1.1.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1f" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.9" xref="alg2.13.13.m1.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1g" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.10" xref="alg2.13.13.m1.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1h" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.11" xref="alg2.13.13.m1.1.1.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1i" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.12" xref="alg2.13.13.m1.1.1.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1j" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.13" xref="alg2.13.13.m1.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.1.1.1k" xref="alg2.13.13.m1.1.1.1.cmml">​</mo><mi id="alg2.13.13.m1.1.1.14" xref="alg2.13.13.m1.1.1.14.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.13.m1.1b"><apply id="alg2.13.13.m1.1.1.cmml" xref="alg2.13.13.m1.1.1"><times id="alg2.13.13.m1.1.1.1.cmml" xref="alg2.13.13.m1.1.1.1"></times><ci id="alg2.13.13.m1.1.1.2.cmml" xref="alg2.13.13.m1.1.1.2">𝑓</ci><ci id="alg2.13.13.m1.1.1.3.cmml" xref="alg2.13.13.m1.1.1.3">𝑖</ci><ci id="alg2.13.13.m1.1.1.4.cmml" xref="alg2.13.13.m1.1.1.4">𝑛</ci><ci id="alg2.13.13.m1.1.1.5.cmml" xref="alg2.13.13.m1.1.1.5">𝑎</ci><ci id="alg2.13.13.m1.1.1.6.cmml" xref="alg2.13.13.m1.1.1.6">𝑙</ci><ci id="alg2.13.13.m1.1.1.7.cmml" xref="alg2.13.13.m1.1.1.7">_</ci><ci id="alg2.13.13.m1.1.1.8.cmml" xref="alg2.13.13.m1.1.1.8">𝑚</ci><ci id="alg2.13.13.m1.1.1.9.cmml" xref="alg2.13.13.m1.1.1.9">𝑎</ci><ci id="alg2.13.13.m1.1.1.10.cmml" xref="alg2.13.13.m1.1.1.10">𝑝</ci><ci id="alg2.13.13.m1.1.1.11.cmml" xref="alg2.13.13.m1.1.1.11">𝑝</ci><ci id="alg2.13.13.m1.1.1.12.cmml" xref="alg2.13.13.m1.1.1.12">𝑖</ci><ci id="alg2.13.13.m1.1.1.13.cmml" xref="alg2.13.13.m1.1.1.13">𝑛</ci><ci id="alg2.13.13.m1.1.1.14.cmml" xref="alg2.13.13.m1.1.1.14">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.m1.1c">final\_mapping</annotation></semantics></math>

</div>
<div id="alg2.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.14.14.2" class="ltx_text ltx_font_bold">for</span> <em id="alg2.14.14.1" class="ltx_emph ltx_font_italic"><math id="alg2.14.14.1.m1.2" class="ltx_Math" alttext="c\in[2,K]" display="inline"><semantics id="alg2.14.14.1.m1.2a"><mrow id="alg2.14.14.1.m1.2.3" xref="alg2.14.14.1.m1.2.3.cmml"><mi id="alg2.14.14.1.m1.2.3.2" xref="alg2.14.14.1.m1.2.3.2.cmml">c</mi><mo id="alg2.14.14.1.m1.2.3.1" xref="alg2.14.14.1.m1.2.3.1.cmml">∈</mo><mrow id="alg2.14.14.1.m1.2.3.3.2" xref="alg2.14.14.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg2.14.14.1.m1.2.3.3.2.1" xref="alg2.14.14.1.m1.2.3.3.1.cmml">[</mo><mn id="alg2.14.14.1.m1.1.1" xref="alg2.14.14.1.m1.1.1.cmml">2</mn><mo id="alg2.14.14.1.m1.2.3.3.2.2" xref="alg2.14.14.1.m1.2.3.3.1.cmml">,</mo><mi id="alg2.14.14.1.m1.2.2" xref="alg2.14.14.1.m1.2.2.cmml">K</mi><mo stretchy="false" id="alg2.14.14.1.m1.2.3.3.2.3" xref="alg2.14.14.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.1.m1.2b"><apply id="alg2.14.14.1.m1.2.3.cmml" xref="alg2.14.14.1.m1.2.3"><in id="alg2.14.14.1.m1.2.3.1.cmml" xref="alg2.14.14.1.m1.2.3.1"></in><ci id="alg2.14.14.1.m1.2.3.2.cmml" xref="alg2.14.14.1.m1.2.3.2">𝑐</ci><interval closure="closed" id="alg2.14.14.1.m1.2.3.3.1.cmml" xref="alg2.14.14.1.m1.2.3.3.2"><cn type="integer" id="alg2.14.14.1.m1.1.1.cmml" xref="alg2.14.14.1.m1.1.1">2</cn><ci id="alg2.14.14.1.m1.2.2.cmml" xref="alg2.14.14.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.1.m1.2c">c\in[2,K]</annotation></semantics></math></em> <span id="alg2.14.14.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg2.23.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.23.28.1" class="ltx_text ltx_font_bold">if</span> <em id="alg2.23.28.2" class="ltx_emph ltx_font_italic">c is offline</em> <span id="alg2.23.28.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg2.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.15.15.m1.1" class="ltx_Math" alttext="\tilde{X}\leftarrow" display="inline"><semantics id="alg2.15.15.m1.1a"><mrow id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml"><mover accent="true" id="alg2.15.15.m1.1.1.2" xref="alg2.15.15.m1.1.1.2.cmml"><mi id="alg2.15.15.m1.1.1.2.2" xref="alg2.15.15.m1.1.1.2.2.cmml">X</mi><mo id="alg2.15.15.m1.1.1.2.1" xref="alg2.15.15.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg2.15.15.m1.1.1.1" xref="alg2.15.15.m1.1.1.1.cmml">←</mo><mi id="alg2.15.15.m1.1.1.3" xref="alg2.15.15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.1b"><apply id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1"><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">←</ci><apply id="alg2.15.15.m1.1.1.2.cmml" xref="alg2.15.15.m1.1.1.2"><ci id="alg2.15.15.m1.1.1.2.1.cmml" xref="alg2.15.15.m1.1.1.2.1">~</ci><ci id="alg2.15.15.m1.1.1.2.2.cmml" xref="alg2.15.15.m1.1.1.2.2">𝑋</ci></apply><csymbol cd="latexml" id="alg2.15.15.m1.1.1.3.cmml" xref="alg2.15.15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.1c">\tilde{X}\leftarrow</annotation></semantics></math> append cached intermediate results

</div>
<div id="alg2.23.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.23.29.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg2.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.16.16.m1.1" class="ltx_Math" alttext="\tilde{X}\leftarrow" display="inline"><semantics id="alg2.16.16.m1.1a"><mrow id="alg2.16.16.m1.1.1" xref="alg2.16.16.m1.1.1.cmml"><mover accent="true" id="alg2.16.16.m1.1.1.2" xref="alg2.16.16.m1.1.1.2.cmml"><mi id="alg2.16.16.m1.1.1.2.2" xref="alg2.16.16.m1.1.1.2.2.cmml">X</mi><mo id="alg2.16.16.m1.1.1.2.1" xref="alg2.16.16.m1.1.1.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg2.16.16.m1.1.1.1" xref="alg2.16.16.m1.1.1.1.cmml">←</mo><mi id="alg2.16.16.m1.1.1.3" xref="alg2.16.16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.16.16.m1.1b"><apply id="alg2.16.16.m1.1.1.cmml" xref="alg2.16.16.m1.1.1"><ci id="alg2.16.16.m1.1.1.1.cmml" xref="alg2.16.16.m1.1.1.1">←</ci><apply id="alg2.16.16.m1.1.1.2.cmml" xref="alg2.16.16.m1.1.1.2"><ci id="alg2.16.16.m1.1.1.2.1.cmml" xref="alg2.16.16.m1.1.1.2.1">~</ci><ci id="alg2.16.16.m1.1.1.2.2.cmml" xref="alg2.16.16.m1.1.1.2.2">𝑋</ci></apply><csymbol cd="latexml" id="alg2.16.16.m1.1.1.3.cmml" xref="alg2.16.16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.m1.1c">\tilde{X}\leftarrow</annotation></semantics></math> Receive and append intermediate results. Cache the received results.

</div>
<div id="alg2.23.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.23.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.17.17.m1.1" class="ltx_Math" alttext="X_{intermediate}\leftarrow" display="inline"><semantics id="alg2.17.17.m1.1a"><mrow id="alg2.17.17.m1.1.1" xref="alg2.17.17.m1.1.1.cmml"><msub id="alg2.17.17.m1.1.1.2" xref="alg2.17.17.m1.1.1.2.cmml"><mi id="alg2.17.17.m1.1.1.2.2" xref="alg2.17.17.m1.1.1.2.2.cmml">X</mi><mrow id="alg2.17.17.m1.1.1.2.3" xref="alg2.17.17.m1.1.1.2.3.cmml"><mi id="alg2.17.17.m1.1.1.2.3.2" xref="alg2.17.17.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.3" xref="alg2.17.17.m1.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1a" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.4" xref="alg2.17.17.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1b" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.5" xref="alg2.17.17.m1.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1c" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.6" xref="alg2.17.17.m1.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1d" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.7" xref="alg2.17.17.m1.1.1.2.3.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1e" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.8" xref="alg2.17.17.m1.1.1.2.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1f" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.9" xref="alg2.17.17.m1.1.1.2.3.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1g" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.10" xref="alg2.17.17.m1.1.1.2.3.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1h" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.11" xref="alg2.17.17.m1.1.1.2.3.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1i" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.12" xref="alg2.17.17.m1.1.1.2.3.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.2.3.1j" xref="alg2.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.2.3.13" xref="alg2.17.17.m1.1.1.2.3.13.cmml">e</mi></mrow></msub><mo stretchy="false" id="alg2.17.17.m1.1.1.1" xref="alg2.17.17.m1.1.1.1.cmml">←</mo><mi id="alg2.17.17.m1.1.1.3" xref="alg2.17.17.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.17.m1.1b"><apply id="alg2.17.17.m1.1.1.cmml" xref="alg2.17.17.m1.1.1"><ci id="alg2.17.17.m1.1.1.1.cmml" xref="alg2.17.17.m1.1.1.1">←</ci><apply id="alg2.17.17.m1.1.1.2.cmml" xref="alg2.17.17.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.17.17.m1.1.1.2.1.cmml" xref="alg2.17.17.m1.1.1.2">subscript</csymbol><ci id="alg2.17.17.m1.1.1.2.2.cmml" xref="alg2.17.17.m1.1.1.2.2">𝑋</ci><apply id="alg2.17.17.m1.1.1.2.3.cmml" xref="alg2.17.17.m1.1.1.2.3"><times id="alg2.17.17.m1.1.1.2.3.1.cmml" xref="alg2.17.17.m1.1.1.2.3.1"></times><ci id="alg2.17.17.m1.1.1.2.3.2.cmml" xref="alg2.17.17.m1.1.1.2.3.2">𝑖</ci><ci id="alg2.17.17.m1.1.1.2.3.3.cmml" xref="alg2.17.17.m1.1.1.2.3.3">𝑛</ci><ci id="alg2.17.17.m1.1.1.2.3.4.cmml" xref="alg2.17.17.m1.1.1.2.3.4">𝑡</ci><ci id="alg2.17.17.m1.1.1.2.3.5.cmml" xref="alg2.17.17.m1.1.1.2.3.5">𝑒</ci><ci id="alg2.17.17.m1.1.1.2.3.6.cmml" xref="alg2.17.17.m1.1.1.2.3.6">𝑟</ci><ci id="alg2.17.17.m1.1.1.2.3.7.cmml" xref="alg2.17.17.m1.1.1.2.3.7">𝑚</ci><ci id="alg2.17.17.m1.1.1.2.3.8.cmml" xref="alg2.17.17.m1.1.1.2.3.8">𝑒</ci><ci id="alg2.17.17.m1.1.1.2.3.9.cmml" xref="alg2.17.17.m1.1.1.2.3.9">𝑑</ci><ci id="alg2.17.17.m1.1.1.2.3.10.cmml" xref="alg2.17.17.m1.1.1.2.3.10">𝑖</ci><ci id="alg2.17.17.m1.1.1.2.3.11.cmml" xref="alg2.17.17.m1.1.1.2.3.11">𝑎</ci><ci id="alg2.17.17.m1.1.1.2.3.12.cmml" xref="alg2.17.17.m1.1.1.2.3.12">𝑡</ci><ci id="alg2.17.17.m1.1.1.2.3.13.cmml" xref="alg2.17.17.m1.1.1.2.3.13">𝑒</ci></apply></apply><csymbol cd="latexml" id="alg2.17.17.m1.1.1.3.cmml" xref="alg2.17.17.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.m1.1c">X_{intermediate}\leftarrow</annotation></semantics></math> concatenate <math id="alg2.18.18.m2.1" class="ltx_Math" alttext="\tilde{X}" display="inline"><semantics id="alg2.18.18.m2.1a"><mover accent="true" id="alg2.18.18.m2.1.1" xref="alg2.18.18.m2.1.1.cmml"><mi id="alg2.18.18.m2.1.1.2" xref="alg2.18.18.m2.1.1.2.cmml">X</mi><mo id="alg2.18.18.m2.1.1.1" xref="alg2.18.18.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.18.18.m2.1b"><apply id="alg2.18.18.m2.1.1.cmml" xref="alg2.18.18.m2.1.1"><ci id="alg2.18.18.m2.1.1.1.cmml" xref="alg2.18.18.m2.1.1.1">~</ci><ci id="alg2.18.18.m2.1.1.2.cmml" xref="alg2.18.18.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.m2.1c">\tilde{X}</annotation></semantics></math> column-wise

</div>
<div id="alg2.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.19.19.m1.1" class="ltx_math_unparsed" alttext="Z_{latent},M\_Loss\leftarrow PartialEnc(X_{intermediate}" display="inline"><semantics id="alg2.19.19.m1.1a"><mrow id="alg2.19.19.m1.1b"><msub id="alg2.19.19.m1.1.1"><mi id="alg2.19.19.m1.1.1.2">Z</mi><mrow id="alg2.19.19.m1.1.1.3"><mi id="alg2.19.19.m1.1.1.3.2">l</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.1.3.1">​</mo><mi id="alg2.19.19.m1.1.1.3.3">a</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.1.3.1a">​</mo><mi id="alg2.19.19.m1.1.1.3.4">t</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.1.3.1b">​</mo><mi id="alg2.19.19.m1.1.1.3.5">e</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.1.3.1c">​</mo><mi id="alg2.19.19.m1.1.1.3.6">n</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.1.3.1d">​</mo><mi id="alg2.19.19.m1.1.1.3.7">t</mi></mrow></msub><mo id="alg2.19.19.m1.1.2">,</mo><mi id="alg2.19.19.m1.1.3">M</mi><mi mathvariant="normal" id="alg2.19.19.m1.1.4">_</mi><mi id="alg2.19.19.m1.1.5">L</mi><mi id="alg2.19.19.m1.1.6">o</mi><mi id="alg2.19.19.m1.1.7">s</mi><mi id="alg2.19.19.m1.1.8">s</mi><mo stretchy="false" id="alg2.19.19.m1.1.9">←</mo><mi id="alg2.19.19.m1.1.10">P</mi><mi id="alg2.19.19.m1.1.11">a</mi><mi id="alg2.19.19.m1.1.12">r</mi><mi id="alg2.19.19.m1.1.13">t</mi><mi id="alg2.19.19.m1.1.14">i</mi><mi id="alg2.19.19.m1.1.15">a</mi><mi id="alg2.19.19.m1.1.16">l</mi><mi id="alg2.19.19.m1.1.17">E</mi><mi id="alg2.19.19.m1.1.18">n</mi><mi id="alg2.19.19.m1.1.19">c</mi><mrow id="alg2.19.19.m1.1.20"><mo stretchy="false" id="alg2.19.19.m1.1.20.1">(</mo><msub id="alg2.19.19.m1.1.20.2"><mi id="alg2.19.19.m1.1.20.2.2">X</mi><mrow id="alg2.19.19.m1.1.20.2.3"><mi id="alg2.19.19.m1.1.20.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1">​</mo><mi id="alg2.19.19.m1.1.20.2.3.3">n</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1a">​</mo><mi id="alg2.19.19.m1.1.20.2.3.4">t</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1b">​</mo><mi id="alg2.19.19.m1.1.20.2.3.5">e</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1c">​</mo><mi id="alg2.19.19.m1.1.20.2.3.6">r</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1d">​</mo><mi id="alg2.19.19.m1.1.20.2.3.7">m</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1e">​</mo><mi id="alg2.19.19.m1.1.20.2.3.8">e</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1f">​</mo><mi id="alg2.19.19.m1.1.20.2.3.9">d</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1g">​</mo><mi id="alg2.19.19.m1.1.20.2.3.10">i</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1h">​</mo><mi id="alg2.19.19.m1.1.20.2.3.11">a</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1i">​</mo><mi id="alg2.19.19.m1.1.20.2.3.12">t</mi><mo lspace="0em" rspace="0em" id="alg2.19.19.m1.1.20.2.3.1j">​</mo><mi id="alg2.19.19.m1.1.20.2.3.13">e</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg2.19.19.m1.1c">Z_{latent},M\_Loss\leftarrow PartialEnc(X_{intermediate}</annotation></semantics></math>)

</div>
<div id="alg2.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.20.20.m1.1" class="ltx_Math" alttext="final\_logits\leftarrow final\_mapping(Z_{latent})" display="inline"><semantics id="alg2.20.20.m1.1a"><mrow id="alg2.20.20.m1.1.1" xref="alg2.20.20.m1.1.1.cmml"><mrow id="alg2.20.20.m1.1.1.3" xref="alg2.20.20.m1.1.1.3.cmml"><mi id="alg2.20.20.m1.1.1.3.2" xref="alg2.20.20.m1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.3" xref="alg2.20.20.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1a" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.4" xref="alg2.20.20.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1b" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.5" xref="alg2.20.20.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1c" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.6" xref="alg2.20.20.m1.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1d" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.20.20.m1.1.1.3.7" xref="alg2.20.20.m1.1.1.3.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1e" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.8" xref="alg2.20.20.m1.1.1.3.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1f" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.9" xref="alg2.20.20.m1.1.1.3.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1g" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.10" xref="alg2.20.20.m1.1.1.3.10.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1h" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.11" xref="alg2.20.20.m1.1.1.3.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1i" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.12" xref="alg2.20.20.m1.1.1.3.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.3.1j" xref="alg2.20.20.m1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.3.13" xref="alg2.20.20.m1.1.1.3.13.cmml">s</mi></mrow><mo stretchy="false" id="alg2.20.20.m1.1.1.2" xref="alg2.20.20.m1.1.1.2.cmml">←</mo><mrow id="alg2.20.20.m1.1.1.1" xref="alg2.20.20.m1.1.1.1.cmml"><mi id="alg2.20.20.m1.1.1.1.3" xref="alg2.20.20.m1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.4" xref="alg2.20.20.m1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2a" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.5" xref="alg2.20.20.m1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2b" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.6" xref="alg2.20.20.m1.1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2c" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.7" xref="alg2.20.20.m1.1.1.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2d" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg2.20.20.m1.1.1.1.8" xref="alg2.20.20.m1.1.1.1.8.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2e" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.9" xref="alg2.20.20.m1.1.1.1.9.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2f" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.10" xref="alg2.20.20.m1.1.1.1.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2g" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.11" xref="alg2.20.20.m1.1.1.1.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2h" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.12" xref="alg2.20.20.m1.1.1.1.12.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2i" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.13" xref="alg2.20.20.m1.1.1.1.13.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2j" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.14" xref="alg2.20.20.m1.1.1.1.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2k" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.15" xref="alg2.20.20.m1.1.1.1.15.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.2l" xref="alg2.20.20.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.20.20.m1.1.1.1.1.1" xref="alg2.20.20.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.20.20.m1.1.1.1.1.1.2" xref="alg2.20.20.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.20.20.m1.1.1.1.1.1.1" xref="alg2.20.20.m1.1.1.1.1.1.1.cmml"><mi id="alg2.20.20.m1.1.1.1.1.1.1.2" xref="alg2.20.20.m1.1.1.1.1.1.1.2.cmml">Z</mi><mrow id="alg2.20.20.m1.1.1.1.1.1.1.3" xref="alg2.20.20.m1.1.1.1.1.1.1.3.cmml"><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.2" xref="alg2.20.20.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.1.1.1.3.1" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.3" xref="alg2.20.20.m1.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.1.1.1.3.1a" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.4" xref="alg2.20.20.m1.1.1.1.1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.1.1.1.3.1b" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.5" xref="alg2.20.20.m1.1.1.1.1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.1.1.1.3.1c" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.6" xref="alg2.20.20.m1.1.1.1.1.1.1.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.20.20.m1.1.1.1.1.1.1.3.1d" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.20.20.m1.1.1.1.1.1.1.3.7" xref="alg2.20.20.m1.1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg2.20.20.m1.1.1.1.1.1.3" xref="alg2.20.20.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.20.20.m1.1b"><apply id="alg2.20.20.m1.1.1.cmml" xref="alg2.20.20.m1.1.1"><ci id="alg2.20.20.m1.1.1.2.cmml" xref="alg2.20.20.m1.1.1.2">←</ci><apply id="alg2.20.20.m1.1.1.3.cmml" xref="alg2.20.20.m1.1.1.3"><times id="alg2.20.20.m1.1.1.3.1.cmml" xref="alg2.20.20.m1.1.1.3.1"></times><ci id="alg2.20.20.m1.1.1.3.2.cmml" xref="alg2.20.20.m1.1.1.3.2">𝑓</ci><ci id="alg2.20.20.m1.1.1.3.3.cmml" xref="alg2.20.20.m1.1.1.3.3">𝑖</ci><ci id="alg2.20.20.m1.1.1.3.4.cmml" xref="alg2.20.20.m1.1.1.3.4">𝑛</ci><ci id="alg2.20.20.m1.1.1.3.5.cmml" xref="alg2.20.20.m1.1.1.3.5">𝑎</ci><ci id="alg2.20.20.m1.1.1.3.6.cmml" xref="alg2.20.20.m1.1.1.3.6">𝑙</ci><ci id="alg2.20.20.m1.1.1.3.7.cmml" xref="alg2.20.20.m1.1.1.3.7">_</ci><ci id="alg2.20.20.m1.1.1.3.8.cmml" xref="alg2.20.20.m1.1.1.3.8">𝑙</ci><ci id="alg2.20.20.m1.1.1.3.9.cmml" xref="alg2.20.20.m1.1.1.3.9">𝑜</ci><ci id="alg2.20.20.m1.1.1.3.10.cmml" xref="alg2.20.20.m1.1.1.3.10">𝑔</ci><ci id="alg2.20.20.m1.1.1.3.11.cmml" xref="alg2.20.20.m1.1.1.3.11">𝑖</ci><ci id="alg2.20.20.m1.1.1.3.12.cmml" xref="alg2.20.20.m1.1.1.3.12">𝑡</ci><ci id="alg2.20.20.m1.1.1.3.13.cmml" xref="alg2.20.20.m1.1.1.3.13">𝑠</ci></apply><apply id="alg2.20.20.m1.1.1.1.cmml" xref="alg2.20.20.m1.1.1.1"><times id="alg2.20.20.m1.1.1.1.2.cmml" xref="alg2.20.20.m1.1.1.1.2"></times><ci id="alg2.20.20.m1.1.1.1.3.cmml" xref="alg2.20.20.m1.1.1.1.3">𝑓</ci><ci id="alg2.20.20.m1.1.1.1.4.cmml" xref="alg2.20.20.m1.1.1.1.4">𝑖</ci><ci id="alg2.20.20.m1.1.1.1.5.cmml" xref="alg2.20.20.m1.1.1.1.5">𝑛</ci><ci id="alg2.20.20.m1.1.1.1.6.cmml" xref="alg2.20.20.m1.1.1.1.6">𝑎</ci><ci id="alg2.20.20.m1.1.1.1.7.cmml" xref="alg2.20.20.m1.1.1.1.7">𝑙</ci><ci id="alg2.20.20.m1.1.1.1.8.cmml" xref="alg2.20.20.m1.1.1.1.8">_</ci><ci id="alg2.20.20.m1.1.1.1.9.cmml" xref="alg2.20.20.m1.1.1.1.9">𝑚</ci><ci id="alg2.20.20.m1.1.1.1.10.cmml" xref="alg2.20.20.m1.1.1.1.10">𝑎</ci><ci id="alg2.20.20.m1.1.1.1.11.cmml" xref="alg2.20.20.m1.1.1.1.11">𝑝</ci><ci id="alg2.20.20.m1.1.1.1.12.cmml" xref="alg2.20.20.m1.1.1.1.12">𝑝</ci><ci id="alg2.20.20.m1.1.1.1.13.cmml" xref="alg2.20.20.m1.1.1.1.13">𝑖</ci><ci id="alg2.20.20.m1.1.1.1.14.cmml" xref="alg2.20.20.m1.1.1.1.14">𝑛</ci><ci id="alg2.20.20.m1.1.1.1.15.cmml" xref="alg2.20.20.m1.1.1.1.15">𝑔</ci><apply id="alg2.20.20.m1.1.1.1.1.1.1.cmml" xref="alg2.20.20.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.20.20.m1.1.1.1.1.1.1.1.cmml" xref="alg2.20.20.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.20.20.m1.1.1.1.1.1.1.2.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.2">𝑍</ci><apply id="alg2.20.20.m1.1.1.1.1.1.1.3.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3"><times id="alg2.20.20.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.1"></times><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.4.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.4">𝑡</ci><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.5.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.5">𝑒</ci><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.6.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.6">𝑛</ci><ci id="alg2.20.20.m1.1.1.1.1.1.1.3.7.cmml" xref="alg2.20.20.m1.1.1.1.1.1.1.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.m1.1c">final\_logits\leftarrow final\_mapping(Z_{latent})</annotation></semantics></math>

</div>
<div id="alg2.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.21.21.m1.1" class="ltx_Math" alttext="prediction\_proba\leftarrow softmax(final\_logits)" display="inline"><semantics id="alg2.21.21.m1.1a"><mrow id="alg2.21.21.m1.1.1" xref="alg2.21.21.m1.1.1.cmml"><mrow id="alg2.21.21.m1.1.1.3" xref="alg2.21.21.m1.1.1.3.cmml"><mi id="alg2.21.21.m1.1.1.3.2" xref="alg2.21.21.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.3" xref="alg2.21.21.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1a" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.4" xref="alg2.21.21.m1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1b" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.5" xref="alg2.21.21.m1.1.1.3.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1c" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.6" xref="alg2.21.21.m1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1d" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.7" xref="alg2.21.21.m1.1.1.3.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1e" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.8" xref="alg2.21.21.m1.1.1.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1f" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.9" xref="alg2.21.21.m1.1.1.3.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1g" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.10" xref="alg2.21.21.m1.1.1.3.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1h" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.11" xref="alg2.21.21.m1.1.1.3.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1i" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.21.21.m1.1.1.3.12" xref="alg2.21.21.m1.1.1.3.12.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1j" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.13" xref="alg2.21.21.m1.1.1.3.13.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1k" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.14" xref="alg2.21.21.m1.1.1.3.14.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1l" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.15" xref="alg2.21.21.m1.1.1.3.15.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1m" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.16" xref="alg2.21.21.m1.1.1.3.16.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.3.1n" xref="alg2.21.21.m1.1.1.3.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.3.17" xref="alg2.21.21.m1.1.1.3.17.cmml">a</mi></mrow><mo stretchy="false" id="alg2.21.21.m1.1.1.2" xref="alg2.21.21.m1.1.1.2.cmml">←</mo><mrow id="alg2.21.21.m1.1.1.1" xref="alg2.21.21.m1.1.1.1.cmml"><mi id="alg2.21.21.m1.1.1.1.3" xref="alg2.21.21.m1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.4" xref="alg2.21.21.m1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2a" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.5" xref="alg2.21.21.m1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2b" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.6" xref="alg2.21.21.m1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2c" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.7" xref="alg2.21.21.m1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2d" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.8" xref="alg2.21.21.m1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2e" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.9" xref="alg2.21.21.m1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.2f" xref="alg2.21.21.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.21.21.m1.1.1.1.1.1" xref="alg2.21.21.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.21.21.m1.1.1.1.1.1.2" xref="alg2.21.21.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.21.21.m1.1.1.1.1.1.1" xref="alg2.21.21.m1.1.1.1.1.1.1.cmml"><mi id="alg2.21.21.m1.1.1.1.1.1.1.2" xref="alg2.21.21.m1.1.1.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.3" xref="alg2.21.21.m1.1.1.1.1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1a" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.4" xref="alg2.21.21.m1.1.1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1b" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.5" xref="alg2.21.21.m1.1.1.1.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1c" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.6" xref="alg2.21.21.m1.1.1.1.1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1d" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg2.21.21.m1.1.1.1.1.1.1.7" xref="alg2.21.21.m1.1.1.1.1.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1e" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.8" xref="alg2.21.21.m1.1.1.1.1.1.1.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1f" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.9" xref="alg2.21.21.m1.1.1.1.1.1.1.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1g" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.10" xref="alg2.21.21.m1.1.1.1.1.1.1.10.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1h" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.11" xref="alg2.21.21.m1.1.1.1.1.1.1.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1i" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.12" xref="alg2.21.21.m1.1.1.1.1.1.1.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.21.21.m1.1.1.1.1.1.1.1j" xref="alg2.21.21.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.21.21.m1.1.1.1.1.1.1.13" xref="alg2.21.21.m1.1.1.1.1.1.1.13.cmml">s</mi></mrow><mo stretchy="false" id="alg2.21.21.m1.1.1.1.1.1.3" xref="alg2.21.21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.21.21.m1.1b"><apply id="alg2.21.21.m1.1.1.cmml" xref="alg2.21.21.m1.1.1"><ci id="alg2.21.21.m1.1.1.2.cmml" xref="alg2.21.21.m1.1.1.2">←</ci><apply id="alg2.21.21.m1.1.1.3.cmml" xref="alg2.21.21.m1.1.1.3"><times id="alg2.21.21.m1.1.1.3.1.cmml" xref="alg2.21.21.m1.1.1.3.1"></times><ci id="alg2.21.21.m1.1.1.3.2.cmml" xref="alg2.21.21.m1.1.1.3.2">𝑝</ci><ci id="alg2.21.21.m1.1.1.3.3.cmml" xref="alg2.21.21.m1.1.1.3.3">𝑟</ci><ci id="alg2.21.21.m1.1.1.3.4.cmml" xref="alg2.21.21.m1.1.1.3.4">𝑒</ci><ci id="alg2.21.21.m1.1.1.3.5.cmml" xref="alg2.21.21.m1.1.1.3.5">𝑑</ci><ci id="alg2.21.21.m1.1.1.3.6.cmml" xref="alg2.21.21.m1.1.1.3.6">𝑖</ci><ci id="alg2.21.21.m1.1.1.3.7.cmml" xref="alg2.21.21.m1.1.1.3.7">𝑐</ci><ci id="alg2.21.21.m1.1.1.3.8.cmml" xref="alg2.21.21.m1.1.1.3.8">𝑡</ci><ci id="alg2.21.21.m1.1.1.3.9.cmml" xref="alg2.21.21.m1.1.1.3.9">𝑖</ci><ci id="alg2.21.21.m1.1.1.3.10.cmml" xref="alg2.21.21.m1.1.1.3.10">𝑜</ci><ci id="alg2.21.21.m1.1.1.3.11.cmml" xref="alg2.21.21.m1.1.1.3.11">𝑛</ci><ci id="alg2.21.21.m1.1.1.3.12.cmml" xref="alg2.21.21.m1.1.1.3.12">_</ci><ci id="alg2.21.21.m1.1.1.3.13.cmml" xref="alg2.21.21.m1.1.1.3.13">𝑝</ci><ci id="alg2.21.21.m1.1.1.3.14.cmml" xref="alg2.21.21.m1.1.1.3.14">𝑟</ci><ci id="alg2.21.21.m1.1.1.3.15.cmml" xref="alg2.21.21.m1.1.1.3.15">𝑜</ci><ci id="alg2.21.21.m1.1.1.3.16.cmml" xref="alg2.21.21.m1.1.1.3.16">𝑏</ci><ci id="alg2.21.21.m1.1.1.3.17.cmml" xref="alg2.21.21.m1.1.1.3.17">𝑎</ci></apply><apply id="alg2.21.21.m1.1.1.1.cmml" xref="alg2.21.21.m1.1.1.1"><times id="alg2.21.21.m1.1.1.1.2.cmml" xref="alg2.21.21.m1.1.1.1.2"></times><ci id="alg2.21.21.m1.1.1.1.3.cmml" xref="alg2.21.21.m1.1.1.1.3">𝑠</ci><ci id="alg2.21.21.m1.1.1.1.4.cmml" xref="alg2.21.21.m1.1.1.1.4">𝑜</ci><ci id="alg2.21.21.m1.1.1.1.5.cmml" xref="alg2.21.21.m1.1.1.1.5">𝑓</ci><ci id="alg2.21.21.m1.1.1.1.6.cmml" xref="alg2.21.21.m1.1.1.1.6">𝑡</ci><ci id="alg2.21.21.m1.1.1.1.7.cmml" xref="alg2.21.21.m1.1.1.1.7">𝑚</ci><ci id="alg2.21.21.m1.1.1.1.8.cmml" xref="alg2.21.21.m1.1.1.1.8">𝑎</ci><ci id="alg2.21.21.m1.1.1.1.9.cmml" xref="alg2.21.21.m1.1.1.1.9">𝑥</ci><apply id="alg2.21.21.m1.1.1.1.1.1.1.cmml" xref="alg2.21.21.m1.1.1.1.1.1"><times id="alg2.21.21.m1.1.1.1.1.1.1.1.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.1"></times><ci id="alg2.21.21.m1.1.1.1.1.1.1.2.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.3.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.3">𝑖</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.4.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.4">𝑛</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.5.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.5">𝑎</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.6.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.6">𝑙</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.7.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.7">_</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.8.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.8">𝑙</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.9.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.9">𝑜</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.10.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.10">𝑔</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.11.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.11">𝑖</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.12.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.12">𝑡</ci><ci id="alg2.21.21.m1.1.1.1.1.1.1.13.cmml" xref="alg2.21.21.m1.1.1.1.1.1.1.13">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.m1.1c">prediction\_proba\leftarrow softmax(final\_logits)</annotation></semantics></math>

</div>
<div id="alg2.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.22.22.m1.2" class="ltx_Math" alttext="loss\leftarrow classification\_loss(prediction\_proba,y\_true)" display="inline"><semantics id="alg2.22.22.m1.2a"><mrow id="alg2.22.22.m1.2.2" xref="alg2.22.22.m1.2.2.cmml"><mrow id="alg2.22.22.m1.2.2.4" xref="alg2.22.22.m1.2.2.4.cmml"><mi id="alg2.22.22.m1.2.2.4.2" xref="alg2.22.22.m1.2.2.4.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.4.1" xref="alg2.22.22.m1.2.2.4.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.4.3" xref="alg2.22.22.m1.2.2.4.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.4.1a" xref="alg2.22.22.m1.2.2.4.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.4.4" xref="alg2.22.22.m1.2.2.4.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.4.1b" xref="alg2.22.22.m1.2.2.4.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.4.5" xref="alg2.22.22.m1.2.2.4.5.cmml">s</mi></mrow><mo stretchy="false" id="alg2.22.22.m1.2.2.3" xref="alg2.22.22.m1.2.2.3.cmml">←</mo><mrow id="alg2.22.22.m1.2.2.2" xref="alg2.22.22.m1.2.2.2.cmml"><mi id="alg2.22.22.m1.2.2.2.4" xref="alg2.22.22.m1.2.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.5" xref="alg2.22.22.m1.2.2.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3a" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.6" xref="alg2.22.22.m1.2.2.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3b" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.7" xref="alg2.22.22.m1.2.2.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3c" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.8" xref="alg2.22.22.m1.2.2.2.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3d" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.9" xref="alg2.22.22.m1.2.2.2.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3e" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.10" xref="alg2.22.22.m1.2.2.2.10.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3f" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.11" xref="alg2.22.22.m1.2.2.2.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3g" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.12" xref="alg2.22.22.m1.2.2.2.12.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3h" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.13" xref="alg2.22.22.m1.2.2.2.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3i" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.14" xref="alg2.22.22.m1.2.2.2.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3j" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.15" xref="alg2.22.22.m1.2.2.2.15.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3k" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.16" xref="alg2.22.22.m1.2.2.2.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3l" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.17" xref="alg2.22.22.m1.2.2.2.17.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3m" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="alg2.22.22.m1.2.2.2.18" xref="alg2.22.22.m1.2.2.2.18.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3n" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.19" xref="alg2.22.22.m1.2.2.2.19.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3o" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.20" xref="alg2.22.22.m1.2.2.2.20.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3p" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.21" xref="alg2.22.22.m1.2.2.2.21.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3q" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.22" xref="alg2.22.22.m1.2.2.2.22.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.3r" xref="alg2.22.22.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.22.22.m1.2.2.2.2.2" xref="alg2.22.22.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.22.22.m1.2.2.2.2.2.3" xref="alg2.22.22.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg2.22.22.m1.1.1.1.1.1.1" xref="alg2.22.22.m1.1.1.1.1.1.1.cmml"><mi id="alg2.22.22.m1.1.1.1.1.1.1.2" xref="alg2.22.22.m1.1.1.1.1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.3" xref="alg2.22.22.m1.1.1.1.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1a" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.4" xref="alg2.22.22.m1.1.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1b" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.5" xref="alg2.22.22.m1.1.1.1.1.1.1.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1c" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.6" xref="alg2.22.22.m1.1.1.1.1.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1d" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.7" xref="alg2.22.22.m1.1.1.1.1.1.1.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1e" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.8" xref="alg2.22.22.m1.1.1.1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1f" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.9" xref="alg2.22.22.m1.1.1.1.1.1.1.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1g" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.10" xref="alg2.22.22.m1.1.1.1.1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1h" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.11" xref="alg2.22.22.m1.1.1.1.1.1.1.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1i" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg2.22.22.m1.1.1.1.1.1.1.12" xref="alg2.22.22.m1.1.1.1.1.1.1.12.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1j" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.13" xref="alg2.22.22.m1.1.1.1.1.1.1.13.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1k" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.14" xref="alg2.22.22.m1.1.1.1.1.1.1.14.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1l" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.15" xref="alg2.22.22.m1.1.1.1.1.1.1.15.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1m" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.16" xref="alg2.22.22.m1.1.1.1.1.1.1.16.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.1.1.1.1.1.1.1n" xref="alg2.22.22.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.22.22.m1.1.1.1.1.1.1.17" xref="alg2.22.22.m1.1.1.1.1.1.1.17.cmml">a</mi></mrow><mo id="alg2.22.22.m1.2.2.2.2.2.4" xref="alg2.22.22.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg2.22.22.m1.2.2.2.2.2.2" xref="alg2.22.22.m1.2.2.2.2.2.2.cmml"><mi id="alg2.22.22.m1.2.2.2.2.2.2.2" xref="alg2.22.22.m1.2.2.2.2.2.2.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.2.2.2.1" xref="alg2.22.22.m1.2.2.2.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.22.22.m1.2.2.2.2.2.2.3" xref="alg2.22.22.m1.2.2.2.2.2.2.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.2.2.2.1a" xref="alg2.22.22.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.2.2.2.4" xref="alg2.22.22.m1.2.2.2.2.2.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.2.2.2.1b" xref="alg2.22.22.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.2.2.2.5" xref="alg2.22.22.m1.2.2.2.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.2.2.2.1c" xref="alg2.22.22.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.2.2.2.6" xref="alg2.22.22.m1.2.2.2.2.2.2.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg2.22.22.m1.2.2.2.2.2.2.1d" xref="alg2.22.22.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.22.22.m1.2.2.2.2.2.2.7" xref="alg2.22.22.m1.2.2.2.2.2.2.7.cmml">e</mi></mrow><mo stretchy="false" id="alg2.22.22.m1.2.2.2.2.2.5" xref="alg2.22.22.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.22.22.m1.2b"><apply id="alg2.22.22.m1.2.2.cmml" xref="alg2.22.22.m1.2.2"><ci id="alg2.22.22.m1.2.2.3.cmml" xref="alg2.22.22.m1.2.2.3">←</ci><apply id="alg2.22.22.m1.2.2.4.cmml" xref="alg2.22.22.m1.2.2.4"><times id="alg2.22.22.m1.2.2.4.1.cmml" xref="alg2.22.22.m1.2.2.4.1"></times><ci id="alg2.22.22.m1.2.2.4.2.cmml" xref="alg2.22.22.m1.2.2.4.2">𝑙</ci><ci id="alg2.22.22.m1.2.2.4.3.cmml" xref="alg2.22.22.m1.2.2.4.3">𝑜</ci><ci id="alg2.22.22.m1.2.2.4.4.cmml" xref="alg2.22.22.m1.2.2.4.4">𝑠</ci><ci id="alg2.22.22.m1.2.2.4.5.cmml" xref="alg2.22.22.m1.2.2.4.5">𝑠</ci></apply><apply id="alg2.22.22.m1.2.2.2.cmml" xref="alg2.22.22.m1.2.2.2"><times id="alg2.22.22.m1.2.2.2.3.cmml" xref="alg2.22.22.m1.2.2.2.3"></times><ci id="alg2.22.22.m1.2.2.2.4.cmml" xref="alg2.22.22.m1.2.2.2.4">𝑐</ci><ci id="alg2.22.22.m1.2.2.2.5.cmml" xref="alg2.22.22.m1.2.2.2.5">𝑙</ci><ci id="alg2.22.22.m1.2.2.2.6.cmml" xref="alg2.22.22.m1.2.2.2.6">𝑎</ci><ci id="alg2.22.22.m1.2.2.2.7.cmml" xref="alg2.22.22.m1.2.2.2.7">𝑠</ci><ci id="alg2.22.22.m1.2.2.2.8.cmml" xref="alg2.22.22.m1.2.2.2.8">𝑠</ci><ci id="alg2.22.22.m1.2.2.2.9.cmml" xref="alg2.22.22.m1.2.2.2.9">𝑖</ci><ci id="alg2.22.22.m1.2.2.2.10.cmml" xref="alg2.22.22.m1.2.2.2.10">𝑓</ci><ci id="alg2.22.22.m1.2.2.2.11.cmml" xref="alg2.22.22.m1.2.2.2.11">𝑖</ci><ci id="alg2.22.22.m1.2.2.2.12.cmml" xref="alg2.22.22.m1.2.2.2.12">𝑐</ci><ci id="alg2.22.22.m1.2.2.2.13.cmml" xref="alg2.22.22.m1.2.2.2.13">𝑎</ci><ci id="alg2.22.22.m1.2.2.2.14.cmml" xref="alg2.22.22.m1.2.2.2.14">𝑡</ci><ci id="alg2.22.22.m1.2.2.2.15.cmml" xref="alg2.22.22.m1.2.2.2.15">𝑖</ci><ci id="alg2.22.22.m1.2.2.2.16.cmml" xref="alg2.22.22.m1.2.2.2.16">𝑜</ci><ci id="alg2.22.22.m1.2.2.2.17.cmml" xref="alg2.22.22.m1.2.2.2.17">𝑛</ci><ci id="alg2.22.22.m1.2.2.2.18.cmml" xref="alg2.22.22.m1.2.2.2.18">_</ci><ci id="alg2.22.22.m1.2.2.2.19.cmml" xref="alg2.22.22.m1.2.2.2.19">𝑙</ci><ci id="alg2.22.22.m1.2.2.2.20.cmml" xref="alg2.22.22.m1.2.2.2.20">𝑜</ci><ci id="alg2.22.22.m1.2.2.2.21.cmml" xref="alg2.22.22.m1.2.2.2.21">𝑠</ci><ci id="alg2.22.22.m1.2.2.2.22.cmml" xref="alg2.22.22.m1.2.2.2.22">𝑠</ci><interval closure="open" id="alg2.22.22.m1.2.2.2.2.3.cmml" xref="alg2.22.22.m1.2.2.2.2.2"><apply id="alg2.22.22.m1.1.1.1.1.1.1.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1"><times id="alg2.22.22.m1.1.1.1.1.1.1.1.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.1"></times><ci id="alg2.22.22.m1.1.1.1.1.1.1.2.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.3.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.3">𝑟</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.4.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.4">𝑒</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.5.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.5">𝑑</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.6.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.6">𝑖</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.7.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.7">𝑐</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.8.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.8">𝑡</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.9.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.9">𝑖</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.10.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.10">𝑜</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.11.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.11">𝑛</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.12.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.12">_</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.13.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.13">𝑝</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.14.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.14">𝑟</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.15.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.15">𝑜</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.16.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.16">𝑏</ci><ci id="alg2.22.22.m1.1.1.1.1.1.1.17.cmml" xref="alg2.22.22.m1.1.1.1.1.1.1.17">𝑎</ci></apply><apply id="alg2.22.22.m1.2.2.2.2.2.2.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2"><times id="alg2.22.22.m1.2.2.2.2.2.2.1.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.1"></times><ci id="alg2.22.22.m1.2.2.2.2.2.2.2.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="alg2.22.22.m1.2.2.2.2.2.2.3.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.3">_</ci><ci id="alg2.22.22.m1.2.2.2.2.2.2.4.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.4">𝑡</ci><ci id="alg2.22.22.m1.2.2.2.2.2.2.5.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.5">𝑟</ci><ci id="alg2.22.22.m1.2.2.2.2.2.2.6.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.6">𝑢</ci><ci id="alg2.22.22.m1.2.2.2.2.2.2.7.cmml" xref="alg2.22.22.m1.2.2.2.2.2.2.7">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.22.m1.2c">loss\leftarrow classification\_loss(prediction\_proba,y\_true)</annotation></semantics></math>

</div>
<div id="alg2.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.23.23.m1.1" class="ltx_Math" alttext="loss=loss-M\_loss*\lambda_{sparse}" display="inline"><semantics id="alg2.23.23.m1.1a"><mrow id="alg2.23.23.m1.1.1" xref="alg2.23.23.m1.1.1.cmml"><mrow id="alg2.23.23.m1.1.1.2" xref="alg2.23.23.m1.1.1.2.cmml"><mi id="alg2.23.23.m1.1.1.2.2" xref="alg2.23.23.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.2.1" xref="alg2.23.23.m1.1.1.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.2.3" xref="alg2.23.23.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.2.1a" xref="alg2.23.23.m1.1.1.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.2.4" xref="alg2.23.23.m1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.2.1b" xref="alg2.23.23.m1.1.1.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.2.5" xref="alg2.23.23.m1.1.1.2.5.cmml">s</mi></mrow><mo id="alg2.23.23.m1.1.1.1" xref="alg2.23.23.m1.1.1.1.cmml">=</mo><mrow id="alg2.23.23.m1.1.1.3" xref="alg2.23.23.m1.1.1.3.cmml"><mrow id="alg2.23.23.m1.1.1.3.2" xref="alg2.23.23.m1.1.1.3.2.cmml"><mi id="alg2.23.23.m1.1.1.3.2.2" xref="alg2.23.23.m1.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.2.1" xref="alg2.23.23.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.2.3" xref="alg2.23.23.m1.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.2.1a" xref="alg2.23.23.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.2.4" xref="alg2.23.23.m1.1.1.3.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.2.1b" xref="alg2.23.23.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.2.5" xref="alg2.23.23.m1.1.1.3.2.5.cmml">s</mi></mrow><mo id="alg2.23.23.m1.1.1.3.1" xref="alg2.23.23.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.23.23.m1.1.1.3.3" xref="alg2.23.23.m1.1.1.3.3.cmml"><mrow id="alg2.23.23.m1.1.1.3.3.2" xref="alg2.23.23.m1.1.1.3.3.2.cmml"><mi id="alg2.23.23.m1.1.1.3.3.2.2" xref="alg2.23.23.m1.1.1.3.3.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.2.1" xref="alg2.23.23.m1.1.1.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.23.23.m1.1.1.3.3.2.3" xref="alg2.23.23.m1.1.1.3.3.2.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.2.1a" xref="alg2.23.23.m1.1.1.3.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.2.4" xref="alg2.23.23.m1.1.1.3.3.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.2.1b" xref="alg2.23.23.m1.1.1.3.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.2.5" xref="alg2.23.23.m1.1.1.3.3.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.2.1c" xref="alg2.23.23.m1.1.1.3.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.2.6" xref="alg2.23.23.m1.1.1.3.3.2.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.2.1d" xref="alg2.23.23.m1.1.1.3.3.2.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.2.7" xref="alg2.23.23.m1.1.1.3.3.2.7.cmml">s</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="alg2.23.23.m1.1.1.3.3.1" xref="alg2.23.23.m1.1.1.3.3.1.cmml">∗</mo><msub id="alg2.23.23.m1.1.1.3.3.3" xref="alg2.23.23.m1.1.1.3.3.3.cmml"><mi id="alg2.23.23.m1.1.1.3.3.3.2" xref="alg2.23.23.m1.1.1.3.3.3.2.cmml">λ</mi><mrow id="alg2.23.23.m1.1.1.3.3.3.3" xref="alg2.23.23.m1.1.1.3.3.3.3.cmml"><mi id="alg2.23.23.m1.1.1.3.3.3.3.2" xref="alg2.23.23.m1.1.1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.3.3.1" xref="alg2.23.23.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.3.3.3" xref="alg2.23.23.m1.1.1.3.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.3.3.1a" xref="alg2.23.23.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.3.3.4" xref="alg2.23.23.m1.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.3.3.1b" xref="alg2.23.23.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.3.3.5" xref="alg2.23.23.m1.1.1.3.3.3.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.3.3.1c" xref="alg2.23.23.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.3.3.6" xref="alg2.23.23.m1.1.1.3.3.3.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.23.23.m1.1.1.3.3.3.3.1d" xref="alg2.23.23.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg2.23.23.m1.1.1.3.3.3.3.7" xref="alg2.23.23.m1.1.1.3.3.3.3.7.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.23.23.m1.1b"><apply id="alg2.23.23.m1.1.1.cmml" xref="alg2.23.23.m1.1.1"><eq id="alg2.23.23.m1.1.1.1.cmml" xref="alg2.23.23.m1.1.1.1"></eq><apply id="alg2.23.23.m1.1.1.2.cmml" xref="alg2.23.23.m1.1.1.2"><times id="alg2.23.23.m1.1.1.2.1.cmml" xref="alg2.23.23.m1.1.1.2.1"></times><ci id="alg2.23.23.m1.1.1.2.2.cmml" xref="alg2.23.23.m1.1.1.2.2">𝑙</ci><ci id="alg2.23.23.m1.1.1.2.3.cmml" xref="alg2.23.23.m1.1.1.2.3">𝑜</ci><ci id="alg2.23.23.m1.1.1.2.4.cmml" xref="alg2.23.23.m1.1.1.2.4">𝑠</ci><ci id="alg2.23.23.m1.1.1.2.5.cmml" xref="alg2.23.23.m1.1.1.2.5">𝑠</ci></apply><apply id="alg2.23.23.m1.1.1.3.cmml" xref="alg2.23.23.m1.1.1.3"><minus id="alg2.23.23.m1.1.1.3.1.cmml" xref="alg2.23.23.m1.1.1.3.1"></minus><apply id="alg2.23.23.m1.1.1.3.2.cmml" xref="alg2.23.23.m1.1.1.3.2"><times id="alg2.23.23.m1.1.1.3.2.1.cmml" xref="alg2.23.23.m1.1.1.3.2.1"></times><ci id="alg2.23.23.m1.1.1.3.2.2.cmml" xref="alg2.23.23.m1.1.1.3.2.2">𝑙</ci><ci id="alg2.23.23.m1.1.1.3.2.3.cmml" xref="alg2.23.23.m1.1.1.3.2.3">𝑜</ci><ci id="alg2.23.23.m1.1.1.3.2.4.cmml" xref="alg2.23.23.m1.1.1.3.2.4">𝑠</ci><ci id="alg2.23.23.m1.1.1.3.2.5.cmml" xref="alg2.23.23.m1.1.1.3.2.5">𝑠</ci></apply><apply id="alg2.23.23.m1.1.1.3.3.cmml" xref="alg2.23.23.m1.1.1.3.3"><times id="alg2.23.23.m1.1.1.3.3.1.cmml" xref="alg2.23.23.m1.1.1.3.3.1"></times><apply id="alg2.23.23.m1.1.1.3.3.2.cmml" xref="alg2.23.23.m1.1.1.3.3.2"><times id="alg2.23.23.m1.1.1.3.3.2.1.cmml" xref="alg2.23.23.m1.1.1.3.3.2.1"></times><ci id="alg2.23.23.m1.1.1.3.3.2.2.cmml" xref="alg2.23.23.m1.1.1.3.3.2.2">𝑀</ci><ci id="alg2.23.23.m1.1.1.3.3.2.3.cmml" xref="alg2.23.23.m1.1.1.3.3.2.3">_</ci><ci id="alg2.23.23.m1.1.1.3.3.2.4.cmml" xref="alg2.23.23.m1.1.1.3.3.2.4">𝑙</ci><ci id="alg2.23.23.m1.1.1.3.3.2.5.cmml" xref="alg2.23.23.m1.1.1.3.3.2.5">𝑜</ci><ci id="alg2.23.23.m1.1.1.3.3.2.6.cmml" xref="alg2.23.23.m1.1.1.3.3.2.6">𝑠</ci><ci id="alg2.23.23.m1.1.1.3.3.2.7.cmml" xref="alg2.23.23.m1.1.1.3.3.2.7">𝑠</ci></apply><apply id="alg2.23.23.m1.1.1.3.3.3.cmml" xref="alg2.23.23.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.23.23.m1.1.1.3.3.3.1.cmml" xref="alg2.23.23.m1.1.1.3.3.3">subscript</csymbol><ci id="alg2.23.23.m1.1.1.3.3.3.2.cmml" xref="alg2.23.23.m1.1.1.3.3.3.2">𝜆</ci><apply id="alg2.23.23.m1.1.1.3.3.3.3.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3"><times id="alg2.23.23.m1.1.1.3.3.3.3.1.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.1"></times><ci id="alg2.23.23.m1.1.1.3.3.3.3.2.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.2">𝑠</ci><ci id="alg2.23.23.m1.1.1.3.3.3.3.3.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.3">𝑝</ci><ci id="alg2.23.23.m1.1.1.3.3.3.3.4.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.4">𝑎</ci><ci id="alg2.23.23.m1.1.1.3.3.3.3.5.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.5">𝑟</ci><ci id="alg2.23.23.m1.1.1.3.3.3.3.6.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.6">𝑠</ci><ci id="alg2.23.23.m1.1.1.3.3.3.3.7.cmml" xref="alg2.23.23.m1.1.1.3.3.3.3.7">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.23.m1.1c">loss=loss-M\_loss*\lambda_{sparse}</annotation></semantics></math>

</div>
<div id="alg2.23.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate gradients and update the weights

</div>
<div id="alg2.23.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.23.34" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.25.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>TabVFL Finetuning Process</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Performance Evaluation</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we first introduce the experimental setup and the baselines. We then showcase the evaluation pipeline, followed by the presentation and analysis of the results.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Experiment Details</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Setup.</span> TabVFL <span id="S5.SS1.p1.1.2" class="ltx_text">is</span> compared against three baseline designs: Central TabNet (CT), Local TabNets (LT) and TabNet VFL with guests-assigned encoders (TabVFL-LE). CT is the baseline where TabNet is run on the full dataset in a non-federated setting. TabNet model implemented with PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> is used. The code is modified to disable batch shuffling in each mini-batch iteration and a feature for measuring epoch time is added. The former is implemented to ensure that the experiments differ only in design.
LT applies the design from prior work  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> where multiple autoencoders are trained locally in each guest client. The TabNet pretraining model is used instead of autoencoders to keep it consistent with the other baselines. During finetuning, one fully-connected (FC) layer is trained collaboratively in the host. This is done by ensuring that only latent representations are sent to the host.
The latent data of each guest are aggregated to make up one latent vector which is processed by the FC-layer in the host to predict a label and calculate the loss. The decision of training one FC-layer at the host (similar to splitNN) is made to
fairly compare it with other designs as it resembles the training procedure of finetuning in TabVFL.
TabVFL-LE shares the pretraining model design of TabVFL, differing slightly in that the complete encoder is kept within each guest client, unlike TabVFL where it is split into two parts.
The outputs of all decision steps are sent as a list of tensors to the host (see <a href="#S4.F3.sf1" title="3(a) ‣ Figure 3 ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">3(a)</span></a>) where the output of each decision step is aggregated by means of summation with the outputs of the same decision step from different guests. The reason is that
the decoder accepts a list of encoder decision step tensors. Each encoder decision step corresponds to a decoder decision step.
Due to the host receiving all encoder steps from the guests, concatenating each encoder split output and feeding it to the decoder is not feasible. This approach would create incompatible dimensions for each decoder split.
Consequently, every encoder decision step output received by the host is aggregated into a single vector, ensuring compatibility with the dimensions expected by the decoder.
In <a href="#S2.F2" title="Figure 2 ‣ II Preliminaries ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 2</span></a> it is shown that encoder steps are aggregated and passed to the decoder. But in the PyTorch code of TabNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, the aggregation happens at the decoder. The finetuning phase is identical to TabVFL with the only difference being that the latent vectors sent from each guest client to the host are aggregated using summation instead of concatenation as in TabVFL. This is done to keep the aggregation method consistent throughout the training phases. This baseline can be seen as a partial transition from LT design to TabVFL <span id="S5.SS1.p1.1.3" class="ltx_text">design</span>. We find it interesting to see how the transitioning design affects the evaluation results.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2404.17990/assets/x6.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="394" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.3.2" class="ltx_text" style="font-size:90%;">Evaluation pipeline for evaluating the latent data of different experimental designs.</span></figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure ltx_align_center"><img src="/html/2404.17990/assets/x7.png" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="332" height="148" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.4.2" class="ltx_text" style="font-size:90%;">Results of the latent representation quality of TabVFL and all baselines on different datasets.</span></figcaption>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Environment.</span> The experiments have been run on a machine with NVIDIA GeForce RTX 2080 Ti GPU with 11 GB of VRAM and CUDA version 11.0. The amount of RAM is 32 GB. Intel(R) Core(TM) i9-10900KF CPU is used with speed of 3.70GHz and 20 cores.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Datasets.</span> Five different classification datasets are considered for evaluations: Air Passenger Satisfaction (air), Network Intrusion Detection (intrusion), Bank Marketing (bank), Forest Cover Type (forest) and Rice MSC (rice). The datasets bank and forest are retrieved from <a target="_blank" href="https://archive.ics.uci.edu/datasets" title="" class="ltx_ref ltx_href">UCI Machine Learning Repository</a>, while air, intrusion and rice are acquired from <a target="_blank" href="https://www.kaggle.com/datasets" title="" class="ltx_ref ltx_href">Kaggle</a>. Among the classification datasets, three are suited for binary tasks, while two are tailored for multi-class tasks.
The metadata of each dataset are shown in <a href="#S5.T2" title="TABLE II ‣ V-B Evaluation Pipeline ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Tab. II</span></a>. All datasets, with the exception of bank, are down-sized to 50K samples due to the limited computational resources. Stratified random sampling is employed with regards to the target label to ensure identical class distribution between the original and the down-sized datasets. All the designs are run for 300 epochs to allow ample time for convergence both during pretraining and finetuning. Batch size of 64 is used.
A latent dimension of five has been chosen for all experiments to facilitate similar model sizes across all baselines and to encourage a compressed latent representation for all datasets. Furthermore, three runs are conducted from which the average is calculated and presented to account for the inherent randomness and variability in the results. During the experiments, each dataset is split vertically and uniformly to mimic a VFL environment. Moreover, the numerical features of the datasets are preprocessed using standard scaling. Binary features and class labels are label encoded, while the categorical features are one-hot encoded.
</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Evaluation Pipeline</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">An evaluation pipeline has been devised to evaluate the effectiveness of the generated latent representation of each design. The pipeline is shown in <a href="#S5.F4" title="Figure 4 ‣ V-A Experiment Details ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 4</span></a>. The full dataset is preprocessed and split into training, validation and test sets with a ratio of 70%-15%-15% respectively. The training set is used as input for both pretraining and finetuning in each experiment design. The validation set is used for the early stopping mechanism that we employ during training. A patience value is used as the maximum count of how many iterations to wait for the validation score to improve. The early stopping feature is implemented as a regularization method to prevent overfitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. The training is stopped when the maximum amount of epochs is reached or when the patience value is reached. After training completion, the training, validation and test sets are combined and processed by the TabNet finetuning model to generate the total latent set from the encoder. The set is then split into a training and test set with ratios 70%-30%, respectively, using random shuffling to generate the latent train and test sets. The latent train set is used to train six classic machine learning algorithms: logistic regression, decision tree, random forest tree, multi-layer perceptron (MLP), XGBoost and linear support vector machine (Linear SVM).
The performance, and hence the quality of the generated latent data, of each algorithm is evaluated on the latent test set using the conventional classification metrics: accuracy, F1-score, and the area under the curve of the receiver operating characteristic curve (ROC-AUC). For each experiment run, the mean of the metric results of each algorithm are reported.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.2.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S5.T2.3.2" class="ltx_text" style="font-size:90%;">Metadata of the datasets used for the experiments.</span></figcaption>
<div id="S5.T2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:111pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(5.9pt,-1.5pt) scale(1.02785322322582,1.02785322322582) ;">
<table id="S5.T2.4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.4.1.1.1" class="ltx_tr">
<th id="S5.T2.4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Dataset</th>
<th id="S5.T2.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">#Samples</th>
<th id="S5.T2.4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">#Classes</th>
<th id="S5.T2.4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">#Categorical</th>
<th id="S5.T2.4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">#Numerical</th>
<th id="S5.T2.4.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">#Binary</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.4.1.2.1" class="ltx_tr">
<td id="S5.T2.4.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Intrusion</td>
<td id="S5.T2.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">50,000</td>
<td id="S5.T2.4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S5.T2.4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">11</td>
<td id="S5.T2.4.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">23</td>
<td id="S5.T2.4.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">4</td>
</tr>
<tr id="S5.T2.4.1.3.2" class="ltx_tr">
<td id="S5.T2.4.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Rice MSC</td>
<td id="S5.T2.4.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">50,000</td>
<td id="S5.T2.4.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">5</td>
<td id="S5.T2.4.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0</td>
<td id="S5.T2.4.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">106</td>
<td id="S5.T2.4.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0</td>
</tr>
<tr id="S5.T2.4.1.4.3" class="ltx_tr">
<td id="S5.T2.4.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Air Passenger Satisfaction</td>
<td id="S5.T2.4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">50,000</td>
<td id="S5.T2.4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S5.T2.4.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">15</td>
<td id="S5.T2.4.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">4</td>
<td id="S5.T2.4.1.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">3</td>
</tr>
<tr id="S5.T2.4.1.5.4" class="ltx_tr">
<td id="S5.T2.4.1.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Forest Cover Type</td>
<td id="S5.T2.4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">50,000</td>
<td id="S5.T2.4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">7</td>
<td id="S5.T2.4.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">44</td>
<td id="S5.T2.4.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">10</td>
<td id="S5.T2.4.1.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0</td>
</tr>
<tr id="S5.T2.4.1.6.5" class="ltx_tr">
<td id="S5.T2.4.1.6.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Bank Marketing</td>
<td id="S5.T2.4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">45,211</td>
<td id="S5.T2.4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">2</td>
<td id="S5.T2.4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">6</td>
<td id="S5.T2.4.1.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">7</td>
<td id="S5.T2.4.1.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">3</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.2.1.1" class="ltx_text" style="font-size:90%;">TABLE III</span>: </span><span id="S5.T3.3.2" class="ltx_text" style="font-size:90%;">Average evaluation metric results of the six predictors for each latent dimension tested. The results are noted per design. Only F1-scores are included due to lack of space.</span></figcaption>
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.4.1.1" class="ltx_tr">
<th id="S5.T3.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_ll ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T3.4.1.1.1.1" class="ltx_text">Dataset</span></th>
<th id="S5.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3">CT</th>
<th id="S5.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3">LT</th>
<th id="S5.T3.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3">TabVFL-LE</th>
<th id="S5.T3.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_rr ltx_border_t" colspan="3">TabVFL</th>
</tr>
<tr id="S5.T3.4.2.2" class="ltx_tr">
<th id="S5.T3.4.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">16</th>
<th id="S5.T3.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">32</th>
<th id="S5.T3.4.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">64</th>
<th id="S5.T3.4.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">16</th>
<th id="S5.T3.4.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">32</th>
<th id="S5.T3.4.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">64</th>
<th id="S5.T3.4.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">16</th>
<th id="S5.T3.4.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">32</th>
<th id="S5.T3.4.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">64</th>
<th id="S5.T3.4.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">16</th>
<th id="S5.T3.4.2.2.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">32</th>
<th id="S5.T3.4.2.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_rr ltx_border_t">64</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.4.3.1" class="ltx_tr">
<td id="S5.T3.4.3.1.1" class="ltx_td ltx_align_center ltx_border_ll ltx_border_r ltx_border_t">Intrusion</td>
<td id="S5.T3.4.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.996</td>
<td id="S5.T3.4.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.993</td>
<td id="S5.T3.4.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.996</td>
<td id="S5.T3.4.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.919</td>
<td id="S5.T3.4.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.982</td>
<td id="S5.T3.4.3.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.989</td>
<td id="S5.T3.4.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.85</td>
<td id="S5.T3.4.3.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.992</td>
<td id="S5.T3.4.3.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.947</td>
<td id="S5.T3.4.3.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.995</td>
<td id="S5.T3.4.3.1.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.993</td>
<td id="S5.T3.4.3.1.13" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">0.995</td>
</tr>
<tr id="S5.T3.4.4.2" class="ltx_tr">
<td id="S5.T3.4.4.2.1" class="ltx_td ltx_align_center ltx_border_ll ltx_border_r ltx_border_t">Rice MSC</td>
<td id="S5.T3.4.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.999</td>
<td id="S5.T3.4.4.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.994</td>
<td id="S5.T3.4.4.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.996</td>
<td id="S5.T3.4.4.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.997</td>
<td id="S5.T3.4.4.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.999</td>
<td id="S5.T3.4.4.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.998</td>
<td id="S5.T3.4.4.2.13" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">0.999</td>
</tr>
<tr id="S5.T3.4.5.3" class="ltx_tr">
<td id="S5.T3.4.5.3.1" class="ltx_td ltx_align_center ltx_border_ll ltx_border_r ltx_border_t">Bank Marketing</td>
<td id="S5.T3.4.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.895</td>
<td id="S5.T3.4.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.895</td>
<td id="S5.T3.4.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.887</td>
<td id="S5.T3.4.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.859</td>
<td id="S5.T3.4.5.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.876</td>
<td id="S5.T3.4.5.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.882</td>
<td id="S5.T3.4.5.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.888</td>
<td id="S5.T3.4.5.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.888</td>
<td id="S5.T3.4.5.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.887</td>
<td id="S5.T3.4.5.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.888</td>
<td id="S5.T3.4.5.3.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.888</td>
<td id="S5.T3.4.5.3.13" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">0.887</td>
</tr>
<tr id="S5.T3.4.6.4" class="ltx_tr">
<td id="S5.T3.4.6.4.1" class="ltx_td ltx_align_center ltx_border_ll ltx_border_r ltx_border_t">Forest Cover Type</td>
<td id="S5.T3.4.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.772</td>
<td id="S5.T3.4.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.792</td>
<td id="S5.T3.4.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.78</td>
<td id="S5.T3.4.6.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.636</td>
<td id="S5.T3.4.6.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.635</td>
<td id="S5.T3.4.6.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.7</td>
<td id="S5.T3.4.6.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.76</td>
<td id="S5.T3.4.6.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.771</td>
<td id="S5.T3.4.6.4.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.78</td>
<td id="S5.T3.4.6.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.772</td>
<td id="S5.T3.4.6.4.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.785</td>
<td id="S5.T3.4.6.4.13" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">0.78</td>
</tr>
<tr id="S5.T3.4.7.5" class="ltx_tr">
<td id="S5.T3.4.7.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_ll ltx_border_r ltx_border_t">Air Passenger Satisfaction</td>
<td id="S5.T3.4.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.952</td>
<td id="S5.T3.4.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.957</td>
<td id="S5.T3.4.7.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.957</td>
<td id="S5.T3.4.7.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.85</td>
<td id="S5.T3.4.7.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.897</td>
<td id="S5.T3.4.7.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.919</td>
<td id="S5.T3.4.7.5.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.943</td>
<td id="S5.T3.4.7.5.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.944</td>
<td id="S5.T3.4.7.5.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.946</td>
<td id="S5.T3.4.7.5.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.952</td>
<td id="S5.T3.4.7.5.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.956</td>
<td id="S5.T3.4.7.5.13" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr ltx_border_t">0.957</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Result Analysis</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">The experiment setup described thus far holds in any experiment unless stated otherwise. Our experiments are designed to answer the following three research questions:
</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">How does the <span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">latent quality</span> produced by TabVFL compare to that of the baselines, and to what extent is it superior?</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">To what extent is the performance affected of each design if the <span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">latent dimension</span> is varied?</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">How does the <span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">robustness</span> of the cached and zero intermediate results differ in TabVFL against random client failures?</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">How efficient is TabVFL in terms of runtime, network consumption and memory usage compared to the baselines?
</p>
</div>
</li>
</ul>
<p id="S5.SS3.p1.2" class="ltx_p">The questions are answered by conducting three experiments. The first experiment is to evaluate the quality of the latent representation of each design using the classification metrics. The influence of different latent dimensions on the performance is evaluated in the second experiment. To answer the third question, an experiment with different failure probability of each client is devised to compare the cache method for client failure handling with existing zero vector method in the literature.
The amount of guest clients for the first, second and last experiments is fixed to five clients, aligning with established setting in previous research <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. The setup of the third experiment consists of one host and two guest clients to adhere to the common two-client setup in VFL  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. For the third experiment setup, each method runs for 120 epochs in total with batch size of 128.
For the fourth experiment, we set the batch size to 512 and amount of epochs for both training phases to 100.
Early stopping mechanism is disabled in the third and fourth for fair comparison and measurements.</p>
</div>
<section id="S5.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS3.SSS1.5.1.1" class="ltx_text">V-C</span>1 </span><span id="S5.SS3.SSS1.6.2" class="ltx_text ltx_font_bold">Latent Quality Experiment</span>
</h4>

<div id="S5.SS3.SSS1.p1" class="ltx_para">
<p id="S5.SS3.SSS1.p1.1" class="ltx_p">Evaluating a design’s capability to learn high-quality latent representations offers valuable insights into how effective TabVFL is able to effectively capture underlying feature correlations compared to the baseline.
The results linked to this experiment are presented in <a href="#S5.F5" title="Figure 5 ‣ V-A Experiment Details ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 5</span></a> as histograms. Generally, CT always outperforms the baseline as expected since it possesses all the data locally.</p>
</div>
<div id="S5.SS3.SSS1.p2" class="ltx_para">
<p id="S5.SS3.SSS1.p2.1" class="ltx_p">Furthermore, TabVFL clearly performs better than the prior work design (LT) for all the classification datasets. In terms of accuracy, f1-score and roc-auc TabVFL can perform up to 22.34%, 26.12% and 19.41% better than LT respectively. This suggests that TabVFL is able to capture the underlying feature correlations which leads to the generation of better latent representations of the features. A dataset where LT was able to perform well and approach evaluation results almost similar to other designs is the intrusion dataset. This could be attributed by the simplicity of the underlying patterns of the dataset which results in high performance for most of the tested designs. Although TabVFL-LE has lower accuracy and f1-score compared to LT, it still managed to be better in terms of ROC-AUC score. This means that TabVFL-LE is better at discriminating between negative and positive classes (in the multiclass sense) compared to LT.
</p>
</div>
<div id="S5.SS3.SSS1.p3" class="ltx_para">
<p id="S5.SS3.SSS1.p3.1" class="ltx_p">In addition, LT shows the biggest discrepancies in performance for the forest and air datasets compared to TabVFL. A possible reason is that both datasets have a varying amounts of correlated features at different placements compared to other datasets.
LT fails to capture general patterns in such datasets because local pretraining may result in guest clients learning entirely distinct latent representations, introducing potential biases.
This could steer the finetuning model to converge at a suboptimal minima during training, leading to added noise to the latent space, therefore failing to capture common and relevant latent patterns of features scattered among clients.
</p>
</div>
<figure id="S5.F6" class="ltx_figure ltx_align_center"><img src="/html/2404.17990/assets/x8.png" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="332" height="74" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.4.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.5.2" class="ltx_text" style="font-size:90%;">Result over different client failure probabilities <span id="S5.F6.5.2.1" class="ltx_text ltx_font_bold ltx_font_italic">p</span> on different datasets.</span></figcaption>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T4.3.1.1" class="ltx_text" style="font-size:90%;">TABLE IV</span>: </span><span id="S5.T4.4.2" class="ltx_text" style="font-size:90%;">Client failures experiment improvements of cache method compared to zeros method and maximum performance decrease of both method compared to baseline. All values are presented in percentages. Best results are highlighted in <span id="S5.T4.4.2.1" class="ltx_text ltx_font_bold">bold</span>.</span></figcaption>
<div id="S5.T4.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:190.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(18.5pt,-8.1pt) scale(1.09315829190353,1.09315829190353) ;">
<table id="S5.T4.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.5.1.1.1" class="ltx_tr">
<th id="S5.T4.5.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" rowspan="2">
<span id="S5.T4.5.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.1.1.1.1.1" class="ltx_p" style="width:110.0pt;"><span id="S5.T4.5.1.1.1.1.1.1.1" class="ltx_text">Dataset</span></span>
</span>
</th>
<th id="S5.T4.5.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">Cache Method</th>
<th id="S5.T4.5.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.1.1.3.1.1" class="ltx_p" style="width:60.0pt;">Maximum Performance Decrease Zeros Method</span>
</span>
</th>
<th id="S5.T4.5.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.1.1.4.1.1" class="ltx_p" style="width:60.0pt;">Maximum Performance Decrease Cache Method</span>
</span>
</th>
</tr>
<tr id="S5.T4.5.1.2.2" class="ltx_tr">
<td id="S5.T4.5.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.2.2.1.1.1" class="ltx_p" style="width:50.0pt;">Average Improvement</span>
</span>
</td>
<td id="S5.T4.5.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.2.2.2.1.1" class="ltx_p" style="width:50.0pt;">Maximum Improvement</span>
</span>
</td>
<td id="S5.T4.5.1.2.2.3" class="ltx_td ltx_align_top ltx_border_r"></td>
<td id="S5.T4.5.1.2.2.4" class="ltx_td ltx_align_top ltx_border_r"></td>
</tr>
<tr id="S5.T4.5.1.3.3" class="ltx_tr">
<td id="S5.T4.5.1.3.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.3.3.1.1.1" class="ltx_p" style="width:110.0pt;">Intrusion</span>
</span>
</td>
<td id="S5.T4.5.1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.3.3.2.1.1" class="ltx_p" style="width:50.0pt;">2.3</span>
</span>
</td>
<td id="S5.T4.5.1.3.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.3.3.3.1.1" class="ltx_p" style="width:50.0pt;">4.37</span>
</span>
</td>
<td id="S5.T4.5.1.3.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.3.3.4.1.1" class="ltx_p" style="width:60.0pt;">-4.78</span>
</span>
</td>
<td id="S5.T4.5.1.3.3.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.3.3.5.1.1" class="ltx_p" style="width:60.0pt;"><span id="S5.T4.5.1.3.3.5.1.1.1" class="ltx_text ltx_font_bold">-0.22</span></span>
</span>
</td>
</tr>
<tr id="S5.T4.5.1.4.4" class="ltx_tr">
<td id="S5.T4.5.1.4.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.4.4.1.1.1" class="ltx_p" style="width:110.0pt;">Rice MSC</span>
</span>
</td>
<td id="S5.T4.5.1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.4.4.2.1.1" class="ltx_p" style="width:50.0pt;">3.91</span>
</span>
</td>
<td id="S5.T4.5.1.4.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.4.4.3.1.1" class="ltx_p" style="width:50.0pt;">9.49</span>
</span>
</td>
<td id="S5.T4.5.1.4.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.4.4.4.1.1" class="ltx_p" style="width:60.0pt;">-10.85</span>
</span>
</td>
<td id="S5.T4.5.1.4.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.4.4.5.1.1" class="ltx_p" style="width:60.0pt;">-0.32</span>
</span>
</td>
</tr>
<tr id="S5.T4.5.1.5.5" class="ltx_tr">
<td id="S5.T4.5.1.5.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.5.5.1.1.1" class="ltx_p" style="width:110.0pt;">Bank Marketing</span>
</span>
</td>
<td id="S5.T4.5.1.5.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.5.5.2.1.1" class="ltx_p" style="width:50.0pt;">1.51</span>
</span>
</td>
<td id="S5.T4.5.1.5.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.5.5.3.1.1" class="ltx_p" style="width:50.0pt;">2.04</span>
</span>
</td>
<td id="S5.T4.5.1.5.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.5.5.4.1.1" class="ltx_p" style="width:60.0pt;"><span id="S5.T4.5.1.5.5.4.1.1.1" class="ltx_text ltx_font_bold">-2.71</span></span>
</span>
</td>
<td id="S5.T4.5.1.5.5.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.5.5.5.1.1" class="ltx_p" style="width:60.0pt;">-0.65</span>
</span>
</td>
</tr>
<tr id="S5.T4.5.1.6.6" class="ltx_tr">
<td id="S5.T4.5.1.6.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.6.6.1.1.1" class="ltx_p" style="width:110.0pt;">Forest Cover Type</span>
</span>
</td>
<td id="S5.T4.5.1.6.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.6.6.2.1.1" class="ltx_p" style="width:50.0pt;"><span id="S5.T4.5.1.6.6.2.1.1.1" class="ltx_text ltx_font_bold">9.15</span></span>
</span>
</td>
<td id="S5.T4.5.1.6.6.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.6.6.3.1.1" class="ltx_p" style="width:50.0pt;"><span id="S5.T4.5.1.6.6.3.1.1.1" class="ltx_text ltx_font_bold">13.16</span></span>
</span>
</td>
<td id="S5.T4.5.1.6.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.6.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.6.6.4.1.1" class="ltx_p" style="width:60.0pt;">-17.59</span>
</span>
</td>
<td id="S5.T4.5.1.6.6.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.6.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.6.6.5.1.1" class="ltx_p" style="width:60.0pt;">-2.11</span>
</span>
</td>
</tr>
<tr id="S5.T4.5.1.7.7" class="ltx_tr">
<td id="S5.T4.5.1.7.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.7.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.7.7.1.1.1" class="ltx_p" style="width:110.0pt;">Air Passenger Satisfaction</span>
</span>
</td>
<td id="S5.T4.5.1.7.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.7.7.2.1.1" class="ltx_p" style="width:50.0pt;">6.31</span>
</span>
</td>
<td id="S5.T4.5.1.7.7.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.7.7.3.1.1" class="ltx_p" style="width:50.0pt;">12.73</span>
</span>
</td>
<td id="S5.T4.5.1.7.7.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.7.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.7.7.4.1.1" class="ltx_p" style="width:60.0pt;">-18.04</span>
</span>
</td>
<td id="S5.T4.5.1.7.7.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T4.5.1.7.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T4.5.1.7.7.5.1.1" class="ltx_p" style="width:60.0pt;">-3.01</span>
</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS3.SSS2.5.1.1" class="ltx_text">V-C</span>2 </span><span id="S5.SS3.SSS2.6.2" class="ltx_text ltx_font_bold">Differing Latent Dimensions Experiment</span>
</h4>

<div id="S5.SS3.SSS2.p1" class="ltx_para">
<p id="S5.SS3.SSS2.p1.1" class="ltx_p">To acquire a comprehensive insight of the performance, we also tested how each design performs for varying latent dimensions. The corresponding results are presented in <a href="#S5.T3" title="TABLE III ‣ V-B Evaluation Pipeline ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Tab. III</span></a>. The setup is identical to the one described in <a href="#S5.SS1" title="V-A Experiment Details ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Sec. <span class="ltx_text">V-A</span></span></a>. We use the latent dimensions 16, 32 and 64 for each design to sufficiently test the effect of small and large values. The CT design shows somewhat of a stable performance. LT on the other hand shows an increasing trend in relation with the increasing latent dimension. This is contributed by the larger latent dimension assigned to each client, allowing for an enriched representation of the local data. Furthermore, TabVFL-LE also demonstrates a positive trend in terms of performance for the majority of the datasets while exhibiting stable performance on others. Moreover, TabVFL shows similar performance as CT where the performance is stable on most datasets regardless of the latent dimension. Nevertheless, LT still underperforms when compared to TabVFL and the other baselines on most if not all the datasets. The results indicate that TabVFL is robust against latent dimension changes compared to LT and can hence be applied in scenarios where stable performance is essential regardless of the latent dimension being used.
</p>
</div>
</section>
<section id="S5.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS3.SSS3.5.1.1" class="ltx_text">V-C</span>3 </span><span id="S5.SS3.SSS3.6.2" class="ltx_text ltx_font_bold">Client Failures Experiment</span>
</h4>

<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T5.2.1.1" class="ltx_text" style="font-size:90%;">TABLE V</span>: </span><span id="S5.T5.3.2" class="ltx_text" style="font-size:90%;">System performance evaluation result. The pretraining and finetuning runtimes on rice dataset are presented including the network consumption and memory usage.</span></figcaption>
<div id="S5.T5.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:189.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(29.0pt,-12.7pt) scale(1.15426667356629,1.15426667356629) ;">
<table id="S5.T5.4.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.4.1.1.1" class="ltx_tr">
<td id="S5.T5.4.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.1.1.1" class="ltx_p" style="width:50.0pt;">Design</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.2.1.1" class="ltx_p" style="width:40.0pt;">Pretraining</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.3.1.1" class="ltx_p" style="width:40.0pt;">Finetuning</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_rr ltx_border_t">
<span id="S5.T5.4.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.4.1.1" class="ltx_p" style="width:35.0pt;">Total Training</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.5.1.1" class="ltx_p" style="width:40.0pt;">Pretraining Network</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.6.1.1" class="ltx_p" style="width:40.0pt;">Finetuning Network</span>
</span>
</td>
<td id="S5.T5.4.1.1.1.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.1.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.1.1.7.1.1" class="ltx_p" style="width:40.0pt;">Memory</span>
</span>
</td>
</tr>
<tr id="S5.T5.4.1.2.2" class="ltx_tr">
<td id="S5.T5.4.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.1.1.1" class="ltx_p" style="width:50.0pt;">CT</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.2.1.1" class="ltx_p" style="width:40.0pt;"><span id="S5.T5.4.1.2.2.2.1.1.1" class="ltx_text ltx_font_bold">151</span> s</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.3.1.1" class="ltx_p" style="width:40.0pt;"><span id="S5.T5.4.1.2.2.3.1.1.1" class="ltx_text ltx_font_bold">116</span> s</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_rr ltx_border_t">
<span id="S5.T5.4.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.4.1.1" class="ltx_p" style="width:35.0pt;"><span id="S5.T5.4.1.2.2.4.1.1.1" class="ltx_text ltx_font_bold">267</span> s</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.5.1.1" class="ltx_p" style="width:40.0pt;">-</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.6.1.1" class="ltx_p" style="width:40.0pt;">-</span>
</span>
</td>
<td id="S5.T5.4.1.2.2.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.2.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.2.2.7.1.1" class="ltx_p" style="width:40.0pt;"><span id="S5.T5.4.1.2.2.7.1.1.1" class="ltx_text ltx_font_bold">2.75</span> GB</span>
</span>
</td>
</tr>
<tr id="S5.T5.4.1.3.3" class="ltx_tr">
<td id="S5.T5.4.1.3.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.1.1.1" class="ltx_p" style="width:50.0pt;">LT</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.2.1.1" class="ltx_p" style="width:40.0pt;">244 s</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.3.1.1" class="ltx_p" style="width:40.0pt;">187 s</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_rr ltx_border_t">
<span id="S5.T5.4.1.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.4.1.1" class="ltx_p" style="width:35.0pt;">431 s</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.5.1.1" class="ltx_p" style="width:40.0pt;">-</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.6.1.1" class="ltx_p" style="width:40.0pt;"><span id="S5.T5.4.1.3.3.6.1.1.1" class="ltx_text ltx_font_bold">0.7</span> MB</span>
</span>
</td>
<td id="S5.T5.4.1.3.3.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.3.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.3.3.7.1.1" class="ltx_p" style="width:40.0pt;">15.12 GB</span>
</span>
</td>
</tr>
<tr id="S5.T5.4.1.4.4" class="ltx_tr">
<td id="S5.T5.4.1.4.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.1.1.1" class="ltx_p" style="width:50.0pt;">TabVFL-LE</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.2.1.1" class="ltx_p" style="width:40.0pt;">252 s</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.3.1.1" class="ltx_p" style="width:40.0pt;">204 s</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_rr ltx_border_t">
<span id="S5.T5.4.1.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.4.1.1" class="ltx_p" style="width:35.0pt;">456 s</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.5.1.1" class="ltx_p" style="width:40.0pt;"><span id="S5.T5.4.1.4.4.5.1.1.1" class="ltx_text ltx_font_bold">14.7</span> MB</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.6.1.1" class="ltx_p" style="width:40.0pt;">3.5 MB</span>
</span>
</td>
<td id="S5.T5.4.1.4.4.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.4.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.4.4.7.1.1" class="ltx_p" style="width:40.0pt;">14.73 GB</span>
</span>
</td>
</tr>
<tr id="S5.T5.4.1.5.5" class="ltx_tr">
<td id="S5.T5.4.1.5.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.1.1.1" class="ltx_p" style="width:50.0pt;">TabVFL</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.2.1.1" class="ltx_p" style="width:40.0pt;">194 s</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.3.1.1" class="ltx_p" style="width:40.0pt;">138 s</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_rr ltx_border_t">
<span id="S5.T5.4.1.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.4.1.1" class="ltx_p" style="width:35.0pt;">332 s</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.5.1.1" class="ltx_p" style="width:40.0pt;">30.38 MB</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.6.1.1" class="ltx_p" style="width:40.0pt;">14.84 MB</span>
</span>
</td>
<td id="S5.T5.4.1.5.5.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T5.4.1.5.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T5.4.1.5.5.7.1.1" class="ltx_p" style="width:40.0pt;">14.73 GB</span>
</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.SS3.SSS3.p1" class="ltx_para">
<p id="S5.SS3.SSS3.p1.1" class="ltx_p">In this study, we contrast the caching method for intermediate results (<a href="#S4.SS5" title="IV-E Client Failure Handling ‣ IV Methodology ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Sec. <span class="ltx_text">IV-E</span></span></a>) with the zero intermediate results method from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> in handling client failures. The zero method compensates for missing client results with zero values. Client failure probabilities ranged from 0.2 to 0.5 in 0.15 steps. We also ran a baseline test without client failure handling. Only the f1-score, illustrating client failure impact, is reported and can be seen in <a href="#S5.F6" title="Figure 6 ‣ V-C1 Latent Quality Experiment ‣ V-C Result Analysis ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Fig. 6</span></a>.</p>
</div>
<div id="S5.SS3.SSS3.p2" class="ltx_para">
<p id="S5.SS3.SSS3.p2.1" class="ltx_p">The dashed blue line represents the baseline without any client failures. The displayed f1-scores are eight-run averages for each probability (<span id="S5.SS3.SSS3.p2.1.1" class="ltx_text ltx_font_bold">p</span>) value. As the client failure probability <span id="S5.SS3.SSS3.p2.1.2" class="ltx_text ltx_font_bold">p</span> increases, the f1-score drops for both methods due to compensating missing results with outdated ones, resulting in suboptimal performance. Yet, cache method shows a more stable and less drastic decline than the zero method. Comparing to zero method, the cache method showed its best average and maximum improvements of 9.15% and 13.16%, respectively, on the forest dataset. In contrast, its worst performance was a 3.01% decline with the air dataset, whereas the zeros method dropped by 18.04% on the same dataset. The minimal performance decline was 0.22% for the cache method on intrusion dataset and 2.71% for the zeros method on bank dataset. The complete results can be found in <a href="#S5.T4" title="TABLE IV ‣ V-C1 Latent Quality Experiment ‣ V-C Result Analysis ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Tab. IV</span></a>.</p>
</div>
<div id="S5.SS3.SSS3.p3" class="ltx_para">
<p id="S5.SS3.SSS3.p3.1" class="ltx_p">Remarkably, the cache method matched the baseline for the rice dataset at <span id="S5.SS3.SSS3.p3.1.1" class="ltx_text ltx_font_italic">p=0.2</span>, likely due to the dataset’s simplicity. Furthermore, caching consistently outperformed the zero method, suggesting higher performance even with client dropouts, by using more realistic intermediate results instead of zeros. Zero vectors might introduce learning biases, producing non-existent patterns. The zero method’s declining performance, especially with higher client failure probabilities, contrasts with the cache method’s steadier results across datasets. By using the latest intermediate results, the cache method maintains some relevant data representations. However, as seen with the air dataset, performance might drop, influenced by the dataset complexity and the staleness of cached data.</p>
</div>
</section>
<section id="S5.SS3.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS3.SSS4.5.1.1" class="ltx_text">V-C</span>4 </span><span id="S5.SS3.SSS4.6.2" class="ltx_text ltx_font_bold">Framework Efficiency and Resource Consumption Analysis</span>
</h4>

<div id="S5.SS3.SSS4.p1" class="ltx_para">
<p id="S5.SS3.SSS4.p1.1" class="ltx_p">In this section, we measure and display key performance metrics for common VFL systems, including runtime, network consumption, and memory usage for the TabVFL, LT, and TabVFL-LE. For the centralized model, we exclude network consumption as it is not federated. For LT, as pretraining occurs locally at each guest client, we choose the client with the longest runtime as its representative. No communication means no pretraining network consumption for LT. The results are presented in <a href="#S5.T5" title="TABLE V ‣ V-C3 Client Failures Experiment ‣ V-C Result Analysis ‣ V Performance Evaluation ‣ TabVFL: Improving Latent Representation in Vertical Federated Learning" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Tab. V</span></a>. Training phase network consumption is gauged using a 4096 batch size for one iteration of each design.</p>
</div>
<div id="S5.SS3.SSS4.p2" class="ltx_para">
<p id="S5.SS3.SSS4.p2.1" class="ltx_p">We base our efficiency assessment on the rice dataset, which has the most data columns in our evaluations, making its results indicative. TabVFL achieves the fastest runtime, being 29.75% quicker than LT and 38.04% faster than TabVFL-LE. TabVFL-LE’s slower pace is due to its aggregation phase requiring iterative summation for each decision step. LT’s delay stems from the entire TabNet model pretraining at each guest client.</p>
</div>
<div id="S5.SS3.SSS4.p3" class="ltx_para">
<p id="S5.SS3.SSS4.p3.1" class="ltx_p">In terms of network consumption during pretraining, TabVFL-LE uses less than TabVFL since it transmits outputs (i.e., the latent representation) with a consistent, smaller dimension compared to TabVFL’s output dimension (i.e., the same dimension as input data). For finetuning, LT is most efficient as each guest uses only a fifth of the total latent dimension, reducing network consumption significantly.
</p>
</div>
<div id="S5.SS3.SSS4.p4" class="ltx_para">
<p id="S5.SS3.SSS4.p4.1" class="ltx_p">Memory-wise, CT consumes the least, whereas LT uses the most. Although TabVFL-LE guest clients employ TabNet encoders, they have similar memory usage to TabVFL because TabVFL’s total input dimension equals the combined local input of all TabVFL-LE guest clients.
</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we present a novel distributed framework TabVFL that integrates the state-of-the-art tabular model TabNet to improve latent representation learning on tabular data in the context of vertical federated learning (VFL). To protect against direct data leakage, TabVFL employs a fully-connected layer to preserve data privacy. This is due to the risk of direct data leakage from integrating TabNet as is in VFL. TabVFL consolidates intermediate results from all parties in order to learn a single latent respresentation, capturing underlying feature correlations. The framework also addresses the client failures by caching intermediate results. Comprehensive experiments across five datasets illustrate remarkable improvement up to 26.12% on f1-score in latent quality by TabVFL, surpassing baseline designs.
TabVFL demonstrates superior performance in terms of runtime and memory usage, yet encounters reasonable communication overhead when compared to the baselines. </p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
D. E. Rumelhart and J. L. McClelland, “Parallel distributed processing: explorations in the microstructure of cognition, vol. 1: foundations,” 1986. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:15291527" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:15291527</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert: Pre-training of deep bidirectional transformers for language understanding,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">North American Chapter of the Association for Computational Linguistics</em>, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:52967399" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:52967399</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
G. E. Hinton, L. Deng, D. Yu, G. E. Dahl, A. rahman Mohamed, N. Jaitly, A. W. Senior, V. Vanhoucke, P. Nguyen, T. N. Sainath, and B. Kingsbury, “Deep neural networks for acoustic modeling in speech recognition,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, vol. 29, p. 82, 2012. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:7230302" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:7230302</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Krizhevsky, I. Sutskever, and G. E. Hinton, “Imagenet classification with deep convolutional neural networks,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, vol. 60, pp. 84 – 90, 2012. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:195908774" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:195908774</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Chen and C. Guestrin, “Xgboost: A scalable tree boosting system,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
G. Ke, Q. Meng, T. Finley, T. Wang, W. Chen, W. Ma, Q. Ye, and T.-Y. Liu, “Lightgbm: A highly efficient gradient boosting decision tree,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Ostroumova, G. Gusev, A. Vorobev, A. V. Dorogush, and A. Gulin, “Catboost: unbiased boosting with categorical features,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Ö. Arik and T. Pfister, “Tabnet: Attentive interpretable tabular learning,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1908.07442, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Yang, B. Ren, X. Zhou, and L. Liu, “Parallel distributed logistic regression for vertical federated learning without third-party coordinator,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1911.09824, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:208248396" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:208248396</a>

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
L. Xia, P. Zheng, J. Li, W. Tang, and X. Zhang, “Privacy-preserving gradient boosting tree: Vertical federated learning for collaborative bearing fault diagnosis,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IET Collaborative Intelligent Manufacturing</em>, vol. 4, no. 3, pp. 208–219, 2022. [Online]. Available: <a target="_blank" href="https://ietresearch.onlinelibrary.wiley.com/doi/abs/10.1049/cim2.12057" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ietresearch.onlinelibrary.wiley.com/doi/abs/10.1049/cim2.12057</a>

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
D. Cha, M. Sung, and Y. R. Park, “Implementing vertical federated learning using autoencoders: Practical application, generalizability, and utility study,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">JMIR Medical Informatics</em>, vol. 9, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
K.-F. Chu and L. Zhang, “Privacy-preserving self-taught federated learning for heterogeneous data,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2102.05883, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Khan, M. ten Thij, and A. Wilbik, “Communication-efficient vertical federated learning,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Algorithms</em>, vol. 15, p. 273, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
M. G. Poirot, P. Vepakomma, K. Chang, J. Kalpathy-Cramer, R. Gupta, and R. Raskar, “Split learning for collaborative deep learning in healthcare,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1912.12115, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
P. Vepakomma, O. Gupta, T. Swedish, and R. Raskar, “Split learning for health: Distributed deep learning without sharing raw patient data,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1812.00564, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
F. Ang, L. Chen, N. Zhao, Y. Chen, W. Wang, and F. R. Yu, “Robust federated learning with noisy communication,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Communications</em>, vol. 68, pp. 3452–3464, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:207870310" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:207870310</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Q. Chen, Z. Wang, Y. Zhou, J. Chen, D. Xiao, and X. Lin, “Cfl: Cluster federated learning in large-scale peer-to-peer networks,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Information Security Conference</em>, 2022. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:250312010" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:250312010</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
I. Ceballos, V. Sharma, E. Mugica, A. Singh, A. Roman, P. Vepakomma, and R. Raskar, “Splitnn-driven vertical partitioning,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2008.04137, 2020. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:221090598" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:221090598</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
J. Sun, Z. Du, A. C. Dai, S. Baghersalimi, A. J. Amirshahi, D. Atienza, and Y. Chen, “Robust and ip-protecting vertical federated learning against unexpected quitting of parties,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2303.18178, 2023. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:257900954" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:257900954</a>

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Chen, K. Laine, and P. Rindal, “Fast private set intersection from homomorphic encryption,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security</em>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
L. Lu and N. Ding, “Multi-party private set intersection in vertical federated learning,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2020 IEEE 19th International Conference on Trust, Security and Privacy in Computing and Communications (TrustCom)</em>, pp. 707–714, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
N. Angelou, A. Benaissa, B. Cebere, W. Clark, A. J. Hall, M. A. Hoeh, D. Liu, P. Papadopoulos, R. Roehm, R. Sandmann, P. Schoppmann, and T. Titcombe, “Asymmetric private set intersection with applications to contact tracing and private vertical federated machine learning,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2011.09350, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Z. Mao, H. Li, Z. Huang, Y. Tian, P. Zhao, and Y. Li, “Full data-processing power load forecasting based on vertical federated learning,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">J. Electr. Comput. Eng.</em>, vol. 2023, pp. 9 914 169:1–9 914 169:9, 2023.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Wu, S. Cai, X. Xiao, G. Chen, and B. C. Ooi, “Privacy preserving vertical federated learning for tree-based models,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. VLDB Endow.</em>, vol. 13, no. 12, p. 2090–2103, sep 2020. [Online]. Available: <a target="_blank" href="https://doi.org/10.14778/3407790.3407811" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.14778/3407790.3407811</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. Cheng, T. Fan, Y. Jin, Y. Liu, T. Chen, and Q. Yang, “Secureboost: A lossless federated learning framework,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Intelligent Systems</em>, vol. 36, pp. 87–98, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Z. Zhao, H. Wu, A. Van Moorsel, and L. Y. Chen, “Gtv: Generating tabular data via vertical federated learning,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.01706</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
F. Fu, Y. Shao, L. Yu, J. Jiang, H. Xue, Y. Tao, and B. Cui, “Vf2boost: Very fast vertical federated gradient boosting for cross-enterprise learning,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 International Conference on Management of Data</em>, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Liu, Y. Liu, Z. Liu, Y. Liang, C. Meng, J. Zhang, and Y. Zheng, “Federated forest,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Big Data</em>, vol. 8, pp. 843–854, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:165163667" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:165163667</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
H. R. Roth, A. Hatamizadeh, Z. Xu, C. Zhao, W. Li, A. Myronenko, and D. Xu, “Split-u-net: Preventing data leakage in split learning for collaborative multi-modal brain tumor segmentation,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">DeCaF/FAIR@MICCAI</em>, 2022. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:251741520" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:251741520</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
W. Li, Q. Xia, H. Cheng, K. Xue, and S. Xia, “Vertical semi-federated learning for efficient online advertising,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2209.15635, 2022. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:252668523" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:252668523</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
D. Romanini, A. J. Hall, P. Papadopoulos, T. Titcombe, A. Ismail, T. Cebere, R. Sandmann, R. Roehm, and M. A. Hoeh, “Pyvertical: A vertical federated learning framework for multi-headed splitnn,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2104.00489, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Hu, D. Niu, J. Yang, and S. Zhou, “Fdml: A collaborative machine learning framework for distributed features,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:156053162" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:156053162</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Wu, Q. Li, and B. He, “Practical vertical federated learning with unsupervised representation learning,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2208.10278, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
K. Bonawitz, H. Eichner, W. Grieskamp, D. Huba, A. Ingerman, V. Ivanov, C. Kiddon, J. Konecný, S. Mazzocchi, H. B. McMahan, T. V. Overveldt, D. Petrou, D. Ramage, and J. Roselander, “Towards federated learning at scale: System design,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1902.01046, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:59599820" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:59599820</a>

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
C. Yang, Q. Wang, M. Xu, Z. Chen, K. Bian, Y. Liu, and X. Liu, “Characterizing impacts of heterogeneity in federated learning upon large-scale smartphone data,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Web Conference 2021</em>, 2021. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:235324741" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:235324741</a>

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
L. Li, H. Xiong, Z. Guo, J. Wang, and C. Xu, “Smartpc: Hierarchical pace control in real-time federated learning system,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Real-Time Systems Symposium (RTSS)</em>, pp. 406–418, 2019. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:203582658" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:203582658</a>

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
C. Yang, Q. Wang, M. Xu, S. Wang, K. Bian, and X. Liu, “Heterogeneity-aware federated learning,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2006.06983, 2020. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:219636005" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:219636005</a>

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
J. Hou, M. Su, A. Fu, and Y. Yu, “Verifiable privacy-preserving scheme based on vertical federated random forest,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, vol. 9, pp. 22 158–22 172, 2021. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:237905041" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:237905041</a>

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
W. Fang, D. Zhao, J. Tan, C. Chen, C. Yu, L. xilinx Wang, L. Wang, J. Zhou, and B. Zhang, “Large-scale secure xgb for vertical federated learning,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>, 2020. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:237396281" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:237396281</a>

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
F. Fu, H. Xue, Y. Cheng, Y. Tao, and B. Cui, “Blindfl: Vertical federated machine learning without peeking into your data,” <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 International Conference on Management of Data</em>, 2022. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:249578995" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:249578995</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
S. Fischman, “Pytorch implementation of tabnet paper,” <a target="_blank" href="https://github.com/dreamquark-ai/tabnet" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/dreamquark-ai/tabnet</a>, 2019.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
R. Caruana, S. Lawrence, and C. L. Giles, “Overfitting in neural nets: Backpropagation, conjugate gradient, and early stopping,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2000. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:7365231" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:7365231</a>

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
A. Li, H. Peng, L. Zhang, J. Huang, Q.-W. Guo, H. Yu, and Y. Liu, “Fedsdg-fs: Efficient and secure feature selection for vertical federated learning,” <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2023 - IEEE Conference on Computer Communications</em>, pp. 1–10, 2023. [Online]. Available: <a target="_blank" href="https://api.semanticscholar.org/CorpusID:257050801" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:257050801</a>

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.17989" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.17990" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.17990">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.17990" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.17991" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 15:00:44 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
