<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2304.00160] Secure Federated Learning against Model Poisoning Attacks via Client Filtering</title><meta property="og:description" content="Given the distributed nature, detecting and defending against the backdoor attack under federated learning (FL) systems is challenging. In this paper,
we observe that the cosine similarity of the last layer’s weight be…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Secure Federated Learning against Model Poisoning Attacks via Client Filtering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Secure Federated Learning against Model Poisoning Attacks via Client Filtering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2304.00160">

<!--Generated on Thu Feb 29 16:04:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotetext: </span>The first two authors contributed equally.</span></span></span>
<h1 class="ltx_title ltx_title_document">Secure Federated Learning against Model Poisoning Attacks via Client Filtering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Duygu Nur Yaldiz<math id="id1.1.m1.1" class="ltx_Math" alttext="\phantom{}{}^{*}" display="inline"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><times id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\phantom{}{}^{*}</annotation></semantics></math>
, Tuo Zhang<math id="id2.2.m2.1" class="ltx_Math" alttext="\phantom{}{}^{*}" display="inline"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mi id="id2.2.m2.1.1a" xref="id2.2.m2.1.1.cmml"></mi><mo id="id2.2.m2.1.1.1" xref="id2.2.m2.1.1.1.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><times id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">\phantom{}{}^{*}</annotation></semantics></math>, Salman Avestimehr
<br class="ltx_break">Department of Electrical and Computer Engineering
<br class="ltx_break">University of Southern California 
<br class="ltx_break"><span id="id3.3.id1" class="ltx_text ltx_font_typewriter">yaldiz@usc.edu, tuozhang@usc.edu, avestime@usc.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Given the distributed nature, detecting and defending against the backdoor attack under federated learning (FL) systems is challenging. In this paper,
we observe that the cosine similarity of the last layer’s weight between the global model and each local update could be used effectively as an indicator of malicious model updates. Therefore, we propose <span id="id4.id1.1" class="ltx_text ltx_font_typewriter">CosDefense</span>, a cosine-similarity-based attacker detection algorithm. Specifically, under <span id="id4.id1.2" class="ltx_text ltx_font_typewriter">CosDefense</span>, the server calculates the cosine similarity score of the last layer’s weight between the global model and each client update, labels malicious clients whose score is much higher than the average, and filters them out of the model aggregation in each round. Compared to existing defense schemes, <span id="id4.id1.3" class="ltx_text ltx_font_typewriter">CosDefense</span> does not require any extra information besides the received model updates to operate and is compatible with client sampling. Experiment results on three real-world datasets demonstrate that <span id="id4.id1.4" class="ltx_text ltx_font_typewriter">CosDefense</span> could provide robust performance under the state-of-the-art FL poisoning attack.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">The gist of Federated Learning (FL) is to train a model coordinated by a server while preserving the clients’ data privacy <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>. However, this substantial property introduces new challenges. Since the server does not have access to the client data due to privacy concerns, FL is vulnerable to data or model poisoning attacks, in which the attacker send corrupted updates and contaminates the global model. Given the distributed nature of FL, it is challenging to detect and correct these failures under the vanilla FL framework <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>); Zhang et al. (<a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Several solutions have been proposed to defend the server from model poisoning attacks to relax the security challenge for the FL framework. Server-side robust aggregation approaches aim to detect outliers by inspecting the client updates, and filtering the malicious updates before model aggregation such as <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>.
Besides completely filtering out before model aggregation, approaches proposed by <cite class="ltx_cite ltx_citemacro_cite">Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>); Cao et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>); Regatti et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>); Fung et al. (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>); Prakash et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite> diminish the aggregation coefficients of the clients that are likely to be malicious.
However, existing approaches have some critical drawbacks or unfeasible assumptions as we summarize in Table <a href="#S1.T1" title="Table 1 ‣ 1 Introduction ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this work, we propose <span id="S1.p3.1.1" class="ltx_text ltx_font_typewriter">CosDetect</span>, a cosine similarity based outlier detection algorithm, to tackle the fundamental issues of existing defense methods. We provide an intriguing finding that the weight inside the last layer of the local model update is more sensitive to the local data distribution than other layers. Based on this crucial observation, we propose that the last layer of local updates from the malicious clients should be outliers compared to the ones from the benign clients. By calculating the cosine similarity of the last layer between each collected model update and the last global model, it is possible to filter the poisoning updates before model aggregation.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of <span id="S1.T1.34.1" class="ltx_text ltx_font_typewriter">CosDefense</span> with existing backdoor defense FL methods.</figcaption>
<table id="S1.T1.32.32" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.T1.32.32.33.1" class="ltx_tr">
<th id="S1.T1.32.32.33.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<td id="S1.T1.32.32.33.1.2" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S1.T1.32.32.33.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S1.T1.32.32.33.1.2.1.1" class="ltx_tr">
<td id="S1.T1.32.32.33.1.2.1.1.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.2.1.1.1.1" class="ltx_text ltx_font_bold">Compatibility with</span></td>
</tr>
<tr id="S1.T1.32.32.33.1.2.1.2" class="ltx_tr">
<td id="S1.T1.32.32.33.1.2.1.2.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.2.1.2.1.1" class="ltx_text ltx_font_bold">Client Sampling</span></td>
</tr>
</table>
</td>
<td id="S1.T1.32.32.33.1.3" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S1.T1.32.32.33.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S1.T1.32.32.33.1.3.1.1" class="ltx_tr">
<td id="S1.T1.32.32.33.1.3.1.1.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.3.1.1.1.1" class="ltx_text ltx_font_bold">Validation Data</span></td>
</tr>
<tr id="S1.T1.32.32.33.1.3.1.2" class="ltx_tr">
<td id="S1.T1.32.32.33.1.3.1.2.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.3.1.2.1.1" class="ltx_text ltx_font_bold">at the Server</span></td>
</tr>
</table>
</td>
<td id="S1.T1.32.32.33.1.4" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S1.T1.32.32.33.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S1.T1.32.32.33.1.4.1.1" class="ltx_tr">
<td id="S1.T1.32.32.33.1.4.1.1.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.4.1.1.1.1" class="ltx_text ltx_font_bold">Information of</span></td>
</tr>
<tr id="S1.T1.32.32.33.1.4.1.2" class="ltx_tr">
<td id="S1.T1.32.32.33.1.4.1.2.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.4.1.2.1.1" class="ltx_text ltx_font_bold">Attacker Number</span></td>
</tr>
</table>
</td>
<td id="S1.T1.32.32.33.1.5" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S1.T1.32.32.33.1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S1.T1.32.32.33.1.5.1.1" class="ltx_tr">
<td id="S1.T1.32.32.33.1.5.1.1.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.5.1.1.1.1" class="ltx_text ltx_font_bold">Client Score</span></td>
</tr>
<tr id="S1.T1.32.32.33.1.5.1.2" class="ltx_tr">
<td id="S1.T1.32.32.33.1.5.1.2.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.5.1.2.1.1" class="ltx_text ltx_font_bold">Maintenance</span></td>
</tr>
<tr id="S1.T1.32.32.33.1.5.1.3" class="ltx_tr">
<td id="S1.T1.32.32.33.1.5.1.3.1" class="ltx_td ltx_align_center"><span id="S1.T1.32.32.33.1.5.1.3.1.1" class="ltx_text ltx_font_bold">at the Server</span></td>
</tr>
</table>
</td>
</tr>
<tr id="S1.T1.4.4.4" class="ltx_tr">
<th id="S1.T1.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Krum <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>
</th>
<td id="S1.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S1.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.1.1.1.1.m1.1a"><mo id="S1.T1.1.1.1.1.m1.1.1" xref="S1.T1.1.1.1.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S1.T1.1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S1.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.2.2.2.2.m1.1a"><mo id="S1.T1.2.2.2.2.m1.1.1" xref="S1.T1.2.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.2.2.m1.1b"><times id="S1.T1.2.2.2.2.m1.1.1.cmml" xref="S1.T1.2.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.2.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S1.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.3.3.3.3.m1.1a"><mo id="S1.T1.3.3.3.3.m1.1.1" xref="S1.T1.3.3.3.3.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S1.T1.3.3.3.3.m1.1.1.cmml" xref="S1.T1.3.3.3.3.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.3.3.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S1.T1.4.4.4.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.4.4.4.4.m1.1a"><mo id="S1.T1.4.4.4.4.m1.1.1" xref="S1.T1.4.4.4.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.4.4.4.4.m1.1b"><times id="S1.T1.4.4.4.4.m1.1.1.cmml" xref="S1.T1.4.4.4.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.4.4.4.4.m1.1c">\times</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.8.8.8" class="ltx_tr">
<th id="S1.T1.8.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Multi-Krum <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>
</th>
<td id="S1.T1.5.5.5.1" class="ltx_td ltx_align_center"><math id="S1.T1.5.5.5.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.5.5.5.1.m1.1a"><mo id="S1.T1.5.5.5.1.m1.1.1" xref="S1.T1.5.5.5.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.5.5.5.1.m1.1b"><csymbol cd="latexml" id="S1.T1.5.5.5.1.m1.1.1.cmml" xref="S1.T1.5.5.5.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.5.5.5.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.6.6.6.2" class="ltx_td ltx_align_center"><math id="S1.T1.6.6.6.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.6.6.6.2.m1.1a"><mo id="S1.T1.6.6.6.2.m1.1.1" xref="S1.T1.6.6.6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.6.6.6.2.m1.1b"><times id="S1.T1.6.6.6.2.m1.1.1.cmml" xref="S1.T1.6.6.6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.6.6.6.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.7.7.7.3" class="ltx_td ltx_align_center"><math id="S1.T1.7.7.7.3.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.7.7.7.3.m1.1a"><mo id="S1.T1.7.7.7.3.m1.1.1" xref="S1.T1.7.7.7.3.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.7.7.7.3.m1.1b"><csymbol cd="latexml" id="S1.T1.7.7.7.3.m1.1.1.cmml" xref="S1.T1.7.7.7.3.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.7.7.7.3.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.8.8.8.4" class="ltx_td ltx_align_center"><math id="S1.T1.8.8.8.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.8.8.8.4.m1.1a"><mo id="S1.T1.8.8.8.4.m1.1.1" xref="S1.T1.8.8.8.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.8.8.8.4.m1.1b"><times id="S1.T1.8.8.8.4.m1.1.1.cmml" xref="S1.T1.8.8.8.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.8.8.8.4.m1.1c">\times</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.12.12.12" class="ltx_tr">
<th id="S1.T1.12.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Median <cite class="ltx_cite ltx_citemacro_cite">Yin et al. (<a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite>
</th>
<td id="S1.T1.9.9.9.1" class="ltx_td ltx_align_center"><math id="S1.T1.9.9.9.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.9.9.9.1.m1.1a"><mo id="S1.T1.9.9.9.1.m1.1.1" xref="S1.T1.9.9.9.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S1.T1.9.9.9.1.m1.1.1.cmml" xref="S1.T1.9.9.9.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.9.9.9.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.10.10.10.2" class="ltx_td ltx_align_center"><math id="S1.T1.10.10.10.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.10.10.10.2.m1.1a"><mo id="S1.T1.10.10.10.2.m1.1.1" xref="S1.T1.10.10.10.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.10.10.10.2.m1.1b"><times id="S1.T1.10.10.10.2.m1.1.1.cmml" xref="S1.T1.10.10.10.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.10.10.10.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.11.11.11.3" class="ltx_td ltx_align_center"><math id="S1.T1.11.11.11.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.11.11.11.3.m1.1a"><mo id="S1.T1.11.11.11.3.m1.1.1" xref="S1.T1.11.11.11.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.11.11.11.3.m1.1b"><times id="S1.T1.11.11.11.3.m1.1.1.cmml" xref="S1.T1.11.11.11.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.11.11.11.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.12.12.12.4" class="ltx_td ltx_align_center"><math id="S1.T1.12.12.12.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.12.12.12.4.m1.1a"><mo id="S1.T1.12.12.12.4.m1.1.1" xref="S1.T1.12.12.12.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.12.12.12.4.m1.1b"><times id="S1.T1.12.12.12.4.m1.1.1.cmml" xref="S1.T1.12.12.12.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.12.12.12.4.m1.1c">\times</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.16.16.16" class="ltx_tr">
<th id="S1.T1.16.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">RFFL <cite class="ltx_cite ltx_citemacro_cite">Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S1.T1.13.13.13.1" class="ltx_td ltx_align_center"><math id="S1.T1.13.13.13.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.13.13.13.1.m1.1a"><mo id="S1.T1.13.13.13.1.m1.1.1" xref="S1.T1.13.13.13.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.13.13.13.1.m1.1b"><times id="S1.T1.13.13.13.1.m1.1.1.cmml" xref="S1.T1.13.13.13.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.13.13.13.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.14.14.14.2" class="ltx_td ltx_align_center"><math id="S1.T1.14.14.14.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.14.14.14.2.m1.1a"><mo id="S1.T1.14.14.14.2.m1.1.1" xref="S1.T1.14.14.14.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.14.14.14.2.m1.1b"><times id="S1.T1.14.14.14.2.m1.1.1.cmml" xref="S1.T1.14.14.14.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.14.14.14.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.15.15.15.3" class="ltx_td ltx_align_center"><math id="S1.T1.15.15.15.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.15.15.15.3.m1.1a"><mo id="S1.T1.15.15.15.3.m1.1.1" xref="S1.T1.15.15.15.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.15.15.15.3.m1.1b"><times id="S1.T1.15.15.15.3.m1.1.1.cmml" xref="S1.T1.15.15.15.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.15.15.15.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.16.16.16.4" class="ltx_td ltx_align_center"><math id="S1.T1.16.16.16.4.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.16.16.16.4.m1.1a"><mo id="S1.T1.16.16.16.4.m1.1.1" xref="S1.T1.16.16.16.4.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.16.16.16.4.m1.1b"><csymbol cd="latexml" id="S1.T1.16.16.16.4.m1.1.1.cmml" xref="S1.T1.16.16.16.4.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.16.16.16.4.m1.1c">\surd</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.20.20.20" class="ltx_tr">
<th id="S1.T1.20.20.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FoolsGold <cite class="ltx_cite ltx_citemacro_cite">Fung et al. (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S1.T1.17.17.17.1" class="ltx_td ltx_align_center"><math id="S1.T1.17.17.17.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.17.17.17.1.m1.1a"><mo id="S1.T1.17.17.17.1.m1.1.1" xref="S1.T1.17.17.17.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.17.17.17.1.m1.1b"><csymbol cd="latexml" id="S1.T1.17.17.17.1.m1.1.1.cmml" xref="S1.T1.17.17.17.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.17.17.17.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.18.18.18.2" class="ltx_td ltx_align_center"><math id="S1.T1.18.18.18.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.18.18.18.2.m1.1a"><mo id="S1.T1.18.18.18.2.m1.1.1" xref="S1.T1.18.18.18.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.18.18.18.2.m1.1b"><times id="S1.T1.18.18.18.2.m1.1.1.cmml" xref="S1.T1.18.18.18.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.18.18.18.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.19.19.19.3" class="ltx_td ltx_align_center"><math id="S1.T1.19.19.19.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.19.19.19.3.m1.1a"><mo id="S1.T1.19.19.19.3.m1.1.1" xref="S1.T1.19.19.19.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.19.19.19.3.m1.1b"><times id="S1.T1.19.19.19.3.m1.1.1.cmml" xref="S1.T1.19.19.19.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.19.19.19.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.20.20.20.4" class="ltx_td ltx_align_center"><math id="S1.T1.20.20.20.4.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.20.20.20.4.m1.1a"><mo id="S1.T1.20.20.20.4.m1.1.1" xref="S1.T1.20.20.20.4.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.20.20.20.4.m1.1b"><csymbol cd="latexml" id="S1.T1.20.20.20.4.m1.1.1.cmml" xref="S1.T1.20.20.20.4.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.20.20.20.4.m1.1c">\surd</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.24.24.24" class="ltx_tr">
<th id="S1.T1.24.24.24.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FLTrust <cite class="ltx_cite ltx_citemacro_cite">Cao et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S1.T1.21.21.21.1" class="ltx_td ltx_align_center"><math id="S1.T1.21.21.21.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.21.21.21.1.m1.1a"><mo id="S1.T1.21.21.21.1.m1.1.1" xref="S1.T1.21.21.21.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.21.21.21.1.m1.1b"><csymbol cd="latexml" id="S1.T1.21.21.21.1.m1.1.1.cmml" xref="S1.T1.21.21.21.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.21.21.21.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.22.22.22.2" class="ltx_td ltx_align_center"><math id="S1.T1.22.22.22.2.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.22.22.22.2.m1.1a"><mo id="S1.T1.22.22.22.2.m1.1.1" xref="S1.T1.22.22.22.2.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.22.22.22.2.m1.1b"><csymbol cd="latexml" id="S1.T1.22.22.22.2.m1.1.1.cmml" xref="S1.T1.22.22.22.2.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.22.22.22.2.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.23.23.23.3" class="ltx_td ltx_align_center"><math id="S1.T1.23.23.23.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.23.23.23.3.m1.1a"><mo id="S1.T1.23.23.23.3.m1.1.1" xref="S1.T1.23.23.23.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.23.23.23.3.m1.1b"><times id="S1.T1.23.23.23.3.m1.1.1.cmml" xref="S1.T1.23.23.23.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.23.23.23.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.24.24.24.4" class="ltx_td ltx_align_center"><math id="S1.T1.24.24.24.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.24.24.24.4.m1.1a"><mo id="S1.T1.24.24.24.4.m1.1.1" xref="S1.T1.24.24.24.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.24.24.24.4.m1.1b"><times id="S1.T1.24.24.24.4.m1.1.1.cmml" xref="S1.T1.24.24.24.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.24.24.24.4.m1.1c">\times</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.28.28.28" class="ltx_tr">
<th id="S1.T1.28.28.28.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">ByGars <cite class="ltx_cite ltx_citemacro_cite">Regatti et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S1.T1.25.25.25.1" class="ltx_td ltx_align_center"><math id="S1.T1.25.25.25.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.25.25.25.1.m1.1a"><mo id="S1.T1.25.25.25.1.m1.1.1" xref="S1.T1.25.25.25.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S1.T1.25.25.25.1.m1.1.1.cmml" xref="S1.T1.25.25.25.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.25.25.25.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.26.26.26.2" class="ltx_td ltx_align_center"><math id="S1.T1.26.26.26.2.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.26.26.26.2.m1.1a"><mo id="S1.T1.26.26.26.2.m1.1.1" xref="S1.T1.26.26.26.2.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.26.26.26.2.m1.1b"><csymbol cd="latexml" id="S1.T1.26.26.26.2.m1.1.1.cmml" xref="S1.T1.26.26.26.2.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.26.26.26.2.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.27.27.27.3" class="ltx_td ltx_align_center"><math id="S1.T1.27.27.27.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.27.27.27.3.m1.1a"><mo id="S1.T1.27.27.27.3.m1.1.1" xref="S1.T1.27.27.27.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.27.27.27.3.m1.1b"><times id="S1.T1.27.27.27.3.m1.1.1.cmml" xref="S1.T1.27.27.27.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.27.27.27.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.28.28.28.4" class="ltx_td ltx_align_center"><math id="S1.T1.28.28.28.4.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.28.28.28.4.m1.1a"><mo id="S1.T1.28.28.28.4.m1.1.1" xref="S1.T1.28.28.28.4.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.28.28.28.4.m1.1b"><csymbol cd="latexml" id="S1.T1.28.28.28.4.m1.1.1.cmml" xref="S1.T1.28.28.28.4.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.28.28.28.4.m1.1c">\surd</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.32.32.32" class="ltx_tr">
<th id="S1.T1.32.32.32.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SageFlow <cite class="ltx_cite ltx_citemacro_cite">Park et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S1.T1.29.29.29.1" class="ltx_td ltx_align_center"><math id="S1.T1.29.29.29.1.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.29.29.29.1.m1.1a"><mo id="S1.T1.29.29.29.1.m1.1.1" xref="S1.T1.29.29.29.1.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.29.29.29.1.m1.1b"><csymbol cd="latexml" id="S1.T1.29.29.29.1.m1.1.1.cmml" xref="S1.T1.29.29.29.1.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.29.29.29.1.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.30.30.30.2" class="ltx_td ltx_align_center"><math id="S1.T1.30.30.30.2.m1.1" class="ltx_Math" alttext="\surd" display="inline"><semantics id="S1.T1.30.30.30.2.m1.1a"><mo id="S1.T1.30.30.30.2.m1.1.1" xref="S1.T1.30.30.30.2.m1.1.1.cmml">√</mo><annotation-xml encoding="MathML-Content" id="S1.T1.30.30.30.2.m1.1b"><csymbol cd="latexml" id="S1.T1.30.30.30.2.m1.1.1.cmml" xref="S1.T1.30.30.30.2.m1.1.1">square-root</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.30.30.30.2.m1.1c">\surd</annotation></semantics></math></td>
<td id="S1.T1.31.31.31.3" class="ltx_td ltx_align_center"><math id="S1.T1.31.31.31.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.31.31.31.3.m1.1a"><mo id="S1.T1.31.31.31.3.m1.1.1" xref="S1.T1.31.31.31.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.31.31.31.3.m1.1b"><times id="S1.T1.31.31.31.3.m1.1.1.cmml" xref="S1.T1.31.31.31.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.31.31.31.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S1.T1.32.32.32.4" class="ltx_td ltx_align_center"><math id="S1.T1.32.32.32.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.T1.32.32.32.4.m1.1a"><mo id="S1.T1.32.32.32.4.m1.1.1" xref="S1.T1.32.32.32.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.T1.32.32.32.4.m1.1b"><times id="S1.T1.32.32.32.4.m1.1.1.cmml" xref="S1.T1.32.32.32.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.32.32.32.4.m1.1c">\times</annotation></semantics></math></td>
</tr>
<tr id="S1.T1.32.32.34.2" class="ltx_tr">
<th id="S1.T1.32.32.34.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S1.T1.32.32.34.2.1.1" class="ltx_text ltx_font_bold">CosDefense (Our Method)</span></th>
<td id="S1.T1.32.32.34.2.2" class="ltx_td ltx_align_center ltx_border_bb">✔</td>
<td id="S1.T1.32.32.34.2.3" class="ltx_td ltx_align_center ltx_border_bb">✖</td>
<td id="S1.T1.32.32.34.2.4" class="ltx_td ltx_align_center ltx_border_bb">✖</td>
<td id="S1.T1.32.32.34.2.5" class="ltx_td ltx_align_center ltx_border_bb">✖</td>
</tr>
</tbody>
</table>
</figure>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">As shown in Table <a href="#S1.T1" title="Table 1 ‣ 1 Introduction ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the proposed cosine similarity based outlier detection scheme, though simple, has equipped <span id="S1.p4.1.1" class="ltx_text ltx_font_typewriter">CosDetect</span> with multiform merits compared to prior strategies: (1) <span id="S1.p4.1.2" class="ltx_text ltx_font_typewriter">CosDetect</span> does not require representative benign data at the server to distinguish the malicious updates. It is only built on accessing the global model parameters and the clients’ updates. (2) <span id="S1.p4.1.3" class="ltx_text ltx_font_typewriter">CosDetect</span> does not need the precise number of malicious clients per communication round in advance for robust performance. (3) <span id="S1.p4.1.4" class="ltx_text ltx_font_typewriter">CosDetect</span> does not rely on the previous clients’ records to cluster the malicious clients. Instead, <span id="S1.p4.1.5" class="ltx_text ltx_font_typewriter">CosDetect</span> eliminates the outliers only based on the current round information, which makes our algorithm compatible with client selection and brings more flexibility for the implementation.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Approach Overview</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Layer-wise Cosine Similarity for Model Weights</h3>

<figure id="S2.F1" class="ltx_figure ltx_align_floatright"><img src="/html/2304.00160/assets/plot/cs.png" id="S2.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="192" height="145" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The average cosine similarity of model weight in various layers between one client and the other nine clients. All 10 models are trained independently for 1000 iterations without synchronization.</figcaption>
</figure>
<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.4" class="ltx_p">We first focus on a critical question: <span id="S2.SS1.p1.4.1" class="ltx_text ltx_font_italic">how would the attack be reflected on the server side during FL training?</span> Under the vanilla FL setting <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>, the only information the server holds during the training are the collected model updates and the following aggregated model. A previous study <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> notes that label information for the training data can be computed analytically from the gradients of the last layer inside the machine learning model under the centralized setting. Following this direction, one intriguing finding from our empirical study is that compared to other layers, the last layer’s weight is more sensitive to the input data distribution. We quantify the similarity of model weights by cosine similarity, which is the dot product of the two vectors divided by the product of individual norms as
<math id="S2.SS1.p1.1.m1.5" class="ltx_math_unparsed" alttext="cos(\alpha)=\frac{&lt;x,y&gt;}{||x||\cdot||y||}" display="inline"><semantics id="S2.SS1.p1.1.m1.5a"><mrow id="S2.SS1.p1.1.m1.5.6"><mrow id="S2.SS1.p1.1.m1.5.6.2"><mi id="S2.SS1.p1.1.m1.5.6.2.2">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.5.6.2.1">​</mo><mi id="S2.SS1.p1.1.m1.5.6.2.3">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.5.6.2.1a">​</mo><mi id="S2.SS1.p1.1.m1.5.6.2.4">s</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.5.6.2.1b">​</mo><mrow id="S2.SS1.p1.1.m1.5.6.2.5.2"><mo stretchy="false" id="S2.SS1.p1.1.m1.5.6.2.5.2.1">(</mo><mi id="S2.SS1.p1.1.m1.5.5">α</mi><mo stretchy="false" id="S2.SS1.p1.1.m1.5.6.2.5.2.2">)</mo></mrow></mrow><mo id="S2.SS1.p1.1.m1.5.6.1">=</mo><mfrac id="S2.SS1.p1.1.m1.4.4"><mrow id="S2.SS1.p1.1.m1.2.2.2"><mo id="S2.SS1.p1.1.m1.2.2.2.3">&lt;</mo><mi id="S2.SS1.p1.1.m1.1.1.1.1">x</mi><mo id="S2.SS1.p1.1.m1.2.2.2.4">,</mo><mi id="S2.SS1.p1.1.m1.2.2.2.2">y</mi><mo id="S2.SS1.p1.1.m1.2.2.2.5">&gt;</mo></mrow><mrow id="S2.SS1.p1.1.m1.4.4.4"><mrow id="S2.SS1.p1.1.m1.4.4.4.4.2"><mo maxsize="142%" minsize="142%" id="S2.SS1.p1.1.m1.4.4.4.4.2.1">‖</mo><mi id="S2.SS1.p1.1.m1.3.3.3.1">x</mi><mo maxsize="142%" minsize="142%" rspace="0.055em" id="S2.SS1.p1.1.m1.4.4.4.4.2.2">‖</mo></mrow><mo rspace="0.222em" id="S2.SS1.p1.1.m1.4.4.4.3">⋅</mo><mrow id="S2.SS1.p1.1.m1.4.4.4.5.2"><mo maxsize="142%" minsize="142%" id="S2.SS1.p1.1.m1.4.4.4.5.2.1">‖</mo><mi id="S2.SS1.p1.1.m1.4.4.4.2">y</mi><mo maxsize="142%" minsize="142%" id="S2.SS1.p1.1.m1.4.4.4.5.2.2">‖</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.5b">cos(\alpha)=\frac{&lt;x,y&gt;}{||x||\cdot||y||}</annotation></semantics></math>
where <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\alpha</annotation></semantics></math> is the angle between vectors <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">x</annotation></semantics></math> and <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">y</annotation></semantics></math>. Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Layer-wise Cosine Similarity for Model Weights ‣ 2 Approach Overview ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the average cosine similarity for each layer in the model across independent clients. In this experiment, ten clients train a four-layer CNN-based model independently without any model synchronization on the MNIST dataset, which has been non-iid partitioned (See Section <a href="#S3.SS1" title="3.1 Experiment Setup ‣ 3 Evaluations ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> for details). We observe that with the increment of the iteration, the input-side layers show higher similarity than the output-side layers, and the last layer has the lowest similarity score, because the local data distribution among all clients mainly varies on the label distribution. These observations provide critical insight that the local data label distribution could be efficiently reflected in the last layer’s weight compared to the other layers.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>CosDefense: Filtering the Malicious Model Update via Cosine Similarity</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.9" class="ltx_p">Based on the crucial observation we described in the previous section, we propose that the last layer of the local models from the attackers should be outliers compared to the ones from the benign models. Therefore, it is possible to filter the malicious model update on the server by calculating the cosine similarity between each collected model update and the last global model.
When calculating the cosine similarity between global model weights and local model update, we have the following:</p>
<table id="A6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\displaystyle cos(\alpha_{i})" display="inline"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">​</mo><mi id="S2.E1.m1.1.1.4" xref="S2.E1.m1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.2a" xref="S2.E1.m1.1.1.2.cmml">​</mo><mi id="S2.E1.m1.1.1.5" xref="S2.E1.m1.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.2b" xref="S2.E1.m1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">α</mi><mi id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><times id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></times><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑐</ci><ci id="S2.E1.m1.1.1.4.cmml" xref="S2.E1.m1.1.1.4">𝑜</ci><ci id="S2.E1.m1.1.1.5.cmml" xref="S2.E1.m1.1.1.5">𝑠</ci><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">𝛼</ci><ci id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle cos(\alpha_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m2.6" class="ltx_math_unparsed" alttext="\displaystyle=\frac{&lt;\theta_{t},g_{t+1}^{i}&gt;}{||\theta_{t}||\cdot||g_{t+1}^{i}||}=\frac{&lt;\theta_{t},\theta_{t+1}^{i}-\theta_{t}&gt;}{||\theta_{t}||\cdot||\theta_{t+1}^{i}-\theta_{t}||}=\frac{&lt;\theta_{t},\theta_{t+1}^{i}&gt;-&lt;\theta_{t},\theta_{t}&gt;}{||\theta_{t}||\cdot||\theta_{t+1}^{i}-\theta_{t}||}" display="inline"><semantics id="S2.E1.m2.6a"><mrow id="S2.E1.m2.6.7"><mi id="S2.E1.m2.6.7.2"></mi><mo id="S2.E1.m2.6.7.3">=</mo><mstyle displaystyle="true" id="S2.E1.m2.2.2"><mfrac id="S2.E1.m2.2.2a"><mrow id="S2.E1.m2.2.2.4"><mo id="S2.E1.m2.2.2.4.1">&lt;</mo><msub id="S2.E1.m2.2.2.4.2"><mi id="S2.E1.m2.2.2.4.2.2">θ</mi><mi id="S2.E1.m2.2.2.4.2.3">t</mi></msub><mo id="S2.E1.m2.2.2.4.3">,</mo><msubsup id="S2.E1.m2.2.2.4.4"><mi id="S2.E1.m2.2.2.4.4.2.2">g</mi><mrow id="S2.E1.m2.2.2.4.4.2.3"><mi id="S2.E1.m2.2.2.4.4.2.3.2">t</mi><mo id="S2.E1.m2.2.2.4.4.2.3.1">+</mo><mn id="S2.E1.m2.2.2.4.4.2.3.3">1</mn></mrow><mi id="S2.E1.m2.2.2.4.4.3">i</mi></msubsup><mo id="S2.E1.m2.2.2.4.5">&gt;</mo></mrow><mrow id="S2.E1.m2.2.2.2"><mrow id="S2.E1.m2.1.1.1.1.1"><mo stretchy="false" id="S2.E1.m2.1.1.1.1.1.2">‖</mo><msub id="S2.E1.m2.1.1.1.1.1.1"><mi id="S2.E1.m2.1.1.1.1.1.1.2">θ</mi><mi id="S2.E1.m2.1.1.1.1.1.1.3">t</mi></msub><mo rspace="0.055em" stretchy="false" id="S2.E1.m2.1.1.1.1.1.3">‖</mo></mrow><mo rspace="0.222em" id="S2.E1.m2.2.2.2.3">⋅</mo><mrow id="S2.E1.m2.2.2.2.2.1"><mo stretchy="false" id="S2.E1.m2.2.2.2.2.1.2">‖</mo><msubsup id="S2.E1.m2.2.2.2.2.1.1"><mi id="S2.E1.m2.2.2.2.2.1.1.2.2">g</mi><mrow id="S2.E1.m2.2.2.2.2.1.1.2.3"><mi id="S2.E1.m2.2.2.2.2.1.1.2.3.2">t</mi><mo id="S2.E1.m2.2.2.2.2.1.1.2.3.1">+</mo><mn id="S2.E1.m2.2.2.2.2.1.1.2.3.3">1</mn></mrow><mi id="S2.E1.m2.2.2.2.2.1.1.3">i</mi></msubsup><mo stretchy="false" id="S2.E1.m2.2.2.2.2.1.3">‖</mo></mrow></mrow></mfrac></mstyle><mo id="S2.E1.m2.6.7.4">=</mo><mstyle displaystyle="true" id="S2.E1.m2.4.4"><mfrac id="S2.E1.m2.4.4a"><mrow id="S2.E1.m2.4.4.4"><mo id="S2.E1.m2.4.4.4.1">&lt;</mo><msub id="S2.E1.m2.4.4.4.2"><mi id="S2.E1.m2.4.4.4.2.2">θ</mi><mi id="S2.E1.m2.4.4.4.2.3">t</mi></msub><mo id="S2.E1.m2.4.4.4.3">,</mo><msubsup id="S2.E1.m2.4.4.4.4"><mi id="S2.E1.m2.4.4.4.4.2.2">θ</mi><mrow id="S2.E1.m2.4.4.4.4.2.3"><mi id="S2.E1.m2.4.4.4.4.2.3.2">t</mi><mo id="S2.E1.m2.4.4.4.4.2.3.1">+</mo><mn id="S2.E1.m2.4.4.4.4.2.3.3">1</mn></mrow><mi id="S2.E1.m2.4.4.4.4.3">i</mi></msubsup><mo id="S2.E1.m2.4.4.4.5">−</mo><msub id="S2.E1.m2.4.4.4.6"><mi id="S2.E1.m2.4.4.4.6.2">θ</mi><mi id="S2.E1.m2.4.4.4.6.3">t</mi></msub><mo id="S2.E1.m2.4.4.4.7">&gt;</mo></mrow><mrow id="S2.E1.m2.4.4.2"><mrow id="S2.E1.m2.3.3.1.1.1"><mo stretchy="false" id="S2.E1.m2.3.3.1.1.1.2">‖</mo><msub id="S2.E1.m2.3.3.1.1.1.1"><mi id="S2.E1.m2.3.3.1.1.1.1.2">θ</mi><mi id="S2.E1.m2.3.3.1.1.1.1.3">t</mi></msub><mo rspace="0.055em" stretchy="false" id="S2.E1.m2.3.3.1.1.1.3">‖</mo></mrow><mo rspace="0.222em" id="S2.E1.m2.4.4.2.3">⋅</mo><mrow id="S2.E1.m2.4.4.2.2.1"><mo stretchy="false" id="S2.E1.m2.4.4.2.2.1.2">‖</mo><mrow id="S2.E1.m2.4.4.2.2.1.1"><msubsup id="S2.E1.m2.4.4.2.2.1.1.2"><mi id="S2.E1.m2.4.4.2.2.1.1.2.2.2">θ</mi><mrow id="S2.E1.m2.4.4.2.2.1.1.2.2.3"><mi id="S2.E1.m2.4.4.2.2.1.1.2.2.3.2">t</mi><mo id="S2.E1.m2.4.4.2.2.1.1.2.2.3.1">+</mo><mn id="S2.E1.m2.4.4.2.2.1.1.2.2.3.3">1</mn></mrow><mi id="S2.E1.m2.4.4.2.2.1.1.2.3">i</mi></msubsup><mo id="S2.E1.m2.4.4.2.2.1.1.1">−</mo><msub id="S2.E1.m2.4.4.2.2.1.1.3"><mi id="S2.E1.m2.4.4.2.2.1.1.3.2">θ</mi><mi id="S2.E1.m2.4.4.2.2.1.1.3.3">t</mi></msub></mrow><mo stretchy="false" id="S2.E1.m2.4.4.2.2.1.3">‖</mo></mrow></mrow></mfrac></mstyle><mo id="S2.E1.m2.6.7.5">=</mo><mstyle displaystyle="true" id="S2.E1.m2.6.6"><mfrac id="S2.E1.m2.6.6a"><mrow id="S2.E1.m2.6.6.4"><mo id="S2.E1.m2.6.6.4.1">&lt;</mo><msub id="S2.E1.m2.6.6.4.2"><mi id="S2.E1.m2.6.6.4.2.2">θ</mi><mi id="S2.E1.m2.6.6.4.2.3">t</mi></msub><mo id="S2.E1.m2.6.6.4.3">,</mo><msubsup id="S2.E1.m2.6.6.4.4"><mi id="S2.E1.m2.6.6.4.4.2.2">θ</mi><mrow id="S2.E1.m2.6.6.4.4.2.3"><mi id="S2.E1.m2.6.6.4.4.2.3.2">t</mi><mo id="S2.E1.m2.6.6.4.4.2.3.1">+</mo><mn id="S2.E1.m2.6.6.4.4.2.3.3">1</mn></mrow><mi id="S2.E1.m2.6.6.4.4.3">i</mi></msubsup><mo rspace="0em" id="S2.E1.m2.6.6.4.5">&gt;</mo><mo lspace="0em" rspace="0em" id="S2.E1.m2.6.6.4.6">−</mo><mo lspace="0em" id="S2.E1.m2.6.6.4.7">&lt;</mo><msub id="S2.E1.m2.6.6.4.8"><mi id="S2.E1.m2.6.6.4.8.2">θ</mi><mi id="S2.E1.m2.6.6.4.8.3">t</mi></msub><mo id="S2.E1.m2.6.6.4.9">,</mo><msub id="S2.E1.m2.6.6.4.10"><mi id="S2.E1.m2.6.6.4.10.2">θ</mi><mi id="S2.E1.m2.6.6.4.10.3">t</mi></msub><mo id="S2.E1.m2.6.6.4.11">&gt;</mo></mrow><mrow id="S2.E1.m2.6.6.2"><mrow id="S2.E1.m2.5.5.1.1.1"><mo stretchy="false" id="S2.E1.m2.5.5.1.1.1.2">‖</mo><msub id="S2.E1.m2.5.5.1.1.1.1"><mi id="S2.E1.m2.5.5.1.1.1.1.2">θ</mi><mi id="S2.E1.m2.5.5.1.1.1.1.3">t</mi></msub><mo rspace="0.055em" stretchy="false" id="S2.E1.m2.5.5.1.1.1.3">‖</mo></mrow><mo rspace="0.222em" id="S2.E1.m2.6.6.2.3">⋅</mo><mrow id="S2.E1.m2.6.6.2.2.1"><mo stretchy="false" id="S2.E1.m2.6.6.2.2.1.2">‖</mo><mrow id="S2.E1.m2.6.6.2.2.1.1"><msubsup id="S2.E1.m2.6.6.2.2.1.1.2"><mi id="S2.E1.m2.6.6.2.2.1.1.2.2.2">θ</mi><mrow id="S2.E1.m2.6.6.2.2.1.1.2.2.3"><mi id="S2.E1.m2.6.6.2.2.1.1.2.2.3.2">t</mi><mo id="S2.E1.m2.6.6.2.2.1.1.2.2.3.1">+</mo><mn id="S2.E1.m2.6.6.2.2.1.1.2.2.3.3">1</mn></mrow><mi id="S2.E1.m2.6.6.2.2.1.1.2.3">i</mi></msubsup><mo id="S2.E1.m2.6.6.2.2.1.1.1">−</mo><msub id="S2.E1.m2.6.6.2.2.1.1.3"><mi id="S2.E1.m2.6.6.2.2.1.1.3.2">θ</mi><mi id="S2.E1.m2.6.6.2.2.1.1.3.3">t</mi></msub></mrow><mo stretchy="false" id="S2.E1.m2.6.6.2.2.1.3">‖</mo></mrow></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex" id="S2.E1.m2.6b">\displaystyle=\frac{&lt;\theta_{t},g_{t+1}^{i}&gt;}{||\theta_{t}||\cdot||g_{t+1}^{i}||}=\frac{&lt;\theta_{t},\theta_{t+1}^{i}-\theta_{t}&gt;}{||\theta_{t}||\cdot||\theta_{t+1}^{i}-\theta_{t}||}=\frac{&lt;\theta_{t},\theta_{t+1}^{i}&gt;-&lt;\theta_{t},\theta_{t}&gt;}{||\theta_{t}||\cdot||\theta_{t+1}^{i}-\theta_{t}||}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.8" class="ltx_p">where <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">α</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝛼</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\alpha_{i}</annotation></semantics></math> denotes the angle between global model weights (<math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\theta_{t}</annotation></semantics></math>) and local model update of client <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">i</annotation></semantics></math> (<math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="g_{t+1}^{i}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><msubsup id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2.2" xref="S2.SS2.p1.4.m4.1.1.2.2.cmml">g</mi><mrow id="S2.SS2.p1.4.m4.1.1.2.3" xref="S2.SS2.p1.4.m4.1.1.2.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2.3.2" xref="S2.SS2.p1.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.4.m4.1.1.2.3.1" xref="S2.SS2.p1.4.m4.1.1.2.3.1.cmml">+</mo><mn id="S2.SS2.p1.4.m4.1.1.2.3.3" xref="S2.SS2.p1.4.m4.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">superscript</csymbol><apply id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.2.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2.2">𝑔</ci><apply id="S2.SS2.p1.4.m4.1.1.2.3.cmml" xref="S2.SS2.p1.4.m4.1.1.2.3"><plus id="S2.SS2.p1.4.m4.1.1.2.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.2.3.1"></plus><ci id="S2.SS2.p1.4.m4.1.1.2.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.4.m4.1.1.2.3.3.cmml" xref="S2.SS2.p1.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">g_{t+1}^{i}</annotation></semantics></math>). If all the participated clients are benign nodes, as the communication round <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">t</annotation></semantics></math> goes to infinity, the global model should be converged to an optimal point based on the received local model update. Therefore, the cosine similarity between global model weights and the local model update tends to be decreasing during the training, as the difference between <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝜃</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\theta_{t}</annotation></semantics></math> and <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="\theta_{t+1}^{i}" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><msubsup id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2.2" xref="S2.SS2.p1.7.m7.1.1.2.2.cmml">θ</mi><mrow id="S2.SS2.p1.7.m7.1.1.2.3" xref="S2.SS2.p1.7.m7.1.1.2.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2.3.2" xref="S2.SS2.p1.7.m7.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.7.m7.1.1.2.3.1" xref="S2.SS2.p1.7.m7.1.1.2.3.1.cmml">+</mo><mn id="S2.SS2.p1.7.m7.1.1.2.3.3" xref="S2.SS2.p1.7.m7.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2.2">𝜃</ci><apply id="S2.SS2.p1.7.m7.1.1.2.3.cmml" xref="S2.SS2.p1.7.m7.1.1.2.3"><plus id="S2.SS2.p1.7.m7.1.1.2.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.2.3.1"></plus><ci id="S2.SS2.p1.7.m7.1.1.2.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.7.m7.1.1.2.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">\theta_{t+1}^{i}</annotation></semantics></math> (local model for client <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">i</annotation></semantics></math>) goes smaller for each client.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.2" class="ltx_p">However, the cosine similarity scores from malicious clients do not follow this phenomenon. As their aim is to prevent convergence, their local optimization direction would be different compared to the benign client models or the global model. As a result, the difference between <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝜃</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\theta_{t}</annotation></semantics></math> and <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\theta_{t+1}^{i}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msubsup id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.cmml">θ</mi><mrow id="S2.SS2.p2.2.m2.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.2.3.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2.3.2" xref="S2.SS2.p2.2.m2.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.p2.2.m2.1.1.2.3.1" xref="S2.SS2.p2.2.m2.1.1.2.3.1.cmml">+</mo><mn id="S2.SS2.p2.2.m2.1.1.2.3.3" xref="S2.SS2.p2.2.m2.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2">𝜃</ci><apply id="S2.SS2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3"><plus id="S2.SS2.p2.2.m2.1.1.2.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3.1"></plus><ci id="S2.SS2.p2.2.m2.1.1.2.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p2.2.m2.1.1.2.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\theta_{t+1}^{i}</annotation></semantics></math> from malicious nodes becomes more extensive than the benign nodes, making the cosine similarity score between the malicious client update and the global weights tend to be increasing during the training.</p>
</div>
<figure id="S2.F2" class="ltx_figure ltx_align_floatright"><img src="/html/2304.00160/assets/plot/cs2.png" id="S2.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="192" height="138" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The trace of the average cosine similarity score of the last layer’s weight between all received local updates and global model. </figcaption>
</figure>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p">To demonstrate our thoughts, we trace the average cosine score of the last layer local updates and that of the global model under benign and poisoning attack cases ( Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 CosDefense: Filtering the Malicious Model Update via Cosine Similarity ‣ 2 Approach Overview ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Under both cases, the total client number is 100, and the sampling rate is 0.1 in each round. For the poisoning attack case, we launch the IPM attack <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite> at round 200, with 30% of the participants being malicious clients. For a better illustration, Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 CosDefense: Filtering the Malicious Model Update via Cosine Similarity ‣ 2 Approach Overview ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is smoothed by the moving averaged filter with window size 40. The average cosine similarity increases sharply as the attack happens and is much higher than the scores under the all-benign case, which confirms our speculation.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p">We observed that cosine similarity between global model parameters and the benign local model updates tends to be smaller during the training, which indicates that the direction of benign updates is less than perpendicular to the global model, making it move toward a different direction in each round. However, the average cosine similarity scores increase after the attack, indicating that cosine similarity scores from malicious clients are much larger than the scores from benign clients. The large cosine similarity values represent that malicious client updates are aligned with the global model parameters and do not update the global model in different directions but keep it still. As a result, if there are enough malicious clients in the system, their updates considerably diminish the benefit of benign client updates, preventing the convergence of the global model.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.2" class="ltx_p">Following these directions, we propose <span id="S2.SS2.p5.2.1" class="ltx_text ltx_font_typewriter">CosDefense</span>, a server-side clustering-based defense method as shown in the Appendix <a href="#A3" title="Appendix C Algorithm ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>. In each round <math id="S2.SS2.p5.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p5.1.m1.1a"><mi id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.1b"><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.1c">t</annotation></semantics></math>, after the server receives all the updates from the sampled clients, it calculates the cosine similarity between the last layer’s global weights and the last layer’s local updates for each client. Then, the server clusters clients based on their cosine similarity scores either as malicious or benign. If the cosine similarity score of a client is much higher than others, then the server labels that client as malicious for round <math id="S2.SS2.p5.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p5.2.m2.1a"><mi id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><ci id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">t</annotation></semantics></math> and exclude that client from aggregation.
<span id="S2.SS2.p5.2.2" class="ltx_text ltx_font_typewriter">CosDefense</span> only detects malicious clients before aggregation and excludes them, allowing the server to perform any aggregation method with benign client updates. Hence, <span id="S2.SS2.p5.2.3" class="ltx_text ltx_font_typewriter">CosDefense</span> algorithm is compatible with any aggregation method.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Evaluations</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experiment Setup</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.2" class="ltx_p">We conduct the evaluations on three datasets and two models: MNIST <cite class="ltx_cite ltx_citemacro_cite">LeCun et al. (<a href="#bib.bib8" title="" class="ltx_ref">1998</a>)</cite> and Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> with a four-layer CNN-based model following the previous related work <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>, and CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky (<a href="#bib.bib7" title="" class="ltx_ref">2009</a>)</cite> with ResNet-18 model <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a href="#bib.bib6" title="" class="ltx_ref">2015</a>)</cite>. We generate the non-iid partition for all datasets following previous FL works <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>); Fang et al. (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite> with default <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">q</annotation></semantics></math> as 0.5, where the higher <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">q</annotation></semantics></math> represents a higher non-iid degree. We compare our defense method with two representative robust aggregation rules: Krum <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> and Clipping-Median. We do not include the baselines such as FLTrust <cite class="ltx_cite ltx_citemacro_cite">Cao et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> or RFFL <cite class="ltx_cite ltx_citemacro_cite">Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite> because they either need validation data on the server or do not compatible with the client sampling. Further details of the baseline implementation and parameter selection can be found in Appendix <a href="#A4" title="Appendix D Experimental Details ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Defense Performance with the State-of-the-Art Model Poisoning Attack</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">To evaluate the defense performance, we evaluate the <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_typewriter">CosDefense</span> on top of the state-of-the-art model poisoning attack methods, Inner Product Manipulation (IPM) <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite> attack.
In the following experiments, we set the attacker control 30% of the participants as malicious nodes, and the attack would launch at round 200. The server randomly samples 10 clients from 100 for local model training in each communication round.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Evaluation Results:</span> Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Defense Performance with the State-of-the-Art Model Poisoning Attack ‣ 3 Evaluations ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the accuracy curve over 1000 communication rounds for Krum, Clipping-Median, and <span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_typewriter">CosDefense</span> for MNIST, Fashion-MNIST, and CIFAR-10. The detailed numerical results and ablation study related to the non-iid degree are shown in Appendix <a href="#A5" title="Appendix E Experimental Results ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.
We have three observations from the results. (1) As Krum and Clipping-Median use all layers of the updates, the results of <span id="S3.SS2.p2.1.3" class="ltx_text ltx_font_typewriter">CosDefense</span> indicate that the similarity of the last layer between the collected model update and global model is more sensitive to attacks, which could effectively be used to filter out the malicious model updates. (2) After the IPM attack begins, all the defense strategies drop the accuracy significantly. However, the proposed <span id="S3.SS2.p2.1.4" class="ltx_text ltx_font_typewriter">CosDefense</span> strategy has a much faster convergence speed and shorter recovery time to resume the learning compared to Krum and Clipping-Median. (3) For the most challenging dataset CIFAR-10, after the IPM attack happens, <span id="S3.SS2.p2.1.5" class="ltx_text ltx_font_typewriter">CosDefense</span> not only recovers the best accuracy before round 200, but also has an increasing trend on the curve, while other defense baselines even could not reach the best accuracy before the attack.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<table id="S3.F3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F3.3.3" class="ltx_tr">
<td id="S3.F3.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2304.00160/assets/plot/mnist-ipm.png" id="S3.F3.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="157" height="126" alt="Refer to caption"></td>
<td id="S3.F3.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2304.00160/assets/plot/fmnist-ipm.png" id="S3.F3.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="157" height="126" alt="Refer to caption"></td>
<td id="S3.F3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2304.00160/assets/plot/cifar-ipm.png" id="S3.F3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="157" height="126" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Accuracy performance over 1000 rounds for Krum, Clipping-Median, <span id="S3.F3.5.1" class="ltx_text ltx_font_typewriter">CosDefense</span>, and FedAvg on MNIST (left), FMNIST (middle), and CIFAR-10 (right) under IPM attack. </figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure ltx_align_floatright"><img src="/html/2304.00160/assets/plot/ipm-attacker.png" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="165" height="133" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Accuracy performance on MNIST dataset under different numbers of attackers perform IPM attacks.</figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p"><span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">Impact of the number of the attackers.</span>
Some previous works on untargeted model poisoning assume that there is a large fraction of attackers among participants <cite class="ltx_cite ltx_citemacro_cite">Fang et al. (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>); Xie et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>. Therefore, we also investigate the number of attackers’ impact on defense performance. In this section, we conduct experiments on non-iid partitioned MNIST with <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="q=0.5" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">q</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><eq id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></eq><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑞</ci><cn type="float" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">q=0.5</annotation></semantics></math>, and vary the number of attackers from 10% to 40% of the total participants. Results of this study are provided in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2 Defense Performance with the State-of-the-Art Model Poisoning Attack ‣ 3 Evaluations ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, showing the final global model accuracy of defense methods under various settings. We observe that the two defense baselines remain robust when the ratio of attackers is less than 30%. As the ratio reaches 30%, both Krum and Clipping Median collapse on the accuracy performance and fail to defend the model convergence, while <span id="S3.SS2.p3.1.2" class="ltx_text ltx_font_typewriter">CosDefense</span> still provides robust accuracy performance. One notable point is that the <span id="S3.SS2.p3.1.3" class="ltx_text ltx_font_typewriter">CosDefense</span> achieves the best accuracy compared to other baselines among all different ratios of attackers. The experiment results demonstrate that <span id="S3.SS2.p3.1.4" class="ltx_text ltx_font_typewriter">CosDefense</span> is robust and reliable under both small-scale and large-scale attack
scenarios.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We presented <span id="S4.p1.1.1" class="ltx_text ltx_font_typewriter">CosDefense</span>, a cluster-based defense scheme that could filter the malicious updates out of the model aggregation on the server. Experiment results on real-world datasets demonstrate that <span id="S4.p1.1.2" class="ltx_text ltx_font_typewriter">CosDefense</span> can provide robust performance under the state-of-the-art FL poisoning attack. We picture the limitations and potential future work in Appendix <a href="#A6" title="Appendix F Limitations and Future works. ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Acknowledgement</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">This material is based upon work supported by Defense Advanced Research Projects Agency (DARPA) under Contract No. HR001120C0156, ARO award W911NF1810400, ONR Award No. N00014-16-1-2189. The views, opinions, and/or findings expressed are those of the author(s) and should not be interpreted
as representing the official views or policies of the Department of Defense or the U.S. Government.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biggio et al. (2012)</span>
<span class="ltx_bibblock">
Battista Biggio, Blaine Nelson, and Pavel Laskov.

</span>
<span class="ltx_bibblock">Poisoning attacks against support vector machines.

</span>
<span class="ltx_bibblock">ICML, 2012.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanchard et al. (2017)</span>
<span class="ltx_bibblock">
Peva Blanchard, El Mahdi El Mhamdi, Rachid Guerraoui, and Julien Stainer.

</span>
<span class="ltx_bibblock">Machine learning with adversaries: Byzantine tolerant gradient
descent.

</span>
<span class="ltx_bibblock">NeurIPS, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2021)</span>
<span class="ltx_bibblock">
Xiaoyu Cao, Minghong Fang, Jia Liu, and Neil Zhenqiang Gong.

</span>
<span class="ltx_bibblock">Fltrust: Byzantine-robust federated learning via trust bootstrapping.

</span>
<span class="ltx_bibblock">NDSS, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. (2019)</span>
<span class="ltx_bibblock">
Minghong Fang, Xiaoyu Cao, Jinyuan Jia, and Neil Zhenqiang Gong.

</span>
<span class="ltx_bibblock">Local model poisoning attacks to byzantine-robust federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">USENIX Security Symposium</em>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fung et al. (2020)</span>
<span class="ltx_bibblock">
Clement Fung, Chris JM Yoon, and Ivan Beschastnikh.

</span>
<span class="ltx_bibblock">The limitations of federated learning in sybil settings.

</span>
<span class="ltx_bibblock">23rd International Symposium on Research in Attacks, Intrusions and
Defenses (RAID), 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2015)</span>
<span class="ltx_bibblock">
Kaiming He, X. Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">2016 IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</em>, pp.  770–778, 2015.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky (2009)</span>
<span class="ltx_bibblock">
Alex Krizhevsky.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1998)</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE</em>, 86:2278–2324, 1998.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Henger Li, Xiaolin Sun, and Zizhan Zheng.

</span>
<span class="ltx_bibblock">Learning to attack federated learning: A model-based reinforcement
learning attack framework.

</span>
<span class="ltx_bibblock">In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho
(eds.), <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=4OHRr7gmhd4" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=4OHRr7gmhd4</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2016)</span>
<span class="ltx_bibblock">
H. B. McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Agüera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naseri et al. (2020)</span>
<span class="ltx_bibblock">
Mohammad Naseri, Jamie Hayes, and Emiliano De Cristofaro.

</span>
<span class="ltx_bibblock">Toward robustness and privacy in federated learning: Experimenting
with local and central differential privacy.

</span>
<span class="ltx_bibblock">arXiv, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2021)</span>
<span class="ltx_bibblock">
Jungwuk Park, Dong-Jun Han, Minseok Choi, and Jaekyun Moon.

</span>
<span class="ltx_bibblock">Sageflow: Robust federated learning against both stragglers and
adversaries.

</span>
<span class="ltx_bibblock">In M. Ranzato, A. Beygelzimer, Y. Dauphin, P.S. Liang, and J. Wortman
Vaughan (eds.), <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 34, pp.  840–851, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prakash et al. (2020)</span>
<span class="ltx_bibblock">
Saurav Prakash, Hanieh Hashemi, Yongqin Wang, Murali Annavaram, and Salman
Avestimehr.

</span>
<span class="ltx_bibblock">Secure and fault tolerant decentralized learning.

</span>
<span class="ltx_bibblock">2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Regatti et al. (2021)</span>
<span class="ltx_bibblock">
Jayanth Regatti, Hao Chen, and Abhishek Gupta.

</span>
<span class="ltx_bibblock">Bygars: Byzantine sgd with arbitrary number of attackers.

</span>
<span class="ltx_bibblock">International Workshop on Federated Learning for User Privacy and
Data Confidentiality in Conjunction with ICML, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Jingwei Sun, Ang Li, Louis DiValentin, Amin Hassanzadeh, Yiran Chen, and Hai
Li.

</span>
<span class="ltx_bibblock">Fl-wbc: Enhancing robustness against model poisoning attacks in
federated learning from a client perspective.

</span>
<span class="ltx_bibblock">NeurIPS, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Ziteng Sun, Peter Kairouz, Ananda Theertha Suresh, and H. Brendan McMahan.

</span>
<span class="ltx_bibblock">Can you really backdoor federated learning?

</span>
<span class="ltx_bibblock">arXiv, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolpegin et al. (2020)</span>
<span class="ltx_bibblock">
Vale Tolpegin, Stacey Truex, Mehmet Emre Gursoy, and Ling Liu.

</span>
<span class="ltx_bibblock">Data poisoning attacks against federated learning systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Computer Security – ESORICS 2020</em>, pp.  480–501. Springer
International Publishing, 2020.

</span>
<span class="ltx_bibblock">ISBN 978-3-030-58951-6.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2017)</span>
<span class="ltx_bibblock">
Han Xiao, Kashif Rasul, and Roland Vollgraf.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for benchmarking machine
learning algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1708.07747, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2019)</span>
<span class="ltx_bibblock">
Cong Xie, Oluwasanmi Koyejo, and Indranil Gupta.

</span>
<span class="ltx_bibblock">Fall of empires: Breaking byzantine-tolerant sgd by inner product
manipulation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">35th Conference on Uncertainty in Artificial Intelligence</em>,
2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu &amp; Lyu (2021)</span>
<span class="ltx_bibblock">
Xinyi Xu and Lingjuan Lyu.

</span>
<span class="ltx_bibblock">A reputation mechanism is all you need: Collaborative fairness and
adversarial robustness in federated learning.

</span>
<span class="ltx_bibblock">International Workshop on Federated Learning for User Privacy and
Data Confidentiality in Conjunction with ICML, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2018)</span>
<span class="ltx_bibblock">
Dong Yin, Yudong Chen, Ramchandran Kannan, and Peter Bartlett.

</span>
<span class="ltx_bibblock">Byzantine-robust distributed learning: Towards optimal statistical
rates.

</span>
<span class="ltx_bibblock">In Jennifer Dy and Andreas Krause (eds.), <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
35th International Conference on Machine Learning</em>, volume 80 of
<em id="bib.bib21.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  5650–5659. PMLR,
10–15 Jul 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v80/yin18a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v80/yin18a.html</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Tuo Zhang, Lei Gao, Chaoyang He, Mi Zhang, Bhaskar Krishnamachari, and Salman
Avestimehr.

</span>
<span class="ltx_bibblock">Federated learning for the internet of things: Applications,
challenges, and opportunities.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Magazine</em>, 5:24–29, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Tuo Zhang, Tiantian Feng, Samiul Alam, Sunwoo Lee, Mi Zhang, Shrikanth S
Narayanan, and Salman Avestimehr.

</span>
<span class="ltx_bibblock">Fedaudio: A federated learning benchmark for audio tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.15707</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2020)</span>
<span class="ltx_bibblock">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen.

</span>
<span class="ltx_bibblock">idlg: Improved deep leakage from gradients.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2001.02610, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zizzo et al. (2020)</span>
<span class="ltx_bibblock">
Giulio Zizzo, Ambrish Rawat, Mathieu Sinn, and Beat Buesser.

</span>
<span class="ltx_bibblock">Fat: Federated adversarial training.

</span>
<span class="ltx_bibblock">NeurIPS Workshop on Scalability, Privacy, and Security in Federated
Learning (SpicyFL), 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Preliminary</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Federated Learning</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.11" class="ltx_p">In this paper, we consider the federated learning setting that is similar to the vanilla FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>, in which the FL system is composed of a server with <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\mathcal{K}</annotation></semantics></math> clients, whose data is only locally kept without sharing. The clients cooperate in training a global model <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{W}_{g}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><msub id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">𝒲</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝒲</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\mathcal{W}_{g}</annotation></semantics></math> with parameters <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\theta</annotation></semantics></math>. We consider the following distributed optimization problem: <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="\min\limits_{\theta}f(\theta)" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mrow id="A1.SS1.p1.4.m4.1.2" xref="A1.SS1.p1.4.m4.1.2.cmml"><mrow id="A1.SS1.p1.4.m4.1.2.2" xref="A1.SS1.p1.4.m4.1.2.2.cmml"><munder id="A1.SS1.p1.4.m4.1.2.2.1" xref="A1.SS1.p1.4.m4.1.2.2.1.cmml"><mi id="A1.SS1.p1.4.m4.1.2.2.1.2" xref="A1.SS1.p1.4.m4.1.2.2.1.2.cmml">min</mi><mi id="A1.SS1.p1.4.m4.1.2.2.1.3" xref="A1.SS1.p1.4.m4.1.2.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="A1.SS1.p1.4.m4.1.2.2a" xref="A1.SS1.p1.4.m4.1.2.2.cmml">⁡</mo><mi id="A1.SS1.p1.4.m4.1.2.2.2" xref="A1.SS1.p1.4.m4.1.2.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="A1.SS1.p1.4.m4.1.2.1" xref="A1.SS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="A1.SS1.p1.4.m4.1.2.3.2" xref="A1.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.4.m4.1.2.3.2.1" xref="A1.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">θ</mi><mo stretchy="false" id="A1.SS1.p1.4.m4.1.2.3.2.2" xref="A1.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.2.cmml" xref="A1.SS1.p1.4.m4.1.2"><times id="A1.SS1.p1.4.m4.1.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.1"></times><apply id="A1.SS1.p1.4.m4.1.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2"><apply id="A1.SS1.p1.4.m4.1.2.2.1.cmml" xref="A1.SS1.p1.4.m4.1.2.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.2.2.1.1.cmml" xref="A1.SS1.p1.4.m4.1.2.2.1">subscript</csymbol><min id="A1.SS1.p1.4.m4.1.2.2.1.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2.1.2"></min><ci id="A1.SS1.p1.4.m4.1.2.2.1.3.cmml" xref="A1.SS1.p1.4.m4.1.2.2.1.3">𝜃</ci></apply><ci id="A1.SS1.p1.4.m4.1.2.2.2.cmml" xref="A1.SS1.p1.4.m4.1.2.2.2">𝑓</ci></apply><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\min\limits_{\theta}f(\theta)</annotation></semantics></math>, where <math id="A1.SS1.p1.5.m5.2" class="ltx_Math" alttext="f(\theta):=\sum_{i=1}^{\mathcal{K}}p_{i}F_{i}(\theta)" display="inline"><semantics id="A1.SS1.p1.5.m5.2a"><mrow id="A1.SS1.p1.5.m5.2.3" xref="A1.SS1.p1.5.m5.2.3.cmml"><mrow id="A1.SS1.p1.5.m5.2.3.2" xref="A1.SS1.p1.5.m5.2.3.2.cmml"><mi id="A1.SS1.p1.5.m5.2.3.2.2" xref="A1.SS1.p1.5.m5.2.3.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p1.5.m5.2.3.2.1" xref="A1.SS1.p1.5.m5.2.3.2.1.cmml">​</mo><mrow id="A1.SS1.p1.5.m5.2.3.2.3.2" xref="A1.SS1.p1.5.m5.2.3.2.cmml"><mo stretchy="false" id="A1.SS1.p1.5.m5.2.3.2.3.2.1" xref="A1.SS1.p1.5.m5.2.3.2.cmml">(</mo><mi id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="A1.SS1.p1.5.m5.2.3.2.3.2.2" xref="A1.SS1.p1.5.m5.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A1.SS1.p1.5.m5.2.3.1" xref="A1.SS1.p1.5.m5.2.3.1.cmml">:=</mo><mrow id="A1.SS1.p1.5.m5.2.3.3" xref="A1.SS1.p1.5.m5.2.3.3.cmml"><msubsup id="A1.SS1.p1.5.m5.2.3.3.1" xref="A1.SS1.p1.5.m5.2.3.3.1.cmml"><mo id="A1.SS1.p1.5.m5.2.3.3.1.2.2" xref="A1.SS1.p1.5.m5.2.3.3.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.5.m5.2.3.3.1.2.3" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.cmml"><mi id="A1.SS1.p1.5.m5.2.3.3.1.2.3.2" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.2.cmml">i</mi><mo id="A1.SS1.p1.5.m5.2.3.3.1.2.3.1" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.5.m5.2.3.3.1.2.3.3" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.5.m5.2.3.3.1.3" xref="A1.SS1.p1.5.m5.2.3.3.1.3.cmml">𝒦</mi></msubsup><mrow id="A1.SS1.p1.5.m5.2.3.3.2" xref="A1.SS1.p1.5.m5.2.3.3.2.cmml"><msub id="A1.SS1.p1.5.m5.2.3.3.2.2" xref="A1.SS1.p1.5.m5.2.3.3.2.2.cmml"><mi id="A1.SS1.p1.5.m5.2.3.3.2.2.2" xref="A1.SS1.p1.5.m5.2.3.3.2.2.2.cmml">p</mi><mi id="A1.SS1.p1.5.m5.2.3.3.2.2.3" xref="A1.SS1.p1.5.m5.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS1.p1.5.m5.2.3.3.2.1" xref="A1.SS1.p1.5.m5.2.3.3.2.1.cmml">​</mo><msub id="A1.SS1.p1.5.m5.2.3.3.2.3" xref="A1.SS1.p1.5.m5.2.3.3.2.3.cmml"><mi id="A1.SS1.p1.5.m5.2.3.3.2.3.2" xref="A1.SS1.p1.5.m5.2.3.3.2.3.2.cmml">F</mi><mi id="A1.SS1.p1.5.m5.2.3.3.2.3.3" xref="A1.SS1.p1.5.m5.2.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS1.p1.5.m5.2.3.3.2.1a" xref="A1.SS1.p1.5.m5.2.3.3.2.1.cmml">​</mo><mrow id="A1.SS1.p1.5.m5.2.3.3.2.4.2" xref="A1.SS1.p1.5.m5.2.3.3.2.cmml"><mo stretchy="false" id="A1.SS1.p1.5.m5.2.3.3.2.4.2.1" xref="A1.SS1.p1.5.m5.2.3.3.2.cmml">(</mo><mi id="A1.SS1.p1.5.m5.2.2" xref="A1.SS1.p1.5.m5.2.2.cmml">θ</mi><mo stretchy="false" id="A1.SS1.p1.5.m5.2.3.3.2.4.2.2" xref="A1.SS1.p1.5.m5.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.2b"><apply id="A1.SS1.p1.5.m5.2.3.cmml" xref="A1.SS1.p1.5.m5.2.3"><csymbol cd="latexml" id="A1.SS1.p1.5.m5.2.3.1.cmml" xref="A1.SS1.p1.5.m5.2.3.1">assign</csymbol><apply id="A1.SS1.p1.5.m5.2.3.2.cmml" xref="A1.SS1.p1.5.m5.2.3.2"><times id="A1.SS1.p1.5.m5.2.3.2.1.cmml" xref="A1.SS1.p1.5.m5.2.3.2.1"></times><ci id="A1.SS1.p1.5.m5.2.3.2.2.cmml" xref="A1.SS1.p1.5.m5.2.3.2.2">𝑓</ci><ci id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">𝜃</ci></apply><apply id="A1.SS1.p1.5.m5.2.3.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3"><apply id="A1.SS1.p1.5.m5.2.3.3.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.2.3.3.1.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1">superscript</csymbol><apply id="A1.SS1.p1.5.m5.2.3.3.1.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.2.3.3.1.2.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1">subscript</csymbol><sum id="A1.SS1.p1.5.m5.2.3.3.1.2.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.2.2"></sum><apply id="A1.SS1.p1.5.m5.2.3.3.1.2.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3"><eq id="A1.SS1.p1.5.m5.2.3.3.1.2.3.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.1"></eq><ci id="A1.SS1.p1.5.m5.2.3.3.1.2.3.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="A1.SS1.p1.5.m5.2.3.3.1.2.3.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="A1.SS1.p1.5.m5.2.3.3.1.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.1.3">𝒦</ci></apply><apply id="A1.SS1.p1.5.m5.2.3.3.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2"><times id="A1.SS1.p1.5.m5.2.3.3.2.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.1"></times><apply id="A1.SS1.p1.5.m5.2.3.3.2.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.2.3.3.2.2.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.2">subscript</csymbol><ci id="A1.SS1.p1.5.m5.2.3.3.2.2.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.2.2">𝑝</ci><ci id="A1.SS1.p1.5.m5.2.3.3.2.2.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.2.3">𝑖</ci></apply><apply id="A1.SS1.p1.5.m5.2.3.3.2.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.2.3.3.2.3.1.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.3">subscript</csymbol><ci id="A1.SS1.p1.5.m5.2.3.3.2.3.2.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.3.2">𝐹</ci><ci id="A1.SS1.p1.5.m5.2.3.3.2.3.3.cmml" xref="A1.SS1.p1.5.m5.2.3.3.2.3.3">𝑖</ci></apply><ci id="A1.SS1.p1.5.m5.2.2.cmml" xref="A1.SS1.p1.5.m5.2.2">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.2c">f(\theta):=\sum_{i=1}^{\mathcal{K}}p_{i}F_{i}(\theta)</annotation></semantics></math>. The <math id="A1.SS1.p1.6.m6.1" class="ltx_Math" alttext="F_{i}(\cdot)" display="inline"><semantics id="A1.SS1.p1.6.m6.1a"><mrow id="A1.SS1.p1.6.m6.1.2" xref="A1.SS1.p1.6.m6.1.2.cmml"><msub id="A1.SS1.p1.6.m6.1.2.2" xref="A1.SS1.p1.6.m6.1.2.2.cmml"><mi id="A1.SS1.p1.6.m6.1.2.2.2" xref="A1.SS1.p1.6.m6.1.2.2.2.cmml">F</mi><mi id="A1.SS1.p1.6.m6.1.2.2.3" xref="A1.SS1.p1.6.m6.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS1.p1.6.m6.1.2.1" xref="A1.SS1.p1.6.m6.1.2.1.cmml">​</mo><mrow id="A1.SS1.p1.6.m6.1.2.3.2" xref="A1.SS1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.6.m6.1.2.3.2.1" xref="A1.SS1.p1.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="A1.SS1.p1.6.m6.1.2.3.2.2" xref="A1.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><apply id="A1.SS1.p1.6.m6.1.2.cmml" xref="A1.SS1.p1.6.m6.1.2"><times id="A1.SS1.p1.6.m6.1.2.1.cmml" xref="A1.SS1.p1.6.m6.1.2.1"></times><apply id="A1.SS1.p1.6.m6.1.2.2.cmml" xref="A1.SS1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m6.1.2.2.1.cmml" xref="A1.SS1.p1.6.m6.1.2.2">subscript</csymbol><ci id="A1.SS1.p1.6.m6.1.2.2.2.cmml" xref="A1.SS1.p1.6.m6.1.2.2.2">𝐹</ci><ci id="A1.SS1.p1.6.m6.1.2.2.3.cmml" xref="A1.SS1.p1.6.m6.1.2.2.3">𝑖</ci></apply><ci id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">F_{i}(\cdot)</annotation></semantics></math> represents the local objective of client <math id="A1.SS1.p1.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">i</annotation></semantics></math> and <math id="A1.SS1.p1.8.m8.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="A1.SS1.p1.8.m8.1a"><msub id="A1.SS1.p1.8.m8.1.1" xref="A1.SS1.p1.8.m8.1.1.cmml"><mi id="A1.SS1.p1.8.m8.1.1.2" xref="A1.SS1.p1.8.m8.1.1.2.cmml">p</mi><mi id="A1.SS1.p1.8.m8.1.1.3" xref="A1.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m8.1b"><apply id="A1.SS1.p1.8.m8.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="A1.SS1.p1.8.m8.1.1.2.cmml" xref="A1.SS1.p1.8.m8.1.1.2">𝑝</ci><ci id="A1.SS1.p1.8.m8.1.1.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">p_{i}</annotation></semantics></math> denotes the aggregation weight of client <math id="A1.SS1.p1.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.p1.9.m9.1a"><mi id="A1.SS1.p1.9.m9.1.1" xref="A1.SS1.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m9.1b"><ci id="A1.SS1.p1.9.m9.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m9.1c">i</annotation></semantics></math> satisfying <math id="A1.SS1.p1.10.m10.1" class="ltx_Math" alttext="p_{i}\geq 0" display="inline"><semantics id="A1.SS1.p1.10.m10.1a"><mrow id="A1.SS1.p1.10.m10.1.1" xref="A1.SS1.p1.10.m10.1.1.cmml"><msub id="A1.SS1.p1.10.m10.1.1.2" xref="A1.SS1.p1.10.m10.1.1.2.cmml"><mi id="A1.SS1.p1.10.m10.1.1.2.2" xref="A1.SS1.p1.10.m10.1.1.2.2.cmml">p</mi><mi id="A1.SS1.p1.10.m10.1.1.2.3" xref="A1.SS1.p1.10.m10.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS1.p1.10.m10.1.1.1" xref="A1.SS1.p1.10.m10.1.1.1.cmml">≥</mo><mn id="A1.SS1.p1.10.m10.1.1.3" xref="A1.SS1.p1.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m10.1b"><apply id="A1.SS1.p1.10.m10.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1"><geq id="A1.SS1.p1.10.m10.1.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1.1"></geq><apply id="A1.SS1.p1.10.m10.1.1.2.cmml" xref="A1.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.10.m10.1.1.2.1.cmml" xref="A1.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.10.m10.1.1.2.2.cmml" xref="A1.SS1.p1.10.m10.1.1.2.2">𝑝</ci><ci id="A1.SS1.p1.10.m10.1.1.2.3.cmml" xref="A1.SS1.p1.10.m10.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.SS1.p1.10.m10.1.1.3.cmml" xref="A1.SS1.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m10.1c">p_{i}\geq 0</annotation></semantics></math> and <math id="A1.SS1.p1.11.m11.1" class="ltx_Math" alttext="\sum_{i=1}^{\mathcal{C}}p_{i}=1" display="inline"><semantics id="A1.SS1.p1.11.m11.1a"><mrow id="A1.SS1.p1.11.m11.1.1" xref="A1.SS1.p1.11.m11.1.1.cmml"><mrow id="A1.SS1.p1.11.m11.1.1.2" xref="A1.SS1.p1.11.m11.1.1.2.cmml"><msubsup id="A1.SS1.p1.11.m11.1.1.2.1" xref="A1.SS1.p1.11.m11.1.1.2.1.cmml"><mo id="A1.SS1.p1.11.m11.1.1.2.1.2.2" xref="A1.SS1.p1.11.m11.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.11.m11.1.1.2.1.2.3" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.cmml"><mi id="A1.SS1.p1.11.m11.1.1.2.1.2.3.2" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.2.cmml">i</mi><mo id="A1.SS1.p1.11.m11.1.1.2.1.2.3.1" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.11.m11.1.1.2.1.2.3.3" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.11.m11.1.1.2.1.3" xref="A1.SS1.p1.11.m11.1.1.2.1.3.cmml">𝒞</mi></msubsup><msub id="A1.SS1.p1.11.m11.1.1.2.2" xref="A1.SS1.p1.11.m11.1.1.2.2.cmml"><mi id="A1.SS1.p1.11.m11.1.1.2.2.2" xref="A1.SS1.p1.11.m11.1.1.2.2.2.cmml">p</mi><mi id="A1.SS1.p1.11.m11.1.1.2.2.3" xref="A1.SS1.p1.11.m11.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="A1.SS1.p1.11.m11.1.1.1" xref="A1.SS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="A1.SS1.p1.11.m11.1.1.3" xref="A1.SS1.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m11.1b"><apply id="A1.SS1.p1.11.m11.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1"><eq id="A1.SS1.p1.11.m11.1.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1.1"></eq><apply id="A1.SS1.p1.11.m11.1.1.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2"><apply id="A1.SS1.p1.11.m11.1.1.2.1.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.11.m11.1.1.2.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1">superscript</csymbol><apply id="A1.SS1.p1.11.m11.1.1.2.1.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.11.m11.1.1.2.1.2.1.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1">subscript</csymbol><sum id="A1.SS1.p1.11.m11.1.1.2.1.2.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.2.2"></sum><apply id="A1.SS1.p1.11.m11.1.1.2.1.2.3.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3"><eq id="A1.SS1.p1.11.m11.1.1.2.1.2.3.1.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.1"></eq><ci id="A1.SS1.p1.11.m11.1.1.2.1.2.3.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="A1.SS1.p1.11.m11.1.1.2.1.2.3.3.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A1.SS1.p1.11.m11.1.1.2.1.3.cmml" xref="A1.SS1.p1.11.m11.1.1.2.1.3">𝒞</ci></apply><apply id="A1.SS1.p1.11.m11.1.1.2.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.11.m11.1.1.2.2.1.cmml" xref="A1.SS1.p1.11.m11.1.1.2.2">subscript</csymbol><ci id="A1.SS1.p1.11.m11.1.1.2.2.2.cmml" xref="A1.SS1.p1.11.m11.1.1.2.2.2">𝑝</ci><ci id="A1.SS1.p1.11.m11.1.1.2.2.3.cmml" xref="A1.SS1.p1.11.m11.1.1.2.2.3">𝑖</ci></apply></apply><cn type="integer" id="A1.SS1.p1.11.m11.1.1.3.cmml" xref="A1.SS1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m11.1c">\sum_{i=1}^{\mathcal{C}}p_{i}=1</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.p2.16" class="ltx_p">The federated learning algorithm runs as follows: in each communication round <math id="A1.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A1.SS1.p2.1.m1.1a"><mi id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><ci id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">t</annotation></semantics></math>, the server randomly selects a subset <math id="A1.SS1.p2.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="A1.SS1.p2.2.m2.1a"><msub id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml"><mi id="A1.SS1.p2.2.m2.1.1.2" xref="A1.SS1.p2.2.m2.1.1.2.cmml">S</mi><mi id="A1.SS1.p2.2.m2.1.1.3" xref="A1.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.p2.2.m2.1.1.2">𝑆</ci><ci id="A1.SS1.p2.2.m2.1.1.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">S_{t}</annotation></semantics></math> from available clients for client sampling and sends the global model parameters <math id="A1.SS1.p2.3.m3.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="A1.SS1.p2.3.m3.1a"><msub id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml"><mi id="A1.SS1.p2.3.m3.1.1.2" xref="A1.SS1.p2.3.m3.1.1.2.cmml">θ</mi><mi id="A1.SS1.p2.3.m3.1.1.3" xref="A1.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><apply id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.3.m3.1.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p2.3.m3.1.1.2.cmml" xref="A1.SS1.p2.3.m3.1.1.2">𝜃</ci><ci id="A1.SS1.p2.3.m3.1.1.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">\theta_{t}</annotation></semantics></math> to the selected clients. Each selected client <math id="A1.SS1.p2.4.m4.1" class="ltx_Math" alttext="i\in S_{t}" display="inline"><semantics id="A1.SS1.p2.4.m4.1a"><mrow id="A1.SS1.p2.4.m4.1.1" xref="A1.SS1.p2.4.m4.1.1.cmml"><mi id="A1.SS1.p2.4.m4.1.1.2" xref="A1.SS1.p2.4.m4.1.1.2.cmml">i</mi><mo id="A1.SS1.p2.4.m4.1.1.1" xref="A1.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msub id="A1.SS1.p2.4.m4.1.1.3" xref="A1.SS1.p2.4.m4.1.1.3.cmml"><mi id="A1.SS1.p2.4.m4.1.1.3.2" xref="A1.SS1.p2.4.m4.1.1.3.2.cmml">S</mi><mi id="A1.SS1.p2.4.m4.1.1.3.3" xref="A1.SS1.p2.4.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.1b"><apply id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1"><in id="A1.SS1.p2.4.m4.1.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1.1"></in><ci id="A1.SS1.p2.4.m4.1.1.2.cmml" xref="A1.SS1.p2.4.m4.1.1.2">𝑖</ci><apply id="A1.SS1.p2.4.m4.1.1.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.1.1.3.1.cmml" xref="A1.SS1.p2.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS1.p2.4.m4.1.1.3.2.cmml" xref="A1.SS1.p2.4.m4.1.1.3.2">𝑆</ci><ci id="A1.SS1.p2.4.m4.1.1.3.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.1c">i\in S_{t}</annotation></semantics></math> initializes its local model parameters as <math id="A1.SS1.p2.5.m5.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="A1.SS1.p2.5.m5.1a"><msub id="A1.SS1.p2.5.m5.1.1" xref="A1.SS1.p2.5.m5.1.1.cmml"><mi id="A1.SS1.p2.5.m5.1.1.2" xref="A1.SS1.p2.5.m5.1.1.2.cmml">θ</mi><mi id="A1.SS1.p2.5.m5.1.1.3" xref="A1.SS1.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m5.1b"><apply id="A1.SS1.p2.5.m5.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m5.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="A1.SS1.p2.5.m5.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.2">𝜃</ci><ci id="A1.SS1.p2.5.m5.1.1.3.cmml" xref="A1.SS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m5.1c">\theta_{t}</annotation></semantics></math> and performs local model updates <math id="A1.SS1.p2.6.m6.2" class="ltx_Math" alttext="\theta^{i}_{t+1}=\theta_{t}-\eta\frac{1}{B}\sum_{z\in b_{i}}\nabla_{\theta}\ell(\theta_{t};z)" display="inline"><semantics id="A1.SS1.p2.6.m6.2a"><mrow id="A1.SS1.p2.6.m6.2.2" xref="A1.SS1.p2.6.m6.2.2.cmml"><msubsup id="A1.SS1.p2.6.m6.2.2.3" xref="A1.SS1.p2.6.m6.2.2.3.cmml"><mi id="A1.SS1.p2.6.m6.2.2.3.2.2" xref="A1.SS1.p2.6.m6.2.2.3.2.2.cmml">θ</mi><mrow id="A1.SS1.p2.6.m6.2.2.3.3" xref="A1.SS1.p2.6.m6.2.2.3.3.cmml"><mi id="A1.SS1.p2.6.m6.2.2.3.3.2" xref="A1.SS1.p2.6.m6.2.2.3.3.2.cmml">t</mi><mo id="A1.SS1.p2.6.m6.2.2.3.3.1" xref="A1.SS1.p2.6.m6.2.2.3.3.1.cmml">+</mo><mn id="A1.SS1.p2.6.m6.2.2.3.3.3" xref="A1.SS1.p2.6.m6.2.2.3.3.3.cmml">1</mn></mrow><mi id="A1.SS1.p2.6.m6.2.2.3.2.3" xref="A1.SS1.p2.6.m6.2.2.3.2.3.cmml">i</mi></msubsup><mo id="A1.SS1.p2.6.m6.2.2.2" xref="A1.SS1.p2.6.m6.2.2.2.cmml">=</mo><mrow id="A1.SS1.p2.6.m6.2.2.1" xref="A1.SS1.p2.6.m6.2.2.1.cmml"><msub id="A1.SS1.p2.6.m6.2.2.1.3" xref="A1.SS1.p2.6.m6.2.2.1.3.cmml"><mi id="A1.SS1.p2.6.m6.2.2.1.3.2" xref="A1.SS1.p2.6.m6.2.2.1.3.2.cmml">θ</mi><mi id="A1.SS1.p2.6.m6.2.2.1.3.3" xref="A1.SS1.p2.6.m6.2.2.1.3.3.cmml">t</mi></msub><mo id="A1.SS1.p2.6.m6.2.2.1.2" xref="A1.SS1.p2.6.m6.2.2.1.2.cmml">−</mo><mrow id="A1.SS1.p2.6.m6.2.2.1.1" xref="A1.SS1.p2.6.m6.2.2.1.1.cmml"><mi id="A1.SS1.p2.6.m6.2.2.1.1.3" xref="A1.SS1.p2.6.m6.2.2.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p2.6.m6.2.2.1.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.2.cmml">​</mo><mfrac id="A1.SS1.p2.6.m6.2.2.1.1.4" xref="A1.SS1.p2.6.m6.2.2.1.1.4.cmml"><mn id="A1.SS1.p2.6.m6.2.2.1.1.4.2" xref="A1.SS1.p2.6.m6.2.2.1.1.4.2.cmml">1</mn><mi id="A1.SS1.p2.6.m6.2.2.1.1.4.3" xref="A1.SS1.p2.6.m6.2.2.1.1.4.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="A1.SS1.p2.6.m6.2.2.1.1.2a" xref="A1.SS1.p2.6.m6.2.2.1.1.2.cmml">​</mo><mrow id="A1.SS1.p2.6.m6.2.2.1.1.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.cmml"><msub id="A1.SS1.p2.6.m6.2.2.1.1.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.cmml"><mo id="A1.SS1.p2.6.m6.2.2.1.1.1.2.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml"><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.2.cmml">z</mi><mo id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.1.cmml">∈</mo><msub id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.cmml"><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.2.cmml">b</mi><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></msub><mrow id="A1.SS1.p2.6.m6.2.2.1.1.1.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.cmml"><mrow id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml"><msub id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.cmml"><mo rspace="0.167em" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.2.cmml">∇</mo><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.3.cmml">θ</mi></msub><mi mathvariant="normal" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.2" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.3" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="A1.SS1.p2.6.m6.1.1" xref="A1.SS1.p2.6.m6.1.1.cmml">z</mi><mo stretchy="false" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.4" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m6.2b"><apply id="A1.SS1.p2.6.m6.2.2.cmml" xref="A1.SS1.p2.6.m6.2.2"><eq id="A1.SS1.p2.6.m6.2.2.2.cmml" xref="A1.SS1.p2.6.m6.2.2.2"></eq><apply id="A1.SS1.p2.6.m6.2.2.3.cmml" xref="A1.SS1.p2.6.m6.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.3">subscript</csymbol><apply id="A1.SS1.p2.6.m6.2.2.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.3.2.1.cmml" xref="A1.SS1.p2.6.m6.2.2.3">superscript</csymbol><ci id="A1.SS1.p2.6.m6.2.2.3.2.2.cmml" xref="A1.SS1.p2.6.m6.2.2.3.2.2">𝜃</ci><ci id="A1.SS1.p2.6.m6.2.2.3.2.3.cmml" xref="A1.SS1.p2.6.m6.2.2.3.2.3">𝑖</ci></apply><apply id="A1.SS1.p2.6.m6.2.2.3.3.cmml" xref="A1.SS1.p2.6.m6.2.2.3.3"><plus id="A1.SS1.p2.6.m6.2.2.3.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.3.3.1"></plus><ci id="A1.SS1.p2.6.m6.2.2.3.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.3.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.6.m6.2.2.3.3.3.cmml" xref="A1.SS1.p2.6.m6.2.2.3.3.3">1</cn></apply></apply><apply id="A1.SS1.p2.6.m6.2.2.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1"><minus id="A1.SS1.p2.6.m6.2.2.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.2"></minus><apply id="A1.SS1.p2.6.m6.2.2.1.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.1.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.3">subscript</csymbol><ci id="A1.SS1.p2.6.m6.2.2.1.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.3.2">𝜃</ci><ci id="A1.SS1.p2.6.m6.2.2.1.3.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.3.3">𝑡</ci></apply><apply id="A1.SS1.p2.6.m6.2.2.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1"><times id="A1.SS1.p2.6.m6.2.2.1.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.2"></times><ci id="A1.SS1.p2.6.m6.2.2.1.1.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.3">𝜂</ci><apply id="A1.SS1.p2.6.m6.2.2.1.1.4.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.4"><divide id="A1.SS1.p2.6.m6.2.2.1.1.4.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.4"></divide><cn type="integer" id="A1.SS1.p2.6.m6.2.2.1.1.4.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.4.2">1</cn><ci id="A1.SS1.p2.6.m6.2.2.1.1.4.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.4.3">𝐵</ci></apply><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1"><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.1.1.1.2.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2">subscript</csymbol><sum id="A1.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.2"></sum><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3"><in id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.1"></in><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.2">𝑧</ci><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3">subscript</csymbol><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.2">𝑏</ci><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1"><times id="A1.SS1.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.2"></times><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3"><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1">subscript</csymbol><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.2">∇</ci><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.1.3">𝜃</ci></apply><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.3.2">ℓ</ci></apply><list id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1"><apply id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.6.m6.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="A1.SS1.p2.6.m6.1.1.cmml" xref="A1.SS1.p2.6.m6.1.1">𝑧</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m6.2c">\theta^{i}_{t+1}=\theta_{t}-\eta\frac{1}{B}\sum_{z\in b_{i}}\nabla_{\theta}\ell(\theta_{t};z)</annotation></semantics></math>, where <math id="A1.SS1.p2.7.m7.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="A1.SS1.p2.7.m7.1a"><mi id="A1.SS1.p2.7.m7.1.1" xref="A1.SS1.p2.7.m7.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.7.m7.1b"><ci id="A1.SS1.p2.7.m7.1.1.cmml" xref="A1.SS1.p2.7.m7.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.7.m7.1c">\eta</annotation></semantics></math> is learning rate, <math id="A1.SS1.p2.8.m8.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="A1.SS1.p2.8.m8.1a"><msub id="A1.SS1.p2.8.m8.1.1" xref="A1.SS1.p2.8.m8.1.1.cmml"><mi id="A1.SS1.p2.8.m8.1.1.2" xref="A1.SS1.p2.8.m8.1.1.2.cmml">b</mi><mi id="A1.SS1.p2.8.m8.1.1.3" xref="A1.SS1.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.8.m8.1b"><apply id="A1.SS1.p2.8.m8.1.1.cmml" xref="A1.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m8.1.1.1.cmml" xref="A1.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="A1.SS1.p2.8.m8.1.1.2.cmml" xref="A1.SS1.p2.8.m8.1.1.2">𝑏</ci><ci id="A1.SS1.p2.8.m8.1.1.3.cmml" xref="A1.SS1.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.8.m8.1c">b_{i}</annotation></semantics></math> is a mini-batch of size <math id="A1.SS1.p2.9.m9.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A1.SS1.p2.9.m9.1a"><mi id="A1.SS1.p2.9.m9.1.1" xref="A1.SS1.p2.9.m9.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.9.m9.1b"><ci id="A1.SS1.p2.9.m9.1.1.cmml" xref="A1.SS1.p2.9.m9.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.9.m9.1c">B</annotation></semantics></math> randomly sampled from local data <math id="A1.SS1.p2.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="A1.SS1.p2.10.m10.1a"><msub id="A1.SS1.p2.10.m10.1.1" xref="A1.SS1.p2.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.10.m10.1.1.2" xref="A1.SS1.p2.10.m10.1.1.2.cmml">𝒟</mi><mi id="A1.SS1.p2.10.m10.1.1.3" xref="A1.SS1.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.10.m10.1b"><apply id="A1.SS1.p2.10.m10.1.1.cmml" xref="A1.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.10.m10.1.1.1.cmml" xref="A1.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="A1.SS1.p2.10.m10.1.1.2.cmml" xref="A1.SS1.p2.10.m10.1.1.2">𝒟</ci><ci id="A1.SS1.p2.10.m10.1.1.3.cmml" xref="A1.SS1.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.10.m10.1c">\mathcal{D}_{i}</annotation></semantics></math>. After local update finishes, each client <math id="A1.SS1.p2.11.m11.1" class="ltx_Math" alttext="i\in S_{t}" display="inline"><semantics id="A1.SS1.p2.11.m11.1a"><mrow id="A1.SS1.p2.11.m11.1.1" xref="A1.SS1.p2.11.m11.1.1.cmml"><mi id="A1.SS1.p2.11.m11.1.1.2" xref="A1.SS1.p2.11.m11.1.1.2.cmml">i</mi><mo id="A1.SS1.p2.11.m11.1.1.1" xref="A1.SS1.p2.11.m11.1.1.1.cmml">∈</mo><msub id="A1.SS1.p2.11.m11.1.1.3" xref="A1.SS1.p2.11.m11.1.1.3.cmml"><mi id="A1.SS1.p2.11.m11.1.1.3.2" xref="A1.SS1.p2.11.m11.1.1.3.2.cmml">S</mi><mi id="A1.SS1.p2.11.m11.1.1.3.3" xref="A1.SS1.p2.11.m11.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.11.m11.1b"><apply id="A1.SS1.p2.11.m11.1.1.cmml" xref="A1.SS1.p2.11.m11.1.1"><in id="A1.SS1.p2.11.m11.1.1.1.cmml" xref="A1.SS1.p2.11.m11.1.1.1"></in><ci id="A1.SS1.p2.11.m11.1.1.2.cmml" xref="A1.SS1.p2.11.m11.1.1.2">𝑖</ci><apply id="A1.SS1.p2.11.m11.1.1.3.cmml" xref="A1.SS1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.11.m11.1.1.3.1.cmml" xref="A1.SS1.p2.11.m11.1.1.3">subscript</csymbol><ci id="A1.SS1.p2.11.m11.1.1.3.2.cmml" xref="A1.SS1.p2.11.m11.1.1.3.2">𝑆</ci><ci id="A1.SS1.p2.11.m11.1.1.3.3.cmml" xref="A1.SS1.p2.11.m11.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.11.m11.1c">i\in S_{t}</annotation></semantics></math> send the model update <math id="A1.SS1.p2.12.m12.1" class="ltx_Math" alttext="g^{i}_{t+1}:=\theta^{i}_{t+1}-\theta_{t}" display="inline"><semantics id="A1.SS1.p2.12.m12.1a"><mrow id="A1.SS1.p2.12.m12.1.1" xref="A1.SS1.p2.12.m12.1.1.cmml"><msubsup id="A1.SS1.p2.12.m12.1.1.2" xref="A1.SS1.p2.12.m12.1.1.2.cmml"><mi id="A1.SS1.p2.12.m12.1.1.2.2.2" xref="A1.SS1.p2.12.m12.1.1.2.2.2.cmml">g</mi><mrow id="A1.SS1.p2.12.m12.1.1.2.3" xref="A1.SS1.p2.12.m12.1.1.2.3.cmml"><mi id="A1.SS1.p2.12.m12.1.1.2.3.2" xref="A1.SS1.p2.12.m12.1.1.2.3.2.cmml">t</mi><mo id="A1.SS1.p2.12.m12.1.1.2.3.1" xref="A1.SS1.p2.12.m12.1.1.2.3.1.cmml">+</mo><mn id="A1.SS1.p2.12.m12.1.1.2.3.3" xref="A1.SS1.p2.12.m12.1.1.2.3.3.cmml">1</mn></mrow><mi id="A1.SS1.p2.12.m12.1.1.2.2.3" xref="A1.SS1.p2.12.m12.1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0.278em" rspace="0.278em" id="A1.SS1.p2.12.m12.1.1.1" xref="A1.SS1.p2.12.m12.1.1.1.cmml">:=</mo><mrow id="A1.SS1.p2.12.m12.1.1.3" xref="A1.SS1.p2.12.m12.1.1.3.cmml"><msubsup id="A1.SS1.p2.12.m12.1.1.3.2" xref="A1.SS1.p2.12.m12.1.1.3.2.cmml"><mi id="A1.SS1.p2.12.m12.1.1.3.2.2.2" xref="A1.SS1.p2.12.m12.1.1.3.2.2.2.cmml">θ</mi><mrow id="A1.SS1.p2.12.m12.1.1.3.2.3" xref="A1.SS1.p2.12.m12.1.1.3.2.3.cmml"><mi id="A1.SS1.p2.12.m12.1.1.3.2.3.2" xref="A1.SS1.p2.12.m12.1.1.3.2.3.2.cmml">t</mi><mo id="A1.SS1.p2.12.m12.1.1.3.2.3.1" xref="A1.SS1.p2.12.m12.1.1.3.2.3.1.cmml">+</mo><mn id="A1.SS1.p2.12.m12.1.1.3.2.3.3" xref="A1.SS1.p2.12.m12.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="A1.SS1.p2.12.m12.1.1.3.2.2.3" xref="A1.SS1.p2.12.m12.1.1.3.2.2.3.cmml">i</mi></msubsup><mo id="A1.SS1.p2.12.m12.1.1.3.1" xref="A1.SS1.p2.12.m12.1.1.3.1.cmml">−</mo><msub id="A1.SS1.p2.12.m12.1.1.3.3" xref="A1.SS1.p2.12.m12.1.1.3.3.cmml"><mi id="A1.SS1.p2.12.m12.1.1.3.3.2" xref="A1.SS1.p2.12.m12.1.1.3.3.2.cmml">θ</mi><mi id="A1.SS1.p2.12.m12.1.1.3.3.3" xref="A1.SS1.p2.12.m12.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.12.m12.1b"><apply id="A1.SS1.p2.12.m12.1.1.cmml" xref="A1.SS1.p2.12.m12.1.1"><csymbol cd="latexml" id="A1.SS1.p2.12.m12.1.1.1.cmml" xref="A1.SS1.p2.12.m12.1.1.1">assign</csymbol><apply id="A1.SS1.p2.12.m12.1.1.2.cmml" xref="A1.SS1.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.12.m12.1.1.2.1.cmml" xref="A1.SS1.p2.12.m12.1.1.2">subscript</csymbol><apply id="A1.SS1.p2.12.m12.1.1.2.2.cmml" xref="A1.SS1.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.12.m12.1.1.2.2.1.cmml" xref="A1.SS1.p2.12.m12.1.1.2">superscript</csymbol><ci id="A1.SS1.p2.12.m12.1.1.2.2.2.cmml" xref="A1.SS1.p2.12.m12.1.1.2.2.2">𝑔</ci><ci id="A1.SS1.p2.12.m12.1.1.2.2.3.cmml" xref="A1.SS1.p2.12.m12.1.1.2.2.3">𝑖</ci></apply><apply id="A1.SS1.p2.12.m12.1.1.2.3.cmml" xref="A1.SS1.p2.12.m12.1.1.2.3"><plus id="A1.SS1.p2.12.m12.1.1.2.3.1.cmml" xref="A1.SS1.p2.12.m12.1.1.2.3.1"></plus><ci id="A1.SS1.p2.12.m12.1.1.2.3.2.cmml" xref="A1.SS1.p2.12.m12.1.1.2.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.12.m12.1.1.2.3.3.cmml" xref="A1.SS1.p2.12.m12.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS1.p2.12.m12.1.1.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3"><minus id="A1.SS1.p2.12.m12.1.1.3.1.cmml" xref="A1.SS1.p2.12.m12.1.1.3.1"></minus><apply id="A1.SS1.p2.12.m12.1.1.3.2.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p2.12.m12.1.1.3.2.1.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2">subscript</csymbol><apply id="A1.SS1.p2.12.m12.1.1.3.2.2.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p2.12.m12.1.1.3.2.2.1.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2">superscript</csymbol><ci id="A1.SS1.p2.12.m12.1.1.3.2.2.2.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.2.2">𝜃</ci><ci id="A1.SS1.p2.12.m12.1.1.3.2.2.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.2.3">𝑖</ci></apply><apply id="A1.SS1.p2.12.m12.1.1.3.2.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.3"><plus id="A1.SS1.p2.12.m12.1.1.3.2.3.1.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.3.1"></plus><ci id="A1.SS1.p2.12.m12.1.1.3.2.3.2.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.12.m12.1.1.3.2.3.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3.2.3.3">1</cn></apply></apply><apply id="A1.SS1.p2.12.m12.1.1.3.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.12.m12.1.1.3.3.1.cmml" xref="A1.SS1.p2.12.m12.1.1.3.3">subscript</csymbol><ci id="A1.SS1.p2.12.m12.1.1.3.3.2.cmml" xref="A1.SS1.p2.12.m12.1.1.3.3.2">𝜃</ci><ci id="A1.SS1.p2.12.m12.1.1.3.3.3.cmml" xref="A1.SS1.p2.12.m12.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.12.m12.1c">g^{i}_{t+1}:=\theta^{i}_{t+1}-\theta_{t}</annotation></semantics></math> to the server. Lastly, the server performs the aggregation function over the received model updates and obtains a new global model such that <math id="A1.SS1.p2.13.m13.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\theta_{t}-G_{t}" display="inline"><semantics id="A1.SS1.p2.13.m13.1a"><mrow id="A1.SS1.p2.13.m13.1.1" xref="A1.SS1.p2.13.m13.1.1.cmml"><msub id="A1.SS1.p2.13.m13.1.1.2" xref="A1.SS1.p2.13.m13.1.1.2.cmml"><mi id="A1.SS1.p2.13.m13.1.1.2.2" xref="A1.SS1.p2.13.m13.1.1.2.2.cmml">θ</mi><mrow id="A1.SS1.p2.13.m13.1.1.2.3" xref="A1.SS1.p2.13.m13.1.1.2.3.cmml"><mi id="A1.SS1.p2.13.m13.1.1.2.3.2" xref="A1.SS1.p2.13.m13.1.1.2.3.2.cmml">t</mi><mo id="A1.SS1.p2.13.m13.1.1.2.3.1" xref="A1.SS1.p2.13.m13.1.1.2.3.1.cmml">+</mo><mn id="A1.SS1.p2.13.m13.1.1.2.3.3" xref="A1.SS1.p2.13.m13.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="A1.SS1.p2.13.m13.1.1.1" xref="A1.SS1.p2.13.m13.1.1.1.cmml">←</mo><mrow id="A1.SS1.p2.13.m13.1.1.3" xref="A1.SS1.p2.13.m13.1.1.3.cmml"><msub id="A1.SS1.p2.13.m13.1.1.3.2" xref="A1.SS1.p2.13.m13.1.1.3.2.cmml"><mi id="A1.SS1.p2.13.m13.1.1.3.2.2" xref="A1.SS1.p2.13.m13.1.1.3.2.2.cmml">θ</mi><mi id="A1.SS1.p2.13.m13.1.1.3.2.3" xref="A1.SS1.p2.13.m13.1.1.3.2.3.cmml">t</mi></msub><mo id="A1.SS1.p2.13.m13.1.1.3.1" xref="A1.SS1.p2.13.m13.1.1.3.1.cmml">−</mo><msub id="A1.SS1.p2.13.m13.1.1.3.3" xref="A1.SS1.p2.13.m13.1.1.3.3.cmml"><mi id="A1.SS1.p2.13.m13.1.1.3.3.2" xref="A1.SS1.p2.13.m13.1.1.3.3.2.cmml">G</mi><mi id="A1.SS1.p2.13.m13.1.1.3.3.3" xref="A1.SS1.p2.13.m13.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.13.m13.1b"><apply id="A1.SS1.p2.13.m13.1.1.cmml" xref="A1.SS1.p2.13.m13.1.1"><ci id="A1.SS1.p2.13.m13.1.1.1.cmml" xref="A1.SS1.p2.13.m13.1.1.1">←</ci><apply id="A1.SS1.p2.13.m13.1.1.2.cmml" xref="A1.SS1.p2.13.m13.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.13.m13.1.1.2.1.cmml" xref="A1.SS1.p2.13.m13.1.1.2">subscript</csymbol><ci id="A1.SS1.p2.13.m13.1.1.2.2.cmml" xref="A1.SS1.p2.13.m13.1.1.2.2">𝜃</ci><apply id="A1.SS1.p2.13.m13.1.1.2.3.cmml" xref="A1.SS1.p2.13.m13.1.1.2.3"><plus id="A1.SS1.p2.13.m13.1.1.2.3.1.cmml" xref="A1.SS1.p2.13.m13.1.1.2.3.1"></plus><ci id="A1.SS1.p2.13.m13.1.1.2.3.2.cmml" xref="A1.SS1.p2.13.m13.1.1.2.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.13.m13.1.1.2.3.3.cmml" xref="A1.SS1.p2.13.m13.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS1.p2.13.m13.1.1.3.cmml" xref="A1.SS1.p2.13.m13.1.1.3"><minus id="A1.SS1.p2.13.m13.1.1.3.1.cmml" xref="A1.SS1.p2.13.m13.1.1.3.1"></minus><apply id="A1.SS1.p2.13.m13.1.1.3.2.cmml" xref="A1.SS1.p2.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p2.13.m13.1.1.3.2.1.cmml" xref="A1.SS1.p2.13.m13.1.1.3.2">subscript</csymbol><ci id="A1.SS1.p2.13.m13.1.1.3.2.2.cmml" xref="A1.SS1.p2.13.m13.1.1.3.2.2">𝜃</ci><ci id="A1.SS1.p2.13.m13.1.1.3.2.3.cmml" xref="A1.SS1.p2.13.m13.1.1.3.2.3">𝑡</ci></apply><apply id="A1.SS1.p2.13.m13.1.1.3.3.cmml" xref="A1.SS1.p2.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.13.m13.1.1.3.3.1.cmml" xref="A1.SS1.p2.13.m13.1.1.3.3">subscript</csymbol><ci id="A1.SS1.p2.13.m13.1.1.3.3.2.cmml" xref="A1.SS1.p2.13.m13.1.1.3.3.2">𝐺</ci><ci id="A1.SS1.p2.13.m13.1.1.3.3.3.cmml" xref="A1.SS1.p2.13.m13.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.13.m13.1c">\theta_{t+1}\leftarrow\theta_{t}-G_{t}</annotation></semantics></math>, where <math id="A1.SS1.p2.14.m14.1" class="ltx_Math" alttext="G_{t}\leftarrow Aggr(\{g^{i}_{t+1}\}_{i\in S_{t}})" display="inline"><semantics id="A1.SS1.p2.14.m14.1a"><mrow id="A1.SS1.p2.14.m14.1.1" xref="A1.SS1.p2.14.m14.1.1.cmml"><msub id="A1.SS1.p2.14.m14.1.1.3" xref="A1.SS1.p2.14.m14.1.1.3.cmml"><mi id="A1.SS1.p2.14.m14.1.1.3.2" xref="A1.SS1.p2.14.m14.1.1.3.2.cmml">G</mi><mi id="A1.SS1.p2.14.m14.1.1.3.3" xref="A1.SS1.p2.14.m14.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="A1.SS1.p2.14.m14.1.1.2" xref="A1.SS1.p2.14.m14.1.1.2.cmml">←</mo><mrow id="A1.SS1.p2.14.m14.1.1.1" xref="A1.SS1.p2.14.m14.1.1.1.cmml"><mi id="A1.SS1.p2.14.m14.1.1.1.3" xref="A1.SS1.p2.14.m14.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p2.14.m14.1.1.1.2" xref="A1.SS1.p2.14.m14.1.1.1.2.cmml">​</mo><mi id="A1.SS1.p2.14.m14.1.1.1.4" xref="A1.SS1.p2.14.m14.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p2.14.m14.1.1.1.2a" xref="A1.SS1.p2.14.m14.1.1.1.2.cmml">​</mo><mi id="A1.SS1.p2.14.m14.1.1.1.5" xref="A1.SS1.p2.14.m14.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p2.14.m14.1.1.1.2b" xref="A1.SS1.p2.14.m14.1.1.1.2.cmml">​</mo><mi id="A1.SS1.p2.14.m14.1.1.1.6" xref="A1.SS1.p2.14.m14.1.1.1.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p2.14.m14.1.1.1.2c" xref="A1.SS1.p2.14.m14.1.1.1.2.cmml">​</mo><mrow id="A1.SS1.p2.14.m14.1.1.1.1.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.p2.14.m14.1.1.1.1.1.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS1.p2.14.m14.1.1.1.1.1.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.cmml"><mrow id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mrow id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.cmml"><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.1" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.cmml"><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.2" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.2.cmml">S</mi><mi id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></msub><mo stretchy="false" id="A1.SS1.p2.14.m14.1.1.1.1.1.3" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.14.m14.1b"><apply id="A1.SS1.p2.14.m14.1.1.cmml" xref="A1.SS1.p2.14.m14.1.1"><ci id="A1.SS1.p2.14.m14.1.1.2.cmml" xref="A1.SS1.p2.14.m14.1.1.2">←</ci><apply id="A1.SS1.p2.14.m14.1.1.3.cmml" xref="A1.SS1.p2.14.m14.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.14.m14.1.1.3.1.cmml" xref="A1.SS1.p2.14.m14.1.1.3">subscript</csymbol><ci id="A1.SS1.p2.14.m14.1.1.3.2.cmml" xref="A1.SS1.p2.14.m14.1.1.3.2">𝐺</ci><ci id="A1.SS1.p2.14.m14.1.1.3.3.cmml" xref="A1.SS1.p2.14.m14.1.1.3.3">𝑡</ci></apply><apply id="A1.SS1.p2.14.m14.1.1.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1"><times id="A1.SS1.p2.14.m14.1.1.1.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.2"></times><ci id="A1.SS1.p2.14.m14.1.1.1.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.3">𝐴</ci><ci id="A1.SS1.p2.14.m14.1.1.1.4.cmml" xref="A1.SS1.p2.14.m14.1.1.1.4">𝑔</ci><ci id="A1.SS1.p2.14.m14.1.1.1.5.cmml" xref="A1.SS1.p2.14.m14.1.1.1.5">𝑔</ci><ci id="A1.SS1.p2.14.m14.1.1.1.6.cmml" xref="A1.SS1.p2.14.m14.1.1.1.6">𝑟</ci><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1">subscript</csymbol><set id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1"><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3"><plus id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></set><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3"><in id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.1"></in><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.1.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.2.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.2">𝑆</ci><ci id="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.3.cmml" xref="A1.SS1.p2.14.m14.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.14.m14.1c">G_{t}\leftarrow Aggr(\{g^{i}_{t+1}\}_{i\in S_{t}})</annotation></semantics></math>. The newly updated model parameters <math id="A1.SS1.p2.15.m15.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="A1.SS1.p2.15.m15.1a"><msub id="A1.SS1.p2.15.m15.1.1" xref="A1.SS1.p2.15.m15.1.1.cmml"><mi id="A1.SS1.p2.15.m15.1.1.2" xref="A1.SS1.p2.15.m15.1.1.2.cmml">θ</mi><mrow id="A1.SS1.p2.15.m15.1.1.3" xref="A1.SS1.p2.15.m15.1.1.3.cmml"><mi id="A1.SS1.p2.15.m15.1.1.3.2" xref="A1.SS1.p2.15.m15.1.1.3.2.cmml">t</mi><mo id="A1.SS1.p2.15.m15.1.1.3.1" xref="A1.SS1.p2.15.m15.1.1.3.1.cmml">+</mo><mn id="A1.SS1.p2.15.m15.1.1.3.3" xref="A1.SS1.p2.15.m15.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.15.m15.1b"><apply id="A1.SS1.p2.15.m15.1.1.cmml" xref="A1.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.15.m15.1.1.1.cmml" xref="A1.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="A1.SS1.p2.15.m15.1.1.2.cmml" xref="A1.SS1.p2.15.m15.1.1.2">𝜃</ci><apply id="A1.SS1.p2.15.m15.1.1.3.cmml" xref="A1.SS1.p2.15.m15.1.1.3"><plus id="A1.SS1.p2.15.m15.1.1.3.1.cmml" xref="A1.SS1.p2.15.m15.1.1.3.1"></plus><ci id="A1.SS1.p2.15.m15.1.1.3.2.cmml" xref="A1.SS1.p2.15.m15.1.1.3.2">𝑡</ci><cn type="integer" id="A1.SS1.p2.15.m15.1.1.3.3.cmml" xref="A1.SS1.p2.15.m15.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.15.m15.1c">\theta_{t+1}</annotation></semantics></math> is then used to perform the next round of FL training. The FL training is ended when the round number reaches <math id="A1.SS1.p2.16.m16.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="A1.SS1.p2.16.m16.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.16.m16.1.1" xref="A1.SS1.p2.16.m16.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.16.m16.1b"><ci id="A1.SS1.p2.16.m16.1.1.cmml" xref="A1.SS1.p2.16.m16.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.16.m16.1c">\mathcal{T}</annotation></semantics></math>.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Threat Model</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.6" class="ltx_p">We assume that the attacker’s goal is to diminish global model accuracy regardless of specific inputs or classes, in which malicious clients perform untargeted attacks. In this work, we assume that <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">p</annotation></semantics></math> percentage of the total number of clients is malicious, where <math id="A1.SS2.p1.2.m2.1" class="ltx_Math" alttext="0\leq p\leq 1" display="inline"><semantics id="A1.SS2.p1.2.m2.1a"><mrow id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml"><mn id="A1.SS2.p1.2.m2.1.1.2" xref="A1.SS2.p1.2.m2.1.1.2.cmml">0</mn><mo id="A1.SS2.p1.2.m2.1.1.3" xref="A1.SS2.p1.2.m2.1.1.3.cmml">≤</mo><mi id="A1.SS2.p1.2.m2.1.1.4" xref="A1.SS2.p1.2.m2.1.1.4.cmml">p</mi><mo id="A1.SS2.p1.2.m2.1.1.5" xref="A1.SS2.p1.2.m2.1.1.5.cmml">≤</mo><mn id="A1.SS2.p1.2.m2.1.1.6" xref="A1.SS2.p1.2.m2.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><apply id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1"><and id="A1.SS2.p1.2.m2.1.1a.cmml" xref="A1.SS2.p1.2.m2.1.1"></and><apply id="A1.SS2.p1.2.m2.1.1b.cmml" xref="A1.SS2.p1.2.m2.1.1"><leq id="A1.SS2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.3"></leq><cn type="integer" id="A1.SS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.2">0</cn><ci id="A1.SS2.p1.2.m2.1.1.4.cmml" xref="A1.SS2.p1.2.m2.1.1.4">𝑝</ci></apply><apply id="A1.SS2.p1.2.m2.1.1c.cmml" xref="A1.SS2.p1.2.m2.1.1"><leq id="A1.SS2.p1.2.m2.1.1.5.cmml" xref="A1.SS2.p1.2.m2.1.1.5"></leq><share href="#A1.SS2.p1.2.m2.1.1.4.cmml" id="A1.SS2.p1.2.m2.1.1d.cmml" xref="A1.SS2.p1.2.m2.1.1"></share><cn type="integer" id="A1.SS2.p1.2.m2.1.1.6.cmml" xref="A1.SS2.p1.2.m2.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">0\leq p\leq 1</annotation></semantics></math>. Let the malicious clients be denoted by <math id="A1.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="A1.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><ci id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">\mathcal{M}</annotation></semantics></math> and the set of malicious clients as <math id="A1.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="A1.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><ci id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">\mathcal{A}</annotation></semantics></math>. All malicious clients share the same purpose and perform the same type of attack. They are either coordinated by an external attacker or by a leader client. During the FL training, the malicious attackers send crafted local updates <math id="A1.SS2.p1.5.m5.1" class="ltx_Math" alttext="\left\{\widetilde{g}^{t}_{k}\right\}_{k\in\mathcal{A}}" display="inline"><semantics id="A1.SS2.p1.5.m5.1a"><msub id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml"><mrow id="A1.SS2.p1.5.m5.1.1.1.1" xref="A1.SS2.p1.5.m5.1.1.1.2.cmml"><mo id="A1.SS2.p1.5.m5.1.1.1.1.2" xref="A1.SS2.p1.5.m5.1.1.1.2.cmml">{</mo><msubsup id="A1.SS2.p1.5.m5.1.1.1.1.1" xref="A1.SS2.p1.5.m5.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.cmml"><mi id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.2" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.2.cmml">g</mi><mo id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.1" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.SS2.p1.5.m5.1.1.1.1.1.3" xref="A1.SS2.p1.5.m5.1.1.1.1.1.3.cmml">k</mi><mi id="A1.SS2.p1.5.m5.1.1.1.1.1.2.3" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="A1.SS2.p1.5.m5.1.1.1.1.3" xref="A1.SS2.p1.5.m5.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p1.5.m5.1.1.3" xref="A1.SS2.p1.5.m5.1.1.3.cmml"><mi id="A1.SS2.p1.5.m5.1.1.3.2" xref="A1.SS2.p1.5.m5.1.1.3.2.cmml">k</mi><mo id="A1.SS2.p1.5.m5.1.1.3.1" xref="A1.SS2.p1.5.m5.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p1.5.m5.1.1.3.3" xref="A1.SS2.p1.5.m5.1.1.3.3.cmml">𝒜</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><apply id="A1.SS2.p1.5.m5.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1">subscript</csymbol><set id="A1.SS2.p1.5.m5.1.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1"><apply id="A1.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1">superscript</csymbol><apply id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2"><ci id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.1">~</ci><ci id="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.2.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.2.2">𝑔</ci></apply><ci id="A1.SS2.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.SS2.p1.5.m5.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.5.m5.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="A1.SS2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.p1.5.m5.1.1.3"><in id="A1.SS2.p1.5.m5.1.1.3.1.cmml" xref="A1.SS2.p1.5.m5.1.1.3.1"></in><ci id="A1.SS2.p1.5.m5.1.1.3.2.cmml" xref="A1.SS2.p1.5.m5.1.1.3.2">𝑘</ci><ci id="A1.SS2.p1.5.m5.1.1.3.3.cmml" xref="A1.SS2.p1.5.m5.1.1.3.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">\left\{\widetilde{g}^{t}_{k}\right\}_{k\in\mathcal{A}}</annotation></semantics></math> to the server to purposely maximize the global optimization function <math id="A1.SS2.p1.6.m6.1" class="ltx_Math" alttext="f(\theta)" display="inline"><semantics id="A1.SS2.p1.6.m6.1a"><mrow id="A1.SS2.p1.6.m6.1.2" xref="A1.SS2.p1.6.m6.1.2.cmml"><mi id="A1.SS2.p1.6.m6.1.2.2" xref="A1.SS2.p1.6.m6.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p1.6.m6.1.2.1" xref="A1.SS2.p1.6.m6.1.2.1.cmml">​</mo><mrow id="A1.SS2.p1.6.m6.1.2.3.2" xref="A1.SS2.p1.6.m6.1.2.cmml"><mo stretchy="false" id="A1.SS2.p1.6.m6.1.2.3.2.1" xref="A1.SS2.p1.6.m6.1.2.cmml">(</mo><mi id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml">θ</mi><mo stretchy="false" id="A1.SS2.p1.6.m6.1.2.3.2.2" xref="A1.SS2.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><apply id="A1.SS2.p1.6.m6.1.2.cmml" xref="A1.SS2.p1.6.m6.1.2"><times id="A1.SS2.p1.6.m6.1.2.1.cmml" xref="A1.SS2.p1.6.m6.1.2.1"></times><ci id="A1.SS2.p1.6.m6.1.2.2.cmml" xref="A1.SS2.p1.6.m6.1.2.2">𝑓</ci><ci id="A1.SS2.p1.6.m6.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">f(\theta)</annotation></semantics></math>. The crafted local updates are generated from their local data distributions, which differ from the benign clients’ local distributions. The illustration of the threat model is shown in Figure <a href="#A1.F5" title="Figure 5 ‣ A.2 Threat Model ‣ Appendix A Preliminary ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="A1.F5" class="ltx_figure"><img src="/html/2304.00160/assets/plot/setup.png" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="267" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Threat model of the data poisoning attack in FL. After receiving the global model from the server, the malicious clients purposely upload contaminated model updates to poison the model.</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Related Works</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p"><span id="A2.p1.1.1" class="ltx_text ltx_font_bold">Poisoning Attacks in FL.</span>
In federated learning, the attackers may control a fraction of the clients and manipulate the local data or training process to purposely poison the global model performance by injecting the wrong local model update. This kind of attack is called the model poisoning attack, in which the attacker contaminates the global model.
Poisoning attacks are mainly categorized into targeted and untargeted attacks according to the attacker’s aim. Targeted attacks aim to keep global model performance high, while the model considerably misbehaves on a specific set of inputs. This can be done either by injecting backdoor triggers to the inputs regardless of the original class or flipping the labels of only one class to a similar label (e.g., flipping 1 to 7 in MNIST or ’cat’ to ’dog’ in CIFAR10).
On the other hand, the purpose of untargeted attacks is to decrease the global model’s performance significantly. Label-flip <cite class="ltx_cite ltx_citemacro_cite">Biggio et al. (<a href="#bib.bib1" title="" class="ltx_ref">2012</a>)</cite>, and gradient modification (e.g., sending random noise to the server instead of real update) <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> attacks are examples of this type. Moreover, <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> utilizes reinforcement learning to create an optimal untargeted attack, however, building the framework to generate online attack is costly in terms of both time and computation. Another state-of-the-art untargeted model poisoning attack is Inner Product Manipulation (IPM) proposed by <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>. The aim of the IPM is to modify the local updates of the malicious clients such that the inner product between the true gradient and the aggregated updates is negative.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.4" class="ltx_p"><span id="A2.p2.4.1" class="ltx_text ltx_font_bold">Defenses for Poisoning Attacks in FL.</span> Several solutions have been proposed to mitigate the effect of the attacks, so that model performance is not negatively affected. Client-side defenses modify the local training algorithm and rely on benign clients <cite class="ltx_cite ltx_citemacro_cite">Zizzo et al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>); Sun et al. (<a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. For example, <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> finds the model parameters that the attack is hidden and perturbs those parameters during local training of benign clients. Some server-side defense methods decrease the aggregation weights of the malicious client updates <cite class="ltx_cite ltx_citemacro_cite">Regatti et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>); Cao et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>); Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>. While others perform clustering based on different techniques and aggregate only benign clients <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>); Tolpegin et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. For instance, Multi-Krum <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> calculates the total Euclidean distance from the <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="n-f-2" display="inline"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml">n</mi><mo id="A2.p2.1.m1.1.1.1" xref="A2.p2.1.m1.1.1.1.cmml">−</mo><mi id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">f</mi><mo id="A2.p2.1.m1.1.1.1a" xref="A2.p2.1.m1.1.1.1.cmml">−</mo><mn id="A2.p2.1.m1.1.1.4" xref="A2.p2.1.m1.1.1.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><minus id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></minus><ci id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">𝑛</ci><ci id="A2.p2.1.m1.1.1.3.cmml" xref="A2.p2.1.m1.1.1.3">𝑓</ci><cn type="integer" id="A2.p2.1.m1.1.1.4.cmml" xref="A2.p2.1.m1.1.1.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">n-f-2</annotation></semantics></math> nearest neighbors for each client update, where <math id="A2.p2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="A2.p2.2.m2.1a"><mi id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><ci id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">n</annotation></semantics></math> is the number of clients and <math id="A2.p2.3.m3.1" class="ltx_Math" alttext="f" display="inline"><semantics id="A2.p2.3.m3.1a"><mi id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><ci id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">f</annotation></semantics></math> is the estimated malicious client number. Then, only the <math id="A2.p2.4.m4.1" class="ltx_Math" alttext="n-f" display="inline"><semantics id="A2.p2.4.m4.1a"><mrow id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml"><mi id="A2.p2.4.m4.1.1.2" xref="A2.p2.4.m4.1.1.2.cmml">n</mi><mo id="A2.p2.4.m4.1.1.1" xref="A2.p2.4.m4.1.1.1.cmml">−</mo><mi id="A2.p2.4.m4.1.1.3" xref="A2.p2.4.m4.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><apply id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1"><minus id="A2.p2.4.m4.1.1.1.cmml" xref="A2.p2.4.m4.1.1.1"></minus><ci id="A2.p2.4.m4.1.1.2.cmml" xref="A2.p2.4.m4.1.1.2">𝑛</ci><ci id="A2.p2.4.m4.1.1.3.cmml" xref="A2.p2.4.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">n-f</annotation></semantics></math> updates with the minimum distance is aggregated. Another work <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> applies norm-clipping to the client updates before the aggregation, based on the observation that norm of malicious updates are large. Also, differential privacy methods (e.g., adding noise to updates) are shown to be mitigating model poisoning attacks <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>); Naseri et al. (<a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.1" class="ltx_p">However, some current solutions have critical drawbacks in terms of real-world feasibility. For instance, algorithms proposed by <cite class="ltx_cite ltx_citemacro_cite">Regatti et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>); Cao et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>); Park et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> rely on representative benign data on the server, which is hard to accomplish in actual FL deployment, where the server seldom stores the ground-true validation data. Moreover, <cite class="ltx_cite ltx_citemacro_cite">Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite> is incompatible with client selection, an inevitable necessity for cross-device FL where thousands of clients participate. Also, Krum and Multi-Krum <cite class="ltx_cite ltx_citemacro_cite">Blanchard et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> require the knowledge of the number of malicious clients in the FL setting , which is not feasible. Lastly, methods proposed by <cite class="ltx_cite ltx_citemacro_cite">Xu &amp; Lyu (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>); Fung et al. (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>); Regatti et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> maintains reputation scores for each client on the server side, which is a serious overhead since thousands of clients may participate in the FL system. Overall, there is a gap for a defense solution in the FL setting that does not require server data, is compatible with client selection, and is self-sufficient for detecting malicious clients.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Algorithm</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_typewriter">CosDefense</span> algorithm is presented in the Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Algorithm ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. More specifically, after calculating the cosine similarity scores of each client, the server takes their absolute value before and performs min-max normalization, which is beneficial for separating the actual malicious and benign clients better. After these two adjustments, we define the threshold value as the mean of current scores and cluster clients accordingly. If the client score exceeds the mean value, it is labeled malicious. Otherwise, the server considers it benign and aggregates its weights for the next global model.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_typewriter">CosDefense</span></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Global model parameters <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝜃</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\theta_{t}</annotation></semantics></math>, local updates <math id="alg1.l1.m2.1" class="ltx_Math" alttext="g^{i}_{t+1}" display="inline"><semantics id="alg1.l1.m2.1a"><msubsup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2.2" xref="alg1.l1.m2.1.1.2.2.cmml">g</mi><mrow id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml"><mi id="alg1.l1.m2.1.1.3.2" xref="alg1.l1.m2.1.1.3.2.cmml">t</mi><mo id="alg1.l1.m2.1.1.3.1" xref="alg1.l1.m2.1.1.3.1.cmml">+</mo><mn id="alg1.l1.m2.1.1.3.3" xref="alg1.l1.m2.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m2.1.1.2.3" xref="alg1.l1.m2.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><apply id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.2.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.2.cmml" xref="alg1.l1.m2.1.1.2.2">𝑔</ci><ci id="alg1.l1.m2.1.1.2.3.cmml" xref="alg1.l1.m2.1.1.2.3">𝑖</ci></apply><apply id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"><plus id="alg1.l1.m2.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.3.1"></plus><ci id="alg1.l1.m2.1.1.3.2.cmml" xref="alg1.l1.m2.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l1.m2.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">g^{i}_{t+1}</annotation></semantics></math> of sampled clients <math id="alg1.l1.m3.1" class="ltx_Math" alttext="i\in S_{t}" display="inline"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">i</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><msub id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.3.2" xref="alg1.l1.m3.1.1.3.2.cmml">S</mi><mi id="alg1.l1.m3.1.1.3.3" xref="alg1.l1.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑖</ci><apply id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3">subscript</csymbol><ci id="alg1.l1.m3.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.3.2">𝑆</ci><ci id="alg1.l1.m3.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">i\in S_{t}</annotation></semantics></math>, and aggregation method <math id="alg1.l1.m4.1" class="ltx_Math" alttext="Aggr(\cdot)" display="inline"><semantics id="alg1.l1.m4.1a"><mrow id="alg1.l1.m4.1.2" xref="alg1.l1.m4.1.2.cmml"><mi id="alg1.l1.m4.1.2.2" xref="alg1.l1.m4.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.2.1" xref="alg1.l1.m4.1.2.1.cmml">​</mo><mi id="alg1.l1.m4.1.2.3" xref="alg1.l1.m4.1.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.2.1a" xref="alg1.l1.m4.1.2.1.cmml">​</mo><mi id="alg1.l1.m4.1.2.4" xref="alg1.l1.m4.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.2.1b" xref="alg1.l1.m4.1.2.1.cmml">​</mo><mi id="alg1.l1.m4.1.2.5" xref="alg1.l1.m4.1.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.2.1c" xref="alg1.l1.m4.1.2.1.cmml">​</mo><mrow id="alg1.l1.m4.1.2.6.2" xref="alg1.l1.m4.1.2.cmml"><mo stretchy="false" id="alg1.l1.m4.1.2.6.2.1" xref="alg1.l1.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l1.m4.1.2.6.2.2" xref="alg1.l1.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.2.cmml" xref="alg1.l1.m4.1.2"><times id="alg1.l1.m4.1.2.1.cmml" xref="alg1.l1.m4.1.2.1"></times><ci id="alg1.l1.m4.1.2.2.cmml" xref="alg1.l1.m4.1.2.2">𝐴</ci><ci id="alg1.l1.m4.1.2.3.cmml" xref="alg1.l1.m4.1.2.3">𝑔</ci><ci id="alg1.l1.m4.1.2.4.cmml" xref="alg1.l1.m4.1.2.4">𝑔</ci><ci id="alg1.l1.m4.1.2.5.cmml" xref="alg1.l1.m4.1.2.5">𝑟</ci><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">Aggr(\cdot)</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Initialize:</span> Benign client set <math id="alg1.l2.m1.1" class="ltx_Math" alttext="B=\{\}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">B</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mrow id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.1" xref="alg1.l2.m1.1.1.3.1.cmml">{</mo><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.2" xref="alg1.l2.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐵</ci><list id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">B=\{\}</annotation></semantics></math>ß

</div>
<div id="alg1.l3" class="ltx_listingline">  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l3.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">i</annotation></semantics></math> in <math id="alg1.l3.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.l3.m2.1a"><msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">S</mi><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑆</ci><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">S_{t}</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">     <math id="alg1.l4.m1.5" class="ltx_Math" alttext="cs_{i}\leftarrow|cosine\ similarity(\theta_{t,L},g_{t+1,L}^{i})|" display="inline"><semantics id="alg1.l4.m1.5a"><mrow id="alg1.l4.m1.5.5" xref="alg1.l4.m1.5.5.cmml"><mrow id="alg1.l4.m1.5.5.3" xref="alg1.l4.m1.5.5.3.cmml"><mi id="alg1.l4.m1.5.5.3.2" xref="alg1.l4.m1.5.5.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.3.1" xref="alg1.l4.m1.5.5.3.1.cmml">​</mo><msub id="alg1.l4.m1.5.5.3.3" xref="alg1.l4.m1.5.5.3.3.cmml"><mi id="alg1.l4.m1.5.5.3.3.2" xref="alg1.l4.m1.5.5.3.3.2.cmml">s</mi><mi id="alg1.l4.m1.5.5.3.3.3" xref="alg1.l4.m1.5.5.3.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l4.m1.5.5.2" xref="alg1.l4.m1.5.5.2.cmml">←</mo><mrow id="alg1.l4.m1.5.5.1.1" xref="alg1.l4.m1.5.5.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.5.5.1.1.2" xref="alg1.l4.m1.5.5.1.2.1.cmml">|</mo><mrow id="alg1.l4.m1.5.5.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.4" xref="alg1.l4.m1.5.5.1.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.5" xref="alg1.l4.m1.5.5.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3a" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.6" xref="alg1.l4.m1.5.5.1.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3b" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.7" xref="alg1.l4.m1.5.5.1.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3c" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.8" xref="alg1.l4.m1.5.5.1.1.1.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3d" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.9" xref="alg1.l4.m1.5.5.1.1.1.9.cmml">e</mi><mo lspace="0.500em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3e" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.10" xref="alg1.l4.m1.5.5.1.1.1.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3f" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.11" xref="alg1.l4.m1.5.5.1.1.1.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3g" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.12" xref="alg1.l4.m1.5.5.1.1.1.12.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3h" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.13" xref="alg1.l4.m1.5.5.1.1.1.13.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3i" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.14" xref="alg1.l4.m1.5.5.1.1.1.14.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3j" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.15" xref="alg1.l4.m1.5.5.1.1.1.15.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3k" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.16" xref="alg1.l4.m1.5.5.1.1.1.16.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3l" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.17" xref="alg1.l4.m1.5.5.1.1.1.17.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3m" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.18" xref="alg1.l4.m1.5.5.1.1.1.18.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3n" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mi id="alg1.l4.m1.5.5.1.1.1.19" xref="alg1.l4.m1.5.5.1.1.1.19.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.1.1.1.3o" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">​</mo><mrow id="alg1.l4.m1.5.5.1.1.1.2.2" xref="alg1.l4.m1.5.5.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l4.m1.5.5.1.1.1.2.2.3" xref="alg1.l4.m1.5.5.1.1.1.2.3.cmml">(</mo><msub id="alg1.l4.m1.5.5.1.1.1.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="alg1.l4.m1.2.2.2.4" xref="alg1.l4.m1.2.2.2.3.cmml"><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">t</mi><mo id="alg1.l4.m1.2.2.2.4.1" xref="alg1.l4.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml">L</mi></mrow></msub><mo id="alg1.l4.m1.5.5.1.1.1.2.2.4" xref="alg1.l4.m1.5.5.1.1.1.2.3.cmml">,</mo><msubsup id="alg1.l4.m1.5.5.1.1.1.2.2.2" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.2.2.2.2.2" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.2.2.cmml">g</mi><mrow id="alg1.l4.m1.4.4.2.2" xref="alg1.l4.m1.4.4.2.3.cmml"><mrow id="alg1.l4.m1.4.4.2.2.1" xref="alg1.l4.m1.4.4.2.2.1.cmml"><mi id="alg1.l4.m1.4.4.2.2.1.2" xref="alg1.l4.m1.4.4.2.2.1.2.cmml">t</mi><mo id="alg1.l4.m1.4.4.2.2.1.1" xref="alg1.l4.m1.4.4.2.2.1.1.cmml">+</mo><mn id="alg1.l4.m1.4.4.2.2.1.3" xref="alg1.l4.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="alg1.l4.m1.4.4.2.2.2" xref="alg1.l4.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.1.cmml">L</mi></mrow><mi id="alg1.l4.m1.5.5.1.1.1.2.2.2.3" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l4.m1.5.5.1.1.1.2.2.5" xref="alg1.l4.m1.5.5.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l4.m1.5.5.1.1.3" xref="alg1.l4.m1.5.5.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.5b"><apply id="alg1.l4.m1.5.5.cmml" xref="alg1.l4.m1.5.5"><ci id="alg1.l4.m1.5.5.2.cmml" xref="alg1.l4.m1.5.5.2">←</ci><apply id="alg1.l4.m1.5.5.3.cmml" xref="alg1.l4.m1.5.5.3"><times id="alg1.l4.m1.5.5.3.1.cmml" xref="alg1.l4.m1.5.5.3.1"></times><ci id="alg1.l4.m1.5.5.3.2.cmml" xref="alg1.l4.m1.5.5.3.2">𝑐</ci><apply id="alg1.l4.m1.5.5.3.3.cmml" xref="alg1.l4.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.3.3.1.cmml" xref="alg1.l4.m1.5.5.3.3">subscript</csymbol><ci id="alg1.l4.m1.5.5.3.3.2.cmml" xref="alg1.l4.m1.5.5.3.3.2">𝑠</ci><ci id="alg1.l4.m1.5.5.3.3.3.cmml" xref="alg1.l4.m1.5.5.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l4.m1.5.5.1.2.cmml" xref="alg1.l4.m1.5.5.1.1"><abs id="alg1.l4.m1.5.5.1.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.2"></abs><apply id="alg1.l4.m1.5.5.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1"><times id="alg1.l4.m1.5.5.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.3"></times><ci id="alg1.l4.m1.5.5.1.1.1.4.cmml" xref="alg1.l4.m1.5.5.1.1.1.4">𝑐</ci><ci id="alg1.l4.m1.5.5.1.1.1.5.cmml" xref="alg1.l4.m1.5.5.1.1.1.5">𝑜</ci><ci id="alg1.l4.m1.5.5.1.1.1.6.cmml" xref="alg1.l4.m1.5.5.1.1.1.6">𝑠</ci><ci id="alg1.l4.m1.5.5.1.1.1.7.cmml" xref="alg1.l4.m1.5.5.1.1.1.7">𝑖</ci><ci id="alg1.l4.m1.5.5.1.1.1.8.cmml" xref="alg1.l4.m1.5.5.1.1.1.8">𝑛</ci><ci id="alg1.l4.m1.5.5.1.1.1.9.cmml" xref="alg1.l4.m1.5.5.1.1.1.9">𝑒</ci><ci id="alg1.l4.m1.5.5.1.1.1.10.cmml" xref="alg1.l4.m1.5.5.1.1.1.10">𝑠</ci><ci id="alg1.l4.m1.5.5.1.1.1.11.cmml" xref="alg1.l4.m1.5.5.1.1.1.11">𝑖</ci><ci id="alg1.l4.m1.5.5.1.1.1.12.cmml" xref="alg1.l4.m1.5.5.1.1.1.12">𝑚</ci><ci id="alg1.l4.m1.5.5.1.1.1.13.cmml" xref="alg1.l4.m1.5.5.1.1.1.13">𝑖</ci><ci id="alg1.l4.m1.5.5.1.1.1.14.cmml" xref="alg1.l4.m1.5.5.1.1.1.14">𝑙</ci><ci id="alg1.l4.m1.5.5.1.1.1.15.cmml" xref="alg1.l4.m1.5.5.1.1.1.15">𝑎</ci><ci id="alg1.l4.m1.5.5.1.1.1.16.cmml" xref="alg1.l4.m1.5.5.1.1.1.16">𝑟</ci><ci id="alg1.l4.m1.5.5.1.1.1.17.cmml" xref="alg1.l4.m1.5.5.1.1.1.17">𝑖</ci><ci id="alg1.l4.m1.5.5.1.1.1.18.cmml" xref="alg1.l4.m1.5.5.1.1.1.18">𝑡</ci><ci id="alg1.l4.m1.5.5.1.1.1.19.cmml" xref="alg1.l4.m1.5.5.1.1.1.19">𝑦</ci><interval closure="open" id="alg1.l4.m1.5.5.1.1.1.2.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2"><apply id="alg1.l4.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.1.1.1.2">𝜃</ci><list id="alg1.l4.m1.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.4"><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝑡</ci><ci id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2">𝐿</ci></list></apply><apply id="alg1.l4.m1.5.5.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.2.2.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2">superscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.2.2.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.2.2.2.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.1.2.2.2.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.2.2">𝑔</ci><list id="alg1.l4.m1.4.4.2.3.cmml" xref="alg1.l4.m1.4.4.2.2"><apply id="alg1.l4.m1.4.4.2.2.1.cmml" xref="alg1.l4.m1.4.4.2.2.1"><plus id="alg1.l4.m1.4.4.2.2.1.1.cmml" xref="alg1.l4.m1.4.4.2.2.1.1"></plus><ci id="alg1.l4.m1.4.4.2.2.1.2.cmml" xref="alg1.l4.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l4.m1.4.4.2.2.1.3.cmml" xref="alg1.l4.m1.4.4.2.2.1.3">1</cn></apply><ci id="alg1.l4.m1.3.3.1.1.cmml" xref="alg1.l4.m1.3.3.1.1">𝐿</ci></list></apply><ci id="alg1.l4.m1.5.5.1.1.1.2.2.2.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.5c">cs_{i}\leftarrow|cosine\ similarity(\theta_{t,L},g_{t+1,L}^{i})|</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">  <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l5.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">i</annotation></semantics></math> in <math id="alg1.l5.m2.1" class="ltx_Math" alttext="cs_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">​</mo><msub id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.3.2.cmml">s</mi><mi id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><times id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1"></times><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑐</ci><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3">subscript</csymbol><ci id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3.2">𝑠</ci><ci id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">cs_{i}</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">     <math id="alg1.l6.m1.2" class="ltx_Math" alttext="cs_{i}\leftarrow(cs_{i}-min(cs))/(max(cs)-min(cs))" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mrow id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml"><mi id="alg1.l6.m1.2.2.4.2" xref="alg1.l6.m1.2.2.4.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.4.1" xref="alg1.l6.m1.2.2.4.1.cmml">​</mo><msub id="alg1.l6.m1.2.2.4.3" xref="alg1.l6.m1.2.2.4.3.cmml"><mi id="alg1.l6.m1.2.2.4.3.2" xref="alg1.l6.m1.2.2.4.3.2.cmml">s</mi><mi id="alg1.l6.m1.2.2.4.3.3" xref="alg1.l6.m1.2.2.4.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">←</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml"><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.3.1" xref="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.1.4" xref="alg1.l6.m1.1.1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.1.2a" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.1.5" xref="alg1.l6.m1.1.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.1.2b" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">/</mo><mrow id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.cmml"><mrow id="alg1.l6.m1.2.2.2.2.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.1.4" xref="alg1.l6.m1.2.2.2.2.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.1.2a" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.1.5" xref="alg1.l6.m1.2.2.2.2.1.1.1.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.1.2b" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l6.m1.2.2.2.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.3.cmml">−</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.2.3" xref="alg1.l6.m1.2.2.2.2.1.1.2.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.2.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.2.4" xref="alg1.l6.m1.2.2.2.2.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.2.2a" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.2.5" xref="alg1.l6.m1.2.2.2.2.1.1.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.2.2b" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3">←</ci><apply id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4"><times id="alg1.l6.m1.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.4.1"></times><ci id="alg1.l6.m1.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.4.2">𝑐</ci><apply id="alg1.l6.m1.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.4.3.1.cmml" xref="alg1.l6.m1.2.2.4.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.4.3.2.cmml" xref="alg1.l6.m1.2.2.4.3.2">𝑠</ci><ci id="alg1.l6.m1.2.2.4.3.3.cmml" xref="alg1.l6.m1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><divide id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.3"></divide><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><minus id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2"></minus><apply id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3"><times id="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2">𝑐</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑚</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.5">𝑛</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="alg1.l6.m1.2.2.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1"><minus id="alg1.l6.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.3"></minus><apply id="alg1.l6.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1"><times id="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.2"></times><ci id="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3">𝑚</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.4.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.4">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.5.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.5">𝑥</ci><apply id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1"><times id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.1"></times><ci id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.2">𝑐</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2"><times id="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.2"></times><ci id="alg1.l6.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.3">𝑚</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.2.4.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.4">𝑖</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.2.5.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.5">𝑛</ci><apply id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1"><times id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.1"></times><ci id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.2">𝑐</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">cs_{i}\leftarrow(cs_{i}-min(cs))/(max(cs)-min(cs))</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">  threshold <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\leftarrow mean(cs)" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi><mo stretchy="false" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">←</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.4" xref="alg1.l7.m1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2a" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.5" xref="alg1.l7.m1.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2b" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.6" xref="alg1.l7.m1.1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2c" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">←</ci><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><ci id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">𝑚</ci><ci id="alg1.l7.m1.1.1.1.4.cmml" xref="alg1.l7.m1.1.1.1.4">𝑒</ci><ci id="alg1.l7.m1.1.1.1.5.cmml" xref="alg1.l7.m1.1.1.1.5">𝑎</ci><ci id="alg1.l7.m1.1.1.1.6.cmml" xref="alg1.l7.m1.1.1.1.6">𝑛</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><times id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">𝑐</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\leftarrow mean(cs)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">  <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l8.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i</annotation></semantics></math> in <math id="alg1.l8.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">S</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝑆</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">S_{t}</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">     <span id="alg1.l9.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="cs_{i}&lt;" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">s</mi><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><lt id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></lt><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑐</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑠</ci><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">cs_{i}&lt;</annotation></semantics></math> threshold <span id="alg1.l9.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l10" class="ltx_listingline">        <math id="alg1.l10.m1.1" class="ltx_Math" alttext="B\leftarrow B\cup\{i\}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.2" xref="alg1.l10.m1.1.2.cmml"><mi id="alg1.l10.m1.1.2.2" xref="alg1.l10.m1.1.2.2.cmml">B</mi><mo stretchy="false" id="alg1.l10.m1.1.2.1" xref="alg1.l10.m1.1.2.1.cmml">←</mo><mrow id="alg1.l10.m1.1.2.3" xref="alg1.l10.m1.1.2.3.cmml"><mi id="alg1.l10.m1.1.2.3.2" xref="alg1.l10.m1.1.2.3.2.cmml">B</mi><mo id="alg1.l10.m1.1.2.3.1" xref="alg1.l10.m1.1.2.3.1.cmml">∪</mo><mrow id="alg1.l10.m1.1.2.3.3.2" xref="alg1.l10.m1.1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l10.m1.1.2.3.3.2.1" xref="alg1.l10.m1.1.2.3.3.1.cmml">{</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.1.2.3.3.2.2" xref="alg1.l10.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.2.cmml" xref="alg1.l10.m1.1.2"><ci id="alg1.l10.m1.1.2.1.cmml" xref="alg1.l10.m1.1.2.1">←</ci><ci id="alg1.l10.m1.1.2.2.cmml" xref="alg1.l10.m1.1.2.2">𝐵</ci><apply id="alg1.l10.m1.1.2.3.cmml" xref="alg1.l10.m1.1.2.3"><union id="alg1.l10.m1.1.2.3.1.cmml" xref="alg1.l10.m1.1.2.3.1"></union><ci id="alg1.l10.m1.1.2.3.2.cmml" xref="alg1.l10.m1.1.2.3.2">𝐵</ci><set id="alg1.l10.m1.1.2.3.3.1.cmml" xref="alg1.l10.m1.1.2.3.3.2"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑖</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">B\leftarrow B\cup\{i\}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">  <math id="alg1.l11.m1.1" class="ltx_Math" alttext="G_{g}\leftarrow Aggr(\{g_{t+1}^{i}\}_{i\in B})" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><msub id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">G</mi><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">←</mo><mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l11.m1.1.1.1.4" xref="alg1.l11.m1.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.2a" xref="alg1.l11.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l11.m1.1.1.1.5" xref="alg1.l11.m1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.2b" xref="alg1.l11.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l11.m1.1.1.1.6" xref="alg1.l11.m1.1.1.1.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.2c" xref="alg1.l11.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l11.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mrow id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l11.m1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l11.m1.1.1.1.1.1.1.3.1" xref="alg1.l11.m1.1.1.1.1.1.1.3.1.cmml">∈</mo><mi id="alg1.l11.m1.1.1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.cmml">B</mi></mrow></msub><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">←</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝐺</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑔</ci></apply><apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"><times id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.2"></times><ci id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3">𝐴</ci><ci id="alg1.l11.m1.1.1.1.4.cmml" xref="alg1.l11.m1.1.1.1.4">𝑔</ci><ci id="alg1.l11.m1.1.1.1.5.cmml" xref="alg1.l11.m1.1.1.1.5">𝑔</ci><ci id="alg1.l11.m1.1.1.1.6.cmml" xref="alg1.l11.m1.1.1.1.6">𝑟</ci><apply id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1">subscript</csymbol><set id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg1.l11.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3"><in id="alg1.l11.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.1"></in><ci id="alg1.l11.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">G_{g}\leftarrow Aggr(\{g_{t+1}^{i}\}_{i\in B})</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">  <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\theta_{t}-G_{t}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msub id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">θ</mi><mrow id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.3.1" xref="alg1.l12.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><msub id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">−</mo><msub id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml">G</mi><mi id="alg1.l12.m1.1.1.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝜃</ci><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><plus id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.1"></plus><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><minus id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></minus><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝜃</ci><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2">𝐺</ci><ci id="alg1.l12.m1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\theta_{t+1}\leftarrow\theta_{t}-G_{t}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">  <span id="alg1.l13.1" class="ltx_text ltx_font_bold">Output:</span> <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="alg1.l13.m1.1a"><msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">θ</mi><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝜃</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><plus id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></plus><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\theta_{t+1}</annotation></semantics></math>

</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Experimental Details</h2>

<div id="A4.p1" class="ltx_para ltx_noindent">
<p id="A4.p1.9" class="ltx_p"><span id="A4.p1.9.1" class="ltx_text ltx_font_bold">Datasets and partitioning.</span>
Dataset statistics are provided in Table <a href="#A4.T2" title="Table 2 ‣ Appendix D Experimental Details ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We generate the non-iid partition for all datasets following previous FL works <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>); Fang et al. (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>. Specifically, suppose there are <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A4.p1.1.m1.1a"><mi id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><ci id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">C</annotation></semantics></math> various classes in a dataset. We evenly break all the clients into C groups, in which each group is assigned <math id="A4.p1.2.m2.1" class="ltx_Math" alttext="1/C" display="inline"><semantics id="A4.p1.2.m2.1a"><mrow id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><mn id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml">1</mn><mo id="A4.p1.2.m2.1.1.1" xref="A4.p1.2.m2.1.1.1.cmml">/</mo><mi id="A4.p1.2.m2.1.1.3" xref="A4.p1.2.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><divide id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1.1"></divide><cn type="integer" id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2">1</cn><ci id="A4.p1.2.m2.1.1.3.cmml" xref="A4.p1.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">1/C</annotation></semantics></math> of training samples as follows. A training point with label <math id="A4.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A4.p1.3.m3.1a"><mi id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><ci id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">c</annotation></semantics></math> would be assigned to <math id="A4.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A4.p1.4.m4.1a"><mi id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><ci id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">c</annotation></semantics></math>-th group with probability <math id="A4.p1.5.m5.1" class="ltx_Math" alttext="q\geq 1/C" display="inline"><semantics id="A4.p1.5.m5.1a"><mrow id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mi id="A4.p1.5.m5.1.1.2" xref="A4.p1.5.m5.1.1.2.cmml">q</mi><mo id="A4.p1.5.m5.1.1.1" xref="A4.p1.5.m5.1.1.1.cmml">≥</mo><mrow id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml"><mn id="A4.p1.5.m5.1.1.3.2" xref="A4.p1.5.m5.1.1.3.2.cmml">1</mn><mo id="A4.p1.5.m5.1.1.3.1" xref="A4.p1.5.m5.1.1.3.1.cmml">/</mo><mi id="A4.p1.5.m5.1.1.3.3" xref="A4.p1.5.m5.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><geq id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1.1"></geq><ci id="A4.p1.5.m5.1.1.2.cmml" xref="A4.p1.5.m5.1.1.2">𝑞</ci><apply id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3"><divide id="A4.p1.5.m5.1.1.3.1.cmml" xref="A4.p1.5.m5.1.1.3.1"></divide><cn type="integer" id="A4.p1.5.m5.1.1.3.2.cmml" xref="A4.p1.5.m5.1.1.3.2">1</cn><ci id="A4.p1.5.m5.1.1.3.3.cmml" xref="A4.p1.5.m5.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">q\geq 1/C</annotation></semantics></math> and to each of the rest groups with probability <math id="A4.p1.6.m6.2" class="ltx_Math" alttext="(1-q)/(1-C)" display="inline"><semantics id="A4.p1.6.m6.2a"><mrow id="A4.p1.6.m6.2.2" xref="A4.p1.6.m6.2.2.cmml"><mrow id="A4.p1.6.m6.1.1.1.1" xref="A4.p1.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.p1.6.m6.1.1.1.1.2" xref="A4.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="A4.p1.6.m6.1.1.1.1.1" xref="A4.p1.6.m6.1.1.1.1.1.cmml"><mn id="A4.p1.6.m6.1.1.1.1.1.2" xref="A4.p1.6.m6.1.1.1.1.1.2.cmml">1</mn><mo id="A4.p1.6.m6.1.1.1.1.1.1" xref="A4.p1.6.m6.1.1.1.1.1.1.cmml">−</mo><mi id="A4.p1.6.m6.1.1.1.1.1.3" xref="A4.p1.6.m6.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="A4.p1.6.m6.1.1.1.1.3" xref="A4.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.p1.6.m6.2.2.3" xref="A4.p1.6.m6.2.2.3.cmml">/</mo><mrow id="A4.p1.6.m6.2.2.2.1" xref="A4.p1.6.m6.2.2.2.1.1.cmml"><mo stretchy="false" id="A4.p1.6.m6.2.2.2.1.2" xref="A4.p1.6.m6.2.2.2.1.1.cmml">(</mo><mrow id="A4.p1.6.m6.2.2.2.1.1" xref="A4.p1.6.m6.2.2.2.1.1.cmml"><mn id="A4.p1.6.m6.2.2.2.1.1.2" xref="A4.p1.6.m6.2.2.2.1.1.2.cmml">1</mn><mo id="A4.p1.6.m6.2.2.2.1.1.1" xref="A4.p1.6.m6.2.2.2.1.1.1.cmml">−</mo><mi id="A4.p1.6.m6.2.2.2.1.1.3" xref="A4.p1.6.m6.2.2.2.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="A4.p1.6.m6.2.2.2.1.3" xref="A4.p1.6.m6.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.6.m6.2b"><apply id="A4.p1.6.m6.2.2.cmml" xref="A4.p1.6.m6.2.2"><divide id="A4.p1.6.m6.2.2.3.cmml" xref="A4.p1.6.m6.2.2.3"></divide><apply id="A4.p1.6.m6.1.1.1.1.1.cmml" xref="A4.p1.6.m6.1.1.1.1"><minus id="A4.p1.6.m6.1.1.1.1.1.1.cmml" xref="A4.p1.6.m6.1.1.1.1.1.1"></minus><cn type="integer" id="A4.p1.6.m6.1.1.1.1.1.2.cmml" xref="A4.p1.6.m6.1.1.1.1.1.2">1</cn><ci id="A4.p1.6.m6.1.1.1.1.1.3.cmml" xref="A4.p1.6.m6.1.1.1.1.1.3">𝑞</ci></apply><apply id="A4.p1.6.m6.2.2.2.1.1.cmml" xref="A4.p1.6.m6.2.2.2.1"><minus id="A4.p1.6.m6.2.2.2.1.1.1.cmml" xref="A4.p1.6.m6.2.2.2.1.1.1"></minus><cn type="integer" id="A4.p1.6.m6.2.2.2.1.1.2.cmml" xref="A4.p1.6.m6.2.2.2.1.1.2">1</cn><ci id="A4.p1.6.m6.2.2.2.1.1.3.cmml" xref="A4.p1.6.m6.2.2.2.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.6.m6.2c">(1-q)/(1-C)</annotation></semantics></math>. The attacking clients would be evenly distributed across <math id="A4.p1.7.m7.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A4.p1.7.m7.1a"><mi id="A4.p1.7.m7.1.1" xref="A4.p1.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.1b"><ci id="A4.p1.7.m7.1.1.cmml" xref="A4.p1.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.1c">C</annotation></semantics></math> groups. A higher <math id="A4.p1.8.m8.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.p1.8.m8.1a"><mi id="A4.p1.8.m8.1.1" xref="A4.p1.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.p1.8.m8.1b"><ci id="A4.p1.8.m8.1.1.cmml" xref="A4.p1.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m8.1c">q</annotation></semantics></math> value stands for a higher non-iid degree. In the experiments above, we set the default <math id="A4.p1.9.m9.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.p1.9.m9.1a"><mi id="A4.p1.9.m9.1.1" xref="A4.p1.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.p1.9.m9.1b"><ci id="A4.p1.9.m9.1.1.cmml" xref="A4.p1.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m9.1c">q</annotation></semantics></math> equals to 0.5 and partition the datasets into 100 clusters.</p>
</div>
<figure id="A4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>
Dataset statistics.
</figcaption>
<table id="A4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T2.1.1.1" class="ltx_tr">
<th id="A4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_border_t"><span id="A4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_border_t"><span id="A4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Train Clients</span></th>
<th id="A4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="A4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Train Examples</span></th>
<th id="A4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="A4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Test Examples</span></th>
<th id="A4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="A4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">Input Size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T2.1.2.1" class="ltx_tr">
<th id="A4.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">MNIST</th>
<th id="A4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">100</th>
<td id="A4.T2.1.2.1.3" class="ltx_td ltx_align_center">60,000</td>
<td id="A4.T2.1.2.1.4" class="ltx_td ltx_align_center">10,000</td>
<td id="A4.T2.1.2.1.5" class="ltx_td ltx_align_center">1x28x28</td>
</tr>
<tr id="A4.T2.1.3.2" class="ltx_tr">
<th id="A4.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Fashion-MNIST</th>
<th id="A4.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">100</th>
<td id="A4.T2.1.3.2.3" class="ltx_td ltx_align_center">60,000</td>
<td id="A4.T2.1.3.2.4" class="ltx_td ltx_align_center">10,000</td>
<td id="A4.T2.1.3.2.5" class="ltx_td ltx_align_center">1x28x28</td>
</tr>
<tr id="A4.T2.1.4.3" class="ltx_tr">
<th id="A4.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">CIFAR-10</th>
<th id="A4.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">100</th>
<td id="A4.T2.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">50,000</td>
<td id="A4.T2.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">10,000</td>
<td id="A4.T2.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb">3x32x32</td>
</tr>
</tbody>
</table>
</figure>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p"><span id="A4.p2.1.1" class="ltx_text ltx_font_bold">Baseline implementations and parameter selections.</span>
We follow the same implementation details for Krum and Clipping-Median as in the previous work <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>.
For Krum, we set the number of the attacker parameter <math id="A4.p2.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="A4.p2.1.m1.1a"><mi id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><ci id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">f</annotation></semantics></math> to its real value in each round for the best performance. For the Clipping-Median, we first apply norm-clipping <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> then perform coordinate-wise median <cite class="ltx_cite ltx_citemacro_cite">Yin et al. (<a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite>, since it is shown to be more powerful than the vanilla median <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>. Moreover, we provide the results for no defense case, where the server only performs FedAvg aggregation.
For all experiments, the communication rounds fix to 1000, and the local training iteration number is 1 with batch size 128. The aggregation function is FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>. The default local learning rate is 0.01 for all experiments.</p>
</div>
<div id="A4.p3" class="ltx_para ltx_noindent">
<p id="A4.p3.1" class="ltx_p"><span id="A4.p3.1.1" class="ltx_text ltx_font_bold">Configurations.</span>
All experiments are conducted by CPU/GPU simulation. The simulation experiments are conducted on a computing server with eight GPUs. The server is equipped with AMD EPYC 7502 32-Core Processor and 1024G memory. The GPU is NVIDIA RTX A4000.</p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Experimental Results</h2>

<div id="A5.p1" class="ltx_para ltx_noindent">
<p id="A5.p1.1" class="ltx_p">The final global model accuracy of each method is provided in the table <a href="#A5.T3" title="Table 3 ‣ Appendix E Experimental Results ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="A5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>
Global model accuracy comparison between No Defense, Krum, Clipping-Median, and <span id="A5.T3.2.1" class="ltx_text ltx_font_typewriter">CosDefense</span>.
</figcaption>
<table id="A5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A5.T3.3.1.1" class="ltx_tr">
<td id="A5.T3.3.1.1.1" class="ltx_td ltx_border_tt ltx_border_t"></td>
<th id="A5.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">No Defense</th>
<th id="A5.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">Krun</th>
<th id="A5.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">Clipping-Median</th>
<th id="A5.T3.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="A5.T3.3.1.1.5.1" class="ltx_text ltx_font_typewriter">CosDefense</span></th>
</tr>
<tr id="A5.T3.3.2.2" class="ltx_tr">
<td id="A5.T3.3.2.2.1" class="ltx_td ltx_align_center ltx_border_t">MNIST</td>
<td id="A5.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t">9.8%</td>
<td id="A5.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t">9.8%</td>
<td id="A5.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t">19.29%</td>
<td id="A5.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A5.T3.3.2.2.5.1" class="ltx_text ltx_font_bold">83.37%</span></td>
</tr>
<tr id="A5.T3.3.3.3" class="ltx_tr">
<td id="A5.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t">F-MNIST</td>
<td id="A5.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t">10%</td>
<td id="A5.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">10%</td>
<td id="A5.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">21.24%</td>
<td id="A5.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A5.T3.3.3.3.5.1" class="ltx_text ltx_font_bold">67.63%</span></td>
</tr>
<tr id="A5.T3.3.4.4" class="ltx_tr">
<td id="A5.T3.3.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">CIFAR-10</td>
<td id="A5.T3.3.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">10%</td>
<td id="A5.T3.3.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">10%</td>
<td id="A5.T3.3.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">20.89%</td>
<td id="A5.T3.3.4.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="A5.T3.3.4.4.5.1" class="ltx_text ltx_font_bold">52.02%</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="A5.p2" class="ltx_para ltx_noindent">
<p id="A5.p2.1" class="ltx_p"><span id="A5.p2.1.1" class="ltx_text ltx_font_bold">Impact of the non-iid degree.</span>
In order to investigate the impact of data heterogeneity on <span id="A5.p2.1.2" class="ltx_text ltx_font_typewriter">CosDefense</span>, we partition the MNIST dataset with <math id="A5.p2.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A5.p2.1.m1.1a"><mi id="A5.p2.1.m1.1.1" xref="A5.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A5.p2.1.m1.1b"><ci id="A5.p2.1.m1.1.1.cmml" xref="A5.p2.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.1.m1.1c">q</annotation></semantics></math> equals 0.1, 0.3, and 0.5, respectively, and run all three defense strategies on top of the IPM attack for the evaluation. We set 30% of the devices as malicious clients, the same as in the previous section.
As shown in Figure <a href="#A5.F6" title="Figure 6 ‣ Appendix E Experimental Results ‣ Secure Federated Learning against Model Poisoning Attacks via Client Filtering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we observe that <span id="A5.p2.1.3" class="ltx_text ltx_font_typewriter">CosDefense</span> is stable with the change of the non-iid degree, and outperforms the other two defense baselines on accuracy performance among all scenarios.
The results indicate that the <span id="A5.p2.1.4" class="ltx_text ltx_font_typewriter">CosDefense</span> is resistant to the impact of data heterogeneity compared to the other defense baselines.</p>
</div>
<figure id="A5.F6" class="ltx_figure"><img src="/html/2304.00160/assets/plot/ipm-hetero.png" id="A5.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="269" height="217" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Accuracy performance on MNIST dataset under different non-iid partition levels.</figcaption>
</figure>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Limitations and Future works.</h2>

<div id="A6.p1" class="ltx_para ltx_noindent">
<p id="A6.p1.1" class="ltx_p">One of the directions for future work is the combination of <span id="A6.p1.1.1" class="ltx_text ltx_font_typewriter">CosDefense</span> with the existing secure aggregation frameworks. The challenging point is that under the secure aggregation frameworks, each model update is locally encrypted and uninspectable by a server. Instead, only the sum of the model update would be revealed to the server when sufficient updates have been received, which impedes the implementation of <span id="A6.p1.1.2" class="ltx_text ltx_font_typewriter">CosDefense</span> on top of it.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2304.00159" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2304.00160" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2304.00160">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2304.00160" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2304.00161" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 16:04:53 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
