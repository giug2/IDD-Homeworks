<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.09232] MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes</title><meta property="og:description" content="In some real-world applications, data samples are usually distributed on local devices, where federated learning (FL) techniques are proposed to coordinate decentralized clients without directly sharing users’ private …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.09232">

<!--Generated on Sun May  5 22:23:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated learning,  Non-I.I.D. data,  label distribution shift,  aggregation,  personalization,  incomplete classes,  restricted softmax,  inherited private model
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xin-Chun Li,
Shaoming Song,
Yinchuan Li, 
Bingshuai Li,
Yunfeng Shao,
Yang Yang,
and De-Chuan Zhan
</span><span class="ltx_author_notes">
Xin-Chun Li and De-Chuan Zhan are with the State Key Laboratory for Novel Software Technology, Nanjing University, Nanjing, Jiangsu 210023, China.
E-mail: lixc@lamda.nju.edu.cn, zhandc@nju.edu.cn
Yang Yang is with the Nanjing University of Science and Technology, Nanjing, Jiangsu 210094, China.
E-mail: yyang@njust.edu.cn
Shaoming Song, Yinchuan Li, Bingshuai Li, and Yunfeng Shao are with Huawei Noah’s Ark Lab, Beijing 100085, China.
E-mail: {shaoming.song, liyinchuan, libingshuai, shaoyunfeng}@huawei.com
Yang Yang is the corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">In some real-world applications, data samples are usually distributed on local devices, where federated learning (FL) techniques are proposed to coordinate decentralized clients without directly sharing users’ private data. FL commonly follows the parameter server architecture and contains multiple personalization and aggregation procedures. The natural data heterogeneity across clients, i.e., Non-I.I.D. data, challenges both the aggregation and personalization goals in FL. In this paper, we focus on a special kind of Non-I.I.D. scene where clients own incomplete classes, i.e., each client can only access a partial set of the whole class set. The server aims to aggregate a complete classification model that could generalize to all classes, while the clients are inclined to improve the performance of distinguishing their observed classes. For better model aggregation, we point out that the standard softmax will encounter several problems caused by missing classes and propose “restricted softmax” as an alternative. For better model personalization, we point out that the hard-won personalized models are not well exploited and propose “inherited private model” to store the personalization experience. Our proposed algorithm named MAP could simultaneously achieve the aggregation and personalization goals in FL. Abundant experimental studies verify the superiorities of our algorithm.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated learning, Non-I.I.D. data, label distribution shift, aggregation, personalization, incomplete classes, restricted softmax, inherited private model

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Although deep learning has experienced great success in many fields <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, a data center training paradigm is usually required. Due to data privacy or transmission cost, data from individual participants can not be located on the same device in some real-world applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Standard distributed optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> provides solutions to distributed training with big data or huge models, while federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> is tailored for data privacy protection and efficient distributed training. Like most distributed optimization algorithms, FL is commonly organized in the parameter server architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> where a server coordinates amounts of clients to accomplish the model training process. Specifically, FL takes multiple rounds of local personalization and global aggregation procedures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> to coordinate isolated clients. During the local personalization procedure, a subset of clients download the global model from the central server and update it on their local private data. During the global aggregation procedure, the central server receives clients’ model parameters and updates the global model. These two procedures are iterated until convergence. In the whole process, only model parameters are transmitted among clients and the server, which brings basic privacy protection for participating users. Additionally, clients often undertake more computation steps during local personalization procedures, e.g., epochs of training on local data, making decentralized training more communication efficient. Due to these advantages, FL has been successfully applied to computer vision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, speech analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, etc.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The server and clients in FL have different goals. The server aims to aggregate a single global model that could generalize well to forthcoming data, while clients participate in FL with the purpose of enhancing the local model performance on their own private data. To be brief, the server wants to obtain a single global model that performs well on the global data distribution, while clients want to obtain personalized models that perform well on their local data distributions. The Non-I.I.D. data across clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> hinders both the global aggregation and local personalization goals in FL. On the one hand, the local training procedure will diverge a lot from the global target due to the discrepancy between the local and global data distribution, leading to the weight divergence phenomenon that degrades the aggregation performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. On the other hand, the globally aggregated model may be a compromise among clients, which performs worse than the locally trained model on a specific client’s data and dispels the client’s incentive to participate in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. The stronger the heterogeneity of the local data distributions, the harder it is to simultaneously obtain a satisfied global model and local personalized models. Hence, it is necessary to design effective strategies for both aggregation and personalization goals under Non-I.I.D. scenes.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we study a special kind of Non-I.I.D. scene where clients own incomplete classes. Specifically, the server is targeted to classify a set of classes, while clients only observe a partial set of these classes. This scene is an extreme case of the label distribution skew <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> in FL that certain classes are not presented in some clients’ data currently or even in the future. Hence, the server’s goal is to obtain a model that could distinguish all classes well, while clients only aim to obtain personalized models that perform well on their observed classes. For example, in photo classification, the server needs to recognize many types of photos, while a specific terminal device only needs to recognize partial classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>; in service awareness application, the server needs to build a model to identify the byte stream of multiple APP types, while a user may not have downloaded some APPs and does not need to identify them <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>; in disease prediction, the server needs to obtain a model to recognize disease types as more as possible, while a specialized hospital only needs to recognize a fraction of disease types. The illustrations of the scene and goals are shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our motivation is to achieve both aggregation and personalization goals in the FL scene with incomplete classes. Fortunately, the author’s two previous works, i.e., FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, can be seamlessly combined to achieve both goals.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2404.09232/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.2.1" class="ltx_text" style="font-size:90%;">The considered FL scene with incomplete classes.</span></figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> is proposed for better model aggregation, which in-depth analyzes and improves the classification layer of a neural network. Existing studies show that the topmost layer is more task-specific than bottom layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. Faced with label distribution skew, the commonly utilized softmax operation for classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> could be more vulnerable. Specifically, we first analyze and show the inherent pulling and pushing forces in standard softmax. Then we point out that several properties will disappear faced with missing classes, making the missing classes’ proxies become inaccurate during local training procedures of FL. As an alternative, we slightly modify the standard softmax and introduce “restricted softmax” (RS) to limit the update of missing classes’ weights for better aggregation.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> is proposed for better model personalization, which in-depth analyzes and improves the exploitation of personalized models. Our significant observation is that the newly downloaded global model from the server may perform poorly on clients, while it could become better after adequate personalization steps. Inspired by this, we advocate that the hard-won personalized model in each communication round should be rationally exploited, while standard FL methods directly overwrite the previous personalized models. Specifically, we propose a novel concept named “inherited private model” (HPM) for each local client as a temporal ensembling of its historical personalized models and exploit it to supervise the personalization process in the next global round.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">FedRS is designed for model aggregation, while FedPHP is for model personalization, and neither of them could achieve aggregation and personalization goals simultaneously. Hence, we utilize the “RS” in FedRS for better model aggregation and the “HPM” in FedPHP for better model personalization, which could simultaneously achieve model aggregation and personalization goals in FL with incomplete classes. We name the proposed method MAP and investigate its superiorities via abundant experimental studies and analysis.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Works</span>
</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.2" class="ltx_p"><span id="S2.p1.2.1" class="ltx_text ltx_font_bold">FL with Non-I.I.D. Data.</span>
Commonly, FL divides the Non-I.I.D. scenes into five categories: feature distribution skew, label distribution skew, concept shift with different features, concept shift with different labels, and quantity skew. The first two categories correspond to the covariate shift and label shift in dataset shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Label distribution skew is also related to class imbalanced learning with long tail data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> or class incremental learning with new classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Label distribution skew in FL refers to that the prior label distributions <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="{\mathcal{P}}^{k}(y)" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.2" xref="S2.p1.1.m1.1.2.cmml"><msup id="S2.p1.1.m1.1.2.2" xref="S2.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.2.2.2" xref="S2.p1.1.m1.1.2.2.2.cmml">𝒫</mi><mi id="S2.p1.1.m1.1.2.2.3" xref="S2.p1.1.m1.1.2.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S2.p1.1.m1.1.2.1" xref="S2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.p1.1.m1.1.2.3.2" xref="S2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.p1.1.m1.1.2.3.2.1" xref="S2.p1.1.m1.1.2.cmml">(</mo><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="S2.p1.1.m1.1.2.3.2.2" xref="S2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.2.cmml" xref="S2.p1.1.m1.1.2"><times id="S2.p1.1.m1.1.2.1.cmml" xref="S2.p1.1.m1.1.2.1"></times><apply id="S2.p1.1.m1.1.2.2.cmml" xref="S2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.2.2.1.cmml" xref="S2.p1.1.m1.1.2.2">superscript</csymbol><ci id="S2.p1.1.m1.1.2.2.2.cmml" xref="S2.p1.1.m1.1.2.2.2">𝒫</ci><ci id="S2.p1.1.m1.1.2.2.3.cmml" xref="S2.p1.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">{\mathcal{P}}^{k}(y)</annotation></semantics></math> may vary a lot across clients, but <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="{\mathcal{P}}^{k}({\mathbf{x}}|y)" display="inline"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><msup id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1.3.2" xref="S2.p1.2.m2.1.1.3.2.cmml">𝒫</mi><mi id="S2.p1.2.m2.1.1.3.3" xref="S2.p1.2.m2.1.1.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S2.p1.2.m2.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p1.2.m2.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.2.m2.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.1.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S2.p1.2.m2.1.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p1.2.m2.1.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S2.p1.2.m2.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><times id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2"></times><apply id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.p1.2.m2.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.3.2">𝒫</ci><ci id="S2.p1.2.m2.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3">𝑘</ci></apply><apply id="S2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1.2">𝐱</ci><ci id="S2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">{\mathcal{P}}^{k}({\mathbf{x}}|y)</annotation></semantics></math> is the same. The considered scene in this paper is a special case of label distribution skew in FL, where the prior label distribution of some clients is extremely imbalanced, i.e., some classes are missing. Various techniques have been proposed to solve the Non-I.I.D. challenge in FL. Most of these techniques improve the aggregation and personalization performances independently. One exception is the recently proposed FedROD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, which borrows techniques from class-imbalanced learning and private-shared models for both aggregation and personalization in FL. Different from FedROD, we in-depth analyze the drawbacks of traditional FL algorithms and propose novel techniques.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Model Aggregation with Non-I.I.D. Data.</span>
FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> takes the simplest parameter averaging for model aggregation, whose performance may degrade under Non-I.I.D. data. The heterogeneity of clients’ data distributions could make the local updates too diverged to aggregate, i.e., the phenomenon of weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Sharing a small public data set among clients could benefit model fusion with a slight risk of privacy leakage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Utilizing local regularizations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> or control variates <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> could restrict the local model parameters not diverge from the global model too much. Designing better optimization strategies could also help aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>. Some methods aim to align model parameters for better aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. FedAwS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> studies the extreme scene where each client could only access one class. The author’s previous work, FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, proposes “RS” to handle the missing classes for better model aggregation. Utilizing class-imbalanced learning techniques is also a possible solution for better aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Model Personalization with Non-I.I.D. Data.</span>
FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> generates a single global model, which is hard to capture heterogeneous local distributions simultaneously <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>. Finetuning the aggregated models is the most direct solution for personalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Some methods resort to multi-task learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> or meta learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> for fast local adaptation. Taking advantage of fully decentralized learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> or private-shared models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> are also solutions for better personalization. The author’s previous work, FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, proposes “HPM” to store the historical personalization experience for better model personalization. A previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> empirically studies how to design appropriate shared-private network architectures for aggregation and personalization. The recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> presents a unique taxonomy of personalized federated learning techniques.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Background and Issues to Solve</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.1.1" class="ltx_text ltx_font_italic">Basic Procedure of FL</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">In standard FL systems, e.g., FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, we have <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> distributed clients and a global parameter server. Each client could be an organization, an individual user, or a terminal device, etc. The <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">k</annotation></semantics></math>-th client has a local data distribution <math id="S3.SS1.p1.3.m3.2" class="ltx_Math" alttext="{\mathcal{D}}^{k}={\mathcal{P}}^{k}({\mathbf{x}},y)" display="inline"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.3" xref="S3.SS1.p1.3.m3.2.3.cmml"><msup id="S3.SS1.p1.3.m3.2.3.2" xref="S3.SS1.p1.3.m3.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.3.2.2" xref="S3.SS1.p1.3.m3.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.2.3.2.3" xref="S3.SS1.p1.3.m3.2.3.2.3.cmml">k</mi></msup><mo id="S3.SS1.p1.3.m3.2.3.1" xref="S3.SS1.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.2.3.3" xref="S3.SS1.p1.3.m3.2.3.3.cmml"><msup id="S3.SS1.p1.3.m3.2.3.3.2" xref="S3.SS1.p1.3.m3.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.3.3.2.2" xref="S3.SS1.p1.3.m3.2.3.3.2.2.cmml">𝒫</mi><mi id="S3.SS1.p1.3.m3.2.3.3.2.3" xref="S3.SS1.p1.3.m3.2.3.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.2.3.3.1" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">​</mo><mrow id="S3.SS1.p1.3.m3.2.3.3.3.2" xref="S3.SS1.p1.3.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.2.3.3.3.2.1" xref="S3.SS1.p1.3.m3.2.3.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.3.m3.2.3.3.3.2.2" xref="S3.SS1.p1.3.m3.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.2.3.3.3.2.3" xref="S3.SS1.p1.3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3"><eq id="S3.SS1.p1.3.m3.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.1"></eq><apply id="S3.SS1.p1.3.m3.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.3.2.1.cmml" xref="S3.SS1.p1.3.m3.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.2.3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.2.3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.3.m3.2.3.3.cmml" xref="S3.SS1.p1.3.m3.2.3.3"><times id="S3.SS1.p1.3.m3.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.1"></times><apply id="S3.SS1.p1.3.m3.2.3.3.2.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.3.3.2.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.2.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2.2">𝒫</ci><ci id="S3.SS1.p1.3.m3.2.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2.3">𝑘</ci></apply><interval closure="open" id="S3.SS1.p1.3.m3.2.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.3.2"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐱</ci><ci id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">{\mathcal{D}}^{k}={\mathcal{P}}^{k}({\mathbf{x}},y)</annotation></semantics></math>, and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{D}}^{k}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">{\mathcal{D}}^{k}</annotation></semantics></math> could differ from other clients’ distributions a lot, where <math id="S3.SS1.p1.5.m5.4" class="ltx_Math" alttext="k\sim{\mathcal{K}}=\{1,2,\cdots,K\}" display="inline"><semantics id="S3.SS1.p1.5.m5.4a"><mrow id="S3.SS1.p1.5.m5.4.5" xref="S3.SS1.p1.5.m5.4.5.cmml"><mi id="S3.SS1.p1.5.m5.4.5.2" xref="S3.SS1.p1.5.m5.4.5.2.cmml">k</mi><mo id="S3.SS1.p1.5.m5.4.5.3" xref="S3.SS1.p1.5.m5.4.5.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.5.4" xref="S3.SS1.p1.5.m5.4.5.4.cmml">𝒦</mi><mo id="S3.SS1.p1.5.m5.4.5.5" xref="S3.SS1.p1.5.m5.4.5.5.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.4.5.6.2" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.4.5.6.2.1" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml">{</mo><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">1</mn><mo id="S3.SS1.p1.5.m5.4.5.6.2.2" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml">,</mo><mn id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">2</mn><mo id="S3.SS1.p1.5.m5.4.5.6.2.3" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml">⋯</mi><mo id="S3.SS1.p1.5.m5.4.5.6.2.4" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml">,</mo><mi id="S3.SS1.p1.5.m5.4.4" xref="S3.SS1.p1.5.m5.4.4.cmml">K</mi><mo stretchy="false" id="S3.SS1.p1.5.m5.4.5.6.2.5" xref="S3.SS1.p1.5.m5.4.5.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.4b"><apply id="S3.SS1.p1.5.m5.4.5.cmml" xref="S3.SS1.p1.5.m5.4.5"><and id="S3.SS1.p1.5.m5.4.5a.cmml" xref="S3.SS1.p1.5.m5.4.5"></and><apply id="S3.SS1.p1.5.m5.4.5b.cmml" xref="S3.SS1.p1.5.m5.4.5"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.4.5.3.cmml" xref="S3.SS1.p1.5.m5.4.5.3">similar-to</csymbol><ci id="S3.SS1.p1.5.m5.4.5.2.cmml" xref="S3.SS1.p1.5.m5.4.5.2">𝑘</ci><ci id="S3.SS1.p1.5.m5.4.5.4.cmml" xref="S3.SS1.p1.5.m5.4.5.4">𝒦</ci></apply><apply id="S3.SS1.p1.5.m5.4.5c.cmml" xref="S3.SS1.p1.5.m5.4.5"><eq id="S3.SS1.p1.5.m5.4.5.5.cmml" xref="S3.SS1.p1.5.m5.4.5.5"></eq><share href="#S3.SS1.p1.5.m5.4.5.4.cmml" id="S3.SS1.p1.5.m5.4.5d.cmml" xref="S3.SS1.p1.5.m5.4.5"></share><set id="S3.SS1.p1.5.m5.4.5.6.1.cmml" xref="S3.SS1.p1.5.m5.4.5.6.2"><cn type="integer" id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">1</cn><cn type="integer" id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">2</cn><ci id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3">⋯</ci><ci id="S3.SS1.p1.5.m5.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4">𝐾</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.4c">k\sim{\mathcal{K}}=\{1,2,\cdots,K\}</annotation></semantics></math>. For the <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">k</annotation></semantics></math>-th client, its optimization target is:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="{\mathcal{L}}(\psi^{k})=\mathbb{E}_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}}^{k}}\left[\ell\left(f({\mathbf{x}}^{k};\psi^{k}),y^{k}\right)\right]," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">ψ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><msub id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">(</mo><msup id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E1.m1.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.3.cmml">,</mo><msup id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.5" xref="S3.E1.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.4.2" xref="S3.E1.m1.2.2.2.4.2.cmml">𝒟</mi><mi id="S3.E1.m1.2.2.2.4.3" xref="S3.E1.m1.2.2.2.4.3.cmml">k</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.2.1.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">(</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml">ψ</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">,</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3.cmml">k</mi></msup><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">ℒ</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝜓</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"></times><apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">𝔼</ci><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval><apply id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.4">superscript</csymbol><ci id="S3.E1.m1.2.2.2.4.2.cmml" xref="S3.E1.m1.2.2.2.4.2">𝒟</ci><ci id="S3.E1.m1.2.2.2.4.3.cmml" xref="S3.E1.m1.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1"><times id="S3.E1.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.3"></times><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.4">ℓ</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3"></times><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4">𝑓</ci><list id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2">𝜓</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">{\mathcal{L}}(\psi^{k})=\mathbb{E}_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}}^{k}}\left[\ell\left(f({\mathbf{x}}^{k};\psi^{k}),y^{k}\right)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.9" class="ltx_p">where <math id="S3.SS1.p1.7.m1.2" class="ltx_Math" alttext="f(\cdot;\psi^{k})" display="inline"><semantics id="S3.SS1.p1.7.m1.2a"><mrow id="S3.SS1.p1.7.m1.2.2" xref="S3.SS1.p1.7.m1.2.2.cmml"><mi id="S3.SS1.p1.7.m1.2.2.3" xref="S3.SS1.p1.7.m1.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.2.2.2" xref="S3.SS1.p1.7.m1.2.2.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.2.2.1.1" xref="S3.SS1.p1.7.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.1.1.2" xref="S3.SS1.p1.7.m1.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.1.1" xref="S3.SS1.p1.7.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.7.m1.2.2.1.1.3" xref="S3.SS1.p1.7.m1.2.2.1.2.cmml">;</mo><msup id="S3.SS1.p1.7.m1.2.2.1.1.1" xref="S3.SS1.p1.7.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.7.m1.2.2.1.1.1.2" xref="S3.SS1.p1.7.m1.2.2.1.1.1.2.cmml">ψ</mi><mi id="S3.SS1.p1.7.m1.2.2.1.1.1.3" xref="S3.SS1.p1.7.m1.2.2.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.1.1.4" xref="S3.SS1.p1.7.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.2b"><apply id="S3.SS1.p1.7.m1.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2"><times id="S3.SS1.p1.7.m1.2.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2"></times><ci id="S3.SS1.p1.7.m1.2.2.3.cmml" xref="S3.SS1.p1.7.m1.2.2.3">𝑓</ci><list id="S3.SS1.p1.7.m1.2.2.1.2.cmml" xref="S3.SS1.p1.7.m1.2.2.1.1"><ci id="S3.SS1.p1.7.m1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1">⋅</ci><apply id="S3.SS1.p1.7.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.2.2.1.1.1.2">𝜓</ci><ci id="S3.SS1.p1.7.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.7.m1.2.2.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.2c">f(\cdot;\psi^{k})</annotation></semantics></math> is the prediction function with parameters <math id="S3.SS1.p1.8.m2.1" class="ltx_Math" alttext="\psi^{k}" display="inline"><semantics id="S3.SS1.p1.8.m2.1a"><msup id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml"><mi id="S3.SS1.p1.8.m2.1.1.2" xref="S3.SS1.p1.8.m2.1.1.2.cmml">ψ</mi><mi id="S3.SS1.p1.8.m2.1.1.3" xref="S3.SS1.p1.8.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><apply id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.p1.8.m2.1.1.2">𝜓</ci><ci id="S3.SS1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">\psi^{k}</annotation></semantics></math>. <math id="S3.SS1.p1.9.m3.2" class="ltx_Math" alttext="\ell\left(\cdot,\cdot\right)" display="inline"><semantics id="S3.SS1.p1.9.m3.2a"><mrow id="S3.SS1.p1.9.m3.2.3" xref="S3.SS1.p1.9.m3.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.9.m3.2.3.2" xref="S3.SS1.p1.9.m3.2.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m3.2.3.1" xref="S3.SS1.p1.9.m3.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.9.m3.2.3.3.2" xref="S3.SS1.p1.9.m3.2.3.3.1.cmml"><mo id="S3.SS1.p1.9.m3.2.3.3.2.1" xref="S3.SS1.p1.9.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m3.1.1" xref="S3.SS1.p1.9.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p1.9.m3.2.3.3.2.2" xref="S3.SS1.p1.9.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m3.2.2" xref="S3.SS1.p1.9.m3.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.9.m3.2.3.3.2.3" xref="S3.SS1.p1.9.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m3.2b"><apply id="S3.SS1.p1.9.m3.2.3.cmml" xref="S3.SS1.p1.9.m3.2.3"><times id="S3.SS1.p1.9.m3.2.3.1.cmml" xref="S3.SS1.p1.9.m3.2.3.1"></times><ci id="S3.SS1.p1.9.m3.2.3.2.cmml" xref="S3.SS1.p1.9.m3.2.3.2">ℓ</ci><interval closure="open" id="S3.SS1.p1.9.m3.2.3.3.1.cmml" xref="S3.SS1.p1.9.m3.2.3.3.2"><ci id="S3.SS1.p1.9.m3.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1">⋅</ci><ci id="S3.SS1.p1.9.m3.2.2.cmml" xref="S3.SS1.p1.9.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m3.2c">\ell\left(\cdot,\cdot\right)</annotation></semantics></math> is the loss function, which is usually the cross-entropy loss for classification tasks. FedAvg takes the following optimization target:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="{\mathcal{L}}(\psi)=\sum_{k=1}^{K}p_{k}\left[\mathbb{E}_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}}^{k}}\left[\ell\left(f({\mathbf{x}}^{k};\psi),y^{k}\right)\right]\right]," display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.1" xref="S3.E2.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.3.3.2" xref="S3.E2.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.3.3.2.1" xref="S3.E2.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">ψ</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.3.3.2.2" xref="S3.E2.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml"><munderover id="S3.E2.m1.5.5.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.5.5.1.1.1.2.2.3.1" xref="S3.E2.m1.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.1.1.1.2.2.3.3" xref="S3.E2.m1.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.5.5.1.1.1.2.3" xref="S3.E2.m1.5.5.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E2.m1.5.5.1.1.1.1.3.3" xref="S3.E2.m1.5.5.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">(</mo><msup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.3.cmml">,</mo><msup id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml">k</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">ψ</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msup><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"></eq><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><times id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1"></times><ci id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2">ℒ</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜓</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"><apply id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.5.5.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.2.2.3"><eq id="S3.E2.m1.5.5.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.5.5.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.5.5.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.5.5.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"></times><apply id="S3.E2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.2">𝑝</ci><ci id="S3.E2.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4">superscript</csymbol><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">𝒟</ci><ci id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.4">ℓ</ci><interval closure="open" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝜓</ci></list></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">{\mathcal{L}}(\psi)=\sum_{k=1}^{K}p_{k}\left[\mathbb{E}_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}}^{k}}\left[\ell\left(f({\mathbf{x}}^{k};\psi),y^{k}\right)\right]\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.24" class="ltx_p">where <math id="S3.SS1.p1.10.m1.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS1.p1.10.m1.1a"><msub id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml"><mi id="S3.SS1.p1.10.m1.1.1.2" xref="S3.SS1.p1.10.m1.1.1.2.cmml">p</mi><mi id="S3.SS1.p1.10.m1.1.1.3" xref="S3.SS1.p1.10.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.1b"><apply id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m1.1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m1.1.1.2.cmml" xref="S3.SS1.p1.10.m1.1.1.2">𝑝</ci><ci id="S3.SS1.p1.10.m1.1.1.3.cmml" xref="S3.SS1.p1.10.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.1c">p_{k}</annotation></semantics></math> denotes the weight of the <math id="S3.SS1.p1.11.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.11.m2.1a"><mi id="S3.SS1.p1.11.m2.1.1" xref="S3.SS1.p1.11.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m2.1b"><ci id="S3.SS1.p1.11.m2.1.1.cmml" xref="S3.SS1.p1.11.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m2.1c">k</annotation></semantics></math>-th client, which satisfies <math id="S3.SS1.p1.12.m3.1" class="ltx_Math" alttext="\sum_{k=1}^{K}p_{k}=1" display="inline"><semantics id="S3.SS1.p1.12.m3.1a"><mrow id="S3.SS1.p1.12.m3.1.1" xref="S3.SS1.p1.12.m3.1.1.cmml"><mrow id="S3.SS1.p1.12.m3.1.1.2" xref="S3.SS1.p1.12.m3.1.1.2.cmml"><msubsup id="S3.SS1.p1.12.m3.1.1.2.1" xref="S3.SS1.p1.12.m3.1.1.2.1.cmml"><mo id="S3.SS1.p1.12.m3.1.1.2.1.2.2" xref="S3.SS1.p1.12.m3.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.12.m3.1.1.2.1.2.3" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.cmml"><mi id="S3.SS1.p1.12.m3.1.1.2.1.2.3.2" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.12.m3.1.1.2.1.2.3.1" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.12.m3.1.1.2.1.2.3.3" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.12.m3.1.1.2.1.3" xref="S3.SS1.p1.12.m3.1.1.2.1.3.cmml">K</mi></msubsup><msub id="S3.SS1.p1.12.m3.1.1.2.2" xref="S3.SS1.p1.12.m3.1.1.2.2.cmml"><mi id="S3.SS1.p1.12.m3.1.1.2.2.2" xref="S3.SS1.p1.12.m3.1.1.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.12.m3.1.1.2.2.3" xref="S3.SS1.p1.12.m3.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S3.SS1.p1.12.m3.1.1.1" xref="S3.SS1.p1.12.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.p1.12.m3.1.1.3" xref="S3.SS1.p1.12.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m3.1b"><apply id="S3.SS1.p1.12.m3.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1"><eq id="S3.SS1.p1.12.m3.1.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1.1"></eq><apply id="S3.SS1.p1.12.m3.1.1.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2"><apply id="S3.SS1.p1.12.m3.1.1.2.1.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m3.1.1.2.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1">superscript</csymbol><apply id="S3.SS1.p1.12.m3.1.1.2.1.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m3.1.1.2.1.2.1.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1">subscript</csymbol><sum id="S3.SS1.p1.12.m3.1.1.2.1.2.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.2.2"></sum><apply id="S3.SS1.p1.12.m3.1.1.2.1.2.3.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3"><eq id="S3.SS1.p1.12.m3.1.1.2.1.2.3.1.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.1"></eq><ci id="S3.SS1.p1.12.m3.1.1.2.1.2.3.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.12.m3.1.1.2.1.2.3.3.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.12.m3.1.1.2.1.3.cmml" xref="S3.SS1.p1.12.m3.1.1.2.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.12.m3.1.1.2.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m3.1.1.2.2.1.cmml" xref="S3.SS1.p1.12.m3.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m3.1.1.2.2.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2.2.2">𝑝</ci><ci id="S3.SS1.p1.12.m3.1.1.2.2.3.cmml" xref="S3.SS1.p1.12.m3.1.1.2.2.3">𝑘</ci></apply></apply><cn type="integer" id="S3.SS1.p1.12.m3.1.1.3.cmml" xref="S3.SS1.p1.12.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m3.1c">\sum_{k=1}^{K}p_{k}=1</annotation></semantics></math>. We denote <math id="S3.SS1.p1.13.m4.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS1.p1.13.m4.1a"><mi id="S3.SS1.p1.13.m4.1.1" xref="S3.SS1.p1.13.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m4.1b"><ci id="S3.SS1.p1.13.m4.1.1.cmml" xref="S3.SS1.p1.13.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m4.1c">\psi</annotation></semantics></math> as the global parameters on the server, and <math id="S3.SS1.p1.14.m5.1" class="ltx_Math" alttext="\psi^{k}" display="inline"><semantics id="S3.SS1.p1.14.m5.1a"><msup id="S3.SS1.p1.14.m5.1.1" xref="S3.SS1.p1.14.m5.1.1.cmml"><mi id="S3.SS1.p1.14.m5.1.1.2" xref="S3.SS1.p1.14.m5.1.1.2.cmml">ψ</mi><mi id="S3.SS1.p1.14.m5.1.1.3" xref="S3.SS1.p1.14.m5.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m5.1b"><apply id="S3.SS1.p1.14.m5.1.1.cmml" xref="S3.SS1.p1.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m5.1.1.1.cmml" xref="S3.SS1.p1.14.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m5.1.1.2.cmml" xref="S3.SS1.p1.14.m5.1.1.2">𝜓</ci><ci id="S3.SS1.p1.14.m5.1.1.3.cmml" xref="S3.SS1.p1.14.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m5.1c">\psi^{k}</annotation></semantics></math> as the parameters on the <math id="S3.SS1.p1.15.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.15.m6.1a"><mi id="S3.SS1.p1.15.m6.1.1" xref="S3.SS1.p1.15.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m6.1b"><ci id="S3.SS1.p1.15.m6.1.1.cmml" xref="S3.SS1.p1.15.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m6.1c">k</annotation></semantics></math>-th client. The optimization target in Eq. <a href="#S3.E2" title="In 3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> can be solved by rounds of local personalization and global aggregation procedures. During the local procedure in <math id="S3.SS1.p1.16.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.16.m7.1a"><mi id="S3.SS1.p1.16.m7.1.1" xref="S3.SS1.p1.16.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m7.1b"><ci id="S3.SS1.p1.16.m7.1.1.cmml" xref="S3.SS1.p1.16.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m7.1c">t</annotation></semantics></math>-th round, where <math id="S3.SS1.p1.17.m8.4" class="ltx_Math" alttext="t\in\{1,2,\cdots,T\}" display="inline"><semantics id="S3.SS1.p1.17.m8.4a"><mrow id="S3.SS1.p1.17.m8.4.5" xref="S3.SS1.p1.17.m8.4.5.cmml"><mi id="S3.SS1.p1.17.m8.4.5.2" xref="S3.SS1.p1.17.m8.4.5.2.cmml">t</mi><mo id="S3.SS1.p1.17.m8.4.5.1" xref="S3.SS1.p1.17.m8.4.5.1.cmml">∈</mo><mrow id="S3.SS1.p1.17.m8.4.5.3.2" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.17.m8.4.5.3.2.1" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml">{</mo><mn id="S3.SS1.p1.17.m8.1.1" xref="S3.SS1.p1.17.m8.1.1.cmml">1</mn><mo id="S3.SS1.p1.17.m8.4.5.3.2.2" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml">,</mo><mn id="S3.SS1.p1.17.m8.2.2" xref="S3.SS1.p1.17.m8.2.2.cmml">2</mn><mo id="S3.SS1.p1.17.m8.4.5.3.2.3" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.17.m8.3.3" xref="S3.SS1.p1.17.m8.3.3.cmml">⋯</mi><mo id="S3.SS1.p1.17.m8.4.5.3.2.4" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.17.m8.4.4" xref="S3.SS1.p1.17.m8.4.4.cmml">T</mi><mo stretchy="false" id="S3.SS1.p1.17.m8.4.5.3.2.5" xref="S3.SS1.p1.17.m8.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m8.4b"><apply id="S3.SS1.p1.17.m8.4.5.cmml" xref="S3.SS1.p1.17.m8.4.5"><in id="S3.SS1.p1.17.m8.4.5.1.cmml" xref="S3.SS1.p1.17.m8.4.5.1"></in><ci id="S3.SS1.p1.17.m8.4.5.2.cmml" xref="S3.SS1.p1.17.m8.4.5.2">𝑡</ci><set id="S3.SS1.p1.17.m8.4.5.3.1.cmml" xref="S3.SS1.p1.17.m8.4.5.3.2"><cn type="integer" id="S3.SS1.p1.17.m8.1.1.cmml" xref="S3.SS1.p1.17.m8.1.1">1</cn><cn type="integer" id="S3.SS1.p1.17.m8.2.2.cmml" xref="S3.SS1.p1.17.m8.2.2">2</cn><ci id="S3.SS1.p1.17.m8.3.3.cmml" xref="S3.SS1.p1.17.m8.3.3">⋯</ci><ci id="S3.SS1.p1.17.m8.4.4.cmml" xref="S3.SS1.p1.17.m8.4.4">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m8.4c">t\in\{1,2,\cdots,T\}</annotation></semantics></math>, a subset of clients <math id="S3.SS1.p1.18.m9.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS1.p1.18.m9.1a"><msub id="S3.SS1.p1.18.m9.1.1" xref="S3.SS1.p1.18.m9.1.1.cmml"><mi id="S3.SS1.p1.18.m9.1.1.2" xref="S3.SS1.p1.18.m9.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.18.m9.1.1.3" xref="S3.SS1.p1.18.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m9.1b"><apply id="S3.SS1.p1.18.m9.1.1.cmml" xref="S3.SS1.p1.18.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m9.1.1.1.cmml" xref="S3.SS1.p1.18.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m9.1.1.2.cmml" xref="S3.SS1.p1.18.m9.1.1.2">𝑆</ci><ci id="S3.SS1.p1.18.m9.1.1.3.cmml" xref="S3.SS1.p1.18.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m9.1c">S_{t}</annotation></semantics></math> is selected, and the selected clients download the global model, i.e., <math id="S3.SS1.p1.19.m10.1" class="ltx_Math" alttext="\psi_{t}^{k}\leftarrow\psi_{t}" display="inline"><semantics id="S3.SS1.p1.19.m10.1a"><mrow id="S3.SS1.p1.19.m10.1.1" xref="S3.SS1.p1.19.m10.1.1.cmml"><msubsup id="S3.SS1.p1.19.m10.1.1.2" xref="S3.SS1.p1.19.m10.1.1.2.cmml"><mi id="S3.SS1.p1.19.m10.1.1.2.2.2" xref="S3.SS1.p1.19.m10.1.1.2.2.2.cmml">ψ</mi><mi id="S3.SS1.p1.19.m10.1.1.2.2.3" xref="S3.SS1.p1.19.m10.1.1.2.2.3.cmml">t</mi><mi id="S3.SS1.p1.19.m10.1.1.2.3" xref="S3.SS1.p1.19.m10.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.19.m10.1.1.1" xref="S3.SS1.p1.19.m10.1.1.1.cmml">←</mo><msub id="S3.SS1.p1.19.m10.1.1.3" xref="S3.SS1.p1.19.m10.1.1.3.cmml"><mi id="S3.SS1.p1.19.m10.1.1.3.2" xref="S3.SS1.p1.19.m10.1.1.3.2.cmml">ψ</mi><mi id="S3.SS1.p1.19.m10.1.1.3.3" xref="S3.SS1.p1.19.m10.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m10.1b"><apply id="S3.SS1.p1.19.m10.1.1.cmml" xref="S3.SS1.p1.19.m10.1.1"><ci id="S3.SS1.p1.19.m10.1.1.1.cmml" xref="S3.SS1.p1.19.m10.1.1.1">←</ci><apply id="S3.SS1.p1.19.m10.1.1.2.cmml" xref="S3.SS1.p1.19.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m10.1.1.2.1.cmml" xref="S3.SS1.p1.19.m10.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.19.m10.1.1.2.2.cmml" xref="S3.SS1.p1.19.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m10.1.1.2.2.1.cmml" xref="S3.SS1.p1.19.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.19.m10.1.1.2.2.2.cmml" xref="S3.SS1.p1.19.m10.1.1.2.2.2">𝜓</ci><ci id="S3.SS1.p1.19.m10.1.1.2.2.3.cmml" xref="S3.SS1.p1.19.m10.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.19.m10.1.1.2.3.cmml" xref="S3.SS1.p1.19.m10.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.19.m10.1.1.3.cmml" xref="S3.SS1.p1.19.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m10.1.1.3.1.cmml" xref="S3.SS1.p1.19.m10.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.19.m10.1.1.3.2.cmml" xref="S3.SS1.p1.19.m10.1.1.3.2">𝜓</ci><ci id="S3.SS1.p1.19.m10.1.1.3.3.cmml" xref="S3.SS1.p1.19.m10.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m10.1c">\psi_{t}^{k}\leftarrow\psi_{t}</annotation></semantics></math>. Then, the <math id="S3.SS1.p1.20.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.20.m11.1a"><mi id="S3.SS1.p1.20.m11.1.1" xref="S3.SS1.p1.20.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m11.1b"><ci id="S3.SS1.p1.20.m11.1.1.cmml" xref="S3.SS1.p1.20.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m11.1c">k</annotation></semantics></math>-th client samples data batches from its training data and updates <math id="S3.SS1.p1.21.m12.1" class="ltx_Math" alttext="\psi_{t}^{k}" display="inline"><semantics id="S3.SS1.p1.21.m12.1a"><msubsup id="S3.SS1.p1.21.m12.1.1" xref="S3.SS1.p1.21.m12.1.1.cmml"><mi id="S3.SS1.p1.21.m12.1.1.2.2" xref="S3.SS1.p1.21.m12.1.1.2.2.cmml">ψ</mi><mi id="S3.SS1.p1.21.m12.1.1.2.3" xref="S3.SS1.p1.21.m12.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p1.21.m12.1.1.3" xref="S3.SS1.p1.21.m12.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m12.1b"><apply id="S3.SS1.p1.21.m12.1.1.cmml" xref="S3.SS1.p1.21.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m12.1.1.1.cmml" xref="S3.SS1.p1.21.m12.1.1">superscript</csymbol><apply id="S3.SS1.p1.21.m12.1.1.2.cmml" xref="S3.SS1.p1.21.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m12.1.1.2.1.cmml" xref="S3.SS1.p1.21.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.21.m12.1.1.2.2.cmml" xref="S3.SS1.p1.21.m12.1.1.2.2">𝜓</ci><ci id="S3.SS1.p1.21.m12.1.1.2.3.cmml" xref="S3.SS1.p1.21.m12.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.21.m12.1.1.3.cmml" xref="S3.SS1.p1.21.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m12.1c">\psi_{t}^{k}</annotation></semantics></math> via the corresponding empirical loss of Eq. <a href="#S3.E1" title="In 3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The updated parameters, denoted as <math id="S3.SS1.p1.22.m13.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{k}" display="inline"><semantics id="S3.SS1.p1.22.m13.1a"><msubsup id="S3.SS1.p1.22.m13.1.1" xref="S3.SS1.p1.22.m13.1.1.cmml"><mover accent="true" id="S3.SS1.p1.22.m13.1.1.2.2" xref="S3.SS1.p1.22.m13.1.1.2.2.cmml"><mi id="S3.SS1.p1.22.m13.1.1.2.2.2" xref="S3.SS1.p1.22.m13.1.1.2.2.2.cmml">ψ</mi><mo id="S3.SS1.p1.22.m13.1.1.2.2.1" xref="S3.SS1.p1.22.m13.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.22.m13.1.1.2.3" xref="S3.SS1.p1.22.m13.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p1.22.m13.1.1.3" xref="S3.SS1.p1.22.m13.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m13.1b"><apply id="S3.SS1.p1.22.m13.1.1.cmml" xref="S3.SS1.p1.22.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m13.1.1.1.cmml" xref="S3.SS1.p1.22.m13.1.1">superscript</csymbol><apply id="S3.SS1.p1.22.m13.1.1.2.cmml" xref="S3.SS1.p1.22.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m13.1.1.2.1.cmml" xref="S3.SS1.p1.22.m13.1.1">subscript</csymbol><apply id="S3.SS1.p1.22.m13.1.1.2.2.cmml" xref="S3.SS1.p1.22.m13.1.1.2.2"><ci id="S3.SS1.p1.22.m13.1.1.2.2.1.cmml" xref="S3.SS1.p1.22.m13.1.1.2.2.1">^</ci><ci id="S3.SS1.p1.22.m13.1.1.2.2.2.cmml" xref="S3.SS1.p1.22.m13.1.1.2.2.2">𝜓</ci></apply><ci id="S3.SS1.p1.22.m13.1.1.2.3.cmml" xref="S3.SS1.p1.22.m13.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.22.m13.1.1.3.cmml" xref="S3.SS1.p1.22.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m13.1c">\hat{\psi}_{t}^{k}</annotation></semantics></math>, will be uploaded to the server. During the aggregation procedure, the server averages the global model via <math id="S3.SS1.p1.23.m14.1" class="ltx_Math" alttext="\psi_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{\psi}_{t}^{k}" display="inline"><semantics id="S3.SS1.p1.23.m14.1a"><mrow id="S3.SS1.p1.23.m14.1.2" xref="S3.SS1.p1.23.m14.1.2.cmml"><msub id="S3.SS1.p1.23.m14.1.2.2" xref="S3.SS1.p1.23.m14.1.2.2.cmml"><mi id="S3.SS1.p1.23.m14.1.2.2.2" xref="S3.SS1.p1.23.m14.1.2.2.2.cmml">ψ</mi><mrow id="S3.SS1.p1.23.m14.1.2.2.3" xref="S3.SS1.p1.23.m14.1.2.2.3.cmml"><mi id="S3.SS1.p1.23.m14.1.2.2.3.2" xref="S3.SS1.p1.23.m14.1.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.23.m14.1.2.2.3.1" xref="S3.SS1.p1.23.m14.1.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.23.m14.1.2.2.3.3" xref="S3.SS1.p1.23.m14.1.2.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="S3.SS1.p1.23.m14.1.2.1" xref="S3.SS1.p1.23.m14.1.2.1.cmml">←</mo><mrow id="S3.SS1.p1.23.m14.1.2.3" xref="S3.SS1.p1.23.m14.1.2.3.cmml"><msub id="S3.SS1.p1.23.m14.1.2.3.1" xref="S3.SS1.p1.23.m14.1.2.3.1.cmml"><mo id="S3.SS1.p1.23.m14.1.2.3.1.2" xref="S3.SS1.p1.23.m14.1.2.3.1.2.cmml">∑</mo><mrow id="S3.SS1.p1.23.m14.1.2.3.1.3" xref="S3.SS1.p1.23.m14.1.2.3.1.3.cmml"><mi id="S3.SS1.p1.23.m14.1.2.3.1.3.2" xref="S3.SS1.p1.23.m14.1.2.3.1.3.2.cmml">k</mi><mo id="S3.SS1.p1.23.m14.1.2.3.1.3.1" xref="S3.SS1.p1.23.m14.1.2.3.1.3.1.cmml">∈</mo><msub id="S3.SS1.p1.23.m14.1.2.3.1.3.3" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3.cmml"><mi id="S3.SS1.p1.23.m14.1.2.3.1.3.3.2" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3.2.cmml">S</mi><mi id="S3.SS1.p1.23.m14.1.2.3.1.3.3.3" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="S3.SS1.p1.23.m14.1.2.3.2" xref="S3.SS1.p1.23.m14.1.2.3.2.cmml"><mfrac id="S3.SS1.p1.23.m14.1.1" xref="S3.SS1.p1.23.m14.1.1.cmml"><mn id="S3.SS1.p1.23.m14.1.1.3" xref="S3.SS1.p1.23.m14.1.1.3.cmml">1</mn><mrow id="S3.SS1.p1.23.m14.1.1.1.1" xref="S3.SS1.p1.23.m14.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.23.m14.1.1.1.1.2" xref="S3.SS1.p1.23.m14.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.23.m14.1.1.1.1.1" xref="S3.SS1.p1.23.m14.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.23.m14.1.1.1.1.1.2" xref="S3.SS1.p1.23.m14.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.23.m14.1.1.1.1.1.3" xref="S3.SS1.p1.23.m14.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS1.p1.23.m14.1.1.1.1.3" xref="S3.SS1.p1.23.m14.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p1.23.m14.1.2.3.2.1" xref="S3.SS1.p1.23.m14.1.2.3.2.1.cmml">​</mo><msubsup id="S3.SS1.p1.23.m14.1.2.3.2.2" xref="S3.SS1.p1.23.m14.1.2.3.2.2.cmml"><mover accent="true" id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.cmml"><mi id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.2" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.2.cmml">ψ</mi><mo id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.1" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.23.m14.1.2.3.2.2.2.3" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.p1.23.m14.1.2.3.2.2.3" xref="S3.SS1.p1.23.m14.1.2.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m14.1b"><apply id="S3.SS1.p1.23.m14.1.2.cmml" xref="S3.SS1.p1.23.m14.1.2"><ci id="S3.SS1.p1.23.m14.1.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.1">←</ci><apply id="S3.SS1.p1.23.m14.1.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.2.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.23.m14.1.2.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.2.2">𝜓</ci><apply id="S3.SS1.p1.23.m14.1.2.2.3.cmml" xref="S3.SS1.p1.23.m14.1.2.2.3"><plus id="S3.SS1.p1.23.m14.1.2.2.3.1.cmml" xref="S3.SS1.p1.23.m14.1.2.2.3.1"></plus><ci id="S3.SS1.p1.23.m14.1.2.2.3.2.cmml" xref="S3.SS1.p1.23.m14.1.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.23.m14.1.2.2.3.3.cmml" xref="S3.SS1.p1.23.m14.1.2.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.23.m14.1.2.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3"><apply id="S3.SS1.p1.23.m14.1.2.3.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.2.3.1.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1">subscript</csymbol><sum id="S3.SS1.p1.23.m14.1.2.3.1.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.2"></sum><apply id="S3.SS1.p1.23.m14.1.2.3.1.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3"><in id="S3.SS1.p1.23.m14.1.2.3.1.3.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.1"></in><ci id="S3.SS1.p1.23.m14.1.2.3.1.3.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.2">𝑘</ci><apply id="S3.SS1.p1.23.m14.1.2.3.1.3.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.2.3.1.3.3.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.23.m14.1.2.3.1.3.3.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3.2">𝑆</ci><ci id="S3.SS1.p1.23.m14.1.2.3.1.3.3.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.SS1.p1.23.m14.1.2.3.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2"><times id="S3.SS1.p1.23.m14.1.2.3.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.1"></times><apply id="S3.SS1.p1.23.m14.1.1.cmml" xref="S3.SS1.p1.23.m14.1.1"><divide id="S3.SS1.p1.23.m14.1.1.2.cmml" xref="S3.SS1.p1.23.m14.1.1"></divide><cn type="integer" id="S3.SS1.p1.23.m14.1.1.3.cmml" xref="S3.SS1.p1.23.m14.1.1.3">1</cn><apply id="S3.SS1.p1.23.m14.1.1.1.2.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1"><abs id="S3.SS1.p1.23.m14.1.1.1.2.1.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1.2"></abs><apply id="S3.SS1.p1.23.m14.1.1.1.1.1.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.23.m14.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p1.23.m14.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.23.m14.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.SS1.p1.23.m14.1.2.3.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.2.3.2.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2">superscript</csymbol><apply id="S3.SS1.p1.23.m14.1.2.3.2.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m14.1.2.3.2.2.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2">subscript</csymbol><apply id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2"><ci id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.1">^</ci><ci id="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.2.2">𝜓</ci></apply><ci id="S3.SS1.p1.23.m14.1.2.3.2.2.2.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.23.m14.1.2.3.2.2.3.cmml" xref="S3.SS1.p1.23.m14.1.2.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m14.1c">\psi_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{\psi}_{t}^{k}</annotation></semantics></math>. These two procedures will repeat <math id="S3.SS1.p1.24.m15.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p1.24.m15.1a"><mi id="S3.SS1.p1.24.m15.1.1" xref="S3.SS1.p1.24.m15.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m15.1b"><ci id="S3.SS1.p1.24.m15.1.1.cmml" xref="S3.SS1.p1.24.m15.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m15.1c">T</annotation></semantics></math> communication rounds until the convergence.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_italic">FL Scene with Incomplete Classes</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.25" class="ltx_p">The considered FL scene with incomplete classes is an extreme case of label disribution skew in FL. Suppose the <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">k</annotation></semantics></math>-th client owns a training set <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="D^{k}_{\text{tr}}=\{({\mathbf{x}}^{k}_{i},y^{k}_{i})\}_{i=1}^{N^{k}_{\text{tr}}}\sim{\mathcal{D}}^{k}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msubsup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2.2" xref="S3.SS2.p1.2.m2.1.1.3.2.2.cmml">D</mi><mtext id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3a.cmml">tr</mtext><mi id="S3.SS2.p1.2.m2.1.1.3.2.3" xref="S3.SS2.p1.2.m2.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p1.2.m2.1.1.4" xref="S3.SS2.p1.2.m2.1.1.4.cmml">=</mo><msubsup id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml"><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.4" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.5" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.3.1" xref="S3.SS2.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p1.2.m2.1.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><msubsup id="S3.SS2.p1.2.m2.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.3.2.2" xref="S3.SS2.p1.2.m2.1.1.1.3.2.2.cmml">N</mi><mtext id="S3.SS2.p1.2.m2.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.3.3a.cmml">tr</mtext><mi id="S3.SS2.p1.2.m2.1.1.1.3.2.3" xref="S3.SS2.p1.2.m2.1.1.1.3.2.3.cmml">k</mi></msubsup></msubsup><mo id="S3.SS2.p1.2.m2.1.1.5" xref="S3.SS2.p1.2.m2.1.1.5.cmml">∼</mo><msup id="S3.SS2.p1.2.m2.1.1.6" xref="S3.SS2.p1.2.m2.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.6.2" xref="S3.SS2.p1.2.m2.1.1.6.2.cmml">𝒟</mi><mi id="S3.SS2.p1.2.m2.1.1.6.3" xref="S3.SS2.p1.2.m2.1.1.6.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><and id="S3.SS2.p1.2.m2.1.1a.cmml" xref="S3.SS2.p1.2.m2.1.1"></and><apply id="S3.SS2.p1.2.m2.1.1b.cmml" xref="S3.SS2.p1.2.m2.1.1"><eq id="S3.SS2.p1.2.m2.1.1.4.cmml" xref="S3.SS2.p1.2.m2.1.1.4"></eq><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2.2">𝐷</ci><ci id="S3.SS2.p1.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.3.3a.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">tr</mtext></ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1">subscript</csymbol><set id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1"><interval closure="open" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2"><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3"><eq id="S3.SS2.p1.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS2.p1.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.3.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.3.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.2.2">𝑁</ci><ci id="S3.SS2.p1.2.m2.1.1.1.3.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.1.3.3a.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.3"><mtext mathsize="50%" id="S3.SS2.p1.2.m2.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.3.3">tr</mtext></ci></apply></apply></apply><apply id="S3.SS2.p1.2.m2.1.1c.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.5.cmml" xref="S3.SS2.p1.2.m2.1.1.5">similar-to</csymbol><share href="#S3.SS2.p1.2.m2.1.1.1.cmml" id="S3.SS2.p1.2.m2.1.1d.cmml" xref="S3.SS2.p1.2.m2.1.1"></share><apply id="S3.SS2.p1.2.m2.1.1.6.cmml" xref="S3.SS2.p1.2.m2.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.6.1.cmml" xref="S3.SS2.p1.2.m2.1.1.6">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.6.2.cmml" xref="S3.SS2.p1.2.m2.1.1.6.2">𝒟</ci><ci id="S3.SS2.p1.2.m2.1.1.6.3.cmml" xref="S3.SS2.p1.2.m2.1.1.6.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">D^{k}_{\text{tr}}=\{({\mathbf{x}}^{k}_{i},y^{k}_{i})\}_{i=1}^{N^{k}_{\text{tr}}}\sim{\mathcal{D}}^{k}</annotation></semantics></math> with <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="N^{k}_{\text{tr}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msubsup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">N</mi><mtext id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3a.cmml">tr</mtext><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝑁</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3a.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">tr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">N^{k}_{\text{tr}}</annotation></semantics></math> samples, and a test set <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="D^{k}_{\text{te}}=\{({\mathbf{x}}^{k}_{j},y^{k}_{j})\}_{j=1}^{N^{k}_{\text{te}}}\sim{\mathcal{D}}^{k}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msubsup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2.2" xref="S3.SS2.p1.4.m4.1.1.3.2.2.cmml">D</mi><mtext id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3a.cmml">te</mtext><mi id="S3.SS2.p1.4.m4.1.1.3.2.3" xref="S3.SS2.p1.4.m4.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p1.4.m4.1.1.4" xref="S3.SS2.p1.4.m4.1.1.4.cmml">=</mo><msubsup id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml"><mrow id="S3.SS2.p1.4.m4.1.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.4" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml">j</mi><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.5" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS2.p1.4.m4.1.1.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p1.4.m4.1.1.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><msubsup id="S3.SS2.p1.4.m4.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.3.2.2" xref="S3.SS2.p1.4.m4.1.1.1.3.2.2.cmml">N</mi><mtext id="S3.SS2.p1.4.m4.1.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.1.3.3a.cmml">te</mtext><mi id="S3.SS2.p1.4.m4.1.1.1.3.2.3" xref="S3.SS2.p1.4.m4.1.1.1.3.2.3.cmml">k</mi></msubsup></msubsup><mo id="S3.SS2.p1.4.m4.1.1.5" xref="S3.SS2.p1.4.m4.1.1.5.cmml">∼</mo><msup id="S3.SS2.p1.4.m4.1.1.6" xref="S3.SS2.p1.4.m4.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.6.2" xref="S3.SS2.p1.4.m4.1.1.6.2.cmml">𝒟</mi><mi id="S3.SS2.p1.4.m4.1.1.6.3" xref="S3.SS2.p1.4.m4.1.1.6.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><and id="S3.SS2.p1.4.m4.1.1a.cmml" xref="S3.SS2.p1.4.m4.1.1"></and><apply id="S3.SS2.p1.4.m4.1.1b.cmml" xref="S3.SS2.p1.4.m4.1.1"><eq id="S3.SS2.p1.4.m4.1.1.4.cmml" xref="S3.SS2.p1.4.m4.1.1.4"></eq><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.2">𝐷</ci><ci id="S3.SS2.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.3.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3"><mtext mathsize="70%" id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">te</mtext></ci></apply><apply id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1">subscript</csymbol><set id="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1"><interval closure="open" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2"><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="S3.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3"><eq id="S3.SS2.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS2.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.4.m4.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.3.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.3.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3.2.2">𝑁</ci><ci id="S3.SS2.p1.4.m4.1.1.1.3.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.1.3.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3.3"><mtext mathsize="50%" id="S3.SS2.p1.4.m4.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.3.3">te</mtext></ci></apply></apply></apply><apply id="S3.SS2.p1.4.m4.1.1c.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S3.SS2.p1.4.m4.1.1.5.cmml" xref="S3.SS2.p1.4.m4.1.1.5">similar-to</csymbol><share href="#S3.SS2.p1.4.m4.1.1.1.cmml" id="S3.SS2.p1.4.m4.1.1d.cmml" xref="S3.SS2.p1.4.m4.1.1"></share><apply id="S3.SS2.p1.4.m4.1.1.6.cmml" xref="S3.SS2.p1.4.m4.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.6.1.cmml" xref="S3.SS2.p1.4.m4.1.1.6">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.6.2.cmml" xref="S3.SS2.p1.4.m4.1.1.6.2">𝒟</ci><ci id="S3.SS2.p1.4.m4.1.1.6.3.cmml" xref="S3.SS2.p1.4.m4.1.1.6.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">D^{k}_{\text{te}}=\{({\mathbf{x}}^{k}_{j},y^{k}_{j})\}_{j=1}^{N^{k}_{\text{te}}}\sim{\mathcal{D}}^{k}</annotation></semantics></math> with <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="N^{k}_{\text{te}}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msubsup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">N</mi><mtext id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3a.cmml">te</mtext><mi id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">𝑁</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.3a.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">te</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">N^{k}_{\text{te}}</annotation></semantics></math> samples. According to the assumption of label distribution skew in FL, only the prior class distribution <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="{\mathcal{P}}^{k}(y)" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.2" xref="S3.SS2.p1.6.m6.1.2.cmml"><msup id="S3.SS2.p1.6.m6.1.2.2" xref="S3.SS2.p1.6.m6.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.2.2.2" xref="S3.SS2.p1.6.m6.1.2.2.2.cmml">𝒫</mi><mi id="S3.SS2.p1.6.m6.1.2.2.3" xref="S3.SS2.p1.6.m6.1.2.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.2.1" xref="S3.SS2.p1.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.6.m6.1.2.3.2" xref="S3.SS2.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.1.2.3.2.1" xref="S3.SS2.p1.6.m6.1.2.cmml">(</mo><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS2.p1.6.m6.1.2.3.2.2" xref="S3.SS2.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.2.cmml" xref="S3.SS2.p1.6.m6.1.2"><times id="S3.SS2.p1.6.m6.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.2.1"></times><apply id="S3.SS2.p1.6.m6.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.2.2.1.cmml" xref="S3.SS2.p1.6.m6.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.2.2.2.cmml" xref="S3.SS2.p1.6.m6.1.2.2.2">𝒫</ci><ci id="S3.SS2.p1.6.m6.1.2.2.3.cmml" xref="S3.SS2.p1.6.m6.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">{\mathcal{P}}^{k}(y)</annotation></semantics></math> varies across clients, while <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\mathcal{P}}^{k}({\mathbf{x}}|y)" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><msup id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">𝒫</mi><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.7.m7.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><times id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2"></times><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝒫</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">{\mathcal{P}}^{k}({\mathbf{x}}|y)</annotation></semantics></math> keeps the same. To be an extreme case, we assume that <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="{\mathcal{P}}^{k}(y=c)=0" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mrow id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.cmml"><msup id="S3.SS2.p1.8.m8.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.1.3.2.cmml">𝒫</mi><mi id="S3.SS2.p1.8.m8.1.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.1.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.1.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S3.SS2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">=</mo><mn id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><eq id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"></eq><apply id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1"><times id="S3.SS2.p1.8.m8.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.2"></times><apply id="S3.SS2.p1.8.m8.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3.2">𝒫</ci><ci id="S3.SS2.p1.8.m8.1.1.1.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1"><eq id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1"></eq><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn type="integer" id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">{\mathcal{P}}^{k}(y=c)=0</annotation></semantics></math> holds for some certain classes <math id="S3.SS2.p1.9.m9.4" class="ltx_Math" alttext="c\in{\mathcal{C}}=\{1,2,\ldots,C\}" display="inline"><semantics id="S3.SS2.p1.9.m9.4a"><mrow id="S3.SS2.p1.9.m9.4.5" xref="S3.SS2.p1.9.m9.4.5.cmml"><mi id="S3.SS2.p1.9.m9.4.5.2" xref="S3.SS2.p1.9.m9.4.5.2.cmml">c</mi><mo id="S3.SS2.p1.9.m9.4.5.3" xref="S3.SS2.p1.9.m9.4.5.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.4.5.4" xref="S3.SS2.p1.9.m9.4.5.4.cmml">𝒞</mi><mo id="S3.SS2.p1.9.m9.4.5.5" xref="S3.SS2.p1.9.m9.4.5.5.cmml">=</mo><mrow id="S3.SS2.p1.9.m9.4.5.6.2" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m9.4.5.6.2.1" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml">{</mo><mn id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">1</mn><mo id="S3.SS2.p1.9.m9.4.5.6.2.2" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml">,</mo><mn id="S3.SS2.p1.9.m9.2.2" xref="S3.SS2.p1.9.m9.2.2.cmml">2</mn><mo id="S3.SS2.p1.9.m9.4.5.6.2.3" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.9.m9.3.3" xref="S3.SS2.p1.9.m9.3.3.cmml">…</mi><mo id="S3.SS2.p1.9.m9.4.5.6.2.4" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml">,</mo><mi id="S3.SS2.p1.9.m9.4.4" xref="S3.SS2.p1.9.m9.4.4.cmml">C</mi><mo stretchy="false" id="S3.SS2.p1.9.m9.4.5.6.2.5" xref="S3.SS2.p1.9.m9.4.5.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.4b"><apply id="S3.SS2.p1.9.m9.4.5.cmml" xref="S3.SS2.p1.9.m9.4.5"><and id="S3.SS2.p1.9.m9.4.5a.cmml" xref="S3.SS2.p1.9.m9.4.5"></and><apply id="S3.SS2.p1.9.m9.4.5b.cmml" xref="S3.SS2.p1.9.m9.4.5"><in id="S3.SS2.p1.9.m9.4.5.3.cmml" xref="S3.SS2.p1.9.m9.4.5.3"></in><ci id="S3.SS2.p1.9.m9.4.5.2.cmml" xref="S3.SS2.p1.9.m9.4.5.2">𝑐</ci><ci id="S3.SS2.p1.9.m9.4.5.4.cmml" xref="S3.SS2.p1.9.m9.4.5.4">𝒞</ci></apply><apply id="S3.SS2.p1.9.m9.4.5c.cmml" xref="S3.SS2.p1.9.m9.4.5"><eq id="S3.SS2.p1.9.m9.4.5.5.cmml" xref="S3.SS2.p1.9.m9.4.5.5"></eq><share href="#S3.SS2.p1.9.m9.4.5.4.cmml" id="S3.SS2.p1.9.m9.4.5d.cmml" xref="S3.SS2.p1.9.m9.4.5"></share><set id="S3.SS2.p1.9.m9.4.5.6.1.cmml" xref="S3.SS2.p1.9.m9.4.5.6.2"><cn type="integer" id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">1</cn><cn type="integer" id="S3.SS2.p1.9.m9.2.2.cmml" xref="S3.SS2.p1.9.m9.2.2">2</cn><ci id="S3.SS2.p1.9.m9.3.3.cmml" xref="S3.SS2.p1.9.m9.3.3">…</ci><ci id="S3.SS2.p1.9.m9.4.4.cmml" xref="S3.SS2.p1.9.m9.4.4">𝐶</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.4c">c\in{\mathcal{C}}=\{1,2,\ldots,C\}</annotation></semantics></math>. <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">C</annotation></semantics></math> is the number of classes. That is, the <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">k</annotation></semantics></math>-th client’s data could only come from an incomplete class set, i.e., <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="y^{k}_{i}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><msubsup id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2.2" xref="S3.SS2.p1.12.m12.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml">i</mi><mi id="S3.SS2.p1.12.m12.1.1.2.3" xref="S3.SS2.p1.12.m12.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">subscript</csymbol><apply id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.2.1.cmml" xref="S3.SS2.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2.2">𝑦</ci><ci id="S3.SS2.p1.12.m12.1.1.2.3.cmml" xref="S3.SS2.p1.12.m12.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">y^{k}_{i}</annotation></semantics></math> and <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="y^{k}_{j}" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><msubsup id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><mi id="S3.SS2.p1.13.m13.1.1.2.2" xref="S3.SS2.p1.13.m13.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml">j</mi><mi id="S3.SS2.p1.13.m13.1.1.2.3" xref="S3.SS2.p1.13.m13.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">subscript</csymbol><apply id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.2.1.cmml" xref="S3.SS2.p1.13.m13.1.1">superscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2.2">𝑦</ci><ci id="S3.SS2.p1.13.m13.1.1.2.3.cmml" xref="S3.SS2.p1.13.m13.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">y^{k}_{j}</annotation></semantics></math> is only from <math id="S3.SS2.p1.14.m14.1" class="ltx_Math" alttext="{\mathcal{O}}^{k}\subseteq{\mathcal{C}}" display="inline"><semantics id="S3.SS2.p1.14.m14.1a"><mrow id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml"><msup id="S3.SS2.p1.14.m14.1.1.2" xref="S3.SS2.p1.14.m14.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.14.m14.1.1.2.2" xref="S3.SS2.p1.14.m14.1.1.2.2.cmml">𝒪</mi><mi id="S3.SS2.p1.14.m14.1.1.2.3" xref="S3.SS2.p1.14.m14.1.1.2.3.cmml">k</mi></msup><mo id="S3.SS2.p1.14.m14.1.1.1" xref="S3.SS2.p1.14.m14.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.14.m14.1.1.3" xref="S3.SS2.p1.14.m14.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><apply id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1"><subset id="S3.SS2.p1.14.m14.1.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1.1"></subset><apply id="S3.SS2.p1.14.m14.1.1.2.cmml" xref="S3.SS2.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m14.1.1.2.1.cmml" xref="S3.SS2.p1.14.m14.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.14.m14.1.1.2.2.cmml" xref="S3.SS2.p1.14.m14.1.1.2.2">𝒪</ci><ci id="S3.SS2.p1.14.m14.1.1.2.3.cmml" xref="S3.SS2.p1.14.m14.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.14.m14.1.1.3.cmml" xref="S3.SS2.p1.14.m14.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">{\mathcal{O}}^{k}\subseteq{\mathcal{C}}</annotation></semantics></math>. <math id="S3.SS2.p1.15.m15.1" class="ltx_Math" alttext="{\mathcal{O}}^{k}" display="inline"><semantics id="S3.SS2.p1.15.m15.1a"><msup id="S3.SS2.p1.15.m15.1.1" xref="S3.SS2.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.15.m15.1.1.2" xref="S3.SS2.p1.15.m15.1.1.2.cmml">𝒪</mi><mi id="S3.SS2.p1.15.m15.1.1.3" xref="S3.SS2.p1.15.m15.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m15.1b"><apply id="S3.SS2.p1.15.m15.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1">superscript</csymbol><ci id="S3.SS2.p1.15.m15.1.1.2.cmml" xref="S3.SS2.p1.15.m15.1.1.2">𝒪</ci><ci id="S3.SS2.p1.15.m15.1.1.3.cmml" xref="S3.SS2.p1.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m15.1c">{\mathcal{O}}^{k}</annotation></semantics></math> denotes the observed class set of the <math id="S3.SS2.p1.16.m16.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.16.m16.1a"><mi id="S3.SS2.p1.16.m16.1.1" xref="S3.SS2.p1.16.m16.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m16.1b"><ci id="S3.SS2.p1.16.m16.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m16.1c">k</annotation></semantics></math>-th client. Similarly, the missing class set is denoted as <math id="S3.SS2.p1.17.m17.1" class="ltx_Math" alttext="{\mathcal{M}}^{k}={\mathcal{C}}\setminus{\mathcal{O}}^{k}" display="inline"><semantics id="S3.SS2.p1.17.m17.1a"><mrow id="S3.SS2.p1.17.m17.1.1" xref="S3.SS2.p1.17.m17.1.1.cmml"><msup id="S3.SS2.p1.17.m17.1.1.2" xref="S3.SS2.p1.17.m17.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.17.m17.1.1.2.2" xref="S3.SS2.p1.17.m17.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.p1.17.m17.1.1.2.3" xref="S3.SS2.p1.17.m17.1.1.2.3.cmml">k</mi></msup><mo id="S3.SS2.p1.17.m17.1.1.1" xref="S3.SS2.p1.17.m17.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.17.m17.1.1.3" xref="S3.SS2.p1.17.m17.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.17.m17.1.1.3.2" xref="S3.SS2.p1.17.m17.1.1.3.2.cmml">𝒞</mi><mo id="S3.SS2.p1.17.m17.1.1.3.1" xref="S3.SS2.p1.17.m17.1.1.3.1.cmml">∖</mo><msup id="S3.SS2.p1.17.m17.1.1.3.3" xref="S3.SS2.p1.17.m17.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.17.m17.1.1.3.3.2" xref="S3.SS2.p1.17.m17.1.1.3.3.2.cmml">𝒪</mi><mi id="S3.SS2.p1.17.m17.1.1.3.3.3" xref="S3.SS2.p1.17.m17.1.1.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m17.1b"><apply id="S3.SS2.p1.17.m17.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1"><eq id="S3.SS2.p1.17.m17.1.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1.1"></eq><apply id="S3.SS2.p1.17.m17.1.1.2.cmml" xref="S3.SS2.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.1.1.2.1.cmml" xref="S3.SS2.p1.17.m17.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.17.m17.1.1.2.2.cmml" xref="S3.SS2.p1.17.m17.1.1.2.2">ℳ</ci><ci id="S3.SS2.p1.17.m17.1.1.2.3.cmml" xref="S3.SS2.p1.17.m17.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.17.m17.1.1.3.cmml" xref="S3.SS2.p1.17.m17.1.1.3"><setdiff id="S3.SS2.p1.17.m17.1.1.3.1.cmml" xref="S3.SS2.p1.17.m17.1.1.3.1"></setdiff><ci id="S3.SS2.p1.17.m17.1.1.3.2.cmml" xref="S3.SS2.p1.17.m17.1.1.3.2">𝒞</ci><apply id="S3.SS2.p1.17.m17.1.1.3.3.cmml" xref="S3.SS2.p1.17.m17.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.1.1.3.3.1.cmml" xref="S3.SS2.p1.17.m17.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p1.17.m17.1.1.3.3.2.cmml" xref="S3.SS2.p1.17.m17.1.1.3.3.2">𝒪</ci><ci id="S3.SS2.p1.17.m17.1.1.3.3.3.cmml" xref="S3.SS2.p1.17.m17.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m17.1c">{\mathcal{M}}^{k}={\mathcal{C}}\setminus{\mathcal{O}}^{k}</annotation></semantics></math>. Note that the <math id="S3.SS2.p1.18.m18.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.18.m18.1a"><mi id="S3.SS2.p1.18.m18.1.1" xref="S3.SS2.p1.18.m18.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m18.1b"><ci id="S3.SS2.p1.18.m18.1.1.cmml" xref="S3.SS2.p1.18.m18.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m18.1c">k</annotation></semantics></math>-th client actually does a <math id="S3.SS2.p1.19.m19.1" class="ltx_Math" alttext="|{\mathcal{O}}^{k}|" display="inline"><semantics id="S3.SS2.p1.19.m19.1a"><mrow id="S3.SS2.p1.19.m19.1.1.1" xref="S3.SS2.p1.19.m19.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.19.m19.1.1.1.2" xref="S3.SS2.p1.19.m19.1.1.2.1.cmml">|</mo><msup id="S3.SS2.p1.19.m19.1.1.1.1" xref="S3.SS2.p1.19.m19.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.19.m19.1.1.1.1.2" xref="S3.SS2.p1.19.m19.1.1.1.1.2.cmml">𝒪</mi><mi id="S3.SS2.p1.19.m19.1.1.1.1.3" xref="S3.SS2.p1.19.m19.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.SS2.p1.19.m19.1.1.1.3" xref="S3.SS2.p1.19.m19.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m19.1b"><apply id="S3.SS2.p1.19.m19.1.1.2.cmml" xref="S3.SS2.p1.19.m19.1.1.1"><abs id="S3.SS2.p1.19.m19.1.1.2.1.cmml" xref="S3.SS2.p1.19.m19.1.1.1.2"></abs><apply id="S3.SS2.p1.19.m19.1.1.1.1.cmml" xref="S3.SS2.p1.19.m19.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m19.1.1.1.1.1.cmml" xref="S3.SS2.p1.19.m19.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.19.m19.1.1.1.1.2.cmml" xref="S3.SS2.p1.19.m19.1.1.1.1.2">𝒪</ci><ci id="S3.SS2.p1.19.m19.1.1.1.1.3.cmml" xref="S3.SS2.p1.19.m19.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m19.1c">|{\mathcal{O}}^{k}|</annotation></semantics></math>-class classification problem. We also assume <math id="S3.SS2.p1.20.m20.1" class="ltx_Math" alttext="\cup_{k=1}^{K}{\mathcal{O}}^{k}={\mathcal{C}}" display="inline"><semantics id="S3.SS2.p1.20.m20.1a"><mrow id="S3.SS2.p1.20.m20.1.1" xref="S3.SS2.p1.20.m20.1.1.cmml"><mrow id="S3.SS2.p1.20.m20.1.1.2" xref="S3.SS2.p1.20.m20.1.1.2.cmml"><msubsup id="S3.SS2.p1.20.m20.1.1.2.1" xref="S3.SS2.p1.20.m20.1.1.2.1.cmml"><mo id="S3.SS2.p1.20.m20.1.1.2.1.2.2" xref="S3.SS2.p1.20.m20.1.1.2.1.2.2.cmml">∪</mo><mrow id="S3.SS2.p1.20.m20.1.1.2.1.2.3" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.cmml"><mi id="S3.SS2.p1.20.m20.1.1.2.1.2.3.2" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p1.20.m20.1.1.2.1.2.3.1" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p1.20.m20.1.1.2.1.2.3.3" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.20.m20.1.1.2.1.3" xref="S3.SS2.p1.20.m20.1.1.2.1.3.cmml">K</mi></msubsup><msup id="S3.SS2.p1.20.m20.1.1.2.2" xref="S3.SS2.p1.20.m20.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.20.m20.1.1.2.2.2" xref="S3.SS2.p1.20.m20.1.1.2.2.2.cmml">𝒪</mi><mi id="S3.SS2.p1.20.m20.1.1.2.2.3" xref="S3.SS2.p1.20.m20.1.1.2.2.3.cmml">k</mi></msup></mrow><mo id="S3.SS2.p1.20.m20.1.1.1" xref="S3.SS2.p1.20.m20.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.20.m20.1.1.3" xref="S3.SS2.p1.20.m20.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m20.1b"><apply id="S3.SS2.p1.20.m20.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1"><eq id="S3.SS2.p1.20.m20.1.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1.1"></eq><apply id="S3.SS2.p1.20.m20.1.1.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2"><apply id="S3.SS2.p1.20.m20.1.1.2.1.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m20.1.1.2.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1">superscript</csymbol><apply id="S3.SS2.p1.20.m20.1.1.2.1.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m20.1.1.2.1.2.1.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1">subscript</csymbol><union id="S3.SS2.p1.20.m20.1.1.2.1.2.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.2.2"></union><apply id="S3.SS2.p1.20.m20.1.1.2.1.2.3.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3"><eq id="S3.SS2.p1.20.m20.1.1.2.1.2.3.1.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.1"></eq><ci id="S3.SS2.p1.20.m20.1.1.2.1.2.3.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p1.20.m20.1.1.2.1.2.3.3.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.20.m20.1.1.2.1.3.cmml" xref="S3.SS2.p1.20.m20.1.1.2.1.3">𝐾</ci></apply><apply id="S3.SS2.p1.20.m20.1.1.2.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m20.1.1.2.2.1.cmml" xref="S3.SS2.p1.20.m20.1.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.20.m20.1.1.2.2.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2.2.2">𝒪</ci><ci id="S3.SS2.p1.20.m20.1.1.2.2.3.cmml" xref="S3.SS2.p1.20.m20.1.1.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS2.p1.20.m20.1.1.3.cmml" xref="S3.SS2.p1.20.m20.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m20.1c">\cup_{k=1}^{K}{\mathcal{O}}^{k}={\mathcal{C}}</annotation></semantics></math>, which means that the server aims to obtain a complete classification model that distinguishes samples from <math id="S3.SS2.p1.21.m21.1" class="ltx_Math" alttext="{\mathcal{C}}" display="inline"><semantics id="S3.SS2.p1.21.m21.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.21.m21.1.1" xref="S3.SS2.p1.21.m21.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m21.1b"><ci id="S3.SS2.p1.21.m21.1.1.cmml" xref="S3.SS2.p1.21.m21.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m21.1c">{\mathcal{C}}</annotation></semantics></math>, i.e., a <math id="S3.SS2.p1.22.m22.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.22.m22.1a"><mi id="S3.SS2.p1.22.m22.1.1" xref="S3.SS2.p1.22.m22.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m22.1b"><ci id="S3.SS2.p1.22.m22.1.1.cmml" xref="S3.SS2.p1.22.m22.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m22.1c">C</annotation></semantics></math>-class classification model. Hence, to evaluate the aggregated global model, the server owns a global test set denoted as <math id="S3.SS2.p1.23.m23.1" class="ltx_Math" alttext="D_{\text{te}}=\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N_{\text{te}}}" display="inline"><semantics id="S3.SS2.p1.23.m23.1a"><mrow id="S3.SS2.p1.23.m23.1.1" xref="S3.SS2.p1.23.m23.1.1.cmml"><msub id="S3.SS2.p1.23.m23.1.1.3" xref="S3.SS2.p1.23.m23.1.1.3.cmml"><mi id="S3.SS2.p1.23.m23.1.1.3.2" xref="S3.SS2.p1.23.m23.1.1.3.2.cmml">D</mi><mtext id="S3.SS2.p1.23.m23.1.1.3.3" xref="S3.SS2.p1.23.m23.1.1.3.3a.cmml">te</mtext></msub><mo id="S3.SS2.p1.23.m23.1.1.2" xref="S3.SS2.p1.23.m23.1.1.2.cmml">=</mo><msubsup id="S3.SS2.p1.23.m23.1.1.1" xref="S3.SS2.p1.23.m23.1.1.1.cmml"><mrow id="S3.SS2.p1.23.m23.1.1.1.1.1.1" xref="S3.SS2.p1.23.m23.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.2" xref="S3.SS2.p1.23.m23.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.4" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.5" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.3" xref="S3.SS2.p1.23.m23.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.23.m23.1.1.1.1.3" xref="S3.SS2.p1.23.m23.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.23.m23.1.1.1.1.3.2" xref="S3.SS2.p1.23.m23.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.23.m23.1.1.1.1.3.1" xref="S3.SS2.p1.23.m23.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p1.23.m23.1.1.1.1.3.3" xref="S3.SS2.p1.23.m23.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS2.p1.23.m23.1.1.1.3" xref="S3.SS2.p1.23.m23.1.1.1.3.cmml"><mi id="S3.SS2.p1.23.m23.1.1.1.3.2" xref="S3.SS2.p1.23.m23.1.1.1.3.2.cmml">N</mi><mtext id="S3.SS2.p1.23.m23.1.1.1.3.3" xref="S3.SS2.p1.23.m23.1.1.1.3.3a.cmml">te</mtext></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.23.m23.1b"><apply id="S3.SS2.p1.23.m23.1.1.cmml" xref="S3.SS2.p1.23.m23.1.1"><eq id="S3.SS2.p1.23.m23.1.1.2.cmml" xref="S3.SS2.p1.23.m23.1.1.2"></eq><apply id="S3.SS2.p1.23.m23.1.1.3.cmml" xref="S3.SS2.p1.23.m23.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.3.1.cmml" xref="S3.SS2.p1.23.m23.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.23.m23.1.1.3.2.cmml" xref="S3.SS2.p1.23.m23.1.1.3.2">𝐷</ci><ci id="S3.SS2.p1.23.m23.1.1.3.3a.cmml" xref="S3.SS2.p1.23.m23.1.1.3.3"><mtext mathsize="70%" id="S3.SS2.p1.23.m23.1.1.3.3.cmml" xref="S3.SS2.p1.23.m23.1.1.3.3">te</mtext></ci></apply><apply id="S3.SS2.p1.23.m23.1.1.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.1.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.23.m23.1.1.1.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.1.1.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1">subscript</csymbol><set id="S3.SS2.p1.23.m23.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1"><interval closure="open" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2"><apply id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS2.p1.23.m23.1.1.1.1.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.3"><eq id="S3.SS2.p1.23.m23.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.3.1"></eq><ci id="S3.SS2.p1.23.m23.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p1.23.m23.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.23.m23.1.1.1.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m23.1.1.1.3.1.cmml" xref="S3.SS2.p1.23.m23.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.23.m23.1.1.1.3.2.cmml" xref="S3.SS2.p1.23.m23.1.1.1.3.2">𝑁</ci><ci id="S3.SS2.p1.23.m23.1.1.1.3.3a.cmml" xref="S3.SS2.p1.23.m23.1.1.1.3.3"><mtext mathsize="50%" id="S3.SS2.p1.23.m23.1.1.1.3.3.cmml" xref="S3.SS2.p1.23.m23.1.1.1.3.3">te</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.23.m23.1c">D_{\text{te}}=\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N_{\text{te}}}</annotation></semantics></math> with <math id="S3.SS2.p1.24.m24.1" class="ltx_Math" alttext="N_{\text{te}}" display="inline"><semantics id="S3.SS2.p1.24.m24.1a"><msub id="S3.SS2.p1.24.m24.1.1" xref="S3.SS2.p1.24.m24.1.1.cmml"><mi id="S3.SS2.p1.24.m24.1.1.2" xref="S3.SS2.p1.24.m24.1.1.2.cmml">N</mi><mtext id="S3.SS2.p1.24.m24.1.1.3" xref="S3.SS2.p1.24.m24.1.1.3a.cmml">te</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.24.m24.1b"><apply id="S3.SS2.p1.24.m24.1.1.cmml" xref="S3.SS2.p1.24.m24.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.24.m24.1.1.1.cmml" xref="S3.SS2.p1.24.m24.1.1">subscript</csymbol><ci id="S3.SS2.p1.24.m24.1.1.2.cmml" xref="S3.SS2.p1.24.m24.1.1.2">𝑁</ci><ci id="S3.SS2.p1.24.m24.1.1.3a.cmml" xref="S3.SS2.p1.24.m24.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.24.m24.1.1.3.cmml" xref="S3.SS2.p1.24.m24.1.1.3">te</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.24.m24.1c">N_{\text{te}}</annotation></semantics></math> samples, where <math id="S3.SS2.p1.25.m25.1" class="ltx_Math" alttext="y_{i}\in{\mathcal{C}}" display="inline"><semantics id="S3.SS2.p1.25.m25.1a"><mrow id="S3.SS2.p1.25.m25.1.1" xref="S3.SS2.p1.25.m25.1.1.cmml"><msub id="S3.SS2.p1.25.m25.1.1.2" xref="S3.SS2.p1.25.m25.1.1.2.cmml"><mi id="S3.SS2.p1.25.m25.1.1.2.2" xref="S3.SS2.p1.25.m25.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p1.25.m25.1.1.2.3" xref="S3.SS2.p1.25.m25.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.25.m25.1.1.1" xref="S3.SS2.p1.25.m25.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.25.m25.1.1.3" xref="S3.SS2.p1.25.m25.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.25.m25.1b"><apply id="S3.SS2.p1.25.m25.1.1.cmml" xref="S3.SS2.p1.25.m25.1.1"><in id="S3.SS2.p1.25.m25.1.1.1.cmml" xref="S3.SS2.p1.25.m25.1.1.1"></in><apply id="S3.SS2.p1.25.m25.1.1.2.cmml" xref="S3.SS2.p1.25.m25.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.25.m25.1.1.2.1.cmml" xref="S3.SS2.p1.25.m25.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.25.m25.1.1.2.2.cmml" xref="S3.SS2.p1.25.m25.1.1.2.2">𝑦</ci><ci id="S3.SS2.p1.25.m25.1.1.2.3.cmml" xref="S3.SS2.p1.25.m25.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.25.m25.1.1.3.cmml" xref="S3.SS2.p1.25.m25.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.25.m25.1c">y_{i}\in{\mathcal{C}}</annotation></semantics></math> and follows a uniform distribution. The scene is illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.1.1" class="ltx_text ltx_font_italic">Goals of Aggregation and Personalization</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">The server aims to obtain a single global model that minimizes Eq. <a href="#S3.E2" title="In 3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, i.e., a <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">C</annotation></semantics></math>-class classification model. The <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">k</annotation></semantics></math>-th client is inclined to obtain a well-performed model that could minimize the Eq. <a href="#S3.E1" title="In 3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> on its own data distribution, i.e., a <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="|{\mathcal{O}}^{k}|" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.1.cmml">|</mo><msup id="S3.SS3.p1.3.m3.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.3.m3.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.2.cmml">𝒪</mi><mi id="S3.SS3.p1.3.m3.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.SS3.p1.3.m3.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1"><abs id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.2"></abs><apply id="S3.SS3.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.2">𝒪</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">|{\mathcal{O}}^{k}|</annotation></semantics></math>-class classification model. We formally present the goals and corresponding metrics of aggregation and personalization as follows:</p>
</div>
<div id="Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span><span id="Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(Goal of Aggregation in FL)<span id="Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem1.p1" class="ltx_para">
<p id="Thmtheorem1.p1.1" class="ltx_p"><span id="Thmtheorem1.p1.1.1" class="ltx_text ltx_font_italic">The parameter server calculates the classification accuracy of the aggregated model on the global test set <math id="Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="D_{\text{te}}" display="inline"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><msub id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.2.cmml">D</mi><mtext class="ltx_mathvariant_italic" id="Thmtheorem1.p1.1.1.m1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3a.cmml">te</mtext></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><apply id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.2">𝐷</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.3a.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3">te</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">D_{\text{te}}</annotation></semantics></math> in each communication round to evaluate the aggregation performance.</span></p>
</div>
</div>
<div id="Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem2.1.1.1" class="ltx_text ltx_font_bold">Definition 2</span></span><span id="Thmtheorem2.2.2" class="ltx_text ltx_font_bold"> </span>(Goal of Personalization in FL)<span id="Thmtheorem2.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem2.p1" class="ltx_para">
<p id="Thmtheorem2.p1.2" class="ltx_p"><span id="Thmtheorem2.p1.2.2" class="ltx_text ltx_font_italic">The <math id="Thmtheorem2.p1.1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Thmtheorem2.p1.1.1.m1.1a"><mi id="Thmtheorem2.p1.1.1.m1.1.1" xref="Thmtheorem2.p1.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.1.1.m1.1b"><ci id="Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.1.1.m1.1c">k</annotation></semantics></math>-th client calculates the performance of the personalized model on the local test set <math id="Thmtheorem2.p1.2.2.m2.1" class="ltx_Math" alttext="D^{k}_{\text{te}}" display="inline"><semantics id="Thmtheorem2.p1.2.2.m2.1a"><msubsup id="Thmtheorem2.p1.2.2.m2.1.1" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.2.2" xref="Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml">D</mi><mtext class="ltx_mathvariant_italic" id="Thmtheorem2.p1.2.2.m2.1.1.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3a.cmml">te</mtext><mi id="Thmtheorem2.p1.2.2.m2.1.1.2.3" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.2.2.m2.1b"><apply id="Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1">subscript</csymbol><apply id="Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.m2.1.1.2.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1">superscript</csymbol><ci id="Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.2">𝐷</ci><ci id="Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3">𝑘</ci></apply><ci id="Thmtheorem2.p1.2.2.m2.1.1.3a.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3">te</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.2.2.m2.1c">D^{k}_{\text{te}}</annotation></semantics></math> in each communication round. The average accuracy across selected clients evaluates the personalization performance.</span></p>
</div>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">During each communication round, we distinguish the model before and after personalization as the newly-downloaded global model and the personalized model, respectively. Notably, we calculate the personalization performance with the personalized model rather than the newly-downloaded model.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">We can find that the goal of aggregation emphasizes the globally aggregated model’s ability, which is expected to work well universally for existing clients or novel clients. However, the goal of personalization emphasizes the personalized model’s ability, which reflects the original incentive for clients to participate in FL. Due to the Non-I.I.D. challenge, it is hard to generate a well-performed aggregated model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Even we can obtain such a global model, it could still perform poorly on clients, and delicate personalization methods should be further utilized for better adaptation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>. Hence, we should design an effective FL method that could simultaneously improve both aggregation and personalization performances.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Proposed Methods</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section will introduce the proposed “RS” for model aggregation, the “HPM” for model personalization, and the proposed method MAP.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span id="S4.SS1.1.1" class="ltx_text ltx_font_italic">Restricted Softmax for Model Aggregation</span>
</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Softmax Properties</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.13" class="ltx_p">Assume we have a training set <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N}" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><msubsup id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.4" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.5" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1"><interval closure="open" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3"><eq id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.1"></eq><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N}</annotation></semantics></math> with <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mi id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">N</annotation></semantics></math> samples, where <math id="S4.SS1.SSS1.p1.3.m3.4" class="ltx_Math" alttext="y_{i}\in{\mathcal{C}}=\{1,2,\ldots,C\}" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.4a"><mrow id="S4.SS1.SSS1.p1.3.m3.4.5" xref="S4.SS1.SSS1.p1.3.m3.4.5.cmml"><msub id="S4.SS1.SSS1.p1.3.m3.4.5.2" xref="S4.SS1.SSS1.p1.3.m3.4.5.2.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.4.5.2.2" xref="S4.SS1.SSS1.p1.3.m3.4.5.2.2.cmml">y</mi><mi id="S4.SS1.SSS1.p1.3.m3.4.5.2.3" xref="S4.SS1.SSS1.p1.3.m3.4.5.2.3.cmml">i</mi></msub><mo id="S4.SS1.SSS1.p1.3.m3.4.5.3" xref="S4.SS1.SSS1.p1.3.m3.4.5.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p1.3.m3.4.5.4" xref="S4.SS1.SSS1.p1.3.m3.4.5.4.cmml">𝒞</mi><mo id="S4.SS1.SSS1.p1.3.m3.4.5.5" xref="S4.SS1.SSS1.p1.3.m3.4.5.5.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.3.m3.4.5.6.2" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.3.m3.4.5.6.2.1" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml">{</mo><mn id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml">1</mn><mo id="S4.SS1.SSS1.p1.3.m3.4.5.6.2.2" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml">,</mo><mn id="S4.SS1.SSS1.p1.3.m3.2.2" xref="S4.SS1.SSS1.p1.3.m3.2.2.cmml">2</mn><mo id="S4.SS1.SSS1.p1.3.m3.4.5.6.2.3" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.SSS1.p1.3.m3.3.3" xref="S4.SS1.SSS1.p1.3.m3.3.3.cmml">…</mi><mo id="S4.SS1.SSS1.p1.3.m3.4.5.6.2.4" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml">,</mo><mi id="S4.SS1.SSS1.p1.3.m3.4.4" xref="S4.SS1.SSS1.p1.3.m3.4.4.cmml">C</mi><mo stretchy="false" id="S4.SS1.SSS1.p1.3.m3.4.5.6.2.5" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.4b"><apply id="S4.SS1.SSS1.p1.3.m3.4.5.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5"><and id="S4.SS1.SSS1.p1.3.m3.4.5a.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5"></and><apply id="S4.SS1.SSS1.p1.3.m3.4.5b.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5"><in id="S4.SS1.SSS1.p1.3.m3.4.5.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.3"></in><apply id="S4.SS1.SSS1.p1.3.m3.4.5.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.4.5.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.4.5.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.2.2">𝑦</ci><ci id="S4.SS1.SSS1.p1.3.m3.4.5.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p1.3.m3.4.5.4.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.4">𝒞</ci></apply><apply id="S4.SS1.SSS1.p1.3.m3.4.5c.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5"><eq id="S4.SS1.SSS1.p1.3.m3.4.5.5.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.5"></eq><share href="#S4.SS1.SSS1.p1.3.m3.4.5.4.cmml" id="S4.SS1.SSS1.p1.3.m3.4.5d.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5"></share><set id="S4.SS1.SSS1.p1.3.m3.4.5.6.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.5.6.2"><cn type="integer" id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">1</cn><cn type="integer" id="S4.SS1.SSS1.p1.3.m3.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.2.2">2</cn><ci id="S4.SS1.SSS1.p1.3.m3.3.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.3.3">…</ci><ci id="S4.SS1.SSS1.p1.3.m3.4.4.cmml" xref="S4.SS1.SSS1.p1.3.m3.4.4">𝐶</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.4c">y_{i}\in{\mathcal{C}}=\{1,2,\ldots,C\}</annotation></semantics></math>. Deep networks contain the feature extractor <math id="S4.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="F_{\theta}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p1.4.m4.1a"><mrow id="S4.SS1.SSS1.p1.4.m4.1.2" xref="S4.SS1.SSS1.p1.4.m4.1.2.cmml"><msub id="S4.SS1.SSS1.p1.4.m4.1.2.2" xref="S4.SS1.SSS1.p1.4.m4.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.4.m4.1.2.2.2" xref="S4.SS1.SSS1.p1.4.m4.1.2.2.2.cmml">F</mi><mi id="S4.SS1.SSS1.p1.4.m4.1.2.2.3" xref="S4.SS1.SSS1.p1.4.m4.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.4.m4.1.2.1" xref="S4.SS1.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.4.m4.1.2.3.2" xref="S4.SS1.SSS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.4.m4.1.2.3.2.1" xref="S4.SS1.SSS1.p1.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.4.m4.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p1.4.m4.1.2.3.2.2" xref="S4.SS1.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.4.m4.1b"><apply id="S4.SS1.SSS1.p1.4.m4.1.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2"><times id="S4.SS1.SSS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2.1"></times><apply id="S4.SS1.SSS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.4.m4.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.4.m4.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2.2.2">𝐹</ci><ci id="S4.SS1.SSS1.p1.4.m4.1.2.2.3.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.2.2.3">𝜃</ci></apply><ci id="S4.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.4.m4.1c">F_{\theta}(\cdot)</annotation></semantics></math> with parameters <math id="S4.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS1.SSS1.p1.5.m5.1a"><mi id="S4.SS1.SSS1.p1.5.m5.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.5.m5.1b"><ci id="S4.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.5.m5.1c">\theta</annotation></semantics></math> and the last classification layer with weights <math id="S4.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}\}_{c=1}^{C}" display="inline"><semantics id="S4.SS1.SSS1.p1.6.m6.1a"><msubsup id="S4.SS1.SSS1.p1.6.m6.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.6.m6.1.1.1.3" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.2" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.2.cmml">c</mi><mo id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.3" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p1.6.m6.1.1.3" xref="S4.SS1.SSS1.p1.6.m6.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.6.m6.1b"><apply id="S4.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.6.m6.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1"><apply id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3"><eq id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.1"></eq><ci id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.SS1.SSS1.p1.6.m6.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.6.m6.1c">\{{\mathbf{w}}_{c}\}_{c=1}^{C}</annotation></semantics></math> (we omit the bias for simplification). The whole parameter set is denoted as <math id="S4.SS1.SSS1.p1.7.m7.2" class="ltx_Math" alttext="\psi=\left(\theta,\{{\mathbf{w}}_{c}\}_{c=1}^{C}\right)" display="inline"><semantics id="S4.SS1.SSS1.p1.7.m7.2a"><mrow id="S4.SS1.SSS1.p1.7.m7.2.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.2.2.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.3.cmml">ψ</mi><mo id="S4.SS1.SSS1.p1.7.m7.2.2.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.7.m7.2.2.1.1" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.2.cmml"><mo id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p1.7.m7.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.cmml">θ</mi><mo id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.2.cmml">,</mo><msubsup id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.1" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.3.cmml">C</mi></msubsup><mo id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.4" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.7.m7.2b"><apply id="S4.SS1.SSS1.p1.7.m7.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2"><eq id="S4.SS1.SSS1.p1.7.m7.2.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.2"></eq><ci id="S4.SS1.SSS1.p1.7.m7.2.2.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.3">𝜓</ci><interval closure="open" id="S4.SS1.SSS1.p1.7.m7.2.2.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1"><ci id="S4.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">𝜃</ci><apply id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1"><apply id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3"><eq id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.1"></eq><ci id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.1.1.1.3">𝐶</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.7.m7.2c">\psi=\left(\theta,\{{\mathbf{w}}_{c}\}_{c=1}^{C}\right)</annotation></semantics></math>. Without additional declaration, we refer to the last classification layer as the classifier. We denote <math id="S4.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="{\mathbf{h}}_{i}=F_{\theta}({\mathbf{x}}_{i})\in{\mathcal{R}}^{d}" display="inline"><semantics id="S4.SS1.SSS1.p1.8.m8.1a"><mrow id="S4.SS1.SSS1.p1.8.m8.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.cmml"><msub id="S4.SS1.SSS1.p1.8.m8.1.1.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.8.m8.1.1.3.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.2.cmml">𝐡</mi><mi id="S4.SS1.SSS1.p1.8.m8.1.1.3.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS1.SSS1.p1.8.m8.1.1.4" xref="S4.SS1.SSS1.p1.8.m8.1.1.4.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.8.m8.1.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.cmml"><msub id="S4.SS1.SSS1.p1.8.m8.1.1.1.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3.2.cmml">F</mi><mi id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.8.m8.1.1.1.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS1.p1.8.m8.1.1.5" xref="S4.SS1.SSS1.p1.8.m8.1.1.5.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.8.m8.1.1.6" xref="S4.SS1.SSS1.p1.8.m8.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p1.8.m8.1.1.6.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.6.2.cmml">ℛ</mi><mi id="S4.SS1.SSS1.p1.8.m8.1.1.6.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.6.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.8.m8.1b"><apply id="S4.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"><and id="S4.SS1.SSS1.p1.8.m8.1.1a.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"></and><apply id="S4.SS1.SSS1.p1.8.m8.1.1b.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"><eq id="S4.SS1.SSS1.p1.8.m8.1.1.4.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.4"></eq><apply id="S4.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.2">𝐡</ci><ci id="S4.SS1.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.3">𝑖</ci></apply><apply id="S4.SS1.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1"><times id="S4.SS1.SSS1.p1.8.m8.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.2"></times><apply id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3.2">𝐹</ci><ci id="S4.SS1.SSS1.p1.8.m8.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.SS1.SSS1.p1.8.m8.1.1c.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"><in id="S4.SS1.SSS1.p1.8.m8.1.1.5.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.5"></in><share href="#S4.SS1.SSS1.p1.8.m8.1.1.1.cmml" id="S4.SS1.SSS1.p1.8.m8.1.1d.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"></share><apply id="S4.SS1.SSS1.p1.8.m8.1.1.6.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.8.m8.1.1.6.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.6">superscript</csymbol><ci id="S4.SS1.SSS1.p1.8.m8.1.1.6.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.6.2">ℛ</ci><ci id="S4.SS1.SSS1.p1.8.m8.1.1.6.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.6.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.8.m8.1c">{\mathbf{h}}_{i}=F_{\theta}({\mathbf{x}}_{i})\in{\mathcal{R}}^{d}</annotation></semantics></math> as the extracted feature vector of the <math id="S4.SS1.SSS1.p1.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.SSS1.p1.9.m9.1a"><mi id="S4.SS1.SSS1.p1.9.m9.1.1" xref="S4.SS1.SSS1.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.9.m9.1b"><ci id="S4.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS1.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.9.m9.1c">i</annotation></semantics></math>-th sample. We refer to the classification weights <math id="S4.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}\}_{c=1}^{C}" display="inline"><semantics id="S4.SS1.SSS1.p1.10.m10.1a"><msubsup id="S4.SS1.SSS1.p1.10.m10.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.10.m10.1.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.2" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.2.cmml">c</mi><mo id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p1.10.m10.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.10.m10.1b"><apply id="S4.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.10.m10.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1"><apply id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3"><eq id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.1"></eq><ci id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.SS1.SSS1.p1.10.m10.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.10.m10.1c">\{{\mathbf{w}}_{c}\}_{c=1}^{C}</annotation></semantics></math> as proxies. For the <math id="S4.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.SSS1.p1.11.m11.1a"><mi id="S4.SS1.SSS1.p1.11.m11.1.1" xref="S4.SS1.SSS1.p1.11.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.11.m11.1b"><ci id="S4.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.11.m11.1c">c</annotation></semantics></math>-th proxy <math id="S4.SS1.SSS1.p1.12.m12.1" class="ltx_Math" alttext="{\mathbf{w}}_{c}" display="inline"><semantics id="S4.SS1.SSS1.p1.12.m12.1a"><msub id="S4.SS1.SSS1.p1.12.m12.1.1" xref="S4.SS1.SSS1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.SSS1.p1.12.m12.1.1.2" xref="S4.SS1.SSS1.p1.12.m12.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS1.p1.12.m12.1.1.3" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.12.m12.1b"><apply id="S4.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.2">𝐰</ci><ci id="S4.SS1.SSS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.12.m12.1c">{\mathbf{w}}_{c}</annotation></semantics></math>, we denote the features from the <math id="S4.SS1.SSS1.p1.13.m13.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.SSS1.p1.13.m13.1a"><mi id="S4.SS1.SSS1.p1.13.m13.1.1" xref="S4.SS1.SSS1.p1.13.m13.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.13.m13.1b"><ci id="S4.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.13.m13.1c">c</annotation></semantics></math>-th class and other classes as positive features and negative features respectively.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.4" class="ltx_p">The commonly utilized softmax operation and cross-entropy loss are:</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\displaystyle p_{i,c}" display="inline"><semantics id="S4.E3.m1.2a"><msub id="S4.E3.m1.2.3" xref="S4.E3.m1.2.3.cmml"><mi id="S4.E3.m1.2.3.2" xref="S4.E3.m1.2.3.2.cmml">p</mi><mrow id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">i</mi><mo id="S4.E3.m1.2.2.2.4.1" xref="S4.E3.m1.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.3.cmml" xref="S4.E3.m1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.3.1.cmml" xref="S4.E3.m1.2.3">subscript</csymbol><ci id="S4.E3.m1.2.3.2.cmml" xref="S4.E3.m1.2.3.2">𝑝</ci><list id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.4"><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑖</ci><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\displaystyle p_{i,c}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E3.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S4.E3.m2.1a"><mo id="S4.E3.m2.1.1" xref="S4.E3.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E3.m2.1b"><eq id="S4.E3.m2.1.1.cmml" xref="S4.E3.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m3.3" class="ltx_Math" alttext="\displaystyle\exp({\mathbf{w}}_{c}^{T}{\mathbf{h}}_{i})/\sum_{j=1}^{C}\exp({\mathbf{w}}_{j}^{T}{\mathbf{h}}_{i})," display="inline"><semantics id="S4.E3.m3.3a"><mrow id="S4.E3.m3.3.3.1" xref="S4.E3.m3.3.3.1.1.cmml"><mrow id="S4.E3.m3.3.3.1.1" xref="S4.E3.m3.3.3.1.1.cmml"><mrow id="S4.E3.m3.3.3.1.1.1.1" xref="S4.E3.m3.3.3.1.1.1.2.cmml"><mi id="S4.E3.m3.1.1" xref="S4.E3.m3.1.1.cmml">exp</mi><mo id="S4.E3.m3.3.3.1.1.1.1a" xref="S4.E3.m3.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S4.E3.m3.3.3.1.1.1.1.1" xref="S4.E3.m3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m3.3.3.1.1.1.1.1.2" xref="S4.E3.m3.3.3.1.1.1.2.cmml">(</mo><mrow id="S4.E3.m3.3.3.1.1.1.1.1.1" xref="S4.E3.m3.3.3.1.1.1.1.1.1.cmml"><msubsup id="S4.E3.m3.3.3.1.1.1.1.1.1.2" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.2" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.3" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.3.cmml">c</mi><mi id="S4.E3.m3.3.3.1.1.1.1.1.1.2.3" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m3.3.3.1.1.1.1.1.1.1" xref="S4.E3.m3.3.3.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E3.m3.3.3.1.1.1.1.1.1.3" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m3.3.3.1.1.1.1.1.1.3.2" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S4.E3.m3.3.3.1.1.1.1.1.1.3.3" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.E3.m3.3.3.1.1.1.1.1.3" xref="S4.E3.m3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m3.3.3.1.1.3" xref="S4.E3.m3.3.3.1.1.3.cmml">/</mo><mrow id="S4.E3.m3.3.3.1.1.2" xref="S4.E3.m3.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E3.m3.3.3.1.1.2.2" xref="S4.E3.m3.3.3.1.1.2.2.cmml"><munderover id="S4.E3.m3.3.3.1.1.2.2a" xref="S4.E3.m3.3.3.1.1.2.2.cmml"><mo movablelimits="false" id="S4.E3.m3.3.3.1.1.2.2.2.2" xref="S4.E3.m3.3.3.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E3.m3.3.3.1.1.2.2.2.3" xref="S4.E3.m3.3.3.1.1.2.2.2.3.cmml"><mi id="S4.E3.m3.3.3.1.1.2.2.2.3.2" xref="S4.E3.m3.3.3.1.1.2.2.2.3.2.cmml">j</mi><mo id="S4.E3.m3.3.3.1.1.2.2.2.3.1" xref="S4.E3.m3.3.3.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.E3.m3.3.3.1.1.2.2.2.3.3" xref="S4.E3.m3.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m3.3.3.1.1.2.2.3" xref="S4.E3.m3.3.3.1.1.2.2.3.cmml">C</mi></munderover></mstyle><mrow id="S4.E3.m3.3.3.1.1.2.1.1" xref="S4.E3.m3.3.3.1.1.2.1.2.cmml"><mi id="S4.E3.m3.2.2" xref="S4.E3.m3.2.2.cmml">exp</mi><mo id="S4.E3.m3.3.3.1.1.2.1.1a" xref="S4.E3.m3.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="S4.E3.m3.3.3.1.1.2.1.1.1" xref="S4.E3.m3.3.3.1.1.2.1.2.cmml"><mo stretchy="false" id="S4.E3.m3.3.3.1.1.2.1.1.1.2" xref="S4.E3.m3.3.3.1.1.2.1.2.cmml">(</mo><mrow id="S4.E3.m3.3.3.1.1.2.1.1.1.1" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.cmml"><msubsup id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.cmml"><mi id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.2" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.3" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.3.cmml">j</mi><mi id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.3" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m3.3.3.1.1.2.1.1.1.1.1" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.1.cmml">​</mo><msub id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.2" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.3" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.E3.m3.3.3.1.1.2.1.1.1.3" xref="S4.E3.m3.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m3.3.3.1.2" xref="S4.E3.m3.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m3.3b"><apply id="S4.E3.m3.3.3.1.1.cmml" xref="S4.E3.m3.3.3.1"><divide id="S4.E3.m3.3.3.1.1.3.cmml" xref="S4.E3.m3.3.3.1.1.3"></divide><apply id="S4.E3.m3.3.3.1.1.1.2.cmml" xref="S4.E3.m3.3.3.1.1.1.1"><exp id="S4.E3.m3.1.1.cmml" xref="S4.E3.m3.1.1"></exp><apply id="S4.E3.m3.3.3.1.1.1.1.1.1.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1"><times id="S4.E3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.1"></times><apply id="S4.E3.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.2">𝐰</ci><ci id="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><ci id="S4.E3.m3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.E3.m3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3.2">𝐡</ci><ci id="S4.E3.m3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m3.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E3.m3.3.3.1.1.2.cmml" xref="S4.E3.m3.3.3.1.1.2"><apply id="S4.E3.m3.3.3.1.1.2.2.cmml" xref="S4.E3.m3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.2.2.1.cmml" xref="S4.E3.m3.3.3.1.1.2.2">superscript</csymbol><apply id="S4.E3.m3.3.3.1.1.2.2.2.cmml" xref="S4.E3.m3.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.2.2.2.1.cmml" xref="S4.E3.m3.3.3.1.1.2.2">subscript</csymbol><sum id="S4.E3.m3.3.3.1.1.2.2.2.2.cmml" xref="S4.E3.m3.3.3.1.1.2.2.2.2"></sum><apply id="S4.E3.m3.3.3.1.1.2.2.2.3.cmml" xref="S4.E3.m3.3.3.1.1.2.2.2.3"><eq id="S4.E3.m3.3.3.1.1.2.2.2.3.1.cmml" xref="S4.E3.m3.3.3.1.1.2.2.2.3.1"></eq><ci id="S4.E3.m3.3.3.1.1.2.2.2.3.2.cmml" xref="S4.E3.m3.3.3.1.1.2.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E3.m3.3.3.1.1.2.2.2.3.3.cmml" xref="S4.E3.m3.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E3.m3.3.3.1.1.2.2.3.cmml" xref="S4.E3.m3.3.3.1.1.2.2.3">𝐶</ci></apply><apply id="S4.E3.m3.3.3.1.1.2.1.2.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1"><exp id="S4.E3.m3.2.2.cmml" xref="S4.E3.m3.2.2"></exp><apply id="S4.E3.m3.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1"><times id="S4.E3.m3.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.1"></times><apply id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.1.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.2.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.2">𝐰</ci><ci id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.3.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.2">𝐡</ci><ci id="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E3.m3.3.3.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m3.3c">\displaystyle\exp({\mathbf{w}}_{c}^{T}{\mathbf{h}}_{i})/\sum_{j=1}^{C}\exp({\mathbf{w}}_{j}^{T}{\mathbf{h}}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle{\mathcal{L}}" display="inline"><semantics id="S4.E4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle{\mathcal{L}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E4.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S4.E4.m2.1a"><mo id="S4.E4.m2.1.1" xref="S4.E4.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E4.m2.1b"><eq id="S4.E4.m2.1.1.cmml" xref="S4.E4.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m3.3" class="ltx_Math" alttext="\displaystyle-\sum_{i=1}^{N}\sum_{c=1}^{C}{\mathcal{I}}\{y_{i}=c\}\log p_{i,c}," display="inline"><semantics id="S4.E4.m3.3a"><mrow id="S4.E4.m3.3.3.1" xref="S4.E4.m3.3.3.1.1.cmml"><mrow id="S4.E4.m3.3.3.1.1" xref="S4.E4.m3.3.3.1.1.cmml"><mo id="S4.E4.m3.3.3.1.1a" xref="S4.E4.m3.3.3.1.1.cmml">−</mo><mrow id="S4.E4.m3.3.3.1.1.1" xref="S4.E4.m3.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m3.3.3.1.1.1.2" xref="S4.E4.m3.3.3.1.1.1.2.cmml"><munderover id="S4.E4.m3.3.3.1.1.1.2a" xref="S4.E4.m3.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4.m3.3.3.1.1.1.2.2.2" xref="S4.E4.m3.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m3.3.3.1.1.1.2.2.3" xref="S4.E4.m3.3.3.1.1.1.2.2.3.cmml"><mi id="S4.E4.m3.3.3.1.1.1.2.2.3.2" xref="S4.E4.m3.3.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E4.m3.3.3.1.1.1.2.2.3.1" xref="S4.E4.m3.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m3.3.3.1.1.1.2.2.3.3" xref="S4.E4.m3.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m3.3.3.1.1.1.2.3" xref="S4.E4.m3.3.3.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E4.m3.3.3.1.1.1.1" xref="S4.E4.m3.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m3.3.3.1.1.1.1.2" xref="S4.E4.m3.3.3.1.1.1.1.2.cmml"><munderover id="S4.E4.m3.3.3.1.1.1.1.2a" xref="S4.E4.m3.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4.m3.3.3.1.1.1.1.2.2.2" xref="S4.E4.m3.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m3.3.3.1.1.1.1.2.2.3" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.cmml"><mi id="S4.E4.m3.3.3.1.1.1.1.2.2.3.2" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S4.E4.m3.3.3.1.1.1.1.2.2.3.1" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m3.3.3.1.1.1.1.2.2.3.3" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m3.3.3.1.1.1.1.2.3" xref="S4.E4.m3.3.3.1.1.1.1.2.3.cmml">C</mi></munderover></mstyle><mrow id="S4.E4.m3.3.3.1.1.1.1.1" xref="S4.E4.m3.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m3.3.3.1.1.1.1.1.3" xref="S4.E4.m3.3.3.1.1.1.1.1.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m3.3.3.1.1.1.1.1.2" xref="S4.E4.m3.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m3.3.3.1.1.1.1.1.1.1" xref="S4.E4.m3.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m3.3.3.1.1.1.1.1.1.1.2" xref="S4.E4.m3.3.3.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E4.m3.3.3.1.1.1.1.1.1.1.3" xref="S4.E4.m3.3.3.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E4.m3.3.3.1.1.1.1.1.2a" xref="S4.E4.m3.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m3.3.3.1.1.1.1.1.4" xref="S4.E4.m3.3.3.1.1.1.1.1.4.cmml"><mi id="S4.E4.m3.3.3.1.1.1.1.1.4.1" xref="S4.E4.m3.3.3.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.E4.m3.3.3.1.1.1.1.1.4a" xref="S4.E4.m3.3.3.1.1.1.1.1.4.cmml">⁡</mo><msub id="S4.E4.m3.3.3.1.1.1.1.1.4.2" xref="S4.E4.m3.3.3.1.1.1.1.1.4.2.cmml"><mi id="S4.E4.m3.3.3.1.1.1.1.1.4.2.2" xref="S4.E4.m3.3.3.1.1.1.1.1.4.2.2.cmml">p</mi><mrow id="S4.E4.m3.2.2.2.4" xref="S4.E4.m3.2.2.2.3.cmml"><mi id="S4.E4.m3.1.1.1.1" xref="S4.E4.m3.1.1.1.1.cmml">i</mi><mo id="S4.E4.m3.2.2.2.4.1" xref="S4.E4.m3.2.2.2.3.cmml">,</mo><mi id="S4.E4.m3.2.2.2.2" xref="S4.E4.m3.2.2.2.2.cmml">c</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4.m3.3.3.1.2" xref="S4.E4.m3.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m3.3b"><apply id="S4.E4.m3.3.3.1.1.cmml" xref="S4.E4.m3.3.3.1"><minus id="S4.E4.m3.3.3.1.1.2.cmml" xref="S4.E4.m3.3.3.1"></minus><apply id="S4.E4.m3.3.3.1.1.1.cmml" xref="S4.E4.m3.3.3.1.1.1"><apply id="S4.E4.m3.3.3.1.1.1.2.cmml" xref="S4.E4.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.2">superscript</csymbol><apply id="S4.E4.m3.3.3.1.1.1.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.2.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.2">subscript</csymbol><sum id="S4.E4.m3.3.3.1.1.1.2.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.2.2.2"></sum><apply id="S4.E4.m3.3.3.1.1.1.2.2.3.cmml" xref="S4.E4.m3.3.3.1.1.1.2.2.3"><eq id="S4.E4.m3.3.3.1.1.1.2.2.3.1.cmml" xref="S4.E4.m3.3.3.1.1.1.2.2.3.1"></eq><ci id="S4.E4.m3.3.3.1.1.1.2.2.3.2.cmml" xref="S4.E4.m3.3.3.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m3.3.3.1.1.1.2.2.3.3.cmml" xref="S4.E4.m3.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E4.m3.3.3.1.1.1.2.3.cmml" xref="S4.E4.m3.3.3.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E4.m3.3.3.1.1.1.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1"><apply id="S4.E4.m3.3.3.1.1.1.1.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.1.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m3.3.3.1.1.1.1.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.1.2.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2">subscript</csymbol><sum id="S4.E4.m3.3.3.1.1.1.1.2.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.2.2"></sum><apply id="S4.E4.m3.3.3.1.1.1.1.2.2.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3"><eq id="S4.E4.m3.3.3.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S4.E4.m3.3.3.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S4.E4.m3.3.3.1.1.1.1.2.2.3.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E4.m3.3.3.1.1.1.1.2.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.2.3">𝐶</ci></apply><apply id="S4.E4.m3.3.3.1.1.1.1.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1"><times id="S4.E4.m3.3.3.1.1.1.1.1.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.2"></times><ci id="S4.E4.m3.3.3.1.1.1.1.1.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.3">ℐ</ci><set id="S4.E4.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1"><apply id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1"><eq id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.E4.m3.3.3.1.1.1.1.1.4.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.4"><log id="S4.E4.m3.3.3.1.1.1.1.1.4.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.4.1"></log><apply id="S4.E4.m3.3.3.1.1.1.1.1.4.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E4.m3.3.3.1.1.1.1.1.4.2.1.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E4.m3.3.3.1.1.1.1.1.4.2.2.cmml" xref="S4.E4.m3.3.3.1.1.1.1.1.4.2.2">𝑝</ci><list id="S4.E4.m3.2.2.2.3.cmml" xref="S4.E4.m3.2.2.2.4"><ci id="S4.E4.m3.1.1.1.1.cmml" xref="S4.E4.m3.1.1.1.1">𝑖</ci><ci id="S4.E4.m3.2.2.2.2.cmml" xref="S4.E4.m3.2.2.2.2">𝑐</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m3.3c">\displaystyle-\sum_{i=1}^{N}\sum_{c=1}^{C}{\mathcal{I}}\{y_{i}=c\}\log p_{i,c},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p2.2" class="ltx_p">where <math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{I}}\{\cdot\}" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><mrow id="S4.SS1.SSS1.p2.1.m1.1.2" xref="S4.SS1.SSS1.p2.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.1.m1.1.2.2" xref="S4.SS1.SSS1.p2.1.m1.1.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.2.1" xref="S4.SS1.SSS1.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p2.1.m1.1.2.3.2" xref="S4.SS1.SSS1.p2.1.m1.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p2.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.p2.1.m1.1.2.3.1.cmml">{</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p2.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.p2.1.m1.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><apply id="S4.SS1.SSS1.p2.1.m1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.2"><times id="S4.SS1.SSS1.p2.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.2.1"></times><ci id="S4.SS1.SSS1.p2.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.2.2">ℐ</ci><set id="S4.SS1.SSS1.p2.1.m1.1.2.3.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.2.3.2"><ci id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1">⋅</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">{\mathcal{I}}\{\cdot\}</annotation></semantics></math> is the indication function. The update of <math id="S4.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="{\mathbf{w}}_{c}" display="inline"><semantics id="S4.SS1.SSS1.p2.2.m2.1a"><msub id="S4.SS1.SSS1.p2.2.m2.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS1.p2.2.m2.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.1b"><apply id="S4.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.2">𝐰</ci><ci id="S4.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.1c">{\mathbf{w}}_{c}</annotation></semantics></math> via gradient descent could be divided into pulling and pushing forces:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.10" class="ltx_Math" alttext="{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{\text{pulling}}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{pushing}}," display="block"><semantics id="S4.E5.m1.10a"><mrow id="S4.E5.m1.10.10.1" xref="S4.E5.m1.10.10.1.1.cmml"><mrow id="S4.E5.m1.10.10.1.1" xref="S4.E5.m1.10.10.1.1.cmml"><msub id="S4.E5.m1.10.10.1.1.2" xref="S4.E5.m1.10.10.1.1.2.cmml"><mi id="S4.E5.m1.10.10.1.1.2.2" xref="S4.E5.m1.10.10.1.1.2.2.cmml">𝐰</mi><mi id="S4.E5.m1.10.10.1.1.2.3" xref="S4.E5.m1.10.10.1.1.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.10.10.1.1.1" xref="S4.E5.m1.10.10.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.10.10.1.1.3" xref="S4.E5.m1.10.10.1.1.3.cmml"><msub id="S4.E5.m1.10.10.1.1.3.2" xref="S4.E5.m1.10.10.1.1.3.2.cmml"><mi id="S4.E5.m1.10.10.1.1.3.2.2" xref="S4.E5.m1.10.10.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.E5.m1.10.10.1.1.3.2.3" xref="S4.E5.m1.10.10.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.10.10.1.1.3.1" xref="S4.E5.m1.10.10.1.1.3.1.cmml">+</mo><mrow id="S4.E5.m1.10.10.1.1.3.3" xref="S4.E5.m1.10.10.1.1.3.3.cmml"><munder id="S4.E5.m1.10.10.1.1.3.3.2" xref="S4.E5.m1.10.10.1.1.3.3.2.cmml"><munder accentunder="true" id="S4.E5.m1.5.5" xref="S4.E5.m1.5.5.cmml"><mrow id="S4.E5.m1.5.5.5" xref="S4.E5.m1.5.5.5.cmml"><mi id="S4.E5.m1.5.5.5.7" xref="S4.E5.m1.5.5.5.7.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.6" xref="S4.E5.m1.5.5.5.6.cmml">​</mo><mrow id="S4.E5.m1.5.5.5.5" xref="S4.E5.m1.5.5.5.5.cmml"><munderover id="S4.E5.m1.5.5.5.5.2" xref="S4.E5.m1.5.5.5.5.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E5.m1.5.5.5.5.2.2.2" xref="S4.E5.m1.5.5.5.5.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.3.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.2.2.2.2.2.2.3" xref="S4.E5.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.E5.m1.2.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.2.cmml"><msub id="S4.E5.m1.2.2.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.2.2.2.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m1.2.2.2.2.2.2.2.2.3" xref="S4.E5.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.2.2.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.2.2.1.cmml">=</mo><mi id="S4.E5.m1.2.2.2.2.2.2.2.3" xref="S4.E5.m1.2.2.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E5.m1.5.5.5.5.2.3" xref="S4.E5.m1.5.5.5.5.2.3.cmml">N</mi></munderover><mrow id="S4.E5.m1.5.5.5.5.1" xref="S4.E5.m1.5.5.5.5.1.cmml"><mrow id="S4.E5.m1.5.5.5.5.1.1.1" xref="S4.E5.m1.5.5.5.5.1.1.1.1.cmml"><mo id="S4.E5.m1.5.5.5.5.1.1.1.2" xref="S4.E5.m1.5.5.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.5.5.5.5.1.1.1.1" xref="S4.E5.m1.5.5.5.5.1.1.1.1.cmml"><mn id="S4.E5.m1.5.5.5.5.1.1.1.1.2" xref="S4.E5.m1.5.5.5.5.1.1.1.1.2.cmml">1</mn><mo id="S4.E5.m1.5.5.5.5.1.1.1.1.1" xref="S4.E5.m1.5.5.5.5.1.1.1.1.1.cmml">−</mo><msub id="S4.E5.m1.5.5.5.5.1.1.1.1.3" xref="S4.E5.m1.5.5.5.5.1.1.1.1.3.cmml"><mi id="S4.E5.m1.5.5.5.5.1.1.1.1.3.2" xref="S4.E5.m1.5.5.5.5.1.1.1.1.3.2.cmml">p</mi><mrow id="S4.E5.m1.4.4.4.4.2.4" xref="S4.E5.m1.4.4.4.4.2.3.cmml"><mi id="S4.E5.m1.3.3.3.3.1.1" xref="S4.E5.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S4.E5.m1.4.4.4.4.2.4.1" xref="S4.E5.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.4.4.4.4.2.2" xref="S4.E5.m1.4.4.4.4.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S4.E5.m1.5.5.5.5.1.1.1.3" xref="S4.E5.m1.5.5.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.5.1.2" xref="S4.E5.m1.5.5.5.5.1.2.cmml">​</mo><msub id="S4.E5.m1.5.5.5.5.1.3" xref="S4.E5.m1.5.5.5.5.1.3.cmml"><mi id="S4.E5.m1.5.5.5.5.1.3.2" xref="S4.E5.m1.5.5.5.5.1.3.2.cmml">𝐡</mi><mi id="S4.E5.m1.5.5.5.5.1.3.3" xref="S4.E5.m1.5.5.5.5.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.6" xref="S4.E5.m1.5.5.6.cmml">⏟</mo></munder><mtext id="S4.E5.m1.10.10.1.1.3.3.2.2" xref="S4.E5.m1.10.10.1.1.3.3.2.2a.cmml">pulling</mtext></munder><mo lspace="0em" rspace="0em" id="S4.E5.m1.10.10.1.1.3.3.1" xref="S4.E5.m1.10.10.1.1.3.3.1.cmml">​</mo><munder id="S4.E5.m1.10.10.1.1.3.3.3" xref="S4.E5.m1.10.10.1.1.3.3.3.cmml"><munder accentunder="true" id="S4.E5.m1.9.9" xref="S4.E5.m1.9.9.cmml"><mrow id="S4.E5.m1.9.9.4" xref="S4.E5.m1.9.9.4.cmml"><mo id="S4.E5.m1.9.9.4a" xref="S4.E5.m1.9.9.4.cmml">−</mo><mrow id="S4.E5.m1.9.9.4.6" xref="S4.E5.m1.9.9.4.6.cmml"><mi id="S4.E5.m1.9.9.4.6.2" xref="S4.E5.m1.9.9.4.6.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.9.9.4.6.1" xref="S4.E5.m1.9.9.4.6.1.cmml">​</mo><mrow id="S4.E5.m1.9.9.4.6.3" xref="S4.E5.m1.9.9.4.6.3.cmml"><munderover id="S4.E5.m1.9.9.4.6.3.1" xref="S4.E5.m1.9.9.4.6.3.1.cmml"><mo movablelimits="false" id="S4.E5.m1.9.9.4.6.3.1.2.2" xref="S4.E5.m1.9.9.4.6.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.7.7.2.2.2.2" xref="S4.E5.m1.7.7.2.2.2.3.cmml"><mrow id="S4.E5.m1.6.6.1.1.1.1.1" xref="S4.E5.m1.6.6.1.1.1.1.1.cmml"><mi id="S4.E5.m1.6.6.1.1.1.1.1.2" xref="S4.E5.m1.6.6.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E5.m1.6.6.1.1.1.1.1.1" xref="S4.E5.m1.6.6.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E5.m1.6.6.1.1.1.1.1.3" xref="S4.E5.m1.6.6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.7.7.2.2.2.2.3" xref="S4.E5.m1.7.7.2.2.2.3a.cmml">,</mo><mrow id="S4.E5.m1.7.7.2.2.2.2.2" xref="S4.E5.m1.7.7.2.2.2.2.2.cmml"><msub id="S4.E5.m1.7.7.2.2.2.2.2.2" xref="S4.E5.m1.7.7.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.7.7.2.2.2.2.2.2.2" xref="S4.E5.m1.7.7.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m1.7.7.2.2.2.2.2.2.3" xref="S4.E5.m1.7.7.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.7.7.2.2.2.2.2.1" xref="S4.E5.m1.7.7.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E5.m1.7.7.2.2.2.2.2.3" xref="S4.E5.m1.7.7.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E5.m1.9.9.4.6.3.1.3" xref="S4.E5.m1.9.9.4.6.3.1.3.cmml">N</mi></munderover><mrow id="S4.E5.m1.9.9.4.6.3.2" xref="S4.E5.m1.9.9.4.6.3.2.cmml"><msub id="S4.E5.m1.9.9.4.6.3.2.2" xref="S4.E5.m1.9.9.4.6.3.2.2.cmml"><mi id="S4.E5.m1.9.9.4.6.3.2.2.2" xref="S4.E5.m1.9.9.4.6.3.2.2.2.cmml">p</mi><mrow id="S4.E5.m1.9.9.4.4.2.4" xref="S4.E5.m1.9.9.4.4.2.3.cmml"><mi id="S4.E5.m1.8.8.3.3.1.1" xref="S4.E5.m1.8.8.3.3.1.1.cmml">i</mi><mo id="S4.E5.m1.9.9.4.4.2.4.1" xref="S4.E5.m1.9.9.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.9.9.4.4.2.2" xref="S4.E5.m1.9.9.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.9.9.4.6.3.2.1" xref="S4.E5.m1.9.9.4.6.3.2.1.cmml">​</mo><msub id="S4.E5.m1.9.9.4.6.3.2.3" xref="S4.E5.m1.9.9.4.6.3.2.3.cmml"><mi id="S4.E5.m1.9.9.4.6.3.2.3.2" xref="S4.E5.m1.9.9.4.6.3.2.3.2.cmml">𝐡</mi><mi id="S4.E5.m1.9.9.4.6.3.2.3.3" xref="S4.E5.m1.9.9.4.6.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.9.9.5" xref="S4.E5.m1.9.9.5.cmml">⏟</mo></munder><mtext id="S4.E5.m1.10.10.1.1.3.3.3.2" xref="S4.E5.m1.10.10.1.1.3.3.3.2a.cmml">pushing</mtext></munder></mrow></mrow></mrow><mo id="S4.E5.m1.10.10.1.2" xref="S4.E5.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.10b"><apply id="S4.E5.m1.10.10.1.1.cmml" xref="S4.E5.m1.10.10.1"><eq id="S4.E5.m1.10.10.1.1.1.cmml" xref="S4.E5.m1.10.10.1.1.1"></eq><apply id="S4.E5.m1.10.10.1.1.2.cmml" xref="S4.E5.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.1.1.2.1.cmml" xref="S4.E5.m1.10.10.1.1.2">subscript</csymbol><ci id="S4.E5.m1.10.10.1.1.2.2.cmml" xref="S4.E5.m1.10.10.1.1.2.2">𝐰</ci><ci id="S4.E5.m1.10.10.1.1.2.3.cmml" xref="S4.E5.m1.10.10.1.1.2.3">𝑐</ci></apply><apply id="S4.E5.m1.10.10.1.1.3.cmml" xref="S4.E5.m1.10.10.1.1.3"><plus id="S4.E5.m1.10.10.1.1.3.1.cmml" xref="S4.E5.m1.10.10.1.1.3.1"></plus><apply id="S4.E5.m1.10.10.1.1.3.2.cmml" xref="S4.E5.m1.10.10.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.1.1.3.2.1.cmml" xref="S4.E5.m1.10.10.1.1.3.2">subscript</csymbol><ci id="S4.E5.m1.10.10.1.1.3.2.2.cmml" xref="S4.E5.m1.10.10.1.1.3.2.2">𝐰</ci><ci id="S4.E5.m1.10.10.1.1.3.2.3.cmml" xref="S4.E5.m1.10.10.1.1.3.2.3">𝑐</ci></apply><apply id="S4.E5.m1.10.10.1.1.3.3.cmml" xref="S4.E5.m1.10.10.1.1.3.3"><times id="S4.E5.m1.10.10.1.1.3.3.1.cmml" xref="S4.E5.m1.10.10.1.1.3.3.1"></times><apply id="S4.E5.m1.10.10.1.1.3.3.2.cmml" xref="S4.E5.m1.10.10.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.1.1.3.3.2.1.cmml" xref="S4.E5.m1.10.10.1.1.3.3.2">subscript</csymbol><apply id="S4.E5.m1.5.5.cmml" xref="S4.E5.m1.5.5"><ci id="S4.E5.m1.5.5.6.cmml" xref="S4.E5.m1.5.5.6">⏟</ci><apply id="S4.E5.m1.5.5.5.cmml" xref="S4.E5.m1.5.5.5"><times id="S4.E5.m1.5.5.5.6.cmml" xref="S4.E5.m1.5.5.5.6"></times><ci id="S4.E5.m1.5.5.5.7.cmml" xref="S4.E5.m1.5.5.5.7">𝜂</ci><apply id="S4.E5.m1.5.5.5.5.cmml" xref="S4.E5.m1.5.5.5.5"><apply id="S4.E5.m1.5.5.5.5.2.cmml" xref="S4.E5.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.2.1.cmml" xref="S4.E5.m1.5.5.5.5.2">superscript</csymbol><apply id="S4.E5.m1.5.5.5.5.2.2.cmml" xref="S4.E5.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.2.2.1.cmml" xref="S4.E5.m1.5.5.5.5.2">subscript</csymbol><sum id="S4.E5.m1.5.5.5.5.2.2.2.cmml" xref="S4.E5.m1.5.5.5.5.2.2.2"></sum><apply id="S4.E5.m1.2.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.2.3a.cmml" xref="S4.E5.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"></eq><ci id="S4.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E5.m1.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2"><eq id="S4.E5.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.1"></eq><apply id="S4.E5.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E5.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E5.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E5.m1.5.5.5.5.2.3.cmml" xref="S4.E5.m1.5.5.5.5.2.3">𝑁</ci></apply><apply id="S4.E5.m1.5.5.5.5.1.cmml" xref="S4.E5.m1.5.5.5.5.1"><times id="S4.E5.m1.5.5.5.5.1.2.cmml" xref="S4.E5.m1.5.5.5.5.1.2"></times><apply id="S4.E5.m1.5.5.5.5.1.1.1.1.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1"><minus id="S4.E5.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1.1.1"></minus><cn type="integer" id="S4.E5.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1.1.2">1</cn><apply id="S4.E5.m1.5.5.5.5.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.1.1.1.1.3.1.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.5.5.5.5.1.1.1.1.3.2.cmml" xref="S4.E5.m1.5.5.5.5.1.1.1.1.3.2">𝑝</ci><list id="S4.E5.m1.4.4.4.4.2.3.cmml" xref="S4.E5.m1.4.4.4.4.2.4"><ci id="S4.E5.m1.3.3.3.3.1.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1">𝑖</ci><ci id="S4.E5.m1.4.4.4.4.2.2.cmml" xref="S4.E5.m1.4.4.4.4.2.2">𝑐</ci></list></apply></apply><apply id="S4.E5.m1.5.5.5.5.1.3.cmml" xref="S4.E5.m1.5.5.5.5.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.1.3.1.cmml" xref="S4.E5.m1.5.5.5.5.1.3">subscript</csymbol><ci id="S4.E5.m1.5.5.5.5.1.3.2.cmml" xref="S4.E5.m1.5.5.5.5.1.3.2">𝐡</ci><ci id="S4.E5.m1.5.5.5.5.1.3.3.cmml" xref="S4.E5.m1.5.5.5.5.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><ci id="S4.E5.m1.10.10.1.1.3.3.2.2a.cmml" xref="S4.E5.m1.10.10.1.1.3.3.2.2"><mtext mathsize="70%" id="S4.E5.m1.10.10.1.1.3.3.2.2.cmml" xref="S4.E5.m1.10.10.1.1.3.3.2.2">pulling</mtext></ci></apply><apply id="S4.E5.m1.10.10.1.1.3.3.3.cmml" xref="S4.E5.m1.10.10.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.1.1.3.3.3.1.cmml" xref="S4.E5.m1.10.10.1.1.3.3.3">subscript</csymbol><apply id="S4.E5.m1.9.9.cmml" xref="S4.E5.m1.9.9"><ci id="S4.E5.m1.9.9.5.cmml" xref="S4.E5.m1.9.9.5">⏟</ci><apply id="S4.E5.m1.9.9.4.cmml" xref="S4.E5.m1.9.9.4"><minus id="S4.E5.m1.9.9.4.5.cmml" xref="S4.E5.m1.9.9.4"></minus><apply id="S4.E5.m1.9.9.4.6.cmml" xref="S4.E5.m1.9.9.4.6"><times id="S4.E5.m1.9.9.4.6.1.cmml" xref="S4.E5.m1.9.9.4.6.1"></times><ci id="S4.E5.m1.9.9.4.6.2.cmml" xref="S4.E5.m1.9.9.4.6.2">𝜂</ci><apply id="S4.E5.m1.9.9.4.6.3.cmml" xref="S4.E5.m1.9.9.4.6.3"><apply id="S4.E5.m1.9.9.4.6.3.1.cmml" xref="S4.E5.m1.9.9.4.6.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.9.9.4.6.3.1.1.cmml" xref="S4.E5.m1.9.9.4.6.3.1">superscript</csymbol><apply id="S4.E5.m1.9.9.4.6.3.1.2.cmml" xref="S4.E5.m1.9.9.4.6.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.9.9.4.6.3.1.2.1.cmml" xref="S4.E5.m1.9.9.4.6.3.1">subscript</csymbol><sum id="S4.E5.m1.9.9.4.6.3.1.2.2.cmml" xref="S4.E5.m1.9.9.4.6.3.1.2.2"></sum><apply id="S4.E5.m1.7.7.2.2.2.3.cmml" xref="S4.E5.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.7.7.2.2.2.3a.cmml" xref="S4.E5.m1.7.7.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.6.6.1.1.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.1"><eq id="S4.E5.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.1.1"></eq><ci id="S4.E5.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E5.m1.6.6.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E5.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.1.1.1.3">1</cn></apply><apply id="S4.E5.m1.7.7.2.2.2.2.2.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2"><neq id="S4.E5.m1.7.7.2.2.2.2.2.1.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.1"></neq><apply id="S4.E5.m1.7.7.2.2.2.2.2.2.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.7.7.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.7.7.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E5.m1.7.7.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E5.m1.7.7.2.2.2.2.2.3.cmml" xref="S4.E5.m1.7.7.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E5.m1.9.9.4.6.3.1.3.cmml" xref="S4.E5.m1.9.9.4.6.3.1.3">𝑁</ci></apply><apply id="S4.E5.m1.9.9.4.6.3.2.cmml" xref="S4.E5.m1.9.9.4.6.3.2"><times id="S4.E5.m1.9.9.4.6.3.2.1.cmml" xref="S4.E5.m1.9.9.4.6.3.2.1"></times><apply id="S4.E5.m1.9.9.4.6.3.2.2.cmml" xref="S4.E5.m1.9.9.4.6.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.9.9.4.6.3.2.2.1.cmml" xref="S4.E5.m1.9.9.4.6.3.2.2">subscript</csymbol><ci id="S4.E5.m1.9.9.4.6.3.2.2.2.cmml" xref="S4.E5.m1.9.9.4.6.3.2.2.2">𝑝</ci><list id="S4.E5.m1.9.9.4.4.2.3.cmml" xref="S4.E5.m1.9.9.4.4.2.4"><ci id="S4.E5.m1.8.8.3.3.1.1.cmml" xref="S4.E5.m1.8.8.3.3.1.1">𝑖</ci><ci id="S4.E5.m1.9.9.4.4.2.2.cmml" xref="S4.E5.m1.9.9.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E5.m1.9.9.4.6.3.2.3.cmml" xref="S4.E5.m1.9.9.4.6.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.9.9.4.6.3.2.3.1.cmml" xref="S4.E5.m1.9.9.4.6.3.2.3">subscript</csymbol><ci id="S4.E5.m1.9.9.4.6.3.2.3.2.cmml" xref="S4.E5.m1.9.9.4.6.3.2.3.2">𝐡</ci><ci id="S4.E5.m1.9.9.4.6.3.2.3.3.cmml" xref="S4.E5.m1.9.9.4.6.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><ci id="S4.E5.m1.10.10.1.1.3.3.3.2a.cmml" xref="S4.E5.m1.10.10.1.1.3.3.3.2"><mtext mathsize="70%" id="S4.E5.m1.10.10.1.1.3.3.3.2.cmml" xref="S4.E5.m1.10.10.1.1.3.3.3.2">pushing</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.10c">{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{\text{pulling}}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{pushing}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p2.3" class="ltx_p">where <math id="S4.SS1.SSS1.p2.3.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS1.SSS1.p2.3.m1.1a"><mi id="S4.SS1.SSS1.p2.3.m1.1.1" xref="S4.SS1.SSS1.p2.3.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m1.1b"><ci id="S4.SS1.SSS1.p2.3.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m1.1c">\eta</annotation></semantics></math> is the learning rate. Hence, we can obtain the following properties:</p>
</div>
<div id="Thmproperty1" class="ltx_theorem ltx_theorem_property">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmproperty1.1.1.1" class="ltx_text ltx_font_bold">Property 1</span></span><span id="Thmproperty1.2.2" class="ltx_text ltx_font_bold"> </span>(Properties of Softmax)<span id="Thmproperty1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmproperty1.p1" class="ltx_para">
<p id="Thmproperty1.p1.1" class="ltx_p"><span id="Thmproperty1.p1.1.1" class="ltx_text ltx_font_italic">Classification with softmax has the following properties: (1) pulling proxies closer to positive features; (2) pushing proxies away from negative features.</span></p>
</div>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.8" class="ltx_p">The properties are illustrated in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1.1 Softmax Properties ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (A), where a demo with three classes is shown. We only show the properties of updating proxy <math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="{\mathbf{w}}_{1}" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><msub id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p3.1.m1.1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS1.p3.1.m1.1.1.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">{\mathbf{w}}_{1}</annotation></semantics></math>. The data region <math id="S4.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="{\mathbf{X}}_{1}" display="inline"><semantics id="S4.SS1.SSS1.p3.2.m2.1a"><msub id="S4.SS1.SSS1.p3.2.m2.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p3.2.m2.1.1.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.2.m2.1.1.3" xref="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.2.m2.1b"><apply id="S4.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.2.m2.1c">{\mathbf{X}}_{1}</annotation></semantics></math> contains positive features, while <math id="S4.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="{\mathbf{X}}_{2}" display="inline"><semantics id="S4.SS1.SSS1.p3.3.m3.1a"><msub id="S4.SS1.SSS1.p3.3.m3.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p3.3.m3.1.1.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.3.m3.1.1.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.3.m3.1b"><apply id="S4.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.3.m3.1c">{\mathbf{X}}_{2}</annotation></semantics></math> and <math id="S4.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="{\mathbf{X}}_{3}" display="inline"><semantics id="S4.SS1.SSS1.p3.4.m4.1a"><msub id="S4.SS1.SSS1.p3.4.m4.1.1" xref="S4.SS1.SSS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p3.4.m4.1.1.2" xref="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.4.m4.1.1.3" xref="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.4.m4.1b"><apply id="S4.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.4.m4.1c">{\mathbf{X}}_{3}</annotation></semantics></math> contain negative features. Hence, <math id="S4.SS1.SSS1.p3.5.m5.1" class="ltx_Math" alttext="{\mathbf{w}}_{1}" display="inline"><semantics id="S4.SS1.SSS1.p3.5.m5.1a"><msub id="S4.SS1.SSS1.p3.5.m5.1.1" xref="S4.SS1.SSS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.1.1.2" xref="S4.SS1.SSS1.p3.5.m5.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS1.p3.5.m5.1.1.3" xref="S4.SS1.SSS1.p3.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.5.m5.1b"><apply id="S4.SS1.SSS1.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.5.m5.1c">{\mathbf{w}}_{1}</annotation></semantics></math> is pulled closer to <math id="S4.SS1.SSS1.p3.6.m6.1" class="ltx_Math" alttext="{\mathbf{X}}_{1}" display="inline"><semantics id="S4.SS1.SSS1.p3.6.m6.1a"><msub id="S4.SS1.SSS1.p3.6.m6.1.1" xref="S4.SS1.SSS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.SSS1.p3.6.m6.1.1.2" xref="S4.SS1.SSS1.p3.6.m6.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.6.m6.1.1.3" xref="S4.SS1.SSS1.p3.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.6.m6.1b"><apply id="S4.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.6.m6.1c">{\mathbf{X}}_{1}</annotation></semantics></math> and pushed away from <math id="S4.SS1.SSS1.p3.7.m7.1" class="ltx_Math" alttext="{\mathbf{X}}_{2}" display="inline"><semantics id="S4.SS1.SSS1.p3.7.m7.1a"><msub id="S4.SS1.SSS1.p3.7.m7.1.1" xref="S4.SS1.SSS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.SSS1.p3.7.m7.1.1.2" xref="S4.SS1.SSS1.p3.7.m7.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.7.m7.1.1.3" xref="S4.SS1.SSS1.p3.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.7.m7.1b"><apply id="S4.SS1.SSS1.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p3.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.7.m7.1c">{\mathbf{X}}_{2}</annotation></semantics></math>, <math id="S4.SS1.SSS1.p3.8.m8.1" class="ltx_Math" alttext="{\mathbf{X}}_{3}" display="inline"><semantics id="S4.SS1.SSS1.p3.8.m8.1a"><msub id="S4.SS1.SSS1.p3.8.m8.1.1" xref="S4.SS1.SSS1.p3.8.m8.1.1.cmml"><mi id="S4.SS1.SSS1.p3.8.m8.1.1.2" xref="S4.SS1.SSS1.p3.8.m8.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS1.p3.8.m8.1.1.3" xref="S4.SS1.SSS1.p3.8.m8.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.8.m8.1b"><apply id="S4.SS1.SSS1.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.SSS1.p3.8.m8.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.8.m8.1c">{\mathbf{X}}_{3}</annotation></semantics></math> simultaneously.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2404.09232/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="131" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.2.1" class="ltx_text" style="font-size:90%;">The properties of softmax, i.e., Eq. <a href="#S4.E5" title="In 4.1.1 Softmax Properties ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, Eq. <a href="#S4.E6" title="In 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and Eq. <a href="#S4.E7" title="In 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</span></figcaption>
</figure>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Softmax with Missing Classes</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.5" class="ltx_p">The above shows the softmax classification with complete classes. In the considered FL scene, the clients only observe a partial set of classes. We in-depth analyze the local update of the proxies with missing classes. We still denote the training set as <math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N}" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><msubsup id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.4" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.5" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS2.p1.1.m1.1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS2.p1.1.m1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><set id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1"><interval closure="open" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3"><eq id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.1"></eq><ci id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS1.SSS2.p1.1.m1.1.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{N}</annotation></semantics></math>, while <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><msub id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.SSS2.p1.2.m2.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">y_{i}</annotation></semantics></math> is only from <math id="S4.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{O}}\subseteq{\mathcal{C}}" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><mrow id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.3.m3.1.1.2" xref="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml">𝒪</mi><mo id="S4.SS1.SSS2.p1.3.m3.1.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.3.m3.1.1.3" xref="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><apply id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1"><subset id="S4.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.1"></subset><ci id="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.2">𝒪</ci><ci id="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">{\mathcal{O}}\subseteq{\mathcal{C}}</annotation></semantics></math>. The missing class set is denoted as <math id="S4.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{M}}={\mathcal{C}}\setminus{\mathcal{O}}" display="inline"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mrow id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.4.m4.1.1.2" xref="S4.SS1.SSS2.p1.4.m4.1.1.2.cmml">ℳ</mi><mo id="S4.SS1.SSS2.p1.4.m4.1.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS2.p1.4.m4.1.1.3" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.2.cmml">𝒞</mi><mo id="S4.SS1.SSS2.p1.4.m4.1.1.3.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.1.cmml">∖</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.3.cmml">𝒪</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><apply id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1"><eq id="S4.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.2">ℳ</ci><apply id="S4.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.3"><setdiff id="S4.SS1.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.1"></setdiff><ci id="S4.SS1.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.2">𝒞</ci><ci id="S4.SS1.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1.3.3">𝒪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">{\mathcal{M}}={\mathcal{C}}\setminus{\mathcal{O}}</annotation></semantics></math>. Then, the Eq. <a href="#S4.E5" title="In 4.1.1 Softmax Properties ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> can be adapted. For <math id="S4.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="c\in{\mathcal{M}}" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><mrow id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.1.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS2.p1.5.m5.1.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.5.m5.1.1.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><apply id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1"><in id="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1"></in><ci id="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2">𝑐</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">c\in{\mathcal{M}}</annotation></semantics></math>:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.10" class="ltx_Math" alttext="{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{=0}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{only pushing exists}}." display="block"><semantics id="S4.E6.m1.10a"><mrow id="S4.E6.m1.10.10.1" xref="S4.E6.m1.10.10.1.1.cmml"><mrow id="S4.E6.m1.10.10.1.1" xref="S4.E6.m1.10.10.1.1.cmml"><msub id="S4.E6.m1.10.10.1.1.2" xref="S4.E6.m1.10.10.1.1.2.cmml"><mi id="S4.E6.m1.10.10.1.1.2.2" xref="S4.E6.m1.10.10.1.1.2.2.cmml">𝐰</mi><mi id="S4.E6.m1.10.10.1.1.2.3" xref="S4.E6.m1.10.10.1.1.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.10.10.1.1.1" xref="S4.E6.m1.10.10.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.10.10.1.1.3" xref="S4.E6.m1.10.10.1.1.3.cmml"><msub id="S4.E6.m1.10.10.1.1.3.2" xref="S4.E6.m1.10.10.1.1.3.2.cmml"><mi id="S4.E6.m1.10.10.1.1.3.2.2" xref="S4.E6.m1.10.10.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.E6.m1.10.10.1.1.3.2.3" xref="S4.E6.m1.10.10.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E6.m1.10.10.1.1.3.1" xref="S4.E6.m1.10.10.1.1.3.1.cmml">+</mo><mrow id="S4.E6.m1.10.10.1.1.3.3" xref="S4.E6.m1.10.10.1.1.3.3.cmml"><munder id="S4.E6.m1.10.10.1.1.3.3.2" xref="S4.E6.m1.10.10.1.1.3.3.2.cmml"><munder accentunder="true" id="S4.E6.m1.5.5" xref="S4.E6.m1.5.5.cmml"><mrow id="S4.E6.m1.5.5.5" xref="S4.E6.m1.5.5.5.cmml"><mi id="S4.E6.m1.5.5.5.7" xref="S4.E6.m1.5.5.5.7.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.5.6" xref="S4.E6.m1.5.5.5.6.cmml">​</mo><mrow id="S4.E6.m1.5.5.5.5" xref="S4.E6.m1.5.5.5.5.cmml"><munderover id="S4.E6.m1.5.5.5.5.2" xref="S4.E6.m1.5.5.5.5.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E6.m1.5.5.5.5.2.2.2" xref="S4.E6.m1.5.5.5.5.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.3.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.2.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.E6.m1.2.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.2.cmml"><msub id="S4.E6.m1.2.2.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.2.2.2.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.2.2.1.cmml">=</mo><mi id="S4.E6.m1.2.2.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E6.m1.5.5.5.5.2.3" xref="S4.E6.m1.5.5.5.5.2.3.cmml">N</mi></munderover><mrow id="S4.E6.m1.5.5.5.5.1" xref="S4.E6.m1.5.5.5.5.1.cmml"><mrow id="S4.E6.m1.5.5.5.5.1.1.1" xref="S4.E6.m1.5.5.5.5.1.1.1.1.cmml"><mo id="S4.E6.m1.5.5.5.5.1.1.1.2" xref="S4.E6.m1.5.5.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.5.5.5.5.1.1.1.1" xref="S4.E6.m1.5.5.5.5.1.1.1.1.cmml"><mn id="S4.E6.m1.5.5.5.5.1.1.1.1.2" xref="S4.E6.m1.5.5.5.5.1.1.1.1.2.cmml">1</mn><mo id="S4.E6.m1.5.5.5.5.1.1.1.1.1" xref="S4.E6.m1.5.5.5.5.1.1.1.1.1.cmml">−</mo><msub id="S4.E6.m1.5.5.5.5.1.1.1.1.3" xref="S4.E6.m1.5.5.5.5.1.1.1.1.3.cmml"><mi id="S4.E6.m1.5.5.5.5.1.1.1.1.3.2" xref="S4.E6.m1.5.5.5.5.1.1.1.1.3.2.cmml">p</mi><mrow id="S4.E6.m1.4.4.4.4.2.4" xref="S4.E6.m1.4.4.4.4.2.3.cmml"><mi id="S4.E6.m1.3.3.3.3.1.1" xref="S4.E6.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S4.E6.m1.4.4.4.4.2.4.1" xref="S4.E6.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.4.4.4.4.2.2" xref="S4.E6.m1.4.4.4.4.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S4.E6.m1.5.5.5.5.1.1.1.3" xref="S4.E6.m1.5.5.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.5.5.1.2" xref="S4.E6.m1.5.5.5.5.1.2.cmml">​</mo><msub id="S4.E6.m1.5.5.5.5.1.3" xref="S4.E6.m1.5.5.5.5.1.3.cmml"><mi id="S4.E6.m1.5.5.5.5.1.3.2" xref="S4.E6.m1.5.5.5.5.1.3.2.cmml">𝐡</mi><mi id="S4.E6.m1.5.5.5.5.1.3.3" xref="S4.E6.m1.5.5.5.5.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.6" xref="S4.E6.m1.5.5.6.cmml">⏟</mo></munder><mrow id="S4.E6.m1.10.10.1.1.3.3.2.2" xref="S4.E6.m1.10.10.1.1.3.3.2.2.cmml"><mi id="S4.E6.m1.10.10.1.1.3.3.2.2.2" xref="S4.E6.m1.10.10.1.1.3.3.2.2.2.cmml"></mi><mo id="S4.E6.m1.10.10.1.1.3.3.2.2.1" xref="S4.E6.m1.10.10.1.1.3.3.2.2.1.cmml">=</mo><mn id="S4.E6.m1.10.10.1.1.3.3.2.2.3" xref="S4.E6.m1.10.10.1.1.3.3.2.2.3.cmml">0</mn></mrow></munder><mo lspace="0em" rspace="0em" id="S4.E6.m1.10.10.1.1.3.3.1" xref="S4.E6.m1.10.10.1.1.3.3.1.cmml">​</mo><munder id="S4.E6.m1.10.10.1.1.3.3.3" xref="S4.E6.m1.10.10.1.1.3.3.3.cmml"><munder accentunder="true" id="S4.E6.m1.9.9" xref="S4.E6.m1.9.9.cmml"><mrow id="S4.E6.m1.9.9.4" xref="S4.E6.m1.9.9.4.cmml"><mo id="S4.E6.m1.9.9.4a" xref="S4.E6.m1.9.9.4.cmml">−</mo><mrow id="S4.E6.m1.9.9.4.6" xref="S4.E6.m1.9.9.4.6.cmml"><mi id="S4.E6.m1.9.9.4.6.2" xref="S4.E6.m1.9.9.4.6.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.9.9.4.6.1" xref="S4.E6.m1.9.9.4.6.1.cmml">​</mo><mrow id="S4.E6.m1.9.9.4.6.3" xref="S4.E6.m1.9.9.4.6.3.cmml"><munderover id="S4.E6.m1.9.9.4.6.3.1" xref="S4.E6.m1.9.9.4.6.3.1.cmml"><mo movablelimits="false" id="S4.E6.m1.9.9.4.6.3.1.2.2" xref="S4.E6.m1.9.9.4.6.3.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.7.7.2.2.2.2" xref="S4.E6.m1.7.7.2.2.2.3.cmml"><mrow id="S4.E6.m1.6.6.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.cmml"><mi id="S4.E6.m1.6.6.1.1.1.1.1.2" xref="S4.E6.m1.6.6.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E6.m1.6.6.1.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E6.m1.6.6.1.1.1.1.1.3" xref="S4.E6.m1.6.6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.7.7.2.2.2.2.3" xref="S4.E6.m1.7.7.2.2.2.3a.cmml">,</mo><mrow id="S4.E6.m1.7.7.2.2.2.2.2" xref="S4.E6.m1.7.7.2.2.2.2.2.cmml"><msub id="S4.E6.m1.7.7.2.2.2.2.2.2" xref="S4.E6.m1.7.7.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.7.7.2.2.2.2.2.2.2" xref="S4.E6.m1.7.7.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E6.m1.7.7.2.2.2.2.2.2.3" xref="S4.E6.m1.7.7.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.7.7.2.2.2.2.2.1" xref="S4.E6.m1.7.7.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E6.m1.7.7.2.2.2.2.2.3" xref="S4.E6.m1.7.7.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E6.m1.9.9.4.6.3.1.3" xref="S4.E6.m1.9.9.4.6.3.1.3.cmml">N</mi></munderover><mrow id="S4.E6.m1.9.9.4.6.3.2" xref="S4.E6.m1.9.9.4.6.3.2.cmml"><msub id="S4.E6.m1.9.9.4.6.3.2.2" xref="S4.E6.m1.9.9.4.6.3.2.2.cmml"><mi id="S4.E6.m1.9.9.4.6.3.2.2.2" xref="S4.E6.m1.9.9.4.6.3.2.2.2.cmml">p</mi><mrow id="S4.E6.m1.9.9.4.4.2.4" xref="S4.E6.m1.9.9.4.4.2.3.cmml"><mi id="S4.E6.m1.8.8.3.3.1.1" xref="S4.E6.m1.8.8.3.3.1.1.cmml">i</mi><mo id="S4.E6.m1.9.9.4.4.2.4.1" xref="S4.E6.m1.9.9.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.9.9.4.4.2.2" xref="S4.E6.m1.9.9.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.9.9.4.6.3.2.1" xref="S4.E6.m1.9.9.4.6.3.2.1.cmml">​</mo><msub id="S4.E6.m1.9.9.4.6.3.2.3" xref="S4.E6.m1.9.9.4.6.3.2.3.cmml"><mi id="S4.E6.m1.9.9.4.6.3.2.3.2" xref="S4.E6.m1.9.9.4.6.3.2.3.2.cmml">𝐡</mi><mi id="S4.E6.m1.9.9.4.6.3.2.3.3" xref="S4.E6.m1.9.9.4.6.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.9.9.5" xref="S4.E6.m1.9.9.5.cmml">⏟</mo></munder><mtext id="S4.E6.m1.10.10.1.1.3.3.3.2" xref="S4.E6.m1.10.10.1.1.3.3.3.2a.cmml">only pushing exists</mtext></munder></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m1.10.10.1.2" xref="S4.E6.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.10b"><apply id="S4.E6.m1.10.10.1.1.cmml" xref="S4.E6.m1.10.10.1"><eq id="S4.E6.m1.10.10.1.1.1.cmml" xref="S4.E6.m1.10.10.1.1.1"></eq><apply id="S4.E6.m1.10.10.1.1.2.cmml" xref="S4.E6.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.1.1.2.1.cmml" xref="S4.E6.m1.10.10.1.1.2">subscript</csymbol><ci id="S4.E6.m1.10.10.1.1.2.2.cmml" xref="S4.E6.m1.10.10.1.1.2.2">𝐰</ci><ci id="S4.E6.m1.10.10.1.1.2.3.cmml" xref="S4.E6.m1.10.10.1.1.2.3">𝑐</ci></apply><apply id="S4.E6.m1.10.10.1.1.3.cmml" xref="S4.E6.m1.10.10.1.1.3"><plus id="S4.E6.m1.10.10.1.1.3.1.cmml" xref="S4.E6.m1.10.10.1.1.3.1"></plus><apply id="S4.E6.m1.10.10.1.1.3.2.cmml" xref="S4.E6.m1.10.10.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.1.1.3.2.1.cmml" xref="S4.E6.m1.10.10.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.10.10.1.1.3.2.2.cmml" xref="S4.E6.m1.10.10.1.1.3.2.2">𝐰</ci><ci id="S4.E6.m1.10.10.1.1.3.2.3.cmml" xref="S4.E6.m1.10.10.1.1.3.2.3">𝑐</ci></apply><apply id="S4.E6.m1.10.10.1.1.3.3.cmml" xref="S4.E6.m1.10.10.1.1.3.3"><times id="S4.E6.m1.10.10.1.1.3.3.1.cmml" xref="S4.E6.m1.10.10.1.1.3.3.1"></times><apply id="S4.E6.m1.10.10.1.1.3.3.2.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.1.1.3.3.2.1.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2">subscript</csymbol><apply id="S4.E6.m1.5.5.cmml" xref="S4.E6.m1.5.5"><ci id="S4.E6.m1.5.5.6.cmml" xref="S4.E6.m1.5.5.6">⏟</ci><apply id="S4.E6.m1.5.5.5.cmml" xref="S4.E6.m1.5.5.5"><times id="S4.E6.m1.5.5.5.6.cmml" xref="S4.E6.m1.5.5.5.6"></times><ci id="S4.E6.m1.5.5.5.7.cmml" xref="S4.E6.m1.5.5.5.7">𝜂</ci><apply id="S4.E6.m1.5.5.5.5.cmml" xref="S4.E6.m1.5.5.5.5"><apply id="S4.E6.m1.5.5.5.5.2.cmml" xref="S4.E6.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.5.5.2.1.cmml" xref="S4.E6.m1.5.5.5.5.2">superscript</csymbol><apply id="S4.E6.m1.5.5.5.5.2.2.cmml" xref="S4.E6.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.5.5.2.2.1.cmml" xref="S4.E6.m1.5.5.5.5.2">subscript</csymbol><sum id="S4.E6.m1.5.5.5.5.2.2.2.cmml" xref="S4.E6.m1.5.5.5.5.2.2.2"></sum><apply id="S4.E6.m1.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.3a.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"></eq><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E6.m1.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2"><eq id="S4.E6.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.1"></eq><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E6.m1.5.5.5.5.2.3.cmml" xref="S4.E6.m1.5.5.5.5.2.3">𝑁</ci></apply><apply id="S4.E6.m1.5.5.5.5.1.cmml" xref="S4.E6.m1.5.5.5.5.1"><times id="S4.E6.m1.5.5.5.5.1.2.cmml" xref="S4.E6.m1.5.5.5.5.1.2"></times><apply id="S4.E6.m1.5.5.5.5.1.1.1.1.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1"><minus id="S4.E6.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1.1.1"></minus><cn type="integer" id="S4.E6.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1.1.2">1</cn><apply id="S4.E6.m1.5.5.5.5.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.5.5.1.1.1.1.3.1.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.5.5.5.5.1.1.1.1.3.2.cmml" xref="S4.E6.m1.5.5.5.5.1.1.1.1.3.2">𝑝</ci><list id="S4.E6.m1.4.4.4.4.2.3.cmml" xref="S4.E6.m1.4.4.4.4.2.4"><ci id="S4.E6.m1.3.3.3.3.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1">𝑖</ci><ci id="S4.E6.m1.4.4.4.4.2.2.cmml" xref="S4.E6.m1.4.4.4.4.2.2">𝑐</ci></list></apply></apply><apply id="S4.E6.m1.5.5.5.5.1.3.cmml" xref="S4.E6.m1.5.5.5.5.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.5.5.1.3.1.cmml" xref="S4.E6.m1.5.5.5.5.1.3">subscript</csymbol><ci id="S4.E6.m1.5.5.5.5.1.3.2.cmml" xref="S4.E6.m1.5.5.5.5.1.3.2">𝐡</ci><ci id="S4.E6.m1.5.5.5.5.1.3.3.cmml" xref="S4.E6.m1.5.5.5.5.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E6.m1.10.10.1.1.3.3.2.2.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2.2"><eq id="S4.E6.m1.10.10.1.1.3.3.2.2.1.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2.2.1"></eq><csymbol cd="latexml" id="S4.E6.m1.10.10.1.1.3.3.2.2.2.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2.2.2">absent</csymbol><cn type="integer" id="S4.E6.m1.10.10.1.1.3.3.2.2.3.cmml" xref="S4.E6.m1.10.10.1.1.3.3.2.2.3">0</cn></apply></apply><apply id="S4.E6.m1.10.10.1.1.3.3.3.cmml" xref="S4.E6.m1.10.10.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.1.1.3.3.3.1.cmml" xref="S4.E6.m1.10.10.1.1.3.3.3">subscript</csymbol><apply id="S4.E6.m1.9.9.cmml" xref="S4.E6.m1.9.9"><ci id="S4.E6.m1.9.9.5.cmml" xref="S4.E6.m1.9.9.5">⏟</ci><apply id="S4.E6.m1.9.9.4.cmml" xref="S4.E6.m1.9.9.4"><minus id="S4.E6.m1.9.9.4.5.cmml" xref="S4.E6.m1.9.9.4"></minus><apply id="S4.E6.m1.9.9.4.6.cmml" xref="S4.E6.m1.9.9.4.6"><times id="S4.E6.m1.9.9.4.6.1.cmml" xref="S4.E6.m1.9.9.4.6.1"></times><ci id="S4.E6.m1.9.9.4.6.2.cmml" xref="S4.E6.m1.9.9.4.6.2">𝜂</ci><apply id="S4.E6.m1.9.9.4.6.3.cmml" xref="S4.E6.m1.9.9.4.6.3"><apply id="S4.E6.m1.9.9.4.6.3.1.cmml" xref="S4.E6.m1.9.9.4.6.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.4.6.3.1.1.cmml" xref="S4.E6.m1.9.9.4.6.3.1">superscript</csymbol><apply id="S4.E6.m1.9.9.4.6.3.1.2.cmml" xref="S4.E6.m1.9.9.4.6.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.4.6.3.1.2.1.cmml" xref="S4.E6.m1.9.9.4.6.3.1">subscript</csymbol><sum id="S4.E6.m1.9.9.4.6.3.1.2.2.cmml" xref="S4.E6.m1.9.9.4.6.3.1.2.2"></sum><apply id="S4.E6.m1.7.7.2.2.2.3.cmml" xref="S4.E6.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.2.2.2.3a.cmml" xref="S4.E6.m1.7.7.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.6.6.1.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1"><eq id="S4.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.1"></eq><ci id="S4.E6.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E6.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.3">1</cn></apply><apply id="S4.E6.m1.7.7.2.2.2.2.2.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2"><neq id="S4.E6.m1.7.7.2.2.2.2.2.1.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.1"></neq><apply id="S4.E6.m1.7.7.2.2.2.2.2.2.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.7.7.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E6.m1.7.7.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E6.m1.7.7.2.2.2.2.2.3.cmml" xref="S4.E6.m1.7.7.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E6.m1.9.9.4.6.3.1.3.cmml" xref="S4.E6.m1.9.9.4.6.3.1.3">𝑁</ci></apply><apply id="S4.E6.m1.9.9.4.6.3.2.cmml" xref="S4.E6.m1.9.9.4.6.3.2"><times id="S4.E6.m1.9.9.4.6.3.2.1.cmml" xref="S4.E6.m1.9.9.4.6.3.2.1"></times><apply id="S4.E6.m1.9.9.4.6.3.2.2.cmml" xref="S4.E6.m1.9.9.4.6.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.4.6.3.2.2.1.cmml" xref="S4.E6.m1.9.9.4.6.3.2.2">subscript</csymbol><ci id="S4.E6.m1.9.9.4.6.3.2.2.2.cmml" xref="S4.E6.m1.9.9.4.6.3.2.2.2">𝑝</ci><list id="S4.E6.m1.9.9.4.4.2.3.cmml" xref="S4.E6.m1.9.9.4.4.2.4"><ci id="S4.E6.m1.8.8.3.3.1.1.cmml" xref="S4.E6.m1.8.8.3.3.1.1">𝑖</ci><ci id="S4.E6.m1.9.9.4.4.2.2.cmml" xref="S4.E6.m1.9.9.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E6.m1.9.9.4.6.3.2.3.cmml" xref="S4.E6.m1.9.9.4.6.3.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.4.6.3.2.3.1.cmml" xref="S4.E6.m1.9.9.4.6.3.2.3">subscript</csymbol><ci id="S4.E6.m1.9.9.4.6.3.2.3.2.cmml" xref="S4.E6.m1.9.9.4.6.3.2.3.2">𝐡</ci><ci id="S4.E6.m1.9.9.4.6.3.2.3.3.cmml" xref="S4.E6.m1.9.9.4.6.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><ci id="S4.E6.m1.10.10.1.1.3.3.3.2a.cmml" xref="S4.E6.m1.10.10.1.1.3.3.3.2"><mtext mathsize="70%" id="S4.E6.m1.10.10.1.1.3.3.3.2.cmml" xref="S4.E6.m1.10.10.1.1.3.3.3.2">only pushing exists</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.10c">{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{=0}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{only pushing exists}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.2" class="ltx_p">This shows that due to lacking corresponding training samples, the pulling force of proxy <math id="S4.SS1.SSS2.p2.1.m1.2" class="ltx_Math" alttext="{\mathbf{w}}_{c},c\in{\mathcal{M}}" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.2a"><mrow id="S4.SS1.SSS2.p2.1.m1.2.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.cmml"><mrow id="S4.SS1.SSS2.p2.1.m1.2.2.1.1" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.2.cmml"><msub id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.2.cmml">,</mo><mi id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml">c</mi></mrow><mo id="S4.SS1.SSS2.p2.1.m1.2.2.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p2.1.m1.2.2.3" xref="S4.SS1.SSS2.p2.1.m1.2.2.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.2b"><apply id="S4.SS1.SSS2.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2"><in id="S4.SS1.SSS2.p2.1.m1.2.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.2"></in><list id="S4.SS1.SSS2.p2.1.m1.2.2.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1"><apply id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.2">𝐰</ci><ci id="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.1.1.1.3">𝑐</ci></apply><ci id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1">𝑐</ci></list><ci id="S4.SS1.SSS2.p2.1.m1.2.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.2.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.2c">{\mathbf{w}}_{c},c\in{\mathcal{M}}</annotation></semantics></math> is missing, and the proxy is only pushed away from negative features. This phenomenon is illustrated in the left part of Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (B), where <math id="S4.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="{\mathbf{w}}_{2}" display="inline"><semantics id="S4.SS1.SSS2.p2.2.m2.1a"><msub id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS2.p2.2.m2.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.1b"><apply id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.1c">{\mathbf{w}}_{2}</annotation></semantics></math> is the proxy of the missing class and the gray arc implies the pulling property is missing.</p>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.2" class="ltx_p">For the observed class <math id="S4.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="c\in{\mathcal{O}}" display="inline"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><mrow id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p3.1.m1.1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS2.p3.1.m1.1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.1.m1.1.1.3" xref="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml">𝒪</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1"><in id="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.1"></in><ci id="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2">𝑐</ci><ci id="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.3">𝒪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">c\in{\mathcal{O}}</annotation></semantics></math>, we have the update of <math id="S4.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="{\mathbf{w}}_{c}" display="inline"><semantics id="S4.SS1.SSS2.p3.2.m2.1a"><msub id="S4.SS1.SSS2.p3.2.m2.1.1" xref="S4.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p3.2.m2.1.1.2" xref="S4.SS1.SSS2.p3.2.m2.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS2.p3.2.m2.1.1.3" xref="S4.SS1.SSS2.p3.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.2.m2.1b"><apply id="S4.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1.2">𝐰</ci><ci id="S4.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.2.m2.1c">{\mathbf{w}}_{c}</annotation></semantics></math>:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.11" class="ltx_Math" alttext="{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{\text{pulling}}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{$\left(|{\mathcal{O}}|-1\right)$ classes}}," display="block"><semantics id="S4.E7.m1.11a"><mrow id="S4.E7.m1.11.11.1" xref="S4.E7.m1.11.11.1.1.cmml"><mrow id="S4.E7.m1.11.11.1.1" xref="S4.E7.m1.11.11.1.1.cmml"><msub id="S4.E7.m1.11.11.1.1.2" xref="S4.E7.m1.11.11.1.1.2.cmml"><mi id="S4.E7.m1.11.11.1.1.2.2" xref="S4.E7.m1.11.11.1.1.2.2.cmml">𝐰</mi><mi id="S4.E7.m1.11.11.1.1.2.3" xref="S4.E7.m1.11.11.1.1.2.3.cmml">c</mi></msub><mo id="S4.E7.m1.11.11.1.1.1" xref="S4.E7.m1.11.11.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.11.11.1.1.3" xref="S4.E7.m1.11.11.1.1.3.cmml"><msub id="S4.E7.m1.11.11.1.1.3.2" xref="S4.E7.m1.11.11.1.1.3.2.cmml"><mi id="S4.E7.m1.11.11.1.1.3.2.2" xref="S4.E7.m1.11.11.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.E7.m1.11.11.1.1.3.2.3" xref="S4.E7.m1.11.11.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.E7.m1.11.11.1.1.3.1" xref="S4.E7.m1.11.11.1.1.3.1.cmml">+</mo><mrow id="S4.E7.m1.11.11.1.1.3.3" xref="S4.E7.m1.11.11.1.1.3.3.cmml"><munder id="S4.E7.m1.11.11.1.1.3.3.2" xref="S4.E7.m1.11.11.1.1.3.3.2.cmml"><munder accentunder="true" id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml"><mrow id="S4.E7.m1.6.6.5" xref="S4.E7.m1.6.6.5.cmml"><mi id="S4.E7.m1.6.6.5.7" xref="S4.E7.m1.6.6.5.7.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.5.6" xref="S4.E7.m1.6.6.5.6.cmml">​</mo><mrow id="S4.E7.m1.6.6.5.5" xref="S4.E7.m1.6.6.5.5.cmml"><munderover id="S4.E7.m1.6.6.5.5.2" xref="S4.E7.m1.6.6.5.5.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E7.m1.6.6.5.5.2.2.2" xref="S4.E7.m1.6.6.5.5.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.3.3.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.3.cmml"><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E7.m1.3.3.2.2.2.2.3" xref="S4.E7.m1.3.3.2.2.2.3a.cmml">,</mo><mrow id="S4.E7.m1.3.3.2.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.2.2.cmml"><msub id="S4.E7.m1.3.3.2.2.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S4.E7.m1.3.3.2.2.2.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E7.m1.3.3.2.2.2.2.2.2.3" xref="S4.E7.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.3.3.2.2.2.2.2.1" xref="S4.E7.m1.3.3.2.2.2.2.2.1.cmml">=</mo><mi id="S4.E7.m1.3.3.2.2.2.2.2.3" xref="S4.E7.m1.3.3.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E7.m1.6.6.5.5.2.3" xref="S4.E7.m1.6.6.5.5.2.3.cmml">N</mi></munderover><mrow id="S4.E7.m1.6.6.5.5.1" xref="S4.E7.m1.6.6.5.5.1.cmml"><mrow id="S4.E7.m1.6.6.5.5.1.1.1" xref="S4.E7.m1.6.6.5.5.1.1.1.1.cmml"><mo id="S4.E7.m1.6.6.5.5.1.1.1.2" xref="S4.E7.m1.6.6.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.6.6.5.5.1.1.1.1" xref="S4.E7.m1.6.6.5.5.1.1.1.1.cmml"><mn id="S4.E7.m1.6.6.5.5.1.1.1.1.2" xref="S4.E7.m1.6.6.5.5.1.1.1.1.2.cmml">1</mn><mo id="S4.E7.m1.6.6.5.5.1.1.1.1.1" xref="S4.E7.m1.6.6.5.5.1.1.1.1.1.cmml">−</mo><msub id="S4.E7.m1.6.6.5.5.1.1.1.1.3" xref="S4.E7.m1.6.6.5.5.1.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.5.5.1.1.1.1.3.2" xref="S4.E7.m1.6.6.5.5.1.1.1.1.3.2.cmml">p</mi><mrow id="S4.E7.m1.5.5.4.4.2.4" xref="S4.E7.m1.5.5.4.4.2.3.cmml"><mi id="S4.E7.m1.4.4.3.3.1.1" xref="S4.E7.m1.4.4.3.3.1.1.cmml">i</mi><mo id="S4.E7.m1.5.5.4.4.2.4.1" xref="S4.E7.m1.5.5.4.4.2.3.cmml">,</mo><mi id="S4.E7.m1.5.5.4.4.2.2" xref="S4.E7.m1.5.5.4.4.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S4.E7.m1.6.6.5.5.1.1.1.3" xref="S4.E7.m1.6.6.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.5.5.1.2" xref="S4.E7.m1.6.6.5.5.1.2.cmml">​</mo><msub id="S4.E7.m1.6.6.5.5.1.3" xref="S4.E7.m1.6.6.5.5.1.3.cmml"><mi id="S4.E7.m1.6.6.5.5.1.3.2" xref="S4.E7.m1.6.6.5.5.1.3.2.cmml">𝐡</mi><mi id="S4.E7.m1.6.6.5.5.1.3.3" xref="S4.E7.m1.6.6.5.5.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E7.m1.6.6.6" xref="S4.E7.m1.6.6.6.cmml">⏟</mo></munder><mtext id="S4.E7.m1.11.11.1.1.3.3.2.2" xref="S4.E7.m1.11.11.1.1.3.3.2.2a.cmml">pulling</mtext></munder><mo lspace="0em" rspace="0em" id="S4.E7.m1.11.11.1.1.3.3.1" xref="S4.E7.m1.11.11.1.1.3.3.1.cmml">​</mo><munder id="S4.E7.m1.11.11.1.1.3.3.3" xref="S4.E7.m1.11.11.1.1.3.3.3.cmml"><munder accentunder="true" id="S4.E7.m1.10.10" xref="S4.E7.m1.10.10.cmml"><mrow id="S4.E7.m1.10.10.4" xref="S4.E7.m1.10.10.4.cmml"><mo id="S4.E7.m1.10.10.4a" xref="S4.E7.m1.10.10.4.cmml">−</mo><mrow id="S4.E7.m1.10.10.4.6" xref="S4.E7.m1.10.10.4.6.cmml"><mi id="S4.E7.m1.10.10.4.6.2" xref="S4.E7.m1.10.10.4.6.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.4.6.1" xref="S4.E7.m1.10.10.4.6.1.cmml">​</mo><mrow id="S4.E7.m1.10.10.4.6.3" xref="S4.E7.m1.10.10.4.6.3.cmml"><munderover id="S4.E7.m1.10.10.4.6.3.1" xref="S4.E7.m1.10.10.4.6.3.1.cmml"><mo movablelimits="false" id="S4.E7.m1.10.10.4.6.3.1.2.2" xref="S4.E7.m1.10.10.4.6.3.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.8.8.2.2.2.2" xref="S4.E7.m1.8.8.2.2.2.3.cmml"><mrow id="S4.E7.m1.7.7.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.1.2.cmml">i</mi><mo id="S4.E7.m1.7.7.1.1.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E7.m1.7.7.1.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E7.m1.8.8.2.2.2.2.3" xref="S4.E7.m1.8.8.2.2.2.3a.cmml">,</mo><mrow id="S4.E7.m1.8.8.2.2.2.2.2" xref="S4.E7.m1.8.8.2.2.2.2.2.cmml"><msub id="S4.E7.m1.8.8.2.2.2.2.2.2" xref="S4.E7.m1.8.8.2.2.2.2.2.2.cmml"><mi id="S4.E7.m1.8.8.2.2.2.2.2.2.2" xref="S4.E7.m1.8.8.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E7.m1.8.8.2.2.2.2.2.2.3" xref="S4.E7.m1.8.8.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.8.8.2.2.2.2.2.1" xref="S4.E7.m1.8.8.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E7.m1.8.8.2.2.2.2.2.3" xref="S4.E7.m1.8.8.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><mi id="S4.E7.m1.10.10.4.6.3.1.3" xref="S4.E7.m1.10.10.4.6.3.1.3.cmml">N</mi></munderover><mrow id="S4.E7.m1.10.10.4.6.3.2" xref="S4.E7.m1.10.10.4.6.3.2.cmml"><msub id="S4.E7.m1.10.10.4.6.3.2.2" xref="S4.E7.m1.10.10.4.6.3.2.2.cmml"><mi id="S4.E7.m1.10.10.4.6.3.2.2.2" xref="S4.E7.m1.10.10.4.6.3.2.2.2.cmml">p</mi><mrow id="S4.E7.m1.10.10.4.4.2.4" xref="S4.E7.m1.10.10.4.4.2.3.cmml"><mi id="S4.E7.m1.9.9.3.3.1.1" xref="S4.E7.m1.9.9.3.3.1.1.cmml">i</mi><mo id="S4.E7.m1.10.10.4.4.2.4.1" xref="S4.E7.m1.10.10.4.4.2.3.cmml">,</mo><mi id="S4.E7.m1.10.10.4.4.2.2" xref="S4.E7.m1.10.10.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.4.6.3.2.1" xref="S4.E7.m1.10.10.4.6.3.2.1.cmml">​</mo><msub id="S4.E7.m1.10.10.4.6.3.2.3" xref="S4.E7.m1.10.10.4.6.3.2.3.cmml"><mi id="S4.E7.m1.10.10.4.6.3.2.3.2" xref="S4.E7.m1.10.10.4.6.3.2.3.2.cmml">𝐡</mi><mi id="S4.E7.m1.10.10.4.6.3.2.3.3" xref="S4.E7.m1.10.10.4.6.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.10.10.5" xref="S4.E7.m1.10.10.5.cmml">⏟</mo></munder><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1b.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.3" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3.cmml"><mo id="S4.E7.m1.1.1.1.1.1.m1.2.2.3.1" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3.cmml"><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.1" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.m1.1.1" xref="S4.E7.m1.1.1.1.1.1.m1.1.1.cmml">𝒪</mi><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.2" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.cmml">|</mo></mrow><mo id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.1" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.1.cmml">−</mo><mn id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.3" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.3.cmml">1</mn></mrow><mo id="S4.E7.m1.1.1.1.1.1.m1.2.2.3.2" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3.cmml">)</mo></mrow><mtext id="S4.E7.m1.1.1.1a" xref="S4.E7.m1.1.1.1b.cmml"> classes</mtext></mrow></munder></mrow></mrow></mrow><mo id="S4.E7.m1.11.11.1.2" xref="S4.E7.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.11b"><apply id="S4.E7.m1.11.11.1.1.cmml" xref="S4.E7.m1.11.11.1"><eq id="S4.E7.m1.11.11.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1"></eq><apply id="S4.E7.m1.11.11.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.2.1.cmml" xref="S4.E7.m1.11.11.1.1.2">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.2.2.cmml" xref="S4.E7.m1.11.11.1.1.2.2">𝐰</ci><ci id="S4.E7.m1.11.11.1.1.2.3.cmml" xref="S4.E7.m1.11.11.1.1.2.3">𝑐</ci></apply><apply id="S4.E7.m1.11.11.1.1.3.cmml" xref="S4.E7.m1.11.11.1.1.3"><plus id="S4.E7.m1.11.11.1.1.3.1.cmml" xref="S4.E7.m1.11.11.1.1.3.1"></plus><apply id="S4.E7.m1.11.11.1.1.3.2.cmml" xref="S4.E7.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.3.2.1.cmml" xref="S4.E7.m1.11.11.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.3.2.2.cmml" xref="S4.E7.m1.11.11.1.1.3.2.2">𝐰</ci><ci id="S4.E7.m1.11.11.1.1.3.2.3.cmml" xref="S4.E7.m1.11.11.1.1.3.2.3">𝑐</ci></apply><apply id="S4.E7.m1.11.11.1.1.3.3.cmml" xref="S4.E7.m1.11.11.1.1.3.3"><times id="S4.E7.m1.11.11.1.1.3.3.1.cmml" xref="S4.E7.m1.11.11.1.1.3.3.1"></times><apply id="S4.E7.m1.11.11.1.1.3.3.2.cmml" xref="S4.E7.m1.11.11.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.3.3.2.1.cmml" xref="S4.E7.m1.11.11.1.1.3.3.2">subscript</csymbol><apply id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6"><ci id="S4.E7.m1.6.6.6.cmml" xref="S4.E7.m1.6.6.6">⏟</ci><apply id="S4.E7.m1.6.6.5.cmml" xref="S4.E7.m1.6.6.5"><times id="S4.E7.m1.6.6.5.6.cmml" xref="S4.E7.m1.6.6.5.6"></times><ci id="S4.E7.m1.6.6.5.7.cmml" xref="S4.E7.m1.6.6.5.7">𝜂</ci><apply id="S4.E7.m1.6.6.5.5.cmml" xref="S4.E7.m1.6.6.5.5"><apply id="S4.E7.m1.6.6.5.5.2.cmml" xref="S4.E7.m1.6.6.5.5.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.5.5.2.1.cmml" xref="S4.E7.m1.6.6.5.5.2">superscript</csymbol><apply id="S4.E7.m1.6.6.5.5.2.2.cmml" xref="S4.E7.m1.6.6.5.5.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.5.5.2.2.1.cmml" xref="S4.E7.m1.6.6.5.5.2">subscript</csymbol><sum id="S4.E7.m1.6.6.5.5.2.2.2.cmml" xref="S4.E7.m1.6.6.5.5.2.2.2"></sum><apply id="S4.E7.m1.3.3.2.2.2.3.cmml" xref="S4.E7.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.2.2.2.3a.cmml" xref="S4.E7.m1.3.3.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1"><eq id="S4.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1"></eq><ci id="S4.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E7.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S4.E7.m1.3.3.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2"><eq id="S4.E7.m1.3.3.2.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.1"></eq><apply id="S4.E7.m1.3.3.2.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E7.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E7.m1.3.3.2.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E7.m1.6.6.5.5.2.3.cmml" xref="S4.E7.m1.6.6.5.5.2.3">𝑁</ci></apply><apply id="S4.E7.m1.6.6.5.5.1.cmml" xref="S4.E7.m1.6.6.5.5.1"><times id="S4.E7.m1.6.6.5.5.1.2.cmml" xref="S4.E7.m1.6.6.5.5.1.2"></times><apply id="S4.E7.m1.6.6.5.5.1.1.1.1.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1"><minus id="S4.E7.m1.6.6.5.5.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1.1.1"></minus><cn type="integer" id="S4.E7.m1.6.6.5.5.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1.1.2">1</cn><apply id="S4.E7.m1.6.6.5.5.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.5.5.1.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.5.5.1.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.5.5.1.1.1.1.3.2">𝑝</ci><list id="S4.E7.m1.5.5.4.4.2.3.cmml" xref="S4.E7.m1.5.5.4.4.2.4"><ci id="S4.E7.m1.4.4.3.3.1.1.cmml" xref="S4.E7.m1.4.4.3.3.1.1">𝑖</ci><ci id="S4.E7.m1.5.5.4.4.2.2.cmml" xref="S4.E7.m1.5.5.4.4.2.2">𝑐</ci></list></apply></apply><apply id="S4.E7.m1.6.6.5.5.1.3.cmml" xref="S4.E7.m1.6.6.5.5.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.5.5.1.3.1.cmml" xref="S4.E7.m1.6.6.5.5.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.5.5.1.3.2.cmml" xref="S4.E7.m1.6.6.5.5.1.3.2">𝐡</ci><ci id="S4.E7.m1.6.6.5.5.1.3.3.cmml" xref="S4.E7.m1.6.6.5.5.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><ci id="S4.E7.m1.11.11.1.1.3.3.2.2a.cmml" xref="S4.E7.m1.11.11.1.1.3.3.2.2"><mtext mathsize="70%" id="S4.E7.m1.11.11.1.1.3.3.2.2.cmml" xref="S4.E7.m1.11.11.1.1.3.3.2.2">pulling</mtext></ci></apply><apply id="S4.E7.m1.11.11.1.1.3.3.3.cmml" xref="S4.E7.m1.11.11.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.3.3.3.1.cmml" xref="S4.E7.m1.11.11.1.1.3.3.3">subscript</csymbol><apply id="S4.E7.m1.10.10.cmml" xref="S4.E7.m1.10.10"><ci id="S4.E7.m1.10.10.5.cmml" xref="S4.E7.m1.10.10.5">⏟</ci><apply id="S4.E7.m1.10.10.4.cmml" xref="S4.E7.m1.10.10.4"><minus id="S4.E7.m1.10.10.4.5.cmml" xref="S4.E7.m1.10.10.4"></minus><apply id="S4.E7.m1.10.10.4.6.cmml" xref="S4.E7.m1.10.10.4.6"><times id="S4.E7.m1.10.10.4.6.1.cmml" xref="S4.E7.m1.10.10.4.6.1"></times><ci id="S4.E7.m1.10.10.4.6.2.cmml" xref="S4.E7.m1.10.10.4.6.2">𝜂</ci><apply id="S4.E7.m1.10.10.4.6.3.cmml" xref="S4.E7.m1.10.10.4.6.3"><apply id="S4.E7.m1.10.10.4.6.3.1.cmml" xref="S4.E7.m1.10.10.4.6.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.4.6.3.1.1.cmml" xref="S4.E7.m1.10.10.4.6.3.1">superscript</csymbol><apply id="S4.E7.m1.10.10.4.6.3.1.2.cmml" xref="S4.E7.m1.10.10.4.6.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.4.6.3.1.2.1.cmml" xref="S4.E7.m1.10.10.4.6.3.1">subscript</csymbol><sum id="S4.E7.m1.10.10.4.6.3.1.2.2.cmml" xref="S4.E7.m1.10.10.4.6.3.1.2.2"></sum><apply id="S4.E7.m1.8.8.2.2.2.3.cmml" xref="S4.E7.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.2.2.2.3a.cmml" xref="S4.E7.m1.8.8.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1"><eq id="S4.E7.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.1"></eq><ci id="S4.E7.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S4.E7.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1.3">1</cn></apply><apply id="S4.E7.m1.8.8.2.2.2.2.2.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2"><neq id="S4.E7.m1.8.8.2.2.2.2.2.1.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.1"></neq><apply id="S4.E7.m1.8.8.2.2.2.2.2.2.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.8.8.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E7.m1.8.8.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E7.m1.8.8.2.2.2.2.2.3.cmml" xref="S4.E7.m1.8.8.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><ci id="S4.E7.m1.10.10.4.6.3.1.3.cmml" xref="S4.E7.m1.10.10.4.6.3.1.3">𝑁</ci></apply><apply id="S4.E7.m1.10.10.4.6.3.2.cmml" xref="S4.E7.m1.10.10.4.6.3.2"><times id="S4.E7.m1.10.10.4.6.3.2.1.cmml" xref="S4.E7.m1.10.10.4.6.3.2.1"></times><apply id="S4.E7.m1.10.10.4.6.3.2.2.cmml" xref="S4.E7.m1.10.10.4.6.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.4.6.3.2.2.1.cmml" xref="S4.E7.m1.10.10.4.6.3.2.2">subscript</csymbol><ci id="S4.E7.m1.10.10.4.6.3.2.2.2.cmml" xref="S4.E7.m1.10.10.4.6.3.2.2.2">𝑝</ci><list id="S4.E7.m1.10.10.4.4.2.3.cmml" xref="S4.E7.m1.10.10.4.4.2.4"><ci id="S4.E7.m1.9.9.3.3.1.1.cmml" xref="S4.E7.m1.9.9.3.3.1.1">𝑖</ci><ci id="S4.E7.m1.10.10.4.4.2.2.cmml" xref="S4.E7.m1.10.10.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E7.m1.10.10.4.6.3.2.3.cmml" xref="S4.E7.m1.10.10.4.6.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.4.6.3.2.3.1.cmml" xref="S4.E7.m1.10.10.4.6.3.2.3">subscript</csymbol><ci id="S4.E7.m1.10.10.4.6.3.2.3.2.cmml" xref="S4.E7.m1.10.10.4.6.3.2.3.2">𝐡</ci><ci id="S4.E7.m1.10.10.4.6.3.2.3.3.cmml" xref="S4.E7.m1.10.10.4.6.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><ci id="S4.E7.m1.1.1.1b.cmml" xref="S4.E7.m1.1.1.1"><mrow id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3"><mo id="S4.E7.m1.1.1.1.1.1.m1.2.2.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3"><mrow id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2"><mo maxsize="70%" minsize="70%" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="S4.E7.m1.1.1.1.1.1.m1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.1.1">𝒪</mi><mo maxsize="70%" minsize="70%" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.2.2">|</mo></mrow><mo mathsize="70%" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.1">−</mo><mn mathsize="70%" id="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.1.1.3">1</mn></mrow><mo id="S4.E7.m1.1.1.1.1.1.m1.2.2.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.m1.2.2.3">)</mo></mrow><mtext mathsize="70%" id="S4.E7.m1.1.1.1a.cmml" xref="S4.E7.m1.1.1.1"> classes</mtext></mrow></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.11c">{\mathbf{w}}_{c}={\mathbf{w}}_{c}+\underbrace{\eta\sum_{i=1,y_{i}=c}^{N}\left(1-p_{i,c}\right){\mathbf{h}}_{i}}_{\text{pulling}}\underbrace{-\eta\sum_{i=1,y_{i}\neq c}^{N}p_{i,c}{\mathbf{h}}_{i}}_{\text{$\left(|{\mathcal{O}}|-1\right)$ classes}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS2.p3.6" class="ltx_p">where we can find that the pushing force becomes weaker due to that the negative features only come from <math id="S4.SS1.SSS2.p3.3.m1.1" class="ltx_Math" alttext="|{\mathcal{O}}|-1" display="inline"><semantics id="S4.SS1.SSS2.p3.3.m1.1a"><mrow id="S4.SS1.SSS2.p3.3.m1.1.2" xref="S4.SS1.SSS2.p3.3.m1.1.2.cmml"><mrow id="S4.SS1.SSS2.p3.3.m1.1.2.2.2" xref="S4.SS1.SSS2.p3.3.m1.1.2.2.1.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.3.m1.1.2.2.2.1" xref="S4.SS1.SSS2.p3.3.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.3.m1.1.1" xref="S4.SS1.SSS2.p3.3.m1.1.1.cmml">𝒪</mi><mo stretchy="false" id="S4.SS1.SSS2.p3.3.m1.1.2.2.2.2" xref="S4.SS1.SSS2.p3.3.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.SSS2.p3.3.m1.1.2.1" xref="S4.SS1.SSS2.p3.3.m1.1.2.1.cmml">−</mo><mn id="S4.SS1.SSS2.p3.3.m1.1.2.3" xref="S4.SS1.SSS2.p3.3.m1.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.3.m1.1b"><apply id="S4.SS1.SSS2.p3.3.m1.1.2.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.2"><minus id="S4.SS1.SSS2.p3.3.m1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.2.1"></minus><apply id="S4.SS1.SSS2.p3.3.m1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.2.2.2"><abs id="S4.SS1.SSS2.p3.3.m1.1.2.2.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.2.2.2.1"></abs><ci id="S4.SS1.SSS2.p3.3.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.1">𝒪</ci></apply><cn type="integer" id="S4.SS1.SSS2.p3.3.m1.1.2.3.cmml" xref="S4.SS1.SSS2.p3.3.m1.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.3.m1.1c">|{\mathcal{O}}|-1</annotation></semantics></math> classes. This is illustrated in the right part of Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (B), where the negative feature region <math id="S4.SS1.SSS2.p3.4.m2.1" class="ltx_Math" alttext="{\mathbf{X}}_{2}" display="inline"><semantics id="S4.SS1.SSS2.p3.4.m2.1a"><msub id="S4.SS1.SSS2.p3.4.m2.1.1" xref="S4.SS1.SSS2.p3.4.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p3.4.m2.1.1.2" xref="S4.SS1.SSS2.p3.4.m2.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS2.p3.4.m2.1.1.3" xref="S4.SS1.SSS2.p3.4.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.4.m2.1b"><apply id="S4.SS1.SSS2.p3.4.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.4.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.4.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p3.4.m2.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS2.p3.4.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p3.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.4.m2.1c">{\mathbf{X}}_{2}</annotation></semantics></math> does not exist and only <math id="S4.SS1.SSS2.p3.5.m3.1" class="ltx_Math" alttext="{\mathbf{X}}_{3}" display="inline"><semantics id="S4.SS1.SSS2.p3.5.m3.1a"><msub id="S4.SS1.SSS2.p3.5.m3.1.1" xref="S4.SS1.SSS2.p3.5.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p3.5.m3.1.1.2" xref="S4.SS1.SSS2.p3.5.m3.1.1.2.cmml">𝐗</mi><mn id="S4.SS1.SSS2.p3.5.m3.1.1.3" xref="S4.SS1.SSS2.p3.5.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.5.m3.1b"><apply id="S4.SS1.SSS2.p3.5.m3.1.1.cmml" xref="S4.SS1.SSS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p3.5.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p3.5.m3.1.1.2">𝐗</ci><cn type="integer" id="S4.SS1.SSS2.p3.5.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p3.5.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.5.m3.1c">{\mathbf{X}}_{3}</annotation></semantics></math> exists when updating the proxy <math id="S4.SS1.SSS2.p3.6.m4.1" class="ltx_Math" alttext="{\mathbf{w}}_{1}" display="inline"><semantics id="S4.SS1.SSS2.p3.6.m4.1a"><msub id="S4.SS1.SSS2.p3.6.m4.1.1" xref="S4.SS1.SSS2.p3.6.m4.1.1.cmml"><mi id="S4.SS1.SSS2.p3.6.m4.1.1.2" xref="S4.SS1.SSS2.p3.6.m4.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS2.p3.6.m4.1.1.3" xref="S4.SS1.SSS2.p3.6.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.6.m4.1b"><apply id="S4.SS1.SSS2.p3.6.m4.1.1.cmml" xref="S4.SS1.SSS2.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.6.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p3.6.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.6.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p3.6.m4.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS2.p3.6.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p3.6.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.6.m4.1c">{\mathbf{w}}_{1}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS2.p4" class="ltx_para">
<p id="S4.SS1.SSS2.p4.1" class="ltx_p">Obviously, this update process could diverge from the oracle proxies a lot, and it could become less and less accurate with more training steps. When diverged from the oracle ones, the obtained proxies will be harder to aggregate. We will detail on this in the following sections. We conclude the above analysis as a problem of softmax with missing classes:</p>
</div>
<div id="Thmproperty2" class="ltx_theorem ltx_theorem_property">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmproperty2.1.1.1" class="ltx_text ltx_font_bold">Property 2</span></span><span id="Thmproperty2.2.2" class="ltx_text ltx_font_bold"> </span>(Problem of Softmax with Missing Classes)<span id="Thmproperty2.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmproperty2.p1" class="ltx_para">
<p id="Thmproperty2.p1.4" class="ltx_p"><span id="Thmproperty2.p1.4.4" class="ltx_text ltx_font_italic">With missing class set <math id="Thmproperty2.p1.1.1.m1.1" class="ltx_Math" alttext="{\mathcal{M}}" display="inline"><semantics id="Thmproperty2.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Thmproperty2.p1.1.1.m1.1.1" xref="Thmproperty2.p1.1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="Thmproperty2.p1.1.1.m1.1b"><ci id="Thmproperty2.p1.1.1.m1.1.1.cmml" xref="Thmproperty2.p1.1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproperty2.p1.1.1.m1.1c">{\mathcal{M}}</annotation></semantics></math>, the softmax classification has following problems: (1) the proxies of missing classes, i.e., <math id="Thmproperty2.p1.2.2.m2.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}\}_{c\in{\mathcal{M}}}" display="inline"><semantics id="Thmproperty2.p1.2.2.m2.1a"><msub id="Thmproperty2.p1.2.2.m2.1.1" xref="Thmproperty2.p1.2.2.m2.1.1.cmml"><mrow id="Thmproperty2.p1.2.2.m2.1.1.1.1" xref="Thmproperty2.p1.2.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="Thmproperty2.p1.2.2.m2.1.1.1.1.2" xref="Thmproperty2.p1.2.2.m2.1.1.1.2.cmml">{</mo><msub id="Thmproperty2.p1.2.2.m2.1.1.1.1.1" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.2" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1.2.cmml">𝐰</mi><mi id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.3" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="Thmproperty2.p1.2.2.m2.1.1.1.1.3" xref="Thmproperty2.p1.2.2.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="Thmproperty2.p1.2.2.m2.1.1.3" xref="Thmproperty2.p1.2.2.m2.1.1.3.cmml"><mi id="Thmproperty2.p1.2.2.m2.1.1.3.2" xref="Thmproperty2.p1.2.2.m2.1.1.3.2.cmml">c</mi><mo id="Thmproperty2.p1.2.2.m2.1.1.3.1" xref="Thmproperty2.p1.2.2.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Thmproperty2.p1.2.2.m2.1.1.3.3" xref="Thmproperty2.p1.2.2.m2.1.1.3.3.cmml">ℳ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmproperty2.p1.2.2.m2.1b"><apply id="Thmproperty2.p1.2.2.m2.1.1.cmml" xref="Thmproperty2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmproperty2.p1.2.2.m2.1.1.2.cmml" xref="Thmproperty2.p1.2.2.m2.1.1">subscript</csymbol><set id="Thmproperty2.p1.2.2.m2.1.1.1.2.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.1.1"><apply id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1.2">𝐰</ci><ci id="Thmproperty2.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="Thmproperty2.p1.2.2.m2.1.1.3.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.3"><in id="Thmproperty2.p1.2.2.m2.1.1.3.1.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.3.1"></in><ci id="Thmproperty2.p1.2.2.m2.1.1.3.2.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.3.2">𝑐</ci><ci id="Thmproperty2.p1.2.2.m2.1.1.3.3.cmml" xref="Thmproperty2.p1.2.2.m2.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproperty2.p1.2.2.m2.1c">\{{\mathbf{w}}_{c}\}_{c\in{\mathcal{M}}}</annotation></semantics></math>, are only pushed away from negative features, becoming more and more inaccurate; (2) the proxies of observed classes, i.e., <math id="Thmproperty2.p1.3.3.m3.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}\}_{c\in{\mathcal{O}}}" display="inline"><semantics id="Thmproperty2.p1.3.3.m3.1a"><msub id="Thmproperty2.p1.3.3.m3.1.1" xref="Thmproperty2.p1.3.3.m3.1.1.cmml"><mrow id="Thmproperty2.p1.3.3.m3.1.1.1.1" xref="Thmproperty2.p1.3.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="Thmproperty2.p1.3.3.m3.1.1.1.1.2" xref="Thmproperty2.p1.3.3.m3.1.1.1.2.cmml">{</mo><msub id="Thmproperty2.p1.3.3.m3.1.1.1.1.1" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.2" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1.2.cmml">𝐰</mi><mi id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.3" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="Thmproperty2.p1.3.3.m3.1.1.1.1.3" xref="Thmproperty2.p1.3.3.m3.1.1.1.2.cmml">}</mo></mrow><mrow id="Thmproperty2.p1.3.3.m3.1.1.3" xref="Thmproperty2.p1.3.3.m3.1.1.3.cmml"><mi id="Thmproperty2.p1.3.3.m3.1.1.3.2" xref="Thmproperty2.p1.3.3.m3.1.1.3.2.cmml">c</mi><mo id="Thmproperty2.p1.3.3.m3.1.1.3.1" xref="Thmproperty2.p1.3.3.m3.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Thmproperty2.p1.3.3.m3.1.1.3.3" xref="Thmproperty2.p1.3.3.m3.1.1.3.3.cmml">𝒪</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmproperty2.p1.3.3.m3.1b"><apply id="Thmproperty2.p1.3.3.m3.1.1.cmml" xref="Thmproperty2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmproperty2.p1.3.3.m3.1.1.2.cmml" xref="Thmproperty2.p1.3.3.m3.1.1">subscript</csymbol><set id="Thmproperty2.p1.3.3.m3.1.1.1.2.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.1.1"><apply id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1.2">𝐰</ci><ci id="Thmproperty2.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="Thmproperty2.p1.3.3.m3.1.1.3.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.3"><in id="Thmproperty2.p1.3.3.m3.1.1.3.1.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.3.1"></in><ci id="Thmproperty2.p1.3.3.m3.1.1.3.2.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.3.2">𝑐</ci><ci id="Thmproperty2.p1.3.3.m3.1.1.3.3.cmml" xref="Thmproperty2.p1.3.3.m3.1.1.3.3">𝒪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproperty2.p1.3.3.m3.1c">\{{\mathbf{w}}_{c}\}_{c\in{\mathcal{O}}}</annotation></semantics></math>, are only pushed away from <math id="Thmproperty2.p1.4.4.m4.1" class="ltx_Math" alttext="|{\mathcal{O}}|-1" display="inline"><semantics id="Thmproperty2.p1.4.4.m4.1a"><mrow id="Thmproperty2.p1.4.4.m4.1.2" xref="Thmproperty2.p1.4.4.m4.1.2.cmml"><mrow id="Thmproperty2.p1.4.4.m4.1.2.2.2" xref="Thmproperty2.p1.4.4.m4.1.2.2.1.cmml"><mo stretchy="false" id="Thmproperty2.p1.4.4.m4.1.2.2.2.1" xref="Thmproperty2.p1.4.4.m4.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Thmproperty2.p1.4.4.m4.1.1" xref="Thmproperty2.p1.4.4.m4.1.1.cmml">𝒪</mi><mo stretchy="false" id="Thmproperty2.p1.4.4.m4.1.2.2.2.2" xref="Thmproperty2.p1.4.4.m4.1.2.2.1.1.cmml">|</mo></mrow><mo id="Thmproperty2.p1.4.4.m4.1.2.1" xref="Thmproperty2.p1.4.4.m4.1.2.1.cmml">−</mo><mn id="Thmproperty2.p1.4.4.m4.1.2.3" xref="Thmproperty2.p1.4.4.m4.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmproperty2.p1.4.4.m4.1b"><apply id="Thmproperty2.p1.4.4.m4.1.2.cmml" xref="Thmproperty2.p1.4.4.m4.1.2"><minus id="Thmproperty2.p1.4.4.m4.1.2.1.cmml" xref="Thmproperty2.p1.4.4.m4.1.2.1"></minus><apply id="Thmproperty2.p1.4.4.m4.1.2.2.1.cmml" xref="Thmproperty2.p1.4.4.m4.1.2.2.2"><abs id="Thmproperty2.p1.4.4.m4.1.2.2.1.1.cmml" xref="Thmproperty2.p1.4.4.m4.1.2.2.2.1"></abs><ci id="Thmproperty2.p1.4.4.m4.1.1.cmml" xref="Thmproperty2.p1.4.4.m4.1.1">𝒪</ci></apply><cn type="integer" id="Thmproperty2.p1.4.4.m4.1.2.3.cmml" xref="Thmproperty2.p1.4.4.m4.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproperty2.p1.4.4.m4.1c">|{\mathcal{O}}|-1</annotation></semantics></math> negative feature regions.</span></p>
</div>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Restricted Softmax</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.13" class="ltx_p">As introduced in Sect. <a href="#S3.SS1" title="3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> and Sect. <a href="#S3.SS2" title="3.2 FL Scene with Incomplete Classes ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, the selected clients will update the downloaded global model for multiple local epochs. The downloaded global model contains the full set of proxies <math id="S4.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}\}_{c=1}^{C}" display="inline"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><msubsup id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1">subscript</csymbol><set id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2">𝐰</ci><ci id="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3"><eq id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.1"></eq><ci id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.SS1.SSS3.p1.1.m1.1.1.1.3.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">\{{\mathbf{w}}_{c}\}_{c=1}^{C}</annotation></semantics></math>, while the <math id="S4.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><mi id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><ci id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">k</annotation></semantics></math>-th client only observes a partial set (i.e., <math id="S4.SS1.SSS3.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{O}}^{k}" display="inline"><semantics id="S4.SS1.SSS3.p1.3.m3.1a"><msup id="S4.SS1.SSS3.p1.3.m3.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml">𝒪</mi><mi id="S4.SS1.SSS3.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.3.m3.1b"><apply id="S4.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.2">𝒪</ci><ci id="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.3.m3.1c">{\mathcal{O}}^{k}</annotation></semantics></math>) of the whole class set. This local training procedure with missing classes could cause several problems listed in Property <a href="#Thmproperty2" title="Property 2 (Problem of Softmax with Missing Classes). ‣ 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. That is, the missing classes’ proxies will become inaccurate, making the models hard to aggregate. As illustrated in the upload stage in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the server aims to build a 5-class classification model while the two clients only observe 3 and 2 classes respectively. After the <math id="S4.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.SSS3.p1.4.m4.1a"><mi id="S4.SS1.SSS3.p1.4.m4.1.1" xref="S4.SS1.SSS3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.4.m4.1b"><ci id="S4.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.4.m4.1c">t</annotation></semantics></math>-th personalization procedure, proxies <math id="S4.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="{\mathbf{w}}_{4}" display="inline"><semantics id="S4.SS1.SSS3.p1.5.m5.1a"><msub id="S4.SS1.SSS3.p1.5.m5.1.1" xref="S4.SS1.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p1.5.m5.1.1.2" xref="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.5.m5.1.1.3" xref="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.5.m5.1b"><apply id="S4.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.5.m5.1c">{\mathbf{w}}_{4}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.6.m6.1" class="ltx_Math" alttext="{\mathbf{w}}_{5}" display="inline"><semantics id="S4.SS1.SSS3.p1.6.m6.1a"><msub id="S4.SS1.SSS3.p1.6.m6.1.1" xref="S4.SS1.SSS3.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS3.p1.6.m6.1.1.2" xref="S4.SS1.SSS3.p1.6.m6.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.6.m6.1.1.3" xref="S4.SS1.SSS3.p1.6.m6.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.6.m6.1b"><apply id="S4.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.6.m6.1c">{\mathbf{w}}_{5}</annotation></semantics></math> on client A, and <math id="S4.SS1.SSS3.p1.7.m7.1" class="ltx_Math" alttext="{\mathbf{w}}_{1}" display="inline"><semantics id="S4.SS1.SSS3.p1.7.m7.1a"><msub id="S4.SS1.SSS3.p1.7.m7.1.1" xref="S4.SS1.SSS3.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS3.p1.7.m7.1.1.2" xref="S4.SS1.SSS3.p1.7.m7.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.7.m7.1.1.3" xref="S4.SS1.SSS3.p1.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.7.m7.1b"><apply id="S4.SS1.SSS3.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.7.m7.1c">{\mathbf{w}}_{1}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.8.m8.1" class="ltx_Math" alttext="{\mathbf{w}}_{2}" display="inline"><semantics id="S4.SS1.SSS3.p1.8.m8.1a"><msub id="S4.SS1.SSS3.p1.8.m8.1.1" xref="S4.SS1.SSS3.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS3.p1.8.m8.1.1.2" xref="S4.SS1.SSS3.p1.8.m8.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.8.m8.1.1.3" xref="S4.SS1.SSS3.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.8.m8.1b"><apply id="S4.SS1.SSS3.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS3.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS3.p1.8.m8.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS3.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.8.m8.1c">{\mathbf{w}}_{2}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.9.m9.1" class="ltx_Math" alttext="{\mathbf{w}}_{3}" display="inline"><semantics id="S4.SS1.SSS3.p1.9.m9.1a"><msub id="S4.SS1.SSS3.p1.9.m9.1.1" xref="S4.SS1.SSS3.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS3.p1.9.m9.1.1.2" xref="S4.SS1.SSS3.p1.9.m9.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.9.m9.1.1.3" xref="S4.SS1.SSS3.p1.9.m9.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.9.m9.1b"><apply id="S4.SS1.SSS3.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.9.m9.1c">{\mathbf{w}}_{3}</annotation></semantics></math> on client B could become inaccurate, leading to a poor aggregation on the server, e.g., proxies <math id="S4.SS1.SSS3.p1.10.m10.1" class="ltx_Math" alttext="{\mathbf{w}}_{2}" display="inline"><semantics id="S4.SS1.SSS3.p1.10.m10.1a"><msub id="S4.SS1.SSS3.p1.10.m10.1.1" xref="S4.SS1.SSS3.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS3.p1.10.m10.1.1.2" xref="S4.SS1.SSS3.p1.10.m10.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.10.m10.1.1.3" xref="S4.SS1.SSS3.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.10.m10.1b"><apply id="S4.SS1.SSS3.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.10.m10.1c">{\mathbf{w}}_{2}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.11.m11.1" class="ltx_Math" alttext="{\mathbf{w}}_{3}" display="inline"><semantics id="S4.SS1.SSS3.p1.11.m11.1a"><msub id="S4.SS1.SSS3.p1.11.m11.1.1" xref="S4.SS1.SSS3.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS3.p1.11.m11.1.1.2" xref="S4.SS1.SSS3.p1.11.m11.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.11.m11.1.1.3" xref="S4.SS1.SSS3.p1.11.m11.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.11.m11.1b"><apply id="S4.SS1.SSS3.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.11.m11.1c">{\mathbf{w}}_{3}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.12.m12.1" class="ltx_Math" alttext="{\mathbf{w}}_{4}" display="inline"><semantics id="S4.SS1.SSS3.p1.12.m12.1a"><msub id="S4.SS1.SSS3.p1.12.m12.1.1" xref="S4.SS1.SSS3.p1.12.m12.1.1.cmml"><mi id="S4.SS1.SSS3.p1.12.m12.1.1.2" xref="S4.SS1.SSS3.p1.12.m12.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.12.m12.1.1.3" xref="S4.SS1.SSS3.p1.12.m12.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.12.m12.1b"><apply id="S4.SS1.SSS3.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.12.m12.1.1.1.cmml" xref="S4.SS1.SSS3.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.12.m12.1.1.2.cmml" xref="S4.SS1.SSS3.p1.12.m12.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.12.m12.1.1.3.cmml" xref="S4.SS1.SSS3.p1.12.m12.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.12.m12.1c">{\mathbf{w}}_{4}</annotation></semantics></math>, <math id="S4.SS1.SSS3.p1.13.m13.1" class="ltx_Math" alttext="{\mathbf{w}}_{5}" display="inline"><semantics id="S4.SS1.SSS3.p1.13.m13.1a"><msub id="S4.SS1.SSS3.p1.13.m13.1.1" xref="S4.SS1.SSS3.p1.13.m13.1.1.cmml"><mi id="S4.SS1.SSS3.p1.13.m13.1.1.2" xref="S4.SS1.SSS3.p1.13.m13.1.1.2.cmml">𝐰</mi><mn id="S4.SS1.SSS3.p1.13.m13.1.1.3" xref="S4.SS1.SSS3.p1.13.m13.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.13.m13.1b"><apply id="S4.SS1.SSS3.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.2">𝐰</ci><cn type="integer" id="S4.SS1.SSS3.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.13.m13.1c">{\mathbf{w}}_{5}</annotation></semantics></math> diverge from their feature regions a lot. FL algorithms usually need amounts of communication rounds to converge. Hence, the error accumulation will become more serious, leading to an unstable training process and poor aggregation performances.</p>
</div>
<div id="S4.SS1.SSS3.p2" class="ltx_para">
<p id="S4.SS1.SSS3.p2.1" class="ltx_p">To solve the problems caused by softmax, we advocate that the update of missing classes’ proxies, i.e., <math id="S4.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\{{\mathbf{w}}_{c}^{k}\}_{c\in{\mathcal{M}}^{k}}" display="inline"><semantics id="S4.SS1.SSS3.p2.1.m1.1a"><msub id="S4.SS1.SSS3.p2.1.m1.1.1" xref="S4.SS1.SSS3.p2.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS3.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.2" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3.cmml">c</mi><mi id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS3.p2.1.m1.1.1.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p2.1.m1.1.1.3.2" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.SS1.SSS3.p2.1.m1.1.1.3.1" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.1.cmml">∈</mo><msup id="S4.SS1.SSS3.p2.1.m1.1.1.3.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.2" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3.2.cmml">ℳ</mi><mi id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.3" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3.3.cmml">k</mi></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p2.1.m1.1b"><apply id="S4.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1">subscript</csymbol><set id="S4.SS1.SSS3.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1"><apply id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2">𝐰</ci><ci id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS1.SSS3.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3"><in id="S4.SS1.SSS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.1"></in><ci id="S4.SS1.SSS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.2">𝑐</ci><apply id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3.2">ℳ</ci><ci id="S4.SS1.SSS3.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.SSS3.p2.1.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p2.1.m1.1c">\{{\mathbf{w}}_{c}^{k}\}_{c\in{\mathcal{M}}^{k}}</annotation></semantics></math>, should be restricted. An easy way to implement this is adding “scaling factors” to softmax operation, i.e.,</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.5" class="ltx_Math" alttext="p^{k}_{i,c}=\exp(\alpha^{k}_{c}{{\mathbf{w}}^{k}_{c}}^{T}{\mathbf{h}}^{k}_{i})/\sum_{j=1}^{C}\exp(\alpha^{k}_{j}{{\mathbf{w}}^{k}_{j}}^{T}{\mathbf{h}}^{k}_{i})," display="block"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5.1" xref="S4.E8.m1.5.5.1.1.cmml"><mrow id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml"><msubsup id="S4.E8.m1.5.5.1.1.4" xref="S4.E8.m1.5.5.1.1.4.cmml"><mi id="S4.E8.m1.5.5.1.1.4.2.2" xref="S4.E8.m1.5.5.1.1.4.2.2.cmml">p</mi><mrow id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">i</mi><mo id="S4.E8.m1.2.2.2.4.1" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mi id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">c</mi></mrow><mi id="S4.E8.m1.5.5.1.1.4.2.3" xref="S4.E8.m1.5.5.1.1.4.2.3.cmml">k</mi></msubsup><mo id="S4.E8.m1.5.5.1.1.3" xref="S4.E8.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E8.m1.5.5.1.1.2" xref="S4.E8.m1.5.5.1.1.2.cmml"><mrow id="S4.E8.m1.5.5.1.1.1.1.1" xref="S4.E8.m1.5.5.1.1.1.1.2.cmml"><mi id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">exp</mi><mo id="S4.E8.m1.5.5.1.1.1.1.1a" xref="S4.E8.m1.5.5.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E8.m1.5.5.1.1.1.1.1.1" xref="S4.E8.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.1.1.1.1.2.cmml">(</mo><mrow id="S4.E8.m1.5.5.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">α</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">c</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.1.cmml">​</mo><mmultiscripts id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.2" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.3.cmml">c</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.3.cmml">k</mi><mrow id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3a" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml"></mrow><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.1a" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.2" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml">𝐡</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.3.cmml">i</mi><mi id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.3" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="S4.E8.m1.5.5.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S4.E8.m1.5.5.1.1.2.3" xref="S4.E8.m1.5.5.1.1.2.3.cmml">/</mo><mrow id="S4.E8.m1.5.5.1.1.2.2" xref="S4.E8.m1.5.5.1.1.2.2.cmml"><munderover id="S4.E8.m1.5.5.1.1.2.2.2" xref="S4.E8.m1.5.5.1.1.2.2.2.cmml"><mo movablelimits="false" id="S4.E8.m1.5.5.1.1.2.2.2.2.2" xref="S4.E8.m1.5.5.1.1.2.2.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.5.5.1.1.2.2.2.2.3" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.cmml"><mi id="S4.E8.m1.5.5.1.1.2.2.2.2.3.2" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.2.cmml">j</mi><mo id="S4.E8.m1.5.5.1.1.2.2.2.2.3.1" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.5.5.1.1.2.2.2.2.3.3" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.5.5.1.1.2.2.2.3" xref="S4.E8.m1.5.5.1.1.2.2.2.3.cmml">C</mi></munderover><mrow id="S4.E8.m1.5.5.1.1.2.2.1.1" xref="S4.E8.m1.5.5.1.1.2.2.1.2.cmml"><mi id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml">exp</mi><mo id="S4.E8.m1.5.5.1.1.2.2.1.1a" xref="S4.E8.m1.5.5.1.1.2.2.1.2.cmml">⁡</mo><mrow id="S4.E8.m1.5.5.1.1.2.2.1.1.1" xref="S4.E8.m1.5.5.1.1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.2" xref="S4.E8.m1.5.5.1.1.2.2.1.2.cmml">(</mo><mrow id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.cmml"><msubsup id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.cmml"><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.2" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.2.cmml">α</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.3.cmml">j</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">​</mo><mmultiscripts id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.cmml"><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.2" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.3.cmml">j</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.3.cmml">k</mi><mrow id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3a" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.cmml"></mrow><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1a" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">​</mo><msubsup id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.cmml"><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.2" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.2.cmml">𝐡</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.3.cmml">i</mi><mi id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.3" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.3" xref="S4.E8.m1.5.5.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.5.5.1.2" xref="S4.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1"><eq id="S4.E8.m1.5.5.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.3"></eq><apply id="S4.E8.m1.5.5.1.1.4.cmml" xref="S4.E8.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.4.1.cmml" xref="S4.E8.m1.5.5.1.1.4">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.4.2.cmml" xref="S4.E8.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.4.2.1.cmml" xref="S4.E8.m1.5.5.1.1.4">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.4.2.2.cmml" xref="S4.E8.m1.5.5.1.1.4.2.2">𝑝</ci><ci id="S4.E8.m1.5.5.1.1.4.2.3.cmml" xref="S4.E8.m1.5.5.1.1.4.2.3">𝑘</ci></apply><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.4"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝑖</ci><ci id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2">𝑐</ci></list></apply><apply id="S4.E8.m1.5.5.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2"><divide id="S4.E8.m1.5.5.1.1.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.3"></divide><apply id="S4.E8.m1.5.5.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1"><exp id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"></exp><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1"><times id="S4.E8.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.1"></times><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.2">𝛼</ci><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.2">𝐰</ci><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.2">𝐡</ci><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E8.m1.5.5.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.5.5.1.1.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2"><apply id="S4.E8.m1.5.5.1.1.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2">superscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2">subscript</csymbol><sum id="S4.E8.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.2.2"></sum><apply id="S4.E8.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3"><eq id="S4.E8.m1.5.5.1.1.2.2.2.2.3.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.1"></eq><ci id="S4.E8.m1.5.5.1.1.2.2.2.2.3.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E8.m1.5.5.1.1.2.2.2.2.3.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2.3">𝐶</ci></apply><apply id="S4.E8.m1.5.5.1.1.2.2.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1"><exp id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.4"></exp><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1"><times id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.1"></times><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.2">𝛼</ci><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.2.3">𝑗</ci></apply><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.2">𝐰</ci><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.3.3">𝑇</ci></apply><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.2">𝐡</ci><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">p^{k}_{i,c}=\exp(\alpha^{k}_{c}{{\mathbf{w}}^{k}_{c}}^{T}{\mathbf{h}}^{k}_{i})/\sum_{j=1}^{C}\exp(\alpha^{k}_{j}{{\mathbf{w}}^{k}_{j}}^{T}{\mathbf{h}}^{k}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS3.p2.5" class="ltx_p">which is denoted as “restricted softmax” (RS). We set <math id="S4.SS1.SSS3.p2.2.m1.2" class="ltx_Math" alttext="\alpha_{c}^{k}={\mathcal{I}}\{c\in{\mathcal{O}}^{k}\}+\alpha{\mathcal{I}}\{c\in{\mathcal{M}}^{k}\}" display="inline"><semantics id="S4.SS1.SSS3.p2.2.m1.2a"><mrow id="S4.SS1.SSS3.p2.2.m1.2.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.cmml"><msubsup id="S4.SS1.SSS3.p2.2.m1.2.2.4" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.cmml"><mi id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.2.2.cmml">α</mi><mi id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.2.3.cmml">c</mi><mi id="S4.SS1.SSS3.p2.2.m1.2.2.4.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.3.cmml">k</mi></msubsup><mo id="S4.SS1.SSS3.p2.2.m1.2.2.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS3.p2.2.m1.2.2.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.cmml"><mrow id="S4.SS1.SSS3.p2.2.m1.1.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.3" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.2" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.2.cmml">𝒪</mi><mi id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.SS1.SSS3.p2.2.m1.2.2.2.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.3.cmml">+</mo><mrow id="S4.SS1.SSS3.p2.2.m1.2.2.2.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.cmml"><mi id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.4" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.4.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2a" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.2.cmml">{</mo><mrow id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.2.cmml">c</mi><mo id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.1" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.2" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.2.cmml">ℳ</mi><mi id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.3" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p2.2.m1.2b"><apply id="S4.SS1.SSS3.p2.2.m1.2.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2"><eq id="S4.SS1.SSS3.p2.2.m1.2.2.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.3"></eq><apply id="S4.SS1.SSS3.p2.2.m1.2.2.4.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.2.m1.2.2.4.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4">superscript</csymbol><apply id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4">subscript</csymbol><ci id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.2.2">𝛼</ci><ci id="S4.SS1.SSS3.p2.2.m1.2.2.4.2.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS3.p2.2.m1.2.2.4.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.4.3">𝑘</ci></apply><apply id="S4.SS1.SSS3.p2.2.m1.2.2.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2"><plus id="S4.SS1.SSS3.p2.2.m1.2.2.2.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.3"></plus><apply id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1"><times id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.2"></times><ci id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.3">ℐ</ci><set id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1"><apply id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1"><in id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.1"></in><ci id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.2">𝑐</ci><apply id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.2">𝒪</ci><ci id="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></set></apply><apply id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2"><times id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.2"></times><ci id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.3">𝛼</ci><ci id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.4.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.4">ℐ</ci><set id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1"><apply id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1"><in id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.1"></in><ci id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.2">𝑐</ci><apply id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.2">ℳ</ci><ci id="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.SSS3.p2.2.m1.2.2.2.2.1.1.1.3.3">𝑘</ci></apply></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p2.2.m1.2c">\alpha_{c}^{k}={\mathcal{I}}\{c\in{\mathcal{O}}^{k}\}+\alpha{\mathcal{I}}\{c\in{\mathcal{M}}^{k}\}</annotation></semantics></math>, where <math id="S4.SS1.SSS3.p2.3.m2.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S4.SS1.SSS3.p2.3.m2.2a"><mrow id="S4.SS1.SSS3.p2.3.m2.2.3" xref="S4.SS1.SSS3.p2.3.m2.2.3.cmml"><mi id="S4.SS1.SSS3.p2.3.m2.2.3.2" xref="S4.SS1.SSS3.p2.3.m2.2.3.2.cmml">α</mi><mo id="S4.SS1.SSS3.p2.3.m2.2.3.1" xref="S4.SS1.SSS3.p2.3.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS1.SSS3.p2.3.m2.2.3.3.2" xref="S4.SS1.SSS3.p2.3.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p2.3.m2.2.3.3.2.1" xref="S4.SS1.SSS3.p2.3.m2.2.3.3.1.cmml">[</mo><mn id="S4.SS1.SSS3.p2.3.m2.1.1" xref="S4.SS1.SSS3.p2.3.m2.1.1.cmml">0</mn><mo id="S4.SS1.SSS3.p2.3.m2.2.3.3.2.2" xref="S4.SS1.SSS3.p2.3.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.SSS3.p2.3.m2.2.2" xref="S4.SS1.SSS3.p2.3.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS3.p2.3.m2.2.3.3.2.3" xref="S4.SS1.SSS3.p2.3.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p2.3.m2.2b"><apply id="S4.SS1.SSS3.p2.3.m2.2.3.cmml" xref="S4.SS1.SSS3.p2.3.m2.2.3"><in id="S4.SS1.SSS3.p2.3.m2.2.3.1.cmml" xref="S4.SS1.SSS3.p2.3.m2.2.3.1"></in><ci id="S4.SS1.SSS3.p2.3.m2.2.3.2.cmml" xref="S4.SS1.SSS3.p2.3.m2.2.3.2">𝛼</ci><interval closure="closed" id="S4.SS1.SSS3.p2.3.m2.2.3.3.1.cmml" xref="S4.SS1.SSS3.p2.3.m2.2.3.3.2"><cn type="integer" id="S4.SS1.SSS3.p2.3.m2.1.1.cmml" xref="S4.SS1.SSS3.p2.3.m2.1.1">0</cn><cn type="integer" id="S4.SS1.SSS3.p2.3.m2.2.2.cmml" xref="S4.SS1.SSS3.p2.3.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p2.3.m2.2c">\alpha\in[0,1]</annotation></semantics></math> is the only hyper-parameter. This is an asymmetric scaling way that works normally with <math id="S4.SS1.SSS3.p2.4.m3.1" class="ltx_Math" alttext="\alpha_{c}^{k}=1" display="inline"><semantics id="S4.SS1.SSS3.p2.4.m3.1a"><mrow id="S4.SS1.SSS3.p2.4.m3.1.1" xref="S4.SS1.SSS3.p2.4.m3.1.1.cmml"><msubsup id="S4.SS1.SSS3.p2.4.m3.1.1.2" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.cmml"><mi id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.2" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.2.2.cmml">α</mi><mi id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.3" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.2.3.cmml">c</mi><mi id="S4.SS1.SSS3.p2.4.m3.1.1.2.3" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.SSS3.p2.4.m3.1.1.1" xref="S4.SS1.SSS3.p2.4.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p2.4.m3.1.1.3" xref="S4.SS1.SSS3.p2.4.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p2.4.m3.1b"><apply id="S4.SS1.SSS3.p2.4.m3.1.1.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1"><eq id="S4.SS1.SSS3.p2.4.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.1"></eq><apply id="S4.SS1.SSS3.p2.4.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.4.m3.1.1.2.1.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.1.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.2.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.2.2">𝛼</ci><ci id="S4.SS1.SSS3.p2.4.m3.1.1.2.2.3.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS3.p2.4.m3.1.1.2.3.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS1.SSS3.p2.4.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p2.4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p2.4.m3.1c">\alpha_{c}^{k}=1</annotation></semantics></math> for observed classes while working as a decaying method with <math id="S4.SS1.SSS3.p2.5.m4.1" class="ltx_Math" alttext="\alpha_{c}^{k}=\alpha" display="inline"><semantics id="S4.SS1.SSS3.p2.5.m4.1a"><mrow id="S4.SS1.SSS3.p2.5.m4.1.1" xref="S4.SS1.SSS3.p2.5.m4.1.1.cmml"><msubsup id="S4.SS1.SSS3.p2.5.m4.1.1.2" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.cmml"><mi id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.2" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.2.2.cmml">α</mi><mi id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.3" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.2.3.cmml">c</mi><mi id="S4.SS1.SSS3.p2.5.m4.1.1.2.3" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS1.SSS3.p2.5.m4.1.1.1" xref="S4.SS1.SSS3.p2.5.m4.1.1.1.cmml">=</mo><mi id="S4.SS1.SSS3.p2.5.m4.1.1.3" xref="S4.SS1.SSS3.p2.5.m4.1.1.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p2.5.m4.1b"><apply id="S4.SS1.SSS3.p2.5.m4.1.1.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1"><eq id="S4.SS1.SSS3.p2.5.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.1"></eq><apply id="S4.SS1.SSS3.p2.5.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.5.m4.1.1.2.1.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.1.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.2.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.2.2">𝛼</ci><ci id="S4.SS1.SSS3.p2.5.m4.1.1.2.2.3.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.2.3">𝑐</ci></apply><ci id="S4.SS1.SSS3.p2.5.m4.1.1.2.3.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.SSS3.p2.5.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p2.5.m4.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p2.5.m4.1c">\alpha_{c}^{k}=\alpha</annotation></semantics></math> for missing classes. Although it is a simple modification, we in-depth analyze the brought advantages from several aspects.</p>
</div>
<div id="S4.SS1.SSS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.SSS3.p3.1" class="ltx_p"><span id="S4.SS1.SSS3.p3.1.1" class="ltx_text ltx_font_bold">Restricting update of missing classes’ proxies.</span>
Similar to Eq. <a href="#S4.E6" title="In 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we can obtain the gradient update of <math id="S4.SS1.SSS3.p3.1.m1.1" class="ltx_Math" alttext="{\mathbf{w}}^{k}_{c}" display="inline"><semantics id="S4.SS1.SSS3.p3.1.m1.1a"><msubsup id="S4.SS1.SSS3.p3.1.m1.1.1" xref="S4.SS1.SSS3.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p3.1.m1.1.1.2.2" xref="S4.SS1.SSS3.p3.1.m1.1.1.2.2.cmml">𝐰</mi><mi id="S4.SS1.SSS3.p3.1.m1.1.1.3" xref="S4.SS1.SSS3.p3.1.m1.1.1.3.cmml">c</mi><mi id="S4.SS1.SSS3.p3.1.m1.1.1.2.3" xref="S4.SS1.SSS3.p3.1.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.1.m1.1b"><apply id="S4.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.SSS3.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.2.2">𝐰</ci><ci id="S4.SS1.SSS3.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.SSS3.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.1.m1.1c">{\mathbf{w}}^{k}_{c}</annotation></semantics></math> under “RS”:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.3" class="ltx_Math" alttext="{\mathbf{w}}^{k}_{c}={\mathbf{w}}^{k}_{c}\underbrace{-\alpha\eta\sum_{i=1}^{N_{k}}p^{k}_{i,c}{\mathbf{h}}^{k}_{i}}_{\text{restricted}}," display="block"><semantics id="S4.E9.m1.3a"><mrow id="S4.E9.m1.3.3.1" xref="S4.E9.m1.3.3.1.1.cmml"><mrow id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml"><msubsup id="S4.E9.m1.3.3.1.1.2" xref="S4.E9.m1.3.3.1.1.2.cmml"><mi id="S4.E9.m1.3.3.1.1.2.2.2" xref="S4.E9.m1.3.3.1.1.2.2.2.cmml">𝐰</mi><mi id="S4.E9.m1.3.3.1.1.2.3" xref="S4.E9.m1.3.3.1.1.2.3.cmml">c</mi><mi id="S4.E9.m1.3.3.1.1.2.2.3" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.E9.m1.3.3.1.1.1" xref="S4.E9.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.3.3.1.1.3" xref="S4.E9.m1.3.3.1.1.3.cmml"><msubsup id="S4.E9.m1.3.3.1.1.3.2" xref="S4.E9.m1.3.3.1.1.3.2.cmml"><mi id="S4.E9.m1.3.3.1.1.3.2.2.2" xref="S4.E9.m1.3.3.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S4.E9.m1.3.3.1.1.3.2.3" xref="S4.E9.m1.3.3.1.1.3.2.3.cmml">c</mi><mi id="S4.E9.m1.3.3.1.1.3.2.2.3" xref="S4.E9.m1.3.3.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.1.1.3.1" xref="S4.E9.m1.3.3.1.1.3.1.cmml">​</mo><munder id="S4.E9.m1.3.3.1.1.3.3" xref="S4.E9.m1.3.3.1.1.3.3.cmml"><munder accentunder="true" id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml"><mrow id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml"><mo id="S4.E9.m1.2.2.2a" xref="S4.E9.m1.2.2.2.cmml">−</mo><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.4.cmml"><mi id="S4.E9.m1.2.2.2.4.2" xref="S4.E9.m1.2.2.2.4.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.4.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.4.3" xref="S4.E9.m1.2.2.2.4.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.4.1a" xref="S4.E9.m1.2.2.2.4.1.cmml">​</mo><mrow id="S4.E9.m1.2.2.2.4.4" xref="S4.E9.m1.2.2.2.4.4.cmml"><munderover id="S4.E9.m1.2.2.2.4.4.1" xref="S4.E9.m1.2.2.2.4.4.1.cmml"><mo movablelimits="false" id="S4.E9.m1.2.2.2.4.4.1.2.2" xref="S4.E9.m1.2.2.2.4.4.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.2.4.4.1.2.3" xref="S4.E9.m1.2.2.2.4.4.1.2.3.cmml"><mi id="S4.E9.m1.2.2.2.4.4.1.2.3.2" xref="S4.E9.m1.2.2.2.4.4.1.2.3.2.cmml">i</mi><mo id="S4.E9.m1.2.2.2.4.4.1.2.3.1" xref="S4.E9.m1.2.2.2.4.4.1.2.3.1.cmml">=</mo><mn id="S4.E9.m1.2.2.2.4.4.1.2.3.3" xref="S4.E9.m1.2.2.2.4.4.1.2.3.3.cmml">1</mn></mrow><msub id="S4.E9.m1.2.2.2.4.4.1.3" xref="S4.E9.m1.2.2.2.4.4.1.3.cmml"><mi id="S4.E9.m1.2.2.2.4.4.1.3.2" xref="S4.E9.m1.2.2.2.4.4.1.3.2.cmml">N</mi><mi id="S4.E9.m1.2.2.2.4.4.1.3.3" xref="S4.E9.m1.2.2.2.4.4.1.3.3.cmml">k</mi></msub></munderover><mrow id="S4.E9.m1.2.2.2.4.4.2" xref="S4.E9.m1.2.2.2.4.4.2.cmml"><msubsup id="S4.E9.m1.2.2.2.4.4.2.2" xref="S4.E9.m1.2.2.2.4.4.2.2.cmml"><mi id="S4.E9.m1.2.2.2.4.4.2.2.2.2" xref="S4.E9.m1.2.2.2.4.4.2.2.2.2.cmml">p</mi><mrow id="S4.E9.m1.2.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.E9.m1.2.2.2.2.2.4.1" xref="S4.E9.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.cmml">c</mi></mrow><mi id="S4.E9.m1.2.2.2.4.4.2.2.2.3" xref="S4.E9.m1.2.2.2.4.4.2.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.4.4.2.1" xref="S4.E9.m1.2.2.2.4.4.2.1.cmml">​</mo><msubsup id="S4.E9.m1.2.2.2.4.4.2.3" xref="S4.E9.m1.2.2.2.4.4.2.3.cmml"><mi id="S4.E9.m1.2.2.2.4.4.2.3.2.2" xref="S4.E9.m1.2.2.2.4.4.2.3.2.2.cmml">𝐡</mi><mi id="S4.E9.m1.2.2.2.4.4.2.3.3" xref="S4.E9.m1.2.2.2.4.4.2.3.3.cmml">i</mi><mi id="S4.E9.m1.2.2.2.4.4.2.3.2.3" xref="S4.E9.m1.2.2.2.4.4.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.2.2.3" xref="S4.E9.m1.2.2.3.cmml">⏟</mo></munder><mtext id="S4.E9.m1.3.3.1.1.3.3.2" xref="S4.E9.m1.3.3.1.1.3.3.2a.cmml">restricted</mtext></munder></mrow></mrow><mo id="S4.E9.m1.3.3.1.2" xref="S4.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.3b"><apply id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1"><eq id="S4.E9.m1.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1"></eq><apply id="S4.E9.m1.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2">subscript</csymbol><apply id="S4.E9.m1.3.3.1.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2">superscript</csymbol><ci id="S4.E9.m1.3.3.1.1.2.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2">𝐰</ci><ci id="S4.E9.m1.3.3.1.1.2.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.3">𝑘</ci></apply><ci id="S4.E9.m1.3.3.1.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.3">𝑐</ci></apply><apply id="S4.E9.m1.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.3"><times id="S4.E9.m1.3.3.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.3.1"></times><apply id="S4.E9.m1.3.3.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.3.2.1.cmml" xref="S4.E9.m1.3.3.1.1.3.2">subscript</csymbol><apply id="S4.E9.m1.3.3.1.1.3.2.2.cmml" xref="S4.E9.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E9.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S4.E9.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E9.m1.3.3.1.1.3.2.2.2">𝐰</ci><ci id="S4.E9.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E9.m1.3.3.1.1.3.2.2.3">𝑘</ci></apply><ci id="S4.E9.m1.3.3.1.1.3.2.3.cmml" xref="S4.E9.m1.3.3.1.1.3.2.3">𝑐</ci></apply><apply id="S4.E9.m1.3.3.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.3.3.1.cmml" xref="S4.E9.m1.3.3.1.1.3.3">subscript</csymbol><apply id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2"><ci id="S4.E9.m1.2.2.3.cmml" xref="S4.E9.m1.2.2.3">⏟</ci><apply id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"><minus id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2"></minus><apply id="S4.E9.m1.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.4"><times id="S4.E9.m1.2.2.2.4.1.cmml" xref="S4.E9.m1.2.2.2.4.1"></times><ci id="S4.E9.m1.2.2.2.4.2.cmml" xref="S4.E9.m1.2.2.2.4.2">𝛼</ci><ci id="S4.E9.m1.2.2.2.4.3.cmml" xref="S4.E9.m1.2.2.2.4.3">𝜂</ci><apply id="S4.E9.m1.2.2.2.4.4.cmml" xref="S4.E9.m1.2.2.2.4.4"><apply id="S4.E9.m1.2.2.2.4.4.1.cmml" xref="S4.E9.m1.2.2.2.4.4.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.1.1.cmml" xref="S4.E9.m1.2.2.2.4.4.1">superscript</csymbol><apply id="S4.E9.m1.2.2.2.4.4.1.2.cmml" xref="S4.E9.m1.2.2.2.4.4.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.1.2.1.cmml" xref="S4.E9.m1.2.2.2.4.4.1">subscript</csymbol><sum id="S4.E9.m1.2.2.2.4.4.1.2.2.cmml" xref="S4.E9.m1.2.2.2.4.4.1.2.2"></sum><apply id="S4.E9.m1.2.2.2.4.4.1.2.3.cmml" xref="S4.E9.m1.2.2.2.4.4.1.2.3"><eq id="S4.E9.m1.2.2.2.4.4.1.2.3.1.cmml" xref="S4.E9.m1.2.2.2.4.4.1.2.3.1"></eq><ci id="S4.E9.m1.2.2.2.4.4.1.2.3.2.cmml" xref="S4.E9.m1.2.2.2.4.4.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E9.m1.2.2.2.4.4.1.2.3.3.cmml" xref="S4.E9.m1.2.2.2.4.4.1.2.3.3">1</cn></apply></apply><apply id="S4.E9.m1.2.2.2.4.4.1.3.cmml" xref="S4.E9.m1.2.2.2.4.4.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.1.3.1.cmml" xref="S4.E9.m1.2.2.2.4.4.1.3">subscript</csymbol><ci id="S4.E9.m1.2.2.2.4.4.1.3.2.cmml" xref="S4.E9.m1.2.2.2.4.4.1.3.2">𝑁</ci><ci id="S4.E9.m1.2.2.2.4.4.1.3.3.cmml" xref="S4.E9.m1.2.2.2.4.4.1.3.3">𝑘</ci></apply></apply><apply id="S4.E9.m1.2.2.2.4.4.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2"><times id="S4.E9.m1.2.2.2.4.4.2.1.cmml" xref="S4.E9.m1.2.2.2.4.4.2.1"></times><apply id="S4.E9.m1.2.2.2.4.4.2.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.2.2.1.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2">subscript</csymbol><apply id="S4.E9.m1.2.2.2.4.4.2.2.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2">superscript</csymbol><ci id="S4.E9.m1.2.2.2.4.4.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2.2.2">𝑝</ci><ci id="S4.E9.m1.2.2.2.4.4.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.4.4.2.2.2.3">𝑘</ci></apply><list id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.4"><ci id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1">𝑖</ci><ci id="S4.E9.m1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2">𝑐</ci></list></apply><apply id="S4.E9.m1.2.2.2.4.4.2.3.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.2.3.1.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3">subscript</csymbol><apply id="S4.E9.m1.2.2.2.4.4.2.3.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.4.2.3.2.1.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3">superscript</csymbol><ci id="S4.E9.m1.2.2.2.4.4.2.3.2.2.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3.2.2">𝐡</ci><ci id="S4.E9.m1.2.2.2.4.4.2.3.2.3.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3.2.3">𝑘</ci></apply><ci id="S4.E9.m1.2.2.2.4.4.2.3.3.cmml" xref="S4.E9.m1.2.2.2.4.4.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><ci id="S4.E9.m1.3.3.1.1.3.3.2a.cmml" xref="S4.E9.m1.3.3.1.1.3.3.2"><mtext mathsize="70%" id="S4.E9.m1.3.3.1.1.3.3.2.cmml" xref="S4.E9.m1.3.3.1.1.3.3.2">restricted</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.3c">{\mathbf{w}}^{k}_{c}={\mathbf{w}}^{k}_{c}\underbrace{-\alpha\eta\sum_{i=1}^{N_{k}}p^{k}_{i,c}{\mathbf{h}}^{k}_{i}}_{\text{restricted}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS3.p3.4" class="ltx_p">where we can find that the pushing force is restricted with <math id="S4.SS1.SSS3.p3.2.m1.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S4.SS1.SSS3.p3.2.m1.2a"><mrow id="S4.SS1.SSS3.p3.2.m1.2.3" xref="S4.SS1.SSS3.p3.2.m1.2.3.cmml"><mi id="S4.SS1.SSS3.p3.2.m1.2.3.2" xref="S4.SS1.SSS3.p3.2.m1.2.3.2.cmml">α</mi><mo id="S4.SS1.SSS3.p3.2.m1.2.3.1" xref="S4.SS1.SSS3.p3.2.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS1.SSS3.p3.2.m1.2.3.3.2" xref="S4.SS1.SSS3.p3.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p3.2.m1.2.3.3.2.1" xref="S4.SS1.SSS3.p3.2.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS1.SSS3.p3.2.m1.1.1" xref="S4.SS1.SSS3.p3.2.m1.1.1.cmml">0</mn><mo id="S4.SS1.SSS3.p3.2.m1.2.3.3.2.2" xref="S4.SS1.SSS3.p3.2.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.SSS3.p3.2.m1.2.2" xref="S4.SS1.SSS3.p3.2.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS3.p3.2.m1.2.3.3.2.3" xref="S4.SS1.SSS3.p3.2.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.2.m1.2b"><apply id="S4.SS1.SSS3.p3.2.m1.2.3.cmml" xref="S4.SS1.SSS3.p3.2.m1.2.3"><in id="S4.SS1.SSS3.p3.2.m1.2.3.1.cmml" xref="S4.SS1.SSS3.p3.2.m1.2.3.1"></in><ci id="S4.SS1.SSS3.p3.2.m1.2.3.2.cmml" xref="S4.SS1.SSS3.p3.2.m1.2.3.2">𝛼</ci><interval closure="closed" id="S4.SS1.SSS3.p3.2.m1.2.3.3.1.cmml" xref="S4.SS1.SSS3.p3.2.m1.2.3.3.2"><cn type="integer" id="S4.SS1.SSS3.p3.2.m1.1.1.cmml" xref="S4.SS1.SSS3.p3.2.m1.1.1">0</cn><cn type="integer" id="S4.SS1.SSS3.p3.2.m1.2.2.cmml" xref="S4.SS1.SSS3.p3.2.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.2.m1.2c">\alpha\in[0,1]</annotation></semantics></math>. If we take <math id="S4.SS1.SSS3.p3.3.m2.1" class="ltx_Math" alttext="\alpha=0" display="inline"><semantics id="S4.SS1.SSS3.p3.3.m2.1a"><mrow id="S4.SS1.SSS3.p3.3.m2.1.1" xref="S4.SS1.SSS3.p3.3.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p3.3.m2.1.1.2" xref="S4.SS1.SSS3.p3.3.m2.1.1.2.cmml">α</mi><mo id="S4.SS1.SSS3.p3.3.m2.1.1.1" xref="S4.SS1.SSS3.p3.3.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p3.3.m2.1.1.3" xref="S4.SS1.SSS3.p3.3.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.3.m2.1b"><apply id="S4.SS1.SSS3.p3.3.m2.1.1.cmml" xref="S4.SS1.SSS3.p3.3.m2.1.1"><eq id="S4.SS1.SSS3.p3.3.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p3.3.m2.1.1.1"></eq><ci id="S4.SS1.SSS3.p3.3.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p3.3.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.SS1.SSS3.p3.3.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p3.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.3.m2.1c">\alpha=0</annotation></semantics></math>, it degenerates into fixed proxies (if we do not consider weight decay); if <math id="S4.SS1.SSS3.p3.4.m3.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.SS1.SSS3.p3.4.m3.1a"><mrow id="S4.SS1.SSS3.p3.4.m3.1.1" xref="S4.SS1.SSS3.p3.4.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p3.4.m3.1.1.2" xref="S4.SS1.SSS3.p3.4.m3.1.1.2.cmml">α</mi><mo id="S4.SS1.SSS3.p3.4.m3.1.1.1" xref="S4.SS1.SSS3.p3.4.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p3.4.m3.1.1.3" xref="S4.SS1.SSS3.p3.4.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.4.m3.1b"><apply id="S4.SS1.SSS3.p3.4.m3.1.1.cmml" xref="S4.SS1.SSS3.p3.4.m3.1.1"><eq id="S4.SS1.SSS3.p3.4.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p3.4.m3.1.1.1"></eq><ci id="S4.SS1.SSS3.p3.4.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p3.4.m3.1.1.2">𝛼</ci><cn type="integer" id="S4.SS1.SSS3.p3.4.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p3.4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.4.m3.1c">\alpha=1</annotation></semantics></math>, it is just normal softmax. Overall, the update speed of missing classes’ gradients is restricted. We use the “RS” during the local training procedure and aggregate the model as common FL algorithms, e.g., the simple parameter averaging in FedAvg.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2404.09232/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="214" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.2.1" class="ltx_text" style="font-size:90%;">Model aggregation and personalization challenges caused by incomplete classes.</span></figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">Inherited Private Model for Model Personalization</span>
</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Local Performance Degradation</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.17" class="ltx_p">As the most standard FL algorithm, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> aims to generate a single global model, which is hard to capture heterogeneous local distributions simultaneously. An empirical observation in FedAvg is that the newly downloaded global model could perform poorly on local data. As shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, at the beginning of the <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="(t+1)" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.1.m1.1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.SSS1.p1.1.m1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1"><plus id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1"></plus><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">(t+1)</annotation></semantics></math>-th personalization procedure, clients A and B first download the globally aggregated model (i.e., five proxies). Obviously, the downloaded proxies do not match the feature regions well, e.g., <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="{\mathbf{w}}_{2}" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><msub id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝐰</mi><mn id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2">𝐰</ci><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">{\mathbf{w}}_{2}</annotation></semantics></math> and <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="{\mathbf{w}}_{3}" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><msub id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p1.3.m3.1.1.2" xref="S4.SS2.SSS1.p1.3.m3.1.1.2.cmml">𝐰</mi><mn id="S4.SS2.SSS1.p1.3.m3.1.1.3" xref="S4.SS2.SSS1.p1.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><apply id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1.2">𝐰</ci><cn type="integer" id="S4.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">{\mathbf{w}}_{3}</annotation></semantics></math> deviate from the regions <math id="S4.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="{\mathbf{X}}_{2}" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><msub id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml">𝐗</mi><mn id="S4.SS2.SSS1.p1.4.m4.1.1.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><apply id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.2">𝐗</ci><cn type="integer" id="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">{\mathbf{X}}_{2}</annotation></semantics></math> and <math id="S4.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="{\mathbf{X}}_{3}" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><msub id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml">𝐗</mi><mn id="S4.SS2.SSS1.p1.5.m5.1.1.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><apply id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2">𝐗</ci><cn type="integer" id="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">{\mathbf{X}}_{3}</annotation></semantics></math> significantly on client A. The newly-downloaded proxies could perform worse than the personalized models during the <math id="S4.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mi id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><ci id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">t</annotation></semantics></math>-th personalization procedure. The loss curves in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> also disclose this phenomenon. Specifically, during the personalization stage of the <math id="S4.SS2.SSS1.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS1.p1.7.m7.1a"><mi id="S4.SS2.SSS1.p1.7.m7.1.1" xref="S4.SS2.SSS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.7.m7.1b"><ci id="S4.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.7.m7.1c">t</annotation></semantics></math>-th communication round, two clients first finetune the global model <math id="S4.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\psi_{t}" display="inline"><semantics id="S4.SS2.SSS1.p1.8.m8.1a"><msub id="S4.SS2.SSS1.p1.8.m8.1.1" xref="S4.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p1.8.m8.1.1.2" xref="S4.SS2.SSS1.p1.8.m8.1.1.2.cmml">ψ</mi><mi id="S4.SS2.SSS1.p1.8.m8.1.1.3" xref="S4.SS2.SSS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.8.m8.1b"><apply id="S4.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1.2">𝜓</ci><ci id="S4.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.8.m8.1c">\psi_{t}</annotation></semantics></math> according to their own data distributions and obtain personalized models <math id="S4.SS2.SSS1.p1.9.m9.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{A}}" display="inline"><semantics id="S4.SS2.SSS1.p1.9.m9.1a"><msubsup id="S4.SS2.SSS1.p1.9.m9.1.1" xref="S4.SS2.SSS1.p1.9.m9.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.9.m9.1.1.2.2" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.9.m9.1.1.2.2.2" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.9.m9.1.1.2.2.1" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.9.m9.1.1.2.3" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.9.m9.1.1.3" xref="S4.SS2.SSS1.p1.9.m9.1.1.3a.cmml">A</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.9.m9.1b"><apply id="S4.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.9.m9.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.9.m9.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2"><ci id="S4.SS2.SSS1.p1.9.m9.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.9.m9.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.9.m9.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.9.m9.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1.3">A</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.9.m9.1c">\hat{\psi}_{t}^{\text{A}}</annotation></semantics></math>, <math id="S4.SS2.SSS1.p1.10.m10.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{B}}" display="inline"><semantics id="S4.SS2.SSS1.p1.10.m10.1a"><msubsup id="S4.SS2.SSS1.p1.10.m10.1.1" xref="S4.SS2.SSS1.p1.10.m10.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.10.m10.1.1.2.2" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.10.m10.1.1.2.2.2" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.10.m10.1.1.2.2.1" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.10.m10.1.1.2.3" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.10.m10.1.1.3" xref="S4.SS2.SSS1.p1.10.m10.1.1.3a.cmml">B</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.10.m10.1b"><apply id="S4.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.10.m10.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.10.m10.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2"><ci id="S4.SS2.SSS1.p1.10.m10.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.10.m10.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.10.m10.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.10.m10.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S4.SS2.SSS1.p1.10.m10.1.1.3">B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.10.m10.1c">\hat{\psi}_{t}^{\text{B}}</annotation></semantics></math> respectively. During aggregation, the server collects the personalized models and takes a direct parameter averaging as <math id="S4.SS2.SSS1.p1.11.m11.1" class="ltx_Math" alttext="\psi_{t+1}\leftarrow(\hat{\psi}_{t}^{\text{A}}+\hat{\psi}_{t}^{\text{B}})/2" display="inline"><semantics id="S4.SS2.SSS1.p1.11.m11.1a"><mrow id="S4.SS2.SSS1.p1.11.m11.1.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.cmml"><msub id="S4.SS2.SSS1.p1.11.m11.1.1.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.11.m11.1.1.3.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.2.cmml">ψ</mi><mrow id="S4.SS2.SSS1.p1.11.m11.1.1.3.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.cmml"><mi id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.2.cmml">t</mi><mo id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.1.cmml">+</mo><mn id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS2.SSS1.p1.11.m11.1.1.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.2.cmml">←</mo><mrow id="S4.SS2.SSS1.p1.11.m11.1.1.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml"><msubsup id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3a.cmml">A</mtext></msubsup><mo id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.1" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3a.cmml">B</mtext></msubsup></mrow><mo stretchy="false" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS1.p1.11.m11.1.1.1.2" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.2.cmml">/</mo><mn id="S4.SS2.SSS1.p1.11.m11.1.1.1.3" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.11.m11.1b"><apply id="S4.SS2.SSS1.p1.11.m11.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1"><ci id="S4.SS2.SSS1.p1.11.m11.1.1.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.2">←</ci><apply id="S4.SS2.SSS1.p1.11.m11.1.1.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.11.m11.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p1.11.m11.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.2">𝜓</ci><apply id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3"><plus id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.1"></plus><ci id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS1.p1.11.m11.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.3.3.3">1</cn></apply></apply><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1"><divide id="S4.SS2.SSS1.p1.11.m11.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.2"></divide><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1"><plus id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.1"></plus><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2"><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3a.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.2.3">A</mtext></ci></apply><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2"><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3a.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.1.1.1.3.3">B</mtext></ci></apply></apply><cn type="integer" id="S4.SS2.SSS1.p1.11.m11.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.11.m11.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.11.m11.1c">\psi_{t+1}\leftarrow(\hat{\psi}_{t}^{\text{A}}+\hat{\psi}_{t}^{\text{B}})/2</annotation></semantics></math>. At the beginning of the next communication round, the aggregated model <math id="S4.SS2.SSS1.p1.12.m12.1" class="ltx_Math" alttext="\psi_{t+1}" display="inline"><semantics id="S4.SS2.SSS1.p1.12.m12.1a"><msub id="S4.SS2.SSS1.p1.12.m12.1.1" xref="S4.SS2.SSS1.p1.12.m12.1.1.cmml"><mi id="S4.SS2.SSS1.p1.12.m12.1.1.2" xref="S4.SS2.SSS1.p1.12.m12.1.1.2.cmml">ψ</mi><mrow id="S4.SS2.SSS1.p1.12.m12.1.1.3" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.12.m12.1.1.3.2" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS1.p1.12.m12.1.1.3.1" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.1.cmml">+</mo><mn id="S4.SS2.SSS1.p1.12.m12.1.1.3.3" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.12.m12.1b"><apply id="S4.SS2.SSS1.p1.12.m12.1.1.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.12.m12.1.1.1.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.12.m12.1.1.2.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1.2">𝜓</ci><apply id="S4.SS2.SSS1.p1.12.m12.1.1.3.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1.3"><plus id="S4.SS2.SSS1.p1.12.m12.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.1"></plus><ci id="S4.SS2.SSS1.p1.12.m12.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS1.p1.12.m12.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.12.m12.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.12.m12.1c">\psi_{t+1}</annotation></semantics></math> may perform worse than the last personalized models correspondingly, i.e., the local losses of <math id="S4.SS2.SSS1.p1.13.m13.1" class="ltx_Math" alttext="\psi_{t+1}" display="inline"><semantics id="S4.SS2.SSS1.p1.13.m13.1a"><msub id="S4.SS2.SSS1.p1.13.m13.1.1" xref="S4.SS2.SSS1.p1.13.m13.1.1.cmml"><mi id="S4.SS2.SSS1.p1.13.m13.1.1.2" xref="S4.SS2.SSS1.p1.13.m13.1.1.2.cmml">ψ</mi><mrow id="S4.SS2.SSS1.p1.13.m13.1.1.3" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m13.1.1.3.2" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS1.p1.13.m13.1.1.3.1" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.1.cmml">+</mo><mn id="S4.SS2.SSS1.p1.13.m13.1.1.3.3" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.13.m13.1b"><apply id="S4.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m13.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.13.m13.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1.2">𝜓</ci><apply id="S4.SS2.SSS1.p1.13.m13.1.1.3.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1.3"><plus id="S4.SS2.SSS1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.1"></plus><ci id="S4.SS2.SSS1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.13.m13.1c">\psi_{t+1}</annotation></semantics></math> are higher than <math id="S4.SS2.SSS1.p1.14.m14.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{A}}" display="inline"><semantics id="S4.SS2.SSS1.p1.14.m14.1a"><msubsup id="S4.SS2.SSS1.p1.14.m14.1.1" xref="S4.SS2.SSS1.p1.14.m14.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.14.m14.1.1.2.2" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.14.m14.1.1.2.2.2" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.14.m14.1.1.2.2.1" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.14.m14.1.1.2.3" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.14.m14.1.1.3" xref="S4.SS2.SSS1.p1.14.m14.1.1.3a.cmml">A</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.14.m14.1b"><apply id="S4.SS2.SSS1.p1.14.m14.1.1.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.14.m14.1.1.1.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.14.m14.1.1.2.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.14.m14.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.14.m14.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2"><ci id="S4.SS2.SSS1.p1.14.m14.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.14.m14.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.14.m14.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.14.m14.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.14.m14.1.1.3.cmml" xref="S4.SS2.SSS1.p1.14.m14.1.1.3">A</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.14.m14.1c">\hat{\psi}_{t}^{\text{A}}</annotation></semantics></math> and <math id="S4.SS2.SSS1.p1.15.m15.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{B}}" display="inline"><semantics id="S4.SS2.SSS1.p1.15.m15.1a"><msubsup id="S4.SS2.SSS1.p1.15.m15.1.1" xref="S4.SS2.SSS1.p1.15.m15.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.15.m15.1.1.2.2" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.15.m15.1.1.2.2.2" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.15.m15.1.1.2.2.1" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.15.m15.1.1.2.3" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.15.m15.1.1.3" xref="S4.SS2.SSS1.p1.15.m15.1.1.3a.cmml">B</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.15.m15.1b"><apply id="S4.SS2.SSS1.p1.15.m15.1.1.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.15.m15.1.1.1.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.15.m15.1.1.2.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.15.m15.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.15.m15.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2"><ci id="S4.SS2.SSS1.p1.15.m15.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.15.m15.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.15.m15.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.15.m15.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.15.m15.1.1.3.cmml" xref="S4.SS2.SSS1.p1.15.m15.1.1.3">B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.15.m15.1c">\hat{\psi}_{t}^{\text{B}}</annotation></semantics></math>. This phenomenon is named local performance degradation, and it happens once receiving the newly downloaded model from the server. A fundamental problem here is that the hard-won personalized models are directly overwritten by the newly downloaded global model (i.e., <math id="S4.SS2.SSS1.p1.16.m16.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{A}}" display="inline"><semantics id="S4.SS2.SSS1.p1.16.m16.1a"><msubsup id="S4.SS2.SSS1.p1.16.m16.1.1" xref="S4.SS2.SSS1.p1.16.m16.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.16.m16.1.1.2.2" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.16.m16.1.1.2.2.2" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.16.m16.1.1.2.2.1" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.16.m16.1.1.2.3" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.16.m16.1.1.3" xref="S4.SS2.SSS1.p1.16.m16.1.1.3a.cmml">A</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.16.m16.1b"><apply id="S4.SS2.SSS1.p1.16.m16.1.1.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.16.m16.1.1.1.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.16.m16.1.1.2.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.16.m16.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.16.m16.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2"><ci id="S4.SS2.SSS1.p1.16.m16.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.16.m16.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.16.m16.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.16.m16.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.16.m16.1.1.3.cmml" xref="S4.SS2.SSS1.p1.16.m16.1.1.3">A</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.16.m16.1c">\hat{\psi}_{t}^{\text{A}}</annotation></semantics></math>, <math id="S4.SS2.SSS1.p1.17.m17.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{\text{B}}" display="inline"><semantics id="S4.SS2.SSS1.p1.17.m17.1a"><msubsup id="S4.SS2.SSS1.p1.17.m17.1.1" xref="S4.SS2.SSS1.p1.17.m17.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.17.m17.1.1.2.2" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.17.m17.1.1.2.2.2" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS1.p1.17.m17.1.1.2.2.1" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS1.p1.17.m17.1.1.2.3" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.3.cmml">t</mi><mtext id="S4.SS2.SSS1.p1.17.m17.1.1.3" xref="S4.SS2.SSS1.p1.17.m17.1.1.3a.cmml">B</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.17.m17.1b"><apply id="S4.SS2.SSS1.p1.17.m17.1.1.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.17.m17.1.1.1.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.17.m17.1.1.2.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.17.m17.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.17.m17.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2"><ci id="S4.SS2.SSS1.p1.17.m17.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS1.p1.17.m17.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS1.p1.17.m17.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS1.p1.17.m17.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.17.m17.1.1.3.cmml" xref="S4.SS2.SSS1.p1.17.m17.1.1.3">B</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.17.m17.1c">\hat{\psi}_{t}^{\text{B}}</annotation></semantics></math> are not stored for better exploitation), and the clients have to personalize the global model from scratch in a new round.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Inherited Private Model</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.7" class="ltx_p">To solve the local performance degradation problem, we propose a novel concept named “inherited private model” (HPM) to keep the moving average of historical personalized models in each client and utilize it to supervise the newly downloaded model in the next round. Specifically, we use <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\psi_{\text{p}}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msubsup id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml">ψ</mi><mtext id="S4.SS2.SSS2.p1.1.m1.1.1.2.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.3a.cmml">p</mtext><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.3a.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.3">p</mtext></ci></apply><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">\psi_{\text{p}}^{k}</annotation></semantics></math> to denote the “HPM” of the <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><mi id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">k</annotation></semantics></math>-th client. At the beginning of the <math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">t</annotation></semantics></math>-th personalization procedure, the <math id="S4.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><mi id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><ci id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">k</annotation></semantics></math>-th client downloads the global model: <math id="S4.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\psi_{t}^{k}\leftarrow\psi_{t}" display="inline"><semantics id="S4.SS2.SSS2.p1.5.m5.1a"><mrow id="S4.SS2.SSS2.p1.5.m5.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.5.m5.1.1.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.5.m5.1.1.2.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS2.SSS2.p1.5.m5.1.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.1.cmml">←</mo><msub id="S4.SS2.SSS2.p1.5.m5.1.1.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.1.1.3.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p1.5.m5.1.1.3.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m5.1b"><apply id="S4.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1"><ci id="S4.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.1">←</ci><apply id="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p1.5.m5.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.2">𝜓</ci><ci id="S4.SS2.SSS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m5.1c">\psi_{t}^{k}\leftarrow\psi_{t}</annotation></semantics></math> and obtain the personalized model <math id="S4.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.6.m6.1a"><msubsup id="S4.SS2.SSS2.p1.6.m6.1.1" xref="S4.SS2.SSS2.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.6.m6.1.1.2.2" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2.cmml"><mi id="S4.SS2.SSS2.p1.6.m6.1.1.2.2.2" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS2.p1.6.m6.1.1.2.2.1" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS2.p1.6.m6.1.1.2.3" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.6.m6.1.1.3" xref="S4.SS2.SSS2.p1.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.6.m6.1b"><apply id="S4.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m6.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p1.6.m6.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2"><ci id="S4.SS2.SSS2.p1.6.m6.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS2.p1.6.m6.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS2.p1.6.m6.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.6.m6.1c">\hat{\psi}_{t}^{k}</annotation></semantics></math>. The specific personalization process will be introduced later. At the end, we update <math id="S4.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\psi_{\text{p}}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.7.m7.1a"><msubsup id="S4.SS2.SSS2.p1.7.m7.1.1" xref="S4.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p1.7.m7.1.1.2.2" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.2.cmml">ψ</mi><mtext id="S4.SS2.SSS2.p1.7.m7.1.1.2.3" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.3a.cmml">p</mtext><mi id="S4.SS2.SSS2.p1.7.m7.1.1.3" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.7.m7.1b"><apply id="S4.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.m7.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.m7.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p1.7.m7.1.1.2.3a.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p1.7.m7.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.3">p</mtext></ci></apply><ci id="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.7.m7.1c">\psi_{\text{p}}^{k}</annotation></semantics></math> via:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.5" class="ltx_Math" alttext="\psi_{\text{p},t+1}^{k}\leftarrow(1-\mu_{t}^{k})\hat{\psi}_{t}^{k}+\mu_{t}^{k}\psi_{\text{p},t}^{k}," display="block"><semantics id="S4.E10.m1.5a"><mrow id="S4.E10.m1.5.5.1" xref="S4.E10.m1.5.5.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml"><msubsup id="S4.E10.m1.5.5.1.1.3" xref="S4.E10.m1.5.5.1.1.3.cmml"><mi id="S4.E10.m1.5.5.1.1.3.2.2" xref="S4.E10.m1.5.5.1.1.3.2.2.cmml">ψ</mi><mrow id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.3.cmml"><mtext id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1a.cmml">p</mtext><mo id="S4.E10.m1.2.2.2.2.2" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E10.m1.2.2.2.2.1" xref="S4.E10.m1.2.2.2.2.1.cmml"><mi id="S4.E10.m1.2.2.2.2.1.2" xref="S4.E10.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S4.E10.m1.2.2.2.2.1.1" xref="S4.E10.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E10.m1.2.2.2.2.1.3" xref="S4.E10.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S4.E10.m1.5.5.1.1.3.3" xref="S4.E10.m1.5.5.1.1.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E10.m1.5.5.1.1.2" xref="S4.E10.m1.5.5.1.1.2.cmml">←</mo><mrow id="S4.E10.m1.5.5.1.1.1" xref="S4.E10.m1.5.5.1.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.5.5.1.1.1.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.5.5.1.1.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml"><mn id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E10.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="S4.E10.m1.5.5.1.1.1.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.1.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E10.m1.5.5.1.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.5.5.1.1.1.1.3.2.2" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2.cmml"><mi id="S4.E10.m1.5.5.1.1.1.1.3.2.2.2" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2.2.cmml">ψ</mi><mo id="S4.E10.m1.5.5.1.1.1.1.3.2.2.1" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.5.5.1.1.1.1.3.2.3" xref="S4.E10.m1.5.5.1.1.1.1.3.2.3.cmml">t</mi><mi id="S4.E10.m1.5.5.1.1.1.1.3.3" xref="S4.E10.m1.5.5.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E10.m1.5.5.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.2.cmml">+</mo><mrow id="S4.E10.m1.5.5.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.3.cmml"><msubsup id="S4.E10.m1.5.5.1.1.1.3.2" xref="S4.E10.m1.5.5.1.1.1.3.2.cmml"><mi id="S4.E10.m1.5.5.1.1.1.3.2.2.2" xref="S4.E10.m1.5.5.1.1.1.3.2.2.2.cmml">μ</mi><mi id="S4.E10.m1.5.5.1.1.1.3.2.2.3" xref="S4.E10.m1.5.5.1.1.1.3.2.2.3.cmml">t</mi><mi id="S4.E10.m1.5.5.1.1.1.3.2.3" xref="S4.E10.m1.5.5.1.1.1.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.1.1.1.3.1" xref="S4.E10.m1.5.5.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E10.m1.5.5.1.1.1.3.3" xref="S4.E10.m1.5.5.1.1.1.3.3.cmml"><mi id="S4.E10.m1.5.5.1.1.1.3.3.2.2" xref="S4.E10.m1.5.5.1.1.1.3.3.2.2.cmml">ψ</mi><mrow id="S4.E10.m1.4.4.2.4" xref="S4.E10.m1.4.4.2.3.cmml"><mtext id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1a.cmml">p</mtext><mo id="S4.E10.m1.4.4.2.4.1" xref="S4.E10.m1.4.4.2.3.cmml">,</mo><mi id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml">t</mi></mrow><mi id="S4.E10.m1.5.5.1.1.1.3.3.3" xref="S4.E10.m1.5.5.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S4.E10.m1.5.5.1.2" xref="S4.E10.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.5b"><apply id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1"><ci id="S4.E10.m1.5.5.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.2">←</ci><apply id="S4.E10.m1.5.5.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.3">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.3.2.2">𝜓</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2"><ci id="S4.E10.m1.1.1.1.1a.cmml" xref="S4.E10.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">p</mtext></ci><apply id="S4.E10.m1.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.1"><plus id="S4.E10.m1.2.2.2.2.1.1.cmml" xref="S4.E10.m1.2.2.2.2.1.1"></plus><ci id="S4.E10.m1.2.2.2.2.1.2.cmml" xref="S4.E10.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E10.m1.2.2.2.2.1.3.cmml" xref="S4.E10.m1.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S4.E10.m1.5.5.1.1.3.3.cmml" xref="S4.E10.m1.5.5.1.1.3.3">𝑘</ci></apply><apply id="S4.E10.m1.5.5.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1"><plus id="S4.E10.m1.5.5.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.2"></plus><apply id="S4.E10.m1.5.5.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1"><times id="S4.E10.m1.5.5.1.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.2"></times><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1"><minus id="S4.E10.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.2">𝜇</ci><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S4.E10.m1.5.5.1.1.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3">subscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2"><ci id="S4.E10.m1.5.5.1.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2.1">^</ci><ci id="S4.E10.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3.2.2.2">𝜓</ci></apply><ci id="S4.E10.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E10.m1.5.5.1.1.1.1.3.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S4.E10.m1.5.5.1.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.1.3"><times id="S4.E10.m1.5.5.1.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.1.3.1"></times><apply id="S4.E10.m1.5.5.1.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.1.3.2.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2.2.2">𝜇</ci><ci id="S4.E10.m1.5.5.1.1.1.3.2.2.3.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S4.E10.m1.5.5.1.1.1.3.2.3.cmml" xref="S4.E10.m1.5.5.1.1.1.3.2.3">𝑘</ci></apply><apply id="S4.E10.m1.5.5.1.1.1.3.3.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.3.3.1.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.3.3.2.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.3.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.1.3.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3.2.2">𝜓</ci><list id="S4.E10.m1.4.4.2.3.cmml" xref="S4.E10.m1.4.4.2.4"><ci id="S4.E10.m1.3.3.1.1a.cmml" xref="S4.E10.m1.3.3.1.1"><mtext mathsize="70%" id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">p</mtext></ci><ci id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S4.E10.m1.5.5.1.1.1.3.3.3.cmml" xref="S4.E10.m1.5.5.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.5c">\psi_{\text{p},t+1}^{k}\leftarrow(1-\mu_{t}^{k})\hat{\psi}_{t}^{k}+\mu_{t}^{k}\psi_{\text{p},t}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p1.24" class="ltx_p">which keeps a moving average of historically personalized models. <math id="S4.SS2.SSS2.p1.8.m1.2" class="ltx_Math" alttext="\mu_{t}^{k}\in[0,1]" display="inline"><semantics id="S4.SS2.SSS2.p1.8.m1.2a"><mrow id="S4.SS2.SSS2.p1.8.m1.2.3" xref="S4.SS2.SSS2.p1.8.m1.2.3.cmml"><msubsup id="S4.SS2.SSS2.p1.8.m1.2.3.2" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.cmml"><mi id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.2" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.3" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.8.m1.2.3.2.3" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.8.m1.2.3.1" xref="S4.SS2.SSS2.p1.8.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.SSS2.p1.8.m1.2.3.3.2" xref="S4.SS2.SSS2.p1.8.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.8.m1.2.3.3.2.1" xref="S4.SS2.SSS2.p1.8.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS2.SSS2.p1.8.m1.1.1" xref="S4.SS2.SSS2.p1.8.m1.1.1.cmml">0</mn><mo id="S4.SS2.SSS2.p1.8.m1.2.3.3.2.2" xref="S4.SS2.SSS2.p1.8.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.8.m1.2.2" xref="S4.SS2.SSS2.p1.8.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.SSS2.p1.8.m1.2.3.3.2.3" xref="S4.SS2.SSS2.p1.8.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.8.m1.2b"><apply id="S4.SS2.SSS2.p1.8.m1.2.3.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3"><in id="S4.SS2.SSS2.p1.8.m1.2.3.1.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.1"></in><apply id="S4.SS2.SSS2.p1.8.m1.2.3.2.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.8.m1.2.3.2.1.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.1.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.2.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.8.m1.2.3.2.2.3.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.8.m1.2.3.2.3.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.2.3">𝑘</ci></apply><interval closure="closed" id="S4.SS2.SSS2.p1.8.m1.2.3.3.1.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.3.3.2"><cn type="integer" id="S4.SS2.SSS2.p1.8.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.8.m1.1.1">0</cn><cn type="integer" id="S4.SS2.SSS2.p1.8.m1.2.2.cmml" xref="S4.SS2.SSS2.p1.8.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.8.m1.2c">\mu_{t}^{k}\in[0,1]</annotation></semantics></math> is the momentum term for the <math id="S4.SS2.SSS2.p1.9.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS2.p1.9.m2.1a"><mi id="S4.SS2.SSS2.p1.9.m2.1.1" xref="S4.SS2.SSS2.p1.9.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.9.m2.1b"><ci id="S4.SS2.SSS2.p1.9.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.9.m2.1c">k</annotation></semantics></math>-th client. When <math id="S4.SS2.SSS2.p1.10.m3.1" class="ltx_Math" alttext="\mu_{t}^{k}=0" display="inline"><semantics id="S4.SS2.SSS2.p1.10.m3.1a"><mrow id="S4.SS2.SSS2.p1.10.m3.1.1" xref="S4.SS2.SSS2.p1.10.m3.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.10.m3.1.1.2" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.2" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.3" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.10.m3.1.1.2.3" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.10.m3.1.1.1" xref="S4.SS2.SSS2.p1.10.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.10.m3.1.1.3" xref="S4.SS2.SSS2.p1.10.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.10.m3.1b"><apply id="S4.SS2.SSS2.p1.10.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1"><eq id="S4.SS2.SSS2.p1.10.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.1"></eq><apply id="S4.SS2.SSS2.p1.10.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.10.m3.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.10.m3.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.10.m3.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS2.SSS2.p1.10.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p1.10.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.10.m3.1c">\mu_{t}^{k}=0</annotation></semantics></math>, the “HPM” only keeps the current personalized model; when <math id="S4.SS2.SSS2.p1.11.m4.1" class="ltx_Math" alttext="\mu_{t}^{k}=1" display="inline"><semantics id="S4.SS2.SSS2.p1.11.m4.1a"><mrow id="S4.SS2.SSS2.p1.11.m4.1.1" xref="S4.SS2.SSS2.p1.11.m4.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.11.m4.1.1.2" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.2" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.3" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.11.m4.1.1.2.3" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.11.m4.1.1.1" xref="S4.SS2.SSS2.p1.11.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.11.m4.1.1.3" xref="S4.SS2.SSS2.p1.11.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.11.m4.1b"><apply id="S4.SS2.SSS2.p1.11.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1"><eq id="S4.SS2.SSS2.p1.11.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.1"></eq><apply id="S4.SS2.SSS2.p1.11.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.11.m4.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.11.m4.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.11.m4.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS2.SSS2.p1.11.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p1.11.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.11.m4.1c">\mu_{t}^{k}=1</annotation></semantics></math>, the “HPM” degenerates into an independent private model. Because only a fraction of clients is selected in each round, the update frequency and learning speed of clients are slightly distinct. Hence, the momentum should be client-specific and dynamically adjusted. We assign a counter <math id="S4.SS2.SSS2.p1.12.m5.1" class="ltx_Math" alttext="z_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.12.m5.1a"><msubsup id="S4.SS2.SSS2.p1.12.m5.1.1" xref="S4.SS2.SSS2.p1.12.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p1.12.m5.1.1.2.2" xref="S4.SS2.SSS2.p1.12.m5.1.1.2.2.cmml">z</mi><mi id="S4.SS2.SSS2.p1.12.m5.1.1.2.3" xref="S4.SS2.SSS2.p1.12.m5.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.12.m5.1.1.3" xref="S4.SS2.SSS2.p1.12.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.12.m5.1b"><apply id="S4.SS2.SSS2.p1.12.m5.1.1.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.12.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.12.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.12.m5.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.12.m5.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1.2.2">𝑧</ci><ci id="S4.SS2.SSS2.p1.12.m5.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.12.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p1.12.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.12.m5.1c">z_{t}^{k}</annotation></semantics></math> as the number of times that the <math id="S4.SS2.SSS2.p1.13.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS2.p1.13.m6.1a"><mi id="S4.SS2.SSS2.p1.13.m6.1.1" xref="S4.SS2.SSS2.p1.13.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.13.m6.1b"><ci id="S4.SS2.SSS2.p1.13.m6.1.1.cmml" xref="S4.SS2.SSS2.p1.13.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.13.m6.1c">k</annotation></semantics></math>-th client has been selected. If <math id="S4.SS2.SSS2.p1.14.m7.1" class="ltx_Math" alttext="k\in{\mathcal{S}}_{t}" display="inline"><semantics id="S4.SS2.SSS2.p1.14.m7.1a"><mrow id="S4.SS2.SSS2.p1.14.m7.1.1" xref="S4.SS2.SSS2.p1.14.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p1.14.m7.1.1.2" xref="S4.SS2.SSS2.p1.14.m7.1.1.2.cmml">k</mi><mo id="S4.SS2.SSS2.p1.14.m7.1.1.1" xref="S4.SS2.SSS2.p1.14.m7.1.1.1.cmml">∈</mo><msub id="S4.SS2.SSS2.p1.14.m7.1.1.3" xref="S4.SS2.SSS2.p1.14.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.14.m7.1.1.3.2" xref="S4.SS2.SSS2.p1.14.m7.1.1.3.2.cmml">𝒮</mi><mi id="S4.SS2.SSS2.p1.14.m7.1.1.3.3" xref="S4.SS2.SSS2.p1.14.m7.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.14.m7.1b"><apply id="S4.SS2.SSS2.p1.14.m7.1.1.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1"><in id="S4.SS2.SSS2.p1.14.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.1"></in><ci id="S4.SS2.SSS2.p1.14.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.2">𝑘</ci><apply id="S4.SS2.SSS2.p1.14.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.14.m7.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.14.m7.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.3.2">𝒮</ci><ci id="S4.SS2.SSS2.p1.14.m7.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.14.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.14.m7.1c">k\in{\mathcal{S}}_{t}</annotation></semantics></math>, then <math id="S4.SS2.SSS2.p1.15.m8.1" class="ltx_Math" alttext="z_{t}^{k}=z_{t-1}^{k}+1" display="inline"><semantics id="S4.SS2.SSS2.p1.15.m8.1a"><mrow id="S4.SS2.SSS2.p1.15.m8.1.1" xref="S4.SS2.SSS2.p1.15.m8.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.15.m8.1.1.2" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.2" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.2.2.cmml">z</mi><mi id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.15.m8.1.1.2.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.15.m8.1.1.1" xref="S4.SS2.SSS2.p1.15.m8.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.15.m8.1.1.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.cmml"><msubsup id="S4.SS2.SSS2.p1.15.m8.1.1.3.2" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.cmml"><mi id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.2" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.2.cmml">z</mi><mrow id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.cmml"><mi id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.2" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.2.cmml">t</mi><mo id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.1" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.1.cmml">−</mo><mn id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.15.m8.1.1.3.1" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.1.cmml">+</mo><mn id="S4.SS2.SSS2.p1.15.m8.1.1.3.3" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.15.m8.1b"><apply id="S4.SS2.SSS2.p1.15.m8.1.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1"><eq id="S4.SS2.SSS2.p1.15.m8.1.1.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.1"></eq><apply id="S4.SS2.SSS2.p1.15.m8.1.1.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.15.m8.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.2.2">𝑧</ci><ci id="S4.SS2.SSS2.p1.15.m8.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.15.m8.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p1.15.m8.1.1.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3"><plus id="S4.SS2.SSS2.p1.15.m8.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.1"></plus><apply id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.2">𝑧</ci><apply id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3"><minus id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.1.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.1"></minus><ci id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.2.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p1.15.m8.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS2.SSS2.p1.15.m8.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.15.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.15.m8.1c">z_{t}^{k}=z_{t-1}^{k}+1</annotation></semantics></math>. Then we linearly set <math id="S4.SS2.SSS2.p1.16.m9.1" class="ltx_Math" alttext="\mu_{t}^{k}=\mu*z_{t}^{k}/(Q*T)" display="inline"><semantics id="S4.SS2.SSS2.p1.16.m9.1a"><mrow id="S4.SS2.SSS2.p1.16.m9.1.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.16.m9.1.1.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.16.m9.1.1.3.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p1.16.m9.1.1.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.2.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.16.m9.1.1.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p1.16.m9.1.1.1.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.1.cmml">∗</mo><msubsup id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.cmml"><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.2.cmml">z</mi><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS2.SSS2.p1.16.m9.1.1.1.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.2.cmml">/</mo><mrow id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.16.m9.1b"><apply id="S4.SS2.SSS2.p1.16.m9.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1"><eq id="S4.SS2.SSS2.p1.16.m9.1.1.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.2"></eq><apply id="S4.SS2.SSS2.p1.16.m9.1.1.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.16.m9.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.16.m9.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.16.m9.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p1.16.m9.1.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1"><divide id="S4.SS2.SSS2.p1.16.m9.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.2"></divide><apply id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3"><times id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.2">𝜇</ci><apply id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3">superscript</csymbol><apply id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.2">𝑧</ci><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1"><times id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.2">𝑄</ci><ci id="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.16.m9.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.16.m9.1c">\mu_{t}^{k}=\mu*z_{t}^{k}/(Q*T)</annotation></semantics></math>, where <math id="S4.SS2.SSS2.p1.17.m10.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.SSS2.p1.17.m10.1a"><mi id="S4.SS2.SSS2.p1.17.m10.1.1" xref="S4.SS2.SSS2.p1.17.m10.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.17.m10.1b"><ci id="S4.SS2.SSS2.p1.17.m10.1.1.cmml" xref="S4.SS2.SSS2.p1.17.m10.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.17.m10.1c">Q</annotation></semantics></math> is the client selection ratio, <math id="S4.SS2.SSS2.p1.18.m11.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS2.SSS2.p1.18.m11.1a"><mi id="S4.SS2.SSS2.p1.18.m11.1.1" xref="S4.SS2.SSS2.p1.18.m11.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.18.m11.1b"><ci id="S4.SS2.SSS2.p1.18.m11.1.1.cmml" xref="S4.SS2.SSS2.p1.18.m11.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.18.m11.1c">T</annotation></semantics></math> is the maximum number of global rounds, and <math id="S4.SS2.SSS2.p1.19.m12.1" class="ltx_Math" alttext="Q*T" display="inline"><semantics id="S4.SS2.SSS2.p1.19.m12.1a"><mrow id="S4.SS2.SSS2.p1.19.m12.1.1" xref="S4.SS2.SSS2.p1.19.m12.1.1.cmml"><mi id="S4.SS2.SSS2.p1.19.m12.1.1.2" xref="S4.SS2.SSS2.p1.19.m12.1.1.2.cmml">Q</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p1.19.m12.1.1.1" xref="S4.SS2.SSS2.p1.19.m12.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS2.p1.19.m12.1.1.3" xref="S4.SS2.SSS2.p1.19.m12.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.19.m12.1b"><apply id="S4.SS2.SSS2.p1.19.m12.1.1.cmml" xref="S4.SS2.SSS2.p1.19.m12.1.1"><times id="S4.SS2.SSS2.p1.19.m12.1.1.1.cmml" xref="S4.SS2.SSS2.p1.19.m12.1.1.1"></times><ci id="S4.SS2.SSS2.p1.19.m12.1.1.2.cmml" xref="S4.SS2.SSS2.p1.19.m12.1.1.2">𝑄</ci><ci id="S4.SS2.SSS2.p1.19.m12.1.1.3.cmml" xref="S4.SS2.SSS2.p1.19.m12.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.19.m12.1c">Q*T</annotation></semantics></math> denotes the expected times of being selected. <math id="S4.SS2.SSS2.p1.20.m13.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.SSS2.p1.20.m13.1a"><mi id="S4.SS2.SSS2.p1.20.m13.1.1" xref="S4.SS2.SSS2.p1.20.m13.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.20.m13.1b"><ci id="S4.SS2.SSS2.p1.20.m13.1.1.cmml" xref="S4.SS2.SSS2.p1.20.m13.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.20.m13.1c">\mu</annotation></semantics></math> is the macro momentum that controls the change of <math id="S4.SS2.SSS2.p1.21.m14.1" class="ltx_Math" alttext="\mu_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.21.m14.1a"><msubsup id="S4.SS2.SSS2.p1.21.m14.1.1" xref="S4.SS2.SSS2.p1.21.m14.1.1.cmml"><mi id="S4.SS2.SSS2.p1.21.m14.1.1.2.2" xref="S4.SS2.SSS2.p1.21.m14.1.1.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.21.m14.1.1.2.3" xref="S4.SS2.SSS2.p1.21.m14.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.21.m14.1.1.3" xref="S4.SS2.SSS2.p1.21.m14.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.21.m14.1b"><apply id="S4.SS2.SSS2.p1.21.m14.1.1.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.21.m14.1.1.1.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.21.m14.1.1.2.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.21.m14.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.21.m14.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.21.m14.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.21.m14.1.1.3.cmml" xref="S4.SS2.SSS2.p1.21.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.21.m14.1c">\mu_{t}^{k}</annotation></semantics></math>, and we take <math id="S4.SS2.SSS2.p1.22.m15.1" class="ltx_Math" alttext="\mu=0.9" display="inline"><semantics id="S4.SS2.SSS2.p1.22.m15.1a"><mrow id="S4.SS2.SSS2.p1.22.m15.1.1" xref="S4.SS2.SSS2.p1.22.m15.1.1.cmml"><mi id="S4.SS2.SSS2.p1.22.m15.1.1.2" xref="S4.SS2.SSS2.p1.22.m15.1.1.2.cmml">μ</mi><mo id="S4.SS2.SSS2.p1.22.m15.1.1.1" xref="S4.SS2.SSS2.p1.22.m15.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.22.m15.1.1.3" xref="S4.SS2.SSS2.p1.22.m15.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.22.m15.1b"><apply id="S4.SS2.SSS2.p1.22.m15.1.1.cmml" xref="S4.SS2.SSS2.p1.22.m15.1.1"><eq id="S4.SS2.SSS2.p1.22.m15.1.1.1.cmml" xref="S4.SS2.SSS2.p1.22.m15.1.1.1"></eq><ci id="S4.SS2.SSS2.p1.22.m15.1.1.2.cmml" xref="S4.SS2.SSS2.p1.22.m15.1.1.2">𝜇</ci><cn type="float" id="S4.SS2.SSS2.p1.22.m15.1.1.3.cmml" xref="S4.SS2.SSS2.p1.22.m15.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.22.m15.1c">\mu=0.9</annotation></semantics></math> in this paper by default. Finally, we limit <math id="S4.SS2.SSS2.p1.23.m16.1" class="ltx_Math" alttext="\mu_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p1.23.m16.1a"><msubsup id="S4.SS2.SSS2.p1.23.m16.1.1" xref="S4.SS2.SSS2.p1.23.m16.1.1.cmml"><mi id="S4.SS2.SSS2.p1.23.m16.1.1.2.2" xref="S4.SS2.SSS2.p1.23.m16.1.1.2.2.cmml">μ</mi><mi id="S4.SS2.SSS2.p1.23.m16.1.1.2.3" xref="S4.SS2.SSS2.p1.23.m16.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p1.23.m16.1.1.3" xref="S4.SS2.SSS2.p1.23.m16.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.23.m16.1b"><apply id="S4.SS2.SSS2.p1.23.m16.1.1.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.23.m16.1.1.1.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.23.m16.1.1.2.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.23.m16.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.23.m16.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1.2.2">𝜇</ci><ci id="S4.SS2.SSS2.p1.23.m16.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p1.23.m16.1.1.3.cmml" xref="S4.SS2.SSS2.p1.23.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.23.m16.1c">\mu_{t}^{k}</annotation></semantics></math> in a range of <math id="S4.SS2.SSS2.p1.24.m17.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS2.SSS2.p1.24.m17.2a"><mrow id="S4.SS2.SSS2.p1.24.m17.2.3.2" xref="S4.SS2.SSS2.p1.24.m17.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.24.m17.2.3.2.1" xref="S4.SS2.SSS2.p1.24.m17.2.3.1.cmml">[</mo><mn id="S4.SS2.SSS2.p1.24.m17.1.1" xref="S4.SS2.SSS2.p1.24.m17.1.1.cmml">0</mn><mo id="S4.SS2.SSS2.p1.24.m17.2.3.2.2" xref="S4.SS2.SSS2.p1.24.m17.2.3.1.cmml">,</mo><mn id="S4.SS2.SSS2.p1.24.m17.2.2" xref="S4.SS2.SSS2.p1.24.m17.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.SSS2.p1.24.m17.2.3.2.3" xref="S4.SS2.SSS2.p1.24.m17.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.24.m17.2b"><interval closure="closed" id="S4.SS2.SSS2.p1.24.m17.2.3.1.cmml" xref="S4.SS2.SSS2.p1.24.m17.2.3.2"><cn type="integer" id="S4.SS2.SSS2.p1.24.m17.1.1.cmml" xref="S4.SS2.SSS2.p1.24.m17.1.1">0</cn><cn type="integer" id="S4.SS2.SSS2.p1.24.m17.2.2.cmml" xref="S4.SS2.SSS2.p1.24.m17.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.24.m17.2c">[0,1]</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.10" class="ltx_p">Then, we exploit the “HPM” to supervise the personalization process of the newly downloaded model in the next communication round. In the first communication round of FL, we do not apply this process because we have not stored the “HPM”. We explore two specific forms of knowledge transfer. For a specific sample <math id="S4.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="{\mathbf{x}}_{i}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><msubsup id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><apply id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.2">𝐱</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">{\mathbf{x}}_{i}^{k}</annotation></semantics></math>, we denote the outputs of <math id="S4.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\psi_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><msubsup id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.1.1.2.2" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p2.2.m2.1.1.2.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p2.2.m2.1.1.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.1b"><apply id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.1c">\psi_{t}^{k}</annotation></semantics></math> and <math id="S4.SS2.SSS2.p2.3.m3.2" class="ltx_Math" alttext="\psi_{\text{p},t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p2.3.m3.2a"><msubsup id="S4.SS2.SSS2.p2.3.m3.2.3" xref="S4.SS2.SSS2.p2.3.m3.2.3.cmml"><mi id="S4.SS2.SSS2.p2.3.m3.2.3.2.2" xref="S4.SS2.SSS2.p2.3.m3.2.3.2.2.cmml">ψ</mi><mrow id="S4.SS2.SSS2.p2.3.m3.2.2.2.4" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml"><mtext id="S4.SS2.SSS2.p2.3.m3.1.1.1.1" xref="S4.SS2.SSS2.p2.3.m3.1.1.1.1a.cmml">p</mtext><mo id="S4.SS2.SSS2.p2.3.m3.2.2.2.4.1" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p2.3.m3.2.2.2.2" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.2.cmml">t</mi></mrow><mi id="S4.SS2.SSS2.p2.3.m3.2.3.3" xref="S4.SS2.SSS2.p2.3.m3.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m3.2b"><apply id="S4.SS2.SSS2.p2.3.m3.2.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.2.3.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3">superscript</csymbol><apply id="S4.SS2.SSS2.p2.3.m3.2.3.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.2.3.2.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.3.m3.2.3.2.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3.2.2">𝜓</ci><list id="S4.SS2.SSS2.p2.3.m3.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.4"><ci id="S4.SS2.SSS2.p2.3.m3.1.1.1.1a.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.1.1"><mtext mathsize="70%" id="S4.SS2.SSS2.p2.3.m3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.1.1">p</mtext></ci><ci id="S4.SS2.SSS2.p2.3.m3.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.2.2.2">𝑡</ci></list></apply><ci id="S4.SS2.SSS2.p2.3.m3.2.3.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m3.2c">\psi_{\text{p},t}^{k}</annotation></semantics></math> as <math id="S4.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="{\mathbf{g}}_{i}" display="inline"><semantics id="S4.SS2.SSS2.p2.4.m4.1a"><msub id="S4.SS2.SSS2.p2.4.m4.1.1" xref="S4.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p2.4.m4.1.1.2" xref="S4.SS2.SSS2.p2.4.m4.1.1.2.cmml">𝐠</mi><mi id="S4.SS2.SSS2.p2.4.m4.1.1.3" xref="S4.SS2.SSS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m4.1b"><apply id="S4.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1.2">𝐠</ci><ci id="S4.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m4.1c">{\mathbf{g}}_{i}</annotation></semantics></math> and <math id="S4.SS2.SSS2.p2.5.m5.2" class="ltx_Math" alttext="{\mathbf{g}}_{\text{p},i}" display="inline"><semantics id="S4.SS2.SSS2.p2.5.m5.2a"><msub id="S4.SS2.SSS2.p2.5.m5.2.3" xref="S4.SS2.SSS2.p2.5.m5.2.3.cmml"><mi id="S4.SS2.SSS2.p2.5.m5.2.3.2" xref="S4.SS2.SSS2.p2.5.m5.2.3.2.cmml">𝐠</mi><mrow id="S4.SS2.SSS2.p2.5.m5.2.2.2.4" xref="S4.SS2.SSS2.p2.5.m5.2.2.2.3.cmml"><mtext id="S4.SS2.SSS2.p2.5.m5.1.1.1.1" xref="S4.SS2.SSS2.p2.5.m5.1.1.1.1a.cmml">p</mtext><mo id="S4.SS2.SSS2.p2.5.m5.2.2.2.4.1" xref="S4.SS2.SSS2.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p2.5.m5.2.2.2.2" xref="S4.SS2.SSS2.p2.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.5.m5.2b"><apply id="S4.SS2.SSS2.p2.5.m5.2.3.cmml" xref="S4.SS2.SSS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.5.m5.2.3.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.5.m5.2.3.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.2.3.2">𝐠</ci><list id="S4.SS2.SSS2.p2.5.m5.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.5.m5.2.2.2.4"><ci id="S4.SS2.SSS2.p2.5.m5.1.1.1.1a.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.1.1.1"><mtext mathsize="70%" id="S4.SS2.SSS2.p2.5.m5.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.1.1.1">p</mtext></ci><ci id="S4.SS2.SSS2.p2.5.m5.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.5.m5.2c">{\mathbf{g}}_{\text{p},i}</annotation></semantics></math>, respectively; and their intermediate features as <math id="S4.SS2.SSS2.p2.6.m6.1" class="ltx_Math" alttext="{\mathbf{h}}_{i}" display="inline"><semantics id="S4.SS2.SSS2.p2.6.m6.1a"><msub id="S4.SS2.SSS2.p2.6.m6.1.1" xref="S4.SS2.SSS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.SSS2.p2.6.m6.1.1.2" xref="S4.SS2.SSS2.p2.6.m6.1.1.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p2.6.m6.1.1.3" xref="S4.SS2.SSS2.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.6.m6.1b"><apply id="S4.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1.2">𝐡</ci><ci id="S4.SS2.SSS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.6.m6.1c">{\mathbf{h}}_{i}</annotation></semantics></math> and <math id="S4.SS2.SSS2.p2.7.m7.2" class="ltx_Math" alttext="{\mathbf{h}}_{\text{p},i}" display="inline"><semantics id="S4.SS2.SSS2.p2.7.m7.2a"><msub id="S4.SS2.SSS2.p2.7.m7.2.3" xref="S4.SS2.SSS2.p2.7.m7.2.3.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.2.3.2" xref="S4.SS2.SSS2.p2.7.m7.2.3.2.cmml">𝐡</mi><mrow id="S4.SS2.SSS2.p2.7.m7.2.2.2.4" xref="S4.SS2.SSS2.p2.7.m7.2.2.2.3.cmml"><mtext id="S4.SS2.SSS2.p2.7.m7.1.1.1.1" xref="S4.SS2.SSS2.p2.7.m7.1.1.1.1a.cmml">p</mtext><mo id="S4.SS2.SSS2.p2.7.m7.2.2.2.4.1" xref="S4.SS2.SSS2.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p2.7.m7.2.2.2.2" xref="S4.SS2.SSS2.p2.7.m7.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.7.m7.2b"><apply id="S4.SS2.SSS2.p2.7.m7.2.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.7.m7.2.3.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.7.m7.2.3.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.3.2">𝐡</ci><list id="S4.SS2.SSS2.p2.7.m7.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.2.2.4"><ci id="S4.SS2.SSS2.p2.7.m7.1.1.1.1a.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1.1.1"><mtext mathsize="70%" id="S4.SS2.SSS2.p2.7.m7.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1.1.1">p</mtext></ci><ci id="S4.SS2.SSS2.p2.7.m7.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.7.m7.2c">{\mathbf{h}}_{\text{p},i}</annotation></semantics></math>, respectively. The outputs are “logits” without softmax, while the intermediate features are <math id="S4.SS2.SSS2.p2.8.m8.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS2.SSS2.p2.8.m8.1a"><mi id="S4.SS2.SSS2.p2.8.m8.1.1" xref="S4.SS2.SSS2.p2.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.8.m8.1b"><ci id="S4.SS2.SSS2.p2.8.m8.1.1.cmml" xref="S4.SS2.SSS2.p2.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.8.m8.1c">d</annotation></semantics></math>-dimension vectors extracted by the feature extractor. We omit the index of <math id="S4.SS2.SSS2.p2.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS2.p2.9.m9.1a"><mi id="S4.SS2.SSS2.p2.9.m9.1.1" xref="S4.SS2.SSS2.p2.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.9.m9.1b"><ci id="S4.SS2.SSS2.p2.9.m9.1.1.cmml" xref="S4.SS2.SSS2.p2.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.9.m9.1c">k</annotation></semantics></math> and <math id="S4.SS2.SSS2.p2.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS2.p2.10.m10.1a"><mi id="S4.SS2.SSS2.p2.10.m10.1.1" xref="S4.SS2.SSS2.p2.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.10.m10.1b"><ci id="S4.SS2.SSS2.p2.10.m10.1.1.cmml" xref="S4.SS2.SSS2.p2.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.10.m10.1c">t</annotation></semantics></math> for simplification.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2404.09232/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="204" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.2.1" class="ltx_text" style="font-size:90%;">The architecture and procedure of the proposed MAP.</span></figcaption>
</figure>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.16" class="ltx_p">First, we could transfer the knowledge contained in the outputs. The knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> could be utilized to enhance the information transfer via:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.2" class="ltx_math_unparsed" alttext="{\mathcal{L}}_{\text{kd}}\left(\psi_{t}^{k}\right)=\tau^{2}\frac{1}{B}\sum_{i=1}^{B}D_{KL}\left(\sigma({\mathbf{g}}_{\text{p},i}/\tau)||\sigma({\mathbf{g}}_{i}/\tau)\right)," display="block"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2b"><msub id="S4.E11.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.3.2">ℒ</mi><mtext id="S4.E11.m1.2.3.3">kd</mtext></msub><mrow id="S4.E11.m1.2.4"><mo id="S4.E11.m1.2.4.1">(</mo><msubsup id="S4.E11.m1.2.4.2"><mi id="S4.E11.m1.2.4.2.2.2">ψ</mi><mi id="S4.E11.m1.2.4.2.2.3">t</mi><mi id="S4.E11.m1.2.4.2.3">k</mi></msubsup><mo id="S4.E11.m1.2.4.3">)</mo></mrow><mo id="S4.E11.m1.2.5">=</mo><msup id="S4.E11.m1.2.6"><mi id="S4.E11.m1.2.6.2">τ</mi><mn id="S4.E11.m1.2.6.3">2</mn></msup><mfrac id="S4.E11.m1.2.7"><mn id="S4.E11.m1.2.7.2">1</mn><mi id="S4.E11.m1.2.7.3">B</mi></mfrac><munderover id="S4.E11.m1.2.8"><mo movablelimits="false" id="S4.E11.m1.2.8.2.2">∑</mo><mrow id="S4.E11.m1.2.8.2.3"><mi id="S4.E11.m1.2.8.2.3.2">i</mi><mo id="S4.E11.m1.2.8.2.3.1">=</mo><mn id="S4.E11.m1.2.8.2.3.3">1</mn></mrow><mi id="S4.E11.m1.2.8.3">B</mi></munderover><msub id="S4.E11.m1.2.9"><mi id="S4.E11.m1.2.9.2">D</mi><mrow id="S4.E11.m1.2.9.3"><mi id="S4.E11.m1.2.9.3.2">K</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.9.3.1">​</mo><mi id="S4.E11.m1.2.9.3.3">L</mi></mrow></msub><mrow id="S4.E11.m1.2.10"><mo id="S4.E11.m1.2.10.1">(</mo><mi id="S4.E11.m1.2.10.2">σ</mi><mrow id="S4.E11.m1.2.10.3"><mo stretchy="false" id="S4.E11.m1.2.10.3.1">(</mo><msub id="S4.E11.m1.2.10.3.2"><mi id="S4.E11.m1.2.10.3.2.2">𝐠</mi><mrow id="S4.E11.m1.2.2.2.4"><mtext id="S4.E11.m1.1.1.1.1">p</mtext><mo id="S4.E11.m1.2.2.2.4.1">,</mo><mi id="S4.E11.m1.2.2.2.2">i</mi></mrow></msub><mo id="S4.E11.m1.2.10.3.3">/</mo><mi id="S4.E11.m1.2.10.3.4">τ</mi><mo stretchy="false" id="S4.E11.m1.2.10.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E11.m1.2.10.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E11.m1.2.10.5">|</mo><mi id="S4.E11.m1.2.10.6">σ</mi><mrow id="S4.E11.m1.2.10.7"><mo stretchy="false" id="S4.E11.m1.2.10.7.1">(</mo><msub id="S4.E11.m1.2.10.7.2"><mi id="S4.E11.m1.2.10.7.2.2">𝐠</mi><mi id="S4.E11.m1.2.10.7.2.3">i</mi></msub><mo id="S4.E11.m1.2.10.7.3">/</mo><mi id="S4.E11.m1.2.10.7.4">τ</mi><mo stretchy="false" id="S4.E11.m1.2.10.7.5">)</mo></mrow><mo id="S4.E11.m1.2.10.8">)</mo></mrow><mo id="S4.E11.m1.2.11">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E11.m1.2c">{\mathcal{L}}_{\text{kd}}\left(\psi_{t}^{k}\right)=\tau^{2}\frac{1}{B}\sum_{i=1}^{B}D_{KL}\left(\sigma({\mathbf{g}}_{\text{p},i}/\tau)||\sigma({\mathbf{g}}_{i}/\tau)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p3.5" class="ltx_p">where <math id="S4.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="D_{KL}" display="inline"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><msub id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml">D</mi><mrow id="S4.SS2.SSS2.p3.1.m1.1.1.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.1.m1.1.1.3.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><apply id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2">𝐷</ci><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3"><times id="S4.SS2.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.1"></times><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2">𝐾</ci><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">D_{KL}</annotation></semantics></math> refers to the KL-divergence, <math id="S4.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S4.SS2.SSS2.p3.2.m2.1a"><mrow id="S4.SS2.SSS2.p3.2.m2.1.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml"><mi id="S4.SS2.SSS2.p3.2.m2.1.2.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.1.2.1" xref="S4.SS2.SSS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.2.m2.1.2.3.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.2.m2.1.2.3.2.1" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS2.p3.2.m2.1.2.3.2.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.1b"><apply id="S4.SS2.SSS2.p3.2.m2.1.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2"><times id="S4.SS2.SSS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.1"></times><ci id="S4.SS2.SSS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.2">𝜎</ci><ci id="S4.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.1c">\sigma(\cdot)</annotation></semantics></math> is the softmax operation, <math id="S4.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><mi id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><ci id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">B</annotation></semantics></math> denotes the batch size, and <math id="S4.SS2.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.SSS2.p3.4.m4.1a"><mi id="S4.SS2.SSS2.p3.4.m4.1.1" xref="S4.SS2.SSS2.p3.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m4.1b"><ci id="S4.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m4.1c">\tau</annotation></semantics></math> is the temperature. We fix <math id="S4.SS2.SSS2.p3.5.m5.1" class="ltx_Math" alttext="\tau=4.0" display="inline"><semantics id="S4.SS2.SSS2.p3.5.m5.1a"><mrow id="S4.SS2.SSS2.p3.5.m5.1.1" xref="S4.SS2.SSS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p3.5.m5.1.1.2" xref="S4.SS2.SSS2.p3.5.m5.1.1.2.cmml">τ</mi><mo id="S4.SS2.SSS2.p3.5.m5.1.1.1" xref="S4.SS2.SSS2.p3.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p3.5.m5.1.1.3" xref="S4.SS2.SSS2.p3.5.m5.1.1.3.cmml">4.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.5.m5.1b"><apply id="S4.SS2.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.1.1"><eq id="S4.SS2.SSS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m5.1.1.1"></eq><ci id="S4.SS2.SSS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m5.1.1.2">𝜏</ci><cn type="float" id="S4.SS2.SSS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p3.5.m5.1.1.3">4.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.5.m5.1c">\tau=4.0</annotation></semantics></math> which is commonly utilized in knowledge distillation. We can also transfer the knowledge contained in the intermediate features. We can take the maximum mean discrepancy (MMD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> to align the feature distributions between the newly-downloaded model and the “HPM”:</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.3" class="ltx_Math" alttext="{\mathcal{L}}_{\text{mmd}}\left(\psi_{t}^{k}\right)=\left\lVert\frac{1}{B}\sum_{i=1}^{B}\Phi({\mathbf{h}}_{i})-\frac{1}{B}\sum_{i=1}^{B}\Phi({\mathbf{h}}_{\text{p},i})\right\rVert_{\mathcal{H}}^{2}," display="block"><semantics id="S4.E12.m1.3a"><mrow id="S4.E12.m1.3.3.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1.1" xref="S4.E12.m1.3.3.1.1.1.cmml"><msub id="S4.E12.m1.3.3.1.1.1.3" xref="S4.E12.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.3.3.1.1.1.3.2" xref="S4.E12.m1.3.3.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E12.m1.3.3.1.1.1.3.3" xref="S4.E12.m1.3.3.1.1.1.3.3a.cmml">mmd</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.1.2" xref="S4.E12.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.3.3.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E12.m1.3.3.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml">ψ</mi><mi id="S4.E12.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E12.m1.3.3.1.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E12.m1.3.3.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.1389em" id="S4.E12.m1.3.3.1.1.3" xref="S4.E12.m1.3.3.1.1.3.cmml">=</mo><msubsup id="S4.E12.m1.3.3.1.1.2" xref="S4.E12.m1.3.3.1.1.2.cmml"><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.2.cmml"><mo fence="true" lspace="0.1389em" rspace="0em" stretchy="true" id="S4.E12.m1.3.3.1.1.2.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.2.1.cmml">∥</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mfrac id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.cmml"><mn id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml">1</mn><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><munderover id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">B</mi></munderover><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E12.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.3.cmml">−</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.cmml"><mfrac id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.cmml"><mn id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.2.cmml">1</mn><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.cmml"><munderover id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.cmml"><mo movablelimits="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.cmml"><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.2.cmml">i</mi><mo id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.3.cmml">B</mi></munderover><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.cmml"><mi mathvariant="normal" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.3.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.2.cmml">𝐡</mi><mrow id="S4.E12.m1.2.2.2.4" xref="S4.E12.m1.2.2.2.3.cmml"><mtext id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1a.cmml">p</mtext><mo id="S4.E12.m1.2.2.2.4.1" xref="S4.E12.m1.2.2.2.3.cmml">,</mo><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo fence="true" lspace="0em" rspace="0em" stretchy="true" id="S4.E12.m1.3.3.1.1.2.1.1.1.3" xref="S4.E12.m1.3.3.1.1.2.1.1.2.1.cmml">∥</mo></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.3.3.1.1.2.1.3" xref="S4.E12.m1.3.3.1.1.2.1.3.cmml">ℋ</mi><mn id="S4.E12.m1.3.3.1.1.2.3" xref="S4.E12.m1.3.3.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E12.m1.3.3.1.2" xref="S4.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.3b"><apply id="S4.E12.m1.3.3.1.1.cmml" xref="S4.E12.m1.3.3.1"><eq id="S4.E12.m1.3.3.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.3"></eq><apply id="S4.E12.m1.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1"><times id="S4.E12.m1.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.2"></times><apply id="S4.E12.m1.3.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.1.3.2.cmml" xref="S4.E12.m1.3.3.1.1.1.3.2">ℒ</ci><ci id="S4.E12.m1.3.3.1.1.1.3.3a.cmml" xref="S4.E12.m1.3.3.1.1.1.3.3"><mtext mathsize="70%" id="S4.E12.m1.3.3.1.1.1.3.3.cmml" xref="S4.E12.m1.3.3.1.1.1.3.3">mmd</mtext></ci></apply><apply id="S4.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S4.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2.2">𝜓</ci><ci id="S4.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.E12.m1.3.3.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E12.m1.3.3.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2">subscript</csymbol><apply id="S4.E12.m1.3.3.1.1.2.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.3.3.1.1.2.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1"><minus id="S4.E12.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.3"></minus><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1"><times id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.2"></times><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3"><divide id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3"></divide><cn type="integer" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.2">1</cn><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.3.3">𝐵</ci></apply><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1"><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3"><eq id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.2.3">𝐵</ci></apply><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1"><times id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.2"></times><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.3">Φ</ci><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2"><times id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.2"></times><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3"><divide id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3"></divide><cn type="integer" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.2">1</cn><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.3.3">𝐵</ci></apply><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1"><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2">superscript</csymbol><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2">subscript</csymbol><sum id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.2"></sum><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3"><eq id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.1"></eq><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.2.3">𝐵</ci></apply><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1"><times id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.2"></times><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.3">Φ</ci><apply id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2.1.1.1.1.2.1.1.1.1.1.2">𝐡</ci><list id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.4"><ci id="S4.E12.m1.1.1.1.1a.cmml" xref="S4.E12.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">p</mtext></ci><ci id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></apply><ci id="S4.E12.m1.3.3.1.1.2.1.3.cmml" xref="S4.E12.m1.3.3.1.1.2.1.3">ℋ</ci></apply><cn type="integer" id="S4.E12.m1.3.3.1.1.2.3.cmml" xref="S4.E12.m1.3.3.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.3c">{\mathcal{L}}_{\text{mmd}}\left(\psi_{t}^{k}\right)=\left\lVert\frac{1}{B}\sum_{i=1}^{B}\Phi({\mathbf{h}}_{i})-\frac{1}{B}\sum_{i=1}^{B}\Phi({\mathbf{h}}_{\text{p},i})\right\rVert_{\mathcal{H}}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p3.7" class="ltx_p">where <math id="S4.SS2.SSS2.p3.6.m1.1" class="ltx_Math" alttext="\Phi(\cdot)" display="inline"><semantics id="S4.SS2.SSS2.p3.6.m1.1a"><mrow id="S4.SS2.SSS2.p3.6.m1.1.2" xref="S4.SS2.SSS2.p3.6.m1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS2.p3.6.m1.1.2.2" xref="S4.SS2.SSS2.p3.6.m1.1.2.2.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.6.m1.1.2.1" xref="S4.SS2.SSS2.p3.6.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.6.m1.1.2.3.2" xref="S4.SS2.SSS2.p3.6.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.6.m1.1.2.3.2.1" xref="S4.SS2.SSS2.p3.6.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.6.m1.1.1" xref="S4.SS2.SSS2.p3.6.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS2.p3.6.m1.1.2.3.2.2" xref="S4.SS2.SSS2.p3.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.6.m1.1b"><apply id="S4.SS2.SSS2.p3.6.m1.1.2.cmml" xref="S4.SS2.SSS2.p3.6.m1.1.2"><times id="S4.SS2.SSS2.p3.6.m1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.6.m1.1.2.1"></times><ci id="S4.SS2.SSS2.p3.6.m1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.6.m1.1.2.2">Φ</ci><ci id="S4.SS2.SSS2.p3.6.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.6.m1.1c">\Phi(\cdot)</annotation></semantics></math> is a feature map induced by a specific kernel function, i.e., <math id="S4.SS2.SSS2.p3.7.m2.4" class="ltx_Math" alttext="k({\mathbf{h}}_{i},{\mathbf{h}}_{j})=\langle\Phi({\mathbf{h}}_{i}),\Phi({\mathbf{h}}_{j})\rangle" display="inline"><semantics id="S4.SS2.SSS2.p3.7.m2.4a"><mrow id="S4.SS2.SSS2.p3.7.m2.4.4" xref="S4.SS2.SSS2.p3.7.m2.4.4.cmml"><mrow id="S4.SS2.SSS2.p3.7.m2.2.2.2" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.cmml"><mi id="S4.SS2.SSS2.p3.7.m2.2.2.2.4" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.4.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.7.m2.2.2.2.3" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.3.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.3" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.4" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.cmml"><mi id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.2" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.3" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.5" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p3.7.m2.4.4.5" xref="S4.SS2.SSS2.p3.7.m2.4.4.5.cmml">=</mo><mrow id="S4.SS2.SSS2.p3.7.m2.4.4.4.2" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.3.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.3" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.3.cmml">⟨</mo><mrow id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.3.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.4" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.3.cmml">,</mo><mrow id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.cmml"><mi mathvariant="normal" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.3" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.3.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.2" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.cmml">(</mo><msub id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.2" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.3" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.5" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.7.m2.4b"><apply id="S4.SS2.SSS2.p3.7.m2.4.4.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4"><eq id="S4.SS2.SSS2.p3.7.m2.4.4.5.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.5"></eq><apply id="S4.SS2.SSS2.p3.7.m2.2.2.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2"><times id="S4.SS2.SSS2.p3.7.m2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.3"></times><ci id="S4.SS2.SSS2.p3.7.m2.2.2.2.4.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.4">𝑘</ci><interval closure="open" id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2"><apply id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.2">𝐡</ci><ci id="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.2">𝐡</ci><ci id="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply><list id="S4.SS2.SSS2.p3.7.m2.4.4.4.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2"><apply id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1"><times id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.2"></times><ci id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.3">Φ</ci><apply id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.2">𝐡</ci><ci id="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.3.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2"><times id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.2"></times><ci id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.3">Φ</ci><apply id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.2">𝐡</ci><ci id="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.7.m2.4.4.4.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.7.m2.4c">k({\mathbf{h}}_{i},{\mathbf{h}}_{j})=\langle\Phi({\mathbf{h}}_{i}),\Phi({\mathbf{h}}_{j})\rangle</annotation></semantics></math>. We use multiple Gaussian kernels with different bandwidths as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>. With these types of knowledge transfer, and combined with Eq. <a href="#S3.E1" title="In 3.1 Basic Procedure of FL ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the total personalization loss is denoted as:</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.1" class="ltx_Math" alttext="{\mathcal{L}}_{\text{total}}\left(\psi_{t}^{k}\right)=(1-\lambda){\mathcal{L}}\left(\psi_{t}^{k}\right)+\lambda{\mathcal{L}}_{\text{kt}}\left(\psi_{t}^{k}\right)," display="block"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E13.m1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.3.3a.cmml">total</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml">ψ</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E13.m1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.1.1.1.1.5" xref="S4.E13.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.4" xref="S4.E13.m1.1.1.1.1.4.cmml"><mrow id="S4.E13.m1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.3.2.cmml"><mrow id="S4.E13.m1.1.1.1.1.2.1.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.2.1.1.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml"><mn id="S4.E13.m1.1.1.1.1.2.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="S4.E13.m1.1.1.1.1.2.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.E13.m1.1.1.1.1.2.1.1.1.3" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.3.2.3" xref="S4.E13.m1.1.1.1.1.3.2.3.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.3.2.4" xref="S4.E13.m1.1.1.1.1.3.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.3.2.3a" xref="S4.E13.m1.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.3.2.2.1" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.3.2.2.1.2" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.cmml">(</mo><msubsup id="S4.E13.m1.1.1.1.1.3.2.2.1.1" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.2" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.2.cmml">ψ</mi><mi id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.3" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.3.cmml">t</mi><mi id="S4.E13.m1.1.1.1.1.3.2.2.1.1.3" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.3.cmml">k</mi></msubsup><mo id="S4.E13.m1.1.1.1.1.3.2.2.1.3" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.1.1.1.1.4.4" xref="S4.E13.m1.1.1.1.1.4.4.cmml">+</mo><mrow id="S4.E13.m1.1.1.1.1.4.3" xref="S4.E13.m1.1.1.1.1.4.3.cmml"><mi id="S4.E13.m1.1.1.1.1.4.3.3" xref="S4.E13.m1.1.1.1.1.4.3.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.4.3.2" xref="S4.E13.m1.1.1.1.1.4.3.2.cmml">​</mo><msub id="S4.E13.m1.1.1.1.1.4.3.4" xref="S4.E13.m1.1.1.1.1.4.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.4.3.4.2" xref="S4.E13.m1.1.1.1.1.4.3.4.2.cmml">ℒ</mi><mtext id="S4.E13.m1.1.1.1.1.4.3.4.3" xref="S4.E13.m1.1.1.1.1.4.3.4.3a.cmml">kt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.4.3.2a" xref="S4.E13.m1.1.1.1.1.4.3.2.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.4.3.1.1" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.4.3.1.1.2" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.cmml">(</mo><msubsup id="S4.E13.m1.1.1.1.1.4.3.1.1.1" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.2.cmml">ψ</mi><mi id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.3.cmml">t</mi><mi id="S4.E13.m1.1.1.1.1.4.3.1.1.1.3" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E13.m1.1.1.1.1.4.3.1.1.3" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.5.cmml" xref="S4.E13.m1.1.1.1.1.5"></eq><apply id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.2"></times><apply id="S4.E13.m1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.3.2">ℒ</ci><ci id="S4.E13.m1.1.1.1.1.1.3.3a.cmml" xref="S4.E13.m1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.E13.m1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3.3">total</mtext></ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.2">𝜓</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.E13.m1.1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.1.4"><plus id="S4.E13.m1.1.1.1.1.4.4.cmml" xref="S4.E13.m1.1.1.1.1.4.4"></plus><apply id="S4.E13.m1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2"><times id="S4.E13.m1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3"></times><apply id="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1"><minus id="S4.E13.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E13.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.2">1</cn><ci id="S4.E13.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.3">𝜆</ci></apply><ci id="S4.E13.m1.1.1.1.1.3.2.4.cmml" xref="S4.E13.m1.1.1.1.1.3.2.4">ℒ</ci><apply id="S4.E13.m1.1.1.1.1.3.2.2.1.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.2.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.2">𝜓</ci><ci id="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.2.3">𝑡</ci></apply><ci id="S4.E13.m1.1.1.1.1.3.2.2.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.1.1.3">𝑘</ci></apply></apply><apply id="S4.E13.m1.1.1.1.1.4.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3"><times id="S4.E13.m1.1.1.1.1.4.3.2.cmml" xref="S4.E13.m1.1.1.1.1.4.3.2"></times><ci id="S4.E13.m1.1.1.1.1.4.3.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3.3">𝜆</ci><apply id="S4.E13.m1.1.1.1.1.4.3.4.cmml" xref="S4.E13.m1.1.1.1.1.4.3.4"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.4.3.4.1.cmml" xref="S4.E13.m1.1.1.1.1.4.3.4">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.4.3.4.2.cmml" xref="S4.E13.m1.1.1.1.1.4.3.4.2">ℒ</ci><ci id="S4.E13.m1.1.1.1.1.4.3.4.3a.cmml" xref="S4.E13.m1.1.1.1.1.4.3.4.3"><mtext mathsize="70%" id="S4.E13.m1.1.1.1.1.4.3.4.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3.4.3">kt</mtext></ci></apply><apply id="S4.E13.m1.1.1.1.1.4.3.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.4.3.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.2">𝜓</ci><ci id="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E13.m1.1.1.1.1.4.3.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">{\mathcal{L}}_{\text{total}}\left(\psi_{t}^{k}\right)=(1-\lambda){\mathcal{L}}\left(\psi_{t}^{k}\right)+\lambda{\mathcal{L}}_{\text{kt}}\left(\psi_{t}^{k}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p3.15" class="ltx_p">where <math id="S4.SS2.SSS2.p3.8.m1.1" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}}" display="inline"><semantics id="S4.SS2.SSS2.p3.8.m1.1a"><msub id="S4.SS2.SSS2.p3.8.m1.1.1" xref="S4.SS2.SSS2.p3.8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.8.m1.1.1.2" xref="S4.SS2.SSS2.p3.8.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS2.p3.8.m1.1.1.3" xref="S4.SS2.SSS2.p3.8.m1.1.1.3a.cmml">kt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.8.m1.1b"><apply id="S4.SS2.SSS2.p3.8.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.8.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.8.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.8.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.8.m1.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.8.m1.1.1.3a.cmml" xref="S4.SS2.SSS2.p3.8.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p3.8.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.8.m1.1.1.3">kt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.8.m1.1c">{\mathcal{L}}_{\text{kt}}</annotation></semantics></math> could be <math id="S4.SS2.SSS2.p3.9.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{kd}}" display="inline"><semantics id="S4.SS2.SSS2.p3.9.m2.1a"><msub id="S4.SS2.SSS2.p3.9.m2.1.1" xref="S4.SS2.SSS2.p3.9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.9.m2.1.1.2" xref="S4.SS2.SSS2.p3.9.m2.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS2.p3.9.m2.1.1.3" xref="S4.SS2.SSS2.p3.9.m2.1.1.3a.cmml">kd</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.9.m2.1b"><apply id="S4.SS2.SSS2.p3.9.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.9.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.9.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.9.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.9.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p3.9.m2.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.9.m2.1.1.3a.cmml" xref="S4.SS2.SSS2.p3.9.m2.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p3.9.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p3.9.m2.1.1.3">kd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.9.m2.1c">\mathcal{L}_{\text{kd}}</annotation></semantics></math> or <math id="S4.SS2.SSS2.p3.10.m3.1" class="ltx_Math" alttext="\mathcal{L}_{\text{mmd}}" display="inline"><semantics id="S4.SS2.SSS2.p3.10.m3.1a"><msub id="S4.SS2.SSS2.p3.10.m3.1.1" xref="S4.SS2.SSS2.p3.10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.10.m3.1.1.2" xref="S4.SS2.SSS2.p3.10.m3.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS2.p3.10.m3.1.1.3" xref="S4.SS2.SSS2.p3.10.m3.1.1.3a.cmml">mmd</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.10.m3.1b"><apply id="S4.SS2.SSS2.p3.10.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.10.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.10.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p3.10.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.10.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p3.10.m3.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.10.m3.1.1.3a.cmml" xref="S4.SS2.SSS2.p3.10.m3.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p3.10.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p3.10.m3.1.1.3">mmd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.10.m3.1c">\mathcal{L}_{\text{mmd}}</annotation></semantics></math>. <math id="S4.SS2.SSS2.p3.11.m4.1" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}}" display="inline"><semantics id="S4.SS2.SSS2.p3.11.m4.1a"><msub id="S4.SS2.SSS2.p3.11.m4.1.1" xref="S4.SS2.SSS2.p3.11.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.11.m4.1.1.2" xref="S4.SS2.SSS2.p3.11.m4.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS2.p3.11.m4.1.1.3" xref="S4.SS2.SSS2.p3.11.m4.1.1.3a.cmml">kt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.11.m4.1b"><apply id="S4.SS2.SSS2.p3.11.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.11.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.11.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p3.11.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.11.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p3.11.m4.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.11.m4.1.1.3a.cmml" xref="S4.SS2.SSS2.p3.11.m4.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p3.11.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p3.11.m4.1.1.3">kt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.11.m4.1c">{\mathcal{L}}_{\text{kt}}</annotation></semantics></math> and <math id="S4.SS2.SSS2.p3.12.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.SSS2.p3.12.m5.1a"><mi id="S4.SS2.SSS2.p3.12.m5.1.1" xref="S4.SS2.SSS2.p3.12.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.12.m5.1b"><ci id="S4.SS2.SSS2.p3.12.m5.1.1.cmml" xref="S4.SS2.SSS2.p3.12.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.12.m5.1c">\lambda</annotation></semantics></math> are hyper-parameters. The personalized model <math id="S4.SS2.SSS2.p3.13.m6.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS2.p3.13.m6.1a"><msubsup id="S4.SS2.SSS2.p3.13.m6.1.1" xref="S4.SS2.SSS2.p3.13.m6.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p3.13.m6.1.1.2.2" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2.cmml"><mi id="S4.SS2.SSS2.p3.13.m6.1.1.2.2.2" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2.2.cmml">ψ</mi><mo id="S4.SS2.SSS2.p3.13.m6.1.1.2.2.1" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS2.p3.13.m6.1.1.2.3" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p3.13.m6.1.1.3" xref="S4.SS2.SSS2.p3.13.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.13.m6.1b"><apply id="S4.SS2.SSS2.p3.13.m6.1.1.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.13.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.13.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.13.m6.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p3.13.m6.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2"><ci id="S4.SS2.SSS2.p3.13.m6.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2.1">^</ci><ci id="S4.SS2.SSS2.p3.13.m6.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.2.2">𝜓</ci></apply><ci id="S4.SS2.SSS2.p3.13.m6.1.1.2.3.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p3.13.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p3.13.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.13.m6.1c">\hat{\psi}_{t}^{k}</annotation></semantics></math> could be obtained via several steps of SGD update as <math id="S4.SS2.SSS2.p3.14.m7.1" class="ltx_Math" alttext="\psi_{t}^{k}\leftarrow\psi_{t}^{k}-\eta\nabla_{\psi_{t}^{k}}{\mathcal{L}}_{\text{total}}\left(\psi_{t}^{k}\right)" display="inline"><semantics id="S4.SS2.SSS2.p3.14.m7.1a"><mrow id="S4.SS2.SSS2.p3.14.m7.1.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.cmml"><msubsup id="S4.SS2.SSS2.p3.14.m7.1.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.cmml"><mi id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.3.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS2.SSS2.p3.14.m7.1.1.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.2.cmml">←</mo><mrow id="S4.SS2.SSS2.p3.14.m7.1.1.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.cmml"><msubsup id="S4.SS2.SSS2.p3.14.m7.1.1.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p3.14.m7.1.1.1.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.2.cmml">−</mo><mrow id="S4.SS2.SSS2.p3.14.m7.1.1.1.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.cmml"><msub id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.2.cmml">∇</mo><msubsup id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.cmml"><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.3.cmml">k</mi></msubsup></msub><msub id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3a.cmml">total</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2a" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.2" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.2.cmml">ψ</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.14.m7.1b"><apply id="S4.SS2.SSS2.p3.14.m7.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1"><ci id="S4.SS2.SSS2.p3.14.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.2">←</ci><apply id="S4.SS2.SSS2.p3.14.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.3.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p3.14.m7.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p3.14.m7.1.1.3.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1"><minus id="S4.SS2.SSS2.p3.14.m7.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.2"></minus><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1"><times id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.2"></times><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.3">𝜂</ci><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4"><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.2">∇</ci><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3">superscript</csymbol><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.1.3.3">𝑘</ci></apply></apply><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3a.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3"><mtext mathsize="70%" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.4.2.3">total</mtext></ci></apply></apply><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.2">𝜓</ci><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.14.m7.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.14.m7.1c">\psi_{t}^{k}\leftarrow\psi_{t}^{k}-\eta\nabla_{\psi_{t}^{k}}{\mathcal{L}}_{\text{total}}\left(\psi_{t}^{k}\right)</annotation></semantics></math>. <math id="S4.SS2.SSS2.p3.15.m8.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS2.SSS2.p3.15.m8.1a"><mi id="S4.SS2.SSS2.p3.15.m8.1.1" xref="S4.SS2.SSS2.p3.15.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.15.m8.1b"><ci id="S4.SS2.SSS2.p3.15.m8.1.1.cmml" xref="S4.SS2.SSS2.p3.15.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.15.m8.1c">\eta</annotation></semantics></math> is the learning rate.</p>
</div>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3 </span>Theoretical Analysis</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.p1.9" class="ltx_p">We provide a macroscopic analysis of the advantages of “HPM”. Similar to FedBoost <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, we utilize the Bregman Divergence <math id="S4.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="B_{F}" display="inline"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><msub id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.1.m1.1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml">B</mi><mi id="S4.SS2.SSS3.p1.1.m1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.2">𝐵</ci><ci id="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">B_{F}</annotation></semantics></math> as the loss function and assume that <math id="S4.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.SSS3.p1.2.m2.1a"><mi id="S4.SS2.SSS3.p1.2.m2.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.1b"><ci id="S4.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.1c">F</annotation></semantics></math> is strictly convex and <math id="S4.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="B_{F}" display="inline"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><msub id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml">B</mi><mi id="S4.SS2.SSS3.p1.3.m3.1.1.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><apply id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2">𝐵</ci><ci id="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">B_{F}</annotation></semantics></math> is jointly convex. The loss of the <math id="S4.SS2.SSS3.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><mi id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><ci id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">k</annotation></semantics></math>-th client is <math id="S4.SS2.SSS3.p1.5.m5.1" class="ltx_math_unparsed" alttext="B_{F}\left(h^{k}||\mathcal{D}^{k}\right)=F(h^{k})-F(\mathcal{D}^{k})-\left\langle\nabla F(\mathcal{D}^{k}),h^{k}-\mathcal{D}^{k}\right\rangle" display="inline"><semantics id="S4.SS2.SSS3.p1.5.m5.1a"><mrow id="S4.SS2.SSS3.p1.5.m5.1b"><msub id="S4.SS2.SSS3.p1.5.m5.1.1"><mi id="S4.SS2.SSS3.p1.5.m5.1.1.2">B</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.1.3">F</mi></msub><mrow id="S4.SS2.SSS3.p1.5.m5.1.2"><mo id="S4.SS2.SSS3.p1.5.m5.1.2.1">(</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.2.2"><mi id="S4.SS2.SSS3.p1.5.m5.1.2.2.2">h</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.2.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.2.4">|</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.2.5"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.5.m5.1.2.5.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.2.5.3">k</mi></msup><mo id="S4.SS2.SSS3.p1.5.m5.1.2.6">)</mo></mrow><mo id="S4.SS2.SSS3.p1.5.m5.1.3">=</mo><mi id="S4.SS2.SSS3.p1.5.m5.1.4">F</mi><mrow id="S4.SS2.SSS3.p1.5.m5.1.5"><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.5.1">(</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.5.2"><mi id="S4.SS2.SSS3.p1.5.m5.1.5.2.2">h</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.5.2.3">k</mi></msup><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.5.3">)</mo></mrow><mo id="S4.SS2.SSS3.p1.5.m5.1.6">−</mo><mi id="S4.SS2.SSS3.p1.5.m5.1.7">F</mi><mrow id="S4.SS2.SSS3.p1.5.m5.1.8"><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.8.1">(</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.8.2"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.5.m5.1.8.2.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.8.2.3">k</mi></msup><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.8.3">)</mo></mrow><mo id="S4.SS2.SSS3.p1.5.m5.1.9">−</mo><mrow id="S4.SS2.SSS3.p1.5.m5.1.10"><mo id="S4.SS2.SSS3.p1.5.m5.1.10.1">⟨</mo><mo rspace="0.167em" id="S4.SS2.SSS3.p1.5.m5.1.10.2">∇</mo><mi id="S4.SS2.SSS3.p1.5.m5.1.10.3">F</mi><mrow id="S4.SS2.SSS3.p1.5.m5.1.10.4"><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.10.4.1">(</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.10.4.2"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.5.m5.1.10.4.2.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.10.4.2.3">k</mi></msup><mo stretchy="false" id="S4.SS2.SSS3.p1.5.m5.1.10.4.3">)</mo></mrow><mo id="S4.SS2.SSS3.p1.5.m5.1.10.5">,</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.10.6"><mi id="S4.SS2.SSS3.p1.5.m5.1.10.6.2">h</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.10.6.3">k</mi></msup><mo id="S4.SS2.SSS3.p1.5.m5.1.10.7">−</mo><msup id="S4.SS2.SSS3.p1.5.m5.1.10.8"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.5.m5.1.10.8.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.10.8.3">k</mi></msup><mo id="S4.SS2.SSS3.p1.5.m5.1.10.9">⟩</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.5.m5.1c">B_{F}\left(h^{k}||\mathcal{D}^{k}\right)=F(h^{k})-F(\mathcal{D}^{k})-\left\langle\nabla F(\mathcal{D}^{k}),h^{k}-\mathcal{D}^{k}\right\rangle</annotation></semantics></math>, where <math id="S4.SS2.SSS3.p1.6.m6.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.6.m6.1a"><msup id="S4.SS2.SSS3.p1.6.m6.1.1" xref="S4.SS2.SSS3.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS3.p1.6.m6.1.1.2" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.cmml">h</mi><mi id="S4.SS2.SSS3.p1.6.m6.1.1.3" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.6.m6.1b"><apply id="S4.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.2">ℎ</ci><ci id="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.6.m6.1c">h^{k}</annotation></semantics></math> is the learned estimator with a little abuse of notations.
The updated “HPM” in the <math id="S4.SS2.SSS3.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS3.p1.7.m7.1a"><mi id="S4.SS2.SSS3.p1.7.m7.1.1" xref="S4.SS2.SSS3.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.7.m7.1b"><ci id="S4.SS2.SSS3.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.7.m7.1c">t</annotation></semantics></math>-th round is actually an interpolation as: <math id="S4.SS2.SSS3.p1.8.m8.5" class="ltx_Math" alttext="h_{\text{p},t+1}^{k}=(1-\alpha)\hat{h}_{t}^{k}+\alpha h_{\text{p},t}^{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.8.m8.5a"><mrow id="S4.SS2.SSS3.p1.8.m8.5.5" xref="S4.SS2.SSS3.p1.8.m8.5.5.cmml"><msubsup id="S4.SS2.SSS3.p1.8.m8.5.5.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.3.cmml"><mi id="S4.SS2.SSS3.p1.8.m8.5.5.3.2.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.3.2.2.cmml">h</mi><mrow id="S4.SS2.SSS3.p1.8.m8.2.2.2.2" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.3.cmml"><mtext id="S4.SS2.SSS3.p1.8.m8.1.1.1.1" xref="S4.SS2.SSS3.p1.8.m8.1.1.1.1a.cmml">p</mtext><mo id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.2" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.3.cmml">,</mo><mrow id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.cmml"><mi id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.2" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.2.cmml">t</mi><mo id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.1" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.3" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S4.SS2.SSS3.p1.8.m8.5.5.3.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.3.3.cmml">k</mi></msubsup><mo id="S4.SS2.SSS3.p1.8.m8.5.5.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.2.cmml">=</mo><mrow id="S4.SS2.SSS3.p1.8.m8.5.5.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.cmml"><mrow id="S4.SS2.SSS3.p1.8.m8.5.5.1.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.cmml"><mrow id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.cmml"><mn id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.1.cmml">−</mo><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.2.cmml">​</mo><msubsup id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.cmml"><mover accent="true" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.cmml"><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.2.cmml">h</mi><mo id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS2.SSS3.p1.8.m8.5.5.1.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.2.cmml">+</mo><mrow id="S4.SS2.SSS3.p1.8.m8.5.5.1.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.cmml"><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.1" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.1.cmml">​</mo><msubsup id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.cmml"><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.2" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.2.cmml">h</mi><mrow id="S4.SS2.SSS3.p1.8.m8.4.4.2.4" xref="S4.SS2.SSS3.p1.8.m8.4.4.2.3.cmml"><mtext id="S4.SS2.SSS3.p1.8.m8.3.3.1.1" xref="S4.SS2.SSS3.p1.8.m8.3.3.1.1a.cmml">p</mtext><mo id="S4.SS2.SSS3.p1.8.m8.4.4.2.4.1" xref="S4.SS2.SSS3.p1.8.m8.4.4.2.3.cmml">,</mo><mi id="S4.SS2.SSS3.p1.8.m8.4.4.2.2" xref="S4.SS2.SSS3.p1.8.m8.4.4.2.2.cmml">t</mi></mrow><mi id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.3" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.8.m8.5b"><apply id="S4.SS2.SSS3.p1.8.m8.5.5.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5"><eq id="S4.SS2.SSS3.p1.8.m8.5.5.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.2"></eq><apply id="S4.SS2.SSS3.p1.8.m8.5.5.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.3.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3">superscript</csymbol><apply id="S4.SS2.SSS3.p1.8.m8.5.5.3.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.3.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.8.m8.5.5.3.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3.2.2">ℎ</ci><list id="S4.SS2.SSS3.p1.8.m8.2.2.2.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2"><ci id="S4.SS2.SSS3.p1.8.m8.1.1.1.1a.cmml" xref="S4.SS2.SSS3.p1.8.m8.1.1.1.1"><mtext mathsize="70%" id="S4.SS2.SSS3.p1.8.m8.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.1.1.1.1">p</mtext></ci><apply id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1"><plus id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.1"></plus><ci id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S4.SS2.SSS3.p1.8.m8.5.5.3.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.3.3">𝑘</ci></apply><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1"><plus id="S4.SS2.SSS3.p1.8.m8.5.5.1.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.2"></plus><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1"><times id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.2"></times><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1"><minus id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.2">1</cn><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.1.1.1.3">𝛼</ci></apply><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3">subscript</csymbol><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2"><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.1">^</ci><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.2.2">ℎ</ci></apply><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.1.3.3">𝑘</ci></apply></apply><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3"><times id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.1"></times><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.2">𝛼</ci><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3">superscript</csymbol><apply id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.2.2">ℎ</ci><list id="S4.SS2.SSS3.p1.8.m8.4.4.2.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.4.4.2.4"><ci id="S4.SS2.SSS3.p1.8.m8.3.3.1.1a.cmml" xref="S4.SS2.SSS3.p1.8.m8.3.3.1.1"><mtext mathsize="70%" id="S4.SS2.SSS3.p1.8.m8.3.3.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m8.3.3.1.1">p</mtext></ci><ci id="S4.SS2.SSS3.p1.8.m8.4.4.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m8.4.4.2.2">𝑡</ci></list></apply><ci id="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.3.cmml" xref="S4.SS2.SSS3.p1.8.m8.5.5.1.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.8.m8.5c">h_{\text{p},t+1}^{k}=(1-\alpha)\hat{h}_{t}^{k}+\alpha h_{\text{p},t}^{k}</annotation></semantics></math>, with <math id="S4.SS2.SSS3.p1.9.m9.1" class="ltx_Math" alttext="\alpha=\mu_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.9.m9.1a"><mrow id="S4.SS2.SSS3.p1.9.m9.1.1" xref="S4.SS2.SSS3.p1.9.m9.1.1.cmml"><mi id="S4.SS2.SSS3.p1.9.m9.1.1.2" xref="S4.SS2.SSS3.p1.9.m9.1.1.2.cmml">α</mi><mo id="S4.SS2.SSS3.p1.9.m9.1.1.1" xref="S4.SS2.SSS3.p1.9.m9.1.1.1.cmml">=</mo><msubsup id="S4.SS2.SSS3.p1.9.m9.1.1.3" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.cmml"><mi id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.2" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.2.2.cmml">μ</mi><mi id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.3" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.2.3.cmml">t</mi><mi id="S4.SS2.SSS3.p1.9.m9.1.1.3.3" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.9.m9.1b"><apply id="S4.SS2.SSS3.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1"><eq id="S4.SS2.SSS3.p1.9.m9.1.1.1.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.1"></eq><ci id="S4.SS2.SSS3.p1.9.m9.1.1.2.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.2">𝛼</ci><apply id="S4.SS2.SSS3.p1.9.m9.1.1.3.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.9.m9.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3">superscript</csymbol><apply id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.1.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.2.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.2.2">𝜇</ci><ci id="S4.SS2.SSS3.p1.9.m9.1.1.3.2.3.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS3.p1.9.m9.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.9.m9.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.9.m9.1c">\alpha=\mu_{t}^{k}</annotation></semantics></math>. According to the property of Bregman Divergence, the local loss function is bounded:</p>
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex1.m1.4" class="ltx_math_unparsed" alttext="B_{F}\left(h_{\text{p},t+1}^{k}||{\mathcal{D}}^{k}\right)\leq(1-\alpha)B_{F}\left(\hat{h}_{t}^{k}||{\mathcal{D}}^{k}\right)+\alpha B_{F}\left(h_{\text{p},t}^{k}||{\mathcal{D}}^{k}\right)," display="block"><semantics id="S4.Ex1.m1.4a"><mrow id="S4.Ex1.m1.4b"><msub id="S4.Ex1.m1.4.5"><mi id="S4.Ex1.m1.4.5.2">B</mi><mi id="S4.Ex1.m1.4.5.3">F</mi></msub><mrow id="S4.Ex1.m1.4.6"><mo id="S4.Ex1.m1.4.6.1">(</mo><msubsup id="S4.Ex1.m1.4.6.2"><mi id="S4.Ex1.m1.4.6.2.2.2">h</mi><mrow id="S4.Ex1.m1.2.2.2.2"><mtext id="S4.Ex1.m1.1.1.1.1">p</mtext><mo id="S4.Ex1.m1.2.2.2.2.2">,</mo><mrow id="S4.Ex1.m1.2.2.2.2.1"><mi id="S4.Ex1.m1.2.2.2.2.1.2">t</mi><mo id="S4.Ex1.m1.2.2.2.2.1.1">+</mo><mn id="S4.Ex1.m1.2.2.2.2.1.3">1</mn></mrow></mrow><mi id="S4.Ex1.m1.4.6.2.3">k</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.6.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.6.4">|</mo><msup id="S4.Ex1.m1.4.6.5"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.4.6.5.2">𝒟</mi><mi id="S4.Ex1.m1.4.6.5.3">k</mi></msup><mo id="S4.Ex1.m1.4.6.6">)</mo></mrow><mo id="S4.Ex1.m1.4.7">≤</mo><mrow id="S4.Ex1.m1.4.8"><mo stretchy="false" id="S4.Ex1.m1.4.8.1">(</mo><mn id="S4.Ex1.m1.4.8.2">1</mn><mo id="S4.Ex1.m1.4.8.3">−</mo><mi id="S4.Ex1.m1.4.8.4">α</mi><mo stretchy="false" id="S4.Ex1.m1.4.8.5">)</mo></mrow><msub id="S4.Ex1.m1.4.9"><mi id="S4.Ex1.m1.4.9.2">B</mi><mi id="S4.Ex1.m1.4.9.3">F</mi></msub><mrow id="S4.Ex1.m1.4.10"><mo id="S4.Ex1.m1.4.10.1">(</mo><msubsup id="S4.Ex1.m1.4.10.2"><mover accent="true" id="S4.Ex1.m1.4.10.2.2.2"><mi id="S4.Ex1.m1.4.10.2.2.2.2">h</mi><mo id="S4.Ex1.m1.4.10.2.2.2.1">^</mo></mover><mi id="S4.Ex1.m1.4.10.2.2.3">t</mi><mi id="S4.Ex1.m1.4.10.2.3">k</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.10.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.10.4">|</mo><msup id="S4.Ex1.m1.4.10.5"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.4.10.5.2">𝒟</mi><mi id="S4.Ex1.m1.4.10.5.3">k</mi></msup><mo id="S4.Ex1.m1.4.10.6">)</mo></mrow><mo id="S4.Ex1.m1.4.11">+</mo><mi id="S4.Ex1.m1.4.12">α</mi><msub id="S4.Ex1.m1.4.13"><mi id="S4.Ex1.m1.4.13.2">B</mi><mi id="S4.Ex1.m1.4.13.3">F</mi></msub><mrow id="S4.Ex1.m1.4.14"><mo id="S4.Ex1.m1.4.14.1">(</mo><msubsup id="S4.Ex1.m1.4.14.2"><mi id="S4.Ex1.m1.4.14.2.2.2">h</mi><mrow id="S4.Ex1.m1.4.4.2.4"><mtext id="S4.Ex1.m1.3.3.1.1">p</mtext><mo id="S4.Ex1.m1.4.4.2.4.1">,</mo><mi id="S4.Ex1.m1.4.4.2.2">t</mi></mrow><mi id="S4.Ex1.m1.4.14.2.3">k</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.14.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m1.4.14.4">|</mo><msup id="S4.Ex1.m1.4.14.5"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.4.14.5.2">𝒟</mi><mi id="S4.Ex1.m1.4.14.5.3">k</mi></msup><mo id="S4.Ex1.m1.4.14.6">)</mo></mrow><mo id="S4.Ex1.m1.4.15">,</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex1.m1.4c">B_{F}\left(h_{\text{p},t+1}^{k}||{\mathcal{D}}^{k}\right)\leq(1-\alpha)B_{F}\left(\hat{h}_{t}^{k}||{\mathcal{D}}^{k}\right)+\alpha B_{F}\left(h_{\text{p},t}^{k}||{\mathcal{D}}^{k}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS3.p1.14" class="ltx_p">which bounds the personalization error via two components: <math id="S4.SS2.SSS3.p1.10.m1.1" class="ltx_math_unparsed" alttext="B_{F}\left(\hat{h}_{t}^{k}||{\mathcal{D}}^{k}\right)" display="inline"><semantics id="S4.SS2.SSS3.p1.10.m1.1a"><mrow id="S4.SS2.SSS3.p1.10.m1.1b"><msub id="S4.SS2.SSS3.p1.10.m1.1.1"><mi id="S4.SS2.SSS3.p1.10.m1.1.1.2">B</mi><mi id="S4.SS2.SSS3.p1.10.m1.1.1.3">F</mi></msub><mrow id="S4.SS2.SSS3.p1.10.m1.1.2"><mo id="S4.SS2.SSS3.p1.10.m1.1.2.1">(</mo><msubsup id="S4.SS2.SSS3.p1.10.m1.1.2.2"><mover accent="true" id="S4.SS2.SSS3.p1.10.m1.1.2.2.2.2"><mi id="S4.SS2.SSS3.p1.10.m1.1.2.2.2.2.2">h</mi><mo id="S4.SS2.SSS3.p1.10.m1.1.2.2.2.2.1">^</mo></mover><mi id="S4.SS2.SSS3.p1.10.m1.1.2.2.2.3">t</mi><mi id="S4.SS2.SSS3.p1.10.m1.1.2.2.3">k</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.10.m1.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.10.m1.1.2.4">|</mo><msup id="S4.SS2.SSS3.p1.10.m1.1.2.5"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.10.m1.1.2.5.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.10.m1.1.2.5.3">k</mi></msup><mo id="S4.SS2.SSS3.p1.10.m1.1.2.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.10.m1.1c">B_{F}\left(\hat{h}_{t}^{k}||{\mathcal{D}}^{k}\right)</annotation></semantics></math> denotes the error of after personalizing <math id="S4.SS2.SSS3.p1.11.m2.1" class="ltx_Math" alttext="h_{t}^{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.11.m2.1a"><msubsup id="S4.SS2.SSS3.p1.11.m2.1.1" xref="S4.SS2.SSS3.p1.11.m2.1.1.cmml"><mi id="S4.SS2.SSS3.p1.11.m2.1.1.2.2" xref="S4.SS2.SSS3.p1.11.m2.1.1.2.2.cmml">h</mi><mi id="S4.SS2.SSS3.p1.11.m2.1.1.2.3" xref="S4.SS2.SSS3.p1.11.m2.1.1.2.3.cmml">t</mi><mi id="S4.SS2.SSS3.p1.11.m2.1.1.3" xref="S4.SS2.SSS3.p1.11.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.11.m2.1b"><apply id="S4.SS2.SSS3.p1.11.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.11.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS3.p1.11.m2.1.1.2.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.11.m2.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.11.m2.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1.2.2">ℎ</ci><ci id="S4.SS2.SSS3.p1.11.m2.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.SSS3.p1.11.m2.1.1.3.cmml" xref="S4.SS2.SSS3.p1.11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.11.m2.1c">h_{t}^{k}</annotation></semantics></math>, which can be small with appropriate fine-tuning; <math id="S4.SS2.SSS3.p1.12.m3.2" class="ltx_math_unparsed" alttext="B_{F}\left(h_{\text{p},t}^{k}||{\mathcal{D}}^{k}\right)" display="inline"><semantics id="S4.SS2.SSS3.p1.12.m3.2a"><mrow id="S4.SS2.SSS3.p1.12.m3.2b"><msub id="S4.SS2.SSS3.p1.12.m3.2.3"><mi id="S4.SS2.SSS3.p1.12.m3.2.3.2">B</mi><mi id="S4.SS2.SSS3.p1.12.m3.2.3.3">F</mi></msub><mrow id="S4.SS2.SSS3.p1.12.m3.2.4"><mo id="S4.SS2.SSS3.p1.12.m3.2.4.1">(</mo><msubsup id="S4.SS2.SSS3.p1.12.m3.2.4.2"><mi id="S4.SS2.SSS3.p1.12.m3.2.4.2.2.2">h</mi><mrow id="S4.SS2.SSS3.p1.12.m3.2.2.2.4"><mtext id="S4.SS2.SSS3.p1.12.m3.1.1.1.1">p</mtext><mo id="S4.SS2.SSS3.p1.12.m3.2.2.2.4.1">,</mo><mi id="S4.SS2.SSS3.p1.12.m3.2.2.2.2">t</mi></mrow><mi id="S4.SS2.SSS3.p1.12.m3.2.4.2.3">k</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.12.m3.2.4.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.SSS3.p1.12.m3.2.4.4">|</mo><msup id="S4.SS2.SSS3.p1.12.m3.2.4.5"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.12.m3.2.4.5.2">𝒟</mi><mi id="S4.SS2.SSS3.p1.12.m3.2.4.5.3">k</mi></msup><mo id="S4.SS2.SSS3.p1.12.m3.2.4.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.12.m3.2c">B_{F}\left(h_{\text{p},t}^{k}||{\mathcal{D}}^{k}\right)</annotation></semantics></math> denotes the error of the <math id="S4.SS2.SSS3.p1.13.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.SSS3.p1.13.m4.1a"><mi id="S4.SS2.SSS3.p1.13.m4.1.1" xref="S4.SS2.SSS3.p1.13.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.13.m4.1b"><ci id="S4.SS2.SSS3.p1.13.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.13.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.13.m4.1c">t</annotation></semantics></math>-th “HPM”, which can be deduced similarly to the <math id="S4.SS2.SSS3.p1.14.m5.1" class="ltx_Math" alttext="(t-1)" display="inline"><semantics id="S4.SS2.SSS3.p1.14.m5.1a"><mrow id="S4.SS2.SSS3.p1.14.m5.1.1.1" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS3.p1.14.m5.1.1.1.2" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS3.p1.14.m5.1.1.1.1" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.2" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.1" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.3" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.SSS3.p1.14.m5.1.1.1.3" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.14.m5.1b"><apply id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.14.m5.1.1.1"><minus id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.1"></minus><ci id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.2">𝑡</ci><cn type="integer" id="S4.SS2.SSS3.p1.14.m5.1.1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.14.m5.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.14.m5.1c">(t-1)</annotation></semantics></math>-th round.
To be brief, the macroscopic theoretical analysis shows that “HPM” is a special kind of private-shared model that can inherit the historical personalized models’ ability, leading to smaller personalization errors.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.13.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Model Aggregation and Personalization (MAP)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.9" class="ltx_p ltx_figure_panel"><span id="alg1.9.1" class="ltx_text ltx_font_bold">HyperParameters</span>: <math id="alg1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">Q</annotation></semantics></math>, <math id="alg1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">T</annotation></semantics></math>, <math id="alg1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">E</annotation></semantics></math>, <math id="alg1.4.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.4.m4.1a"><mi id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">B</annotation></semantics></math>, <math id="alg1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\alpha</annotation></semantics></math> in Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>; <math id="alg1.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.6.m6.1a"><mi id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">\lambda</annotation></semantics></math> and <math id="alg1.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{\text{kt}}" display="inline"><semantics id="alg1.7.m7.1a"><msub id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2.cmml">ℒ</mi><mtext id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3a.cmml">kt</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.cmml" xref="alg1.7.m7.1.1">subscript</csymbol><ci id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2">ℒ</ci><ci id="alg1.7.m7.1.1.3a.cmml" xref="alg1.7.m7.1.1.3"><mtext mathsize="70%" id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3">kt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">\mathcal{L}_{\text{kt}}</annotation></semantics></math> in Eq. <a href="#S4.E13" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> 
<br class="ltx_break"><span id="alg1.9.2" class="ltx_text ltx_font_bold">Return</span>: <math id="alg1.8.m8.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="alg1.8.m8.1a"><mi id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><ci id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">\psi</annotation></semantics></math>: the final aggregated global model; <math id="alg1.9.m9.1" class="ltx_Math" alttext="\{\psi^{k}\}_{k=1}^{K}" display="inline"><semantics id="alg1.9.m9.1a"><msubsup id="alg1.9.m9.1.1" xref="alg1.9.m9.1.1.cmml"><mrow id="alg1.9.m9.1.1.1.1.1" xref="alg1.9.m9.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.9.m9.1.1.1.1.1.2" xref="alg1.9.m9.1.1.1.1.2.cmml">{</mo><msup id="alg1.9.m9.1.1.1.1.1.1" xref="alg1.9.m9.1.1.1.1.1.1.cmml"><mi id="alg1.9.m9.1.1.1.1.1.1.2" xref="alg1.9.m9.1.1.1.1.1.1.2.cmml">ψ</mi><mi id="alg1.9.m9.1.1.1.1.1.1.3" xref="alg1.9.m9.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.9.m9.1.1.1.1.1.3" xref="alg1.9.m9.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.9.m9.1.1.1.3" xref="alg1.9.m9.1.1.1.3.cmml"><mi id="alg1.9.m9.1.1.1.3.2" xref="alg1.9.m9.1.1.1.3.2.cmml">k</mi><mo id="alg1.9.m9.1.1.1.3.1" xref="alg1.9.m9.1.1.1.3.1.cmml">=</mo><mn id="alg1.9.m9.1.1.1.3.3" xref="alg1.9.m9.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.9.m9.1.1.3" xref="alg1.9.m9.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.9.m9.1b"><apply id="alg1.9.m9.1.1.cmml" xref="alg1.9.m9.1.1"><csymbol cd="ambiguous" id="alg1.9.m9.1.1.2.cmml" xref="alg1.9.m9.1.1">superscript</csymbol><apply id="alg1.9.m9.1.1.1.cmml" xref="alg1.9.m9.1.1"><csymbol cd="ambiguous" id="alg1.9.m9.1.1.1.2.cmml" xref="alg1.9.m9.1.1">subscript</csymbol><set id="alg1.9.m9.1.1.1.1.2.cmml" xref="alg1.9.m9.1.1.1.1.1"><apply id="alg1.9.m9.1.1.1.1.1.1.cmml" xref="alg1.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.9.m9.1.1.1.1.1.1.1.cmml" xref="alg1.9.m9.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.9.m9.1.1.1.1.1.1.2.cmml" xref="alg1.9.m9.1.1.1.1.1.1.2">𝜓</ci><ci id="alg1.9.m9.1.1.1.1.1.1.3.cmml" xref="alg1.9.m9.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg1.9.m9.1.1.1.3.cmml" xref="alg1.9.m9.1.1.1.3"><eq id="alg1.9.m9.1.1.1.3.1.cmml" xref="alg1.9.m9.1.1.1.3.1"></eq><ci id="alg1.9.m9.1.1.1.3.2.cmml" xref="alg1.9.m9.1.1.1.3.2">𝑘</ci><cn type="integer" id="alg1.9.m9.1.1.1.3.3.cmml" xref="alg1.9.m9.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.9.m9.1.1.3.cmml" xref="alg1.9.m9.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m9.1c">\{\psi^{k}\}_{k=1}^{K}</annotation></semantics></math>: the personalization model for each local client 
<br class="ltx_break"><span id="alg1.9.3" class="ltx_text ltx_font_bold">ServerProcedure</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.14" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">for</span> global round <math id="alg1.l1.m1.4" class="ltx_Math" alttext="t=1,2,\ldots,T" display="inline"><semantics id="alg1.l1.m1.4a"><mrow id="alg1.l1.m1.4.5" xref="alg1.l1.m1.4.5.cmml"><mi id="alg1.l1.m1.4.5.2" xref="alg1.l1.m1.4.5.2.cmml">t</mi><mo id="alg1.l1.m1.4.5.1" xref="alg1.l1.m1.4.5.1.cmml">=</mo><mrow id="alg1.l1.m1.4.5.3.2" xref="alg1.l1.m1.4.5.3.1.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">1</mn><mo id="alg1.l1.m1.4.5.3.2.1" xref="alg1.l1.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">2</mn><mo id="alg1.l1.m1.4.5.3.2.2" xref="alg1.l1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">…</mi><mo id="alg1.l1.m1.4.5.3.2.3" xref="alg1.l1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l1.m1.4.4" xref="alg1.l1.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.4b"><apply id="alg1.l1.m1.4.5.cmml" xref="alg1.l1.m1.4.5"><eq id="alg1.l1.m1.4.5.1.cmml" xref="alg1.l1.m1.4.5.1"></eq><ci id="alg1.l1.m1.4.5.2.cmml" xref="alg1.l1.m1.4.5.2">𝑡</ci><list id="alg1.l1.m1.4.5.3.1.cmml" xref="alg1.l1.m1.4.5.3.2"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">1</cn><cn type="integer" id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">2</cn><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">…</ci><ci id="alg1.l1.m1.4.4.cmml" xref="alg1.l1.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.4c">t=1,2,\ldots,T</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <math id="alg1.l2.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝑆</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">S_{t}\leftarrow</annotation></semantics></math> sample <math id="alg1.l2.m2.3" class="ltx_Math" alttext="\max(Q\cdot K,1)" display="inline"><semantics id="alg1.l2.m2.3a"><mrow id="alg1.l2.m2.3.3.1" xref="alg1.l2.m2.3.3.2.cmml"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">max</mi><mo id="alg1.l2.m2.3.3.1a" xref="alg1.l2.m2.3.3.2.cmml">⁡</mo><mrow id="alg1.l2.m2.3.3.1.1" xref="alg1.l2.m2.3.3.2.cmml"><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.2" xref="alg1.l2.m2.3.3.2.cmml">(</mo><mrow id="alg1.l2.m2.3.3.1.1.1" xref="alg1.l2.m2.3.3.1.1.1.cmml"><mi id="alg1.l2.m2.3.3.1.1.1.2" xref="alg1.l2.m2.3.3.1.1.1.2.cmml">Q</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l2.m2.3.3.1.1.1.1" xref="alg1.l2.m2.3.3.1.1.1.1.cmml">⋅</mo><mi id="alg1.l2.m2.3.3.1.1.1.3" xref="alg1.l2.m2.3.3.1.1.1.3.cmml">K</mi></mrow><mo id="alg1.l2.m2.3.3.1.1.3" xref="alg1.l2.m2.3.3.2.cmml">,</mo><mn id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.4" xref="alg1.l2.m2.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.3b"><apply id="alg1.l2.m2.3.3.2.cmml" xref="alg1.l2.m2.3.3.1"><max id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"></max><apply id="alg1.l2.m2.3.3.1.1.1.cmml" xref="alg1.l2.m2.3.3.1.1.1"><ci id="alg1.l2.m2.3.3.1.1.1.1.cmml" xref="alg1.l2.m2.3.3.1.1.1.1">⋅</ci><ci id="alg1.l2.m2.3.3.1.1.1.2.cmml" xref="alg1.l2.m2.3.3.1.1.1.2">𝑄</ci><ci id="alg1.l2.m2.3.3.1.1.1.3.cmml" xref="alg1.l2.m2.3.3.1.1.1.3">𝐾</ci></apply><cn type="integer" id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.3c">\max(Q\cdot K,1)</annotation></semantics></math> clients

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">k</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">∈</mo><msub id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><in id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></in><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑘</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑆</ci><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">k\in S_{t}</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        <math id="alg1.l4.m1.6" class="ltx_Math" alttext="\hat{\psi}_{\text{a},t}^{k},\psi_{\text{p},t+1}^{k}\leftarrow" display="inline"><semantics id="alg1.l4.m1.6a"><mrow id="alg1.l4.m1.6.6" xref="alg1.l4.m1.6.6.cmml"><mrow id="alg1.l4.m1.6.6.2.2" xref="alg1.l4.m1.6.6.2.3.cmml"><msubsup id="alg1.l4.m1.5.5.1.1.1" xref="alg1.l4.m1.5.5.1.1.1.cmml"><mover accent="true" id="alg1.l4.m1.5.5.1.1.1.2.2" xref="alg1.l4.m1.5.5.1.1.1.2.2.cmml"><mi id="alg1.l4.m1.5.5.1.1.1.2.2.2" xref="alg1.l4.m1.5.5.1.1.1.2.2.2.cmml">ψ</mi><mo id="alg1.l4.m1.5.5.1.1.1.2.2.1" xref="alg1.l4.m1.5.5.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l4.m1.2.2.2.4" xref="alg1.l4.m1.2.2.2.3.cmml"><mtext id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1a.cmml">a</mtext><mo id="alg1.l4.m1.2.2.2.4.1" xref="alg1.l4.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml">t</mi></mrow><mi id="alg1.l4.m1.5.5.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l4.m1.6.6.2.2.3" xref="alg1.l4.m1.6.6.2.3.cmml">,</mo><msubsup id="alg1.l4.m1.6.6.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.cmml">ψ</mi><mrow id="alg1.l4.m1.4.4.2.2" xref="alg1.l4.m1.4.4.2.3.cmml"><mtext id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.1a.cmml">p</mtext><mo id="alg1.l4.m1.4.4.2.2.2" xref="alg1.l4.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.l4.m1.4.4.2.2.1" xref="alg1.l4.m1.4.4.2.2.1.cmml"><mi id="alg1.l4.m1.4.4.2.2.1.2" xref="alg1.l4.m1.4.4.2.2.1.2.cmml">t</mi><mo id="alg1.l4.m1.4.4.2.2.1.1" xref="alg1.l4.m1.4.4.2.2.1.1.cmml">+</mo><mn id="alg1.l4.m1.4.4.2.2.1.3" xref="alg1.l4.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="alg1.l4.m1.6.6.2.2.2.3" xref="alg1.l4.m1.6.6.2.2.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l4.m1.6.6.3" xref="alg1.l4.m1.6.6.3.cmml">←</mo><mi id="alg1.l4.m1.6.6.4" xref="alg1.l4.m1.6.6.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.6b"><apply id="alg1.l4.m1.6.6.cmml" xref="alg1.l4.m1.6.6"><ci id="alg1.l4.m1.6.6.3.cmml" xref="alg1.l4.m1.6.6.3">←</ci><list id="alg1.l4.m1.6.6.2.3.cmml" xref="alg1.l4.m1.6.6.2.2"><apply id="alg1.l4.m1.5.5.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1">superscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1">subscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.1.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2"><ci id="alg1.l4.m1.5.5.1.1.1.2.2.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.1">^</ci><ci id="alg1.l4.m1.5.5.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.1.2.2.2">𝜓</ci></apply><list id="alg1.l4.m1.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.4"><ci id="alg1.l4.m1.1.1.1.1a.cmml" xref="alg1.l4.m1.1.1.1.1"><mtext mathsize="70%" id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">a</mtext></ci><ci id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2">𝑡</ci></list></apply><ci id="alg1.l4.m1.5.5.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.1.3">𝑘</ci></apply><apply id="alg1.l4.m1.6.6.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.1.cmml" xref="alg1.l4.m1.6.6.2.2.2">superscript</csymbol><apply id="alg1.l4.m1.6.6.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.2.1.cmml" xref="alg1.l4.m1.6.6.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2">𝜓</ci><list id="alg1.l4.m1.4.4.2.3.cmml" xref="alg1.l4.m1.4.4.2.2"><ci id="alg1.l4.m1.3.3.1.1a.cmml" xref="alg1.l4.m1.3.3.1.1"><mtext mathsize="70%" id="alg1.l4.m1.3.3.1.1.cmml" xref="alg1.l4.m1.3.3.1.1">p</mtext></ci><apply id="alg1.l4.m1.4.4.2.2.1.cmml" xref="alg1.l4.m1.4.4.2.2.1"><plus id="alg1.l4.m1.4.4.2.2.1.1.cmml" xref="alg1.l4.m1.4.4.2.2.1.1"></plus><ci id="alg1.l4.m1.4.4.2.2.1.2.cmml" xref="alg1.l4.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l4.m1.4.4.2.2.1.3.cmml" xref="alg1.l4.m1.4.4.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l4.m1.6.6.2.2.2.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.3">𝑘</ci></apply></list><csymbol cd="latexml" id="alg1.l4.m1.6.6.4.cmml" xref="alg1.l4.m1.6.6.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.6c">\hat{\psi}_{\text{a},t}^{k},\psi_{\text{p},t+1}^{k}\leftarrow</annotation></semantics></math> ClientProcedure(<math id="alg1.l4.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">k</annotation></semantics></math>, <math id="alg1.l4.m3.1" class="ltx_Math" alttext="\psi_{t}" display="inline"><semantics id="alg1.l4.m3.1a"><msub id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml"><mi id="alg1.l4.m3.1.1.2" xref="alg1.l4.m3.1.1.2.cmml">ψ</mi><mi id="alg1.l4.m3.1.1.3" xref="alg1.l4.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><apply id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"><csymbol cd="ambiguous" id="alg1.l4.m3.1.1.1.cmml" xref="alg1.l4.m3.1.1">subscript</csymbol><ci id="alg1.l4.m3.1.1.2.cmml" xref="alg1.l4.m3.1.1.2">𝜓</ci><ci id="alg1.l4.m3.1.1.3.cmml" xref="alg1.l4.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\psi_{t}</annotation></semantics></math>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <math id="alg1.l6.m1.3" class="ltx_Math" alttext="\psi_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{\psi}_{\text{a},t}^{k}" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.4" xref="alg1.l6.m1.3.4.cmml"><msub id="alg1.l6.m1.3.4.2" xref="alg1.l6.m1.3.4.2.cmml"><mi id="alg1.l6.m1.3.4.2.2" xref="alg1.l6.m1.3.4.2.2.cmml">ψ</mi><mrow id="alg1.l6.m1.3.4.2.3" xref="alg1.l6.m1.3.4.2.3.cmml"><mi id="alg1.l6.m1.3.4.2.3.2" xref="alg1.l6.m1.3.4.2.3.2.cmml">t</mi><mo id="alg1.l6.m1.3.4.2.3.1" xref="alg1.l6.m1.3.4.2.3.1.cmml">+</mo><mn id="alg1.l6.m1.3.4.2.3.3" xref="alg1.l6.m1.3.4.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l6.m1.3.4.1" xref="alg1.l6.m1.3.4.1.cmml">←</mo><mrow id="alg1.l6.m1.3.4.3" xref="alg1.l6.m1.3.4.3.cmml"><msub id="alg1.l6.m1.3.4.3.1" xref="alg1.l6.m1.3.4.3.1.cmml"><mo id="alg1.l6.m1.3.4.3.1.2" xref="alg1.l6.m1.3.4.3.1.2.cmml">∑</mo><mrow id="alg1.l6.m1.3.4.3.1.3" xref="alg1.l6.m1.3.4.3.1.3.cmml"><mi id="alg1.l6.m1.3.4.3.1.3.2" xref="alg1.l6.m1.3.4.3.1.3.2.cmml">k</mi><mo id="alg1.l6.m1.3.4.3.1.3.1" xref="alg1.l6.m1.3.4.3.1.3.1.cmml">∈</mo><msub id="alg1.l6.m1.3.4.3.1.3.3" xref="alg1.l6.m1.3.4.3.1.3.3.cmml"><mi id="alg1.l6.m1.3.4.3.1.3.3.2" xref="alg1.l6.m1.3.4.3.1.3.3.2.cmml">S</mi><mi id="alg1.l6.m1.3.4.3.1.3.3.3" xref="alg1.l6.m1.3.4.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l6.m1.3.4.3.2" xref="alg1.l6.m1.3.4.3.2.cmml"><mfrac id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">1</mn><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml">S</mi><mi id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l6.m1.3.4.3.2.1" xref="alg1.l6.m1.3.4.3.2.1.cmml">​</mo><msubsup id="alg1.l6.m1.3.4.3.2.2" xref="alg1.l6.m1.3.4.3.2.2.cmml"><mover accent="true" id="alg1.l6.m1.3.4.3.2.2.2.2" xref="alg1.l6.m1.3.4.3.2.2.2.2.cmml"><mi id="alg1.l6.m1.3.4.3.2.2.2.2.2" xref="alg1.l6.m1.3.4.3.2.2.2.2.2.cmml">ψ</mi><mo id="alg1.l6.m1.3.4.3.2.2.2.2.1" xref="alg1.l6.m1.3.4.3.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l6.m1.3.3.2.4" xref="alg1.l6.m1.3.3.2.3.cmml"><mtext id="alg1.l6.m1.2.2.1.1" xref="alg1.l6.m1.2.2.1.1a.cmml">a</mtext><mo id="alg1.l6.m1.3.3.2.4.1" xref="alg1.l6.m1.3.3.2.3.cmml">,</mo><mi id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.2.cmml">t</mi></mrow><mi id="alg1.l6.m1.3.4.3.2.2.3" xref="alg1.l6.m1.3.4.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.4.cmml" xref="alg1.l6.m1.3.4"><ci id="alg1.l6.m1.3.4.1.cmml" xref="alg1.l6.m1.3.4.1">←</ci><apply id="alg1.l6.m1.3.4.2.cmml" xref="alg1.l6.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.4.2.1.cmml" xref="alg1.l6.m1.3.4.2">subscript</csymbol><ci id="alg1.l6.m1.3.4.2.2.cmml" xref="alg1.l6.m1.3.4.2.2">𝜓</ci><apply id="alg1.l6.m1.3.4.2.3.cmml" xref="alg1.l6.m1.3.4.2.3"><plus id="alg1.l6.m1.3.4.2.3.1.cmml" xref="alg1.l6.m1.3.4.2.3.1"></plus><ci id="alg1.l6.m1.3.4.2.3.2.cmml" xref="alg1.l6.m1.3.4.2.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m1.3.4.2.3.3.cmml" xref="alg1.l6.m1.3.4.2.3.3">1</cn></apply></apply><apply id="alg1.l6.m1.3.4.3.cmml" xref="alg1.l6.m1.3.4.3"><apply id="alg1.l6.m1.3.4.3.1.cmml" xref="alg1.l6.m1.3.4.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.3.4.3.1.1.cmml" xref="alg1.l6.m1.3.4.3.1">subscript</csymbol><sum id="alg1.l6.m1.3.4.3.1.2.cmml" xref="alg1.l6.m1.3.4.3.1.2"></sum><apply id="alg1.l6.m1.3.4.3.1.3.cmml" xref="alg1.l6.m1.3.4.3.1.3"><in id="alg1.l6.m1.3.4.3.1.3.1.cmml" xref="alg1.l6.m1.3.4.3.1.3.1"></in><ci id="alg1.l6.m1.3.4.3.1.3.2.cmml" xref="alg1.l6.m1.3.4.3.1.3.2">𝑘</ci><apply id="alg1.l6.m1.3.4.3.1.3.3.cmml" xref="alg1.l6.m1.3.4.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.4.3.1.3.3.1.cmml" xref="alg1.l6.m1.3.4.3.1.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.4.3.1.3.3.2.cmml" xref="alg1.l6.m1.3.4.3.1.3.3.2">𝑆</ci><ci id="alg1.l6.m1.3.4.3.1.3.3.3.cmml" xref="alg1.l6.m1.3.4.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l6.m1.3.4.3.2.cmml" xref="alg1.l6.m1.3.4.3.2"><times id="alg1.l6.m1.3.4.3.2.1.cmml" xref="alg1.l6.m1.3.4.3.2.1"></times><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><divide id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1"></divide><cn type="integer" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">1</cn><apply id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1"><abs id="alg1.l6.m1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2"></abs><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">𝑆</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="alg1.l6.m1.3.4.3.2.2.cmml" xref="alg1.l6.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.4.3.2.2.1.cmml" xref="alg1.l6.m1.3.4.3.2.2">superscript</csymbol><apply id="alg1.l6.m1.3.4.3.2.2.2.cmml" xref="alg1.l6.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.4.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.4.3.2.2">subscript</csymbol><apply id="alg1.l6.m1.3.4.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.4.3.2.2.2.2"><ci id="alg1.l6.m1.3.4.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.4.3.2.2.2.2.1">^</ci><ci id="alg1.l6.m1.3.4.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.4.3.2.2.2.2.2">𝜓</ci></apply><list id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.4"><ci id="alg1.l6.m1.2.2.1.1a.cmml" xref="alg1.l6.m1.2.2.1.1"><mtext mathsize="70%" id="alg1.l6.m1.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.1.1">a</mtext></ci><ci id="alg1.l6.m1.3.3.2.2.cmml" xref="alg1.l6.m1.3.3.2.2">𝑡</ci></list></apply><ci id="alg1.l6.m1.3.4.3.2.2.3.cmml" xref="alg1.l6.m1.3.4.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">\psi_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{\psi}_{\text{a},t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <span id="alg1.l8.2" class="ltx_text ltx_font_bold">Return</span>: <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\psi\leftarrow\psi_{T+1}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">ψ</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><msub id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">ψ</mi><mrow id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.2" xref="alg1.l8.m1.1.1.3.3.2.cmml">T</mi><mo id="alg1.l8.m1.1.1.3.3.1" xref="alg1.l8.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝜓</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝜓</ci><apply id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3"><plus id="alg1.l8.m1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.1"></plus><ci id="alg1.l8.m1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.2">𝑇</ci><cn type="integer" id="alg1.l8.m1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\psi\leftarrow\psi_{T+1}</annotation></semantics></math>, and <math id="alg1.l8.m2.5" class="ltx_Math" alttext="\psi^{k}\leftarrow\psi_{\text{p},T+1}^{k},\forall k\in[K]" display="inline"><semantics id="alg1.l8.m2.5a"><mrow id="alg1.l8.m2.5.5.2" xref="alg1.l8.m2.5.5.3.cmml"><mrow id="alg1.l8.m2.4.4.1.1" xref="alg1.l8.m2.4.4.1.1.cmml"><msup id="alg1.l8.m2.4.4.1.1.2" xref="alg1.l8.m2.4.4.1.1.2.cmml"><mi id="alg1.l8.m2.4.4.1.1.2.2" xref="alg1.l8.m2.4.4.1.1.2.2.cmml">ψ</mi><mi id="alg1.l8.m2.4.4.1.1.2.3" xref="alg1.l8.m2.4.4.1.1.2.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.l8.m2.4.4.1.1.1" xref="alg1.l8.m2.4.4.1.1.1.cmml">←</mo><msubsup id="alg1.l8.m2.4.4.1.1.3" xref="alg1.l8.m2.4.4.1.1.3.cmml"><mi id="alg1.l8.m2.4.4.1.1.3.2.2" xref="alg1.l8.m2.4.4.1.1.3.2.2.cmml">ψ</mi><mrow id="alg1.l8.m2.2.2.2.2" xref="alg1.l8.m2.2.2.2.3.cmml"><mtext id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1a.cmml">p</mtext><mo id="alg1.l8.m2.2.2.2.2.2" xref="alg1.l8.m2.2.2.2.3.cmml">,</mo><mrow id="alg1.l8.m2.2.2.2.2.1" xref="alg1.l8.m2.2.2.2.2.1.cmml"><mi id="alg1.l8.m2.2.2.2.2.1.2" xref="alg1.l8.m2.2.2.2.2.1.2.cmml">T</mi><mo id="alg1.l8.m2.2.2.2.2.1.1" xref="alg1.l8.m2.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l8.m2.2.2.2.2.1.3" xref="alg1.l8.m2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="alg1.l8.m2.4.4.1.1.3.3" xref="alg1.l8.m2.4.4.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="alg1.l8.m2.5.5.2.3" xref="alg1.l8.m2.5.5.3a.cmml">,</mo><mrow id="alg1.l8.m2.5.5.2.2" xref="alg1.l8.m2.5.5.2.2.cmml"><mrow id="alg1.l8.m2.5.5.2.2.2" xref="alg1.l8.m2.5.5.2.2.2.cmml"><mo rspace="0.167em" id="alg1.l8.m2.5.5.2.2.2.1" xref="alg1.l8.m2.5.5.2.2.2.1.cmml">∀</mo><mi id="alg1.l8.m2.5.5.2.2.2.2" xref="alg1.l8.m2.5.5.2.2.2.2.cmml">k</mi></mrow><mo id="alg1.l8.m2.5.5.2.2.1" xref="alg1.l8.m2.5.5.2.2.1.cmml">∈</mo><mrow id="alg1.l8.m2.5.5.2.2.3.2" xref="alg1.l8.m2.5.5.2.2.3.1.cmml"><mo stretchy="false" id="alg1.l8.m2.5.5.2.2.3.2.1" xref="alg1.l8.m2.5.5.2.2.3.1.1.cmml">[</mo><mi id="alg1.l8.m2.3.3" xref="alg1.l8.m2.3.3.cmml">K</mi><mo stretchy="false" id="alg1.l8.m2.5.5.2.2.3.2.2" xref="alg1.l8.m2.5.5.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.5b"><apply id="alg1.l8.m2.5.5.3.cmml" xref="alg1.l8.m2.5.5.2"><csymbol cd="ambiguous" id="alg1.l8.m2.5.5.3a.cmml" xref="alg1.l8.m2.5.5.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m2.4.4.1.1.cmml" xref="alg1.l8.m2.4.4.1.1"><ci id="alg1.l8.m2.4.4.1.1.1.cmml" xref="alg1.l8.m2.4.4.1.1.1">←</ci><apply id="alg1.l8.m2.4.4.1.1.2.cmml" xref="alg1.l8.m2.4.4.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m2.4.4.1.1.2.1.cmml" xref="alg1.l8.m2.4.4.1.1.2">superscript</csymbol><ci id="alg1.l8.m2.4.4.1.1.2.2.cmml" xref="alg1.l8.m2.4.4.1.1.2.2">𝜓</ci><ci id="alg1.l8.m2.4.4.1.1.2.3.cmml" xref="alg1.l8.m2.4.4.1.1.2.3">𝑘</ci></apply><apply id="alg1.l8.m2.4.4.1.1.3.cmml" xref="alg1.l8.m2.4.4.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m2.4.4.1.1.3.1.cmml" xref="alg1.l8.m2.4.4.1.1.3">superscript</csymbol><apply id="alg1.l8.m2.4.4.1.1.3.2.cmml" xref="alg1.l8.m2.4.4.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m2.4.4.1.1.3.2.1.cmml" xref="alg1.l8.m2.4.4.1.1.3">subscript</csymbol><ci id="alg1.l8.m2.4.4.1.1.3.2.2.cmml" xref="alg1.l8.m2.4.4.1.1.3.2.2">𝜓</ci><list id="alg1.l8.m2.2.2.2.3.cmml" xref="alg1.l8.m2.2.2.2.2"><ci id="alg1.l8.m2.1.1.1.1a.cmml" xref="alg1.l8.m2.1.1.1.1"><mtext mathsize="70%" id="alg1.l8.m2.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">p</mtext></ci><apply id="alg1.l8.m2.2.2.2.2.1.cmml" xref="alg1.l8.m2.2.2.2.2.1"><plus id="alg1.l8.m2.2.2.2.2.1.1.cmml" xref="alg1.l8.m2.2.2.2.2.1.1"></plus><ci id="alg1.l8.m2.2.2.2.2.1.2.cmml" xref="alg1.l8.m2.2.2.2.2.1.2">𝑇</ci><cn type="integer" id="alg1.l8.m2.2.2.2.2.1.3.cmml" xref="alg1.l8.m2.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l8.m2.4.4.1.1.3.3.cmml" xref="alg1.l8.m2.4.4.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l8.m2.5.5.2.2.cmml" xref="alg1.l8.m2.5.5.2.2"><in id="alg1.l8.m2.5.5.2.2.1.cmml" xref="alg1.l8.m2.5.5.2.2.1"></in><apply id="alg1.l8.m2.5.5.2.2.2.cmml" xref="alg1.l8.m2.5.5.2.2.2"><csymbol cd="latexml" id="alg1.l8.m2.5.5.2.2.2.1.cmml" xref="alg1.l8.m2.5.5.2.2.2.1">for-all</csymbol><ci id="alg1.l8.m2.5.5.2.2.2.2.cmml" xref="alg1.l8.m2.5.5.2.2.2.2">𝑘</ci></apply><apply id="alg1.l8.m2.5.5.2.2.3.1.cmml" xref="alg1.l8.m2.5.5.2.2.3.2"><csymbol cd="latexml" id="alg1.l8.m2.5.5.2.2.3.1.1.cmml" xref="alg1.l8.m2.5.5.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.m2.3.3.cmml" xref="alg1.l8.m2.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.5c">\psi^{k}\leftarrow\psi_{\text{p},T+1}^{k},\forall k\in[K]</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.11" class="ltx_p ltx_figure_panel"><span id="alg1.11.1" class="ltx_text ltx_font_bold">ClientProcedure</span>(<math id="alg1.10.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.10.m1.1a"><mi id="alg1.10.m1.1.1" xref="alg1.10.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m1.1b"><ci id="alg1.10.m1.1.1.cmml" xref="alg1.10.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m1.1c">k</annotation></semantics></math>, <math id="alg1.11.m2.1" class="ltx_Math" alttext="\psi_{t}" display="inline"><semantics id="alg1.11.m2.1a"><msub id="alg1.11.m2.1.1" xref="alg1.11.m2.1.1.cmml"><mi id="alg1.11.m2.1.1.2" xref="alg1.11.m2.1.1.2.cmml">ψ</mi><mi id="alg1.11.m2.1.1.3" xref="alg1.11.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.11.m2.1b"><apply id="alg1.11.m2.1.1.cmml" xref="alg1.11.m2.1.1"><csymbol cd="ambiguous" id="alg1.11.m2.1.1.1.cmml" xref="alg1.11.m2.1.1">subscript</csymbol><ci id="alg1.11.m2.1.1.2.cmml" xref="alg1.11.m2.1.1.2">𝜓</ci><ci id="alg1.11.m2.1.1.3.cmml" xref="alg1.11.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m2.1c">\psi_{t}</annotation></semantics></math>):</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.15" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1a.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <math id="alg1.l1a.m1.1" class="ltx_Math" alttext="\psi_{t}^{k}\leftarrow\psi_{t}" display="inline"><semantics id="alg1.l1a.m1.1a"><mrow id="alg1.l1a.m1.1.1" xref="alg1.l1a.m1.1.1.cmml"><msubsup id="alg1.l1a.m1.1.1.2" xref="alg1.l1a.m1.1.1.2.cmml"><mi id="alg1.l1a.m1.1.1.2.2.2" xref="alg1.l1a.m1.1.1.2.2.2.cmml">ψ</mi><mi id="alg1.l1a.m1.1.1.2.2.3" xref="alg1.l1a.m1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l1a.m1.1.1.2.3" xref="alg1.l1a.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l1a.m1.1.1.1" xref="alg1.l1a.m1.1.1.1.cmml">←</mo><msub id="alg1.l1a.m1.1.1.3" xref="alg1.l1a.m1.1.1.3.cmml"><mi id="alg1.l1a.m1.1.1.3.2" xref="alg1.l1a.m1.1.1.3.2.cmml">ψ</mi><mi id="alg1.l1a.m1.1.1.3.3" xref="alg1.l1a.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1a.m1.1b"><apply id="alg1.l1a.m1.1.1.cmml" xref="alg1.l1a.m1.1.1"><ci id="alg1.l1a.m1.1.1.1.cmml" xref="alg1.l1a.m1.1.1.1">←</ci><apply id="alg1.l1a.m1.1.1.2.cmml" xref="alg1.l1a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1a.m1.1.1.2.1.cmml" xref="alg1.l1a.m1.1.1.2">superscript</csymbol><apply id="alg1.l1a.m1.1.1.2.2.cmml" xref="alg1.l1a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1a.m1.1.1.2.2.1.cmml" xref="alg1.l1a.m1.1.1.2">subscript</csymbol><ci id="alg1.l1a.m1.1.1.2.2.2.cmml" xref="alg1.l1a.m1.1.1.2.2.2">𝜓</ci><ci id="alg1.l1a.m1.1.1.2.2.3.cmml" xref="alg1.l1a.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l1a.m1.1.1.2.3.cmml" xref="alg1.l1a.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l1a.m1.1.1.3.cmml" xref="alg1.l1a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1a.m1.1.1.3.1.cmml" xref="alg1.l1a.m1.1.1.3">subscript</csymbol><ci id="alg1.l1a.m1.1.1.3.2.cmml" xref="alg1.l1a.m1.1.1.3.2">𝜓</ci><ci id="alg1.l1a.m1.1.1.3.3.cmml" xref="alg1.l1a.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1a.m1.1c">\psi_{t}^{k}\leftarrow\psi_{t}</annotation></semantics></math>

</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2a.2" class="ltx_text ltx_font_bold">for</span> local epoch <math id="alg1.l2a.m1.4" class="ltx_Math" alttext="e=1,2,\ldots,E/2" display="inline"><semantics id="alg1.l2a.m1.4a"><mrow id="alg1.l2a.m1.4.4" xref="alg1.l2a.m1.4.4.cmml"><mi id="alg1.l2a.m1.4.4.3" xref="alg1.l2a.m1.4.4.3.cmml">e</mi><mo id="alg1.l2a.m1.4.4.2" xref="alg1.l2a.m1.4.4.2.cmml">=</mo><mrow id="alg1.l2a.m1.4.4.1.1" xref="alg1.l2a.m1.4.4.1.2.cmml"><mn id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml">1</mn><mo id="alg1.l2a.m1.4.4.1.1.2" xref="alg1.l2a.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l2a.m1.2.2" xref="alg1.l2a.m1.2.2.cmml">2</mn><mo id="alg1.l2a.m1.4.4.1.1.3" xref="alg1.l2a.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l2a.m1.3.3" xref="alg1.l2a.m1.3.3.cmml">…</mi><mo id="alg1.l2a.m1.4.4.1.1.4" xref="alg1.l2a.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l2a.m1.4.4.1.1.1" xref="alg1.l2a.m1.4.4.1.1.1.cmml"><mi id="alg1.l2a.m1.4.4.1.1.1.2" xref="alg1.l2a.m1.4.4.1.1.1.2.cmml">E</mi><mo id="alg1.l2a.m1.4.4.1.1.1.1" xref="alg1.l2a.m1.4.4.1.1.1.1.cmml">/</mo><mn id="alg1.l2a.m1.4.4.1.1.1.3" xref="alg1.l2a.m1.4.4.1.1.1.3.cmml">2</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.4b"><apply id="alg1.l2a.m1.4.4.cmml" xref="alg1.l2a.m1.4.4"><eq id="alg1.l2a.m1.4.4.2.cmml" xref="alg1.l2a.m1.4.4.2"></eq><ci id="alg1.l2a.m1.4.4.3.cmml" xref="alg1.l2a.m1.4.4.3">𝑒</ci><list id="alg1.l2a.m1.4.4.1.2.cmml" xref="alg1.l2a.m1.4.4.1.1"><cn type="integer" id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1">1</cn><cn type="integer" id="alg1.l2a.m1.2.2.cmml" xref="alg1.l2a.m1.2.2">2</cn><ci id="alg1.l2a.m1.3.3.cmml" xref="alg1.l2a.m1.3.3">…</ci><apply id="alg1.l2a.m1.4.4.1.1.1.cmml" xref="alg1.l2a.m1.4.4.1.1.1"><divide id="alg1.l2a.m1.4.4.1.1.1.1.cmml" xref="alg1.l2a.m1.4.4.1.1.1.1"></divide><ci id="alg1.l2a.m1.4.4.1.1.1.2.cmml" xref="alg1.l2a.m1.4.4.1.1.1.2">𝐸</ci><cn type="integer" id="alg1.l2a.m1.4.4.1.1.1.3.cmml" xref="alg1.l2a.m1.4.4.1.1.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.4c">e=1,2,\ldots,E/2</annotation></semantics></math> <span id="alg1.l2a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3a.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3a.2" class="ltx_text ltx_font_bold">for</span> each batch <math id="alg1.l3a.m1.1" class="ltx_Math" alttext="\left\{\left({\mathbf{x}}_{i}^{k},y_{i}^{k}\right)\right\}_{i=1}^{B}" display="inline"><semantics id="alg1.l3a.m1.1a"><msubsup id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml"><mrow id="alg1.l3a.m1.1.1.1.1.1" xref="alg1.l3a.m1.1.1.1.1.2.cmml"><mo id="alg1.l3a.m1.1.1.1.1.1.2" xref="alg1.l3a.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l3a.m1.1.1.1.1.1.1.2" xref="alg1.l3a.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l3a.m1.1.1.1.1.1.1.2.3" xref="alg1.l3a.m1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="alg1.l3a.m1.1.1.1.1.1.1.1.1" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l3a.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l3a.m1.1.1.1.1.1.1.2.4" xref="alg1.l3a.m1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="alg1.l3a.m1.1.1.1.1.1.1.2.2" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="alg1.l3a.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="alg1.l3a.m1.1.1.1.1.1.1.2.5" xref="alg1.l3a.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l3a.m1.1.1.1.1.1.3" xref="alg1.l3a.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l3a.m1.1.1.1.3" xref="alg1.l3a.m1.1.1.1.3.cmml"><mi id="alg1.l3a.m1.1.1.1.3.2" xref="alg1.l3a.m1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l3a.m1.1.1.1.3.1" xref="alg1.l3a.m1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l3a.m1.1.1.1.3.3" xref="alg1.l3a.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l3a.m1.1.1.3" xref="alg1.l3a.m1.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.1b"><apply id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.2.cmml" xref="alg1.l3a.m1.1.1">superscript</csymbol><apply id="alg1.l3a.m1.1.1.1.cmml" xref="alg1.l3a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.2.cmml" xref="alg1.l3a.m1.1.1">subscript</csymbol><set id="alg1.l3a.m1.1.1.1.1.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1"><interval closure="open" id="alg1.l3a.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2"><apply id="alg1.l3a.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l3a.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l3a.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="alg1.l3a.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l3a.m1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="alg1.l3a.m1.1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.1.3"><eq id="alg1.l3a.m1.1.1.1.3.1.cmml" xref="alg1.l3a.m1.1.1.1.3.1"></eq><ci id="alg1.l3a.m1.1.1.1.3.2.cmml" xref="alg1.l3a.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l3a.m1.1.1.1.3.3.cmml" xref="alg1.l3a.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l3a.m1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.1c">\left\{\left({\mathbf{x}}_{i}^{k},y_{i}^{k}\right)\right\}_{i=1}^{B}</annotation></semantics></math> sampled from <math id="alg1.l3a.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="alg1.l3a.m2.1a"><msub id="alg1.l3a.m2.1.1" xref="alg1.l3a.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3a.m2.1.1.2" xref="alg1.l3a.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l3a.m2.1.1.3" xref="alg1.l3a.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3a.m2.1b"><apply id="alg1.l3a.m2.1.1.cmml" xref="alg1.l3a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m2.1.1.1.cmml" xref="alg1.l3a.m2.1.1">subscript</csymbol><ci id="alg1.l3a.m2.1.1.2.cmml" xref="alg1.l3a.m2.1.1.2">𝒟</ci><ci id="alg1.l3a.m2.1.1.3.cmml" xref="alg1.l3a.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m2.1c">\mathcal{D}_{k}</annotation></semantics></math> <span id="alg1.l3a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4a.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        Update <math id="alg1.l4a.m1.1" class="ltx_Math" alttext="\psi^{k}_{t}" display="inline"><semantics id="alg1.l4a.m1.1a"><msubsup id="alg1.l4a.m1.1.1" xref="alg1.l4a.m1.1.1.cmml"><mi id="alg1.l4a.m1.1.1.2.2" xref="alg1.l4a.m1.1.1.2.2.cmml">ψ</mi><mi id="alg1.l4a.m1.1.1.3" xref="alg1.l4a.m1.1.1.3.cmml">t</mi><mi id="alg1.l4a.m1.1.1.2.3" xref="alg1.l4a.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.1b"><apply id="alg1.l4a.m1.1.1.cmml" xref="alg1.l4a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.cmml" xref="alg1.l4a.m1.1.1">subscript</csymbol><apply id="alg1.l4a.m1.1.1.2.cmml" xref="alg1.l4a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.2.1.cmml" xref="alg1.l4a.m1.1.1">superscript</csymbol><ci id="alg1.l4a.m1.1.1.2.2.cmml" xref="alg1.l4a.m1.1.1.2.2">𝜓</ci><ci id="alg1.l4a.m1.1.1.2.3.cmml" xref="alg1.l4a.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l4a.m1.1.1.3.cmml" xref="alg1.l4a.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.1c">\psi^{k}_{t}</annotation></semantics></math> via the “RS” (Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)

</div>
<div id="alg1.l5a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5a.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6a.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  <span id="alg1.l6a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7a.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  Obtain the model for aggregation: <math id="alg1.l7a.m1.2" class="ltx_Math" alttext="\hat{\psi}_{\text{a},t}^{k}\leftarrow\psi_{t}^{k}" display="inline"><semantics id="alg1.l7a.m1.2a"><mrow id="alg1.l7a.m1.2.3" xref="alg1.l7a.m1.2.3.cmml"><msubsup id="alg1.l7a.m1.2.3.2" xref="alg1.l7a.m1.2.3.2.cmml"><mover accent="true" id="alg1.l7a.m1.2.3.2.2.2" xref="alg1.l7a.m1.2.3.2.2.2.cmml"><mi id="alg1.l7a.m1.2.3.2.2.2.2" xref="alg1.l7a.m1.2.3.2.2.2.2.cmml">ψ</mi><mo id="alg1.l7a.m1.2.3.2.2.2.1" xref="alg1.l7a.m1.2.3.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l7a.m1.2.2.2.4" xref="alg1.l7a.m1.2.2.2.3.cmml"><mtext id="alg1.l7a.m1.1.1.1.1" xref="alg1.l7a.m1.1.1.1.1a.cmml">a</mtext><mo id="alg1.l7a.m1.2.2.2.4.1" xref="alg1.l7a.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l7a.m1.2.2.2.2" xref="alg1.l7a.m1.2.2.2.2.cmml">t</mi></mrow><mi id="alg1.l7a.m1.2.3.2.3" xref="alg1.l7a.m1.2.3.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7a.m1.2.3.1" xref="alg1.l7a.m1.2.3.1.cmml">←</mo><msubsup id="alg1.l7a.m1.2.3.3" xref="alg1.l7a.m1.2.3.3.cmml"><mi id="alg1.l7a.m1.2.3.3.2.2" xref="alg1.l7a.m1.2.3.3.2.2.cmml">ψ</mi><mi id="alg1.l7a.m1.2.3.3.2.3" xref="alg1.l7a.m1.2.3.3.2.3.cmml">t</mi><mi id="alg1.l7a.m1.2.3.3.3" xref="alg1.l7a.m1.2.3.3.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.2b"><apply id="alg1.l7a.m1.2.3.cmml" xref="alg1.l7a.m1.2.3"><ci id="alg1.l7a.m1.2.3.1.cmml" xref="alg1.l7a.m1.2.3.1">←</ci><apply id="alg1.l7a.m1.2.3.2.cmml" xref="alg1.l7a.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.3.2.1.cmml" xref="alg1.l7a.m1.2.3.2">superscript</csymbol><apply id="alg1.l7a.m1.2.3.2.2.cmml" xref="alg1.l7a.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.3.2.2.1.cmml" xref="alg1.l7a.m1.2.3.2">subscript</csymbol><apply id="alg1.l7a.m1.2.3.2.2.2.cmml" xref="alg1.l7a.m1.2.3.2.2.2"><ci id="alg1.l7a.m1.2.3.2.2.2.1.cmml" xref="alg1.l7a.m1.2.3.2.2.2.1">^</ci><ci id="alg1.l7a.m1.2.3.2.2.2.2.cmml" xref="alg1.l7a.m1.2.3.2.2.2.2">𝜓</ci></apply><list id="alg1.l7a.m1.2.2.2.3.cmml" xref="alg1.l7a.m1.2.2.2.4"><ci id="alg1.l7a.m1.1.1.1.1a.cmml" xref="alg1.l7a.m1.1.1.1.1"><mtext mathsize="70%" id="alg1.l7a.m1.1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1.1">a</mtext></ci><ci id="alg1.l7a.m1.2.2.2.2.cmml" xref="alg1.l7a.m1.2.2.2.2">𝑡</ci></list></apply><ci id="alg1.l7a.m1.2.3.2.3.cmml" xref="alg1.l7a.m1.2.3.2.3">𝑘</ci></apply><apply id="alg1.l7a.m1.2.3.3.cmml" xref="alg1.l7a.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.3.3.1.cmml" xref="alg1.l7a.m1.2.3.3">superscript</csymbol><apply id="alg1.l7a.m1.2.3.3.2.cmml" xref="alg1.l7a.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.3.3.2.1.cmml" xref="alg1.l7a.m1.2.3.3">subscript</csymbol><ci id="alg1.l7a.m1.2.3.3.2.2.cmml" xref="alg1.l7a.m1.2.3.3.2.2">𝜓</ci><ci id="alg1.l7a.m1.2.3.3.2.3.cmml" xref="alg1.l7a.m1.2.3.3.2.3">𝑡</ci></apply><ci id="alg1.l7a.m1.2.3.3.3.cmml" xref="alg1.l7a.m1.2.3.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.2c">\hat{\psi}_{\text{a},t}^{k}\leftarrow\psi_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l8a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8a.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <span id="alg1.l8a.2" class="ltx_text ltx_font_bold">for</span> local epoch <math id="alg1.l8a.m1.4" class="ltx_Math" alttext="e=E/2+1,E/2+2,\ldots,E" display="inline"><semantics id="alg1.l8a.m1.4a"><mrow id="alg1.l8a.m1.4.4" xref="alg1.l8a.m1.4.4.cmml"><mi id="alg1.l8a.m1.4.4.4" xref="alg1.l8a.m1.4.4.4.cmml">e</mi><mo id="alg1.l8a.m1.4.4.3" xref="alg1.l8a.m1.4.4.3.cmml">=</mo><mrow id="alg1.l8a.m1.4.4.2.2" xref="alg1.l8a.m1.4.4.2.3.cmml"><mrow id="alg1.l8a.m1.3.3.1.1.1" xref="alg1.l8a.m1.3.3.1.1.1.cmml"><mrow id="alg1.l8a.m1.3.3.1.1.1.2" xref="alg1.l8a.m1.3.3.1.1.1.2.cmml"><mi id="alg1.l8a.m1.3.3.1.1.1.2.2" xref="alg1.l8a.m1.3.3.1.1.1.2.2.cmml">E</mi><mo id="alg1.l8a.m1.3.3.1.1.1.2.1" xref="alg1.l8a.m1.3.3.1.1.1.2.1.cmml">/</mo><mn id="alg1.l8a.m1.3.3.1.1.1.2.3" xref="alg1.l8a.m1.3.3.1.1.1.2.3.cmml">2</mn></mrow><mo id="alg1.l8a.m1.3.3.1.1.1.1" xref="alg1.l8a.m1.3.3.1.1.1.1.cmml">+</mo><mn id="alg1.l8a.m1.3.3.1.1.1.3" xref="alg1.l8a.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l8a.m1.4.4.2.2.3" xref="alg1.l8a.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.l8a.m1.4.4.2.2.2" xref="alg1.l8a.m1.4.4.2.2.2.cmml"><mrow id="alg1.l8a.m1.4.4.2.2.2.2" xref="alg1.l8a.m1.4.4.2.2.2.2.cmml"><mi id="alg1.l8a.m1.4.4.2.2.2.2.2" xref="alg1.l8a.m1.4.4.2.2.2.2.2.cmml">E</mi><mo id="alg1.l8a.m1.4.4.2.2.2.2.1" xref="alg1.l8a.m1.4.4.2.2.2.2.1.cmml">/</mo><mn id="alg1.l8a.m1.4.4.2.2.2.2.3" xref="alg1.l8a.m1.4.4.2.2.2.2.3.cmml">2</mn></mrow><mo id="alg1.l8a.m1.4.4.2.2.2.1" xref="alg1.l8a.m1.4.4.2.2.2.1.cmml">+</mo><mn id="alg1.l8a.m1.4.4.2.2.2.3" xref="alg1.l8a.m1.4.4.2.2.2.3.cmml">2</mn></mrow><mo id="alg1.l8a.m1.4.4.2.2.4" xref="alg1.l8a.m1.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l8a.m1.1.1" xref="alg1.l8a.m1.1.1.cmml">…</mi><mo id="alg1.l8a.m1.4.4.2.2.5" xref="alg1.l8a.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l8a.m1.2.2" xref="alg1.l8a.m1.2.2.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.4b"><apply id="alg1.l8a.m1.4.4.cmml" xref="alg1.l8a.m1.4.4"><eq id="alg1.l8a.m1.4.4.3.cmml" xref="alg1.l8a.m1.4.4.3"></eq><ci id="alg1.l8a.m1.4.4.4.cmml" xref="alg1.l8a.m1.4.4.4">𝑒</ci><list id="alg1.l8a.m1.4.4.2.3.cmml" xref="alg1.l8a.m1.4.4.2.2"><apply id="alg1.l8a.m1.3.3.1.1.1.cmml" xref="alg1.l8a.m1.3.3.1.1.1"><plus id="alg1.l8a.m1.3.3.1.1.1.1.cmml" xref="alg1.l8a.m1.3.3.1.1.1.1"></plus><apply id="alg1.l8a.m1.3.3.1.1.1.2.cmml" xref="alg1.l8a.m1.3.3.1.1.1.2"><divide id="alg1.l8a.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l8a.m1.3.3.1.1.1.2.1"></divide><ci id="alg1.l8a.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l8a.m1.3.3.1.1.1.2.2">𝐸</ci><cn type="integer" id="alg1.l8a.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l8a.m1.3.3.1.1.1.2.3">2</cn></apply><cn type="integer" id="alg1.l8a.m1.3.3.1.1.1.3.cmml" xref="alg1.l8a.m1.3.3.1.1.1.3">1</cn></apply><apply id="alg1.l8a.m1.4.4.2.2.2.cmml" xref="alg1.l8a.m1.4.4.2.2.2"><plus id="alg1.l8a.m1.4.4.2.2.2.1.cmml" xref="alg1.l8a.m1.4.4.2.2.2.1"></plus><apply id="alg1.l8a.m1.4.4.2.2.2.2.cmml" xref="alg1.l8a.m1.4.4.2.2.2.2"><divide id="alg1.l8a.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l8a.m1.4.4.2.2.2.2.1"></divide><ci id="alg1.l8a.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l8a.m1.4.4.2.2.2.2.2">𝐸</ci><cn type="integer" id="alg1.l8a.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l8a.m1.4.4.2.2.2.2.3">2</cn></apply><cn type="integer" id="alg1.l8a.m1.4.4.2.2.2.3.cmml" xref="alg1.l8a.m1.4.4.2.2.2.3">2</cn></apply><ci id="alg1.l8a.m1.1.1.cmml" xref="alg1.l8a.m1.1.1">…</ci><ci id="alg1.l8a.m1.2.2.cmml" xref="alg1.l8a.m1.2.2">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.4c">e=E/2+1,E/2+2,\ldots,E</annotation></semantics></math> <span id="alg1.l8a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span> each batch <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\left\{\left({\mathbf{x}}_{i}^{k},y_{i}^{k}\right)\right\}_{i=1}^{B}" display="inline"><semantics id="alg1.l9.m1.1a"><msubsup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.2.cmml"><mo id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l9.m1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="alg1.l9.m1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l9.m1.1.1.1.1.1.1.2.4" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="alg1.l9.m1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="alg1.l9.m1.1.1.1.1.1.1.2.5" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><set id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1"><interval closure="open" id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><eq id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3.1"></eq><ci id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\left\{\left({\mathbf{x}}_{i}^{k},y_{i}^{k}\right)\right\}_{i=1}^{B}</annotation></semantics></math> sampled from <math id="alg1.l9.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝒟</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\mathcal{D}_{k}</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        Update <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\psi^{k}_{t}" display="inline"><semantics id="alg1.l10.m1.1a"><msubsup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">ψ</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">t</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝜓</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\psi^{k}_{t}</annotation></semantics></math> via the softmax and the KD loss (Eq. <a href="#S4.E13" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>)

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  Obtain the personalized model: <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\hat{\psi}_{t}^{k}\leftarrow\psi_{t}^{k}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msubsup id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mover accent="true" id="alg1.l13.m1.1.1.2.2.2" xref="alg1.l13.m1.1.1.2.2.2.cmml"><mi id="alg1.l13.m1.1.1.2.2.2.2" xref="alg1.l13.m1.1.1.2.2.2.2.cmml">ψ</mi><mo id="alg1.l13.m1.1.1.2.2.2.1" xref="alg1.l13.m1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l13.m1.1.1.2.2.3" xref="alg1.l13.m1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">ψ</mi><mi id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">superscript</csymbol><apply id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><apply id="alg1.l13.m1.1.1.2.2.2.cmml" xref="alg1.l13.m1.1.1.2.2.2"><ci id="alg1.l13.m1.1.1.2.2.2.1.cmml" xref="alg1.l13.m1.1.1.2.2.2.1">^</ci><ci id="alg1.l13.m1.1.1.2.2.2.2.cmml" xref="alg1.l13.m1.1.1.2.2.2.2">𝜓</ci></apply><ci id="alg1.l13.m1.1.1.2.2.3.cmml" xref="alg1.l13.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝜓</ci><ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\hat{\psi}_{t}^{k}\leftarrow\psi_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  Update the “HPM”: <math id="alg1.l14.m1.5" class="ltx_Math" alttext="\psi_{\text{p},t+1}^{k}\leftarrow(1-\mu_{t}^{k})\hat{\psi}_{t}^{k}+\mu_{t}^{k}\psi_{\text{p},t}^{k}" display="inline"><semantics id="alg1.l14.m1.5a"><mrow id="alg1.l14.m1.5.5" xref="alg1.l14.m1.5.5.cmml"><msubsup id="alg1.l14.m1.5.5.3" xref="alg1.l14.m1.5.5.3.cmml"><mi id="alg1.l14.m1.5.5.3.2.2" xref="alg1.l14.m1.5.5.3.2.2.cmml">ψ</mi><mrow id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml"><mtext id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1a.cmml">p</mtext><mo id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l14.m1.2.2.2.2.1" xref="alg1.l14.m1.2.2.2.2.1.cmml"><mi id="alg1.l14.m1.2.2.2.2.1.2" xref="alg1.l14.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.2.2.1.1" xref="alg1.l14.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.2.2.1.3" xref="alg1.l14.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="alg1.l14.m1.5.5.3.3" xref="alg1.l14.m1.5.5.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l14.m1.5.5.2" xref="alg1.l14.m1.5.5.2.cmml">←</mo><mrow id="alg1.l14.m1.5.5.1" xref="alg1.l14.m1.5.5.1.cmml"><mrow id="alg1.l14.m1.5.5.1.1" xref="alg1.l14.m1.5.5.1.1.cmml"><mrow id="alg1.l14.m1.5.5.1.1.1.1" xref="alg1.l14.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.5.5.1.1.1.1.2" xref="alg1.l14.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.5.5.1.1.1.1.1" xref="alg1.l14.m1.5.5.1.1.1.1.1.cmml"><mn id="alg1.l14.m1.5.5.1.1.1.1.1.2" xref="alg1.l14.m1.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l14.m1.5.5.1.1.1.1.1.1" xref="alg1.l14.m1.5.5.1.1.1.1.1.1.cmml">−</mo><msubsup id="alg1.l14.m1.5.5.1.1.1.1.1.3" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.2" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.2.2.cmml">μ</mi><mi id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.3" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l14.m1.5.5.1.1.1.1.1.3.3" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l14.m1.5.5.1.1.1.1.3" xref="alg1.l14.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.5.5.1.1.2" xref="alg1.l14.m1.5.5.1.1.2.cmml">​</mo><msubsup id="alg1.l14.m1.5.5.1.1.3" xref="alg1.l14.m1.5.5.1.1.3.cmml"><mover accent="true" id="alg1.l14.m1.5.5.1.1.3.2.2" xref="alg1.l14.m1.5.5.1.1.3.2.2.cmml"><mi id="alg1.l14.m1.5.5.1.1.3.2.2.2" xref="alg1.l14.m1.5.5.1.1.3.2.2.2.cmml">ψ</mi><mo id="alg1.l14.m1.5.5.1.1.3.2.2.1" xref="alg1.l14.m1.5.5.1.1.3.2.2.1.cmml">^</mo></mover><mi id="alg1.l14.m1.5.5.1.1.3.2.3" xref="alg1.l14.m1.5.5.1.1.3.2.3.cmml">t</mi><mi id="alg1.l14.m1.5.5.1.1.3.3" xref="alg1.l14.m1.5.5.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="alg1.l14.m1.5.5.1.2" xref="alg1.l14.m1.5.5.1.2.cmml">+</mo><mrow id="alg1.l14.m1.5.5.1.3" xref="alg1.l14.m1.5.5.1.3.cmml"><msubsup id="alg1.l14.m1.5.5.1.3.2" xref="alg1.l14.m1.5.5.1.3.2.cmml"><mi id="alg1.l14.m1.5.5.1.3.2.2.2" xref="alg1.l14.m1.5.5.1.3.2.2.2.cmml">μ</mi><mi id="alg1.l14.m1.5.5.1.3.2.2.3" xref="alg1.l14.m1.5.5.1.3.2.2.3.cmml">t</mi><mi id="alg1.l14.m1.5.5.1.3.2.3" xref="alg1.l14.m1.5.5.1.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l14.m1.5.5.1.3.1" xref="alg1.l14.m1.5.5.1.3.1.cmml">​</mo><msubsup id="alg1.l14.m1.5.5.1.3.3" xref="alg1.l14.m1.5.5.1.3.3.cmml"><mi id="alg1.l14.m1.5.5.1.3.3.2.2" xref="alg1.l14.m1.5.5.1.3.3.2.2.cmml">ψ</mi><mrow id="alg1.l14.m1.4.4.2.4" xref="alg1.l14.m1.4.4.2.3.cmml"><mtext id="alg1.l14.m1.3.3.1.1" xref="alg1.l14.m1.3.3.1.1a.cmml">p</mtext><mo id="alg1.l14.m1.4.4.2.4.1" xref="alg1.l14.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l14.m1.4.4.2.2" xref="alg1.l14.m1.4.4.2.2.cmml">t</mi></mrow><mi id="alg1.l14.m1.5.5.1.3.3.3" xref="alg1.l14.m1.5.5.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.5b"><apply id="alg1.l14.m1.5.5.cmml" xref="alg1.l14.m1.5.5"><ci id="alg1.l14.m1.5.5.2.cmml" xref="alg1.l14.m1.5.5.2">←</ci><apply id="alg1.l14.m1.5.5.3.cmml" xref="alg1.l14.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.3.1.cmml" xref="alg1.l14.m1.5.5.3">superscript</csymbol><apply id="alg1.l14.m1.5.5.3.2.cmml" xref="alg1.l14.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.3.2.1.cmml" xref="alg1.l14.m1.5.5.3">subscript</csymbol><ci id="alg1.l14.m1.5.5.3.2.2.cmml" xref="alg1.l14.m1.5.5.3.2.2">𝜓</ci><list id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2"><ci id="alg1.l14.m1.1.1.1.1a.cmml" xref="alg1.l14.m1.1.1.1.1"><mtext mathsize="70%" id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">p</mtext></ci><apply id="alg1.l14.m1.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.1"><plus id="alg1.l14.m1.2.2.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.1.1"></plus><ci id="alg1.l14.m1.2.2.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l14.m1.2.2.2.2.1.3.cmml" xref="alg1.l14.m1.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l14.m1.5.5.3.3.cmml" xref="alg1.l14.m1.5.5.3.3">𝑘</ci></apply><apply id="alg1.l14.m1.5.5.1.cmml" xref="alg1.l14.m1.5.5.1"><plus id="alg1.l14.m1.5.5.1.2.cmml" xref="alg1.l14.m1.5.5.1.2"></plus><apply id="alg1.l14.m1.5.5.1.1.cmml" xref="alg1.l14.m1.5.5.1.1"><times id="alg1.l14.m1.5.5.1.1.2.cmml" xref="alg1.l14.m1.5.5.1.1.2"></times><apply id="alg1.l14.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l14.m1.5.5.1.1.1.1"><minus id="alg1.l14.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l14.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.2">1</cn><apply id="alg1.l14.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.2.2">𝜇</ci><ci id="alg1.l14.m1.5.5.1.1.1.1.1.3.2.3.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.5.5.1.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.5.5.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l14.m1.5.5.1.1.3.cmml" xref="alg1.l14.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.1.3.1.cmml" xref="alg1.l14.m1.5.5.1.1.3">superscript</csymbol><apply id="alg1.l14.m1.5.5.1.1.3.2.cmml" xref="alg1.l14.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.1.3.2.1.cmml" xref="alg1.l14.m1.5.5.1.1.3">subscript</csymbol><apply id="alg1.l14.m1.5.5.1.1.3.2.2.cmml" xref="alg1.l14.m1.5.5.1.1.3.2.2"><ci id="alg1.l14.m1.5.5.1.1.3.2.2.1.cmml" xref="alg1.l14.m1.5.5.1.1.3.2.2.1">^</ci><ci id="alg1.l14.m1.5.5.1.1.3.2.2.2.cmml" xref="alg1.l14.m1.5.5.1.1.3.2.2.2">𝜓</ci></apply><ci id="alg1.l14.m1.5.5.1.1.3.2.3.cmml" xref="alg1.l14.m1.5.5.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.5.5.1.1.3.3.cmml" xref="alg1.l14.m1.5.5.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l14.m1.5.5.1.3.cmml" xref="alg1.l14.m1.5.5.1.3"><times id="alg1.l14.m1.5.5.1.3.1.cmml" xref="alg1.l14.m1.5.5.1.3.1"></times><apply id="alg1.l14.m1.5.5.1.3.2.cmml" xref="alg1.l14.m1.5.5.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.3.2.1.cmml" xref="alg1.l14.m1.5.5.1.3.2">superscript</csymbol><apply id="alg1.l14.m1.5.5.1.3.2.2.cmml" xref="alg1.l14.m1.5.5.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.3.2.2.1.cmml" xref="alg1.l14.m1.5.5.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.5.5.1.3.2.2.2.cmml" xref="alg1.l14.m1.5.5.1.3.2.2.2">𝜇</ci><ci id="alg1.l14.m1.5.5.1.3.2.2.3.cmml" xref="alg1.l14.m1.5.5.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.5.5.1.3.2.3.cmml" xref="alg1.l14.m1.5.5.1.3.2.3">𝑘</ci></apply><apply id="alg1.l14.m1.5.5.1.3.3.cmml" xref="alg1.l14.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.3.3.1.cmml" xref="alg1.l14.m1.5.5.1.3.3">superscript</csymbol><apply id="alg1.l14.m1.5.5.1.3.3.2.cmml" xref="alg1.l14.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.3.3.2.1.cmml" xref="alg1.l14.m1.5.5.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.5.5.1.3.3.2.2.cmml" xref="alg1.l14.m1.5.5.1.3.3.2.2">𝜓</ci><list id="alg1.l14.m1.4.4.2.3.cmml" xref="alg1.l14.m1.4.4.2.4"><ci id="alg1.l14.m1.3.3.1.1a.cmml" xref="alg1.l14.m1.3.3.1.1"><mtext mathsize="70%" id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">p</mtext></ci><ci id="alg1.l14.m1.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.2.2">𝑡</ci></list></apply><ci id="alg1.l14.m1.5.5.1.3.3.3.cmml" xref="alg1.l14.m1.5.5.1.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.5c">\psi_{\text{p},t+1}^{k}\leftarrow(1-\mu_{t}^{k})\hat{\psi}_{t}^{k}+\mu_{t}^{k}\psi_{\text{p},t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  Adjust <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\mu_{t}^{k}" display="inline"><semantics id="alg1.l15.m1.1a"><msubsup id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">μ</mi><mi id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml">t</mi><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">superscript</csymbol><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝜇</ci><ci id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mu_{t}^{k}</annotation></semantics></math> as in Sect. <a href="#S4.SS2" title="4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">Return</span>: <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\hat{\psi}_{\text{a},t}^{k}" display="inline"><semantics id="alg1.l16.m1.2a"><msubsup id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><mover accent="true" id="alg1.l16.m1.2.3.2.2" xref="alg1.l16.m1.2.3.2.2.cmml"><mi id="alg1.l16.m1.2.3.2.2.2" xref="alg1.l16.m1.2.3.2.2.2.cmml">ψ</mi><mo id="alg1.l16.m1.2.3.2.2.1" xref="alg1.l16.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="alg1.l16.m1.2.2.2.4" xref="alg1.l16.m1.2.2.2.3.cmml"><mtext id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1a.cmml">a</mtext><mo id="alg1.l16.m1.2.2.2.4.1" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">t</mi></mrow><mi id="alg1.l16.m1.2.3.3" xref="alg1.l16.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3">superscript</csymbol><apply id="alg1.l16.m1.2.3.2.cmml" xref="alg1.l16.m1.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.2.1.cmml" xref="alg1.l16.m1.2.3">subscript</csymbol><apply id="alg1.l16.m1.2.3.2.2.cmml" xref="alg1.l16.m1.2.3.2.2"><ci id="alg1.l16.m1.2.3.2.2.1.cmml" xref="alg1.l16.m1.2.3.2.2.1">^</ci><ci id="alg1.l16.m1.2.3.2.2.2.cmml" xref="alg1.l16.m1.2.3.2.2.2">𝜓</ci></apply><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.4"><ci id="alg1.l16.m1.1.1.1.1a.cmml" xref="alg1.l16.m1.1.1.1.1"><mtext mathsize="70%" id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">a</mtext></ci><ci id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2">𝑡</ci></list></apply><ci id="alg1.l16.m1.2.3.3.cmml" xref="alg1.l16.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\hat{\psi}_{\text{a},t}^{k}</annotation></semantics></math>, <math id="alg1.l16.m2.2" class="ltx_Math" alttext="\psi_{\text{p},t+1}^{k}" display="inline"><semantics id="alg1.l16.m2.2a"><msubsup id="alg1.l16.m2.2.3" xref="alg1.l16.m2.2.3.cmml"><mi id="alg1.l16.m2.2.3.2.2" xref="alg1.l16.m2.2.3.2.2.cmml">ψ</mi><mrow id="alg1.l16.m2.2.2.2.2" xref="alg1.l16.m2.2.2.2.3.cmml"><mtext id="alg1.l16.m2.1.1.1.1" xref="alg1.l16.m2.1.1.1.1a.cmml">p</mtext><mo id="alg1.l16.m2.2.2.2.2.2" xref="alg1.l16.m2.2.2.2.3.cmml">,</mo><mrow id="alg1.l16.m2.2.2.2.2.1" xref="alg1.l16.m2.2.2.2.2.1.cmml"><mi id="alg1.l16.m2.2.2.2.2.1.2" xref="alg1.l16.m2.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l16.m2.2.2.2.2.1.1" xref="alg1.l16.m2.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l16.m2.2.2.2.2.1.3" xref="alg1.l16.m2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="alg1.l16.m2.2.3.3" xref="alg1.l16.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.2b"><apply id="alg1.l16.m2.2.3.cmml" xref="alg1.l16.m2.2.3"><csymbol cd="ambiguous" id="alg1.l16.m2.2.3.1.cmml" xref="alg1.l16.m2.2.3">superscript</csymbol><apply id="alg1.l16.m2.2.3.2.cmml" xref="alg1.l16.m2.2.3"><csymbol cd="ambiguous" id="alg1.l16.m2.2.3.2.1.cmml" xref="alg1.l16.m2.2.3">subscript</csymbol><ci id="alg1.l16.m2.2.3.2.2.cmml" xref="alg1.l16.m2.2.3.2.2">𝜓</ci><list id="alg1.l16.m2.2.2.2.3.cmml" xref="alg1.l16.m2.2.2.2.2"><ci id="alg1.l16.m2.1.1.1.1a.cmml" xref="alg1.l16.m2.1.1.1.1"><mtext mathsize="70%" id="alg1.l16.m2.1.1.1.1.cmml" xref="alg1.l16.m2.1.1.1.1">p</mtext></ci><apply id="alg1.l16.m2.2.2.2.2.1.cmml" xref="alg1.l16.m2.2.2.2.2.1"><plus id="alg1.l16.m2.2.2.2.2.1.1.cmml" xref="alg1.l16.m2.2.2.2.2.1.1"></plus><ci id="alg1.l16.m2.2.2.2.2.1.2.cmml" xref="alg1.l16.m2.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l16.m2.2.2.2.2.1.3.cmml" xref="alg1.l16.m2.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l16.m2.2.3.3.cmml" xref="alg1.l16.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.2c">\psi_{\text{p},t+1}^{k}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span id="S4.SS3.1.1" class="ltx_text ltx_font_italic">Proposed MAP and Discussions</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We propose MAP via seamlessly combining the proposed “RS” and “HPM” in FL. The illustration is shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We follow the architecture and training paradigm of FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Different from FedAvg, we take two stages of training in each personalization procedure. In the first personalization stage, we utilize “RS” (Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) instead of normal softmax to restrict the update of missing classes’ proxies, and the updated model is sent to the server for better aggregation. In the second personalization stage, we switch “RS” to softmax and continue training on the client’s local data. The personalization is supervised via the normal training loss and the knowledge distillation loss from the “HPM” (Eq. <a href="#S4.E13" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>). The final personalized model is fused into the “HPM” via moving average (Eq. <a href="#S4.E10" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). Obviously, the first stage benefits the model aggregation, and the second stage benefits the model personalization. That is, the proposed MAP could simultaneously achieve the model aggregation and personalization goals in FL with incomplete classes. The pseudo-code is listed in Algo. <a href="#alg1" title="Algorithm 1 ‣ 4.2.3 Theoretical Analysis ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.4" class="ltx_p">Discussions from several other aspects could also explain the advantages of the proposed method. Adding scaling factors to softmax can be seen as applying an effective learning rate of <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha\eta" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">η</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><times id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></times><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝛼</ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝜂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\alpha\eta</annotation></semantics></math>, <math id="S4.SS3.p2.2.m2.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.3" xref="S4.SS3.p2.2.m2.2.3.cmml"><mi id="S4.SS3.p2.2.m2.2.3.2" xref="S4.SS3.p2.2.m2.2.3.2.cmml">α</mi><mo id="S4.SS3.p2.2.m2.2.3.1" xref="S4.SS3.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS3.p2.2.m2.2.3.3.2" xref="S4.SS3.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.2.m2.2.3.3.2.1" xref="S4.SS3.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">0</mn><mo id="S4.SS3.p2.2.m2.2.3.3.2.2" xref="S4.SS3.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p2.2.m2.2.2" xref="S4.SS3.p2.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p2.2.m2.2.3.3.2.3" xref="S4.SS3.p2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><apply id="S4.SS3.p2.2.m2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.3"><in id="S4.SS3.p2.2.m2.2.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3.1"></in><ci id="S4.SS3.p2.2.m2.2.3.2.cmml" xref="S4.SS3.p2.2.m2.2.3.2">𝛼</ci><interval closure="closed" id="S4.SS3.p2.2.m2.2.3.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3.3.2"><cn type="integer" id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">0</cn><cn type="integer" id="S4.SS3.p2.2.m2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">\alpha\in[0,1]</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>.
“RS” is similar to PC-Softmax <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>, which corrects the problem of imbalanced data from the aspect of “scores” as <math id="S4.SS3.p2.3.m3.2" class="ltx_Math" alttext="p_{c}\propto\exp(p(y=c){\mathbf{w}}_{c}^{T}{\mathbf{h}})" display="inline"><semantics id="S4.SS3.p2.3.m3.2a"><mrow id="S4.SS3.p2.3.m3.2.2" xref="S4.SS3.p2.3.m3.2.2.cmml"><msub id="S4.SS3.p2.3.m3.2.2.3" xref="S4.SS3.p2.3.m3.2.2.3.cmml"><mi id="S4.SS3.p2.3.m3.2.2.3.2" xref="S4.SS3.p2.3.m3.2.2.3.2.cmml">p</mi><mi id="S4.SS3.p2.3.m3.2.2.3.3" xref="S4.SS3.p2.3.m3.2.2.3.3.cmml">c</mi></msub><mo id="S4.SS3.p2.3.m3.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.cmml">∝</mo><mrow id="S4.SS3.p2.3.m3.2.2.1.1" xref="S4.SS3.p2.3.m3.2.2.1.2.cmml"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">exp</mi><mo id="S4.SS3.p2.3.m3.2.2.1.1a" xref="S4.SS3.p2.3.m3.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS3.p2.3.m3.2.2.1.1.1" xref="S4.SS3.p2.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.3.m3.2.2.1.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.2.cmml">(</mo><mrow id="S4.SS3.p2.3.m3.2.2.1.1.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.2a" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.2.cmml">​</mo><msubsup id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.cmml"><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.2" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.2.cmml">𝐰</mi><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.3" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.3.cmml">c</mi><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.3" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.2b" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p2.3.m3.2.2.1.1.1.1.5" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.5.cmml">𝐡</mi></mrow><mo stretchy="false" id="S4.SS3.p2.3.m3.2.2.1.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.2b"><apply id="S4.SS3.p2.3.m3.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2"><csymbol cd="latexml" id="S4.SS3.p2.3.m3.2.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2">proportional-to</csymbol><apply id="S4.SS3.p2.3.m3.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.2.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.2.3.2">𝑝</ci><ci id="S4.SS3.p2.3.m3.2.2.3.3.cmml" xref="S4.SS3.p2.3.m3.2.2.3.3">𝑐</ci></apply><apply id="S4.SS3.p2.3.m3.2.2.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1"><exp id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"></exp><apply id="S4.SS3.p2.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1"><times id="S4.SS3.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.2"></times><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.3">𝑝</ci><apply id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1"><eq id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.1"></eq><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4">superscript</csymbol><apply id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.2">𝐰</ci><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.2.3">𝑐</ci></apply><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.3.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.4.3">𝑇</ci></apply><ci id="S4.SS3.p2.3.m3.2.2.1.1.1.1.5.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.1.1.5">𝐡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.2c">p_{c}\propto\exp(p(y=c){\mathbf{w}}_{c}^{T}{\mathbf{h}})</annotation></semantics></math>, where we take a smooth prior distribution <math id="S4.SS3.p2.4.m4.3" class="ltx_Math" alttext="p(y=c)\propto{\mathcal{I}}\{c\in{\mathcal{O}}\}+\alpha{\mathcal{I}}\{c\in{\mathcal{M}}\}" display="inline"><semantics id="S4.SS3.p2.4.m4.3a"><mrow id="S4.SS3.p2.4.m4.3.3" xref="S4.SS3.p2.4.m4.3.3.cmml"><mrow id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.1.3" xref="S4.SS3.p2.4.m4.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.1.2" xref="S4.SS3.p2.4.m4.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p2.4.m4.1.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.4.m4.1.1.1.1.1.2" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.4.m4.1.1.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.1.1.1.1.2" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.SS3.p2.4.m4.1.1.1.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS3.p2.4.m4.1.1.1.1.1.1.3" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.SS3.p2.4.m4.1.1.1.1.1.3" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.4.m4.3.3.4" xref="S4.SS3.p2.4.m4.3.3.4.cmml">∝</mo><mrow id="S4.SS3.p2.4.m4.3.3.3" xref="S4.SS3.p2.4.m4.3.3.3.cmml"><mrow id="S4.SS3.p2.4.m4.2.2.2.1" xref="S4.SS3.p2.4.m4.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.2.2.2.1.3" xref="S4.SS3.p2.4.m4.2.2.2.1.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.2.2.2.1.2" xref="S4.SS3.p2.4.m4.2.2.2.1.2.cmml">​</mo><mrow id="S4.SS3.p2.4.m4.2.2.2.1.1.1" xref="S4.SS3.p2.4.m4.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.4.m4.2.2.2.1.1.1.2" xref="S4.SS3.p2.4.m4.2.2.2.1.1.2.cmml">{</mo><mrow id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.cmml"><mi id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.2" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.2.cmml">c</mi><mo id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.1" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.3" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.3.cmml">𝒪</mi></mrow><mo stretchy="false" id="S4.SS3.p2.4.m4.2.2.2.1.1.1.3" xref="S4.SS3.p2.4.m4.2.2.2.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.SS3.p2.4.m4.3.3.3.3" xref="S4.SS3.p2.4.m4.3.3.3.3.cmml">+</mo><mrow id="S4.SS3.p2.4.m4.3.3.3.2" xref="S4.SS3.p2.4.m4.3.3.3.2.cmml"><mi id="S4.SS3.p2.4.m4.3.3.3.2.3" xref="S4.SS3.p2.4.m4.3.3.3.2.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.3.3.3.2.2" xref="S4.SS3.p2.4.m4.3.3.3.2.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.3.3.3.2.4" xref="S4.SS3.p2.4.m4.3.3.3.2.4.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.3.3.3.2.2a" xref="S4.SS3.p2.4.m4.3.3.3.2.2.cmml">​</mo><mrow id="S4.SS3.p2.4.m4.3.3.3.2.1.1" xref="S4.SS3.p2.4.m4.3.3.3.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.4.m4.3.3.3.2.1.1.2" xref="S4.SS3.p2.4.m4.3.3.3.2.1.2.cmml">{</mo><mrow id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.cmml"><mi id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.2" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.2.cmml">c</mi><mo id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.1" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.3" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.3.cmml">ℳ</mi></mrow><mo stretchy="false" id="S4.SS3.p2.4.m4.3.3.3.2.1.1.3" xref="S4.SS3.p2.4.m4.3.3.3.2.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.3b"><apply id="S4.SS3.p2.4.m4.3.3.cmml" xref="S4.SS3.p2.4.m4.3.3"><csymbol cd="latexml" id="S4.SS3.p2.4.m4.3.3.4.cmml" xref="S4.SS3.p2.4.m4.3.3.4">proportional-to</csymbol><apply id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"><times id="S4.SS3.p2.4.m4.1.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.1.2"></times><ci id="S4.SS3.p2.4.m4.1.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.1.3">𝑝</ci><apply id="S4.SS3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.1"><eq id="S4.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.1"></eq><ci id="S4.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS3.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S4.SS3.p2.4.m4.3.3.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3"><plus id="S4.SS3.p2.4.m4.3.3.3.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3"></plus><apply id="S4.SS3.p2.4.m4.2.2.2.1.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1"><times id="S4.SS3.p2.4.m4.2.2.2.1.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.2"></times><ci id="S4.SS3.p2.4.m4.2.2.2.1.3.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.3">ℐ</ci><set id="S4.SS3.p2.4.m4.2.2.2.1.1.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1"><apply id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1"><in id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.1"></in><ci id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.2">𝑐</ci><ci id="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.3.cmml" xref="S4.SS3.p2.4.m4.2.2.2.1.1.1.1.3">𝒪</ci></apply></set></apply><apply id="S4.SS3.p2.4.m4.3.3.3.2.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2"><times id="S4.SS3.p2.4.m4.3.3.3.2.2.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.2"></times><ci id="S4.SS3.p2.4.m4.3.3.3.2.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.3">𝛼</ci><ci id="S4.SS3.p2.4.m4.3.3.3.2.4.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.4">ℐ</ci><set id="S4.SS3.p2.4.m4.3.3.3.2.1.2.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1"><apply id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1"><in id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.1"></in><ci id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.2.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.2">𝑐</ci><ci id="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3.2.1.1.1.3">ℳ</ci></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.3c">p(y=c)\propto{\mathcal{I}}\{c\in{\mathcal{O}}\}+\alpha{\mathcal{I}}\{c\in{\mathcal{M}}\}</annotation></semantics></math>.
The moving average in “HPM” is inherently one type of temporal ensembling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>, which works similarly as the self-ensembling and mean teacher in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We investigate our methods on several FL benchmarks constructed from FaMnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite>, CIFAR-10/100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, and CINIC-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>. We also explore the FeMnist benchmark recommended by LEAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>. For visualization and analysis, we also utilize Mnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite> data.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span><span id="S5.SS1.1.1" class="ltx_text ltx_font_italic">Observations</span>
</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Softmax with Missing Classes</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">We first verify the Property <a href="#Thmproperty2" title="Property 2 (Problem of Softmax with Missing Classes). ‣ 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> via visualization on Mnist. We slightly modify LeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> by setting the final hidden dimension as 2 for better visualization. We select Mnist data from the first 8, 5, and 2 classes, and then train LeNet on these data correspondingly. We use SGD with a momentum of 0.9 as the optimizer. The learning rate is 0.01. The number of training epochs is 50. The results are shown in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1.1 Softmax with Missing Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The top/bottom shows the results of LeNet with/without ReLU activation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib73" title="" class="ltx_ref">73</a>]</cite> before the final classification layer. Arrows show the learned proxies and the white ones show proxies of missing classes. We scale the norm of proxies by 10x for better visualization. Not so rigorously, the proxies of missing classes are updated towards the negative direction of existing samples’ center according to Eq. <a href="#S4.E6" title="In 4.1.2 Softmax with Missing Classes ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. First, proxies of missing classes are sometimes squeezed towards the point of origin. Second, as the number of missing classes increases, the features of observed classes become less compact. Regardless of the ReLU activation function, the missing classes’ proxies tend to be inaccurate and have a smaller norm.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2404.09232/assets/x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S5.F5.2.1" class="ltx_text" style="font-size:90%;">Visualization of learned features and proxies with 8, 5, and 2 observed classes, respectively.</span></figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2404.09232/assets/x6.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="111" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S5.F6.2.1" class="ltx_text" style="font-size:90%;">The change of observed and missing classes’ proxies during training with incomplete classes.</span></figcaption>
</figure>
<div id="S5.SS1.SSS1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.p2.5" class="ltx_p">We also explore the change of proxies during the training process. Specifically, we train VGG11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>]</cite> with batch normalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib75" title="" class="ltx_ref">75</a>]</cite> on CIFAR-10. We sample the first 8 classes as observed classes and the other 2 classes as missing ones. We still use SGD with a momentum of 0.9 as the optimizer. The learning rate is 0.03. The number of training epochs is 50. After each training epoch, we record some statistics of the proxies including: (1) the norm of these proxies, i.e., <math id="S5.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\lVert\mathbf{w}_{c}\rVert_{2}" display="inline"><semantics id="S5.SS1.SSS1.p2.1.m1.1a"><msub id="S5.SS1.SSS1.p2.1.m1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.1.m1.1.1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml">∥</mo><msub id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo fence="true" lspace="0em" id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS1.SSS1.p2.1.m1.1.1.3" xref="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.1.m1.1b"><apply id="S5.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1">subscript</csymbol><apply id="S5.SS1.SSS1.p2.1.m1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn type="integer" id="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.1.m1.1c">\lVert\mathbf{w}_{c}\rVert_{2}</annotation></semantics></math>; (2) the norm of these proxies’ gradient, i.e., <math id="S5.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\lVert\nabla_{\mathbf{w}_{c}}{\mathcal{L}}\rVert_{2}" display="inline"><semantics id="S5.SS1.SSS1.p2.2.m2.1a"><msub id="S5.SS1.SSS1.p2.2.m2.1.1" xref="S5.SS1.SSS1.p2.2.m2.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.2.m2.1.1.1.1" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.2" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml"><msub id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml">∇</mo><msub id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.2" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.3" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.3.cmml">c</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.2.cmml">ℒ</mi></mrow><mo fence="true" lspace="0em" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.3" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS1.SSS1.p2.2.m2.1.1.3" xref="S5.SS1.SSS1.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.2.m2.1b"><apply id="S5.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1">subscript</csymbol><apply id="S5.SS1.SSS1.p2.2.m2.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p2.2.m2.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1"><apply id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2">∇</ci><apply id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><ci id="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.1.1.1.2">ℒ</ci></apply></apply><cn type="integer" id="S5.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.SSS1.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.2.m2.1c">\lVert\nabla_{\mathbf{w}_{c}}{\mathcal{L}}\rVert_{2}</annotation></semantics></math>, where the gradient is accumulated across this training epoch; (3) the average distance between proxies, i.e., <math id="S5.SS1.SSS1.p2.3.m3.4" class="ltx_Math" alttext="\sum_{i,j\in{\mathcal{O}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/|{\mathcal{O}}|^{2}" display="inline"><semantics id="S5.SS1.SSS1.p2.3.m3.4a"><mrow id="S5.SS1.SSS1.p2.3.m3.4.4" xref="S5.SS1.SSS1.p2.3.m3.4.4.cmml"><msub id="S5.SS1.SSS1.p2.3.m3.4.4.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.2.cmml"><mo id="S5.SS1.SSS1.p2.3.m3.4.4.2.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.2.2.cmml">∑</mo><mrow id="S5.SS1.SSS1.p2.3.m3.2.2.2" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.cmml"><mrow id="S5.SS1.SSS1.p2.3.m3.2.2.2.4.2" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.4.1.cmml"><mi id="S5.SS1.SSS1.p2.3.m3.1.1.1.1" xref="S5.SS1.SSS1.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS1.p2.3.m3.2.2.2.4.2.1" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.4.1.cmml">,</mo><mi id="S5.SS1.SSS1.p2.3.m3.2.2.2.2" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.2.cmml">j</mi></mrow><mo id="S5.SS1.SSS1.p2.3.m3.2.2.2.3" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.3.m3.2.2.2.5" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.5.cmml">𝒪</mi></mrow></msub><mrow id="S5.SS1.SSS1.p2.3.m3.4.4.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.cmml"><msub id="S5.SS1.SSS1.p2.3.m3.4.4.1.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.cmml"><msub id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.cmml"><mi id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.1.cmml">−</mo><msub id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.cmml"><mi id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.3.cmml">2</mn></msub><mo id="S5.SS1.SSS1.p2.3.m3.4.4.1.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.2.cmml">/</mo><msup id="S5.SS1.SSS1.p2.3.m3.4.4.1.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.cmml"><mrow id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.2.1" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.3.m3.3.3" xref="S5.SS1.SSS1.p2.3.m3.3.3.cmml">𝒪</mi><mo stretchy="false" id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.2.2" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.1.1.cmml">|</mo></mrow><mn id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.3" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.3.m3.4b"><apply id="S5.SS1.SSS1.p2.3.m3.4.4.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4"><apply id="S5.SS1.SSS1.p2.3.m3.4.4.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.3.m3.4.4.2.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.2">subscript</csymbol><sum id="S5.SS1.SSS1.p2.3.m3.4.4.2.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.2.2"></sum><apply id="S5.SS1.SSS1.p2.3.m3.2.2.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.2.2.2"><in id="S5.SS1.SSS1.p2.3.m3.2.2.2.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.3"></in><list id="S5.SS1.SSS1.p2.3.m3.2.2.2.4.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.4.2"><ci id="S5.SS1.SSS1.p2.3.m3.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.1.1.1.1">𝑖</ci><ci id="S5.SS1.SSS1.p2.3.m3.2.2.2.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.2">𝑗</ci></list><ci id="S5.SS1.SSS1.p2.3.m3.2.2.2.5.cmml" xref="S5.SS1.SSS1.p2.3.m3.2.2.2.5">𝒪</ci></apply></apply><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1"><divide id="S5.SS1.SSS1.p2.3.m3.4.4.1.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.2"></divide><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1">subscript</csymbol><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1"><minus id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.1"></minus><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.2.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S5.SS1.SSS1.p2.3.m3.4.4.1.1.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.1.3">2</cn></apply><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3">superscript</csymbol><apply id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.2"><abs id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.1.1.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.2.2.1"></abs><ci id="S5.SS1.SSS1.p2.3.m3.3.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.3.3">𝒪</ci></apply><cn type="integer" id="S5.SS1.SSS1.p2.3.m3.4.4.1.3.3.cmml" xref="S5.SS1.SSS1.p2.3.m3.4.4.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.3.m3.4c">\sum_{i,j\in{\mathcal{O}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/|{\mathcal{O}}|^{2}</annotation></semantics></math>, <math id="S5.SS1.SSS1.p2.4.m4.6" class="ltx_Math" alttext="\sum_{i\in{\mathcal{O}},j\in{\mathcal{M}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/(|{\mathcal{O}}|*|{\mathcal{M}}|)" display="inline"><semantics id="S5.SS1.SSS1.p2.4.m4.6a"><mrow id="S5.SS1.SSS1.p2.4.m4.6.6" xref="S5.SS1.SSS1.p2.4.m4.6.6.cmml"><msub id="S5.SS1.SSS1.p2.4.m4.6.6.3" xref="S5.SS1.SSS1.p2.4.m4.6.6.3.cmml"><mo id="S5.SS1.SSS1.p2.4.m4.6.6.3.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.3.2.cmml">∑</mo><mrow id="S5.SS1.SSS1.p2.4.m4.2.2.2.2" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.3.cmml"><mrow id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.2.cmml">i</mi><mo id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.3.cmml">𝒪</mi></mrow><mo id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.3" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.3a.cmml">,</mo><mrow id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.2" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.2.cmml">j</mi><mo id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.1" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.3" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.3.cmml">ℳ</mi></mrow></mrow></msub><mrow id="S5.SS1.SSS1.p2.4.m4.6.6.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.cmml"><msub id="S5.SS1.SSS1.p2.4.m4.5.5.1.1" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.2" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.cmml"><msub id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.cmml"><mi id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.2" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.3" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.1.cmml">−</mo><msub id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.cmml"><mi id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.2" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.3" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.3" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.3" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.3.cmml">2</mn></msub><mo id="S5.SS1.SSS1.p2.4.m4.6.6.2.3" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.3.cmml">/</mo><mrow id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.cmml">(</mo><mrow id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.2.1" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.4.m4.3.3" xref="S5.SS1.SSS1.p2.4.m4.3.3.cmml">𝒪</mi><mo rspace="0.055em" stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.2.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.1" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.1.cmml">∗</mo><mrow id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.2.1" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.4.m4.4.4" xref="S5.SS1.SSS1.p2.4.m4.4.4.cmml">ℳ</mi><mo stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.2.2" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.1.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.3" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.4.m4.6b"><apply id="S5.SS1.SSS1.p2.4.m4.6.6.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6"><apply id="S5.SS1.SSS1.p2.4.m4.6.6.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.4.m4.6.6.3.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.3">subscript</csymbol><sum id="S5.SS1.SSS1.p2.4.m4.6.6.3.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.3.2"></sum><apply id="S5.SS1.SSS1.p2.4.m4.2.2.2.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.4.m4.2.2.2.3a.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1"><in id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.1"></in><ci id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.2">𝑖</ci><ci id="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.1.1.1.1.1.3">𝒪</ci></apply><apply id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2"><in id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.1"></in><ci id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.2">𝑗</ci><ci id="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.2.2.2.2.2.3">ℳ</ci></apply></apply></apply><apply id="S5.SS1.SSS1.p2.4.m4.6.6.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2"><divide id="S5.SS1.SSS1.p2.4.m4.6.6.2.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.3"></divide><apply id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1">subscript</csymbol><apply id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1"><minus id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.1"></minus><apply id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.2.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S5.SS1.SSS1.p2.4.m4.5.5.1.1.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.5.5.1.1.3">2</cn></apply><apply id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1"><times id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.1"></times><apply id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.2"><abs id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.2.2.1"></abs><ci id="S5.SS1.SSS1.p2.4.m4.3.3.cmml" xref="S5.SS1.SSS1.p2.4.m4.3.3">𝒪</ci></apply><apply id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.2"><abs id="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.1.1.cmml" xref="S5.SS1.SSS1.p2.4.m4.6.6.2.2.1.1.3.2.1"></abs><ci id="S5.SS1.SSS1.p2.4.m4.4.4.cmml" xref="S5.SS1.SSS1.p2.4.m4.4.4">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.4.m4.6c">\sum_{i\in{\mathcal{O}},j\in{\mathcal{M}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/(|{\mathcal{O}}|*|{\mathcal{M}}|)</annotation></semantics></math>, and <math id="S5.SS1.SSS1.p2.5.m5.4" class="ltx_Math" alttext="\sum_{i,j\in{\mathcal{M}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/|{\mathcal{M}}|^{2}" display="inline"><semantics id="S5.SS1.SSS1.p2.5.m5.4a"><mrow id="S5.SS1.SSS1.p2.5.m5.4.4" xref="S5.SS1.SSS1.p2.5.m5.4.4.cmml"><msub id="S5.SS1.SSS1.p2.5.m5.4.4.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.2.cmml"><mo id="S5.SS1.SSS1.p2.5.m5.4.4.2.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.2.2.cmml">∑</mo><mrow id="S5.SS1.SSS1.p2.5.m5.2.2.2" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.cmml"><mrow id="S5.SS1.SSS1.p2.5.m5.2.2.2.4.2" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.4.1.cmml"><mi id="S5.SS1.SSS1.p2.5.m5.1.1.1.1" xref="S5.SS1.SSS1.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS1.p2.5.m5.2.2.2.4.2.1" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.4.1.cmml">,</mo><mi id="S5.SS1.SSS1.p2.5.m5.2.2.2.2" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.2.cmml">j</mi></mrow><mo id="S5.SS1.SSS1.p2.5.m5.2.2.2.3" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.5.m5.2.2.2.5" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.5.cmml">ℳ</mi></mrow></msub><mrow id="S5.SS1.SSS1.p2.5.m5.4.4.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.cmml"><msub id="S5.SS1.SSS1.p2.5.m5.4.4.1.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.cmml"><mrow id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.cmml"><msub id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.cmml"><mi id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.1.cmml">−</mo><msub id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.cmml"><mi id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo fence="true" lspace="0em" rspace="0em" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.3.cmml">2</mn></msub><mo id="S5.SS1.SSS1.p2.5.m5.4.4.1.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.2.cmml">/</mo><msup id="S5.SS1.SSS1.p2.5.m5.4.4.1.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.cmml"><mrow id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.2.1" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.5.m5.3.3" xref="S5.SS1.SSS1.p2.5.m5.3.3.cmml">ℳ</mi><mo stretchy="false" id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.2.2" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.1.1.cmml">|</mo></mrow><mn id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.3" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.5.m5.4b"><apply id="S5.SS1.SSS1.p2.5.m5.4.4.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4"><apply id="S5.SS1.SSS1.p2.5.m5.4.4.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.5.m5.4.4.2.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.2">subscript</csymbol><sum id="S5.SS1.SSS1.p2.5.m5.4.4.2.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.2.2"></sum><apply id="S5.SS1.SSS1.p2.5.m5.2.2.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.2.2.2"><in id="S5.SS1.SSS1.p2.5.m5.2.2.2.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.3"></in><list id="S5.SS1.SSS1.p2.5.m5.2.2.2.4.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.4.2"><ci id="S5.SS1.SSS1.p2.5.m5.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.1.1.1.1">𝑖</ci><ci id="S5.SS1.SSS1.p2.5.m5.2.2.2.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.2">𝑗</ci></list><ci id="S5.SS1.SSS1.p2.5.m5.2.2.2.5.cmml" xref="S5.SS1.SSS1.p2.5.m5.2.2.2.5">ℳ</ci></apply></apply><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1"><divide id="S5.SS1.SSS1.p2.5.m5.4.4.1.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.2"></divide><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1">subscript</csymbol><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1"><minus id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.1"></minus><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.2.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.2">𝐰</ci><ci id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S5.SS1.SSS1.p2.5.m5.4.4.1.1.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.1.3">2</cn></apply><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3">superscript</csymbol><apply id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.2"><abs id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.1.1.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.2.2.1"></abs><ci id="S5.SS1.SSS1.p2.5.m5.3.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.3.3">ℳ</ci></apply><cn type="integer" id="S5.SS1.SSS1.p2.5.m5.4.4.1.3.3.cmml" xref="S5.SS1.SSS1.p2.5.m5.4.4.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.5.m5.4c">\sum_{i,j\in{\mathcal{M}}}\lVert\mathbf{w}_{i}-\mathbf{w}_{j}\rVert_{2}/|{\mathcal{M}}|^{2}</annotation></semantics></math>, which are denoted as “O-O”, “O-M”, and “M-M”, respectively. The change of these statistics is shown in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.1.1 Softmax with Missing Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. From this figure, we can observe that the norm of missing classes’ proxies is slightly smaller than the observed classes, which agrees with the visualization result in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1.1 Softmax with Missing Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Then, the gradient norm of missing classes’ proxies is large in the beginning and becomes nearly zero after convergence. This implies that the pushing force is stronger at the beginning, which could make the missing classes’ proxies lose their effectiveness rapidly. Additionally, as shown in the right of Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.1.1 Softmax with Missing Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the distance between missing classes’ proxies becomes nearly zero even after only one training epoch. That is, the missing classes’ proxies will have no distinctness due to the lack of pulling forces. These experimental observations reveal the disadvantages of model training with incomplete classes.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2404.09232/assets/x7.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="111" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S5.F7.2.1" class="ltx_text" style="font-size:90%;">The performance degradation on incomplete classes.</span></figcaption>
</figure>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Performance Degradation on Incomplete Classes</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">The above shows that training with incomplete classes could make the missing classes’ proxies inaccurate rapidly, which challenges the goal of building a complete classification model. Then, we want to present that training with all classes’ samples may hurt the ability to distinguish a definite set of partial classes.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span><span id="S5.T1.4.2" class="ltx_text" style="font-size:90%;">Aggregation performance comparisons with standard FL algorithms (<math id="S5.T1.3.1.m1.1" class="ltx_Math" alttext="T=150" display="inline"><semantics id="S5.T1.3.1.m1.1b"><mrow id="S5.T1.3.1.m1.1.1" xref="S5.T1.3.1.m1.1.1.cmml"><mi id="S5.T1.3.1.m1.1.1.2" xref="S5.T1.3.1.m1.1.1.2.cmml">T</mi><mo id="S5.T1.3.1.m1.1.1.1" xref="S5.T1.3.1.m1.1.1.1.cmml">=</mo><mn id="S5.T1.3.1.m1.1.1.3" xref="S5.T1.3.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.m1.1c"><apply id="S5.T1.3.1.m1.1.1.cmml" xref="S5.T1.3.1.m1.1.1"><eq id="S5.T1.3.1.m1.1.1.1.cmml" xref="S5.T1.3.1.m1.1.1.1"></eq><ci id="S5.T1.3.1.m1.1.1.2.cmml" xref="S5.T1.3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S5.T1.3.1.m1.1.1.3.cmml" xref="S5.T1.3.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.m1.1d">T=150</annotation></semantics></math>, <math id="S5.T1.4.2.m2.1" class="ltx_Math" alttext="Q=0.2" display="inline"><semantics id="S5.T1.4.2.m2.1b"><mrow id="S5.T1.4.2.m2.1.1" xref="S5.T1.4.2.m2.1.1.cmml"><mi id="S5.T1.4.2.m2.1.1.2" xref="S5.T1.4.2.m2.1.1.2.cmml">Q</mi><mo id="S5.T1.4.2.m2.1.1.1" xref="S5.T1.4.2.m2.1.1.1.cmml">=</mo><mn id="S5.T1.4.2.m2.1.1.3" xref="S5.T1.4.2.m2.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.m2.1c"><apply id="S5.T1.4.2.m2.1.1.cmml" xref="S5.T1.4.2.m2.1.1"><eq id="S5.T1.4.2.m2.1.1.1.cmml" xref="S5.T1.4.2.m2.1.1.1"></eq><ci id="S5.T1.4.2.m2.1.1.2.cmml" xref="S5.T1.4.2.m2.1.1.2">𝑄</ci><cn type="float" id="S5.T1.4.2.m2.1.1.3.cmml" xref="S5.T1.4.2.m2.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.m2.1d">Q=0.2</annotation></semantics></math>).</span></figcaption>
<table id="S5.T1.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.8.4" class="ltx_tr">
<th id="S5.T1.8.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td id="S5.T1.5.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">FaMnist (<math id="S5.T1.5.1.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.T1.5.1.1.m1.1a"><mrow id="S5.T1.5.1.1.m1.1.1" xref="S5.T1.5.1.1.m1.1.1.cmml"><mi id="S5.T1.5.1.1.m1.1.1.2" xref="S5.T1.5.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.T1.5.1.1.m1.1.1.1" xref="S5.T1.5.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T1.5.1.1.m1.1.1.3" xref="S5.T1.5.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.5.1.1.m1.1b"><apply id="S5.T1.5.1.1.m1.1.1.cmml" xref="S5.T1.5.1.1.m1.1.1"><eq id="S5.T1.5.1.1.m1.1.1.1.cmml" xref="S5.T1.5.1.1.m1.1.1.1"></eq><ci id="S5.T1.5.1.1.m1.1.1.2.cmml" xref="S5.T1.5.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T1.5.1.1.m1.1.1.3.cmml" xref="S5.T1.5.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.1.1.m1.1c">E=5</annotation></semantics></math>)</td>
<td id="S5.T1.6.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CIFAR-10 (<math id="S5.T1.6.2.2.m1.1" class="ltx_Math" alttext="E=10" display="inline"><semantics id="S5.T1.6.2.2.m1.1a"><mrow id="S5.T1.6.2.2.m1.1.1" xref="S5.T1.6.2.2.m1.1.1.cmml"><mi id="S5.T1.6.2.2.m1.1.1.2" xref="S5.T1.6.2.2.m1.1.1.2.cmml">E</mi><mo id="S5.T1.6.2.2.m1.1.1.1" xref="S5.T1.6.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T1.6.2.2.m1.1.1.3" xref="S5.T1.6.2.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.6.2.2.m1.1b"><apply id="S5.T1.6.2.2.m1.1.1.cmml" xref="S5.T1.6.2.2.m1.1.1"><eq id="S5.T1.6.2.2.m1.1.1.1.cmml" xref="S5.T1.6.2.2.m1.1.1.1"></eq><ci id="S5.T1.6.2.2.m1.1.1.2.cmml" xref="S5.T1.6.2.2.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T1.6.2.2.m1.1.1.3.cmml" xref="S5.T1.6.2.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.2.2.m1.1c">E=10</annotation></semantics></math>)</td>
<td id="S5.T1.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CIFAR-100 (<math id="S5.T1.7.3.3.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="S5.T1.7.3.3.m1.1a"><mrow id="S5.T1.7.3.3.m1.1.1" xref="S5.T1.7.3.3.m1.1.1.cmml"><mi id="S5.T1.7.3.3.m1.1.1.2" xref="S5.T1.7.3.3.m1.1.1.2.cmml">E</mi><mo id="S5.T1.7.3.3.m1.1.1.1" xref="S5.T1.7.3.3.m1.1.1.1.cmml">=</mo><mn id="S5.T1.7.3.3.m1.1.1.3" xref="S5.T1.7.3.3.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.7.3.3.m1.1b"><apply id="S5.T1.7.3.3.m1.1.1.cmml" xref="S5.T1.7.3.3.m1.1.1"><eq id="S5.T1.7.3.3.m1.1.1.1.cmml" xref="S5.T1.7.3.3.m1.1.1.1"></eq><ci id="S5.T1.7.3.3.m1.1.1.2.cmml" xref="S5.T1.7.3.3.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T1.7.3.3.m1.1.1.3.cmml" xref="S5.T1.7.3.3.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.3.3.m1.1c">E=20</annotation></semantics></math>)</td>
<td id="S5.T1.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CINIC-10 (<math id="S5.T1.8.4.4.m1.1" class="ltx_Math" alttext="E=40" display="inline"><semantics id="S5.T1.8.4.4.m1.1a"><mrow id="S5.T1.8.4.4.m1.1.1" xref="S5.T1.8.4.4.m1.1.1.cmml"><mi id="S5.T1.8.4.4.m1.1.1.2" xref="S5.T1.8.4.4.m1.1.1.2.cmml">E</mi><mo id="S5.T1.8.4.4.m1.1.1.1" xref="S5.T1.8.4.4.m1.1.1.1.cmml">=</mo><mn id="S5.T1.8.4.4.m1.1.1.3" xref="S5.T1.8.4.4.m1.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.8.4.4.m1.1b"><apply id="S5.T1.8.4.4.m1.1.1.cmml" xref="S5.T1.8.4.4.m1.1.1"><eq id="S5.T1.8.4.4.m1.1.1.1.cmml" xref="S5.T1.8.4.4.m1.1.1.1"></eq><ci id="S5.T1.8.4.4.m1.1.1.2.cmml" xref="S5.T1.8.4.4.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T1.8.4.4.m1.1.1.3.cmml" xref="S5.T1.8.4.4.m1.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.4.4.m1.1c">E=40</annotation></semantics></math>)</td>
<td id="S5.T1.8.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S5.T1.8.4.6.1" class="ltx_text">Avg</span></td>
</tr>
<tr id="S5.T1.8.5.1" class="ltx_tr">
<th id="S5.T1.8.5.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td id="S5.T1.8.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MLPNet</td>
<td id="S5.T1.8.5.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">LeNet</td>
<td id="S5.T1.8.5.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">TFCNN</td>
<td id="S5.T1.8.5.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG8</td>
<td id="S5.T1.8.5.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG8-BN</td>
<td id="S5.T1.8.5.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG11</td>
<td id="S5.T1.8.5.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ResNet20</td>
<td id="S5.T1.8.5.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ResNet56</td>
</tr>
<tr id="S5.T1.8.6.2" class="ltx_tr">
<th id="S5.T1.8.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S5.T1.8.6.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.2 <span id="S5.T1.8.6.2.2.1" class="ltx_text" style="font-size:70%;">(0.92%)</span>
</td>
<td id="S5.T1.8.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.3 <span id="S5.T1.8.6.2.3.1" class="ltx_text" style="font-size:70%;">(0.58%)</span>
</td>
<td id="S5.T1.8.6.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.8 <span id="S5.T1.8.6.2.4.1" class="ltx_text" style="font-size:70%;">(0.64%)</span>
</td>
<td id="S5.T1.8.6.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.0 <span id="S5.T1.8.6.2.5.1" class="ltx_text" style="font-size:70%;">(0.99%)</span>
</td>
<td id="S5.T1.8.6.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.6 <span id="S5.T1.8.6.2.6.1" class="ltx_text" style="font-size:70%;">(0.78%)</span>
</td>
<td id="S5.T1.8.6.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">24.8 <span id="S5.T1.8.6.2.7.1" class="ltx_text" style="font-size:70%;">(0.50%)</span>
</td>
<td id="S5.T1.8.6.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.5 <span id="S5.T1.8.6.2.8.1" class="ltx_text" style="font-size:70%;">(0.51%)</span>
</td>
<td id="S5.T1.8.6.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.8 <span id="S5.T1.8.6.2.9.1" class="ltx_text" style="font-size:70%;">(1.03%)</span>
</td>
<td id="S5.T1.8.6.2.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.0</td>
</tr>
<tr id="S5.T1.8.7.3" class="ltx_tr">
<th id="S5.T1.8.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</th>
<td id="S5.T1.8.7.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.8 <span id="S5.T1.8.7.3.2.1" class="ltx_text" style="font-size:70%;">(0.80%)</span>
</td>
<td id="S5.T1.8.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.4 <span id="S5.T1.8.7.3.3.1" class="ltx_text" style="font-size:70%;">(0.47%)</span>
</td>
<td id="S5.T1.8.7.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.7 <span id="S5.T1.8.7.3.4.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T1.8.7.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.6 <span id="S5.T1.8.7.3.5.1" class="ltx_text" style="font-size:70%;">(0.26%)</span>
</td>
<td id="S5.T1.8.7.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.0 <span id="S5.T1.8.7.3.6.1" class="ltx_text" style="font-size:70%;">(0.66%)</span>
</td>
<td id="S5.T1.8.7.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">24.8 <span id="S5.T1.8.7.3.7.1" class="ltx_text" style="font-size:70%;">(0.08%)</span>
</td>
<td id="S5.T1.8.7.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.8 <span id="S5.T1.8.7.3.8.1" class="ltx_text" style="font-size:70%;">(1.19%)</span>
</td>
<td id="S5.T1.8.7.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.5 <span id="S5.T1.8.7.3.9.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T1.8.7.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.3</td>
</tr>
<tr id="S5.T1.8.8.4" class="ltx_tr">
<th id="S5.T1.8.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</th>
<td id="S5.T1.8.8.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.0 <span id="S5.T1.8.8.4.2.1" class="ltx_text" style="font-size:70%;">(4.42%)</span>
</td>
<td id="S5.T1.8.8.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.2 <span id="S5.T1.8.8.4.3.1" class="ltx_text" style="font-size:70%;">(0.70%)</span>
</td>
<td id="S5.T1.8.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.9 <span id="S5.T1.8.8.4.4.1" class="ltx_text" style="font-size:70%;">(1.07%)</span>
</td>
<td id="S5.T1.8.8.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.7 <span id="S5.T1.8.8.4.5.1" class="ltx_text" style="font-size:70%;">(0.66%)</span>
</td>
<td id="S5.T1.8.8.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.8 <span id="S5.T1.8.8.4.6.1" class="ltx_text" style="font-size:70%;">(0.69%)</span>
</td>
<td id="S5.T1.8.8.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.9 <span id="S5.T1.8.8.4.7.1" class="ltx_text" style="font-size:70%;">(0.96%)</span>
</td>
<td id="S5.T1.8.8.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.3 <span id="S5.T1.8.8.4.8.1" class="ltx_text" style="font-size:70%;">(1.07%)</span>
</td>
<td id="S5.T1.8.8.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.1 <span id="S5.T1.8.8.4.9.1" class="ltx_text" style="font-size:70%;">(0.19%)</span>
</td>
<td id="S5.T1.8.8.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.5</td>
</tr>
<tr id="S5.T1.8.9.5" class="ltx_tr">
<th id="S5.T1.8.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</th>
<td id="S5.T1.8.9.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.6 <span id="S5.T1.8.9.5.2.1" class="ltx_text" style="font-size:70%;">(0.46%)</span>
</td>
<td id="S5.T1.8.9.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.2 <span id="S5.T1.8.9.5.3.1" class="ltx_text" style="font-size:70%;">(0.33%)</span>
</td>
<td id="S5.T1.8.9.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.9 <span id="S5.T1.8.9.5.4.1" class="ltx_text" style="font-size:70%;">(0.54%)</span>
</td>
<td id="S5.T1.8.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.2 <span id="S5.T1.8.9.5.5.1" class="ltx_text" style="font-size:70%;">(0.69%)</span>
</td>
<td id="S5.T1.8.9.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">52.3 <span id="S5.T1.8.9.5.6.1" class="ltx_text" style="font-size:70%;">(0.60%)</span>
</td>
<td id="S5.T1.8.9.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">21.3 <span id="S5.T1.8.9.5.7.1" class="ltx_text" style="font-size:70%;">(0.42%)</span>
</td>
<td id="S5.T1.8.9.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.3 <span id="S5.T1.8.9.5.8.1" class="ltx_text" style="font-size:70%;">(0.72%)</span>
</td>
<td id="S5.T1.8.9.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.1 <span id="S5.T1.8.9.5.9.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T1.8.9.5.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.6</td>
</tr>
<tr id="S5.T1.8.10.6" class="ltx_tr">
<th id="S5.T1.8.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S5.T1.8.10.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.6 <span id="S5.T1.8.10.6.2.1" class="ltx_text" style="font-size:70%;">(1.94%)</span>
</td>
<td id="S5.T1.8.10.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.5 <span id="S5.T1.8.10.6.3.1" class="ltx_text" style="font-size:70%;">(1.05%)</span>
</td>
<td id="S5.T1.8.10.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.1 <span id="S5.T1.8.10.6.4.1" class="ltx_text" style="font-size:70%;">(2.06%)</span>
</td>
<td id="S5.T1.8.10.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.6 <span id="S5.T1.8.10.6.5.1" class="ltx_text" style="font-size:70%;">(3.56%)</span>
</td>
<td id="S5.T1.8.10.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.0 <span id="S5.T1.8.10.6.6.1" class="ltx_text" style="font-size:70%;">(1.87%)</span>
</td>
<td id="S5.T1.8.10.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.9 <span id="S5.T1.8.10.6.7.1" class="ltx_text" style="font-size:70%;">(1.41%)</span>
</td>
<td id="S5.T1.8.10.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.1 <span id="S5.T1.8.10.6.8.1" class="ltx_text" style="font-size:70%;">(1.42%)</span>
</td>
<td id="S5.T1.8.10.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.2 <span id="S5.T1.8.10.6.9.1" class="ltx_text" style="font-size:70%;">(2.48%)</span>
</td>
<td id="S5.T1.8.10.6.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.9</td>
</tr>
<tr id="S5.T1.8.11.7" class="ltx_tr">
<th id="S5.T1.8.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>
</th>
<td id="S5.T1.8.11.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.3 <span id="S5.T1.8.11.7.2.1" class="ltx_text" style="font-size:70%;">(0.12%)</span>
</td>
<td id="S5.T1.8.11.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.6 <span id="S5.T1.8.11.7.3.1" class="ltx_text" style="font-size:70%;">(1.36%)</span>
</td>
<td id="S5.T1.8.11.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.7 <span id="S5.T1.8.11.7.4.1" class="ltx_text" style="font-size:70%;">(1.46%)</span>
</td>
<td id="S5.T1.8.11.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.1 <span id="S5.T1.8.11.7.5.1" class="ltx_text" style="font-size:70%;">(1.26%)</span>
</td>
<td id="S5.T1.8.11.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">43.0 <span id="S5.T1.8.11.7.6.1" class="ltx_text" style="font-size:70%;">(1.40%)</span>
</td>
<td id="S5.T1.8.11.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">23.6 <span id="S5.T1.8.11.7.7.1" class="ltx_text" style="font-size:70%;">(2.18%)</span>
</td>
<td id="S5.T1.8.11.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">60.4 <span id="S5.T1.8.11.7.8.1" class="ltx_text" style="font-size:70%;">(1.33%)</span>
</td>
<td id="S5.T1.8.11.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.7 <span id="S5.T1.8.11.7.9.1" class="ltx_text" style="font-size:70%;">(1.89%)</span>
</td>
<td id="S5.T1.8.11.7.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.2</td>
</tr>
<tr id="S5.T1.8.12.8" class="ltx_tr">
<th id="S5.T1.8.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>
</th>
<td id="S5.T1.8.12.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.5 <span id="S5.T1.8.12.8.2.1" class="ltx_text" style="font-size:70%;">(1.17%)</span>
</td>
<td id="S5.T1.8.12.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.8 <span id="S5.T1.8.12.8.3.1" class="ltx_text" style="font-size:70%;">(0.56%)</span>
</td>
<td id="S5.T1.8.12.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.0 <span id="S5.T1.8.12.8.4.1" class="ltx_text" style="font-size:70%;">(1.62%)</span>
</td>
<td id="S5.T1.8.12.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.7 <span id="S5.T1.8.12.8.5.1" class="ltx_text" style="font-size:70%;">(1.66%)</span>
</td>
<td id="S5.T1.8.12.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">42.5 <span id="S5.T1.8.12.8.6.1" class="ltx_text" style="font-size:70%;">(1.17%)</span>
</td>
<td id="S5.T1.8.12.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">23.4 <span id="S5.T1.8.12.8.7.1" class="ltx_text" style="font-size:70%;">(1.10%)</span>
</td>
<td id="S5.T1.8.12.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.0 <span id="S5.T1.8.12.8.8.1" class="ltx_text" style="font-size:70%;">(1.09%)</span>
</td>
<td id="S5.T1.8.12.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">60.4 <span id="S5.T1.8.12.8.9.1" class="ltx_text" style="font-size:70%;">(1.92%)</span>
</td>
<td id="S5.T1.8.12.8.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.7</td>
</tr>
<tr id="S5.T1.8.13.9" class="ltx_tr">
<th id="S5.T1.8.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAwS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>
</th>
<td id="S5.T1.8.13.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.4 <span id="S5.T1.8.13.9.2.1" class="ltx_text" style="font-size:70%;">(0.36%)</span>
</td>
<td id="S5.T1.8.13.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.13.9.3.1" class="ltx_text" style="font-size:70%;">(0.43%)</span>
</td>
<td id="S5.T1.8.13.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.9 <span id="S5.T1.8.13.9.4.1" class="ltx_text" style="font-size:70%;">(0.56%)</span>
</td>
<td id="S5.T1.8.13.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.9 <span id="S5.T1.8.13.9.5.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T1.8.13.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.1 <span id="S5.T1.8.13.9.6.1" class="ltx_text" style="font-size:70%;">(0.82%)</span>
</td>
<td id="S5.T1.8.13.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.5 <span id="S5.T1.8.13.9.7.1" class="ltx_text" style="font-size:70%;">(0.46%)</span>
</td>
<td id="S5.T1.8.13.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.5 <span id="S5.T1.8.13.9.8.1" class="ltx_text" style="font-size:70%;">(1.23%)</span>
</td>
<td id="S5.T1.8.13.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.8 <span id="S5.T1.8.13.9.9.1" class="ltx_text" style="font-size:70%;">(0.76%)</span>
</td>
<td id="S5.T1.8.13.9.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.0</td>
</tr>
<tr id="S5.T1.8.14.10" class="ltx_tr">
<th id="S5.T1.8.14.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite>
</th>
<td id="S5.T1.8.14.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.4 <span id="S5.T1.8.14.10.2.1" class="ltx_text" style="font-size:70%;">(0.14%)</span>
</td>
<td id="S5.T1.8.14.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.14.10.3.1" class="ltx_text" style="font-size:70%;">(0.41%)</span>
</td>
<td id="S5.T1.8.14.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.6 <span id="S5.T1.8.14.10.4.1" class="ltx_text" style="font-size:70%;">(0.73%)</span>
</td>
<td id="S5.T1.8.14.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.6 <span id="S5.T1.8.14.10.5.1" class="ltx_text" style="font-size:70%;">(0.83%)</span>
</td>
<td id="S5.T1.8.14.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.1 <span id="S5.T1.8.14.10.6.1" class="ltx_text" style="font-size:70%;">(0.53%)</span>
</td>
<td id="S5.T1.8.14.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.1 <span id="S5.T1.8.14.10.7.1" class="ltx_text" style="font-size:70%;">(0.15%)</span>
</td>
<td id="S5.T1.8.14.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.1 <span id="S5.T1.8.14.10.8.1" class="ltx_text" style="font-size:70%;">(1.13%)</span>
</td>
<td id="S5.T1.8.14.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.9 <span id="S5.T1.8.14.10.9.1" class="ltx_text" style="font-size:70%;">(1.19%)</span>
</td>
<td id="S5.T1.8.14.10.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.1</td>
</tr>
<tr id="S5.T1.8.15.11" class="ltx_tr">
<th id="S5.T1.8.15.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<td id="S5.T1.8.15.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.9 <span id="S5.T1.8.15.11.2.1" class="ltx_text" style="font-size:70%;">(1.63%)</span>
</td>
<td id="S5.T1.8.15.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.8 <span id="S5.T1.8.15.11.3.1" class="ltx_text" style="font-size:70%;">(1.08%)</span>
</td>
<td id="S5.T1.8.15.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.0 <span id="S5.T1.8.15.11.4.1" class="ltx_text" style="font-size:70%;">(2.18%)</span>
</td>
<td id="S5.T1.8.15.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.4 <span id="S5.T1.8.15.11.5.1" class="ltx_text" style="font-size:70%;">(1.02%)</span>
</td>
<td id="S5.T1.8.15.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">37.4 <span id="S5.T1.8.15.11.6.1" class="ltx_text" style="font-size:70%;">(1.58%)</span>
</td>
<td id="S5.T1.8.15.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">23.0 <span id="S5.T1.8.15.11.7.1" class="ltx_text" style="font-size:70%;">(1.62%)</span>
</td>
<td id="S5.T1.8.15.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.1 <span id="S5.T1.8.15.11.8.1" class="ltx_text" style="font-size:70%;">(0.76%)</span>
</td>
<td id="S5.T1.8.15.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">58.4 <span id="S5.T1.8.15.11.9.1" class="ltx_text" style="font-size:70%;">(1.52%)</span>
</td>
<td id="S5.T1.8.15.11.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.5</td>
</tr>
<tr id="S5.T1.8.16.12" class="ltx_tr">
<th id="S5.T1.8.16.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FLDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>
</th>
<td id="S5.T1.8.16.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.4 <span id="S5.T1.8.16.12.2.1" class="ltx_text" style="font-size:70%;">(0.16%)</span>
</td>
<td id="S5.T1.8.16.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.2 <span id="S5.T1.8.16.12.3.1" class="ltx_text" style="font-size:70%;">(0.83%)</span>
</td>
<td id="S5.T1.8.16.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.3 <span id="S5.T1.8.16.12.4.1" class="ltx_text" style="font-size:70%;">(1.18%)</span>
</td>
<td id="S5.T1.8.16.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.2 <span id="S5.T1.8.16.12.5.1" class="ltx_text" style="font-size:70%;">(0.42%)</span>
</td>
<td id="S5.T1.8.16.12.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.8 <span id="S5.T1.8.16.12.6.1" class="ltx_text" style="font-size:70%;">(0.78%)</span>
</td>
<td id="S5.T1.8.16.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">28.2 <span id="S5.T1.8.16.12.7.1" class="ltx_text" style="font-size:70%;">(0.69%)</span>
</td>
<td id="S5.T1.8.16.12.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.2 <span id="S5.T1.8.16.12.8.1" class="ltx_text" style="font-size:70%;">(0.73%)</span>
</td>
<td id="S5.T1.8.16.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.9 <span id="S5.T1.8.16.12.9.1" class="ltx_text" style="font-size:70%;">(0.91%)</span>
</td>
<td id="S5.T1.8.16.12.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.2</td>
</tr>
<tr id="S5.T1.8.17.13" class="ltx_tr">
<th id="S5.T1.8.17.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite>
</th>
<td id="S5.T1.8.17.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.7 <span id="S5.T1.8.17.13.2.1" class="ltx_text" style="font-size:70%;">(0.63%)</span>
</td>
<td id="S5.T1.8.17.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.17.13.3.1" class="ltx_text" style="font-size:70%;">(0.38%)</span>
</td>
<td id="S5.T1.8.17.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.6 <span id="S5.T1.8.17.13.4.1" class="ltx_text" style="font-size:70%;">(2.87%)</span>
</td>
<td id="S5.T1.8.17.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">58.9 <span id="S5.T1.8.17.13.5.1" class="ltx_text" style="font-size:70%;">(1.96%)</span>
</td>
<td id="S5.T1.8.17.13.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.5 <span id="S5.T1.8.17.13.6.1" class="ltx_text" style="font-size:70%;">(0.93%)</span>
</td>
<td id="S5.T1.8.17.13.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1.3 <span id="S5.T1.8.17.13.7.1" class="ltx_text" style="font-size:70%;">(0.14%)</span>
</td>
<td id="S5.T1.8.17.13.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.0 <span id="S5.T1.8.17.13.8.1" class="ltx_text" style="font-size:70%;">(0.98%)</span>
</td>
<td id="S5.T1.8.17.13.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.5 <span id="S5.T1.8.17.13.9.1" class="ltx_text" style="font-size:70%;">(0.61%)</span>
</td>
<td id="S5.T1.8.17.13.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.3</td>
</tr>
<tr id="S5.T1.8.18.14" class="ltx_tr">
<th id="S5.T1.8.18.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">PerFedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>
</th>
<td id="S5.T1.8.18.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.6 <span id="S5.T1.8.18.14.2.1" class="ltx_text" style="font-size:70%;">(4.47%)</span>
</td>
<td id="S5.T1.8.18.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.2 <span id="S5.T1.8.18.14.3.1" class="ltx_text" style="font-size:70%;">(4.51%)</span>
</td>
<td id="S5.T1.8.18.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.3 <span id="S5.T1.8.18.14.4.1" class="ltx_text" style="font-size:70%;">(3.48%)</span>
</td>
<td id="S5.T1.8.18.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.5 <span id="S5.T1.8.18.14.5.1" class="ltx_text" style="font-size:70%;">(3.32%)</span>
</td>
<td id="S5.T1.8.18.14.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">45.5 <span id="S5.T1.8.18.14.6.1" class="ltx_text" style="font-size:70%;">(1.26%)</span>
</td>
<td id="S5.T1.8.18.14.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1.0 <span id="S5.T1.8.18.14.7.1" class="ltx_text" style="font-size:70%;">(0.00%)</span>
</td>
<td id="S5.T1.8.18.14.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.9 <span id="S5.T1.8.18.14.8.1" class="ltx_text" style="font-size:70%;">(0.75%)</span>
</td>
<td id="S5.T1.8.18.14.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.6 <span id="S5.T1.8.18.14.9.1" class="ltx_text" style="font-size:70%;">(0.61%)</span>
</td>
<td id="S5.T1.8.18.14.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.1</td>
</tr>
<tr id="S5.T1.8.19.15" class="ltx_tr">
<th id="S5.T1.8.19.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite>
</th>
<td id="S5.T1.8.19.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.5 <span id="S5.T1.8.19.15.2.1" class="ltx_text" style="font-size:70%;">(0.60%)</span>
</td>
<td id="S5.T1.8.19.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.5 <span id="S5.T1.8.19.15.3.1" class="ltx_text" style="font-size:70%;">(0.89%)</span>
</td>
<td id="S5.T1.8.19.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.4 <span id="S5.T1.8.19.15.4.1" class="ltx_text" style="font-size:70%;">(0.52%)</span>
</td>
<td id="S5.T1.8.19.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.2 <span id="S5.T1.8.19.15.5.1" class="ltx_text" style="font-size:70%;">(0.95%)</span>
</td>
<td id="S5.T1.8.19.15.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.3 <span id="S5.T1.8.19.15.6.1" class="ltx_text" style="font-size:70%;">(0.29%)</span>
</td>
<td id="S5.T1.8.19.15.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.3 <span id="S5.T1.8.19.15.7.1" class="ltx_text" style="font-size:70%;">(0.40%)</span>
</td>
<td id="S5.T1.8.19.15.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.8 <span id="S5.T1.8.19.15.8.1" class="ltx_text" style="font-size:70%;">(0.49%)</span>
</td>
<td id="S5.T1.8.19.15.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.7 <span id="S5.T1.8.19.15.9.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T1.8.19.15.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.7</td>
</tr>
<tr id="S5.T1.8.20.16" class="ltx_tr">
<th id="S5.T1.8.20.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedROD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S5.T1.8.20.16.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.1 <span id="S5.T1.8.20.16.2.1" class="ltx_text" style="font-size:70%;">(0.97%)</span>
</td>
<td id="S5.T1.8.20.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.9 <span id="S5.T1.8.20.16.3.1" class="ltx_text" style="font-size:70%;">(0.53%)</span>
</td>
<td id="S5.T1.8.20.16.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.9 <span id="S5.T1.8.20.16.4.1" class="ltx_text" style="font-size:70%;">(1.07%)</span>
</td>
<td id="S5.T1.8.20.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.8 <span id="S5.T1.8.20.16.5.1" class="ltx_text" style="font-size:70%;">(1.11%)</span>
</td>
<td id="S5.T1.8.20.16.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.6 <span id="S5.T1.8.20.16.6.1" class="ltx_text" style="font-size:70%;">(1.74%)</span>
</td>
<td id="S5.T1.8.20.16.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.8 <span id="S5.T1.8.20.16.7.1" class="ltx_text" style="font-size:70%;">(0.77%)</span>
</td>
<td id="S5.T1.8.20.16.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.6 <span id="S5.T1.8.20.16.8.1" class="ltx_text" style="font-size:70%;">(0.48%)</span>
</td>
<td id="S5.T1.8.20.16.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.4 <span id="S5.T1.8.20.16.9.1" class="ltx_text" style="font-size:70%;">(0.39%)</span>
</td>
<td id="S5.T1.8.20.16.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.3</td>
</tr>
<tr id="S5.T1.8.21.17" class="ltx_tr">
<th id="S5.T1.8.21.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<td id="S5.T1.8.21.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.21.17.2.1" class="ltx_text" style="font-size:70%;">(0.46%)</span>
</td>
<td id="S5.T1.8.21.17.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.1 <span id="S5.T1.8.21.17.3.1" class="ltx_text" style="font-size:70%;">(0.58%)</span>
</td>
<td id="S5.T1.8.21.17.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.7 <span id="S5.T1.8.21.17.4.1" class="ltx_text" style="font-size:70%;">(1.11%)</span>
</td>
<td id="S5.T1.8.21.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.9 <span id="S5.T1.8.21.17.5.1" class="ltx_text" style="font-size:70%;">(1.19%)</span>
</td>
<td id="S5.T1.8.21.17.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.5 <span id="S5.T1.8.21.17.6.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T1.8.21.17.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.4 <span id="S5.T1.8.21.17.7.1" class="ltx_text" style="font-size:70%;">(0.71%)</span>
</td>
<td id="S5.T1.8.21.17.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.4 <span id="S5.T1.8.21.17.8.1" class="ltx_text" style="font-size:70%;">(1.20%)</span>
</td>
<td id="S5.T1.8.21.17.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.4 <span id="S5.T1.8.21.17.9.1" class="ltx_text" style="font-size:70%;">(1.25%)</span>
</td>
<td id="S5.T1.8.21.17.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.6</td>
</tr>
<tr id="S5.T1.8.22.18" class="ltx_tr">
<th id="S5.T1.8.22.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</th>
<td id="S5.T1.8.22.18.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.7 <span id="S5.T1.8.22.18.2.1" class="ltx_text" style="font-size:70%;">(0.60%)</span>
</td>
<td id="S5.T1.8.22.18.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.22.18.3.1" class="ltx_text" style="font-size:70%;">(0.38%)</span>
</td>
<td id="S5.T1.8.22.18.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.3 <span id="S5.T1.8.22.18.4.1" class="ltx_text" style="font-size:70%;">(0.85%)</span>
</td>
<td id="S5.T1.8.22.18.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.3 <span id="S5.T1.8.22.18.5.1" class="ltx_text" style="font-size:70%;">(0.31%)</span>
</td>
<td id="S5.T1.8.22.18.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.4 <span id="S5.T1.8.22.18.6.1" class="ltx_text" style="font-size:70%;">(0.05%)</span>
</td>
<td id="S5.T1.8.22.18.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.9 <span id="S5.T1.8.22.18.7.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T1.8.22.18.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.2 <span id="S5.T1.8.22.18.8.1" class="ltx_text" style="font-size:70%;">(1.27%)</span>
</td>
<td id="S5.T1.8.22.18.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.2 <span id="S5.T1.8.22.18.9.1" class="ltx_text" style="font-size:70%;">(0.73%)</span>
</td>
<td id="S5.T1.8.22.18.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.5</td>
</tr>
<tr id="S5.T1.8.23.19" class="ltx_tr">
<th id="S5.T1.8.23.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">DittoRS</th>
<td id="S5.T1.8.23.19.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.8 <span id="S5.T1.8.23.19.2.1" class="ltx_text" style="font-size:70%;">(0.37%)</span>
</td>
<td id="S5.T1.8.23.19.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.3 <span id="S5.T1.8.23.19.3.1" class="ltx_text" style="font-size:70%;">(1.00%)</span>
</td>
<td id="S5.T1.8.23.19.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.7 <span id="S5.T1.8.23.19.4.1" class="ltx_text" style="font-size:70%;">(1.29%)</span>
</td>
<td id="S5.T1.8.23.19.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.9 <span id="S5.T1.8.23.19.5.1" class="ltx_text" style="font-size:70%;">(1.14%)</span>
</td>
<td id="S5.T1.8.23.19.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.3 <span id="S5.T1.8.23.19.6.1" class="ltx_text" style="font-size:70%;">(1.18%)</span>
</td>
<td id="S5.T1.8.23.19.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.0 <span id="S5.T1.8.23.19.7.1" class="ltx_text" style="font-size:70%;">(0.78%)</span>
</td>
<td id="S5.T1.8.23.19.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.2 <span id="S5.T1.8.23.19.8.1" class="ltx_text" style="font-size:70%;">(0.90%)</span>
</td>
<td id="S5.T1.8.23.19.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.8 <span id="S5.T1.8.23.19.9.1" class="ltx_text" style="font-size:70%;">(0.99%)</span>
</td>
<td id="S5.T1.8.23.19.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.6</td>
</tr>
<tr id="S5.T1.8.24.20" class="ltx_tr">
<th id="S5.T1.8.24.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ScaRS</th>
<td id="S5.T1.8.24.20.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.0 <span id="S5.T1.8.24.20.2.1" class="ltx_text" style="font-size:70%;">(1.90%)</span>
</td>
<td id="S5.T1.8.24.20.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.1 <span id="S5.T1.8.24.20.3.1" class="ltx_text" style="font-size:70%;">(1.39%)</span>
</td>
<td id="S5.T1.8.24.20.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.2 <span id="S5.T1.8.24.20.4.1" class="ltx_text" style="font-size:70%;">(2.12%)</span>
</td>
<td id="S5.T1.8.24.20.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.7 <span id="S5.T1.8.24.20.5.1" class="ltx_text" style="font-size:70%;">(1.89%)</span>
</td>
<td id="S5.T1.8.24.20.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">54.4 <span id="S5.T1.8.24.20.6.1" class="ltx_text" style="font-size:70%;">(1.75%)</span>
</td>
<td id="S5.T1.8.24.20.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">21.0 <span id="S5.T1.8.24.20.7.1" class="ltx_text" style="font-size:70%;">(1.21%)</span>
</td>
<td id="S5.T1.8.24.20.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.6 <span id="S5.T1.8.24.20.8.1" class="ltx_text" style="font-size:70%;">(0.91%)</span>
</td>
<td id="S5.T1.8.24.20.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.3 <span id="S5.T1.8.24.20.9.1" class="ltx_text" style="font-size:70%;">(0.83%)</span>
</td>
<td id="S5.T1.8.24.20.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.4</td>
</tr>
<tr id="S5.T1.8.25.21" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T1.8.25.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.1.1" class="ltx_text" style="background-color:#E6E6E6;">MAP (Ours)</span></th>
<td id="S5.T1.8.25.21.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.2.1" class="ltx_text" style="background-color:#E6E6E6;">88.1 <span id="S5.T1.8.25.21.2.1.1" class="ltx_text" style="font-size:70%;">(0.54%)</span></span></td>
<td id="S5.T1.8.25.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.3.1" class="ltx_text" style="background-color:#E6E6E6;">88.4 <span id="S5.T1.8.25.21.3.1.1" class="ltx_text" style="font-size:70%;">(0.44%)</span></span></td>
<td id="S5.T1.8.25.21.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.4.1" class="ltx_text" style="background-color:#E6E6E6;">71.8 <span id="S5.T1.8.25.21.4.1.1" class="ltx_text" style="font-size:70%;">(0.84%)</span></span></td>
<td id="S5.T1.8.25.21.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.5.1" class="ltx_text" style="background-color:#E6E6E6;">76.4 <span id="S5.T1.8.25.21.5.1.1" class="ltx_text" style="font-size:70%;">(0.72%)</span></span></td>
<td id="S5.T1.8.25.21.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.6.1" class="ltx_text" style="background-color:#E6E6E6;">48.7 <span id="S5.T1.8.25.21.6.1.1" class="ltx_text" style="font-size:70%;">(0.70%)</span></span></td>
<td id="S5.T1.8.25.21.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.7.1" class="ltx_text" style="background-color:#E6E6E6;">25.5 <span id="S5.T1.8.25.21.7.1.1" class="ltx_text" style="font-size:70%;">(0.77%)</span></span></td>
<td id="S5.T1.8.25.21.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.8.1" class="ltx_text" style="background-color:#E6E6E6;">67.9 <span id="S5.T1.8.25.21.8.1.1" class="ltx_text" style="font-size:70%;">(1.03%)</span></span></td>
<td id="S5.T1.8.25.21.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.9.1" class="ltx_text" style="background-color:#E6E6E6;">67.9 <span id="S5.T1.8.25.21.9.1.1" class="ltx_text" style="font-size:70%;">(0.80%)</span></span></td>
<td id="S5.T1.8.25.21.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.25.21.10.1" class="ltx_text" style="background-color:#E6E6E6;">66.8</span></td>
</tr>
<tr id="S5.T1.8.26.22" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T1.8.26.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.1.1" class="ltx_text" style="background-color:#E6E6E6;">ScaMAP (Ours)</span></th>
<td id="S5.T1.8.26.22.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.2.1" class="ltx_text" style="background-color:#E6E6E6;">88.3 <span id="S5.T1.8.26.22.2.1.1" class="ltx_text" style="font-size:70%;">(1.25%)</span></span></td>
<td id="S5.T1.8.26.22.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.3.1" class="ltx_text" style="background-color:#E6E6E6;">89.6 <span id="S5.T1.8.26.22.3.1.1" class="ltx_text" style="font-size:70%;">(0.91%)</span></span></td>
<td id="S5.T1.8.26.22.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.4.1" class="ltx_text" style="background-color:#E6E6E6;">75.6 <span id="S5.T1.8.26.22.4.1.1" class="ltx_text" style="font-size:70%;">(1.39%)</span></span></td>
<td id="S5.T1.8.26.22.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.5.1" class="ltx_text" style="background-color:#E6E6E6;">76.5 <span id="S5.T1.8.26.22.5.1.1" class="ltx_text" style="font-size:70%;">(1.79%)</span></span></td>
<td id="S5.T1.8.26.22.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.6.1" class="ltx_text" style="background-color:#E6E6E6;">52.6 <span id="S5.T1.8.26.22.6.1.1" class="ltx_text" style="font-size:70%;">(1.70%)</span></span></td>
<td id="S5.T1.8.26.22.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.7.1" class="ltx_text" style="background-color:#E6E6E6;">21.9 <span id="S5.T1.8.26.22.7.1.1" class="ltx_text" style="font-size:70%;">(0.48%)</span></span></td>
<td id="S5.T1.8.26.22.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.8.1" class="ltx_text" style="background-color:#E6E6E6;">64.9 <span id="S5.T1.8.26.22.8.1.1" class="ltx_text" style="font-size:70%;">(1.36%)</span></span></td>
<td id="S5.T1.8.26.22.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.9.1" class="ltx_text" style="background-color:#E6E6E6;">66.1 <span id="S5.T1.8.26.22.9.1.1" class="ltx_text" style="font-size:70%;">(0.93%)</span></span></td>
<td id="S5.T1.8.26.22.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T1.8.26.22.10.1" class="ltx_text" style="background-color:#E6E6E6;">66.9</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.SSS2.p2" class="ltx_para">
<p id="S5.SS1.SSS2.p2.2" class="ltx_p">We train VGG16 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>]</cite> with batch normalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib75" title="" class="ltx_ref">75</a>]</cite> on CIFAR-100. CIFAR-100 contains 100 classes and each class has 500 training samples. We aim to compare the models trained on the whole 100 classes or a partial set of targeted classes. The number of targeted classes ranges from 10 to 80. Take 80 targeted classes as an example, we first train a model on the 80 classes’ data, i.e., <math id="S5.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="80\times 500" display="inline"><semantics id="S5.SS1.SSS2.p2.1.m1.1a"><mrow id="S5.SS1.SSS2.p2.1.m1.1.1" xref="S5.SS1.SSS2.p2.1.m1.1.1.cmml"><mn id="S5.SS1.SSS2.p2.1.m1.1.1.2" xref="S5.SS1.SSS2.p2.1.m1.1.1.2.cmml">80</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS2.p2.1.m1.1.1.1" xref="S5.SS1.SSS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS2.p2.1.m1.1.1.3" xref="S5.SS1.SSS2.p2.1.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p2.1.m1.1b"><apply id="S5.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p2.1.m1.1.1"><times id="S5.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.p2.1.m1.1.1.2">80</cn><cn type="integer" id="S5.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S5.SS1.SSS2.p2.1.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p2.1.m1.1c">80\times 500</annotation></semantics></math> samples. Then, we train a model on all classes with the same number of targeted classes, i.e., using all <math id="S5.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="100\times 500" display="inline"><semantics id="S5.SS1.SSS2.p2.2.m2.1a"><mrow id="S5.SS1.SSS2.p2.2.m2.1.1" xref="S5.SS1.SSS2.p2.2.m2.1.1.cmml"><mn id="S5.SS1.SSS2.p2.2.m2.1.1.2" xref="S5.SS1.SSS2.p2.2.m2.1.1.2.cmml">100</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS2.p2.2.m2.1.1.1" xref="S5.SS1.SSS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS2.p2.2.m2.1.1.3" xref="S5.SS1.SSS2.p2.2.m2.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p2.2.m2.1b"><apply id="S5.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S5.SS1.SSS2.p2.2.m2.1.1"><times id="S5.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S5.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.p2.2.m2.1.1.2">100</cn><cn type="integer" id="S5.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S5.SS1.SSS2.p2.2.m2.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p2.2.m2.1c">100\times 500</annotation></semantics></math> samples. For ease of description, we denote these two models M1, M2, respectively. For performance comparison, we only calculate the model’s test accuracy on targeted classes. We still train models up to 50 epochs. The optimizer is SGD with a momentum of 0.9 and the learning rate is 0.03. Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.1.1 Softmax with Missing Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the results, where the dark bars show the accuracy of M1, and the light bars show the accuracies of M2. M2 sees the same number of targeted samples, while it simultaneously has to distinguish other classes well, which still leads to the degradation of performance on targeted classes. As the number of targeted classes decreases, the performance degradation becomes more serious. That is, if one only aims to distinguish a partial set of classes, introducing other classes’ samples may degrade the performance. Correspondingly, in FL with incomplete classes, the aggregated global model on the server does not necessarily satisfy the client’s personalization goals. We will detail this more in the following sections.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2404.09232/assets/x8.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="175" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S5.F8.2.1" class="ltx_text" style="font-size:90%;">An FL demo that shows the drawbacks of FedAvg (the top) and the advantages of MAP (the bottom).</span></figcaption>
</figure>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Visualization in FL with Incomplete Classes</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p id="S5.SS1.SSS3.p1.2" class="ltx_p">Then, we show the drawbacks of softmax and the phenomena of local performance degradation caused by incomplete classes in an FL demo. The simple demo only contains 2 clients, where the first client owns samples from the class set <math id="S5.SS1.SSS3.p1.1.m1.5" class="ltx_Math" alttext="\{0,1,2,3,4\}" display="inline"><semantics id="S5.SS1.SSS3.p1.1.m1.5a"><mrow id="S5.SS1.SSS3.p1.1.m1.5.6.2" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml"><mo stretchy="false" id="S5.SS1.SSS3.p1.1.m1.5.6.2.1" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">{</mo><mn id="S5.SS1.SSS3.p1.1.m1.1.1" xref="S5.SS1.SSS3.p1.1.m1.1.1.cmml">0</mn><mo id="S5.SS1.SSS3.p1.1.m1.5.6.2.2" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.1.m1.2.2" xref="S5.SS1.SSS3.p1.1.m1.2.2.cmml">1</mn><mo id="S5.SS1.SSS3.p1.1.m1.5.6.2.3" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.1.m1.3.3" xref="S5.SS1.SSS3.p1.1.m1.3.3.cmml">2</mn><mo id="S5.SS1.SSS3.p1.1.m1.5.6.2.4" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.1.m1.4.4" xref="S5.SS1.SSS3.p1.1.m1.4.4.cmml">3</mn><mo id="S5.SS1.SSS3.p1.1.m1.5.6.2.5" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.1.m1.5.5" xref="S5.SS1.SSS3.p1.1.m1.5.5.cmml">4</mn><mo stretchy="false" id="S5.SS1.SSS3.p1.1.m1.5.6.2.6" xref="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.1.m1.5b"><set id="S5.SS1.SSS3.p1.1.m1.5.6.1.cmml" xref="S5.SS1.SSS3.p1.1.m1.5.6.2"><cn type="integer" id="S5.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS3.p1.1.m1.1.1">0</cn><cn type="integer" id="S5.SS1.SSS3.p1.1.m1.2.2.cmml" xref="S5.SS1.SSS3.p1.1.m1.2.2">1</cn><cn type="integer" id="S5.SS1.SSS3.p1.1.m1.3.3.cmml" xref="S5.SS1.SSS3.p1.1.m1.3.3">2</cn><cn type="integer" id="S5.SS1.SSS3.p1.1.m1.4.4.cmml" xref="S5.SS1.SSS3.p1.1.m1.4.4">3</cn><cn type="integer" id="S5.SS1.SSS3.p1.1.m1.5.5.cmml" xref="S5.SS1.SSS3.p1.1.m1.5.5">4</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.1.m1.5c">\{0,1,2,3,4\}</annotation></semantics></math> while the second one has samples from <math id="S5.SS1.SSS3.p1.2.m2.5" class="ltx_Math" alttext="\{5,6,7,8,9\}" display="inline"><semantics id="S5.SS1.SSS3.p1.2.m2.5a"><mrow id="S5.SS1.SSS3.p1.2.m2.5.6.2" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml"><mo stretchy="false" id="S5.SS1.SSS3.p1.2.m2.5.6.2.1" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">{</mo><mn id="S5.SS1.SSS3.p1.2.m2.1.1" xref="S5.SS1.SSS3.p1.2.m2.1.1.cmml">5</mn><mo id="S5.SS1.SSS3.p1.2.m2.5.6.2.2" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.2.m2.2.2" xref="S5.SS1.SSS3.p1.2.m2.2.2.cmml">6</mn><mo id="S5.SS1.SSS3.p1.2.m2.5.6.2.3" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.2.m2.3.3" xref="S5.SS1.SSS3.p1.2.m2.3.3.cmml">7</mn><mo id="S5.SS1.SSS3.p1.2.m2.5.6.2.4" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.2.m2.4.4" xref="S5.SS1.SSS3.p1.2.m2.4.4.cmml">8</mn><mo id="S5.SS1.SSS3.p1.2.m2.5.6.2.5" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.2.m2.5.5" xref="S5.SS1.SSS3.p1.2.m2.5.5.cmml">9</mn><mo stretchy="false" id="S5.SS1.SSS3.p1.2.m2.5.6.2.6" xref="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.2.m2.5b"><set id="S5.SS1.SSS3.p1.2.m2.5.6.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.5.6.2"><cn type="integer" id="S5.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1">5</cn><cn type="integer" id="S5.SS1.SSS3.p1.2.m2.2.2.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2">6</cn><cn type="integer" id="S5.SS1.SSS3.p1.2.m2.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3">7</cn><cn type="integer" id="S5.SS1.SSS3.p1.2.m2.4.4.cmml" xref="S5.SS1.SSS3.p1.2.m2.4.4">8</cn><cn type="integer" id="S5.SS1.SSS3.p1.2.m2.5.5.cmml" xref="S5.SS1.SSS3.p1.2.m2.5.5">9</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.2.m2.5c">\{5,6,7,8,9\}</annotation></semantics></math>. We use LeNet without ReLU activation as the network and set the final dimension as 2 for better visualization. We train models following the procedure of FL. Specifically, we take 10 global communication rounds and train local models up to 5 epochs in each local personalization procedure. We plot the learned features and proxies at the 5th round in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. The two rows compare FedAvg and MAP on the first client. The first column shows the beginning of the local procedure, i.e., the extracted features via the newly-downloaded global model and its proxies. The second column shows the local personalized results with incomplete classes, i.e., only 5 classes. We can obviously observe that proxies of missing classes are suppressed towards zero in FedAvg, while MAP can alleviate this phenomenon owing to the effects of “RS”. Correspondingly, the aggregated proxies become inaccurate in FedAvg, while MAP can get more discriminative proxies in the third column. The last column shows the performance degradation in this simple FL demo. Specifically, we record the local test accuracies of the newly downloaded model and the personalized model in each personalization stage. When using FedAvg, we can observe that the local performances will improve during the personalization procedure (the solid segments), while the newly downloaded models’ performance could be much worse than the last personalized model (the dotted segments). This observation conforms to the motivation in Sect. <a href="#S4.SS2.SSS1" title="4.2.1 Local Performance Degradation ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2.1</span></a>. However, MAP could mitigate the performance degradation phenomena with the help of the “HPM”. The above results directly show the problems of traditional FL algorithms faced with incomplete classes and vividly verify the superiorities of MAP.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span><span id="S5.SS2.1.1" class="ltx_text ltx_font_italic">Performance Comparisons</span>
</h3>

<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Experimental Settings</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para">
<p id="S5.SS2.SSS1.p1.1" class="ltx_p">We then evaluate the aggregation and personalization performances of MAP on several FL benchmarks including FaMnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite>, CIFAR-10/100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, and CINIC-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>. The full name of FaMnist is Fashion-MNIST, which comprises 70,000 images of fashion products from 10 categories. The training set has 60,000 images and the test set has 10,000 images. CIFAR-10 and CIFAR-100 have 10/100 classes to classify. They consist of 50,000 training images and 10,000 test images. CINIC-10 is a combination of CIFAR-10 and ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which contains 10 classes. It contains 90,000 samples for training, validation, and testing, respectively. We do not use the validation set. We scale all images to the size of <math id="S5.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S5.SS2.SSS1.p1.1.m1.1a"><mrow id="S5.SS2.SSS1.p1.1.m1.1.1" xref="S5.SS2.SSS1.p1.1.m1.1.1.cmml"><mn id="S5.SS2.SSS1.p1.1.m1.1.1.2" xref="S5.SS2.SSS1.p1.1.m1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS1.p1.1.m1.1.1.1" xref="S5.SS2.SSS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS2.SSS1.p1.1.m1.1.1.3" xref="S5.SS2.SSS1.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p1.1.m1.1b"><apply id="S5.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1"><times id="S5.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1.1"></times><cn type="integer" id="S5.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1.2">32</cn><cn type="integer" id="S5.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p1.1.m1.1c">32\times 32</annotation></semantics></math>.</p>
</div>
<div id="S5.SS2.SSS1.p2" class="ltx_para">
<p id="S5.SS2.SSS1.p2.1" class="ltx_p">For each benchmark, we vary the utilized neural networks to fully verify the effectiveness of MAP. Specifically, for FaMnist, we utilize MLPNet and LeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> as the models, respectively. MLPNet contains two hidden layers with each hidden layer containing 512 neurons. Different from the goal of visualization, we utilize the original LeNet without any modifications. For CIFAR-10, we utilize the network used in FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> (denoted as TFCNN) and VGG8 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>]</cite>, respectively. We utilize VGG8-BN and VGG11 for CIFAR-100. ResNet20 and ResNet56 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> are for CINIC-10. The networks are implemented via PyTorch<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://pytorch.org</span></span></span></span>.</p>
</div>
<div id="S5.SS2.SSS1.p3" class="ltx_para">
<p id="S5.SS2.SSS1.p3.1" class="ltx_p">Then we introduce the settings of FL experiments. By default, we assume there are 100 clients that are coordinated by one single central server. To simulate the FL scenes with incomplete classes, we randomly assign <math id="S5.SS2.SSS1.p3.1.m1.4" class="ltx_Math" alttext="c\in\{2,3,\ldots,C\}" display="inline"><semantics id="S5.SS2.SSS1.p3.1.m1.4a"><mrow id="S5.SS2.SSS1.p3.1.m1.4.5" xref="S5.SS2.SSS1.p3.1.m1.4.5.cmml"><mi id="S5.SS2.SSS1.p3.1.m1.4.5.2" xref="S5.SS2.SSS1.p3.1.m1.4.5.2.cmml">c</mi><mo id="S5.SS2.SSS1.p3.1.m1.4.5.1" xref="S5.SS2.SSS1.p3.1.m1.4.5.1.cmml">∈</mo><mrow id="S5.SS2.SSS1.p3.1.m1.4.5.3.2" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS1.p3.1.m1.4.5.3.2.1" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml">{</mo><mn id="S5.SS2.SSS1.p3.1.m1.1.1" xref="S5.SS2.SSS1.p3.1.m1.1.1.cmml">2</mn><mo id="S5.SS2.SSS1.p3.1.m1.4.5.3.2.2" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS2.SSS1.p3.1.m1.2.2" xref="S5.SS2.SSS1.p3.1.m1.2.2.cmml">3</mn><mo id="S5.SS2.SSS1.p3.1.m1.4.5.3.2.3" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S5.SS2.SSS1.p3.1.m1.3.3" xref="S5.SS2.SSS1.p3.1.m1.3.3.cmml">…</mi><mo id="S5.SS2.SSS1.p3.1.m1.4.5.3.2.4" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml">,</mo><mi id="S5.SS2.SSS1.p3.1.m1.4.4" xref="S5.SS2.SSS1.p3.1.m1.4.4.cmml">C</mi><mo stretchy="false" id="S5.SS2.SSS1.p3.1.m1.4.5.3.2.5" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p3.1.m1.4b"><apply id="S5.SS2.SSS1.p3.1.m1.4.5.cmml" xref="S5.SS2.SSS1.p3.1.m1.4.5"><in id="S5.SS2.SSS1.p3.1.m1.4.5.1.cmml" xref="S5.SS2.SSS1.p3.1.m1.4.5.1"></in><ci id="S5.SS2.SSS1.p3.1.m1.4.5.2.cmml" xref="S5.SS2.SSS1.p3.1.m1.4.5.2">𝑐</ci><set id="S5.SS2.SSS1.p3.1.m1.4.5.3.1.cmml" xref="S5.SS2.SSS1.p3.1.m1.4.5.3.2"><cn type="integer" id="S5.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p3.1.m1.1.1">2</cn><cn type="integer" id="S5.SS2.SSS1.p3.1.m1.2.2.cmml" xref="S5.SS2.SSS1.p3.1.m1.2.2">3</cn><ci id="S5.SS2.SSS1.p3.1.m1.3.3.cmml" xref="S5.SS2.SSS1.p3.1.m1.3.3">…</ci><ci id="S5.SS2.SSS1.p3.1.m1.4.4.cmml" xref="S5.SS2.SSS1.p3.1.m1.4.4">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p3.1.m1.4c">c\in\{2,3,\ldots,C\}</annotation></semantics></math> classes to each client and decentralize the training samples of corresponding benchmarks onto these clients. This strategy is similar to several previous works that utilize label partitions to split data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib79" title="" class="ltx_ref">79</a>]</cite>. Different from them, we assume that the number of classes differs among clients. The test samples of corresponding benchmarks are stored on the server to evaluate the aggregation performance. To evaluate the local personalization performance, we randomly leave aside 20% samples on each client as local test samples. Notably, although the client encounters missing classes, the samples among observed classes are nearly balanced. Hence, we utilize accuracy as the metric for both aggregation and personalization performance evaluation.</p>
</div>
<div id="S5.SS2.SSS1.p4" class="ltx_para">
<p id="S5.SS2.SSS1.p4.4" class="ltx_p">We then report the utilized FL hyper-parameters. We set the number of communication rounds (<math id="S5.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.SSS1.p4.1.m1.1a"><mi id="S5.SS2.SSS1.p4.1.m1.1.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.1.m1.1b"><ci id="S5.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.1.m1.1c">T</annotation></semantics></math>) as 150 and the client selection ratio (<math id="S5.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S5.SS2.SSS1.p4.2.m2.1a"><mi id="S5.SS2.SSS1.p4.2.m2.1.1" xref="S5.SS2.SSS1.p4.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.2.m2.1b"><ci id="S5.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S5.SS2.SSS1.p4.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.2.m2.1c">Q</annotation></semantics></math>) as 0.2. That is, we select 20% clients to participate in the FL procedure in each round. The number of local personalization epochs (<math id="S5.SS2.SSS1.p4.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.SSS1.p4.3.m3.1a"><mi id="S5.SS2.SSS1.p4.3.m3.1.1" xref="S5.SS2.SSS1.p4.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.3.m3.1b"><ci id="S5.SS2.SSS1.p4.3.m3.1.1.cmml" xref="S5.SS2.SSS1.p4.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.3.m3.1c">E</annotation></semantics></math>) is varied among FaMnist, CIFAR-10, CIFAR-100, and CINIC-10, i.e., 5, 10, 20, and 40 epochs, respectively. Because ResNet could be stably updated with a larger learning rate, we utilize a constant learning rate of 0.03 for the first three benchmarks, and 0.05 for CINIC-10. The optimizer is SGD with a momentum of 0.9. The batch size is 64 and the weight decay is <span id="S5.SS2.SSS1.p4.4.1" class="ltx_text ltx_markedasmath">1e-5</span>.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span><span id="S5.T2.4.2" class="ltx_text" style="font-size:90%;">Personalization performance comparisons with standard FL algorithms (<math id="S5.T2.3.1.m1.1" class="ltx_Math" alttext="T=150" display="inline"><semantics id="S5.T2.3.1.m1.1b"><mrow id="S5.T2.3.1.m1.1.1" xref="S5.T2.3.1.m1.1.1.cmml"><mi id="S5.T2.3.1.m1.1.1.2" xref="S5.T2.3.1.m1.1.1.2.cmml">T</mi><mo id="S5.T2.3.1.m1.1.1.1" xref="S5.T2.3.1.m1.1.1.1.cmml">=</mo><mn id="S5.T2.3.1.m1.1.1.3" xref="S5.T2.3.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.m1.1c"><apply id="S5.T2.3.1.m1.1.1.cmml" xref="S5.T2.3.1.m1.1.1"><eq id="S5.T2.3.1.m1.1.1.1.cmml" xref="S5.T2.3.1.m1.1.1.1"></eq><ci id="S5.T2.3.1.m1.1.1.2.cmml" xref="S5.T2.3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S5.T2.3.1.m1.1.1.3.cmml" xref="S5.T2.3.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.m1.1d">T=150</annotation></semantics></math>, <math id="S5.T2.4.2.m2.1" class="ltx_Math" alttext="Q=0.2" display="inline"><semantics id="S5.T2.4.2.m2.1b"><mrow id="S5.T2.4.2.m2.1.1" xref="S5.T2.4.2.m2.1.1.cmml"><mi id="S5.T2.4.2.m2.1.1.2" xref="S5.T2.4.2.m2.1.1.2.cmml">Q</mi><mo id="S5.T2.4.2.m2.1.1.1" xref="S5.T2.4.2.m2.1.1.1.cmml">=</mo><mn id="S5.T2.4.2.m2.1.1.3" xref="S5.T2.4.2.m2.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.m2.1c"><apply id="S5.T2.4.2.m2.1.1.cmml" xref="S5.T2.4.2.m2.1.1"><eq id="S5.T2.4.2.m2.1.1.1.cmml" xref="S5.T2.4.2.m2.1.1.1"></eq><ci id="S5.T2.4.2.m2.1.1.2.cmml" xref="S5.T2.4.2.m2.1.1.2">𝑄</ci><cn type="float" id="S5.T2.4.2.m2.1.1.3.cmml" xref="S5.T2.4.2.m2.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.m2.1d">Q=0.2</annotation></semantics></math>).</span></figcaption>
<table id="S5.T2.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.8.4" class="ltx_tr">
<th id="S5.T2.8.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td id="S5.T2.5.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">FaMnist (<math id="S5.T2.5.1.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.T2.5.1.1.m1.1a"><mrow id="S5.T2.5.1.1.m1.1.1" xref="S5.T2.5.1.1.m1.1.1.cmml"><mi id="S5.T2.5.1.1.m1.1.1.2" xref="S5.T2.5.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.T2.5.1.1.m1.1.1.1" xref="S5.T2.5.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T2.5.1.1.m1.1.1.3" xref="S5.T2.5.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.1.1.m1.1b"><apply id="S5.T2.5.1.1.m1.1.1.cmml" xref="S5.T2.5.1.1.m1.1.1"><eq id="S5.T2.5.1.1.m1.1.1.1.cmml" xref="S5.T2.5.1.1.m1.1.1.1"></eq><ci id="S5.T2.5.1.1.m1.1.1.2.cmml" xref="S5.T2.5.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T2.5.1.1.m1.1.1.3.cmml" xref="S5.T2.5.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.1.1.m1.1c">E=5</annotation></semantics></math>)</td>
<td id="S5.T2.6.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CIFAR-10 (<math id="S5.T2.6.2.2.m1.1" class="ltx_Math" alttext="E=10" display="inline"><semantics id="S5.T2.6.2.2.m1.1a"><mrow id="S5.T2.6.2.2.m1.1.1" xref="S5.T2.6.2.2.m1.1.1.cmml"><mi id="S5.T2.6.2.2.m1.1.1.2" xref="S5.T2.6.2.2.m1.1.1.2.cmml">E</mi><mo id="S5.T2.6.2.2.m1.1.1.1" xref="S5.T2.6.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T2.6.2.2.m1.1.1.3" xref="S5.T2.6.2.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.2.2.m1.1b"><apply id="S5.T2.6.2.2.m1.1.1.cmml" xref="S5.T2.6.2.2.m1.1.1"><eq id="S5.T2.6.2.2.m1.1.1.1.cmml" xref="S5.T2.6.2.2.m1.1.1.1"></eq><ci id="S5.T2.6.2.2.m1.1.1.2.cmml" xref="S5.T2.6.2.2.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T2.6.2.2.m1.1.1.3.cmml" xref="S5.T2.6.2.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.2.2.m1.1c">E=10</annotation></semantics></math>)</td>
<td id="S5.T2.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CIFAR-100 (<math id="S5.T2.7.3.3.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="S5.T2.7.3.3.m1.1a"><mrow id="S5.T2.7.3.3.m1.1.1" xref="S5.T2.7.3.3.m1.1.1.cmml"><mi id="S5.T2.7.3.3.m1.1.1.2" xref="S5.T2.7.3.3.m1.1.1.2.cmml">E</mi><mo id="S5.T2.7.3.3.m1.1.1.1" xref="S5.T2.7.3.3.m1.1.1.1.cmml">=</mo><mn id="S5.T2.7.3.3.m1.1.1.3" xref="S5.T2.7.3.3.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.7.3.3.m1.1b"><apply id="S5.T2.7.3.3.m1.1.1.cmml" xref="S5.T2.7.3.3.m1.1.1"><eq id="S5.T2.7.3.3.m1.1.1.1.cmml" xref="S5.T2.7.3.3.m1.1.1.1"></eq><ci id="S5.T2.7.3.3.m1.1.1.2.cmml" xref="S5.T2.7.3.3.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T2.7.3.3.m1.1.1.3.cmml" xref="S5.T2.7.3.3.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.3.3.m1.1c">E=20</annotation></semantics></math>)</td>
<td id="S5.T2.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="2">CINIC-10 (<math id="S5.T2.8.4.4.m1.1" class="ltx_Math" alttext="E=40" display="inline"><semantics id="S5.T2.8.4.4.m1.1a"><mrow id="S5.T2.8.4.4.m1.1.1" xref="S5.T2.8.4.4.m1.1.1.cmml"><mi id="S5.T2.8.4.4.m1.1.1.2" xref="S5.T2.8.4.4.m1.1.1.2.cmml">E</mi><mo id="S5.T2.8.4.4.m1.1.1.1" xref="S5.T2.8.4.4.m1.1.1.1.cmml">=</mo><mn id="S5.T2.8.4.4.m1.1.1.3" xref="S5.T2.8.4.4.m1.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.4.4.m1.1b"><apply id="S5.T2.8.4.4.m1.1.1.cmml" xref="S5.T2.8.4.4.m1.1.1"><eq id="S5.T2.8.4.4.m1.1.1.1.cmml" xref="S5.T2.8.4.4.m1.1.1.1"></eq><ci id="S5.T2.8.4.4.m1.1.1.2.cmml" xref="S5.T2.8.4.4.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T2.8.4.4.m1.1.1.3.cmml" xref="S5.T2.8.4.4.m1.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.4.4.m1.1c">E=40</annotation></semantics></math>)</td>
<td id="S5.T2.8.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="2"><span id="S5.T2.8.4.6.1" class="ltx_text">Avg</span></td>
</tr>
<tr id="S5.T2.8.5.1" class="ltx_tr">
<th id="S5.T2.8.5.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td id="S5.T2.8.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MLPNet</td>
<td id="S5.T2.8.5.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">LeNet</td>
<td id="S5.T2.8.5.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">TFCNN</td>
<td id="S5.T2.8.5.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG8</td>
<td id="S5.T2.8.5.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG8-BN</td>
<td id="S5.T2.8.5.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">VGG11</td>
<td id="S5.T2.8.5.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ResNet20</td>
<td id="S5.T2.8.5.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ResNet56</td>
</tr>
<tr id="S5.T2.8.6.2" class="ltx_tr">
<th id="S5.T2.8.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S5.T2.8.6.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.5 <span id="S5.T2.8.6.2.2.1" class="ltx_text" style="font-size:70%;">(0.58%)</span>
</td>
<td id="S5.T2.8.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.3 <span id="S5.T2.8.6.2.3.1" class="ltx_text" style="font-size:70%;">(0.68%)</span>
</td>
<td id="S5.T2.8.6.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.7 <span id="S5.T2.8.6.2.4.1" class="ltx_text" style="font-size:70%;">(0.99%)</span>
</td>
<td id="S5.T2.8.6.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.5 <span id="S5.T2.8.6.2.5.1" class="ltx_text" style="font-size:70%;">(0.82%)</span>
</td>
<td id="S5.T2.8.6.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.0 <span id="S5.T2.8.6.2.6.1" class="ltx_text" style="font-size:70%;">(0.56%)</span>
</td>
<td id="S5.T2.8.6.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.4 <span id="S5.T2.8.6.2.7.1" class="ltx_text" style="font-size:70%;">(0.90%)</span>
</td>
<td id="S5.T2.8.6.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.0 <span id="S5.T2.8.6.2.8.1" class="ltx_text" style="font-size:70%;">(0.84%)</span>
</td>
<td id="S5.T2.8.6.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.9 <span id="S5.T2.8.6.2.9.1" class="ltx_text" style="font-size:70%;">(0.47%)</span>
</td>
<td id="S5.T2.8.6.2.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.3</td>
</tr>
<tr id="S5.T2.8.7.3" class="ltx_tr">
<th id="S5.T2.8.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</th>
<td id="S5.T2.8.7.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.7 <span id="S5.T2.8.7.3.2.1" class="ltx_text" style="font-size:70%;">(0.51%)</span>
</td>
<td id="S5.T2.8.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.0 <span id="S5.T2.8.7.3.3.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T2.8.7.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.0 <span id="S5.T2.8.7.3.4.1" class="ltx_text" style="font-size:70%;">(0.76%)</span>
</td>
<td id="S5.T2.8.7.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.2 <span id="S5.T2.8.7.3.5.1" class="ltx_text" style="font-size:70%;">(1.18%)</span>
</td>
<td id="S5.T2.8.7.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.4 <span id="S5.T2.8.7.3.6.1" class="ltx_text" style="font-size:70%;">(0.80%)</span>
</td>
<td id="S5.T2.8.7.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.4 <span id="S5.T2.8.7.3.7.1" class="ltx_text" style="font-size:70%;">(0.76%)</span>
</td>
<td id="S5.T2.8.7.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.2 <span id="S5.T2.8.7.3.8.1" class="ltx_text" style="font-size:70%;">(0.40%)</span>
</td>
<td id="S5.T2.8.7.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.1 <span id="S5.T2.8.7.3.9.1" class="ltx_text" style="font-size:70%;">(0.52%)</span>
</td>
<td id="S5.T2.8.7.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.2</td>
</tr>
<tr id="S5.T2.8.8.4" class="ltx_tr">
<th id="S5.T2.8.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</th>
<td id="S5.T2.8.8.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.8 <span id="S5.T2.8.8.4.2.1" class="ltx_text" style="font-size:70%;">(4.53%)</span>
</td>
<td id="S5.T2.8.8.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.2 <span id="S5.T2.8.8.4.3.1" class="ltx_text" style="font-size:70%;">(0.39%)</span>
</td>
<td id="S5.T2.8.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.0 <span id="S5.T2.8.8.4.4.1" class="ltx_text" style="font-size:70%;">(0.99%)</span>
</td>
<td id="S5.T2.8.8.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.5 <span id="S5.T2.8.8.4.5.1" class="ltx_text" style="font-size:70%;">(0.55%)</span>
</td>
<td id="S5.T2.8.8.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.4 <span id="S5.T2.8.8.4.6.1" class="ltx_text" style="font-size:70%;">(1.01%)</span>
</td>
<td id="S5.T2.8.8.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">32.6 <span id="S5.T2.8.8.4.7.1" class="ltx_text" style="font-size:70%;">(1.25%)</span>
</td>
<td id="S5.T2.8.8.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.7 <span id="S5.T2.8.8.4.8.1" class="ltx_text" style="font-size:70%;">(0.27%)</span>
</td>
<td id="S5.T2.8.8.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.9 <span id="S5.T2.8.8.4.9.1" class="ltx_text" style="font-size:70%;">(0.80%)</span>
</td>
<td id="S5.T2.8.8.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.1</td>
</tr>
<tr id="S5.T2.8.9.5" class="ltx_tr">
<th id="S5.T2.8.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</th>
<td id="S5.T2.8.9.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.7 <span id="S5.T2.8.9.5.2.1" class="ltx_text" style="font-size:70%;">(0.42%)</span>
</td>
<td id="S5.T2.8.9.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.3 <span id="S5.T2.8.9.5.3.1" class="ltx_text" style="font-size:70%;">(0.13%)</span>
</td>
<td id="S5.T2.8.9.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.1 <span id="S5.T2.8.9.5.4.1" class="ltx_text" style="font-size:70%;">(0.71%)</span>
</td>
<td id="S5.T2.8.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.9 <span id="S5.T2.8.9.5.5.1" class="ltx_text" style="font-size:70%;">(1.04%)</span>
</td>
<td id="S5.T2.8.9.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">51.2 <span id="S5.T2.8.9.5.6.1" class="ltx_text" style="font-size:70%;">(1.16%)</span>
</td>
<td id="S5.T2.8.9.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.7 <span id="S5.T2.8.9.5.7.1" class="ltx_text" style="font-size:70%;">(1.11%)</span>
</td>
<td id="S5.T2.8.9.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.5 <span id="S5.T2.8.9.5.8.1" class="ltx_text" style="font-size:70%;">(0.74%)</span>
</td>
<td id="S5.T2.8.9.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.6 <span id="S5.T2.8.9.5.9.1" class="ltx_text" style="font-size:70%;">(1.24%)</span>
</td>
<td id="S5.T2.8.9.5.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.4</td>
</tr>
<tr id="S5.T2.8.10.6" class="ltx_tr">
<th id="S5.T2.8.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S5.T2.8.10.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.2 <span id="S5.T2.8.10.6.2.1" class="ltx_text" style="font-size:70%;">(1.64%)</span>
</td>
<td id="S5.T2.8.10.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.9 <span id="S5.T2.8.10.6.3.1" class="ltx_text" style="font-size:70%;">(0.60%)</span>
</td>
<td id="S5.T2.8.10.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.8 <span id="S5.T2.8.10.6.4.1" class="ltx_text" style="font-size:70%;">(1.96%)</span>
</td>
<td id="S5.T2.8.10.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.6 <span id="S5.T2.8.10.6.5.1" class="ltx_text" style="font-size:70%;">(3.01%)</span>
</td>
<td id="S5.T2.8.10.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.2 <span id="S5.T2.8.10.6.6.1" class="ltx_text" style="font-size:70%;">(1.55%)</span>
</td>
<td id="S5.T2.8.10.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.3 <span id="S5.T2.8.10.6.7.1" class="ltx_text" style="font-size:70%;">(1.20%)</span>
</td>
<td id="S5.T2.8.10.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.0 <span id="S5.T2.8.10.6.8.1" class="ltx_text" style="font-size:70%;">(1.63%)</span>
</td>
<td id="S5.T2.8.10.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.6 <span id="S5.T2.8.10.6.9.1" class="ltx_text" style="font-size:70%;">(1.89%)</span>
</td>
<td id="S5.T2.8.10.6.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.2</td>
</tr>
<tr id="S5.T2.8.11.7" class="ltx_tr">
<th id="S5.T2.8.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>
</th>
<td id="S5.T2.8.11.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.2 <span id="S5.T2.8.11.7.2.1" class="ltx_text" style="font-size:70%;">(1.23%)</span>
</td>
<td id="S5.T2.8.11.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.0 <span id="S5.T2.8.11.7.3.1" class="ltx_text" style="font-size:70%;">(0.68%)</span>
</td>
<td id="S5.T2.8.11.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.7 <span id="S5.T2.8.11.7.4.1" class="ltx_text" style="font-size:70%;">(1.72%)</span>
</td>
<td id="S5.T2.8.11.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.7 <span id="S5.T2.8.11.7.5.1" class="ltx_text" style="font-size:70%;">(1.14%)</span>
</td>
<td id="S5.T2.8.11.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">51.6 <span id="S5.T2.8.11.7.6.1" class="ltx_text" style="font-size:70%;">(1.60%)</span>
</td>
<td id="S5.T2.8.11.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.8 <span id="S5.T2.8.11.7.7.1" class="ltx_text" style="font-size:70%;">(1.33%)</span>
</td>
<td id="S5.T2.8.11.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.6 <span id="S5.T2.8.11.7.8.1" class="ltx_text" style="font-size:70%;">(1.42%)</span>
</td>
<td id="S5.T2.8.11.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.9 <span id="S5.T2.8.11.7.9.1" class="ltx_text" style="font-size:70%;">(1.92%)</span>
</td>
<td id="S5.T2.8.11.7.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.3</td>
</tr>
<tr id="S5.T2.8.12.8" class="ltx_tr">
<th id="S5.T2.8.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>
</th>
<td id="S5.T2.8.12.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.6 <span id="S5.T2.8.12.8.2.1" class="ltx_text" style="font-size:70%;">(1.20%)</span>
</td>
<td id="S5.T2.8.12.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.5 <span id="S5.T2.8.12.8.3.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T2.8.12.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.7 <span id="S5.T2.8.12.8.4.1" class="ltx_text" style="font-size:70%;">(1.91%)</span>
</td>
<td id="S5.T2.8.12.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.8 <span id="S5.T2.8.12.8.5.1" class="ltx_text" style="font-size:70%;">(1.34%)</span>
</td>
<td id="S5.T2.8.12.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">43.9 <span id="S5.T2.8.12.8.6.1" class="ltx_text" style="font-size:70%;">(1.54%)</span>
</td>
<td id="S5.T2.8.12.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.6 <span id="S5.T2.8.12.8.7.1" class="ltx_text" style="font-size:70%;">(1.24%)</span>
</td>
<td id="S5.T2.8.12.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.3 <span id="S5.T2.8.12.8.8.1" class="ltx_text" style="font-size:70%;">(1.31%)</span>
</td>
<td id="S5.T2.8.12.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.5 <span id="S5.T2.8.12.8.9.1" class="ltx_text" style="font-size:70%;">(1.53%)</span>
</td>
<td id="S5.T2.8.12.8.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.6</td>
</tr>
<tr id="S5.T2.8.13.9" class="ltx_tr">
<th id="S5.T2.8.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAwS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>
</th>
<td id="S5.T2.8.13.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.9 <span id="S5.T2.8.13.9.2.1" class="ltx_text" style="font-size:70%;">(0.60%)</span>
</td>
<td id="S5.T2.8.13.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.8 <span id="S5.T2.8.13.9.3.1" class="ltx_text" style="font-size:70%;">(0.46%)</span>
</td>
<td id="S5.T2.8.13.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.0 <span id="S5.T2.8.13.9.4.1" class="ltx_text" style="font-size:70%;">(0.89%)</span>
</td>
<td id="S5.T2.8.13.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.2 <span id="S5.T2.8.13.9.5.1" class="ltx_text" style="font-size:70%;">(0.62%)</span>
</td>
<td id="S5.T2.8.13.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">51.1 <span id="S5.T2.8.13.9.6.1" class="ltx_text" style="font-size:70%;">(1.55%)</span>
</td>
<td id="S5.T2.8.13.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">29.7 <span id="S5.T2.8.13.9.7.1" class="ltx_text" style="font-size:70%;">(1.26%)</span>
</td>
<td id="S5.T2.8.13.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.5 <span id="S5.T2.8.13.9.8.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T2.8.13.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.5 <span id="S5.T2.8.13.9.9.1" class="ltx_text" style="font-size:70%;">(0.30%)</span>
</td>
<td id="S5.T2.8.13.9.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.7</td>
</tr>
<tr id="S5.T2.8.14.10" class="ltx_tr">
<th id="S5.T2.8.14.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite>
</th>
<td id="S5.T2.8.14.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.6 <span id="S5.T2.8.14.10.2.1" class="ltx_text" style="font-size:70%;">(0.36%)</span>
</td>
<td id="S5.T2.8.14.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.7 <span id="S5.T2.8.14.10.3.1" class="ltx_text" style="font-size:70%;">(0.28%)</span>
</td>
<td id="S5.T2.8.14.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.6 <span id="S5.T2.8.14.10.4.1" class="ltx_text" style="font-size:70%;">(0.85%)</span>
</td>
<td id="S5.T2.8.14.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.5 <span id="S5.T2.8.14.10.5.1" class="ltx_text" style="font-size:70%;">(0.92%)</span>
</td>
<td id="S5.T2.8.14.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.7 <span id="S5.T2.8.14.10.6.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T2.8.14.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">28.1 <span id="S5.T2.8.14.10.7.1" class="ltx_text" style="font-size:70%;">(0.28%)</span>
</td>
<td id="S5.T2.8.14.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.2 <span id="S5.T2.8.14.10.8.1" class="ltx_text" style="font-size:70%;">(0.66%)</span>
</td>
<td id="S5.T2.8.14.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.2 <span id="S5.T2.8.14.10.9.1" class="ltx_text" style="font-size:70%;">(0.93%)</span>
</td>
<td id="S5.T2.8.14.10.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.3</td>
</tr>
<tr id="S5.T2.8.15.11" class="ltx_tr">
<th id="S5.T2.8.15.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</th>
<td id="S5.T2.8.15.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.2 <span id="S5.T2.8.15.11.2.1" class="ltx_text" style="font-size:70%;">(1.09%)</span>
</td>
<td id="S5.T2.8.15.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.7 <span id="S5.T2.8.15.11.3.1" class="ltx_text" style="font-size:70%;">(1.88%)</span>
</td>
<td id="S5.T2.8.15.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.6 <span id="S5.T2.8.15.11.4.1" class="ltx_text" style="font-size:70%;">(1.98%)</span>
</td>
<td id="S5.T2.8.15.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.5 <span id="S5.T2.8.15.11.5.1" class="ltx_text" style="font-size:70%;">(2.07%)</span>
</td>
<td id="S5.T2.8.15.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">39.7 <span id="S5.T2.8.15.11.6.1" class="ltx_text" style="font-size:70%;">(1.08%)</span>
</td>
<td id="S5.T2.8.15.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">23.3 <span id="S5.T2.8.15.11.7.1" class="ltx_text" style="font-size:70%;">(1.17%)</span>
</td>
<td id="S5.T2.8.15.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.7 <span id="S5.T2.8.15.11.8.1" class="ltx_text" style="font-size:70%;">(0.52%)</span>
</td>
<td id="S5.T2.8.15.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.9 <span id="S5.T2.8.15.11.9.1" class="ltx_text" style="font-size:70%;">(1.10%)</span>
</td>
<td id="S5.T2.8.15.11.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.2</td>
</tr>
<tr id="S5.T2.8.16.12" class="ltx_tr">
<th id="S5.T2.8.16.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>
</th>
<td id="S5.T2.8.16.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.2 <span id="S5.T2.8.16.12.2.1" class="ltx_text" style="font-size:70%;">(0.78%)</span>
</td>
<td id="S5.T2.8.16.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.5 <span id="S5.T2.8.16.12.3.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T2.8.16.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">61.7 <span id="S5.T2.8.16.12.4.1" class="ltx_text" style="font-size:70%;">(1.23%)</span>
</td>
<td id="S5.T2.8.16.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.5 <span id="S5.T2.8.16.12.5.1" class="ltx_text" style="font-size:70%;">(0.75%)</span>
</td>
<td id="S5.T2.8.16.12.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">32.0 <span id="S5.T2.8.16.12.6.1" class="ltx_text" style="font-size:70%;">(0.50%)</span>
</td>
<td id="S5.T2.8.16.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">19.2 <span id="S5.T2.8.16.12.7.1" class="ltx_text" style="font-size:70%;">(0.25%)</span>
</td>
<td id="S5.T2.8.16.12.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.6 <span id="S5.T2.8.16.12.8.1" class="ltx_text" style="font-size:70%;">(0.94%)</span>
</td>
<td id="S5.T2.8.16.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.0 <span id="S5.T2.8.16.12.9.1" class="ltx_text" style="font-size:70%;">(0.07%)</span>
</td>
<td id="S5.T2.8.16.12.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.1</td>
</tr>
<tr id="S5.T2.8.17.13" class="ltx_tr">
<th id="S5.T2.8.17.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FLDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>
</th>
<td id="S5.T2.8.17.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.9 <span id="S5.T2.8.17.13.2.1" class="ltx_text" style="font-size:70%;">(0.44%)</span>
</td>
<td id="S5.T2.8.17.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.3 <span id="S5.T2.8.17.13.3.1" class="ltx_text" style="font-size:70%;">(0.15%)</span>
</td>
<td id="S5.T2.8.17.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.2 <span id="S5.T2.8.17.13.4.1" class="ltx_text" style="font-size:70%;">(0.70%)</span>
</td>
<td id="S5.T2.8.17.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.1 <span id="S5.T2.8.17.13.5.1" class="ltx_text" style="font-size:70%;">(0.95%)</span>
</td>
<td id="S5.T2.8.17.13.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.2 <span id="S5.T2.8.17.13.6.1" class="ltx_text" style="font-size:70%;">(0.92%)</span>
</td>
<td id="S5.T2.8.17.13.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">24.6 <span id="S5.T2.8.17.13.7.1" class="ltx_text" style="font-size:70%;">(0.67%)</span>
</td>
<td id="S5.T2.8.17.13.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.4 <span id="S5.T2.8.17.13.8.1" class="ltx_text" style="font-size:70%;">(0.88%)</span>
</td>
<td id="S5.T2.8.17.13.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.1 <span id="S5.T2.8.17.13.9.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T2.8.17.13.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.6</td>
</tr>
<tr id="S5.T2.8.18.14" class="ltx_tr">
<th id="S5.T2.8.18.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite>
</th>
<td id="S5.T2.8.18.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.2 <span id="S5.T2.8.18.14.2.1" class="ltx_text" style="font-size:70%;">(0.55%)</span>
</td>
<td id="S5.T2.8.18.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.5 <span id="S5.T2.8.18.14.3.1" class="ltx_text" style="font-size:70%;">(0.85%)</span>
</td>
<td id="S5.T2.8.18.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.5 <span id="S5.T2.8.18.14.4.1" class="ltx_text" style="font-size:70%;">(3.10%)</span>
</td>
<td id="S5.T2.8.18.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.0 <span id="S5.T2.8.18.14.5.1" class="ltx_text" style="font-size:70%;">(2.16%)</span>
</td>
<td id="S5.T2.8.18.14.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.8 <span id="S5.T2.8.18.14.6.1" class="ltx_text" style="font-size:70%;">(1.15%)</span>
</td>
<td id="S5.T2.8.18.14.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1.7 <span id="S5.T2.8.18.14.7.1" class="ltx_text" style="font-size:70%;">(0.35%)</span>
</td>
<td id="S5.T2.8.18.14.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.5 <span id="S5.T2.8.18.14.8.1" class="ltx_text" style="font-size:70%;">(0.87%)</span>
</td>
<td id="S5.T2.8.18.14.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.3 <span id="S5.T2.8.18.14.9.1" class="ltx_text" style="font-size:70%;">(0.56%)</span>
</td>
<td id="S5.T2.8.18.14.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.3</td>
</tr>
<tr id="S5.T2.8.19.15" class="ltx_tr">
<th id="S5.T2.8.19.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">PerFedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>
</th>
<td id="S5.T2.8.19.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.2 <span id="S5.T2.8.19.15.2.1" class="ltx_text" style="font-size:70%;">(4.64%)</span>
</td>
<td id="S5.T2.8.19.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.1 <span id="S5.T2.8.19.15.3.1" class="ltx_text" style="font-size:70%;">(4.68%)</span>
</td>
<td id="S5.T2.8.19.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.0 <span id="S5.T2.8.19.15.4.1" class="ltx_text" style="font-size:70%;">(3.76%)</span>
</td>
<td id="S5.T2.8.19.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.6 <span id="S5.T2.8.19.15.5.1" class="ltx_text" style="font-size:70%;">(3.62%)</span>
</td>
<td id="S5.T2.8.19.15.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">46.1 <span id="S5.T2.8.19.15.6.1" class="ltx_text" style="font-size:70%;">(0.73%)</span>
</td>
<td id="S5.T2.8.19.15.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1.2 <span id="S5.T2.8.19.15.7.1" class="ltx_text" style="font-size:70%;">(0.17%)</span>
</td>
<td id="S5.T2.8.19.15.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.8 <span id="S5.T2.8.19.15.8.1" class="ltx_text" style="font-size:70%;">(0.80%)</span>
</td>
<td id="S5.T2.8.19.15.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.6 <span id="S5.T2.8.19.15.9.1" class="ltx_text" style="font-size:70%;">(1.29%)</span>
</td>
<td id="S5.T2.8.19.15.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.7</td>
</tr>
<tr id="S5.T2.8.20.16" class="ltx_tr">
<th id="S5.T2.8.20.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S5.T2.8.20.16.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.0 <span id="S5.T2.8.20.16.2.1" class="ltx_text" style="font-size:70%;">(0.92%)</span>
</td>
<td id="S5.T2.8.20.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.4 <span id="S5.T2.8.20.16.3.1" class="ltx_text" style="font-size:70%;">(1.23%)</span>
</td>
<td id="S5.T2.8.20.16.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.1 <span id="S5.T2.8.20.16.4.1" class="ltx_text" style="font-size:70%;">(2.22%)</span>
</td>
<td id="S5.T2.8.20.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.9 <span id="S5.T2.8.20.16.5.1" class="ltx_text" style="font-size:70%;">(2.17%)</span>
</td>
<td id="S5.T2.8.20.16.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.7 <span id="S5.T2.8.20.16.6.1" class="ltx_text" style="font-size:70%;">(0.12%)</span>
</td>
<td id="S5.T2.8.20.16.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">21.2 <span id="S5.T2.8.20.16.7.1" class="ltx_text" style="font-size:70%;">(1.04%)</span>
</td>
<td id="S5.T2.8.20.16.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.7 <span id="S5.T2.8.20.16.8.1" class="ltx_text" style="font-size:70%;">(0.77%)</span>
</td>
<td id="S5.T2.8.20.16.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.4 <span id="S5.T2.8.20.16.9.1" class="ltx_text" style="font-size:70%;">(1.12%)</span>
</td>
<td id="S5.T2.8.20.16.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">59.3</td>
</tr>
<tr id="S5.T2.8.21.17" class="ltx_tr">
<th id="S5.T2.8.21.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite>
</th>
<td id="S5.T2.8.21.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.0 <span id="S5.T2.8.21.17.2.1" class="ltx_text" style="font-size:70%;">(0.71%)</span>
</td>
<td id="S5.T2.8.21.17.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.2 <span id="S5.T2.8.21.17.3.1" class="ltx_text" style="font-size:70%;">(1.11%)</span>
</td>
<td id="S5.T2.8.21.17.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.3 <span id="S5.T2.8.21.17.4.1" class="ltx_text" style="font-size:70%;">(0.21%)</span>
</td>
<td id="S5.T2.8.21.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.9 <span id="S5.T2.8.21.17.5.1" class="ltx_text" style="font-size:70%;">(1.64%)</span>
</td>
<td id="S5.T2.8.21.17.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.0 <span id="S5.T2.8.21.17.6.1" class="ltx_text" style="font-size:70%;">(0.72%)</span>
</td>
<td id="S5.T2.8.21.17.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">19.0 <span id="S5.T2.8.21.17.7.1" class="ltx_text" style="font-size:70%;">(1.10%)</span>
</td>
<td id="S5.T2.8.21.17.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.0 <span id="S5.T2.8.21.17.8.1" class="ltx_text" style="font-size:70%;">(0.18%)</span>
</td>
<td id="S5.T2.8.21.17.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.4 <span id="S5.T2.8.21.17.9.1" class="ltx_text" style="font-size:70%;">(0.59%)</span>
</td>
<td id="S5.T2.8.21.17.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.1</td>
</tr>
<tr id="S5.T2.8.22.18" class="ltx_tr">
<th id="S5.T2.8.22.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedROD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S5.T2.8.22.18.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.1 <span id="S5.T2.8.22.18.2.1" class="ltx_text" style="font-size:70%;">(0.21%)</span>
</td>
<td id="S5.T2.8.22.18.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.0 <span id="S5.T2.8.22.18.3.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T2.8.22.18.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.2 <span id="S5.T2.8.22.18.4.1" class="ltx_text" style="font-size:70%;">(0.35%)</span>
</td>
<td id="S5.T2.8.22.18.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.3 <span id="S5.T2.8.22.18.5.1" class="ltx_text" style="font-size:70%;">(1.13%)</span>
</td>
<td id="S5.T2.8.22.18.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.4 <span id="S5.T2.8.22.18.6.1" class="ltx_text" style="font-size:70%;">(1.24%)</span>
</td>
<td id="S5.T2.8.22.18.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">22.8 <span id="S5.T2.8.22.18.7.1" class="ltx_text" style="font-size:70%;">(1.35%)</span>
</td>
<td id="S5.T2.8.22.18.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.6 <span id="S5.T2.8.22.18.8.1" class="ltx_text" style="font-size:70%;">(0.33%)</span>
</td>
<td id="S5.T2.8.22.18.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.5 <span id="S5.T2.8.22.18.9.1" class="ltx_text" style="font-size:70%;">(1.21%)</span>
</td>
<td id="S5.T2.8.22.18.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.1</td>
</tr>
<tr id="S5.T2.8.23.19" class="ltx_tr">
<th id="S5.T2.8.23.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</th>
<td id="S5.T2.8.23.19.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.4 <span id="S5.T2.8.23.19.2.1" class="ltx_text" style="font-size:70%;">(1.09%)</span>
</td>
<td id="S5.T2.8.23.19.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.7 <span id="S5.T2.8.23.19.3.1" class="ltx_text" style="font-size:70%;">(1.21%)</span>
</td>
<td id="S5.T2.8.23.19.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.9 <span id="S5.T2.8.23.19.4.1" class="ltx_text" style="font-size:70%;">(1.98%)</span>
</td>
<td id="S5.T2.8.23.19.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.1 <span id="S5.T2.8.23.19.5.1" class="ltx_text" style="font-size:70%;">(1.97%)</span>
</td>
<td id="S5.T2.8.23.19.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.5 <span id="S5.T2.8.23.19.6.1" class="ltx_text" style="font-size:70%;">(1.43%)</span>
</td>
<td id="S5.T2.8.23.19.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">30.1 <span id="S5.T2.8.23.19.7.1" class="ltx_text" style="font-size:70%;">(1.32%)</span>
</td>
<td id="S5.T2.8.23.19.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.8 <span id="S5.T2.8.23.19.8.1" class="ltx_text" style="font-size:70%;">(1.41%)</span>
</td>
<td id="S5.T2.8.23.19.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.9 <span id="S5.T2.8.23.19.9.1" class="ltx_text" style="font-size:70%;">(1.06%)</span>
</td>
<td id="S5.T2.8.23.19.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.2</td>
</tr>
<tr id="S5.T2.8.24.20" class="ltx_tr">
<th id="S5.T2.8.24.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</th>
<td id="S5.T2.8.24.20.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.9 <span id="S5.T2.8.24.20.2.1" class="ltx_text" style="font-size:70%;">(0.63%)</span>
</td>
<td id="S5.T2.8.24.20.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.1 <span id="S5.T2.8.24.20.3.1" class="ltx_text" style="font-size:70%;">(0.78%)</span>
</td>
<td id="S5.T2.8.24.20.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.3 <span id="S5.T2.8.24.20.4.1" class="ltx_text" style="font-size:70%;">(0.91%)</span>
</td>
<td id="S5.T2.8.24.20.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.7 <span id="S5.T2.8.24.20.5.1" class="ltx_text" style="font-size:70%;">(0.84%)</span>
</td>
<td id="S5.T2.8.24.20.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.5 <span id="S5.T2.8.24.20.6.1" class="ltx_text" style="font-size:70%;">(1.31%)</span>
</td>
<td id="S5.T2.8.24.20.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">33.2 <span id="S5.T2.8.24.20.7.1" class="ltx_text" style="font-size:70%;">(1.69%)</span>
</td>
<td id="S5.T2.8.24.20.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.2 <span id="S5.T2.8.24.20.8.1" class="ltx_text" style="font-size:70%;">(0.81%)</span>
</td>
<td id="S5.T2.8.24.20.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.0 <span id="S5.T2.8.24.20.9.1" class="ltx_text" style="font-size:70%;">(0.97%)</span>
</td>
<td id="S5.T2.8.24.20.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.9</td>
</tr>
<tr id="S5.T2.8.25.21" class="ltx_tr">
<th id="S5.T2.8.25.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">DittoRS</th>
<td id="S5.T2.8.25.21.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.2 <span id="S5.T2.8.25.21.2.1" class="ltx_text" style="font-size:70%;">(0.79%)</span>
</td>
<td id="S5.T2.8.25.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.8 <span id="S5.T2.8.25.21.3.1" class="ltx_text" style="font-size:70%;">(0.86%)</span>
</td>
<td id="S5.T2.8.25.21.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.5 <span id="S5.T2.8.25.21.4.1" class="ltx_text" style="font-size:70%;">(0.55%)</span>
</td>
<td id="S5.T2.8.25.21.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.3 <span id="S5.T2.8.25.21.5.1" class="ltx_text" style="font-size:70%;">(1.13%)</span>
</td>
<td id="S5.T2.8.25.21.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.8 <span id="S5.T2.8.25.21.6.1" class="ltx_text" style="font-size:70%;">(0.55%)</span>
</td>
<td id="S5.T2.8.25.21.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">19.6 <span id="S5.T2.8.25.21.7.1" class="ltx_text" style="font-size:70%;">(1.26%)</span>
</td>
<td id="S5.T2.8.25.21.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.7 <span id="S5.T2.8.25.21.8.1" class="ltx_text" style="font-size:70%;">(0.67%)</span>
</td>
<td id="S5.T2.8.25.21.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.9 <span id="S5.T2.8.25.21.9.1" class="ltx_text" style="font-size:70%;">(0.71%)</span>
</td>
<td id="S5.T2.8.25.21.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">58.2</td>
</tr>
<tr id="S5.T2.8.26.22" class="ltx_tr">
<th id="S5.T2.8.26.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">ScaRS</th>
<td id="S5.T2.8.26.22.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.6 <span id="S5.T2.8.26.22.2.1" class="ltx_text" style="font-size:70%;">(1.03%)</span>
</td>
<td id="S5.T2.8.26.22.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.5 <span id="S5.T2.8.26.22.3.1" class="ltx_text" style="font-size:70%;">(1.11%)</span>
</td>
<td id="S5.T2.8.26.22.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.0 <span id="S5.T2.8.26.22.4.1" class="ltx_text" style="font-size:70%;">(1.48%)</span>
</td>
<td id="S5.T2.8.26.22.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.4 <span id="S5.T2.8.26.22.5.1" class="ltx_text" style="font-size:70%;">(1.85%)</span>
</td>
<td id="S5.T2.8.26.22.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.2 <span id="S5.T2.8.26.22.6.1" class="ltx_text" style="font-size:70%;">(2.11%)</span>
</td>
<td id="S5.T2.8.26.22.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">21.8 <span id="S5.T2.8.26.22.7.1" class="ltx_text" style="font-size:70%;">(0.83%)</span>
</td>
<td id="S5.T2.8.26.22.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.1 <span id="S5.T2.8.26.22.8.1" class="ltx_text" style="font-size:70%;">(1.00%)</span>
</td>
<td id="S5.T2.8.26.22.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.7 <span id="S5.T2.8.26.22.9.1" class="ltx_text" style="font-size:70%;">(0.88%)</span>
</td>
<td id="S5.T2.8.26.22.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.3</td>
</tr>
<tr id="S5.T2.8.27.23" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T2.8.27.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.1.1" class="ltx_text" style="background-color:#E6E6E6;">MAP (Ours)</span></th>
<td id="S5.T2.8.27.23.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.2.1" class="ltx_text" style="background-color:#E6E6E6;">92.1 <span id="S5.T2.8.27.23.2.1.1" class="ltx_text" style="font-size:70%;">(0.90%)</span></span></td>
<td id="S5.T2.8.27.23.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.3.1" class="ltx_text" style="background-color:#E6E6E6;">91.8 <span id="S5.T2.8.27.23.3.1.1" class="ltx_text" style="font-size:70%;">(1.18%)</span></span></td>
<td id="S5.T2.8.27.23.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.4.1" class="ltx_text" style="background-color:#E6E6E6;">76.9 <span id="S5.T2.8.27.23.4.1.1" class="ltx_text" style="font-size:70%;">(0.97%)</span></span></td>
<td id="S5.T2.8.27.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.5.1" class="ltx_text" style="background-color:#E6E6E6;">80.4 <span id="S5.T2.8.27.23.5.1.1" class="ltx_text" style="font-size:70%;">(0.93%)</span></span></td>
<td id="S5.T2.8.27.23.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.6.1" class="ltx_text" style="background-color:#E6E6E6;">52.2 <span id="S5.T2.8.27.23.6.1.1" class="ltx_text" style="font-size:70%;">(1.08%)</span></span></td>
<td id="S5.T2.8.27.23.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.7.1" class="ltx_text" style="background-color:#E6E6E6;">31.7 <span id="S5.T2.8.27.23.7.1.1" class="ltx_text" style="font-size:70%;">(1.00%)</span></span></td>
<td id="S5.T2.8.27.23.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.8.1" class="ltx_text" style="background-color:#E6E6E6;">84.7 <span id="S5.T2.8.27.23.8.1.1" class="ltx_text" style="font-size:70%;">(1.15%)</span></span></td>
<td id="S5.T2.8.27.23.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.9.1" class="ltx_text" style="background-color:#E6E6E6;">81.0 <span id="S5.T2.8.27.23.9.1.1" class="ltx_text" style="font-size:70%;">(0.64%)</span></span></td>
<td id="S5.T2.8.27.23.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.27.23.10.1" class="ltx_text" style="background-color:#E6E6E6;">73.9</span></td>
</tr>
<tr id="S5.T2.8.28.24" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T2.8.28.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.1.1" class="ltx_text" style="background-color:#E6E6E6;">ScaMAP (Ours)</span></th>
<td id="S5.T2.8.28.24.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.2.1" class="ltx_text" style="background-color:#E6E6E6;">90.5 <span id="S5.T2.8.28.24.2.1.1" class="ltx_text" style="font-size:70%;">(0.90%)</span></span></td>
<td id="S5.T2.8.28.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.3.1" class="ltx_text" style="background-color:#E6E6E6;">91.9 <span id="S5.T2.8.28.24.3.1.1" class="ltx_text" style="font-size:70%;">(0.75%)</span></span></td>
<td id="S5.T2.8.28.24.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.4.1" class="ltx_text" style="background-color:#E6E6E6;">81.7 <span id="S5.T2.8.28.24.4.1.1" class="ltx_text" style="font-size:70%;">(1.35%)</span></span></td>
<td id="S5.T2.8.28.24.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.5.1" class="ltx_text" style="background-color:#E6E6E6;">81.2 <span id="S5.T2.8.28.24.5.1.1" class="ltx_text" style="font-size:70%;">(1.48%)</span></span></td>
<td id="S5.T2.8.28.24.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.6.1" class="ltx_text" style="background-color:#E6E6E6;">53.3 <span id="S5.T2.8.28.24.6.1.1" class="ltx_text" style="font-size:70%;">(1.78%)</span></span></td>
<td id="S5.T2.8.28.24.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.7.1" class="ltx_text" style="background-color:#E6E6E6;">25.4 <span id="S5.T2.8.28.24.7.1.1" class="ltx_text" style="font-size:70%;">(1.45%)</span></span></td>
<td id="S5.T2.8.28.24.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.8.1" class="ltx_text" style="background-color:#E6E6E6;">82.5 <span id="S5.T2.8.28.24.8.1.1" class="ltx_text" style="font-size:70%;">(1.75%)</span></span></td>
<td id="S5.T2.8.28.24.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.9.1" class="ltx_text" style="background-color:#E6E6E6;">82.5 <span id="S5.T2.8.28.24.9.1.1" class="ltx_text" style="font-size:70%;">(0.25%)</span></span></td>
<td id="S5.T2.8.28.24.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T2.8.28.24.10.1" class="ltx_text" style="background-color:#E6E6E6;">73.6</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Compared Methods</h4>

<div id="S5.SS2.SSS2.p1" class="ltx_para">
<p id="S5.SS2.SSS2.p1.1" class="ltx_p">We compare MAP with popular FL algorithms as follows.
FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is the most standard FL algorithm.
FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, FedMMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> and FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> introduce various regularization techniques during local personalization procedures. We use the public code for FedDyn <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/alpemreacar/FedDyn</span></span></span></span>. Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> introduces control variates to correct the client-drift problems.
FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> uses a public data set for robust model fusion via ensemble distillation. We randomly sample 500 samples from the global test set as the public data set.
FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> and FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> takes better optimization strategies in FL.
FedAwS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> originally solves the extreme case where each client only observes one class. The spreadout term could be also applied to the considered FL scene in this paper.
MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite> takes advantage of the contrastive learning method at the model-level.
FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> and FLDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> utilize private-shared models for better personalization in FL.
pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> uses Moreau envelopes as clients’ regularized loss for personalization.
PerFedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> applies meta learning to FL for fast model adaptation. We use the public code for pFedMe and PerFedAvg <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/CharlieDinh/pFedMe</span></span></span></span>.
FedProto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> shares class prototypes instead of gradients for federated personalization.
Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite> is the variant of FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> for federated personalization.
FedROD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> combines class imbalanced loss and private-shared model for both aggregation and personalization. We use the linear version of FedROD and set the final classification layer as the G-Head and P-Head.
FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> is one of the precursors to MAP, which introduces “RS” for better model aggregation.
FedPHP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> is another precursor to MAP, which introduces “HPM” for better model personalization.</p>
</div>
<div id="S5.SS2.SSS2.p2" class="ltx_para">
<p id="S5.SS2.SSS2.p2.5" class="ltx_p">These methods almost cover all of the mainstream approaches that are designed to tackle Non-I.I.D. problems in FL. Our method aims to simultaneously achieve model aggregation and personalization goals in FL, and hence, we name our method MAP. The “RS” and “HPM” in MAP could also be combined with other FL algorithms. For example, we combine MAP with Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and obtain ScaMAP. We run each compared FL method 3 times on average with varied hyper-parameters, and the best performances are reported. The hyper-parameters of MAP include the <math id="S5.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS2.p2.1.m1.1a"><mi id="S5.SS2.SSS2.p2.1.m1.1.1" xref="S5.SS2.SSS2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p2.1.m1.1b"><ci id="S5.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p2.1.m1.1c">\alpha</annotation></semantics></math> in “RS” (Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), and <math id="S5.SS2.SSS2.p2.2.m2.2" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}},\lambda" display="inline"><semantics id="S5.SS2.SSS2.p2.2.m2.2a"><mrow id="S5.SS2.SSS2.p2.2.m2.2.2.1" xref="S5.SS2.SSS2.p2.2.m2.2.2.2.cmml"><msub id="S5.SS2.SSS2.p2.2.m2.2.2.1.1" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.2" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3a.cmml">kt</mtext></msub><mo id="S5.SS2.SSS2.p2.2.m2.2.2.1.2" xref="S5.SS2.SSS2.p2.2.m2.2.2.2.cmml">,</mo><mi id="S5.SS2.SSS2.p2.2.m2.1.1" xref="S5.SS2.SSS2.p2.2.m2.1.1.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p2.2.m2.2b"><list id="S5.SS2.SSS2.p2.2.m2.2.2.2.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1"><apply id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.2.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.2">ℒ</ci><ci id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3a.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3.cmml" xref="S5.SS2.SSS2.p2.2.m2.2.2.1.1.3">kt</mtext></ci></apply><ci id="S5.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S5.SS2.SSS2.p2.2.m2.1.1">𝜆</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p2.2.m2.2c">{\mathcal{L}}_{\text{kt}},\lambda</annotation></semantics></math> in “HPM” (Eq. <a href="#S4.E13" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>). We will study the hyper-parameters in the following experimental studies. The default setting is <math id="S5.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="S5.SS2.SSS2.p2.3.m3.1a"><mrow id="S5.SS2.SSS2.p2.3.m3.1.1" xref="S5.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.SSS2.p2.3.m3.1.1.2" xref="S5.SS2.SSS2.p2.3.m3.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS2.p2.3.m3.1.1.1" xref="S5.SS2.SSS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS2.p2.3.m3.1.1.3" xref="S5.SS2.SSS2.p2.3.m3.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p2.3.m3.1b"><apply id="S5.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S5.SS2.SSS2.p2.3.m3.1.1"><eq id="S5.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.SSS2.p2.3.m3.1.1.1"></eq><ci id="S5.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.SSS2.p2.3.m3.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.SSS2.p2.3.m3.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p2.3.m3.1c">\alpha=0.9</annotation></semantics></math>, <math id="S5.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}}={\mathcal{L}}_{\text{kd}}" display="inline"><semantics id="S5.SS2.SSS2.p2.4.m4.1a"><mrow id="S5.SS2.SSS2.p2.4.m4.1.1" xref="S5.SS2.SSS2.p2.4.m4.1.1.cmml"><msub id="S5.SS2.SSS2.p2.4.m4.1.1.2" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS2.p2.4.m4.1.1.2.2" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS2.p2.4.m4.1.1.2.3" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.3a.cmml">kt</mtext></msub><mo id="S5.SS2.SSS2.p2.4.m4.1.1.1" xref="S5.SS2.SSS2.p2.4.m4.1.1.1.cmml">=</mo><msub id="S5.SS2.SSS2.p2.4.m4.1.1.3" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS2.p2.4.m4.1.1.3.2" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS2.p2.4.m4.1.1.3.3" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.3a.cmml">kd</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p2.4.m4.1b"><apply id="S5.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1"><eq id="S5.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.1"></eq><apply id="S5.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.2">ℒ</ci><ci id="S5.SS2.SSS2.p2.4.m4.1.1.2.3a.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.3"><mtext mathsize="70%" id="S5.SS2.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.2.3">kt</mtext></ci></apply><apply id="S5.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.2">ℒ</ci><ci id="S5.SS2.SSS2.p2.4.m4.1.1.3.3a.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.3"><mtext mathsize="70%" id="S5.SS2.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S5.SS2.SSS2.p2.4.m4.1.1.3.3">kd</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p2.4.m4.1c">{\mathcal{L}}_{\text{kt}}={\mathcal{L}}_{\text{kd}}</annotation></semantics></math>, <math id="S5.SS2.SSS2.p2.5.m5.1" class="ltx_Math" alttext="\lambda=0.01" display="inline"><semantics id="S5.SS2.SSS2.p2.5.m5.1a"><mrow id="S5.SS2.SSS2.p2.5.m5.1.1" xref="S5.SS2.SSS2.p2.5.m5.1.1.cmml"><mi id="S5.SS2.SSS2.p2.5.m5.1.1.2" xref="S5.SS2.SSS2.p2.5.m5.1.1.2.cmml">λ</mi><mo id="S5.SS2.SSS2.p2.5.m5.1.1.1" xref="S5.SS2.SSS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS2.p2.5.m5.1.1.3" xref="S5.SS2.SSS2.p2.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p2.5.m5.1b"><apply id="S5.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S5.SS2.SSS2.p2.5.m5.1.1"><eq id="S5.SS2.SSS2.p2.5.m5.1.1.1.cmml" xref="S5.SS2.SSS2.p2.5.m5.1.1.1"></eq><ci id="S5.SS2.SSS2.p2.5.m5.1.1.2.cmml" xref="S5.SS2.SSS2.p2.5.m5.1.1.2">𝜆</ci><cn type="float" id="S5.SS2.SSS2.p2.5.m5.1.1.3.cmml" xref="S5.SS2.SSS2.p2.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p2.5.m5.1c">\lambda=0.01</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3 </span>Results and Analysis</h4>

<div id="S5.SS2.SSS3.p1" class="ltx_para">
<p id="S5.SS2.SSS3.p1.2" class="ltx_p">We show the aggregation and personalization performances in Tab. <a href="#S5.T1" title="TABLE I ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ 5.2.1 Experimental Settings ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, respectively. The last column shows the average of the previous eight columns. For aggregation performances, we record the test accuracy of the finally aggregated model on the global test set after <math id="S5.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="T=150" display="inline"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><mrow id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS3.p1.1.m1.1.1.2" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.cmml">T</mi><mo id="S5.SS2.SSS3.p1.1.m1.1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS3.p1.1.m1.1.1.3" xref="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><apply id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1"><eq id="S5.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">T=150</annotation></semantics></math> communication rounds. For personalization performances, we first calculate the test accuracy on the local test set after personalization for each participated client individually and then report their average accuracy. Notably, we use the personalized model instead of the newly-downloaded model to evaluate the local personalization performance, which is similar to the “Finetune” method in previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib80" title="" class="ltx_ref">80</a>]</cite>. Commonly, the local test accuracy could improve a lot after personalization, e.g., the demo shown in the last column of Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. That is, the personalization performances of compared algorithms are stronger baselines. The metrics are calculated based on Definition <a href="#Thmtheorem1" title="Definition 1 (Goal of Aggregation in FL). ‣ 3.3 Goals of Aggregation and Personalization ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Definition <a href="#Thmtheorem2" title="Definition 2 (Goal of Personalization in FL). ‣ 3.3 Goals of Aggregation and Personalization ‣ 3 Background and Issues to Solve ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, respectively, where we only report the results in the last communication round. We vary several groups of hyper-parameters for investigated FL algorithms and report the best performance among these settings. Additionally, the standard deviations under these hyper-parameter settings are also reported. To compare the FL algorithms more intuitively, the average results of the <math id="S5.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="4\times 2=8" display="inline"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><mrow id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml"><mrow id="S5.SS2.SSS3.p1.2.m2.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml"><mn id="S5.SS2.SSS3.p1.2.m2.1.1.2.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS3.p1.2.m2.1.1.2.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.1.cmml">×</mo><mn id="S5.SS2.SSS3.p1.2.m2.1.1.2.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.3.cmml">2</mn></mrow><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS3.p1.2.m2.1.1.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><apply id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1"><eq id="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1"></eq><apply id="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2"><times id="S5.SS2.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.1"></times><cn type="integer" id="S5.SS2.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.2">4</cn><cn type="integer" id="S5.SS2.SSS3.p1.2.m2.1.1.2.3.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">4\times 2=8</annotation></semantics></math> experimental groups (i.e., 4 benchmarks and 2 network architectures for each benchmark) are listed in the last column. Most FL algorithms perform well on FaMnist. CIFAR-100 is a harder benchmark that needs to identify 100 classes. Especially, utilizing VGG11 without batch normalization makes the scene harder. Because the clients only need to identify a partial set of classes, the personalization performances are commonly higher than the aggregation performances.</p>
</div>
<div id="S5.SS2.SSS3.p2" class="ltx_para">
<p id="S5.SS2.SSS3.p2.15" class="ltx_p">As shown in Tab. <a href="#S5.T1" title="TABLE I ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, the aggregation performance of FedAvg is about <math id="S5.SS2.SSS3.p2.1.m1.1" class="ltx_Math" alttext="64.0\%" display="inline"><semantics id="S5.SS2.SSS3.p2.1.m1.1a"><mrow id="S5.SS2.SSS3.p2.1.m1.1.1" xref="S5.SS2.SSS3.p2.1.m1.1.1.cmml"><mn id="S5.SS2.SSS3.p2.1.m1.1.1.2" xref="S5.SS2.SSS3.p2.1.m1.1.1.2.cmml">64.0</mn><mo id="S5.SS2.SSS3.p2.1.m1.1.1.1" xref="S5.SS2.SSS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.1.m1.1b"><apply id="S5.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.1.m1.1.1.1.cmml" xref="S5.SS2.SSS3.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.1.m1.1.1.2.cmml" xref="S5.SS2.SSS3.p2.1.m1.1.1.2">64.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.1.m1.1c">64.0\%</annotation></semantics></math> on average. Some advanced FL algorithms could indeed improve the aggregation performances, e.g., FedProx obtains <math id="S5.SS2.SSS3.p2.2.m2.1" class="ltx_Math" alttext="65.3\%" display="inline"><semantics id="S5.SS2.SSS3.p2.2.m2.1a"><mrow id="S5.SS2.SSS3.p2.2.m2.1.1" xref="S5.SS2.SSS3.p2.2.m2.1.1.cmml"><mn id="S5.SS2.SSS3.p2.2.m2.1.1.2" xref="S5.SS2.SSS3.p2.2.m2.1.1.2.cmml">65.3</mn><mo id="S5.SS2.SSS3.p2.2.m2.1.1.1" xref="S5.SS2.SSS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.2.m2.1b"><apply id="S5.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p2.2.m2.1.1.2">65.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.2.m2.1c">65.3\%</annotation></semantics></math>, MOON obtains <math id="S5.SS2.SSS3.p2.3.m3.1" class="ltx_Math" alttext="65.1\%" display="inline"><semantics id="S5.SS2.SSS3.p2.3.m3.1a"><mrow id="S5.SS2.SSS3.p2.3.m3.1.1" xref="S5.SS2.SSS3.p2.3.m3.1.1.cmml"><mn id="S5.SS2.SSS3.p2.3.m3.1.1.2" xref="S5.SS2.SSS3.p2.3.m3.1.1.2.cmml">65.1</mn><mo id="S5.SS2.SSS3.p2.3.m3.1.1.1" xref="S5.SS2.SSS3.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.3.m3.1b"><apply id="S5.SS2.SSS3.p2.3.m3.1.1.cmml" xref="S5.SS2.SSS3.p2.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.3.m3.1.1.1.cmml" xref="S5.SS2.SSS3.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.3.m3.1.1.2.cmml" xref="S5.SS2.SSS3.p2.3.m3.1.1.2">65.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.3.m3.1c">65.1\%</annotation></semantics></math>. Among compared FL algorithms, Scaffold and FedRS obtain the best aggregation result, i.e., <math id="S5.SS2.SSS3.p2.4.m4.1" class="ltx_Math" alttext="66.6\%" display="inline"><semantics id="S5.SS2.SSS3.p2.4.m4.1a"><mrow id="S5.SS2.SSS3.p2.4.m4.1.1" xref="S5.SS2.SSS3.p2.4.m4.1.1.cmml"><mn id="S5.SS2.SSS3.p2.4.m4.1.1.2" xref="S5.SS2.SSS3.p2.4.m4.1.1.2.cmml">66.6</mn><mo id="S5.SS2.SSS3.p2.4.m4.1.1.1" xref="S5.SS2.SSS3.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.4.m4.1b"><apply id="S5.SS2.SSS3.p2.4.m4.1.1.cmml" xref="S5.SS2.SSS3.p2.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.4.m4.1.1.1.cmml" xref="S5.SS2.SSS3.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.4.m4.1.1.2.cmml" xref="S5.SS2.SSS3.p2.4.m4.1.1.2">66.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.4.m4.1c">66.6\%</annotation></semantics></math>. FedRep and FedProto are only designed for personalization and do not keep a complete aggregated model on the server, and we set their aggregation performance as <math id="S5.SS2.SSS3.p2.5.m5.1" class="ltx_Math" alttext="0.0\%" display="inline"><semantics id="S5.SS2.SSS3.p2.5.m5.1a"><mrow id="S5.SS2.SSS3.p2.5.m5.1.1" xref="S5.SS2.SSS3.p2.5.m5.1.1.cmml"><mn id="S5.SS2.SSS3.p2.5.m5.1.1.2" xref="S5.SS2.SSS3.p2.5.m5.1.1.2.cmml">0.0</mn><mo id="S5.SS2.SSS3.p2.5.m5.1.1.1" xref="S5.SS2.SSS3.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.5.m5.1b"><apply id="S5.SS2.SSS3.p2.5.m5.1.1.cmml" xref="S5.SS2.SSS3.p2.5.m5.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.5.m5.1.1.1.cmml" xref="S5.SS2.SSS3.p2.5.m5.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.5.m5.1.1.2.cmml" xref="S5.SS2.SSS3.p2.5.m5.1.1.2">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.5.m5.1c">0.0\%</annotation></semantics></math>. Our proposed MAP and ScaMAP could surpass FedRS and Scaffold slightly, which obtain <math id="S5.SS2.SSS3.p2.6.m6.1" class="ltx_Math" alttext="66.8\%" display="inline"><semantics id="S5.SS2.SSS3.p2.6.m6.1a"><mrow id="S5.SS2.SSS3.p2.6.m6.1.1" xref="S5.SS2.SSS3.p2.6.m6.1.1.cmml"><mn id="S5.SS2.SSS3.p2.6.m6.1.1.2" xref="S5.SS2.SSS3.p2.6.m6.1.1.2.cmml">66.8</mn><mo id="S5.SS2.SSS3.p2.6.m6.1.1.1" xref="S5.SS2.SSS3.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.6.m6.1b"><apply id="S5.SS2.SSS3.p2.6.m6.1.1.cmml" xref="S5.SS2.SSS3.p2.6.m6.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.6.m6.1.1.1.cmml" xref="S5.SS2.SSS3.p2.6.m6.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.6.m6.1.1.2.cmml" xref="S5.SS2.SSS3.p2.6.m6.1.1.2">66.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.6.m6.1c">66.8\%</annotation></semantics></math> and <math id="S5.SS2.SSS3.p2.7.m7.1" class="ltx_Math" alttext="66.9\%" display="inline"><semantics id="S5.SS2.SSS3.p2.7.m7.1a"><mrow id="S5.SS2.SSS3.p2.7.m7.1.1" xref="S5.SS2.SSS3.p2.7.m7.1.1.cmml"><mn id="S5.SS2.SSS3.p2.7.m7.1.1.2" xref="S5.SS2.SSS3.p2.7.m7.1.1.2.cmml">66.9</mn><mo id="S5.SS2.SSS3.p2.7.m7.1.1.1" xref="S5.SS2.SSS3.p2.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.7.m7.1b"><apply id="S5.SS2.SSS3.p2.7.m7.1.1.cmml" xref="S5.SS2.SSS3.p2.7.m7.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.7.m7.1.1.1.cmml" xref="S5.SS2.SSS3.p2.7.m7.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.7.m7.1.1.2.cmml" xref="S5.SS2.SSS3.p2.7.m7.1.1.2">66.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.7.m7.1c">66.9\%</annotation></semantics></math>, respectively. Tab. <a href="#S5.T2" title="TABLE II ‣ 5.2.1 Experimental Settings ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> shows the personalization performances. FedAvg achieves a personalization performance of <math id="S5.SS2.SSS3.p2.8.m8.1" class="ltx_Math" alttext="71.3\%" display="inline"><semantics id="S5.SS2.SSS3.p2.8.m8.1a"><mrow id="S5.SS2.SSS3.p2.8.m8.1.1" xref="S5.SS2.SSS3.p2.8.m8.1.1.cmml"><mn id="S5.SS2.SSS3.p2.8.m8.1.1.2" xref="S5.SS2.SSS3.p2.8.m8.1.1.2.cmml">71.3</mn><mo id="S5.SS2.SSS3.p2.8.m8.1.1.1" xref="S5.SS2.SSS3.p2.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.8.m8.1b"><apply id="S5.SS2.SSS3.p2.8.m8.1.1.cmml" xref="S5.SS2.SSS3.p2.8.m8.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.8.m8.1.1.1.cmml" xref="S5.SS2.SSS3.p2.8.m8.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.8.m8.1.1.2.cmml" xref="S5.SS2.SSS3.p2.8.m8.1.1.2">71.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.8.m8.1c">71.3\%</annotation></semantics></math> on average. First, the algorithms that are customized for aggregation may perform worse, e.g., Scaffold only obtains <math id="S5.SS2.SSS3.p2.9.m9.1" class="ltx_Math" alttext="70.4\%" display="inline"><semantics id="S5.SS2.SSS3.p2.9.m9.1a"><mrow id="S5.SS2.SSS3.p2.9.m9.1.1" xref="S5.SS2.SSS3.p2.9.m9.1.1.cmml"><mn id="S5.SS2.SSS3.p2.9.m9.1.1.2" xref="S5.SS2.SSS3.p2.9.m9.1.1.2.cmml">70.4</mn><mo id="S5.SS2.SSS3.p2.9.m9.1.1.1" xref="S5.SS2.SSS3.p2.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.9.m9.1b"><apply id="S5.SS2.SSS3.p2.9.m9.1.1.cmml" xref="S5.SS2.SSS3.p2.9.m9.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.9.m9.1.1.1.cmml" xref="S5.SS2.SSS3.p2.9.m9.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.9.m9.1.1.2.cmml" xref="S5.SS2.SSS3.p2.9.m9.1.1.2">70.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.9.m9.1c">70.4\%</annotation></semantics></math>. One exception is FedRS, which obtains <math id="S5.SS2.SSS3.p2.10.m10.1" class="ltx_Math" alttext="72.2\%" display="inline"><semantics id="S5.SS2.SSS3.p2.10.m10.1a"><mrow id="S5.SS2.SSS3.p2.10.m10.1.1" xref="S5.SS2.SSS3.p2.10.m10.1.1.cmml"><mn id="S5.SS2.SSS3.p2.10.m10.1.1.2" xref="S5.SS2.SSS3.p2.10.m10.1.1.2.cmml">72.2</mn><mo id="S5.SS2.SSS3.p2.10.m10.1.1.1" xref="S5.SS2.SSS3.p2.10.m10.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.10.m10.1b"><apply id="S5.SS2.SSS3.p2.10.m10.1.1.cmml" xref="S5.SS2.SSS3.p2.10.m10.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.10.m10.1.1.1.cmml" xref="S5.SS2.SSS3.p2.10.m10.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.10.m10.1.1.2.cmml" xref="S5.SS2.SSS3.p2.10.m10.1.1.2">72.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.10.m10.1c">72.2\%</annotation></semantics></math> on average. Some FL personalization methods could perform much worse than FedAvg, e.g., pFedMe obtains <math id="S5.SS2.SSS3.p2.11.m11.1" class="ltx_Math" alttext="65.3\%" display="inline"><semantics id="S5.SS2.SSS3.p2.11.m11.1a"><mrow id="S5.SS2.SSS3.p2.11.m11.1.1" xref="S5.SS2.SSS3.p2.11.m11.1.1.cmml"><mn id="S5.SS2.SSS3.p2.11.m11.1.1.2" xref="S5.SS2.SSS3.p2.11.m11.1.1.2.cmml">65.3</mn><mo id="S5.SS2.SSS3.p2.11.m11.1.1.1" xref="S5.SS2.SSS3.p2.11.m11.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.11.m11.1b"><apply id="S5.SS2.SSS3.p2.11.m11.1.1.cmml" xref="S5.SS2.SSS3.p2.11.m11.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.11.m11.1.1.1.cmml" xref="S5.SS2.SSS3.p2.11.m11.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.11.m11.1.1.2.cmml" xref="S5.SS2.SSS3.p2.11.m11.1.1.2">65.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.11.m11.1c">65.3\%</annotation></semantics></math> and PerFedAvg obtains <math id="S5.SS2.SSS3.p2.12.m12.1" class="ltx_Math" alttext="67.7\%" display="inline"><semantics id="S5.SS2.SSS3.p2.12.m12.1a"><mrow id="S5.SS2.SSS3.p2.12.m12.1.1" xref="S5.SS2.SSS3.p2.12.m12.1.1.cmml"><mn id="S5.SS2.SSS3.p2.12.m12.1.1.2" xref="S5.SS2.SSS3.p2.12.m12.1.1.2.cmml">67.7</mn><mo id="S5.SS2.SSS3.p2.12.m12.1.1.1" xref="S5.SS2.SSS3.p2.12.m12.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.12.m12.1b"><apply id="S5.SS2.SSS3.p2.12.m12.1.1.cmml" xref="S5.SS2.SSS3.p2.12.m12.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.12.m12.1.1.1.cmml" xref="S5.SS2.SSS3.p2.12.m12.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.12.m12.1.1.2.cmml" xref="S5.SS2.SSS3.p2.12.m12.1.1.2">67.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.12.m12.1c">67.7\%</annotation></semantics></math>. The reasons are that these algorithms may have more than three hyper-parameters to tune. Under the consideration of limited computation resources and fair comparison, we only vary several groups of hyper-parameters. If we enlarge the search space of their hyper-parameters, these FL personalization algorithms may show better performances. Among of the compared methods, FedPHP achieves the best personalization result, i.e., <math id="S5.SS2.SSS3.p2.13.m13.1" class="ltx_Math" alttext="73.9\%" display="inline"><semantics id="S5.SS2.SSS3.p2.13.m13.1a"><mrow id="S5.SS2.SSS3.p2.13.m13.1.1" xref="S5.SS2.SSS3.p2.13.m13.1.1.cmml"><mn id="S5.SS2.SSS3.p2.13.m13.1.1.2" xref="S5.SS2.SSS3.p2.13.m13.1.1.2.cmml">73.9</mn><mo id="S5.SS2.SSS3.p2.13.m13.1.1.1" xref="S5.SS2.SSS3.p2.13.m13.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.13.m13.1b"><apply id="S5.SS2.SSS3.p2.13.m13.1.1.cmml" xref="S5.SS2.SSS3.p2.13.m13.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.13.m13.1.1.1.cmml" xref="S5.SS2.SSS3.p2.13.m13.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.13.m13.1.1.2.cmml" xref="S5.SS2.SSS3.p2.13.m13.1.1.2">73.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.13.m13.1c">73.9\%</annotation></semantics></math>. Our proposed MAP and ScaMAP could also obtain comparable results, i.e., <math id="S5.SS2.SSS3.p2.14.m14.1" class="ltx_Math" alttext="73.9\%" display="inline"><semantics id="S5.SS2.SSS3.p2.14.m14.1a"><mrow id="S5.SS2.SSS3.p2.14.m14.1.1" xref="S5.SS2.SSS3.p2.14.m14.1.1.cmml"><mn id="S5.SS2.SSS3.p2.14.m14.1.1.2" xref="S5.SS2.SSS3.p2.14.m14.1.1.2.cmml">73.9</mn><mo id="S5.SS2.SSS3.p2.14.m14.1.1.1" xref="S5.SS2.SSS3.p2.14.m14.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.14.m14.1b"><apply id="S5.SS2.SSS3.p2.14.m14.1.1.cmml" xref="S5.SS2.SSS3.p2.14.m14.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.14.m14.1.1.1.cmml" xref="S5.SS2.SSS3.p2.14.m14.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.14.m14.1.1.2.cmml" xref="S5.SS2.SSS3.p2.14.m14.1.1.2">73.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.14.m14.1c">73.9\%</annotation></semantics></math> and <math id="S5.SS2.SSS3.p2.15.m15.1" class="ltx_Math" alttext="73.6\%" display="inline"><semantics id="S5.SS2.SSS3.p2.15.m15.1a"><mrow id="S5.SS2.SSS3.p2.15.m15.1.1" xref="S5.SS2.SSS3.p2.15.m15.1.1.cmml"><mn id="S5.SS2.SSS3.p2.15.m15.1.1.2" xref="S5.SS2.SSS3.p2.15.m15.1.1.2.cmml">73.6</mn><mo id="S5.SS2.SSS3.p2.15.m15.1.1.1" xref="S5.SS2.SSS3.p2.15.m15.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p2.15.m15.1b"><apply id="S5.SS2.SSS3.p2.15.m15.1.1.cmml" xref="S5.SS2.SSS3.p2.15.m15.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p2.15.m15.1.1.1.cmml" xref="S5.SS2.SSS3.p2.15.m15.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p2.15.m15.1.1.2.cmml" xref="S5.SS2.SSS3.p2.15.m15.1.1.2">73.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p2.15.m15.1c">73.6\%</annotation></semantics></math>, respectively.</p>
</div>
<figure id="S5.F9" class="ltx_figure"><img src="/html/2404.09232/assets/x9.png" id="S5.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span id="S5.F9.2.1" class="ltx_text" style="font-size:90%;">The joint look of aggregation and personalization results.</span></figcaption>
</figure>
<div id="S5.SS2.SSS3.p3" class="ltx_para">
<p id="S5.SS2.SSS3.p3.4" class="ltx_p">For fair comparison under incomplete classes, we also apply the proposed “RS” to Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite> and Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, which are denoted as DittoRS and ScaRS, respectively. From Tab. <a href="#S5.T1" title="TABLE I ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ 5.2.1 Experimental Settings ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, DittoRS could improve the aggregation and personalization performances of Ditto, i.e., <math id="S5.SS2.SSS3.p3.1.m1.1" class="ltx_Math" alttext="64.7\%" display="inline"><semantics id="S5.SS2.SSS3.p3.1.m1.1a"><mrow id="S5.SS2.SSS3.p3.1.m1.1.1" xref="S5.SS2.SSS3.p3.1.m1.1.1.cmml"><mn id="S5.SS2.SSS3.p3.1.m1.1.1.2" xref="S5.SS2.SSS3.p3.1.m1.1.1.2.cmml">64.7</mn><mo id="S5.SS2.SSS3.p3.1.m1.1.1.1" xref="S5.SS2.SSS3.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p3.1.m1.1b"><apply id="S5.SS2.SSS3.p3.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p3.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p3.1.m1.1.1.1.cmml" xref="S5.SS2.SSS3.p3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p3.1.m1.1.1.2.cmml" xref="S5.SS2.SSS3.p3.1.m1.1.1.2">64.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p3.1.m1.1c">64.7\%</annotation></semantics></math> to <math id="S5.SS2.SSS3.p3.2.m2.1" class="ltx_Math" alttext="65.6\%" display="inline"><semantics id="S5.SS2.SSS3.p3.2.m2.1a"><mrow id="S5.SS2.SSS3.p3.2.m2.1.1" xref="S5.SS2.SSS3.p3.2.m2.1.1.cmml"><mn id="S5.SS2.SSS3.p3.2.m2.1.1.2" xref="S5.SS2.SSS3.p3.2.m2.1.1.2.cmml">65.6</mn><mo id="S5.SS2.SSS3.p3.2.m2.1.1.1" xref="S5.SS2.SSS3.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p3.2.m2.1b"><apply id="S5.SS2.SSS3.p3.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p3.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p3.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p3.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p3.2.m2.1.1.2">65.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p3.2.m2.1c">65.6\%</annotation></semantics></math>, and <math id="S5.SS2.SSS3.p3.3.m3.1" class="ltx_Math" alttext="57.1\%" display="inline"><semantics id="S5.SS2.SSS3.p3.3.m3.1a"><mrow id="S5.SS2.SSS3.p3.3.m3.1.1" xref="S5.SS2.SSS3.p3.3.m3.1.1.cmml"><mn id="S5.SS2.SSS3.p3.3.m3.1.1.2" xref="S5.SS2.SSS3.p3.3.m3.1.1.2.cmml">57.1</mn><mo id="S5.SS2.SSS3.p3.3.m3.1.1.1" xref="S5.SS2.SSS3.p3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p3.3.m3.1b"><apply id="S5.SS2.SSS3.p3.3.m3.1.1.cmml" xref="S5.SS2.SSS3.p3.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p3.3.m3.1.1.1.cmml" xref="S5.SS2.SSS3.p3.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p3.3.m3.1.1.2.cmml" xref="S5.SS2.SSS3.p3.3.m3.1.1.2">57.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p3.3.m3.1c">57.1\%</annotation></semantics></math> to <math id="S5.SS2.SSS3.p3.4.m4.1" class="ltx_Math" alttext="58.2\%" display="inline"><semantics id="S5.SS2.SSS3.p3.4.m4.1a"><mrow id="S5.SS2.SSS3.p3.4.m4.1.1" xref="S5.SS2.SSS3.p3.4.m4.1.1.cmml"><mn id="S5.SS2.SSS3.p3.4.m4.1.1.2" xref="S5.SS2.SSS3.p3.4.m4.1.1.2.cmml">58.2</mn><mo id="S5.SS2.SSS3.p3.4.m4.1.1.1" xref="S5.SS2.SSS3.p3.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p3.4.m4.1b"><apply id="S5.SS2.SSS3.p3.4.m4.1.1.cmml" xref="S5.SS2.SSS3.p3.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.SSS3.p3.4.m4.1.1.1.cmml" xref="S5.SS2.SSS3.p3.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS3.p3.4.m4.1.1.2.cmml" xref="S5.SS2.SSS3.p3.4.m4.1.1.2">58.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p3.4.m4.1c">58.2\%</annotation></semantics></math>, respectively. This implies the effectiveness of the proposed “RS”. However, the personalization accuracy is still weaker than FedPHP and MAP. Scaffold could already obtain good aggregation performances and ScaRS does not improve its aggregation ability. Compared with ScaRS, ScaMAP additionally utilizes the proposed “HPM” for personalization. Hence, the personalization accuracy of ScaMAP is significantly higher than Scaffold and ScaRS, which verifies the effectiveness of the proposed “HPM”.</p>
</div>
<div id="S5.SS2.SSS3.p4" class="ltx_para">
<p id="S5.SS2.SSS3.p4.1" class="ltx_p">Considering the aggregation performance, the proposed MAP and ScaMAP only show slightly better results than Scaffold and FedRS. Considering the personalization performance, the proposed MAP and ScaMAP achieve comparable results as the FedPHP. It seems that our proposed methods do not show obvious advantages. We then combine the aggregation and personalization accuracies of each FL algorithm (i.e., the last columns of Tab. <a href="#S5.T1" title="TABLE I ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ 5.2.1 Experimental Settings ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>), and the scatter plot is shown in Fig. <a href="#S5.F9" title="Figure 9 ‣ 5.2.3 Results and Analysis ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. Obviously, the FL algorithms in the upper right could simultaneously obtain better aggregation and personalization results. Although Scaffold and FedRS basically stay on the rightmost of the figure, they are not very near the top edge (i.e., a lower personalization performance). Similarly, although FedPHP basically stays on the topmost of the figure, it is not very near the right edge (i.e., a lower aggregation performance). Our methods could also perform better than the recently proposed FedROD which considers both aggregation and personalization in FL. From the above analysis, we conclude that MAP and ScaMAP could simultaneously obtain better aggregation and personalization accuracies, which is the core superiority towards other FL algorithms.</p>
</div>
<figure id="S5.F10" class="ltx_figure"><img src="" id="S5.F10.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="S5.F10.2.1" class="ltx_text" style="font-size:90%;">The personalization accuracy change of MAP compared with FedAvg.</span></figcaption>
</figure>
<figure id="S5.F11" class="ltx_figure"><img src="/html/2404.09232/assets/x11.png" id="S5.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="110" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span id="S5.F11.2.1" class="ltx_text" style="font-size:90%;">The hyper-parameter studies of our proposed methods.</span></figcaption>
</figure>
<figure id="S5.F12" class="ltx_figure"><img src="/html/2404.09232/assets/x12.png" id="S5.F12.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="121" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span id="S5.F12.2.1" class="ltx_text" style="font-size:90%;">Comparisons of convergence curves on FEMNIST.</span></figcaption>
</figure>
</section>
<section id="S5.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.4 </span>Personalization Fairness Comparisons</h4>

<div id="S5.SS2.SSS4.p1" class="ltx_para">
<p id="S5.SS2.SSS4.p1.1" class="ltx_p">Although using the average accuracy to measure personalization performance is common, the fairness among clients is also significant. Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.2.3 Results and Analysis ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> shows the change in client personalization accuracy from FedAvg to MAP, where the histogram of 100 clients is calculated and the number of clients is displayed on the bars. Clearly, most of the clients could obtain improvement from MAP, e.g., only 16 clients meet performance degradation on FaMnist. How to further ensure that these clients can also obtain performance improvement is future research work.</p>
</div>
</section>
<section id="S5.SS2.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.5 </span>Hyper-Parameter Studies</h4>

<div id="S5.SS2.SSS5.p1" class="ltx_para">
<p id="S5.SS2.SSS5.p1.7" class="ltx_p">We then study the hyper-parameters of MAP, i.e., the <math id="S5.SS2.SSS5.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS5.p1.1.m1.1a"><mi id="S5.SS2.SSS5.p1.1.m1.1.1" xref="S5.SS2.SSS5.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.1.m1.1b"><ci id="S5.SS2.SSS5.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS5.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.1.m1.1c">\alpha</annotation></semantics></math> in “RS” (Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), and <math id="S5.SS2.SSS5.p1.2.m2.2" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}},\lambda" display="inline"><semantics id="S5.SS2.SSS5.p1.2.m2.2a"><mrow id="S5.SS2.SSS5.p1.2.m2.2.2.1" xref="S5.SS2.SSS5.p1.2.m2.2.2.2.cmml"><msub id="S5.SS2.SSS5.p1.2.m2.2.2.1.1" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.2" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3a.cmml">kt</mtext></msub><mo id="S5.SS2.SSS5.p1.2.m2.2.2.1.2" xref="S5.SS2.SSS5.p1.2.m2.2.2.2.cmml">,</mo><mi id="S5.SS2.SSS5.p1.2.m2.1.1" xref="S5.SS2.SSS5.p1.2.m2.1.1.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.2.m2.2b"><list id="S5.SS2.SSS5.p1.2.m2.2.2.2.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1"><apply id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.1.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.2.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3.cmml" xref="S5.SS2.SSS5.p1.2.m2.2.2.1.1.3">kt</mtext></ci></apply><ci id="S5.SS2.SSS5.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS5.p1.2.m2.1.1">𝜆</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.2.m2.2c">{\mathcal{L}}_{\text{kt}},\lambda</annotation></semantics></math> in “HPM” (Eq. <a href="#S4.E13" title="In 4.2.2 Inherited Private Model ‣ 4.2 Inherited Private Model for Model Personalization ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>). Specifically, we vary the hyper-parameters of MAP and record the performances like the Tab. <a href="#S5.T1" title="TABLE I ‣ 5.1.2 Performance Degradation on Incomplete Classes ‣ 5.1 Observations ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ 5.2.1 Experimental Settings ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. We do not record the results on CINIC-10 because running ResNet on it costs too much. That is, we only record the performances of <math id="S5.SS2.SSS5.p1.3.m3.1" class="ltx_Math" alttext="3\times 2=6" display="inline"><semantics id="S5.SS2.SSS5.p1.3.m3.1a"><mrow id="S5.SS2.SSS5.p1.3.m3.1.1" xref="S5.SS2.SSS5.p1.3.m3.1.1.cmml"><mrow id="S5.SS2.SSS5.p1.3.m3.1.1.2" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.cmml"><mn id="S5.SS2.SSS5.p1.3.m3.1.1.2.2" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS5.p1.3.m3.1.1.2.1" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.1.cmml">×</mo><mn id="S5.SS2.SSS5.p1.3.m3.1.1.2.3" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.3.cmml">2</mn></mrow><mo id="S5.SS2.SSS5.p1.3.m3.1.1.1" xref="S5.SS2.SSS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS5.p1.3.m3.1.1.3" xref="S5.SS2.SSS5.p1.3.m3.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.3.m3.1b"><apply id="S5.SS2.SSS5.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1"><eq id="S5.SS2.SSS5.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.1"></eq><apply id="S5.SS2.SSS5.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.2"><times id="S5.SS2.SSS5.p1.3.m3.1.1.2.1.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.1"></times><cn type="integer" id="S5.SS2.SSS5.p1.3.m3.1.1.2.2.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.2">3</cn><cn type="integer" id="S5.SS2.SSS5.p1.3.m3.1.1.2.3.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS2.SSS5.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS5.p1.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.3.m3.1c">3\times 2=6</annotation></semantics></math> experimental groups (i.e., 3 benchmarks and 2 network architectures for each benchmark) and plot the scatter of the average results. The space of hyper-parameter is <math id="S5.SS2.SSS5.p1.4.m4.5" class="ltx_Math" alttext="\alpha\in\{0.1,0.25,0.5,0.75,0.9\}" display="inline"><semantics id="S5.SS2.SSS5.p1.4.m4.5a"><mrow id="S5.SS2.SSS5.p1.4.m4.5.6" xref="S5.SS2.SSS5.p1.4.m4.5.6.cmml"><mi id="S5.SS2.SSS5.p1.4.m4.5.6.2" xref="S5.SS2.SSS5.p1.4.m4.5.6.2.cmml">α</mi><mo id="S5.SS2.SSS5.p1.4.m4.5.6.1" xref="S5.SS2.SSS5.p1.4.m4.5.6.1.cmml">∈</mo><mrow id="S5.SS2.SSS5.p1.4.m4.5.6.3.2" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.1" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">{</mo><mn id="S5.SS2.SSS5.p1.4.m4.1.1" xref="S5.SS2.SSS5.p1.4.m4.1.1.cmml">0.1</mn><mo id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.2" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS5.p1.4.m4.2.2" xref="S5.SS2.SSS5.p1.4.m4.2.2.cmml">0.25</mn><mo id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.3" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS5.p1.4.m4.3.3" xref="S5.SS2.SSS5.p1.4.m4.3.3.cmml">0.5</mn><mo id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.4" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS5.p1.4.m4.4.4" xref="S5.SS2.SSS5.p1.4.m4.4.4.cmml">0.75</mn><mo id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.5" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS5.p1.4.m4.5.5" xref="S5.SS2.SSS5.p1.4.m4.5.5.cmml">0.9</mn><mo stretchy="false" id="S5.SS2.SSS5.p1.4.m4.5.6.3.2.6" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.4.m4.5b"><apply id="S5.SS2.SSS5.p1.4.m4.5.6.cmml" xref="S5.SS2.SSS5.p1.4.m4.5.6"><in id="S5.SS2.SSS5.p1.4.m4.5.6.1.cmml" xref="S5.SS2.SSS5.p1.4.m4.5.6.1"></in><ci id="S5.SS2.SSS5.p1.4.m4.5.6.2.cmml" xref="S5.SS2.SSS5.p1.4.m4.5.6.2">𝛼</ci><set id="S5.SS2.SSS5.p1.4.m4.5.6.3.1.cmml" xref="S5.SS2.SSS5.p1.4.m4.5.6.3.2"><cn type="float" id="S5.SS2.SSS5.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS5.p1.4.m4.1.1">0.1</cn><cn type="float" id="S5.SS2.SSS5.p1.4.m4.2.2.cmml" xref="S5.SS2.SSS5.p1.4.m4.2.2">0.25</cn><cn type="float" id="S5.SS2.SSS5.p1.4.m4.3.3.cmml" xref="S5.SS2.SSS5.p1.4.m4.3.3">0.5</cn><cn type="float" id="S5.SS2.SSS5.p1.4.m4.4.4.cmml" xref="S5.SS2.SSS5.p1.4.m4.4.4">0.75</cn><cn type="float" id="S5.SS2.SSS5.p1.4.m4.5.5.cmml" xref="S5.SS2.SSS5.p1.4.m4.5.5">0.9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.4.m4.5c">\alpha\in\{0.1,0.25,0.5,0.75,0.9\}</annotation></semantics></math>, and <math id="S5.SS2.SSS5.p1.5.m5.10" class="ltx_Math" alttext="({\mathcal{L}}_{\text{kt}},\lambda)\in\{({\mathcal{L}}_{\text{kd}},0.01),({\mathcal{L}}_{\text{kd}},0.1),({\mathcal{L}}_{\text{mmd}},0.01),({\mathcal{L}}_{\text{mmd}},0.1)\}" display="inline"><semantics id="S5.SS2.SSS5.p1.5.m5.10a"><mrow id="S5.SS2.SSS5.p1.5.m5.10.10" xref="S5.SS2.SSS5.p1.5.m5.10.10.cmml"><mrow id="S5.SS2.SSS5.p1.5.m5.6.6.1.1" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.2.cmml">(</mo><msub id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3a.cmml">kt</mtext></msub><mo id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.2.cmml">,</mo><mi id="S5.SS2.SSS5.p1.5.m5.1.1" xref="S5.SS2.SSS5.p1.5.m5.1.1.cmml">λ</mi><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.4" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.2.cmml">)</mo></mrow><mo id="S5.SS2.SSS5.p1.5.m5.10.10.6" xref="S5.SS2.SSS5.p1.5.m5.10.10.6.cmml">∈</mo><mrow id="S5.SS2.SSS5.p1.5.m5.10.10.5.4" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.5" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml">{</mo><mrow id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.2.cmml">(</mo><msub id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3a.cmml">kd</mtext></msub><mo id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.2.cmml">,</mo><mn id="S5.SS2.SSS5.p1.5.m5.2.2" xref="S5.SS2.SSS5.p1.5.m5.2.2.cmml">0.01</mn><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.4" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.2.cmml">)</mo></mrow><mo id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.6" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml">,</mo><mrow id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.2.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.2" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.2.cmml">(</mo><msub id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3a.cmml">kd</mtext></msub><mo id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.3" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.2.cmml">,</mo><mn id="S5.SS2.SSS5.p1.5.m5.3.3" xref="S5.SS2.SSS5.p1.5.m5.3.3.cmml">0.1</mn><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.4" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.2.cmml">)</mo></mrow><mo id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.7" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml">,</mo><mrow id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.2.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.2" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.2.cmml">(</mo><msub id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3a.cmml">mmd</mtext></msub><mo id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.3" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.2.cmml">,</mo><mn id="S5.SS2.SSS5.p1.5.m5.4.4" xref="S5.SS2.SSS5.p1.5.m5.4.4.cmml">0.01</mn><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.4" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.2.cmml">)</mo></mrow><mo id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.8" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml">,</mo><mrow id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.2.cmml"><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.2" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.2.cmml">(</mo><msub id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.2" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3a.cmml">mmd</mtext></msub><mo id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.3" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.2.cmml">,</mo><mn id="S5.SS2.SSS5.p1.5.m5.5.5" xref="S5.SS2.SSS5.p1.5.m5.5.5.cmml">0.1</mn><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.4" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.2.cmml">)</mo></mrow><mo stretchy="false" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.9" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.5.m5.10b"><apply id="S5.SS2.SSS5.p1.5.m5.10.10.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10"><in id="S5.SS2.SSS5.p1.5.m5.10.10.6.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.6"></in><interval closure="open" id="S5.SS2.SSS5.p1.5.m5.6.6.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1"><apply id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.6.6.1.1.1.3">kt</mtext></ci></apply><ci id="S5.SS2.SSS5.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.1.1">𝜆</ci></interval><set id="S5.SS2.SSS5.p1.5.m5.10.10.5.5.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4"><interval closure="open" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1"><apply id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.7.7.2.1.1.1.1.3">kd</mtext></ci></apply><cn type="float" id="S5.SS2.SSS5.p1.5.m5.2.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.2.2">0.01</cn></interval><interval closure="open" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1"><apply id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.8.8.3.2.2.1.1.3">kd</mtext></ci></apply><cn type="float" id="S5.SS2.SSS5.p1.5.m5.3.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.3.3">0.1</cn></interval><interval closure="open" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1"><apply id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.9.9.4.3.3.1.1.3">mmd</mtext></ci></apply><cn type="float" id="S5.SS2.SSS5.p1.5.m5.4.4.cmml" xref="S5.SS2.SSS5.p1.5.m5.4.4">0.01</cn></interval><interval closure="open" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1"><apply id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.1.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1">subscript</csymbol><ci id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.2.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3a.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3.cmml" xref="S5.SS2.SSS5.p1.5.m5.10.10.5.4.4.1.1.3">mmd</mtext></ci></apply><cn type="float" id="S5.SS2.SSS5.p1.5.m5.5.5.cmml" xref="S5.SS2.SSS5.p1.5.m5.5.5">0.1</cn></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.5.m5.10c">({\mathcal{L}}_{\text{kt}},\lambda)\in\{({\mathcal{L}}_{\text{kd}},0.01),({\mathcal{L}}_{\text{kd}},0.1),({\mathcal{L}}_{\text{mmd}},0.01),({\mathcal{L}}_{\text{mmd}},0.1)\}</annotation></semantics></math>. Fig. <a href="#S5.F11" title="Figure 11 ‣ 5.2.3 Results and Analysis ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> shows the comparison among different hyper-parameters. Setting <math id="S5.SS2.SSS5.p1.6.m6.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="S5.SS2.SSS5.p1.6.m6.1a"><mrow id="S5.SS2.SSS5.p1.6.m6.1.1" xref="S5.SS2.SSS5.p1.6.m6.1.1.cmml"><mi id="S5.SS2.SSS5.p1.6.m6.1.1.2" xref="S5.SS2.SSS5.p1.6.m6.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS5.p1.6.m6.1.1.1" xref="S5.SS2.SSS5.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS5.p1.6.m6.1.1.3" xref="S5.SS2.SSS5.p1.6.m6.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.6.m6.1b"><apply id="S5.SS2.SSS5.p1.6.m6.1.1.cmml" xref="S5.SS2.SSS5.p1.6.m6.1.1"><eq id="S5.SS2.SSS5.p1.6.m6.1.1.1.cmml" xref="S5.SS2.SSS5.p1.6.m6.1.1.1"></eq><ci id="S5.SS2.SSS5.p1.6.m6.1.1.2.cmml" xref="S5.SS2.SSS5.p1.6.m6.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS5.p1.6.m6.1.1.3.cmml" xref="S5.SS2.SSS5.p1.6.m6.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.6.m6.1c">\alpha=0.9</annotation></semantics></math>, and <math id="S5.SS2.SSS5.p1.7.m7.2" class="ltx_Math" alttext="{\mathcal{L}}_{\text{kt}}={\mathcal{L}}_{\text{kd}},\lambda=0.01" display="inline"><semantics id="S5.SS2.SSS5.p1.7.m7.2a"><mrow id="S5.SS2.SSS5.p1.7.m7.2.2.2" xref="S5.SS2.SSS5.p1.7.m7.2.2.3.cmml"><mrow id="S5.SS2.SSS5.p1.7.m7.1.1.1.1" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.cmml"><msub id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.2" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3a.cmml">kt</mtext></msub><mo id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.1" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.1.cmml">=</mo><msub id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.2" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3a.cmml">kd</mtext></msub></mrow><mo id="S5.SS2.SSS5.p1.7.m7.2.2.2.3" xref="S5.SS2.SSS5.p1.7.m7.2.2.3a.cmml">,</mo><mrow id="S5.SS2.SSS5.p1.7.m7.2.2.2.2" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.cmml"><mi id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.2" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.2.cmml">λ</mi><mo id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.1" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.1.cmml">=</mo><mn id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.3" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.3.cmml">0.01</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS5.p1.7.m7.2b"><apply id="S5.SS2.SSS5.p1.7.m7.2.2.3.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.7.m7.2.2.3a.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1"><eq id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.1.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.1"></eq><apply id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.2.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3a.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.2.3">kt</mtext></ci></apply><apply id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.1.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.2.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.2">ℒ</ci><ci id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3a.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3"><mtext mathsize="70%" id="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3.cmml" xref="S5.SS2.SSS5.p1.7.m7.1.1.1.1.3.3">kd</mtext></ci></apply></apply><apply id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2"><eq id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.1.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.1"></eq><ci id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.2.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.2">𝜆</ci><cn type="float" id="S5.SS2.SSS5.p1.7.m7.2.2.2.2.3.cmml" xref="S5.SS2.SSS5.p1.7.m7.2.2.2.2.3">0.01</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS5.p1.7.m7.2c">{\mathcal{L}}_{\text{kt}}={\mathcal{L}}_{\text{kd}},\lambda=0.01</annotation></semantics></math> is preferred. Although the performance under different hyper-parameters varies, the results are all superior to the most standard FL algorithm, i.e., FedAvg. That is, our methods could uniformly surpass FedAvg under various hyper-parameters.</p>
</div>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span><span id="S5.SS3.1.1" class="ltx_text ltx_font_italic">Large-Scale Datasets</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.9" class="ltx_p">We also investigate the performances on large-scale FL scenes, i.e., the FEMNIST recommended by LEAF<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://leaf.cmu.edu/</span></span></span></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>. There are 3550 different users in FEMNIST and each user owns 229 samples on average. We split local data into <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="80\%" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mn id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">80</mn><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">80\%</annotation></semantics></math> as the local training set on this client and the other <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mn id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">20</mn><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">20\%</annotation></semantics></math> as the local test set. The local test set across all clients are combined as a global test set. Although the scene is not a typical FL scene with incomplete classes, there exists an obvious class-missing phenomenon in each client’s local data. Specifically, FEMNIST contains 62 classes in total while each client could only observe 25 classes on average whose sample size is greater than 2. Hence, for each local client, we view classes with samples less than 2 in FEMNIST as missing classes. We train FL algorithms with different <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">Q</annotation></semantics></math> and <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mi id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><ci id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">E</annotation></semantics></math> on FEMNIST. The number of communication rounds is 100. The client selection ratio (<math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mi id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><ci id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">Q</annotation></semantics></math>) is varied in <math id="S5.SS3.p1.6.m6.2" class="ltx_Math" alttext="\{0.1,0.3\}" display="inline"><semantics id="S5.SS3.p1.6.m6.2a"><mrow id="S5.SS3.p1.6.m6.2.3.2" xref="S5.SS3.p1.6.m6.2.3.1.cmml"><mo stretchy="false" id="S5.SS3.p1.6.m6.2.3.2.1" xref="S5.SS3.p1.6.m6.2.3.1.cmml">{</mo><mn id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml">0.1</mn><mo id="S5.SS3.p1.6.m6.2.3.2.2" xref="S5.SS3.p1.6.m6.2.3.1.cmml">,</mo><mn id="S5.SS3.p1.6.m6.2.2" xref="S5.SS3.p1.6.m6.2.2.cmml">0.3</mn><mo stretchy="false" id="S5.SS3.p1.6.m6.2.3.2.3" xref="S5.SS3.p1.6.m6.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.2b"><set id="S5.SS3.p1.6.m6.2.3.1.cmml" xref="S5.SS3.p1.6.m6.2.3.2"><cn type="float" id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1">0.1</cn><cn type="float" id="S5.SS3.p1.6.m6.2.2.cmml" xref="S5.SS3.p1.6.m6.2.2">0.3</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.2c">\{0.1,0.3\}</annotation></semantics></math>, while the number of local personalization epochs (<math id="S5.SS3.p1.7.m7.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS3.p1.7.m7.1a"><mi id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.1b"><ci id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">E</annotation></semantics></math>) is varied in <math id="S5.SS3.p1.8.m8.3" class="ltx_Math" alttext="\{2,5,10\}" display="inline"><semantics id="S5.SS3.p1.8.m8.3a"><mrow id="S5.SS3.p1.8.m8.3.4.2" xref="S5.SS3.p1.8.m8.3.4.1.cmml"><mo stretchy="false" id="S5.SS3.p1.8.m8.3.4.2.1" xref="S5.SS3.p1.8.m8.3.4.1.cmml">{</mo><mn id="S5.SS3.p1.8.m8.1.1" xref="S5.SS3.p1.8.m8.1.1.cmml">2</mn><mo id="S5.SS3.p1.8.m8.3.4.2.2" xref="S5.SS3.p1.8.m8.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.8.m8.2.2" xref="S5.SS3.p1.8.m8.2.2.cmml">5</mn><mo id="S5.SS3.p1.8.m8.3.4.2.3" xref="S5.SS3.p1.8.m8.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.8.m8.3.3" xref="S5.SS3.p1.8.m8.3.3.cmml">10</mn><mo stretchy="false" id="S5.SS3.p1.8.m8.3.4.2.4" xref="S5.SS3.p1.8.m8.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.8.m8.3b"><set id="S5.SS3.p1.8.m8.3.4.1.cmml" xref="S5.SS3.p1.8.m8.3.4.2"><cn type="integer" id="S5.SS3.p1.8.m8.1.1.cmml" xref="S5.SS3.p1.8.m8.1.1">2</cn><cn type="integer" id="S5.SS3.p1.8.m8.2.2.cmml" xref="S5.SS3.p1.8.m8.2.2">5</cn><cn type="integer" id="S5.SS3.p1.8.m8.3.3.cmml" xref="S5.SS3.p1.8.m8.3.3">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.8.m8.3c">\{2,5,10\}</annotation></semantics></math>. We use a network with two convolution layers and one fully-connected layer. We use SGD with a momentum of 0.9, and the learning rate is <math id="S5.SS3.p1.9.m9.1" class="ltx_Math" alttext="0.004" display="inline"><semantics id="S5.SS3.p1.9.m9.1a"><mn id="S5.SS3.p1.9.m9.1.1" xref="S5.SS3.p1.9.m9.1.1.cmml">0.004</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.9.m9.1b"><cn type="float" id="S5.SS3.p1.9.m9.1.1.cmml" xref="S5.SS3.p1.9.m9.1.1">0.004</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.9.m9.1c">0.004</annotation></semantics></math>. For better visualization, we only compare MAP with FedAvg, Scaffold, and FedROD. The convergence curves are shown in Fig. <a href="#S5.F12" title="Figure 12 ‣ 5.2.3 Results and Analysis ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. Utilizing a larger local personalization epoch could lead to faster convergence. FedROD may encounter the aggregation performance degradation problem because of longer local training. Compared with other FL algorithms, MAP could obtain better performances under all of these experimental settings.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span><span id="S5.T3.4.2" class="ltx_text" style="font-size:90%;">Performance comparisions under complete classes (<math id="S5.T3.3.1.m1.1" class="ltx_Math" alttext="T=150" display="inline"><semantics id="S5.T3.3.1.m1.1b"><mrow id="S5.T3.3.1.m1.1.1" xref="S5.T3.3.1.m1.1.1.cmml"><mi id="S5.T3.3.1.m1.1.1.2" xref="S5.T3.3.1.m1.1.1.2.cmml">T</mi><mo id="S5.T3.3.1.m1.1.1.1" xref="S5.T3.3.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.3.1.m1.1.1.3" xref="S5.T3.3.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.m1.1c"><apply id="S5.T3.3.1.m1.1.1.cmml" xref="S5.T3.3.1.m1.1.1"><eq id="S5.T3.3.1.m1.1.1.1.cmml" xref="S5.T3.3.1.m1.1.1.1"></eq><ci id="S5.T3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S5.T3.3.1.m1.1.1.3.cmml" xref="S5.T3.3.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.m1.1d">T=150</annotation></semantics></math>, <math id="S5.T3.4.2.m2.1" class="ltx_Math" alttext="Q=0.2" display="inline"><semantics id="S5.T3.4.2.m2.1b"><mrow id="S5.T3.4.2.m2.1.1" xref="S5.T3.4.2.m2.1.1.cmml"><mi id="S5.T3.4.2.m2.1.1.2" xref="S5.T3.4.2.m2.1.1.2.cmml">Q</mi><mo id="S5.T3.4.2.m2.1.1.1" xref="S5.T3.4.2.m2.1.1.1.cmml">=</mo><mn id="S5.T3.4.2.m2.1.1.3" xref="S5.T3.4.2.m2.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.m2.1c"><apply id="S5.T3.4.2.m2.1.1.cmml" xref="S5.T3.4.2.m2.1.1"><eq id="S5.T3.4.2.m2.1.1.1.cmml" xref="S5.T3.4.2.m2.1.1.1"></eq><ci id="S5.T3.4.2.m2.1.1.2.cmml" xref="S5.T3.4.2.m2.1.1.2">𝑄</ci><cn type="float" id="S5.T3.4.2.m2.1.1.3.cmml" xref="S5.T3.4.2.m2.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.m2.1d">Q=0.2</annotation></semantics></math>, averaged across FaMnist, CIFAR-10, and CIFAR-100).</span></figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.5.1.1" class="ltx_tr">
<th id="S5.T3.5.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td id="S5.T3.5.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedAvg</td>
<td id="S5.T3.5.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedProx</td>
<td id="S5.T3.5.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Scaffold</td>
<td id="S5.T3.5.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedDyn</td>
<td id="S5.T3.5.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MOON</td>
<td id="S5.T3.5.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">pFedMe</td>
<td id="S5.T3.5.1.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Ditto</td>
<td id="S5.T3.5.1.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedROD</td>
<td id="S5.T3.5.1.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedRS</td>
<td id="S5.T3.5.1.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPHP</td>
<td id="S5.T3.5.1.1.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">MAP</td>
</tr>
<tr id="S5.T3.5.2.2" class="ltx_tr">
<th id="S5.T3.5.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Aggregation Accuracy</th>
<td id="S5.T3.5.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.93</td>
<td id="S5.T3.5.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.34</td>
<td id="S5.T3.5.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.85</td>
<td id="S5.T3.5.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.20</td>
<td id="S5.T3.5.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.35</td>
<td id="S5.T3.5.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.65</td>
<td id="S5.T3.5.2.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.31</td>
<td id="S5.T3.5.2.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.19</td>
<td id="S5.T3.5.2.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.15</td>
<td id="S5.T3.5.2.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.52</td>
<td id="S5.T3.5.2.2.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T3.5.2.2.12.1" class="ltx_text ltx_font_bold">73.03</span></td>
</tr>
<tr id="S5.T3.5.3.3" class="ltx_tr">
<th id="S5.T3.5.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Personalization Accuracy</th>
<td id="S5.T3.5.3.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.45</td>
<td id="S5.T3.5.3.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.08</td>
<td id="S5.T3.5.3.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.47</td>
<td id="S5.T3.5.3.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.44</td>
<td id="S5.T3.5.3.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.79</td>
<td id="S5.T3.5.3.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.78</td>
<td id="S5.T3.5.3.3.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.26</td>
<td id="S5.T3.5.3.3.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.25</td>
<td id="S5.T3.5.3.3.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.45</td>
<td id="S5.T3.5.3.3.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.08</td>
<td id="S5.T3.5.3.3.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S5.T3.5.3.3.12.1" class="ltx_text ltx_font_bold">75.61</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span><span id="S5.SS4.1.1" class="ltx_text ltx_font_italic">Scenes with Complete Classes</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.4" class="ltx_p">One of the limitations of this work is only focusing on the extreme scene of label distribution skew in FL. If we set <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{c}^{k}=\frac{m_{c}^{k}}{\sum_{j=1}^{C}m_{j}^{k}}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><msubsup id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2.2.2" xref="S5.SS4.p1.1.m1.1.1.2.2.2.cmml">α</mi><mi id="S5.SS4.p1.1.m1.1.1.2.2.3" xref="S5.SS4.p1.1.m1.1.1.2.2.3.cmml">c</mi><mi id="S5.SS4.p1.1.m1.1.1.2.3" xref="S5.SS4.p1.1.m1.1.1.2.3.cmml">k</mi></msubsup><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">=</mo><mfrac id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><msubsup id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2.2.2" xref="S5.SS4.p1.1.m1.1.1.3.2.2.2.cmml">m</mi><mi id="S5.SS4.p1.1.m1.1.1.3.2.2.3" xref="S5.SS4.p1.1.m1.1.1.3.2.2.3.cmml">c</mi><mi id="S5.SS4.p1.1.m1.1.1.3.2.3" xref="S5.SS4.p1.1.m1.1.1.3.2.3.cmml">k</mi></msubsup><mrow id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S5.SS4.p1.1.m1.1.1.3.3.1" xref="S5.SS4.p1.1.m1.1.1.3.3.1.cmml"><msubsup id="S5.SS4.p1.1.m1.1.1.3.3.1a" xref="S5.SS4.p1.1.m1.1.1.3.3.1.cmml"><mo id="S5.SS4.p1.1.m1.1.1.3.3.1.2.2" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.2" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.1" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.SS4.p1.1.m1.1.1.3.3.1.3" xref="S5.SS4.p1.1.m1.1.1.3.3.1.3.cmml">C</mi></msubsup></mstyle><msubsup id="S5.SS4.p1.1.m1.1.1.3.3.2" xref="S5.SS4.p1.1.m1.1.1.3.3.2.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.3.2.2.2" xref="S5.SS4.p1.1.m1.1.1.3.3.2.2.2.cmml">m</mi><mi id="S5.SS4.p1.1.m1.1.1.3.3.2.2.3" xref="S5.SS4.p1.1.m1.1.1.3.3.2.2.3.cmml">j</mi><mi id="S5.SS4.p1.1.m1.1.1.3.3.2.3" xref="S5.SS4.p1.1.m1.1.1.3.3.2.3.cmml">k</mi></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><eq id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></eq><apply id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.2">superscript</csymbol><apply id="S5.SS4.p1.1.m1.1.1.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.2.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2.2.2">𝛼</ci><ci id="S5.SS4.p1.1.m1.1.1.2.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.2.2.3">𝑐</ci></apply><ci id="S5.SS4.p1.1.m1.1.1.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><divide id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3"></divide><apply id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">superscript</csymbol><apply id="S5.SS4.p1.1.m1.1.1.3.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.2.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.3.2.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.2.2">𝑚</ci><ci id="S5.SS4.p1.1.m1.1.1.3.2.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.2.3">𝑐</ci></apply><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3">𝑘</ci></apply><apply id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3"><apply id="S5.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.3.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1">superscript</csymbol><apply id="S5.SS4.p1.1.m1.1.1.3.3.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.3.1.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S5.SS4.p1.1.m1.1.1.3.3.1.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.2"></sum><apply id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3"><eq id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.1"></eq><ci id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S5.SS4.p1.1.m1.1.1.3.3.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.1.3">𝐶</ci></apply><apply id="S5.SS4.p1.1.m1.1.1.3.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.3.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2">superscript</csymbol><apply id="S5.SS4.p1.1.m1.1.1.3.3.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.3.2.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.3.3.2.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2.2.2">𝑚</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.2.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2.2.3">𝑗</ci></apply><ci id="S5.SS4.p1.1.m1.1.1.3.3.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\alpha_{c}^{k}=\frac{m_{c}^{k}}{\sum_{j=1}^{C}m_{j}^{k}}</annotation></semantics></math> in Eq. <a href="#S4.E8" title="In 4.1.3 Restricted Softmax ‣ 4.1 Restricted Softmax for Model Aggregation ‣ 4 Proposed Methods ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, where <math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="m_{c}^{k}" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><msubsup id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2.2" xref="S5.SS4.p1.2.m2.1.1.2.2.cmml">m</mi><mi id="S5.SS4.p1.2.m2.1.1.2.3" xref="S5.SS4.p1.2.m2.1.1.2.3.cmml">c</mi><mi id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">superscript</csymbol><apply id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.2.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2.2">𝑚</ci><ci id="S5.SS4.p1.2.m2.1.1.2.3.cmml" xref="S5.SS4.p1.2.m2.1.1.2.3">𝑐</ci></apply><ci id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">m_{c}^{k}</annotation></semantics></math> means the amount of samples in the <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><mi id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">c</annotation></semantics></math>-th class, we could apply “RS” to complete classes. We construct scenes with complete classes via decentralizing data by the Dirichlet distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, and set the Dirichlet alpha as <math id="S5.SS4.p1.4.m4.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.SS4.p1.4.m4.1a"><mn id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><cn type="float" id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">0.5</annotation></semantics></math>. The used networks and datasets are LeNet on FaMnist, TFCNN on CIFAR-10, and VGG8-BN on CIFAR-100. Other hyper-parameters are kept the same as before. The averaged aggregation and personalization results are listed in Tab. <a href="#S5.T3" title="TABLE III ‣ 5.3 Large-Scale Datasets ‣ 5 Experiments ‣ MAP: Model Aggregation and Personalization in Federated Learning with Incomplete Classes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. With slight modification, FedRS could also improve the aggregation accuracy, while it is not so effective when compared with Scaffold. The significant personalization improvement of FedPHP shows the pure effectiveness of “HPM” under complete classes. MAP improves both aggregation and personalization performances, which verifies that combing “RS” and “HPM” could also facilitate the learning process under complete scenes.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We study an extreme label distribution Non-I.I.D. scene in FL, i.e., FL with incomplete classes where participating clients could encounter the challenges of missing classes. We point out that the missing classes could harm both the aggregation and personalization performances in FL. On one hand, to tackle the aggregation problem caused by incomplete classes, we propose a novel strategy named “restricted softmax” to carefully update the proxies of missing classes during local training. On the other hand, to solve the personalization problem caused by incomplete classes, we propose another novel strategy named “inherited private model” to carefully utilize the historical personalization experience. The two strategies are seamlessly combined as the proposed methods. Our proposed MAP could simultaneously obtain better aggregation and personalization performances. Abundant experimental studies verify the superiorities of our methods. Extending the method to more complex and practical FL scenes may be the future work. Simultaneously considering other factors like fairness in FL is also interesting to study further.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is partially supported by the the National Key RD Program of China (Grant No. 2022YFF0712100) and the National Natural Science Foundation of China (Grant No. 61921006, 62006118, 62276131). Thanks to Huawei Noah’s Ark Lab NetMIND Research Team.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
J. Deng, W. Dong, R. Socher, L. Li, K. Li, and L. Fei-Fei, “Imagenet: A
large-scale hierarchical image database,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Computer Society
Conference on Computer Vision and Pattern Recognition</em>, 2009, pp. 248–255.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern
Recognition</em>, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
S. Ramaswamy, R. Mathews, K. Rao, and F. Beaufays, “Federated learning for
emoji prediction in a mobile keyboard,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1906.04329,
2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
M. Li, L. Zhou, Z. Yang, A. Li, F. Xia, D. G. Andersen, and A. Smola,
“Parameter server for distributed machine learning,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Big Learning
NeurIPS Workshop</em>, vol. 6, 2013, p. 2.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Dean, G. Corrado, R. Monga, K. Chen, M. Devin, Q. V. Le, M. Z. Mao,
M. Ranzato, A. W. Senior, P. A. Tucker, K. Yang, and A. Y. Ng, “Large scale
distributed deep networks,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems 25</em>, 2012, pp. 1232–1240.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, and Y. Tong, “Federated machine learning: Concept
and applications,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology</em>, vol. 10, no. 2, pp. 12:1–12:19, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
X. Zhang, Y. Li, W. Li, K. Guo, and Y. Shao, “Personalized federated learning
via variational bayesian inference,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">International Conference on
Machine Learning</em>, 2022, pp. 26 293–26 310.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
X. Li, L. Gan, D. Zhan, Y. Shao, B. Li, and S. Song, “Aggregate or not?
exploring where to privatize in DNN based federated learning under
different non-iid scenes,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2107.11954, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Z. Li, J. Lu, S. Luo, D. Zhu, Y. Shao, Y. Li, Z. Zhang, and C. Wu, “Mining
latent relationships among clients: Peer-to-peer federated learning with
adaptive neighbor matching,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Big Data</em>, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Li, X. Liu, X. Zhang, Y. Shao, Q. Wang, and Y. Geng, “Personalized
federated learning via maximizing correlation with sparse and hierarchical
extensions,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2107.05330, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Yuan, X. Ma, D. Chen, F. Wu, L. Lin, and K. Kuang, “Collaborative semantic
aggregation and calibration for federated domain generalization,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Knowledge and Data Engineering</em>, vol. 35,
no. 12, pp. 12 528–12 541, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
C. He, A. D. Shah, Z. Tang, D. Fan, A. N. Sivashunmugam, K. Bhogaraju,
M. Shimpi, L. Shen, X. Chu, M. Soltanolkotabi, and S. Avestimehr, “Fedcv:
A federated learning framework for diverse computer vision tasks,”
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2111.11066, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
X. Li, Y. Xu, S. Song, B. Li, Y. Li, Y. Shao, and D. Zhan, “Federated learning
with position-aware neurons,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision
and Pattern Recognition</em>, 2022, pp. 10 082–10 091.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
B. Y. Lin, C. He, Z. Ze, H. Wang, Y. Hua, C. Dupuy, R. Gupta,
M. Soltanolkotabi, X. Ren, and S. Avestimehr, “Fednlp: Benchmarking
federated learning methods for natural language processing tasks,” in
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics</em>, 2022, pp.
157–175.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
X. Li, D. Zhan, Y. Shao, B. Li, and S. Song, “Preliminary steps towards
federated sentiment classification,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2107.11956, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
X. Li, J. Tang, S. Song, B. Li, Y. Li, Y. Shao, L. Gan, and D. Zhan, “Avoid
overfitting user specific information in federated keyword spotting,”
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2206.08864, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning and Systems</em>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1806.00582, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
T. Yu, E. Bagdasaryan, and V. Shmatikov, “Salvaging federated learning by
local adaptation,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2002.04758, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
M. Yurochkin, M. Agarwal, S. Ghosh, K. H. Greenewald, T. N. Hoang, and
Y. Khazaeni, “Bayesian nonparametric federated learning of neural
networks,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th International Conference on
Machine Learning</em>, 2019, pp. 7252–7261.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Practical one-shot federated learning for
cross-silo setting,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirtieth International
Joint Conference on Artificial Intelligence</em>, 2021, pp. 1484–1490.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
L. Wang, S. Xu, X. Wang, and Q. Zhu, “Addressing class imbalance in federated
learning,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Thirty-Fifth AAAI Conference on Artificial
Intelligence</em>, 2021, pp. 10 165–10 173.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
T. Lin, L. Kong, S. U. Stich, and M. Jaggi, “Ensemble distillation for robust
model fusion in federated learning,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems 33</em>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. Tan, G. Long, L. Liu, T. Zhou, Q. Lu, J. Jiang, and C. Zhang, “Fedproto:
Federated prototype learning across heterogeneous clients,” in
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Thirty-Sixth AAAI Conference on Artificial Intelligence</em>, 2022, pp.
8432–8440.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
X. Li and D. Zhan, “Fedrs: Federated learning with restricted softmax for
label distribution non-iid data,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">The 27th ACM SIGKDD
Conference on Knowledge Discovery and Data Mining</em>, 2021, pp. 995–1005.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
X. Li, D. Zhan, Y. Shao, B. Li, and S. Song, “Fedphp: Federated
personalization with inherited private models,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Machine Learning
and Knowledge Discovery in Databases. Research Track - European Conference</em>,
2021, pp. 587–602.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Yosinski, J. Clune, Y. Bengio, and H. Lipson, “How transferable are
features in deep neural networks?” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems 27</em>, 2014, pp. 3320–3328.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
K. Jarrett, K. Kavukcuoglu, M. Ranzato, and Y. LeCun, “What is the best
multi-stage architecture for object recognition?” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE 12th
International Conference on Computer Vision</em>, 2009, pp. 2146–2153.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
J. Quionero-Candela, M. Sugiyama, A. Schwaighofer, and N. Lawrence, “Dataset
shift in machine learning,” 01 2009.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
M. A. Jamal, M. Brown, M. Yang, L. Wang, and B. Gong, “Rethinking
class-balanced methods for long-tailed visual recognition from a domain
adaptation perspective,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 2020, pp. 7607–7616.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
M. Hayat, S. H. Khan, W. Zamir, J. Shen, and L. Shao, “Max-margin class
imbalanced learning with gaussian affinity,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/1901.07711, 2019.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Shen, J. Cerviño, H. Hassani, and A. Ribeiro, “An agnostic approach
to federated learning with class imbalance,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">The Tenth
International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Dong, L. Wang, Z. Fang, G. Sun, S. Xu, X. Wang, and Q. Zhu, “Federated
class-incremental learning,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2203.11473, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Y. Yang, D. Zhou, D. Zhan, H. Xiong, and Y. Jiang, “Adaptive deep models for
incremental learning: Considering capacity scalability and sustainability,”
in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th ACM SIGKDD International Conference on
Knowledge Discovery &amp; Data Mining</em>, 2019, pp. 74–82.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Y. Yang, Z.-Q. Sun, H. Zhu, Y. Fu, Y. Zhou, H. Xiong, and J. Yang, “Learning
adaptive embedding considering incremental class,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions
on Knowledge and Data Engineering</em>, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
H. Chen and W. Chao, “On bridging generic and personalized federated learning
for image classification,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">The Tenth International Conference on
Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
E. Jeong, S. Oh, H. Kim, J. Park, M. Bennis, and S. Kim,
“Communication-efficient on-device machine learning: Federated distillation
and augmentation under non-iid private data,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/1811.11479, 2018.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
X. Yao, T. Huang, R. Zhang, R. Li, and L. Sun, “Federated learning with
unbiased gradient aggregation and controllable meta updating,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">CoRR</em>,
vol. abs/1910.08234, 2019.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
X. Wu, S. Liu, and Z. Zhou, “Heterogeneous model reuse via optimizing
multiparty multiclass margin,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th
International Conference on Machine Learning</em>, 2019, pp. 6840–6849.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
D. A. E. Acar, Y. Zhao, R. M. Navarro, M. Mattina, P. N. Whatmough, and
V. Saligrama, “Federated learning based on dynamic regularization,” in
<em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
X. Yao, C. Huang, and L. Sun, “Two-stream federated learning: Reduce the
communication costs,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">IEEE Visual Communications and Image
Processing</em>, 2018, pp. 1–4.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. J. Reddi, S. U. Stich, and A. T.
Suresh, “SCAFFOLD: stochastic controlled averaging for federated
learning,” in <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International Conference on
Machine Learning</em>, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
S. J. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečný,
S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” in
<em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
J. Wang, Q. Liu, H. Liang, G. Joshi, and H. V. Poor, “Tackling the objective
inconsistency problem in heterogeneous federated optimization,” in
<em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33</em>, 2020.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
H. Wang, M. Yurochkin, Y. Sun, D. S. Papailiopoulos, and Y. Khazaeni,
“Federated learning with matched averaging,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">8th International
Conference on Learning Representations</em>, 2020.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
F. X. Yu, A. S. Rawat, A. K. Menon, and S. Kumar, “Federated learning with
only positive labels,” in <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International
Conference on Machine Learning</em>, 2020, pp. 10 946–10 956.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
T. H. Hsu, H. Qi, and M. Brown, “Federated visual classification with
real-world data distribution,” in <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Computer Vision - ECCV 2020 - 16th
European Conference</em>, 2020, pp. 76–92.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
J. Hamer, M. Mohri, and A. T. Suresh, “FedBoost: A communication-efficient
algorithm for federated learning,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th
International Conference on Machine Learning</em>, 2020, pp. 3973–3983.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
K. Wang, R. Mathews, C. Kiddon, H. Eichner, F. Beaufays, and D. Ramage,
“Federated evaluation of on-device personalization,” <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/1910.10252, 2019.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
V. Smith, C. Chiang, M. Sanjabi, and A. S. Talwalkar, “Federated multi-task
learning,” in <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 30</em>,
2017, pp. 4424–4434.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. E. Ozdaglar, “Personalized federated learning
with theoretical guarantees: A model-agnostic meta-learning approach,” in
<em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33</em>, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
F. Chen, Z. Dong, Z. Li, and X. He, “Federated meta-learning for
recommendation,” <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1802.07876, 2018.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
A. Bellet, R. Guerraoui, M. Taziki, and M. Tommasi, “Personalized and private
peer-to-peer machine learning,” in <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">International Conference on
Artificial Intelligence and Statistics</em>, vol. 84, 2018, pp. 473–481.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
D. Peterson, P. Kanani, and V. J. Marathe, “Private federated learning with
domain adaptation,” <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1912.06733, 2019.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
L. Collins, H. Hassani, A. Mokhtari, and S. Shakkottai, “Exploiting shared
representations for personalized federated learning,” in <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 38th International Conference on Machine Learning</em>, 2021, pp.
2089–2099.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global
and local models,” <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2002.05516, 2020.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, and Q. Yang, “Towards personalized federated
learning,” <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning
Systems</em>, vol. 34, no. 12, pp. 9587–9603, 2023.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/2002.10619, 2020.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
G. E. Hinton, O. Vinyals, and J. Dean, “Distilling the knowledge in a neural
network,” <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1503.02531, 2015.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
A. Gretton, K. M. Borgwardt, M. J. Rasch, B. Schölkopf, and A. J. Smola,
“A kernel method for the two-sample-problem,” in <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Advances in Neural
Information Processing Systems 19</em>, 2006, pp. 513–520.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
M. Long, Y. Cao, J. Wang, and M. I. Jordan, “Learning transferable features
with deep adaptation networks,” in <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 32nd
International Conference on Machine Learning</em>, 2015, pp. 97–105.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
A. Agarwala, J. Pennington, Y. N. Dauphin, and S. S. Schoenholz, “Temperature
check: theory and practice for training models with softmax-cross-entropy
losses,” <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2010.07344, 2020.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Z. Qin and D. Kim, “Rethinking softmax with cross-entropy: Neural network
classifier as mutual information estimator,” <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol.
abs/1911.10688, 2019.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
S. Laine and T. Aila, “Temporal ensembling for semi-supervised learning,” in
<em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">5th International Conference on Learning Representations</em>, 2017.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
A. Tarvainen and H. Valpola, “Mean teachers are better role models:
Weight-averaged consistency targets improve semi-supervised deep learning
results,” in <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 30</em>,
2017, pp. 1195–1204.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf, “Fashion-mnist: a novel image dataset for
benchmarking machine learning algorithms,” <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1708.07747,
2017.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
A. Krizhevsky, “Learning multiple layers of features from tiny images,” 2012.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
L. N. Darlow, E. J. Crowley, A. Antoniou, and A. J. Storkey, “CINIC-10 is
not imagenet or CIFAR-10,” <em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1810.03505, 2018.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
S. Caldas, P. Wu, T. Li, J. Konecný, H. B. McMahan, V. Smith, and
A. Talwalkar, “LEAF: A benchmark for federated settings,” <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">CoRR</em>,
vol. abs/1812.01097, 2018.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
Y. LeCun, “The mnist database of handwritten digits,” 1998. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://yann.lecun.com/exdb/mnist/</span>

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol. 86,
no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
V. Nair and G. E. Hinton, “Rectified linear units improve restricted boltzmann
machines,” in <em id="bib.bib73.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 27th International Conference on
Machine Learning</em>, 2010, pp. 807–814.

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
K. Simonyan and A. Zisserman, “Very deep convolutional networks for
large-scale image recognition,” in <em id="bib.bib74.1.1" class="ltx_emph ltx_font_italic">3rd International Conference on
Learning Representations</em>, 2015.

</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
S. Ioffe and C. Szegedy, “Batch normalization: Accelerating deep network
training by reducing internal covariate shift,” in <em id="bib.bib75.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
32nd International Conference on Machine Learning</em>, 2015, pp. 448–456.

</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Model-contrastive federated learning,” in
<em id="bib.bib76.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition</em>, 2021,
pp. 10 713–10 722.

</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
C. T. Dinh, N. H. Tran, and T. D. Nguyen, “Personalized federated learning
with moreau envelopes,” in <em id="bib.bib77.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems 33</em>, 2020.

</span>
</li>
<li id="bib.bib78" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock">
T. Li, S. Hu, A. Beirami, and V. Smith, “Ditto: Fair and robust federated
learning through personalization,” in <em id="bib.bib78.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</em>, 2021, pp. 6357–6368.

</span>
</li>
<li id="bib.bib79" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock">
D. Li and J. Wang, “Fedmd: Heterogenous federated learning via model
distillation,” <em id="bib.bib79.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1910.03581, 2019.

</span>
</li>
<li id="bib.bib80" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock">
K. Pillutla, K. Malik, A. Mohamed, M. Rabbat, M. Sanjabi, and L. Xiao,
“Federated learning with partial model personalization,” in
<em id="bib.bib80.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2022, pp.
17 716–17 758.

</span>
</li>
</ul>
</section>
<figure id="id1" class="ltx_float biography">
<table id="id1.1" class="ltx_tabular">
<tr id="id1.1.1" class="ltx_tr">
<td id="id1.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/lixc.png" id="id1.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="88" height="125" alt="[Uncaptioned image]"></td>
<td id="id1.1.1.2" class="ltx_td">
<span id="id1.1.1.2.1" class="ltx_inline-block">
<span id="id1.1.1.2.1.1" class="ltx_p"><span id="id1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Xin-Chun Li</span>  received his M.Sc. degree with the National Key Lab for Novel Software Technology, the Department of Computer Science and Technology in Nanjing University, China. He is working towards a Ph.D. degree with the School of Artificial Intelligence in Nanjing University, China. Up until now, he has published over 10 papers in national and international journals or conferences such as NeurIPS, CVPR, KDD, ICASSP, SCIS, etc. His research interests lie primarily in machine learning and data mining, including federated learning.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id2" class="ltx_float biography">
<table id="id2.1" class="ltx_tabular">
<tr id="id2.1.1" class="ltx_tr">
<td id="id2.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/songsm.jpg" id="id2.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="100" height="125" alt="[Uncaptioned image]"></td>
<td id="id2.1.1.2" class="ltx_td">
<span id="id2.1.1.2.1" class="ltx_inline-block">
<span id="id2.1.1.2.1.1" class="ltx_p"><span id="id2.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Shaoming Song</span>  received his M.Sc. degree with the Tsinghua National Laboratory for Information Science and Technology, the Department of Automation in Tsinghua University, China. Currently he serves as a senior research engineer at Huawei Noah’s Ark Lab. His research interests mainly include machine learning generalization and federated learning.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id3" class="ltx_float biography">
<table id="id3.1" class="ltx_tabular">
<tr id="id3.1.1" class="ltx_tr">
<td id="id3.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/x13.png" id="id3.1.1.1.g1" class="ltx_graphics ltx_img_square" width="77" height="94" alt="[Uncaptioned image]"></td>
<td id="id3.1.1.2" class="ltx_td">
<span id="id3.1.1.2.1" class="ltx_inline-block">
<span id="id3.1.1.2.1.1" class="ltx_p"><span id="id3.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Yinchuan Li</span>  (Member, IEEE) received the B.S. and Ph.D. degrees in electronic engineering from the Beijing Institute of Technology (BIT), Beijing, China, in 2015 and 2020, respectively. From November 2017 to November 2019, he was a Visiting Scholar with the Department of Electrical Engineering, Columbia University, New York, NY, USA. From February 2020 to August 2020, he was a senior technical consultant in Santé Ventures, Austin, TX, USA. He now works at Noah’s Ark Lab, Huawei Technologies, Beijing, China, as an AI researcher. His current research interests include machine learning, deep learning, reinforcement learning and sparse signal processing. Dr. Li received the Excellent Paper Award at the 2019 IEEE International Conference on Signal, Information and Data Processing.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id4" class="ltx_float biography">
<table id="id4.1" class="ltx_tabular">
<tr id="id4.1.1" class="ltx_tr">
<td id="id4.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/libs.jpg" id="id4.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="100" height="125" alt="[Uncaptioned image]"></td>
<td id="id4.1.1.2" class="ltx_td">
<span id="id4.1.1.2.1" class="ltx_inline-block">
<span id="id4.1.1.2.1.1" class="ltx_p"><span id="id4.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Bingshuai Li</span>  received the B.Sc. and M.Sc. degrees from JiLin University China, in 2014 and 2017, respectively. He is currently an engineer in Huawei Noah’s Ark Lab. His current research interest includes machine learning, federated learning, transfer learning and their applications in Telecommunication network.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id5" class="ltx_float biography">
<table id="id5.1" class="ltx_tabular">
<tr id="id5.1.1" class="ltx_tr">
<td id="id5.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/shaoyf.jpg" id="id5.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="97" height="125" alt="[Uncaptioned image]"></td>
<td id="id5.1.1.2" class="ltx_td">
<span id="id5.1.1.2.1" class="ltx_inline-block">
<span id="id5.1.1.2.1.1" class="ltx_p"><span id="id5.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Yunfeng Shao</span>  received the B.S. and Ph.D. degrees in Electronic Engineering from Shanghai Jiao Tong University and University of Chinese Academy of Sciences China, in 2009 and 2014, respectively. He is currently an expert in Huawei Noah’s Ark Lab. His research interests include machine learning with privacy protection, federated learning, transfer learning and their applications in Telecommunication network.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id6" class="ltx_float biography">
<table id="id6.1" class="ltx_tabular">
<tr id="id6.1.1" class="ltx_tr">
<td id="id6.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/yangy.jpg" id="id6.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="88" height="125" alt="[Uncaptioned image]"></td>
<td id="id6.1.1.2" class="ltx_td">
<span id="id6.1.1.2.1" class="ltx_inline-block">
<span id="id6.1.1.2.1.1" class="ltx_p"><span id="id6.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Yang Yang</span>  received the Ph.D. degree in computer science, Nanjing University, China in 2019. At the same year, he became a faculty member at Nanjing University of Science and Technology, China. He is currently a Professor with the school of Computer Science and Engineering. His research interests lie primarily in machine learning and data mining, including heterogeneous learning, model reuse, and incremental mining. He has published prolifically in refereed journals and conference proceedings, including IEEE Transactions on Knowledge and Data Engineering (TKDE), ACM Transactions on Information Systems (ACM TOIS), ACM Transactions on Knowledge Discovery from Data (TKDD), ACM SIGKDD, ACM SIGIR, WWW, IJCAI, and AAAI. He was the recipient of the the Best Paper Award of ACML-2017. He serves as PC/SPC in leading conferences such as IJCAI, AAAI, ICML, NeurIPS, etc.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id7" class="ltx_float biography">
<table id="id7.1" class="ltx_tabular">
<tr id="id7.1.1" class="ltx_tr">
<td id="id7.1.1.1" class="ltx_td"><img src="/html/2404.09232/assets/zhandc.jpg" id="id7.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="89" height="125" alt="[Uncaptioned image]"></td>
<td id="id7.1.1.2" class="ltx_td">
<span id="id7.1.1.2.1" class="ltx_inline-block">
<span id="id7.1.1.2.1.1" class="ltx_p"><span id="id7.1.1.2.1.1.1" class="ltx_text ltx_font_bold">De-Chuan Zhan</span>  joined in the LAMDA Group on 2004 and received his Ph.D. degree in Computer Science from Nanjing University in 2010, and then serviced in the Department of Computer Science and Technology of Nanjing University as an Assistant Professor from 2010, and as an Associate Professor from 2013. Then he joined the School of Artificial Intelligence of Nanjing University as a Professor from 2019. His research interests mainly include machine learning and data mining, especially working on mobile intelligence, distance metric learning, multi-modal learning, etc. Up until now, he has published over 60 papers in national and international journals or conferences such as TPAMI, TKDD, TIFS, TSMSB, IJCAI, ICML, NIPS, AAAI, etc. He served as the deputy director of LAMDA group, NJU, and the director of AI Innovation Institute of AI Valley, Nanjing, China.</span>
</span>
</td>
</tr>
</table>
</figure>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.09231" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.09232" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.09232">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.09232" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.09233" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 22:23:00 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
