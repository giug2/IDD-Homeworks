<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL</title>
<!--Generated on Wed Sep  4 13:30:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="generative AI logistics parcel tracking multi-agent systems AI-driven communication Specialized Large Language Models LLAMA3 PostNL operational efficiency digital transformation Track and Trace." lang="en" name="keywords"/>
<base href="/html/2409.02711v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S1" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S1.SS1" title="In 1 Introduction ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>PostNL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S1.SS2" title="In 1 Introduction ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.2 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S1.SS3" title="In 1 Introduction ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.3 </span>Research Goal</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Literature Study</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS1" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Generative AI and ChatGPT</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS2" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Transformer Architectures and Large Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS3" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Open-sourced and closed-sourced LLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS4" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Making LLMs suitable for specific tasks through fine-tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS5" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Making LLMS suitable for specific tasks through Retrieval Augmented Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS6" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span>Enhancing the input of an LLM-based systems through prompt engineering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS7" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.7 </span>Enhancing the performance of LLM-based systems through Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS8" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.8 </span>Logistic event prediction through sequence to sequence prediction by T5</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S2.SS9" title="In 2 Literature Study ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.9 </span>LLMs and Multi-Agent systems</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The Solution</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS1" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Data and knowledge Discovery</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS2" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Data Preparation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Model design</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3.SSS1" title="In 3.3 Model design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Expected model output</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3.SSS2" title="In 3.3 Model design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Overall Model design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3.SSS3" title="In 3.3 Model design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>language detection and translation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3.SSS4" title="In 3.3 Model design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.4 </span>Logistic event prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS3.SSS5" title="In 3.3 Model design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.5 </span>Fine-tuning LLAMA</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS4" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Optimizing the performance of the model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS5" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Architectural design</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS5.SSS1" title="In 3.5 Architectural design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.1 </span>The multi-agent setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS5.SSS2" title="In 3.5 Architectural design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.2 </span>Prompt engineering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS5.SSS3" title="In 3.5 Architectural design ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.3 </span>RAG architecture</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS6" title="In 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Overall System Architecture Overview</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S3.SS6.SSS1" title="In 3.6 Overall System Architecture Overview ‣ 3 The Solution ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6.1 </span>The final product and User-Interface</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Evaluation and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS1" title="In 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Technical Evaluation of the model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS2" title="In 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Human Evaluation of the generated output by SuperTracy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS2.SSS1" title="In 4.2 Human Evaluation of the generated output by SuperTracy ‣ 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Experimental Setup of Human Evaluation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS3" title="In 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results of the evaluation of Domain Experts</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS3.SSS1" title="In 4.3 Results of the evaluation of Domain Experts ‣ 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Quantitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS3.SSS2" title="In 4.3 Results of the evaluation of Domain Experts ‣ 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Qualitative Feedback</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS4" title="In 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#S4.SS5" title="In 4 Evaluation and Discussion ‣ Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Future Work</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#Pt0.Ax1" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title">Appendices</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#Pt0.A1" title="In Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A </span>Illustrations of various applications of SuperTracy, including user queries and system responses.</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>
Vrije Universiteit Amsterdam </span></span></span><span class="ltx_note ltx_role_institutetext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>IT E-commerce at PostNL 
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id2.1"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">email: </span>m.s.reshadati@student.vu.nl</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">Creating a Gen-AI based Track and Trace Assistant MVP (SuperTracy) for PostNL</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohammad Reshadati
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">The developments in the field of generative AI has brought a lot of opportunities for companies, for instance to improve efficiency in customer service and automating tasks. PostNL, the biggest parcel and E-commerce corporation of the Netherlands wants to use generative AI to enhance the communication around track and trace of parcels. During the internship a Minimal Viable Product (MVP) is created to showcase the value of using generative AI technologies, to enhance parcel tracking, analyzing the parcel’s journey and being able to communicate about it in an easy to understand manner. The primary goal was to develop an in-house LLM-based system, reducing dependency on external platforms and establishing the feasibility of a dedicated generative AI team within the company. This multi-agent LLM based system aimed to construct parcel journey stories and identify logistical disruptions with heightened efficiency and accuracy. The research involved deploying a sophisticated AI-driven communication system, employing Retrieval-Augmented Generation (RAG) for enhanced response precision, and optimizing large language models (LLMs) tailored to domain specific tasks.</p>
<p class="ltx_p" id="id3.id2">The MVP successfully implemented a multi-agent open-source LLM system, called SuperTracy. SuperTracy is capable of autonomously managing a broad spectrum of user inquiries and improving internal knowledge handling. Results and evaluation demonstrated technological innovation and feasibility, notably in communication about the track and trace of a parcel, which exceeded initial expectations. These advancements highlight the potential of AI-driven solutions in logistics, suggesting many opportunities for further refinement and broader implementation within PostNL’s operational framework.</p>
<div class="ltx_block ltx_minipage ltx_align_middle" id="id1.1" style="width:433.6pt;">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="125" id="id1.1.g1" src="extracted/5833211/image9.png" width="299"/>
</div>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>generative AI logistics parcel tracking multi-agent systems AI-driven communication Specialized Large Language Models LLAMA3 PostNL operational efficiency digital transformation Track and Trace.
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">My project was greatly facilitated by my supervisors, Banno Postma from VU Amsterdam and Jochem Roth from PostNL. I thank Banno Postma for his guidance, feedback and flexibility throughout the process. I thank the Gen-AI team for welcoming me with open arms to PostNL. My special thanks to Jochem Roth for this internship opportunity, his guidance and the trust he had in me to provide the MVP and present it for the Directors. I greatly value Chris Scholtens’ expertise in clarifying PostNL’s logistical network and Nick Smith for providing logistics data. I express my gratitude to Jasper Bosma for his critical evaluation of the SuperTracy project, as well as to his team members Antoine Donkers, Stefan de Jong, Sebastiaan van de Koppel, Kees-Jan de Gee, Floris Groot, Robbert-Jan Joling, and Michael Street for their essential evaluations.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The developments in the field of generative AI has brought a lot of opportunities for companies. For instance, the logistics and postal sector has seen significant improvements in efficiency of customer service through the integration of AI technologies. As one of the leading postal and logistics companies in the Netherlands, PostNL has embraced these advancements to enhance the internal and external communication around track and trace of parcels. This thesis explores the development and implementation of a generative AI-based multi-agent large language model system designed to facilitate parcel-related inquiries at PostNL. By leveraging the capabilities of generative AI, this system aims to streamline communication, improve customer satisfaction and to help internal agents to understand the journey of the parcel in an easy manner.</p>
</div>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>PostNL</h3>
<div class="ltx_para" id="S1.SS1.p1">
<p class="ltx_p" id="S1.SS1.p1.1">PostNL is the biggest mail, parcel and E-commerce corporation of the Netherlands, with
operations among the Benelux, Germany, Italy and the United Kingdom. It has a rich history of 225 years in The Netherlands. On an average weekday, 1.1 million parcels and 6.9 million letters are delivered throughout the Netherlands by PostNL. This huge amount is achieved by the existence of 37 sorting centers, 11.000 letter boxes, 903 Automated Parcel Lockers 5.795 retail locations and approximately 33.500 employees <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.SS1.p2">
<p class="ltx_p" id="S1.SS1.p2.1">The business of PostNL is high-over divided in 3 sections: parcels, mail and Cross Border Solutions (CBS). The scope of this research is parcels and E-commerce. The end-to-end process of parcel delivery can be quite complex, but very efficient at the same time. The key elements in the value chain are the following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib1" title="">1</a>]</cite>:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Collect</span> In this first step the parcels are collected from the customers. In this process, the expectations of the customer have to be matched by timely pick-up and processing.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Sort</span> The second step is sorting and processing the parcels, based on destination and specific customer and consumer needs. An efficient sorting helps to ensure delivery to the right location on time.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Deliver</span> The final step is delivery, which is the moment of connection within the sender and receiver, and the final delivery of the parcel. As the delivery men are in each street in The Netherlands everyday, this gives space for additional societal services, like identifying loneliness in households and working together with charity organizations.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.SS1.p3">
<p class="ltx_p" id="S1.SS1.p3.1">The execution of these vital steps are heavily influenced by technological developments.
The digital transformation that PostNL is going through is an important initiative to stay on top of these innovations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib1" title="">1</a>]</cite>. Digitalisation helps in developing the core activities to provide smart E-commerce solutions to improve its competitive position. Logistics has developed from being a pure service providing activity, to becoming a key driver of digital and societal change. Technologies such as the Internet of Things (IoT), autonomous driving, big data and are inseparably intertwined with logistics. Recently, generative AI has emerged as another significant technology to contribute to advancements in this industry.</p>
</div>
</section>
<section class="ltx_subsection" id="S1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2 </span>Problem Statement</h3>
<div class="ltx_para" id="S1.SS2.p1">
<p class="ltx_p" id="S1.SS2.p1.1">The value chain of parcel delivery is described in the section above in a high-over and abstract way. However, the value chain is more complicated, depending on variables like customer and consumer preferences, the size of the parcel, the time of the year, the volume of parcels, which PostNL services are being executed and more. Throughout this process, logistic events are registered, also called ’waarnemingen’ in Dutch. These logistic events represent diverse situations that can appear based on the variables. The logistic events are a code starting with a letter followed by 2 numbers. There are 400 unique logistic events. These individual events together form logistic event sequences, which describe the journey of the parcel from the moment of acceptance in the PostNL network up to delivery. There is a lot of variation possible in these sequences, resulting in hundreds to thousand different sequence possibilities. For instance, a package with a specific barcode during its journey can exhibit the following sequence of ’waarnemingen’:</p>
</div>
<div class="ltx_para" id="S1.SS2.p2">
<table class="ltx_equationgroup ltx_eqn_table" id="S1.Ex1">
<tbody id="S1.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{[}A01,A98,A95,B01,G03,V06,A04,K50,B01,A96,J01,J40," class="ltx_Math" display="inline" id="S1.Ex1X.2.1.1.m1.1"><semantics id="S1.Ex1X.2.1.1.m1.1a"><mrow id="S1.Ex1X.2.1.1.m1.1.1.1"><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.12" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml"><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.cmml"><mtext id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2a.cmml">[</mtext><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.3.cmml">A</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1a" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.4" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.4.cmml">01</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.13" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.2.cmml">A</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.3.cmml">98</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.14" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.2.cmml">A</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.3.cmml">95</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.15" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.2.cmml">B</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.3.cmml">01</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.16" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.2.cmml">G</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.3.cmml">03</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.17" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.2.cmml">V</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.3.cmml">06</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.18" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.2.cmml">A</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.3.cmml">04</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.19" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.2.cmml">K</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.3.cmml">50</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.20" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.2.cmml">B</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.3.cmml">01</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.21" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.2.cmml">A</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.3.cmml">96</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.22" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.2.cmml">J</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.3.cmml">01</mn></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.23" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml">,</mo><mrow id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.cmml"><mi id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.2" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.2.cmml">J</mi><mo id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.1" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.1.cmml">⁢</mo><mn id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.3" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.3.cmml">40</mn></mrow></mrow><mo id="S1.Ex1X.2.1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex1X.2.1.1.m1.1b"><list id="S1.Ex1X.2.1.1.m1.1.1.1.1.13.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12"><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2a.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2"><mtext id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.2">[</mtext></ci><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.3">𝐴</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.4.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.1.1.4">01</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.2">𝐴</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.2.2.3">98</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.2">𝐴</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.3.3.3">95</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.2">𝐵</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.4.4.3">01</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.2">𝐺</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.5.5.3">03</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.2">𝑉</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.6.6.3">06</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.2">𝐴</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.7.7.3">04</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.2">𝐾</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.8.8.3">50</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.2">𝐵</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.9.9.3">01</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.2">𝐴</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.10.10.3">96</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.2">𝐽</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.11.11.3">01</cn></apply><apply id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12"><times id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.1.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.1"></times><ci id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.2.cmml" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.2">𝐽</ci><cn id="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.3.cmml" type="integer" xref="S1.Ex1X.2.1.1.m1.1.1.1.1.12.12.3">40</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex1X.2.1.1.m1.1c">\displaystyle\text{[}A01,A98,A95,B01,G03,V06,A04,K50,B01,A96,J01,J40,</annotation><annotation encoding="application/x-llamapun" id="S1.Ex1X.2.1.1.m1.1d">[ italic_A 01 , italic_A 98 , italic_A 95 , italic_B 01 , italic_G 03 , italic_V 06 , italic_A 04 , italic_K 50 , italic_B 01 , italic_A 96 , italic_J 01 , italic_J 40 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S1.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle A19,J05,A19,H01,J30,B01,J17,B01,J01,J01,J40,A19,A19,J05,I01\text%
{]}" class="ltx_Math" display="inline" id="S1.Ex1Xa.2.1.1.m1.15"><semantics id="S1.Ex1Xa.2.1.1.m1.15a"><mrow id="S1.Ex1Xa.2.1.1.m1.15.15.15" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml"><mrow id="S1.Ex1Xa.2.1.1.m1.1.1.1.1" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.2" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.2.cmml">A</mi><mo id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.1" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.3" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.3.cmml">19</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.16" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.2.2.2.2" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.2" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.1" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.3" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.3.cmml">05</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.17" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.3.3.3.3" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.2" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.2.cmml">A</mi><mo id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.1" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.3" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.3.cmml">19</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.18" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.4.4.4.4" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.2" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.2.cmml">H</mi><mo id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.1" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.3" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.3.cmml">01</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.19" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.5.5.5.5" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.2" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.1" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.3" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.3.cmml">30</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.20" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.6.6.6.6" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.2" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.2.cmml">B</mi><mo id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.1" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.3" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.3.cmml">01</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.21" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.7.7.7.7" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.2" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.1" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.3" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.3.cmml">17</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.22" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.8.8.8.8" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.2" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.2.cmml">B</mi><mo id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.1" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.3" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.3.cmml">01</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.23" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.9.9.9.9" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.2" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.1" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.3" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.3.cmml">01</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.24" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.10.10.10.10" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.2" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.1" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.3" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.3.cmml">01</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.25" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.11.11.11.11" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.2" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.1" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.3" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.3.cmml">40</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.26" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.12.12.12.12" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.2" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.2.cmml">A</mi><mo id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.1" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.3" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.3.cmml">19</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.27" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.13.13.13.13" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.2" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.2.cmml">A</mi><mo id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.1" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.3" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.3.cmml">19</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.28" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.14.14.14.14" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.2" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.2.cmml">J</mi><mo id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.1" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.3" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.3.cmml">05</mn></mrow><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.29" xref="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml">,</mo><mrow id="S1.Ex1Xa.2.1.1.m1.15.15.15.15" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.cmml"><mi id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.2" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.2.cmml">I</mi><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1.cmml">⁢</mo><mn id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.3" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.3.cmml">01</mn><mo id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1a" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1.cmml">⁢</mo><mtext id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4a.cmml">]</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex1Xa.2.1.1.m1.15b"><list id="S1.Ex1Xa.2.1.1.m1.15.15.16.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15"><apply id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1"><times id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.2">𝐴</ci><cn id="S1.Ex1Xa.2.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.1.1.1.1.3">19</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2"><times id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.2.2.2.2.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.2.2.2.2.3">05</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.cmml" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3"><times id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.2">𝐴</ci><cn id="S1.Ex1Xa.2.1.1.m1.3.3.3.3.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.3.3.3.3.3">19</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.cmml" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4"><times id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.2">𝐻</ci><cn id="S1.Ex1Xa.2.1.1.m1.4.4.4.4.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.4.4.4.4.3">01</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.cmml" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5"><times id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.5.5.5.5.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.5.5.5.5.3">30</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.cmml" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6"><times id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.2">𝐵</ci><cn id="S1.Ex1Xa.2.1.1.m1.6.6.6.6.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.6.6.6.6.3">01</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.cmml" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7"><times id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.7.7.7.7.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.7.7.7.7.3">17</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.cmml" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8"><times id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.2">𝐵</ci><cn id="S1.Ex1Xa.2.1.1.m1.8.8.8.8.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.8.8.8.8.3">01</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.cmml" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9"><times id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.9.9.9.9.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.9.9.9.9.3">01</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.cmml" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10"><times id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.10.10.10.10.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.10.10.10.10.3">01</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.cmml" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11"><times id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.11.11.11.11.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.11.11.11.11.3">40</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.cmml" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12"><times id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.2">𝐴</ci><cn id="S1.Ex1Xa.2.1.1.m1.12.12.12.12.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.12.12.12.12.3">19</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.cmml" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13"><times id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.2">𝐴</ci><cn id="S1.Ex1Xa.2.1.1.m1.13.13.13.13.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.13.13.13.13.3">19</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.cmml" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14"><times id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.2">𝐽</ci><cn id="S1.Ex1Xa.2.1.1.m1.14.14.14.14.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.14.14.14.14.3">05</cn></apply><apply id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15"><times id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.1"></times><ci id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.2.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.2">𝐼</ci><cn id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.3.cmml" type="integer" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.3">01</cn><ci id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4a.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4"><mtext id="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4.cmml" xref="S1.Ex1Xa.2.1.1.m1.15.15.15.15.4">]</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex1Xa.2.1.1.m1.15c">\displaystyle A19,J05,A19,H01,J30,B01,J17,B01,J01,J01,J40,A19,A19,J05,I01\text%
{]}</annotation><annotation encoding="application/x-llamapun" id="S1.Ex1Xa.2.1.1.m1.15d">italic_A 19 , italic_J 05 , italic_A 19 , italic_H 01 , italic_J 30 , italic_B 01 , italic_J 17 , italic_B 01 , italic_J 01 , italic_J 01 , italic_J 40 , italic_A 19 , italic_A 19 , italic_J 05 , italic_I 01 ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S1.SS2.p3">
<p class="ltx_p" id="S1.SS2.p3.1">Each code in the sequence above has a descriptive meaning and a contextual explanation. One challenge is the diverse combination of codes in sequences, where the presence or absence of a code can be due to a mistake in the logistical operational process.</p>
</div>
<div class="ltx_para" id="S1.SS2.p4">
<p class="ltx_p" id="S1.SS2.p4.1">Within PostNL there are logistic business experts who can interpret these sequences and explain it to others. They know the context of the operational process behind the events. Certain combinations of logistic events in sequences can imply implicit knowledge that can only be understood and explained by these experts. They also know the full meaning of a logistic event that might not be well documented. These experts use an internal system called ’Tracy’ where for the barcode of each parcel, you can look up the logistic events, along with description of the event, timestamps, where they happen (locations), source-system, and some customer and consumer information. For external communication with consumers on the status of the parcel, a small selection of these events are shared through the PostNL app notifications, through email or through the track-and-trace page on the PostNL website.</p>
</div>
<div class="ltx_para" id="S1.SS2.p5">
<p class="ltx_p" id="S1.SS2.p5.1">PostNL wants to see if Gen-AI can be used to make sense of these complex logistic event sequences in a easy to understand manner. You could say an elevated version of Tracy, with the name ’SuperTracy’. Such a system could be used internally for business use-cases, or externally for consumer facing communication about the status of the parcel.</p>
</div>
</section>
<section class="ltx_subsection" id="S1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.3 </span>Research Goal</h3>
<div class="ltx_para" id="S1.SS3.p1">
<p class="ltx_p" id="S1.SS3.p1.1">The goal of this research is to explore the potential for forming a dedicated approach towards generative AI research, development, and engineering at PostNL, by inspiring business stakeholders on its potential. There are several sub-goals that contribute to this:</p>
</div>
<div class="ltx_para" id="S1.SS3.p2">
<ol class="ltx_enumerate" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i1.p1.1.1">Exploring valuable business use-cases solved by Gen-AI:</span> In order to get dedication and interest of business stakeholders, it has to be shown that there are valuable use-cases that can be solved through Gen-AI. One of the use-cases is to improve the efficiency and accuracy of communication around parcel track and trace within the logistical ecosystem of PostNL through SuperTracy.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i2.p1.1.1">Using in-house solutions:</span> The MVP of SuperTracy is aimed to establish the viability of developing an entirely new in-house generative generative AI based system, eliminating reliance on external AI platforms like ChatGPT API’s or Amazon Bedrock services. Doing so will decrease the costs and make the usage of Generative AI more approachable.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i3.p1.1.1">Creating a MVP for the business stakeholders</span>: Showing the value of a Gen-AI based solution to a business problem, requires a MVP. This unfolds in having a technical sound product, but also an evaluation to show the value. The evaluation has to show that SuperTracy can mimic parcel experts at least, or even enhance the understanding of parcel journeys and effectively identify and communicate issues in the logistics and delivery processes. The MVP should be suitable to show to business stakeholders to see the value.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Literature Study</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Generative AI and ChatGPT</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Generative AI refers to a category of artificial intelligence algorithms that can generate new data or content that is similar to the data it was trained on. Unlike traditional AI, which typically focuses on identifying patterns and making decisions based on existing data, generative AI can create new, original content, such as text, images, music, and even code. This capability is powered by models such as Generative Adversarial Networks (GANs), Variational Autoencoders (VAEs), and transformer-based models like GPT (Generative Pre-trained Transformer). <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">ChatGPT is a notable example of a transformer-based generative AI model developed by OpenAI, which is specifically designed for conversational tasks. It has attracted worldwide attention for its capability of dealing with challenging language understanding and generation tasks in the form of conversations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib3" title="">3</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib4" title="">4</a>]</cite>. This has also inspired businesses to make use ChatGPT AI systems, as it can have various efficiency gains. ChatGPT can automate various business tasks such as content creation, customer service, and data analysis, leading to improved productivity and cost savings. Also the model’s ability to understand natural language and provide human-like responses can enhance customer engagement and satisfaction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib5" title="">5</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Transformer Architectures and Large Language Models</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The way ChatGPT works is through sophisticated natural language processing (NLP) techniques within massive computational infrastructures that result in the fluent human like responses. The workings of this rely on neural transformer models and Large Language Models (LLMs). Transformer based models are excellent at processing longer sequences of data–like text–by using self-attention processes that enable the model to focus on different areas of the input by learning long-range dependencies in text. Self-attention is a mechanism that allows the model to learn the importance of each word in the input sequence, regardless of its position <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">LLMs are constructed using the transformer architecture. LLMs are a type of AI model trained on massive amounts of text data to understand and generate human-like language. They have a large number of parameters, often in the billions, which enable them to capture intricate patterns in language. This scaling up has allowed LLMs to understand and generate text at a level comparable to humans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib4" title="">4</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">So transformers help the system focus on the important parts of the input text, understanding the context and meaning. LLMs use this understanding to predict and generate the next word in a sentence, making the conversation flow naturally.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Open-sourced and closed-sourced LLMs</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">ChatGPT is a closed-source general purpose-chatbot. The closed source LLMS are also called ’commercial’ or ’Proprietary’ LLMs. In general, closed-source LLM models perform well across diverse tasks, but they fail to capture in-depth domain-specific knowledge <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib7" title="">7</a>]</cite>. The same holds for other closed-source LLM models like other OpenAI GPT model families or Claude <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib8" title="">8</a>]</cite>. The usage of LLMs for specific use-cases can sometimes seem unattainable, due to the lack of transparency, high cost and energy consumption, usage limits, and adherence to terms of service.
The recent emergence of highly capable open-source LLMs such as LLAMA 3, T5, MADLAD, and GEMMA 2 allow researchers and practitioners at large to easily obtain, customize, and deploy LLMs in more diverse environments and for more diverse and specific use cases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib9" title="">9</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Making LLMs suitable for specific tasks through fine-tuning</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">There is a irresistible necessity from enterprises for fine-tuning LLMs to get them trained on proprietary domain knowledge. Fine-tuning is the process of continuing the training of an already pre-trained model on a new dataset that is typically smaller and task-specific <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib10" title="">10</a>]</cite>. This allows the model to adjust its weights and parameters to better fit the nuances of the new data and the specific requirements of the target task. Though there is an option to use OpenAI (open-source) models to solve most of the use-cases, there is a high demand for domain specific LLMs due to data privacy and pricing concerns as mentioned earlier. The data of an enterprise can stay on premise as the LLMs are also present on premise. In-house development ensures this. Fine-tuned LLMs provide quality and custom feel to the stakeholder and also has low latency in displaying the results.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib10" title="">10</a>]</cite></p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Making LLMS suitable for specific tasks through Retrieval Augmented Generation</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">When a LLM model that is not fine-tuned is used for domain specific tasks and asked to handle queries beyond its training data or current information, hallucinations can happen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib11" title="">11</a>]</cite>. As fine-tuning can be done to make LLMs suitable for specific use-cases, another approach next to or instead of fine-tuning can be to use Retrieval-Augmented Generation (RAG) architecture. RAG enhances LLMs by retrieving relevant document chunks (in real time) from external knowledge bases through semantic similarity calculation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib12" title="">12</a>]</cite>. So RAG retrieves additional data, and augments it to the existing knowledge of the LLM based on semantic similarity. In fine-tuning, the weights of the existing parameters of the LLM get adjusted to the learned knowledge, but vectors are not added. Therefore to keep the knowledge base updated, fine-tuning would be computationally expensive.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6 </span>Enhancing the input of an LLM-based systems through prompt engineering</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.1">The input that is given to an LLM is also important for the desired output. That input is also called a Prompt. Prompt engineering is the process of designing and refining input queries, or “prompts,” to elicit desired responses from LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib13" title="">13</a>]</cite>. In the literature, prompt engineering is usually explained in two different context. Prompt engineering can apply to how a user of an LLM based system can phrase its desired task to the model the best way<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib14" title="">14</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib15" title="">15</a>]</cite>, or prompt engineering can refer to the effective way of responding of the LLM-based system, which can be determined by the developer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib16" title="">16</a>]</cite>. In the latter case, various prompt engineering techniques are available to guide the model effectively. Well known methods are few-shot prompting, chain-of-thought prompting and self-consistency <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib16" title="">16</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7 </span>Enhancing the performance of LLM-based systems through Quantization</h3>
<div class="ltx_para" id="S2.SS7.p1">
<p class="ltx_p" id="S2.SS7.p1.1">The performance of open-source models depend on the hardware and the available computational resources that are being used. Significant challenges can be faced when attempting to leverage the full potential of transformer models in cases where memory or computational resources are limited. Because the advancements in transformer performance are accompanied by a corresponding increase in model size and computational costs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib17" title="">17</a>]</cite>. Floating-point post-training quantization techniques can be used to enable the compression of transformers to face the challenges of limited computational resources. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib18" title="">18</a>]</cite>. This approach enables the effective use of LLMs on hardware with constrained computational capabilities while maintaining the high quality of generative AI services. Additionally, it reduces the computational resources required for training and executing models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib19" title="">19</a>]</cite>, resulting in cost savings.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.8 </span>Logistic event prediction through sequence to sequence prediction by T5</h3>
<div class="ltx_para" id="S2.SS8.p1">
<p class="ltx_p" id="S2.SS8.p1.1">In the previous sections, the transformer architecture and LLMS like GPT-3 and GEMMA have been discussed. These models have demonstrated remarkable capabilities in various NLP tasks due to their ability to understand and generate human-like text. Transformer-based models are very versatile and diverse, making each of them suitable for different tasks. T5 (Text-to-Text-Transfer Transformer), developed
by Google, is a versatile language model that is trained in a ”text-to-text” framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib20" title="">20</a>]</cite>. The key innovation of T5 is the formulation of all tasks as text generation problems. This means that every task, including text classification, summarizing, translation, and question answering, is cast into a text-to-text format. For example, instead of training T5 to answer questions directly, it is trained to generate the complete answer given the question and relevant context. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib21" title="">21</a>]</cite></p>
</div>
<div class="ltx_para" id="S2.SS8.p2">
<p class="ltx_p" id="S2.SS8.p2.1">For the prediction of future logistic events in the sequence as shown in the Problem Statement, The T5 can be used. Transformers are highly suitable for this task due to their ability to handle sequential data and capture long-range dependencies through self-attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib22" title="">22</a>]</cite>. The T5 model excels in sequence prediction tasks and can be fine-tuned on specific datasets to improve accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib23" title="">23</a>]</cite>. Mathematically, the transformer architecture uses an encoder-decoder structure where both components utilize self-attention and feed-forward neural networks. The self-attention mechanism computes representations for each element in the sequence by considering the entire sequence context, enhancing the model’s capability to predict the most likely sequence of logistic event codes. This mechanism can be described by the attention function, which maps a query and a set of key-value pairs to an output, computed as a weighted sum of the values, where the weights are derived from the query and corresponding key <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.9 </span>LLMs and Multi-Agent systems</h3>
<div class="ltx_para" id="S2.SS9.p1">
<p class="ltx_p" id="S2.SS9.p1.1">So far various methods to make LLMs suitable for specific tasks have been discussed, such as fine-tuning and prompt engineering. As intelligent agents also focus on specific tasks, researchers have started to leverage LLMs to construct AI agents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib24" title="">24</a>]</cite>. LLMs can be employed as the brain or controller of these agents and expand their perceptual and action space. These LLM based agents can exhibit reasoning and planning abilities through earlier discussed prompt engineering techniques like Chain-of-Thought.</p>
</div>
<div class="ltx_para" id="S2.SS9.p2">
<p class="ltx_p" id="S2.SS9.p2.1">Based on the capabilities of the single LLM based agent, LLM-based Multi-Agents have been proposed to leverage the collective intelligence and specialized profiles and skills of multiple agents. Compared to systems using a single LLM-powered agent, multi-agent systems offer advanced capabilities by specializing LLMs into various distinct agents, each with different capabilities, and by enabling interactions among these diverse agents to simulate complex real-world environments effectively <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The Solution</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Data and knowledge Discovery</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To make LLMs suitable for domain specific tasks, the models have to be fine-tuned on relevant PostNL data. Several interviews have been done with experts of logistic events and data warehouse engineers to identify the existing datasets and to understand the operational process behind the data. Also the workings and background data of Tracy have been investigated. This resulted in the selection of appropriate datasets to build the solution with:</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Collo data:</span> The ’Collo’ dataset is a well known dataset in PostNL. It contains all the barcodes of parcels, along with all the logistic events that are registered throughout the journey of the parcel, from the moment of acceptance in the network up to delivery. This is an extensive data set, with 159 columns, with each row representing an event or the current state of a parcel.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Abbreviations:</span> Abbreviations are used a lot in PostNL, resulting in PostNL specific terminology which is widely used in documentation and other data. This dataset has a collection of abbreviations, along with a description and explanation. These abbreviations are also widely used throughout Collo columns and data entries.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">Waarnemingen:</span> This data set contains all the 400 unique ’waarnemingen’ or logistic events, along with a description of what each mean. Each Waarneming code of a parcel forms a row in Collo. Additionally, each code falls into either the internal or external category. The internal category indicates that this event is only visible for PostNL employees through Tracy for example. The external category indicates that the logistic event is being shared externally with customers. For example through the PostNL app or email.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">Location data:</span> The location master data set contains all the locations that PostNL does business on. Examples are warehouses, sorting centres, distributions centres, hubs and more.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS1.p2.1">For this project access to Tracy was provided. Tracy is the web-application containing all the data on parcels in real-time. Tracy ingests Collo data. Tracy has been used throughout the process to lookup some barcodes for tests. The combination of the mentioned data sources allowed for a meaningful interpretation of the main dataset, Collo.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Data Preparation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The datasets procured from the data warehouse were initially in a raw format, necessitating extensive data preparation prior to further analysis. The initial phase involved Exploratory Data Analysis (EDA), through which a comprehensive understanding of the dataset was developed. This was followed by the data preparation phase, outlined as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">Data Cleaning:</span> This process addressed issues such as missing values and duplication of data points to ensure the integrity of the dataset.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">Statistical Analysis:</span> Statistical summaries were performed to examine the distribution, mean, median, mode, and variance of the data. This analysis was critical for understanding the underlying patterns and anomalies within the dataset.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.1.1">Data Transformation:</span></p>
<ul class="ltx_itemize" id="S3.I2.i3.I1">
<li class="ltx_item" id="S3.I2.i3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.I1.i1.1.1.1">–</span></span>
<div class="ltx_para" id="S3.I2.i3.I1.i1.p1">
<p class="ltx_p" id="S3.I2.i3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.I1.i1.p1.1.1">Language Standardization:</span> Translated 132 columns of logistic parcel data from Dutch to English to establish a uniform language baseline essential for subsequent project implementation.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.I1.i2.1.1.1">–</span></span>
<div class="ltx_para" id="S3.I2.i3.I1.i2.p1">
<p class="ltx_p" id="S3.I2.i3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.I1.i2.p1.1.1">Normalization and Cleansing:</span> This step involved both normalizing and cleansing the textual data to enhance its suitability for analysis. Normalization tasks included case conversion to minimize case sensitivity issues and tokenization to structure the text into usable segments. Concurrently, the data was cleansed by removing punctuation and special characters to prevent potential data processing errors. These processes together ensured that the textual data was not only uniform but also clean and optimized for subsequent analytical tasks.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i4.p1">
<p class="ltx_p" id="S3.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i4.p1.1.1">Data Splitting:</span> The dataset was segmented into training, validation, and test sets to support the development of robust predictive models.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">These preparatory steps were instrumental in ensuring that the data was aptly conditioned for the sophisticated analyses and modeling that followed.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model design</h3>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Expected model output</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">The first step of design thinking <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib26" title="">26</a>]</cite> is to understand the problem, and then have clear what the concept of the solution can be. So to understand what kind of output is expected. This was achieved by discussions with domain experts, creating a shared agreement on the possible expected outcomes of the final system. The agreed goal of the system is to simulate the comprehension and narration abilities of a logistic domain experts at PostNL, who answers in a user friendly and helpful manner.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Overall Model design</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">To achieve the goals stated in section 1.3, a solution is proposed building upon the findings of the literature study in section 2. The final solution is SuperTracy, a multi-agent LLM based system, leveraging open-source LLM models like GEMMA 2 and LLAMA 3 to make sure the company data is on premise and safe. Prompt engineering has been applied to direct the agents to a specific behaviour and output style. This solution is further fine-tuned on relevant datasets to make it suitable for specific use-cases. The system is build upon the RAG-architecture, such that hallucination is prevented and realtime data can be used. Also the solution is quantized, to make sure it can be run on modest hardware. The final solution contains different models and modules like logistic event prediction and translation to different languages for extra features.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>language detection and translation</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">LLMs already have the capability to ’speak’ in different langauges, but the performance is limited for some languages <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib27" title="">27</a>]</cite>. In order for an LLM based system to function, the instructions through prompt engineering are necessary. These prompt engineering templates need to be in the same language as the destination language. As the templates are designed by the developer, they are predefined. For this solution, the prompt templates are available in English and Dutch. But if another language is desired, the templates need to be translated. To do this first the language has to be detected from the user input, and then translation can happen. The CLD3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib28" title="">28</a>]</cite> neural network detects the language of the user input. As mentioned earlier in the literature review, T5 models are suitable for translation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib20" title="">20</a>]</cite>. The MADLAD model, which is a variation of the T5 model, is employed for text-to-text translation of the templates.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.4 </span>Logistic event prediction</h4>
<div class="ltx_para" id="S3.SS3.SSS4.p1">
<p class="ltx_p" id="S3.SS3.SSS4.p1.1">On the moment of data retrieval, not all the ’waarnemingen’ codes for parcels were complete, as some parcels were still in progress and their final code had not been generated yet. To explore LLMs for sequence-to-sequence problems, the T5 model is used to predict the most likely sequence of ’waarnemingen’ codes to make up for the absence of the end state of the journey. By using this strategy, we can predict the future states of parcels. If a ’waarnemingen’ code indicates a problem, we can anticipate which combinations of ’waarnemingen’ codes will occur so that pro-active communication can take place. This allows us to complete the entire sequence of ’waarnemingen’ codes and estimate the final stage of the parcels’ journeys. In the generated output it will be stated what the prediction is.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p2">
<p class="ltx_p" id="S3.SS3.SSS4.p2.2">Given an input sequence of ’waarnemingen’ codes <math alttext="X=[x_{1},x_{2},\ldots,x_{n}]" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p2.1.m1.4"><semantics id="S3.SS3.SSS4.p2.1.m1.4a"><mrow id="S3.SS3.SSS4.p2.1.m1.4.4" xref="S3.SS3.SSS4.p2.1.m1.4.4.cmml"><mi id="S3.SS3.SSS4.p2.1.m1.4.4.5" xref="S3.SS3.SSS4.p2.1.m1.4.4.5.cmml">X</mi><mo id="S3.SS3.SSS4.p2.1.m1.4.4.4" xref="S3.SS3.SSS4.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS4.p2.1.m1.4.4.3.3" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.5" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.2.cmml">x</mi><mn id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.6" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS4.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS4.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.7" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.2" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.2.cmml">x</mi><mi id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.3" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p2.1.m1.4b"><apply id="S3.SS3.SSS4.p2.1.m1.4.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4"><eq id="S3.SS3.SSS4.p2.1.m1.4.4.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.4"></eq><ci id="S3.SS3.SSS4.p2.1.m1.4.4.5.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.5">𝑋</ci><list id="S3.SS3.SSS4.p2.1.m1.4.4.3.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3"><apply id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS4.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.2">𝑥</ci><cn id="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS4.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS4.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.1.1">…</ci><apply id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.2">𝑥</ci><ci id="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS4.p2.1.m1.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p2.1.m1.4c">X=[x_{1},x_{2},\ldots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p2.1.m1.4d">italic_X = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, where each <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p2.2.m2.1"><semantics id="S3.SS3.SSS4.p2.2.m2.1a"><msub id="S3.SS3.SSS4.p2.2.m2.1.1" xref="S3.SS3.SSS4.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS4.p2.2.m2.1.1.2" xref="S3.SS3.SSS4.p2.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS4.p2.2.m2.1.1.3" xref="S3.SS3.SSS4.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p2.2.m2.1b"><apply id="S3.SS3.SSS4.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS4.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS4.p2.2.m2.1.1.2">𝑥</ci><ci id="S3.SS3.SSS4.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS4.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p2.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents a specific code (e.g., ”A01”, ”A98”), the goal is to predict the most likely next code in the sequence. Each ’waarnemingen’ code is converted into a dense vector representation through an embedding layer. The self-attention mechanism computes the attention scores for each pair of codes in the sequence to capture their relationships:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
\mathbf{Q}\mathbf{K}^{T}}{\sqrt{d_{k}}}\right)\mathbf{V}" class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mrow id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml"><mtext id="S3.E1.m1.4.5.2.2" xref="S3.E1.m1.4.5.2.2a.cmml">Attention</mtext><mo id="S3.E1.m1.4.5.2.1" xref="S3.E1.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.4.5.2.3.2" xref="S3.E1.m1.4.5.2.3.1.cmml"><mo id="S3.E1.m1.4.5.2.3.2.1" stretchy="false" xref="S3.E1.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐐</mi><mo id="S3.E1.m1.4.5.2.3.2.2" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐊</mi><mo id="S3.E1.m1.4.5.2.3.2.3" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝐕</mi><mo id="S3.E1.m1.4.5.2.3.2.4" stretchy="false" xref="S3.E1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml"><mtext id="S3.E1.m1.4.5.3.2" xref="S3.E1.m1.4.5.3.2a.cmml">softmax</mtext><mo id="S3.E1.m1.4.5.3.1" xref="S3.E1.m1.4.5.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.4.5.3.3.2" xref="S3.E1.m1.4.4.cmml"><mo id="S3.E1.m1.4.5.3.3.2.1" xref="S3.E1.m1.4.4.cmml">(</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><msup id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">𝐐𝐊</mi><mi id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml">T</mi></msup><msqrt id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><msub id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml"><mi id="S3.E1.m1.4.4.3.2.2" xref="S3.E1.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E1.m1.4.4.3.2.3" xref="S3.E1.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E1.m1.4.5.3.3.2.2" xref="S3.E1.m1.4.4.cmml">)</mo></mrow><mo id="S3.E1.m1.4.5.3.1a" xref="S3.E1.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.E1.m1.4.5.3.4" xref="S3.E1.m1.4.5.3.4.cmml">𝐕</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><apply id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2"><times id="S3.E1.m1.4.5.2.1.cmml" xref="S3.E1.m1.4.5.2.1"></times><ci id="S3.E1.m1.4.5.2.2a.cmml" xref="S3.E1.m1.4.5.2.2"><mtext id="S3.E1.m1.4.5.2.2.cmml" xref="S3.E1.m1.4.5.2.2">Attention</mtext></ci><vector id="S3.E1.m1.4.5.2.3.1.cmml" xref="S3.E1.m1.4.5.2.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐐</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐊</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"><times id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.5.3.1"></times><ci id="S3.E1.m1.4.5.3.2a.cmml" xref="S3.E1.m1.4.5.3.2"><mtext id="S3.E1.m1.4.5.3.2.cmml" xref="S3.E1.m1.4.5.3.2">softmax</mtext></ci><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.5.3.3.2"><divide id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.5.3.3.2"></divide><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2">superscript</csymbol><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝐐𝐊</ci><ci id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3">𝑇</ci></apply><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><root id="S3.E1.m1.4.4.3a.cmml" xref="S3.E1.m1.4.4.3"></root><apply id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.2.1.cmml" xref="S3.E1.m1.4.4.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.3.2.2.cmml" xref="S3.E1.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E1.m1.4.4.3.2.3.cmml" xref="S3.E1.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E1.m1.4.5.3.4.cmml" xref="S3.E1.m1.4.5.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
\mathbf{Q}\mathbf{K}^{T}}{\sqrt{d_{k}}}\right)\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">Attention ( bold_Q , bold_K , bold_V ) = softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) bold_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p4">
<p class="ltx_p" id="S3.SS3.SSS4.p4.1">Multiple self-attention mechanisms (heads) capture different aspects of the relationships:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MultiHead}(\mathbf{Q},\mathbf{K},\mathbf{V})=[\text{head}_{1};\text{head%
}_{2};\ldots;\text{head}_{h}]\mathbf{W}_{O}" class="ltx_Math" display="block" id="S3.E2.m1.7"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><mrow id="S3.E2.m1.7.7.5" xref="S3.E2.m1.7.7.5.cmml"><mtext id="S3.E2.m1.7.7.5.2" xref="S3.E2.m1.7.7.5.2a.cmml">MultiHead</mtext><mo id="S3.E2.m1.7.7.5.1" xref="S3.E2.m1.7.7.5.1.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.5.3.2" xref="S3.E2.m1.7.7.5.3.1.cmml"><mo id="S3.E2.m1.7.7.5.3.2.1" stretchy="false" xref="S3.E2.m1.7.7.5.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐐</mi><mo id="S3.E2.m1.7.7.5.3.2.2" xref="S3.E2.m1.7.7.5.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝐊</mi><mo id="S3.E2.m1.7.7.5.3.2.3" xref="S3.E2.m1.7.7.5.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐕</mi><mo id="S3.E2.m1.7.7.5.3.2.4" stretchy="false" xref="S3.E2.m1.7.7.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.4" xref="S3.E2.m1.7.7.4.cmml">=</mo><mrow id="S3.E2.m1.7.7.3" xref="S3.E2.m1.7.7.3.cmml"><mrow id="S3.E2.m1.7.7.3.3.3" xref="S3.E2.m1.7.7.3.3.4.cmml"><mo id="S3.E2.m1.7.7.3.3.3.4" stretchy="false" xref="S3.E2.m1.7.7.3.3.4.cmml">[</mo><msub id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><mtext id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E2.m1.5.5.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.7.7.3.3.3.5" xref="S3.E2.m1.7.7.3.3.4.cmml">;</mo><msub id="S3.E2.m1.6.6.2.2.2.2" xref="S3.E2.m1.6.6.2.2.2.2.cmml"><mtext id="S3.E2.m1.6.6.2.2.2.2.2" xref="S3.E2.m1.6.6.2.2.2.2.2a.cmml">head</mtext><mn id="S3.E2.m1.6.6.2.2.2.2.3" xref="S3.E2.m1.6.6.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E2.m1.7.7.3.3.3.6" xref="S3.E2.m1.7.7.3.3.4.cmml">;</mo><mi id="S3.E2.m1.4.4" mathvariant="normal" xref="S3.E2.m1.4.4.cmml">…</mi><mo id="S3.E2.m1.7.7.3.3.3.7" xref="S3.E2.m1.7.7.3.3.4.cmml">;</mo><msub id="S3.E2.m1.7.7.3.3.3.3" xref="S3.E2.m1.7.7.3.3.3.3.cmml"><mtext id="S3.E2.m1.7.7.3.3.3.3.2" xref="S3.E2.m1.7.7.3.3.3.3.2a.cmml">head</mtext><mi id="S3.E2.m1.7.7.3.3.3.3.3" xref="S3.E2.m1.7.7.3.3.3.3.3.cmml">h</mi></msub><mo id="S3.E2.m1.7.7.3.3.3.8" stretchy="false" xref="S3.E2.m1.7.7.3.3.4.cmml">]</mo></mrow><mo id="S3.E2.m1.7.7.3.4" xref="S3.E2.m1.7.7.3.4.cmml">⁢</mo><msub id="S3.E2.m1.7.7.3.5" xref="S3.E2.m1.7.7.3.5.cmml"><mi id="S3.E2.m1.7.7.3.5.2" xref="S3.E2.m1.7.7.3.5.2.cmml">𝐖</mi><mi id="S3.E2.m1.7.7.3.5.3" xref="S3.E2.m1.7.7.3.5.3.cmml">O</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.4.cmml" xref="S3.E2.m1.7.7.4"></eq><apply id="S3.E2.m1.7.7.5.cmml" xref="S3.E2.m1.7.7.5"><times id="S3.E2.m1.7.7.5.1.cmml" xref="S3.E2.m1.7.7.5.1"></times><ci id="S3.E2.m1.7.7.5.2a.cmml" xref="S3.E2.m1.7.7.5.2"><mtext id="S3.E2.m1.7.7.5.2.cmml" xref="S3.E2.m1.7.7.5.2">MultiHead</mtext></ci><vector id="S3.E2.m1.7.7.5.3.1.cmml" xref="S3.E2.m1.7.7.5.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐐</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐊</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E2.m1.7.7.3.cmml" xref="S3.E2.m1.7.7.3"><times id="S3.E2.m1.7.7.3.4.cmml" xref="S3.E2.m1.7.7.3.4"></times><list id="S3.E2.m1.7.7.3.3.4.cmml" xref="S3.E2.m1.7.7.3.3.3"><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.2a.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><mtext id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">head</mtext></ci><cn id="S3.E2.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.5.5.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.6.6.2.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.2.2.2.2.2a.cmml" xref="S3.E2.m1.6.6.2.2.2.2.2"><mtext id="S3.E2.m1.6.6.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2.2.2">head</mtext></ci><cn id="S3.E2.m1.6.6.2.2.2.2.3.cmml" type="integer" xref="S3.E2.m1.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">…</ci><apply id="S3.E2.m1.7.7.3.3.3.3.cmml" xref="S3.E2.m1.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.3.3.3.1.cmml" xref="S3.E2.m1.7.7.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.7.7.3.3.3.3.2a.cmml" xref="S3.E2.m1.7.7.3.3.3.3.2"><mtext id="S3.E2.m1.7.7.3.3.3.3.2.cmml" xref="S3.E2.m1.7.7.3.3.3.3.2">head</mtext></ci><ci id="S3.E2.m1.7.7.3.3.3.3.3.cmml" xref="S3.E2.m1.7.7.3.3.3.3.3">ℎ</ci></apply></list><apply id="S3.E2.m1.7.7.3.5.cmml" xref="S3.E2.m1.7.7.3.5"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.5.1.cmml" xref="S3.E2.m1.7.7.3.5">subscript</csymbol><ci id="S3.E2.m1.7.7.3.5.2.cmml" xref="S3.E2.m1.7.7.3.5.2">𝐖</ci><ci id="S3.E2.m1.7.7.3.5.3.cmml" xref="S3.E2.m1.7.7.3.5.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\text{MultiHead}(\mathbf{Q},\mathbf{K},\mathbf{V})=[\text{head}_{1};\text{head%
}_{2};\ldots;\text{head}_{h}]\mathbf{W}_{O}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.7d">MultiHead ( bold_Q , bold_K , bold_V ) = [ head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; head start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; … ; head start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ] bold_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p6">
<p class="ltx_p" id="S3.SS3.SSS4.p6.1">The output of the multi-head attention is passed through a position-wise feed-forward neural network to introduce non-linearity:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FFN}(\mathbf{x})=\max(0,\mathbf{x}\mathbf{W}_{1}+\mathbf{b}_{1})\mathbf{%
W}_{2}+\mathbf{b}_{2}" class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml"><mtext id="S3.E3.m1.4.4.3.2" xref="S3.E3.m1.4.4.3.2a.cmml">FFN</mtext><mo id="S3.E3.m1.4.4.3.1" xref="S3.E3.m1.4.4.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.3.3.2" xref="S3.E3.m1.4.4.3.cmml"><mo id="S3.E3.m1.4.4.3.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐱</mi><mo id="S3.E3.m1.4.4.3.3.2.2" stretchy="false" xref="S3.E3.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml">=</mo><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">max</mi><mo id="S3.E3.m1.4.4.1.1.1.1a" xref="S3.E3.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.2.cmml">(</mo><mn id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">0</mn><mo id="S3.E3.m1.4.4.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.2.cmml">,</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.4.4.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝐱𝐖</mi><mn id="S3.E3.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.4.4.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E3.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.E3.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">⁢</mo><msub id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml">𝐖</mi><mn id="S3.E3.m1.4.4.1.1.3.3" xref="S3.E3.m1.4.4.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.2.cmml">+</mo><msub id="S3.E3.m1.4.4.1.3" xref="S3.E3.m1.4.4.1.3.cmml"><mi id="S3.E3.m1.4.4.1.3.2" xref="S3.E3.m1.4.4.1.3.2.cmml">𝐛</mi><mn id="S3.E3.m1.4.4.1.3.3" xref="S3.E3.m1.4.4.1.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><eq id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"></eq><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"><times id="S3.E3.m1.4.4.3.1.cmml" xref="S3.E3.m1.4.4.3.1"></times><ci id="S3.E3.m1.4.4.3.2a.cmml" xref="S3.E3.m1.4.4.3.2"><mtext id="S3.E3.m1.4.4.3.2.cmml" xref="S3.E3.m1.4.4.3.2">FFN</mtext></ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐱</ci></apply><apply id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.4.1"><plus id="S3.E3.m1.4.4.1.2.cmml" xref="S3.E3.m1.4.4.1.2"></plus><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1"><times id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"></times><apply id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1"><max id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"></max><cn id="S3.E3.m1.3.3.cmml" type="integer" xref="S3.E3.m1.3.3">0</cn><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1"><plus id="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.2">𝐱𝐖</ci><cn id="S3.E3.m1.4.4.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.2">𝐛</ci><cn id="S3.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2">𝐖</ci><cn id="S3.E3.m1.4.4.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.3.3">2</cn></apply></apply><apply id="S3.E3.m1.4.4.1.3.cmml" xref="S3.E3.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.3.1.cmml" xref="S3.E3.m1.4.4.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.3.2.cmml" xref="S3.E3.m1.4.4.1.3.2">𝐛</ci><cn id="S3.E3.m1.4.4.1.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\text{FFN}(\mathbf{x})=\max(0,\mathbf{x}\mathbf{W}_{1}+\mathbf{b}_{1})\mathbf{%
W}_{2}+\mathbf{b}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">FFN ( bold_x ) = roman_max ( 0 , bold_xW start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p8">
<p class="ltx_p" id="S3.SS3.SSS4.p8.1">Finally, the transformer’s decoder predicts the next ’waarnemingen’ code by applying a softmax layer over the vocabulary of possible codes:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(x_{n+1}|x_{1},x_{2},\ldots,x_{n})=\text{softmax}(\mathbf{h}_{n}\mathbf{W}_{O%
}+\mathbf{b}_{O})" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.cmml"><mi id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.2.2.1.3.cmml">P</mi><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mo id="S3.E4.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.1.1.5.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.5.2" xref="S3.E4.m1.2.2.1.1.1.1.5.2.cmml">x</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.5.3" xref="S3.E4.m1.2.2.1.1.1.1.5.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.5.3.2" xref="S3.E4.m1.2.2.1.1.1.1.5.3.2.cmml">n</mi><mo id="S3.E4.m1.2.2.1.1.1.1.5.3.1" xref="S3.E4.m1.2.2.1.1.1.1.5.3.1.cmml">+</mo><mn id="S3.E4.m1.2.2.1.1.1.1.5.3.3" xref="S3.E4.m1.2.2.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E4.m1.2.2.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.4.cmml">|</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.4.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.2.2.1.1.1.1.3.3.4" xref="S3.E4.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.2.cmml">x</mi><mn id="S3.E4.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E4.m1.2.2.1.1.1.1.3.3.5" xref="S3.E4.m1.2.2.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E4.m1.1.1" mathvariant="normal" xref="S3.E4.m1.1.1.cmml">…</mi><mo id="S3.E4.m1.2.2.1.1.1.1.3.3.6" xref="S3.E4.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.1.1.3.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.3.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S3.E4.m1.2.2.1.1.1.1.3.3.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="S3.E4.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mtext id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3a.cmml">softmax</mtext><mo id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.2.1.1" xref="S3.E4.m1.3.3.2.1.1.1.cmml"><mo id="S3.E4.m1.3.3.2.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.2.1.1.1" xref="S3.E4.m1.3.3.2.1.1.1.cmml"><mrow id="S3.E4.m1.3.3.2.1.1.1.2" xref="S3.E4.m1.3.3.2.1.1.1.2.cmml"><msub id="S3.E4.m1.3.3.2.1.1.1.2.2" xref="S3.E4.m1.3.3.2.1.1.1.2.2.cmml"><mi id="S3.E4.m1.3.3.2.1.1.1.2.2.2" xref="S3.E4.m1.3.3.2.1.1.1.2.2.2.cmml">𝐡</mi><mi id="S3.E4.m1.3.3.2.1.1.1.2.2.3" xref="S3.E4.m1.3.3.2.1.1.1.2.2.3.cmml">n</mi></msub><mo id="S3.E4.m1.3.3.2.1.1.1.2.1" xref="S3.E4.m1.3.3.2.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E4.m1.3.3.2.1.1.1.2.3" xref="S3.E4.m1.3.3.2.1.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.2.1.1.1.2.3.2" xref="S3.E4.m1.3.3.2.1.1.1.2.3.2.cmml">𝐖</mi><mi id="S3.E4.m1.3.3.2.1.1.1.2.3.3" xref="S3.E4.m1.3.3.2.1.1.1.2.3.3.cmml">O</mi></msub></mrow><mo id="S3.E4.m1.3.3.2.1.1.1.1" xref="S3.E4.m1.3.3.2.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.3.3.2.1.1.1.3" xref="S3.E4.m1.3.3.2.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.2.1.1.1.3.2" xref="S3.E4.m1.3.3.2.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E4.m1.3.3.2.1.1.1.3.3" xref="S3.E4.m1.3.3.2.1.1.1.3.3.cmml">O</mi></msub></mrow><mo id="S3.E4.m1.3.3.2.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"></eq><apply id="S3.E4.m1.2.2.1.cmml" xref="S3.E4.m1.2.2.1"><times id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.2"></times><ci id="S3.E4.m1.2.2.1.3.cmml" xref="S3.E4.m1.2.2.1.3">𝑃</ci><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4">conditional</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2">𝑥</ci><apply id="S3.E4.m1.2.2.1.1.1.1.5.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.3"><plus id="S3.E4.m1.2.2.1.1.1.1.5.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.3.1"></plus><ci id="S3.E4.m1.2.2.1.1.1.1.5.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.3.2">𝑛</ci><cn id="S3.E4.m1.2.2.1.1.1.1.5.3.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.5.3.3">1</cn></apply></apply><list id="S3.E4.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2">𝑥</ci><cn id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.2">𝑥</ci><cn id="S3.E4.m1.2.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">…</ci><apply id="S3.E4.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S3.E4.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.3">𝑛</ci></apply></list></apply></apply><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><times id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2"></times><ci id="S3.E4.m1.3.3.2.3a.cmml" xref="S3.E4.m1.3.3.2.3"><mtext id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3">softmax</mtext></ci><apply id="S3.E4.m1.3.3.2.1.1.1.cmml" xref="S3.E4.m1.3.3.2.1.1"><plus id="S3.E4.m1.3.3.2.1.1.1.1.cmml" xref="S3.E4.m1.3.3.2.1.1.1.1"></plus><apply id="S3.E4.m1.3.3.2.1.1.1.2.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2"><times id="S3.E4.m1.3.3.2.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.1"></times><apply id="S3.E4.m1.3.3.2.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.1.1.1.2.2.1.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.2.1.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.2.2">𝐡</ci><ci id="S3.E4.m1.3.3.2.1.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.2.3">𝑛</ci></apply><apply id="S3.E4.m1.3.3.2.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.1.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.3.3.2.1.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.3.2">𝐖</ci><ci id="S3.E4.m1.3.3.2.1.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.2.1.1.1.2.3.3">𝑂</ci></apply></apply><apply id="S3.E4.m1.3.3.2.1.1.1.3.cmml" xref="S3.E4.m1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.2.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.2.1.1.1.3.2">𝐛</ci><ci id="S3.E4.m1.3.3.2.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.2.1.1.1.3.3">𝑂</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">P(x_{n+1}|x_{1},x_{2},\ldots,x_{n})=\text{softmax}(\mathbf{h}_{n}\mathbf{W}_{O%
}+\mathbf{b}_{O})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_P ( italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = softmax ( bold_h start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p10">
<p class="ltx_p" id="S3.SS3.SSS4.p10.1">Using these mathematical formulations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib22" title="">22</a>]</cite>, the T5 model processes the input sequence of ’waarnemingen’ codes, capturing dependencies and predicting the most likely subsequent codes, thereby allowing us to anticipate future states and resolve issues in parcel transportation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib29" title="">29</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.5 </span>Fine-tuning LLAMA</h4>
<div class="ltx_para" id="S3.SS3.SSS5.p1">
<p class="ltx_p" id="S3.SS3.SSS5.p1.1">LLAMA focuses on the main expected task of the solution: describing the journey of a specific barcode based on its associated data dependencies. In this step the advanced capabilities of the latest open-source LLM, specifically the LLAMA 3 model developed by Meta <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib30" title="">30</a>]</cite> are leveraged. The objective is to fine-tune this model using the prepared training datasets as described in 3.1.
The training dataset was constructed following the Alpaca-style methodology<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib31" title="">31</a>]</cite>, where synthetic data is generated to mimic real-world scenarios. This methodology involves structuring data in a specific format that consists of an instruction, contextual input, and the model’s expected response. For example, the training set schema looks like this:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS5.p2">
<div class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing" id="S3.SS3.SSS5.p2.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,CmFscGFjYV90cmFpbmluZ19zY2hlbWEgPSAiIiJCZWxvdyBpcyBhbiBpbnN0cnVjdGlvbiB0aGF0IGRlc2NyaWJlcyBhIHRhc2ssIHBhaXJlZCB3aXRoIGFuIGlucHV0IHRoYXQgcHJvdmlkZXMgZnVydGhlciBjb250ZXh0LiBXcml0ZSBhIHJlc3BvbnNlIHRoYXQgYXBwcm9wcmlhdGVseSBjb21wbGV0ZXMgdGhlIHJlcXVlc3QuCiMjIyBJbnN0cnVjdGlvbjoKe0Rlc2NyaWJlIHRoZSBrZXkgZXZlbnRzIGluIHRoZSBwYWNrYWdlJ3Mgam91cm5leSBmcm9tIHNlbmRlciB0byByZWNlaXZlciwgZm9jdXNpbmcgb24gY3J1Y2lhbCBtb21lbnRzLn0KIyMjIElucHV0Ogp7VHJhY2tpbmcgZGV0YWlscyBpbmRpY2F0aW5nIHRpbWVzLCBsb2NhdGlvbnMsIGFuZCBzdGF0dXNlcy4KfQojIyMgUmVzcG9uc2U6CntBIGNvbmNpc2UgbmFycmF0aXZlIHN1bW1hcml6aW5nIHRoZSBwYWNrYWdlcyBqb3VybmV5LCBoaWdobGlnaHRpbmcgaW1wb3J0YW50IHRyYW5zaXRpb25zIGFuZCB1cGRhdGVzLgp9IiIi">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.1" style="font-size:90%;">alpaca_training_schema</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.3" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx2.5" style="font-size:90%;color:#9400D1;">""</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx2.6" style="font-size:90%;color:#9400D1;">"Below<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.1"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.2"> </span>an<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.3"> </span>instruction<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.4"> </span>that<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.5"> </span>describes<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.6"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.7"> </span>task,<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.8"> </span>paired<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.9"> </span>with<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.10"> </span>an<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.11"> </span>input<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.12"> </span>that<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.13"> </span>provides<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.14"> </span>further<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.15"> </span>context.<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.16"> </span>Write<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.17"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.18"> </span>response<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.19"> </span>that<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.20"> </span>appropriately<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.21"> </span>completes<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.22"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx2.6.23"> </span>request.</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx3.1" style="font-size:90%;color:#9400D1;">###</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.3" style="font-size:90%;color:#9400D1;">Instruction:</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx4.1" style="font-size:90%;color:#9400D1;">{Describe</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.3" style="font-size:90%;color:#9400D1;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.4" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.5" style="font-size:90%;color:#9400D1;">key</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.6" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.7" style="font-size:90%;color:#9400D1;">events</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.8" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.9" style="font-size:90%;color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.10" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.11" style="font-size:90%;color:#9400D1;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.12" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.13" style="font-size:90%;color:#9400D1;">package’s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.14" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.15" style="font-size:90%;color:#9400D1;">journey</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.16" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.17" style="font-size:90%;color:#9400D1;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.18" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.19" style="font-size:90%;color:#9400D1;">sender</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.20" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.21" style="font-size:90%;color:#9400D1;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.22" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.23" style="font-size:90%;color:#9400D1;">receiver,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.24" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.25" style="font-size:90%;color:#9400D1;">focusing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.26" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.27" style="font-size:90%;color:#9400D1;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.28" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.29" style="font-size:90%;color:#9400D1;">crucial</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.30" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.31" style="font-size:90%;color:#9400D1;">moments.}</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx5.1" style="font-size:90%;color:#9400D1;">###</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.3" style="font-size:90%;color:#9400D1;">Input:</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx6.1" style="font-size:90%;color:#9400D1;">{Tracking</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.3" style="font-size:90%;color:#9400D1;">details</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.4" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.5" style="font-size:90%;color:#9400D1;">indicating</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.6" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.7" style="font-size:90%;color:#9400D1;">times,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.8" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.9" style="font-size:90%;color:#9400D1;">locations,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.10" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.11" style="font-size:90%;color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.12" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.13" style="font-size:90%;color:#9400D1;">statuses.</span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx7.1" style="font-size:90%;color:#9400D1;">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx8.1" style="font-size:90%;color:#9400D1;">###</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.3" style="font-size:90%;color:#9400D1;">Response:</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx9.1" style="font-size:90%;color:#9400D1;">{A</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.3" style="font-size:90%;color:#9400D1;">concise</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.4" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.5" style="font-size:90%;color:#9400D1;">narrative</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.6" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.7" style="font-size:90%;color:#9400D1;">summarizing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.8" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.9" style="font-size:90%;color:#9400D1;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.10" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.11" style="font-size:90%;color:#9400D1;">packages</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.12" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.13" style="font-size:90%;color:#9400D1;">journey,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.14" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.15" style="font-size:90%;color:#9400D1;">highlighting</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.16" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.17" style="font-size:90%;color:#9400D1;">important</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.18" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.19" style="font-size:90%;color:#9400D1;">transitions</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.20" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.21" style="font-size:90%;color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.22" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.23" style="font-size:90%;color:#9400D1;">updates.</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx10.1" style="font-size:90%;color:#9400D1;">}"</span><span class="ltx_text ltx_lst_string" id="lstnumberx10.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.3" style="font-size:90%;color:#9400D1;">""</span>
</div>
</div>
</div>
<div class="ltx_para" id="S3.SS3.SSS5.p3">
<p class="ltx_p" id="S3.SS3.SSS5.p3.1">This structured approach allows us to create a high-quality, domain-specific training dataset without extensive manual annotation, typically required. By integrating these training datasets, the LLAMA model not only retains its comprehensive linguistic comprehension but also gains specialized knowledge crucial for interpreting parcel statuses and journeys effectively.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS5.p4">
<p class="ltx_p" id="S3.SS3.SSS5.p4.1">Fine-tuning the LLAMA 3 model with our enriched dataset is executed using the Hugging Face Supervised Fine-tuning Trainer<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib32" title="">32</a>]</cite>. The optimization objective is to minimize the loss function over the training data, typically using cross-entropy loss for language models:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS5.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\theta)=\frac{1}{N}\sum_{i=1}^{N}\mathcal{L}(\hat{y}_{i},y_{i})" class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.4" xref="S3.E5.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.4.2" xref="S3.E5.m1.3.3.4.2.cmml">ℒ</mi><mo id="S3.E5.m1.3.3.4.1" xref="S3.E5.m1.3.3.4.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.4.3.2" xref="S3.E5.m1.3.3.4.cmml"><mo id="S3.E5.m1.3.3.4.3.2.1" stretchy="false" xref="S3.E5.m1.3.3.4.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">θ</mi><mo id="S3.E5.m1.3.3.4.3.2.2" stretchy="false" xref="S3.E5.m1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml">=</mo><mrow id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml"><mfrac id="S3.E5.m1.3.3.2.4" xref="S3.E5.m1.3.3.2.4.cmml"><mn id="S3.E5.m1.3.3.2.4.2" xref="S3.E5.m1.3.3.2.4.2.cmml">1</mn><mi id="S3.E5.m1.3.3.2.4.3" xref="S3.E5.m1.3.3.2.4.3.cmml">N</mi></mfrac><mo id="S3.E5.m1.3.3.2.3" xref="S3.E5.m1.3.3.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.2.2" xref="S3.E5.m1.3.3.2.2.cmml"><munderover id="S3.E5.m1.3.3.2.2.3" xref="S3.E5.m1.3.3.2.2.3.cmml"><mo id="S3.E5.m1.3.3.2.2.3.2.2" movablelimits="false" xref="S3.E5.m1.3.3.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E5.m1.3.3.2.2.3.2.3" xref="S3.E5.m1.3.3.2.2.3.2.3.cmml"><mi id="S3.E5.m1.3.3.2.2.3.2.3.2" xref="S3.E5.m1.3.3.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E5.m1.3.3.2.2.3.2.3.1" xref="S3.E5.m1.3.3.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E5.m1.3.3.2.2.3.2.3.3" xref="S3.E5.m1.3.3.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.3.3.2.2.3.3" xref="S3.E5.m1.3.3.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E5.m1.3.3.2.2.2" xref="S3.E5.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.2.2.2.4" xref="S3.E5.m1.3.3.2.2.2.4.cmml">ℒ</mi><mo id="S3.E5.m1.3.3.2.2.2.3" xref="S3.E5.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.2.2.2.2.2" xref="S3.E5.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E5.m1.3.3.2.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.2.2.2.2.2.4" xref="S3.E5.m1.3.3.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.3.3.2.2.2.2.2.2" xref="S3.E5.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.3.3.2.2.2.2.2.2.2" xref="S3.E5.m1.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E5.m1.3.3.2.2.2.2.2.2.3" xref="S3.E5.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.2.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"></eq><apply id="S3.E5.m1.3.3.4.cmml" xref="S3.E5.m1.3.3.4"><times id="S3.E5.m1.3.3.4.1.cmml" xref="S3.E5.m1.3.3.4.1"></times><ci id="S3.E5.m1.3.3.4.2.cmml" xref="S3.E5.m1.3.3.4.2">ℒ</ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝜃</ci></apply><apply id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"><times id="S3.E5.m1.3.3.2.3.cmml" xref="S3.E5.m1.3.3.2.3"></times><apply id="S3.E5.m1.3.3.2.4.cmml" xref="S3.E5.m1.3.3.2.4"><divide id="S3.E5.m1.3.3.2.4.1.cmml" xref="S3.E5.m1.3.3.2.4"></divide><cn id="S3.E5.m1.3.3.2.4.2.cmml" type="integer" xref="S3.E5.m1.3.3.2.4.2">1</cn><ci id="S3.E5.m1.3.3.2.4.3.cmml" xref="S3.E5.m1.3.3.2.4.3">𝑁</ci></apply><apply id="S3.E5.m1.3.3.2.2.cmml" xref="S3.E5.m1.3.3.2.2"><apply id="S3.E5.m1.3.3.2.2.3.cmml" xref="S3.E5.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.3.1.cmml" xref="S3.E5.m1.3.3.2.2.3">superscript</csymbol><apply id="S3.E5.m1.3.3.2.2.3.2.cmml" xref="S3.E5.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.3.2.1.cmml" xref="S3.E5.m1.3.3.2.2.3">subscript</csymbol><sum id="S3.E5.m1.3.3.2.2.3.2.2.cmml" xref="S3.E5.m1.3.3.2.2.3.2.2"></sum><apply id="S3.E5.m1.3.3.2.2.3.2.3.cmml" xref="S3.E5.m1.3.3.2.2.3.2.3"><eq id="S3.E5.m1.3.3.2.2.3.2.3.1.cmml" xref="S3.E5.m1.3.3.2.2.3.2.3.1"></eq><ci id="S3.E5.m1.3.3.2.2.3.2.3.2.cmml" xref="S3.E5.m1.3.3.2.2.3.2.3.2">𝑖</ci><cn id="S3.E5.m1.3.3.2.2.3.2.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.3.3.2.2.3.3.cmml" xref="S3.E5.m1.3.3.2.2.3.3">𝑁</ci></apply><apply id="S3.E5.m1.3.3.2.2.2.cmml" xref="S3.E5.m1.3.3.2.2.2"><times id="S3.E5.m1.3.3.2.2.2.3.cmml" xref="S3.E5.m1.3.3.2.2.2.3"></times><ci id="S3.E5.m1.3.3.2.2.2.4.cmml" xref="S3.E5.m1.3.3.2.2.2.4">ℒ</ci><interval closure="open" id="S3.E5.m1.3.3.2.2.2.2.3.cmml" xref="S3.E5.m1.3.3.2.2.2.2.2"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E5.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E5.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\mathcal{L}(\theta)=\frac{1}{N}\sum_{i=1}^{N}\mathcal{L}(\hat{y}_{i},y_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">caligraphic_L ( italic_θ ) = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT caligraphic_L ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS5.p6">
<p class="ltx_p" id="S3.SS3.SSS5.p6.5">where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p6.1.m1.1"><semantics id="S3.SS3.SSS5.p6.1.m1.1a"><mi id="S3.SS3.SSS5.p6.1.m1.1.1" xref="S3.SS3.SSS5.p6.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p6.1.m1.1b"><ci id="S3.SS3.SSS5.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS5.p6.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p6.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p6.1.m1.1d">italic_θ</annotation></semantics></math> denotes the model parameters, <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p6.2.m2.1"><semantics id="S3.SS3.SSS5.p6.2.m2.1a"><mi id="S3.SS3.SSS5.p6.2.m2.1.1" xref="S3.SS3.SSS5.p6.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p6.2.m2.1b"><ci id="S3.SS3.SSS5.p6.2.m2.1.1.cmml" xref="S3.SS3.SSS5.p6.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p6.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p6.2.m2.1d">italic_N</annotation></semantics></math> is the number of training samples, <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p6.3.m3.1"><semantics id="S3.SS3.SSS5.p6.3.m3.1a"><msub id="S3.SS3.SSS5.p6.3.m3.1.1" xref="S3.SS3.SSS5.p6.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS5.p6.3.m3.1.1.2" xref="S3.SS3.SSS5.p6.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS5.p6.3.m3.1.1.2.2" xref="S3.SS3.SSS5.p6.3.m3.1.1.2.2.cmml">y</mi><mo id="S3.SS3.SSS5.p6.3.m3.1.1.2.1" xref="S3.SS3.SSS5.p6.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS5.p6.3.m3.1.1.3" xref="S3.SS3.SSS5.p6.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p6.3.m3.1b"><apply id="S3.SS3.SSS5.p6.3.m3.1.1.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS5.p6.3.m3.1.1.1.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS5.p6.3.m3.1.1.2.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1.2"><ci id="S3.SS3.SSS5.p6.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1.2.1">^</ci><ci id="S3.SS3.SSS5.p6.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1.2.2">𝑦</ci></apply><ci id="S3.SS3.SSS5.p6.3.m3.1.1.3.cmml" xref="S3.SS3.SSS5.p6.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p6.3.m3.1c">\hat{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p6.3.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p6.4.m4.1"><semantics id="S3.SS3.SSS5.p6.4.m4.1a"><msub id="S3.SS3.SSS5.p6.4.m4.1.1" xref="S3.SS3.SSS5.p6.4.m4.1.1.cmml"><mi id="S3.SS3.SSS5.p6.4.m4.1.1.2" xref="S3.SS3.SSS5.p6.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS5.p6.4.m4.1.1.3" xref="S3.SS3.SSS5.p6.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p6.4.m4.1b"><apply id="S3.SS3.SSS5.p6.4.m4.1.1.cmml" xref="S3.SS3.SSS5.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS5.p6.4.m4.1.1.1.cmml" xref="S3.SS3.SSS5.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS5.p6.4.m4.1.1.2.cmml" xref="S3.SS3.SSS5.p6.4.m4.1.1.2">𝑦</ci><ci id="S3.SS3.SSS5.p6.4.m4.1.1.3.cmml" xref="S3.SS3.SSS5.p6.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p6.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p6.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represent the predicted and true labels, respectively, and <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p6.5.m5.1"><semantics id="S3.SS3.SSS5.p6.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS5.p6.5.m5.1.1" xref="S3.SS3.SSS5.p6.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p6.5.m5.1b"><ci id="S3.SS3.SSS5.p6.5.m5.1.1.cmml" xref="S3.SS3.SSS5.p6.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p6.5.m5.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p6.5.m5.1d">caligraphic_L</annotation></semantics></math> is the loss function <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib22" title="">22</a>]</cite>. The training process involves techniques such as gradient accumulation and mixed-precision training to manage memory consumption and accelerate computation. Gradient accumulation effectively increases the batch size without requiring additional memory, which is crucial for handling large models. By carefully adjusting parameters and leveraging these advanced training techniques, we ensure that the fine-tuned model achieves optimal performance.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="388" id="S3.F1.g1" src="extracted/5833211/plot.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Fine-Tuning LLAMA3</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.SSS5.p7">
<p class="ltx_p" id="S3.SS3.SSS5.p7.1">The plot in figure 1 delineates the training loss trajectory of a Large Language Model (LLAMA3) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib30" title="">30</a>]</cite> during a fine-tuning phase conducted over a single epoch, comprising 120 steps. The model configuration involves 83,886,080 trainable parameters. Key training parameters include a per-device train batch size of 2, a gradient accumulation strategy across 4 steps, and an initial learning rate of <math alttext="2\times 10^{-4}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p7.1.m1.1"><semantics id="S3.SS3.SSS5.p7.1.m1.1a"><mrow id="S3.SS3.SSS5.p7.1.m1.1.1" xref="S3.SS3.SSS5.p7.1.m1.1.1.cmml"><mn id="S3.SS3.SSS5.p7.1.m1.1.1.2" xref="S3.SS3.SSS5.p7.1.m1.1.1.2.cmml">2</mn><mo id="S3.SS3.SSS5.p7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS5.p7.1.m1.1.1.1.cmml">×</mo><msup id="S3.SS3.SSS5.p7.1.m1.1.1.3" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.cmml"><mn id="S3.SS3.SSS5.p7.1.m1.1.1.3.2" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS3.SSS5.p7.1.m1.1.1.3.3" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3.cmml"><mo id="S3.SS3.SSS5.p7.1.m1.1.1.3.3a" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS3.SSS5.p7.1.m1.1.1.3.3.2" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p7.1.m1.1b"><apply id="S3.SS3.SSS5.p7.1.m1.1.1.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1"><times id="S3.SS3.SSS5.p7.1.m1.1.1.1.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1.1"></times><cn id="S3.SS3.SSS5.p7.1.m1.1.1.2.cmml" type="integer" xref="S3.SS3.SSS5.p7.1.m1.1.1.2">2</cn><apply id="S3.SS3.SSS5.p7.1.m1.1.1.3.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS5.p7.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1.3">superscript</csymbol><cn id="S3.SS3.SSS5.p7.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.2">10</cn><apply id="S3.SS3.SSS5.p7.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3"><minus id="S3.SS3.SSS5.p7.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3"></minus><cn id="S3.SS3.SSS5.p7.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS5.p7.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p7.1.m1.1c">2\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p7.1.m1.1d">2 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, optimized using an 8-bit AdamW optimizer with a linear learning rate scheduler. The primary plot line, marked in blue, represents the raw training loss recorded at each step, reflecting the model’s immediate response to batch-level optimizations. Overlaying this, a red trend line—calculated as a moving average—smoothes out fluctuations to highlight broader trends in model performance and stability. Noteworthy are the annotations at the lowest and highest points of loss, which pinpoint critical moments in the training process where the model achieved optimal learning and where it may have struggled, respectively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Optimizing the performance of the model</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">To optimize the model’s performance during fine-tuning, quantization is being applied. Quantization reduces the memory footprint and computational requirements of neural networks. Quantization involves reducing the precision of the model parameters, typically from 32-bit floating-point (FP32) to lower bit-width representations such as 16-bit floating-point (FP16), 8-bit integers (INT8), or even 4-bit integers (INT4). Mathematically, this can be expressed as:</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{W}=\text{round}\left(\frac{W-\min(W)}{\Delta}\right)\cdot\Delta+\min(W)" class="ltx_Math" display="block" id="S3.E6.m1.4"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4.5" xref="S3.E6.m1.4.5.cmml"><mover accent="true" id="S3.E6.m1.4.5.2" xref="S3.E6.m1.4.5.2.cmml"><mi id="S3.E6.m1.4.5.2.2" xref="S3.E6.m1.4.5.2.2.cmml">W</mi><mo id="S3.E6.m1.4.5.2.1" xref="S3.E6.m1.4.5.2.1.cmml">~</mo></mover><mo id="S3.E6.m1.4.5.1" xref="S3.E6.m1.4.5.1.cmml">=</mo><mrow id="S3.E6.m1.4.5.3" xref="S3.E6.m1.4.5.3.cmml"><mrow id="S3.E6.m1.4.5.3.2" xref="S3.E6.m1.4.5.3.2.cmml"><mrow id="S3.E6.m1.4.5.3.2.2" xref="S3.E6.m1.4.5.3.2.2.cmml"><mtext id="S3.E6.m1.4.5.3.2.2.2" xref="S3.E6.m1.4.5.3.2.2.2a.cmml">round</mtext><mo id="S3.E6.m1.4.5.3.2.2.1" xref="S3.E6.m1.4.5.3.2.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.4.5.3.2.2.3.2" xref="S3.E6.m1.2.2.cmml"><mo id="S3.E6.m1.4.5.3.2.2.3.2.1" xref="S3.E6.m1.2.2.cmml">(</mo><mfrac id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mi id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.4.cmml">W</mi><mo id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E6.m1.2.2.2.5.2" xref="S3.E6.m1.2.2.2.5.1.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">min</mi><mo id="S3.E6.m1.2.2.2.5.2a" xref="S3.E6.m1.2.2.2.5.1.cmml">⁡</mo><mrow id="S3.E6.m1.2.2.2.5.2.1" xref="S3.E6.m1.2.2.2.5.1.cmml"><mo id="S3.E6.m1.2.2.2.5.2.1.1" stretchy="false" xref="S3.E6.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">W</mi><mo id="S3.E6.m1.2.2.2.5.2.1.2" stretchy="false" xref="S3.E6.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></mrow><mi id="S3.E6.m1.2.2.4" mathvariant="normal" xref="S3.E6.m1.2.2.4.cmml">Δ</mi></mfrac><mo id="S3.E6.m1.4.5.3.2.2.3.2.2" rspace="0.055em" xref="S3.E6.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.5.3.2.1" rspace="0.222em" xref="S3.E6.m1.4.5.3.2.1.cmml">⋅</mo><mi id="S3.E6.m1.4.5.3.2.3" mathvariant="normal" xref="S3.E6.m1.4.5.3.2.3.cmml">Δ</mi></mrow><mo id="S3.E6.m1.4.5.3.1" xref="S3.E6.m1.4.5.3.1.cmml">+</mo><mrow id="S3.E6.m1.4.5.3.3.2" xref="S3.E6.m1.4.5.3.3.1.cmml"><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">min</mi><mo id="S3.E6.m1.4.5.3.3.2a" xref="S3.E6.m1.4.5.3.3.1.cmml">⁡</mo><mrow id="S3.E6.m1.4.5.3.3.2.1" xref="S3.E6.m1.4.5.3.3.1.cmml"><mo id="S3.E6.m1.4.5.3.3.2.1.1" stretchy="false" xref="S3.E6.m1.4.5.3.3.1.cmml">(</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">W</mi><mo id="S3.E6.m1.4.5.3.3.2.1.2" stretchy="false" xref="S3.E6.m1.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.4b"><apply id="S3.E6.m1.4.5.cmml" xref="S3.E6.m1.4.5"><eq id="S3.E6.m1.4.5.1.cmml" xref="S3.E6.m1.4.5.1"></eq><apply id="S3.E6.m1.4.5.2.cmml" xref="S3.E6.m1.4.5.2"><ci id="S3.E6.m1.4.5.2.1.cmml" xref="S3.E6.m1.4.5.2.1">~</ci><ci id="S3.E6.m1.4.5.2.2.cmml" xref="S3.E6.m1.4.5.2.2">𝑊</ci></apply><apply id="S3.E6.m1.4.5.3.cmml" xref="S3.E6.m1.4.5.3"><plus id="S3.E6.m1.4.5.3.1.cmml" xref="S3.E6.m1.4.5.3.1"></plus><apply id="S3.E6.m1.4.5.3.2.cmml" xref="S3.E6.m1.4.5.3.2"><ci id="S3.E6.m1.4.5.3.2.1.cmml" xref="S3.E6.m1.4.5.3.2.1">⋅</ci><apply id="S3.E6.m1.4.5.3.2.2.cmml" xref="S3.E6.m1.4.5.3.2.2"><times id="S3.E6.m1.4.5.3.2.2.1.cmml" xref="S3.E6.m1.4.5.3.2.2.1"></times><ci id="S3.E6.m1.4.5.3.2.2.2a.cmml" xref="S3.E6.m1.4.5.3.2.2.2"><mtext id="S3.E6.m1.4.5.3.2.2.2.cmml" xref="S3.E6.m1.4.5.3.2.2.2">round</mtext></ci><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.4.5.3.2.2.3.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.4.5.3.2.2.3.2"></divide><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><minus id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></minus><ci id="S3.E6.m1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.4">𝑊</ci><apply id="S3.E6.m1.2.2.2.5.1.cmml" xref="S3.E6.m1.2.2.2.5.2"><min id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"></min><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑊</ci></apply></apply><ci id="S3.E6.m1.2.2.4.cmml" xref="S3.E6.m1.2.2.4">Δ</ci></apply></apply><ci id="S3.E6.m1.4.5.3.2.3.cmml" xref="S3.E6.m1.4.5.3.2.3">Δ</ci></apply><apply id="S3.E6.m1.4.5.3.3.1.cmml" xref="S3.E6.m1.4.5.3.3.2"><min id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"></min><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\tilde{W}=\text{round}\left(\frac{W-\min(W)}{\Delta}\right)\cdot\Delta+\min(W)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.4d">over~ start_ARG italic_W end_ARG = round ( divide start_ARG italic_W - roman_min ( italic_W ) end_ARG start_ARG roman_Δ end_ARG ) ⋅ roman_Δ + roman_min ( italic_W )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.4">where <math alttext="\tilde{W}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mover accent="true" id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">W</mi><mo id="S3.SS4.p3.1.m1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><ci id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1">~</ci><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\tilde{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">over~ start_ARG italic_W end_ARG</annotation></semantics></math> represents the quantized weights and <math alttext="\Delta" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p3.2.m2.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">roman_Δ</annotation></semantics></math> is the quantization step size, defined as <math alttext="\Delta=\frac{\max(W)-\min(W)}{2^{b}-1}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.4"><semantics id="S3.SS4.p3.3.m3.4a"><mrow id="S3.SS4.p3.3.m3.4.5" xref="S3.SS4.p3.3.m3.4.5.cmml"><mi id="S3.SS4.p3.3.m3.4.5.2" mathvariant="normal" xref="S3.SS4.p3.3.m3.4.5.2.cmml">Δ</mi><mo id="S3.SS4.p3.3.m3.4.5.1" xref="S3.SS4.p3.3.m3.4.5.1.cmml">=</mo><mfrac id="S3.SS4.p3.3.m3.4.4" xref="S3.SS4.p3.3.m3.4.4.cmml"><mrow id="S3.SS4.p3.3.m3.4.4.4" xref="S3.SS4.p3.3.m3.4.4.4.cmml"><mrow id="S3.SS4.p3.3.m3.4.4.4.6.2" xref="S3.SS4.p3.3.m3.4.4.4.6.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.1.1" xref="S3.SS4.p3.3.m3.1.1.1.1.cmml">max</mi><mo id="S3.SS4.p3.3.m3.4.4.4.6.2a" xref="S3.SS4.p3.3.m3.4.4.4.6.1.cmml">⁡</mo><mrow id="S3.SS4.p3.3.m3.4.4.4.6.2.1" xref="S3.SS4.p3.3.m3.4.4.4.6.1.cmml"><mo id="S3.SS4.p3.3.m3.4.4.4.6.2.1.1" stretchy="false" xref="S3.SS4.p3.3.m3.4.4.4.6.1.cmml">(</mo><mi id="S3.SS4.p3.3.m3.2.2.2.2" xref="S3.SS4.p3.3.m3.2.2.2.2.cmml">W</mi><mo id="S3.SS4.p3.3.m3.4.4.4.6.2.1.2" stretchy="false" xref="S3.SS4.p3.3.m3.4.4.4.6.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.3.m3.4.4.4.5" xref="S3.SS4.p3.3.m3.4.4.4.5.cmml">−</mo><mrow id="S3.SS4.p3.3.m3.4.4.4.7.2" xref="S3.SS4.p3.3.m3.4.4.4.7.1.cmml"><mi id="S3.SS4.p3.3.m3.3.3.3.3" xref="S3.SS4.p3.3.m3.3.3.3.3.cmml">min</mi><mo id="S3.SS4.p3.3.m3.4.4.4.7.2a" xref="S3.SS4.p3.3.m3.4.4.4.7.1.cmml">⁡</mo><mrow id="S3.SS4.p3.3.m3.4.4.4.7.2.1" xref="S3.SS4.p3.3.m3.4.4.4.7.1.cmml"><mo id="S3.SS4.p3.3.m3.4.4.4.7.2.1.1" stretchy="false" xref="S3.SS4.p3.3.m3.4.4.4.7.1.cmml">(</mo><mi id="S3.SS4.p3.3.m3.4.4.4.4" xref="S3.SS4.p3.3.m3.4.4.4.4.cmml">W</mi><mo id="S3.SS4.p3.3.m3.4.4.4.7.2.1.2" stretchy="false" xref="S3.SS4.p3.3.m3.4.4.4.7.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.SS4.p3.3.m3.4.4.6" xref="S3.SS4.p3.3.m3.4.4.6.cmml"><msup id="S3.SS4.p3.3.m3.4.4.6.2" xref="S3.SS4.p3.3.m3.4.4.6.2.cmml"><mn id="S3.SS4.p3.3.m3.4.4.6.2.2" xref="S3.SS4.p3.3.m3.4.4.6.2.2.cmml">2</mn><mi id="S3.SS4.p3.3.m3.4.4.6.2.3" xref="S3.SS4.p3.3.m3.4.4.6.2.3.cmml">b</mi></msup><mo id="S3.SS4.p3.3.m3.4.4.6.1" xref="S3.SS4.p3.3.m3.4.4.6.1.cmml">−</mo><mn id="S3.SS4.p3.3.m3.4.4.6.3" xref="S3.SS4.p3.3.m3.4.4.6.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.4b"><apply id="S3.SS4.p3.3.m3.4.5.cmml" xref="S3.SS4.p3.3.m3.4.5"><eq id="S3.SS4.p3.3.m3.4.5.1.cmml" xref="S3.SS4.p3.3.m3.4.5.1"></eq><ci id="S3.SS4.p3.3.m3.4.5.2.cmml" xref="S3.SS4.p3.3.m3.4.5.2">Δ</ci><apply id="S3.SS4.p3.3.m3.4.4.cmml" xref="S3.SS4.p3.3.m3.4.4"><divide id="S3.SS4.p3.3.m3.4.4.5.cmml" xref="S3.SS4.p3.3.m3.4.4"></divide><apply id="S3.SS4.p3.3.m3.4.4.4.cmml" xref="S3.SS4.p3.3.m3.4.4.4"><minus id="S3.SS4.p3.3.m3.4.4.4.5.cmml" xref="S3.SS4.p3.3.m3.4.4.4.5"></minus><apply id="S3.SS4.p3.3.m3.4.4.4.6.1.cmml" xref="S3.SS4.p3.3.m3.4.4.4.6.2"><max id="S3.SS4.p3.3.m3.1.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1.1.1"></max><ci id="S3.SS4.p3.3.m3.2.2.2.2.cmml" xref="S3.SS4.p3.3.m3.2.2.2.2">𝑊</ci></apply><apply id="S3.SS4.p3.3.m3.4.4.4.7.1.cmml" xref="S3.SS4.p3.3.m3.4.4.4.7.2"><min id="S3.SS4.p3.3.m3.3.3.3.3.cmml" xref="S3.SS4.p3.3.m3.3.3.3.3"></min><ci id="S3.SS4.p3.3.m3.4.4.4.4.cmml" xref="S3.SS4.p3.3.m3.4.4.4.4">𝑊</ci></apply></apply><apply id="S3.SS4.p3.3.m3.4.4.6.cmml" xref="S3.SS4.p3.3.m3.4.4.6"><minus id="S3.SS4.p3.3.m3.4.4.6.1.cmml" xref="S3.SS4.p3.3.m3.4.4.6.1"></minus><apply id="S3.SS4.p3.3.m3.4.4.6.2.cmml" xref="S3.SS4.p3.3.m3.4.4.6.2"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.4.4.6.2.1.cmml" xref="S3.SS4.p3.3.m3.4.4.6.2">superscript</csymbol><cn id="S3.SS4.p3.3.m3.4.4.6.2.2.cmml" type="integer" xref="S3.SS4.p3.3.m3.4.4.6.2.2">2</cn><ci id="S3.SS4.p3.3.m3.4.4.6.2.3.cmml" xref="S3.SS4.p3.3.m3.4.4.6.2.3">𝑏</ci></apply><cn id="S3.SS4.p3.3.m3.4.4.6.3.cmml" type="integer" xref="S3.SS4.p3.3.m3.4.4.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.4c">\Delta=\frac{\max(W)-\min(W)}{2^{b}-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.4d">roman_Δ = divide start_ARG roman_max ( italic_W ) - roman_min ( italic_W ) end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG</annotation></semantics></math>, with <math alttext="b" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_b</annotation></semantics></math> being the number of bits used in the quantization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib19" title="">19</a>]</cite>. This transformation maps the original weight values into a discrete set of levels, significantly reducing the number of bits required to store each weight. This process is crucial for deploying large models on resource-constrained devices, allowing efficient storage and faster computation without significantly compromising model performance.</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.5">Another employed technique is Low-Rank Adaptation (LoRA), which enhances the efficiency of large language models by updating only a small subset of model parameters. LoRA uses low-rank matrices to approximate the updates to the weight matrices in the model, thereby reducing the computational burden. Formally, let <math alttext="W\in\mathbb{R}^{d\times k}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><mrow id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">W</mi><mo id="S3.SS4.p4.1.m1.1.1.1" xref="S3.SS4.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml"><mi id="S3.SS4.p4.1.m1.1.1.3.2" xref="S3.SS4.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.1.m1.1.1.3.3" xref="S3.SS4.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p4.1.m1.1.1.3.3.2" xref="S3.SS4.p4.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS4.p4.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p4.1.m1.1.1.3.3.3" xref="S3.SS4.p4.1.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><in id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1"></in><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑊</ci><apply id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.3.1.cmml" xref="S3.SS4.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.3.2.cmml" xref="S3.SS4.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p4.1.m1.1.1.3.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3.3"><times id="S3.SS4.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p4.1.m1.1.1.3.3.1"></times><ci id="S3.SS4.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p4.1.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">W\in\mathbb{R}^{d\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">italic_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> be the original weight matrix. <math alttext="d\times k" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><mrow id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">d</mi><mo id="S3.SS4.p4.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><times id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1"></times><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">𝑑</ci><ci id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">d\times k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">italic_d × italic_k</annotation></semantics></math> are the dimensions of the original weight matrix, where <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1"><semantics id="S3.SS4.p4.3.m3.1a"><mi id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><ci id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m3.1d">italic_d</annotation></semantics></math> is the number of output features and <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p4.4.m4.1"><semantics id="S3.SS4.p4.4.m4.1a"><mi id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><ci id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.4.m4.1d">italic_k</annotation></semantics></math> is the number of input features. LoRA approximates <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.p4.5.m5.1"><semantics id="S3.SS4.p4.5.m5.1a"><mi id="S3.SS4.p4.5.m5.1.1" xref="S3.SS4.p4.5.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><ci id="S3.SS4.p4.5.m5.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.5.m5.1d">italic_W</annotation></semantics></math> as:</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W\approx W_{0}+\Delta W" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">W</mi><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">≈</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">W</mi><mn id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3.cmml">0</mn></msub><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" mathvariant="normal" xref="S3.E7.m1.1.1.3.3.2.cmml">Δ</mi><mo id="S3.E7.m1.1.1.3.3.1" xref="S3.E7.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml">W</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><approx id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></approx><ci id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">𝑊</ci><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><plus id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝑊</ci><cn id="S3.E7.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E7.m1.1.1.3.2.3">0</cn></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><times id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">Δ</ci><ci id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">W\approx W_{0}+\Delta W</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_W ≈ italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + roman_Δ italic_W</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<p class="ltx_p" id="S3.SS4.p6.2">Where the change in <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.p6.1.m1.1"><semantics id="S3.SS4.p6.1.m1.1a"><mi id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b"><ci id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.1.m1.1d">italic_W</annotation></semantics></math>, denoted <math alttext="\Delta W" class="ltx_Math" display="inline" id="S3.SS4.p6.2.m2.1"><semantics id="S3.SS4.p6.2.m2.1a"><mrow id="S3.SS4.p6.2.m2.1.1" xref="S3.SS4.p6.2.m2.1.1.cmml"><mi id="S3.SS4.p6.2.m2.1.1.2" mathvariant="normal" xref="S3.SS4.p6.2.m2.1.1.2.cmml">Δ</mi><mo id="S3.SS4.p6.2.m2.1.1.1" xref="S3.SS4.p6.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p6.2.m2.1.1.3" xref="S3.SS4.p6.2.m2.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b"><apply id="S3.SS4.p6.2.m2.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1"><times id="S3.SS4.p6.2.m2.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1.1"></times><ci id="S3.SS4.p6.2.m2.1.1.2.cmml" xref="S3.SS4.p6.2.m2.1.1.2">Δ</ci><ci id="S3.SS4.p6.2.m2.1.1.3.cmml" xref="S3.SS4.p6.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">\Delta W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.2.m2.1d">roman_Δ italic_W</annotation></semantics></math>, is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta W=AB" class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.2.2" mathvariant="normal" xref="S3.E8.m1.1.1.2.2.cmml">Δ</mi><mo id="S3.E8.m1.1.1.2.1" xref="S3.E8.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml">W</mi></mrow><mo id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">A</mi><mo id="S3.E8.m1.1.1.3.1" xref="S3.E8.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"></eq><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><times id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2.1"></times><ci id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2">Δ</ci><ci id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3">𝑊</ci></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><times id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1"></times><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝐴</ci><ci id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\Delta W=AB</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">roman_Δ italic_W = italic_A italic_B</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p7">
<p class="ltx_p" id="S3.SS4.p7.9">where <math alttext="W_{0}" class="ltx_Math" display="inline" id="S3.SS4.p7.1.m1.1"><semantics id="S3.SS4.p7.1.m1.1a"><msub id="S3.SS4.p7.1.m1.1.1" xref="S3.SS4.p7.1.m1.1.1.cmml"><mi id="S3.SS4.p7.1.m1.1.1.2" xref="S3.SS4.p7.1.m1.1.1.2.cmml">W</mi><mn id="S3.SS4.p7.1.m1.1.1.3" xref="S3.SS4.p7.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.1.m1.1b"><apply id="S3.SS4.p7.1.m1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p7.1.m1.1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p7.1.m1.1.1.2.cmml" xref="S3.SS4.p7.1.m1.1.1.2">𝑊</ci><cn id="S3.SS4.p7.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.1.m1.1c">W_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.1.m1.1d">italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the pre-trained weight matrix, and <math alttext="A\in\mathbb{R}^{d\times r}" class="ltx_Math" display="inline" id="S3.SS4.p7.2.m2.1"><semantics id="S3.SS4.p7.2.m2.1a"><mrow id="S3.SS4.p7.2.m2.1.1" xref="S3.SS4.p7.2.m2.1.1.cmml"><mi id="S3.SS4.p7.2.m2.1.1.2" xref="S3.SS4.p7.2.m2.1.1.2.cmml">A</mi><mo id="S3.SS4.p7.2.m2.1.1.1" xref="S3.SS4.p7.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p7.2.m2.1.1.3" xref="S3.SS4.p7.2.m2.1.1.3.cmml"><mi id="S3.SS4.p7.2.m2.1.1.3.2" xref="S3.SS4.p7.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p7.2.m2.1.1.3.3" xref="S3.SS4.p7.2.m2.1.1.3.3.cmml"><mi id="S3.SS4.p7.2.m2.1.1.3.3.2" xref="S3.SS4.p7.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS4.p7.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p7.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p7.2.m2.1.1.3.3.3" xref="S3.SS4.p7.2.m2.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.2.m2.1b"><apply id="S3.SS4.p7.2.m2.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1"><in id="S3.SS4.p7.2.m2.1.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1.1"></in><ci id="S3.SS4.p7.2.m2.1.1.2.cmml" xref="S3.SS4.p7.2.m2.1.1.2">𝐴</ci><apply id="S3.SS4.p7.2.m2.1.1.3.cmml" xref="S3.SS4.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p7.2.m2.1.1.3.1.cmml" xref="S3.SS4.p7.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p7.2.m2.1.1.3.2.cmml" xref="S3.SS4.p7.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p7.2.m2.1.1.3.3.cmml" xref="S3.SS4.p7.2.m2.1.1.3.3"><times id="S3.SS4.p7.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p7.2.m2.1.1.3.3.1"></times><ci id="S3.SS4.p7.2.m2.1.1.3.3.2.cmml" xref="S3.SS4.p7.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p7.2.m2.1.1.3.3.3.cmml" xref="S3.SS4.p7.2.m2.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.2.m2.1c">A\in\mathbb{R}^{d\times r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.2.m2.1d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="B\in\mathbb{R}^{r\times k}" class="ltx_Math" display="inline" id="S3.SS4.p7.3.m3.1"><semantics id="S3.SS4.p7.3.m3.1a"><mrow id="S3.SS4.p7.3.m3.1.1" xref="S3.SS4.p7.3.m3.1.1.cmml"><mi id="S3.SS4.p7.3.m3.1.1.2" xref="S3.SS4.p7.3.m3.1.1.2.cmml">B</mi><mo id="S3.SS4.p7.3.m3.1.1.1" xref="S3.SS4.p7.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p7.3.m3.1.1.3" xref="S3.SS4.p7.3.m3.1.1.3.cmml"><mi id="S3.SS4.p7.3.m3.1.1.3.2" xref="S3.SS4.p7.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p7.3.m3.1.1.3.3" xref="S3.SS4.p7.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p7.3.m3.1.1.3.3.2" xref="S3.SS4.p7.3.m3.1.1.3.3.2.cmml">r</mi><mo id="S3.SS4.p7.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p7.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p7.3.m3.1.1.3.3.3" xref="S3.SS4.p7.3.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.3.m3.1b"><apply id="S3.SS4.p7.3.m3.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1"><in id="S3.SS4.p7.3.m3.1.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1.1"></in><ci id="S3.SS4.p7.3.m3.1.1.2.cmml" xref="S3.SS4.p7.3.m3.1.1.2">𝐵</ci><apply id="S3.SS4.p7.3.m3.1.1.3.cmml" xref="S3.SS4.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p7.3.m3.1.1.3.1.cmml" xref="S3.SS4.p7.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p7.3.m3.1.1.3.2.cmml" xref="S3.SS4.p7.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p7.3.m3.1.1.3.3.cmml" xref="S3.SS4.p7.3.m3.1.1.3.3"><times id="S3.SS4.p7.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p7.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p7.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p7.3.m3.1.1.3.3.2">𝑟</ci><ci id="S3.SS4.p7.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p7.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.3.m3.1c">B\in\mathbb{R}^{r\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.3.m3.1d">italic_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> are low-rank matrices with <math alttext="r\ll\min(d,k)" class="ltx_Math" display="inline" id="S3.SS4.p7.4.m4.3"><semantics id="S3.SS4.p7.4.m4.3a"><mrow id="S3.SS4.p7.4.m4.3.4" xref="S3.SS4.p7.4.m4.3.4.cmml"><mi id="S3.SS4.p7.4.m4.3.4.2" xref="S3.SS4.p7.4.m4.3.4.2.cmml">r</mi><mo id="S3.SS4.p7.4.m4.3.4.1" xref="S3.SS4.p7.4.m4.3.4.1.cmml">≪</mo><mrow id="S3.SS4.p7.4.m4.3.4.3.2" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml"><mi id="S3.SS4.p7.4.m4.1.1" xref="S3.SS4.p7.4.m4.1.1.cmml">min</mi><mo id="S3.SS4.p7.4.m4.3.4.3.2a" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml">⁡</mo><mrow id="S3.SS4.p7.4.m4.3.4.3.2.1" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml"><mo id="S3.SS4.p7.4.m4.3.4.3.2.1.1" stretchy="false" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml">(</mo><mi id="S3.SS4.p7.4.m4.2.2" xref="S3.SS4.p7.4.m4.2.2.cmml">d</mi><mo id="S3.SS4.p7.4.m4.3.4.3.2.1.2" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS4.p7.4.m4.3.3" xref="S3.SS4.p7.4.m4.3.3.cmml">k</mi><mo id="S3.SS4.p7.4.m4.3.4.3.2.1.3" stretchy="false" xref="S3.SS4.p7.4.m4.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.4.m4.3b"><apply id="S3.SS4.p7.4.m4.3.4.cmml" xref="S3.SS4.p7.4.m4.3.4"><csymbol cd="latexml" id="S3.SS4.p7.4.m4.3.4.1.cmml" xref="S3.SS4.p7.4.m4.3.4.1">much-less-than</csymbol><ci id="S3.SS4.p7.4.m4.3.4.2.cmml" xref="S3.SS4.p7.4.m4.3.4.2">𝑟</ci><apply id="S3.SS4.p7.4.m4.3.4.3.1.cmml" xref="S3.SS4.p7.4.m4.3.4.3.2"><min id="S3.SS4.p7.4.m4.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1"></min><ci id="S3.SS4.p7.4.m4.2.2.cmml" xref="S3.SS4.p7.4.m4.2.2">𝑑</ci><ci id="S3.SS4.p7.4.m4.3.3.cmml" xref="S3.SS4.p7.4.m4.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.4.m4.3c">r\ll\min(d,k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.4.m4.3d">italic_r ≪ roman_min ( italic_d , italic_k )</annotation></semantics></math>. This decomposition reduces the number of parameters from <math alttext="d\times k" class="ltx_Math" display="inline" id="S3.SS4.p7.5.m5.1"><semantics id="S3.SS4.p7.5.m5.1a"><mrow id="S3.SS4.p7.5.m5.1.1" xref="S3.SS4.p7.5.m5.1.1.cmml"><mi id="S3.SS4.p7.5.m5.1.1.2" xref="S3.SS4.p7.5.m5.1.1.2.cmml">d</mi><mo id="S3.SS4.p7.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p7.5.m5.1.1.1.cmml">×</mo><mi id="S3.SS4.p7.5.m5.1.1.3" xref="S3.SS4.p7.5.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.5.m5.1b"><apply id="S3.SS4.p7.5.m5.1.1.cmml" xref="S3.SS4.p7.5.m5.1.1"><times id="S3.SS4.p7.5.m5.1.1.1.cmml" xref="S3.SS4.p7.5.m5.1.1.1"></times><ci id="S3.SS4.p7.5.m5.1.1.2.cmml" xref="S3.SS4.p7.5.m5.1.1.2">𝑑</ci><ci id="S3.SS4.p7.5.m5.1.1.3.cmml" xref="S3.SS4.p7.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.5.m5.1c">d\times k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.5.m5.1d">italic_d × italic_k</annotation></semantics></math> to <math alttext="r(d+k)" class="ltx_Math" display="inline" id="S3.SS4.p7.6.m6.1"><semantics id="S3.SS4.p7.6.m6.1a"><mrow id="S3.SS4.p7.6.m6.1.1" xref="S3.SS4.p7.6.m6.1.1.cmml"><mi id="S3.SS4.p7.6.m6.1.1.3" xref="S3.SS4.p7.6.m6.1.1.3.cmml">r</mi><mo id="S3.SS4.p7.6.m6.1.1.2" xref="S3.SS4.p7.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p7.6.m6.1.1.1.1" xref="S3.SS4.p7.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS4.p7.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS4.p7.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p7.6.m6.1.1.1.1.1" xref="S3.SS4.p7.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS4.p7.6.m6.1.1.1.1.1.2" xref="S3.SS4.p7.6.m6.1.1.1.1.1.2.cmml">d</mi><mo id="S3.SS4.p7.6.m6.1.1.1.1.1.1" xref="S3.SS4.p7.6.m6.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS4.p7.6.m6.1.1.1.1.1.3" xref="S3.SS4.p7.6.m6.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS4.p7.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS4.p7.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.6.m6.1b"><apply id="S3.SS4.p7.6.m6.1.1.cmml" xref="S3.SS4.p7.6.m6.1.1"><times id="S3.SS4.p7.6.m6.1.1.2.cmml" xref="S3.SS4.p7.6.m6.1.1.2"></times><ci id="S3.SS4.p7.6.m6.1.1.3.cmml" xref="S3.SS4.p7.6.m6.1.1.3">𝑟</ci><apply id="S3.SS4.p7.6.m6.1.1.1.1.1.cmml" xref="S3.SS4.p7.6.m6.1.1.1.1"><plus id="S3.SS4.p7.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS4.p7.6.m6.1.1.1.1.1.1"></plus><ci id="S3.SS4.p7.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS4.p7.6.m6.1.1.1.1.1.2">𝑑</ci><ci id="S3.SS4.p7.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS4.p7.6.m6.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.6.m6.1c">r(d+k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.6.m6.1d">italic_r ( italic_d + italic_k )</annotation></semantics></math>, resulting in significant computational savings. The optimization problem during fine-tuning focuses on learning the matrices <math alttext="A" class="ltx_Math" display="inline" id="S3.SS4.p7.7.m7.1"><semantics id="S3.SS4.p7.7.m7.1a"><mi id="S3.SS4.p7.7.m7.1.1" xref="S3.SS4.p7.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.7.m7.1b"><ci id="S3.SS4.p7.7.m7.1.1.cmml" xref="S3.SS4.p7.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.7.m7.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.7.m7.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.SS4.p7.8.m8.1"><semantics id="S3.SS4.p7.8.m8.1a"><mi id="S3.SS4.p7.8.m8.1.1" xref="S3.SS4.p7.8.m8.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.8.m8.1b"><ci id="S3.SS4.p7.8.m8.1.1.cmml" xref="S3.SS4.p7.8.m8.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.8.m8.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.8.m8.1d">italic_B</annotation></semantics></math>, rather than the full weight matrix <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.p7.9.m9.1"><semantics id="S3.SS4.p7.9.m9.1a"><mi id="S3.SS4.p7.9.m9.1.1" xref="S3.SS4.p7.9.m9.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.9.m9.1b"><ci id="S3.SS4.p7.9.m9.1.1.cmml" xref="S3.SS4.p7.9.m9.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.9.m9.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.9.m9.1d">italic_W</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p8">
<p class="ltx_p" id="S3.SS4.p8.1">Quantization facilitates inference, particularly on devices with limited resources. Quantization during the training process ensures that the model is low-precision and robust. To ensure numerical stability, quantization should be configured in advance and gradients should be computed in reverse order with floating-point precision. By decreasing computational and memory consumption, quantization and LoRA facilitate the utilization of LLAMA 3 by quite modest hardware only.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Architectural design</h3>
<section class="ltx_subsubsection" id="S3.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1 </span>The multi-agent setup</h4>
<div class="ltx_para" id="S3.SS5.SSS1.p1">
<p class="ltx_p" id="S3.SS5.SSS1.p1.1">The main idea of having this multi-agent LLM-based system revolves around domain-specific knowledge agents characterized by role-based agents and system template prompt engineering. This approach determines the main goals of each specific agent and constrains their behavior based on specified requirements and the state of the environment. In this context, the environment is the SuperTracy interactive system, encompassing user interactions and the contextual states of the conversation. There are three agents defined:</p>
<ol class="ltx_enumerate" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I3.i1.p1.1.1">Reception Agent</span>: The Reception Agent handles basic communication. It introduces itself to the user and provides guidance on using the system, including instructions to provide the parcel’s barcode. This agent ensures a smooth initial interaction and prepares the user for further engagement with the system.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I3.i2.p1">
<p class="ltx_p" id="S3.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I3.i2.p1.1.1">Parcel Agent</span>: The Parcel Agent is responsible for analyzing parcel data and generating detailed narratives of parcel journeys. These narratives can range from detailed reports to short, coherent answers, depending on user needs. This agent includes specialized sub-models, such as a predictive model for forecasting the future status of parcels. By customizing its responses, the Parcel Agent enhances the user’s ability to track and understand parcel movements comprehensively.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I3.i3.p1">
<p class="ltx_p" id="S3.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I3.i3.p1.1.1">Knowledge Expert Agent</span>: The Knowledge Expert Agent specializes in answering user questions related to internal PostNL concepts and domain-specific terms. This agent can handle queries ranging from simple explanations to complex scenarios. Its knowledge base is derived from PostNL’s internal documents and general logistics knowledge. The agent’s ability to reason and provide contextually accurate answers makes it a valuable resource for users seeking detailed information on PostNL operations.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p2">
<p class="ltx_p" id="S3.SS5.SSS1.p2.1">The Reception agent and the Parcel agent contribute to the expected outcome of SuperTracy, that is to communicate on the parcel’s track and trace journey. The Knowledge Expert agent is an additional bonus feature. The idea emerged beyond the scope of the main research question and the main requirements of the project which was only limited by the parcels track and trace. The knowledge expert agent is developed using the same approach as the Parcel agents, it is trained on internal PostNL documents. This enables it to answer and explain questions related to internal PostNL knowledge, providing reasoning based on this knowledge. It can handle simple queries, such as explanations of PostNL-specific abbreviations or business and technical terms, as well as more sophisticated questions, such as offering advice on logistical scenarios with certain problems. In all cases, the model answers questions using its acquired knowledge and foundational reasoning capabilities. You can see examples of simple and complex queries in Appendix A.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p3">
<p class="ltx_p" id="S3.SS5.SSS1.p3.1">The agents together generate parcel journeys that are comprehensible due to the use of plain language instead of a sequence of logistic events. Through prompt engineering, the model exhibits both efficiency and adaptability, generating concise stories of parcel journeys that incorporate contextual information.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2 </span>Prompt engineering</h4>
<div class="ltx_para" id="S3.SS5.SSS2.p1">
<p class="ltx_p" id="S3.SS5.SSS2.p1.1">The developer of a LLM-based system can instruct the behaviour of the system through prompt engineering. For this solution Chain-of-Thought prompting and Few-Shot prompting are used <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib16" title="">16</a>]</cite>. Chain-of-Thought prompting is a technique to prompt LLMs in a way that facilitates coherent and step-by-step reasoning processes. Few-shot prompting provides models with a few input-output examples to induce an understanding of a given task.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS2.p2">
<p class="ltx_p" id="S3.SS5.SSS2.p2.1">Within prompt engineering a template refers to a natural language scaffolding filled in with raw data, resulting in a prompt <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib13" title="">13</a>]</cite>. Throughout the solution, 4 different types of templates have been identified.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS2.p3">
<ol class="ltx_enumerate" id="S3.I4">
<li class="ltx_item" id="S3.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I4.i1.p1">
<p class="ltx_p" id="S3.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I4.i1.p1.1.1">Template for cognitive behaviour of the agents</span>: In this template the agent is told how to behave. This differs for each agent. Here you can see the prompt template for the Reception agent:</p>
<div class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing" id="S3.I4.i1.p1.2">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ICAgIGRlZiByZWNlcHRpb25hZ2VudF9jb250ZXh0X2VuKCk6CiAgICByZXR1cm4oCiAgICAgICAgIiIiWW91IGFyZSBTdXBlclRyYWN5LCBhbiBBSSBhZ2VudCBoZWxwaW5nIFBvc3ROTCBjdXN0b21lcnMgd2l0aCB0aGVpciBwYXJjZWwgdHJhY2tpbmcgbmVlZHMuIFlvdSBwcm92aWRlIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IHRoZSBqb3VybmV5IG9mIHBhcmNlbHMgdXNpbmcgYSBnaXZlbiBiYXJjb2RlLiBZb3VyIHByaW1hcnkgZnVuY3Rpb24gaXMgdG8gZ3VpZGUgdXNlcnMgdG8gcHJvdmlkZSB0aGUgYmFyY29kZSBvZiB0aGVpciBwYXJjZWwsIGFuZCB0aGVuIHVzZSB0aGF0IGluZm9ybWF0aW9uIHRvIGZldGNoIGFuZCByZWxheSB0cmFja2luZyBkZXRhaWxzLiBZb3UgcmVzcG9uZCBpbiBhIGhlbHBmdWwgYW5kIHByb2Zlc3Npb25hbCBtYW5uZXIsIGFsd2F5cyBwcm9tcHRpbmcgdXNlcnMgZm9yIHRoZSBiYXJjb2RlIGlmIGl0IGhhc250IGJlZW4gcHJvdmlkZWQsIGFuZCBoYW5kbGluZyBlcnJvcnMgb3IgcXVlc3Rpb25zIGFib3V0IHBhcmNlbCB0cmFja2luZyBncmFjZWZ1bGx5LiBJZiB0aGUgYmFyY29kZSBwcm92aWRlZCBkb2VzIG5vdCByZXR1cm4gYW55IGluZm9ybWF0aW9uIG9yIGlzIGludmFsaWQsIHlvdSBpbnN0cnVjdCB0aGUgdXNlciBvbiBob3cgdG8gZmluZCBhIHZhbGlkIGJhcmNvZGUgb3Igc3VnZ2VzdCBhbHRlcm5hdGl2ZSBzb2x1dGlvbnMuIFdoZW4geW91IGRvIG5vdCBrbm93IHRoZSBhbnN3ZXIgdG8gYSB1c2VyJ3MgcXVlc3Rpb24sIHJlc3BvbmQgd2l0aCwgSSdtIHNvcnJ5LCBJIGRvbid0IGhhdmUgaW5mb3JtYXRpb24gb24gdGhhdCB0b3BpYy4gUGxlYXNlIHByb3ZpZGUgYSBiYXJjb2RlIGlmIHlvdSBuZWVkIHRyYWNraW5nIGRldGFpbHMuIFlvdXIgaW50ZXJhY3Rpb25zIGFyZSBkZXNpZ25lZCB0byBiZSBjbGVhciwgY29uY2lzZSwgYW5kIGZvY3VzZWQgb24gcGFyY2VsIHRyYWNraW5nIHRvIGVuaGFuY2UgY3VzdG9tZXIgc2VydmljZSBlZmZpY2llbmN5LiIiIgogICAgKQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx11.2" style="font-size:90%;color:#0000FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.3" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.4" style="font-size:90%;">receptionagent_context_en</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.5" style="font-size:90%;">():</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx12.2" style="font-size:90%;color:#0000FF;">return</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.3" style="font-size:90%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx13.2" style="font-size:90%;color:#9400D1;">""</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx13.3" style="font-size:90%;color:#9400D1;">"You<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.1"> </span>are<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.2"> </span>SuperTracy,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.3"> </span>an<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.4"> </span>AI<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.5"> </span>agent<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.6"> </span>helping<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.7"> </span>PostNL<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.8"> </span>customers<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.9"> </span>with<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.10"> </span>their<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.11"> </span>parcel<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.12"> </span>tracking<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.13"> </span>needs.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.14"> </span>You<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.15"> </span>provide<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.16"> </span>detailed<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.17"> </span>information<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.18"> </span>about<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.19"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.20"> </span>journey<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.21"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.22"> </span>parcels<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.23"> </span>using<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.24"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.25"> </span>given<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.26"> </span>barcode.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.27"> </span>Your<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.28"> </span>primary<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.29"> </span>function<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.30"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.31"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.32"> </span>guide<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.33"> </span>users<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.34"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.35"> </span>provide<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.36"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.37"> </span>barcode<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.38"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.39"> </span>their<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.40"> </span>parcel,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.41"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.42"> </span>then<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.43"> </span>use<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.44"> </span>that<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.45"> </span>information<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.46"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.47"> </span>fetch<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.48"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.49"> </span>relay<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.50"> </span>tracking<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.51"> </span>details.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.52"> </span>You<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.53"> </span>respond<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.54"> </span>in<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.55"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.56"> </span>helpful<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.57"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.58"> </span>professional<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.59"> </span>manner,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.60"> </span>always<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.61"> </span>prompting<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.62"> </span>users<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.63"> </span>for<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.64"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.65"> </span>barcode<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.66"> </span>if<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.67"> </span>it<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.68"> </span>hasnt<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.69"> </span>been<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.70"> </span>provided,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.71"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.72"> </span>handling<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.73"> </span>errors<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.74"> </span>or<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.75"> </span>questions<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.76"> </span>about<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.77"> </span>parcel<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.78"> </span>tracking<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.79"> </span>gracefully.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.80"> </span>If<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.81"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.82"> </span>barcode<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.83"> </span>provided<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.84"> </span>does<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.85"> </span>not<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.86"> </span>return<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.87"> </span>any<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.88"> </span>information<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.89"> </span>or<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.90"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.91"> </span>invalid,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.92"> </span>you<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.93"> </span>instruct<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.94"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.95"> </span>user<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.96"> </span>on<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.97"> </span>how<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.98"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.99"> </span>find<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.100"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.101"> </span>valid<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.102"> </span>barcode<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.103"> </span>or<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.104"> </span>suggest<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.105"> </span>alternative<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.106"> </span>solutions.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.107"> </span>When<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.108"> </span>you<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.109"> </span>do<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.110"> </span>not<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.111"> </span>know<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.112"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.113"> </span>answer<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.114"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.115"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.116"> </span>user’s<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.117"> </span>question,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.118"> </span>respond<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.119"> </span>with,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.120"> </span>I’m<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.121"> </span>sorry,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.122"> </span>I<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.123"> </span>don’t<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.124"> </span>have<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.125"> </span>information<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.126"> </span>on<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.127"> </span>that<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.128"> </span>topic.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.129"> </span>Please<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.130"> </span>provide<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.131"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.132"> </span>barcode<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.133"> </span>if<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.134"> </span>you<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.135"> </span>need<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.136"> </span>tracking<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.137"> </span>details.<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.138"> </span>Your<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.139"> </span>interactions<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.140"> </span>are<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.141"> </span>designed<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.142"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.143"> </span>be<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.144"> </span>clear,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.145"> </span>concise,<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.146"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.147"> </span>focused<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.148"> </span>on<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.149"> </span>parcel<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.150"> </span>tracking<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.151"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.152"> </span>enhance<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.153"> </span>customer<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.154"> </span>service<span class="ltx_text ltx_lst_space" id="lstnumberx13.3.155"> </span>efficiency."</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx13.4" style="font-size:90%;color:#9400D1;">""</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.2" style="font-size:90%;">)</span>
</div>
</div>
</div>
</li>
<li class="ltx_item" id="S3.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I4.i2.p1">
<p class="ltx_p" id="S3.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I4.i2.p1.1.1">Template for instructions for each agents</span>: The instruction templates tell agents what to do. In this template, variables can be used which refer to other prompt templates. In the example below, you see the variable context-str which refers to the template of the parcel report. Using that template, the agent can act based on the instructions.</p>
</div>
<div class="ltx_para" id="S3.I4.i2.p2">
<div class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing" id="S3.I4.i2.p2.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ICAgIGRlZiBwYXJjZWxhZ2VudF9jb250ZXh0X2VuKGNvbnRleHRfc3RyKToKICAgIHJldHVybiAoCiAgICAgICAgIiIiWW91IGFyZSBhIFBvc3ROTCBjdXN0b21lciBzZXJ2aWNlIEFJLiBZb3UgaGF2ZSBiZWVuIHByb3ZpZGVkIHdpdGggYSBjb21wcmVoZW5zaXZlIG92ZXJ2aWV3IG9mIHRoZSBqb3VybmV5IG9mIGEgcGFyY2VsLiBUaGlzIG92ZXJ2aWV3IGluY2x1ZGVzIHRpbWVsaW5lcywgZGV0YWlsZWQgZXZlbnQgZGVzY3JpcHRpb25zLCBhbmQgaW5zaWdodHMgaW50byB0aGUgcGFyY2VsJ3MgaGFuZGxpbmcgYW5kIHJvdXRlLiIKICAgICAgICAiSGVyZSBhcmUgdGhlIHJlbGV2YW50IGRldGFpbHMgZm9yIHRoZSBjb250ZXh0OiIKICAgICAgICAie2NvbnRleHRfc3RyfSIKICAgICAgICAiSW5zdHJ1Y3Rpb246IGdpdmUgYSBjb25jaXNlIGFuZCBzaG9ydCBzdG9yeSBhYm91dCBhIHBhcmNlbCdzIGpvdXJuZXkgZnJvbSBzaGlwbWVudCB0byBwb3RlbnRpYWwgZGVsaXZlcnkuIEhpZ2hsaWdodCBrZXkgZXZlbnRzIGFuZCBtb3ZlbWVudHMgYmV0d2VlbiBzb3J0aW5nIGNlbnRlcnMsIGltcG9ydGFudCB0aW1lbGluZXMsIGFuZCB0aGUgbG9naXN0aWNzIG9mIHBhcmNlbCBoYW5kbGluZy4gSW5jb3Jwb3JhdGUgcHJlZGljdGlvbnMgcmVnYXJkaW5nIHRoZSBmdXR1cmUgc3RhdGVzIG9mIHRoZSBwYXJjZWwuCgogIiIiCiAgICAp">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx15.2" style="font-size:90%;color:#0000FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.3" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.4" style="font-size:90%;">parcelagent_context_en</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.5" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.6" style="font-size:90%;">context_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.7" style="font-size:90%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx16.2" style="font-size:90%;color:#0000FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.4" style="font-size:90%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx17.2" style="font-size:90%;color:#9400D1;">""</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx17.3" style="font-size:90%;color:#9400D1;">"You<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.1"> </span>are<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.2"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.3"> </span>PostNL<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.4"> </span>customer<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.5"> </span>service<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.6"> </span>AI.<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.7"> </span>You<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.8"> </span>have<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.9"> </span>been<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.10"> </span>provided<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.11"> </span>with<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.12"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.13"> </span>comprehensive<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.14"> </span>overview<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.15"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.16"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.17"> </span>journey<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.18"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.19"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.20"> </span>parcel.<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.21"> </span>This<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.22"> </span>overview<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.23"> </span>includes<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.24"> </span>timelines,<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.25"> </span>detailed<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.26"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.27"> </span>descriptions,<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.28"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.29"> </span>insights<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.30"> </span>into<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.31"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.32"> </span>parcel’s<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.33"> </span>handling<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.34"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx17.3.35"> </span>route."</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx18.2" style="font-size:90%;color:#9400D1;">"Here<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.1"> </span>are<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.3"> </span>relevant<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.4"> </span>details<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.5"> </span>for<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.6"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx18.2.7"> </span>context:"</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx19.2" style="font-size:90%;color:#9400D1;">"{context_str}"</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx20.2" style="font-size:90%;color:#9400D1;">"Instruction:<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.1"> </span>give<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.2"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.3"> </span>concise<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.4"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.5"> </span>short<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.6"> </span>story<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.7"> </span>about<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.8"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.9"> </span>parcel’s<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.10"> </span>journey<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.11"> </span>from<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.12"> </span>shipment<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.13"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.14"> </span>potential<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.15"> </span>delivery.<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.16"> </span>Highlight<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.17"> </span>key<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.18"> </span>events<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.19"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.20"> </span>movements<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.21"> </span>between<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.22"> </span>sorting<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.23"> </span>centers,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.24"> </span>important<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.25"> </span>timelines,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.26"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.27"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.28"> </span>logistics<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.29"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.30"> </span>parcel<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.31"> </span>handling.<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.32"> </span>Incorporate<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.33"> </span>predictions<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.34"> </span>regarding<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.35"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.36"> </span>future<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.37"> </span>states<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.38"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.39"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.40"> </span>parcel.</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.1" style="font-size:90%;color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.2" style="font-size:90%;color:#9400D1;">"</span><span class="ltx_text ltx_lst_string" id="lstnumberx22.3"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.4" style="font-size:90%;color:#9400D1;">""</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.2" style="font-size:90%;">)</span>
</div>
</div>
</div>
</li>
<li class="ltx_item" id="S3.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I4.i3.p1">
<p class="ltx_p" id="S3.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I4.i3.p1.1.1">Template for creating a parcel report</span>: This template is based on Chain-of-Thought and introduces a step-by-step reasoning process for the agent on what to do with the input prompt. There are various steps which cant all be included here. But the general reasoning process for the agent is to extract the barcode from the input, and gather the related information from the provided data set. The key data is structured in a template, and passed to the parcel agent to generate a response with.</p>
</div>
</li>
<li class="ltx_item" id="S3.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S3.I4.i4.p1">
<p class="ltx_p" id="S3.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I4.i4.p1.1.1">Template for generating the output</span>: In this prompt template variables like the memory of the agent, the context window, the chat mode and optional follow up questions to ask are determined. Also the temperature of the agent can be defined, which is a parameter that controls the randomness of the model’s output, affecting how predictable or creative the generated text is. Based on this template, the agent will generate the response.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.3 </span>RAG architecture </h4>
<div class="ltx_para" id="S3.SS5.SSS3.p1">
<p class="ltx_p" id="S3.SS5.SSS3.p1.2">To address challenges and drawbacks of the fine-tuned model like hallucinations and performance issues, we leverage the power of RAG architecture and a vectorized database. RAG architecture combines retrieval and generative capabilities to enhance LLM responses. The architecture has two components: the retriever and the generator. The retriever fetches relevant documents or data segments from a large corpus, while the generator creates responses based on the retrieved information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib34" title="">34</a>]</cite>. Vector databases store data in vector format for efficient similarity searches. Embedding models convert textual data into high-dimensional vectors where semantically similar texts are closer together <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib35" title="">35</a>]</cite>. Hence, the similarity between a document <math alttext="\mathbf{d}" class="ltx_Math" display="inline" id="S3.SS5.SSS3.p1.1.m1.1"><semantics id="S3.SS5.SSS3.p1.1.m1.1a"><mi id="S3.SS5.SSS3.p1.1.m1.1.1" xref="S3.SS5.SSS3.p1.1.m1.1.1.cmml">𝐝</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS3.p1.1.m1.1b"><ci id="S3.SS5.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS3.p1.1.m1.1.1">𝐝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS3.p1.1.m1.1c">\mathbf{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS3.p1.1.m1.1d">bold_d</annotation></semantics></math> and a query <math alttext="\mathbf{q}" class="ltx_Math" display="inline" id="S3.SS5.SSS3.p1.2.m2.1"><semantics id="S3.SS5.SSS3.p1.2.m2.1a"><mi id="S3.SS5.SSS3.p1.2.m2.1.1" xref="S3.SS5.SSS3.p1.2.m2.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS3.p1.2.m2.1b"><ci id="S3.SS5.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS5.SSS3.p1.2.m2.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS3.p1.2.m2.1c">\mathbf{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS3.p1.2.m2.1d">bold_q</annotation></semantics></math> is computed using cosine similarity:</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{sim}(\mathbf{q},\mathbf{d})=\frac{\mathbf{q}\cdot\mathbf{d}}{\|\mathbf{q%
}\|\|\mathbf{d}\|}" class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.5" xref="S3.E9.m1.4.5.cmml"><mrow id="S3.E9.m1.4.5.2" xref="S3.E9.m1.4.5.2.cmml"><mtext id="S3.E9.m1.4.5.2.2" xref="S3.E9.m1.4.5.2.2a.cmml">sim</mtext><mo id="S3.E9.m1.4.5.2.1" xref="S3.E9.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.E9.m1.4.5.2.3.2" xref="S3.E9.m1.4.5.2.3.1.cmml"><mo id="S3.E9.m1.4.5.2.3.2.1" stretchy="false" xref="S3.E9.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">𝐪</mi><mo id="S3.E9.m1.4.5.2.3.2.2" xref="S3.E9.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml">𝐝</mi><mo id="S3.E9.m1.4.5.2.3.2.3" stretchy="false" xref="S3.E9.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.5.1" xref="S3.E9.m1.4.5.1.cmml">=</mo><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.4" xref="S3.E9.m1.2.2.4.cmml"><mi id="S3.E9.m1.2.2.4.2" xref="S3.E9.m1.2.2.4.2.cmml">𝐪</mi><mo id="S3.E9.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.2.2.4.1.cmml">⋅</mo><mi id="S3.E9.m1.2.2.4.3" xref="S3.E9.m1.2.2.4.3.cmml">𝐝</mi></mrow><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mrow id="S3.E9.m1.2.2.2.4.2" xref="S3.E9.m1.2.2.2.4.1.cmml"><mo id="S3.E9.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E9.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">𝐪</mi><mo id="S3.E9.m1.2.2.2.4.2.2" stretchy="false" xref="S3.E9.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.2.5.2" xref="S3.E9.m1.2.2.2.5.1.cmml"><mo id="S3.E9.m1.2.2.2.5.2.1" stretchy="false" xref="S3.E9.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">𝐝</mi><mo id="S3.E9.m1.2.2.2.5.2.2" stretchy="false" xref="S3.E9.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.5.cmml" xref="S3.E9.m1.4.5"><eq id="S3.E9.m1.4.5.1.cmml" xref="S3.E9.m1.4.5.1"></eq><apply id="S3.E9.m1.4.5.2.cmml" xref="S3.E9.m1.4.5.2"><times id="S3.E9.m1.4.5.2.1.cmml" xref="S3.E9.m1.4.5.2.1"></times><ci id="S3.E9.m1.4.5.2.2a.cmml" xref="S3.E9.m1.4.5.2.2"><mtext id="S3.E9.m1.4.5.2.2.cmml" xref="S3.E9.m1.4.5.2.2">sim</mtext></ci><interval closure="open" id="S3.E9.m1.4.5.2.3.1.cmml" xref="S3.E9.m1.4.5.2.3.2"><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">𝐪</ci><ci id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4">𝐝</ci></interval></apply><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2"></divide><apply id="S3.E9.m1.2.2.4.cmml" xref="S3.E9.m1.2.2.4"><ci id="S3.E9.m1.2.2.4.1.cmml" xref="S3.E9.m1.2.2.4.1">⋅</ci><ci id="S3.E9.m1.2.2.4.2.cmml" xref="S3.E9.m1.2.2.4.2">𝐪</ci><ci id="S3.E9.m1.2.2.4.3.cmml" xref="S3.E9.m1.2.2.4.3">𝐝</ci></apply><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></times><apply id="S3.E9.m1.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.4.2"><csymbol cd="latexml" id="S3.E9.m1.2.2.2.4.1.1.cmml" xref="S3.E9.m1.2.2.2.4.2.1">norm</csymbol><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝐪</ci></apply><apply id="S3.E9.m1.2.2.2.5.1.cmml" xref="S3.E9.m1.2.2.2.5.2"><csymbol cd="latexml" id="S3.E9.m1.2.2.2.5.1.1.cmml" xref="S3.E9.m1.2.2.2.5.2.1">norm</csymbol><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝐝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\text{sim}(\mathbf{q},\mathbf{d})=\frac{\mathbf{q}\cdot\mathbf{d}}{\|\mathbf{q%
}\|\|\mathbf{d}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">sim ( bold_q , bold_d ) = divide start_ARG bold_q ⋅ bold_d end_ARG start_ARG ∥ bold_q ∥ ∥ bold_d ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p3">
<p class="ltx_p" id="S3.SS5.SSS3.p3.1">Using “mxbai-embed-large” as embedding model, the mxbai-embed-large model, a transformer-based architecture, generates high-dimensional, semantically rich embeddings. It uses multi-head self-attention mechanisms, weighing the importance of different words in a sentence dynamically. The attention score <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S3.SS5.SSS3.p3.1.m1.1"><semantics id="S3.SS5.SSS3.p3.1.m1.1a"><msub id="S3.SS5.SSS3.p3.1.m1.1.1" xref="S3.SS5.SSS3.p3.1.m1.1.1.cmml"><mi id="S3.SS5.SSS3.p3.1.m1.1.1.2" xref="S3.SS5.SSS3.p3.1.m1.1.1.2.cmml">α</mi><mrow id="S3.SS5.SSS3.p3.1.m1.1.1.3" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS5.SSS3.p3.1.m1.1.1.3.2" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS5.SSS3.p3.1.m1.1.1.3.1" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.SSS3.p3.1.m1.1.1.3.3" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS3.p3.1.m1.1b"><apply id="S3.SS5.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1.2">𝛼</ci><apply id="S3.SS5.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1.3"><times id="S3.SS5.SSS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.1"></times><ci id="S3.SS5.SSS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS5.SSS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS5.SSS3.p3.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS3.p3.1.m1.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS3.p3.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as:</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{ij}=\frac{\exp(e_{ij})}{\sum_{k=1}^{n}\exp(e_{ik})}" class="ltx_Math" display="block" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.5" xref="S3.E10.m1.4.5.cmml"><msub id="S3.E10.m1.4.5.2" xref="S3.E10.m1.4.5.2.cmml"><mi id="S3.E10.m1.4.5.2.2" xref="S3.E10.m1.4.5.2.2.cmml">α</mi><mrow id="S3.E10.m1.4.5.2.3" xref="S3.E10.m1.4.5.2.3.cmml"><mi id="S3.E10.m1.4.5.2.3.2" xref="S3.E10.m1.4.5.2.3.2.cmml">i</mi><mo id="S3.E10.m1.4.5.2.3.1" xref="S3.E10.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.4.5.2.3.3" xref="S3.E10.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.4.5.1" xref="S3.E10.m1.4.5.1.cmml">=</mo><mfrac id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml"><mrow id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E10.m1.2.2.2.2a" xref="S3.E10.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E10.m1.2.2.2.2.1" xref="S3.E10.m1.2.2.2.3.cmml"><mo id="S3.E10.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E10.m1.2.2.2.3.cmml">(</mo><msub id="S3.E10.m1.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.2.cmml">e</mi><mrow id="S3.E10.m1.2.2.2.2.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.3.2" xref="S3.E10.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.2.2.2.2.1.1.3.1" xref="S3.E10.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.1.1.3.3" xref="S3.E10.m1.2.2.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E10.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.4.4.4" xref="S3.E10.m1.4.4.4.cmml"><msubsup id="S3.E10.m1.4.4.4.3" xref="S3.E10.m1.4.4.4.3.cmml"><mo id="S3.E10.m1.4.4.4.3.2.2" xref="S3.E10.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E10.m1.4.4.4.3.2.3" xref="S3.E10.m1.4.4.4.3.2.3.cmml"><mi id="S3.E10.m1.4.4.4.3.2.3.2" xref="S3.E10.m1.4.4.4.3.2.3.2.cmml">k</mi><mo id="S3.E10.m1.4.4.4.3.2.3.1" xref="S3.E10.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E10.m1.4.4.4.3.2.3.3" xref="S3.E10.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.4.4.4.3.3" xref="S3.E10.m1.4.4.4.3.3.cmml">n</mi></msubsup><mrow id="S3.E10.m1.4.4.4.2.1" xref="S3.E10.m1.4.4.4.2.2.cmml"><mi id="S3.E10.m1.3.3.3.1" xref="S3.E10.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E10.m1.4.4.4.2.1a" xref="S3.E10.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E10.m1.4.4.4.2.1.1" xref="S3.E10.m1.4.4.4.2.2.cmml"><mo id="S3.E10.m1.4.4.4.2.1.1.2" stretchy="false" xref="S3.E10.m1.4.4.4.2.2.cmml">(</mo><msub id="S3.E10.m1.4.4.4.2.1.1.1" xref="S3.E10.m1.4.4.4.2.1.1.1.cmml"><mi id="S3.E10.m1.4.4.4.2.1.1.1.2" xref="S3.E10.m1.4.4.4.2.1.1.1.2.cmml">e</mi><mrow id="S3.E10.m1.4.4.4.2.1.1.1.3" xref="S3.E10.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S3.E10.m1.4.4.4.2.1.1.1.3.2" xref="S3.E10.m1.4.4.4.2.1.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.4.4.4.2.1.1.1.3.1" xref="S3.E10.m1.4.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E10.m1.4.4.4.2.1.1.1.3.3" xref="S3.E10.m1.4.4.4.2.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E10.m1.4.4.4.2.1.1.3" stretchy="false" xref="S3.E10.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.5.cmml" xref="S3.E10.m1.4.5"><eq id="S3.E10.m1.4.5.1.cmml" xref="S3.E10.m1.4.5.1"></eq><apply id="S3.E10.m1.4.5.2.cmml" xref="S3.E10.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.5.2.1.cmml" xref="S3.E10.m1.4.5.2">subscript</csymbol><ci id="S3.E10.m1.4.5.2.2.cmml" xref="S3.E10.m1.4.5.2.2">𝛼</ci><apply id="S3.E10.m1.4.5.2.3.cmml" xref="S3.E10.m1.4.5.2.3"><times id="S3.E10.m1.4.5.2.3.1.cmml" xref="S3.E10.m1.4.5.2.3.1"></times><ci id="S3.E10.m1.4.5.2.3.2.cmml" xref="S3.E10.m1.4.5.2.3.2">𝑖</ci><ci id="S3.E10.m1.4.5.2.3.3.cmml" xref="S3.E10.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.4.4"><divide id="S3.E10.m1.4.4.5.cmml" xref="S3.E10.m1.4.4"></divide><apply id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2"><exp id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"></exp><apply id="S3.E10.m1.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.2">𝑒</ci><apply id="S3.E10.m1.2.2.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3"><times id="S3.E10.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.E10.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E10.m1.4.4.4.cmml" xref="S3.E10.m1.4.4.4"><apply id="S3.E10.m1.4.4.4.3.cmml" xref="S3.E10.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.4.3.1.cmml" xref="S3.E10.m1.4.4.4.3">superscript</csymbol><apply id="S3.E10.m1.4.4.4.3.2.cmml" xref="S3.E10.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.4.3.2.1.cmml" xref="S3.E10.m1.4.4.4.3">subscript</csymbol><sum id="S3.E10.m1.4.4.4.3.2.2.cmml" xref="S3.E10.m1.4.4.4.3.2.2"></sum><apply id="S3.E10.m1.4.4.4.3.2.3.cmml" xref="S3.E10.m1.4.4.4.3.2.3"><eq id="S3.E10.m1.4.4.4.3.2.3.1.cmml" xref="S3.E10.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E10.m1.4.4.4.3.2.3.2.cmml" xref="S3.E10.m1.4.4.4.3.2.3.2">𝑘</ci><cn id="S3.E10.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S3.E10.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.4.4.4.3.3.cmml" xref="S3.E10.m1.4.4.4.3.3">𝑛</ci></apply><apply id="S3.E10.m1.4.4.4.2.2.cmml" xref="S3.E10.m1.4.4.4.2.1"><exp id="S3.E10.m1.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.1"></exp><apply id="S3.E10.m1.4.4.4.2.1.1.1.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E10.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1.2">𝑒</ci><apply id="S3.E10.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1.3"><times id="S3.E10.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1.3.1"></times><ci id="S3.E10.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S3.E10.m1.4.4.4.2.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">\alpha_{ij}=\frac{\exp(e_{ij})}{\sum_{k=1}^{n}\exp(e_{ik})}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp ( italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_exp ( italic_e start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p5">
<p class="ltx_p" id="S3.SS5.SSS3.p5.1">where <math alttext="e_{ij}=\mathbf{q}_{i}\cdot\mathbf{k}_{j}" class="ltx_Math" display="inline" id="S3.SS5.SSS3.p5.1.m1.1"><semantics id="S3.SS5.SSS3.p5.1.m1.1a"><mrow id="S3.SS5.SSS3.p5.1.m1.1.1" xref="S3.SS5.SSS3.p5.1.m1.1.1.cmml"><msub id="S3.SS5.SSS3.p5.1.m1.1.1.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.cmml"><mi id="S3.SS5.SSS3.p5.1.m1.1.1.2.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.2.cmml">e</mi><mrow id="S3.SS5.SSS3.p5.1.m1.1.1.2.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.cmml"><mi id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.1" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS5.SSS3.p5.1.m1.1.1.1" xref="S3.SS5.SSS3.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS5.SSS3.p5.1.m1.1.1.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.cmml"><msub id="S3.SS5.SSS3.p5.1.m1.1.1.3.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2.cmml"><mi id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2.2.cmml">𝐪</mi><mi id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.SS5.SSS3.p5.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.1.cmml">⋅</mo><msub id="S3.SS5.SSS3.p5.1.m1.1.1.3.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3.cmml"><mi id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.2" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3.2.cmml">𝐤</mi><mi id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.3" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS3.p5.1.m1.1b"><apply id="S3.SS5.SSS3.p5.1.m1.1.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1"><eq id="S3.SS5.SSS3.p5.1.m1.1.1.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.1"></eq><apply id="S3.SS5.SSS3.p5.1.m1.1.1.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.SSS3.p5.1.m1.1.1.2.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS5.SSS3.p5.1.m1.1.1.2.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.2">𝑒</ci><apply id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3"><times id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.1"></times><ci id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.2">𝑖</ci><ci id="S3.SS5.SSS3.p5.1.m1.1.1.2.3.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS5.SSS3.p5.1.m1.1.1.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3"><ci id="S3.SS5.SSS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.1">⋅</ci><apply id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2.2">𝐪</ci><ci id="S3.SS5.SSS3.p5.1.m1.1.1.3.2.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.2.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3.2">𝐤</ci><ci id="S3.SS5.SSS3.p5.1.m1.1.1.3.3.3.cmml" xref="S3.SS5.SSS3.p5.1.m1.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS3.p5.1.m1.1c">e_{ij}=\mathbf{q}_{i}\cdot\mathbf{k}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS3.p5.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. The model passes input text through multiple layers of attention mechanisms and feed-forward neural networks, producing a dense vector that captures the text’s semantic meaning. This embedding is used for retrieval in RAG architectures. Mxbai-embed-large achieves state-of-the-art performance in NLP tasks, making it a reliable choice for embedding-based retrieval in RAG architectures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib36" title="">36</a>]</cite>. Optimizing the retriever, generator, and vector database is contributes to scalability. Verifying and validating generated responses are crucial to mitigate hallucinations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib37" title="">37</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p6">
<p class="ltx_p" id="S3.SS5.SSS3.p6.1">In order to input the parcel data into the implemented RAG architecture, an ETL pipeline is developed to Extract, Transform, and Load the parcels data. This pipeline consists of the following three steps:</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p7">
<ul class="ltx_itemize" id="S3.I5">
<li class="ltx_item" id="S3.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I5.i1.p1">
<p class="ltx_p" id="S3.I5.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I5.i1.p1.1.1">Extract</span>: Data is retrieved from the earlier mentioned sources (3.1), the main one being Collo.</p>
</div>
</li>
<li class="ltx_item" id="S3.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I5.i2.p1">
<p class="ltx_p" id="S3.I5.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I5.i2.p1.1.1">Transform</span>: Data is cleaned, normalized, and structured; for example, date formats are standardized, and missing values are handled.</p>
</div>
</li>
<li class="ltx_item" id="S3.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I5.i3.p1">
<p class="ltx_p" id="S3.I5.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I5.i3.p1.1.1">Load</span>: Transformed data is loaded into a vectorized database, ready for querying and analysis by LLMs.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS5.SSS3.p8">
<p class="ltx_p" id="S3.SS5.SSS3.p8.1">The integration of RAG architecture and the developed ETL pipeline enhances the precision and contextual richness of the responses of SuperTracy.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Overall System Architecture Overview</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">In the diagram below (Figure 2) you can see the architecture of the final system, where all the components come together that form SuperTracy. The architecture of the system is designed to ensure integration and effective collaboration among the agents and models. Key components include:</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="288" id="S3.F2.g1" src="extracted/5833211/supertracy.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><a class="ltx_ref ltx_href" href="https://drive.google.com/file/d/1QBwRVuOrS9tdSuwtSfhn0g1A_H8fq8a8/view?usp=sharing" title="">SuperTracy System Architecture</a></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F2.1"><a class="ltx_ref ltx_href" href="https://drive.google.com/file/d/1QBwRVuOrS9tdSuwtSfhn0g1A_H8fq8a8/view?usp=sharing" title="">*<span class="ltx_text ltx_font_italic" id="S3.F2.1.1.1">To view a higher resolution version of the SuperTracy architecture, please click here.</span>
</a></p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS6.p2">
<ul class="ltx_itemize" id="S3.I6">
<li class="ltx_item" id="S3.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i1.p1">
<p class="ltx_p" id="S3.I6.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i1.p1.1.1">LLAMA3 and GEMMA2</span>: LLMs serving as the backbone for different agents, providing advanced language understanding and generation capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib38" title="">38</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i2.p1">
<p class="ltx_p" id="S3.I6.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i2.p1.1.1">CLD3</span>: A neural network model for detecting the language of user queries, ensuring accurate processing of inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib28" title="">28</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i3.p1">
<p class="ltx_p" id="S3.I6.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i3.p1.1.1">MADLAD</span>: A text-to-text translation model facilitating multilingual support <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib39" title="">39</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i4.p1">
<p class="ltx_p" id="S3.I6.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i4.p1.1.1">mxbai-embed-large</span>: An embedding model used in the RAG architecture to enhance retrieval and augmentation processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib36" title="">36</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i5.p1">
<p class="ltx_p" id="S3.I6.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i5.p1.1.1">Random Forests Classifier and Regex Pattern Matching</span>: Models and methods for verifying the correctness of barcodes, enhancing the system’s reliability.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i6.p1">
<p class="ltx_p" id="S3.I6.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i6.p1.1.1">T5 model</span>: This model is used for logistic event prediction of the parcel.</p>
</div>
</li>
<li class="ltx_item" id="S3.I6.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I6.i7.p1">
<p class="ltx_p" id="S3.I6.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I6.i7.p1.1.1">Prompt Factory</span>: Prompt factory is the module where prompt engineering takes place and various prompt templates are created and managed.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.1">The integration of these components forms a cohesive system capable of addressing various user needs through the Reception, Parcel, and Knowledge Expert Agents. Each agent operates within its specialized domain, leveraging the strengths of the underlying models to provide accurate, relevant, and timely responses.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.6.1 </span>The final product and User-Interface</h4>
<div class="ltx_para" id="S3.SS6.SSS1.p1">
<p class="ltx_p" id="S3.SS6.SSS1.p1.1">This final stage required integrating all components and sub modules into a unified architecture, involving the following key steps:</p>
</div>
<div class="ltx_para" id="S3.SS6.SSS1.p2">
<ul class="ltx_itemize" id="S3.I7">
<li class="ltx_item" id="S3.I7.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I7.i1.p1">
<p class="ltx_p" id="S3.I7.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I7.i1.p1.1.1">System Integration</span>: Ensuring all components, including the fine-tuned LLMs, the RAG architecture, and the agents work together seamlessly was a challenging software engineering task. This included writing code, debugging, and optimizing system performance to handle user queries efficiently.</p>
</div>
</li>
<li class="ltx_item" id="S3.I7.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I7.i2.p1">
<p class="ltx_p" id="S3.I7.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I7.i2.p1.1.1">Web Platform Development</span>: Creating a user-friendly web interface that allows users to interact with the system. This platform serves as the front end, providing an intuitive and accessible means for users to query the knowledge expert agent and receive responses. The web-interface is visible in the figures in Appendix A.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS6.SSS1.p3">
<p class="ltx_p" id="S3.SS6.SSS1.p3.1">The successful execution of these procedures has led to the development of a comprehensive system that combines multiple LLMs into a fully operational and user-interactive system. This system not only provides answers to basic questions about PostNL-specific terminology but also offers advanced guidance on logistical situations, showcasing the advanced reasoning abilities of the LLMs.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation and Discussion</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Technical Evaluation of the model</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">SuperTracy is a MVP which hasn’t been deployed yet. Therefore, technical performance cannot be formally measured. Below are a few important implementation goals, that made the the finalization of this MVP possible. These implementation goals build further on the three research goals mentioned in section 1.3.</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Lightweight Deployment</span>: The system operates effectively on local machines with modest hardware. This has been achieved by using quantization and open source LLM models. For the deployment of the MVP of Supertracy, a MacBook Pro with chip M1 Max and 64 GB memory has been used. The reaction time of the system was always less than 2 second. Videos are taken of the performance.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Complete Local Integration</span>: All necessary modules and models used for SuperTracy are integrated and run entirely on the local system. This means that external API’s like Open-AI or Bedrock API’s are not used, which can be quite expensive on a large scale. Open source models like GEMMA 2 and LLAMA 3 have been used instead, which also ensure the company data stays on premise.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Integration with RAG Architecture</span>: The integration of agents with RAG architecture, allows agents to work individually or together to perform diverse and complex tasks. Using RAG has made it possible to specialize the LLMs for specific tasks, therefore enabling the business use-case. Through RAG, agents are able to utilize embedded documents to enhance their knowledge base. RAG also enables the system to recall its reasoning and used resources in contrast to the closed-source external LLMs which act as a black box.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Human Evaluation of the generated output by SuperTracy</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The research goals stated in section 1.3 state that a LLM-based system can be build in-house, and solve the business use-case of mimicking the role of a logistical expert, making sense of logistical events of a barcode and being able to communicate about it.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Evaluation of LLM models are challenging, as the output is diverse each time and can be evaluated against a variety of different metrics, like fluency, accuracy, trustworthiness, presence of bias, factuality, multilingual tasks, reasoning and more <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib7" title="">7</a>]</cite>. Also the task of the LLM can be diverse, for example summarizing, translating, question and answering or casual conversing. Therefore the first question is ’what’ to evaluate. For the case of SuperTracy, it has been decided together with the business experts, to evaluate on the factual and relevant information given in the parcel story. Aspects like fluency or multilingual performance and the performance of Knowledge Expert agent and recipient agent are left out of scope.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">The second question is ’how’ to evaluate. The two common evaluation methods are automatic evaluation and human evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib7" title="">7</a>]</cite>. For the evaluation of SuperTracy, Human evaluation is chosen, as available automated evaluation techniques or benchmarks are not suitable for evaluating factuality of the enterprise specific generated parcel stories <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib7" title="">7</a>]</cite>. When choosing human evaluation methods of LLMs, attention has to be paid to various crucial factors to guarantee the dependability and precision of assessments <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib40" title="">40</a>]</cite>. Important criteria are the number of evaluators being around 9 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib41" title="">41</a>]</cite>, evaluation criteria (’what’ to evaluate), and evaluator’s expertise level.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Experimental Setup of Human Evaluation</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">A panel of eight logistical domain experts of the supply chain team have been asked to critically review the output of SuperTracy based on the factual correctness of the generated parcel stories.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.1">A sample of 100 parcel barcodes have been selected, with the minimal requirements provided by the logistics expert to ensure that they represented complex logistical scenarios likely to challenge the system’s capabilities. These requirements have been provided by mentioning which ’waarneming’ codes indicate an unhappy journey flow. The sample of these barcodes containing the selected events have been given to the model to generate a parcel story for.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.1">These experts were asked to assess the factual correctness and relevance of the stories on a scale ranged from 1, indicating a very low level of correctness and relevance, to 5, representing an exemplary level of performance in the parcel story generation. Participants were asked to provide an explanation for a score lower than 3. In that way feedback and insight into lower scores have been achieved. It was decided together with the business experts, that a score of 3 was good enough and anything below indicated a low quality of the generated stories.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results of the evaluation of Domain Experts</h3>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Quantitative Results</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">The results of the given scores by the domain experts on the generated parcel stories by SuperTracy are shown in the figure below. The AI generated outputs are generally well-received by the logistics domain experts. The most common scores are 3 and 4, with a median score of 4. 75% of the generated parcel stories got the score of 3 or more. This reflects that most domain experts rated SuperTracy’s performance favorably. Comparing these results to the expected score of 3 or higher set by the domain experts, indicates that the performance of SuperTracy has been good enough to prove that it can solve the problem statement.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="363" id="S4.F3.g1" src="extracted/5833211/output.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Result of the Human Evaluation</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Qualitative Feedback</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">For the scores of lower than 3, the domain experts have provided reasoning for their choice. The main gist of the gathered feedback from the open answers is about incorrect generalizations or incorrect assumptions of a few event codes. These are summarized in the following points:</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">Incorrect assumptions and generalizations of some logistic events:</span> For example in the logistic events ’ETA was updated’ happens quite a few times at the end of a logistical sequence. This is interpreted as a delay by the model, but this is not necessarily a delay. Also according to the standard process of evening distribution ’Avonddistributie’ the route gets rescheduled, as they are in a planned network. Or in the morning planners can shift parcels from routes to improve the total planning. This has nothing to do with ’delay’ or ’unforeseen circumstances’ as SuperTracy calls it in the parcel stories.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Some steps are default in the process and are not interesting to show</span>: Sometimes it is possible to change something. This is present in the logistic event. For example, the event ’Changing ETA is possible’. But this does not mean that it has to be anticipated on, as its an automatic default released event. This doesn’t have to be mentioned in the parcel story. Only the actual made changes need to be mentioned. An example is that before the first sorting there is always a notification that ’it is not possible to change the date or time’. This is interpreted as a problem, but actually nothing went wrong. The information that is not valuable to share, should be distinguished upfront to make the outcome more clear to the recipient.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Data quality issues in location data</span>: The location data had some issues. Most of the locations were identified as sorting centres, but not all locations are sorting centers. There is a difference between sorting, distribution and retail locations. Not distinguishing between these different locations which execute different business processes, makes the parcel story less accurate.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Conclusion</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">The goal for this project was to create a MVP which can act as a show-case of the value that generative AI can bring for PostNL. Reflecting on the goals set at the beginning of the research in section 1.3, we can conclude that the goals have been achieved.
The main goals were to explore business use-cases that can be solved by Generative AI and creating a MVP to showcase the value to the business. Throughout the demo and the evaluation of SuperTracy by domain experts, a lot of positive reactions are received. The use-case of SuperTracy has inspired the supply chain team to consider using such a system to improve their workflow, and for the business stakeholders to further explore possibilities of refining for deployment. The demo of SuperTracy has also inspired the stakeholders to realize the value of leveraging generative AI techniques, by brainstorming on various new use-cases during the demo. Also the goal to use in-house solutions when designing and creating the system was achieved, by using open source LLM models and using local computing power for running the system. To further prove the value of the use-case, the Human Evaluation confirms that SuperTracy is a successful MVP that can mimic the track and tracing capabilities at PostNL by effectively creating a story of the parcel’s journey, receiving a score of higher than 3 in 75% of the cases. Interestingly, the feedback provided by the subject matter experts, were mostly about the quality of the input data, and not the LLM-based model itself. At the same time, PostNL is working on strengthening their data fundament, which will result in better data quality, which forms the base of a good performing LLM system.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">All together, the creation of SuperTracy has been successful and contributed to the maturity of using generative AI solutions in PostNL, shedding light to its possibilities and business value, all done with the least amount of resources. This undermines the sometimes implicit assumption that adapting to generative AI technologies are expensive or out of reach.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Future Work</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">Future work depends on the scope, being the MVP or for scaling up through deployment. The MVP worked well, but could be improved. Future improvements to MVP of SuperTracy are refining the system’s ability to identify and communicate only the most relevant information, ensuring clarity and precision in the narratives. This can be done by removing auto generated default events in cases for events that can always be neglected. If events are interesting in some cases, a knowledge graph can be designed, which allows inference to understand the difference. Also the evaluation could be more extensive on diverse aspect. Human evaluation or Automatic evaluation methods could be used for aspects like fluency or multilingual performance. The additional aspects of the model could also be further evaluated, such as the individual performance of the logistic event prediction based on the T5 model.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">The broader scope can be the deployment of SuperTracy and further specifying its use-case. In the case of deployment, it is important to pay significant attention to data privacy and security, preventing oversharing sensitive information with the AI system, which are common challenges when leveraging LLMs in business.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02711v1#bib.bib5" title="">5</a>]</cite>. This requires awareness of designing and using AI solutions in an enterprise. Next to the secure deployment, maintaining and increasing the data quality of the used data sets to fine-tune the LLM models are very important. In the evaluation some data quality issues have already been pointed out which deserve further attention. After all, the execution of this MVP has shown that the used methodologies provide value for the use-case. These same methods, technologies and approach can be used for other use-cases too.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
PostNL: <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Annual Report 2023</span>.<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://annualreport.postnl.nl/2023/xmlpages/tan/files?p_file_id=866" title="">https://annualreport.postnl.nl/2023/xmlpages/tan/files?p_file_id=866</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Banh, L., Strobel, G.: Generative Artificial Intelligence. Electronic Markets 33(1), 63 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Wu, T.Y., He, S.Z., Liu, J.P., Sun, S.Q., Liu, K., Han, Q.-L., Tang, Y.: A Brief Overview of ChatGPT: The History, Status Quo and Potential Future Development. IEEE/CAA J. Autom. Sinica 10(5), 1122–1136 (2023). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/JAS.2023.123618" title="">https://doi.org/10.1109/JAS.2023.123618</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Teubner, T., Flath, C. M., Weinhardt, C., van der Aalst, W., Hinz, O.:
Welcome to the Era of ChatGPT et al.: The Prospects of Large Language Models.
<span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Business &amp; Information Systems Engineering</span>, 65(2), 95–101 (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Arman, M., Lamiyar, U.R.: Exploring the Implication of ChatGPT AI for Business: Efficiency and Challenges. International Journal of Marketing and Digital Creative 1(2), 64–84 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Zhao, H., Jia, J., Koltun, V.: Exploring Self-Attention for Image Recognition. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pp. 10076–10085 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chang, Y., Wang, X., Wang, J., Wu, Y., Yang, L., Zhu, K., Xie, X.: A Survey on Evaluation of Large Language Models. ACM Transactions on Intelligent Systems and Technology 15(3), 1–45 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Liu, Z., Qiao, A., Neiswanger, W., Wang, H., Tan, B., Tao, T., Xing, E.P.: LLM360: Towards Fully Transparent Open-Source LLMs. arXiv preprint arXiv:2312.06550 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Kukreja, S., Kumar, T., Purohit, A., Dasgupta, A., Guha, D.: A literature survey on open source large language models. <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2024 7th International Conference on Computers in Management and Business</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1145/3647782.3647803" title="">http://dx.doi.org/10.1145/3647782.3647803</a> (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
VM, K., Warrier, H., Gupta, Y.: Fine Tuning LLM for Enterprise: Practical Guidelines and Recommendations. arXiv preprint arXiv:2404.10779 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Zhang, Y., Li, Y., Cui, L., Cai, D., Liu, L., Fu, T., Huang, X., Zhao, E., Zhang, Y., Chen, Y., et al.: Siren’s Song in the AI Ocean: A Survey on Hallucination in Large Language Models. arXiv preprint arXiv:2309.01219 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Gao, Y., Xiong, Y., Gao, X., Jia, K., Pan, J., Bi, Y., Dai, Y., Sun, J., Wang, M., Wang, H.: Retrieval-Augmented generation for large language models: A survey. <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2312.10997</span> (2023). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.10997" title="">https://arxiv.org/abs/2312.10997</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Sorensen, T., Robinson, J., Rytting, C. M., Shaw, A. G., Rogers, K. J., Delorey, A. P., Khalil, M., Fulda, N., Wingate, D.: An information-theoretic approach to prompt engineering without ground truth labels. <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2203.11364</span> (2022). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2203.11364" title="">https://arxiv.org/abs/2203.11364</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Marvin, G., Hellen, N., Jjingo, D., Nakatumba-Nabende, J.: Prompt Engineering in Large Language Models. In: International Conference on Data Intelligence and Cognitive Informatics, pp. 387–402, Springer Nature Singapore, Singapore (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Bsharat, S. M., Myrzakhan, A., Shen, Z.: Principled instructions are all you need for questioning llama-1/2, GPT-3.5/4. <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2312.16171</span> (2023). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.16171" title="">https://arxiv.org/abs/2312.16171</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Sahoo, P., Singh, A.K., Saha, S., Jain, V., Mondal, S., Chadha, A.: A Systematic Survey of Prompt Engineering in Large Language Models: Techniques and Applications. arXiv preprint arXiv:2402.07927 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Kaplan, J., McCandlish, S., Henighan, T., Brown, T.B., Chess, B., Child, R., Gray, S., Radford, A., Wu, J., Amodei, D.: Scaling Laws for Neural Language Models. arXiv preprint arXiv:2001.08361 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Liu, S., Liu, Z., Huang, X., Dong, P., Cheng, K.-T.: LLM-FP4: 4-Bit floating-point quantized transformers. <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2310.16836</span> (2023). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.16836" title="">https://arxiv.org/abs/2310.16836</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jacob, B., Kligys, S., Chen, B., Zhu, M., Tang, M., Howard, A., et al.: Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference. <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</span>, pages 2704-2713. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openaccess.thecvf.com/content_cvpr_2018/html/Jacob_Quantization_and_Training_CVPR_2018_paper.html" title="">https://openaccess.thecvf.com/content_cvpr_2018/html/Jacob_Quantization_and_Training_CVPR_2018_paper.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., Zhou, Y., Li, W., Liu, P. J.: Exploring the limits of transfer learning with a unified text-to-text transformer. <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1910.10683</span> (2019). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1910.10683" title="">https://arxiv.org/abs/1910.10683</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Hadi, M.U., Qureshi, R., Shah, A., Irfan, M., Zafar, A., Shaikh, M.B., Mirjalili, S.: A Survey on Large Language Models: Applications, Challenges, Limitations, and Practical Usage. Authorea Preprints (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., et al.: Attention is all you need. <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</span>, 30. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1706.03762" title="">https://arxiv.org/abs/1706.03762</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., et al.: Exploring the limits of transfer learning with a unified text-to-text transformer. <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Journal of Machine Learning Research</span>, 21(140), 1-67 (2020). <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v21/20-074.html" title="">http://jmlr.org/papers/v21/20-074.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Zhao, A., Huang, D., Xu, Q., Lin, M., Liu, Y.J., Huang, G.: Expel: LLM Agents Are Experiential Learners. In: Proceedings of the AAAI Conference on Artificial Intelligence, vol. 38, no. 17, pp. 19632–19642 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Guo, T., Chen, X., Wang, Y., Chang, R., Pei, S., Chawla, N. V., Wiest, O., Zhang, X.: Large Language Model based Multi-Agents: A survey of progress and challenges. <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2402.01680</span> (2024). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.01680" title="">https://arxiv.org/abs/2402.01680</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Hacker, W., Sachse, P., Schroda, F.: Design Thinking-Possible Ways to Successful Solutions in Product Development. In: Designers: The Key to Successful Product Development, pp. 205–216, Springer London, London (1998)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Zhao, J., Zhang, Z., Zhang, Q., Gui, T., Huang, X.: Llama Beyond English: An Empirical Study on Language Capability Transfer. arXiv preprint arXiv:2401.01055 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Ooms, J.: cld3: Google’s Compact Language Detector 3 (Version 1.6.0) [R package]. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://docs.ropensci.org/cld3/" title="">https://docs.ropensci.org/cld3/</a>, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ropensci/cld3" title="">https://github.com/ropensci/cld3</a>, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ropensci.r-universe.dev/cld3" title="">https://ropensci.r-universe.dev/cld3</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M. W., Lee, K., Toutanova, K.: BERT: Pre-training of deep bidirectional transformers for language understanding. In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</span>, pages 4171-4186. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.aclweb.org/anthology/N19-1423/" title="">https://www.aclweb.org/anthology/N19-1423/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
AI@Meta: Meta-Llama-3-8B(2024). <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md" title="">https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Taori, R., Gulrajani, I., Zhang, T., Dubois, Y., Li, X., Guestrin, C., Liang, P., Hashimoto, T.B.: Alpaca: A Strong, Replicable Instruction-Following Model. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://crfm.stanford.edu/2023/03/13/alpaca.html" title="">https://crfm.stanford.edu/2023/03/13/alpaca.html</a> (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Hugging Face: Training Large Language Models with Hugging Face’s SFTTrainer. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://crfm.stanford.edu/2023/03/13/alpaca.html" title="">https://crfm.stanford.edu/2023/03/13/alpaca.html</a> (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Hu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, L., et al.: LORA: Low-Rank Adaptation of Large Language Models. <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2106.09685</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2106.09685" title="">https://arxiv.org/abs/2106.09685</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Karpukhin, V., Oguz, B., Min, S., Lewis, P., Wu, L., Edunov, S., et al.: Dense Passage Retrieval for Open-Domain Question Answering. <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2004.04906</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2004.04906" title="">https://arxiv.org/abs/2004.04906</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., et al.: Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks. <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2005.11401</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2005.11401" title="">https://arxiv.org/abs/2005.11401</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Lee, S., Shakir, A., Koenig, D., Lipp, J.: Open Source Strikes Bread - New Fluffy Embeddings Model. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.mixedbread.ai/blog/mxbai-embed-large-v1" title="">https://www.mixedbread.ai/blog/mxbai-embed-large-v1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Li, X., Li, J.: AnglE-optimized Text Embeddings. <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2309.12871</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2309.12871" title="">https://arxiv.org/abs/2309.12871</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Gemma Team, Google DeepMind: Gemma 2: Improving open language models at a practical size. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://stoRAGe.googleapis.com/deepmind-media/gemma/gemma-2-report.pdf" title="">https://stoRAGe.googleapis.com/deepmind-media/gemma/gemma-2-report.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Kudugunta, S., Caswell, I., Zhang, B., Garcia, X., Choquette-Choo, C. A., Lee, K., Xin, D., Kusupati, A., Stella, R., Bapna, A., Firat, O.: MADLAD-400: A Multilingual And Document-Level Large Audited Dataset. <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">arXiv</span>. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2309.04662" title="">https://arxiv.org/abs/2309.04662</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Singhal, K., Azizi, S., Tu, T., Mahdavi, S.S., Wei, J., Chung, H.W., Scales, N., Tanwani, A., Cole-Lewis, H., Pfohl, S., et al.: Large Language Models Encode Clinical Knowledge. Nature 620(7972), 172–180 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Belz, A., Reiter, E.: Comparing Automatic and Human Evaluation of NLG Systems. In: 11th Conference of the European Chapter of the Association for Computational Linguistics, pp. 313–320 (2006)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Pt0.Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendices</h2>
</section>
<section class="ltx_appendix" id="Pt0.A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>Illustrations of various applications of SuperTracy, including user queries and system responses.</h2>
<div class="ltx_para" id="Pt0.A1.p1">
<p class="ltx_p" id="Pt0.A1.p1.1"><span class="ltx_text ltx_font_italic" id="Pt0.A1.p1.1.1">*The illustrations include certain business-related information pertaining to PostNL, which has been redacted at the request of the company. </span></p>
</div>
<figure class="ltx_figure" id="Pt0.A1.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="422" id="Pt0.A1.F4.g1" src="extracted/5833211/image.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F4.2.1">Reception Agent Demo:</span>
Helping newcomers to the Netherlands send parcels back home </figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="294" id="Pt0.A1.F5.g1" src="extracted/5833211/image1.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F5.3.1">Parcel Agent: </span>Predicting the next likely events of an undelivered parcel<span class="ltx_text ltx_font_bold ltx_font_italic" id="Pt0.A1.F5.4.2"> <span class="ltx_text ltx_font_upright" id="Pt0.A1.F5.4.2.1"> </span></span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="271" id="Pt0.A1.F6.g1" src="extracted/5833211/image2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F6.3.1">Parcel Agent: </span> Recognizing an Unhappy Flow of a parcel, with feedback on Data Quality <span class="ltx_text ltx_font_bold" id="Pt0.A1.F6.4.2"> </span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="329" id="Pt0.A1.F7.g1" src="extracted/5833211/image3.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F7.2.1">Parcel Agent: </span>Analyzing a package that has been through a rough and unfortunate journey </figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="Pt0.A1.F8.g1" src="extracted/5833211/image4.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F8.2.1">Knowledge Expert Agent: </span>Asking about a PostNL internal specific process </figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="396" id="Pt0.A1.F9.g1" src="extracted/5833211/image5.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F9.2.1">Knowledge Expert Agent: </span>A general question on CO2 emissions of PostNL vehicles. </figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="422" id="Pt0.A1.F10.g1" src="extracted/5833211/image6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F10.3.1">Knowledge Expert Agent: </span>Helping a new intern with understanding PostNL abbreviations<span class="ltx_text ltx_font_bold" id="Pt0.A1.F10.4.2"> </span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="83" id="Pt0.A1.F11.g1" src="extracted/5833211/image7.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="Pt0.A1.F11.2.1">Knowledge Expert Agent:</span> </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="Pt0.A1.F11.3">Asking an advice on a PostNl specific complex situation (including PostNL abbreviations)<span class="ltx_text ltx_font_bold" id="Pt0.A1.F11.3.1"> </span></p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="Pt0.A1.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="283" id="Pt0.A1.F12.g1" src="extracted/5833211/image8.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Respond to question in Figure 11</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep  4 13:30:24 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
