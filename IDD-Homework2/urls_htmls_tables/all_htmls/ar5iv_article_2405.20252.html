<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Yuchi Liu
    <br class="ltx_break"/>
    Australian National University
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id1.1.id1">
     yuchi.liu@anu.edu.au
    </span>
    <br class="ltx_break"/>
    &amp;Jaskirat Singh
    <br class="ltx_break"/>
    Australian National University
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id2.2.id2">
     Jaskirat.Singh@anu.edu.au
    </span>
    <br class="ltx_break"/>
    Gaowen Liu
    <br class="ltx_break"/>
    Cisco Research
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id3.3.id3">
     gaoliu@cisco.com
    </span>
    <br class="ltx_break"/>
    &amp;Ali Payani
    <br class="ltx_break"/>
    Cisco Research
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id4.4.id4">
     apayani@cisco.com
    </span>
    <br class="ltx_break"/>
    &amp;Liang Zheng
    <br class="ltx_break"/>
    Australian National University
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id5.5.id5">
     liang.zheng@anu.edu.au
    </span>
    <br class="ltx_break"/>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id6.id1">
   Large language models (LLMs) have shown great progress in responding to user questions, allowing for a multitude of diverse applications. Yet, the quality of LLM outputs heavily depends on the prompt design, where a good prompt might enable the LLM to answer a very challenging question correctly. Therefore, recent works developed many strategies for improving the prompt, including both manual crafting and in-domain optimization.
However, their efficacy in unrestricted scenarios remains questionable, as the former depends on human design for specific questions and the latter usually generalizes poorly to unseen scenarios.
To address these problems, we give LLMs the freedom to design the best prompts according to themselves. Specifically, we include a hierarchy of LLMs, first constructing a prompt with precise instructions and accurate wording in a hierarchical manner, and then using this prompt to generate the final answer to the user query. We term this pipeline Hierarchical Multi-Agent Workflow, or HMAW.
In contrast with prior works, HMAW imposes no human restriction and requires no training, and is
completely task-agnostic while capable of adjusting to the nuances of the underlying task.
Through both quantitative and qualitative experiments across multiple benchmarks, we verify that despite its simplicity, the proposed approach can create detailed and suitable prompts, further boosting the performance of current LLMs.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Large language models (LLMs) can perform a wide range of tasks such as creating detailed literary works and generating computer codes. Yet they often give unsatisfactory responses when the prompt is poorly designed. To design better prompts that make the LLM more effective, prompt optimization has been extensively explored in recent years. Specifically, existing works on prompt optimization can be categorized as follows.
The first category involves the manual design of prompts, such as the chain of thought (CoT)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:90%;">
       1
      </span>
     </a>
     ]
    </cite>
    and its variants
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib2" title="">
      <span class="ltx_text" style="font-size:90%;">
       2
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib3" title="">
      <span class="ltx_text" style="font-size:90%;">
       3
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      <span class="ltx_text" style="font-size:90%;">
       4
      </span>
     </a>
     ]
    </cite>
    .
The second category focuses on optimizing prompts on a training set that contains input-response pairs to learn a golden prompt, as demonstrated by APE
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ]
    </cite>
    .
The third category also uses handcrafted prompts, but different from the first category, the handcrafted prompts include examples that can guide an LLM agent to further generate prompts for a second LLM that actually provide the answer,
    <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">
     e.g
    </em>
    .
    <span class="ltx_text" id="S1.p1.1.2">
    </span>
    , ExpertPrompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:90%;">
       6
      </span>
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    However, these methods generally have limited generalization performance across various tasks, as shown in Fig.
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (a), (b), and (c).
The first category
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:90%;">
       1
      </span>
     </a>
     ]
    </cite>
    relies on
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">
     handcrafted prompts
    </span>
    . While they are very useful for tasks such as math, the same prompting method, if applied to other tasks, would be less effective.
The second category,
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:90%;">
       7
      </span>
     </a>
     ]
    </cite>
    ,
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">
     fine-tuned
    </span>
    on a specific dataset, can obtain good performance for in-domain tasks. However, these learned prompts from one domain might fail for other tasks, making them not task-agnostic.
The third category
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ]
    </cite>
    , which
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.3">
     uses LLM to adjust the prompt
    </span>
    , is still limited by the pre-defined examples in the handcrafted prompts. These examples only cover a finite number of scenarios and can potentially limit the quality of the modified prompt.
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.2">
    In this paper, we introduce a more generalizable prompt optimization method named hierarchical multi-agent workflow (HMAW). In a nutshell, our method mimics the hierarchy in companies, where the CEO and the manager create the guidelines for workers, and workers execute user-specified tasks while following these guidelines. Similarly, our method has a CEO
    <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.p3.1.m1.1">
     <semantics id="S1.p3.1.m1.1a">
      <mo id="S1.p3.1.m1.1.1" stretchy="false" xref="S1.p3.1.m1.1.1.cmml">
       →
      </mo>
      <annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b">
       <ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">
        →
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">
       \rightarrow
      </annotation>
     </semantics>
    </math>
    Manager
    <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.p3.2.m2.1">
     <semantics id="S1.p3.2.m2.1a">
      <mo id="S1.p3.2.m2.1.1" stretchy="false" xref="S1.p3.2.m2.1.1.cmml">
       →
      </mo>
      <annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b">
       <ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">
        →
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">
       \rightarrow
      </annotation>
     </semantics>
    </math>
    Worker workflow, which takes the initial user query as input and outputs the user response.
The CEO and the Manager LLMs work in a hierarchical manner to generate accurate and detailed instructions, which are then used as prompts for the Worker LLM to generate the final answer.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Compared with existing prompt optimization methods, HMAW has two advantages that contribute to its generalization ability.
First, having a hierarchy of LLM agents that each has its own job greatly simplifies the task for them. In this way, LLMs can either focus on either the overall goal (CEO), or creating a more detailed checklist (Manager), or giving specific answers (Worker).
Second, our method does not require few-shot examples or any training set, thus does not fit to certain tasks, and has the additional benefit to be easy to use. As such, our method is zero-shot, task-agnostic, and prompt-specific. We compare HMAW with existing literature in Table
    <a class="ltx_ref" href="#S2.T1" title="Table 1 ‣ 2 Related Work ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    On multiple benchmarks, we experimentally verify the effectiveness of the proposed hierarchical approach. When combined with Mixtral
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib8" title="">
      <span class="ltx_text" style="font-size:90%;">
       8
      </span>
     </a>
     ]
    </cite>
    , HMAW achieves a significant average improvement of 30.7% across 5 datasets. The code for our work is available at
    <a class="ltx_ref ltx_href" href="https://github.com/liuyvchi/HMAW" target="_blank" title="">
     here
    </a>
    <span class="ltx_note ltx_role_footnote" id="footnote1">
     <sup class="ltx_note_mark">
      1
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_tag ltx_tag_note">
        1
       </span>
       <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/liuyvchi/HMAW" target="_blank" title="">
        https://github.com/liuyvchi/HMAW
       </a>
      </span>
     </span>
    </span>
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <p class="ltx_p ltx_align_center ltx_align_center" id="S1.F1.1.1">
    <span class="ltx_text" id="S1.F1.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="144" id="S1.F1.1.1.1.g1" src="/html/2405.20252/assets/x1.png" width="461"/>
    </span>
   </p>
   <br class="ltx_break ltx_break"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F1.3.1">
     Examples comparing the generalization ability of existing methods and the proposed one.
    </span>
    (a) COT
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:90%;">
       1
      </span>
     </a>
     ]
    </cite>
    uses a handcrafted prompt, which might not be suitable for all tasks.
(b) APE
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ]
    </cite>
    fine-tunes the prompt on a specific dataset, and its generalization capability to other scenarios is questionable.
(c) ExperPrompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:90%;">
       6
      </span>
     </a>
     ]
    </cite>
    includes few-shot examples in the system prompt to help an LLM convert the user query to a format more suitable for LLM, but these examples might not be able to cover all scenarios.
(d) Our method adopts a hierarchical design in reformatting the user query. Free from pre-defined few-shot examples, the interaction between the LLM hierarchy allows for more generalizable yet more adaptive tuning of the prompt.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Manual prompt engineering
    </span>
    integrates human-like problem-solving knowledge.
For example, few-shot prompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib9" title="">
      <span class="ltx_text" style="font-size:90%;">
       9
      </span>
     </a>
     ]
    </cite>
    allows language models (LMs) to generate responses by providing them with explicit examples. The chain-of-thought (CoT) method
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:90%;">
       1
      </span>
     </a>
     ]
    </cite>
    , along with its variants such as zero-shot CoT
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib2" title="">
      <span class="ltx_text" style="font-size:90%;">
       2
      </span>
     </a>
     ]
    </cite>
    , graph-of-thought (GoT)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib3" title="">
      <span class="ltx_text" style="font-size:90%;">
       3
      </span>
     </a>
     ]
    </cite>
    , and tree-of-thought (ToT)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib4" title="">
      <span class="ltx_text" style="font-size:90%;">
       4
      </span>
     </a>
     ]
    </cite>
    , intricately designs prompts to emulate various types of human-like reasoning processes. Some other works
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib10" title="">
      <span class="ltx_text" style="font-size:90%;">
       10
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib11" title="">
      <span class="ltx_text" style="font-size:90%;">
       11
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib12" title="">
      <span class="ltx_text" style="font-size:90%;">
       12
      </span>
     </a>
     ]
    </cite>
    manually craft prompts that encourage LLMs to engage in critical thinking and verification processes before delivering the final answer. Those manual prompt engineering techniques typically require carefully tailored prompts for various tasks, and for each task, the prompts used remain the same across different user queries. In comparison, we design a task-agnostic prompter that can create tailored prompts for every user query.
   </p>
  </div>
  <figure class="ltx_table" id="S2.T1">
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="S2.T1.1">
    <tr class="ltx_tr" id="S2.T1.1.1">
     <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S2.T1.1.1.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.1.1.1" style="font-size:90%;">
       Method
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.1.1.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.1.2.1" style="font-size:90%;">
       Zero-Shot
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.1.1.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.1.3.1" style="font-size:90%;">
       Task-agnostic
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_tt" id="S2.T1.1.1.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.1.4.1" style="font-size:90%;">
       Query-Specific
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.2">
     <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.2.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.2.1.1" style="font-size:90%;">
       Chain of Thought (CoT)
      </span>
      <cite class="ltx_cite ltx_citemacro_cite">
       <span class="ltx_text" id="S2.T1.1.2.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib1" title="">
        <span class="ltx_text" style="font-size:90%;">
         1
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.2.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.2.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.1.2.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.2.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.2.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.2.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.1.2.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.2.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.2.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.2.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.2.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.2.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.2.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.2.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.3">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.3.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.3.1.1" style="font-size:90%;">
       Zero-shot CoT
      </span>
      <cite class="ltx_cite ltx_citemacro_cite">
       <span class="ltx_text" id="S2.T1.1.3.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib2" title="">
        <span class="ltx_text" style="font-size:90%;">
         2
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.3.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.3.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.3.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.3.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.3.2.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.3.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.3.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.3.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.3.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.3.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.3.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.3.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.3.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.3.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.4">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.4.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.4.1.1" style="font-size:90%;">
       Static ExpertPromting
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.4.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib6" title="">
        <span class="ltx_text" style="font-size:90%;">
         6
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.4.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.4.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.4.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.4.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.4.2.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.4.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.4.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.4.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.4.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.4.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.4.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.4.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.4.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.4.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.5">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.5.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.5.1.1" style="font-size:90%;">
       Dynamic ExpertPromting
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.5.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib6" title="">
        <span class="ltx_text" style="font-size:90%;">
         6
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.5.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.5.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.5.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.5.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.5.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.5.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.5.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.5.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.5.3.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.5.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.5.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.5.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.5.4.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.5.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.6">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.6.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.6.1.1" style="font-size:90%;">
       on Meta-Prompting
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.6.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib13" title="">
        <span class="ltx_text" style="font-size:90%;">
         13
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.6.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.6.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.6.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.6.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.6.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.6.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.6.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.6.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.6.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.6.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.6.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.6.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.6.4.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.6.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.7">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.7.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.7.1.1" style="font-size:90%;">
       Rephrase and Response
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.7.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib14" title="">
        <span class="ltx_text" style="font-size:90%;">
         14
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.7.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.7.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.7.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.7.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.7.2.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.7.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.7.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.7.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.7.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.7.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.7.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.7.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.7.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.7.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.8">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.8.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.8.1.1" style="font-size:90%;">
       Multi-Persona
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.8.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib15" title="">
        <span class="ltx_text" style="font-size:90%;">
         15
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.8.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.8.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.8.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.8.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.8.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.8.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.8.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.8.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.8.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.8.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.8.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.8.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.8.4.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.8.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.9">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.9.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.9.1.1" style="font-size:90%;">
       APE
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.9.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib5" title="">
        <span class="ltx_text" style="font-size:90%;">
         5
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.9.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.9.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.9.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.9.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.9.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.9.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.9.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.9.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.9.3.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.9.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.9.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.9.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.9.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.9.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.10">
     <td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.10.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.10.1.1" style="font-size:90%;">
       PromptAgent
      </span>
      <cite class="ltx_cite ltx_citemacro_citep">
       <span class="ltx_text" id="S2.T1.1.10.1.2.1" style="font-size:90%;">
        [
       </span>
       <a class="ltx_ref" href="#bib.bib16" title="">
        <span class="ltx_text" style="font-size:90%;">
         16
        </span>
       </a>
       <span class="ltx_text" id="S2.T1.1.10.1.3.2" style="font-size:90%;">
        ]
       </span>
      </cite>
      <span class="ltx_text" id="S2.T1.1.10.1.4" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.10.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.10.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.10.2.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.10.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.10.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.10.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.10.3.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.10.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center" id="S2.T1.1.10.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.10.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.10.4.2" style="font-size:90%;color:#FF0000;">
       ✗
      </span>
      <span class="ltx_text" id="S2.T1.1.10.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="S2.T1.1.11">
     <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S2.T1.1.11.1" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.11.1.1" style="font-size:90%;">
       HMAW (Ours)
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S2.T1.1.11.2" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.11.2.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.11.2.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.11.2.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S2.T1.1.11.3" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.11.3.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.11.3.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.11.3.3" style="font-size:90%;">
      </span>
     </td>
     <td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.11.4" style="padding-left:17.1pt;padding-right:17.1pt;">
      <span class="ltx_text" id="S2.T1.1.11.4.1" style="font-size:90%;">
      </span>
      <span class="ltx_text" id="S2.T1.1.11.4.2" style="font-size:90%;color:#00FF00;">
       ✓
      </span>
      <span class="ltx_text" id="S2.T1.1.11.4.3" style="font-size:90%;">
      </span>
     </td>
    </tr>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 1:
    </span>
    Method comparison based on various properties. Our method is zero-shot, task-agnostic, and query-specific, which are useful for dealing with diverse tasks.
   </figcaption>
  </figure>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     Automated prompt engineering methods.
    </span>
    Instead of using fixed hand crafted in-context prompts, automated prompt engineering methods are attracting increasing attention. This line of research aims to let LLMs be prompt generators which automatically generate specific prompts for each user query so that LLMs can respond better. Recent methods include automatic prompt engineer (APE)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ]
    </cite>
    , expert prompting (EP)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:90%;">
       6
      </span>
     </a>
     ]
    </cite>
    , synthetic prompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib17" title="">
      <span class="ltx_text" style="font-size:90%;">
       17
      </span>
     </a>
     ]
    </cite>
    , skeleton-of-thought (SoT),
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib18" title="">
      <span class="ltx_text" style="font-size:90%;">
       18
      </span>
     </a>
     ]
    </cite>
    , multi-personas
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib15" title="">
      <span class="ltx_text" style="font-size:90%;">
       15
      </span>
     </a>
     ]
    </cite>
    , on-meta-prompting
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib13" title="">
      <span class="ltx_text" style="font-size:90%;">
       13
      </span>
     </a>
     ]
    </cite>
    , meta-prompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib19" title="">
      <span class="ltx_text" style="font-size:90%;">
       19
      </span>
     </a>
     ]
    </cite>
    ,
    <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">
     etc
    </span>
    . While these methods can generate specific prompts according to different original prompts or instructions, they are generally not task-agnostic or zero-shot, where manually designed examples are required. In other words, they would not be very suitable for generalizing across ever changing landscape of LLMs. In comparison, our method is completely zero-shot, task-agnostic and prompt-specific.
   </p>
  </div>
  <div class="ltx_para" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">
     Optimization based self-prompt refinement.
    </span>
    Using optimization techniques to improve prompts is a recent focus. Early attempts including prompt tuning
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib20" title="">
      <span class="ltx_text" style="font-size:90%;">
       20
      </span>
     </a>
     ]
    </cite>
    and prefix tuning
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      <span class="ltx_text" style="font-size:90%;">
       21
      </span>
     </a>
     ]
    </cite>
    tried to learn a trainable prefix or soft prompts for better prompting. Recent ones,
    <span class="ltx_text ltx_font_italic" id="S2.p3.1.2">
     e.g.,
    </span>
    , directional stimulus prompting (DSP)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib22" title="">
      <span class="ltx_text" style="font-size:90%;">
       22
      </span>
     </a>
     ]
    </cite>
    , prompt-OIRL
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib23" title="">
      <span class="ltx_text" style="font-size:90%;">
       23
      </span>
     </a>
     ]
    </cite>
    , use reinforcement learning to train an auxiliary model to generate query-specific prompts. OPRO
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:90%;">
       7
      </span>
     </a>
     ]
    </cite>
    makes LLMs itself a optimizer which guides LLMs to produce outputs that align with a predefined objective.
Those works typically require numerous iterations of training for each task and are thus not task-agnostic, and it is costly to adapt them to new tasks. Our work also optimizes user prompt and is thus closely related to this line of works. However, our method is learning-free and task-agnostic.
   </p>
  </div>
  <div class="ltx_para" id="S2.p4">
   <p class="ltx_p" id="S2.p4.1">
    <span class="ltx_text ltx_font_bold" id="S2.p4.1.1">
     Zero-shot self-prompt refinement.
    </span>
    Some manual prompt engineering methods, such as Zero-shot CoT
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib2" title="">
      <span class="ltx_text" style="font-size:90%;">
       2
      </span>
     </a>
     ]
    </cite>
    , Static ExpertPrompting
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:90%;">
       6
      </span>
     </a>
     ]
    </cite>
    , and RaR
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib14" title="">
      <span class="ltx_text" style="font-size:90%;">
       14
      </span>
     </a>
     ]
    </cite>
    , follow the zero-shot paradigm. Because no prompt examples or datasets are used, these methods are typically task-agnostic as well. Despite their simplicity and ease of adaptation to various tasks, their prompt optimization capability is limited by their shallow understanding of the user query. More importantly, they are not guaranteed to be query-specific (e.g., Static ExpertPrompting and RaR), which further limits their capability. In this work, we design a hierarchical multi-agent workflow to address these shortcomings.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Proposed Approach
  </h2>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Preliminaries
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.24">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.24.1">
      Notations.
     </span>
     In language generation tasks, the language model
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     is asked to provide responses to queries in the textual space
     <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        𝒯
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
         𝒯
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">
        \mathcal{T}
       </annotation>
      </semantics>
     </math>
     . Given a dataset
     <math alttext="\mathcal{D}=\{(q_{i},y_{i}^{*})\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1">
      <semantics id="S3.SS1.p1.3.m3.1a">
       <mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">
         𝒟
        </mi>
        <mo id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">
         =
        </mo>
        <msubsup id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">
         <mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">
          <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">
           <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">
            (
           </mo>
           <msub id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">
            <mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">
             q
            </mi>
            <mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msub>
           <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">
            ,
           </mo>
           <msubsup id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml">
            <mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.2.cmml">
             y
            </mi>
            <mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.3.cmml">
             i
            </mi>
            <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">
             ∗
            </mo>
           </msubsup>
           <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">
            )
           </mo>
          </mrow>
          <mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <mrow id="S3.SS1.p1.3.m3.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.3.cmml">
          <mi id="S3.SS1.p1.3.m3.1.1.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.1.1.3.2.cmml">
           i
          </mi>
          <mo id="S3.SS1.p1.3.m3.1.1.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.1.1.3.1.cmml">
           =
          </mo>
          <mn id="S3.SS1.p1.3.m3.1.1.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="S3.SS1.p1.3.m3.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.3.cmml">
          n
         </mi>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b">
        <apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">
         <eq id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">
         </eq>
         <ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">
          𝒟
         </ci>
         <apply id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1">
           superscript
          </csymbol>
          <apply id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1">
            subscript
           </csymbol>
           <set id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1">
            <interval closure="open" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2">
             <apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2">
               𝑞
              </ci>
              <ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3">
               𝑖
              </ci>
             </apply>
             <apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2">
              <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2">
               superscript
              </csymbol>
              <apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2">
               <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2">
                subscript
               </csymbol>
               <ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.2">
                𝑦
               </ci>
               <ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.3">
                𝑖
               </ci>
              </apply>
              <times id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3">
              </times>
             </apply>
            </interval>
           </set>
           <apply id="S3.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.3">
            <eq id="S3.SS1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.3.1">
            </eq>
            <ci id="S3.SS1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.3.2">
             𝑖
            </ci>
            <cn id="S3.SS1.p1.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.1.1.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="S3.SS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3">
           𝑛
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">
        \mathcal{D}=\{(q_{i},y_{i}^{*})\}_{i=1}^{n}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1">
      <semantics id="S3.SS1.p1.4.m4.1a">
       <mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">
        n
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b">
        <ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">
         𝑛
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">
        n
       </annotation>
      </semantics>
     </math>
     is the number of pairs, each
     <math alttext="(q_{i},y_{i}^{*})" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.2">
      <semantics id="S3.SS1.p1.5.m5.2a">
       <mrow id="S3.SS1.p1.5.m5.2.2.2" xref="S3.SS1.p1.5.m5.2.2.3.cmml">
        <mo id="S3.SS1.p1.5.m5.2.2.2.3" stretchy="false" xref="S3.SS1.p1.5.m5.2.2.3.cmml">
         (
        </mo>
        <msub id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.cmml">
         <mi id="S3.SS1.p1.5.m5.1.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.1.2.cmml">
          q
         </mi>
         <mi id="S3.SS1.p1.5.m5.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.1.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.5.m5.2.2.2.4" xref="S3.SS1.p1.5.m5.2.2.3.cmml">
         ,
        </mo>
        <msubsup id="S3.SS1.p1.5.m5.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.cmml">
         <mi id="S3.SS1.p1.5.m5.2.2.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml">
          y
         </mi>
         <mi id="S3.SS1.p1.5.m5.2.2.2.2.2.3" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml">
          i
         </mi>
         <mo id="S3.SS1.p1.5.m5.2.2.2.2.3" xref="S3.SS1.p1.5.m5.2.2.2.2.3.cmml">
          ∗
         </mo>
        </msubsup>
        <mo id="S3.SS1.p1.5.m5.2.2.2.5" stretchy="false" xref="S3.SS1.p1.5.m5.2.2.3.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b">
        <interval closure="open" id="S3.SS1.p1.5.m5.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2">
         <apply id="S3.SS1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.2">
           𝑞
          </ci>
          <ci id="S3.SS1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS1.p1.5.m5.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">
           superscript
          </csymbol>
          <apply id="S3.SS1.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2">
            𝑦
           </ci>
           <ci id="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3">
            𝑖
           </ci>
          </apply>
          <times id="S3.SS1.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.3">
          </times>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">
        (q_{i},y_{i}^{*})
       </annotation>
      </semantics>
     </math>
     pair consists of a text query
     <math alttext="q_{i}\in\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1">
      <semantics id="S3.SS1.p1.6.m6.1a">
       <mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">
        <msub id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">
         <mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">
          q
         </mi>
         <mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">
         𝒯
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b">
        <apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">
         <in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">
         </in>
         <apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">
           𝑞
          </ci>
          <ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">
          𝒯
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">
        q_{i}\in\mathcal{T}
       </annotation>
      </semantics>
     </math>
     and the corresponding golden response
     <math alttext="y_{i}^{*}\in\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1">
      <semantics id="S3.SS1.p1.7.m7.1a">
       <mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">
        <msubsup id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">
         <mi id="S3.SS1.p1.7.m7.1.1.2.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.2.cmml">
          y
         </mi>
         <mi id="S3.SS1.p1.7.m7.1.1.2.2.3" xref="S3.SS1.p1.7.m7.1.1.2.2.3.cmml">
          i
         </mi>
         <mo id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">
          ∗
         </mo>
        </msubsup>
        <mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">
         𝒯
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b">
        <apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">
         <in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1">
         </in>
         <apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">
           superscript
          </csymbol>
          <apply id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.7.m7.1.1.2.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2.2">
            𝑦
           </ci>
           <ci id="S3.SS1.p1.7.m7.1.1.2.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2.3">
            𝑖
           </ci>
          </apply>
          <times id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">
          </times>
         </apply>
         <ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">
          𝒯
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">
        y_{i}^{*}\in\mathcal{T}
       </annotation>
      </semantics>
     </math>
     . We use prompt
     <math alttext="p\in\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1">
      <semantics id="S3.SS1.p1.8.m8.1a">
       <mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">
        <mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">
         p
        </mi>
        <mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">
         𝒯
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b">
        <apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">
         <in id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">
         </in>
         <ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">
          𝑝
         </ci>
         <ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">
          𝒯
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">
        p\in\mathcal{T}
       </annotation>
      </semantics>
     </math>
     to denote input of the large language model (LLM)
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1">
      <semantics id="S3.SS1.p1.9.m9.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b">
        <ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     . In practice,
     <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1">
      <semantics id="S3.SS1.p1.10.m10.1a">
       <mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">
        p
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b">
        <ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">
         𝑝
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">
        p
       </annotation>
      </semantics>
     </math>
     may not be equal to
     <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1">
      <semantics id="S3.SS1.p1.11.m11.1a">
       <mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">
        q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b">
        <ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">
         𝑞
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">
        q
       </annotation>
      </semantics>
     </math>
     and can be the prompt engineering result
     <math alttext="f(q)" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1">
      <semantics id="S3.SS1.p1.12.m12.1a">
       <mrow id="S3.SS1.p1.12.m12.1.2" xref="S3.SS1.p1.12.m12.1.2.cmml">
        <mi id="S3.SS1.p1.12.m12.1.2.2" xref="S3.SS1.p1.12.m12.1.2.2.cmml">
         f
        </mi>
        <mo id="S3.SS1.p1.12.m12.1.2.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.12.m12.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS1.p1.12.m12.1.2.3.2" xref="S3.SS1.p1.12.m12.1.2.cmml">
         <mo id="S3.SS1.p1.12.m12.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.12.m12.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">
          q
         </mi>
         <mo id="S3.SS1.p1.12.m12.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.12.m12.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b">
        <apply id="S3.SS1.p1.12.m12.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2">
         <times id="S3.SS1.p1.12.m12.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.1">
         </times>
         <ci id="S3.SS1.p1.12.m12.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2">
          𝑓
         </ci>
         <ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">
          𝑞
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">
        f(q)
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="f:\mathcal{T}\rightarrow\mathcal{T},f\in\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.2">
      <semantics id="S3.SS1.p1.13.m13.2a">
       <mrow id="S3.SS1.p1.13.m13.2.2" xref="S3.SS1.p1.13.m13.2.2.cmml">
        <mi id="S3.SS1.p1.13.m13.2.2.4" xref="S3.SS1.p1.13.m13.2.2.4.cmml">
         f
        </mi>
        <mo id="S3.SS1.p1.13.m13.2.2.3" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.13.m13.2.2.3.cmml">
         :
        </mo>
        <mrow id="S3.SS1.p1.13.m13.2.2.2.2" xref="S3.SS1.p1.13.m13.2.2.2.3.cmml">
         <mrow id="S3.SS1.p1.13.m13.1.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.1.1.1.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.cmml">
           𝒯
          </mi>
          <mo id="S3.SS1.p1.13.m13.1.1.1.1.1.1" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.cmml">
           →
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.1.1.1.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml">
           𝒯
          </mi>
         </mrow>
         <mo id="S3.SS1.p1.13.m13.2.2.2.2.3" xref="S3.SS1.p1.13.m13.2.2.2.3a.cmml">
          ,
         </mo>
         <mrow id="S3.SS1.p1.13.m13.2.2.2.2.2" xref="S3.SS1.p1.13.m13.2.2.2.2.2.cmml">
          <mi id="S3.SS1.p1.13.m13.2.2.2.2.2.2" xref="S3.SS1.p1.13.m13.2.2.2.2.2.2.cmml">
           f
          </mi>
          <mo id="S3.SS1.p1.13.m13.2.2.2.2.2.1" xref="S3.SS1.p1.13.m13.2.2.2.2.2.1.cmml">
           ∈
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.2.2.2.2.2.3" xref="S3.SS1.p1.13.m13.2.2.2.2.2.3.cmml">
           ℱ
          </mi>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.2b">
        <apply id="S3.SS1.p1.13.m13.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2">
         <ci id="S3.SS1.p1.13.m13.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.3">
          :
         </ci>
         <ci id="S3.SS1.p1.13.m13.2.2.4.cmml" xref="S3.SS1.p1.13.m13.2.2.4">
          𝑓
         </ci>
         <apply id="S3.SS1.p1.13.m13.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.2.2.3a.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="S3.SS1.p1.13.m13.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1">
           <ci id="S3.SS1.p1.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1">
            →
           </ci>
           <ci id="S3.SS1.p1.13.m13.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2">
            𝒯
           </ci>
           <ci id="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3">
            𝒯
           </ci>
          </apply>
          <apply id="S3.SS1.p1.13.m13.2.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2.2">
           <in id="S3.SS1.p1.13.m13.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2.2.1">
           </in>
           <ci id="S3.SS1.p1.13.m13.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2.2.2">
            𝑓
           </ci>
           <ci id="S3.SS1.p1.13.m13.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.2.2.2.3">
            ℱ
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.2c">
        f:\mathcal{T}\rightarrow\mathcal{T},f\in\mathcal{F}
       </annotation>
      </semantics>
     </math>
     , is the prompt-engineering mapping function. In evaluation,
we use a metric
     <math alttext="s:\mathcal{T}\times\mathcal{T}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1">
      <semantics id="S3.SS1.p1.14.m14.1a">
       <mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">
        <mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">
         s
        </mi>
        <mo id="S3.SS1.p1.14.m14.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.14.m14.1.1.1.cmml">
         :
        </mo>
        <mrow id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">
         <mrow id="S3.SS1.p1.14.m14.1.1.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.1.1.3.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.cmml">
           𝒯
          </mi>
          <mo id="S3.SS1.p1.14.m14.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.14.m14.1.1.3.2.1.cmml">
           ×
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.14.m14.1.1.3.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.3.cmml">
           𝒯
          </mi>
         </mrow>
         <mo id="S3.SS1.p1.14.m14.1.1.3.1" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml">
          →
         </mo>
         <mi id="S3.SS1.p1.14.m14.1.1.3.3" xref="S3.SS1.p1.14.m14.1.1.3.3.cmml">
          ℝ
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b">
        <apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">
         <ci id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1">
          :
         </ci>
         <ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">
          <ci id="S3.SS1.p1.14.m14.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1">
           →
          </ci>
          <apply id="S3.SS1.p1.14.m14.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2">
           <times id="S3.SS1.p1.14.m14.1.1.3.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.1">
           </times>
           <ci id="S3.SS1.p1.14.m14.1.1.3.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2">
            𝒯
           </ci>
           <ci id="S3.SS1.p1.14.m14.1.1.3.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3">
            𝒯
           </ci>
          </apply>
          <ci id="S3.SS1.p1.14.m14.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.3">
           ℝ
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">
        s:\mathcal{T}\times\mathcal{T}\rightarrow\mathbb{R}
       </annotation>
      </semantics>
     </math>
     to measure the quality of the responses
     <math alttext="\hat{y}_{i}=\mathcal{M}(f(q_{i}))" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1">
      <semantics id="S3.SS1.p1.15.m15.1a">
       <mrow id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">
        <msub id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">
         <mover accent="true" id="S3.SS1.p1.15.m15.1.1.3.2" xref="S3.SS1.p1.15.m15.1.1.3.2.cmml">
          <mi id="S3.SS1.p1.15.m15.1.1.3.2.2" xref="S3.SS1.p1.15.m15.1.1.3.2.2.cmml">
           y
          </mi>
          <mo id="S3.SS1.p1.15.m15.1.1.3.2.1" xref="S3.SS1.p1.15.m15.1.1.3.2.1.cmml">
           ^
          </mo>
         </mover>
         <mi id="S3.SS1.p1.15.m15.1.1.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.15.m15.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.15.m15.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.3.cmml">
          ℳ
         </mi>
         <mo id="S3.SS1.p1.15.m15.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.15.m15.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS1.p1.15.m15.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml">
          <mo id="S3.SS1.p1.15.m15.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S3.SS1.p1.15.m15.1.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml">
           <mi id="S3.SS1.p1.15.m15.1.1.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.3.cmml">
            f
           </mi>
           <mo id="S3.SS1.p1.15.m15.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.cmml">
            <mo id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.cmml">
             (
            </mo>
            <msub id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.cmml">
             <mi id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.2.cmml">
              q
             </mi>
             <mi id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.3.cmml">
              i
             </mi>
            </msub>
            <mo id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="S3.SS1.p1.15.m15.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b">
        <apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">
         <eq id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">
         </eq>
         <apply id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3">
           subscript
          </csymbol>
          <apply id="S3.SS1.p1.15.m15.1.1.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2">
           <ci id="S3.SS1.p1.15.m15.1.1.3.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2.1">
            ^
           </ci>
           <ci id="S3.SS1.p1.15.m15.1.1.3.2.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2.2">
            𝑦
           </ci>
          </apply>
          <ci id="S3.SS1.p1.15.m15.1.1.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1">
          <times id="S3.SS1.p1.15.m15.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.2">
          </times>
          <ci id="S3.SS1.p1.15.m15.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.3">
           ℳ
          </ci>
          <apply id="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1">
           <times id="S3.SS1.p1.15.m15.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.2">
           </times>
           <ci id="S3.SS1.p1.15.m15.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.3">
            𝑓
           </ci>
           <apply id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.2">
             𝑞
            </ci>
            <ci id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.1.3">
             𝑖
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">
        \hat{y}_{i}=\mathcal{M}(f(q_{i}))
       </annotation>
      </semantics>
     </math>
     .
If
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1">
      <semantics id="S3.SS1.p1.16.m16.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b">
        <ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     provides golden responses,
     <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.1">
      <semantics id="S3.SS1.p1.17.m17.1a">
       <mi id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml">
        s
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b">
        <ci id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">
         𝑠
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">
        s
       </annotation>
      </semantics>
     </math>
     measures the correctness of
     <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m18.1">
      <semantics id="S3.SS1.p1.18.m18.1a">
       <msub id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml">
        <mi id="S3.SS1.p1.18.m18.1.1.2" xref="S3.SS1.p1.18.m18.1.1.2.cmml">
         y
        </mi>
        <mi id="S3.SS1.p1.18.m18.1.1.3" xref="S3.SS1.p1.18.m18.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b">
        <apply id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p1.18.m18.1.1.2.cmml" xref="S3.SS1.p1.18.m18.1.1.2">
          𝑦
         </ci>
         <ci id="S3.SS1.p1.18.m18.1.1.3.cmml" xref="S3.SS1.p1.18.m18.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">
        y_{i}
       </annotation>
      </semantics>
     </math>
     ,
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.24.2">
      i.e
     </em>
     .
     <span class="ltx_text" id="S3.SS1.p1.24.3">
     </span>
     ,
     <math alttext="s(\hat{y_{i}},y_{i}^{*})=\mathbbm{1}\{\hat{y_{i}}=y_{i}^{*}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m19.3">
      <semantics id="S3.SS1.p1.19.m19.3a">
       <mrow id="S3.SS1.p1.19.m19.3.3" xref="S3.SS1.p1.19.m19.3.3.cmml">
        <mrow id="S3.SS1.p1.19.m19.2.2.1" xref="S3.SS1.p1.19.m19.2.2.1.cmml">
         <mi id="S3.SS1.p1.19.m19.2.2.1.3" xref="S3.SS1.p1.19.m19.2.2.1.3.cmml">
          s
         </mi>
         <mo id="S3.SS1.p1.19.m19.2.2.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.19.m19.2.2.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS1.p1.19.m19.2.2.1.1.1" xref="S3.SS1.p1.19.m19.2.2.1.1.2.cmml">
          <mo id="S3.SS1.p1.19.m19.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p1.19.m19.2.2.1.1.2.cmml">
           (
          </mo>
          <mover accent="true" id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml">
           <msub id="S3.SS1.p1.19.m19.1.1.2" xref="S3.SS1.p1.19.m19.1.1.2.cmml">
            <mi id="S3.SS1.p1.19.m19.1.1.2.2" xref="S3.SS1.p1.19.m19.1.1.2.2.cmml">
             y
            </mi>
            <mi id="S3.SS1.p1.19.m19.1.1.2.3" xref="S3.SS1.p1.19.m19.1.1.2.3.cmml">
             i
            </mi>
           </msub>
           <mo id="S3.SS1.p1.19.m19.1.1.1" xref="S3.SS1.p1.19.m19.1.1.1.cmml">
            ^
           </mo>
          </mover>
          <mo id="S3.SS1.p1.19.m19.2.2.1.1.1.3" xref="S3.SS1.p1.19.m19.2.2.1.1.2.cmml">
           ,
          </mo>
          <msubsup id="S3.SS1.p1.19.m19.2.2.1.1.1.1" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.cmml">
           <mi id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.2" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.2.cmml">
            y
           </mi>
           <mi id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.3" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.3.cmml">
            i
           </mi>
           <mo id="S3.SS1.p1.19.m19.2.2.1.1.1.1.3" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.3.cmml">
            ∗
           </mo>
          </msubsup>
          <mo id="S3.SS1.p1.19.m19.2.2.1.1.1.4" stretchy="false" xref="S3.SS1.p1.19.m19.2.2.1.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.SS1.p1.19.m19.3.3.3" xref="S3.SS1.p1.19.m19.3.3.3.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.19.m19.3.3.2" xref="S3.SS1.p1.19.m19.3.3.2.cmml">
         <mn id="S3.SS1.p1.19.m19.3.3.2.3" xref="S3.SS1.p1.19.m19.3.3.2.3.cmml">
          𝟙
         </mn>
         <mo id="S3.SS1.p1.19.m19.3.3.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.19.m19.3.3.2.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS1.p1.19.m19.3.3.2.1.1" xref="S3.SS1.p1.19.m19.3.3.2.1.2.cmml">
          <mo id="S3.SS1.p1.19.m19.3.3.2.1.1.2" stretchy="false" xref="S3.SS1.p1.19.m19.3.3.2.1.2.cmml">
           {
          </mo>
          <mrow id="S3.SS1.p1.19.m19.3.3.2.1.1.1" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.cmml">
           <mover accent="true" id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.cmml">
            <msub id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.cmml">
             <mi id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.2" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.2.cmml">
              y
             </mi>
             <mi id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.3" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.3.cmml">
              i
             </mi>
            </msub>
            <mo id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.1" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.1.cmml">
             ^
            </mo>
           </mover>
           <mo id="S3.SS1.p1.19.m19.3.3.2.1.1.1.1" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.1.cmml">
            =
           </mo>
           <msubsup id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.cmml">
            <mi id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.2" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.2.cmml">
             y
            </mi>
            <mi id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.3" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.3.cmml">
             i
            </mi>
            <mo id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.3" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.3.cmml">
             ∗
            </mo>
           </msubsup>
          </mrow>
          <mo id="S3.SS1.p1.19.m19.3.3.2.1.1.3" stretchy="false" xref="S3.SS1.p1.19.m19.3.3.2.1.2.cmml">
           }
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.3b">
        <apply id="S3.SS1.p1.19.m19.3.3.cmml" xref="S3.SS1.p1.19.m19.3.3">
         <eq id="S3.SS1.p1.19.m19.3.3.3.cmml" xref="S3.SS1.p1.19.m19.3.3.3">
         </eq>
         <apply id="S3.SS1.p1.19.m19.2.2.1.cmml" xref="S3.SS1.p1.19.m19.2.2.1">
          <times id="S3.SS1.p1.19.m19.2.2.1.2.cmml" xref="S3.SS1.p1.19.m19.2.2.1.2">
          </times>
          <ci id="S3.SS1.p1.19.m19.2.2.1.3.cmml" xref="S3.SS1.p1.19.m19.2.2.1.3">
           𝑠
          </ci>
          <interval closure="open" id="S3.SS1.p1.19.m19.2.2.1.1.2.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1">
           <apply id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">
            <ci id="S3.SS1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1.1">
             ^
            </ci>
            <apply id="S3.SS1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2">
             <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.1.1.2.1.cmml" xref="S3.SS1.p1.19.m19.1.1.2">
              subscript
             </csymbol>
             <ci id="S3.SS1.p1.19.m19.1.1.2.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2.2">
              𝑦
             </ci>
             <ci id="S3.SS1.p1.19.m19.1.1.2.3.cmml" xref="S3.SS1.p1.19.m19.1.1.2.3">
              𝑖
             </ci>
            </apply>
           </apply>
           <apply id="S3.SS1.p1.19.m19.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1">
             superscript
            </csymbol>
            <apply id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.2">
              𝑦
             </ci>
             <ci id="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.2.3">
              𝑖
             </ci>
            </apply>
            <times id="S3.SS1.p1.19.m19.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.19.m19.2.2.1.1.1.1.3">
            </times>
           </apply>
          </interval>
         </apply>
         <apply id="S3.SS1.p1.19.m19.3.3.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2">
          <times id="S3.SS1.p1.19.m19.3.3.2.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.2">
          </times>
          <cn id="S3.SS1.p1.19.m19.3.3.2.3.cmml" type="integer" xref="S3.SS1.p1.19.m19.3.3.2.3">
           1
          </cn>
          <set id="S3.SS1.p1.19.m19.3.3.2.1.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1">
           <apply id="S3.SS1.p1.19.m19.3.3.2.1.1.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1">
            <eq id="S3.SS1.p1.19.m19.3.3.2.1.1.1.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.1">
            </eq>
            <apply id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2">
             <ci id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.1">
              ^
             </ci>
             <apply id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2">
              <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2">
               subscript
              </csymbol>
              <ci id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.2">
               𝑦
              </ci>
              <ci id="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.2.2.3">
               𝑖
              </ci>
             </apply>
            </apply>
            <apply id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3">
             <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3">
              superscript
             </csymbol>
             <apply id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3">
              <csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.2">
               𝑦
              </ci>
              <ci id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.2.3">
               𝑖
              </ci>
             </apply>
             <times id="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.3.cmml" xref="S3.SS1.p1.19.m19.3.3.2.1.1.1.3.3">
             </times>
            </apply>
           </apply>
          </set>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.3c">
        s(\hat{y_{i}},y_{i}^{*})=\mathbbm{1}\{\hat{y_{i}}=y_{i}^{*}\}
       </annotation>
      </semantics>
     </math>
     ,
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.24.4">
      e.g.
     </em>
     , when
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.20.m20.1">
      <semantics id="S3.SS1.p1.20.m20.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.20.m20.1.1" xref="S3.SS1.p1.20.m20.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.1b">
        <ci id="S3.SS1.p1.20.m20.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     consists of mathematical or multiple choice questions where answers are objective. If
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.21.m21.1">
      <semantics id="S3.SS1.p1.21.m21.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.21.m21.1.1" xref="S3.SS1.p1.21.m21.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.1b">
        <ci id="S3.SS1.p1.21.m21.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     involves open questions whose golden responses are not predetermined, we use
     <math alttext="s(\hat{y}_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.22.m22.1">
      <semantics id="S3.SS1.p1.22.m22.1a">
       <mrow id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml">
        <mi id="S3.SS1.p1.22.m22.1.1.3" xref="S3.SS1.p1.22.m22.1.1.3.cmml">
         s
        </mi>
        <mo id="S3.SS1.p1.22.m22.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.22.m22.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS1.p1.22.m22.1.1.1.1" xref="S3.SS1.p1.22.m22.1.1.1.1.1.cmml">
         <mo id="S3.SS1.p1.22.m22.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.22.m22.1.1.1.1.1.cmml">
          (
         </mo>
         <msub id="S3.SS1.p1.22.m22.1.1.1.1.1" xref="S3.SS1.p1.22.m22.1.1.1.1.1.cmml">
          <mover accent="true" id="S3.SS1.p1.22.m22.1.1.1.1.1.2" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2.cmml">
           <mi id="S3.SS1.p1.22.m22.1.1.1.1.1.2.2" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2.2.cmml">
            y
           </mi>
           <mo id="S3.SS1.p1.22.m22.1.1.1.1.1.2.1" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2.1.cmml">
            ^
           </mo>
          </mover>
          <mi id="S3.SS1.p1.22.m22.1.1.1.1.1.3" xref="S3.SS1.p1.22.m22.1.1.1.1.1.3.cmml">
           i
          </mi>
         </msub>
         <mo id="S3.SS1.p1.22.m22.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.22.m22.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.1b">
        <apply id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1">
         <times id="S3.SS1.p1.22.m22.1.1.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2">
         </times>
         <ci id="S3.SS1.p1.22.m22.1.1.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3">
          𝑠
         </ci>
         <apply id="S3.SS1.p1.22.m22.1.1.1.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS1.p1.22.m22.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2">
           <ci id="S3.SS1.p1.22.m22.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2.1">
            ^
           </ci>
           <ci id="S3.SS1.p1.22.m22.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1.1.2.2">
            𝑦
           </ci>
          </apply>
          <ci id="S3.SS1.p1.22.m22.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.22.m22.1.1.1.1.1.3">
           𝑖
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.1c">
        s(\hat{y}_{i})
       </annotation>
      </semantics>
     </math>
     to measure the quality of the response
     <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.23.m23.1">
      <semantics id="S3.SS1.p1.23.m23.1a">
       <msub id="S3.SS1.p1.23.m23.1.1" xref="S3.SS1.p1.23.m23.1.1.cmml">
        <mover accent="true" id="S3.SS1.p1.23.m23.1.1.2" xref="S3.SS1.p1.23.m23.1.1.2.cmml">
         <mi id="S3.SS1.p1.23.m23.1.1.2.2" xref="S3.SS1.p1.23.m23.1.1.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS1.p1.23.m23.1.1.2.1" xref="S3.SS1.p1.23.m23.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S3.SS1.p1.23.m23.1.1.3" xref="S3.SS1.p1.23.m23.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m23.1b">
        <apply id="S3.SS1.p1.23.m23.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p1.23.m23.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS1.p1.23.m23.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2">
          <ci id="S3.SS1.p1.23.m23.1.1.2.1.cmml" xref="S3.SS1.p1.23.m23.1.1.2.1">
           ^
          </ci>
          <ci id="S3.SS1.p1.23.m23.1.1.2.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2.2">
           𝑦
          </ci>
         </apply>
         <ci id="S3.SS1.p1.23.m23.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.23.m23.1c">
        \hat{y}_{i}
       </annotation>
      </semantics>
     </math>
     generated by
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.24.m24.1">
      <semantics id="S3.SS1.p1.24.m24.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.24.m24.1.1" xref="S3.SS1.p1.24.m24.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m24.1b">
        <ci id="S3.SS1.p1.24.m24.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.24.m24.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.7">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.7.1">
      Prompt optimization.
     </span>
     Directly prompting LLMs
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1">
      <semantics id="S3.SS1.p2.1.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b">
        <ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     using the initial human query
     <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1">
      <semantics id="S3.SS1.p2.2.m2.1a">
       <mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">
        q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b">
        <ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">
         𝑞
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">
        q
       </annotation>
      </semantics>
     </math>
     may not be the optimal. Ideally, an optimal prompt
     <math alttext="p*" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.3.m3.1">
      <semantics id="S3.SS1.p2.3.m3.1a">
       <mrow id="S3.SS1.p2.3.m3.1b">
        <mi id="S3.SS1.p2.3.m3.1.1">
         p
        </mi>
        <mo id="S3.SS1.p2.3.m3.1.2" lspace="0.222em">
         ∗
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">
        p*
       </annotation>
      </semantics>
     </math>
     allows
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1">
      <semantics id="S3.SS1.p2.4.m4.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b">
        <ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     to generate the golden response
     <math alttext="y^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1">
      <semantics id="S3.SS1.p2.5.m5.1a">
       <msup id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">
        <mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">
         y
        </mi>
        <mo id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">
         ∗
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b">
        <apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">
          𝑦
         </ci>
         <times id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">
        y^{*}
       </annotation>
      </semantics>
     </math>
     . Given a specific pair
     <math alttext="(q_{i},y_{i}^{*})" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.2">
      <semantics id="S3.SS1.p2.6.m6.2a">
       <mrow id="S3.SS1.p2.6.m6.2.2.2" xref="S3.SS1.p2.6.m6.2.2.3.cmml">
        <mo id="S3.SS1.p2.6.m6.2.2.2.3" stretchy="false" xref="S3.SS1.p2.6.m6.2.2.3.cmml">
         (
        </mo>
        <msub id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.cmml">
         <mi id="S3.SS1.p2.6.m6.1.1.1.1.2" xref="S3.SS1.p2.6.m6.1.1.1.1.2.cmml">
          q
         </mi>
         <mi id="S3.SS1.p2.6.m6.1.1.1.1.3" xref="S3.SS1.p2.6.m6.1.1.1.1.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p2.6.m6.2.2.2.4" xref="S3.SS1.p2.6.m6.2.2.3.cmml">
         ,
        </mo>
        <msubsup id="S3.SS1.p2.6.m6.2.2.2.2" xref="S3.SS1.p2.6.m6.2.2.2.2.cmml">
         <mi id="S3.SS1.p2.6.m6.2.2.2.2.2.2" xref="S3.SS1.p2.6.m6.2.2.2.2.2.2.cmml">
          y
         </mi>
         <mi id="S3.SS1.p2.6.m6.2.2.2.2.2.3" xref="S3.SS1.p2.6.m6.2.2.2.2.2.3.cmml">
          i
         </mi>
         <mo id="S3.SS1.p2.6.m6.2.2.2.2.3" xref="S3.SS1.p2.6.m6.2.2.2.2.3.cmml">
          ∗
         </mo>
        </msubsup>
        <mo id="S3.SS1.p2.6.m6.2.2.2.5" stretchy="false" xref="S3.SS1.p2.6.m6.2.2.3.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.2b">
        <interval closure="open" id="S3.SS1.p2.6.m6.2.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2">
         <apply id="S3.SS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.2">
           𝑞
          </ci>
          <ci id="S3.SS1.p2.6.m6.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS1.p2.6.m6.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2">
           superscript
          </csymbol>
          <apply id="S3.SS1.p2.6.m6.2.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p2.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.2.2">
            𝑦
           </ci>
           <ci id="S3.SS1.p2.6.m6.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.2.3">
            𝑖
           </ci>
          </apply>
          <times id="S3.SS1.p2.6.m6.2.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.3">
          </times>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.2c">
        (q_{i},y_{i}^{*})
       </annotation>
      </semantics>
     </math>
     , the task of finding such
     <math alttext="p_{i}^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1">
      <semantics id="S3.SS1.p2.7.m7.1a">
       <msubsup id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">
        <mi id="S3.SS1.p2.7.m7.1.1.2.2" xref="S3.SS1.p2.7.m7.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S3.SS1.p2.7.m7.1.1.2.3" xref="S3.SS1.p2.7.m7.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b">
        <apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2.2">
           𝑝
          </ci>
          <ci id="S3.SS1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">
        p_{i}^{*}
       </annotation>
      </semantics>
     </math>
     can be formulated as a prompt optimization task which aims to maximize the following expected quality score:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="p_{i}^{*}=\underset{p\in\mathcal{T}}{\arg\max}\,s(y_{i}^{*},\mathcal{M}(p\mid q_{i}))." class="ltx_Math" display="block" id="S3.E1.m1.1">
         <semantics id="S3.E1.m1.1a">
          <mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">
           <mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">
            <msubsup id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml">
             <mi id="S3.E1.m1.1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.1.4.2.2.cmml">
              p
             </mi>
             <mi id="S3.E1.m1.1.1.1.1.4.2.3" xref="S3.E1.m1.1.1.1.1.4.2.3.cmml">
              i
             </mi>
             <mo id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml">
              ∗
             </mo>
            </msubsup>
            <mo id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">
             =
            </mo>
            <mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">
             <munder accentunder="true" id="S3.E1.m1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.2.4.cmml">
              <mrow id="S3.E1.m1.1.1.1.1.2.4.2" xref="S3.E1.m1.1.1.1.1.2.4.2.cmml">
               <mi id="S3.E1.m1.1.1.1.1.2.4.2.1" xref="S3.E1.m1.1.1.1.1.2.4.2.1.cmml">
                arg
               </mi>
               <mo id="S3.E1.m1.1.1.1.1.2.4.2a" lspace="0.167em" xref="S3.E1.m1.1.1.1.1.2.4.2.cmml">
                ⁡
               </mo>
               <mi id="S3.E1.m1.1.1.1.1.2.4.2.2" xref="S3.E1.m1.1.1.1.1.2.4.2.2.cmml">
                max
               </mi>
              </mrow>
              <mrow id="S3.E1.m1.1.1.1.1.2.4.1" xref="S3.E1.m1.1.1.1.1.2.4.1.cmml">
               <mi id="S3.E1.m1.1.1.1.1.2.4.1.2" xref="S3.E1.m1.1.1.1.1.2.4.1.2.cmml">
                p
               </mi>
               <mo id="S3.E1.m1.1.1.1.1.2.4.1.1" xref="S3.E1.m1.1.1.1.1.2.4.1.1.cmml">
                ∈
               </mo>
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.4.1.3" xref="S3.E1.m1.1.1.1.1.2.4.1.3.cmml">
                𝒯
               </mi>
              </mrow>
             </munder>
             <mo id="S3.E1.m1.1.1.1.1.2.3" lspace="0.167em" rspace="0em" xref="S3.E1.m1.1.1.1.1.2.3.cmml">
              ​
             </mo>
             <mi id="S3.E1.m1.1.1.1.1.2.5" xref="S3.E1.m1.1.1.1.1.2.5.cmml">
              s
             </mi>
             <mo id="S3.E1.m1.1.1.1.1.2.3a" lspace="0em" rspace="0em" xref="S3.E1.m1.1.1.1.1.2.3.cmml">
              ​
             </mo>
             <mrow id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">
              <mo id="S3.E1.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">
               (
              </mo>
              <msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">
               <mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">
                y
               </mi>
               <mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">
                i
               </mi>
               <mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">
                ∗
               </mo>
              </msubsup>
              <mo id="S3.E1.m1.1.1.1.1.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">
               ,
              </mo>
              <mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">
                ℳ
               </mi>
               <mo id="S3.E1.m1.1.1.1.1.2.2.2.2.2" lspace="0em" rspace="0em" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml">
                ​
               </mo>
               <mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">
                <mo id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">
                 <mi id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.2.cmml">
                  p
                 </mi>
                 <mo id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">
                  ∣
                 </mo>
                 <msub id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml">
                  <mi id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.2.cmml">
                   q
                  </mi>
                  <mi id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.3.cmml">
                   i
                  </mi>
                 </msub>
                </mrow>
                <mo id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E1.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E1.m1.1.1.1.2" lspace="0em" xref="S3.E1.m1.1.1.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b">
           <apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1">
            <eq id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">
            </eq>
            <apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4">
             <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">
              superscript
             </csymbol>
             <apply id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4">
              <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4">
               subscript
              </csymbol>
              <ci id="S3.E1.m1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2.2">
               𝑝
              </ci>
              <ci id="S3.E1.m1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.4.2.3">
               𝑖
              </ci>
             </apply>
             <times id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3">
             </times>
            </apply>
            <apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2">
             <times id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3">
             </times>
             <apply id="S3.E1.m1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.4">
              <apply id="S3.E1.m1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4.1">
               <in id="S3.E1.m1.1.1.1.1.2.4.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4.1.1">
               </in>
               <ci id="S3.E1.m1.1.1.1.1.2.4.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.1.2">
                𝑝
               </ci>
               <ci id="S3.E1.m1.1.1.1.1.2.4.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.1.3">
                𝒯
               </ci>
              </apply>
              <apply id="S3.E1.m1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2">
               <arg id="S3.E1.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.1">
               </arg>
               <max id="S3.E1.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.2">
               </max>
              </apply>
             </apply>
             <ci id="S3.E1.m1.1.1.1.1.2.5.cmml" xref="S3.E1.m1.1.1.1.1.2.5">
              𝑠
             </ci>
             <interval closure="open" id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2">
              <apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">
                superscript
               </csymbol>
               <apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">
                 𝑦
                </ci>
                <ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3">
                 𝑖
                </ci>
               </apply>
               <times id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">
               </times>
              </apply>
              <apply id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2">
               <times id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">
               </times>
               <ci id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3">
                ℳ
               </ci>
               <apply id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1">
                <csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1">
                 conditional
                </csymbol>
                <ci id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.2">
                 𝑝
                </ci>
                <apply id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3">
                 <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.2">
                  𝑞
                 </ci>
                 <ci id="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3.3">
                  𝑖
                 </ci>
                </apply>
               </apply>
              </apply>
             </interval>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E1.m1.1c">
           p_{i}^{*}=\underset{p\in\mathcal{T}}{\arg\max}\,s(y_{i}^{*},\mathcal{M}(p\mid q_{i})).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S3.SS1.p3">
    <p class="ltx_p" id="S3.SS1.p3.4">
     Some methods manually combine
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1">
      <semantics id="S3.SS1.p3.1.m1.1a">
       <msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">
        <mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b">
        <apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     with some carefully designed fixed prefix or suffix to formulate
     <math alttext="p_{i}^{*}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1">
      <semantics id="S3.SS1.p3.2.m2.1a">
       <msubsup id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">
        <mi id="S3.SS1.p3.2.m2.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S3.SS1.p3.2.m2.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b">
        <apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2">
           𝑝
          </ci>
          <ci id="S3.SS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">
        p_{i}^{*}
       </annotation>
      </semantics>
     </math>
     . For example, few-shot prompting
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib9" title="">
       <span class="ltx_text" style="font-size:90%;">
        9
       </span>
      </a>
      ]
     </cite>
     uses a few examples of query-answer pairs beside the query of interest
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1">
      <semantics id="S3.SS1.p3.3.m3.1a">
       <msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">
        <mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b">
        <apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     ; the zero-shot chain-of-thought (CoT)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib1" title="">
       <span class="ltx_text" style="font-size:90%;">
        1
       </span>
      </a>
      ]
     </cite>
     is formulated as ‘
     <math alttext="q_{i}\oplus[\text{let us think step by step}]" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1">
      <semantics id="S3.SS1.p3.4.m4.1a">
       <mrow id="S3.SS1.p3.4.m4.1.2" xref="S3.SS1.p3.4.m4.1.2.cmml">
        <msub id="S3.SS1.p3.4.m4.1.2.2" xref="S3.SS1.p3.4.m4.1.2.2.cmml">
         <mi id="S3.SS1.p3.4.m4.1.2.2.2" xref="S3.SS1.p3.4.m4.1.2.2.2.cmml">
          q
         </mi>
         <mi id="S3.SS1.p3.4.m4.1.2.2.3" xref="S3.SS1.p3.4.m4.1.2.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p3.4.m4.1.2.1" xref="S3.SS1.p3.4.m4.1.2.1.cmml">
         ⊕
        </mo>
        <mrow id="S3.SS1.p3.4.m4.1.2.3.2" xref="S3.SS1.p3.4.m4.1.2.3.1.cmml">
         <mo id="S3.SS1.p3.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.4.m4.1.2.3.1.1.cmml">
          [
         </mo>
         <mtext id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1a.cmml">
          let us think step by step
         </mtext>
         <mo id="S3.SS1.p3.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.4.m4.1.2.3.1.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b">
        <apply id="S3.SS1.p3.4.m4.1.2.cmml" xref="S3.SS1.p3.4.m4.1.2">
         <csymbol cd="latexml" id="S3.SS1.p3.4.m4.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.1">
          direct-sum
         </csymbol>
         <apply id="S3.SS1.p3.4.m4.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p3.4.m4.1.2.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2.2">
           𝑞
          </ci>
          <ci id="S3.SS1.p3.4.m4.1.2.2.3.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS1.p3.4.m4.1.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.2.3.2">
          <csymbol cd="latexml" id="S3.SS1.p3.4.m4.1.2.3.1.1.cmml" xref="S3.SS1.p3.4.m4.1.2.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="S3.SS1.p3.4.m4.1.1a.cmml" xref="S3.SS1.p3.4.m4.1.1">
           <mtext id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">
            let us think step by step
           </mtext>
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">
        q_{i}\oplus[\text{let us think step by step}]
       </annotation>
      </semantics>
     </math>
     ’. Others use automatic methods, which are described in Section
     <a class="ltx_ref" href="#S2" title="2 Related Work ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p4">
    <p class="ltx_p" id="S3.SS1.p4.2">
     A recent line of research (
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p4.2.1">
      e.g
     </em>
     .
     <span class="ltx_text" id="S3.SS1.p4.2.2">
     </span>
     , RAR
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib14" title="">
       <span class="ltx_text" style="font-size:90%;">
        14
       </span>
      </a>
      ]
     </cite>
     , ExpertPrompting
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib6" title="">
       <span class="ltx_text" style="font-size:90%;">
        6
       </span>
      </a>
      ]
     </cite>
     , Multi-Persona
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib15" title="">
       <span class="ltx_text" style="font-size:90%;">
        15
       </span>
      </a>
      ]
     </cite>
     ) focuses on leveraging the text generation capacity of LLMs to directly generate
     <math alttext="p_{i}^{*}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1">
      <semantics id="S3.SS1.p4.1.m1.1a">
       <msubsup id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">
        <mi id="S3.SS1.p4.1.m1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S3.SS1.p4.1.m1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b">
        <apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p4.1.m1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2.2">
           𝑝
          </ci>
          <ci id="S3.SS1.p4.1.m1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">
        p_{i}^{*}
       </annotation>
      </semantics>
     </math>
     by providing some context
     <math alttext="C\in\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1">
      <semantics id="S3.SS1.p4.2.m2.1a">
       <mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">
        <mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">
         C
        </mi>
        <mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">
         𝒯
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b">
        <apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">
         <in id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1">
         </in>
         <ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">
          𝐶
         </ci>
         <ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">
          𝒯
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">
        C\in\mathcal{T}
       </annotation>
      </semantics>
     </math>
     of the optimization task in Eq.
     <a class="ltx_ref" href="#S3.E1" title="In 3.1 Preliminaries ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . Those methods are deployment-friendly because of characteristics like zero-shot, task-agnostic, and query-specific.
In this paper, we not only keep those characteristics but also use a workflow to optimize prompts.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Hierarchical Multi-Agent Workflow
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">
      Intuition.
     </span>
     Now, we consider prompt optimization as a complex and challenging task where prompts are hard to optimize by traditional optimization method. Our design is motivated by recent multi-agent workflow methods
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib24" title="">
       <span class="ltx_text" style="font-size:90%;">
        24
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib25" title="">
       <span class="ltx_text" style="font-size:90%;">
        25
       </span>
      </a>
      ]
     </cite>
     which have shown promise in solving complex tasks. We thus employ the idea of cooperative multiple agents in the prompt optimization task.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.1">
      Hierarchical workflow.
     </span>
     We design a hierarchical workflow which performs prompt optimization and then task response generation. The user query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1">
      <semantics id="S3.SS2.p2.1.m1.1a">
       <msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">
        <mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b">
        <apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     is the input of the workflow and is processed and improved by a hierarchy of agents. The workflow output the final is task response
     <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1">
      <semantics id="S3.SS2.p2.2.m2.1a">
       <msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">
        <mover accent="true" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">
         <mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS2.p2.2.m2.1.1.2.1" xref="S3.SS2.p2.2.m2.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b">
        <apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">
          <ci id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2.1">
           ^
          </ci>
          <ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">
           𝑦
          </ci>
         </apply>
         <ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">
        \hat{y}_{i}
       </annotation>
      </semantics>
     </math>
     from an LLM prompted by the improved user query.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.5">
     The proposed workflow operates like a company with three layers, as shown in Fig.
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     and Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . Each layer plays a different role: ‘CEO’, ‘Manager’, and ‘Worker’, respectively.
The CEO layer takes the initial query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1">
      <semantics id="S3.SS2.p3.1.m1.1a">
       <msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">
        <mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b">
        <apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     as input and outputs the CEO’s instruction
     <math alttext="q_{i}^{c}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1">
      <semantics id="S3.SS2.p3.2.m2.1a">
       <msubsup id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">
        <mi id="S3.SS2.p3.2.m2.1.1.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml">
         i
        </mi>
        <mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">
         c
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b">
        <apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2">
           𝑞
          </ci>
          <ci id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">
        q_{i}^{c}
       </annotation>
      </semantics>
     </math>
     to the Manager layer. The Manager layer responds to the CEO’s instruction and generates its own instruction for the Worker layer. The Worker layer receives Manager instructions and is responsible for yielding the final response
     <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1">
      <semantics id="S3.SS2.p3.3.m3.1a">
       <msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">
        <mover accent="true" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">
         <mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS2.p3.3.m3.1.1.2.1" xref="S3.SS2.p3.3.m3.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b">
        <apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">
          <ci id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.1">
           ^
          </ci>
          <ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">
           𝑦
          </ci>
         </apply>
         <ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">
        \hat{y}_{i}
       </annotation>
      </semantics>
     </math>
     for the initial query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1">
      <semantics id="S3.SS2.p3.4.m4.1a">
       <msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">
        <mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b">
        <apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     . The Manager and Worker layers also receive the user query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1">
      <semantics id="S3.SS2.p3.5.m5.1a">
       <msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">
        <mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b">
        <apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p4">
    <p class="ltx_p" id="S3.SS2.p4.5">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p4.5.1">
      Layer design.
     </span>
     As shown in Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , each layer has a contextual description constant
     <math alttext="c^{j}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1">
      <semantics id="S3.SS2.p4.1.m1.1a">
       <msup id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">
        <mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">
         c
        </mi>
        <mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b">
        <apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">
          𝑐
         </ci>
         <ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">
        c^{j}
       </annotation>
      </semantics>
     </math>
     , a prompter
     <math alttext="f^{j}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1">
      <semantics id="S3.SS2.p4.2.m2.1a">
       <msup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">
        <mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b">
        <apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">
          𝑓
         </ci>
         <ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">
        f^{j}
       </annotation>
      </semantics>
     </math>
     , and an LLM agent
     <math alttext="\mathcal{M}^{j}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1">
      <semantics id="S3.SS2.p4.3.m3.1a">
       <msup id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">
         ℳ
        </mi>
        <mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b">
        <apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">
          ℳ
         </ci>
         <ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">
        \mathcal{M}^{j}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="j\in\{c,m,w\}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.3">
      <semantics id="S3.SS2.p4.4.m4.3a">
       <mrow id="S3.SS2.p4.4.m4.3.4" xref="S3.SS2.p4.4.m4.3.4.cmml">
        <mi id="S3.SS2.p4.4.m4.3.4.2" xref="S3.SS2.p4.4.m4.3.4.2.cmml">
         j
        </mi>
        <mo id="S3.SS2.p4.4.m4.3.4.1" xref="S3.SS2.p4.4.m4.3.4.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS2.p4.4.m4.3.4.3.2" xref="S3.SS2.p4.4.m4.3.4.3.1.cmml">
         <mo id="S3.SS2.p4.4.m4.3.4.3.2.1" stretchy="false" xref="S3.SS2.p4.4.m4.3.4.3.1.cmml">
          {
         </mo>
         <mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">
          c
         </mi>
         <mo id="S3.SS2.p4.4.m4.3.4.3.2.2" xref="S3.SS2.p4.4.m4.3.4.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS2.p4.4.m4.2.2" xref="S3.SS2.p4.4.m4.2.2.cmml">
          m
         </mi>
         <mo id="S3.SS2.p4.4.m4.3.4.3.2.3" xref="S3.SS2.p4.4.m4.3.4.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS2.p4.4.m4.3.3" xref="S3.SS2.p4.4.m4.3.3.cmml">
          w
         </mi>
         <mo id="S3.SS2.p4.4.m4.3.4.3.2.4" stretchy="false" xref="S3.SS2.p4.4.m4.3.4.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.3b">
        <apply id="S3.SS2.p4.4.m4.3.4.cmml" xref="S3.SS2.p4.4.m4.3.4">
         <in id="S3.SS2.p4.4.m4.3.4.1.cmml" xref="S3.SS2.p4.4.m4.3.4.1">
         </in>
         <ci id="S3.SS2.p4.4.m4.3.4.2.cmml" xref="S3.SS2.p4.4.m4.3.4.2">
          𝑗
         </ci>
         <set id="S3.SS2.p4.4.m4.3.4.3.1.cmml" xref="S3.SS2.p4.4.m4.3.4.3.2">
          <ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">
           𝑐
          </ci>
          <ci id="S3.SS2.p4.4.m4.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2">
           𝑚
          </ci>
          <ci id="S3.SS2.p4.4.m4.3.3.cmml" xref="S3.SS2.p4.4.m4.3.3">
           𝑤
          </ci>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.3c">
        j\in\{c,m,w\}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="c,m,w" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.3">
      <semantics id="S3.SS2.p4.5.m5.3a">
       <mrow id="S3.SS2.p4.5.m5.3.4.2" xref="S3.SS2.p4.5.m5.3.4.1.cmml">
        <mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">
         c
        </mi>
        <mo id="S3.SS2.p4.5.m5.3.4.2.1" xref="S3.SS2.p4.5.m5.3.4.1.cmml">
         ,
        </mo>
        <mi id="S3.SS2.p4.5.m5.2.2" xref="S3.SS2.p4.5.m5.2.2.cmml">
         m
        </mi>
        <mo id="S3.SS2.p4.5.m5.3.4.2.2" xref="S3.SS2.p4.5.m5.3.4.1.cmml">
         ,
        </mo>
        <mi id="S3.SS2.p4.5.m5.3.3" xref="S3.SS2.p4.5.m5.3.3.cmml">
         w
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.3b">
        <list id="S3.SS2.p4.5.m5.3.4.1.cmml" xref="S3.SS2.p4.5.m5.3.4.2">
         <ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">
          𝑐
         </ci>
         <ci id="S3.SS2.p4.5.m5.2.2.cmml" xref="S3.SS2.p4.5.m5.2.2">
          𝑚
         </ci>
         <ci id="S3.SS2.p4.5.m5.3.3.cmml" xref="S3.SS2.p4.5.m5.3.3">
          𝑤
         </ci>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.3c">
        c,m,w
       </annotation>
      </semantics>
     </math>
     refer to the CEO, manager, and worker, respectively.
The context description for each layer contains the role, task description, company structure, company workflow, and important notices for this layer. The detailed context descriptions for each layer are provided in Appendix
     <a class="ltx_ref" href="#A1.SS1" title="A.1 Context Descriptions for HMAW ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       A.1
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p5">
    <p class="ltx_p" id="S3.SS2.p5.11">
     Prompter
     <math alttext="f^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1">
      <semantics id="S3.SS2.p5.1.m1.1a">
       <msup id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">
        <mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b">
        <apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">
          𝑓
         </ci>
         <ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">
        f^{j}
       </annotation>
      </semantics>
     </math>
     is an operator that concatenates
     <math alttext="c^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1">
      <semantics id="S3.SS2.p5.2.m2.1a">
       <msup id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">
        <mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">
         c
        </mi>
        <mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b">
        <apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">
          𝑐
         </ci>
         <ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">
        c^{j}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1">
      <semantics id="S3.SS2.p5.3.m3.1a">
       <msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">
        <mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b">
        <apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     , and the instructions output from the previous layer (when
     <math alttext="j=m" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1">
      <semantics id="S3.SS2.p5.4.m4.1a">
       <mrow id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">
        <mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">
         j
        </mi>
        <mo id="S3.SS2.p5.4.m4.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.cmml">
         =
        </mo>
        <mi id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml">
         m
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b">
        <apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">
         <eq id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1">
         </eq>
         <ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">
          𝑗
         </ci>
         <ci id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">
        j=m
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="j=w" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1">
      <semantics id="S3.SS2.p5.5.m5.1a">
       <mrow id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml">
        <mi id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">
         j
        </mi>
        <mo id="S3.SS2.p5.5.m5.1.1.1" xref="S3.SS2.p5.5.m5.1.1.1.cmml">
         =
        </mo>
        <mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">
         w
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b">
        <apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">
         <eq id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1.1">
         </eq>
         <ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">
          𝑗
         </ci>
         <ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">
          𝑤
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">
        j=w
       </annotation>
      </semantics>
     </math>
     ) into a prompt
     <math alttext="p_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m6.1">
      <semantics id="S3.SS2.p5.6.m6.1a">
       <msubsup id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">
        <mi id="S3.SS2.p5.6.m6.1.1.2.2" xref="S3.SS2.p5.6.m6.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S3.SS2.p5.6.m6.1.1.2.3" xref="S3.SS2.p5.6.m6.1.1.2.3.cmml">
         i
        </mi>
        <mi id="S3.SS2.p5.6.m6.1.1.3" xref="S3.SS2.p5.6.m6.1.1.3.cmml">
         j
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b">
        <apply id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.6.m6.1.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS2.p5.6.m6.1.1.2.cmml" xref="S3.SS2.p5.6.m6.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p5.6.m6.1.1.2.1.cmml" xref="S3.SS2.p5.6.m6.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS2.p5.6.m6.1.1.2.2.cmml" xref="S3.SS2.p5.6.m6.1.1.2.2">
           𝑝
          </ci>
          <ci id="S3.SS2.p5.6.m6.1.1.2.3.cmml" xref="S3.SS2.p5.6.m6.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.SS2.p5.6.m6.1.1.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">
        p_{i}^{j}
       </annotation>
      </semantics>
     </math>
     for the LLM agent
     <math alttext="\mathcal{M}^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.7.m7.1">
      <semantics id="S3.SS2.p5.7.m7.1a">
       <msup id="S3.SS2.p5.7.m7.1.1" xref="S3.SS2.p5.7.m7.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.7.m7.1.1.2" xref="S3.SS2.p5.7.m7.1.1.2.cmml">
         ℳ
        </mi>
        <mi id="S3.SS2.p5.7.m7.1.1.3" xref="S3.SS2.p5.7.m7.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m7.1b">
        <apply id="S3.SS2.p5.7.m7.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.7.m7.1.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p5.7.m7.1.1.2.cmml" xref="S3.SS2.p5.7.m7.1.1.2">
          ℳ
         </ci>
         <ci id="S3.SS2.p5.7.m7.1.1.3.cmml" xref="S3.SS2.p5.7.m7.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.7.m7.1c">
        \mathcal{M}^{j}
       </annotation>
      </semantics>
     </math>
     in this layer.
For the CEO and Manager layers, the agent
     <math alttext="\mathcal{M}^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.8.m8.1">
      <semantics id="S3.SS2.p5.8.m8.1a">
       <msup id="S3.SS2.p5.8.m8.1.1" xref="S3.SS2.p5.8.m8.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.8.m8.1.1.2" xref="S3.SS2.p5.8.m8.1.1.2.cmml">
         ℳ
        </mi>
        <mi id="S3.SS2.p5.8.m8.1.1.3" xref="S3.SS2.p5.8.m8.1.1.3.cmml">
         j
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m8.1b">
        <apply id="S3.SS2.p5.8.m8.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.8.m8.1.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p5.8.m8.1.1.2.cmml" xref="S3.SS2.p5.8.m8.1.1.2">
          ℳ
         </ci>
         <ci id="S3.SS2.p5.8.m8.1.1.3.cmml" xref="S3.SS2.p5.8.m8.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.8.m8.1c">
        \mathcal{M}^{j}
       </annotation>
      </semantics>
     </math>
     generates the result
     <math alttext="q_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.p5.9.m9.1">
      <semantics id="S3.SS2.p5.9.m9.1a">
       <msubsup id="S3.SS2.p5.9.m9.1.1" xref="S3.SS2.p5.9.m9.1.1.cmml">
        <mi id="S3.SS2.p5.9.m9.1.1.2.2" xref="S3.SS2.p5.9.m9.1.1.2.2.cmml">
         q
        </mi>
        <mi id="S3.SS2.p5.9.m9.1.1.2.3" xref="S3.SS2.p5.9.m9.1.1.2.3.cmml">
         i
        </mi>
        <mi id="S3.SS2.p5.9.m9.1.1.3" xref="S3.SS2.p5.9.m9.1.1.3.cmml">
         j
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m9.1b">
        <apply id="S3.SS2.p5.9.m9.1.1.cmml" xref="S3.SS2.p5.9.m9.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.9.m9.1.1.1.cmml" xref="S3.SS2.p5.9.m9.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS2.p5.9.m9.1.1.2.cmml" xref="S3.SS2.p5.9.m9.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p5.9.m9.1.1.2.1.cmml" xref="S3.SS2.p5.9.m9.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS2.p5.9.m9.1.1.2.2.cmml" xref="S3.SS2.p5.9.m9.1.1.2.2">
           𝑞
          </ci>
          <ci id="S3.SS2.p5.9.m9.1.1.2.3.cmml" xref="S3.SS2.p5.9.m9.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.SS2.p5.9.m9.1.1.3.cmml" xref="S3.SS2.p5.9.m9.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.9.m9.1c">
        q_{i}^{j}
       </annotation>
      </semantics>
     </math>
     , which serves as the instruction for the next layer. Note that the CEO layer does not receive instructions from other layers. In the worker layer, the refined prompt is
     <math alttext="p_{i}^{*}" class="ltx_Math" display="inline" id="S3.SS2.p5.10.m10.1">
      <semantics id="S3.SS2.p5.10.m10.1a">
       <msubsup id="S3.SS2.p5.10.m10.1.1" xref="S3.SS2.p5.10.m10.1.1.cmml">
        <mi id="S3.SS2.p5.10.m10.1.1.2.2" xref="S3.SS2.p5.10.m10.1.1.2.2.cmml">
         p
        </mi>
        <mi id="S3.SS2.p5.10.m10.1.1.2.3" xref="S3.SS2.p5.10.m10.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S3.SS2.p5.10.m10.1.1.3" xref="S3.SS2.p5.10.m10.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m10.1b">
        <apply id="S3.SS2.p5.10.m10.1.1.cmml" xref="S3.SS2.p5.10.m10.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.10.m10.1.1.1.cmml" xref="S3.SS2.p5.10.m10.1.1">
          superscript
         </csymbol>
         <apply id="S3.SS2.p5.10.m10.1.1.2.cmml" xref="S3.SS2.p5.10.m10.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p5.10.m10.1.1.2.1.cmml" xref="S3.SS2.p5.10.m10.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS2.p5.10.m10.1.1.2.2.cmml" xref="S3.SS2.p5.10.m10.1.1.2.2">
           𝑝
          </ci>
          <ci id="S3.SS2.p5.10.m10.1.1.2.3.cmml" xref="S3.SS2.p5.10.m10.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S3.SS2.p5.10.m10.1.1.3.cmml" xref="S3.SS2.p5.10.m10.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.10.m10.1c">
        p_{i}^{*}
       </annotation>
      </semantics>
     </math>
     , which is fed to the Worker LLM to produce the final response
     <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.11.m11.1">
      <semantics id="S3.SS2.p5.11.m11.1a">
       <msub id="S3.SS2.p5.11.m11.1.1" xref="S3.SS2.p5.11.m11.1.1.cmml">
        <mover accent="true" id="S3.SS2.p5.11.m11.1.1.2" xref="S3.SS2.p5.11.m11.1.1.2.cmml">
         <mi id="S3.SS2.p5.11.m11.1.1.2.2" xref="S3.SS2.p5.11.m11.1.1.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS2.p5.11.m11.1.1.2.1" xref="S3.SS2.p5.11.m11.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S3.SS2.p5.11.m11.1.1.3" xref="S3.SS2.p5.11.m11.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.11.m11.1b">
        <apply id="S3.SS2.p5.11.m11.1.1.cmml" xref="S3.SS2.p5.11.m11.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.11.m11.1.1.1.cmml" xref="S3.SS2.p5.11.m11.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS2.p5.11.m11.1.1.2.cmml" xref="S3.SS2.p5.11.m11.1.1.2">
          <ci id="S3.SS2.p5.11.m11.1.1.2.1.cmml" xref="S3.SS2.p5.11.m11.1.1.2.1">
           ^
          </ci>
          <ci id="S3.SS2.p5.11.m11.1.1.2.2.cmml" xref="S3.SS2.p5.11.m11.1.1.2.2">
           𝑦
          </ci>
         </apply>
         <ci id="S3.SS2.p5.11.m11.1.1.3.cmml" xref="S3.SS2.p5.11.m11.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.11.m11.1c">
        \hat{y}_{i}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <figure class="ltx_figure" id="S3.F2">
    <p class="ltx_p ltx_align_center ltx_align_center" id="S3.F2.1.1">
     <span class="ltx_text" id="S3.F2.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="88" id="S3.F2.1.1.1.g1" src="/html/2405.20252/assets/x2.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 2:
     </span>
     <span class="ltx_text ltx_font_bold" id="S3.F2.25.1">
      Method Overview.
     </span>
     We propose modeling the prompt optimization problem as a zero-shot output within a multi-agent workflow. The initial query,
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.F2.13.13.m1.1">
      <semantics id="S3.F2.13.13.m1.1b">
       <msub id="S3.F2.13.13.m1.1.1" xref="S3.F2.13.13.m1.1.1.cmml">
        <mi id="S3.F2.13.13.m1.1.1.2" xref="S3.F2.13.13.m1.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.F2.13.13.m1.1.1.3" xref="S3.F2.13.13.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F2.13.13.m1.1c">
        <apply id="S3.F2.13.13.m1.1.1.cmml" xref="S3.F2.13.13.m1.1.1">
         <csymbol cd="ambiguous" id="S3.F2.13.13.m1.1.1.1.cmml" xref="S3.F2.13.13.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.F2.13.13.m1.1.1.2.cmml" xref="S3.F2.13.13.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S3.F2.13.13.m1.1.1.3.cmml" xref="S3.F2.13.13.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.13.13.m1.1d">
        q_{i}
       </annotation>
      </semantics>
     </math>
     , is first inputted into the first layer of our framework (the COE layer). Before being processed by the CEO LLM agent,
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.F2.14.14.m2.1">
      <semantics id="S3.F2.14.14.m2.1b">
       <msub id="S3.F2.14.14.m2.1.1" xref="S3.F2.14.14.m2.1.1.cmml">
        <mi id="S3.F2.14.14.m2.1.1.2" xref="S3.F2.14.14.m2.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.F2.14.14.m2.1.1.3" xref="S3.F2.14.14.m2.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F2.14.14.m2.1c">
        <apply id="S3.F2.14.14.m2.1.1.cmml" xref="S3.F2.14.14.m2.1.1">
         <csymbol cd="ambiguous" id="S3.F2.14.14.m2.1.1.1.cmml" xref="S3.F2.14.14.m2.1.1">
          subscript
         </csymbol>
         <ci id="S3.F2.14.14.m2.1.1.2.cmml" xref="S3.F2.14.14.m2.1.1.2">
          𝑞
         </ci>
         <ci id="S3.F2.14.14.m2.1.1.3.cmml" xref="S3.F2.14.14.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.14.14.m2.1d">
        q_{i}
       </annotation>
      </semantics>
     </math>
     is transformed into an LLM prompt
     <math alttext="p_{i_{c}}" class="ltx_Math" display="inline" id="S3.F2.15.15.m3.1">
      <semantics id="S3.F2.15.15.m3.1b">
       <msub id="S3.F2.15.15.m3.1.1" xref="S3.F2.15.15.m3.1.1.cmml">
        <mi id="S3.F2.15.15.m3.1.1.2" xref="S3.F2.15.15.m3.1.1.2.cmml">
         p
        </mi>
        <msub id="S3.F2.15.15.m3.1.1.3" xref="S3.F2.15.15.m3.1.1.3.cmml">
         <mi id="S3.F2.15.15.m3.1.1.3.2" xref="S3.F2.15.15.m3.1.1.3.2.cmml">
          i
         </mi>
         <mi id="S3.F2.15.15.m3.1.1.3.3" xref="S3.F2.15.15.m3.1.1.3.3.cmml">
          c
         </mi>
        </msub>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F2.15.15.m3.1c">
        <apply id="S3.F2.15.15.m3.1.1.cmml" xref="S3.F2.15.15.m3.1.1">
         <csymbol cd="ambiguous" id="S3.F2.15.15.m3.1.1.1.cmml" xref="S3.F2.15.15.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.F2.15.15.m3.1.1.2.cmml" xref="S3.F2.15.15.m3.1.1.2">
          𝑝
         </ci>
         <apply id="S3.F2.15.15.m3.1.1.3.cmml" xref="S3.F2.15.15.m3.1.1.3">
          <csymbol cd="ambiguous" id="S3.F2.15.15.m3.1.1.3.1.cmml" xref="S3.F2.15.15.m3.1.1.3">
           subscript
          </csymbol>
          <ci id="S3.F2.15.15.m3.1.1.3.2.cmml" xref="S3.F2.15.15.m3.1.1.3.2">
           𝑖
          </ci>
          <ci id="S3.F2.15.15.m3.1.1.3.3.cmml" xref="S3.F2.15.15.m3.1.1.3.3">
           𝑐
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.15.15.m3.1d">
        p_{i_{c}}
       </annotation>
      </semantics>
     </math>
     by the prompter
     <math alttext="f^{c}" class="ltx_Math" display="inline" id="S3.F2.16.16.m4.1">
      <semantics id="S3.F2.16.16.m4.1b">
       <msup id="S3.F2.16.16.m4.1.1" xref="S3.F2.16.16.m4.1.1.cmml">
        <mi id="S3.F2.16.16.m4.1.1.2" xref="S3.F2.16.16.m4.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.F2.16.16.m4.1.1.3" xref="S3.F2.16.16.m4.1.1.3.cmml">
         c
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.16.16.m4.1c">
        <apply id="S3.F2.16.16.m4.1.1.cmml" xref="S3.F2.16.16.m4.1.1">
         <csymbol cd="ambiguous" id="S3.F2.16.16.m4.1.1.1.cmml" xref="S3.F2.16.16.m4.1.1">
          superscript
         </csymbol>
         <ci id="S3.F2.16.16.m4.1.1.2.cmml" xref="S3.F2.16.16.m4.1.1.2">
          𝑓
         </ci>
         <ci id="S3.F2.16.16.m4.1.1.3.cmml" xref="S3.F2.16.16.m4.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.16.16.m4.1d">
        f^{c}
       </annotation>
      </semantics>
     </math>
     , which also concatenates it with the context
     <math alttext="C^{c}" class="ltx_Math" display="inline" id="S3.F2.17.17.m5.1">
      <semantics id="S3.F2.17.17.m5.1b">
       <msup id="S3.F2.17.17.m5.1.1" xref="S3.F2.17.17.m5.1.1.cmml">
        <mi id="S3.F2.17.17.m5.1.1.2" xref="S3.F2.17.17.m5.1.1.2.cmml">
         C
        </mi>
        <mi id="S3.F2.17.17.m5.1.1.3" xref="S3.F2.17.17.m5.1.1.3.cmml">
         c
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.17.17.m5.1c">
        <apply id="S3.F2.17.17.m5.1.1.cmml" xref="S3.F2.17.17.m5.1.1">
         <csymbol cd="ambiguous" id="S3.F2.17.17.m5.1.1.1.cmml" xref="S3.F2.17.17.m5.1.1">
          superscript
         </csymbol>
         <ci id="S3.F2.17.17.m5.1.1.2.cmml" xref="S3.F2.17.17.m5.1.1.2">
          𝐶
         </ci>
         <ci id="S3.F2.17.17.m5.1.1.3.cmml" xref="S3.F2.17.17.m5.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.17.17.m5.1d">
        C^{c}
       </annotation>
      </semantics>
     </math>
     in the CEO layer. The output of the first layer,
     <math alttext="q_{i}^{c}" class="ltx_Math" display="inline" id="S3.F2.18.18.m6.1">
      <semantics id="S3.F2.18.18.m6.1b">
       <msubsup id="S3.F2.18.18.m6.1.1" xref="S3.F2.18.18.m6.1.1.cmml">
        <mi id="S3.F2.18.18.m6.1.1.2.2" xref="S3.F2.18.18.m6.1.1.2.2.cmml">
         q
        </mi>
        <mi id="S3.F2.18.18.m6.1.1.2.3" xref="S3.F2.18.18.m6.1.1.2.3.cmml">
         i
        </mi>
        <mi id="S3.F2.18.18.m6.1.1.3" xref="S3.F2.18.18.m6.1.1.3.cmml">
         c
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.18.18.m6.1c">
        <apply id="S3.F2.18.18.m6.1.1.cmml" xref="S3.F2.18.18.m6.1.1">
         <csymbol cd="ambiguous" id="S3.F2.18.18.m6.1.1.1.cmml" xref="S3.F2.18.18.m6.1.1">
          superscript
         </csymbol>
         <apply id="S3.F2.18.18.m6.1.1.2.cmml" xref="S3.F2.18.18.m6.1.1">
          <csymbol cd="ambiguous" id="S3.F2.18.18.m6.1.1.2.1.cmml" xref="S3.F2.18.18.m6.1.1">
           subscript
          </csymbol>
          <ci id="S3.F2.18.18.m6.1.1.2.2.cmml" xref="S3.F2.18.18.m6.1.1.2.2">
           𝑞
          </ci>
          <ci id="S3.F2.18.18.m6.1.1.2.3.cmml" xref="S3.F2.18.18.m6.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.F2.18.18.m6.1.1.3.cmml" xref="S3.F2.18.18.m6.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.18.18.m6.1d">
        q_{i}^{c}
       </annotation>
      </semantics>
     </math>
     , serves as the query from the CEO layer to the Manager layer.
Similarly, the Manager Layer and the Worker Layer each include their own prompters,
     <math alttext="f^{m}" class="ltx_Math" display="inline" id="S3.F2.19.19.m7.1">
      <semantics id="S3.F2.19.19.m7.1b">
       <msup id="S3.F2.19.19.m7.1.1" xref="S3.F2.19.19.m7.1.1.cmml">
        <mi id="S3.F2.19.19.m7.1.1.2" xref="S3.F2.19.19.m7.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.F2.19.19.m7.1.1.3" xref="S3.F2.19.19.m7.1.1.3.cmml">
         m
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.19.19.m7.1c">
        <apply id="S3.F2.19.19.m7.1.1.cmml" xref="S3.F2.19.19.m7.1.1">
         <csymbol cd="ambiguous" id="S3.F2.19.19.m7.1.1.1.cmml" xref="S3.F2.19.19.m7.1.1">
          superscript
         </csymbol>
         <ci id="S3.F2.19.19.m7.1.1.2.cmml" xref="S3.F2.19.19.m7.1.1.2">
          𝑓
         </ci>
         <ci id="S3.F2.19.19.m7.1.1.3.cmml" xref="S3.F2.19.19.m7.1.1.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.19.19.m7.1d">
        f^{m}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="f^{w}" class="ltx_Math" display="inline" id="S3.F2.20.20.m8.1">
      <semantics id="S3.F2.20.20.m8.1b">
       <msup id="S3.F2.20.20.m8.1.1" xref="S3.F2.20.20.m8.1.1.cmml">
        <mi id="S3.F2.20.20.m8.1.1.2" xref="S3.F2.20.20.m8.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.F2.20.20.m8.1.1.3" xref="S3.F2.20.20.m8.1.1.3.cmml">
         w
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.20.20.m8.1c">
        <apply id="S3.F2.20.20.m8.1.1.cmml" xref="S3.F2.20.20.m8.1.1">
         <csymbol cd="ambiguous" id="S3.F2.20.20.m8.1.1.1.cmml" xref="S3.F2.20.20.m8.1.1">
          superscript
         </csymbol>
         <ci id="S3.F2.20.20.m8.1.1.2.cmml" xref="S3.F2.20.20.m8.1.1.2">
          𝑓
         </ci>
         <ci id="S3.F2.20.20.m8.1.1.3.cmml" xref="S3.F2.20.20.m8.1.1.3">
          𝑤
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.20.20.m8.1d">
        f^{w}
       </annotation>
      </semantics>
     </math>
     , respectively. Besides concatenating the content of this layer, the initial query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.F2.21.21.m9.1">
      <semantics id="S3.F2.21.21.m9.1b">
       <msub id="S3.F2.21.21.m9.1.1" xref="S3.F2.21.21.m9.1.1.cmml">
        <mi id="S3.F2.21.21.m9.1.1.2" xref="S3.F2.21.21.m9.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.F2.21.21.m9.1.1.3" xref="S3.F2.21.21.m9.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F2.21.21.m9.1c">
        <apply id="S3.F2.21.21.m9.1.1.cmml" xref="S3.F2.21.21.m9.1.1">
         <csymbol cd="ambiguous" id="S3.F2.21.21.m9.1.1.1.cmml" xref="S3.F2.21.21.m9.1.1">
          subscript
         </csymbol>
         <ci id="S3.F2.21.21.m9.1.1.2.cmml" xref="S3.F2.21.21.m9.1.1.2">
          𝑞
         </ci>
         <ci id="S3.F2.21.21.m9.1.1.3.cmml" xref="S3.F2.21.21.m9.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.21.21.m9.1d">
        q_{i}
       </annotation>
      </semantics>
     </math>
     is also concatenated to enhance stability. The input for the Worker LLM is our optimized prompt
     <math alttext="P_{i}^{*}" class="ltx_Math" display="inline" id="S3.F2.22.22.m10.1">
      <semantics id="S3.F2.22.22.m10.1b">
       <msubsup id="S3.F2.22.22.m10.1.1" xref="S3.F2.22.22.m10.1.1.cmml">
        <mi id="S3.F2.22.22.m10.1.1.2.2" xref="S3.F2.22.22.m10.1.1.2.2.cmml">
         P
        </mi>
        <mi id="S3.F2.22.22.m10.1.1.2.3" xref="S3.F2.22.22.m10.1.1.2.3.cmml">
         i
        </mi>
        <mo id="S3.F2.22.22.m10.1.1.3" xref="S3.F2.22.22.m10.1.1.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.F2.22.22.m10.1c">
        <apply id="S3.F2.22.22.m10.1.1.cmml" xref="S3.F2.22.22.m10.1.1">
         <csymbol cd="ambiguous" id="S3.F2.22.22.m10.1.1.1.cmml" xref="S3.F2.22.22.m10.1.1">
          superscript
         </csymbol>
         <apply id="S3.F2.22.22.m10.1.1.2.cmml" xref="S3.F2.22.22.m10.1.1">
          <csymbol cd="ambiguous" id="S3.F2.22.22.m10.1.1.2.1.cmml" xref="S3.F2.22.22.m10.1.1">
           subscript
          </csymbol>
          <ci id="S3.F2.22.22.m10.1.1.2.2.cmml" xref="S3.F2.22.22.m10.1.1.2.2">
           𝑃
          </ci>
          <ci id="S3.F2.22.22.m10.1.1.2.3.cmml" xref="S3.F2.22.22.m10.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <times id="S3.F2.22.22.m10.1.1.3.cmml" xref="S3.F2.22.22.m10.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.22.22.m10.1d">
        P_{i}^{*}
       </annotation>
      </semantics>
     </math>
     , which directly triggers the LLM agent to generate the final response to the original query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.F2.23.23.m11.1">
      <semantics id="S3.F2.23.23.m11.1b">
       <msub id="S3.F2.23.23.m11.1.1" xref="S3.F2.23.23.m11.1.1.cmml">
        <mi id="S3.F2.23.23.m11.1.1.2" xref="S3.F2.23.23.m11.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.F2.23.23.m11.1.1.3" xref="S3.F2.23.23.m11.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F2.23.23.m11.1c">
        <apply id="S3.F2.23.23.m11.1.1.cmml" xref="S3.F2.23.23.m11.1.1">
         <csymbol cd="ambiguous" id="S3.F2.23.23.m11.1.1.1.cmml" xref="S3.F2.23.23.m11.1.1">
          subscript
         </csymbol>
         <ci id="S3.F2.23.23.m11.1.1.2.cmml" xref="S3.F2.23.23.m11.1.1.2">
          𝑞
         </ci>
         <ci id="S3.F2.23.23.m11.1.1.3.cmml" xref="S3.F2.23.23.m11.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F2.23.23.m11.1d">
        q_{i}
       </annotation>
      </semantics>
     </math>
     .
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Discussion
   </h3>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.1">
      Advantage of a hierarchical structure over a single node.
     </span>
     For complex prompts such as improving code readability, a single node such as ExpertPrompting may not be able to exhibit a deep understanding. In the proposed hierarchical structure, global instructions are given by the CEO, and more local instructions by the manager. This allows for layered understanding of the prompt and thus makes it easy for the worker LLM to generate more satisfying answers.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">
      Why using skip connections?
     </span>
     As illustrated in Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , the prompters in both the manager layer and the worker layer concatenate not only the context information and the orders from the preceding layer but also the initial query
     <math alttext="q_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1">
      <semantics id="S3.SS3.p2.1.m1.1a">
       <msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">
        <mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">
         q
        </mi>
        <mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b">
        <apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">
          𝑞
         </ci>
         <ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">
        q_{i}
       </annotation>
      </semantics>
     </math>
     . This step is essential to preserve the specificity of the initial query in the system, avoiding the dilution of critical details. Moreover, if the instructions generated by a previous layer are not correct, incorporating the initial query would reinforce the original intent, thereby preventing misinterpretation. Results in Section
     <a class="ltx_ref" href="#S5.SS1" title="5.1 Main Evaluation ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       5.1
      </span>
     </a>
     demonstrate the usefulness of skip connections.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">
      AI workflow using tools to solve complex tasks.
     </span>
     Some existing works decompose complex task into individual steps which use different tools. After these steps are executed, it is expected that the task is complete. Our work is different in that we do not perform task decomposition and instead use the refined prompt in one go. This paper follows the standard set up of prompt optimization.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Experimental Setup
  </h2>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    <span class="ltx_text ltx_font_bold" id="S4.SS1.1.1">
     Datasets and Evaluation Metrics
    </span>
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">
      ATLAS
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib26" title="">
       <span class="ltx_text" style="font-size:90%;">
        26
       </span>
      </a>
      ]
     </cite>
     is a manually crafted benchmark for principled prompt evaluation. It contains a standard subset featuring questions across various domains, along with a challenging subset dedicated to reasoning and other complex tasks. It contains 520 questions, and each one has the corresponding output of various LLMs such as GPT-3.5 and Llama 2.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">
      FED
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib27" title="">
       <span class="ltx_text" style="font-size:90%;">
        27
       </span>
      </a>
      ]
     </cite>
     is a comprehensive collection of annotated human-system and human-human conversations, featuring 18 fine-grained dialog qualities. It is comprised of 3,348 turn-level and 1,364 dialog-level data points, totaling 4,712. FED provides evaluation at both the turn and whole dialog levels. With moderate to strong correlation to human judgment across these levels, the dataset offers a reliable benchmark for analyzing interactive dialog systems.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p3">
    <p class="ltx_p" id="S4.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">
      GSM8K.
     </span>
     The GSM8K dataset (Grade School Math 8K)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib28" title="">
       <span class="ltx_text" style="font-size:90%;">
        28
       </span>
      </a>
      ]
     </cite>
     is a collection of 8,791 grade-school-level math word problems, with detailed step-by-step solutions. It includes 7,473 training problems and 1,319 test problems. Designed by OpenAI, GSM8K serves as a benchmark for evaluating mathematical reasoning in machine learning models. We report results on its test set.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p4">
    <p class="ltx_p" id="S4.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">
      CodeNet.
     </span>
     Project CodeNet
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib29" title="">
       <span class="ltx_text" style="font-size:90%;">
        29
       </span>
      </a>
      ]
     </cite>
     is a large-scale dataset consisting of code samples across over 50 programming languages. We follow the practice in Self-Refine
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:90%;">
        30
       </span>
      </a>
      ]
     </cite>
     and consider a random subset of 300 examples in Python. We compare different prompting optimization methods on the task of improving code readability.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p5">
    <p class="ltx_p" id="S4.SS1.p5.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">
      Education.
     </span>
     We collected a new datasets focusing on providing appropriate teaching responses to students. A student question can be
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p5.1.2">
      ‘we just started looking at genes and stuff in science class…what this gene editing thing is all about.’
     </span>
     . The LLM is supposed to give a teacher-style reply which, preferably, should consider student background and is easy to understand. This dataset has 100 student questions generated by GPT4, which were then manually cleaned.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p6">
    <p class="ltx_p" id="S4.SS1.p6.1">
     We use two
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p6.1.1">
      metrics
     </span>
     to evaluate the quality of generated responses. For the objective task GSM8K, we use the provided answer to compute the accuracy of the responses. For subjective tasks (
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p6.1.2">
      i.e
     </em>
     .
     <span class="ltx_text" id="S4.SS1.p6.1.3">
     </span>
     , Education, ATLAS, FED, CodeNet), we follow the practice in
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:90%;">
        30
       </span>
      </a>
      ]
     </cite>
     , which uses LLMs as the evaluator. Specifically, we compare the response pair generated from the optimized prompt and the response generated from the initial query by asking GPT-3.5 which response it prefers. GPT3.5 then assigns a score of 1 to the preferred response and a score of 0 to the other. The prompt used for the Evaluator agent is shown in the Appendix
     <a class="ltx_ref" href="#A1.SS2" title="A.2 Context Descriptions for Evaluator ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       A.2
      </span>
     </a>
     . To reduce the impact of the primacy effect issue
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib31" title="">
       <span class="ltx_text" style="font-size:90%;">
        31
       </span>
      </a>
      ]
     </cite>
     and bias of LLMs in multiple choice questions, we follow the practice in PriDe
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib32" title="">
       <span class="ltx_text" style="font-size:90%;">
        32
       </span>
      </a>
      ]
     </cite>
     and permute option
contents. Specifically, we run each test case twice with switched response orders and compute the average score. We then average these scores across the entire test set. The average score ranges from 0 to 1.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Compared Methods
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     We compared our method to the following types of prompt optimization methods.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">
      Single Agent, Zero-shot.
     </span>
     (1)
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p2.1.2">
      No prompting
     </span>
     . The initial query from the dataset is directly input into the LLMs without utilizing any additional prompting techniques. (2)
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p2.1.3">
      Zero-shot CoT
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib1" title="">
       <span class="ltx_text" style="font-size:90%;">
        1
       </span>
      </a>
      ]
     </cite>
     . This method adds the fixed text ‘
     <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.1.4">
      think step by step
     </span>
     ’ to the end of the initial query to formulate an optimized prompt for the LLM.
(3)
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p2.1.5">
      Rephrase and Response (RaR)
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib14" title="">
       <span class="ltx_text" style="font-size:90%;">
        14
       </span>
      </a>
      ]
     </cite>
     . This method allows LLMs to rephrase and expand questions posed by humans and provides responses in a single prompt.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">
      Single Agent, Multi-shot
     </span>
     (1)
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p3.1.2">
      On Meta-prompting (OMP)
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib13" title="">
       <span class="ltx_text" style="font-size:90%;">
        13
       </span>
      </a>
      ]
     </cite>
     . It designs handcrafted meta-prompts to instruct LLMs to generate prompts for answering the initial human query. (2)
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p3.1.3">
      Expert Prompting (EP)
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib6" title="">
       <span class="ltx_text" style="font-size:90%;">
        6
       </span>
      </a>
      ]
     </cite>
     : this method uses the LLM to generate a text description of the expert identity that is suitable to solve the given query, and then attaches the generated description to the initial query to create an optimized prompt.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p4">
    <p class="ltx_p" id="S4.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">
      Multi-agent prompting.
     </span>
     Multi-Personas
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib15" title="">
       <span class="ltx_text" style="font-size:90%;">
        15
       </span>
      </a>
      ]
     </cite>
     . This method transforms a single LLM into a cognitive synergist by engaging in multi-turn self-collaboration with multiple personas.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p5">
    <p class="ltx_p" id="S4.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p5.1.1">
      Feedback-based
     </span>
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p5.1.2">
      Automatic Prompt Engineer (APE)
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib5" title="">
       <span class="ltx_text" style="font-size:90%;">
        5
       </span>
      </a>
      ]
     </cite>
     . This framework automatically generate prompt candidates and selete prompts based on LLM feedback on those candidates.
    </p>
   </div>
   <figure class="ltx_table" id="S4.T2">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     Comparison with existing prompt optimization methods. For ATLAS, FED, CodeNet, and Education datasets, we GPT-3.5 to give a preference score (%) between results obtained by ‘No Prompting’ and a prompt optimization method. For example, 41.4% under ‘w/o’ means in 41.1% of the pairs, GPT-3.5 prefers answers produced by ‘No Prompt’; 63.4% under ‘w’ means in 63.4% of the pairs GPT-3.5 prefer answers produced after prompt optimization. Higher is better. For GSM8K, we report accuracy (%) of the generated responses
     <em class="ltx_emph ltx_font_italic" id="S4.T2.13.1">
      w.r.t
     </em>
     ground-truth answers, and higher is better. We also report average performance across the five tasks and the absolute improvement (%) of prompt optimization over no prompting.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.8">
     <tr class="ltx_tr" id="S4.T2.8.9">
      <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.8.9.1" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.1.1" style="font-size:90%;">
        Method
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.2.1" style="font-size:90%;">
        ATLAS
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.3.1" style="font-size:90%;">
        FED
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.4.1" style="font-size:90%;">
        CodeNet
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.5.1" style="font-size:90%;">
        Education
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.6.1" style="font-size:90%;">
        GSM8K
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.8.9.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.9.7.1" style="font-size:90%;">
        Avg.
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.8.10">
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.1" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.1.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.2.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.3.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.4.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.5.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.6.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.7.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.8.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.9.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.10.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.11" style="background-color:#FFFFFF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.11.1" style="font-size:90%;background-color:#FFFFFF;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.10.12" style="background-color:#FFFFFF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.10.12.1" style="font-size:90%;background-color:#FFFFFF;">
        w
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.8.11">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="13" id="S4.T2.8.11.1" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.11.1.1" style="font-size:90%;">
        Zero-shot
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.1.1">
      <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.2.1" style="font-size:90%;">
        Zero-CoT
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.1.1.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib1" title="">
         <span class="ltx_text" style="font-size:90%;">
          1
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.1.1.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.3.1" style="font-size:90%;">
        41.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.4.1" style="font-size:90%;">
        58.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.5.1" style="font-size:90%;">
        43.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.6.1" style="font-size:90%;">
        56.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.7.1" style="font-size:90%;">
        45.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.8.1" style="font-size:90%;">
        54.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.9.1" style="font-size:90%;">
        41.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.10.1" style="font-size:90%;">
        58.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.12.1" style="font-size:90%;">
        73.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.13.1" style="font-size:90%;background-color:#BFBFBF;">
        48.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.1.1.1.1" style="font-size:90%;background-color:#BFBFBF;">
        60.3 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1">
         <semantics id="S4.T2.1.1.1.1.m1.1a">
          <mo id="S4.T2.1.1.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b">
           <ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        12.2)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.2.2">
      <td class="ltx_td ltx_align_left" id="S4.T2.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.2.1" style="font-size:90%;">
        RaR
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.2.2.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib14" title="">
         <span class="ltx_text" style="font-size:90%;">
          14
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.2.2.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.3.1" style="font-size:90%;">
        36.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.4.1" style="font-size:90%;">
        63.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.5.1" style="font-size:90%;">
        24.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.6.1" style="font-size:90%;">
        75.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.7.1" style="font-size:90%;">
        60.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.8.1" style="font-size:90%;">
        39.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.9.1" style="font-size:90%;">
        49.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.10.1" style="font-size:90%;">
        50.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.12.1" style="font-size:90%;">
        72.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.13.1" style="font-size:90%;background-color:#BFBFBF;">
        48.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.2.2.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.2.2.1.1" style="font-size:90%;background-color:#BFBFBF;">
        60.2 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.2.2.1.1.m1.1">
         <semantics id="S4.T2.2.2.1.1.m1.1a">
          <mo id="S4.T2.2.2.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.2.2.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.1.m1.1b">
           <ci id="S4.T2.2.2.1.1.m1.1.1.cmml" xref="S4.T2.2.2.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.2.2.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        12.1)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.3.3">
      <td class="ltx_td ltx_align_left" id="S4.T2.3.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.2.1" style="font-size:90%;">
        On-MP
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.3.3.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib13" title="">
         <span class="ltx_text" style="font-size:90%;">
          13
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.3.3.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.3.1" style="font-size:90%;">
        53.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.4.1" style="font-size:90%;">
        46.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.5.1" style="font-size:90%;">
        31.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.6.1" style="font-size:90%;">
        68.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.7.1" style="font-size:90%;">
        50.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.8.1" style="font-size:90%;">
        49.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.9.1" style="font-size:90%;">
        47.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.10.1" style="font-size:90%;">
        52.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.12.1" style="font-size:90%;">
        61.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.13.1" style="font-size:90%;background-color:#BFBFBF;">
        50.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.3.3.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.3.3.1.1" style="font-size:90%;background-color:#BFBFBF;">
        55.5 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.1.1.m1.1">
         <semantics id="S4.T2.3.3.1.1.m1.1a">
          <mo id="S4.T2.3.3.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.3.3.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.1.m1.1b">
           <ci id="S4.T2.3.3.1.1.m1.1.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.3.3.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        5.1)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.4.4">
      <td class="ltx_td ltx_align_left" id="S4.T2.4.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.2.1" style="font-size:90%;">
        Static-EP
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.4.4.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib6" title="">
         <span class="ltx_text" style="font-size:90%;">
          6
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.4.4.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.3.1" style="font-size:90%;">
        44.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.4.1" style="font-size:90%;">
        56.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.5.1" style="font-size:90%;">
        39.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.6.1" style="font-size:90%;">
        60.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.7.1" style="font-size:90%;">
        42.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.8.1" style="font-size:90%;">
        57.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.9.1" style="font-size:90%;">
        52.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.10.1" style="font-size:90%;">
        47.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.12.1" style="font-size:90%;">
        73.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.13.1" style="font-size:90%;background-color:#BFBFBF;">
        49.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.4.4.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.4.4.1.1" style="font-size:90%;background-color:#BFBFBF;">
        59.1 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.4.1.1.m1.1">
         <semantics id="S4.T2.4.4.1.1.m1.1a">
          <mo id="S4.T2.4.4.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.4.4.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.1.m1.1b">
           <ci id="S4.T2.4.4.1.1.m1.1.1.cmml" xref="S4.T2.4.4.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.4.4.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        9.8)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.5.5">
      <td class="ltx_td ltx_align_left" id="S4.T2.5.5.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.2.1" style="font-size:90%;">
        HMAW (Ours)
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.3.1" style="font-size:90%;">
        35.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.4.1" style="font-size:90%;">
        64.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.5.1" style="font-size:90%;">
        13.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.6.1" style="font-size:90%;">
        86.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.7.1" style="font-size:90%;">
        35.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.8.1" style="font-size:90%;">
        64.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.9.1" style="font-size:90%;">
        38.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.10.1" style="font-size:90%;">
        61.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.12.1" style="font-size:90%;">
        70.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.13.1" style="font-size:90%;background-color:#BFBFBF;">
        38.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.5.5.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.5.5.1.1" style="font-size:90%;background-color:#BFBFBF;">
        69.2 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.5.5.1.1.m1.1">
         <semantics id="S4.T2.5.5.1.1.m1.1a">
          <mo id="S4.T2.5.5.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.5.5.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.1.m1.1b">
           <ci id="S4.T2.5.5.1.1.m1.1.1.cmml" xref="S4.T2.5.5.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.5.5.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        30.7)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.8.12">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="13" id="S4.T2.8.12.1" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.12.1.1" style="font-size:90%;">
        Multi-shot
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.6.6">
      <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.2.1" style="font-size:90%;">
        Dynamic-EP
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.6.6.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib6" title="">
         <span class="ltx_text" style="font-size:90%;">
          6
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.6.6.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.3.1" style="font-size:90%;">
        45.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.4.1" style="font-size:90%;">
        54.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.5.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.6.1" style="font-size:90%;">
        71.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.7.1" style="font-size:90%;">
        44.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.8.1" style="font-size:90%;">
        55.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.9.1" style="font-size:90%;">
        46.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.10.1" style="font-size:90%;">
        53.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.12.1" style="font-size:90%;">
        66.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.13.1" style="font-size:90%;background-color:#BFBFBF;">
        54.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.6.6.1.1" style="font-size:90%;background-color:#BFBFBF;">
        60.2 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.6.1.1.m1.1">
         <semantics id="S4.T2.6.6.1.1.m1.1a">
          <mo id="S4.T2.6.6.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.6.6.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.6.6.1.1.m1.1b">
           <ci id="S4.T2.6.6.1.1.m1.1.1.cmml" xref="S4.T2.6.6.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.6.6.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        5.4)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.7.7">
      <td class="ltx_td ltx_align_left" id="S4.T2.7.7.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.2.1" style="font-size:90%;">
        Multi-Persona
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.7.7.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib15" title="">
         <span class="ltx_text" style="font-size:90%;">
          15
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.7.7.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.3.1" style="font-size:90%;">
        73.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.4.1" style="font-size:90%;">
        26.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.5.1" style="font-size:90%;">
        50.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.6.1" style="font-size:90%;">
        49.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.7.1" style="font-size:90%;">
        75.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.8.1" style="font-size:90%;">
        24.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.9.1" style="font-size:90%;">
        57.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.10.1" style="font-size:90%;">
        42.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.12.1" style="font-size:90%;">
        71.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.13.1" style="font-size:90%;background-color:#BFBFBF;">
        65.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T2.7.7.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.7.7.1.1" style="font-size:90%;background-color:#BFBFBF;">
        42.9 (
        <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.7.7.1.1.m1.1">
         <semantics id="S4.T2.7.7.1.1.m1.1a">
          <mo id="S4.T2.7.7.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.7.7.1.1.m1.1.1.cmml">
           ↓
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.7.7.1.1.m1.1b">
           <ci id="S4.T2.7.7.1.1.m1.1.1.cmml" xref="S4.T2.7.7.1.1.m1.1.1">
            ↓
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.7.7.1.1.m1.1c">
           \downarrow
          </annotation>
         </semantics>
        </math>
        22.2)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.8.13">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="13" id="S4.T2.8.13.1" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.13.1.1" style="font-size:90%;">
        Optimized from a training set
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.8.8">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T2.8.8.2" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.2.1" style="font-size:90%;">
        APE
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S4.T2.8.8.2.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib5" title="">
         <span class="ltx_text" style="font-size:90%;">
          5
         </span>
        </a>
        <span class="ltx_text" id="S4.T2.8.8.2.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.3" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.3.1" style="font-size:90%;">
        45.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.4" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.4.1" style="font-size:90%;">
        54.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.5" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.5.1" style="font-size:90%;">
        44.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.6" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.6.1" style="font-size:90%;">
        55.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.7" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.7.1" style="font-size:90%;">
        39.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.8" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.8.1" style="font-size:90%;">
        60.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.9" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.9.1" style="font-size:90%;">
        45.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.10" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.10.1" style="font-size:90%;">
        54.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.11" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.11.1" style="font-size:90%;">
        68.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.12" style="padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.12.1" style="font-size:90%;">
        70.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.13" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.13.1" style="font-size:90%;background-color:#BFBFBF;">
        48.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.8.8.1" style="background-color:#BFBFBF;padding-left:4.0pt;padding-right:4.0pt;">
       <span class="ltx_text" id="S4.T2.8.8.1.1" style="font-size:90%;background-color:#BFBFBF;">
        58.9 (
        <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.8.8.1.1.m1.1">
         <semantics id="S4.T2.8.8.1.1.m1.1a">
          <mo id="S4.T2.8.8.1.1.m1.1.1" mathbackground="#BFBFBF" stretchy="false" xref="S4.T2.8.8.1.1.m1.1.1.cmml">
           ↑
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.8.8.1.1.m1.1b">
           <ci id="S4.T2.8.8.1.1.m1.1.1.cmml" xref="S4.T2.8.8.1.1.m1.1.1">
            ↑
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.8.8.1.1.m1.1c">
           \uparrow
          </annotation>
         </semantics>
        </math>
        10.0)
       </span>
      </td>
     </tr>
    </table>
   </figure>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Experimental Results
  </h2>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1
    </span>
    Main Evaluation
   </h3>
   <div class="ltx_para" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     All experiments in the main evaluation are conducted using the open-source model ‘Mixtral-8x7B-v0.1’
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib8" title="">
       <span class="ltx_text" style="font-size:90%;">
        8
       </span>
      </a>
      ]
     </cite>
     as the LLM agent.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p2">
    <p class="ltx_p" id="S5.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">
      HMAW achieves consistent improvements across various datasets over ‘No Prompting’.
     </span>
     On the five datasets, we compare our method with results obtained without prompting optimization. Results are summarized in Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 Compared Methods ‣ 4 Experimental Setup ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . We clearly observe that HMAW improves response quality over no prompting across the five tasks. Specifically, for ATLAS, FED, CodeNet, and Education, in 64.1%, 86.2%, 70.3%, 64.4%, and 61.3% of the result pairs, respectively, GPT-3.5 prefers HMAW results over the no prompting results. For GSM8K, the accuracy of our method is 70.3%, which is +1.7% higher than the no prompting scenario. If we examine the average performance of the five tasks, result produced by HMAW is preferred by GPT-3.5 in 69.2% of all the result pairs.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p3">
    <p class="ltx_p" id="S5.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">
      HMAW is very competitive compared to the state-of-the-art prompt optimization methods.
     </span>
     The comparative results are summarized in Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 Compared Methods ‣ 4 Experimental Setup ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
We have two observations.
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.2">
      First
     </span>
     , on the ATLAS, FED, CodeNet, and Education datasets, HMAW yields the highest preference score compared with no prompting. On GSM8K, our method is slightly lower. This is partly because prompting methods like Zero-CoT are specifically designed for math problems. These methods are less generalizable to other tasks compared with our method.
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.3">
      Second
     </span>
     , if we compute the average score over the five tasks, our method has the highest score. These results indcate that our method is very competitive while operating in a zero-shot and task-agnostic manner.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F3">
    <p class="ltx_p ltx_align_center ltx_align_center" id="S5.F3.1.1">
     <span class="ltx_text" id="S5.F3.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="92" id="S5.F3.1.1.1.g1" src="/html/2405.20252/assets/x3.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 3:
     </span>
     Ablation studies. We remove various components from the full system. Preference score (%) is reported on three datasets: Education (left), CodeNet (middle), and FED (right). These components include the two skip connections, the CEO layer and the Manager layer. It is observed that removing these components one or two at a time leads to performance drop.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS1.p4">
    <p class="ltx_p" id="S5.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">
      Ablation studies of skip connections.
     </span>
     As shown in Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , HMAW has two skip connections from the user query to both the Manager layer and the Worker layer. This empirical practice alleviates scenarios where HMAW loses or distorts key details from the initial user query. To investigate their impact, we conduct ablation studies by removing them from the workflow. Results on the FED, CodeNet, and Education datasets are reported in Fig.
     <a class="ltx_ref" href="#S5.F3" title="Figure 3 ‣ 5.1 Main Evaluation ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     . We find that removing either of the skip connections leads to performance decrease on the three datasets. For example, removing the connection between user query and the Manger Layer results in preference sore decrease of 20.7% and 5.0% on the CodeNet and Education datasets, respectively. Similar decrease of 9.9% and 2.5% occurs when removing the other connection. Removing both connections results in the worst performance. These results indicate the importance of having the skip connections in the workflow.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p5">
    <p class="ltx_p" id="S5.SS1.p5.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">
      Ablation studies of the CEO and Manager layers.
     </span>
     We remove the layers one at a time from our system. If we remove the Manager layer, the CEO will directly give instructions to drive the Worker without the help of the Manager, where we have modified the context description of both CEO and Worker. If we remove the CEO layer, the Manager directly generates the instructions to Worker without CEO guidance. We compare these scenarios with full system (Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ). Results on three datasets are shown in Fig.
     <a class="ltx_ref" href="#S5.F3" title="Figure 3 ‣ 5.1 Main Evaluation ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     . We clearly find that removing either layer results in worse preference scores. For example, removing the Manager layer leads the preference score to drop by 11.5%, 3.3%, and 12.1% on the three datasets, respectively.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.2
    </span>
    Further Analysis
   </h3>
   <figure class="ltx_figure ltx_align_floatright" id="S5.F4">
    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="346" id="S5.F4.g1" src="/html/2405.20252/assets/x4.png" width="461"/>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      Figure 4:
     </span>
     Impact of the number of workflow layers. The preference scores for responses generated using HMAW with different numbers of layers (1-6) are reported on the Education dataset. GPT-3.5 is used as the LLM agent. Three layers (CEO-Manager-Worker) yields the highest preference score.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S5.T3">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     Impact of different LLMs on our method. We replace the default Mixtral-8x7B-v0.1 with GPT-3.5 and GPT-4 as the base LLMs to optimize prompts and generate responses. Three subjective datasets are used. We use the same preference score as Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 Compared Methods ‣ 4 Experimental Setup ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T3.4">
     <tr class="ltx_tr" id="S5.T3.4.1">
      <td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T3.4.1.1" rowspan="3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.1.1.1" style="font-size:90%;">
        Method
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S5.T3.4.1.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.1.2.1" style="font-size:90%;">
        GPT3.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S5.T3.4.1.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.1.3.1" style="font-size:90%;">
        GPT4o
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T3.4.2">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.1" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.1.1" style="font-size:90%;">
        FED
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.2.1" style="font-size:90%;">
        CodeNet
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.3.1" style="font-size:90%;">
        Education
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.4" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.4.1" style="font-size:90%;">
        FED
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.5" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.5.1" style="font-size:90%;">
        CodeNet
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T3.4.2.6" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.2.6.1" style="font-size:90%;">
        Education
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T3.4.3">
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.1" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.1.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.2.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.3.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.4" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.4.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.5" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.5.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.6" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.6.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.7" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.7.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.8" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.8.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.9" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.9.1" style="font-size:90%;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.10" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.10.1" style="font-size:90%;">
        w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.11" style="background-color:#FFFFFF;padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.11.1" style="font-size:90%;background-color:#FFFFFF;">
        w/o
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.3.12" style="background-color:#FFFFFF;padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.3.12.1" style="font-size:90%;background-color:#FFFFFF;">
        w
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T3.4.4">
      <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.4.4.1" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.1.1" style="font-size:90%;">
        Dynamic-EP
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.2.1" style="font-size:90%;">
        25.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.3.1" style="font-size:90%;">
        74.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.4" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.4.1" style="font-size:90%;">
        20.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.5" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.5.1" style="font-size:90%;">
        79.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.6" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.6.1" style="font-size:90%;">
        48.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.7" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.7.1" style="font-size:90%;">
        52.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.8" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.8.1" style="font-size:90%;">
        22.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.9" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.9.1" style="font-size:90%;">
        77.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.10" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.10.1" style="font-size:90%;">
        24.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.11" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.11.1" style="font-size:90%;">
        75.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.12" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.12.1" style="font-size:90%;">
        44.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.4.13" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.4.13.1" style="font-size:90%;">
        55.5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T3.4.5">
      <td class="ltx_td ltx_align_left" id="S5.T3.4.5.1" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.1.1" style="font-size:90%;">
        APE
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.2.1" style="font-size:90%;">
        46.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.3.1" style="font-size:90%;">
        54.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.4" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.4.1" style="font-size:90%;">
        43.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.5" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.5.1" style="font-size:90%;">
        56.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.6" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.6.1" style="font-size:90%;">
        49.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.7" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.7.1" style="font-size:90%;">
        51.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.8" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.8.1" style="font-size:90%;">
        36.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.9" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.9.1" style="font-size:90%;">
        63.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.10" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.10.1" style="font-size:90%;">
        15.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.11" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.11.1" style="font-size:90%;">
        84.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.12" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.12.1" style="font-size:90%;">
        41.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S5.T3.4.5.13" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.5.13.1" style="font-size:90%;">
        58.2
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T3.4.6">
      <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.4.6.1" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.1.1" style="font-size:90%;">
        HMAW (Ours)
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.2" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.2.1" style="font-size:90%;">
        8.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.3" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.3.1" style="font-size:90%;">
        91.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.4" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.4.1" style="font-size:90%;">
        4.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.5" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.5.1" style="font-size:90%;">
        95.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.6" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.6.1" style="font-size:90%;">
        27.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.7" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.7.1" style="font-size:90%;">
        73.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.8" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.8.1" style="font-size:90%;">
        21.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.9" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.9.1" style="font-size:90%;">
        78.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.10" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.10.1" style="font-size:90%;">
        21.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.11" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.11.1" style="font-size:90%;">
        78.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.12" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.12.1" style="font-size:90%;">
        38.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.6.13" style="padding-left:5.4pt;padding-right:5.4pt;">
       <span class="ltx_text" id="S5.T3.4.6.13.1" style="font-size:90%;">
        61.5
       </span>
      </td>
     </tr>
    </table>
   </figure>
   <div class="ltx_para" id="S5.SS2.p1">
    <p class="ltx_p" id="S5.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">
      Effectiveness of HMAW is consistent across different LLMs.
     </span>
     Here we use GPT-3.5 and GPT-4 as the LLM agents in our designed workflow in replace of Mixtral. But we still use GPT-3.5 for evaluation. Experimental results are shown in Table
     <a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.2 Further Analysis ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , where we have similar observations to Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 Compared Methods ‣ 4 Experimental Setup ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.2">
      First
     </span>
     , for the three tasks, HMAW is consistently better than no prompting under both GPT-3.5 and GPT-4o agents, evidenced by preferences scores being consistently greater than 50%.
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.3">
      Second
     </span>
     , in most scenarios our method is superior to Dynamic-EP and APE. These results again indicate the effectiveness of our method.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p2">
    <p class="ltx_p" id="S5.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">
      Impact of having more layers in the workflow.
     </span>
     It is interesting to investigate how the number of workflow layers influences the performance of our method. To this end, we create as many as six roles. Fig.
     <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ 5.2 Further Analysis ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     presents the preference scores for responses generated using HMAW with 1 to 6 layers on the Education dataset, with GPT-3.5 as the LLM agent. Note that when increasing the number of layers, we always keep Worker as the last layer to generate final responses.
The details of company structure for different setup on total layer number are described in Appendix
     <a class="ltx_ref" href="#A2" title="Appendix B Workflow Structures ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       B
      </span>
     </a>
     . Our results the Worker-Manager-CEO workflow has the best performance. Beyond three layers, the performance does not improve and instead worsens. It suggests that there is an optimal number of layers which balances system complexity and effectiveness. Therefore, we empirically choose 3 layers as the default setting.
    </p>
   </div>
   <figure class="ltx_table ltx_align_floatright" id="S5.T4">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     Comparison between various workflow contexts. The increase in preference scores is reported on the Education Dataset. GPT-3.5 is used as the LLM agent. We observe that all contexts bring improvement, and our default setting (company) is the best.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T4.3">
     <tr class="ltx_tr" id="S5.T4.3.1">
      <td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T4.3.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.1.1.1" style="font-size:90%;">
        Context
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.3.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.1.2.1" style="font-size:90%;">
        Ours
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.3.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.1.3.1" style="font-size:90%;">
        Gov.
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.3.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.1.4.1" style="font-size:90%;">
        Uni.
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.3.1.5" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.1.5.1" style="font-size:90%;">
        Temple
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S5.T4.3.2">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T4.3.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.2.1.1" style="font-size:90%;">
        Preference (%)
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.3.2.2" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.2.2.1" style="font-size:90%;">
        73.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.3.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.2.3.1" style="font-size:90%;">
        69.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.3.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.2.4.1" style="font-size:90%;">
        59.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.3.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">
       <span class="ltx_text" id="S5.T4.3.2.5.1" style="font-size:90%;">
        52.0
       </span>
      </td>
     </tr>
    </table>
   </figure>
   <div class="ltx_para" id="S5.SS2.p3">
    <p class="ltx_p" id="S5.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">
      Effectiveness of other workflow contexts.
     </span>
     The default context of our workflow is based on a company structure. To investigate the impact of the context on the effectiveness of prompt optimization, we test three other scenarios: Government, University and Temple on the Education dataset, where the hierarchies are introduced in Appendix
     <a class="ltx_ref" href="#A2" title="Appendix B Workflow Structures ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       B
      </span>
     </a>
     . Results are shown in Table
     <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2 Further Analysis ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , where the company structure is most competitive. An interesting finding is that the University structure is not the best, because the Education dataset primarily contains middle/high-school questions.
In summary, the company structure generalizes very well, while certain structure contexts tend to benefit certain tasks.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p4">
    <p class="ltx_p" id="S5.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">
      Impact of disordered company structure.
     </span>
     We now use a reverse structure where Worker gives high-level instructions, Manager gives detailed instructions, and CEO executes the refined user query. Compared with the original one, the preference score on the Education dataset drops from 73.0% to 58.5%. It indicates that the reporting line contains useful semantic meanings and should not be changed.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p5">
    <p class="ltx_p" id="S5.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">
      Computational cost.
     </span>
     Our Experiments are conducted on both local LLMs and the remote API request. Experiments conducted on the Mixtral LLM are implemented in local by using 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S5.SS2.p5.1.m1.1">
      <semantics id="S5.SS2.p5.1.m1.1a">
       <mo id="S5.SS2.p5.1.m1.1.1" xref="S5.SS2.p5.1.m1.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.1b">
        <times id="S5.SS2.p5.1.m1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.1c">
        \times
       </annotation>
      </semantics>
     </math>
     Nvidia GTX 3090 GPUs. On the five datasets,
     <em class="ltx_emph ltx_font_italic" id="S5.SS2.p5.1.2">
      i.e.
     </em>
     , ATLAS, FED, GSM8K, CodeNet, and Education, the average zero-shot inference time cost per sample without prompt optimization is approximately 4.36, 0.70, 1.40, 2.27, and 3.74 seconds, respectively. When the proposed prompt optimization method is used, the average additional time cost per sample is approximately 9.97, 5.14, 4.30, 7.27, and 7.76 seconds, respectively. This corresponds to a 228.57%, 734.29%, 306.57%, 320.88%, and 207.49% increase, respectively. In comparison, the time increase percentage per sample for Dynamic-EP is 535.16%, 294.98%, 448%, 306.57%, and 320.88%, respectively. The higher inference cost of our method can be well offset by the improvement of task performance. In future we will study workflow pruning methods to reduce the number of tokens while maintaining accuracy.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F5">
    <p class="ltx_p ltx_align_center ltx_align_center" id="S5.F5.1.1">
     <span class="ltx_text" id="S5.F5.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="252" id="S5.F5.1.1.1.g1" src="/html/2405.20252/assets/x5.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 5:
     </span>
     An example of prompt optimization using HMAW on the Education dataset. A student poses a question about genetics. CEO creates an instruction to Manager, who then
     <span class="ltx_text" id="S5.F5.8.1" style="color:#0000FF;">
      generates instructions to Worker.
     </span>
     Based on this, Worker delivers the final response. Colored texts indicate content coherence:
     <span class="ltx_text" id="S5.F5.9.2" style="color:#00FF00;">
      green
     </span>
     highlights the user background,
     <span class="ltx_text" id="S5.F5.10.3" style="color:#BF0040;">
      purple
     </span>
     focuses on the topic of the task,
     <span class="ltx_text" id="S5.F5.11.4" style="color:#FF8000;">
      orange
     </span>
     indicates the proposed solution,
     <span class="ltx_text" id="S5.F5.12.5" style="color:#FF0000;">
      red
     </span>
     highlights solution details, and
     <span class="ltx_text" id="S5.F5.13.6" style="color:#0000FF;">
      blue
     </span>
     emphasizes the tone of the response. These layers and cross-layer correspondences demonstrate how HMAW effectively optimizes the prompt and responds to specific user needs. Each step adds specificity and applicability, allowing for accurate and intuitive LLM responses.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS2.p6">
    <p class="ltx_p" id="S5.SS2.p6.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p6.1.1">
      A case study.
     </span>
     We conduct qualitative analysis of the the prompts generated in our workflow and how it helps the final response generation procedure. In Fig.
     <a class="ltx_ref" href="#S5.F5" title="Figure 5 ‣ 5.2 Further Analysis ‣ 5 Experimental Results ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , we illustrate the hierarchical process of generating responses using HMAW. The process begins with the CEO layer, which sets high-level guidelines tailored to the user’s background and specific inquiry. The Manager layer then interprets these guidelines, adding detail and context to direct the response formulation. Finally, the Worker layer produces the final response, ensuring it is coherent, professional, and empathetic, taking into full account the user’s limited familiarity with the topic. This structured approach ensures that the response effectively addresses the user’s query and matches their level of understanding. More case studies for other datasets are available in the Appendix Section
     <a class="ltx_ref" href="#A3" title="Appendix C More Case Studies ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       C
      </span>
     </a>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Conclusion
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    This work introduces a new prompt optimization method based on a hierarchical company structure, where CEO, Manager, and Worker have different job contexts but overall serve the same purpose of effectively refining the user prompt. Based on the user query and the layer context, the CEO layer generates a high-level instruction to the Manager layer. In a similar manner, the Manager further generates a more detailed instruction the Worker. Worker gives a refined prompt by concatenating the Manager instruction, user query, and its layer context, which is used for response generating. This structure is zero-shot, prompt-specific, and task-agnostic. On five different tasks including education, conversation, math, question answering, and coding, the generalization performance of our method compares favourably with existing methods. Our future work is to automate the workflow design to more efficiently handle different user queries.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib1.2.2.1" style="font-size:90%;">
      [1]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.4.1" style="font-size:90%;">
      Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.5.1" style="font-size:90%;">
      Chain-of-thought prompting elicits reasoning in large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib1.6.1" style="font-size:90%;">
      Advances in neural information processing systems
     </span>
     <span class="ltx_text" id="bib.bib1.7.2" style="font-size:90%;">
      , 35:24824–24837, 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib2.2.2.1" style="font-size:90%;">
      [2]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.4.1" style="font-size:90%;">
      Takeshi Kojima, Shixiang Shane Gu, Machel Reid, Yutaka Matsuo, and Yusuke Iwasawa.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.5.1" style="font-size:90%;">
      Large language models are zero-shot reasoners.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib2.6.1" style="font-size:90%;">
      Advances in neural information processing systems
     </span>
     <span class="ltx_text" id="bib.bib2.7.2" style="font-size:90%;">
      , 35:22199–22213, 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib3.2.2.1" style="font-size:90%;">
      [3]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.4.1" style="font-size:90%;">
      Maciej Besta, Nils Blach, Ales Kubicek, Robert Gerstenberger, Lukas Gianinazzi, Joanna Gajda, Tomasz Lehmann, Michal Podstawski, Hubert Niewiadomski, Piotr Nyczyk, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.5.1" style="font-size:90%;">
      Graph of thoughts: Solving elaborate problems with large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib3.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2308.09687
     </span>
     <span class="ltx_text" id="bib.bib3.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib4.2.2.1" style="font-size:90%;">
      [4]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.4.1" style="font-size:90%;">
      Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Thomas L. Griffiths, Yuan Cao, and Karthik R Narasimhan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.5.1" style="font-size:90%;">
      Tree of thoughts: Deliberate problem solving with large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib4.7.2" style="font-size:90%;">
      Thirty-seventh Conference on Neural Information Processing Systems
     </span>
     <span class="ltx_text" id="bib.bib4.8.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib5.2.2.1" style="font-size:90%;">
      [5]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.4.1" style="font-size:90%;">
      Yongchao Zhou, Andrei Ioan Muresanu, Ziwen Han, Keiran Paster, Silviu Pitis, Harris Chan, and Jimmy Ba.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.5.1" style="font-size:90%;">
      Large language models are human-level prompt engineers.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib5.7.2" style="font-size:90%;">
      The Eleventh International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib5.8.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib6.2.2.1" style="font-size:90%;">
      [6]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.4.1" style="font-size:90%;">
      Benfeng Xu, An Yang, Junyang Lin, Quan Wang, Chang Zhou, Yongdong Zhang, and Zhendong Mao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.5.1" style="font-size:90%;">
      Expertprompting: Instructing large language models to be distinguished experts.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib6.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2305.14688
     </span>
     <span class="ltx_text" id="bib.bib6.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib7.2.2.1" style="font-size:90%;">
      [7]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.4.1" style="font-size:90%;">
      Chengrun Yang, Xuezhi Wang, Yifeng Lu, Hanxiao Liu, Quoc V Le, Denny Zhou, and Xinyun Chen.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.5.1" style="font-size:90%;">
      Large language models as optimizers.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib7.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib7.8.3" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib8.2.2.1" style="font-size:90%;">
      [8]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.4.1" style="font-size:90%;">
      Albert Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou Hanna, Florian Bressand, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.5.1" style="font-size:90%;">
      Mixtral of experts.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib8.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2401.04088
     </span>
     <span class="ltx_text" id="bib.bib8.7.2" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib9.2.2.1" style="font-size:90%;">
      [9]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.4.1" style="font-size:90%;">
      Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.5.1" style="font-size:90%;">
      Language models are few-shot learners.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib9.6.1" style="font-size:90%;">
      Advances in neural information processing systems
     </span>
     <span class="ltx_text" id="bib.bib9.7.2" style="font-size:90%;">
      , 33:1877–1901, 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib10.2.2.1" style="font-size:90%;">
      [10]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.4.1" style="font-size:90%;">
      Sean Welleck, Ximing Lu, Peter West, Faeze Brahman, Tianxiao Shen, Daniel Khashabi, and Yejin Choi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.5.1" style="font-size:90%;">
      Generating sequences by learning to self-correct.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib10.7.2" style="font-size:90%;">
      The Eleventh International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib10.8.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib11.2.2.1" style="font-size:90%;">
      [11]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.4.1" style="font-size:90%;">
      Noah Shinn, Beck Labash, and Ashwin Gopinath.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.5.1" style="font-size:90%;">
      Reflexion: an autonomous agent with dynamic memory and self-reflection.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib11.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2303.11366
     </span>
     <span class="ltx_text" id="bib.bib11.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib12.2.2.1" style="font-size:90%;">
      [12]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.4.1" style="font-size:90%;">
      Zhibin Gou, Zhihong Shao, Yeyun Gong, yelong shen, Yujiu Yang, Nan Duan, and Weizhu Chen.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.5.1" style="font-size:90%;">
      CRITIC: Large language models can self-correct with tool-interactive critiquing.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib12.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib12.8.3" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib13.2.2.1" style="font-size:90%;">
      [13]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.4.1" style="font-size:90%;">
      Adrian de Wynter, Xun Wang, Qilong Gu, and Si-Qing Chen.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.5.1" style="font-size:90%;">
      On meta-prompting.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib13.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2312.06562
     </span>
     <span class="ltx_text" id="bib.bib13.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib14.2.2.1" style="font-size:90%;">
      [14]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.4.1" style="font-size:90%;">
      Yihe Deng, Weitong Zhang, Zixiang Chen, and Quanquan Gu.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.5.1" style="font-size:90%;">
      Rephrase and respond: Let large language models ask better questions for themselves.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib14.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2311.04205
     </span>
     <span class="ltx_text" id="bib.bib14.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib15.2.2.1" style="font-size:90%;">
      [15]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.4.1" style="font-size:90%;">
      Zhenhailong Wang, Shaoguang Mao, Wenshan Wu, Tao Ge, Furu Wei, and Heng Ji.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.5.1" style="font-size:90%;">
      Unleashing the emergent cognitive synergy in large language models: A task-solving agent through multi-persona self-collaboration.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib15.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2307.05300
     </span>
     <span class="ltx_text" id="bib.bib15.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib16.2.2.1" style="font-size:90%;">
      [16]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.4.1" style="font-size:90%;">
      Xinyuan Wang, Chenxi Li, Zhen Wang, Fan Bai, Haotian Luo, Jiayou Zhang, Nebojsa Jojic, Eric Xing, and Zhiting Hu.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.5.1" style="font-size:90%;">
      Promptagent: Strategic planning with language models enables expert-level prompt optimization.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib16.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib16.8.3" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib17.2.2.1" style="font-size:90%;">
      [17]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.4.1" style="font-size:90%;">
      Zhihong Shao, Yeyun Gong, Yelong Shen, Minlie Huang, Nan Duan, and Weizhu Chen.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.5.1" style="font-size:90%;">
      Synthetic prompting: Generating chain-of-thought demonstrations for large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib17.7.2" style="font-size:90%;">
      International Conference on Machine Learning
     </span>
     <span class="ltx_text" id="bib.bib17.8.3" style="font-size:90%;">
      , pages 30706–30775. PMLR, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib18.2.2.1" style="font-size:90%;">
      [18]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.4.1" style="font-size:90%;">
      Xuefei Ning, Zinan Lin, Zixuan Zhou, Zifu Wang, Huazhong Yang, and Yu Wang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.5.1" style="font-size:90%;">
      Skeleton-of-thought: Large language models can do parallel decoding.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib18.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib18.8.3" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib19.2.2.1" style="font-size:90%;">
      [19]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.4.1" style="font-size:90%;">
      Mirac Suzgun and Adam Tauman Kalai.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.5.1" style="font-size:90%;">
      Meta-prompting: Enhancing language models with task-agnostic scaffolding.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib19.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2401.12954
     </span>
     <span class="ltx_text" id="bib.bib19.7.2" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib20.2.2.1" style="font-size:90%;">
      [20]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.4.1" style="font-size:90%;">
      Brian Lester, Rami Al-Rfou, and Noah Constant.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.5.1" style="font-size:90%;">
      The power of scale for parameter-efficient prompt tuning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib20.7.2" style="font-size:90%;">
      Conference on Empirical Methods in Natural Language Processing
     </span>
     <span class="ltx_text" id="bib.bib20.8.3" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib21.2.2.1" style="font-size:90%;">
      [21]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.4.1" style="font-size:90%;">
      Xiang Lisa Li and Percy Liang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.5.1" style="font-size:90%;">
      Prefix-tuning: Optimizing continuous prompts for generation.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib21.6.1" style="font-size:90%;">
      Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)
     </span>
     <span class="ltx_text" id="bib.bib21.7.2" style="font-size:90%;">
      , abs/2101.00190, 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib22.2.2.1" style="font-size:90%;">
      [22]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.4.1" style="font-size:90%;">
      Zekun Li, Baolin Peng, Pengcheng He, Michel Galley, Jianfeng Gao, and Xifeng Yan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.5.1" style="font-size:90%;">
      Guiding large language models via directional stimulus prompting.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib22.6.1" style="font-size:90%;">
      Advances in Neural Information Processing Systems
     </span>
     <span class="ltx_text" id="bib.bib22.7.2" style="font-size:90%;">
      , 36, 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib23.2.2.1" style="font-size:90%;">
      [23]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.4.1" style="font-size:90%;">
      Hao Sun, Alihan Hüyük, and Mihaela van der Schaar.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.5.1" style="font-size:90%;">
      Query-dependent prompt evaluation and optimization with offline inverse rl.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib23.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib23.8.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib24.2.2.1" style="font-size:90%;">
      [24]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.4.1" style="font-size:90%;">
      Zongxin Yang, Guikun Chen, Xiaodi Li, Wenguan Wang, and Yi Yang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.5.1" style="font-size:90%;">
      Doraemongpt: Toward understanding dynamic scenes with large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib24.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2401.08392
     </span>
     <span class="ltx_text" id="bib.bib24.7.2" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib25.2.2.1" style="font-size:90%;">
      [25]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.4.1" style="font-size:90%;">
      Yue Wu, Yewen Fan, So Yeon Min, Shrimai Prabhumoye, Stephen McAleer, Yonatan Bisk, Ruslan Salakhutdinov, Yuanzhi Li, and Tom Mitchell.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.5.1" style="font-size:90%;">
      Agentkit: Flow engineering with graphs, not coding.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib25.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2404.11483
     </span>
     <span class="ltx_text" id="bib.bib25.7.2" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib26.2.2.1" style="font-size:90%;">
      [26]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.4.1" style="font-size:90%;">
      Sondos Mahmoud Bsharat, Aidar Myrzakhan, and Zhiqiang Shen.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.5.1" style="font-size:90%;">
      Principled instructions are all you need for questioning llama-1/2, gpt-3.5/4.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib26.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2312.16171
     </span>
     <span class="ltx_text" id="bib.bib26.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib27.2.2.1" style="font-size:90%;">
      [27]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.4.1" style="font-size:90%;">
      Shikib Mehri and Maxine Eskenazi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.5.1" style="font-size:90%;">
      Unsupervised evaluation of interactive dialog with dialogpt.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib27.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2006.12719
     </span>
     <span class="ltx_text" id="bib.bib27.7.2" style="font-size:90%;">
      , 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib28.2.2.1" style="font-size:90%;">
      [28]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.4.1" style="font-size:90%;">
      Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.5.1" style="font-size:90%;">
      Training verifiers to solve math word problems.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib28.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2110.14168
     </span>
     <span class="ltx_text" id="bib.bib28.7.2" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib29.2.2.1" style="font-size:90%;">
      [29]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.4.1" style="font-size:90%;">
      Ruchir Puri, David S Kung, Geert Janssen, Wei Zhang, Giacomo Domeniconi, Vladimir Zolotov, Julian Dolby, Jie Chen, Mihir Choudhury, Lindsey Decker, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.5.1" style="font-size:90%;">
      Codenet: A large-scale ai for code dataset for learning a diversity of coding tasks.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib29.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2105.12655
     </span>
     <span class="ltx_text" id="bib.bib29.7.2" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib30.2.2.1" style="font-size:90%;">
      [30]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.4.1" style="font-size:90%;">
      Aman Madaan, Niket Tandon, Prakhar Gupta, Skyler Hallinan, Luyu Gao, Sarah Wiegreffe, Uri Alon, Nouha Dziri, Shrimai Prabhumoye, Yiming Yang, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.5.1" style="font-size:90%;">
      Self-refine: Iterative refinement with self-feedback.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib30.6.1" style="font-size:90%;">
      Advances in Neural Information Processing Systems
     </span>
     <span class="ltx_text" id="bib.bib30.7.2" style="font-size:90%;">
      , 36, 2024.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib31.2.2.1" style="font-size:90%;">
      [31]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.4.1" style="font-size:90%;">
      Yiwei Wang, Yujun Cai, Muhao Chen, Yuxuan Liang, and Bryan Hooi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.5.1" style="font-size:90%;">
      Primacy effect of chatgpt.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib31.6.1" style="font-size:90%;">
      arXiv preprint arXiv:2310.13206
     </span>
     <span class="ltx_text" id="bib.bib31.7.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib32.2.2.1" style="font-size:90%;">
      [32]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.4.1" style="font-size:90%;">
      Chujie Zheng, Hao Zhou, Fandong Meng, Jie Zhou, and Minlie Huang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.5.1" style="font-size:90%;">
      Large language models are not robust multiple choice selectors.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.6.1" style="font-size:90%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib32.7.2" style="font-size:90%;">
      The Twelfth International Conference on Learning Representations
     </span>
     <span class="ltx_text" id="bib.bib32.8.3" style="font-size:90%;">
      , 2024.
     </span>
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Context Descriptions
  </h2>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    Context Descriptions for HMAW
   </h3>
   <div class="ltx_para" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     In Fig.
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.2 Hierarchical Multi-Agent Workflow ‣ 3 Proposed Approach ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , each layer has its own context description. In this section, we show the description details for the CEO, Manager and Worker Layer in Table
     <a class="ltx_ref" href="#A1.F6" title="Figure 6 ‣ A.1 Context Descriptions for HMAW ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , Table
     <a class="ltx_ref" href="#A1.F7" title="Figure 7 ‣ A.1 Context Descriptions for HMAW ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     and Table
     <a class="ltx_ref" href="#A1.F8" title="Figure 8 ‣ A.1 Context Descriptions for HMAW ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     , respectively.
    </p>
   </div>
   <figure class="ltx_figure" id="A1.F6">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A1.F6.1.1">
     <span class="ltx_text" id="A1.F6.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="246" id="A1.F6.1.1.1.g1" src="/html/2405.20252/assets/x6.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 6:
     </span>
     The context description for the CEO layer.
    </figcaption>
   </figure>
   <figure class="ltx_figure" id="A1.F7">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A1.F7.1.1">
     <span class="ltx_text" id="A1.F7.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="257" id="A1.F7.1.1.1.g1" src="/html/2405.20252/assets/x7.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 7:
     </span>
     The context description for the Manager layer.
    </figcaption>
   </figure>
   <figure class="ltx_figure" id="A1.F8">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A1.F8.1.1">
     <span class="ltx_text" id="A1.F8.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="A1.F8.1.1.1.g1" src="/html/2405.20252/assets/x8.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 8:
     </span>
     The context description for the Worker layer.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2
    </span>
    Context Descriptions for Evaluator
   </h3>
   <div class="ltx_para" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     As described in Section
     <a class="ltx_ref" href="#S4" title="4 Experimental Setup ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , we use GPT3.5 as the evaluator to provide preference scores for a pair of responses. The context (prompt) used to this evaluator is shown in Fig.
     <a class="ltx_ref" href="#A1.F9" title="Figure 9 ‣ A.2 Context Descriptions for Evaluator ‣ Appendix A Context Descriptions ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
    </p>
   </div>
   <figure class="ltx_figure" id="A1.F9">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A1.F9.1.1">
     <span class="ltx_text" id="A1.F9.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="130" id="A1.F9.1.1.1.g1" src="/html/2405.20252/assets/x9.png" width="461"/>
     </span>
    </p>
    <br class="ltx_break ltx_break"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 9:
     </span>
     The context description used for the evaluator.
    </figcaption>
   </figure>
  </section>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Workflow Structures
  </h2>
  <div class="ltx_para" id="A2.p1">
   <p class="ltx_p" id="A2.p1.1">
    <span class="ltx_text ltx_font_bold" id="A2.p1.1.1">
     Changing the Number of Layers.
    </span>
    In our experiments, we investigate the impact of the number of layers in our workflow. The structures for each setting are shown as follows.
   </p>
  </div>
  <div class="ltx_para" id="A2.p2">
   <ul class="ltx_itemize" id="A2.I1">
    <li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i1.p1">
      <p class="ltx_p" id="A2.I1.i1.p1.1">
       1 Layer: the same as without prompting.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i2.p1">
      <p class="ltx_p" id="A2.I1.i2.p1.1">
       2 Layers: CEO
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i2.p1.1.m1.1">
        <semantics id="A2.I1.i2.p1.1.m1.1a">
         <mo id="A2.I1.i2.p1.1.m1.1.1" stretchy="false" xref="A2.I1.i2.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.1b">
          <ci id="A2.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Worker.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i3.p1">
      <p class="ltx_p" id="A2.I1.i3.p1.2">
       3 Layers: CEO
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i3.p1.1.m1.1">
        <semantics id="A2.I1.i3.p1.1.m1.1a">
         <mo id="A2.I1.i3.p1.1.m1.1.1" stretchy="false" xref="A2.I1.i3.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i3.p1.1.m1.1b">
          <ci id="A2.I1.i3.p1.1.m1.1.1.cmml" xref="A2.I1.i3.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i3.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i3.p1.2.m2.1">
        <semantics id="A2.I1.i3.p1.2.m2.1a">
         <mo id="A2.I1.i3.p1.2.m2.1.1" stretchy="false" xref="A2.I1.i3.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i3.p1.2.m2.1b">
          <ci id="A2.I1.i3.p1.2.m2.1.1.cmml" xref="A2.I1.i3.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i3.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Worker.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i4.p1">
      <p class="ltx_p" id="A2.I1.i4.p1.3">
       4 Layers: CEO
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i4.p1.1.m1.1">
        <semantics id="A2.I1.i4.p1.1.m1.1a">
         <mo id="A2.I1.i4.p1.1.m1.1.1" stretchy="false" xref="A2.I1.i4.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.1.m1.1b">
          <ci id="A2.I1.i4.p1.1.m1.1.1.cmml" xref="A2.I1.i4.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i4.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Senior Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i4.p1.2.m2.1">
        <semantics id="A2.I1.i4.p1.2.m2.1a">
         <mo id="A2.I1.i4.p1.2.m2.1.1" stretchy="false" xref="A2.I1.i4.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.2.m2.1b">
          <ci id="A2.I1.i4.p1.2.m2.1.1.cmml" xref="A2.I1.i4.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i4.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i4.p1.3.m3.1">
        <semantics id="A2.I1.i4.p1.3.m3.1a">
         <mo id="A2.I1.i4.p1.3.m3.1.1" stretchy="false" xref="A2.I1.i4.p1.3.m3.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.3.m3.1b">
          <ci id="A2.I1.i4.p1.3.m3.1.1.cmml" xref="A2.I1.i4.p1.3.m3.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i4.p1.3.m3.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Worker.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I1.i5" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i5.p1">
      <p class="ltx_p" id="A2.I1.i5.p1.4">
       5 Layers: CEO
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i5.p1.1.m1.1">
        <semantics id="A2.I1.i5.p1.1.m1.1a">
         <mo id="A2.I1.i5.p1.1.m1.1.1" stretchy="false" xref="A2.I1.i5.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.1.m1.1b">
          <ci id="A2.I1.i5.p1.1.m1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i5.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Senior Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i5.p1.2.m2.1">
        <semantics id="A2.I1.i5.p1.2.m2.1a">
         <mo id="A2.I1.i5.p1.2.m2.1.1" stretchy="false" xref="A2.I1.i5.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.2.m2.1b">
          <ci id="A2.I1.i5.p1.2.m2.1.1.cmml" xref="A2.I1.i5.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i5.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i5.p1.3.m3.1">
        <semantics id="A2.I1.i5.p1.3.m3.1a">
         <mo id="A2.I1.i5.p1.3.m3.1.1" stretchy="false" xref="A2.I1.i5.p1.3.m3.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.3.m3.1b">
          <ci id="A2.I1.i5.p1.3.m3.1.1.cmml" xref="A2.I1.i5.p1.3.m3.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i5.p1.3.m3.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Supervisor
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i5.p1.4.m4.1">
        <semantics id="A2.I1.i5.p1.4.m4.1a">
         <mo id="A2.I1.i5.p1.4.m4.1.1" stretchy="false" xref="A2.I1.i5.p1.4.m4.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.4.m4.1b">
          <ci id="A2.I1.i5.p1.4.m4.1.1.cmml" xref="A2.I1.i5.p1.4.m4.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i5.p1.4.m4.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Worker.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I1.i6" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I1.i6.p1">
      <p class="ltx_p" id="A2.I1.i6.p1.5">
       6 Layers: CEO
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i6.p1.1.m1.1">
        <semantics id="A2.I1.i6.p1.1.m1.1a">
         <mo id="A2.I1.i6.p1.1.m1.1.1" stretchy="false" xref="A2.I1.i6.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.1.m1.1b">
          <ci id="A2.I1.i6.p1.1.m1.1.1.cmml" xref="A2.I1.i6.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i6.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Senior Vice President
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i6.p1.2.m2.1">
        <semantics id="A2.I1.i6.p1.2.m2.1a">
         <mo id="A2.I1.i6.p1.2.m2.1.1" stretchy="false" xref="A2.I1.i6.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.2.m2.1b">
          <ci id="A2.I1.i6.p1.2.m2.1.1.cmml" xref="A2.I1.i6.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i6.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Vice President
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i6.p1.3.m3.1">
        <semantics id="A2.I1.i6.p1.3.m3.1a">
         <mo id="A2.I1.i6.p1.3.m3.1.1" stretchy="false" xref="A2.I1.i6.p1.3.m3.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.3.m3.1b">
          <ci id="A2.I1.i6.p1.3.m3.1.1.cmml" xref="A2.I1.i6.p1.3.m3.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i6.p1.3.m3.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Director
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i6.p1.4.m4.1">
        <semantics id="A2.I1.i6.p1.4.m4.1a">
         <mo id="A2.I1.i6.p1.4.m4.1.1" stretchy="false" xref="A2.I1.i6.p1.4.m4.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.4.m4.1b">
          <ci id="A2.I1.i6.p1.4.m4.1.1.cmml" xref="A2.I1.i6.p1.4.m4.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i6.p1.4.m4.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Manager
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I1.i6.p1.5.m5.1">
        <semantics id="A2.I1.i6.p1.5.m5.1a">
         <mo id="A2.I1.i6.p1.5.m5.1.1" stretchy="false" xref="A2.I1.i6.p1.5.m5.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.5.m5.1b">
          <ci id="A2.I1.i6.p1.5.m5.1.1.cmml" xref="A2.I1.i6.p1.5.m5.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I1.i6.p1.5.m5.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Worker.
      </p>
     </div>
    </li>
   </ul>
  </div>
  <div class="ltx_para" id="A2.p3">
   <p class="ltx_p" id="A2.p3.1">
    <span class="ltx_text ltx_font_bold" id="A2.p3.1.1">
     Changing the Workflow Context.
    </span>
    We also show the results of using various workflow contexts, such as Government, University, and Temple, in the main paper. The following are the structures for each kind of context.
   </p>
  </div>
  <div class="ltx_para" id="A2.p4">
   <ul class="ltx_itemize" id="A2.I2">
    <li class="ltx_item" id="A2.I2.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I2.i1.p1">
      <p class="ltx_p" id="A2.I2.i1.p1.2">
       Government: President
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i1.p1.1.m1.1">
        <semantics id="A2.I2.i1.p1.1.m1.1a">
         <mo id="A2.I2.i1.p1.1.m1.1.1" stretchy="false" xref="A2.I2.i1.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.1.m1.1b">
          <ci id="A2.I2.i1.p1.1.m1.1.1.cmml" xref="A2.I2.i1.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i1.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Minister
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i1.p1.2.m2.1">
        <semantics id="A2.I2.i1.p1.2.m2.1a">
         <mo id="A2.I2.i1.p1.2.m2.1.1" stretchy="false" xref="A2.I2.i1.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.2.m2.1b">
          <ci id="A2.I2.i1.p1.2.m2.1.1.cmml" xref="A2.I2.i1.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i1.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Officer.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I2.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I2.i2.p1">
      <p class="ltx_p" id="A2.I2.i2.p1.2">
       University: Dean
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i2.p1.1.m1.1">
        <semantics id="A2.I2.i2.p1.1.m1.1a">
         <mo id="A2.I2.i2.p1.1.m1.1.1" stretchy="false" xref="A2.I2.i2.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.1.m1.1b">
          <ci id="A2.I2.i2.p1.1.m1.1.1.cmml" xref="A2.I2.i2.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i2.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Department Head
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i2.p1.2.m2.1">
        <semantics id="A2.I2.i2.p1.2.m2.1a">
         <mo id="A2.I2.i2.p1.2.m2.1.1" stretchy="false" xref="A2.I2.i2.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.2.m2.1b">
          <ci id="A2.I2.i2.p1.2.m2.1.1.cmml" xref="A2.I2.i2.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i2.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Lecturer.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A2.I2.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A2.I2.i3.p1">
      <p class="ltx_p" id="A2.I2.i3.p1.2">
       Temple: Abbot
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i3.p1.1.m1.1">
        <semantics id="A2.I2.i3.p1.1.m1.1a">
         <mo id="A2.I2.i3.p1.1.m1.1.1" stretchy="false" xref="A2.I2.i3.p1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i3.p1.1.m1.1b">
          <ci id="A2.I2.i3.p1.1.m1.1.1.cmml" xref="A2.I2.i3.p1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i3.p1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Prior
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.I2.i3.p1.2.m2.1">
        <semantics id="A2.I2.i3.p1.2.m2.1a">
         <mo id="A2.I2.i3.p1.2.m2.1.1" stretchy="false" xref="A2.I2.i3.p1.2.m2.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A2.I2.i3.p1.2.m2.1b">
          <ci id="A2.I2.i3.p1.2.m2.1.1.cmml" xref="A2.I2.i3.p1.2.m2.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.I2.i3.p1.2.m2.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Monk.
      </p>
     </div>
    </li>
   </ul>
  </div>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   More Case Studies
  </h2>
  <div class="ltx_para" id="A3.p1">
   <p class="ltx_p" id="A3.p1.1">
    In this section, we show more case studies of our method for the datasets of CodeNet, GSM8K, ATLAS, and FED in Fig.
    <a class="ltx_ref" href="#A3.F10" title="Figure 10 ‣ Appendix C More Case Studies ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      10
     </span>
    </a>
    , Fig.
    <a class="ltx_ref" href="#A3.F11" title="Figure 11 ‣ Appendix C More Case Studies ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      11
     </span>
    </a>
    , Fig.
    <a class="ltx_ref" href="#A3.F12" title="Figure 12 ‣ Appendix C More Case Studies ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      12
     </span>
    </a>
    , and Fig.
    <a class="ltx_ref" href="#A3.F13" title="Figure 13 ‣ Appendix C More Case Studies ‣ Towards Hierarchical Multi-Agent Workflows for Zero-Shot Prompt Optimization">
     <span class="ltx_text ltx_ref_tag">
      13
     </span>
    </a>
    , respectively.
   </p>
  </div>
  <figure class="ltx_figure" id="A3.F10">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A3.F10.1.1">
    <span class="ltx_text" id="A3.F10.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="298" id="A3.F10.1.1.1.g1" src="/html/2405.20252/assets/x10.png" width="461"/>
    </span>
   </p>
   <br class="ltx_break ltx_break"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 10:
    </span>
    A case study of HMAW on the CodeNet Dataset.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F11">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A3.F11.1.1">
    <span class="ltx_text" id="A3.F11.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="238" id="A3.F11.1.1.1.g1" src="/html/2405.20252/assets/x11.png" width="461"/>
    </span>
   </p>
   <br class="ltx_break ltx_break"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 11:
    </span>
    A case study of HMAW on the GSM8K Dataset. Colored texts indicate content coherence.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F12">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A3.F12.1.1">
    <span class="ltx_text" id="A3.F12.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="468" id="A3.F12.1.1.1.g1" src="/html/2405.20252/assets/x12.png" width="461"/>
    </span>
   </p>
   <br class="ltx_break ltx_break"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 12:
    </span>
    A case study of HMAW on the ATLAS Dataset. Colored texts indicate content coherence.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A3.F13">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A3.F13.1.1">
    <span class="ltx_text" id="A3.F13.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="237" id="A3.F13.1.1.1.g1" src="/html/2405.20252/assets/x13.png" width="461"/>
    </span>
   </p>
   <br class="ltx_break ltx_break"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 13:
    </span>
    A case study of HMAW on the FED Dataset. Colored texts indicate content coherence.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="Ax1">
  <h2 class="ltx_title ltx_title_appendix">
   Limitation
  </h2>
  <div class="ltx_para" id="Ax1.p1">
   <p class="ltx_p" id="Ax1.p1.1">
    Our method is limited in deployment environments where computational resources are extremely constrained because it requires more than one time of inference for the LLM.
   </p>
  </div>
 </section>
 <section class="ltx_appendix" id="Ax2">
  <h2 class="ltx_title ltx_title_appendix">
   Impact statement
  </h2>
  <div class="ltx_para" id="Ax2.p1">
   <p class="ltx_p" id="Ax2.p1.1">
    This paper presents work aimed at advancing the field of multi-agent cooperation. There are many potential societal consequences of our work, such as improved human-computer interaction.
   </p>
  </div>
 </section>
</article>
