<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders</title>
<!--Generated on Wed Aug 14 15:19:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="sequential recommendation; cross-entropy loss; negative sampling" lang="en" name="keywords"/>
<base href="/html/2408.02354v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S1" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S2" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S3" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Reduced Cross-Entropy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px1" title="In 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px2" title="In 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title">Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px3" title="In 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title">Model and Baselines</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S6" title="In RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Danil Gusak
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0008-1238-6533" title="ORCID identifier">0009-0008-1238-6533</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id2.1.id1">Skolkovo Institute of Science and Technology</span><span class="ltx_text ltx_affiliation_country" id="id3.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.3.id1">HSE University</span><span class="ltx_text ltx_affiliation_city" id="id5.4.id2">Moscow</span><span class="ltx_text ltx_affiliation_country" id="id6.5.id3">Russian Federation</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:danil.gusak@skoltech.ru">danil.gusak@skoltech.ru</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gleb Mezentsev
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0003-7591-3082" title="ORCID identifier">0009-0003-7591-3082</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Skolkovo Institute of Science and Technology</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Moscow</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">Russian Federation</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:gleb.mezentsev@skoltech.ru">gleb.mezentsev@skoltech.ru</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ivan Oseledets
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0003-2071-2163" title="ORCID identifier">0000-0003-2071-2163</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Artificial Intelligence Research Institute</span><span class="ltx_text ltx_affiliation_country" id="id11.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.3.id1">Skolkovo Institute of Science and Technology</span><span class="ltx_text ltx_affiliation_city" id="id13.4.id2">Moscow</span><span class="ltx_text ltx_affiliation_country" id="id14.5.id3">Russian Federation</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:oseledets@airi.net">oseledets@airi.net</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Evgeny Frolov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0003-3679-5311" title="ORCID identifier">0000-0003-3679-5311</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">Artificial Intelligence Research Institute</span><span class="ltx_text ltx_affiliation_country" id="id16.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.3.id1">Skolkovo Institute of Science and Technology</span><span class="ltx_text ltx_affiliation_country" id="id18.4.id2"></span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.5.id1">HSE University</span><span class="ltx_text ltx_affiliation_city" id="id20.6.id2">Moscow</span><span class="ltx_text ltx_affiliation_country" id="id21.7.id3">Russian Federation</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:frolov@airi.net">frolov@airi.net</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id22.id1">Scalability is a major challenge in modern recommender systems. In sequential recommendations, full Cross-Entropy (CE) loss achieves state-of-the-art recommendation quality but consumes excessive GPU memory with large item catalogs, limiting its practicality.</p>
<p class="ltx_p" id="id1.1">Using a GPU-efficient locality-sensitive hashing-like algorithm for approximating large tensor of logits, this paper introduces a novel RECE (<span class="ltx_text ltx_font_bold" id="id1.1.1">RE</span>duced <span class="ltx_text ltx_font_bold" id="id1.1.2">C</span>ross-<span class="ltx_text ltx_font_bold" id="id1.1.3">E</span>ntropy) loss. RECE significantly reduces memory consumption while allowing one to enjoy the state-of-the-art performance of full CE loss. Experimental results on various datasets show that RECE cuts training peak memory usage by up to <math alttext="12" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn id="id1.1.m1.1.1.cmml" type="integer" xref="id1.1.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">12</annotation></semantics></math> times compared to existing methods while retaining or exceeding performance metrics of CE loss.
The approach also opens up new possibilities for large-scale applications in other domains.</p>
</div>
<div class="ltx_keywords">sequential recommendation; cross-entropy loss; negative sampling
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679986</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>33rd ACM International Conference on
Information and Knowledge Management; October 21–25,
2024; Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<figure class="ltx_figure ltx_teaserfigure" id="S0.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="169" id="S0.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S0.F1.3.2" style="font-size:90%;">Simplified example illustrating the bucketing, sorting, chunking, and scalar product calculation steps of the proposed RECE approach. Different colors correspond to belonging to different buckets.</span></figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="256" id="S1.F2.g1" src="x2.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S1.F2.3.2" style="font-size:90%;">Impact of different components on peak GPU memory usage during SASRec training with Cross-Entropy loss. Measurements were conducted using PyTorch profiling tools.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S1.F2.4">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S1.F2.5">[]</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In collaborative filtering, recent state-of-the-art models increasingly adopt sequential approaches to predict the next item a user might choose based on past activity. By considering the sequence of interactions, such systems make timely and relevant recommendations, like suggesting phone accessories following a phone purchase.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Transformer architectures <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib38" title="">2017</a>)</cite>, originally from natural language processing (NLP), have been successfully adapted for <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">next item prediction task</em> in recommender systems. Notable models include SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>)</cite> and BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib35" title="">2019</a>)</cite>, inspired by GPT <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib30" title="">2018</a>)</cite> and BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib10" title="">2018</a>)</cite> architectures. Initially, SASRec employed Binary Cross-Entropy (BCE) loss for training, but subsequent research showed that full Cross-Entropy (CE) loss (<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S3.E3" title="In 3. Reduced Cross-Entropy ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">3</span></a>) enables SOTA performance <cite class="ltx_cite ltx_citemacro_citep">(Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>; Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>, highlighting CE effectiveness.
CE loss, however, is memory-intensive due to the need to compute and store a large tensor of logits, making CE less scalable for larger item catalogs (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">2</span></a>). The challenge is <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">to develop a reduced replacement for CE loss that maintains accuracy while operating within memory constraints similar to those of BCE</em>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We propose a novel RECE (<span class="ltx_text ltx_font_bold" id="S1.p3.1.1">RE</span>duced <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">C</span>ross-<span class="ltx_text ltx_font_bold" id="S1.p3.1.3">E</span>ntropy) loss, <em class="ltx_emph ltx_font_italic" id="S1.p3.1.4">which uses a selective computation strategy</em> to prioritize the most informative elements from input sequences and item catalog - those most likely to cause misclassifications. By approximating the softmax distribution over these elements, pre-identified using a GPU-friendly approximate search for maximum inner products, RECE <em class="ltx_emph ltx_font_italic" id="S1.p3.1.5">eliminates the need to compute and store the full logit tensor</em> while mitigating inefficiencies of less selective negative sampling. We evaluate RECE integrated into SASRec on four datasets. This approach can also benefit other domains like NLP and search systems.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To summarize, the main contributions of this paper are:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose RECE – a memory-efficient approximation of CE loss, potentially applicable beyond sequential recommenders;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We use RECE to train SASRec, conduct an extensive evaluation, and show that RECE significantly reduces the peak training memory without compromising the model performance.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Since the introduction of the Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib38" title="">2017</a>)</cite>, Transformer -based models have outperformed other approaches in sequential recommendations <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib35" title="">2019</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib42" title="">2022</a>; Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib12" title="">2022</a>)</cite>. SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>)</cite> shows state-of-the-art performance with CE loss <cite class="ltx_cite ltx_citemacro_citep">(Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>)</cite>. However, large item catalogs in real-world applications require negative sampling methods or CE approximations to train such models.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.3">Uniform random sampling of negatives is a straightforward method
<cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib36" title="">2018</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>)</cite>. It can be improved by increasing the number of negative samples, modifying BCE (<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S2.E1" title="In 2. Related Work ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">1</span></a>) or CE (<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S2.E2" title="In 2. Related Work ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">2</span></a>) <cite class="ltx_cite ltx_citemacro_citep">(Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>)</cite> loss functions:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{BCE^{+}}=-\log(\sigma(logit_{i,+}))-\sum_{j\in I_{n}^{-}}\log(1-%
\sigma(logit_{i,j}))," class="ltx_Math" display="block" id="S2.E1.m1.7"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7.1" xref="S2.E1.m1.7.7.1.1.cmml"><mrow id="S2.E1.m1.7.7.1.1" xref="S2.E1.m1.7.7.1.1.cmml"><msub id="S2.E1.m1.7.7.1.1.4" xref="S2.E1.m1.7.7.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.1.1.4.2" xref="S2.E1.m1.7.7.1.1.4.2.cmml">ℒ</mi><mrow id="S2.E1.m1.7.7.1.1.4.3" xref="S2.E1.m1.7.7.1.1.4.3.cmml"><mi id="S2.E1.m1.7.7.1.1.4.3.2" xref="S2.E1.m1.7.7.1.1.4.3.2.cmml">B</mi><mo id="S2.E1.m1.7.7.1.1.4.3.1" xref="S2.E1.m1.7.7.1.1.4.3.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.4.3.3" xref="S2.E1.m1.7.7.1.1.4.3.3.cmml">C</mi><mo id="S2.E1.m1.7.7.1.1.4.3.1a" xref="S2.E1.m1.7.7.1.1.4.3.1.cmml">⁢</mo><msup id="S2.E1.m1.7.7.1.1.4.3.4" xref="S2.E1.m1.7.7.1.1.4.3.4.cmml"><mi id="S2.E1.m1.7.7.1.1.4.3.4.2" xref="S2.E1.m1.7.7.1.1.4.3.4.2.cmml">E</mi><mo id="S2.E1.m1.7.7.1.1.4.3.4.3" xref="S2.E1.m1.7.7.1.1.4.3.4.3.cmml">+</mo></msup></mrow></msub><mo id="S2.E1.m1.7.7.1.1.3" xref="S2.E1.m1.7.7.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.7.7.1.1.2" xref="S2.E1.m1.7.7.1.1.2.cmml"><mrow id="S2.E1.m1.7.7.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.cmml"><mo id="S2.E1.m1.7.7.1.1.1.1a" rspace="0.167em" xref="S2.E1.m1.7.7.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">log</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1a" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.4.cmml">g</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1b" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.5" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1c" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.2.cmml">t</mi><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">i</mi><mo id="S2.E1.m1.2.2.2.4.1" rspace="0em" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><mo id="S2.E1.m1.2.2.2.2" lspace="0em" xref="S2.E1.m1.2.2.2.2.cmml">+</mo></mrow></msub></mrow><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.7.7.1.1.2.3" rspace="0.055em" xref="S2.E1.m1.7.7.1.1.2.3.cmml">−</mo><mrow id="S2.E1.m1.7.7.1.1.2.2" xref="S2.E1.m1.7.7.1.1.2.2.cmml"><munder id="S2.E1.m1.7.7.1.1.2.2.2" xref="S2.E1.m1.7.7.1.1.2.2.2.cmml"><mo id="S2.E1.m1.7.7.1.1.2.2.2.2" movablelimits="false" xref="S2.E1.m1.7.7.1.1.2.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.2.3" xref="S2.E1.m1.7.7.1.1.2.2.2.3.cmml"><mi id="S2.E1.m1.7.7.1.1.2.2.2.3.2" xref="S2.E1.m1.7.7.1.1.2.2.2.3.2.cmml">j</mi><mo id="S2.E1.m1.7.7.1.1.2.2.2.3.1" xref="S2.E1.m1.7.7.1.1.2.2.2.3.1.cmml">∈</mo><msubsup id="S2.E1.m1.7.7.1.1.2.2.2.3.3" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.cmml"><mi id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.2" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.2.cmml">I</mi><mi id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.3" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.3.cmml">n</mi><mo id="S2.E1.m1.7.7.1.1.2.2.2.3.3.3" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.3.cmml">−</mo></msubsup></mrow></munder><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.2.cmml"><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">log</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1a" xref="S2.E1.m1.7.7.1.1.2.2.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.2.cmml"><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.2.2.1.2.cmml">(</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.cmml"><mn id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.3.cmml">1</mn><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.2.cmml">−</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1a" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.4.cmml">g</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1b" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.5" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1c" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.cmml"><mi id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.2" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.2.cmml">t</mi><mrow id="S2.E1.m1.4.4.2.4" xref="S2.E1.m1.4.4.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">i</mi><mo id="S2.E1.m1.4.4.2.4.1" xref="S2.E1.m1.4.4.2.3.cmml">,</mo><mi id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.7.7.1.1.2.2.1.1.1.3" stretchy="false" xref="S2.E1.m1.7.7.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.7.7.1.2" xref="S2.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.1.1.cmml" xref="S2.E1.m1.7.7.1"><eq id="S2.E1.m1.7.7.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.3"></eq><apply id="S2.E1.m1.7.7.1.1.4.cmml" xref="S2.E1.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.4.1.cmml" xref="S2.E1.m1.7.7.1.1.4">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.4.2.cmml" xref="S2.E1.m1.7.7.1.1.4.2">ℒ</ci><apply id="S2.E1.m1.7.7.1.1.4.3.cmml" xref="S2.E1.m1.7.7.1.1.4.3"><times id="S2.E1.m1.7.7.1.1.4.3.1.cmml" xref="S2.E1.m1.7.7.1.1.4.3.1"></times><ci id="S2.E1.m1.7.7.1.1.4.3.2.cmml" xref="S2.E1.m1.7.7.1.1.4.3.2">𝐵</ci><ci id="S2.E1.m1.7.7.1.1.4.3.3.cmml" xref="S2.E1.m1.7.7.1.1.4.3.3">𝐶</ci><apply id="S2.E1.m1.7.7.1.1.4.3.4.cmml" xref="S2.E1.m1.7.7.1.1.4.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.4.3.4.1.cmml" xref="S2.E1.m1.7.7.1.1.4.3.4">superscript</csymbol><ci id="S2.E1.m1.7.7.1.1.4.3.4.2.cmml" xref="S2.E1.m1.7.7.1.1.4.3.4.2">𝐸</ci><plus id="S2.E1.m1.7.7.1.1.4.3.4.3.cmml" xref="S2.E1.m1.7.7.1.1.4.3.4.3"></plus></apply></apply></apply><apply id="S2.E1.m1.7.7.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2"><minus id="S2.E1.m1.7.7.1.1.2.3.cmml" xref="S2.E1.m1.7.7.1.1.2.3"></minus><apply id="S2.E1.m1.7.7.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1"><minus id="S2.E1.m1.7.7.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1"></minus><apply id="S2.E1.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1"><log id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5"></log><apply id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.4">𝑔</ci><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.5">𝑖</ci><apply id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.6.2">𝑡</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑖</ci><plus id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></plus></list></apply></apply></apply></apply></apply><apply id="S2.E1.m1.7.7.1.1.2.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2"><apply id="S2.E1.m1.7.7.1.1.2.2.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.2.2.2.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2">subscript</csymbol><sum id="S2.E1.m1.7.7.1.1.2.2.2.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.2"></sum><apply id="S2.E1.m1.7.7.1.1.2.2.2.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3"><in id="S2.E1.m1.7.7.1.1.2.2.2.3.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.1"></in><ci id="S2.E1.m1.7.7.1.1.2.2.2.3.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.2">𝑗</ci><apply id="S2.E1.m1.7.7.1.1.2.2.2.3.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.2.2.2.3.3.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3">superscript</csymbol><apply id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.2">𝐼</ci><ci id="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.2.3">𝑛</ci></apply><minus id="S2.E1.m1.7.7.1.1.2.2.2.3.3.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.2.3.3.3"></minus></apply></apply></apply><apply id="S2.E1.m1.7.7.1.1.2.2.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1"><log id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"></log><apply id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1"><minus id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.2"></minus><cn id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.3">1</cn><apply id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.2"></times><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.3">𝜎</ci><apply id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.4">𝑔</ci><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.5">𝑖</ci><apply id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.1.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.2.cmml" xref="S2.E1.m1.7.7.1.1.2.2.1.1.1.1.1.1.1.1.6.2">𝑡</ci><list id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.4"><ci id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1">𝑖</ci><ci id="S2.E1.m1.4.4.2.2.cmml" xref="S2.E1.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">\mathcal{L}_{BCE^{+}}=-\log(\sigma(logit_{i,+}))-\sum_{j\in I_{n}^{-}}\log(1-%
\sigma(logit_{i,j})),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.7d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = - roman_log ( italic_σ ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , + end_POSTSUBSCRIPT ) ) - ∑ start_POSTSUBSCRIPT italic_j ∈ italic_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_log ( 1 - italic_σ ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{CE^{-}}=-\log\frac{\exp(logit_{i,+})}{\exp(logit_{i,+})+\sum_{j%
\in I_{n}^{-}}\exp(logit_{i,j})}," class="ltx_Math" display="block" id="S2.E2.m1.13"><semantics id="S2.E2.m1.13a"><mrow id="S2.E2.m1.13.13.1" xref="S2.E2.m1.13.13.1.1.cmml"><mrow id="S2.E2.m1.13.13.1.1" xref="S2.E2.m1.13.13.1.1.cmml"><msub id="S2.E2.m1.13.13.1.1.2" xref="S2.E2.m1.13.13.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.13.13.1.1.2.2" xref="S2.E2.m1.13.13.1.1.2.2.cmml">ℒ</mi><mrow id="S2.E2.m1.13.13.1.1.2.3" xref="S2.E2.m1.13.13.1.1.2.3.cmml"><mi id="S2.E2.m1.13.13.1.1.2.3.2" xref="S2.E2.m1.13.13.1.1.2.3.2.cmml">C</mi><mo id="S2.E2.m1.13.13.1.1.2.3.1" xref="S2.E2.m1.13.13.1.1.2.3.1.cmml">⁢</mo><msup id="S2.E2.m1.13.13.1.1.2.3.3" xref="S2.E2.m1.13.13.1.1.2.3.3.cmml"><mi id="S2.E2.m1.13.13.1.1.2.3.3.2" xref="S2.E2.m1.13.13.1.1.2.3.3.2.cmml">E</mi><mo id="S2.E2.m1.13.13.1.1.2.3.3.3" xref="S2.E2.m1.13.13.1.1.2.3.3.3.cmml">−</mo></msup></mrow></msub><mo id="S2.E2.m1.13.13.1.1.1" xref="S2.E2.m1.13.13.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.13.13.1.1.3" xref="S2.E2.m1.13.13.1.1.3.cmml"><mo id="S2.E2.m1.13.13.1.1.3a" rspace="0.167em" xref="S2.E2.m1.13.13.1.1.3.cmml">−</mo><mrow id="S2.E2.m1.13.13.1.1.3.2" xref="S2.E2.m1.13.13.1.1.3.2.cmml"><mi id="S2.E2.m1.13.13.1.1.3.2.1" xref="S2.E2.m1.13.13.1.1.3.2.1.cmml">log</mi><mo id="S2.E2.m1.13.13.1.1.3.2a" lspace="0.167em" xref="S2.E2.m1.13.13.1.1.3.2.cmml">⁡</mo><mfrac id="S2.E2.m1.12.12" xref="S2.E2.m1.12.12.cmml"><mrow id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.5.cmml"><mi id="S2.E2.m1.3.3.3.3" xref="S2.E2.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E2.m1.4.4.4.4a" xref="S2.E2.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E2.m1.4.4.4.4.1" xref="S2.E2.m1.4.4.4.5.cmml"><mo id="S2.E2.m1.4.4.4.4.1.2" stretchy="false" xref="S2.E2.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E2.m1.4.4.4.4.1.1" xref="S2.E2.m1.4.4.4.4.1.1.cmml"><mi id="S2.E2.m1.4.4.4.4.1.1.2" xref="S2.E2.m1.4.4.4.4.1.1.2.cmml">l</mi><mo id="S2.E2.m1.4.4.4.4.1.1.1" xref="S2.E2.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.4.4.4.4.1.1.3" xref="S2.E2.m1.4.4.4.4.1.1.3.cmml">o</mi><mo id="S2.E2.m1.4.4.4.4.1.1.1a" xref="S2.E2.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.4.4.4.4.1.1.4" xref="S2.E2.m1.4.4.4.4.1.1.4.cmml">g</mi><mo id="S2.E2.m1.4.4.4.4.1.1.1b" xref="S2.E2.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.4.4.4.4.1.1.5" xref="S2.E2.m1.4.4.4.4.1.1.5.cmml">i</mi><mo id="S2.E2.m1.4.4.4.4.1.1.1c" xref="S2.E2.m1.4.4.4.4.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.4.4.4.4.1.1.6" xref="S2.E2.m1.4.4.4.4.1.1.6.cmml"><mi id="S2.E2.m1.4.4.4.4.1.1.6.2" xref="S2.E2.m1.4.4.4.4.1.1.6.2.cmml">t</mi><mrow id="S2.E2.m1.2.2.2.2.2.4" xref="S2.E2.m1.2.2.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.2.2.2.2.2.4.1" rspace="0em" xref="S2.E2.m1.2.2.2.2.2.3.cmml">,</mo><mo id="S2.E2.m1.2.2.2.2.2.2" lspace="0em" xref="S2.E2.m1.2.2.2.2.2.2.cmml">+</mo></mrow></msub></mrow><mo id="S2.E2.m1.4.4.4.4.1.3" stretchy="false" xref="S2.E2.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E2.m1.12.12.12" xref="S2.E2.m1.12.12.12.cmml"><mrow id="S2.E2.m1.11.11.11.7.1" xref="S2.E2.m1.11.11.11.7.2.cmml"><mi id="S2.E2.m1.9.9.9.5" xref="S2.E2.m1.9.9.9.5.cmml">exp</mi><mo id="S2.E2.m1.11.11.11.7.1a" xref="S2.E2.m1.11.11.11.7.2.cmml">⁡</mo><mrow id="S2.E2.m1.11.11.11.7.1.1" xref="S2.E2.m1.11.11.11.7.2.cmml"><mo id="S2.E2.m1.11.11.11.7.1.1.2" stretchy="false" xref="S2.E2.m1.11.11.11.7.2.cmml">(</mo><mrow id="S2.E2.m1.11.11.11.7.1.1.1" xref="S2.E2.m1.11.11.11.7.1.1.1.cmml"><mi id="S2.E2.m1.11.11.11.7.1.1.1.2" xref="S2.E2.m1.11.11.11.7.1.1.1.2.cmml">l</mi><mo id="S2.E2.m1.11.11.11.7.1.1.1.1" xref="S2.E2.m1.11.11.11.7.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.11.11.11.7.1.1.1.3" xref="S2.E2.m1.11.11.11.7.1.1.1.3.cmml">o</mi><mo id="S2.E2.m1.11.11.11.7.1.1.1.1a" xref="S2.E2.m1.11.11.11.7.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.11.11.11.7.1.1.1.4" xref="S2.E2.m1.11.11.11.7.1.1.1.4.cmml">g</mi><mo id="S2.E2.m1.11.11.11.7.1.1.1.1b" xref="S2.E2.m1.11.11.11.7.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.11.11.11.7.1.1.1.5" xref="S2.E2.m1.11.11.11.7.1.1.1.5.cmml">i</mi><mo id="S2.E2.m1.11.11.11.7.1.1.1.1c" xref="S2.E2.m1.11.11.11.7.1.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.11.11.11.7.1.1.1.6" xref="S2.E2.m1.11.11.11.7.1.1.1.6.cmml"><mi id="S2.E2.m1.11.11.11.7.1.1.1.6.2" xref="S2.E2.m1.11.11.11.7.1.1.1.6.2.cmml">t</mi><mrow id="S2.E2.m1.6.6.6.2.2.4" xref="S2.E2.m1.6.6.6.2.2.3.cmml"><mi id="S2.E2.m1.5.5.5.1.1.1" xref="S2.E2.m1.5.5.5.1.1.1.cmml">i</mi><mo id="S2.E2.m1.6.6.6.2.2.4.1" rspace="0em" xref="S2.E2.m1.6.6.6.2.2.3.cmml">,</mo><mo id="S2.E2.m1.6.6.6.2.2.2" lspace="0em" xref="S2.E2.m1.6.6.6.2.2.2.cmml">+</mo></mrow></msub></mrow><mo id="S2.E2.m1.11.11.11.7.1.1.3" stretchy="false" xref="S2.E2.m1.11.11.11.7.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.12.12.12.9" rspace="0.055em" xref="S2.E2.m1.12.12.12.9.cmml">+</mo><mrow id="S2.E2.m1.12.12.12.8" xref="S2.E2.m1.12.12.12.8.cmml"><msub id="S2.E2.m1.12.12.12.8.2" xref="S2.E2.m1.12.12.12.8.2.cmml"><mo id="S2.E2.m1.12.12.12.8.2.2" xref="S2.E2.m1.12.12.12.8.2.2.cmml">∑</mo><mrow id="S2.E2.m1.12.12.12.8.2.3" xref="S2.E2.m1.12.12.12.8.2.3.cmml"><mi id="S2.E2.m1.12.12.12.8.2.3.2" xref="S2.E2.m1.12.12.12.8.2.3.2.cmml">j</mi><mo id="S2.E2.m1.12.12.12.8.2.3.1" xref="S2.E2.m1.12.12.12.8.2.3.1.cmml">∈</mo><msubsup id="S2.E2.m1.12.12.12.8.2.3.3" xref="S2.E2.m1.12.12.12.8.2.3.3.cmml"><mi id="S2.E2.m1.12.12.12.8.2.3.3.2.2" xref="S2.E2.m1.12.12.12.8.2.3.3.2.2.cmml">I</mi><mi id="S2.E2.m1.12.12.12.8.2.3.3.2.3" xref="S2.E2.m1.12.12.12.8.2.3.3.2.3.cmml">n</mi><mo id="S2.E2.m1.12.12.12.8.2.3.3.3" xref="S2.E2.m1.12.12.12.8.2.3.3.3.cmml">−</mo></msubsup></mrow></msub><mrow id="S2.E2.m1.12.12.12.8.1.1" xref="S2.E2.m1.12.12.12.8.1.2.cmml"><mi id="S2.E2.m1.10.10.10.6" xref="S2.E2.m1.10.10.10.6.cmml">exp</mi><mo id="S2.E2.m1.12.12.12.8.1.1a" xref="S2.E2.m1.12.12.12.8.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.12.12.12.8.1.1.1" xref="S2.E2.m1.12.12.12.8.1.2.cmml"><mo id="S2.E2.m1.12.12.12.8.1.1.1.2" stretchy="false" xref="S2.E2.m1.12.12.12.8.1.2.cmml">(</mo><mrow id="S2.E2.m1.12.12.12.8.1.1.1.1" xref="S2.E2.m1.12.12.12.8.1.1.1.1.cmml"><mi id="S2.E2.m1.12.12.12.8.1.1.1.1.2" xref="S2.E2.m1.12.12.12.8.1.1.1.1.2.cmml">l</mi><mo id="S2.E2.m1.12.12.12.8.1.1.1.1.1" xref="S2.E2.m1.12.12.12.8.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.12.12.12.8.1.1.1.1.3" xref="S2.E2.m1.12.12.12.8.1.1.1.1.3.cmml">o</mi><mo id="S2.E2.m1.12.12.12.8.1.1.1.1.1a" xref="S2.E2.m1.12.12.12.8.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.12.12.12.8.1.1.1.1.4" xref="S2.E2.m1.12.12.12.8.1.1.1.1.4.cmml">g</mi><mo id="S2.E2.m1.12.12.12.8.1.1.1.1.1b" xref="S2.E2.m1.12.12.12.8.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.12.12.12.8.1.1.1.1.5" xref="S2.E2.m1.12.12.12.8.1.1.1.1.5.cmml">i</mi><mo id="S2.E2.m1.12.12.12.8.1.1.1.1.1c" xref="S2.E2.m1.12.12.12.8.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.12.12.12.8.1.1.1.1.6" xref="S2.E2.m1.12.12.12.8.1.1.1.1.6.cmml"><mi id="S2.E2.m1.12.12.12.8.1.1.1.1.6.2" xref="S2.E2.m1.12.12.12.8.1.1.1.1.6.2.cmml">t</mi><mrow id="S2.E2.m1.8.8.8.4.2.4" xref="S2.E2.m1.8.8.8.4.2.3.cmml"><mi id="S2.E2.m1.7.7.7.3.1.1" xref="S2.E2.m1.7.7.7.3.1.1.cmml">i</mi><mo id="S2.E2.m1.8.8.8.4.2.4.1" xref="S2.E2.m1.8.8.8.4.2.3.cmml">,</mo><mi id="S2.E2.m1.8.8.8.4.2.2" xref="S2.E2.m1.8.8.8.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S2.E2.m1.12.12.12.8.1.1.1.3" stretchy="false" xref="S2.E2.m1.12.12.12.8.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S2.E2.m1.13.13.1.2" xref="S2.E2.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.13b"><apply id="S2.E2.m1.13.13.1.1.cmml" xref="S2.E2.m1.13.13.1"><eq id="S2.E2.m1.13.13.1.1.1.cmml" xref="S2.E2.m1.13.13.1.1.1"></eq><apply id="S2.E2.m1.13.13.1.1.2.cmml" xref="S2.E2.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.13.13.1.1.2.1.cmml" xref="S2.E2.m1.13.13.1.1.2">subscript</csymbol><ci id="S2.E2.m1.13.13.1.1.2.2.cmml" xref="S2.E2.m1.13.13.1.1.2.2">ℒ</ci><apply id="S2.E2.m1.13.13.1.1.2.3.cmml" xref="S2.E2.m1.13.13.1.1.2.3"><times id="S2.E2.m1.13.13.1.1.2.3.1.cmml" xref="S2.E2.m1.13.13.1.1.2.3.1"></times><ci id="S2.E2.m1.13.13.1.1.2.3.2.cmml" xref="S2.E2.m1.13.13.1.1.2.3.2">𝐶</ci><apply id="S2.E2.m1.13.13.1.1.2.3.3.cmml" xref="S2.E2.m1.13.13.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.13.13.1.1.2.3.3.1.cmml" xref="S2.E2.m1.13.13.1.1.2.3.3">superscript</csymbol><ci id="S2.E2.m1.13.13.1.1.2.3.3.2.cmml" xref="S2.E2.m1.13.13.1.1.2.3.3.2">𝐸</ci><minus id="S2.E2.m1.13.13.1.1.2.3.3.3.cmml" xref="S2.E2.m1.13.13.1.1.2.3.3.3"></minus></apply></apply></apply><apply id="S2.E2.m1.13.13.1.1.3.cmml" xref="S2.E2.m1.13.13.1.1.3"><minus id="S2.E2.m1.13.13.1.1.3.1.cmml" xref="S2.E2.m1.13.13.1.1.3"></minus><apply id="S2.E2.m1.13.13.1.1.3.2.cmml" xref="S2.E2.m1.13.13.1.1.3.2"><log id="S2.E2.m1.13.13.1.1.3.2.1.cmml" xref="S2.E2.m1.13.13.1.1.3.2.1"></log><apply id="S2.E2.m1.12.12.cmml" xref="S2.E2.m1.12.12"><divide id="S2.E2.m1.12.12.13.cmml" xref="S2.E2.m1.12.12"></divide><apply id="S2.E2.m1.4.4.4.5.cmml" xref="S2.E2.m1.4.4.4.4"><exp id="S2.E2.m1.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3"></exp><apply id="S2.E2.m1.4.4.4.4.1.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1"><times id="S2.E2.m1.4.4.4.4.1.1.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.1"></times><ci id="S2.E2.m1.4.4.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.4.4.1.1.2">𝑙</ci><ci id="S2.E2.m1.4.4.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.4.4.1.1.3">𝑜</ci><ci id="S2.E2.m1.4.4.4.4.1.1.4.cmml" xref="S2.E2.m1.4.4.4.4.1.1.4">𝑔</ci><ci id="S2.E2.m1.4.4.4.4.1.1.5.cmml" xref="S2.E2.m1.4.4.4.4.1.1.5">𝑖</ci><apply id="S2.E2.m1.4.4.4.4.1.1.6.cmml" xref="S2.E2.m1.4.4.4.4.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.4.1.1.6.1.cmml" xref="S2.E2.m1.4.4.4.4.1.1.6">subscript</csymbol><ci id="S2.E2.m1.4.4.4.4.1.1.6.2.cmml" xref="S2.E2.m1.4.4.4.4.1.1.6.2">𝑡</ci><list id="S2.E2.m1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">𝑖</ci><plus id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2"></plus></list></apply></apply></apply><apply id="S2.E2.m1.12.12.12.cmml" xref="S2.E2.m1.12.12.12"><plus id="S2.E2.m1.12.12.12.9.cmml" xref="S2.E2.m1.12.12.12.9"></plus><apply id="S2.E2.m1.11.11.11.7.2.cmml" xref="S2.E2.m1.11.11.11.7.1"><exp id="S2.E2.m1.9.9.9.5.cmml" xref="S2.E2.m1.9.9.9.5"></exp><apply id="S2.E2.m1.11.11.11.7.1.1.1.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1"><times id="S2.E2.m1.11.11.11.7.1.1.1.1.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.1"></times><ci id="S2.E2.m1.11.11.11.7.1.1.1.2.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.2">𝑙</ci><ci id="S2.E2.m1.11.11.11.7.1.1.1.3.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.3">𝑜</ci><ci id="S2.E2.m1.11.11.11.7.1.1.1.4.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.4">𝑔</ci><ci id="S2.E2.m1.11.11.11.7.1.1.1.5.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.5">𝑖</ci><apply id="S2.E2.m1.11.11.11.7.1.1.1.6.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.11.11.11.7.1.1.1.6.1.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.6">subscript</csymbol><ci id="S2.E2.m1.11.11.11.7.1.1.1.6.2.cmml" xref="S2.E2.m1.11.11.11.7.1.1.1.6.2">𝑡</ci><list id="S2.E2.m1.6.6.6.2.2.3.cmml" xref="S2.E2.m1.6.6.6.2.2.4"><ci id="S2.E2.m1.5.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.5.1.1.1">𝑖</ci><plus id="S2.E2.m1.6.6.6.2.2.2.cmml" xref="S2.E2.m1.6.6.6.2.2.2"></plus></list></apply></apply></apply><apply id="S2.E2.m1.12.12.12.8.cmml" xref="S2.E2.m1.12.12.12.8"><apply id="S2.E2.m1.12.12.12.8.2.cmml" xref="S2.E2.m1.12.12.12.8.2"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.8.2.1.cmml" xref="S2.E2.m1.12.12.12.8.2">subscript</csymbol><sum id="S2.E2.m1.12.12.12.8.2.2.cmml" xref="S2.E2.m1.12.12.12.8.2.2"></sum><apply id="S2.E2.m1.12.12.12.8.2.3.cmml" xref="S2.E2.m1.12.12.12.8.2.3"><in id="S2.E2.m1.12.12.12.8.2.3.1.cmml" xref="S2.E2.m1.12.12.12.8.2.3.1"></in><ci id="S2.E2.m1.12.12.12.8.2.3.2.cmml" xref="S2.E2.m1.12.12.12.8.2.3.2">𝑗</ci><apply id="S2.E2.m1.12.12.12.8.2.3.3.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.8.2.3.3.1.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3">superscript</csymbol><apply id="S2.E2.m1.12.12.12.8.2.3.3.2.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.8.2.3.3.2.1.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3">subscript</csymbol><ci id="S2.E2.m1.12.12.12.8.2.3.3.2.2.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3.2.2">𝐼</ci><ci id="S2.E2.m1.12.12.12.8.2.3.3.2.3.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3.2.3">𝑛</ci></apply><minus id="S2.E2.m1.12.12.12.8.2.3.3.3.cmml" xref="S2.E2.m1.12.12.12.8.2.3.3.3"></minus></apply></apply></apply><apply id="S2.E2.m1.12.12.12.8.1.2.cmml" xref="S2.E2.m1.12.12.12.8.1.1"><exp id="S2.E2.m1.10.10.10.6.cmml" xref="S2.E2.m1.10.10.10.6"></exp><apply id="S2.E2.m1.12.12.12.8.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1"><times id="S2.E2.m1.12.12.12.8.1.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.1"></times><ci id="S2.E2.m1.12.12.12.8.1.1.1.1.2.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.2">𝑙</ci><ci id="S2.E2.m1.12.12.12.8.1.1.1.1.3.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.3">𝑜</ci><ci id="S2.E2.m1.12.12.12.8.1.1.1.1.4.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.4">𝑔</ci><ci id="S2.E2.m1.12.12.12.8.1.1.1.1.5.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.5">𝑖</ci><apply id="S2.E2.m1.12.12.12.8.1.1.1.1.6.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.8.1.1.1.1.6.1.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.6">subscript</csymbol><ci id="S2.E2.m1.12.12.12.8.1.1.1.1.6.2.cmml" xref="S2.E2.m1.12.12.12.8.1.1.1.1.6.2">𝑡</ci><list id="S2.E2.m1.8.8.8.4.2.3.cmml" xref="S2.E2.m1.8.8.8.4.2.4"><ci id="S2.E2.m1.7.7.7.3.1.1.cmml" xref="S2.E2.m1.7.7.7.3.1.1">𝑖</ci><ci id="S2.E2.m1.8.8.8.4.2.2.cmml" xref="S2.E2.m1.8.8.8.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.13c">\mathcal{L}_{CE^{-}}=-\log\frac{\exp(logit_{i,+})}{\exp(logit_{i,+})+\sum_{j%
\in I_{n}^{-}}\exp(logit_{i,j})},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.13d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_E start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , + end_POSTSUBSCRIPT ) end_ARG start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , + end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_j ∈ italic_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.2">where <math alttext="I_{n}^{-}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><msubsup id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2.2" xref="S2.p2.1.m1.1.1.2.2.cmml">I</mi><mi id="S2.p2.1.m1.1.1.2.3" xref="S2.p2.1.m1.1.1.2.3.cmml">n</mi><mo id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">−</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">superscript</csymbol><apply id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.2.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.2.cmml" xref="S2.p2.1.m1.1.1.2.2">𝐼</ci><ci id="S2.p2.1.m1.1.1.2.3.cmml" xref="S2.p2.1.m1.1.1.2.3">𝑛</ci></apply><minus id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">I_{n}^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> is a set of <math alttext="n" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_n</annotation></semantics></math> sampled negatives.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">However, this method often lacks <em class="ltx_emph ltx_font_italic" id="S2.p3.1.1">hard negatives</em> (negatives that the model misclassifies as positives), leading to overconfidence <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>. Calibrating predicted scores can mitigate this <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>, resulting in SOTA performance, but leaves samples uninformative, suggesting possible improvement. Popularity-based sampling <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib23" title="">2020</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib7" title="">2022</a>)</cite> is another approach, often better than uniform sampling but still outperformed by methods targeting hard negatives directly <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib7" title="">2022</a>; Rendle and Freudenthaler, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib32" title="">2014</a>)</cite>. In-batch negative sampling <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib18" title="">2015</a>; Hidasi and Karatzoglou, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib17" title="">2018</a>)</cite> uses true class labels from other items in the batch, leveraging item popularity. More informative sampling methods approximate softmax distributions using matrix factorizations <cite class="ltx_cite ltx_citemacro_citep">(Rendle and Freudenthaler, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib32" title="">2014</a>)</cite>, adaptive n-grams <cite class="ltx_cite ltx_citemacro_citep">(Bengio and Senécal, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib4" title="">2008</a>)</cite>, and kernel methods <cite class="ltx_cite ltx_citemacro_citep">(Blanc and Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib5" title="">2018</a>; Rawat et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib31" title="">2019</a>)</cite>. Two-step procedures select items with larger logits for loss computation <cite class="ltx_cite ltx_citemacro_citep">(Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib3" title="">2017</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib7" title="">2022</a>; Wilm et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib41" title="">2023</a>)</cite>. Methods targeting hard negatives include accumulating hard negatives for each user <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib40" title="">2021</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib11" title="">2020</a>)</cite>, but this introduces memory overhead. Instead, hard negatives can be selected at each step using (approximate) maximum inner product search (MIPS) or nearest neighbor search (NNS) <cite class="ltx_cite ltx_citemacro_citep">(Vijayanarasimhan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib39" title="">2014</a>; Spring and Shrivastava, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib34" title="">2017</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib15" title="">2016</a>; Yen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib43" title="">2018</a>; Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib23" title="">2020</a>)</cite>. However, the implementations of these methods are not designed for GPU usage and are not easily adaptable due to their reliance on GPU-inefficient operations (like maintaining a hash table).</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">In summary, existing methods fail to target hard negatives effectively or are inefficient for GPU computations, resulting in suboptimal model performance. Our approach addresses this by ensuring an efficient search for hard negatives and batch processing compatibility, which improves GPU utilization.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Reduced Cross-Entropy</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we propose a novel scalable approach for CE loss approximation that reduces memory requirements while maintaining performance, and discuss its wide applicability across domains.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Inspired by the studies <cite class="ltx_cite ltx_citemacro_citep">(Kitaev et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib21" title="">2020</a>)</cite> for efficient attention approximation, our method utilizes locality-sensitive hashing for angular distance <cite class="ltx_cite ltx_citemacro_citep">(Andoni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib2" title="">2015</a>)</cite> for the calculation of CE loss over the part of catalog that most affects gradient updates, finding this part in a GPU-friendly manner.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.10">If we are predicting the next item <math alttext="z_{i+1}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">z</mi><mrow id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.p3.1.m1.1.1.3.1" xref="S3.p3.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑧</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><plus id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3.1"></plus><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">𝑖</ci><cn id="S3.p3.1.m1.1.1.3.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">z_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math> (catalog index) for item <math alttext="z_{i}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">z</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝑧</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">x</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝑥</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the transformer’s output for <math alttext="z_{i}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">z</mi><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝑧</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="y_{j}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><msub id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">y</mi><mi id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">𝑦</ci><ci id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">y_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as the embedding of item <math alttext="j" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_j</annotation></semantics></math> (both of dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.p3.7.m7.1"><semantics id="S3.p3.7.m7.1a"><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">italic_d</annotation></semantics></math>) and the model output score <math alttext="logit_{i,j}=x_{i}^{T}y_{j}" class="ltx_Math" display="inline" id="S3.p3.8.m8.2"><semantics id="S3.p3.8.m8.2a"><mrow id="S3.p3.8.m8.2.3" xref="S3.p3.8.m8.2.3.cmml"><mrow id="S3.p3.8.m8.2.3.2" xref="S3.p3.8.m8.2.3.2.cmml"><mi id="S3.p3.8.m8.2.3.2.2" xref="S3.p3.8.m8.2.3.2.2.cmml">l</mi><mo id="S3.p3.8.m8.2.3.2.1" xref="S3.p3.8.m8.2.3.2.1.cmml">⁢</mo><mi id="S3.p3.8.m8.2.3.2.3" xref="S3.p3.8.m8.2.3.2.3.cmml">o</mi><mo id="S3.p3.8.m8.2.3.2.1a" xref="S3.p3.8.m8.2.3.2.1.cmml">⁢</mo><mi id="S3.p3.8.m8.2.3.2.4" xref="S3.p3.8.m8.2.3.2.4.cmml">g</mi><mo id="S3.p3.8.m8.2.3.2.1b" xref="S3.p3.8.m8.2.3.2.1.cmml">⁢</mo><mi id="S3.p3.8.m8.2.3.2.5" xref="S3.p3.8.m8.2.3.2.5.cmml">i</mi><mo id="S3.p3.8.m8.2.3.2.1c" xref="S3.p3.8.m8.2.3.2.1.cmml">⁢</mo><msub id="S3.p3.8.m8.2.3.2.6" xref="S3.p3.8.m8.2.3.2.6.cmml"><mi id="S3.p3.8.m8.2.3.2.6.2" xref="S3.p3.8.m8.2.3.2.6.2.cmml">t</mi><mrow id="S3.p3.8.m8.2.2.2.4" xref="S3.p3.8.m8.2.2.2.3.cmml"><mi id="S3.p3.8.m8.1.1.1.1" xref="S3.p3.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.p3.8.m8.2.2.2.4.1" xref="S3.p3.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.p3.8.m8.2.2.2.2" xref="S3.p3.8.m8.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.p3.8.m8.2.3.1" xref="S3.p3.8.m8.2.3.1.cmml">=</mo><mrow id="S3.p3.8.m8.2.3.3" xref="S3.p3.8.m8.2.3.3.cmml"><msubsup id="S3.p3.8.m8.2.3.3.2" xref="S3.p3.8.m8.2.3.3.2.cmml"><mi id="S3.p3.8.m8.2.3.3.2.2.2" xref="S3.p3.8.m8.2.3.3.2.2.2.cmml">x</mi><mi id="S3.p3.8.m8.2.3.3.2.2.3" xref="S3.p3.8.m8.2.3.3.2.2.3.cmml">i</mi><mi id="S3.p3.8.m8.2.3.3.2.3" xref="S3.p3.8.m8.2.3.3.2.3.cmml">T</mi></msubsup><mo id="S3.p3.8.m8.2.3.3.1" xref="S3.p3.8.m8.2.3.3.1.cmml">⁢</mo><msub id="S3.p3.8.m8.2.3.3.3" xref="S3.p3.8.m8.2.3.3.3.cmml"><mi id="S3.p3.8.m8.2.3.3.3.2" xref="S3.p3.8.m8.2.3.3.3.2.cmml">y</mi><mi id="S3.p3.8.m8.2.3.3.3.3" xref="S3.p3.8.m8.2.3.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.2b"><apply id="S3.p3.8.m8.2.3.cmml" xref="S3.p3.8.m8.2.3"><eq id="S3.p3.8.m8.2.3.1.cmml" xref="S3.p3.8.m8.2.3.1"></eq><apply id="S3.p3.8.m8.2.3.2.cmml" xref="S3.p3.8.m8.2.3.2"><times id="S3.p3.8.m8.2.3.2.1.cmml" xref="S3.p3.8.m8.2.3.2.1"></times><ci id="S3.p3.8.m8.2.3.2.2.cmml" xref="S3.p3.8.m8.2.3.2.2">𝑙</ci><ci id="S3.p3.8.m8.2.3.2.3.cmml" xref="S3.p3.8.m8.2.3.2.3">𝑜</ci><ci id="S3.p3.8.m8.2.3.2.4.cmml" xref="S3.p3.8.m8.2.3.2.4">𝑔</ci><ci id="S3.p3.8.m8.2.3.2.5.cmml" xref="S3.p3.8.m8.2.3.2.5">𝑖</ci><apply id="S3.p3.8.m8.2.3.2.6.cmml" xref="S3.p3.8.m8.2.3.2.6"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.2.6.1.cmml" xref="S3.p3.8.m8.2.3.2.6">subscript</csymbol><ci id="S3.p3.8.m8.2.3.2.6.2.cmml" xref="S3.p3.8.m8.2.3.2.6.2">𝑡</ci><list id="S3.p3.8.m8.2.2.2.3.cmml" xref="S3.p3.8.m8.2.2.2.4"><ci id="S3.p3.8.m8.1.1.1.1.cmml" xref="S3.p3.8.m8.1.1.1.1">𝑖</ci><ci id="S3.p3.8.m8.2.2.2.2.cmml" xref="S3.p3.8.m8.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.p3.8.m8.2.3.3.cmml" xref="S3.p3.8.m8.2.3.3"><times id="S3.p3.8.m8.2.3.3.1.cmml" xref="S3.p3.8.m8.2.3.3.1"></times><apply id="S3.p3.8.m8.2.3.3.2.cmml" xref="S3.p3.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.3.2.1.cmml" xref="S3.p3.8.m8.2.3.3.2">superscript</csymbol><apply id="S3.p3.8.m8.2.3.3.2.2.cmml" xref="S3.p3.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.3.2.2.1.cmml" xref="S3.p3.8.m8.2.3.3.2">subscript</csymbol><ci id="S3.p3.8.m8.2.3.3.2.2.2.cmml" xref="S3.p3.8.m8.2.3.3.2.2.2">𝑥</ci><ci id="S3.p3.8.m8.2.3.3.2.2.3.cmml" xref="S3.p3.8.m8.2.3.3.2.2.3">𝑖</ci></apply><ci id="S3.p3.8.m8.2.3.3.2.3.cmml" xref="S3.p3.8.m8.2.3.3.2.3">𝑇</ci></apply><apply id="S3.p3.8.m8.2.3.3.3.cmml" xref="S3.p3.8.m8.2.3.3.3"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.3.3.1.cmml" xref="S3.p3.8.m8.2.3.3.3">subscript</csymbol><ci id="S3.p3.8.m8.2.3.3.3.2.cmml" xref="S3.p3.8.m8.2.3.3.3.2">𝑦</ci><ci id="S3.p3.8.m8.2.3.3.3.3.cmml" xref="S3.p3.8.m8.2.3.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.2c">logit_{i,j}=x_{i}^{T}y_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.2d">italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, then for catalog size <math alttext="C" class="ltx_Math" display="inline" id="S3.p3.9.m9.1"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">italic_C</annotation></semantics></math>, the CE loss for item <math alttext="z_{i}" class="ltx_Math" display="inline" id="S3.p3.10.m10.1"><semantics id="S3.p3.10.m10.1a"><msub id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mi id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml">z</mi><mi id="S3.p3.10.m10.1.1.3" xref="S3.p3.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2">𝑧</ci><ci id="S3.p3.10.m10.1.1.3.cmml" xref="S3.p3.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m10.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{CE}=-\log(\text{softmax}(logit_{i})_{z_{i+1}})\ =-\log\frac{\exp(%
logit_{i,z_{i+1}})}{\sum_{c=1}^{C}\exp(logit_{i,c})}" class="ltx_Math" display="block" id="S3.E3.m1.10"><semantics id="S3.E3.m1.10a"><mrow id="S3.E3.m1.10.10" xref="S3.E3.m1.10.10.cmml"><msub id="S3.E3.m1.10.10.3" xref="S3.E3.m1.10.10.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.10.10.3.2" xref="S3.E3.m1.10.10.3.2.cmml">ℒ</mi><mrow id="S3.E3.m1.10.10.3.3" xref="S3.E3.m1.10.10.3.3.cmml"><mi id="S3.E3.m1.10.10.3.3.2" xref="S3.E3.m1.10.10.3.3.2.cmml">C</mi><mo id="S3.E3.m1.10.10.3.3.1" xref="S3.E3.m1.10.10.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.10.10.3.3.3" xref="S3.E3.m1.10.10.3.3.3.cmml">E</mi></mrow></msub><mo id="S3.E3.m1.10.10.4" xref="S3.E3.m1.10.10.4.cmml">=</mo><mrow id="S3.E3.m1.10.10.1" xref="S3.E3.m1.10.10.1.cmml"><mo id="S3.E3.m1.10.10.1a" rspace="0.167em" xref="S3.E3.m1.10.10.1.cmml">−</mo><mrow id="S3.E3.m1.10.10.1.1.1" xref="S3.E3.m1.10.10.1.1.2.cmml"><mi id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml">log</mi><mo id="S3.E3.m1.10.10.1.1.1a" xref="S3.E3.m1.10.10.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.10.10.1.1.1.1" xref="S3.E3.m1.10.10.1.1.2.cmml"><mo id="S3.E3.m1.10.10.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.10.10.1.1.2.cmml">(</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.cmml"><mtext id="S3.E3.m1.10.10.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.3a.cmml">softmax</mtext><mo id="S3.E3.m1.10.10.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.4.cmml">g</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1b" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.5" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1c" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.2.cmml">t</mi><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.3.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.2.cmml">z</mi><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></msub></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.3" rspace="0.500em" stretchy="false" xref="S3.E3.m1.10.10.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.10.10.5" xref="S3.E3.m1.10.10.5.cmml">=</mo><mrow id="S3.E3.m1.10.10.6" xref="S3.E3.m1.10.10.6.cmml"><mo id="S3.E3.m1.10.10.6a" rspace="0.167em" xref="S3.E3.m1.10.10.6.cmml">−</mo><mrow id="S3.E3.m1.10.10.6.2" xref="S3.E3.m1.10.10.6.2.cmml"><mi id="S3.E3.m1.10.10.6.2.1" xref="S3.E3.m1.10.10.6.2.1.cmml">log</mi><mo id="S3.E3.m1.10.10.6.2a" lspace="0.167em" xref="S3.E3.m1.10.10.6.2.cmml">⁡</mo><mfrac id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml"><mrow id="S3.E3.m1.4.4.4.4" xref="S3.E3.m1.4.4.4.5.cmml"><mi id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml">exp</mi><mo id="S3.E3.m1.4.4.4.4a" xref="S3.E3.m1.4.4.4.5.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.4.4.1" xref="S3.E3.m1.4.4.4.5.cmml"><mo id="S3.E3.m1.4.4.4.4.1.2" stretchy="false" xref="S3.E3.m1.4.4.4.5.cmml">(</mo><mrow id="S3.E3.m1.4.4.4.4.1.1" xref="S3.E3.m1.4.4.4.4.1.1.cmml"><mi id="S3.E3.m1.4.4.4.4.1.1.2" xref="S3.E3.m1.4.4.4.4.1.1.2.cmml">l</mi><mo id="S3.E3.m1.4.4.4.4.1.1.1" xref="S3.E3.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.4.4.1.1.3" xref="S3.E3.m1.4.4.4.4.1.1.3.cmml">o</mi><mo id="S3.E3.m1.4.4.4.4.1.1.1a" xref="S3.E3.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.4.4.1.1.4" xref="S3.E3.m1.4.4.4.4.1.1.4.cmml">g</mi><mo id="S3.E3.m1.4.4.4.4.1.1.1b" xref="S3.E3.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.4.4.1.1.5" xref="S3.E3.m1.4.4.4.4.1.1.5.cmml">i</mi><mo id="S3.E3.m1.4.4.4.4.1.1.1c" xref="S3.E3.m1.4.4.4.4.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.4.4.4.4.1.1.6" xref="S3.E3.m1.4.4.4.4.1.1.6.cmml"><mi id="S3.E3.m1.4.4.4.4.1.1.6.2" xref="S3.E3.m1.4.4.4.4.1.1.6.2.cmml">t</mi><mrow id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.2.1.2.cmml">z</mi><mrow id="S3.E3.m1.2.2.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.1.cmml">+</mo><mn id="S3.E3.m1.2.2.2.2.2.2.1.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.cmml">1</mn></mrow></msub></mrow></msub></mrow><mo id="S3.E3.m1.4.4.4.4.1.3" stretchy="false" xref="S3.E3.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.8.8.8" xref="S3.E3.m1.8.8.8.cmml"><msubsup id="S3.E3.m1.8.8.8.5" xref="S3.E3.m1.8.8.8.5.cmml"><mo id="S3.E3.m1.8.8.8.5.2.2" xref="S3.E3.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="S3.E3.m1.8.8.8.5.2.3" xref="S3.E3.m1.8.8.8.5.2.3.cmml"><mi id="S3.E3.m1.8.8.8.5.2.3.2" xref="S3.E3.m1.8.8.8.5.2.3.2.cmml">c</mi><mo id="S3.E3.m1.8.8.8.5.2.3.1" xref="S3.E3.m1.8.8.8.5.2.3.1.cmml">=</mo><mn id="S3.E3.m1.8.8.8.5.2.3.3" xref="S3.E3.m1.8.8.8.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.8.8.8.5.3" xref="S3.E3.m1.8.8.8.5.3.cmml">C</mi></msubsup><mrow id="S3.E3.m1.8.8.8.4.1" xref="S3.E3.m1.8.8.8.4.2.cmml"><mi id="S3.E3.m1.7.7.7.3" xref="S3.E3.m1.7.7.7.3.cmml">exp</mi><mo id="S3.E3.m1.8.8.8.4.1a" xref="S3.E3.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="S3.E3.m1.8.8.8.4.1.1" xref="S3.E3.m1.8.8.8.4.2.cmml"><mo id="S3.E3.m1.8.8.8.4.1.1.2" stretchy="false" xref="S3.E3.m1.8.8.8.4.2.cmml">(</mo><mrow id="S3.E3.m1.8.8.8.4.1.1.1" xref="S3.E3.m1.8.8.8.4.1.1.1.cmml"><mi id="S3.E3.m1.8.8.8.4.1.1.1.2" xref="S3.E3.m1.8.8.8.4.1.1.1.2.cmml">l</mi><mo id="S3.E3.m1.8.8.8.4.1.1.1.1" xref="S3.E3.m1.8.8.8.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.8.8.8.4.1.1.1.3" xref="S3.E3.m1.8.8.8.4.1.1.1.3.cmml">o</mi><mo id="S3.E3.m1.8.8.8.4.1.1.1.1a" xref="S3.E3.m1.8.8.8.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.8.8.8.4.1.1.1.4" xref="S3.E3.m1.8.8.8.4.1.1.1.4.cmml">g</mi><mo id="S3.E3.m1.8.8.8.4.1.1.1.1b" xref="S3.E3.m1.8.8.8.4.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.8.8.8.4.1.1.1.5" xref="S3.E3.m1.8.8.8.4.1.1.1.5.cmml">i</mi><mo id="S3.E3.m1.8.8.8.4.1.1.1.1c" xref="S3.E3.m1.8.8.8.4.1.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.8.8.8.4.1.1.1.6" xref="S3.E3.m1.8.8.8.4.1.1.1.6.cmml"><mi id="S3.E3.m1.8.8.8.4.1.1.1.6.2" xref="S3.E3.m1.8.8.8.4.1.1.1.6.2.cmml">t</mi><mrow id="S3.E3.m1.6.6.6.2.2.4" xref="S3.E3.m1.6.6.6.2.2.3.cmml"><mi id="S3.E3.m1.5.5.5.1.1.1" xref="S3.E3.m1.5.5.5.1.1.1.cmml">i</mi><mo id="S3.E3.m1.6.6.6.2.2.4.1" xref="S3.E3.m1.6.6.6.2.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.6.2.2.2" xref="S3.E3.m1.6.6.6.2.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S3.E3.m1.8.8.8.4.1.1.3" stretchy="false" xref="S3.E3.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.10b"><apply id="S3.E3.m1.10.10.cmml" xref="S3.E3.m1.10.10"><and id="S3.E3.m1.10.10a.cmml" xref="S3.E3.m1.10.10"></and><apply id="S3.E3.m1.10.10b.cmml" xref="S3.E3.m1.10.10"><eq id="S3.E3.m1.10.10.4.cmml" xref="S3.E3.m1.10.10.4"></eq><apply id="S3.E3.m1.10.10.3.cmml" xref="S3.E3.m1.10.10.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.3.1.cmml" xref="S3.E3.m1.10.10.3">subscript</csymbol><ci id="S3.E3.m1.10.10.3.2.cmml" xref="S3.E3.m1.10.10.3.2">ℒ</ci><apply id="S3.E3.m1.10.10.3.3.cmml" xref="S3.E3.m1.10.10.3.3"><times id="S3.E3.m1.10.10.3.3.1.cmml" xref="S3.E3.m1.10.10.3.3.1"></times><ci id="S3.E3.m1.10.10.3.3.2.cmml" xref="S3.E3.m1.10.10.3.3.2">𝐶</ci><ci id="S3.E3.m1.10.10.3.3.3.cmml" xref="S3.E3.m1.10.10.3.3.3">𝐸</ci></apply></apply><apply id="S3.E3.m1.10.10.1.cmml" xref="S3.E3.m1.10.10.1"><minus id="S3.E3.m1.10.10.1.2.cmml" xref="S3.E3.m1.10.10.1"></minus><apply id="S3.E3.m1.10.10.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1"><log id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9"></log><apply id="S3.E3.m1.10.10.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.2"></times><ci id="S3.E3.m1.10.10.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.3"><mtext id="S3.E3.m1.10.10.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.4">𝑔</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.5">𝑖</ci><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.2">𝑡</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.6.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.2">𝑧</ci><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3"><plus id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.2">𝑖</ci><cn id="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E3.m1.10.10.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E3.m1.10.10c.cmml" xref="S3.E3.m1.10.10"><eq id="S3.E3.m1.10.10.5.cmml" xref="S3.E3.m1.10.10.5"></eq><share href="https://arxiv.org/html/2408.02354v3#S3.E3.m1.10.10.1.cmml" id="S3.E3.m1.10.10d.cmml" xref="S3.E3.m1.10.10"></share><apply id="S3.E3.m1.10.10.6.cmml" xref="S3.E3.m1.10.10.6"><minus id="S3.E3.m1.10.10.6.1.cmml" xref="S3.E3.m1.10.10.6"></minus><apply id="S3.E3.m1.10.10.6.2.cmml" xref="S3.E3.m1.10.10.6.2"><log id="S3.E3.m1.10.10.6.2.1.cmml" xref="S3.E3.m1.10.10.6.2.1"></log><apply id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8"><divide id="S3.E3.m1.8.8.9.cmml" xref="S3.E3.m1.8.8"></divide><apply id="S3.E3.m1.4.4.4.5.cmml" xref="S3.E3.m1.4.4.4.4"><exp id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3"></exp><apply id="S3.E3.m1.4.4.4.4.1.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1"><times id="S3.E3.m1.4.4.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1.1"></times><ci id="S3.E3.m1.4.4.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.4.4.1.1.2">𝑙</ci><ci id="S3.E3.m1.4.4.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.4.4.1.1.3">𝑜</ci><ci id="S3.E3.m1.4.4.4.4.1.1.4.cmml" xref="S3.E3.m1.4.4.4.4.1.1.4">𝑔</ci><ci id="S3.E3.m1.4.4.4.4.1.1.5.cmml" xref="S3.E3.m1.4.4.4.4.1.1.5">𝑖</ci><apply id="S3.E3.m1.4.4.4.4.1.1.6.cmml" xref="S3.E3.m1.4.4.4.4.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.1.1.6.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1.6">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.1.1.6.2.cmml" xref="S3.E3.m1.4.4.4.4.1.1.6.2">𝑡</ci><list id="S3.E3.m1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.2">𝑧</ci><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3"><plus id="S3.E3.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.1"></plus><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2">𝑖</ci><cn id="S3.E3.m1.2.2.2.2.2.2.1.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3">1</cn></apply></apply></list></apply></apply></apply><apply id="S3.E3.m1.8.8.8.cmml" xref="S3.E3.m1.8.8.8"><apply id="S3.E3.m1.8.8.8.5.cmml" xref="S3.E3.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.8.5.1.cmml" xref="S3.E3.m1.8.8.8.5">superscript</csymbol><apply id="S3.E3.m1.8.8.8.5.2.cmml" xref="S3.E3.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.8.5.2.1.cmml" xref="S3.E3.m1.8.8.8.5">subscript</csymbol><sum id="S3.E3.m1.8.8.8.5.2.2.cmml" xref="S3.E3.m1.8.8.8.5.2.2"></sum><apply id="S3.E3.m1.8.8.8.5.2.3.cmml" xref="S3.E3.m1.8.8.8.5.2.3"><eq id="S3.E3.m1.8.8.8.5.2.3.1.cmml" xref="S3.E3.m1.8.8.8.5.2.3.1"></eq><ci id="S3.E3.m1.8.8.8.5.2.3.2.cmml" xref="S3.E3.m1.8.8.8.5.2.3.2">𝑐</ci><cn id="S3.E3.m1.8.8.8.5.2.3.3.cmml" type="integer" xref="S3.E3.m1.8.8.8.5.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.8.8.8.5.3.cmml" xref="S3.E3.m1.8.8.8.5.3">𝐶</ci></apply><apply id="S3.E3.m1.8.8.8.4.2.cmml" xref="S3.E3.m1.8.8.8.4.1"><exp id="S3.E3.m1.7.7.7.3.cmml" xref="S3.E3.m1.7.7.7.3"></exp><apply id="S3.E3.m1.8.8.8.4.1.1.1.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1"><times id="S3.E3.m1.8.8.8.4.1.1.1.1.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.1"></times><ci id="S3.E3.m1.8.8.8.4.1.1.1.2.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.2">𝑙</ci><ci id="S3.E3.m1.8.8.8.4.1.1.1.3.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.3">𝑜</ci><ci id="S3.E3.m1.8.8.8.4.1.1.1.4.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.4">𝑔</ci><ci id="S3.E3.m1.8.8.8.4.1.1.1.5.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.5">𝑖</ci><apply id="S3.E3.m1.8.8.8.4.1.1.1.6.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.8.4.1.1.1.6.1.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.6">subscript</csymbol><ci id="S3.E3.m1.8.8.8.4.1.1.1.6.2.cmml" xref="S3.E3.m1.8.8.8.4.1.1.1.6.2">𝑡</ci><list id="S3.E3.m1.6.6.6.2.2.3.cmml" xref="S3.E3.m1.6.6.6.2.2.4"><ci id="S3.E3.m1.5.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.5.1.1.1">𝑖</ci><ci id="S3.E3.m1.6.6.6.2.2.2.cmml" xref="S3.E3.m1.6.6.6.2.2.2">𝑐</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.10c">\mathcal{L}_{CE}=-\log(\text{softmax}(logit_{i})_{z_{i+1}})\ =-\log\frac{\exp(%
logit_{i,z_{i+1}})}{\sum_{c=1}^{C}\exp(logit_{i,c})}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.10d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT = - roman_log ( softmax ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = - roman_log divide start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C end_POSTSUPERSCRIPT roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial\mathcal{L}_{CE}}{\partial logit_{i,k}}=\text{softmax}(logit_{i}%
)_{k}-\mathds{1}[k=z_{i+1}]\in\left(-1,1\right)" class="ltx_Math" display="block" id="S3.E4.m1.6"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mfrac id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mrow id="S3.E4.m1.2.2.4" xref="S3.E4.m1.2.2.4.cmml"><mo id="S3.E4.m1.2.2.4.1" rspace="0em" xref="S3.E4.m1.2.2.4.1.cmml">∂</mo><msub id="S3.E4.m1.2.2.4.2" xref="S3.E4.m1.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.4.2.2" xref="S3.E4.m1.2.2.4.2.2.cmml">ℒ</mi><mrow id="S3.E4.m1.2.2.4.2.3" xref="S3.E4.m1.2.2.4.2.3.cmml"><mi id="S3.E4.m1.2.2.4.2.3.2" xref="S3.E4.m1.2.2.4.2.3.2.cmml">C</mi><mo id="S3.E4.m1.2.2.4.2.3.1" xref="S3.E4.m1.2.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.4.2.3.3" xref="S3.E4.m1.2.2.4.2.3.3.cmml">E</mi></mrow></msub></mrow><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mo id="S3.E4.m1.2.2.2.3" rspace="0em" xref="S3.E4.m1.2.2.2.3.cmml">∂</mo><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.4.cmml"><mi id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.4.2.cmml">l</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.4.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.4.3" xref="S3.E4.m1.2.2.2.4.3.cmml">o</mi><mo id="S3.E4.m1.2.2.2.4.1a" xref="S3.E4.m1.2.2.2.4.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.4.4" xref="S3.E4.m1.2.2.2.4.4.cmml">g</mi><mo id="S3.E4.m1.2.2.2.4.1b" xref="S3.E4.m1.2.2.2.4.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.4.5" xref="S3.E4.m1.2.2.2.4.5.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1c" xref="S3.E4.m1.2.2.2.4.1.cmml">⁢</mo><msub id="S3.E4.m1.2.2.2.4.6" xref="S3.E4.m1.2.2.2.4.6.cmml"><mi id="S3.E4.m1.2.2.2.4.6.2" xref="S3.E4.m1.2.2.2.4.6.2.cmml">t</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">k</mi></mrow></msub></mrow></mrow></mfrac><mo id="S3.E4.m1.6.6.5" xref="S3.E4.m1.6.6.5.cmml">=</mo><mrow id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mtext id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3a.cmml">softmax</mtext><mo id="S3.E4.m1.4.4.1.1.2" xref="S3.E4.m1.4.4.1.1.2.cmml">⁢</mo><msub id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1a" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.4" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.cmml">g</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1b" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.5" xref="S3.E4.m1.4.4.1.1.1.1.1.1.5.cmml">i</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1c" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.6" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.6.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6.2.cmml">t</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.6.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.3.cmml">k</mi></msub></mrow><mo id="S3.E4.m1.5.5.2.3" xref="S3.E4.m1.5.5.2.3.cmml">−</mo><mrow id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml"><mn id="S3.E4.m1.5.5.2.2.3" xref="S3.E4.m1.5.5.2.2.3.cmml">𝟙</mn><mo id="S3.E4.m1.5.5.2.2.2" xref="S3.E4.m1.5.5.2.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.2.2.1.1" xref="S3.E4.m1.5.5.2.2.1.2.cmml"><mo id="S3.E4.m1.5.5.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.2.2.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.5.5.2.2.1.1.1" xref="S3.E4.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E4.m1.5.5.2.2.1.1.1.2" xref="S3.E4.m1.5.5.2.2.1.1.1.2.cmml">k</mi><mo id="S3.E4.m1.5.5.2.2.1.1.1.1" xref="S3.E4.m1.5.5.2.2.1.1.1.1.cmml">=</mo><msub id="S3.E4.m1.5.5.2.2.1.1.1.3" xref="S3.E4.m1.5.5.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.2.2.1.1.1.3.2" xref="S3.E4.m1.5.5.2.2.1.1.1.3.2.cmml">z</mi><mrow id="S3.E4.m1.5.5.2.2.1.1.1.3.3" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.cmml"><mi id="S3.E4.m1.5.5.2.2.1.1.1.3.3.2" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E4.m1.5.5.2.2.1.1.1.3.3.1" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.5.5.2.2.1.1.1.3.3.3" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.5.5.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.5.5.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.6.6.6" xref="S3.E4.m1.6.6.6.cmml">∈</mo><mrow id="S3.E4.m1.6.6.3.1" xref="S3.E4.m1.6.6.3.2.cmml"><mo id="S3.E4.m1.6.6.3.1.2" xref="S3.E4.m1.6.6.3.2.cmml">(</mo><mrow id="S3.E4.m1.6.6.3.1.1" xref="S3.E4.m1.6.6.3.1.1.cmml"><mo id="S3.E4.m1.6.6.3.1.1a" xref="S3.E4.m1.6.6.3.1.1.cmml">−</mo><mn id="S3.E4.m1.6.6.3.1.1.2" xref="S3.E4.m1.6.6.3.1.1.2.cmml">1</mn></mrow><mo id="S3.E4.m1.6.6.3.1.3" xref="S3.E4.m1.6.6.3.2.cmml">,</mo><mn id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">1</mn><mo id="S3.E4.m1.6.6.3.1.4" xref="S3.E4.m1.6.6.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><and id="S3.E4.m1.6.6a.cmml" xref="S3.E4.m1.6.6"></and><apply id="S3.E4.m1.6.6b.cmml" xref="S3.E4.m1.6.6"><eq id="S3.E4.m1.6.6.5.cmml" xref="S3.E4.m1.6.6.5"></eq><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2"></divide><apply id="S3.E4.m1.2.2.4.cmml" xref="S3.E4.m1.2.2.4"><partialdiff id="S3.E4.m1.2.2.4.1.cmml" xref="S3.E4.m1.2.2.4.1"></partialdiff><apply id="S3.E4.m1.2.2.4.2.cmml" xref="S3.E4.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.4.2.1.cmml" xref="S3.E4.m1.2.2.4.2">subscript</csymbol><ci id="S3.E4.m1.2.2.4.2.2.cmml" xref="S3.E4.m1.2.2.4.2.2">ℒ</ci><apply id="S3.E4.m1.2.2.4.2.3.cmml" xref="S3.E4.m1.2.2.4.2.3"><times id="S3.E4.m1.2.2.4.2.3.1.cmml" xref="S3.E4.m1.2.2.4.2.3.1"></times><ci id="S3.E4.m1.2.2.4.2.3.2.cmml" xref="S3.E4.m1.2.2.4.2.3.2">𝐶</ci><ci id="S3.E4.m1.2.2.4.2.3.3.cmml" xref="S3.E4.m1.2.2.4.2.3.3">𝐸</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><partialdiff id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3"></partialdiff><apply id="S3.E4.m1.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.4"><times id="S3.E4.m1.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.4.1"></times><ci id="S3.E4.m1.2.2.2.4.2.cmml" xref="S3.E4.m1.2.2.2.4.2">𝑙</ci><ci id="S3.E4.m1.2.2.2.4.3.cmml" xref="S3.E4.m1.2.2.2.4.3">𝑜</ci><ci id="S3.E4.m1.2.2.2.4.4.cmml" xref="S3.E4.m1.2.2.2.4.4">𝑔</ci><ci id="S3.E4.m1.2.2.2.4.5.cmml" xref="S3.E4.m1.2.2.2.4.5">𝑖</ci><apply id="S3.E4.m1.2.2.2.4.6.cmml" xref="S3.E4.m1.2.2.2.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.4.6.1.cmml" xref="S3.E4.m1.2.2.2.4.6">subscript</csymbol><ci id="S3.E4.m1.2.2.2.4.6.2.cmml" xref="S3.E4.m1.2.2.2.4.6.2">𝑡</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑘</ci></list></apply></apply></apply></apply><apply id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"><minus id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.3"></minus><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1"><times id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2"></times><ci id="S3.E4.m1.4.4.1.1.3a.cmml" xref="S3.E4.m1.4.4.1.1.3"><mtext id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3">softmax</mtext></ci><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1">subscript</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4">𝑔</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.5">𝑖</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.6.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.6.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.6.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6.2">𝑡</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.6.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.6.3">𝑖</ci></apply></apply><ci id="S3.E4.m1.4.4.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2"><times id="S3.E4.m1.5.5.2.2.2.cmml" xref="S3.E4.m1.5.5.2.2.2"></times><cn id="S3.E4.m1.5.5.2.2.3.cmml" type="integer" xref="S3.E4.m1.5.5.2.2.3">1</cn><apply id="S3.E4.m1.5.5.2.2.1.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.2.2.1.2.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.5.5.2.2.1.1.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1"><eq id="S3.E4.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.1"></eq><ci id="S3.E4.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.2">𝑘</ci><apply id="S3.E4.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3.2">𝑧</ci><apply id="S3.E4.m1.5.5.2.2.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3"><plus id="S3.E4.m1.5.5.2.2.1.1.1.3.3.1.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.1"></plus><ci id="S3.E4.m1.5.5.2.2.1.1.1.3.3.2.cmml" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.2">𝑖</ci><cn id="S3.E4.m1.5.5.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.5.5.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E4.m1.6.6c.cmml" xref="S3.E4.m1.6.6"><in id="S3.E4.m1.6.6.6.cmml" xref="S3.E4.m1.6.6.6"></in><share href="https://arxiv.org/html/2408.02354v3#S3.E4.m1.5.5.2.cmml" id="S3.E4.m1.6.6d.cmml" xref="S3.E4.m1.6.6"></share><interval closure="open" id="S3.E4.m1.6.6.3.2.cmml" xref="S3.E4.m1.6.6.3.1"><apply id="S3.E4.m1.6.6.3.1.1.cmml" xref="S3.E4.m1.6.6.3.1.1"><minus id="S3.E4.m1.6.6.3.1.1.1.cmml" xref="S3.E4.m1.6.6.3.1.1"></minus><cn id="S3.E4.m1.6.6.3.1.1.2.cmml" type="integer" xref="S3.E4.m1.6.6.3.1.1.2">1</cn></apply><cn id="S3.E4.m1.3.3.cmml" type="integer" xref="S3.E4.m1.3.3">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">\frac{\partial\mathcal{L}_{CE}}{\partial logit_{i,k}}=\text{softmax}(logit_{i}%
)_{k}-\mathds{1}[k=z_{i+1}]\in\left(-1,1\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.6d">divide start_ARG ∂ caligraphic_L start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT end_ARG = softmax ( italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - blackboard_1 [ italic_k = italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ] ∈ ( - 1 , 1 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.14">The gradient of the CE loss with respect to logits ranges from <math alttext="-1" class="ltx_Math" display="inline" id="S3.p3.11.m1.1"><semantics id="S3.p3.11.m1.1a"><mrow id="S3.p3.11.m1.1.1" xref="S3.p3.11.m1.1.1.cmml"><mo id="S3.p3.11.m1.1.1a" xref="S3.p3.11.m1.1.1.cmml">−</mo><mn id="S3.p3.11.m1.1.1.2" xref="S3.p3.11.m1.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.m1.1b"><apply id="S3.p3.11.m1.1.1.cmml" xref="S3.p3.11.m1.1.1"><minus id="S3.p3.11.m1.1.1.1.cmml" xref="S3.p3.11.m1.1.1"></minus><cn id="S3.p3.11.m1.1.1.2.cmml" type="integer" xref="S3.p3.11.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m1.1c">-1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.m1.1d">- 1</annotation></semantics></math> to <math alttext="1" class="ltx_Math" display="inline" id="S3.p3.12.m2.1"><semantics id="S3.p3.12.m2.1a"><mn id="S3.p3.12.m2.1.1" xref="S3.p3.12.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.p3.12.m2.1b"><cn id="S3.p3.12.m2.1.1.cmml" type="integer" xref="S3.p3.12.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.12.m2.1d">1</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S3.E4" title="In 3. Reduced Cross-Entropy ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>). It is close to <math alttext="1" class="ltx_Math" display="inline" id="S3.p3.13.m3.1"><semantics id="S3.p3.13.m3.1a"><mn id="S3.p3.13.m3.1.1" xref="S3.p3.13.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.p3.13.m3.1b"><cn id="S3.p3.13.m3.1.1.cmml" type="integer" xref="S3.p3.13.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.13.m3.1d">1</annotation></semantics></math> for high predicted probabilities of incorrect classes and close to <math alttext="-1" class="ltx_Math" display="inline" id="S3.p3.14.m4.1"><semantics id="S3.p3.14.m4.1a"><mrow id="S3.p3.14.m4.1.1" xref="S3.p3.14.m4.1.1.cmml"><mo id="S3.p3.14.m4.1.1a" xref="S3.p3.14.m4.1.1.cmml">−</mo><mn id="S3.p3.14.m4.1.1.2" xref="S3.p3.14.m4.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.14.m4.1b"><apply id="S3.p3.14.m4.1.1.cmml" xref="S3.p3.14.m4.1.1"><minus id="S3.p3.14.m4.1.1.1.cmml" xref="S3.p3.14.m4.1.1"></minus><cn id="S3.p3.14.m4.1.1.2.cmml" type="integer" xref="S3.p3.14.m4.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m4.1c">-1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.14.m4.1d">- 1</annotation></semantics></math> for low predicted probabilities of correct classes. We aim to compute only logits with the largest absolute gradient values to preserve the most information, identifying these cases in advance. While the correct class logit is known, finding large logits for negative classes is a harder task. We simplify this by searching for all large logits, essentially solving a MIPS problem.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.19">To address this task, we propose the RECE approach, presented in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#alg1" title="Algorithm 1 ‣ 3. Reduced Cross-Entropy ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">1</span></a> with Lines 3-12 depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S0.F1" title="Figure 1 ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">1</span></a>. It starts by generating a set <math alttext="B" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_B</annotation></semantics></math> of <math alttext="n_{b}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">n</mi><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑛</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">n_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> random vectors (Line 2), then indexing of the transformer outputs <math alttext="X" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_X</annotation></semantics></math> (dimensions for batch size <math alttext="s" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">italic_s</annotation></semantics></math> and sequence length <math alttext="l" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><mi id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><ci id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">italic_l</annotation></semantics></math> are collapsed) and catalog item embeddings <math alttext="Y" class="ltx_Math" display="inline" id="S3.p4.6.m6.1"><semantics id="S3.p4.6.m6.1a"><mi id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><ci id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.m6.1d">italic_Y</annotation></semantics></math> with the index of the nearest vector from <math alttext="B" class="ltx_Math" display="inline" id="S3.p4.7.m7.1"><semantics id="S3.p4.7.m7.1a"><mi id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><ci id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p4.7.m7.1d">italic_B</annotation></semantics></math> (Lines 3-4). We want to divide items from <math alttext="X" class="ltx_Math" display="inline" id="S3.p4.8.m8.1"><semantics id="S3.p4.8.m8.1a"><mi id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><ci id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.p4.8.m8.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S3.p4.9.m9.1"><semantics id="S3.p4.9.m9.1a"><mi id="S3.p4.9.m9.1.1" xref="S3.p4.9.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.p4.9.m9.1b"><ci id="S3.p4.9.m9.1.1.cmml" xref="S3.p4.9.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m9.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.p4.9.m9.1d">italic_Y</annotation></semantics></math> into groups based on these indices and to calculate logits only within groups. The idea is that two vectors sharing the nearest vector (in terms of dot product) are likely close to each other. The sizes of these groups could be different, and to perform later computations efficiently, we sort elements based on new indices and divide them into <math alttext="n_{c}" class="ltx_Math" display="inline" id="S3.p4.10.m10.1"><semantics id="S3.p4.10.m10.1a"><msub id="S3.p4.10.m10.1.1" xref="S3.p4.10.m10.1.1.cmml"><mi id="S3.p4.10.m10.1.1.2" xref="S3.p4.10.m10.1.1.2.cmml">n</mi><mi id="S3.p4.10.m10.1.1.3" xref="S3.p4.10.m10.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.10.m10.1b"><apply id="S3.p4.10.m10.1.1.cmml" xref="S3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m10.1.1.1.cmml" xref="S3.p4.10.m10.1.1">subscript</csymbol><ci id="S3.p4.10.m10.1.1.2.cmml" xref="S3.p4.10.m10.1.1.2">𝑛</ci><ci id="S3.p4.10.m10.1.1.3.cmml" xref="S3.p4.10.m10.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m10.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.10.m10.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> equal-sized chunks (Lines 5-11). The number of chunks <math alttext="n_{c}" class="ltx_Math" display="inline" id="S3.p4.11.m11.1"><semantics id="S3.p4.11.m11.1a"><msub id="S3.p4.11.m11.1.1" xref="S3.p4.11.m11.1.1.cmml"><mi id="S3.p4.11.m11.1.1.2" xref="S3.p4.11.m11.1.1.2.cmml">n</mi><mi id="S3.p4.11.m11.1.1.3" xref="S3.p4.11.m11.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.11.m11.1b"><apply id="S3.p4.11.m11.1.1.cmml" xref="S3.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.1.cmml" xref="S3.p4.11.m11.1.1">subscript</csymbol><ci id="S3.p4.11.m11.1.1.2.cmml" xref="S3.p4.11.m11.1.1.2">𝑛</ci><ci id="S3.p4.11.m11.1.1.3.cmml" xref="S3.p4.11.m11.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m11.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.11.m11.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> can be selected larger than <math alttext="n_{b}" class="ltx_Math" display="inline" id="S3.p4.12.m12.1"><semantics id="S3.p4.12.m12.1a"><msub id="S3.p4.12.m12.1.1" xref="S3.p4.12.m12.1.1.cmml"><mi id="S3.p4.12.m12.1.1.2" xref="S3.p4.12.m12.1.1.2.cmml">n</mi><mi id="S3.p4.12.m12.1.1.3" xref="S3.p4.12.m12.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.12.m12.1b"><apply id="S3.p4.12.m12.1.1.cmml" xref="S3.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p4.12.m12.1.1.1.cmml" xref="S3.p4.12.m12.1.1">subscript</csymbol><ci id="S3.p4.12.m12.1.1.2.cmml" xref="S3.p4.12.m12.1.1.2">𝑛</ci><ci id="S3.p4.12.m12.1.1.3.cmml" xref="S3.p4.12.m12.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.12.m12.1c">n_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.12.m12.1d">italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> so that relevant items fall into the same chunk with a higher probability. For the same reason, for logit calculation, we also select items from the neighboring chunks (Line 12). Finally, we calculate logits for negative classes within chunks, compute positive logits (<math alttext="\hat{Z}" class="ltx_Math" display="inline" id="S3.p4.13.m13.1"><semantics id="S3.p4.13.m13.1a"><mover accent="true" id="S3.p4.13.m13.1.1" xref="S3.p4.13.m13.1.1.cmml"><mi id="S3.p4.13.m13.1.1.2" xref="S3.p4.13.m13.1.1.2.cmml">Z</mi><mo id="S3.p4.13.m13.1.1.1" xref="S3.p4.13.m13.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p4.13.m13.1b"><apply id="S3.p4.13.m13.1.1.cmml" xref="S3.p4.13.m13.1.1"><ci id="S3.p4.13.m13.1.1.1.cmml" xref="S3.p4.13.m13.1.1.1">^</ci><ci id="S3.p4.13.m13.1.1.2.cmml" xref="S3.p4.13.m13.1.1.2">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.13.m13.1c">\hat{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.13.m13.1d">over^ start_ARG italic_Z end_ARG</annotation></semantics></math> – correct predictions matrix), determine the value of the loss function for each chunk, and average these values across chunks (Lines 12-16). For better performance, the described procedure (Lines 2-12) can be repeated in parallel over several rounds <math alttext="r" class="ltx_Math" display="inline" id="S3.p4.14.m14.1"><semantics id="S3.p4.14.m14.1a"><mi id="S3.p4.14.m14.1.1" xref="S3.p4.14.m14.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.p4.14.m14.1b"><ci id="S3.p4.14.m14.1.1.cmml" xref="S3.p4.14.m14.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.14.m14.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.p4.14.m14.1d">italic_r</annotation></semantics></math>. In this case, the value of loss function is calculated over an enriched set of negative examples. Duplicate item pairs are accounted for by subtracting from the calculated logit value the natural logarithm of the number of times the logit between these items was calculated over all rounds. For the experiments, we chose the optimal, in terms of peak memory, number of random vectors (<math alttext="n_{b}^{*}=\sqrt{4\alpha_{bc}(1+2n_{ec})\cdot\min(C,s\cdot l)}" class="ltx_Math" display="inline" id="S3.p4.15.m15.4"><semantics id="S3.p4.15.m15.4a"><mrow id="S3.p4.15.m15.4.5" xref="S3.p4.15.m15.4.5.cmml"><msubsup id="S3.p4.15.m15.4.5.2" xref="S3.p4.15.m15.4.5.2.cmml"><mi id="S3.p4.15.m15.4.5.2.2.2" xref="S3.p4.15.m15.4.5.2.2.2.cmml">n</mi><mi id="S3.p4.15.m15.4.5.2.2.3" xref="S3.p4.15.m15.4.5.2.2.3.cmml">b</mi><mo id="S3.p4.15.m15.4.5.2.3" xref="S3.p4.15.m15.4.5.2.3.cmml">∗</mo></msubsup><mo id="S3.p4.15.m15.4.5.1" xref="S3.p4.15.m15.4.5.1.cmml">=</mo><msqrt id="S3.p4.15.m15.4.4" xref="S3.p4.15.m15.4.4.cmml"><mrow id="S3.p4.15.m15.4.4.4" xref="S3.p4.15.m15.4.4.4.cmml"><mrow id="S3.p4.15.m15.3.3.3.3" xref="S3.p4.15.m15.3.3.3.3.cmml"><mn id="S3.p4.15.m15.3.3.3.3.3" xref="S3.p4.15.m15.3.3.3.3.3.cmml">4</mn><mo id="S3.p4.15.m15.3.3.3.3.2" xref="S3.p4.15.m15.3.3.3.3.2.cmml">⁢</mo><msub id="S3.p4.15.m15.3.3.3.3.4" xref="S3.p4.15.m15.3.3.3.3.4.cmml"><mi id="S3.p4.15.m15.3.3.3.3.4.2" xref="S3.p4.15.m15.3.3.3.3.4.2.cmml">α</mi><mrow id="S3.p4.15.m15.3.3.3.3.4.3" xref="S3.p4.15.m15.3.3.3.3.4.3.cmml"><mi id="S3.p4.15.m15.3.3.3.3.4.3.2" xref="S3.p4.15.m15.3.3.3.3.4.3.2.cmml">b</mi><mo id="S3.p4.15.m15.3.3.3.3.4.3.1" xref="S3.p4.15.m15.3.3.3.3.4.3.1.cmml">⁢</mo><mi id="S3.p4.15.m15.3.3.3.3.4.3.3" xref="S3.p4.15.m15.3.3.3.3.4.3.3.cmml">c</mi></mrow></msub><mo id="S3.p4.15.m15.3.3.3.3.2a" xref="S3.p4.15.m15.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.p4.15.m15.3.3.3.3.1.1" xref="S3.p4.15.m15.3.3.3.3.1.1.1.cmml"><mo id="S3.p4.15.m15.3.3.3.3.1.1.2" stretchy="false" xref="S3.p4.15.m15.3.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.p4.15.m15.3.3.3.3.1.1.1" xref="S3.p4.15.m15.3.3.3.3.1.1.1.cmml"><mn id="S3.p4.15.m15.3.3.3.3.1.1.1.2" xref="S3.p4.15.m15.3.3.3.3.1.1.1.2.cmml">1</mn><mo id="S3.p4.15.m15.3.3.3.3.1.1.1.1" xref="S3.p4.15.m15.3.3.3.3.1.1.1.1.cmml">+</mo><mrow id="S3.p4.15.m15.3.3.3.3.1.1.1.3" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.cmml"><mn id="S3.p4.15.m15.3.3.3.3.1.1.1.3.2" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.2.cmml">2</mn><mo id="S3.p4.15.m15.3.3.3.3.1.1.1.3.1" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><msub id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.cmml"><mi id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.2" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.2.cmml">n</mi><mrow id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.cmml"><mi id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.2" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.2.cmml">e</mi><mo id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.1" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.3" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.3.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S3.p4.15.m15.3.3.3.3.1.1.3" rspace="0.055em" stretchy="false" xref="S3.p4.15.m15.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.15.m15.4.4.4.5" rspace="0.222em" xref="S3.p4.15.m15.4.4.4.5.cmml">⋅</mo><mrow id="S3.p4.15.m15.4.4.4.4.1" xref="S3.p4.15.m15.4.4.4.4.2.cmml"><mi id="S3.p4.15.m15.1.1.1.1" xref="S3.p4.15.m15.1.1.1.1.cmml">min</mi><mo id="S3.p4.15.m15.4.4.4.4.1a" xref="S3.p4.15.m15.4.4.4.4.2.cmml">⁡</mo><mrow id="S3.p4.15.m15.4.4.4.4.1.1" xref="S3.p4.15.m15.4.4.4.4.2.cmml"><mo id="S3.p4.15.m15.4.4.4.4.1.1.2" stretchy="false" xref="S3.p4.15.m15.4.4.4.4.2.cmml">(</mo><mi id="S3.p4.15.m15.2.2.2.2" xref="S3.p4.15.m15.2.2.2.2.cmml">C</mi><mo id="S3.p4.15.m15.4.4.4.4.1.1.3" xref="S3.p4.15.m15.4.4.4.4.2.cmml">,</mo><mrow id="S3.p4.15.m15.4.4.4.4.1.1.1" xref="S3.p4.15.m15.4.4.4.4.1.1.1.cmml"><mi id="S3.p4.15.m15.4.4.4.4.1.1.1.2" xref="S3.p4.15.m15.4.4.4.4.1.1.1.2.cmml">s</mi><mo id="S3.p4.15.m15.4.4.4.4.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p4.15.m15.4.4.4.4.1.1.1.1.cmml">⋅</mo><mi id="S3.p4.15.m15.4.4.4.4.1.1.1.3" xref="S3.p4.15.m15.4.4.4.4.1.1.1.3.cmml">l</mi></mrow><mo id="S3.p4.15.m15.4.4.4.4.1.1.4" stretchy="false" xref="S3.p4.15.m15.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.15.m15.4b"><apply id="S3.p4.15.m15.4.5.cmml" xref="S3.p4.15.m15.4.5"><eq id="S3.p4.15.m15.4.5.1.cmml" xref="S3.p4.15.m15.4.5.1"></eq><apply id="S3.p4.15.m15.4.5.2.cmml" xref="S3.p4.15.m15.4.5.2"><csymbol cd="ambiguous" id="S3.p4.15.m15.4.5.2.1.cmml" xref="S3.p4.15.m15.4.5.2">superscript</csymbol><apply id="S3.p4.15.m15.4.5.2.2.cmml" xref="S3.p4.15.m15.4.5.2"><csymbol cd="ambiguous" id="S3.p4.15.m15.4.5.2.2.1.cmml" xref="S3.p4.15.m15.4.5.2">subscript</csymbol><ci id="S3.p4.15.m15.4.5.2.2.2.cmml" xref="S3.p4.15.m15.4.5.2.2.2">𝑛</ci><ci id="S3.p4.15.m15.4.5.2.2.3.cmml" xref="S3.p4.15.m15.4.5.2.2.3">𝑏</ci></apply><times id="S3.p4.15.m15.4.5.2.3.cmml" xref="S3.p4.15.m15.4.5.2.3"></times></apply><apply id="S3.p4.15.m15.4.4.cmml" xref="S3.p4.15.m15.4.4"><root id="S3.p4.15.m15.4.4a.cmml" xref="S3.p4.15.m15.4.4"></root><apply id="S3.p4.15.m15.4.4.4.cmml" xref="S3.p4.15.m15.4.4.4"><ci id="S3.p4.15.m15.4.4.4.5.cmml" xref="S3.p4.15.m15.4.4.4.5">⋅</ci><apply id="S3.p4.15.m15.3.3.3.3.cmml" xref="S3.p4.15.m15.3.3.3.3"><times id="S3.p4.15.m15.3.3.3.3.2.cmml" xref="S3.p4.15.m15.3.3.3.3.2"></times><cn id="S3.p4.15.m15.3.3.3.3.3.cmml" type="integer" xref="S3.p4.15.m15.3.3.3.3.3">4</cn><apply id="S3.p4.15.m15.3.3.3.3.4.cmml" xref="S3.p4.15.m15.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.p4.15.m15.3.3.3.3.4.1.cmml" xref="S3.p4.15.m15.3.3.3.3.4">subscript</csymbol><ci id="S3.p4.15.m15.3.3.3.3.4.2.cmml" xref="S3.p4.15.m15.3.3.3.3.4.2">𝛼</ci><apply id="S3.p4.15.m15.3.3.3.3.4.3.cmml" xref="S3.p4.15.m15.3.3.3.3.4.3"><times id="S3.p4.15.m15.3.3.3.3.4.3.1.cmml" xref="S3.p4.15.m15.3.3.3.3.4.3.1"></times><ci id="S3.p4.15.m15.3.3.3.3.4.3.2.cmml" xref="S3.p4.15.m15.3.3.3.3.4.3.2">𝑏</ci><ci id="S3.p4.15.m15.3.3.3.3.4.3.3.cmml" xref="S3.p4.15.m15.3.3.3.3.4.3.3">𝑐</ci></apply></apply><apply id="S3.p4.15.m15.3.3.3.3.1.1.1.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1"><plus id="S3.p4.15.m15.3.3.3.3.1.1.1.1.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.1"></plus><cn id="S3.p4.15.m15.3.3.3.3.1.1.1.2.cmml" type="integer" xref="S3.p4.15.m15.3.3.3.3.1.1.1.2">1</cn><apply id="S3.p4.15.m15.3.3.3.3.1.1.1.3.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3"><times id="S3.p4.15.m15.3.3.3.3.1.1.1.3.1.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.1"></times><cn id="S3.p4.15.m15.3.3.3.3.1.1.1.3.2.cmml" type="integer" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.2">2</cn><apply id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.1.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.2.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.2">𝑛</ci><apply id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3"><times id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.1.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.1"></times><ci id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.2.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.2">𝑒</ci><ci id="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.3.cmml" xref="S3.p4.15.m15.3.3.3.3.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.p4.15.m15.4.4.4.4.2.cmml" xref="S3.p4.15.m15.4.4.4.4.1"><min id="S3.p4.15.m15.1.1.1.1.cmml" xref="S3.p4.15.m15.1.1.1.1"></min><ci id="S3.p4.15.m15.2.2.2.2.cmml" xref="S3.p4.15.m15.2.2.2.2">𝐶</ci><apply id="S3.p4.15.m15.4.4.4.4.1.1.1.cmml" xref="S3.p4.15.m15.4.4.4.4.1.1.1"><ci id="S3.p4.15.m15.4.4.4.4.1.1.1.1.cmml" xref="S3.p4.15.m15.4.4.4.4.1.1.1.1">⋅</ci><ci id="S3.p4.15.m15.4.4.4.4.1.1.1.2.cmml" xref="S3.p4.15.m15.4.4.4.4.1.1.1.2">𝑠</ci><ci id="S3.p4.15.m15.4.4.4.4.1.1.1.3.cmml" xref="S3.p4.15.m15.4.4.4.4.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.15.m15.4c">n_{b}^{*}=\sqrt{4\alpha_{bc}(1+2n_{ec})\cdot\min(C,s\cdot l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.15.m15.4d">italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = square-root start_ARG 4 italic_α start_POSTSUBSCRIPT italic_b italic_c end_POSTSUBSCRIPT ( 1 + 2 italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT ) ⋅ roman_min ( italic_C , italic_s ⋅ italic_l ) end_ARG</annotation></semantics></math>, where <math alttext="\alpha_{bc}=n_{b}/n_{c}" class="ltx_Math" display="inline" id="S3.p4.16.m16.1"><semantics id="S3.p4.16.m16.1a"><mrow id="S3.p4.16.m16.1.1" xref="S3.p4.16.m16.1.1.cmml"><msub id="S3.p4.16.m16.1.1.2" xref="S3.p4.16.m16.1.1.2.cmml"><mi id="S3.p4.16.m16.1.1.2.2" xref="S3.p4.16.m16.1.1.2.2.cmml">α</mi><mrow id="S3.p4.16.m16.1.1.2.3" xref="S3.p4.16.m16.1.1.2.3.cmml"><mi id="S3.p4.16.m16.1.1.2.3.2" xref="S3.p4.16.m16.1.1.2.3.2.cmml">b</mi><mo id="S3.p4.16.m16.1.1.2.3.1" xref="S3.p4.16.m16.1.1.2.3.1.cmml">⁢</mo><mi id="S3.p4.16.m16.1.1.2.3.3" xref="S3.p4.16.m16.1.1.2.3.3.cmml">c</mi></mrow></msub><mo id="S3.p4.16.m16.1.1.1" xref="S3.p4.16.m16.1.1.1.cmml">=</mo><mrow id="S3.p4.16.m16.1.1.3" xref="S3.p4.16.m16.1.1.3.cmml"><msub id="S3.p4.16.m16.1.1.3.2" xref="S3.p4.16.m16.1.1.3.2.cmml"><mi id="S3.p4.16.m16.1.1.3.2.2" xref="S3.p4.16.m16.1.1.3.2.2.cmml">n</mi><mi id="S3.p4.16.m16.1.1.3.2.3" xref="S3.p4.16.m16.1.1.3.2.3.cmml">b</mi></msub><mo id="S3.p4.16.m16.1.1.3.1" xref="S3.p4.16.m16.1.1.3.1.cmml">/</mo><msub id="S3.p4.16.m16.1.1.3.3" xref="S3.p4.16.m16.1.1.3.3.cmml"><mi id="S3.p4.16.m16.1.1.3.3.2" xref="S3.p4.16.m16.1.1.3.3.2.cmml">n</mi><mi id="S3.p4.16.m16.1.1.3.3.3" xref="S3.p4.16.m16.1.1.3.3.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.16.m16.1b"><apply id="S3.p4.16.m16.1.1.cmml" xref="S3.p4.16.m16.1.1"><eq id="S3.p4.16.m16.1.1.1.cmml" xref="S3.p4.16.m16.1.1.1"></eq><apply id="S3.p4.16.m16.1.1.2.cmml" xref="S3.p4.16.m16.1.1.2"><csymbol cd="ambiguous" id="S3.p4.16.m16.1.1.2.1.cmml" xref="S3.p4.16.m16.1.1.2">subscript</csymbol><ci id="S3.p4.16.m16.1.1.2.2.cmml" xref="S3.p4.16.m16.1.1.2.2">𝛼</ci><apply id="S3.p4.16.m16.1.1.2.3.cmml" xref="S3.p4.16.m16.1.1.2.3"><times id="S3.p4.16.m16.1.1.2.3.1.cmml" xref="S3.p4.16.m16.1.1.2.3.1"></times><ci id="S3.p4.16.m16.1.1.2.3.2.cmml" xref="S3.p4.16.m16.1.1.2.3.2">𝑏</ci><ci id="S3.p4.16.m16.1.1.2.3.3.cmml" xref="S3.p4.16.m16.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.p4.16.m16.1.1.3.cmml" xref="S3.p4.16.m16.1.1.3"><divide id="S3.p4.16.m16.1.1.3.1.cmml" xref="S3.p4.16.m16.1.1.3.1"></divide><apply id="S3.p4.16.m16.1.1.3.2.cmml" xref="S3.p4.16.m16.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.16.m16.1.1.3.2.1.cmml" xref="S3.p4.16.m16.1.1.3.2">subscript</csymbol><ci id="S3.p4.16.m16.1.1.3.2.2.cmml" xref="S3.p4.16.m16.1.1.3.2.2">𝑛</ci><ci id="S3.p4.16.m16.1.1.3.2.3.cmml" xref="S3.p4.16.m16.1.1.3.2.3">𝑏</ci></apply><apply id="S3.p4.16.m16.1.1.3.3.cmml" xref="S3.p4.16.m16.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.16.m16.1.1.3.3.1.cmml" xref="S3.p4.16.m16.1.1.3.3">subscript</csymbol><ci id="S3.p4.16.m16.1.1.3.3.2.cmml" xref="S3.p4.16.m16.1.1.3.3.2">𝑛</ci><ci id="S3.p4.16.m16.1.1.3.3.3.cmml" xref="S3.p4.16.m16.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.16.m16.1c">\alpha_{bc}=n_{b}/n_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.16.m16.1d">italic_α start_POSTSUBSCRIPT italic_b italic_c end_POSTSUBSCRIPT = italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="n_{ec}" class="ltx_Math" display="inline" id="S3.p4.17.m17.1"><semantics id="S3.p4.17.m17.1a"><msub id="S3.p4.17.m17.1.1" xref="S3.p4.17.m17.1.1.cmml"><mi id="S3.p4.17.m17.1.1.2" xref="S3.p4.17.m17.1.1.2.cmml">n</mi><mrow id="S3.p4.17.m17.1.1.3" xref="S3.p4.17.m17.1.1.3.cmml"><mi id="S3.p4.17.m17.1.1.3.2" xref="S3.p4.17.m17.1.1.3.2.cmml">e</mi><mo id="S3.p4.17.m17.1.1.3.1" xref="S3.p4.17.m17.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.17.m17.1.1.3.3" xref="S3.p4.17.m17.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.17.m17.1b"><apply id="S3.p4.17.m17.1.1.cmml" xref="S3.p4.17.m17.1.1"><csymbol cd="ambiguous" id="S3.p4.17.m17.1.1.1.cmml" xref="S3.p4.17.m17.1.1">subscript</csymbol><ci id="S3.p4.17.m17.1.1.2.cmml" xref="S3.p4.17.m17.1.1.2">𝑛</ci><apply id="S3.p4.17.m17.1.1.3.cmml" xref="S3.p4.17.m17.1.1.3"><times id="S3.p4.17.m17.1.1.3.1.cmml" xref="S3.p4.17.m17.1.1.3.1"></times><ci id="S3.p4.17.m17.1.1.3.2.cmml" xref="S3.p4.17.m17.1.1.3.2">𝑒</ci><ci id="S3.p4.17.m17.1.1.3.3.cmml" xref="S3.p4.17.m17.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.17.m17.1c">n_{ec}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.17.m17.1d">italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the number of neighboring chunks we look into). The memory complexity of our algorithm is then <math alttext="2r\sqrt{\alpha_{bc}(1+2n_{ec})\cdot\min(C,s\cdot l)}\cdot\max(C,s\cdot l)" class="ltx_Math" display="inline" id="S3.p4.18.m18.7"><semantics id="S3.p4.18.m18.7a"><mrow id="S3.p4.18.m18.7.7" xref="S3.p4.18.m18.7.7.cmml"><mrow id="S3.p4.18.m18.7.7.3" xref="S3.p4.18.m18.7.7.3.cmml"><mn id="S3.p4.18.m18.7.7.3.2" xref="S3.p4.18.m18.7.7.3.2.cmml">2</mn><mo id="S3.p4.18.m18.7.7.3.1" xref="S3.p4.18.m18.7.7.3.1.cmml">⁢</mo><mi id="S3.p4.18.m18.7.7.3.3" xref="S3.p4.18.m18.7.7.3.3.cmml">r</mi><mo id="S3.p4.18.m18.7.7.3.1a" xref="S3.p4.18.m18.7.7.3.1.cmml">⁢</mo><msqrt id="S3.p4.18.m18.4.4" xref="S3.p4.18.m18.4.4.cmml"><mrow id="S3.p4.18.m18.4.4.4" xref="S3.p4.18.m18.4.4.4.cmml"><mrow id="S3.p4.18.m18.3.3.3.3" xref="S3.p4.18.m18.3.3.3.3.cmml"><msub id="S3.p4.18.m18.3.3.3.3.3" xref="S3.p4.18.m18.3.3.3.3.3.cmml"><mi id="S3.p4.18.m18.3.3.3.3.3.2" xref="S3.p4.18.m18.3.3.3.3.3.2.cmml">α</mi><mrow id="S3.p4.18.m18.3.3.3.3.3.3" xref="S3.p4.18.m18.3.3.3.3.3.3.cmml"><mi id="S3.p4.18.m18.3.3.3.3.3.3.2" xref="S3.p4.18.m18.3.3.3.3.3.3.2.cmml">b</mi><mo id="S3.p4.18.m18.3.3.3.3.3.3.1" xref="S3.p4.18.m18.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.p4.18.m18.3.3.3.3.3.3.3" xref="S3.p4.18.m18.3.3.3.3.3.3.3.cmml">c</mi></mrow></msub><mo id="S3.p4.18.m18.3.3.3.3.2" xref="S3.p4.18.m18.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.p4.18.m18.3.3.3.3.1.1" xref="S3.p4.18.m18.3.3.3.3.1.1.1.cmml"><mo id="S3.p4.18.m18.3.3.3.3.1.1.2" stretchy="false" xref="S3.p4.18.m18.3.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.p4.18.m18.3.3.3.3.1.1.1" xref="S3.p4.18.m18.3.3.3.3.1.1.1.cmml"><mn id="S3.p4.18.m18.3.3.3.3.1.1.1.2" xref="S3.p4.18.m18.3.3.3.3.1.1.1.2.cmml">1</mn><mo id="S3.p4.18.m18.3.3.3.3.1.1.1.1" xref="S3.p4.18.m18.3.3.3.3.1.1.1.1.cmml">+</mo><mrow id="S3.p4.18.m18.3.3.3.3.1.1.1.3" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.cmml"><mn id="S3.p4.18.m18.3.3.3.3.1.1.1.3.2" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.2.cmml">2</mn><mo id="S3.p4.18.m18.3.3.3.3.1.1.1.3.1" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><msub id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.cmml"><mi id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.2" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.2.cmml">n</mi><mrow id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.cmml"><mi id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.2" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.2.cmml">e</mi><mo id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.1" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.3" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.3.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S3.p4.18.m18.3.3.3.3.1.1.3" rspace="0.055em" stretchy="false" xref="S3.p4.18.m18.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.18.m18.4.4.4.5" rspace="0.222em" xref="S3.p4.18.m18.4.4.4.5.cmml">⋅</mo><mrow id="S3.p4.18.m18.4.4.4.4.1" xref="S3.p4.18.m18.4.4.4.4.2.cmml"><mi id="S3.p4.18.m18.1.1.1.1" xref="S3.p4.18.m18.1.1.1.1.cmml">min</mi><mo id="S3.p4.18.m18.4.4.4.4.1a" xref="S3.p4.18.m18.4.4.4.4.2.cmml">⁡</mo><mrow id="S3.p4.18.m18.4.4.4.4.1.1" xref="S3.p4.18.m18.4.4.4.4.2.cmml"><mo id="S3.p4.18.m18.4.4.4.4.1.1.2" stretchy="false" xref="S3.p4.18.m18.4.4.4.4.2.cmml">(</mo><mi id="S3.p4.18.m18.2.2.2.2" xref="S3.p4.18.m18.2.2.2.2.cmml">C</mi><mo id="S3.p4.18.m18.4.4.4.4.1.1.3" xref="S3.p4.18.m18.4.4.4.4.2.cmml">,</mo><mrow id="S3.p4.18.m18.4.4.4.4.1.1.1" xref="S3.p4.18.m18.4.4.4.4.1.1.1.cmml"><mi id="S3.p4.18.m18.4.4.4.4.1.1.1.2" xref="S3.p4.18.m18.4.4.4.4.1.1.1.2.cmml">s</mi><mo id="S3.p4.18.m18.4.4.4.4.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p4.18.m18.4.4.4.4.1.1.1.1.cmml">⋅</mo><mi id="S3.p4.18.m18.4.4.4.4.1.1.1.3" xref="S3.p4.18.m18.4.4.4.4.1.1.1.3.cmml">l</mi></mrow><mo id="S3.p4.18.m18.4.4.4.4.1.1.4" stretchy="false" xref="S3.p4.18.m18.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow></msqrt></mrow><mo id="S3.p4.18.m18.7.7.2" lspace="0.222em" rspace="0.222em" xref="S3.p4.18.m18.7.7.2.cmml">⋅</mo><mrow id="S3.p4.18.m18.7.7.1.1" xref="S3.p4.18.m18.7.7.1.2.cmml"><mi id="S3.p4.18.m18.5.5" xref="S3.p4.18.m18.5.5.cmml">max</mi><mo id="S3.p4.18.m18.7.7.1.1a" xref="S3.p4.18.m18.7.7.1.2.cmml">⁡</mo><mrow id="S3.p4.18.m18.7.7.1.1.1" xref="S3.p4.18.m18.7.7.1.2.cmml"><mo id="S3.p4.18.m18.7.7.1.1.1.2" stretchy="false" xref="S3.p4.18.m18.7.7.1.2.cmml">(</mo><mi id="S3.p4.18.m18.6.6" xref="S3.p4.18.m18.6.6.cmml">C</mi><mo id="S3.p4.18.m18.7.7.1.1.1.3" xref="S3.p4.18.m18.7.7.1.2.cmml">,</mo><mrow id="S3.p4.18.m18.7.7.1.1.1.1" xref="S3.p4.18.m18.7.7.1.1.1.1.cmml"><mi id="S3.p4.18.m18.7.7.1.1.1.1.2" xref="S3.p4.18.m18.7.7.1.1.1.1.2.cmml">s</mi><mo id="S3.p4.18.m18.7.7.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p4.18.m18.7.7.1.1.1.1.1.cmml">⋅</mo><mi id="S3.p4.18.m18.7.7.1.1.1.1.3" xref="S3.p4.18.m18.7.7.1.1.1.1.3.cmml">l</mi></mrow><mo id="S3.p4.18.m18.7.7.1.1.1.4" stretchy="false" xref="S3.p4.18.m18.7.7.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.18.m18.7b"><apply id="S3.p4.18.m18.7.7.cmml" xref="S3.p4.18.m18.7.7"><ci id="S3.p4.18.m18.7.7.2.cmml" xref="S3.p4.18.m18.7.7.2">⋅</ci><apply id="S3.p4.18.m18.7.7.3.cmml" xref="S3.p4.18.m18.7.7.3"><times id="S3.p4.18.m18.7.7.3.1.cmml" xref="S3.p4.18.m18.7.7.3.1"></times><cn id="S3.p4.18.m18.7.7.3.2.cmml" type="integer" xref="S3.p4.18.m18.7.7.3.2">2</cn><ci id="S3.p4.18.m18.7.7.3.3.cmml" xref="S3.p4.18.m18.7.7.3.3">𝑟</ci><apply id="S3.p4.18.m18.4.4.cmml" xref="S3.p4.18.m18.4.4"><root id="S3.p4.18.m18.4.4a.cmml" xref="S3.p4.18.m18.4.4"></root><apply id="S3.p4.18.m18.4.4.4.cmml" xref="S3.p4.18.m18.4.4.4"><ci id="S3.p4.18.m18.4.4.4.5.cmml" xref="S3.p4.18.m18.4.4.4.5">⋅</ci><apply id="S3.p4.18.m18.3.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3"><times id="S3.p4.18.m18.3.3.3.3.2.cmml" xref="S3.p4.18.m18.3.3.3.3.2"></times><apply id="S3.p4.18.m18.3.3.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p4.18.m18.3.3.3.3.3.1.cmml" xref="S3.p4.18.m18.3.3.3.3.3">subscript</csymbol><ci id="S3.p4.18.m18.3.3.3.3.3.2.cmml" xref="S3.p4.18.m18.3.3.3.3.3.2">𝛼</ci><apply id="S3.p4.18.m18.3.3.3.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.3.3"><times id="S3.p4.18.m18.3.3.3.3.3.3.1.cmml" xref="S3.p4.18.m18.3.3.3.3.3.3.1"></times><ci id="S3.p4.18.m18.3.3.3.3.3.3.2.cmml" xref="S3.p4.18.m18.3.3.3.3.3.3.2">𝑏</ci><ci id="S3.p4.18.m18.3.3.3.3.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.3.3.3">𝑐</ci></apply></apply><apply id="S3.p4.18.m18.3.3.3.3.1.1.1.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1"><plus id="S3.p4.18.m18.3.3.3.3.1.1.1.1.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.1"></plus><cn id="S3.p4.18.m18.3.3.3.3.1.1.1.2.cmml" type="integer" xref="S3.p4.18.m18.3.3.3.3.1.1.1.2">1</cn><apply id="S3.p4.18.m18.3.3.3.3.1.1.1.3.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3"><times id="S3.p4.18.m18.3.3.3.3.1.1.1.3.1.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.1"></times><cn id="S3.p4.18.m18.3.3.3.3.1.1.1.3.2.cmml" type="integer" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.2">2</cn><apply id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.1.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.2.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.2">𝑛</ci><apply id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3"><times id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.1.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.1"></times><ci id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.2.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.2">𝑒</ci><ci id="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.3.cmml" xref="S3.p4.18.m18.3.3.3.3.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.p4.18.m18.4.4.4.4.2.cmml" xref="S3.p4.18.m18.4.4.4.4.1"><min id="S3.p4.18.m18.1.1.1.1.cmml" xref="S3.p4.18.m18.1.1.1.1"></min><ci id="S3.p4.18.m18.2.2.2.2.cmml" xref="S3.p4.18.m18.2.2.2.2">𝐶</ci><apply id="S3.p4.18.m18.4.4.4.4.1.1.1.cmml" xref="S3.p4.18.m18.4.4.4.4.1.1.1"><ci id="S3.p4.18.m18.4.4.4.4.1.1.1.1.cmml" xref="S3.p4.18.m18.4.4.4.4.1.1.1.1">⋅</ci><ci id="S3.p4.18.m18.4.4.4.4.1.1.1.2.cmml" xref="S3.p4.18.m18.4.4.4.4.1.1.1.2">𝑠</ci><ci id="S3.p4.18.m18.4.4.4.4.1.1.1.3.cmml" xref="S3.p4.18.m18.4.4.4.4.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.p4.18.m18.7.7.1.2.cmml" xref="S3.p4.18.m18.7.7.1.1"><max id="S3.p4.18.m18.5.5.cmml" xref="S3.p4.18.m18.5.5"></max><ci id="S3.p4.18.m18.6.6.cmml" xref="S3.p4.18.m18.6.6">𝐶</ci><apply id="S3.p4.18.m18.7.7.1.1.1.1.cmml" xref="S3.p4.18.m18.7.7.1.1.1.1"><ci id="S3.p4.18.m18.7.7.1.1.1.1.1.cmml" xref="S3.p4.18.m18.7.7.1.1.1.1.1">⋅</ci><ci id="S3.p4.18.m18.7.7.1.1.1.1.2.cmml" xref="S3.p4.18.m18.7.7.1.1.1.1.2">𝑠</ci><ci id="S3.p4.18.m18.7.7.1.1.1.1.3.cmml" xref="S3.p4.18.m18.7.7.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.18.m18.7c">2r\sqrt{\alpha_{bc}(1+2n_{ec})\cdot\min(C,s\cdot l)}\cdot\max(C,s\cdot l)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.18.m18.7d">2 italic_r square-root start_ARG italic_α start_POSTSUBSCRIPT italic_b italic_c end_POSTSUBSCRIPT ( 1 + 2 italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT ) ⋅ roman_min ( italic_C , italic_s ⋅ italic_l ) end_ARG ⋅ roman_max ( italic_C , italic_s ⋅ italic_l )</annotation></semantics></math>. This is <math alttext="\sqrt{\min(C,s\cdot l)}/(2r\sqrt{\alpha_{bc}(1+2n_{ec})})" class="ltx_Math" display="inline" id="S3.p4.19.m19.5"><semantics id="S3.p4.19.m19.5a"><mrow id="S3.p4.19.m19.5.5" xref="S3.p4.19.m19.5.5.cmml"><msqrt id="S3.p4.19.m19.3.3" xref="S3.p4.19.m19.3.3.cmml"><mrow id="S3.p4.19.m19.3.3.3.3" xref="S3.p4.19.m19.3.3.3.4.cmml"><mi id="S3.p4.19.m19.1.1.1.1" xref="S3.p4.19.m19.1.1.1.1.cmml">min</mi><mo id="S3.p4.19.m19.3.3.3.3a" xref="S3.p4.19.m19.3.3.3.4.cmml">⁡</mo><mrow id="S3.p4.19.m19.3.3.3.3.1" xref="S3.p4.19.m19.3.3.3.4.cmml"><mo id="S3.p4.19.m19.3.3.3.3.1.2" stretchy="false" xref="S3.p4.19.m19.3.3.3.4.cmml">(</mo><mi id="S3.p4.19.m19.2.2.2.2" xref="S3.p4.19.m19.2.2.2.2.cmml">C</mi><mo id="S3.p4.19.m19.3.3.3.3.1.3" xref="S3.p4.19.m19.3.3.3.4.cmml">,</mo><mrow id="S3.p4.19.m19.3.3.3.3.1.1" xref="S3.p4.19.m19.3.3.3.3.1.1.cmml"><mi id="S3.p4.19.m19.3.3.3.3.1.1.2" xref="S3.p4.19.m19.3.3.3.3.1.1.2.cmml">s</mi><mo id="S3.p4.19.m19.3.3.3.3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p4.19.m19.3.3.3.3.1.1.1.cmml">⋅</mo><mi id="S3.p4.19.m19.3.3.3.3.1.1.3" xref="S3.p4.19.m19.3.3.3.3.1.1.3.cmml">l</mi></mrow><mo id="S3.p4.19.m19.3.3.3.3.1.4" stretchy="false" xref="S3.p4.19.m19.3.3.3.4.cmml">)</mo></mrow></mrow></msqrt><mo id="S3.p4.19.m19.5.5.2" xref="S3.p4.19.m19.5.5.2.cmml">/</mo><mrow id="S3.p4.19.m19.5.5.1.1" xref="S3.p4.19.m19.5.5.1.1.1.cmml"><mo id="S3.p4.19.m19.5.5.1.1.2" stretchy="false" xref="S3.p4.19.m19.5.5.1.1.1.cmml">(</mo><mrow id="S3.p4.19.m19.5.5.1.1.1" xref="S3.p4.19.m19.5.5.1.1.1.cmml"><mn id="S3.p4.19.m19.5.5.1.1.1.2" xref="S3.p4.19.m19.5.5.1.1.1.2.cmml">2</mn><mo id="S3.p4.19.m19.5.5.1.1.1.1" xref="S3.p4.19.m19.5.5.1.1.1.1.cmml">⁢</mo><mi id="S3.p4.19.m19.5.5.1.1.1.3" xref="S3.p4.19.m19.5.5.1.1.1.3.cmml">r</mi><mo id="S3.p4.19.m19.5.5.1.1.1.1a" xref="S3.p4.19.m19.5.5.1.1.1.1.cmml">⁢</mo><msqrt id="S3.p4.19.m19.4.4" xref="S3.p4.19.m19.4.4.cmml"><mrow id="S3.p4.19.m19.4.4.1" xref="S3.p4.19.m19.4.4.1.cmml"><msub id="S3.p4.19.m19.4.4.1.3" xref="S3.p4.19.m19.4.4.1.3.cmml"><mi id="S3.p4.19.m19.4.4.1.3.2" xref="S3.p4.19.m19.4.4.1.3.2.cmml">α</mi><mrow id="S3.p4.19.m19.4.4.1.3.3" xref="S3.p4.19.m19.4.4.1.3.3.cmml"><mi id="S3.p4.19.m19.4.4.1.3.3.2" xref="S3.p4.19.m19.4.4.1.3.3.2.cmml">b</mi><mo id="S3.p4.19.m19.4.4.1.3.3.1" xref="S3.p4.19.m19.4.4.1.3.3.1.cmml">⁢</mo><mi id="S3.p4.19.m19.4.4.1.3.3.3" xref="S3.p4.19.m19.4.4.1.3.3.3.cmml">c</mi></mrow></msub><mo id="S3.p4.19.m19.4.4.1.2" xref="S3.p4.19.m19.4.4.1.2.cmml">⁢</mo><mrow id="S3.p4.19.m19.4.4.1.1.1" xref="S3.p4.19.m19.4.4.1.1.1.1.cmml"><mo id="S3.p4.19.m19.4.4.1.1.1.2" stretchy="false" xref="S3.p4.19.m19.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.p4.19.m19.4.4.1.1.1.1" xref="S3.p4.19.m19.4.4.1.1.1.1.cmml"><mn id="S3.p4.19.m19.4.4.1.1.1.1.2" xref="S3.p4.19.m19.4.4.1.1.1.1.2.cmml">1</mn><mo id="S3.p4.19.m19.4.4.1.1.1.1.1" xref="S3.p4.19.m19.4.4.1.1.1.1.1.cmml">+</mo><mrow id="S3.p4.19.m19.4.4.1.1.1.1.3" xref="S3.p4.19.m19.4.4.1.1.1.1.3.cmml"><mn id="S3.p4.19.m19.4.4.1.1.1.1.3.2" xref="S3.p4.19.m19.4.4.1.1.1.1.3.2.cmml">2</mn><mo id="S3.p4.19.m19.4.4.1.1.1.1.3.1" xref="S3.p4.19.m19.4.4.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.p4.19.m19.4.4.1.1.1.1.3.3" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.cmml"><mi id="S3.p4.19.m19.4.4.1.1.1.1.3.3.2" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.2.cmml">n</mi><mrow id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.cmml"><mi id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.2" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.2.cmml">e</mi><mo id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.1" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.3" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.3.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S3.p4.19.m19.4.4.1.1.1.3" stretchy="false" xref="S3.p4.19.m19.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></msqrt></mrow><mo id="S3.p4.19.m19.5.5.1.1.3" stretchy="false" xref="S3.p4.19.m19.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.19.m19.5b"><apply id="S3.p4.19.m19.5.5.cmml" xref="S3.p4.19.m19.5.5"><divide id="S3.p4.19.m19.5.5.2.cmml" xref="S3.p4.19.m19.5.5.2"></divide><apply id="S3.p4.19.m19.3.3.cmml" xref="S3.p4.19.m19.3.3"><root id="S3.p4.19.m19.3.3a.cmml" xref="S3.p4.19.m19.3.3"></root><apply id="S3.p4.19.m19.3.3.3.4.cmml" xref="S3.p4.19.m19.3.3.3.3"><min id="S3.p4.19.m19.1.1.1.1.cmml" xref="S3.p4.19.m19.1.1.1.1"></min><ci id="S3.p4.19.m19.2.2.2.2.cmml" xref="S3.p4.19.m19.2.2.2.2">𝐶</ci><apply id="S3.p4.19.m19.3.3.3.3.1.1.cmml" xref="S3.p4.19.m19.3.3.3.3.1.1"><ci id="S3.p4.19.m19.3.3.3.3.1.1.1.cmml" xref="S3.p4.19.m19.3.3.3.3.1.1.1">⋅</ci><ci id="S3.p4.19.m19.3.3.3.3.1.1.2.cmml" xref="S3.p4.19.m19.3.3.3.3.1.1.2">𝑠</ci><ci id="S3.p4.19.m19.3.3.3.3.1.1.3.cmml" xref="S3.p4.19.m19.3.3.3.3.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.p4.19.m19.5.5.1.1.1.cmml" xref="S3.p4.19.m19.5.5.1.1"><times id="S3.p4.19.m19.5.5.1.1.1.1.cmml" xref="S3.p4.19.m19.5.5.1.1.1.1"></times><cn id="S3.p4.19.m19.5.5.1.1.1.2.cmml" type="integer" xref="S3.p4.19.m19.5.5.1.1.1.2">2</cn><ci id="S3.p4.19.m19.5.5.1.1.1.3.cmml" xref="S3.p4.19.m19.5.5.1.1.1.3">𝑟</ci><apply id="S3.p4.19.m19.4.4.cmml" xref="S3.p4.19.m19.4.4"><root id="S3.p4.19.m19.4.4a.cmml" xref="S3.p4.19.m19.4.4"></root><apply id="S3.p4.19.m19.4.4.1.cmml" xref="S3.p4.19.m19.4.4.1"><times id="S3.p4.19.m19.4.4.1.2.cmml" xref="S3.p4.19.m19.4.4.1.2"></times><apply id="S3.p4.19.m19.4.4.1.3.cmml" xref="S3.p4.19.m19.4.4.1.3"><csymbol cd="ambiguous" id="S3.p4.19.m19.4.4.1.3.1.cmml" xref="S3.p4.19.m19.4.4.1.3">subscript</csymbol><ci id="S3.p4.19.m19.4.4.1.3.2.cmml" xref="S3.p4.19.m19.4.4.1.3.2">𝛼</ci><apply id="S3.p4.19.m19.4.4.1.3.3.cmml" xref="S3.p4.19.m19.4.4.1.3.3"><times id="S3.p4.19.m19.4.4.1.3.3.1.cmml" xref="S3.p4.19.m19.4.4.1.3.3.1"></times><ci id="S3.p4.19.m19.4.4.1.3.3.2.cmml" xref="S3.p4.19.m19.4.4.1.3.3.2">𝑏</ci><ci id="S3.p4.19.m19.4.4.1.3.3.3.cmml" xref="S3.p4.19.m19.4.4.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.p4.19.m19.4.4.1.1.1.1.cmml" xref="S3.p4.19.m19.4.4.1.1.1"><plus id="S3.p4.19.m19.4.4.1.1.1.1.1.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.1"></plus><cn id="S3.p4.19.m19.4.4.1.1.1.1.2.cmml" type="integer" xref="S3.p4.19.m19.4.4.1.1.1.1.2">1</cn><apply id="S3.p4.19.m19.4.4.1.1.1.1.3.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3"><times id="S3.p4.19.m19.4.4.1.1.1.1.3.1.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.1"></times><cn id="S3.p4.19.m19.4.4.1.1.1.1.3.2.cmml" type="integer" xref="S3.p4.19.m19.4.4.1.1.1.1.3.2">2</cn><apply id="S3.p4.19.m19.4.4.1.1.1.1.3.3.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.19.m19.4.4.1.1.1.1.3.3.1.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="S3.p4.19.m19.4.4.1.1.1.1.3.3.2.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.2">𝑛</ci><apply id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3"><times id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.1.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.1"></times><ci id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.2.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.2">𝑒</ci><ci id="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.3.cmml" xref="S3.p4.19.m19.4.4.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.19.m19.5c">\sqrt{\min(C,s\cdot l)}/(2r\sqrt{\alpha_{bc}(1+2n_{ec})})</annotation><annotation encoding="application/x-llamapun" id="S3.p4.19.m19.5d">square-root start_ARG roman_min ( italic_C , italic_s ⋅ italic_l ) end_ARG / ( 2 italic_r square-root start_ARG italic_α start_POSTSUBSCRIPT italic_b italic_c end_POSTSUBSCRIPT ( 1 + 2 italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT ) end_ARG )</annotation></semantics></math> times smaller than the memory size required for the full Cross-Entropy loss. The extended derivation is available in our GitHub repository<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#footnote2" title="footnote 2 ‣ Model and Baselines ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Reduced Cross-Entropy Loss</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2" style="font-size:90%;">Input:</span><span class="ltx_text" id="alg1.l1.3" style="font-size:90%;"> </span><math alttext="\hat{Z}\in\mathbb{N}^{s\cdot l}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mover accent="true" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.2.2" mathsize="90%" xref="alg1.l1.m1.1.1.2.2.cmml">Z</mi><mo id="alg1.l1.m1.1.1.2.1" mathsize="90%" xref="alg1.l1.m1.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l1.m1.1.1.1" mathsize="90%" xref="alg1.l1.m1.1.1.1.cmml">∈</mo><msup id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" mathsize="90%" xref="alg1.l1.m1.1.1.3.2.cmml">ℕ</mi><mrow id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml"><mi id="alg1.l1.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l1.m1.1.1.3.3.2.cmml">s</mi><mo id="alg1.l1.m1.1.1.3.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l1.m1.1.1.3.3.1.cmml">⋅</mo><mi id="alg1.l1.m1.1.1.3.3.3" mathsize="90%" xref="alg1.l1.m1.1.1.3.3.3.cmml">l</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><in id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></in><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><ci id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2.1">^</ci><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝑍</ci></apply><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3">superscript</csymbol><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">ℕ</ci><apply id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3"><ci id="alg1.l1.m1.1.1.3.3.1.cmml" xref="alg1.l1.m1.1.1.3.3.1">⋅</ci><ci id="alg1.l1.m1.1.1.3.3.2.cmml" xref="alg1.l1.m1.1.1.3.3.2">𝑠</ci><ci id="alg1.l1.m1.1.1.3.3.3.cmml" xref="alg1.l1.m1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\hat{Z}\in\mathbb{N}^{s\cdot l}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">over^ start_ARG italic_Z end_ARG ∈ blackboard_N start_POSTSUPERSCRIPT italic_s ⋅ italic_l end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.4" style="font-size:90%;">, </span><math alttext="X\in\mathbb{R}^{s\cdot l\times d}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" mathsize="90%" xref="alg1.l1.m2.1.1.2.cmml">X</mi><mo id="alg1.l1.m2.1.1.1" mathsize="90%" xref="alg1.l1.m2.1.1.1.cmml">∈</mo><msup id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml"><mi id="alg1.l1.m2.1.1.3.2" mathsize="90%" xref="alg1.l1.m2.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l1.m2.1.1.3.3" xref="alg1.l1.m2.1.1.3.3.cmml"><mrow id="alg1.l1.m2.1.1.3.3.2" xref="alg1.l1.m2.1.1.3.3.2.cmml"><mi id="alg1.l1.m2.1.1.3.3.2.2" mathsize="90%" xref="alg1.l1.m2.1.1.3.3.2.2.cmml">s</mi><mo id="alg1.l1.m2.1.1.3.3.2.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l1.m2.1.1.3.3.2.1.cmml">⋅</mo><mi id="alg1.l1.m2.1.1.3.3.2.3" mathsize="90%" xref="alg1.l1.m2.1.1.3.3.2.3.cmml">l</mi></mrow><mo id="alg1.l1.m2.1.1.3.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l1.m2.1.1.3.3.1.cmml">×</mo><mi id="alg1.l1.m2.1.1.3.3.3" mathsize="90%" xref="alg1.l1.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><in id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></in><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑋</ci><apply id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.3">superscript</csymbol><ci id="alg1.l1.m2.1.1.3.2.cmml" xref="alg1.l1.m2.1.1.3.2">ℝ</ci><apply id="alg1.l1.m2.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.3.3"><times id="alg1.l1.m2.1.1.3.3.1.cmml" xref="alg1.l1.m2.1.1.3.3.1"></times><apply id="alg1.l1.m2.1.1.3.3.2.cmml" xref="alg1.l1.m2.1.1.3.3.2"><ci id="alg1.l1.m2.1.1.3.3.2.1.cmml" xref="alg1.l1.m2.1.1.3.3.2.1">⋅</ci><ci id="alg1.l1.m2.1.1.3.3.2.2.cmml" xref="alg1.l1.m2.1.1.3.3.2.2">𝑠</ci><ci id="alg1.l1.m2.1.1.3.3.2.3.cmml" xref="alg1.l1.m2.1.1.3.3.2.3">𝑙</ci></apply><ci id="alg1.l1.m2.1.1.3.3.3.cmml" xref="alg1.l1.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">X\in\mathbb{R}^{s\cdot l\times d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_s ⋅ italic_l × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.5" style="font-size:90%;">, </span><math alttext="Y\in\mathbb{R}^{C\times d}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" mathsize="90%" xref="alg1.l1.m3.1.1.2.cmml">Y</mi><mo id="alg1.l1.m3.1.1.1" mathsize="90%" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><msup id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.3.2" mathsize="90%" xref="alg1.l1.m3.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l1.m3.1.1.3.3" xref="alg1.l1.m3.1.1.3.3.cmml"><mi id="alg1.l1.m3.1.1.3.3.2" mathsize="90%" xref="alg1.l1.m3.1.1.3.3.2.cmml">C</mi><mo id="alg1.l1.m3.1.1.3.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l1.m3.1.1.3.3.1.cmml">×</mo><mi id="alg1.l1.m3.1.1.3.3.3" mathsize="90%" xref="alg1.l1.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑌</ci><apply id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3">superscript</csymbol><ci id="alg1.l1.m3.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.3.2">ℝ</ci><apply id="alg1.l1.m3.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.3.3"><times id="alg1.l1.m3.1.1.3.3.1.cmml" xref="alg1.l1.m3.1.1.3.3.1"></times><ci id="alg1.l1.m3.1.1.3.3.2.cmml" xref="alg1.l1.m3.1.1.3.3.2">𝐶</ci><ci id="alg1.l1.m3.1.1.3.3.3.cmml" xref="alg1.l1.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">Y\in\mathbb{R}^{C\times d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_Y ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.6" style="font-size:90%;">, </span><math alttext="n_{b}" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" mathsize="90%" xref="alg1.l1.m4.1.1.2.cmml">n</mi><mi id="alg1.l1.m4.1.1.3" mathsize="90%" xref="alg1.l1.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑛</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">n_{b}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.7" style="font-size:90%;">, </span><math alttext="n_{c}" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" mathsize="90%" xref="alg1.l1.m5.1.1.2.cmml">n</mi><mi id="alg1.l1.m5.1.1.3" mathsize="90%" xref="alg1.l1.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑛</ci><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.8" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><math alttext="B=\text{randn}_{\scriptstyle{\mathcal{N}(0,1)}}(n_{b},d)=\{b_{k}\}_{k=1}^{n_{b}}" class="ltx_Math" display="inline" id="alg1.l2.m1.5"><semantics id="alg1.l2.m1.5a"><mrow id="alg1.l2.m1.5.5" xref="alg1.l2.m1.5.5.cmml"><mi id="alg1.l2.m1.5.5.4" mathsize="90%" xref="alg1.l2.m1.5.5.4.cmml">B</mi><mo id="alg1.l2.m1.5.5.5" mathsize="90%" xref="alg1.l2.m1.5.5.5.cmml">=</mo><mrow id="alg1.l2.m1.4.4.1" xref="alg1.l2.m1.4.4.1.cmml"><msub id="alg1.l2.m1.4.4.1.3" xref="alg1.l2.m1.4.4.1.3.cmml"><mtext id="alg1.l2.m1.4.4.1.3.2" mathsize="90%" xref="alg1.l2.m1.4.4.1.3.2a.cmml">randn</mtext><mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.2.2.2.4" mathsize="90%" xref="alg1.l2.m1.2.2.2.4.cmml">𝒩</mi><mo id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l2.m1.2.2.2.5.2" xref="alg1.l2.m1.2.2.2.5.1.cmml"><mo id="alg1.l2.m1.2.2.2.5.2.1" maxsize="90%" minsize="90%" xref="alg1.l2.m1.2.2.2.5.1.cmml">(</mo><mn id="alg1.l2.m1.1.1.1.1" mathsize="90%" xref="alg1.l2.m1.1.1.1.1.cmml">0</mn><mo id="alg1.l2.m1.2.2.2.5.2.2" mathsize="90%" xref="alg1.l2.m1.2.2.2.5.1.cmml">,</mo><mn id="alg1.l2.m1.2.2.2.2" mathsize="90%" xref="alg1.l2.m1.2.2.2.2.cmml">1</mn><mo id="alg1.l2.m1.2.2.2.5.2.3" maxsize="90%" minsize="90%" xref="alg1.l2.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="alg1.l2.m1.4.4.1.2" xref="alg1.l2.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l2.m1.4.4.1.1.1" xref="alg1.l2.m1.4.4.1.1.2.cmml"><mo id="alg1.l2.m1.4.4.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l2.m1.4.4.1.1.2.cmml">(</mo><msub id="alg1.l2.m1.4.4.1.1.1.1" xref="alg1.l2.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l2.m1.4.4.1.1.1.1.2" mathsize="90%" xref="alg1.l2.m1.4.4.1.1.1.1.2.cmml">n</mi><mi id="alg1.l2.m1.4.4.1.1.1.1.3" mathsize="90%" xref="alg1.l2.m1.4.4.1.1.1.1.3.cmml">b</mi></msub><mo id="alg1.l2.m1.4.4.1.1.1.3" mathsize="90%" xref="alg1.l2.m1.4.4.1.1.2.cmml">,</mo><mi id="alg1.l2.m1.3.3" mathsize="90%" xref="alg1.l2.m1.3.3.cmml">d</mi><mo id="alg1.l2.m1.4.4.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l2.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg1.l2.m1.5.5.6" mathsize="90%" xref="alg1.l2.m1.5.5.6.cmml">=</mo><msubsup id="alg1.l2.m1.5.5.2" xref="alg1.l2.m1.5.5.2.cmml"><mrow id="alg1.l2.m1.5.5.2.1.1.1" xref="alg1.l2.m1.5.5.2.1.1.2.cmml"><mo id="alg1.l2.m1.5.5.2.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l2.m1.5.5.2.1.1.2.cmml">{</mo><msub id="alg1.l2.m1.5.5.2.1.1.1.1" xref="alg1.l2.m1.5.5.2.1.1.1.1.cmml"><mi id="alg1.l2.m1.5.5.2.1.1.1.1.2" mathsize="90%" xref="alg1.l2.m1.5.5.2.1.1.1.1.2.cmml">b</mi><mi id="alg1.l2.m1.5.5.2.1.1.1.1.3" mathsize="90%" xref="alg1.l2.m1.5.5.2.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l2.m1.5.5.2.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l2.m1.5.5.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m1.5.5.2.1.3" xref="alg1.l2.m1.5.5.2.1.3.cmml"><mi id="alg1.l2.m1.5.5.2.1.3.2" mathsize="90%" xref="alg1.l2.m1.5.5.2.1.3.2.cmml">k</mi><mo id="alg1.l2.m1.5.5.2.1.3.1" mathsize="90%" xref="alg1.l2.m1.5.5.2.1.3.1.cmml">=</mo><mn id="alg1.l2.m1.5.5.2.1.3.3" mathsize="90%" xref="alg1.l2.m1.5.5.2.1.3.3.cmml">1</mn></mrow><msub id="alg1.l2.m1.5.5.2.3" xref="alg1.l2.m1.5.5.2.3.cmml"><mi id="alg1.l2.m1.5.5.2.3.2" mathsize="90%" xref="alg1.l2.m1.5.5.2.3.2.cmml">n</mi><mi id="alg1.l2.m1.5.5.2.3.3" mathsize="90%" xref="alg1.l2.m1.5.5.2.3.3.cmml">b</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.5b"><apply id="alg1.l2.m1.5.5.cmml" xref="alg1.l2.m1.5.5"><and id="alg1.l2.m1.5.5a.cmml" xref="alg1.l2.m1.5.5"></and><apply id="alg1.l2.m1.5.5b.cmml" xref="alg1.l2.m1.5.5"><eq id="alg1.l2.m1.5.5.5.cmml" xref="alg1.l2.m1.5.5.5"></eq><ci id="alg1.l2.m1.5.5.4.cmml" xref="alg1.l2.m1.5.5.4">𝐵</ci><apply id="alg1.l2.m1.4.4.1.cmml" xref="alg1.l2.m1.4.4.1"><times id="alg1.l2.m1.4.4.1.2.cmml" xref="alg1.l2.m1.4.4.1.2"></times><apply id="alg1.l2.m1.4.4.1.3.cmml" xref="alg1.l2.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.4.4.1.3.1.cmml" xref="alg1.l2.m1.4.4.1.3">subscript</csymbol><ci id="alg1.l2.m1.4.4.1.3.2a.cmml" xref="alg1.l2.m1.4.4.1.3.2"><mtext id="alg1.l2.m1.4.4.1.3.2.cmml" mathsize="90%" xref="alg1.l2.m1.4.4.1.3.2">randn</mtext></ci><apply id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"><times id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.3"></times><ci id="alg1.l2.m1.2.2.2.4.cmml" xref="alg1.l2.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg1.l2.m1.2.2.2.5.1.cmml" xref="alg1.l2.m1.2.2.2.5.2"><cn id="alg1.l2.m1.1.1.1.1.cmml" type="integer" xref="alg1.l2.m1.1.1.1.1">0</cn><cn id="alg1.l2.m1.2.2.2.2.cmml" type="integer" xref="alg1.l2.m1.2.2.2.2">1</cn></interval></apply></apply><interval closure="open" id="alg1.l2.m1.4.4.1.1.2.cmml" xref="alg1.l2.m1.4.4.1.1.1"><apply id="alg1.l2.m1.4.4.1.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.2">𝑛</ci><ci id="alg1.l2.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.3">𝑏</ci></apply><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝑑</ci></interval></apply></apply><apply id="alg1.l2.m1.5.5c.cmml" xref="alg1.l2.m1.5.5"><eq id="alg1.l2.m1.5.5.6.cmml" xref="alg1.l2.m1.5.5.6"></eq><share href="https://arxiv.org/html/2408.02354v3#alg1.l2.m1.4.4.1.cmml" id="alg1.l2.m1.5.5d.cmml" xref="alg1.l2.m1.5.5"></share><apply id="alg1.l2.m1.5.5.2.cmml" xref="alg1.l2.m1.5.5.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.2.2.cmml" xref="alg1.l2.m1.5.5.2">superscript</csymbol><apply id="alg1.l2.m1.5.5.2.1.cmml" xref="alg1.l2.m1.5.5.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.2.1.2.cmml" xref="alg1.l2.m1.5.5.2">subscript</csymbol><set id="alg1.l2.m1.5.5.2.1.1.2.cmml" xref="alg1.l2.m1.5.5.2.1.1.1"><apply id="alg1.l2.m1.5.5.2.1.1.1.1.cmml" xref="alg1.l2.m1.5.5.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.2.1.1.1.1.1.cmml" xref="alg1.l2.m1.5.5.2.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.5.5.2.1.1.1.1.2.cmml" xref="alg1.l2.m1.5.5.2.1.1.1.1.2">𝑏</ci><ci id="alg1.l2.m1.5.5.2.1.1.1.1.3.cmml" xref="alg1.l2.m1.5.5.2.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg1.l2.m1.5.5.2.1.3.cmml" xref="alg1.l2.m1.5.5.2.1.3"><eq id="alg1.l2.m1.5.5.2.1.3.1.cmml" xref="alg1.l2.m1.5.5.2.1.3.1"></eq><ci id="alg1.l2.m1.5.5.2.1.3.2.cmml" xref="alg1.l2.m1.5.5.2.1.3.2">𝑘</ci><cn id="alg1.l2.m1.5.5.2.1.3.3.cmml" type="integer" xref="alg1.l2.m1.5.5.2.1.3.3">1</cn></apply></apply><apply id="alg1.l2.m1.5.5.2.3.cmml" xref="alg1.l2.m1.5.5.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.2.3.1.cmml" xref="alg1.l2.m1.5.5.2.3">subscript</csymbol><ci id="alg1.l2.m1.5.5.2.3.2.cmml" xref="alg1.l2.m1.5.5.2.3.2">𝑛</ci><ci id="alg1.l2.m1.5.5.2.3.3.cmml" xref="alg1.l2.m1.5.5.2.3.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.5c">B=\text{randn}_{\scriptstyle{\mathcal{N}(0,1)}}(n_{b},d)=\{b_{k}\}_{k=1}^{n_{b}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.5d">italic_B = randn start_POSTSUBSCRIPT caligraphic_N ( 0 , 1 ) end_POSTSUBSCRIPT ( italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_d ) = { italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l2.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.3.1.1" style="font-size:80%;">3:</span></span><math alttext="I=\text{argmax}_{b}\text{ }BX^{\top}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="90%" xref="alg1.l3.m1.1.1.2.cmml">I</mi><mo id="alg1.l3.m1.1.1.1" mathsize="90%" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><msub id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml"><mtext id="alg1.l3.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l3.m1.1.1.3.2.2a.cmml">argmax</mtext><mi id="alg1.l3.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l3.m1.1.1.3.2.3.cmml">b</mi></msub><mo id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">⁢</mo><mtext id="alg1.l3.m1.1.1.3.3" mathsize="90%" xref="alg1.l3.m1.1.1.3.3a.cmml"> </mtext><mo id="alg1.l3.m1.1.1.3.1a" xref="alg1.l3.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.4" mathsize="90%" xref="alg1.l3.m1.1.1.3.4.cmml">B</mi><mo id="alg1.l3.m1.1.1.3.1b" xref="alg1.l3.m1.1.1.3.1.cmml">⁢</mo><msup id="alg1.l3.m1.1.1.3.5" xref="alg1.l3.m1.1.1.3.5.cmml"><mi id="alg1.l3.m1.1.1.3.5.2" mathsize="90%" xref="alg1.l3.m1.1.1.3.5.2.cmml">X</mi><mo id="alg1.l3.m1.1.1.3.5.3" mathsize="90%" xref="alg1.l3.m1.1.1.3.5.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐼</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><apply id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.2.1.cmml" xref="alg1.l3.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.2a.cmml" xref="alg1.l3.m1.1.1.3.2.2"><mtext id="alg1.l3.m1.1.1.3.2.2.cmml" mathsize="90%" xref="alg1.l3.m1.1.1.3.2.2">argmax</mtext></ci><ci id="alg1.l3.m1.1.1.3.2.3.cmml" xref="alg1.l3.m1.1.1.3.2.3">𝑏</ci></apply><ci id="alg1.l3.m1.1.1.3.3a.cmml" xref="alg1.l3.m1.1.1.3.3"><mtext id="alg1.l3.m1.1.1.3.3.cmml" mathsize="90%" xref="alg1.l3.m1.1.1.3.3"> </mtext></ci><ci id="alg1.l3.m1.1.1.3.4.cmml" xref="alg1.l3.m1.1.1.3.4">𝐵</ci><apply id="alg1.l3.m1.1.1.3.5.cmml" xref="alg1.l3.m1.1.1.3.5"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.5.1.cmml" xref="alg1.l3.m1.1.1.3.5">superscript</csymbol><ci id="alg1.l3.m1.1.1.3.5.2.cmml" xref="alg1.l3.m1.1.1.3.5.2">𝑋</ci><csymbol cd="latexml" id="alg1.l3.m1.1.1.3.5.3.cmml" xref="alg1.l3.m1.1.1.3.5.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">I=\text{argmax}_{b}\text{ }BX^{\top}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_I = argmax start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_B italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l3.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l3.2" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> index of nearest <math alttext="b_{k}" class="ltx_Math" display="inline" id="alg1.l3.2.m2.1"><semantics id="alg1.l3.2.m2.1a"><msub id="alg1.l3.2.m2.1.1" xref="alg1.l3.2.m2.1.1.cmml"><mi id="alg1.l3.2.m2.1.1.2" xref="alg1.l3.2.m2.1.1.2.cmml">b</mi><mi id="alg1.l3.2.m2.1.1.3" xref="alg1.l3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.2.m2.1b"><apply id="alg1.l3.2.m2.1.1.cmml" xref="alg1.l3.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.2.m2.1.1.1.cmml" xref="alg1.l3.2.m2.1.1">subscript</csymbol><ci id="alg1.l3.2.m2.1.1.2.cmml" xref="alg1.l3.2.m2.1.1.2">𝑏</ci><ci id="alg1.l3.2.m2.1.1.3.cmml" xref="alg1.l3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.2.m2.1c">b_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.2.m2.1d">italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><math alttext="J=\text{argmax}_{b}\text{ }BY^{\top}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" mathsize="90%" xref="alg1.l4.m1.1.1.2.cmml">J</mi><mo id="alg1.l4.m1.1.1.1" mathsize="90%" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><msub id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml"><mtext id="alg1.l4.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l4.m1.1.1.3.2.2a.cmml">argmax</mtext><mi id="alg1.l4.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.2.3.cmml">b</mi></msub><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mtext id="alg1.l4.m1.1.1.3.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.3a.cmml"> </mtext><mo id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.4" mathsize="90%" xref="alg1.l4.m1.1.1.3.4.cmml">B</mi><mo id="alg1.l4.m1.1.1.3.1b" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><msup id="alg1.l4.m1.1.1.3.5" xref="alg1.l4.m1.1.1.3.5.cmml"><mi id="alg1.l4.m1.1.1.3.5.2" mathsize="90%" xref="alg1.l4.m1.1.1.3.5.2.cmml">Y</mi><mo id="alg1.l4.m1.1.1.3.5.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.5.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝐽</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.2a.cmml" xref="alg1.l4.m1.1.1.3.2.2"><mtext id="alg1.l4.m1.1.1.3.2.2.cmml" mathsize="90%" xref="alg1.l4.m1.1.1.3.2.2">argmax</mtext></ci><ci id="alg1.l4.m1.1.1.3.2.3.cmml" xref="alg1.l4.m1.1.1.3.2.3">𝑏</ci></apply><ci id="alg1.l4.m1.1.1.3.3a.cmml" xref="alg1.l4.m1.1.1.3.3"><mtext id="alg1.l4.m1.1.1.3.3.cmml" mathsize="90%" xref="alg1.l4.m1.1.1.3.3"> </mtext></ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝐵</ci><apply id="alg1.l4.m1.1.1.3.5.cmml" xref="alg1.l4.m1.1.1.3.5"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.5.1.cmml" xref="alg1.l4.m1.1.1.3.5">superscript</csymbol><ci id="alg1.l4.m1.1.1.3.5.2.cmml" xref="alg1.l4.m1.1.1.3.5.2">𝑌</ci><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.5.3.cmml" xref="alg1.l4.m1.1.1.3.5.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">J=\text{argmax}_{b}\text{ }BY^{\top}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_J = argmax start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_B italic_Y start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l4.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:80%;">5:</span></span><math alttext="X=X[\text{argsort }I]" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.3.cmml">X</mi><mo id="alg1.l5.m1.1.1.2" mathsize="90%" xref="alg1.l5.m1.1.1.2.cmml">=</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.3.cmml">X</mi><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.2.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mtext id="alg1.l5.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.2a.cmml">argsort </mtext><mo id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="alg1.l5.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"></eq><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑋</ci><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝑋</ci><apply id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"><times id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l5.m1.1.1.1.1.1.1.2a.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2"><mtext id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.1.1.2">argsort </mtext></ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">X=X[\text{argsort }I]</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_X = italic_X [ argsort italic_I ]</annotation></semantics></math><span class="ltx_text" id="alg1.l5.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l5.1" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> sorting based on new index</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><math alttext="Y=Y[\text{argsort }J]" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.3" mathsize="90%" xref="alg1.l6.m1.1.1.3.cmml">Y</mi><mo id="alg1.l6.m1.1.1.2" mathsize="90%" xref="alg1.l6.m1.1.1.2.cmml">=</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.3" mathsize="90%" xref="alg1.l6.m1.1.1.1.3.cmml">Y</mi><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.2.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l6.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mtext id="alg1.l6.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l6.m1.1.1.1.1.1.1.2a.cmml">argsort </mtext><mo id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">J</mi></mrow><mo id="alg1.l6.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l6.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></eq><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑌</ci><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3">𝑌</ci><apply id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l6.m1.1.1.1.1.1.1.2a.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2"><mtext id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l6.m1.1.1.1.1.1.1.2">argsort </mtext></ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">Y=Y[\text{argsort }J]</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_Y = italic_Y [ argsort italic_J ]</annotation></semantics></math><span class="ltx_text" id="alg1.l6.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.5.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l7.2" style="font-size:90%;">for <math alttext="c" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mi id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">italic_c</annotation></semantics></math> in range(<math alttext="n_{c}" class="ltx_Math" display="inline" id="alg1.l7.2.m2.1"><semantics id="alg1.l7.2.m2.1a"><msub id="alg1.l7.2.m2.1.1" xref="alg1.l7.2.m2.1.1.cmml"><mi id="alg1.l7.2.m2.1.1.2" xref="alg1.l7.2.m2.1.1.2.cmml">n</mi><mi id="alg1.l7.2.m2.1.1.3" xref="alg1.l7.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.2.m2.1b"><apply id="alg1.l7.2.m2.1.1.cmml" xref="alg1.l7.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.2.m2.1.1.1.cmml" xref="alg1.l7.2.m2.1.1">subscript</csymbol><ci id="alg1.l7.2.m2.1.1.2.cmml" xref="alg1.l7.2.m2.1.1.2">𝑛</ci><ci id="alg1.l7.2.m2.1.1.3.cmml" xref="alg1.l7.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.2.m2.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>):</span><span class="ltx_text" id="alg1.l7.6" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l7.4" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.3.m1.1"><semantics id="alg1.l7.3.m1.1a"><mo id="alg1.l7.3.m1.1.1" xref="alg1.l7.3.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.3.m1.1b"><ci id="alg1.l7.3.m1.1.1.cmml" xref="alg1.l7.3.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.3.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.3.m1.1d">▷</annotation></semantics></math> divide into <math alttext="n_{c}" class="ltx_Math" display="inline" id="alg1.l7.4.m2.1"><semantics id="alg1.l7.4.m2.1a"><msub id="alg1.l7.4.m2.1.1" xref="alg1.l7.4.m2.1.1.cmml"><mi id="alg1.l7.4.m2.1.1.2" xref="alg1.l7.4.m2.1.1.2.cmml">n</mi><mi id="alg1.l7.4.m2.1.1.3" xref="alg1.l7.4.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.4.m2.1b"><apply id="alg1.l7.4.m2.1.1.cmml" xref="alg1.l7.4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.4.m2.1.1.1.cmml" xref="alg1.l7.4.m2.1.1">subscript</csymbol><ci id="alg1.l7.4.m2.1.1.2.cmml" xref="alg1.l7.4.m2.1.1.2">𝑛</ci><ci id="alg1.l7.4.m2.1.1.3.cmml" xref="alg1.l7.4.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.4.m2.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.4.m2.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> chunks</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:90%;">      </span><math alttext="I_{c}=\{i:c|X|/n_{c}\leq i&lt;(c+1)|X|/n_{c}\}" class="ltx_Math" display="inline" id="alg1.l8.m1.4"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml"><msub id="alg1.l8.m1.4.4.3" xref="alg1.l8.m1.4.4.3.cmml"><mi id="alg1.l8.m1.4.4.3.2" mathsize="90%" xref="alg1.l8.m1.4.4.3.2.cmml">I</mi><mi id="alg1.l8.m1.4.4.3.3" mathsize="90%" xref="alg1.l8.m1.4.4.3.3.cmml">c</mi></msub><mo id="alg1.l8.m1.4.4.2" mathsize="90%" xref="alg1.l8.m1.4.4.2.cmml">=</mo><mrow id="alg1.l8.m1.4.4.1.1" xref="alg1.l8.m1.4.4.1.2.cmml"><mo id="alg1.l8.m1.4.4.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.2.1.cmml">{</mo><mi id="alg1.l8.m1.3.3" mathsize="90%" xref="alg1.l8.m1.3.3.cmml">i</mi><mo id="alg1.l8.m1.4.4.1.1.3" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="alg1.l8.m1.4.4.1.2.1.cmml">:</mo><mrow id="alg1.l8.m1.4.4.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1.3" xref="alg1.l8.m1.4.4.1.1.1.3.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1.3.2" xref="alg1.l8.m1.4.4.1.1.1.3.2.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.3.2.2" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.3.2.2.cmml">c</mi><mo id="alg1.l8.m1.4.4.1.1.1.3.2.1" xref="alg1.l8.m1.4.4.1.1.1.3.2.1.cmml">⁢</mo><mrow id="alg1.l8.m1.4.4.1.1.1.3.2.3.2" xref="alg1.l8.m1.4.4.1.1.1.3.2.3.1.cmml"><mo id="alg1.l8.m1.4.4.1.1.1.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.3.2.3.1.1.cmml">|</mo><mi id="alg1.l8.m1.1.1" mathsize="90%" xref="alg1.l8.m1.1.1.cmml">X</mi><mo id="alg1.l8.m1.4.4.1.1.1.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.3.2.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l8.m1.4.4.1.1.1.3.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l8.m1.4.4.1.1.1.3.1.cmml">/</mo><msub id="alg1.l8.m1.4.4.1.1.1.3.3" xref="alg1.l8.m1.4.4.1.1.1.3.3.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.3.3.2" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.3.3.2.cmml">n</mi><mi id="alg1.l8.m1.4.4.1.1.1.3.3.3" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.3.3.3.cmml">c</mi></msub></mrow><mo id="alg1.l8.m1.4.4.1.1.1.4" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.4.cmml">≤</mo><mi id="alg1.l8.m1.4.4.1.1.1.5" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.5.cmml">i</mi><mo id="alg1.l8.m1.4.4.1.1.1.6" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.6.cmml">&lt;</mo><mrow id="alg1.l8.m1.4.4.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.1.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l8.m1.4.4.1.1.1.1.1.2" xref="alg1.l8.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.4.4.1.1.1.1.1.3.2" xref="alg1.l8.m1.4.4.1.1.1.1.1.3.1.cmml"><mo id="alg1.l8.m1.4.4.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.3.1.1.cmml">|</mo><mi id="alg1.l8.m1.2.2" mathsize="90%" xref="alg1.l8.m1.2.2.cmml">X</mi><mo id="alg1.l8.m1.4.4.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.1.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l8.m1.4.4.1.1.1.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l8.m1.4.4.1.1.1.1.2.cmml">/</mo><msub id="alg1.l8.m1.4.4.1.1.1.1.3" xref="alg1.l8.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.1.3.2" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.3.2.cmml">n</mi><mi id="alg1.l8.m1.4.4.1.1.1.1.3.3" mathsize="90%" xref="alg1.l8.m1.4.4.1.1.1.1.3.3.cmml">c</mi></msub></mrow></mrow><mo id="alg1.l8.m1.4.4.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l8.m1.4.4.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4"><eq id="alg1.l8.m1.4.4.2.cmml" xref="alg1.l8.m1.4.4.2"></eq><apply id="alg1.l8.m1.4.4.3.cmml" xref="alg1.l8.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.3.1.cmml" xref="alg1.l8.m1.4.4.3">subscript</csymbol><ci id="alg1.l8.m1.4.4.3.2.cmml" xref="alg1.l8.m1.4.4.3.2">𝐼</ci><ci id="alg1.l8.m1.4.4.3.3.cmml" xref="alg1.l8.m1.4.4.3.3">𝑐</ci></apply><apply id="alg1.l8.m1.4.4.1.2.cmml" xref="alg1.l8.m1.4.4.1.1"><csymbol cd="latexml" id="alg1.l8.m1.4.4.1.2.1.cmml" xref="alg1.l8.m1.4.4.1.1.2">conditional-set</csymbol><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">𝑖</ci><apply id="alg1.l8.m1.4.4.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1"><and id="alg1.l8.m1.4.4.1.1.1a.cmml" xref="alg1.l8.m1.4.4.1.1.1"></and><apply id="alg1.l8.m1.4.4.1.1.1b.cmml" xref="alg1.l8.m1.4.4.1.1.1"><leq id="alg1.l8.m1.4.4.1.1.1.4.cmml" xref="alg1.l8.m1.4.4.1.1.1.4"></leq><apply id="alg1.l8.m1.4.4.1.1.1.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.3"><divide id="alg1.l8.m1.4.4.1.1.1.3.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.1"></divide><apply id="alg1.l8.m1.4.4.1.1.1.3.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.2"><times id="alg1.l8.m1.4.4.1.1.1.3.2.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.2.1"></times><ci id="alg1.l8.m1.4.4.1.1.1.3.2.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.2.2">𝑐</ci><apply id="alg1.l8.m1.4.4.1.1.1.3.2.3.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.2.3.2"><abs id="alg1.l8.m1.4.4.1.1.1.3.2.3.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.2.3.2.1"></abs><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑋</ci></apply></apply><apply id="alg1.l8.m1.4.4.1.1.1.3.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.1.1.1.3.3.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.3">subscript</csymbol><ci id="alg1.l8.m1.4.4.1.1.1.3.3.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.3.2">𝑛</ci><ci id="alg1.l8.m1.4.4.1.1.1.3.3.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.3.3.3">𝑐</ci></apply></apply><ci id="alg1.l8.m1.4.4.1.1.1.5.cmml" xref="alg1.l8.m1.4.4.1.1.1.5">𝑖</ci></apply><apply id="alg1.l8.m1.4.4.1.1.1c.cmml" xref="alg1.l8.m1.4.4.1.1.1"><lt id="alg1.l8.m1.4.4.1.1.1.6.cmml" xref="alg1.l8.m1.4.4.1.1.1.6"></lt><share href="https://arxiv.org/html/2408.02354v3#alg1.l8.m1.4.4.1.1.1.5.cmml" id="alg1.l8.m1.4.4.1.1.1d.cmml" xref="alg1.l8.m1.4.4.1.1.1"></share><apply id="alg1.l8.m1.4.4.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1"><divide id="alg1.l8.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.2"></divide><apply id="alg1.l8.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1"><times id="alg1.l8.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.2"></times><apply id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1"><plus id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.1"></plus><ci id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.2">𝑐</ci><cn id="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l8.m1.4.4.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l8.m1.4.4.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.3.2"><abs id="alg1.l8.m1.4.4.1.1.1.1.1.3.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.1.3.2.1"></abs><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑋</ci></apply></apply><apply id="alg1.l8.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.3.2">𝑛</ci><ci id="alg1.l8.m1.4.4.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">I_{c}=\{i:c|X|/n_{c}\leq i&lt;(c+1)|X|/n_{c}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.4d">italic_I start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = { italic_i : italic_c | italic_X | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ≤ italic_i &lt; ( italic_c + 1 ) | italic_X | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT }</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:90%;">      </span><math alttext="J_{c}=\{j:c|Y|/n_{c}\leq j&lt;(c+1)|Y|/n_{c}\}" class="ltx_Math" display="inline" id="alg1.l9.m1.4"><semantics id="alg1.l9.m1.4a"><mrow id="alg1.l9.m1.4.4" xref="alg1.l9.m1.4.4.cmml"><msub id="alg1.l9.m1.4.4.3" xref="alg1.l9.m1.4.4.3.cmml"><mi id="alg1.l9.m1.4.4.3.2" mathsize="90%" xref="alg1.l9.m1.4.4.3.2.cmml">J</mi><mi id="alg1.l9.m1.4.4.3.3" mathsize="90%" xref="alg1.l9.m1.4.4.3.3.cmml">c</mi></msub><mo id="alg1.l9.m1.4.4.2" mathsize="90%" xref="alg1.l9.m1.4.4.2.cmml">=</mo><mrow id="alg1.l9.m1.4.4.1.1" xref="alg1.l9.m1.4.4.1.2.cmml"><mo id="alg1.l9.m1.4.4.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.2.1.cmml">{</mo><mi id="alg1.l9.m1.3.3" mathsize="90%" xref="alg1.l9.m1.3.3.cmml">j</mi><mo id="alg1.l9.m1.4.4.1.1.3" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="alg1.l9.m1.4.4.1.2.1.cmml">:</mo><mrow id="alg1.l9.m1.4.4.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.cmml"><mrow id="alg1.l9.m1.4.4.1.1.1.3" xref="alg1.l9.m1.4.4.1.1.1.3.cmml"><mrow id="alg1.l9.m1.4.4.1.1.1.3.2" xref="alg1.l9.m1.4.4.1.1.1.3.2.cmml"><mi id="alg1.l9.m1.4.4.1.1.1.3.2.2" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.3.2.2.cmml">c</mi><mo id="alg1.l9.m1.4.4.1.1.1.3.2.1" xref="alg1.l9.m1.4.4.1.1.1.3.2.1.cmml">⁢</mo><mrow id="alg1.l9.m1.4.4.1.1.1.3.2.3.2" xref="alg1.l9.m1.4.4.1.1.1.3.2.3.1.cmml"><mo id="alg1.l9.m1.4.4.1.1.1.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.3.2.3.1.1.cmml">|</mo><mi id="alg1.l9.m1.1.1" mathsize="90%" xref="alg1.l9.m1.1.1.cmml">Y</mi><mo id="alg1.l9.m1.4.4.1.1.1.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.3.2.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l9.m1.4.4.1.1.1.3.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l9.m1.4.4.1.1.1.3.1.cmml">/</mo><msub id="alg1.l9.m1.4.4.1.1.1.3.3" xref="alg1.l9.m1.4.4.1.1.1.3.3.cmml"><mi id="alg1.l9.m1.4.4.1.1.1.3.3.2" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.3.3.2.cmml">n</mi><mi id="alg1.l9.m1.4.4.1.1.1.3.3.3" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.3.3.3.cmml">c</mi></msub></mrow><mo id="alg1.l9.m1.4.4.1.1.1.4" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.4.cmml">≤</mo><mi id="alg1.l9.m1.4.4.1.1.1.5" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.5.cmml">j</mi><mo id="alg1.l9.m1.4.4.1.1.1.6" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.6.cmml">&lt;</mo><mrow id="alg1.l9.m1.4.4.1.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.1.cmml"><mrow id="alg1.l9.m1.4.4.1.1.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.1.1.cmml"><mrow id="alg1.l9.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l9.m1.4.4.1.1.1.1.1.2" xref="alg1.l9.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l9.m1.4.4.1.1.1.1.1.3.2" xref="alg1.l9.m1.4.4.1.1.1.1.1.3.1.cmml"><mo id="alg1.l9.m1.4.4.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.3.1.1.cmml">|</mo><mi id="alg1.l9.m1.2.2" mathsize="90%" xref="alg1.l9.m1.2.2.cmml">Y</mi><mo id="alg1.l9.m1.4.4.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.1.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l9.m1.4.4.1.1.1.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l9.m1.4.4.1.1.1.1.2.cmml">/</mo><msub id="alg1.l9.m1.4.4.1.1.1.1.3" xref="alg1.l9.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.4.4.1.1.1.1.3.2" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.3.2.cmml">n</mi><mi id="alg1.l9.m1.4.4.1.1.1.1.3.3" mathsize="90%" xref="alg1.l9.m1.4.4.1.1.1.1.3.3.cmml">c</mi></msub></mrow></mrow><mo id="alg1.l9.m1.4.4.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l9.m1.4.4.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.4b"><apply id="alg1.l9.m1.4.4.cmml" xref="alg1.l9.m1.4.4"><eq id="alg1.l9.m1.4.4.2.cmml" xref="alg1.l9.m1.4.4.2"></eq><apply id="alg1.l9.m1.4.4.3.cmml" xref="alg1.l9.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.3.1.cmml" xref="alg1.l9.m1.4.4.3">subscript</csymbol><ci id="alg1.l9.m1.4.4.3.2.cmml" xref="alg1.l9.m1.4.4.3.2">𝐽</ci><ci id="alg1.l9.m1.4.4.3.3.cmml" xref="alg1.l9.m1.4.4.3.3">𝑐</ci></apply><apply id="alg1.l9.m1.4.4.1.2.cmml" xref="alg1.l9.m1.4.4.1.1"><csymbol cd="latexml" id="alg1.l9.m1.4.4.1.2.1.cmml" xref="alg1.l9.m1.4.4.1.1.2">conditional-set</csymbol><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝑗</ci><apply id="alg1.l9.m1.4.4.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1"><and id="alg1.l9.m1.4.4.1.1.1a.cmml" xref="alg1.l9.m1.4.4.1.1.1"></and><apply id="alg1.l9.m1.4.4.1.1.1b.cmml" xref="alg1.l9.m1.4.4.1.1.1"><leq id="alg1.l9.m1.4.4.1.1.1.4.cmml" xref="alg1.l9.m1.4.4.1.1.1.4"></leq><apply id="alg1.l9.m1.4.4.1.1.1.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.3"><divide id="alg1.l9.m1.4.4.1.1.1.3.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.1"></divide><apply id="alg1.l9.m1.4.4.1.1.1.3.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.2"><times id="alg1.l9.m1.4.4.1.1.1.3.2.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.2.1"></times><ci id="alg1.l9.m1.4.4.1.1.1.3.2.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.2.2">𝑐</ci><apply id="alg1.l9.m1.4.4.1.1.1.3.2.3.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.2.3.2"><abs id="alg1.l9.m1.4.4.1.1.1.3.2.3.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.2.3.2.1"></abs><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑌</ci></apply></apply><apply id="alg1.l9.m1.4.4.1.1.1.3.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.1.1.1.3.3.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.3">subscript</csymbol><ci id="alg1.l9.m1.4.4.1.1.1.3.3.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.3.2">𝑛</ci><ci id="alg1.l9.m1.4.4.1.1.1.3.3.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.3.3.3">𝑐</ci></apply></apply><ci id="alg1.l9.m1.4.4.1.1.1.5.cmml" xref="alg1.l9.m1.4.4.1.1.1.5">𝑗</ci></apply><apply id="alg1.l9.m1.4.4.1.1.1c.cmml" xref="alg1.l9.m1.4.4.1.1.1"><lt id="alg1.l9.m1.4.4.1.1.1.6.cmml" xref="alg1.l9.m1.4.4.1.1.1.6"></lt><share href="https://arxiv.org/html/2408.02354v3#alg1.l9.m1.4.4.1.1.1.5.cmml" id="alg1.l9.m1.4.4.1.1.1d.cmml" xref="alg1.l9.m1.4.4.1.1.1"></share><apply id="alg1.l9.m1.4.4.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1"><divide id="alg1.l9.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.2"></divide><apply id="alg1.l9.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1"><times id="alg1.l9.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.2"></times><apply id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1"><plus id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.1"></plus><ci id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.2">𝑐</ci><cn id="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l9.m1.4.4.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l9.m1.4.4.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.3.2"><abs id="alg1.l9.m1.4.4.1.1.1.1.1.3.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.1.3.2.1"></abs><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑌</ci></apply></apply><apply id="alg1.l9.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.3.2">𝑛</ci><ci id="alg1.l9.m1.4.4.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.4c">J_{c}=\{j:c|Y|/n_{c}\leq j&lt;(c+1)|Y|/n_{c}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.4d">italic_J start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = { italic_j : italic_c | italic_Y | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ≤ italic_j &lt; ( italic_c + 1 ) | italic_Y | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT }</annotation></semantics></math><span class="ltx_text" id="alg1.l9.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.2" style="font-size:90%;">      </span><math alttext="X_{c}=X[I_{c}]" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" mathsize="90%" xref="alg1.l10.m1.1.1.3.2.cmml">X</mi><mi id="alg1.l10.m1.1.1.3.3" mathsize="90%" xref="alg1.l10.m1.1.1.3.3.cmml">c</mi></msub><mo id="alg1.l10.m1.1.1.2" mathsize="90%" xref="alg1.l10.m1.1.1.2.cmml">=</mo><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.3" mathsize="90%" xref="alg1.l10.m1.1.1.1.3.cmml">X</mi><mo id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l10.m1.1.1.1.1.2.1.cmml">[</mo><msub id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">I</mi><mi id="alg1.l10.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="alg1.l10.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l10.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></eq><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑋</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑐</ci></apply><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3">𝑋</ci><apply id="alg1.l10.m1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l10.m1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝐼</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">X_{c}=X[I_{c}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_X [ italic_I start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ]</annotation></semantics></math><span class="ltx_text" id="alg1.l10.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.2.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg1.l11.3" style="font-size:90%;">      </span><math alttext="Y_{c*}=Y[J_{c-1}\cup J_{c}\cup J_{c+1}]" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml"><msub id="alg1.l11.m1.3.3.3" xref="alg1.l11.m1.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.2" mathsize="90%" xref="alg1.l11.m1.3.3.3.2.cmml">Y</mi><mrow id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.3.cmml"><mi id="alg1.l11.m1.1.1.1.1" mathsize="90%" xref="alg1.l11.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l11.m1.2.2.2.4.1" lspace="0.222em" xref="alg1.l11.m1.2.2.2.3.cmml">⁣</mo><mo id="alg1.l11.m1.2.2.2.2" mathsize="90%" xref="alg1.l11.m1.2.2.2.2.cmml">∗</mo></mrow></msub><mo id="alg1.l11.m1.3.3.2" mathsize="90%" xref="alg1.l11.m1.3.3.2.cmml">=</mo><mrow id="alg1.l11.m1.3.3.1" xref="alg1.l11.m1.3.3.1.cmml"><mi id="alg1.l11.m1.3.3.1.3" mathsize="90%" xref="alg1.l11.m1.3.3.1.3.cmml">Y</mi><mo id="alg1.l11.m1.3.3.1.2" xref="alg1.l11.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.3.3.1.1.1" xref="alg1.l11.m1.3.3.1.1.2.cmml"><mo id="alg1.l11.m1.3.3.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l11.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="alg1.l11.m1.3.3.1.1.1.1" xref="alg1.l11.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l11.m1.3.3.1.1.1.1.2" xref="alg1.l11.m1.3.3.1.1.1.1.2.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.2.2" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.2.2.cmml">J</mi><mrow id="alg1.l11.m1.3.3.1.1.1.1.2.3" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.2.3.2" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.2.cmml">c</mi><mo id="alg1.l11.m1.3.3.1.1.1.1.2.3.1" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="alg1.l11.m1.3.3.1.1.1.1.2.3.3" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l11.m1.3.3.1.1.1.1.1" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.1.cmml">∪</mo><msub id="alg1.l11.m1.3.3.1.1.1.1.3" xref="alg1.l11.m1.3.3.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.3.2" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.3.2.cmml">J</mi><mi id="alg1.l11.m1.3.3.1.1.1.1.3.3" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.3.3.cmml">c</mi></msub><mo id="alg1.l11.m1.3.3.1.1.1.1.1a" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.1.cmml">∪</mo><msub id="alg1.l11.m1.3.3.1.1.1.1.4" xref="alg1.l11.m1.3.3.1.1.1.1.4.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.4.2" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.4.2.cmml">J</mi><mrow id="alg1.l11.m1.3.3.1.1.1.1.4.3" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.4.3.2" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.2.cmml">c</mi><mo id="alg1.l11.m1.3.3.1.1.1.1.4.3.1" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.1.cmml">+</mo><mn id="alg1.l11.m1.3.3.1.1.1.1.4.3.3" mathsize="90%" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l11.m1.3.3.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l11.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3"><eq id="alg1.l11.m1.3.3.2.cmml" xref="alg1.l11.m1.3.3.2"></eq><apply id="alg1.l11.m1.3.3.3.cmml" xref="alg1.l11.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3">subscript</csymbol><ci id="alg1.l11.m1.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.2">𝑌</ci><list id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.4"><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝑐</ci><times id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"></times></list></apply><apply id="alg1.l11.m1.3.3.1.cmml" xref="alg1.l11.m1.3.3.1"><times id="alg1.l11.m1.3.3.1.2.cmml" xref="alg1.l11.m1.3.3.1.2"></times><ci id="alg1.l11.m1.3.3.1.3.cmml" xref="alg1.l11.m1.3.3.1.3">𝑌</ci><apply id="alg1.l11.m1.3.3.1.1.2.cmml" xref="alg1.l11.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg1.l11.m1.3.3.1.1.2.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l11.m1.3.3.1.1.1.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1"><union id="alg1.l11.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1"></union><apply id="alg1.l11.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg1.l11.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2.2">𝐽</ci><apply id="alg1.l11.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2.3"><minus id="alg1.l11.m1.3.3.1.1.1.1.2.3.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.1"></minus><ci id="alg1.l11.m1.3.3.1.1.1.1.2.3.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.2">𝑐</ci><cn id="alg1.l11.m1.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="alg1.l11.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l11.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.3.2">𝐽</ci><ci id="alg1.l11.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.3.3">𝑐</ci></apply><apply id="alg1.l11.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.1.1.1.1.4.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="alg1.l11.m1.3.3.1.1.1.1.4.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4.2">𝐽</ci><apply id="alg1.l11.m1.3.3.1.1.1.1.4.3.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4.3"><plus id="alg1.l11.m1.3.3.1.1.1.1.4.3.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.1"></plus><ci id="alg1.l11.m1.3.3.1.1.1.1.4.3.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.2">𝑐</ci><cn id="alg1.l11.m1.3.3.1.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l11.m1.3.3.1.1.1.1.4.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">Y_{c*}=Y[J_{c-1}\cup J_{c}\cup J_{c+1}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">italic_Y start_POSTSUBSCRIPT italic_c ∗ end_POSTSUBSCRIPT = italic_Y [ italic_J start_POSTSUBSCRIPT italic_c - 1 end_POSTSUBSCRIPT ∪ italic_J start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∪ italic_J start_POSTSUBSCRIPT italic_c + 1 end_POSTSUBSCRIPT ]</annotation></semantics></math><span class="ltx_text" id="alg1.l11.4" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.l11.1" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.1.m1.1d">▷</annotation></semantics></math> current and adjacent chunks</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.2.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg1.l12.3" style="font-size:90%;">      </span><math alttext="logits^{-}_{c}=X_{c}{Y^{\top}}_{c*}\in\mathbb{R}^{|X|/n_{c}\times 3|Y|/n_{c}}" class="ltx_Math" display="inline" id="alg1.l12.m1.4"><semantics id="alg1.l12.m1.4a"><mrow id="alg1.l12.m1.4.5" xref="alg1.l12.m1.4.5.cmml"><mrow id="alg1.l12.m1.4.5.2" xref="alg1.l12.m1.4.5.2.cmml"><mi id="alg1.l12.m1.4.5.2.2" mathsize="90%" xref="alg1.l12.m1.4.5.2.2.cmml">l</mi><mo id="alg1.l12.m1.4.5.2.1" xref="alg1.l12.m1.4.5.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.4.5.2.3" mathsize="90%" xref="alg1.l12.m1.4.5.2.3.cmml">o</mi><mo id="alg1.l12.m1.4.5.2.1a" xref="alg1.l12.m1.4.5.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.4.5.2.4" mathsize="90%" xref="alg1.l12.m1.4.5.2.4.cmml">g</mi><mo id="alg1.l12.m1.4.5.2.1b" xref="alg1.l12.m1.4.5.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.4.5.2.5" mathsize="90%" xref="alg1.l12.m1.4.5.2.5.cmml">i</mi><mo id="alg1.l12.m1.4.5.2.1c" xref="alg1.l12.m1.4.5.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.4.5.2.6" mathsize="90%" xref="alg1.l12.m1.4.5.2.6.cmml">t</mi><mo id="alg1.l12.m1.4.5.2.1d" xref="alg1.l12.m1.4.5.2.1.cmml">⁢</mo><msubsup id="alg1.l12.m1.4.5.2.7" xref="alg1.l12.m1.4.5.2.7.cmml"><mi id="alg1.l12.m1.4.5.2.7.2.2" mathsize="90%" xref="alg1.l12.m1.4.5.2.7.2.2.cmml">s</mi><mi id="alg1.l12.m1.4.5.2.7.3" mathsize="90%" xref="alg1.l12.m1.4.5.2.7.3.cmml">c</mi><mo id="alg1.l12.m1.4.5.2.7.2.3" mathsize="90%" xref="alg1.l12.m1.4.5.2.7.2.3.cmml">−</mo></msubsup></mrow><mo id="alg1.l12.m1.4.5.3" mathsize="90%" xref="alg1.l12.m1.4.5.3.cmml">=</mo><mrow id="alg1.l12.m1.4.5.4" xref="alg1.l12.m1.4.5.4.cmml"><msub id="alg1.l12.m1.4.5.4.2" xref="alg1.l12.m1.4.5.4.2.cmml"><mi id="alg1.l12.m1.4.5.4.2.2" mathsize="90%" xref="alg1.l12.m1.4.5.4.2.2.cmml">X</mi><mi id="alg1.l12.m1.4.5.4.2.3" mathsize="90%" xref="alg1.l12.m1.4.5.4.2.3.cmml">c</mi></msub><mo id="alg1.l12.m1.4.5.4.1" xref="alg1.l12.m1.4.5.4.1.cmml">⁢</mo><mmultiscripts id="alg1.l12.m1.4.5.4.3" xref="alg1.l12.m1.4.5.4.3.cmml"><mi id="alg1.l12.m1.4.5.4.3.2.2" mathsize="90%" xref="alg1.l12.m1.4.5.4.3.2.2.cmml">Y</mi><mrow id="alg1.l12.m1.4.5.4.3a" xref="alg1.l12.m1.4.5.4.3.cmml"></mrow><mo id="alg1.l12.m1.4.5.4.3.2.3" mathsize="90%" xref="alg1.l12.m1.4.5.4.3.2.3.cmml">⊤</mo><mrow id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.1.1" mathsize="90%" xref="alg1.l12.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l12.m1.2.2.2.4.1" lspace="0.222em" xref="alg1.l12.m1.2.2.2.3.cmml">⁣</mo><mo id="alg1.l12.m1.2.2.2.2" mathsize="90%" xref="alg1.l12.m1.2.2.2.2.cmml">∗</mo></mrow><mrow id="alg1.l12.m1.4.5.4.3b" xref="alg1.l12.m1.4.5.4.3.cmml"></mrow></mmultiscripts></mrow><mo id="alg1.l12.m1.4.5.5" mathsize="90%" xref="alg1.l12.m1.4.5.5.cmml">∈</mo><msup id="alg1.l12.m1.4.5.6" xref="alg1.l12.m1.4.5.6.cmml"><mi id="alg1.l12.m1.4.5.6.2" mathsize="90%" xref="alg1.l12.m1.4.5.6.2.cmml">ℝ</mi><mrow id="alg1.l12.m1.4.4.2" xref="alg1.l12.m1.4.4.2.cmml"><mrow id="alg1.l12.m1.4.4.2.4" xref="alg1.l12.m1.4.4.2.4.cmml"><mrow id="alg1.l12.m1.4.4.2.4.2" xref="alg1.l12.m1.4.4.2.4.2.cmml"><mrow id="alg1.l12.m1.4.4.2.4.2.2" xref="alg1.l12.m1.4.4.2.4.2.2.cmml"><mrow id="alg1.l12.m1.4.4.2.4.2.2.2.2" xref="alg1.l12.m1.4.4.2.4.2.2.2.1.cmml"><mo id="alg1.l12.m1.4.4.2.4.2.2.2.2.1" maxsize="90%" minsize="90%" xref="alg1.l12.m1.4.4.2.4.2.2.2.1.1.cmml">|</mo><mi id="alg1.l12.m1.3.3.1.1" mathsize="90%" xref="alg1.l12.m1.3.3.1.1.cmml">X</mi><mo id="alg1.l12.m1.4.4.2.4.2.2.2.2.2" maxsize="90%" minsize="90%" xref="alg1.l12.m1.4.4.2.4.2.2.2.1.1.cmml">|</mo></mrow><mo id="alg1.l12.m1.4.4.2.4.2.2.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l12.m1.4.4.2.4.2.2.1.cmml">/</mo><msub id="alg1.l12.m1.4.4.2.4.2.2.3" xref="alg1.l12.m1.4.4.2.4.2.2.3.cmml"><mi id="alg1.l12.m1.4.4.2.4.2.2.3.2" mathsize="90%" xref="alg1.l12.m1.4.4.2.4.2.2.3.2.cmml">n</mi><mi id="alg1.l12.m1.4.4.2.4.2.2.3.3" mathsize="90%" xref="alg1.l12.m1.4.4.2.4.2.2.3.3.cmml">c</mi></msub></mrow><mo id="alg1.l12.m1.4.4.2.4.2.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l12.m1.4.4.2.4.2.1.cmml">×</mo><mn id="alg1.l12.m1.4.4.2.4.2.3" mathsize="90%" xref="alg1.l12.m1.4.4.2.4.2.3.cmml">3</mn></mrow><mo id="alg1.l12.m1.4.4.2.4.1" xref="alg1.l12.m1.4.4.2.4.1.cmml">⁢</mo><mrow id="alg1.l12.m1.4.4.2.4.3.2" xref="alg1.l12.m1.4.4.2.4.3.1.cmml"><mo id="alg1.l12.m1.4.4.2.4.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l12.m1.4.4.2.4.3.1.1.cmml">|</mo><mi id="alg1.l12.m1.4.4.2.2" mathsize="90%" xref="alg1.l12.m1.4.4.2.2.cmml">Y</mi><mo id="alg1.l12.m1.4.4.2.4.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l12.m1.4.4.2.4.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l12.m1.4.4.2.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l12.m1.4.4.2.3.cmml">/</mo><msub id="alg1.l12.m1.4.4.2.5" xref="alg1.l12.m1.4.4.2.5.cmml"><mi id="alg1.l12.m1.4.4.2.5.2" mathsize="90%" xref="alg1.l12.m1.4.4.2.5.2.cmml">n</mi><mi id="alg1.l12.m1.4.4.2.5.3" mathsize="90%" xref="alg1.l12.m1.4.4.2.5.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.4b"><apply id="alg1.l12.m1.4.5.cmml" xref="alg1.l12.m1.4.5"><and id="alg1.l12.m1.4.5a.cmml" xref="alg1.l12.m1.4.5"></and><apply id="alg1.l12.m1.4.5b.cmml" xref="alg1.l12.m1.4.5"><eq id="alg1.l12.m1.4.5.3.cmml" xref="alg1.l12.m1.4.5.3"></eq><apply id="alg1.l12.m1.4.5.2.cmml" xref="alg1.l12.m1.4.5.2"><times id="alg1.l12.m1.4.5.2.1.cmml" xref="alg1.l12.m1.4.5.2.1"></times><ci id="alg1.l12.m1.4.5.2.2.cmml" xref="alg1.l12.m1.4.5.2.2">𝑙</ci><ci id="alg1.l12.m1.4.5.2.3.cmml" xref="alg1.l12.m1.4.5.2.3">𝑜</ci><ci id="alg1.l12.m1.4.5.2.4.cmml" xref="alg1.l12.m1.4.5.2.4">𝑔</ci><ci id="alg1.l12.m1.4.5.2.5.cmml" xref="alg1.l12.m1.4.5.2.5">𝑖</ci><ci id="alg1.l12.m1.4.5.2.6.cmml" xref="alg1.l12.m1.4.5.2.6">𝑡</ci><apply id="alg1.l12.m1.4.5.2.7.cmml" xref="alg1.l12.m1.4.5.2.7"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.2.7.1.cmml" xref="alg1.l12.m1.4.5.2.7">subscript</csymbol><apply id="alg1.l12.m1.4.5.2.7.2.cmml" xref="alg1.l12.m1.4.5.2.7"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.2.7.2.1.cmml" xref="alg1.l12.m1.4.5.2.7">superscript</csymbol><ci id="alg1.l12.m1.4.5.2.7.2.2.cmml" xref="alg1.l12.m1.4.5.2.7.2.2">𝑠</ci><minus id="alg1.l12.m1.4.5.2.7.2.3.cmml" xref="alg1.l12.m1.4.5.2.7.2.3"></minus></apply><ci id="alg1.l12.m1.4.5.2.7.3.cmml" xref="alg1.l12.m1.4.5.2.7.3">𝑐</ci></apply></apply><apply id="alg1.l12.m1.4.5.4.cmml" xref="alg1.l12.m1.4.5.4"><times id="alg1.l12.m1.4.5.4.1.cmml" xref="alg1.l12.m1.4.5.4.1"></times><apply id="alg1.l12.m1.4.5.4.2.cmml" xref="alg1.l12.m1.4.5.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.4.2.1.cmml" xref="alg1.l12.m1.4.5.4.2">subscript</csymbol><ci id="alg1.l12.m1.4.5.4.2.2.cmml" xref="alg1.l12.m1.4.5.4.2.2">𝑋</ci><ci id="alg1.l12.m1.4.5.4.2.3.cmml" xref="alg1.l12.m1.4.5.4.2.3">𝑐</ci></apply><apply id="alg1.l12.m1.4.5.4.3.cmml" xref="alg1.l12.m1.4.5.4.3"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.4.3.1.cmml" xref="alg1.l12.m1.4.5.4.3">subscript</csymbol><apply id="alg1.l12.m1.4.5.4.3.2.cmml" xref="alg1.l12.m1.4.5.4.3"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.4.3.2.1.cmml" xref="alg1.l12.m1.4.5.4.3">superscript</csymbol><ci id="alg1.l12.m1.4.5.4.3.2.2.cmml" xref="alg1.l12.m1.4.5.4.3.2.2">𝑌</ci><csymbol cd="latexml" id="alg1.l12.m1.4.5.4.3.2.3.cmml" xref="alg1.l12.m1.4.5.4.3.2.3">top</csymbol></apply><list id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.4"><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑐</ci><times id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2"></times></list></apply></apply></apply><apply id="alg1.l12.m1.4.5c.cmml" xref="alg1.l12.m1.4.5"><in id="alg1.l12.m1.4.5.5.cmml" xref="alg1.l12.m1.4.5.5"></in><share href="https://arxiv.org/html/2408.02354v3#alg1.l12.m1.4.5.4.cmml" id="alg1.l12.m1.4.5d.cmml" xref="alg1.l12.m1.4.5"></share><apply id="alg1.l12.m1.4.5.6.cmml" xref="alg1.l12.m1.4.5.6"><csymbol cd="ambiguous" id="alg1.l12.m1.4.5.6.1.cmml" xref="alg1.l12.m1.4.5.6">superscript</csymbol><ci id="alg1.l12.m1.4.5.6.2.cmml" xref="alg1.l12.m1.4.5.6.2">ℝ</ci><apply id="alg1.l12.m1.4.4.2.cmml" xref="alg1.l12.m1.4.4.2"><divide id="alg1.l12.m1.4.4.2.3.cmml" xref="alg1.l12.m1.4.4.2.3"></divide><apply id="alg1.l12.m1.4.4.2.4.cmml" xref="alg1.l12.m1.4.4.2.4"><times id="alg1.l12.m1.4.4.2.4.1.cmml" xref="alg1.l12.m1.4.4.2.4.1"></times><apply id="alg1.l12.m1.4.4.2.4.2.cmml" xref="alg1.l12.m1.4.4.2.4.2"><times id="alg1.l12.m1.4.4.2.4.2.1.cmml" xref="alg1.l12.m1.4.4.2.4.2.1"></times><apply id="alg1.l12.m1.4.4.2.4.2.2.cmml" xref="alg1.l12.m1.4.4.2.4.2.2"><divide id="alg1.l12.m1.4.4.2.4.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.1"></divide><apply id="alg1.l12.m1.4.4.2.4.2.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.2.2"><abs id="alg1.l12.m1.4.4.2.4.2.2.2.1.1.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.2.2.1"></abs><ci id="alg1.l12.m1.3.3.1.1.cmml" xref="alg1.l12.m1.3.3.1.1">𝑋</ci></apply><apply id="alg1.l12.m1.4.4.2.4.2.2.3.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.2.4.2.2.3.1.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.3">subscript</csymbol><ci id="alg1.l12.m1.4.4.2.4.2.2.3.2.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.3.2">𝑛</ci><ci id="alg1.l12.m1.4.4.2.4.2.2.3.3.cmml" xref="alg1.l12.m1.4.4.2.4.2.2.3.3">𝑐</ci></apply></apply><cn id="alg1.l12.m1.4.4.2.4.2.3.cmml" type="integer" xref="alg1.l12.m1.4.4.2.4.2.3">3</cn></apply><apply id="alg1.l12.m1.4.4.2.4.3.1.cmml" xref="alg1.l12.m1.4.4.2.4.3.2"><abs id="alg1.l12.m1.4.4.2.4.3.1.1.cmml" xref="alg1.l12.m1.4.4.2.4.3.2.1"></abs><ci id="alg1.l12.m1.4.4.2.2.cmml" xref="alg1.l12.m1.4.4.2.2">𝑌</ci></apply></apply><apply id="alg1.l12.m1.4.4.2.5.cmml" xref="alg1.l12.m1.4.4.2.5"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.2.5.1.cmml" xref="alg1.l12.m1.4.4.2.5">subscript</csymbol><ci id="alg1.l12.m1.4.4.2.5.2.cmml" xref="alg1.l12.m1.4.4.2.5.2">𝑛</ci><ci id="alg1.l12.m1.4.4.2.5.3.cmml" xref="alg1.l12.m1.4.4.2.5.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.4c">logits^{-}_{c}=X_{c}{Y^{\top}}_{c*}\in\mathbb{R}^{|X|/n_{c}\times 3|Y|/n_{c}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.4d">italic_l italic_o italic_g italic_i italic_t italic_s start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT italic_Y start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c ∗ end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | italic_X | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × 3 | italic_Y | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l12.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l12.1" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> logits for wrong classes </span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.3.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg1.l13.4" style="font-size:90%;">     
</span><span class="ltx_text ltx_font_bold" id="alg1.l13.2" style="font-size:90%;">for <math alttext="i" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mi id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">italic_i</annotation></semantics></math> in range(<math alttext="|X|/n_{c}" class="ltx_Math" display="inline" id="alg1.l13.2.m2.1"><semantics id="alg1.l13.2.m2.1a"><mrow id="alg1.l13.2.m2.1.2" xref="alg1.l13.2.m2.1.2.cmml"><mrow id="alg1.l13.2.m2.1.2.2.2" xref="alg1.l13.2.m2.1.2.2.1.cmml"><mo id="alg1.l13.2.m2.1.2.2.2.1" stretchy="false" xref="alg1.l13.2.m2.1.2.2.1.1.cmml">|</mo><mi id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml">X</mi><mo id="alg1.l13.2.m2.1.2.2.2.2" stretchy="false" xref="alg1.l13.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg1.l13.2.m2.1.2.1" xref="alg1.l13.2.m2.1.2.1.cmml">/</mo><msub id="alg1.l13.2.m2.1.2.3" xref="alg1.l13.2.m2.1.2.3.cmml"><mi id="alg1.l13.2.m2.1.2.3.2" xref="alg1.l13.2.m2.1.2.3.2.cmml">n</mi><mi id="alg1.l13.2.m2.1.2.3.3" xref="alg1.l13.2.m2.1.2.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><apply id="alg1.l13.2.m2.1.2.cmml" xref="alg1.l13.2.m2.1.2"><divide id="alg1.l13.2.m2.1.2.1.cmml" xref="alg1.l13.2.m2.1.2.1"></divide><apply id="alg1.l13.2.m2.1.2.2.1.cmml" xref="alg1.l13.2.m2.1.2.2.2"><abs id="alg1.l13.2.m2.1.2.2.1.1.cmml" xref="alg1.l13.2.m2.1.2.2.2.1"></abs><ci id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1">𝑋</ci></apply><apply id="alg1.l13.2.m2.1.2.3.cmml" xref="alg1.l13.2.m2.1.2.3"><csymbol cd="ambiguous" id="alg1.l13.2.m2.1.2.3.1.cmml" xref="alg1.l13.2.m2.1.2.3">subscript</csymbol><ci id="alg1.l13.2.m2.1.2.3.2.cmml" xref="alg1.l13.2.m2.1.2.3.2">𝑛</ci><ci id="alg1.l13.2.m2.1.2.3.3.cmml" xref="alg1.l13.2.m2.1.2.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">|X|/n_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.2.m2.1d">| italic_X | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>):</span><span class="ltx_text" id="alg1.l13.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.2.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg1.l14.3" style="font-size:90%;">           </span><math alttext="logit^{+}_{c,i}=\sum_{k=1}^{d}X[I_{c,i}]_{k}\cdot Y[\hat{Z}[I_{c,i}]]_{k}" class="ltx_Math" display="inline" id="alg1.l14.m1.8"><semantics id="alg1.l14.m1.8a"><mrow id="alg1.l14.m1.8.8" xref="alg1.l14.m1.8.8.cmml"><mrow id="alg1.l14.m1.8.8.4" xref="alg1.l14.m1.8.8.4.cmml"><mi id="alg1.l14.m1.8.8.4.2" mathsize="90%" xref="alg1.l14.m1.8.8.4.2.cmml">l</mi><mo id="alg1.l14.m1.8.8.4.1" xref="alg1.l14.m1.8.8.4.1.cmml">⁢</mo><mi id="alg1.l14.m1.8.8.4.3" mathsize="90%" xref="alg1.l14.m1.8.8.4.3.cmml">o</mi><mo id="alg1.l14.m1.8.8.4.1a" xref="alg1.l14.m1.8.8.4.1.cmml">⁢</mo><mi id="alg1.l14.m1.8.8.4.4" mathsize="90%" xref="alg1.l14.m1.8.8.4.4.cmml">g</mi><mo id="alg1.l14.m1.8.8.4.1b" xref="alg1.l14.m1.8.8.4.1.cmml">⁢</mo><mi id="alg1.l14.m1.8.8.4.5" mathsize="90%" xref="alg1.l14.m1.8.8.4.5.cmml">i</mi><mo id="alg1.l14.m1.8.8.4.1c" xref="alg1.l14.m1.8.8.4.1.cmml">⁢</mo><msubsup id="alg1.l14.m1.8.8.4.6" xref="alg1.l14.m1.8.8.4.6.cmml"><mi id="alg1.l14.m1.8.8.4.6.2.2" mathsize="90%" xref="alg1.l14.m1.8.8.4.6.2.2.cmml">t</mi><mrow id="alg1.l14.m1.2.2.2.4" xref="alg1.l14.m1.2.2.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l14.m1.2.2.2.4.1" mathsize="90%" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l14.m1.2.2.2.2" mathsize="90%" xref="alg1.l14.m1.2.2.2.2.cmml">i</mi></mrow><mo id="alg1.l14.m1.8.8.4.6.2.3" mathsize="90%" xref="alg1.l14.m1.8.8.4.6.2.3.cmml">+</mo></msubsup></mrow><mo id="alg1.l14.m1.8.8.3" mathsize="90%" rspace="0.111em" xref="alg1.l14.m1.8.8.3.cmml">=</mo><mrow id="alg1.l14.m1.8.8.2" xref="alg1.l14.m1.8.8.2.cmml"><msubsup id="alg1.l14.m1.8.8.2.3" xref="alg1.l14.m1.8.8.2.3.cmml"><mo id="alg1.l14.m1.8.8.2.3.2.2" maxsize="90%" minsize="90%" stretchy="true" xref="alg1.l14.m1.8.8.2.3.2.2.cmml">∑</mo><mrow id="alg1.l14.m1.8.8.2.3.2.3" xref="alg1.l14.m1.8.8.2.3.2.3.cmml"><mi id="alg1.l14.m1.8.8.2.3.2.3.2" mathsize="90%" xref="alg1.l14.m1.8.8.2.3.2.3.2.cmml">k</mi><mo id="alg1.l14.m1.8.8.2.3.2.3.1" mathsize="90%" xref="alg1.l14.m1.8.8.2.3.2.3.1.cmml">=</mo><mn id="alg1.l14.m1.8.8.2.3.2.3.3" mathsize="90%" xref="alg1.l14.m1.8.8.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l14.m1.8.8.2.3.3" mathsize="90%" xref="alg1.l14.m1.8.8.2.3.3.cmml">d</mi></msubsup><mrow id="alg1.l14.m1.8.8.2.2" xref="alg1.l14.m1.8.8.2.2.cmml"><mrow id="alg1.l14.m1.7.7.1.1.1" xref="alg1.l14.m1.7.7.1.1.1.cmml"><mrow id="alg1.l14.m1.7.7.1.1.1.1" xref="alg1.l14.m1.7.7.1.1.1.1.cmml"><mi id="alg1.l14.m1.7.7.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.7.7.1.1.1.1.3.cmml">X</mi><mo id="alg1.l14.m1.7.7.1.1.1.1.2" xref="alg1.l14.m1.7.7.1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l14.m1.7.7.1.1.1.1.1" xref="alg1.l14.m1.7.7.1.1.1.1.1.cmml"><mrow id="alg1.l14.m1.7.7.1.1.1.1.1.1.1" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">I</mi><mrow id="alg1.l14.m1.4.4.2.4" xref="alg1.l14.m1.4.4.2.3.cmml"><mi id="alg1.l14.m1.3.3.1.1" mathsize="90%" xref="alg1.l14.m1.3.3.1.1.cmml">c</mi><mo id="alg1.l14.m1.4.4.2.4.1" mathsize="90%" xref="alg1.l14.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l14.m1.4.4.2.2" mathsize="90%" xref="alg1.l14.m1.4.4.2.2.cmml">i</mi></mrow></msub><mo id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" rspace="0.055em" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="alg1.l14.m1.7.7.1.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.7.7.1.1.1.1.1.3.cmml">k</mi></msub></mrow><mo id="alg1.l14.m1.7.7.1.1.1.2" mathsize="90%" rspace="0.222em" xref="alg1.l14.m1.7.7.1.1.1.2.cmml">⋅</mo><mi id="alg1.l14.m1.7.7.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.7.7.1.1.1.3.cmml">Y</mi></mrow><mo id="alg1.l14.m1.8.8.2.2.3" xref="alg1.l14.m1.8.8.2.2.3.cmml">⁢</mo><msub id="alg1.l14.m1.8.8.2.2.2" xref="alg1.l14.m1.8.8.2.2.2.cmml"><mrow id="alg1.l14.m1.8.8.2.2.2.1.1" xref="alg1.l14.m1.8.8.2.2.2.1.2.cmml"><mo id="alg1.l14.m1.8.8.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.2.1.cmml">[</mo><mrow id="alg1.l14.m1.8.8.2.2.2.1.1.1" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.cmml"><mover accent="true" id="alg1.l14.m1.8.8.2.2.2.1.1.1.3" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3.cmml"><mi id="alg1.l14.m1.8.8.2.2.2.1.1.1.3.2" mathsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3.2.cmml">Z</mi><mo id="alg1.l14.m1.8.8.2.2.2.1.1.1.3.1" mathsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3.1.cmml">^</mo></mover><mo id="alg1.l14.m1.8.8.2.2.2.1.1.1.2" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.2.cmml"><mo id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.2.1.cmml">[</mo><msub id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.2.cmml">I</mi><mrow id="alg1.l14.m1.6.6.2.4" xref="alg1.l14.m1.6.6.2.3.cmml"><mi id="alg1.l14.m1.5.5.1.1" mathsize="90%" xref="alg1.l14.m1.5.5.1.1.cmml">c</mi><mo id="alg1.l14.m1.6.6.2.4.1" mathsize="90%" xref="alg1.l14.m1.6.6.2.3.cmml">,</mo><mi id="alg1.l14.m1.6.6.2.2" mathsize="90%" xref="alg1.l14.m1.6.6.2.2.cmml">i</mi></mrow></msub><mo id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l14.m1.8.8.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.8.8.2.2.2.1.2.1.cmml">]</mo></mrow><mi id="alg1.l14.m1.8.8.2.2.2.3" mathsize="90%" xref="alg1.l14.m1.8.8.2.2.2.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.8b"><apply id="alg1.l14.m1.8.8.cmml" xref="alg1.l14.m1.8.8"><eq id="alg1.l14.m1.8.8.3.cmml" xref="alg1.l14.m1.8.8.3"></eq><apply id="alg1.l14.m1.8.8.4.cmml" xref="alg1.l14.m1.8.8.4"><times id="alg1.l14.m1.8.8.4.1.cmml" xref="alg1.l14.m1.8.8.4.1"></times><ci id="alg1.l14.m1.8.8.4.2.cmml" xref="alg1.l14.m1.8.8.4.2">𝑙</ci><ci id="alg1.l14.m1.8.8.4.3.cmml" xref="alg1.l14.m1.8.8.4.3">𝑜</ci><ci id="alg1.l14.m1.8.8.4.4.cmml" xref="alg1.l14.m1.8.8.4.4">𝑔</ci><ci id="alg1.l14.m1.8.8.4.5.cmml" xref="alg1.l14.m1.8.8.4.5">𝑖</ci><apply id="alg1.l14.m1.8.8.4.6.cmml" xref="alg1.l14.m1.8.8.4.6"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.4.6.1.cmml" xref="alg1.l14.m1.8.8.4.6">subscript</csymbol><apply id="alg1.l14.m1.8.8.4.6.2.cmml" xref="alg1.l14.m1.8.8.4.6"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.4.6.2.1.cmml" xref="alg1.l14.m1.8.8.4.6">superscript</csymbol><ci id="alg1.l14.m1.8.8.4.6.2.2.cmml" xref="alg1.l14.m1.8.8.4.6.2.2">𝑡</ci><plus id="alg1.l14.m1.8.8.4.6.2.3.cmml" xref="alg1.l14.m1.8.8.4.6.2.3"></plus></apply><list id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.4"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝑐</ci><ci id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2">𝑖</ci></list></apply></apply><apply id="alg1.l14.m1.8.8.2.cmml" xref="alg1.l14.m1.8.8.2"><apply id="alg1.l14.m1.8.8.2.3.cmml" xref="alg1.l14.m1.8.8.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.2.3.1.cmml" xref="alg1.l14.m1.8.8.2.3">superscript</csymbol><apply id="alg1.l14.m1.8.8.2.3.2.cmml" xref="alg1.l14.m1.8.8.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.2.3.2.1.cmml" xref="alg1.l14.m1.8.8.2.3">subscript</csymbol><sum id="alg1.l14.m1.8.8.2.3.2.2.cmml" xref="alg1.l14.m1.8.8.2.3.2.2"></sum><apply id="alg1.l14.m1.8.8.2.3.2.3.cmml" xref="alg1.l14.m1.8.8.2.3.2.3"><eq id="alg1.l14.m1.8.8.2.3.2.3.1.cmml" xref="alg1.l14.m1.8.8.2.3.2.3.1"></eq><ci id="alg1.l14.m1.8.8.2.3.2.3.2.cmml" xref="alg1.l14.m1.8.8.2.3.2.3.2">𝑘</ci><cn id="alg1.l14.m1.8.8.2.3.2.3.3.cmml" type="integer" xref="alg1.l14.m1.8.8.2.3.2.3.3">1</cn></apply></apply><ci id="alg1.l14.m1.8.8.2.3.3.cmml" xref="alg1.l14.m1.8.8.2.3.3">𝑑</ci></apply><apply id="alg1.l14.m1.8.8.2.2.cmml" xref="alg1.l14.m1.8.8.2.2"><times id="alg1.l14.m1.8.8.2.2.3.cmml" xref="alg1.l14.m1.8.8.2.2.3"></times><apply id="alg1.l14.m1.7.7.1.1.1.cmml" xref="alg1.l14.m1.7.7.1.1.1"><ci id="alg1.l14.m1.7.7.1.1.1.2.cmml" xref="alg1.l14.m1.7.7.1.1.1.2">⋅</ci><apply id="alg1.l14.m1.7.7.1.1.1.1.cmml" xref="alg1.l14.m1.7.7.1.1.1.1"><times id="alg1.l14.m1.7.7.1.1.1.1.2.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.2"></times><ci id="alg1.l14.m1.7.7.1.1.1.1.3.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.3">𝑋</ci><apply id="alg1.l14.m1.7.7.1.1.1.1.1.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.7.7.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1">subscript</csymbol><apply id="alg1.l14.m1.7.7.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l14.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.1.1.1.2">𝐼</ci><list id="alg1.l14.m1.4.4.2.3.cmml" xref="alg1.l14.m1.4.4.2.4"><ci id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">𝑐</ci><ci id="alg1.l14.m1.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.2.2">𝑖</ci></list></apply></apply><ci id="alg1.l14.m1.7.7.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.7.7.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="alg1.l14.m1.7.7.1.1.1.3.cmml" xref="alg1.l14.m1.7.7.1.1.1.3">𝑌</ci></apply><apply id="alg1.l14.m1.8.8.2.2.2.cmml" xref="alg1.l14.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.2.2.2.2.cmml" xref="alg1.l14.m1.8.8.2.2.2">subscript</csymbol><apply id="alg1.l14.m1.8.8.2.2.2.1.2.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1"><csymbol cd="latexml" id="alg1.l14.m1.8.8.2.2.2.1.2.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l14.m1.8.8.2.2.2.1.1.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1"><times id="alg1.l14.m1.8.8.2.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.2"></times><apply id="alg1.l14.m1.8.8.2.2.2.1.1.1.3.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3"><ci id="alg1.l14.m1.8.8.2.2.2.1.1.1.3.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3.1">^</ci><ci id="alg1.l14.m1.8.8.2.2.2.1.1.1.3.2.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.3.2">𝑍</ci></apply><apply id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.2.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.8.8.2.2.2.1.1.1.1.1.1.2">𝐼</ci><list id="alg1.l14.m1.6.6.2.3.cmml" xref="alg1.l14.m1.6.6.2.4"><ci id="alg1.l14.m1.5.5.1.1.cmml" xref="alg1.l14.m1.5.5.1.1">𝑐</ci><ci id="alg1.l14.m1.6.6.2.2.cmml" xref="alg1.l14.m1.6.6.2.2">𝑖</ci></list></apply></apply></apply></apply><ci id="alg1.l14.m1.8.8.2.2.2.3.cmml" xref="alg1.l14.m1.8.8.2.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.8c">logit^{+}_{c,i}=\sum_{k=1}^{d}X[I_{c,i}]_{k}\cdot Y[\hat{Z}[I_{c,i}]]_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.8d">italic_l italic_o italic_g italic_i italic_t start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_X [ italic_I start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ italic_Y [ over^ start_ARG italic_Z end_ARG [ italic_I start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT ] ] start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l14.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l14.1" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">▷</annotation></semantics></math> logit for correct class</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg1.l15.2" style="font-size:90%;">           </span><math alttext="loss_{c,i}=-\log\frac{\exp(logit^{+}_{c,i})}{\exp(logit^{+}_{c,i})+\sum_{j=1}^%
{3|Y|/n_{c}}\exp(logits^{-}_{c,i,j})}" class="ltx_Math" display="inline" id="alg1.l15.m1.16"><semantics id="alg1.l15.m1.16a"><mrow id="alg1.l15.m1.16.17" xref="alg1.l15.m1.16.17.cmml"><mrow id="alg1.l15.m1.16.17.2" xref="alg1.l15.m1.16.17.2.cmml"><mi id="alg1.l15.m1.16.17.2.2" mathsize="90%" xref="alg1.l15.m1.16.17.2.2.cmml">l</mi><mo id="alg1.l15.m1.16.17.2.1" xref="alg1.l15.m1.16.17.2.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.17.2.3" mathsize="90%" xref="alg1.l15.m1.16.17.2.3.cmml">o</mi><mo id="alg1.l15.m1.16.17.2.1a" xref="alg1.l15.m1.16.17.2.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.17.2.4" mathsize="90%" xref="alg1.l15.m1.16.17.2.4.cmml">s</mi><mo id="alg1.l15.m1.16.17.2.1b" xref="alg1.l15.m1.16.17.2.1.cmml">⁢</mo><msub id="alg1.l15.m1.16.17.2.5" xref="alg1.l15.m1.16.17.2.5.cmml"><mi id="alg1.l15.m1.16.17.2.5.2" mathsize="90%" xref="alg1.l15.m1.16.17.2.5.2.cmml">s</mi><mrow id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l15.m1.2.2.2.4.1" mathsize="90%" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.2.2.2.2" mathsize="90%" xref="alg1.l15.m1.2.2.2.2.cmml">i</mi></mrow></msub></mrow><mo id="alg1.l15.m1.16.17.1" mathsize="90%" xref="alg1.l15.m1.16.17.1.cmml">=</mo><mrow id="alg1.l15.m1.16.17.3" xref="alg1.l15.m1.16.17.3.cmml"><mo id="alg1.l15.m1.16.17.3a" mathsize="90%" rspace="0.167em" xref="alg1.l15.m1.16.17.3.cmml">−</mo><mrow id="alg1.l15.m1.16.17.3.2" xref="alg1.l15.m1.16.17.3.2.cmml"><mi id="alg1.l15.m1.16.17.3.2.1" mathsize="90%" xref="alg1.l15.m1.16.17.3.2.1.cmml">log</mi><mo id="alg1.l15.m1.16.17.3.2a" lspace="0.167em" xref="alg1.l15.m1.16.17.3.2.cmml">⁡</mo><mfrac id="alg1.l15.m1.16.16" xref="alg1.l15.m1.16.16.cmml"><mrow id="alg1.l15.m1.6.6.4.4" xref="alg1.l15.m1.6.6.4.5.cmml"><mi id="alg1.l15.m1.5.5.3.3" mathsize="90%" xref="alg1.l15.m1.5.5.3.3.cmml">exp</mi><mo id="alg1.l15.m1.6.6.4.4a" xref="alg1.l15.m1.6.6.4.5.cmml">⁡</mo><mrow id="alg1.l15.m1.6.6.4.4.1" xref="alg1.l15.m1.6.6.4.5.cmml"><mo id="alg1.l15.m1.6.6.4.4.1.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.6.6.4.5.cmml">(</mo><mrow id="alg1.l15.m1.6.6.4.4.1.1" xref="alg1.l15.m1.6.6.4.4.1.1.cmml"><mi id="alg1.l15.m1.6.6.4.4.1.1.2" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.2.cmml">l</mi><mo id="alg1.l15.m1.6.6.4.4.1.1.1" xref="alg1.l15.m1.6.6.4.4.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.6.6.4.4.1.1.3" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.3.cmml">o</mi><mo id="alg1.l15.m1.6.6.4.4.1.1.1a" xref="alg1.l15.m1.6.6.4.4.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.6.6.4.4.1.1.4" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.4.cmml">g</mi><mo id="alg1.l15.m1.6.6.4.4.1.1.1b" xref="alg1.l15.m1.6.6.4.4.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.6.6.4.4.1.1.5" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.5.cmml">i</mi><mo id="alg1.l15.m1.6.6.4.4.1.1.1c" xref="alg1.l15.m1.6.6.4.4.1.1.1.cmml">⁢</mo><msubsup id="alg1.l15.m1.6.6.4.4.1.1.6" xref="alg1.l15.m1.6.6.4.4.1.1.6.cmml"><mi id="alg1.l15.m1.6.6.4.4.1.1.6.2.2" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.6.2.2.cmml">t</mi><mrow id="alg1.l15.m1.4.4.2.2.2.4" xref="alg1.l15.m1.4.4.2.2.2.3.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1" mathsize="90%" xref="alg1.l15.m1.3.3.1.1.1.1.cmml">c</mi><mo id="alg1.l15.m1.4.4.2.2.2.4.1" mathsize="90%" xref="alg1.l15.m1.4.4.2.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.4.4.2.2.2.2" mathsize="90%" xref="alg1.l15.m1.4.4.2.2.2.2.cmml">i</mi></mrow><mo id="alg1.l15.m1.6.6.4.4.1.1.6.2.3" mathsize="90%" xref="alg1.l15.m1.6.6.4.4.1.1.6.2.3.cmml">+</mo></msubsup></mrow><mo id="alg1.l15.m1.6.6.4.4.1.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="alg1.l15.m1.16.16.14" xref="alg1.l15.m1.16.16.14.cmml"><mrow id="alg1.l15.m1.15.15.13.9.1" xref="alg1.l15.m1.15.15.13.9.2.cmml"><mi id="alg1.l15.m1.13.13.11.7" mathsize="90%" xref="alg1.l15.m1.13.13.11.7.cmml">exp</mi><mo id="alg1.l15.m1.15.15.13.9.1a" xref="alg1.l15.m1.15.15.13.9.2.cmml">⁡</mo><mrow id="alg1.l15.m1.15.15.13.9.1.1" xref="alg1.l15.m1.15.15.13.9.2.cmml"><mo id="alg1.l15.m1.15.15.13.9.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.15.15.13.9.2.cmml">(</mo><mrow id="alg1.l15.m1.15.15.13.9.1.1.1" xref="alg1.l15.m1.15.15.13.9.1.1.1.cmml"><mi id="alg1.l15.m1.15.15.13.9.1.1.1.2" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.2.cmml">l</mi><mo id="alg1.l15.m1.15.15.13.9.1.1.1.1" xref="alg1.l15.m1.15.15.13.9.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.15.15.13.9.1.1.1.3" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.3.cmml">o</mi><mo id="alg1.l15.m1.15.15.13.9.1.1.1.1a" xref="alg1.l15.m1.15.15.13.9.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.15.15.13.9.1.1.1.4" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.4.cmml">g</mi><mo id="alg1.l15.m1.15.15.13.9.1.1.1.1b" xref="alg1.l15.m1.15.15.13.9.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.15.15.13.9.1.1.1.5" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.5.cmml">i</mi><mo id="alg1.l15.m1.15.15.13.9.1.1.1.1c" xref="alg1.l15.m1.15.15.13.9.1.1.1.1.cmml">⁢</mo><msubsup id="alg1.l15.m1.15.15.13.9.1.1.1.6" xref="alg1.l15.m1.15.15.13.9.1.1.1.6.cmml"><mi id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.2" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.6.2.2.cmml">t</mi><mrow id="alg1.l15.m1.8.8.6.2.2.4" xref="alg1.l15.m1.8.8.6.2.2.3.cmml"><mi id="alg1.l15.m1.7.7.5.1.1.1" mathsize="90%" xref="alg1.l15.m1.7.7.5.1.1.1.cmml">c</mi><mo id="alg1.l15.m1.8.8.6.2.2.4.1" mathsize="90%" xref="alg1.l15.m1.8.8.6.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.8.8.6.2.2.2" mathsize="90%" xref="alg1.l15.m1.8.8.6.2.2.2.cmml">i</mi></mrow><mo id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.3" mathsize="90%" xref="alg1.l15.m1.15.15.13.9.1.1.1.6.2.3.cmml">+</mo></msubsup></mrow><mo id="alg1.l15.m1.15.15.13.9.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.15.15.13.9.2.cmml">)</mo></mrow></mrow><mo id="alg1.l15.m1.16.16.14.11" mathsize="90%" xref="alg1.l15.m1.16.16.14.11.cmml">+</mo><mrow id="alg1.l15.m1.16.16.14.10" xref="alg1.l15.m1.16.16.14.10.cmml"><mstyle displaystyle="false" id="alg1.l15.m1.16.16.14.10.2" xref="alg1.l15.m1.16.16.14.10.2.cmml"><msubsup id="alg1.l15.m1.16.16.14.10.2a" xref="alg1.l15.m1.16.16.14.10.2.cmml"><mo id="alg1.l15.m1.16.16.14.10.2.2.2" maxsize="63%" minsize="63%" stretchy="true" xref="alg1.l15.m1.16.16.14.10.2.2.2.cmml">∑</mo><mrow id="alg1.l15.m1.16.16.14.10.2.2.3" xref="alg1.l15.m1.16.16.14.10.2.2.3.cmml"><mi id="alg1.l15.m1.16.16.14.10.2.2.3.2" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.2.2.3.2.cmml">j</mi><mo id="alg1.l15.m1.16.16.14.10.2.2.3.1" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.2.2.3.1.cmml">=</mo><mn id="alg1.l15.m1.16.16.14.10.2.2.3.3" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l15.m1.9.9.7.3.1" xref="alg1.l15.m1.9.9.7.3.1.cmml"><mrow id="alg1.l15.m1.9.9.7.3.1.3" xref="alg1.l15.m1.9.9.7.3.1.3.cmml"><mn id="alg1.l15.m1.9.9.7.3.1.3.2" mathsize="90%" xref="alg1.l15.m1.9.9.7.3.1.3.2.cmml">3</mn><mo id="alg1.l15.m1.9.9.7.3.1.3.1" xref="alg1.l15.m1.9.9.7.3.1.3.1.cmml">⁢</mo><mrow id="alg1.l15.m1.9.9.7.3.1.3.3.2" xref="alg1.l15.m1.9.9.7.3.1.3.3.1.cmml"><mo id="alg1.l15.m1.9.9.7.3.1.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l15.m1.9.9.7.3.1.3.3.1.1.cmml">|</mo><mi id="alg1.l15.m1.9.9.7.3.1.1" mathsize="90%" xref="alg1.l15.m1.9.9.7.3.1.1.cmml">Y</mi><mo id="alg1.l15.m1.9.9.7.3.1.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.9.9.7.3.1.3.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l15.m1.9.9.7.3.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l15.m1.9.9.7.3.1.2.cmml">/</mo><msub id="alg1.l15.m1.9.9.7.3.1.4" xref="alg1.l15.m1.9.9.7.3.1.4.cmml"><mi id="alg1.l15.m1.9.9.7.3.1.4.2" mathsize="90%" xref="alg1.l15.m1.9.9.7.3.1.4.2.cmml">n</mi><mi id="alg1.l15.m1.9.9.7.3.1.4.3" mathsize="90%" xref="alg1.l15.m1.9.9.7.3.1.4.3.cmml">c</mi></msub></mrow></msubsup></mstyle><mrow id="alg1.l15.m1.16.16.14.10.1.1" xref="alg1.l15.m1.16.16.14.10.1.2.cmml"><mi id="alg1.l15.m1.14.14.12.8" mathsize="90%" xref="alg1.l15.m1.14.14.12.8.cmml">exp</mi><mo id="alg1.l15.m1.16.16.14.10.1.1a" xref="alg1.l15.m1.16.16.14.10.1.2.cmml">⁡</mo><mrow id="alg1.l15.m1.16.16.14.10.1.1.1" xref="alg1.l15.m1.16.16.14.10.1.2.cmml"><mo id="alg1.l15.m1.16.16.14.10.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.16.16.14.10.1.2.cmml">(</mo><mrow id="alg1.l15.m1.16.16.14.10.1.1.1.1" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.cmml"><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.2" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.2.cmml">l</mi><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.1" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.3" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.3.cmml">o</mi><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.1a" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.4" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.4.cmml">g</mi><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.1b" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.5" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.5.cmml">i</mi><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.1c" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.6" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.6.cmml">t</mi><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.1d" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml">⁢</mo><msubsup id="alg1.l15.m1.16.16.14.10.1.1.1.1.7" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7.cmml"><mi id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.2" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.2.cmml">s</mi><mrow id="alg1.l15.m1.12.12.10.6.3.5" xref="alg1.l15.m1.12.12.10.6.3.4.cmml"><mi id="alg1.l15.m1.10.10.8.4.1.1" mathsize="90%" xref="alg1.l15.m1.10.10.8.4.1.1.cmml">c</mi><mo id="alg1.l15.m1.12.12.10.6.3.5.1" mathsize="90%" xref="alg1.l15.m1.12.12.10.6.3.4.cmml">,</mo><mi id="alg1.l15.m1.11.11.9.5.2.2" mathsize="90%" xref="alg1.l15.m1.11.11.9.5.2.2.cmml">i</mi><mo id="alg1.l15.m1.12.12.10.6.3.5.2" mathsize="90%" xref="alg1.l15.m1.12.12.10.6.3.4.cmml">,</mo><mi id="alg1.l15.m1.12.12.10.6.3.3" mathsize="90%" xref="alg1.l15.m1.12.12.10.6.3.3.cmml">j</mi></mrow><mo id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.3" mathsize="90%" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.3.cmml">−</mo></msubsup></mrow><mo id="alg1.l15.m1.16.16.14.10.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.16.16.14.10.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.16b"><apply id="alg1.l15.m1.16.17.cmml" xref="alg1.l15.m1.16.17"><eq id="alg1.l15.m1.16.17.1.cmml" xref="alg1.l15.m1.16.17.1"></eq><apply id="alg1.l15.m1.16.17.2.cmml" xref="alg1.l15.m1.16.17.2"><times id="alg1.l15.m1.16.17.2.1.cmml" xref="alg1.l15.m1.16.17.2.1"></times><ci id="alg1.l15.m1.16.17.2.2.cmml" xref="alg1.l15.m1.16.17.2.2">𝑙</ci><ci id="alg1.l15.m1.16.17.2.3.cmml" xref="alg1.l15.m1.16.17.2.3">𝑜</ci><ci id="alg1.l15.m1.16.17.2.4.cmml" xref="alg1.l15.m1.16.17.2.4">𝑠</ci><apply id="alg1.l15.m1.16.17.2.5.cmml" xref="alg1.l15.m1.16.17.2.5"><csymbol cd="ambiguous" id="alg1.l15.m1.16.17.2.5.1.cmml" xref="alg1.l15.m1.16.17.2.5">subscript</csymbol><ci id="alg1.l15.m1.16.17.2.5.2.cmml" xref="alg1.l15.m1.16.17.2.5.2">𝑠</ci><list id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.4"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑐</ci><ci id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2">𝑖</ci></list></apply></apply><apply id="alg1.l15.m1.16.17.3.cmml" xref="alg1.l15.m1.16.17.3"><minus id="alg1.l15.m1.16.17.3.1.cmml" xref="alg1.l15.m1.16.17.3"></minus><apply id="alg1.l15.m1.16.17.3.2.cmml" xref="alg1.l15.m1.16.17.3.2"><log id="alg1.l15.m1.16.17.3.2.1.cmml" xref="alg1.l15.m1.16.17.3.2.1"></log><apply id="alg1.l15.m1.16.16.cmml" xref="alg1.l15.m1.16.16"><divide id="alg1.l15.m1.16.16.15.cmml" xref="alg1.l15.m1.16.16"></divide><apply id="alg1.l15.m1.6.6.4.5.cmml" xref="alg1.l15.m1.6.6.4.4"><exp id="alg1.l15.m1.5.5.3.3.cmml" xref="alg1.l15.m1.5.5.3.3"></exp><apply id="alg1.l15.m1.6.6.4.4.1.1.cmml" xref="alg1.l15.m1.6.6.4.4.1.1"><times id="alg1.l15.m1.6.6.4.4.1.1.1.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.1"></times><ci id="alg1.l15.m1.6.6.4.4.1.1.2.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.2">𝑙</ci><ci id="alg1.l15.m1.6.6.4.4.1.1.3.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.3">𝑜</ci><ci id="alg1.l15.m1.6.6.4.4.1.1.4.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.4">𝑔</ci><ci id="alg1.l15.m1.6.6.4.4.1.1.5.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.5">𝑖</ci><apply id="alg1.l15.m1.6.6.4.4.1.1.6.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.4.4.1.1.6.1.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6">subscript</csymbol><apply id="alg1.l15.m1.6.6.4.4.1.1.6.2.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.4.4.1.1.6.2.1.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6">superscript</csymbol><ci id="alg1.l15.m1.6.6.4.4.1.1.6.2.2.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6.2.2">𝑡</ci><plus id="alg1.l15.m1.6.6.4.4.1.1.6.2.3.cmml" xref="alg1.l15.m1.6.6.4.4.1.1.6.2.3"></plus></apply><list id="alg1.l15.m1.4.4.2.2.2.3.cmml" xref="alg1.l15.m1.4.4.2.2.2.4"><ci id="alg1.l15.m1.3.3.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1">𝑐</ci><ci id="alg1.l15.m1.4.4.2.2.2.2.cmml" xref="alg1.l15.m1.4.4.2.2.2.2">𝑖</ci></list></apply></apply></apply><apply id="alg1.l15.m1.16.16.14.cmml" xref="alg1.l15.m1.16.16.14"><plus id="alg1.l15.m1.16.16.14.11.cmml" xref="alg1.l15.m1.16.16.14.11"></plus><apply id="alg1.l15.m1.15.15.13.9.2.cmml" xref="alg1.l15.m1.15.15.13.9.1"><exp id="alg1.l15.m1.13.13.11.7.cmml" xref="alg1.l15.m1.13.13.11.7"></exp><apply id="alg1.l15.m1.15.15.13.9.1.1.1.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1"><times id="alg1.l15.m1.15.15.13.9.1.1.1.1.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.1"></times><ci id="alg1.l15.m1.15.15.13.9.1.1.1.2.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.2">𝑙</ci><ci id="alg1.l15.m1.15.15.13.9.1.1.1.3.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.3">𝑜</ci><ci id="alg1.l15.m1.15.15.13.9.1.1.1.4.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.4">𝑔</ci><ci id="alg1.l15.m1.15.15.13.9.1.1.1.5.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.5">𝑖</ci><apply id="alg1.l15.m1.15.15.13.9.1.1.1.6.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6"><csymbol cd="ambiguous" id="alg1.l15.m1.15.15.13.9.1.1.1.6.1.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6">subscript</csymbol><apply id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6"><csymbol cd="ambiguous" id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.1.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6">superscript</csymbol><ci id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.2.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6.2.2">𝑡</ci><plus id="alg1.l15.m1.15.15.13.9.1.1.1.6.2.3.cmml" xref="alg1.l15.m1.15.15.13.9.1.1.1.6.2.3"></plus></apply><list id="alg1.l15.m1.8.8.6.2.2.3.cmml" xref="alg1.l15.m1.8.8.6.2.2.4"><ci id="alg1.l15.m1.7.7.5.1.1.1.cmml" xref="alg1.l15.m1.7.7.5.1.1.1">𝑐</ci><ci id="alg1.l15.m1.8.8.6.2.2.2.cmml" xref="alg1.l15.m1.8.8.6.2.2.2">𝑖</ci></list></apply></apply></apply><apply id="alg1.l15.m1.16.16.14.10.cmml" xref="alg1.l15.m1.16.16.14.10"><apply id="alg1.l15.m1.16.16.14.10.2.cmml" xref="alg1.l15.m1.16.16.14.10.2"><csymbol cd="ambiguous" id="alg1.l15.m1.16.16.14.10.2.1.cmml" xref="alg1.l15.m1.16.16.14.10.2">superscript</csymbol><apply id="alg1.l15.m1.16.16.14.10.2.2.cmml" xref="alg1.l15.m1.16.16.14.10.2"><csymbol cd="ambiguous" id="alg1.l15.m1.16.16.14.10.2.2.1.cmml" xref="alg1.l15.m1.16.16.14.10.2">subscript</csymbol><sum id="alg1.l15.m1.16.16.14.10.2.2.2.cmml" xref="alg1.l15.m1.16.16.14.10.2.2.2"></sum><apply id="alg1.l15.m1.16.16.14.10.2.2.3.cmml" xref="alg1.l15.m1.16.16.14.10.2.2.3"><eq id="alg1.l15.m1.16.16.14.10.2.2.3.1.cmml" xref="alg1.l15.m1.16.16.14.10.2.2.3.1"></eq><ci id="alg1.l15.m1.16.16.14.10.2.2.3.2.cmml" xref="alg1.l15.m1.16.16.14.10.2.2.3.2">𝑗</ci><cn id="alg1.l15.m1.16.16.14.10.2.2.3.3.cmml" type="integer" xref="alg1.l15.m1.16.16.14.10.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.9.9.7.3.1.cmml" xref="alg1.l15.m1.9.9.7.3.1"><divide id="alg1.l15.m1.9.9.7.3.1.2.cmml" xref="alg1.l15.m1.9.9.7.3.1.2"></divide><apply id="alg1.l15.m1.9.9.7.3.1.3.cmml" xref="alg1.l15.m1.9.9.7.3.1.3"><times id="alg1.l15.m1.9.9.7.3.1.3.1.cmml" xref="alg1.l15.m1.9.9.7.3.1.3.1"></times><cn id="alg1.l15.m1.9.9.7.3.1.3.2.cmml" type="integer" xref="alg1.l15.m1.9.9.7.3.1.3.2">3</cn><apply id="alg1.l15.m1.9.9.7.3.1.3.3.1.cmml" xref="alg1.l15.m1.9.9.7.3.1.3.3.2"><abs id="alg1.l15.m1.9.9.7.3.1.3.3.1.1.cmml" xref="alg1.l15.m1.9.9.7.3.1.3.3.2.1"></abs><ci id="alg1.l15.m1.9.9.7.3.1.1.cmml" xref="alg1.l15.m1.9.9.7.3.1.1">𝑌</ci></apply></apply><apply id="alg1.l15.m1.9.9.7.3.1.4.cmml" xref="alg1.l15.m1.9.9.7.3.1.4"><csymbol cd="ambiguous" id="alg1.l15.m1.9.9.7.3.1.4.1.cmml" xref="alg1.l15.m1.9.9.7.3.1.4">subscript</csymbol><ci id="alg1.l15.m1.9.9.7.3.1.4.2.cmml" xref="alg1.l15.m1.9.9.7.3.1.4.2">𝑛</ci><ci id="alg1.l15.m1.9.9.7.3.1.4.3.cmml" xref="alg1.l15.m1.9.9.7.3.1.4.3">𝑐</ci></apply></apply></apply><apply id="alg1.l15.m1.16.16.14.10.1.2.cmml" xref="alg1.l15.m1.16.16.14.10.1.1"><exp id="alg1.l15.m1.14.14.12.8.cmml" xref="alg1.l15.m1.14.14.12.8"></exp><apply id="alg1.l15.m1.16.16.14.10.1.1.1.1.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1"><times id="alg1.l15.m1.16.16.14.10.1.1.1.1.1.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.1"></times><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.2.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.2">𝑙</ci><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.3.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.3">𝑜</ci><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.4.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.4">𝑔</ci><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.5.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.5">𝑖</ci><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.6.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.6">𝑡</ci><apply id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7"><csymbol cd="ambiguous" id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.1.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7">subscript</csymbol><apply id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7"><csymbol cd="ambiguous" id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.1.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7">superscript</csymbol><ci id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.2.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.2">𝑠</ci><minus id="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.3.cmml" xref="alg1.l15.m1.16.16.14.10.1.1.1.1.7.2.3"></minus></apply><list id="alg1.l15.m1.12.12.10.6.3.4.cmml" xref="alg1.l15.m1.12.12.10.6.3.5"><ci id="alg1.l15.m1.10.10.8.4.1.1.cmml" xref="alg1.l15.m1.10.10.8.4.1.1">𝑐</ci><ci id="alg1.l15.m1.11.11.9.5.2.2.cmml" xref="alg1.l15.m1.11.11.9.5.2.2">𝑖</ci><ci id="alg1.l15.m1.12.12.10.6.3.3.cmml" xref="alg1.l15.m1.12.12.10.6.3.3">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.16c">loss_{c,i}=-\log\frac{\exp(logit^{+}_{c,i})}{\exp(logit^{+}_{c,i})+\sum_{j=1}^%
{3|Y|/n_{c}}\exp(logits^{-}_{c,i,j})}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.16d">italic_l italic_o italic_s italic_s start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 | italic_Y | / italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT roman_exp ( italic_l italic_o italic_g italic_i italic_t italic_s start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c , italic_i , italic_j end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l15.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.2.1.1" style="font-size:80%;">16:</span></span><math alttext="\mathcal{L}_{\text{RECE}}=\frac{1}{|X|}\sum_{c,i}loss_{c,i}" class="ltx_Math" display="inline" id="alg1.l16.m1.5"><semantics id="alg1.l16.m1.5a"><mrow id="alg1.l16.m1.5.6" xref="alg1.l16.m1.5.6.cmml"><msub id="alg1.l16.m1.5.6.2" xref="alg1.l16.m1.5.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.5.6.2.2" mathsize="90%" xref="alg1.l16.m1.5.6.2.2.cmml">ℒ</mi><mtext id="alg1.l16.m1.5.6.2.3" mathsize="90%" xref="alg1.l16.m1.5.6.2.3a.cmml">RECE</mtext></msub><mo id="alg1.l16.m1.5.6.1" mathsize="90%" xref="alg1.l16.m1.5.6.1.cmml">=</mo><mrow id="alg1.l16.m1.5.6.3" xref="alg1.l16.m1.5.6.3.cmml"><mfrac id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mn id="alg1.l16.m1.1.1.3" mathsize="90%" xref="alg1.l16.m1.1.1.3.cmml">1</mn><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.2.cmml"><mo id="alg1.l16.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="alg1.l16.m1.1.1.1.2.1.cmml">|</mo><mi id="alg1.l16.m1.1.1.1.1" mathsize="90%" xref="alg1.l16.m1.1.1.1.1.cmml">X</mi><mo id="alg1.l16.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="alg1.l16.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="alg1.l16.m1.5.6.3.1" xref="alg1.l16.m1.5.6.3.1.cmml">⁢</mo><mrow id="alg1.l16.m1.5.6.3.2" xref="alg1.l16.m1.5.6.3.2.cmml"><msub id="alg1.l16.m1.5.6.3.2.1" xref="alg1.l16.m1.5.6.3.2.1.cmml"><mo id="alg1.l16.m1.5.6.3.2.1.2" maxsize="90%" minsize="90%" stretchy="true" xref="alg1.l16.m1.5.6.3.2.1.2.cmml">∑</mo><mrow id="alg1.l16.m1.3.3.2.4" xref="alg1.l16.m1.3.3.2.3.cmml"><mi id="alg1.l16.m1.2.2.1.1" mathsize="90%" xref="alg1.l16.m1.2.2.1.1.cmml">c</mi><mo id="alg1.l16.m1.3.3.2.4.1" mathsize="90%" xref="alg1.l16.m1.3.3.2.3.cmml">,</mo><mi id="alg1.l16.m1.3.3.2.2" mathsize="90%" xref="alg1.l16.m1.3.3.2.2.cmml">i</mi></mrow></msub><mrow id="alg1.l16.m1.5.6.3.2.2" xref="alg1.l16.m1.5.6.3.2.2.cmml"><mi id="alg1.l16.m1.5.6.3.2.2.2" mathsize="90%" xref="alg1.l16.m1.5.6.3.2.2.2.cmml">l</mi><mo id="alg1.l16.m1.5.6.3.2.2.1" xref="alg1.l16.m1.5.6.3.2.2.1.cmml">⁢</mo><mi id="alg1.l16.m1.5.6.3.2.2.3" mathsize="90%" xref="alg1.l16.m1.5.6.3.2.2.3.cmml">o</mi><mo id="alg1.l16.m1.5.6.3.2.2.1a" xref="alg1.l16.m1.5.6.3.2.2.1.cmml">⁢</mo><mi id="alg1.l16.m1.5.6.3.2.2.4" mathsize="90%" xref="alg1.l16.m1.5.6.3.2.2.4.cmml">s</mi><mo id="alg1.l16.m1.5.6.3.2.2.1b" xref="alg1.l16.m1.5.6.3.2.2.1.cmml">⁢</mo><msub id="alg1.l16.m1.5.6.3.2.2.5" xref="alg1.l16.m1.5.6.3.2.2.5.cmml"><mi id="alg1.l16.m1.5.6.3.2.2.5.2" mathsize="90%" xref="alg1.l16.m1.5.6.3.2.2.5.2.cmml">s</mi><mrow id="alg1.l16.m1.5.5.2.4" xref="alg1.l16.m1.5.5.2.3.cmml"><mi id="alg1.l16.m1.4.4.1.1" mathsize="90%" xref="alg1.l16.m1.4.4.1.1.cmml">c</mi><mo id="alg1.l16.m1.5.5.2.4.1" mathsize="90%" xref="alg1.l16.m1.5.5.2.3.cmml">,</mo><mi id="alg1.l16.m1.5.5.2.2" mathsize="90%" xref="alg1.l16.m1.5.5.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.5b"><apply id="alg1.l16.m1.5.6.cmml" xref="alg1.l16.m1.5.6"><eq id="alg1.l16.m1.5.6.1.cmml" xref="alg1.l16.m1.5.6.1"></eq><apply id="alg1.l16.m1.5.6.2.cmml" xref="alg1.l16.m1.5.6.2"><csymbol cd="ambiguous" id="alg1.l16.m1.5.6.2.1.cmml" xref="alg1.l16.m1.5.6.2">subscript</csymbol><ci id="alg1.l16.m1.5.6.2.2.cmml" xref="alg1.l16.m1.5.6.2.2">ℒ</ci><ci id="alg1.l16.m1.5.6.2.3a.cmml" xref="alg1.l16.m1.5.6.2.3"><mtext id="alg1.l16.m1.5.6.2.3.cmml" mathsize="63%" xref="alg1.l16.m1.5.6.2.3">RECE</mtext></ci></apply><apply id="alg1.l16.m1.5.6.3.cmml" xref="alg1.l16.m1.5.6.3"><times id="alg1.l16.m1.5.6.3.1.cmml" xref="alg1.l16.m1.5.6.3.1"></times><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><divide id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1"></divide><cn id="alg1.l16.m1.1.1.3.cmml" type="integer" xref="alg1.l16.m1.1.1.3">1</cn><apply id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.3"><abs id="alg1.l16.m1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.3.1"></abs><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑋</ci></apply></apply><apply id="alg1.l16.m1.5.6.3.2.cmml" xref="alg1.l16.m1.5.6.3.2"><apply id="alg1.l16.m1.5.6.3.2.1.cmml" xref="alg1.l16.m1.5.6.3.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.5.6.3.2.1.1.cmml" xref="alg1.l16.m1.5.6.3.2.1">subscript</csymbol><sum id="alg1.l16.m1.5.6.3.2.1.2.cmml" xref="alg1.l16.m1.5.6.3.2.1.2"></sum><list id="alg1.l16.m1.3.3.2.3.cmml" xref="alg1.l16.m1.3.3.2.4"><ci id="alg1.l16.m1.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.1.1">𝑐</ci><ci id="alg1.l16.m1.3.3.2.2.cmml" xref="alg1.l16.m1.3.3.2.2">𝑖</ci></list></apply><apply id="alg1.l16.m1.5.6.3.2.2.cmml" xref="alg1.l16.m1.5.6.3.2.2"><times id="alg1.l16.m1.5.6.3.2.2.1.cmml" xref="alg1.l16.m1.5.6.3.2.2.1"></times><ci id="alg1.l16.m1.5.6.3.2.2.2.cmml" xref="alg1.l16.m1.5.6.3.2.2.2">𝑙</ci><ci id="alg1.l16.m1.5.6.3.2.2.3.cmml" xref="alg1.l16.m1.5.6.3.2.2.3">𝑜</ci><ci id="alg1.l16.m1.5.6.3.2.2.4.cmml" xref="alg1.l16.m1.5.6.3.2.2.4">𝑠</ci><apply id="alg1.l16.m1.5.6.3.2.2.5.cmml" xref="alg1.l16.m1.5.6.3.2.2.5"><csymbol cd="ambiguous" id="alg1.l16.m1.5.6.3.2.2.5.1.cmml" xref="alg1.l16.m1.5.6.3.2.2.5">subscript</csymbol><ci id="alg1.l16.m1.5.6.3.2.2.5.2.cmml" xref="alg1.l16.m1.5.6.3.2.2.5.2">𝑠</ci><list id="alg1.l16.m1.5.5.2.3.cmml" xref="alg1.l16.m1.5.5.2.4"><ci id="alg1.l16.m1.4.4.1.1.cmml" xref="alg1.l16.m1.4.4.1.1">𝑐</ci><ci id="alg1.l16.m1.5.5.2.2.cmml" xref="alg1.l16.m1.5.5.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.5c">\mathcal{L}_{\text{RECE}}=\frac{1}{|X|}\sum_{c,i}loss_{c,i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.5d">caligraphic_L start_POSTSUBSCRIPT RECE end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_X | end_ARG ∑ start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT italic_l italic_o italic_s italic_s start_POSTSUBSCRIPT italic_c , italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l16.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l16.1" style="font-size:80%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l16.1.m1.1"><semantics id="alg1.l16.1.m1.1a"><mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.1.m1.1d">▷</annotation></semantics></math> accumulation of loss values</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">In this work, we utilize SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>)</cite> as our base model due to its widespread use in the literature <cite class="ltx_cite ltx_citemacro_citep">(Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib37" title="">2022</a>; Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite> and its state-of-the-art performance in sequential recommendations with full Cross-Entropy loss <cite class="ltx_cite ltx_citemacro_citep">(Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>)</cite>. Although our primary focus on the RECE method is on recommender systems, where managing large catalogs is a common challenge, the applicability of this approach extends to various domains such as NLP, search systems, computer vision tasks, bioinformatics, and other areas, where tasks with extensive vocabularies or large number of classes are a common bottleneck.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experimental Settings</h2>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h3 class="ltx_title ltx_title_paragraph">Datasets</h3>
<div class="ltx_para" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.4">We conduct our main experiments on four diverse real-world datasets: BeerAdvocate <cite class="ltx_cite ltx_citemacro_citep">(McAuley et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib24" title="">2012</a>)</cite>, Behance <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib16" title="">2016</a>)</cite>, Amazon Kindle Store <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib27" title="">2019</a>)</cite>, and Gowalla <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib8" title="">2011</a>)</cite>. In line with previous research <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib36" title="">2018</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib35" title="">2019</a>)</cite>, we interpret the presence of a review or rating as implicit feedback. Additionally, following common practice <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib20" title="">2018</a>; Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib33" title="">2010</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib44" title="">2019</a>)</cite> and to ensure the number of items in datasets allows for computing full Cross-Entropy loss within GPU memory constraints, we exclude unpopular items with fewer than <math alttext="5" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><cn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.1.m1.1d">5</annotation></semantics></math> interactions and remove users who have fewer than <math alttext="20" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS0.SSS0.Px1.p1.2.m2.1a"><mn id="S4.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.2.m2.1b"><cn id="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.2.m2.1d">20</annotation></semantics></math> interactions. The final dataset statistics are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.T1" title="Table 1 ‣ Datasets ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">1</span></a>. The number of items ranges from <math alttext="22,307" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.3.m3.2"><semantics id="S4.SS0.SSS0.Px1.p1.3.m3.2a"><mrow id="S4.SS0.SSS0.Px1.p1.3.m3.2.3.2" xref="S4.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml"><mn id="S4.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">22</mn><mo id="S4.SS0.SSS0.Px1.p1.3.m3.2.3.2.1" xref="S4.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px1.p1.3.m3.2.2" xref="S4.SS0.SSS0.Px1.p1.3.m3.2.2.cmml">307</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.3.m3.2b"><list id="S4.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m3.2.3.2"><cn id="S4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.3.m3.1.1">22</cn><cn id="S4.SS0.SSS0.Px1.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.3.m3.2.2">307</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.3.m3.2c">22,307</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.3.m3.2d">22 , 307</annotation></semantics></math> in BeerAdvocate to <math alttext="173,511" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.4.m4.2"><semantics id="S4.SS0.SSS0.Px1.p1.4.m4.2a"><mrow id="S4.SS0.SSS0.Px1.p1.4.m4.2.3.2" xref="S4.SS0.SSS0.Px1.p1.4.m4.2.3.1.cmml"><mn id="S4.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">173</mn><mo id="S4.SS0.SSS0.Px1.p1.4.m4.2.3.2.1" xref="S4.SS0.SSS0.Px1.p1.4.m4.2.3.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px1.p1.4.m4.2.2" xref="S4.SS0.SSS0.Px1.p1.4.m4.2.2.cmml">511</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.4.m4.2b"><list id="S4.SS0.SSS0.Px1.p1.4.m4.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.4.m4.2.3.2"><cn id="S4.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.4.m4.1.1">173</cn><cn id="S4.SS0.SSS0.Px1.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.4.m4.2.2">511</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.4.m4.2c">173,511</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.4.m4.2d">173 , 511</annotation></semantics></math> in Gowalla, allowing us to evaluate methods under various memory consumption conditions.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.4.1.1" style="font-size:113%;">Table 1</span>. </span><span class="ltx_text ltx_font_bold" id="S4.T1.5.2" style="font-size:113%;">Statistics of the datasets after preprocessing.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.6" style="width:433.6pt;height:90.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.0pt,-0.2pt) scale(1.00483320410655,1.00483320410655) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T1.6.1.1.1.1"><span class="ltx_text" id="S4.T1.6.1.1.1.1.1" style="font-size:80%;">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T1.6.1.1.1.2"><span class="ltx_text" id="S4.T1.6.1.1.1.2.1" style="font-size:80%;">Domain</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.1.1.3"><span class="ltx_text" id="S4.T1.6.1.1.1.3.1" style="font-size:80%;">Users</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.1.1.4"><span class="ltx_text" id="S4.T1.6.1.1.1.4.1" style="font-size:80%;">Items</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.1.1.5"><span class="ltx_text" id="S4.T1.6.1.1.1.5.1" style="font-size:80%;">Interactions</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.1.1.6"><span class="ltx_text" id="S4.T1.6.1.1.1.6.1" style="font-size:80%;">Density</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.1.2.1.1">
<span class="ltx_text" id="S4.T1.6.1.2.1.1.1" style="font-size:80%;">BeerAdvocate </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T1.6.1.2.1.1.2.1" style="font-size:80%;">(</span>McAuley et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T1.6.1.2.1.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib24" title="">2012</a><span class="ltx_text" id="S4.T1.6.1.2.1.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.1.2.1.2"><span class="ltx_text" id="S4.T1.6.1.2.1.2.1" style="font-size:80%;">Food</span></th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.6.1.2.1.3"><span class="ltx_text" id="S4.T1.6.1.2.1.3.1" style="font-size:80%;">7,606</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.6.1.2.1.4"><span class="ltx_text" id="S4.T1.6.1.2.1.4.1" style="font-size:80%;">22,307</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.6.1.2.1.5"><span class="ltx_text" id="S4.T1.6.1.2.1.5.1" style="font-size:80%;">1,409,494</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.6.1.2.1.6"><span class="ltx_text" id="S4.T1.6.1.2.1.6.1" style="font-size:80%;">0.83%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.1.3.2.1">
<span class="ltx_text" id="S4.T1.6.1.3.2.1.1" style="font-size:80%;">Behance </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T1.6.1.3.2.1.2.1" style="font-size:80%;">(</span>He et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T1.6.1.3.2.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib16" title="">2016</a><span class="ltx_text" id="S4.T1.6.1.3.2.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.1.3.2.2"><span class="ltx_text" id="S4.T1.6.1.3.2.2.1" style="font-size:80%;">Art</span></th>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.3.2.3"><span class="ltx_text" id="S4.T1.6.1.3.2.3.1" style="font-size:80%;">8,097</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.3.2.4"><span class="ltx_text" id="S4.T1.6.1.3.2.4.1" style="font-size:80%;">32,434</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.3.2.5"><span class="ltx_text" id="S4.T1.6.1.3.2.5.1" style="font-size:80%;">546,284</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.3.2.6"><span class="ltx_text" id="S4.T1.6.1.3.2.6.1" style="font-size:80%;">0.21%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.1.4.3.1">
<span class="ltx_text" id="S4.T1.6.1.4.3.1.1" style="font-size:80%;">Kindle Store </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T1.6.1.4.3.1.2.1" style="font-size:80%;">(</span>Ni et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T1.6.1.4.3.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib27" title="">2019</a><span class="ltx_text" id="S4.T1.6.1.4.3.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.1.4.3.2"><span class="ltx_text" id="S4.T1.6.1.4.3.2.1" style="font-size:80%;">E-com</span></th>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.4.3.3"><span class="ltx_text" id="S4.T1.6.1.4.3.3.1" style="font-size:80%;">23,684</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.4.3.4"><span class="ltx_text" id="S4.T1.6.1.4.3.4.1" style="font-size:80%;">96,830</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.4.3.5"><span class="ltx_text" id="S4.T1.6.1.4.3.5.1" style="font-size:80%;">1,256,065</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.6.1.4.3.6"><span class="ltx_text" id="S4.T1.6.1.4.3.6.1" style="font-size:80%;">0.05%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S4.T1.6.1.5.4.1">
<span class="ltx_text" id="S4.T1.6.1.5.4.1.1" style="font-size:80%;">Gowalla </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T1.6.1.5.4.1.2.1" style="font-size:80%;">(</span>Cho et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T1.6.1.5.4.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib8" title="">2011</a><span class="ltx_text" id="S4.T1.6.1.5.4.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S4.T1.6.1.5.4.2"><span class="ltx_text" id="S4.T1.6.1.5.4.2.1" style="font-size:80%;">Soc. Net.</span></th>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.6.1.5.4.3"><span class="ltx_text" id="S4.T1.6.1.5.4.3.1" style="font-size:80%;">27,516</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.6.1.5.4.4"><span class="ltx_text" id="S4.T1.6.1.5.4.4.1" style="font-size:80%;">173,511</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.6.1.5.4.5"><span class="ltx_text" id="S4.T1.6.1.5.4.5.1" style="font-size:80%;">2,627,663</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.6.1.5.4.6"><span class="ltx_text" id="S4.T1.6.1.5.4.6.1" style="font-size:80%;">0.06%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h3 class="ltx_title ltx_title_paragraph">Evaluation</h3>
<div class="ltx_para" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">In offline testing, data splitting using the leave-one-out approach, often by selecting each user’s last interaction, is common in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>; Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>)</cite>. However, this method can lead to data leakage affecting evaluation accuracy <cite class="ltx_cite ltx_citemacro_citep">(Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib19" title="">2023</a>; Meng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib26" title="">2020</a>)</cite>. To mitigate this, we set a global timestamp at the <math alttext="0.95" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">0.95</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.1.m1.1b"><cn id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" type="float" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1">0.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.1.m1.1c">0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p1.1.m1.1d">0.95</annotation></semantics></math> quantile of all interactions <cite class="ltx_cite ltx_citemacro_citep">(Frolov and Oseledets, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib14" title="">2022</a>)</cite>. Interactions before this timestamp are used for training, while interactions after – for testing, keeping test users separate from the training data (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.F3" title="Figure 3 ‣ Evaluation ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">3</span></a>). For test users, we use their last interaction to evaluate model performance. This temporal split prevents ”recommendations from future” bias <cite class="ltx_cite ltx_citemacro_citep">(Meng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib26" title="">2020</a>)</cite>, ensuring the model remains unaware of future interactions. In addition, we use the second-to-last interaction of each test user for validation to tune the model and to control its convergence via early stopping.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="272" id="S4.F3.g1" src="x3.png" width="829"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Temporal data splitting strategy.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F3.4">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F3.5">[]</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p2.1">Following best practices <cite class="ltx_cite ltx_citemacro_citep">(Dallmann et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib9" title="">2021</a>; Cañamares and Castells, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib6" title="">2020</a>)</cite>, we use unsampled top-K ranking metrics: Normalized Discounted Cumulative Gain (NDCG@K) and Hit Rate (HR@K), with K <math alttext="=1,5,10" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p2.1.m1.3"><semantics id="S4.SS0.SSS0.Px2.p2.1.m1.3a"><mrow id="S4.SS0.SSS0.Px2.p2.1.m1.3.4" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.cmml"><mi id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.2" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.2.cmml"></mi><mo id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.1" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml">=</mo><mrow id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.2" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.1.cmml"><mn id="S4.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p2.1.m1.1.1.cmml">1</mn><mo id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.2.1" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px2.p2.1.m1.2.2" xref="S4.SS0.SSS0.Px2.p2.1.m1.2.2.cmml">5</mn><mo id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.2.2" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px2.p2.1.m1.3.3" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.3.cmml">10</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p2.1.m1.3b"><apply id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.cmml" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4"><eq id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.1.cmml" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.1"></eq><csymbol cd="latexml" id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.2.cmml" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.2">absent</csymbol><list id="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.1.cmml" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.4.3.2"><cn id="S4.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p2.1.m1.1.1">1</cn><cn id="S4.SS0.SSS0.Px2.p2.1.m1.2.2.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p2.1.m1.2.2">5</cn><cn id="S4.SS0.SSS0.Px2.p2.1.m1.3.3.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p2.1.m1.3.3">10</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p2.1.m1.3c">=1,5,10</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p2.1.m1.3d">= 1 , 5 , 10</annotation></semantics></math>. Our goal is to balance time consumption, memory efficiency, and ranking performance, so we also measure training time and peak GPU memory during training.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px3">
<h3 class="ltx_title ltx_title_paragraph">Model and Baselines</h3>
<div class="ltx_para" id="S4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px3.p1.2">In our experiments, we use SASRec as the base model and enhance it with the proposed RECE loss. We focus on comparing <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px3.p1.2.3">SASRec-RECE</span> with the model incorporating Binary Cross-Entropy loss with multiple negative samples (<span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px3.p1.1.1">SASRec-BCE<sup class="ltx_sup" id="S4.SS0.SSS0.Px3.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="S4.SS0.SSS0.Px3.p1.1.1.1.1">+</span></sup></span>), detailed in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S2.E1" title="In 2. Related Work ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">1</span></a>), and with SASRec employing full Cross-Entropy loss (<span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px3.p1.2.4">SASRec-CE</span>). Furthermore, we explore recent SOTA sampling-based variations of the loss function for SASRec proposed by Klenitskiy et al. <cite class="ltx_cite ltx_citemacro_citep">(Klenitskiy and Vasilev, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib22" title="">2023</a>)</cite> and Petrov et al. <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>, denoted <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px3.p1.2.2">SASRec-CE<sup class="ltx_sup" id="S4.SS0.SSS0.Px3.p1.2.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.SS0.SSS0.Px3.p1.2.2.1.1">-</span></sup></span> and <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px3.p1.2.5">gSASRec</span> (gBCE loss) respectively. All models are based on the adapted PyTorch implementation<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/pmixer/SASRec.pytorch" title="">https://github.com/pmixer/SASRec.pytorch</a></span></span></span> of the original SASRec architecture, and augmented with loss functions and sampling strategies from the respective papers. All code is available in our repository<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/dalibra/RECE" title="">https://github.com/dalibra/RECE</a></span></span></span>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Results</h2>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="281" id="S5.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">(a)-(d) Pareto front curves illustrating NDCG@10 for different memory budgets. (e)-(h) Same points plotted on NDCG@10 vs. Training time axes, with point sizes representing memory values from corresponding (a)-(d) plots.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.10">Our experiments indicate that when <math alttext="n_{c}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">n</mi><mi id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝑛</ci><ci id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">n_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is equal to <math alttext="n_{b}" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">n</mi><mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝑛</ci><ci id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">n_{b}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="\alpha_{bc}=1" class="ltx_Math" display="inline" id="S5.p1.3.m3.1"><semantics id="S5.p1.3.m3.1a"><mrow id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml"><msub id="S5.p1.3.m3.1.1.2" xref="S5.p1.3.m3.1.1.2.cmml"><mi id="S5.p1.3.m3.1.1.2.2" xref="S5.p1.3.m3.1.1.2.2.cmml">α</mi><mrow id="S5.p1.3.m3.1.1.2.3" xref="S5.p1.3.m3.1.1.2.3.cmml"><mi id="S5.p1.3.m3.1.1.2.3.2" xref="S5.p1.3.m3.1.1.2.3.2.cmml">b</mi><mo id="S5.p1.3.m3.1.1.2.3.1" xref="S5.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S5.p1.3.m3.1.1.2.3.3" xref="S5.p1.3.m3.1.1.2.3.3.cmml">c</mi></mrow></msub><mo id="S5.p1.3.m3.1.1.1" xref="S5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.p1.3.m3.1.1.3" xref="S5.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><apply id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1"><eq id="S5.p1.3.m3.1.1.1.cmml" xref="S5.p1.3.m3.1.1.1"></eq><apply id="S5.p1.3.m3.1.1.2.cmml" xref="S5.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.p1.3.m3.1.1.2.1.cmml" xref="S5.p1.3.m3.1.1.2">subscript</csymbol><ci id="S5.p1.3.m3.1.1.2.2.cmml" xref="S5.p1.3.m3.1.1.2.2">𝛼</ci><apply id="S5.p1.3.m3.1.1.2.3.cmml" xref="S5.p1.3.m3.1.1.2.3"><times id="S5.p1.3.m3.1.1.2.3.1.cmml" xref="S5.p1.3.m3.1.1.2.3.1"></times><ci id="S5.p1.3.m3.1.1.2.3.2.cmml" xref="S5.p1.3.m3.1.1.2.3.2">𝑏</ci><ci id="S5.p1.3.m3.1.1.2.3.3.cmml" xref="S5.p1.3.m3.1.1.2.3.3">𝑐</ci></apply></apply><cn id="S5.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">\alpha_{bc}=1</annotation><annotation encoding="application/x-llamapun" id="S5.p1.3.m3.1d">italic_α start_POSTSUBSCRIPT italic_b italic_c end_POSTSUBSCRIPT = 1</annotation></semantics></math>), optimal performance is achieved for a given memory limit, provided that <math alttext="n_{ec}" class="ltx_Math" display="inline" id="S5.p1.4.m4.1"><semantics id="S5.p1.4.m4.1a"><msub id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml"><mi id="S5.p1.4.m4.1.1.2" xref="S5.p1.4.m4.1.1.2.cmml">n</mi><mrow id="S5.p1.4.m4.1.1.3" xref="S5.p1.4.m4.1.1.3.cmml"><mi id="S5.p1.4.m4.1.1.3.2" xref="S5.p1.4.m4.1.1.3.2.cmml">e</mi><mo id="S5.p1.4.m4.1.1.3.1" xref="S5.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.p1.4.m4.1.1.3.3" xref="S5.p1.4.m4.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.1b"><apply id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p1.4.m4.1.1.1.cmml" xref="S5.p1.4.m4.1.1">subscript</csymbol><ci id="S5.p1.4.m4.1.1.2.cmml" xref="S5.p1.4.m4.1.1.2">𝑛</ci><apply id="S5.p1.4.m4.1.1.3.cmml" xref="S5.p1.4.m4.1.1.3"><times id="S5.p1.4.m4.1.1.3.1.cmml" xref="S5.p1.4.m4.1.1.3.1"></times><ci id="S5.p1.4.m4.1.1.3.2.cmml" xref="S5.p1.4.m4.1.1.3.2">𝑒</ci><ci id="S5.p1.4.m4.1.1.3.3.cmml" xref="S5.p1.4.m4.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.1c">n_{ec}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is sufficiently large. The number of extra neighboring chunks <math alttext="n_{ec}" class="ltx_Math" display="inline" id="S5.p1.5.m5.1"><semantics id="S5.p1.5.m5.1a"><msub id="S5.p1.5.m5.1.1" xref="S5.p1.5.m5.1.1.cmml"><mi id="S5.p1.5.m5.1.1.2" xref="S5.p1.5.m5.1.1.2.cmml">n</mi><mrow id="S5.p1.5.m5.1.1.3" xref="S5.p1.5.m5.1.1.3.cmml"><mi id="S5.p1.5.m5.1.1.3.2" xref="S5.p1.5.m5.1.1.3.2.cmml">e</mi><mo id="S5.p1.5.m5.1.1.3.1" xref="S5.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.p1.5.m5.1.1.3.3" xref="S5.p1.5.m5.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.5.m5.1b"><apply id="S5.p1.5.m5.1.1.cmml" xref="S5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p1.5.m5.1.1.1.cmml" xref="S5.p1.5.m5.1.1">subscript</csymbol><ci id="S5.p1.5.m5.1.1.2.cmml" xref="S5.p1.5.m5.1.1.2">𝑛</ci><apply id="S5.p1.5.m5.1.1.3.cmml" xref="S5.p1.5.m5.1.1.3"><times id="S5.p1.5.m5.1.1.3.1.cmml" xref="S5.p1.5.m5.1.1.3.1"></times><ci id="S5.p1.5.m5.1.1.3.2.cmml" xref="S5.p1.5.m5.1.1.3.2">𝑒</ci><ci id="S5.p1.5.m5.1.1.3.3.cmml" xref="S5.p1.5.m5.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.5.m5.1c">n_{ec}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and the number of rounds <math alttext="r" class="ltx_Math" display="inline" id="S5.p1.6.m6.1"><semantics id="S5.p1.6.m6.1a"><mi id="S5.p1.6.m6.1.1" xref="S5.p1.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.p1.6.m6.1b"><ci id="S5.p1.6.m6.1.1.cmml" xref="S5.p1.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.p1.6.m6.1d">italic_r</annotation></semantics></math> should be increased for larger batch sizes.
To demonstrate the effectiveness of our approach, we conducted a series of experiments in the quality-memory trade-off paradigm on a set of datasets (Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px1" title="Datasets ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>), comparing the SASRec-RECE model with baselines described in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px3" title="Model and Baselines ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>. In order to obtain quality metrics (NDCG@10) for different memory values, we evaluated these models for different values of hyperparameters affecting peak memory: batch size, number of negative samples for BCE<sup class="ltx_sup" id="S5.p1.10.1">+</sup>, gBCE, and CE<sup class="ltx_sup" id="S5.p1.10.2">-</sup>, <math alttext="n_{ec}" class="ltx_Math" display="inline" id="S5.p1.9.m9.1"><semantics id="S5.p1.9.m9.1a"><msub id="S5.p1.9.m9.1.1" xref="S5.p1.9.m9.1.1.cmml"><mi id="S5.p1.9.m9.1.1.2" xref="S5.p1.9.m9.1.1.2.cmml">n</mi><mrow id="S5.p1.9.m9.1.1.3" xref="S5.p1.9.m9.1.1.3.cmml"><mi id="S5.p1.9.m9.1.1.3.2" xref="S5.p1.9.m9.1.1.3.2.cmml">e</mi><mo id="S5.p1.9.m9.1.1.3.1" xref="S5.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S5.p1.9.m9.1.1.3.3" xref="S5.p1.9.m9.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.9.m9.1b"><apply id="S5.p1.9.m9.1.1.cmml" xref="S5.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S5.p1.9.m9.1.1.1.cmml" xref="S5.p1.9.m9.1.1">subscript</csymbol><ci id="S5.p1.9.m9.1.1.2.cmml" xref="S5.p1.9.m9.1.1.2">𝑛</ci><apply id="S5.p1.9.m9.1.1.3.cmml" xref="S5.p1.9.m9.1.1.3"><times id="S5.p1.9.m9.1.1.3.1.cmml" xref="S5.p1.9.m9.1.1.3.1"></times><ci id="S5.p1.9.m9.1.1.3.2.cmml" xref="S5.p1.9.m9.1.1.3.2">𝑒</ci><ci id="S5.p1.9.m9.1.1.3.3.cmml" xref="S5.p1.9.m9.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.9.m9.1c">n_{ec}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.9.m9.1d">italic_n start_POSTSUBSCRIPT italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="r" class="ltx_Math" display="inline" id="S5.p1.10.m10.1"><semantics id="S5.p1.10.m10.1a"><mi id="S5.p1.10.m10.1.1" xref="S5.p1.10.m10.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.p1.10.m10.1b"><ci id="S5.p1.10.m10.1.1.cmml" xref="S5.p1.10.m10.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.10.m10.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.p1.10.m10.1d">italic_r</annotation></semantics></math> for RECE. The grids for all parameters are available in our GitHub<a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#footnote2" title="footnote 2 ‣ Model and Baselines ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">2</span></a>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.F4" title="Figure 4 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a> shows optimal points for given memory budgets, dashed line means there was no configuration that showed higher quality at increased budget.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.4">On BeerAdvocate, the dataset with a small catalog, SASRec-RECE achieves performance close to the best competitors (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.F4" title="Figure 4 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>a), both in terms of quality and peak memory. However, our method is more effective on datasets with larger catalogs, where the memory consumption problem becomes more pronounced. On Behance and Kindle Store datasets (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.F4" title="Figure 4 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>b-c), RECE provides nearly the same quality with <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S5.p2.4.1">12</span> (0.526GB vs. 6.48GB) and <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S5.p2.4.2">3</span> (3.15GB vs. 9.73GB) times less memory consumed, respectively, while on the Gowalla (dataset with the largest catalog) (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.F4" title="Figure 4 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>d), RECE can either outperform the second best method by <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S5.p2.4.3">8.19%</span> (0.0449 vs. 0.0415 NDCG@10) or yield almost the same quality with <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S5.p2.4.4">6.6</span> times less memory (0.78GB vs. 5.13GB). We can also see that SASRec-RECE does not produce any significant computational overhead, and its training time is at the lower end of the spectrum within the competitors (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.F4" title="Figure 4 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>e-h). Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.T2" title="Table 2 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">2</span></a> shows the extended set of metrics for the largest datasets.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.7.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text ltx_font_bold" id="S5.T2.8.2" style="font-size:90%;">Performance under memory constraints. Bold indicates the best performance, and underlined is the second-best. NDCG@1 and HR@1 are equivalent by definition.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.4.4" style="width:433.6pt;height:266.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.7pt,-34.2pt) scale(1.34533813351124,1.34533813351124) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.4.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.4.4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T2.4.4.4.5.1.1"><span class="ltx_text" id="S5.T2.4.4.4.5.1.1.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T2.4.4.4.5.1.2"><span class="ltx_text" id="S5.T2.4.4.4.5.1.2.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.4.4.5.1.3"><span class="ltx_text" id="S5.T2.4.4.4.5.1.3.1" style="font-size:90%;">NDCG@1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.4.4.5.1.4"><span class="ltx_text" id="S5.T2.4.4.4.5.1.4.1" style="font-size:90%;">NDCG@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.4.4.5.1.5"><span class="ltx_text" id="S5.T2.4.4.4.5.1.5.1" style="font-size:90%;">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.4.4.5.1.6"><span class="ltx_text" id="S5.T2.4.4.4.5.1.6.1" style="font-size:90%;">HR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.4.4.5.1.7"><span class="ltx_text" id="S5.T2.4.4.4.5.1.7.1" style="font-size:90%;">HR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.1.1.1.2" rowspan="5"><span class="ltx_text" id="S5.T2.1.1.1.1.2.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.1.1.1.1.2.1.1">
<span class="ltx_tr" id="S5.T2.1.1.1.1.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T2.1.1.1.1.2.1.1.1.1">Kindle</span></span>
<span class="ltx_tr" id="S5.T2.1.1.1.1.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S5.T2.1.1.1.1.2.1.1.2.1">Store</span></span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.1.1.1.1">
<span class="ltx_text" id="S5.T2.1.1.1.1.1.1" style="font-size:90%;">BCE</span><sup class="ltx_sup" id="S5.T2.1.1.1.1.1.2"><span class="ltx_text" id="S5.T2.1.1.1.1.1.2.1" style="font-size:90%;">+</span></sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.1.1.3.1" style="font-size:90%;">0.0473</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.4.1" style="font-size:90%;">0.0674</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.5.1" style="font-size:90%;">0.0725</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.6.1" style="font-size:90%;">0.0856</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.7.1" style="font-size:90%;">0.1010</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.6.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.6.1.1"><span class="ltx_text" id="S5.T2.4.4.4.6.1.1.1" style="font-size:90%;">gBCE</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.6.1.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.4.4.4.6.1.2.1" style="font-size:90%;">0.0473</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.6.1.3"><span class="ltx_text" id="S5.T2.4.4.4.6.1.3.1" style="font-size:90%;">0.0626</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.6.1.4"><span class="ltx_text" id="S5.T2.4.4.4.6.1.4.1" style="font-size:90%;">0.0681</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.6.1.5"><span class="ltx_text" id="S5.T2.4.4.4.6.1.5.1" style="font-size:90%;">0.0766</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.6.1.6"><span class="ltx_text" id="S5.T2.4.4.4.6.1.6.1" style="font-size:90%;">0.0933</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.2.2.2.2.1">
<span class="ltx_text" id="S5.T2.2.2.2.2.1.1" style="font-size:90%;">CE</span><sup class="ltx_sup" id="S5.T2.2.2.2.2.1.2"><span class="ltx_text" id="S5.T2.2.2.2.2.1.2.1" style="font-size:90%;">-</span></sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.2.2.2"><span class="ltx_text" id="S5.T2.2.2.2.2.2.1" style="font-size:90%;">0.0397</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.2.2.3"><span class="ltx_text" id="S5.T2.2.2.2.2.3.1" style="font-size:90%;">0.0582</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.2.2.4"><span class="ltx_text" id="S5.T2.2.2.2.2.4.1" style="font-size:90%;">0.0644</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.2.2.5"><span class="ltx_text" id="S5.T2.2.2.2.2.5.1" style="font-size:90%;">0.0744</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.2.2.6"><span class="ltx_text" id="S5.T2.2.2.2.2.6.1" style="font-size:90%;">0.0938</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.7.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.7.2.1"><span class="ltx_text" id="S5.T2.4.4.4.7.2.1.1" style="font-size:90%;">CE</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.7.2.2"><span class="ltx_text" id="S5.T2.4.4.4.7.2.2.1" style="font-size:90%;">0.0467</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.7.2.3"><span class="ltx_text" id="S5.T2.4.4.4.7.2.3.1" style="font-size:90%;">0.0658</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.7.2.4"><span class="ltx_text" id="S5.T2.4.4.4.7.2.4.1" style="font-size:90%;">0.0711</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.7.2.5"><span class="ltx_text" id="S5.T2.4.4.4.7.2.5.1" style="font-size:90%;">0.0822</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.7.2.6"><span class="ltx_text" id="S5.T2.4.4.4.7.2.6.1" style="font-size:90%;">0.0972</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.8.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.8.3.1"><span class="ltx_text" id="S5.T2.4.4.4.8.3.1.1" style="font-size:90%;">RECE</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.8.3.2"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.8.3.2.1" style="font-size:90%;">0.0486</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.8.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.4.4.4.8.3.3.1" style="font-size:90%;">0.0665</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.8.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.4.4.4.8.3.4.1" style="font-size:90%;">0.0714</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.8.3.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.4.4.4.8.3.5.1" style="font-size:90%;">0.0822</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.8.3.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.4.4.4.8.3.6.1" style="font-size:90%;">0.0985</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S5.T2.3.3.3.3.2" rowspan="5"><span class="ltx_text" id="S5.T2.3.3.3.3.2.1" style="font-size:90%;">Gowalla</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.3.3.3.3.1">
<span class="ltx_text" id="S5.T2.3.3.3.3.1.1" style="font-size:90%;">BCE</span><sup class="ltx_sup" id="S5.T2.3.3.3.3.1.2"><span class="ltx_text" id="S5.T2.3.3.3.3.1.2.1" style="font-size:90%;">+</span></sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.3.3.3.3.3.1" style="font-size:90%;">0.0175</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.3.3.3.3.4.1" style="font-size:90%;">0.0341</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.3.3.3.3.5.1" style="font-size:90%;">0.0415</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.3.3.3.3.6.1" style="font-size:90%;">0.0507</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.3.3.3.3.7.1" style="font-size:90%;">0.0739</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.9.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.9.4.1"><span class="ltx_text" id="S5.T2.4.4.4.9.4.1.1" style="font-size:90%;">gBCE</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.9.4.2"><span class="ltx_text" id="S5.T2.4.4.4.9.4.2.1" style="font-size:90%;">0.0165</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.9.4.3"><span class="ltx_text" id="S5.T2.4.4.4.9.4.3.1" style="font-size:90%;">0.0337</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.9.4.4"><span class="ltx_text" id="S5.T2.4.4.4.9.4.4.1" style="font-size:90%;">0.0410</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.9.4.5"><span class="ltx_text" id="S5.T2.4.4.4.9.4.5.1" style="font-size:90%;">0.0506</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.9.4.6"><span class="ltx_text" id="S5.T2.4.4.4.9.4.6.1" style="font-size:90%;">0.0733</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.4.1">
<span class="ltx_text" id="S5.T2.4.4.4.4.1.1" style="font-size:90%;">CE</span><sup class="ltx_sup" id="S5.T2.4.4.4.4.1.2"><span class="ltx_text" id="S5.T2.4.4.4.4.1.2.1" style="font-size:90%;">-</span></sup>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4.2"><span class="ltx_text" id="S5.T2.4.4.4.4.2.1" style="font-size:90%;">0.0162</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4.3"><span class="ltx_text" id="S5.T2.4.4.4.4.3.1" style="font-size:90%;">0.0321</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4.4"><span class="ltx_text" id="S5.T2.4.4.4.4.4.1" style="font-size:90%;">0.0402</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4.5"><span class="ltx_text" id="S5.T2.4.4.4.4.5.1" style="font-size:90%;">0.0475</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4.6"><span class="ltx_text" id="S5.T2.4.4.4.4.6.1" style="font-size:90%;">0.0729</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.10.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.4.4.10.5.1"><span class="ltx_text" id="S5.T2.4.4.4.10.5.1.1" style="font-size:90%;">CE</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.10.5.2"><span class="ltx_text" id="S5.T2.4.4.4.10.5.2.1" style="font-size:90%;">0.0164</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.10.5.3"><span class="ltx_text" id="S5.T2.4.4.4.10.5.3.1" style="font-size:90%;">0.0324</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.10.5.4"><span class="ltx_text" id="S5.T2.4.4.4.10.5.4.1" style="font-size:90%;">0.0388</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.10.5.5"><span class="ltx_text" id="S5.T2.4.4.4.10.5.5.1" style="font-size:90%;">0.0471</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.10.5.6"><span class="ltx_text" id="S5.T2.4.4.4.10.5.6.1" style="font-size:90%;">0.0674</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4.11.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S5.T2.4.4.4.11.6.1"><span class="ltx_text" id="S5.T2.4.4.4.11.6.1.1" style="font-size:90%;">RECE</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.4.4.11.6.2"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.11.6.2.1" style="font-size:90%;">0.0192</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.4.4.11.6.3"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.11.6.3.1" style="font-size:90%;">0.0372</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.4.4.11.6.4"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.11.6.4.1" style="font-size:90%;">0.0449</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.4.4.11.6.5"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.11.6.5.1" style="font-size:90%;">0.0546</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.4.4.11.6.6"><span class="ltx_text ltx_font_bold" id="S5.T2.4.4.4.11.6.6.1" style="font-size:90%;">0.0787</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Finally, following <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>, we evaluate SASRec-RECE on the Amazon Beauty dataset <cite class="ltx_cite ltx_citemacro_citep">(McAuley et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib25" title="">2015</a>)</cite> against recent models, which report best results, including CBiT <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib12" title="">2022</a>)</cite>, DuoRec <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib29" title="">2022</a>)</cite>, CL4SRec <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib42" title="">2022</a>)</cite>, and FEARec <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib13" title="">2023</a>)</cite>. To comply with the evaluation protocols of these works, we replace the temporal data splitting strategy, described in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S4.SS0.SSS0.Px2" title="Evaluation ‣ 4. Experimental Settings ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">4</span></a>, with the leave-one-out evaluation approach and the corresponding data preprocessing. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#S5.T3" title="Table 3 ‣ 5. Results ‣ RECE: Reduced Cross-Entropy Loss for Large-Catalogue Sequential Recommenders"><span class="ltx_text ltx_ref_tag">3</span></a> shows that SASRec-RECE achieves performance comparable to the recently proposed models.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.3.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text ltx_font_bold" id="S5.T3.4.2" style="font-size:90%;">Comparison of SASRec-RECE with recent results on Beauty using leave-one-out splitting strategy. Setup follows <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.02354v3#bib.bib28" title="">2023</a>)</cite>. Best values are in bold, second best are underlined.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T3.5" style="width:433.6pt;height:71.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(52.2pt,-8.6pt) scale(1.31682483888454,1.31682483888454) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T3.5.1.1.1.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.1.1.1.2">FEARec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.1.1.1.3">CBiT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.1.1.1.4">DuoRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.1.1.1.5">CL4SRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.1.1.1.6">SASRec-RECE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.5.1.2.1.1">NDCG@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.2.1.2">0.0459</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.2.1.3.1">0.0537</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.2.1.4">0.0443</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.2.1.5">0.0299</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.2.1.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.2.1.6.1">0.0525</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S5.T3.5.1.3.2.1">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.5.1.3.2.2">0.0884</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.5.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.3.2.3.1">0.0905</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.5.1.3.2.4">0.0845</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.5.1.3.2.5">0.0681</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.5.1.3.2.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.3.2.6.1">0.0897</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.2">In this work, we introduced RECE, a novel loss function that approximates full Cross-Entropy using hard-negative mining with GPU-efficient operations. This allows the benefits of CE loss, known for state-of-the-art performance, to be applied to large catalogs that would otherwise be infeasible due to high memory requirements.
We demonstrated that RECE almost matches the performance and memory requirements of recent negative sampling methods on datasets with small catalogs and consumes up to <math alttext="12" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mn id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><cn id="S6.p1.1.m1.1.1.cmml" type="integer" xref="S6.p1.1.m1.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">12</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">12</annotation></semantics></math> times less memory on large-catalog datasets. Alternatively, it can improve quality (NDCG@10) by up to <math alttext="8.19\%" class="ltx_Math" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mrow id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml"><mn id="S6.p1.2.m2.1.1.2" xref="S6.p1.2.m2.1.1.2.cmml">8.19</mn><mo id="S6.p1.2.m2.1.1.1" xref="S6.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><apply id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1"><csymbol cd="latexml" id="S6.p1.2.m2.1.1.1.cmml" xref="S6.p1.2.m2.1.1.1">percent</csymbol><cn id="S6.p1.2.m2.1.1.2.cmml" type="float" xref="S6.p1.2.m2.1.1.2">8.19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">8.19\%</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">8.19 %</annotation></semantics></math> compared to other approaches if provided with an extended memory budget.
The idea behind RECE can potentially be applied not only to other loss functions and models in sequential recommender systems but also to other domains.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
The work is supported in part through the Basic Research Program at the National Research University Higher School of Economics (HSE University).

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andoni et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Alexandr Andoni, Piotr Indyk, Thijs Laarhoven, Ilya Razenshteyn, and Ludwig Schmidt. 2015.

</span>
<span class="ltx_bibblock">Practical and optimal LSH for angular distance.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Advances in neural information processing systems</em> 28 (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Yu Bai, Sally Goldman, and Li Zhang. 2017.

</span>
<span class="ltx_bibblock">Tapas: Two-pass approximate adaptive sampling for softmax.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">arXiv preprint arXiv:1707.03073</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio and Senécal (2008)</span>
<span class="ltx_bibblock">
Yoshua Bengio and Jean-Sébastien Senécal. 2008.

</span>
<span class="ltx_bibblock">Adaptive importance sampling to accelerate training of a neural probabilistic language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IEEE Transactions on Neural Networks</em> 19, 4 (2008), 713–722.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanc and Rendle (2018)</span>
<span class="ltx_bibblock">
Guy Blanc and Steffen Rendle. 2018.

</span>
<span class="ltx_bibblock">Adaptive sampled softmax with kernel based sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International conference on machine learning</em>. PMLR, 590–599.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cañamares and Castells (2020)</span>
<span class="ltx_bibblock">
Rocío Cañamares and Pablo Castells. 2020.

</span>
<span class="ltx_bibblock">On Target Item Sampling in Offline Recommender System Evaluation. 259–268.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3383313.3412259" title="">https://doi.org/10.1145/3383313.3412259</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Jia Li, Zhiwei Liu, Nitish Shirish Keskar, Huan Wang, Julian McAuley, and Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Generating Negative Samples for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">arXiv preprint arXiv:2208.03645</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Eunjoon Cho, Seth A. Myers, and Jure Leskovec. 2011.

</span>
<span class="ltx_bibblock">Friendship and mobility: user movement in location-based social networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dallmann et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Alexander Dallmann, Daniel Zoller, and Andreas Hotho. 2021.

</span>
<span class="ltx_bibblock">A Case Study on Sampling Strategies for Evaluating Neural Sequential Item Recommendation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Fifteenth ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(RecSys ’21)</em>. ACM.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3475943" title="">https://doi.org/10.1145/3460231.3475943</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">arXiv preprint arXiv:1810.04805</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jingtao Ding, Yuhan Quan, Quanming Yao, Yong Li, and Depeng Jin. 2020.

</span>
<span class="ltx_bibblock">Simplify and robustify negative sampling for implicit collaborative filtering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Advances in Neural Information Processing Systems</em> 33 (2020), 1094–1105.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Hanwen Du, Hui Shi, Pengpeng Zhao, Deqing Wang, Victor S. Sheng, Yanchi Liu, Guanfeng Liu, and Lei Zhao. 2022.

</span>
<span class="ltx_bibblock">Contrastive Learning with Bidirectional Transformers for Sequential Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2208.03895 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xinyu Du, Huanhuan Yuan, Pengpeng Zhao, Fuzhen Zhuang, Guanfeng Liu, and Yanchi Liu. 2023.

</span>
<span class="ltx_bibblock">Frequency Enhanced Hybrid Attention Network for Sequential Recommendation.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frolov and Oseledets (2022)</span>
<span class="ltx_bibblock">
Evgeny Frolov and Ivan Oseledets. 2022.

</span>
<span class="ltx_bibblock">Tensor-based Sequential Learning via Hankel Matrix Representation for Next Item Recommendations.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2212.05720 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Ruiqi Guo, Sanjiv Kumar, Krzysztof Choromanski, and David Simcha. 2016.

</span>
<span class="ltx_bibblock">Quantization based fast inner product search. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Artificial intelligence and statistics</em>. PMLR, 482–490.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Ruining He, Chen Fang, Zhaowen Wang, and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock">Vista: A Visually, Socially, and Temporally-aware Model for Artistic Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 10th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.2">(RecSys ’16)</em>. ACM.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2959100.2959152" title="">https://doi.org/10.1145/2959100.2959152</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi and Karatzoglou (2018)</span>
<span class="ltx_bibblock">
Balázs Hidasi and Alexandros Karatzoglou. 2018.

</span>
<span class="ltx_bibblock">Recurrent neural networks with top-k gains for session-based recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 27th ACM international conference on information and knowledge management</em>. 843–852.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:1511.06939</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yitong Ji, Aixin Sun, Jie Zhang, and Chenliang Li. 2023.

</span>
<span class="ltx_bibblock">A Critical Study on Data Leakage in Recommender System Offline Evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">ACM Transactions on Information Systems</em> 41, 3 (Feb. 2023), 1–27.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3569930" title="">https://doi.org/10.1145/3569930</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">2018 IEEE international conference on data mining (ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kitaev et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Nikita Kitaev, Łukasz Kaiser, and Anselm Levskaya. 2020.

</span>
<span class="ltx_bibblock">Reformer: The efficient transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:2001.04451</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klenitskiy and Vasilev (2023)</span>
<span class="ltx_bibblock">
Anton Klenitskiy and Alexey Vasilev. 2023.

</span>
<span class="ltx_bibblock">Turning Dross Into Gold Loss: is BERT4Rec really better than SASRec?. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib22.2.2">(RecSys ’23)</em>. ACM.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3610644" title="">https://doi.org/10.1145/3604915.3610644</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Defu Lian, Qi Liu, and Enhong Chen. 2020.

</span>
<span class="ltx_bibblock">Personalized ranking with importance sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of The Web Conference 2020</em>. 1093–1103.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Julian McAuley, Jure Leskovec, and Dan Jurafsky. 2012.

</span>
<span class="ltx_bibblock">Learning attitudes and attributes from multi-aspect reviews. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">2012 IEEE 12th International Conference on Data Mining</em>. IEEE, 1020–1025.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton van den Hengel. 2015.

</span>
<span class="ltx_bibblock">Image-based Recommendations on Styles and Substitutes.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1506.04757 [cs.CV]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zaiqiao Meng, Richard McCreadie, Craig Macdonald, and Iadh Ounis. 2020.

</span>
<span class="ltx_bibblock">Exploring Data Splitting Strategies for the Evaluation of Recommendation Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2007.13237 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jianmo Ni, Jiacheng Li, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">Justifying Recommendations using Distantly-Labeled Reviews and Fine-Grained Aspects. 188–197.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/D19-1018" title="">https://doi.org/10.18653/v1/D19-1018</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2023)</span>
<span class="ltx_bibblock">
Aleksandr Vladimirovich Petrov and Craig Macdonald. 2023.

</span>
<span class="ltx_bibblock">gSASRec: Reducing Overconfidence in Sequential Recommendation Trained with Negative Sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">(RecSys ’23)</em>. ACM.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3608783" title="">https://doi.org/10.1145/3604915.3608783</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ruihong Qiu, Zi Huang, Hongzhi Yin, and Zijian Wang. 2022.

</span>
<span class="ltx_bibblock">Contrastive Learning for Representation Degeneration Problem in Sequential Recommendation. 813–823.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3488560.3498433" title="">https://doi.org/10.1145/3488560.3498433</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et al<span class="ltx_text" id="bib.bib30.3.1">.</span> 2018.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock">(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rawat et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Ankit Singh Rawat, Jiecao Chen, Felix Xinnan X Yu, Ananda Theertha Suresh, and Sanjiv Kumar. 2019.

</span>
<span class="ltx_bibblock">Sampled softmax with random fourier features.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Advances in Neural Information Processing Systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle and Freudenthaler (2014)</span>
<span class="ltx_bibblock">
Steffen Rendle and Christoph Freudenthaler. 2014.

</span>
<span class="ltx_bibblock">Improving pairwise learning for item recommendation from implicit feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 7th ACM international conference on Web search and data mining</em>. 273–282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010.

</span>
<span class="ltx_bibblock">Factorizing personalized markov chains for next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 19th international conference on World wide web</em>. 811–820.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Spring and Shrivastava (2017)</span>
<span class="ltx_bibblock">
Ryan Spring and Anshumali Shrivastava. 2017.

</span>
<span class="ltx_bibblock">A new unbiased and efficient class of lsh-based samplers and estimators for partition function computation in log-linear models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:1703.05160</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via convolutional sequence embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Changxin Tian, Zihan Lin, Shuqing Bian, Jinpeng Wang, and Wayne Zhao. 2022.

</span>
<span class="ltx_bibblock">Temporal Contrastive Pre-Training for Sequential Recommendation. 1925–1934.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3511808.3557468" title="">https://doi.org/10.1145/3511808.3557468</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vijayanarasimhan et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Sudheendra Vijayanarasimhan, Jonathon Shlens, Rajat Monga, and Jay Yagnik. 2014.

</span>
<span class="ltx_bibblock">Deep networks with large output spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:1412.7479</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jinpeng Wang, Jieming Zhu, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">Cross-batch negative sampling for training two-tower recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 44th international ACM SIGIR conference on research and development in information retrieval</em>. 1632–1636.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wilm et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Timo Wilm, Philipp Normann, Sophie Baumeister, and Paul-Vincent Kobow. 2023.

</span>
<span class="ltx_bibblock">Scaling Session-Based Transformer Recommendations using Optimized Negative Sampling and Loss Functions. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>. 1023–1026.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xu Xie, Fei Sun, Zhaoyang Liu, Shiwen Wu, Jinyang Gao, Jiandong Zhang, Bolin Ding, and Bin Cui. 2022.

</span>
<span class="ltx_bibblock">Contrastive Learning for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">2022 IEEE 38th International Conference on Data Engineering (ICDE)</em> (2022), 1259–1273.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:251299631" title="">https://api.semanticscholar.org/CorpusID:251299631</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yen et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Ian En-Hsu Yen, Satyen Kale, Felix Yu, Daniel Holtmann-Rice, Sanjiv Kumar, and Pradeep Ravikumar. 2018.

</span>
<span class="ltx_bibblock">Loss decomposition for fast learning in large output spaces. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">International Conference on Machine Learning</em>. PMLR, 5640–5649.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tingting Zhang, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Deqing Wang, Guanfeng Liu, and Xiaofang Zhou. 2019.

</span>
<span class="ltx_bibblock">Feature-level Deeper Self-Attention Network for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">International Joint Conference on Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 14 15:19:10 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
