<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State</title>
<!--Generated on Sun Jul 21 03:52:44 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Medication Recommendation,  Causal Inference,  Electronic Health Record" lang="en" name="keywords"/>
<base href="/html/2404.12228v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S1" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2.SS1" title="In 2. Related Work ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Medication Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2.SS2" title="In 2. Related Work ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Causal Inference in Recommender Systems</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S3" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Definition</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S3.SS1" title="In 3. Problem Definition ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Medical Entity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S3.SS2" title="In 3. Problem Definition ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>DDI Matrix</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S3.SS3" title="In 3. Problem Definition ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Causal Discovery and Estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S3.SS4" title="In 3. Problem Definition ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Input and Output</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>The Proposed Model: CausalMed</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS1" title="In 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Entity Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS2" title="In 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Relationship Mining</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS3" title="In 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Health State Learning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS3.SSS1" title="In 4.3. Health State Learning ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Homomorphic Relationship Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS3.SSS2" title="In 4.3. Health State Learning ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Heterogeneous Relationship Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS3.SSS3" title="In 4.3. Health State Learning ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Aggregation of Entity Information</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS4" title="In 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Medication Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.SS5" title="In 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Model Training and Inference</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS1" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experiments Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS1.SSS1" title="In 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS1.SSS2" title="In 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS1.SSS3" title="In 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS1.SSS4" title="In 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS2" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS3" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study (RQ2&amp;RQ3&amp;RQ4)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS4" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Parameters Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS5" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Quality Study (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS6" title="In 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>Case Study (RQ3&amp;RQ4&amp;RQ5)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S6" title="In CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiang Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Yanshan University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Qinhuangdao</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.4.id1">Peking University</span><span class="ltx_text ltx_affiliation_city" id="id5.5.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id6.6.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lixiang%CB%99222@stumail.ysu.edu.cn">lixiang˙222@stumail.ysu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shunpan Liang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Yanshan University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Qinhuangdao</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.4.id1">Xinjiang University of Science &amp; Technology</span><span class="ltx_text ltx_affiliation_city" id="id11.5.id2">Korla</span><span class="ltx_text ltx_affiliation_country" id="id12.6.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liangshunpan@ysu.edu.cn">liangshunpan@ysu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yu Lei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Yanshan University</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Qinhuangdao</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:leiyu0160@gmail.com">leiyu0160@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chen Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Yanshan University</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Qinhuangdao</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lichen36211@gmail.com">lichen36211@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yulei Hou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Yanshan University</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Qinhuangdao</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ylhou@ysu.edu.cn">ylhou@ysu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dashun Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">Macao Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id23.2.id2">Macao</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:p2212871@mpu.edu.mo">p2212871@mpu.edu.mo</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tengfei Ma
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id25.1.id1">Hunan University</span><span class="ltx_text ltx_affiliation_city" id="id26.2.id2">Changsha</span><span class="ltx_text ltx_affiliation_country" id="id27.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tfma@hnu.edu.cn">tfma@hnu.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id28.id1">Medication recommendation systems are developed to recommend suitable medications tailored to specific patient.
Previous researches primarily focus on learning medication representations, which have yielded notable advances. However, these methods are limited to capturing personalized patient representations due to the following primary limitations: (i) unable to capture the differences in the impact of diseases/procedures on patients across various patient health states; (ii) fail to model the direct causal relationships between medications and specific health state of patients, resulting in an inability to determine which specific disease each medication is treating.
To address these limitations, we propose CausalMed, a patient health state-centric model capable of enhancing the personalization of patient representations.
Specifically, CausalMed first captures the causal relationship between diseases/procedures and medications through causal discovery and evaluates their causal effects.
Building upon this, CausalMed focuses on analyzing the health state of patients, capturing the dynamic differences of diseases/procedures in different health states of patients, and transforming diseases/procedures into medications on direct causal relationships. Ultimately, CausalMed integrates information from longitudinal visits to recommend medication combinations.
Extensive experiments on real-world datasets show that our method learns more personalized patient representation and outperforms state-of-the-art models in accuracy and safety.</p>
</div>
<div class="ltx_keywords">Medication Recommendation, Causal Inference, Electronic Health Record
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management; October 21–25, 2024; Boise, ID, USA.</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management (CIKM ’24), October 21–25, 2024, Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679542</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Information retrieval</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Causal reasoning and diagnostics</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Health informatics</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Given the noticeable imbalance in healthcare resources’ supply and demand environment, there has been a growing emphasis on AI-based medical systems <cite class="ltx_cite ltx_citemacro_citep">(Rosaci, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib22" title="">2007</a>; Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib4" title="">2016a</a>; Bansal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib2" title="">2014</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib18" title="">2023</a>)</cite>.
Medication recommendation, as one of the domains, aims to provide personalized medication treatment plans for specific patients using data mining <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib17" title="">2018</a>; Symeonidis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib27" title="">2021</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib31" title="">2021</a>)</cite> and deep learning <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib24" title="">2018</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib28" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib32" title="">2022b</a>)</cite> methods.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S1.F1.sf1.g1" src="x1.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.6.3.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S1.F1.sf1.4.2" style="font-size:90%;">An example: patient 1 has disease <math alttext="d_{3}" class="ltx_Math" display="inline" id="S1.F1.sf1.3.1.m1.1"><semantics id="S1.F1.sf1.3.1.m1.1b"><msub id="S1.F1.sf1.3.1.m1.1.1" xref="S1.F1.sf1.3.1.m1.1.1.cmml"><mi id="S1.F1.sf1.3.1.m1.1.1.2" xref="S1.F1.sf1.3.1.m1.1.1.2.cmml">d</mi><mn id="S1.F1.sf1.3.1.m1.1.1.3" xref="S1.F1.sf1.3.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.sf1.3.1.m1.1c"><apply id="S1.F1.sf1.3.1.m1.1.1.cmml" xref="S1.F1.sf1.3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.sf1.3.1.m1.1.1.1.cmml" xref="S1.F1.sf1.3.1.m1.1.1">subscript</csymbol><ci id="S1.F1.sf1.3.1.m1.1.1.2.cmml" xref="S1.F1.sf1.3.1.m1.1.1.2">𝑑</ci><cn id="S1.F1.sf1.3.1.m1.1.1.3.cmml" type="integer" xref="S1.F1.sf1.3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.sf1.3.1.m1.1d">d_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.sf1.3.1.m1.1e">italic_d start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, and Patient 2 has disease <math alttext="d_{4}" class="ltx_Math" display="inline" id="S1.F1.sf1.4.2.m2.1"><semantics id="S1.F1.sf1.4.2.m2.1b"><msub id="S1.F1.sf1.4.2.m2.1.1" xref="S1.F1.sf1.4.2.m2.1.1.cmml"><mi id="S1.F1.sf1.4.2.m2.1.1.2" xref="S1.F1.sf1.4.2.m2.1.1.2.cmml">d</mi><mn id="S1.F1.sf1.4.2.m2.1.1.3" xref="S1.F1.sf1.4.2.m2.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.sf1.4.2.m2.1c"><apply id="S1.F1.sf1.4.2.m2.1.1.cmml" xref="S1.F1.sf1.4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.sf1.4.2.m2.1.1.1.cmml" xref="S1.F1.sf1.4.2.m2.1.1">subscript</csymbol><ci id="S1.F1.sf1.4.2.m2.1.1.2.cmml" xref="S1.F1.sf1.4.2.m2.1.1.2">𝑑</ci><cn id="S1.F1.sf1.4.2.m2.1.1.3.cmml" type="integer" xref="S1.F1.sf1.4.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.sf1.4.2.m2.1d">d_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.sf1.4.2.m2.1e">italic_d start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, their health states differ only in one disease, yet the prescribed medications differ significantly.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="526" id="S1.F1.sf2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:90%;">The relationship between the similarity of the patient’s health state and the similarity of the medications taken by the patients.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The problem of insufficient personalization of medication recommendation.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S1.F1.4">\Description</span></div>
</div>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The term ”health state” refers to the sum of all diseases and procedures within a single clinical visit.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates two real-life cases, explaining why personalized medication recommendation is crucial.
In our study, we observed a common phenomenon, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S1.F1.sf1" title="In Figure 1 ‣ 1. Introduction ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, where even if two patients may have highly similar health states, the required medications could be vastly different.
Furthermore, we conducted pairwise comparisons of all medical records in MIMIC-III <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib12" title="">2016</a>)</cite>, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S1.F1.sf2" title="In Figure 1 ‣ 1. Introduction ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">1(b)</span></a>, where the results indicate that among patients with medical record similarity ranging from 80% to 90%, the average similarity of prescribed medications was only 48.8%.
In conclusion, due to factors such as individual patient differences, doctors often propose different treatment plans for similar diseases/procedures. Hence, personalized representations tailored to each patient are particularly important.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Previous research methods, such as <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib38" title="">2021a</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib36" title="">2022</a>)</cite>, emphasize the importance of prior medications, suggesting that current medication combinations be recommended based on medications prescribed during the last visit. Meanwhile, other methods, like <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib39" title="">2021b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib40" title="">2023</a>)</cite>, advocate starting from a molecular perspective to construct more accurate representations of medications. However, these studies are primarily medication-centric and limited to addressing the aforementioned issue of personalization due to the following limitations:</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">(1) <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">Failing to model a direct causal relationship between medications and patient’s specific health state</span>:
Most medications are specifically designed for one or two particular diseases/procedures, which means that the relationships between diseases/procedures and medications should be point-to-point causal relationships. Traditional methods typically match disease/procedure sets with medication sets, and construct set-to-set relationships based on co-occurrence. However, these co-occurrence-based methods generate excessive false correlations and fail to capture the direct causal relationship between medications and the specific patient health state, making it impossible to determine which specific disease each medication is treating.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">(2) <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Overlooking the difference of diseases in various health states</span>:
The same disease may assume different roles in various patient health states: it may be the primary cause of other diseases during one visit and a secondary disease resulting from other diseases during another visit. This intricate pathological relationship among diseases implies that the impact of diseases on patients varies across different health states. A similar issue exists with procedures. In dealing with multiple diseases/procedures, existing methods simply sum them with equal weight, failing to consider the varying roles that diseases play in different health states.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To address the aforementioned limitations, based on causal inference <cite class="ltx_cite ltx_citemacro_citep">(Hasan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib8" title="">2023</a>)</cite>, we propose a patient health state-centric model named CausalMed.
Specifically, first, <span class="ltx_text ltx_font_bold" id="S1.p6.1.1">to address limitation (1)</span>, we replace co-occurrence relationships with causal relationships. Through causal discovery, we eliminate backdoor paths <cite class="ltx_cite ltx_citemacro_citep">(Gultchin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib7" title="">2020</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib16" title="">2022</a>)</cite> between medical entities (diseases, procedures, medications). Subsequently, we construct corresponding graph networks by estimating the quantified therapeutic effects of specific medications on specific diseases. Ultimately, we transform the initially chaotic set-to-set relationships into clear point-to-point relationships, modeling the direct causal relationships between medications and specific patient states.
At the same time, <span class="ltx_text ltx_font_bold" id="S1.p6.1.2">to address limitation (2)</span>, we introduce a novel approach named Dynamic Self-Adaptive Attention (DSA). Grounded in the causal-based pathological relationships of each health state, DSA learns the variability in the effects that medical entities have on patients under different health states, leading to the construction of personalized patient representations.
Ultimately, by applying this method to historical medical visit data, we integrate longitudinal visit information, resulting in tailored medication recommendations.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Detailed case study can be found in subsection <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS6" title="5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">5.6</span></a>.
Our source code is publicly available on GitHub<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/lixiang-222/CausalMed" title="">https://github.com/lixiang-222/CausalMed</a></span></span></span>.
We list our main contributions as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Important Discovery</span>:
We make the first discovery that different diseases express significantly different meanings under various patient health states, and current works fail to capture which specific disease each medication is treating. These factors contribute to the low level of personalization in existing medication recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Novel Framework</span>:
We propose a novel medication recommendation framework centered on patients’ clinical health state. Utilizing causal inference, we capture point-to-point relationships between diseases and medications and develop a Dynamic Self-Adaptive Attention (DSA) mechanism to discern the dynamic differences in diseases across various health states, thereby enhancing the personalization of patient representations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Extensive Evaluation</span>:
Through extensive experiments on real-world datasets, we demonstrate our model’s ability to capture personalized patient representations, outperforming other state-of-the-art baselines significantly.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Medication Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Early works in medication recommendation, such as LEAP <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib42" title="">2017</a>)</cite>, are instance-based, focusing on single-visit data and treating medication recommendation as a multi-instance, multi-label classification task.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">The first category of research models sequential relationships in patients’ medical records to enhance personalization. RETAIN <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib5" title="">2016b</a>)</cite> personalizes disease predictions using patient histories. MICRON <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib38" title="">2021a</a>)</cite> optimizes therapy by adjusting medications for new symptoms. COGNet <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib36" title="">2022</a>)</cite> translates diseases/procedures to medications and reuses effective past treatments.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">The second category improves prescription accuracy by capturing relationships between entities. DMNC <cite class="ltx_cite ltx_citemacro_citep">(Le et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib14" title="">2018</a>)</cite> uses dynamic memory and deep learning to recommend precise medications. Studies like <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib44" title="">2021b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib45" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib35" title="">2023</a>)</cite> use graph networks to describe connections between medical entities. StratMed <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib15" title="">2023</a>)</cite> stratifies relationships to alleviate data sparsity.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">The third category addresses safety and reliability in medication combinations by incorporating partial medication-related knowledge. SafeDrug <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib39" title="">2021b</a>)</cite> and MoleRec <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib40" title="">2023</a>)</cite> use molecular data to reduce adverse DDIs. Carmen <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib3" title="">2023</a>)</cite> integrates patient history with molecular learning to differentiate similar molecules by function.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">Our proposed model employs a patient health state-centric framework and enhances personalized patient representations through the incorporation of causal inference methods.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="504" id="S2.F2.g1" src="x3.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">CausalMed framework: The upper section illustrates the process of learning the patient’s representation from a single clinical visit. The lower section represents the integration of information from multiple visits and the prediction of medication combinations.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F2.4">\Description</span></div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Causal Inference in Recommender Systems</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The incorporation of causal inference <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib6" title="">2024</a>)</cite> into recommender systems (RS) is a novel concept, with ongoing research falling into three main categories.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">The first category focuses on tackling data bias. Methods like the backdoor criterion <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib34" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib43" title="">2021a</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib33" title="">2022d</a>)</cite> aim to eliminate confounding factors, addressing challenges such as popularity and exposure bias.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">The second category, exemplified by <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib41" title="">2021</a>; Xiao and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib37" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib30" title="">2022c</a>)</cite>, couples real-world data collection with inverse probability weighting and counterfactual methods to fill data gaps or reduce noise by introducing counterfactual interactions.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">The third category aims to enhance model interpretability and fairness. Studies like <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib29" title="">2022a</a>; Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib26" title="">2022</a>)</cite> introduce causal discovery and counterfactual approaches in RS to address the opacity issues inherent in deep learning models.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1">Our method uses causal inference to establish clear, quantifiable causal relationships, effectively overcoming the limitations of traditional methods that rely on co-occurrence relationships.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Problem Definition</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Medical Entity</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">A medical entity refers to specific medical concepts that constitute medical data. We use <math alttext="\mathcal{D}=\{d_{1},d_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3.4" xref="S3.SS1.p1.1.m1.3.3.4.cmml">𝒟</mi><mo id="S3.SS1.p1.1.m1.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS1.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.4" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">d</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.5" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><eq id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.4">𝒟</ci><set id="S3.SS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑑</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑑</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">\mathcal{D}=\{d_{1},d_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.3d">caligraphic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>, <math alttext="\mathcal{P}=\{p_{1},p_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.3"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.4" xref="S3.SS1.p1.2.m2.3.3.4.cmml">𝒫</mi><mo id="S3.SS1.p1.2.m2.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml"><mo id="S3.SS1.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">p</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.4" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">p</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.5" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3"><eq id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3"></eq><ci id="S3.SS1.p1.2.m2.3.3.4.cmml" xref="S3.SS1.p1.2.m2.3.3.4">𝒫</ci><set id="S3.SS1.p1.2.m2.3.3.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">𝑝</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">𝑝</ci><cn id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">\mathcal{P}=\{p_{1},p_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.3d">caligraphic_P = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>, and <math alttext="\mathcal{M}=\{m_{1},m_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.3"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.3.3.4" xref="S3.SS1.p1.3.m3.3.3.4.cmml">ℳ</mi><mo id="S3.SS1.p1.3.m3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.3.3.2.2" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml"><mo id="S3.SS1.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">m</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.2.4" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">m</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.2.5" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><eq id="S3.SS1.p1.3.m3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3"></eq><ci id="S3.SS1.p1.3.m3.3.3.4.cmml" xref="S3.SS1.p1.3.m3.3.3.4">ℳ</ci><set id="S3.SS1.p1.3.m3.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑚</ci><cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑚</ci><cn id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">\mathcal{M}=\{m_{1},m_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.3d">caligraphic_M = { italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math> to represent three sets of medical entities: diseases, procedures, and medications.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>DDI Matrix</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">Our Drug-Drug Interaction (DDI) data is extracted from the Adverse Event Reporting Systems <cite class="ltx_cite ltx_citemacro_citep">(Hoffman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib9" title="">2014</a>)</cite>. We represent DDI information using a binary matrix <math alttext="{\mathbf{M}^{ddi}}\in\{0,1\}^{|\mathcal{M}|\times|\mathcal{M}|}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.5" xref="S3.SS2.p1.1.m1.4.5.cmml"><msup id="S3.SS2.p1.1.m1.4.5.2" xref="S3.SS2.p1.1.m1.4.5.2.cmml"><mi id="S3.SS2.p1.1.m1.4.5.2.2" xref="S3.SS2.p1.1.m1.4.5.2.2.cmml">𝐌</mi><mrow id="S3.SS2.p1.1.m1.4.5.2.3" xref="S3.SS2.p1.1.m1.4.5.2.3.cmml"><mi id="S3.SS2.p1.1.m1.4.5.2.3.2" xref="S3.SS2.p1.1.m1.4.5.2.3.2.cmml">d</mi><mo id="S3.SS2.p1.1.m1.4.5.2.3.1" xref="S3.SS2.p1.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.4.5.2.3.3" xref="S3.SS2.p1.1.m1.4.5.2.3.3.cmml">d</mi><mo id="S3.SS2.p1.1.m1.4.5.2.3.1a" xref="S3.SS2.p1.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.4.5.2.3.4" xref="S3.SS2.p1.1.m1.4.5.2.3.4.cmml">i</mi></mrow></msup><mo id="S3.SS2.p1.1.m1.4.5.1" xref="S3.SS2.p1.1.m1.4.5.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.4.5.3" xref="S3.SS2.p1.1.m1.4.5.3.cmml"><mrow id="S3.SS2.p1.1.m1.4.5.3.2.2" xref="S3.SS2.p1.1.m1.4.5.3.2.1.cmml"><mo id="S3.SS2.p1.1.m1.4.5.3.2.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.2.1.cmml">{</mo><mn id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">0</mn><mo id="S3.SS2.p1.1.m1.4.5.3.2.2.2" xref="S3.SS2.p1.1.m1.4.5.3.2.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml">1</mn><mo id="S3.SS2.p1.1.m1.4.5.3.2.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p1.1.m1.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.cmml"><mrow id="S3.SS2.p1.1.m1.2.2.2.4.2" xref="S3.SS2.p1.1.m1.2.2.2.4.1.cmml"><mo id="S3.SS2.p1.1.m1.2.2.2.4.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">ℳ</mi><mo id="S3.SS2.p1.1.m1.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.4.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.1.m1.2.2.2.3" rspace="0.222em" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">×</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.5.2" xref="S3.SS2.p1.1.m1.2.2.2.5.1.cmml"><mo id="S3.SS2.p1.1.m1.2.2.2.5.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml">ℳ</mi><mo id="S3.SS2.p1.1.m1.2.2.2.5.2.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.5.cmml" xref="S3.SS2.p1.1.m1.4.5"><in id="S3.SS2.p1.1.m1.4.5.1.cmml" xref="S3.SS2.p1.1.m1.4.5.1"></in><apply id="S3.SS2.p1.1.m1.4.5.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.5.2.1.cmml" xref="S3.SS2.p1.1.m1.4.5.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.4.5.2.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2.2">𝐌</ci><apply id="S3.SS2.p1.1.m1.4.5.2.3.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3"><times id="S3.SS2.p1.1.m1.4.5.2.3.1.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3.1"></times><ci id="S3.SS2.p1.1.m1.4.5.2.3.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3.2">𝑑</ci><ci id="S3.SS2.p1.1.m1.4.5.2.3.3.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3.3">𝑑</ci><ci id="S3.SS2.p1.1.m1.4.5.2.3.4.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3.4">𝑖</ci></apply></apply><apply id="S3.SS2.p1.1.m1.4.5.3.cmml" xref="S3.SS2.p1.1.m1.4.5.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.5.3.1.cmml" xref="S3.SS2.p1.1.m1.4.5.3">superscript</csymbol><set id="S3.SS2.p1.1.m1.4.5.3.2.1.cmml" xref="S3.SS2.p1.1.m1.4.5.3.2.2"><cn id="S3.SS2.p1.1.m1.3.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3">0</cn><cn id="S3.SS2.p1.1.m1.4.4.cmml" type="integer" xref="S3.SS2.p1.1.m1.4.4">1</cn></set><apply id="S3.SS2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2"><times id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.3"></times><apply id="S3.SS2.p1.1.m1.2.2.2.4.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4.2"><abs id="S3.SS2.p1.1.m1.2.2.2.4.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4.2.1"></abs><ci id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">ℳ</ci></apply><apply id="S3.SS2.p1.1.m1.2.2.2.5.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.5.2"><abs id="S3.SS2.p1.1.m1.2.2.2.5.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.5.2.1"></abs><ci id="S3.SS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">{\mathbf{M}^{ddi}}\in\{0,1\}^{|\mathcal{M}|\times|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT | caligraphic_M | × | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{M}^{ddi}_{ij}=1" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msubsup id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.2.cmml">𝐌</mi><mrow id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.1.1.2.3.1" xref="S3.SS2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.3.3.cmml">j</mi></mrow><mrow id="S3.SS2.p1.2.m2.1.1.2.2.3" xref="S3.SS2.p1.2.m2.1.1.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.2.3.2.cmml">d</mi><mo id="S3.SS2.p1.2.m2.1.1.2.2.3.1" xref="S3.SS2.p1.2.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.2.3.3.cmml">d</mi><mo id="S3.SS2.p1.2.m2.1.1.2.2.3.1a" xref="S3.SS2.p1.2.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.2.3.4" xref="S3.SS2.p1.2.m2.1.1.2.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><eq id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></eq><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.2">𝐌</ci><apply id="S3.SS2.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3"><times id="S3.SS2.p1.2.m2.1.1.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.2">𝑑</ci><ci id="S3.SS2.p1.2.m2.1.1.2.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.3">𝑑</ci><ci id="S3.SS2.p1.2.m2.1.1.2.2.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2.3.4">𝑖</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3"><times id="S3.SS2.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{M}^{ddi}_{ij}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> indicates the presence of an interaction between medication <math alttext="m_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">m</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑚</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and medication <math alttext="m_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">m</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑚</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">m_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. A high frequency of DDI suggests potential safety issues in recommended results.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Causal Discovery and Estimation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Causal discovery and estimation constitute two pivotal aspects of causal inference <cite class="ltx_cite ltx_citemacro_citep">(Hasan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib8" title="">2023</a>)</cite>. Causal discovery entails employing statistical tools and machine learning algorithms to unveil causal relationships between variables. Causal estimation underscores the quantification of causal effects between variables, relying on observed data.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Input and Output</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.9">The model ingests Electronic Health Records (EHR) of patients as its primary input. Each patient’s record, symbolized as <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">caligraphic_H</annotation></semantics></math>, involves multiple visits <math alttext="\mathcal{H}=\{v_{1},v_{2},\ldots,v_{t}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.4"><semantics id="S3.SS4.p1.2.m2.4a"><mrow id="S3.SS4.p1.2.m2.4.4" xref="S3.SS4.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.4.4.5" xref="S3.SS4.p1.2.m2.4.4.5.cmml">ℋ</mi><mo id="S3.SS4.p1.2.m2.4.4.4" xref="S3.SS4.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS4.p1.2.m2.4.4.3.3" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS4.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS4.p1.2.m2.2.2.1.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.2.m2.2.2.1.1.1.2" xref="S3.SS4.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS4.p1.2.m2.2.2.1.1.1.3" xref="S3.SS4.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.2.m2.4.4.3.3.5" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.p1.2.m2.3.3.2.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS4.p1.2.m2.3.3.2.2.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS4.p1.2.m2.3.3.2.2.2.3" xref="S3.SS4.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p1.2.m2.4.4.3.3.6" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS4.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.p1.2.m2.4.4.3.3.7" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.p1.2.m2.4.4.3.3.3" xref="S3.SS4.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS4.p1.2.m2.4.4.3.3.3.2" xref="S3.SS4.p1.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S3.SS4.p1.2.m2.4.4.3.3.3.3" xref="S3.SS4.p1.2.m2.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S3.SS4.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS4.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.4b"><apply id="S3.SS4.p1.2.m2.4.4.cmml" xref="S3.SS4.p1.2.m2.4.4"><eq id="S3.SS4.p1.2.m2.4.4.4.cmml" xref="S3.SS4.p1.2.m2.4.4.4"></eq><ci id="S3.SS4.p1.2.m2.4.4.5.cmml" xref="S3.SS4.p1.2.m2.4.4.5">ℋ</ci><set id="S3.SS4.p1.2.m2.4.4.3.4.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3"><apply id="S3.SS4.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS4.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS4.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS4.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">…</ci><apply id="S3.SS4.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.3.2">𝑣</ci><ci id="S3.SS4.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.4c">\mathcal{H}=\{v_{1},v_{2},\ldots,v_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.4d">caligraphic_H = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>. Each visit record <math alttext="v_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">v_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> encapsulates a tripartite dataset: diseases, procedures, and medications, expressed as <math alttext="v_{t}=\{\mathcal{D}_{t},\mathcal{P}_{t},\mathcal{M}_{t}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.3"><semantics id="S3.SS4.p1.4.m4.3a"><mrow id="S3.SS4.p1.4.m4.3.3" xref="S3.SS4.p1.4.m4.3.3.cmml"><msub id="S3.SS4.p1.4.m4.3.3.5" xref="S3.SS4.p1.4.m4.3.3.5.cmml"><mi id="S3.SS4.p1.4.m4.3.3.5.2" xref="S3.SS4.p1.4.m4.3.3.5.2.cmml">v</mi><mi id="S3.SS4.p1.4.m4.3.3.5.3" xref="S3.SS4.p1.4.m4.3.3.5.3.cmml">t</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.4" xref="S3.SS4.p1.4.m4.3.3.4.cmml">=</mo><mrow id="S3.SS4.p1.4.m4.3.3.3.3" xref="S3.SS4.p1.4.m4.3.3.3.4.cmml"><mo id="S3.SS4.p1.4.m4.3.3.3.3.4" stretchy="false" xref="S3.SS4.p1.4.m4.3.3.3.4.cmml">{</mo><msub id="S3.SS4.p1.4.m4.1.1.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.4.m4.1.1.1.1.1.2" xref="S3.SS4.p1.4.m4.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS4.p1.4.m4.1.1.1.1.1.3" xref="S3.SS4.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.3.5" xref="S3.SS4.p1.4.m4.3.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.4.m4.2.2.2.2.2" xref="S3.SS4.p1.4.m4.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.4.m4.2.2.2.2.2.2" xref="S3.SS4.p1.4.m4.2.2.2.2.2.2.cmml">𝒫</mi><mi id="S3.SS4.p1.4.m4.2.2.2.2.2.3" xref="S3.SS4.p1.4.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.3.6" xref="S3.SS4.p1.4.m4.3.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.4.m4.3.3.3.3.3" xref="S3.SS4.p1.4.m4.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.4.m4.3.3.3.3.3.2" xref="S3.SS4.p1.4.m4.3.3.3.3.3.2.cmml">ℳ</mi><mi id="S3.SS4.p1.4.m4.3.3.3.3.3.3" xref="S3.SS4.p1.4.m4.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.3.7" stretchy="false" xref="S3.SS4.p1.4.m4.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.3b"><apply id="S3.SS4.p1.4.m4.3.3.cmml" xref="S3.SS4.p1.4.m4.3.3"><eq id="S3.SS4.p1.4.m4.3.3.4.cmml" xref="S3.SS4.p1.4.m4.3.3.4"></eq><apply id="S3.SS4.p1.4.m4.3.3.5.cmml" xref="S3.SS4.p1.4.m4.3.3.5"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.3.3.5.1.cmml" xref="S3.SS4.p1.4.m4.3.3.5">subscript</csymbol><ci id="S3.SS4.p1.4.m4.3.3.5.2.cmml" xref="S3.SS4.p1.4.m4.3.3.5.2">𝑣</ci><ci id="S3.SS4.p1.4.m4.3.3.5.3.cmml" xref="S3.SS4.p1.4.m4.3.3.5.3">𝑡</ci></apply><set id="S3.SS4.p1.4.m4.3.3.3.4.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3"><apply id="S3.SS4.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS4.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.2.2">𝒫</ci><ci id="S3.SS4.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS4.p1.4.m4.3.3.3.3.3.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.3.3.3.3.3.1.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.4.m4.3.3.3.3.3.2.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.3.2">ℳ</ci><ci id="S3.SS4.p1.4.m4.3.3.3.3.3.3.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.3c">v_{t}=\{\mathcal{D}_{t},\mathcal{P}_{t},\mathcal{M}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.3d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="\mathcal{D}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msub id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">𝒟</mi><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝒟</ci><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{P}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1"><semantics id="S3.SS4.p1.6.m6.1a"><msub id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml">𝒫</mi><mi id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2">𝒫</ci><ci id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\mathcal{P}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.1d">caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1"><semantics id="S3.SS4.p1.7.m7.1a"><msub id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">ℳ</ci><ci id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m7.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are all multi-hot encoded using 0 and 1.
The output of model, denoted as <math alttext="\hat{\mathcal{M}}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m8.1"><semantics id="S3.SS4.p1.8.m8.1a"><msub id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mover accent="true" id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.8.m8.1.1.2.2" xref="S3.SS4.p1.8.m8.1.1.2.2.cmml">ℳ</mi><mo id="S3.SS4.p1.8.m8.1.1.2.1" xref="S3.SS4.p1.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2"><ci id="S3.SS4.p1.8.m8.1.1.2.1.cmml" xref="S3.SS4.p1.8.m8.1.1.2.1">^</ci><ci id="S3.SS4.p1.8.m8.1.1.2.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2.2">ℳ</ci></apply><ci id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">\hat{\mathcal{M}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m8.1d">over^ start_ARG caligraphic_M end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, is a predicted medication combination for <math alttext="v_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m9.1"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml">v</mi><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2">𝑣</ci><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">v_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>The Proposed Model: CausalMed</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2.F2" title="Figure 2 ‣ 2.1. Medication Recommendation ‣ 2. Related Work ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">2</span></a>, our model starts by extracting entity representations from a single clinical visit. In the relationship mining stage, we employ causal discovery and estimation to uncover pathological relationships among medical entities and quantify the point-to-point relationships.
During the phase of health state learning, we capture the dynamic changes of entities in different patient states through causal relationships, updating and aggregating embeddings of all medical entities to generate visit representations.
Finally, in the information integration stage, we predict medication combinations based on longitudinal patient visit records.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Entity Representation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.7">In this stage, we encode entities within a single clinical visit. Specifically, we start by extracting the current disease <math alttext="\mathcal{D}_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝒟</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, current procedure <math alttext="\mathcal{P}_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝒫</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝒫</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{P}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the previous medication <math alttext="\mathcal{M}_{t-1}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">ℳ</mi><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p1.3.m3.1.1.3.1" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">ℳ</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><minus id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1"></minus><ci id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">𝑡</ci><cn id="S4.SS1.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\mathcal{M}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. Following that, we construct embedding tables for diseases, procedures, and medications, represented as <math alttext="\mathbf{E}_{d}\in\mathbb{R}^{|\mathcal{D}|\times dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><msub id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2.2" xref="S4.SS1.p1.4.m4.1.2.2.2.cmml">𝐄</mi><mi id="S4.SS1.p1.4.m4.1.2.2.3" xref="S4.SS1.p1.4.m4.1.2.2.3.cmml">d</mi></msub><mo id="S4.SS1.p1.4.m4.1.2.1" xref="S4.SS1.p1.4.m4.1.2.1.cmml">∈</mo><msup id="S4.SS1.p1.4.m4.1.2.3" xref="S4.SS1.p1.4.m4.1.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.2.3.2" xref="S4.SS1.p1.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.3.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.3.2.2" xref="S4.SS1.p1.4.m4.1.1.1.3.2.1.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.3.2.2.1" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">𝒟</mi><mo id="S4.SS1.p1.4.m4.1.1.1.3.2.2.2" rspace="0.055em" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.3.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.4.m4.1.1.1.3.1" rspace="0.222em" xref="S4.SS1.p1.4.m4.1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p1.4.m4.1.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.1.3.3.cmml">d</mi></mrow><mo id="S4.SS1.p1.4.m4.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.1.4" xref="S4.SS1.p1.4.m4.1.1.1.4.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.1.2a" xref="S4.SS1.p1.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.1.5" xref="S4.SS1.p1.4.m4.1.1.1.5.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><in id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1"></in><apply id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.2.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2.2">𝐄</ci><ci id="S4.SS1.p1.4.m4.1.2.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.2.3">𝑑</ci></apply><apply id="S4.SS1.p1.4.m4.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.3.1.cmml" xref="S4.SS1.p1.4.m4.1.2.3">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.2.3.2.cmml" xref="S4.SS1.p1.4.m4.1.2.3.2">ℝ</ci><apply id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"><times id="S4.SS1.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.2"></times><apply id="S4.SS1.p1.4.m4.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3"><times id="S4.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.1"></times><apply id="S4.SS1.p1.4.m4.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.2.2"><abs id="S4.SS1.p1.4.m4.1.1.1.3.2.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.2.2.1"></abs><ci id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">𝒟</ci></apply><ci id="S4.SS1.p1.4.m4.1.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.3">𝑑</ci></apply><ci id="S4.SS1.p1.4.m4.1.1.1.4.cmml" xref="S4.SS1.p1.4.m4.1.1.1.4">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.1.5.cmml" xref="S4.SS1.p1.4.m4.1.1.1.5">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\mathbf{E}_{d}\in\mathbb{R}^{|\mathcal{D}|\times dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">bold_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_D | × italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{E}_{p}\in\mathbb{R}^{|\mathcal{P}|\times dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.2" xref="S4.SS1.p1.5.m5.1.2.cmml"><msub id="S4.SS1.p1.5.m5.1.2.2" xref="S4.SS1.p1.5.m5.1.2.2.cmml"><mi id="S4.SS1.p1.5.m5.1.2.2.2" xref="S4.SS1.p1.5.m5.1.2.2.2.cmml">𝐄</mi><mi id="S4.SS1.p1.5.m5.1.2.2.3" xref="S4.SS1.p1.5.m5.1.2.2.3.cmml">p</mi></msub><mo id="S4.SS1.p1.5.m5.1.2.1" xref="S4.SS1.p1.5.m5.1.2.1.cmml">∈</mo><msup id="S4.SS1.p1.5.m5.1.2.3" xref="S4.SS1.p1.5.m5.1.2.3.cmml"><mi id="S4.SS1.p1.5.m5.1.2.3.2" xref="S4.SS1.p1.5.m5.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml"><mrow id="S4.SS1.p1.5.m5.1.1.1.3" xref="S4.SS1.p1.5.m5.1.1.1.3.cmml"><mrow id="S4.SS1.p1.5.m5.1.1.1.3.2.2" xref="S4.SS1.p1.5.m5.1.1.1.3.2.1.cmml"><mo id="S4.SS1.p1.5.m5.1.1.1.3.2.2.1" stretchy="false" xref="S4.SS1.p1.5.m5.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.cmml">𝒫</mi><mo id="S4.SS1.p1.5.m5.1.1.1.3.2.2.2" rspace="0.055em" stretchy="false" xref="S4.SS1.p1.5.m5.1.1.1.3.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.5.m5.1.1.1.3.1" rspace="0.222em" xref="S4.SS1.p1.5.m5.1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p1.5.m5.1.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.1.3.3.cmml">d</mi></mrow><mo id="S4.SS1.p1.5.m5.1.1.1.2" xref="S4.SS1.p1.5.m5.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.1.4" xref="S4.SS1.p1.5.m5.1.1.1.4.cmml">i</mi><mo id="S4.SS1.p1.5.m5.1.1.1.2a" xref="S4.SS1.p1.5.m5.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.1.5" xref="S4.SS1.p1.5.m5.1.1.1.5.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.2.cmml" xref="S4.SS1.p1.5.m5.1.2"><in id="S4.SS1.p1.5.m5.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2.1"></in><apply id="S4.SS1.p1.5.m5.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.2.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.2.2.2.cmml" xref="S4.SS1.p1.5.m5.1.2.2.2">𝐄</ci><ci id="S4.SS1.p1.5.m5.1.2.2.3.cmml" xref="S4.SS1.p1.5.m5.1.2.2.3">𝑝</ci></apply><apply id="S4.SS1.p1.5.m5.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.2.3.1.cmml" xref="S4.SS1.p1.5.m5.1.2.3">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.2.3.2.cmml" xref="S4.SS1.p1.5.m5.1.2.3.2">ℝ</ci><apply id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"><times id="S4.SS1.p1.5.m5.1.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.1.2"></times><apply id="S4.SS1.p1.5.m5.1.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.1.3"><times id="S4.SS1.p1.5.m5.1.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.3.1"></times><apply id="S4.SS1.p1.5.m5.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.3.2.2"><abs id="S4.SS1.p1.5.m5.1.1.1.3.2.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.3.2.2.1"></abs><ci id="S4.SS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1">𝒫</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.1.3.3">𝑑</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.1.4.cmml" xref="S4.SS1.p1.5.m5.1.1.1.4">𝑖</ci><ci id="S4.SS1.p1.5.m5.1.1.1.5.cmml" xref="S4.SS1.p1.5.m5.1.1.1.5">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathbf{E}_{p}\in\mathbb{R}^{|\mathcal{P}|\times dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">bold_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_P | × italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{E}_{m}\in\mathbb{R}^{|\mathcal{M}|\times dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.2" xref="S4.SS1.p1.6.m6.1.2.cmml"><msub id="S4.SS1.p1.6.m6.1.2.2" xref="S4.SS1.p1.6.m6.1.2.2.cmml"><mi id="S4.SS1.p1.6.m6.1.2.2.2" xref="S4.SS1.p1.6.m6.1.2.2.2.cmml">𝐄</mi><mi id="S4.SS1.p1.6.m6.1.2.2.3" xref="S4.SS1.p1.6.m6.1.2.2.3.cmml">m</mi></msub><mo id="S4.SS1.p1.6.m6.1.2.1" xref="S4.SS1.p1.6.m6.1.2.1.cmml">∈</mo><msup id="S4.SS1.p1.6.m6.1.2.3" xref="S4.SS1.p1.6.m6.1.2.3.cmml"><mi id="S4.SS1.p1.6.m6.1.2.3.2" xref="S4.SS1.p1.6.m6.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml"><mrow id="S4.SS1.p1.6.m6.1.1.1.3" xref="S4.SS1.p1.6.m6.1.1.1.3.cmml"><mrow id="S4.SS1.p1.6.m6.1.1.1.3.2.2" xref="S4.SS1.p1.6.m6.1.1.1.3.2.1.cmml"><mo id="S4.SS1.p1.6.m6.1.1.1.3.2.2.1" stretchy="false" xref="S4.SS1.p1.6.m6.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.1.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.1.cmml">ℳ</mi><mo id="S4.SS1.p1.6.m6.1.1.1.3.2.2.2" rspace="0.055em" stretchy="false" xref="S4.SS1.p1.6.m6.1.1.1.3.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.6.m6.1.1.1.3.1" rspace="0.222em" xref="S4.SS1.p1.6.m6.1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p1.6.m6.1.1.1.3.3" xref="S4.SS1.p1.6.m6.1.1.1.3.3.cmml">d</mi></mrow><mo id="S4.SS1.p1.6.m6.1.1.1.2" xref="S4.SS1.p1.6.m6.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.6.m6.1.1.1.4" xref="S4.SS1.p1.6.m6.1.1.1.4.cmml">i</mi><mo id="S4.SS1.p1.6.m6.1.1.1.2a" xref="S4.SS1.p1.6.m6.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.6.m6.1.1.1.5" xref="S4.SS1.p1.6.m6.1.1.1.5.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.2.cmml" xref="S4.SS1.p1.6.m6.1.2"><in id="S4.SS1.p1.6.m6.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.2.1"></in><apply id="S4.SS1.p1.6.m6.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.2.2.1.cmml" xref="S4.SS1.p1.6.m6.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.2.2.2.cmml" xref="S4.SS1.p1.6.m6.1.2.2.2">𝐄</ci><ci id="S4.SS1.p1.6.m6.1.2.2.3.cmml" xref="S4.SS1.p1.6.m6.1.2.2.3">𝑚</ci></apply><apply id="S4.SS1.p1.6.m6.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.2.3.1.cmml" xref="S4.SS1.p1.6.m6.1.2.3">superscript</csymbol><ci id="S4.SS1.p1.6.m6.1.2.3.2.cmml" xref="S4.SS1.p1.6.m6.1.2.3.2">ℝ</ci><apply id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"><times id="S4.SS1.p1.6.m6.1.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.1.2"></times><apply id="S4.SS1.p1.6.m6.1.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.1.3"><times id="S4.SS1.p1.6.m6.1.1.1.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.3.1"></times><apply id="S4.SS1.p1.6.m6.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.3.2.2"><abs id="S4.SS1.p1.6.m6.1.1.1.3.2.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.3.2.2.1"></abs><ci id="S4.SS1.p1.6.m6.1.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.1">ℳ</ci></apply><ci id="S4.SS1.p1.6.m6.1.1.1.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.1.3.3">𝑑</ci></apply><ci id="S4.SS1.p1.6.m6.1.1.1.4.cmml" xref="S4.SS1.p1.6.m6.1.1.1.4">𝑖</ci><ci id="S4.SS1.p1.6.m6.1.1.1.5.cmml" xref="S4.SS1.p1.6.m6.1.1.1.5">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\mathbf{E}_{m}\in\mathbb{R}^{|\mathcal{M}|\times dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_M | × italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> respectively, where <math alttext="dim" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">d</mi><mo id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">i</mi><mo id="S4.SS1.p1.7.m7.1.1.1a" xref="S4.SS1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.7.m7.1.1.4" xref="S4.SS1.p1.7.m7.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><times id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"></times><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑑</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑖</ci><ci id="S4.SS1.p1.7.m7.1.1.4.cmml" xref="S4.SS1.p1.7.m7.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">dim</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">italic_d italic_i italic_m</annotation></semantics></math> represents the embedding dimension and each row in the table retains a vector for specific medical entity. Through the tables, we obtain embeddings for all entities.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{h}_{d_{i}}=\mathbf{E}_{d}(d_{i}),\quad\mathbf{h}_{p_{j}}=\mathbf{E}_{p%
}(p_{j}),\quad\mathbf{h}_{m_{k}}=\mathbf{E}_{m}(m_{k})," class="ltx_Math" display="block" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1.1"><mrow id="S4.E1.m1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.3.cmml"><mrow id="S4.E1.m1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.1.1.3.2.cmml">𝐡</mi><msub id="S4.E1.m1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.3.3.2" xref="S4.E1.m1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mi id="S4.E1.m1.1.1.1.1.1.1.3.3.3" xref="S4.E1.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.3.2.cmml">𝐄</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.3.3.cmml">d</mi></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.2.3" rspace="1.167em" xref="S4.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.3.cmml"><mrow id="S4.E1.m1.1.1.1.1.2.2.1.1" xref="S4.E1.m1.1.1.1.1.2.2.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.2.2.1.1.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.3.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.2.cmml">𝐡</mi><msub id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">p</mi><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">j</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.2.2.1.1.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml">𝐄</mi><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml">p</mi></msub><mo id="S4.E1.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.2.2.2.3" rspace="1.167em" xref="S4.E1.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.2.cmml">𝐡</mi><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">m</mi><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">k</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.cmml">=</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2.2.1" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.cmml"><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.2.cmml">𝐄</mi><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.3.cmml">m</mi></msub><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.1.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.cmml">m</mi><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3a.cmml" xref="S4.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1"><eq id="S4.E1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3.2">𝐡</ci><apply id="S4.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S4.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1"><times id="S4.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3.2">𝐄</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E1.m1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.3a.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1"><eq id="S4.E1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.2"></eq><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.2">𝐡</ci><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.2">𝑝</ci><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1"><times id="S4.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.2"></times><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.2">𝐄</ci><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.3.3">𝑝</ci></apply><apply id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2"><eq id="S4.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2"></eq><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.2">𝐡</ci><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.2">𝑚</ci><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1"><times id="S4.E1.m1.1.1.1.1.2.2.2.2.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.2"></times><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.2">𝐄</ci><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.3.3">𝑚</ci></apply><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.2">𝑚</ci><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\mathbf{h}_{d_{i}}=\mathbf{E}_{d}(d_{i}),\quad\mathbf{h}_{p_{j}}=\mathbf{E}_{p%
}(p_{j}),\quad\mathbf{h}_{m_{k}}=\mathbf{E}_{m}(m_{k}),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">bold_h start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , bold_h start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , bold_h start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.16">where <math alttext="d_{i}\subset\mathcal{D}_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m1.1"><semantics id="S4.SS1.p1.8.m1.1a"><mrow id="S4.SS1.p1.8.m1.1.1" xref="S4.SS1.p1.8.m1.1.1.cmml"><msub id="S4.SS1.p1.8.m1.1.1.2" xref="S4.SS1.p1.8.m1.1.1.2.cmml"><mi id="S4.SS1.p1.8.m1.1.1.2.2" xref="S4.SS1.p1.8.m1.1.1.2.2.cmml">d</mi><mi id="S4.SS1.p1.8.m1.1.1.2.3" xref="S4.SS1.p1.8.m1.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.8.m1.1.1.1" xref="S4.SS1.p1.8.m1.1.1.1.cmml">⊂</mo><msub id="S4.SS1.p1.8.m1.1.1.3" xref="S4.SS1.p1.8.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.8.m1.1.1.3.2" xref="S4.SS1.p1.8.m1.1.1.3.2.cmml">𝒟</mi><mi id="S4.SS1.p1.8.m1.1.1.3.3" xref="S4.SS1.p1.8.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m1.1b"><apply id="S4.SS1.p1.8.m1.1.1.cmml" xref="S4.SS1.p1.8.m1.1.1"><subset id="S4.SS1.p1.8.m1.1.1.1.cmml" xref="S4.SS1.p1.8.m1.1.1.1"></subset><apply id="S4.SS1.p1.8.m1.1.1.2.cmml" xref="S4.SS1.p1.8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m1.1.1.2.1.cmml" xref="S4.SS1.p1.8.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.8.m1.1.1.2.2.cmml" xref="S4.SS1.p1.8.m1.1.1.2.2">𝑑</ci><ci id="S4.SS1.p1.8.m1.1.1.2.3.cmml" xref="S4.SS1.p1.8.m1.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.8.m1.1.1.3.cmml" xref="S4.SS1.p1.8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m1.1.1.3.1.cmml" xref="S4.SS1.p1.8.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.8.m1.1.1.3.2.cmml" xref="S4.SS1.p1.8.m1.1.1.3.2">𝒟</ci><ci id="S4.SS1.p1.8.m1.1.1.3.3.cmml" xref="S4.SS1.p1.8.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m1.1c">d_{i}\subset\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊂ caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="p_{j}\subset\mathcal{P}_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m2.1"><semantics id="S4.SS1.p1.9.m2.1a"><mrow id="S4.SS1.p1.9.m2.1.1" xref="S4.SS1.p1.9.m2.1.1.cmml"><msub id="S4.SS1.p1.9.m2.1.1.2" xref="S4.SS1.p1.9.m2.1.1.2.cmml"><mi id="S4.SS1.p1.9.m2.1.1.2.2" xref="S4.SS1.p1.9.m2.1.1.2.2.cmml">p</mi><mi id="S4.SS1.p1.9.m2.1.1.2.3" xref="S4.SS1.p1.9.m2.1.1.2.3.cmml">j</mi></msub><mo id="S4.SS1.p1.9.m2.1.1.1" xref="S4.SS1.p1.9.m2.1.1.1.cmml">⊂</mo><msub id="S4.SS1.p1.9.m2.1.1.3" xref="S4.SS1.p1.9.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.9.m2.1.1.3.2" xref="S4.SS1.p1.9.m2.1.1.3.2.cmml">𝒫</mi><mi id="S4.SS1.p1.9.m2.1.1.3.3" xref="S4.SS1.p1.9.m2.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m2.1b"><apply id="S4.SS1.p1.9.m2.1.1.cmml" xref="S4.SS1.p1.9.m2.1.1"><subset id="S4.SS1.p1.9.m2.1.1.1.cmml" xref="S4.SS1.p1.9.m2.1.1.1"></subset><apply id="S4.SS1.p1.9.m2.1.1.2.cmml" xref="S4.SS1.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m2.1.1.2.1.cmml" xref="S4.SS1.p1.9.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.9.m2.1.1.2.2.cmml" xref="S4.SS1.p1.9.m2.1.1.2.2">𝑝</ci><ci id="S4.SS1.p1.9.m2.1.1.2.3.cmml" xref="S4.SS1.p1.9.m2.1.1.2.3">𝑗</ci></apply><apply id="S4.SS1.p1.9.m2.1.1.3.cmml" xref="S4.SS1.p1.9.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m2.1.1.3.1.cmml" xref="S4.SS1.p1.9.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.9.m2.1.1.3.2.cmml" xref="S4.SS1.p1.9.m2.1.1.3.2">𝒫</ci><ci id="S4.SS1.p1.9.m2.1.1.3.3.cmml" xref="S4.SS1.p1.9.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m2.1c">p_{j}\subset\mathcal{P}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m2.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⊂ caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="m_{k}\subset\mathcal{M}_{t-1}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m3.1"><semantics id="S4.SS1.p1.10.m3.1a"><mrow id="S4.SS1.p1.10.m3.1.1" xref="S4.SS1.p1.10.m3.1.1.cmml"><msub id="S4.SS1.p1.10.m3.1.1.2" xref="S4.SS1.p1.10.m3.1.1.2.cmml"><mi id="S4.SS1.p1.10.m3.1.1.2.2" xref="S4.SS1.p1.10.m3.1.1.2.2.cmml">m</mi><mi id="S4.SS1.p1.10.m3.1.1.2.3" xref="S4.SS1.p1.10.m3.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p1.10.m3.1.1.1" xref="S4.SS1.p1.10.m3.1.1.1.cmml">⊂</mo><msub id="S4.SS1.p1.10.m3.1.1.3" xref="S4.SS1.p1.10.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m3.1.1.3.2" xref="S4.SS1.p1.10.m3.1.1.3.2.cmml">ℳ</mi><mrow id="S4.SS1.p1.10.m3.1.1.3.3" xref="S4.SS1.p1.10.m3.1.1.3.3.cmml"><mi id="S4.SS1.p1.10.m3.1.1.3.3.2" xref="S4.SS1.p1.10.m3.1.1.3.3.2.cmml">t</mi><mo id="S4.SS1.p1.10.m3.1.1.3.3.1" xref="S4.SS1.p1.10.m3.1.1.3.3.1.cmml">−</mo><mn id="S4.SS1.p1.10.m3.1.1.3.3.3" xref="S4.SS1.p1.10.m3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m3.1b"><apply id="S4.SS1.p1.10.m3.1.1.cmml" xref="S4.SS1.p1.10.m3.1.1"><subset id="S4.SS1.p1.10.m3.1.1.1.cmml" xref="S4.SS1.p1.10.m3.1.1.1"></subset><apply id="S4.SS1.p1.10.m3.1.1.2.cmml" xref="S4.SS1.p1.10.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m3.1.1.2.1.cmml" xref="S4.SS1.p1.10.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.10.m3.1.1.2.2.cmml" xref="S4.SS1.p1.10.m3.1.1.2.2">𝑚</ci><ci id="S4.SS1.p1.10.m3.1.1.2.3.cmml" xref="S4.SS1.p1.10.m3.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p1.10.m3.1.1.3.cmml" xref="S4.SS1.p1.10.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m3.1.1.3.1.cmml" xref="S4.SS1.p1.10.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.10.m3.1.1.3.2.cmml" xref="S4.SS1.p1.10.m3.1.1.3.2">ℳ</ci><apply id="S4.SS1.p1.10.m3.1.1.3.3.cmml" xref="S4.SS1.p1.10.m3.1.1.3.3"><minus id="S4.SS1.p1.10.m3.1.1.3.3.1.cmml" xref="S4.SS1.p1.10.m3.1.1.3.3.1"></minus><ci id="S4.SS1.p1.10.m3.1.1.3.3.2.cmml" xref="S4.SS1.p1.10.m3.1.1.3.3.2">𝑡</ci><cn id="S4.SS1.p1.10.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p1.10.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m3.1c">m_{k}\subset\mathcal{M}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m3.1d">italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⊂ caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> represent specific medical entities, <math alttext="\mathbf{h}_{d_{i}}\in\mathbb{R}^{dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m4.1"><semantics id="S4.SS1.p1.11.m4.1a"><mrow id="S4.SS1.p1.11.m4.1.1" xref="S4.SS1.p1.11.m4.1.1.cmml"><msub id="S4.SS1.p1.11.m4.1.1.2" xref="S4.SS1.p1.11.m4.1.1.2.cmml"><mi id="S4.SS1.p1.11.m4.1.1.2.2" xref="S4.SS1.p1.11.m4.1.1.2.2.cmml">𝐡</mi><msub id="S4.SS1.p1.11.m4.1.1.2.3" xref="S4.SS1.p1.11.m4.1.1.2.3.cmml"><mi id="S4.SS1.p1.11.m4.1.1.2.3.2" xref="S4.SS1.p1.11.m4.1.1.2.3.2.cmml">d</mi><mi id="S4.SS1.p1.11.m4.1.1.2.3.3" xref="S4.SS1.p1.11.m4.1.1.2.3.3.cmml">i</mi></msub></msub><mo id="S4.SS1.p1.11.m4.1.1.1" xref="S4.SS1.p1.11.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.11.m4.1.1.3" xref="S4.SS1.p1.11.m4.1.1.3.cmml"><mi id="S4.SS1.p1.11.m4.1.1.3.2" xref="S4.SS1.p1.11.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.11.m4.1.1.3.3" xref="S4.SS1.p1.11.m4.1.1.3.3.cmml"><mi id="S4.SS1.p1.11.m4.1.1.3.3.2" xref="S4.SS1.p1.11.m4.1.1.3.3.2.cmml">d</mi><mo id="S4.SS1.p1.11.m4.1.1.3.3.1" xref="S4.SS1.p1.11.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.11.m4.1.1.3.3.3" xref="S4.SS1.p1.11.m4.1.1.3.3.3.cmml">i</mi><mo id="S4.SS1.p1.11.m4.1.1.3.3.1a" xref="S4.SS1.p1.11.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.11.m4.1.1.3.3.4" xref="S4.SS1.p1.11.m4.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m4.1b"><apply id="S4.SS1.p1.11.m4.1.1.cmml" xref="S4.SS1.p1.11.m4.1.1"><in id="S4.SS1.p1.11.m4.1.1.1.cmml" xref="S4.SS1.p1.11.m4.1.1.1"></in><apply id="S4.SS1.p1.11.m4.1.1.2.cmml" xref="S4.SS1.p1.11.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m4.1.1.2.1.cmml" xref="S4.SS1.p1.11.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.11.m4.1.1.2.2.cmml" xref="S4.SS1.p1.11.m4.1.1.2.2">𝐡</ci><apply id="S4.SS1.p1.11.m4.1.1.2.3.cmml" xref="S4.SS1.p1.11.m4.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m4.1.1.2.3.1.cmml" xref="S4.SS1.p1.11.m4.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.11.m4.1.1.2.3.2.cmml" xref="S4.SS1.p1.11.m4.1.1.2.3.2">𝑑</ci><ci id="S4.SS1.p1.11.m4.1.1.2.3.3.cmml" xref="S4.SS1.p1.11.m4.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.11.m4.1.1.3.cmml" xref="S4.SS1.p1.11.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m4.1.1.3.1.cmml" xref="S4.SS1.p1.11.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.11.m4.1.1.3.2.cmml" xref="S4.SS1.p1.11.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.11.m4.1.1.3.3.cmml" xref="S4.SS1.p1.11.m4.1.1.3.3"><times id="S4.SS1.p1.11.m4.1.1.3.3.1.cmml" xref="S4.SS1.p1.11.m4.1.1.3.3.1"></times><ci id="S4.SS1.p1.11.m4.1.1.3.3.2.cmml" xref="S4.SS1.p1.11.m4.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p1.11.m4.1.1.3.3.3.cmml" xref="S4.SS1.p1.11.m4.1.1.3.3.3">𝑖</ci><ci id="S4.SS1.p1.11.m4.1.1.3.3.4.cmml" xref="S4.SS1.p1.11.m4.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m4.1c">\mathbf{h}_{d_{i}}\in\mathbb{R}^{dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m4.1d">bold_h start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> represents the embedding for entity <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m5.1"><semantics id="S4.SS1.p1.12.m5.1a"><msub id="S4.SS1.p1.12.m5.1.1" xref="S4.SS1.p1.12.m5.1.1.cmml"><mi id="S4.SS1.p1.12.m5.1.1.2" xref="S4.SS1.p1.12.m5.1.1.2.cmml">d</mi><mi id="S4.SS1.p1.12.m5.1.1.3" xref="S4.SS1.p1.12.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m5.1b"><apply id="S4.SS1.p1.12.m5.1.1.cmml" xref="S4.SS1.p1.12.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m5.1.1.1.cmml" xref="S4.SS1.p1.12.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m5.1.1.2.cmml" xref="S4.SS1.p1.12.m5.1.1.2">𝑑</ci><ci id="S4.SS1.p1.12.m5.1.1.3.cmml" xref="S4.SS1.p1.12.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m5.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m5.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{h}_{p_{j}}\in\mathbb{R}^{dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m6.1"><semantics id="S4.SS1.p1.13.m6.1a"><mrow id="S4.SS1.p1.13.m6.1.1" xref="S4.SS1.p1.13.m6.1.1.cmml"><msub id="S4.SS1.p1.13.m6.1.1.2" xref="S4.SS1.p1.13.m6.1.1.2.cmml"><mi id="S4.SS1.p1.13.m6.1.1.2.2" xref="S4.SS1.p1.13.m6.1.1.2.2.cmml">𝐡</mi><msub id="S4.SS1.p1.13.m6.1.1.2.3" xref="S4.SS1.p1.13.m6.1.1.2.3.cmml"><mi id="S4.SS1.p1.13.m6.1.1.2.3.2" xref="S4.SS1.p1.13.m6.1.1.2.3.2.cmml">p</mi><mi id="S4.SS1.p1.13.m6.1.1.2.3.3" xref="S4.SS1.p1.13.m6.1.1.2.3.3.cmml">j</mi></msub></msub><mo id="S4.SS1.p1.13.m6.1.1.1" xref="S4.SS1.p1.13.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.13.m6.1.1.3" xref="S4.SS1.p1.13.m6.1.1.3.cmml"><mi id="S4.SS1.p1.13.m6.1.1.3.2" xref="S4.SS1.p1.13.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.13.m6.1.1.3.3" xref="S4.SS1.p1.13.m6.1.1.3.3.cmml"><mi id="S4.SS1.p1.13.m6.1.1.3.3.2" xref="S4.SS1.p1.13.m6.1.1.3.3.2.cmml">d</mi><mo id="S4.SS1.p1.13.m6.1.1.3.3.1" xref="S4.SS1.p1.13.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.13.m6.1.1.3.3.3" xref="S4.SS1.p1.13.m6.1.1.3.3.3.cmml">i</mi><mo id="S4.SS1.p1.13.m6.1.1.3.3.1a" xref="S4.SS1.p1.13.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.13.m6.1.1.3.3.4" xref="S4.SS1.p1.13.m6.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m6.1b"><apply id="S4.SS1.p1.13.m6.1.1.cmml" xref="S4.SS1.p1.13.m6.1.1"><in id="S4.SS1.p1.13.m6.1.1.1.cmml" xref="S4.SS1.p1.13.m6.1.1.1"></in><apply id="S4.SS1.p1.13.m6.1.1.2.cmml" xref="S4.SS1.p1.13.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m6.1.1.2.1.cmml" xref="S4.SS1.p1.13.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.13.m6.1.1.2.2.cmml" xref="S4.SS1.p1.13.m6.1.1.2.2">𝐡</ci><apply id="S4.SS1.p1.13.m6.1.1.2.3.cmml" xref="S4.SS1.p1.13.m6.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m6.1.1.2.3.1.cmml" xref="S4.SS1.p1.13.m6.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.13.m6.1.1.2.3.2.cmml" xref="S4.SS1.p1.13.m6.1.1.2.3.2">𝑝</ci><ci id="S4.SS1.p1.13.m6.1.1.2.3.3.cmml" xref="S4.SS1.p1.13.m6.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S4.SS1.p1.13.m6.1.1.3.cmml" xref="S4.SS1.p1.13.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m6.1.1.3.1.cmml" xref="S4.SS1.p1.13.m6.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.13.m6.1.1.3.2.cmml" xref="S4.SS1.p1.13.m6.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.13.m6.1.1.3.3.cmml" xref="S4.SS1.p1.13.m6.1.1.3.3"><times id="S4.SS1.p1.13.m6.1.1.3.3.1.cmml" xref="S4.SS1.p1.13.m6.1.1.3.3.1"></times><ci id="S4.SS1.p1.13.m6.1.1.3.3.2.cmml" xref="S4.SS1.p1.13.m6.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p1.13.m6.1.1.3.3.3.cmml" xref="S4.SS1.p1.13.m6.1.1.3.3.3">𝑖</ci><ci id="S4.SS1.p1.13.m6.1.1.3.3.4.cmml" xref="S4.SS1.p1.13.m6.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m6.1c">\mathbf{h}_{p_{j}}\in\mathbb{R}^{dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m6.1d">bold_h start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}_{m_{k}}\in\mathbb{R}^{dim}" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m7.1"><semantics id="S4.SS1.p1.14.m7.1a"><mrow id="S4.SS1.p1.14.m7.1.1" xref="S4.SS1.p1.14.m7.1.1.cmml"><msub id="S4.SS1.p1.14.m7.1.1.2" xref="S4.SS1.p1.14.m7.1.1.2.cmml"><mi id="S4.SS1.p1.14.m7.1.1.2.2" xref="S4.SS1.p1.14.m7.1.1.2.2.cmml">𝐡</mi><msub id="S4.SS1.p1.14.m7.1.1.2.3" xref="S4.SS1.p1.14.m7.1.1.2.3.cmml"><mi id="S4.SS1.p1.14.m7.1.1.2.3.2" xref="S4.SS1.p1.14.m7.1.1.2.3.2.cmml">m</mi><mi id="S4.SS1.p1.14.m7.1.1.2.3.3" xref="S4.SS1.p1.14.m7.1.1.2.3.3.cmml">k</mi></msub></msub><mo id="S4.SS1.p1.14.m7.1.1.1" xref="S4.SS1.p1.14.m7.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.14.m7.1.1.3" xref="S4.SS1.p1.14.m7.1.1.3.cmml"><mi id="S4.SS1.p1.14.m7.1.1.3.2" xref="S4.SS1.p1.14.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.14.m7.1.1.3.3" xref="S4.SS1.p1.14.m7.1.1.3.3.cmml"><mi id="S4.SS1.p1.14.m7.1.1.3.3.2" xref="S4.SS1.p1.14.m7.1.1.3.3.2.cmml">d</mi><mo id="S4.SS1.p1.14.m7.1.1.3.3.1" xref="S4.SS1.p1.14.m7.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.14.m7.1.1.3.3.3" xref="S4.SS1.p1.14.m7.1.1.3.3.3.cmml">i</mi><mo id="S4.SS1.p1.14.m7.1.1.3.3.1a" xref="S4.SS1.p1.14.m7.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.14.m7.1.1.3.3.4" xref="S4.SS1.p1.14.m7.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m7.1b"><apply id="S4.SS1.p1.14.m7.1.1.cmml" xref="S4.SS1.p1.14.m7.1.1"><in id="S4.SS1.p1.14.m7.1.1.1.cmml" xref="S4.SS1.p1.14.m7.1.1.1"></in><apply id="S4.SS1.p1.14.m7.1.1.2.cmml" xref="S4.SS1.p1.14.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m7.1.1.2.1.cmml" xref="S4.SS1.p1.14.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.14.m7.1.1.2.2.cmml" xref="S4.SS1.p1.14.m7.1.1.2.2">𝐡</ci><apply id="S4.SS1.p1.14.m7.1.1.2.3.cmml" xref="S4.SS1.p1.14.m7.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m7.1.1.2.3.1.cmml" xref="S4.SS1.p1.14.m7.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.14.m7.1.1.2.3.2.cmml" xref="S4.SS1.p1.14.m7.1.1.2.3.2">𝑚</ci><ci id="S4.SS1.p1.14.m7.1.1.2.3.3.cmml" xref="S4.SS1.p1.14.m7.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S4.SS1.p1.14.m7.1.1.3.cmml" xref="S4.SS1.p1.14.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m7.1.1.3.1.cmml" xref="S4.SS1.p1.14.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.14.m7.1.1.3.2.cmml" xref="S4.SS1.p1.14.m7.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.14.m7.1.1.3.3.cmml" xref="S4.SS1.p1.14.m7.1.1.3.3"><times id="S4.SS1.p1.14.m7.1.1.3.3.1.cmml" xref="S4.SS1.p1.14.m7.1.1.3.3.1"></times><ci id="S4.SS1.p1.14.m7.1.1.3.3.2.cmml" xref="S4.SS1.p1.14.m7.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p1.14.m7.1.1.3.3.3.cmml" xref="S4.SS1.p1.14.m7.1.1.3.3.3">𝑖</ci><ci id="S4.SS1.p1.14.m7.1.1.3.3.4.cmml" xref="S4.SS1.p1.14.m7.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m7.1c">\mathbf{h}_{m_{k}}\in\mathbb{R}^{dim}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m7.1d">bold_h start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> follow the same logic for entities <math alttext="p_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m8.1"><semantics id="S4.SS1.p1.15.m8.1a"><msub id="S4.SS1.p1.15.m8.1.1" xref="S4.SS1.p1.15.m8.1.1.cmml"><mi id="S4.SS1.p1.15.m8.1.1.2" xref="S4.SS1.p1.15.m8.1.1.2.cmml">p</mi><mi id="S4.SS1.p1.15.m8.1.1.3" xref="S4.SS1.p1.15.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m8.1b"><apply id="S4.SS1.p1.15.m8.1.1.cmml" xref="S4.SS1.p1.15.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m8.1.1.1.cmml" xref="S4.SS1.p1.15.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.15.m8.1.1.2.cmml" xref="S4.SS1.p1.15.m8.1.1.2">𝑝</ci><ci id="S4.SS1.p1.15.m8.1.1.3.cmml" xref="S4.SS1.p1.15.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m8.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.15.m8.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="m_{k}" class="ltx_Math" display="inline" id="S4.SS1.p1.16.m9.1"><semantics id="S4.SS1.p1.16.m9.1a"><msub id="S4.SS1.p1.16.m9.1.1" xref="S4.SS1.p1.16.m9.1.1.cmml"><mi id="S4.SS1.p1.16.m9.1.1.2" xref="S4.SS1.p1.16.m9.1.1.2.cmml">m</mi><mi id="S4.SS1.p1.16.m9.1.1.3" xref="S4.SS1.p1.16.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m9.1b"><apply id="S4.SS1.p1.16.m9.1.1.cmml" xref="S4.SS1.p1.16.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m9.1.1.1.cmml" xref="S4.SS1.p1.16.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.16.m9.1.1.2.cmml" xref="S4.SS1.p1.16.m9.1.1.2">𝑚</ci><ci id="S4.SS1.p1.16.m9.1.1.3.cmml" xref="S4.SS1.p1.16.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m9.1c">m_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.16.m9.1d">italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Relationship Mining</h3>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="395" id="S4.F3.g1" src="x4.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.10.5.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.8.4" style="font-size:90%;">An example of causal discovery, discovering the true relationship between <math alttext="d_{1}" class="ltx_Math" display="inline" id="S4.F3.5.1.m1.1"><semantics id="S4.F3.5.1.m1.1b"><msub id="S4.F3.5.1.m1.1.1" xref="S4.F3.5.1.m1.1.1.cmml"><mi id="S4.F3.5.1.m1.1.1.2" xref="S4.F3.5.1.m1.1.1.2.cmml">d</mi><mn id="S4.F3.5.1.m1.1.1.3" xref="S4.F3.5.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F3.5.1.m1.1c"><apply id="S4.F3.5.1.m1.1.1.cmml" xref="S4.F3.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F3.5.1.m1.1.1.1.cmml" xref="S4.F3.5.1.m1.1.1">subscript</csymbol><ci id="S4.F3.5.1.m1.1.1.2.cmml" xref="S4.F3.5.1.m1.1.1.2">𝑑</ci><cn id="S4.F3.5.1.m1.1.1.3.cmml" type="integer" xref="S4.F3.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.1.m1.1d">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.1.m1.1e">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.F3.6.2.m2.1"><semantics id="S4.F3.6.2.m2.1b"><msub id="S4.F3.6.2.m2.1.1" xref="S4.F3.6.2.m2.1.1.cmml"><mi id="S4.F3.6.2.m2.1.1.2" xref="S4.F3.6.2.m2.1.1.2.cmml">d</mi><mn id="S4.F3.6.2.m2.1.1.3" xref="S4.F3.6.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F3.6.2.m2.1c"><apply id="S4.F3.6.2.m2.1.1.cmml" xref="S4.F3.6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F3.6.2.m2.1.1.1.cmml" xref="S4.F3.6.2.m2.1.1">subscript</csymbol><ci id="S4.F3.6.2.m2.1.1.2.cmml" xref="S4.F3.6.2.m2.1.1.2">𝑑</ci><cn id="S4.F3.6.2.m2.1.1.3.cmml" type="integer" xref="S4.F3.6.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.2.m2.1d">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.6.2.m2.1e">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and eliminating the false relationship between <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.F3.7.3.m3.1"><semantics id="S4.F3.7.3.m3.1b"><msub id="S4.F3.7.3.m3.1.1" xref="S4.F3.7.3.m3.1.1.cmml"><mi id="S4.F3.7.3.m3.1.1.2" xref="S4.F3.7.3.m3.1.1.2.cmml">d</mi><mn id="S4.F3.7.3.m3.1.1.3" xref="S4.F3.7.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F3.7.3.m3.1c"><apply id="S4.F3.7.3.m3.1.1.cmml" xref="S4.F3.7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F3.7.3.m3.1.1.1.cmml" xref="S4.F3.7.3.m3.1.1">subscript</csymbol><ci id="S4.F3.7.3.m3.1.1.2.cmml" xref="S4.F3.7.3.m3.1.1.2">𝑑</ci><cn id="S4.F3.7.3.m3.1.1.3.cmml" type="integer" xref="S4.F3.7.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.3.m3.1d">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.7.3.m3.1e">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="m_{1}" class="ltx_Math" display="inline" id="S4.F3.8.4.m4.1"><semantics id="S4.F3.8.4.m4.1b"><msub id="S4.F3.8.4.m4.1.1" xref="S4.F3.8.4.m4.1.1.cmml"><mi id="S4.F3.8.4.m4.1.1.2" xref="S4.F3.8.4.m4.1.1.2.cmml">m</mi><mn id="S4.F3.8.4.m4.1.1.3" xref="S4.F3.8.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F3.8.4.m4.1c"><apply id="S4.F3.8.4.m4.1.1.cmml" xref="S4.F3.8.4.m4.1.1"><csymbol cd="ambiguous" id="S4.F3.8.4.m4.1.1.1.cmml" xref="S4.F3.8.4.m4.1.1">subscript</csymbol><ci id="S4.F3.8.4.m4.1.1.2.cmml" xref="S4.F3.8.4.m4.1.1.2">𝑚</ci><cn id="S4.F3.8.4.m4.1.1.3.cmml" type="integer" xref="S4.F3.8.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.4.m4.1d">m_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.8.4.m4.1e">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, ultimately transforming set-to-set relationships into point-to-point relationships.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F3.11">\Description</span></div>
</div>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">At this stage, we use causal discovery and estimation to uncover genuine relationships among medical entities, eliminating spurious co-occurrence relationships. We transform set-to-set relationships into precise point-to-point relationships and refine causal effects for each group.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">Firstly, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.F3" title="Figure 3 ‣ 4.2. Relationship Mining ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">3</span></a>, the co-occurrence-based method simply associates all diseases and medications that appear together in a single medical visit, assuming that <math alttext="d_{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">d</mi><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑑</ci><cn id="S4.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">d</mi><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑑</ci><cn id="S4.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are both related to <math alttext="m_{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">m</mi><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑚</ci><cn id="S4.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">m_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. However, causal discovery methods can learn that <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">d</mi><mn id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑑</ci><cn id="S4.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is caused by <math alttext="d_{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">d</mi><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝑑</ci><cn id="S4.SS2.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> by resolving backdoor paths <cite class="ltx_cite ltx_citemacro_citep">(Pearl and Mackenzie, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib20" title="">2018</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib16" title="">2022</a>)</cite>, and there is no actual relationship between <math alttext="m_{1}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">m</mi><mn id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝑚</ci><cn id="S4.SS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S4.SS2.p2.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">m_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">d</mi><mn id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝑑</ci><cn id="S4.SS2.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.SS2.p2.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
We utilize causal discovery to learn the causal structure from set-to-set relationships, uncovering the true underlying relationships and eliminating spurious ones caused by co-occurrence, ultimately generating point-to-point relationships between diseases and medications.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.5">Specifically, we analyze the EHR to obtain the distribution <math alttext="U" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_U</annotation></semantics></math> of medical entities and employ a variation of Greedy Intervention Equivalence Search (GIES) <cite class="ltx_cite ltx_citemacro_citep">(Nandy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib19" title="">2018</a>; Kalainathan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib13" title="">2020</a>)</cite> to identify confounding bias and generate a causal relationship graph <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_G</annotation></semantics></math>. GIES optimizes the Bayesian equivalence class. Concerning the Bayesian equivalence class, we define the scoring criterion as <math alttext="S(G,U)" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.2"><semantics id="S4.SS2.p3.3.m3.2a"><mrow id="S4.SS2.p3.3.m3.2.3" xref="S4.SS2.p3.3.m3.2.3.cmml"><mi id="S4.SS2.p3.3.m3.2.3.2" xref="S4.SS2.p3.3.m3.2.3.2.cmml">S</mi><mo id="S4.SS2.p3.3.m3.2.3.1" xref="S4.SS2.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p3.3.m3.2.3.3.2" xref="S4.SS2.p3.3.m3.2.3.3.1.cmml"><mo id="S4.SS2.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS2.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">G</mi><mo id="S4.SS2.p3.3.m3.2.3.3.2.2" xref="S4.SS2.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p3.3.m3.2.2" xref="S4.SS2.p3.3.m3.2.2.cmml">U</mi><mo id="S4.SS2.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS2.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.2b"><apply id="S4.SS2.p3.3.m3.2.3.cmml" xref="S4.SS2.p3.3.m3.2.3"><times id="S4.SS2.p3.3.m3.2.3.1.cmml" xref="S4.SS2.p3.3.m3.2.3.1"></times><ci id="S4.SS2.p3.3.m3.2.3.2.cmml" xref="S4.SS2.p3.3.m3.2.3.2">𝑆</ci><interval closure="open" id="S4.SS2.p3.3.m3.2.3.3.1.cmml" xref="S4.SS2.p3.3.m3.2.3.3.2"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝐺</ci><ci id="S4.SS2.p3.3.m3.2.2.cmml" xref="S4.SS2.p3.3.m3.2.2">𝑈</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.2c">S(G,U)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.2d">italic_S ( italic_G , italic_U )</annotation></semantics></math> to evaluate the quality of each causal graph <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">italic_G</annotation></semantics></math> learned from the distribution <math alttext="U" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_U</annotation></semantics></math>.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx1">
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle S(G,U)=\sum_{i=1}^{n}s(X_{i},P^{G}_{a_{i}})," class="ltx_Math" display="block" id="S4.E2.m1.3"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3.1" xref="S4.E2.m1.3.3.1.1.cmml"><mrow id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml"><mrow id="S4.E2.m1.3.3.1.1.4" xref="S4.E2.m1.3.3.1.1.4.cmml"><mi id="S4.E2.m1.3.3.1.1.4.2" xref="S4.E2.m1.3.3.1.1.4.2.cmml">S</mi><mo id="S4.E2.m1.3.3.1.1.4.1" xref="S4.E2.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.4.3.2" xref="S4.E2.m1.3.3.1.1.4.3.1.cmml"><mo id="S4.E2.m1.3.3.1.1.4.3.2.1" stretchy="false" xref="S4.E2.m1.3.3.1.1.4.3.1.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">G</mi><mo id="S4.E2.m1.3.3.1.1.4.3.2.2" xref="S4.E2.m1.3.3.1.1.4.3.1.cmml">,</mo><mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">U</mi><mo id="S4.E2.m1.3.3.1.1.4.3.2.3" stretchy="false" xref="S4.E2.m1.3.3.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.1.1.3" rspace="0.111em" xref="S4.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.2" xref="S4.E2.m1.3.3.1.1.2.cmml"><munderover id="S4.E2.m1.3.3.1.1.2.3" xref="S4.E2.m1.3.3.1.1.2.3.cmml"><mo id="S4.E2.m1.3.3.1.1.2.3.2.2" movablelimits="false" xref="S4.E2.m1.3.3.1.1.2.3.2.2.cmml">∑</mo><mrow id="S4.E2.m1.3.3.1.1.2.3.2.3" xref="S4.E2.m1.3.3.1.1.2.3.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.2.3.2.3.2" xref="S4.E2.m1.3.3.1.1.2.3.2.3.2.cmml">i</mi><mo id="S4.E2.m1.3.3.1.1.2.3.2.3.1" xref="S4.E2.m1.3.3.1.1.2.3.2.3.1.cmml">=</mo><mn id="S4.E2.m1.3.3.1.1.2.3.2.3.3" xref="S4.E2.m1.3.3.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.3.3.1.1.2.3.3" xref="S4.E2.m1.3.3.1.1.2.3.3.cmml">n</mi></munderover><mrow id="S4.E2.m1.3.3.1.1.2.2" xref="S4.E2.m1.3.3.1.1.2.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.4" xref="S4.E2.m1.3.3.1.1.2.2.4.cmml">s</mi><mo id="S4.E2.m1.3.3.1.1.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S4.E2.m1.3.3.1.1.2.2.2.3.cmml">(</mo><msub id="S4.E2.m1.3.3.1.1.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.4" xref="S4.E2.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msubsup id="S4.E2.m1.3.3.1.1.2.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">P</mi><msub id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.2.cmml">a</mi><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.3.cmml">i</mi></msub><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">G</mi></msubsup><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S4.E2.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.3.3.1.2" xref="S4.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1"><eq id="S4.E2.m1.3.3.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.3"></eq><apply id="S4.E2.m1.3.3.1.1.4.cmml" xref="S4.E2.m1.3.3.1.1.4"><times id="S4.E2.m1.3.3.1.1.4.1.cmml" xref="S4.E2.m1.3.3.1.1.4.1"></times><ci id="S4.E2.m1.3.3.1.1.4.2.cmml" xref="S4.E2.m1.3.3.1.1.4.2">𝑆</ci><interval closure="open" id="S4.E2.m1.3.3.1.1.4.3.1.cmml" xref="S4.E2.m1.3.3.1.1.4.3.2"><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝐺</ci><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝑈</ci></interval></apply><apply id="S4.E2.m1.3.3.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.2"><apply id="S4.E2.m1.3.3.1.1.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.3">superscript</csymbol><apply id="S4.E2.m1.3.3.1.1.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S4.E2.m1.3.3.1.1.2.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.3.2.2"></sum><apply id="S4.E2.m1.3.3.1.1.2.3.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.3.2.3"><eq id="S4.E2.m1.3.3.1.1.2.3.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.3.2.3.1"></eq><ci id="S4.E2.m1.3.3.1.1.2.3.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.3.2.3.2">𝑖</ci><cn id="S4.E2.m1.3.3.1.1.2.3.2.3.3.cmml" type="integer" xref="S4.E2.m1.3.3.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.3.3.1.1.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.3.3">𝑛</ci></apply><apply id="S4.E2.m1.3.3.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2"><times id="S4.E2.m1.3.3.1.1.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3"></times><ci id="S4.E2.m1.3.3.1.1.2.2.4.cmml" xref="S4.E2.m1.3.3.1.1.2.2.4">𝑠</ci><interval closure="open" id="S4.E2.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"><apply id="S4.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2">superscript</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.2">𝑃</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.3">𝐺</ci></apply><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.2">𝑎</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">\displaystyle S(G,U)=\sum_{i=1}^{n}s(X_{i},P^{G}_{a_{i}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.3d">italic_S ( italic_G , italic_U ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_s ( italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_P start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle G^{\prime}=\text{GIES}(S,G)," class="ltx_Math" display="block" id="S4.E3.m1.3"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.3.1" xref="S4.E3.m1.3.3.1.1.cmml"><mrow id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml"><msup id="S4.E3.m1.3.3.1.1.2" xref="S4.E3.m1.3.3.1.1.2.cmml"><mi id="S4.E3.m1.3.3.1.1.2.2" xref="S4.E3.m1.3.3.1.1.2.2.cmml">G</mi><mo id="S4.E3.m1.3.3.1.1.2.3" xref="S4.E3.m1.3.3.1.1.2.3.cmml">′</mo></msup><mo id="S4.E3.m1.3.3.1.1.1" xref="S4.E3.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.3.3.1.1.3" xref="S4.E3.m1.3.3.1.1.3.cmml"><mtext id="S4.E3.m1.3.3.1.1.3.2" xref="S4.E3.m1.3.3.1.1.3.2a.cmml">GIES</mtext><mo id="S4.E3.m1.3.3.1.1.3.1" xref="S4.E3.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3.m1.3.3.1.1.3.3.2" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml"><mo id="S4.E3.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">S</mi><mo id="S4.E3.m1.3.3.1.1.3.3.2.2" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">G</mi><mo id="S4.E3.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S4.E3.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.3.3.1.2" xref="S4.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1"><eq id="S4.E3.m1.3.3.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1"></eq><apply id="S4.E3.m1.3.3.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.2.1.cmml" xref="S4.E3.m1.3.3.1.1.2">superscript</csymbol><ci id="S4.E3.m1.3.3.1.1.2.2.cmml" xref="S4.E3.m1.3.3.1.1.2.2">𝐺</ci><ci id="S4.E3.m1.3.3.1.1.2.3.cmml" xref="S4.E3.m1.3.3.1.1.2.3">′</ci></apply><apply id="S4.E3.m1.3.3.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.3"><times id="S4.E3.m1.3.3.1.1.3.1.cmml" xref="S4.E3.m1.3.3.1.1.3.1"></times><ci id="S4.E3.m1.3.3.1.1.3.2a.cmml" xref="S4.E3.m1.3.3.1.1.3.2"><mtext id="S4.E3.m1.3.3.1.1.3.2.cmml" xref="S4.E3.m1.3.3.1.1.3.2">GIES</mtext></ci><interval closure="open" id="S4.E3.m1.3.3.1.1.3.3.1.cmml" xref="S4.E3.m1.3.3.1.1.3.3.2"><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝑆</ci><ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">𝐺</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">\displaystyle G^{\prime}=\text{GIES}(S,G),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.3d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = GIES ( italic_S , italic_G ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.19">where <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m1.1"><semantics id="S4.SS2.p3.6.m1.1a"><mi id="S4.SS2.p3.6.m1.1.1" xref="S4.SS2.p3.6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m1.1b"><ci id="S4.SS2.p3.6.m1.1.1.cmml" xref="S4.SS2.p3.6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m1.1d">italic_n</annotation></semantics></math> is the number of variables, <math alttext="X_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m2.1"><semantics id="S4.SS2.p3.7.m2.1a"><msub id="S4.SS2.p3.7.m2.1.1" xref="S4.SS2.p3.7.m2.1.1.cmml"><mi id="S4.SS2.p3.7.m2.1.1.2" xref="S4.SS2.p3.7.m2.1.1.2.cmml">X</mi><mi id="S4.SS2.p3.7.m2.1.1.3" xref="S4.SS2.p3.7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m2.1b"><apply id="S4.SS2.p3.7.m2.1.1.cmml" xref="S4.SS2.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m2.1.1.1.cmml" xref="S4.SS2.p3.7.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.7.m2.1.1.2.cmml" xref="S4.SS2.p3.7.m2.1.1.2">𝑋</ci><ci id="S4.SS2.p3.7.m2.1.1.3.cmml" xref="S4.SS2.p3.7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m2.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m2.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the variable including disease, surgery, and medication, and <math alttext="P^{G}_{a_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m3.1"><semantics id="S4.SS2.p3.8.m3.1a"><msubsup id="S4.SS2.p3.8.m3.1.1" xref="S4.SS2.p3.8.m3.1.1.cmml"><mi id="S4.SS2.p3.8.m3.1.1.2.2" xref="S4.SS2.p3.8.m3.1.1.2.2.cmml">P</mi><msub id="S4.SS2.p3.8.m3.1.1.3" xref="S4.SS2.p3.8.m3.1.1.3.cmml"><mi id="S4.SS2.p3.8.m3.1.1.3.2" xref="S4.SS2.p3.8.m3.1.1.3.2.cmml">a</mi><mi id="S4.SS2.p3.8.m3.1.1.3.3" xref="S4.SS2.p3.8.m3.1.1.3.3.cmml">i</mi></msub><mi id="S4.SS2.p3.8.m3.1.1.2.3" xref="S4.SS2.p3.8.m3.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m3.1b"><apply id="S4.SS2.p3.8.m3.1.1.cmml" xref="S4.SS2.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m3.1.1.1.cmml" xref="S4.SS2.p3.8.m3.1.1">subscript</csymbol><apply id="S4.SS2.p3.8.m3.1.1.2.cmml" xref="S4.SS2.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m3.1.1.2.1.cmml" xref="S4.SS2.p3.8.m3.1.1">superscript</csymbol><ci id="S4.SS2.p3.8.m3.1.1.2.2.cmml" xref="S4.SS2.p3.8.m3.1.1.2.2">𝑃</ci><ci id="S4.SS2.p3.8.m3.1.1.2.3.cmml" xref="S4.SS2.p3.8.m3.1.1.2.3">𝐺</ci></apply><apply id="S4.SS2.p3.8.m3.1.1.3.cmml" xref="S4.SS2.p3.8.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m3.1.1.3.1.cmml" xref="S4.SS2.p3.8.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.8.m3.1.1.3.2.cmml" xref="S4.SS2.p3.8.m3.1.1.3.2">𝑎</ci><ci id="S4.SS2.p3.8.m3.1.1.3.3.cmml" xref="S4.SS2.p3.8.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m3.1c">P^{G}_{a_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m3.1d">italic_P start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> represents the parents of <math alttext="X_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m4.1"><semantics id="S4.SS2.p3.9.m4.1a"><msub id="S4.SS2.p3.9.m4.1.1" xref="S4.SS2.p3.9.m4.1.1.cmml"><mi id="S4.SS2.p3.9.m4.1.1.2" xref="S4.SS2.p3.9.m4.1.1.2.cmml">X</mi><mi id="S4.SS2.p3.9.m4.1.1.3" xref="S4.SS2.p3.9.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m4.1b"><apply id="S4.SS2.p3.9.m4.1.1.cmml" xref="S4.SS2.p3.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.9.m4.1.1.1.cmml" xref="S4.SS2.p3.9.m4.1.1">subscript</csymbol><ci id="S4.SS2.p3.9.m4.1.1.2.cmml" xref="S4.SS2.p3.9.m4.1.1.2">𝑋</ci><ci id="S4.SS2.p3.9.m4.1.1.3.cmml" xref="S4.SS2.p3.9.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m4.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m4.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in the graph <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m5.1"><semantics id="S4.SS2.p3.10.m5.1a"><mi id="S4.SS2.p3.10.m5.1.1" xref="S4.SS2.p3.10.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m5.1b"><ci id="S4.SS2.p3.10.m5.1.1.cmml" xref="S4.SS2.p3.10.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m5.1d">italic_G</annotation></semantics></math>.
And <math alttext="s(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p3.11.m6.2"><semantics id="S4.SS2.p3.11.m6.2a"><mrow id="S4.SS2.p3.11.m6.2.3" xref="S4.SS2.p3.11.m6.2.3.cmml"><mi id="S4.SS2.p3.11.m6.2.3.2" xref="S4.SS2.p3.11.m6.2.3.2.cmml">s</mi><mo id="S4.SS2.p3.11.m6.2.3.1" xref="S4.SS2.p3.11.m6.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p3.11.m6.2.3.3.2" xref="S4.SS2.p3.11.m6.2.3.3.1.cmml"><mo id="S4.SS2.p3.11.m6.2.3.3.2.1" stretchy="false" xref="S4.SS2.p3.11.m6.2.3.3.1.cmml">(</mo><mo id="S4.SS2.p3.11.m6.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p3.11.m6.1.1.cmml">⋅</mo><mo id="S4.SS2.p3.11.m6.2.3.3.2.2" rspace="0em" xref="S4.SS2.p3.11.m6.2.3.3.1.cmml">,</mo><mo id="S4.SS2.p3.11.m6.2.2" lspace="0em" rspace="0em" xref="S4.SS2.p3.11.m6.2.2.cmml">⋅</mo><mo id="S4.SS2.p3.11.m6.2.3.3.2.3" stretchy="false" xref="S4.SS2.p3.11.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m6.2b"><apply id="S4.SS2.p3.11.m6.2.3.cmml" xref="S4.SS2.p3.11.m6.2.3"><times id="S4.SS2.p3.11.m6.2.3.1.cmml" xref="S4.SS2.p3.11.m6.2.3.1"></times><ci id="S4.SS2.p3.11.m6.2.3.2.cmml" xref="S4.SS2.p3.11.m6.2.3.2">𝑠</ci><interval closure="open" id="S4.SS2.p3.11.m6.2.3.3.1.cmml" xref="S4.SS2.p3.11.m6.2.3.3.2"><ci id="S4.SS2.p3.11.m6.1.1.cmml" xref="S4.SS2.p3.11.m6.1.1">⋅</ci><ci id="S4.SS2.p3.11.m6.2.2.cmml" xref="S4.SS2.p3.11.m6.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m6.2c">s(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.11.m6.2d">italic_s ( ⋅ , ⋅ )</annotation></semantics></math> refers to the method of obtaining the equivalence class from <math alttext="X_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.12.m7.1"><semantics id="S4.SS2.p3.12.m7.1a"><msub id="S4.SS2.p3.12.m7.1.1" xref="S4.SS2.p3.12.m7.1.1.cmml"><mi id="S4.SS2.p3.12.m7.1.1.2" xref="S4.SS2.p3.12.m7.1.1.2.cmml">X</mi><mi id="S4.SS2.p3.12.m7.1.1.3" xref="S4.SS2.p3.12.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m7.1b"><apply id="S4.SS2.p3.12.m7.1.1.cmml" xref="S4.SS2.p3.12.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m7.1.1.1.cmml" xref="S4.SS2.p3.12.m7.1.1">subscript</csymbol><ci id="S4.SS2.p3.12.m7.1.1.2.cmml" xref="S4.SS2.p3.12.m7.1.1.2">𝑋</ci><ci id="S4.SS2.p3.12.m7.1.1.3.cmml" xref="S4.SS2.p3.12.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m7.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.12.m7.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and its parent nodes (<math alttext="P^{G}_{a_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p3.13.m8.1"><semantics id="S4.SS2.p3.13.m8.1a"><msubsup id="S4.SS2.p3.13.m8.1.1" xref="S4.SS2.p3.13.m8.1.1.cmml"><mi id="S4.SS2.p3.13.m8.1.1.2.2" xref="S4.SS2.p3.13.m8.1.1.2.2.cmml">P</mi><msub id="S4.SS2.p3.13.m8.1.1.3" xref="S4.SS2.p3.13.m8.1.1.3.cmml"><mi id="S4.SS2.p3.13.m8.1.1.3.2" xref="S4.SS2.p3.13.m8.1.1.3.2.cmml">a</mi><mi id="S4.SS2.p3.13.m8.1.1.3.3" xref="S4.SS2.p3.13.m8.1.1.3.3.cmml">i</mi></msub><mi id="S4.SS2.p3.13.m8.1.1.2.3" xref="S4.SS2.p3.13.m8.1.1.2.3.cmml">G</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.13.m8.1b"><apply id="S4.SS2.p3.13.m8.1.1.cmml" xref="S4.SS2.p3.13.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m8.1.1.1.cmml" xref="S4.SS2.p3.13.m8.1.1">subscript</csymbol><apply id="S4.SS2.p3.13.m8.1.1.2.cmml" xref="S4.SS2.p3.13.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m8.1.1.2.1.cmml" xref="S4.SS2.p3.13.m8.1.1">superscript</csymbol><ci id="S4.SS2.p3.13.m8.1.1.2.2.cmml" xref="S4.SS2.p3.13.m8.1.1.2.2">𝑃</ci><ci id="S4.SS2.p3.13.m8.1.1.2.3.cmml" xref="S4.SS2.p3.13.m8.1.1.2.3">𝐺</ci></apply><apply id="S4.SS2.p3.13.m8.1.1.3.cmml" xref="S4.SS2.p3.13.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m8.1.1.3.1.cmml" xref="S4.SS2.p3.13.m8.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.13.m8.1.1.3.2.cmml" xref="S4.SS2.p3.13.m8.1.1.3.2">𝑎</ci><ci id="S4.SS2.p3.13.m8.1.1.3.3.cmml" xref="S4.SS2.p3.13.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.13.m8.1c">P^{G}_{a_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.13.m8.1d">italic_P start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>), through which we can produce the initial graph <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p3.14.m9.1"><semantics id="S4.SS2.p3.14.m9.1a"><mi id="S4.SS2.p3.14.m9.1.1" xref="S4.SS2.p3.14.m9.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.14.m9.1b"><ci id="S4.SS2.p3.14.m9.1.1.cmml" xref="S4.SS2.p3.14.m9.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.14.m9.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.14.m9.1d">italic_G</annotation></semantics></math> and continuously update it.
The <math alttext="\text{GIES}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p3.15.m10.1"><semantics id="S4.SS2.p3.15.m10.1a"><mrow id="S4.SS2.p3.15.m10.1.2" xref="S4.SS2.p3.15.m10.1.2.cmml"><mtext id="S4.SS2.p3.15.m10.1.2.2" xref="S4.SS2.p3.15.m10.1.2.2a.cmml">GIES</mtext><mo id="S4.SS2.p3.15.m10.1.2.1" xref="S4.SS2.p3.15.m10.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p3.15.m10.1.2.3.2" xref="S4.SS2.p3.15.m10.1.2.cmml"><mo id="S4.SS2.p3.15.m10.1.2.3.2.1" stretchy="false" xref="S4.SS2.p3.15.m10.1.2.cmml">(</mo><mo id="S4.SS2.p3.15.m10.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p3.15.m10.1.1.cmml">⋅</mo><mo id="S4.SS2.p3.15.m10.1.2.3.2.2" stretchy="false" xref="S4.SS2.p3.15.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.15.m10.1b"><apply id="S4.SS2.p3.15.m10.1.2.cmml" xref="S4.SS2.p3.15.m10.1.2"><times id="S4.SS2.p3.15.m10.1.2.1.cmml" xref="S4.SS2.p3.15.m10.1.2.1"></times><ci id="S4.SS2.p3.15.m10.1.2.2a.cmml" xref="S4.SS2.p3.15.m10.1.2.2"><mtext id="S4.SS2.p3.15.m10.1.2.2.cmml" xref="S4.SS2.p3.15.m10.1.2.2">GIES</mtext></ci><ci id="S4.SS2.p3.15.m10.1.1.cmml" xref="S4.SS2.p3.15.m10.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.15.m10.1c">\text{GIES}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.15.m10.1d">GIES ( ⋅ )</annotation></semantics></math> optimizes and learns an optimized graph <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.p3.16.m11.1"><semantics id="S4.SS2.p3.16.m11.1a"><msup id="S4.SS2.p3.16.m11.1.1" xref="S4.SS2.p3.16.m11.1.1.cmml"><mi id="S4.SS2.p3.16.m11.1.1.2" xref="S4.SS2.p3.16.m11.1.1.2.cmml">G</mi><mo id="S4.SS2.p3.16.m11.1.1.3" xref="S4.SS2.p3.16.m11.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.16.m11.1b"><apply id="S4.SS2.p3.16.m11.1.1.cmml" xref="S4.SS2.p3.16.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.16.m11.1.1.1.cmml" xref="S4.SS2.p3.16.m11.1.1">superscript</csymbol><ci id="S4.SS2.p3.16.m11.1.1.2.cmml" xref="S4.SS2.p3.16.m11.1.1.2">𝐺</ci><ci id="S4.SS2.p3.16.m11.1.1.3.cmml" xref="S4.SS2.p3.16.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.16.m11.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.16.m11.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> from the initial graph <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p3.17.m12.1"><semantics id="S4.SS2.p3.17.m12.1a"><mi id="S4.SS2.p3.17.m12.1.1" xref="S4.SS2.p3.17.m12.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.17.m12.1b"><ci id="S4.SS2.p3.17.m12.1.1.cmml" xref="S4.SS2.p3.17.m12.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.17.m12.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.17.m12.1d">italic_G</annotation></semantics></math> and the equivalence score <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p3.18.m13.1"><semantics id="S4.SS2.p3.18.m13.1a"><mi id="S4.SS2.p3.18.m13.1.1" xref="S4.SS2.p3.18.m13.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.18.m13.1b"><ci id="S4.SS2.p3.18.m13.1.1.cmml" xref="S4.SS2.p3.18.m13.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.18.m13.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.18.m13.1d">italic_S</annotation></semantics></math>. We apply the above process to each medical visit, generating a series of pathological graphs <math alttext="\mathcal{G}=\{G_{v_{1}},G_{v_{2}},\ldots\}" class="ltx_Math" display="inline" id="S4.SS2.p3.19.m14.3"><semantics id="S4.SS2.p3.19.m14.3a"><mrow id="S4.SS2.p3.19.m14.3.3" xref="S4.SS2.p3.19.m14.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.19.m14.3.3.4" xref="S4.SS2.p3.19.m14.3.3.4.cmml">𝒢</mi><mo id="S4.SS2.p3.19.m14.3.3.3" xref="S4.SS2.p3.19.m14.3.3.3.cmml">=</mo><mrow id="S4.SS2.p3.19.m14.3.3.2.2" xref="S4.SS2.p3.19.m14.3.3.2.3.cmml"><mo id="S4.SS2.p3.19.m14.3.3.2.2.3" stretchy="false" xref="S4.SS2.p3.19.m14.3.3.2.3.cmml">{</mo><msub id="S4.SS2.p3.19.m14.2.2.1.1.1" xref="S4.SS2.p3.19.m14.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.19.m14.2.2.1.1.1.2" xref="S4.SS2.p3.19.m14.2.2.1.1.1.2.cmml">G</mi><msub id="S4.SS2.p3.19.m14.2.2.1.1.1.3" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.19.m14.2.2.1.1.1.3.2" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3.2.cmml">v</mi><mn id="S4.SS2.p3.19.m14.2.2.1.1.1.3.3" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.SS2.p3.19.m14.3.3.2.2.4" xref="S4.SS2.p3.19.m14.3.3.2.3.cmml">,</mo><msub id="S4.SS2.p3.19.m14.3.3.2.2.2" xref="S4.SS2.p3.19.m14.3.3.2.2.2.cmml"><mi id="S4.SS2.p3.19.m14.3.3.2.2.2.2" xref="S4.SS2.p3.19.m14.3.3.2.2.2.2.cmml">G</mi><msub id="S4.SS2.p3.19.m14.3.3.2.2.2.3" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3.cmml"><mi id="S4.SS2.p3.19.m14.3.3.2.2.2.3.2" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3.2.cmml">v</mi><mn id="S4.SS2.p3.19.m14.3.3.2.2.2.3.3" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.SS2.p3.19.m14.3.3.2.2.5" xref="S4.SS2.p3.19.m14.3.3.2.3.cmml">,</mo><mi id="S4.SS2.p3.19.m14.1.1" mathvariant="normal" xref="S4.SS2.p3.19.m14.1.1.cmml">…</mi><mo id="S4.SS2.p3.19.m14.3.3.2.2.6" stretchy="false" xref="S4.SS2.p3.19.m14.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.19.m14.3b"><apply id="S4.SS2.p3.19.m14.3.3.cmml" xref="S4.SS2.p3.19.m14.3.3"><eq id="S4.SS2.p3.19.m14.3.3.3.cmml" xref="S4.SS2.p3.19.m14.3.3.3"></eq><ci id="S4.SS2.p3.19.m14.3.3.4.cmml" xref="S4.SS2.p3.19.m14.3.3.4">𝒢</ci><set id="S4.SS2.p3.19.m14.3.3.2.3.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2"><apply id="S4.SS2.p3.19.m14.2.2.1.1.1.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.19.m14.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.19.m14.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1.2">𝐺</ci><apply id="S4.SS2.p3.19.m14.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.19.m14.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.19.m14.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3.2">𝑣</ci><cn id="S4.SS2.p3.19.m14.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.p3.19.m14.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.19.m14.3.3.2.2.2.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.19.m14.3.3.2.2.2.1.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.19.m14.3.3.2.2.2.2.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2.2">𝐺</ci><apply id="S4.SS2.p3.19.m14.3.3.2.2.2.3.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.19.m14.3.3.2.2.2.3.1.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.19.m14.3.3.2.2.2.3.2.cmml" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3.2">𝑣</ci><cn id="S4.SS2.p3.19.m14.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.p3.19.m14.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS2.p3.19.m14.1.1.cmml" xref="S4.SS2.p3.19.m14.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.19.m14.3c">\mathcal{G}=\{G_{v_{1}},G_{v_{2}},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.19.m14.3d">caligraphic_G = { italic_G start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … }</annotation></semantics></math> that encompass all visits.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.2">Subsequently, adopting the principles of causal estimation, we define diseases and procedures as treatment variables and medications as outcome variables. We use a generalized linear model adjusted based on the backdoor criterion <cite class="ltx_cite ltx_citemacro_citep">(Pearl and Mackenzie, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib20" title="">2018</a>; Gultchin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib7" title="">2020</a>)</cite> to calculate the quantified effects of medications on diseases and procedures. Ultimately, we obtain a quantified relationship between each disease/procedure and each medication, and construct matrices of causal effects, denoted as <math alttext="\mathbf{M}^{dm}\in\mathbb{R}^{|\mathcal{D}|\times|\mathcal{M}|}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.2"><semantics id="S4.SS2.p4.1.m1.2a"><mrow id="S4.SS2.p4.1.m1.2.3" xref="S4.SS2.p4.1.m1.2.3.cmml"><msup id="S4.SS2.p4.1.m1.2.3.2" xref="S4.SS2.p4.1.m1.2.3.2.cmml"><mi id="S4.SS2.p4.1.m1.2.3.2.2" xref="S4.SS2.p4.1.m1.2.3.2.2.cmml">𝐌</mi><mrow id="S4.SS2.p4.1.m1.2.3.2.3" xref="S4.SS2.p4.1.m1.2.3.2.3.cmml"><mi id="S4.SS2.p4.1.m1.2.3.2.3.2" xref="S4.SS2.p4.1.m1.2.3.2.3.2.cmml">d</mi><mo id="S4.SS2.p4.1.m1.2.3.2.3.1" xref="S4.SS2.p4.1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p4.1.m1.2.3.2.3.3" xref="S4.SS2.p4.1.m1.2.3.2.3.3.cmml">m</mi></mrow></msup><mo id="S4.SS2.p4.1.m1.2.3.1" xref="S4.SS2.p4.1.m1.2.3.1.cmml">∈</mo><msup id="S4.SS2.p4.1.m1.2.3.3" xref="S4.SS2.p4.1.m1.2.3.3.cmml"><mi id="S4.SS2.p4.1.m1.2.3.3.2" xref="S4.SS2.p4.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p4.1.m1.2.2.2" xref="S4.SS2.p4.1.m1.2.2.2.cmml"><mrow id="S4.SS2.p4.1.m1.2.2.2.4.2" xref="S4.SS2.p4.1.m1.2.2.2.4.1.cmml"><mo id="S4.SS2.p4.1.m1.2.2.2.4.2.1" stretchy="false" xref="S4.SS2.p4.1.m1.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.1.m1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.cmml">𝒟</mi><mo id="S4.SS2.p4.1.m1.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S4.SS2.p4.1.m1.2.2.2.4.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p4.1.m1.2.2.2.3" rspace="0.222em" xref="S4.SS2.p4.1.m1.2.2.2.3.cmml">×</mo><mrow id="S4.SS2.p4.1.m1.2.2.2.5.2" xref="S4.SS2.p4.1.m1.2.2.2.5.1.cmml"><mo id="S4.SS2.p4.1.m1.2.2.2.5.2.1" stretchy="false" xref="S4.SS2.p4.1.m1.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.1.m1.2.2.2.2" xref="S4.SS2.p4.1.m1.2.2.2.2.cmml">ℳ</mi><mo id="S4.SS2.p4.1.m1.2.2.2.5.2.2" stretchy="false" xref="S4.SS2.p4.1.m1.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.2b"><apply id="S4.SS2.p4.1.m1.2.3.cmml" xref="S4.SS2.p4.1.m1.2.3"><in id="S4.SS2.p4.1.m1.2.3.1.cmml" xref="S4.SS2.p4.1.m1.2.3.1"></in><apply id="S4.SS2.p4.1.m1.2.3.2.cmml" xref="S4.SS2.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.2.3.2.1.cmml" xref="S4.SS2.p4.1.m1.2.3.2">superscript</csymbol><ci id="S4.SS2.p4.1.m1.2.3.2.2.cmml" xref="S4.SS2.p4.1.m1.2.3.2.2">𝐌</ci><apply id="S4.SS2.p4.1.m1.2.3.2.3.cmml" xref="S4.SS2.p4.1.m1.2.3.2.3"><times id="S4.SS2.p4.1.m1.2.3.2.3.1.cmml" xref="S4.SS2.p4.1.m1.2.3.2.3.1"></times><ci id="S4.SS2.p4.1.m1.2.3.2.3.2.cmml" xref="S4.SS2.p4.1.m1.2.3.2.3.2">𝑑</ci><ci id="S4.SS2.p4.1.m1.2.3.2.3.3.cmml" xref="S4.SS2.p4.1.m1.2.3.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS2.p4.1.m1.2.3.3.cmml" xref="S4.SS2.p4.1.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.2.3.3.1.cmml" xref="S4.SS2.p4.1.m1.2.3.3">superscript</csymbol><ci id="S4.SS2.p4.1.m1.2.3.3.2.cmml" xref="S4.SS2.p4.1.m1.2.3.3.2">ℝ</ci><apply id="S4.SS2.p4.1.m1.2.2.2.cmml" xref="S4.SS2.p4.1.m1.2.2.2"><times id="S4.SS2.p4.1.m1.2.2.2.3.cmml" xref="S4.SS2.p4.1.m1.2.2.2.3"></times><apply id="S4.SS2.p4.1.m1.2.2.2.4.1.cmml" xref="S4.SS2.p4.1.m1.2.2.2.4.2"><abs id="S4.SS2.p4.1.m1.2.2.2.4.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.2.4.2.1"></abs><ci id="S4.SS2.p4.1.m1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1">𝒟</ci></apply><apply id="S4.SS2.p4.1.m1.2.2.2.5.1.cmml" xref="S4.SS2.p4.1.m1.2.2.2.5.2"><abs id="S4.SS2.p4.1.m1.2.2.2.5.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.2.5.2.1"></abs><ci id="S4.SS2.p4.1.m1.2.2.2.2.cmml" xref="S4.SS2.p4.1.m1.2.2.2.2">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.2c">\mathbf{M}^{dm}\in\mathbb{R}^{|\mathcal{D}|\times|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.2d">bold_M start_POSTSUPERSCRIPT italic_d italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_D | × | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{M}^{pm}\in\mathbb{R}^{|\mathcal{P}|\times|\mathcal{M}|}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.2"><semantics id="S4.SS2.p4.2.m2.2a"><mrow id="S4.SS2.p4.2.m2.2.3" xref="S4.SS2.p4.2.m2.2.3.cmml"><msup id="S4.SS2.p4.2.m2.2.3.2" xref="S4.SS2.p4.2.m2.2.3.2.cmml"><mi id="S4.SS2.p4.2.m2.2.3.2.2" xref="S4.SS2.p4.2.m2.2.3.2.2.cmml">𝐌</mi><mrow id="S4.SS2.p4.2.m2.2.3.2.3" xref="S4.SS2.p4.2.m2.2.3.2.3.cmml"><mi id="S4.SS2.p4.2.m2.2.3.2.3.2" xref="S4.SS2.p4.2.m2.2.3.2.3.2.cmml">p</mi><mo id="S4.SS2.p4.2.m2.2.3.2.3.1" xref="S4.SS2.p4.2.m2.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p4.2.m2.2.3.2.3.3" xref="S4.SS2.p4.2.m2.2.3.2.3.3.cmml">m</mi></mrow></msup><mo id="S4.SS2.p4.2.m2.2.3.1" xref="S4.SS2.p4.2.m2.2.3.1.cmml">∈</mo><msup id="S4.SS2.p4.2.m2.2.3.3" xref="S4.SS2.p4.2.m2.2.3.3.cmml"><mi id="S4.SS2.p4.2.m2.2.3.3.2" xref="S4.SS2.p4.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p4.2.m2.2.2.2" xref="S4.SS2.p4.2.m2.2.2.2.cmml"><mrow id="S4.SS2.p4.2.m2.2.2.2.4.2" xref="S4.SS2.p4.2.m2.2.2.2.4.1.cmml"><mo id="S4.SS2.p4.2.m2.2.2.2.4.2.1" stretchy="false" xref="S4.SS2.p4.2.m2.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.1.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.1.cmml">𝒫</mi><mo id="S4.SS2.p4.2.m2.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S4.SS2.p4.2.m2.2.2.2.4.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p4.2.m2.2.2.2.3" rspace="0.222em" xref="S4.SS2.p4.2.m2.2.2.2.3.cmml">×</mo><mrow id="S4.SS2.p4.2.m2.2.2.2.5.2" xref="S4.SS2.p4.2.m2.2.2.2.5.1.cmml"><mo id="S4.SS2.p4.2.m2.2.2.2.5.2.1" stretchy="false" xref="S4.SS2.p4.2.m2.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.2.2.2.2" xref="S4.SS2.p4.2.m2.2.2.2.2.cmml">ℳ</mi><mo id="S4.SS2.p4.2.m2.2.2.2.5.2.2" stretchy="false" xref="S4.SS2.p4.2.m2.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.2b"><apply id="S4.SS2.p4.2.m2.2.3.cmml" xref="S4.SS2.p4.2.m2.2.3"><in id="S4.SS2.p4.2.m2.2.3.1.cmml" xref="S4.SS2.p4.2.m2.2.3.1"></in><apply id="S4.SS2.p4.2.m2.2.3.2.cmml" xref="S4.SS2.p4.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.2.3.2.1.cmml" xref="S4.SS2.p4.2.m2.2.3.2">superscript</csymbol><ci id="S4.SS2.p4.2.m2.2.3.2.2.cmml" xref="S4.SS2.p4.2.m2.2.3.2.2">𝐌</ci><apply id="S4.SS2.p4.2.m2.2.3.2.3.cmml" xref="S4.SS2.p4.2.m2.2.3.2.3"><times id="S4.SS2.p4.2.m2.2.3.2.3.1.cmml" xref="S4.SS2.p4.2.m2.2.3.2.3.1"></times><ci id="S4.SS2.p4.2.m2.2.3.2.3.2.cmml" xref="S4.SS2.p4.2.m2.2.3.2.3.2">𝑝</ci><ci id="S4.SS2.p4.2.m2.2.3.2.3.3.cmml" xref="S4.SS2.p4.2.m2.2.3.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS2.p4.2.m2.2.3.3.cmml" xref="S4.SS2.p4.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.2.3.3.1.cmml" xref="S4.SS2.p4.2.m2.2.3.3">superscript</csymbol><ci id="S4.SS2.p4.2.m2.2.3.3.2.cmml" xref="S4.SS2.p4.2.m2.2.3.3.2">ℝ</ci><apply id="S4.SS2.p4.2.m2.2.2.2.cmml" xref="S4.SS2.p4.2.m2.2.2.2"><times id="S4.SS2.p4.2.m2.2.2.2.3.cmml" xref="S4.SS2.p4.2.m2.2.2.2.3"></times><apply id="S4.SS2.p4.2.m2.2.2.2.4.1.cmml" xref="S4.SS2.p4.2.m2.2.2.2.4.2"><abs id="S4.SS2.p4.2.m2.2.2.2.4.1.1.cmml" xref="S4.SS2.p4.2.m2.2.2.2.4.2.1"></abs><ci id="S4.SS2.p4.2.m2.1.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1">𝒫</ci></apply><apply id="S4.SS2.p4.2.m2.2.2.2.5.1.cmml" xref="S4.SS2.p4.2.m2.2.2.2.5.2"><abs id="S4.SS2.p4.2.m2.2.2.2.5.1.1.cmml" xref="S4.SS2.p4.2.m2.2.2.2.5.2.1"></abs><ci id="S4.SS2.p4.2.m2.2.2.2.2.cmml" xref="S4.SS2.p4.2.m2.2.2.2.2">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.2c">\mathbf{M}^{pm}\in\mathbb{R}^{|\mathcal{P}|\times|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.2d">bold_M start_POSTSUPERSCRIPT italic_p italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_P | × | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Health State Learning</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We use causal relationships to learn patients’ health states. Homomorphic relationships update entity meanings under different health states, while heterogeneous relationships apply disease/procedure-medication causality. This information is integrated to create a personalized clinical visit representation.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Homomorphic Relationship Learning</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">As shown in the left half of the Health State Learning part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2.F2" title="Figure 2 ‣ 2.1. Medication Recommendation ‣ 2. Related Work ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">2</span></a>, we learn entity representations through homomorphic relationships. By exploring pathological relationships based on causality, we capture the dynamic differences between entities, enhancing our ability to capture personalized patient characteristics.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1">In different health states, a disease’s impact on patients can vary. In one state, a disease may cause other diseases, while in another, it may result from them. We introduce a Dynamic Self-Adaptive Attention (DSA) mechanism to learn the role of diseases in various health states. Using causal positioning to determine a disease’s role in the current clinical setting, we assign different weights, enhancing personalized patient representations.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p3">
<p class="ltx_p" id="S4.SS3.SSS1.p3.11">First, we extract relationships from the causal graph <math alttext="G_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.1.m1.1"><semantics id="S4.SS3.SSS1.p3.1.m1.1a"><msub id="S4.SS3.SSS1.p3.1.m1.1.1" xref="S4.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p3.1.m1.1.1.2" xref="S4.SS3.SSS1.p3.1.m1.1.1.2.cmml">G</mi><msub id="S4.SS3.SSS1.p3.1.m1.1.1.3" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p3.1.m1.1.1.3.2" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS1.p3.1.m1.1.1.3.3" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.1.m1.1b"><apply id="S4.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.2">𝐺</ci><apply id="S4.SS3.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.1.m1.1c">G_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.1.m1.1d">italic_G start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> involving entities from the current visit and construct three isomorphic causal graphs: <math alttext="G^{d}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.2.m2.1"><semantics id="S4.SS3.SSS1.p3.2.m2.1a"><msubsup id="S4.SS3.SSS1.p3.2.m2.1.1" xref="S4.SS3.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p3.2.m2.1.1.2.2" xref="S4.SS3.SSS1.p3.2.m2.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS1.p3.2.m2.1.1.3" xref="S4.SS3.SSS1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS1.p3.2.m2.1.1.3.2" xref="S4.SS3.SSS1.p3.2.m2.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS1.p3.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p3.2.m2.1.1.3.3.cmml">t</mi></msub><mi id="S4.SS3.SSS1.p3.2.m2.1.1.2.3" xref="S4.SS3.SSS1.p3.2.m2.1.1.2.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.2.m2.1b"><apply id="S4.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.2.2">𝐺</ci><ci id="S4.SS3.SSS1.p3.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.2.3">𝑑</ci></apply><apply id="S4.SS3.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.2.m2.1c">G^{d}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.2.m2.1d">italic_G start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="G^{p}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.3.m3.1"><semantics id="S4.SS3.SSS1.p3.3.m3.1a"><msubsup id="S4.SS3.SSS1.p3.3.m3.1.1" xref="S4.SS3.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS3.SSS1.p3.3.m3.1.1.2.2" xref="S4.SS3.SSS1.p3.3.m3.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS1.p3.3.m3.1.1.3" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS1.p3.3.m3.1.1.3.2" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS1.p3.3.m3.1.1.3.3" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.3.cmml">t</mi></msub><mi id="S4.SS3.SSS1.p3.3.m3.1.1.2.3" xref="S4.SS3.SSS1.p3.3.m3.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.3.m3.1b"><apply id="S4.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.2.2">𝐺</ci><ci id="S4.SS3.SSS1.p3.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.2.3">𝑝</ci></apply><apply id="S4.SS3.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.3.m3.1c">G^{p}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.3.m3.1d">italic_G start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="G^{m}_{v_{t-1}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.4.m4.1"><semantics id="S4.SS3.SSS1.p3.4.m4.1a"><msubsup id="S4.SS3.SSS1.p3.4.m4.1.1" xref="S4.SS3.SSS1.p3.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p3.4.m4.1.1.2.2" xref="S4.SS3.SSS1.p3.4.m4.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS1.p3.4.m4.1.1.3" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS1.p3.4.m4.1.1.3.2" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.2.cmml">v</mi><mrow id="S4.SS3.SSS1.p3.4.m4.1.1.3.3" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.2" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.2.cmml">t</mi><mo id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.1" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.1.cmml">−</mo><mn id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.3" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.3.cmml">1</mn></mrow></msub><mi id="S4.SS3.SSS1.p3.4.m4.1.1.2.3" xref="S4.SS3.SSS1.p3.4.m4.1.1.2.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.4.m4.1b"><apply id="S4.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.4.m4.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.4.m4.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.2.2">𝐺</ci><ci id="S4.SS3.SSS1.p3.4.m4.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.2.3">𝑚</ci></apply><apply id="S4.SS3.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p3.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.2">𝑣</ci><apply id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3"><minus id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.1"></minus><ci id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.2">𝑡</ci><cn id="S4.SS3.SSS1.p3.4.m4.1.1.3.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.4.m4.1c">G^{m}_{v_{t-1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.4.m4.1d">italic_G start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. We then categorize the patient’s diseases/procedures as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.F4" title="Figure 4 ‣ 4.3.1. Homomorphic Relationship Learning ‣ 4.3. Health State Learning ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">4</span></a>. For diseases <math alttext="\mathcal{D}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.5.m5.1"><semantics id="S4.SS3.SSS1.p3.5.m5.1a"><msub id="S4.SS3.SSS1.p3.5.m5.1.1" xref="S4.SS3.SSS1.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.5.m5.1.1.2" xref="S4.SS3.SSS1.p3.5.m5.1.1.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.5.m5.1.1.3" xref="S4.SS3.SSS1.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.5.m5.1b"><apply id="S4.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p3.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p3.5.m5.1.1.2">𝒟</ci><ci id="S4.SS3.SSS1.p3.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.5.m5.1c">\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we categorize them into four types <math alttext="\mathcal{D}^{j}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.6.m6.1"><semantics id="S4.SS3.SSS1.p3.6.m6.1a"><msubsup id="S4.SS3.SSS1.p3.6.m6.1.1" xref="S4.SS3.SSS1.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.6.m6.1.1.2.2" xref="S4.SS3.SSS1.p3.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.6.m6.1.1.3" xref="S4.SS3.SSS1.p3.6.m6.1.1.3.cmml">t</mi><mi id="S4.SS3.SSS1.p3.6.m6.1.1.2.3" xref="S4.SS3.SSS1.p3.6.m6.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.6.m6.1b"><apply id="S4.SS3.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.6.m6.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.6.m6.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1.2.2">𝒟</ci><ci id="S4.SS3.SSS1.p3.6.m6.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1.2.3">𝑗</ci></apply><ci id="S4.SS3.SSS1.p3.6.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.6.m6.1c">\mathcal{D}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.6.m6.1d">caligraphic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> based on <math alttext="G^{d}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.7.m7.1"><semantics id="S4.SS3.SSS1.p3.7.m7.1a"><msubsup id="S4.SS3.SSS1.p3.7.m7.1.1" xref="S4.SS3.SSS1.p3.7.m7.1.1.cmml"><mi id="S4.SS3.SSS1.p3.7.m7.1.1.2.2" xref="S4.SS3.SSS1.p3.7.m7.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS1.p3.7.m7.1.1.3" xref="S4.SS3.SSS1.p3.7.m7.1.1.3.cmml"><mi id="S4.SS3.SSS1.p3.7.m7.1.1.3.2" xref="S4.SS3.SSS1.p3.7.m7.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS1.p3.7.m7.1.1.3.3" xref="S4.SS3.SSS1.p3.7.m7.1.1.3.3.cmml">t</mi></msub><mi id="S4.SS3.SSS1.p3.7.m7.1.1.2.3" xref="S4.SS3.SSS1.p3.7.m7.1.1.2.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.7.m7.1b"><apply id="S4.SS3.SSS1.p3.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.7.m7.1.1.1.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.7.m7.1.1.2.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.7.m7.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.7.m7.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.2.2">𝐺</ci><ci id="S4.SS3.SSS1.p3.7.m7.1.1.2.3.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.2.3">𝑑</ci></apply><apply id="S4.SS3.SSS1.p3.7.m7.1.1.3.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.7.m7.1.1.3.1.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p3.7.m7.1.1.3.2.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS1.p3.7.m7.1.1.3.3.cmml" xref="S4.SS3.SSS1.p3.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.7.m7.1c">G^{d}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.7.m7.1d">italic_G start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>: 1) Causal diseases <math alttext="\mathcal{D}^{1}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.8.m8.1"><semantics id="S4.SS3.SSS1.p3.8.m8.1a"><msubsup id="S4.SS3.SSS1.p3.8.m8.1.1" xref="S4.SS3.SSS1.p3.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.8.m8.1.1.2.2" xref="S4.SS3.SSS1.p3.8.m8.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.8.m8.1.1.3" xref="S4.SS3.SSS1.p3.8.m8.1.1.3.cmml">t</mi><mn id="S4.SS3.SSS1.p3.8.m8.1.1.2.3" xref="S4.SS3.SSS1.p3.8.m8.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.8.m8.1b"><apply id="S4.SS3.SSS1.p3.8.m8.1.1.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.8.m8.1.1.1.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.8.m8.1.1.2.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.8.m8.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.8.m8.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1.2.2">𝒟</ci><cn id="S4.SS3.SSS1.p3.8.m8.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.8.m8.1.1.2.3">1</cn></apply><ci id="S4.SS3.SSS1.p3.8.m8.1.1.3.cmml" xref="S4.SS3.SSS1.p3.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.8.m8.1c">\mathcal{D}^{1}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.8.m8.1d">caligraphic_D start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which initiate other diseases and represent the primary ailment; 2) Effect diseases <math alttext="\mathcal{D}^{2}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.9.m9.1"><semantics id="S4.SS3.SSS1.p3.9.m9.1a"><msubsup id="S4.SS3.SSS1.p3.9.m9.1.1" xref="S4.SS3.SSS1.p3.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.9.m9.1.1.2.2" xref="S4.SS3.SSS1.p3.9.m9.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.9.m9.1.1.3" xref="S4.SS3.SSS1.p3.9.m9.1.1.3.cmml">t</mi><mn id="S4.SS3.SSS1.p3.9.m9.1.1.2.3" xref="S4.SS3.SSS1.p3.9.m9.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.9.m9.1b"><apply id="S4.SS3.SSS1.p3.9.m9.1.1.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.9.m9.1.1.1.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.9.m9.1.1.2.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.9.m9.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.9.m9.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1.2.2">𝒟</ci><cn id="S4.SS3.SSS1.p3.9.m9.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.9.m9.1.1.2.3">2</cn></apply><ci id="S4.SS3.SSS1.p3.9.m9.1.1.3.cmml" xref="S4.SS3.SSS1.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.9.m9.1c">\mathcal{D}^{2}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.9.m9.1d">caligraphic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, influenced by other diseases and indicative of secondary symptoms; 3) Middle diseases <math alttext="\mathcal{D}^{3}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.10.m10.1"><semantics id="S4.SS3.SSS1.p3.10.m10.1a"><msubsup id="S4.SS3.SSS1.p3.10.m10.1.1" xref="S4.SS3.SSS1.p3.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.10.m10.1.1.2.2" xref="S4.SS3.SSS1.p3.10.m10.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.10.m10.1.1.3" xref="S4.SS3.SSS1.p3.10.m10.1.1.3.cmml">t</mi><mn id="S4.SS3.SSS1.p3.10.m10.1.1.2.3" xref="S4.SS3.SSS1.p3.10.m10.1.1.2.3.cmml">3</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.10.m10.1b"><apply id="S4.SS3.SSS1.p3.10.m10.1.1.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.10.m10.1.1.1.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.10.m10.1.1.2.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.10.m10.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.10.m10.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1.2.2">𝒟</ci><cn id="S4.SS3.SSS1.p3.10.m10.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.10.m10.1.1.2.3">3</cn></apply><ci id="S4.SS3.SSS1.p3.10.m10.1.1.3.cmml" xref="S4.SS3.SSS1.p3.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.10.m10.1c">\mathcal{D}^{3}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.10.m10.1d">caligraphic_D start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, both influencing and influenced by other diseases; 4) Independent diseases <math alttext="\mathcal{D}^{4}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.11.m11.1"><semantics id="S4.SS3.SSS1.p3.11.m11.1a"><msubsup id="S4.SS3.SSS1.p3.11.m11.1.1" xref="S4.SS3.SSS1.p3.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p3.11.m11.1.1.2.2" xref="S4.SS3.SSS1.p3.11.m11.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p3.11.m11.1.1.3" xref="S4.SS3.SSS1.p3.11.m11.1.1.3.cmml">t</mi><mn id="S4.SS3.SSS1.p3.11.m11.1.1.2.3" xref="S4.SS3.SSS1.p3.11.m11.1.1.2.3.cmml">4</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.11.m11.1b"><apply id="S4.SS3.SSS1.p3.11.m11.1.1.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.11.m11.1.1.1.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p3.11.m11.1.1.2.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.11.m11.1.1.2.1.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.11.m11.1.1.2.2.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1.2.2">𝒟</ci><cn id="S4.SS3.SSS1.p3.11.m11.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS1.p3.11.m11.1.1.2.3">4</cn></apply><ci id="S4.SS3.SSS1.p3.11.m11.1.1.3.cmml" xref="S4.SS3.SSS1.p3.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.11.m11.1c">\mathcal{D}^{4}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.11.m11.1d">caligraphic_D start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, existing without direct causal links to other diseases.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p4">
<p class="ltx_p" id="S4.SS3.SSS1.p4.1">Since each patient has a unique disease history, the same disease may occupy different positions in the causal graphs <math alttext="G^{d}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.1.m1.1"><semantics id="S4.SS3.SSS1.p4.1.m1.1a"><msubsup id="S4.SS3.SSS1.p4.1.m1.1.1" xref="S4.SS3.SSS1.p4.1.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p4.1.m1.1.1.2.2" xref="S4.SS3.SSS1.p4.1.m1.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS1.p4.1.m1.1.1.3" xref="S4.SS3.SSS1.p4.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p4.1.m1.1.1.3.2" xref="S4.SS3.SSS1.p4.1.m1.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS1.p4.1.m1.1.1.3.3" xref="S4.SS3.SSS1.p4.1.m1.1.1.3.3.cmml">t</mi></msub><mi id="S4.SS3.SSS1.p4.1.m1.1.1.2.3" xref="S4.SS3.SSS1.p4.1.m1.1.1.2.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.1.m1.1b"><apply id="S4.SS3.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.2.2">𝐺</ci><ci id="S4.SS3.SSS1.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.SS3.SSS1.p4.1.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS1.p4.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS1.p4.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.1.m1.1c">G^{d}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.1.m1.1d">italic_G start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for different patients, leading to different group classifications. The DSA mechanism learns the dynamic changes of disease groups across various health states, capturing personalized differences. It updates entity representations based on these groupings to enhance the expressiveness of key entities.
The specific formula is as follows:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx2">
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{D}^{j}_{t}=\text{Classify}(d_{i},G^{d}_{v_{t}})," class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.4.2.2" xref="S4.E4.m1.1.1.1.1.4.2.2.cmml">𝒟</mi><mi id="S4.E4.m1.1.1.1.1.4.3" xref="S4.E4.m1.1.1.1.1.4.3.cmml">t</mi><mi id="S4.E4.m1.1.1.1.1.4.2.3" xref="S4.E4.m1.1.1.1.1.4.2.3.cmml">j</mi></msubsup><mo id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><mtext id="S4.E4.m1.1.1.1.1.2.4" xref="S4.E4.m1.1.1.1.1.2.4a.cmml">Classify</mtext><mo id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E4.m1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E4.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E4.m1.1.1.1.1.2.2.2.4" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E4.m1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">G</mi><msub id="S4.E4.m1.1.1.1.1.2.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.2.cmml">v</mi><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.3.cmml">t</mi></msub><mi id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml">d</mi></msubsup><mo id="S4.E4.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"></eq><apply id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.1.1.1.1.4">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.4.2.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.2.1.cmml" xref="S4.E4.m1.1.1.1.1.4">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.2.2.cmml" xref="S4.E4.m1.1.1.1.1.4.2.2">𝒟</ci><ci id="S4.E4.m1.1.1.1.1.4.2.3.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3">𝑗</ci></apply><ci id="S4.E4.m1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><times id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3"></times><ci id="S4.E4.m1.1.1.1.1.2.4a.cmml" xref="S4.E4.m1.1.1.1.1.2.4"><mtext id="S4.E4.m1.1.1.1.1.2.4.cmml" xref="S4.E4.m1.1.1.1.1.2.4">Classify</mtext></ci><interval closure="open" id="S4.E4.m1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2"><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.2">𝐺</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.2.3">𝑑</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.2">𝑣</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle\mathcal{D}^{j}_{t}=\text{Classify}(d_{i},G^{d}_{v_{t}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">caligraphic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = Classify ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_G start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{h}^{r}_{d_{i}}=\mathbf{h}_{d_{i}}\cdot w^{j}_{t}," class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msubsup id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.cmml">𝐡</mi><msub id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.2.3.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.2.3.3.cmml">i</mi></msub><mi id="S4.E5.m1.1.1.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml">r</mi></msubsup><mo id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><msub id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.3.2.2.cmml">𝐡</mi><msub id="S4.E5.m1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2.3.2" xref="S4.E5.m1.1.1.1.1.3.2.3.2.cmml">d</mi><mi id="S4.E5.m1.1.1.1.1.3.2.3.3" xref="S4.E5.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E5.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.3.2.2" xref="S4.E5.m1.1.1.1.1.3.3.2.2.cmml">w</mi><mi id="S4.E5.m1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.3.3.3.cmml">t</mi><mi id="S4.E5.m1.1.1.1.1.3.3.2.3" xref="S4.E5.m1.1.1.1.1.3.3.2.3.cmml">j</mi></msubsup></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"></eq><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2">𝐡</ci><ci id="S4.E5.m1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3">𝑟</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><ci id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.1">⋅</ci><apply id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.2">𝐡</ci><apply id="S4.E5.m1.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3.2">𝑑</ci><ci id="S4.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.3.2.2">𝑤</ci><ci id="S4.E5.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3.2.3">𝑗</ci></apply><ci id="S4.E5.m1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\mathbf{h}^{r}_{d_{i}}=\mathbf{h}_{d_{i}}\cdot w^{j}_{t},</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_h start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⋅ italic_w start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle w^{j}_{t}=\frac{\exp(\mathbf{W}\cdot\mathbf{h}^{D^{j}}_{t}+b)}{%
\sum_{k=1}^{4}\exp(\mathbf{W}\cdot\mathbf{h}^{D^{k}}_{t}+b)}," class="ltx_Math" display="block" id="S4.E6.m1.5"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><msubsup id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><mi id="S4.E6.m1.5.5.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.2.2.2.cmml">w</mi><mi id="S4.E6.m1.5.5.1.1.2.3" xref="S4.E6.m1.5.5.1.1.2.3.cmml">t</mi><mi id="S4.E6.m1.5.5.1.1.2.2.3" xref="S4.E6.m1.5.5.1.1.2.2.3.cmml">j</mi></msubsup><mo id="S4.E6.m1.5.5.1.1.1" xref="S4.E6.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml"><mrow id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E6.m1.2.2.2.2a" xref="S4.E6.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.3.cmml"><mo id="S4.E6.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E6.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E6.m1.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.1.1.2" xref="S4.E6.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.2" xref="S4.E6.m1.2.2.2.2.1.1.2.2.cmml">𝐖</mi><mo id="S4.E6.m1.2.2.2.2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.2.2.2.2.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E6.m1.2.2.2.2.1.1.2.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.2.2" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.2.cmml">𝐡</mi><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.3.cmml">t</mi><msup id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.2" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.2.cmml">D</mi><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.3.cmml">j</mi></msup></msubsup></mrow><mo id="S4.E6.m1.2.2.2.2.1.1.1" xref="S4.E6.m1.2.2.2.2.1.1.1.cmml">+</mo><mi id="S4.E6.m1.2.2.2.2.1.1.3" xref="S4.E6.m1.2.2.2.2.1.1.3.cmml">b</mi></mrow><mo id="S4.E6.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E6.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.4.4.4" xref="S4.E6.m1.4.4.4.cmml"><msubsup id="S4.E6.m1.4.4.4.3" xref="S4.E6.m1.4.4.4.3.cmml"><mo id="S4.E6.m1.4.4.4.3.2.2" xref="S4.E6.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S4.E6.m1.4.4.4.3.2.3" xref="S4.E6.m1.4.4.4.3.2.3.cmml"><mi id="S4.E6.m1.4.4.4.3.2.3.2" xref="S4.E6.m1.4.4.4.3.2.3.2.cmml">k</mi><mo id="S4.E6.m1.4.4.4.3.2.3.1" xref="S4.E6.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S4.E6.m1.4.4.4.3.2.3.3" xref="S4.E6.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mn id="S4.E6.m1.4.4.4.3.3" xref="S4.E6.m1.4.4.4.3.3.cmml">4</mn></msubsup><mrow id="S4.E6.m1.4.4.4.2.1" xref="S4.E6.m1.4.4.4.2.2.cmml"><mi id="S4.E6.m1.3.3.3.1" xref="S4.E6.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E6.m1.4.4.4.2.1a" xref="S4.E6.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.4.2.1.1" xref="S4.E6.m1.4.4.4.2.2.cmml"><mo id="S4.E6.m1.4.4.4.2.1.1.2" stretchy="false" xref="S4.E6.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E6.m1.4.4.4.2.1.1.1" xref="S4.E6.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E6.m1.4.4.4.2.1.1.1.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.cmml"><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.cmml">𝐖</mi><mo id="S4.E6.m1.4.4.4.2.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.4.4.4.2.1.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E6.m1.4.4.4.2.1.1.1.2.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.cmml"><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.2.cmml">𝐡</mi><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.3.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.3.cmml">t</mi><msup id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.cmml"><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.2.cmml">D</mi><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.3.cmml">k</mi></msup></msubsup></mrow><mo id="S4.E6.m1.4.4.4.2.1.1.1.1" xref="S4.E6.m1.4.4.4.2.1.1.1.1.cmml">+</mo><mi id="S4.E6.m1.4.4.4.2.1.1.1.3" xref="S4.E6.m1.4.4.4.2.1.1.1.3.cmml">b</mi></mrow><mo id="S4.E6.m1.4.4.4.2.1.1.3" stretchy="false" xref="S4.E6.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"></eq><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2.2">𝑤</ci><ci id="S4.E6.m1.5.5.1.1.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E6.m1.5.5.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3">𝑡</ci></apply><apply id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"><divide id="S4.E6.m1.4.4.5.cmml" xref="S4.E6.m1.4.4"></divide><apply id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2"><exp id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"></exp><apply id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1"><plus id="S4.E6.m1.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1"></plus><apply id="S4.E6.m1.2.2.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2"><ci id="S4.E6.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.1">⋅</ci><ci id="S4.E6.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2">𝐖</ci><apply id="S4.E6.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3">subscript</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.3.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.2">𝐡</ci><apply id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.2">𝐷</ci><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.3.3">𝑗</ci></apply></apply><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S4.E6.m1.2.2.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.3">𝑏</ci></apply></apply><apply id="S4.E6.m1.4.4.4.cmml" xref="S4.E6.m1.4.4.4"><apply id="S4.E6.m1.4.4.4.3.cmml" xref="S4.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.3.1.cmml" xref="S4.E6.m1.4.4.4.3">superscript</csymbol><apply id="S4.E6.m1.4.4.4.3.2.cmml" xref="S4.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.3.2.1.cmml" xref="S4.E6.m1.4.4.4.3">subscript</csymbol><sum id="S4.E6.m1.4.4.4.3.2.2.cmml" xref="S4.E6.m1.4.4.4.3.2.2"></sum><apply id="S4.E6.m1.4.4.4.3.2.3.cmml" xref="S4.E6.m1.4.4.4.3.2.3"><eq id="S4.E6.m1.4.4.4.3.2.3.1.cmml" xref="S4.E6.m1.4.4.4.3.2.3.1"></eq><ci id="S4.E6.m1.4.4.4.3.2.3.2.cmml" xref="S4.E6.m1.4.4.4.3.2.3.2">𝑘</ci><cn id="S4.E6.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.3.2.3.3">1</cn></apply></apply><cn id="S4.E6.m1.4.4.4.3.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.3.3">4</cn></apply><apply id="S4.E6.m1.4.4.4.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1"><exp id="S4.E6.m1.3.3.3.1.cmml" xref="S4.E6.m1.3.3.3.1"></exp><apply id="S4.E6.m1.4.4.4.2.1.1.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1"><plus id="S4.E6.m1.4.4.4.2.1.1.1.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1"></plus><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2"><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.1">⋅</ci><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2">𝐖</ci><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.2.3.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3">subscript</csymbol><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.2">𝐡</ci><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3">superscript</csymbol><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.2">𝐷</ci><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.2.3.3">𝑘</ci></apply></apply><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.3.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S4.E6.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.3">𝑏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\displaystyle w^{j}_{t}=\frac{\exp(\mathbf{W}\cdot\mathbf{h}^{D^{j}}_{t}+b)}{%
\sum_{k=1}^{4}\exp(\mathbf{W}\cdot\mathbf{h}^{D^{k}}_{t}+b)},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.5d">italic_w start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = divide start_ARG roman_exp ( bold_W ⋅ bold_h start_POSTSUPERSCRIPT italic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT roman_exp ( bold_W ⋅ bold_h start_POSTSUPERSCRIPT italic_D start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p4.12">Where <math alttext="\text{Classify}(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.2.m1.1"><semantics id="S4.SS3.SSS1.p4.2.m1.1a"><mrow id="S4.SS3.SSS1.p4.2.m1.1.2" xref="S4.SS3.SSS1.p4.2.m1.1.2.cmml"><mtext id="S4.SS3.SSS1.p4.2.m1.1.2.2" xref="S4.SS3.SSS1.p4.2.m1.1.2.2a.cmml">Classify</mtext><mo id="S4.SS3.SSS1.p4.2.m1.1.2.1" xref="S4.SS3.SSS1.p4.2.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS1.p4.2.m1.1.2.3.2" xref="S4.SS3.SSS1.p4.2.m1.1.2.cmml"><mo id="S4.SS3.SSS1.p4.2.m1.1.2.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p4.2.m1.1.2.cmml">(</mo><mo id="S4.SS3.SSS1.p4.2.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS3.SSS1.p4.2.m1.1.1.cmml">⋅</mo><mo id="S4.SS3.SSS1.p4.2.m1.1.2.3.2.2" stretchy="false" xref="S4.SS3.SSS1.p4.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.2.m1.1b"><apply id="S4.SS3.SSS1.p4.2.m1.1.2.cmml" xref="S4.SS3.SSS1.p4.2.m1.1.2"><times id="S4.SS3.SSS1.p4.2.m1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.2.m1.1.2.1"></times><ci id="S4.SS3.SSS1.p4.2.m1.1.2.2a.cmml" xref="S4.SS3.SSS1.p4.2.m1.1.2.2"><mtext id="S4.SS3.SSS1.p4.2.m1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.2.m1.1.2.2">Classify</mtext></ci><ci id="S4.SS3.SSS1.p4.2.m1.1.1.cmml" xref="S4.SS3.SSS1.p4.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.2.m1.1c">\text{Classify}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.2.m1.1d">Classify ( ⋅ )</annotation></semantics></math> assigns <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.3.m2.1"><semantics id="S4.SS3.SSS1.p4.3.m2.1a"><msub id="S4.SS3.SSS1.p4.3.m2.1.1" xref="S4.SS3.SSS1.p4.3.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p4.3.m2.1.1.2" xref="S4.SS3.SSS1.p4.3.m2.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS1.p4.3.m2.1.1.3" xref="S4.SS3.SSS1.p4.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.3.m2.1b"><apply id="S4.SS3.SSS1.p4.3.m2.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p4.3.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m2.1.1.2">𝑑</ci><ci id="S4.SS3.SSS1.p4.3.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.3.m2.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.3.m2.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to a specific category <math alttext="\mathcal{D}^{j}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.4.m3.1"><semantics id="S4.SS3.SSS1.p4.4.m3.1a"><msubsup id="S4.SS3.SSS1.p4.4.m3.1.1" xref="S4.SS3.SSS1.p4.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p4.4.m3.1.1.2.2" xref="S4.SS3.SSS1.p4.4.m3.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p4.4.m3.1.1.3" xref="S4.SS3.SSS1.p4.4.m3.1.1.3.cmml">t</mi><mi id="S4.SS3.SSS1.p4.4.m3.1.1.2.3" xref="S4.SS3.SSS1.p4.4.m3.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.4.m3.1b"><apply id="S4.SS3.SSS1.p4.4.m3.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.4.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m3.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.4.m3.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1.2.2">𝒟</ci><ci id="S4.SS3.SSS1.p4.4.m3.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1.2.3">𝑗</ci></apply><ci id="S4.SS3.SSS1.p4.4.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p4.4.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.4.m3.1c">\mathcal{D}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.4.m3.1d">caligraphic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the DSA generates dynamic weight <math alttext="w^{j}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.5.m4.1"><semantics id="S4.SS3.SSS1.p4.5.m4.1a"><msubsup id="S4.SS3.SSS1.p4.5.m4.1.1" xref="S4.SS3.SSS1.p4.5.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p4.5.m4.1.1.2.2" xref="S4.SS3.SSS1.p4.5.m4.1.1.2.2.cmml">w</mi><mi id="S4.SS3.SSS1.p4.5.m4.1.1.3" xref="S4.SS3.SSS1.p4.5.m4.1.1.3.cmml">t</mi><mi id="S4.SS3.SSS1.p4.5.m4.1.1.2.3" xref="S4.SS3.SSS1.p4.5.m4.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.5.m4.1b"><apply id="S4.SS3.SSS1.p4.5.m4.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.5.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.5.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.5.m4.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.5.m4.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1.2.2">𝑤</ci><ci id="S4.SS3.SSS1.p4.5.m4.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1.2.3">𝑗</ci></apply><ci id="S4.SS3.SSS1.p4.5.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p4.5.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.5.m4.1c">w^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.5.m4.1d">italic_w start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.6.m5.1"><semantics id="S4.SS3.SSS1.p4.6.m5.1a"><mi id="S4.SS3.SSS1.p4.6.m5.1.1" xref="S4.SS3.SSS1.p4.6.m5.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.6.m5.1b"><ci id="S4.SS3.SSS1.p4.6.m5.1.1.cmml" xref="S4.SS3.SSS1.p4.6.m5.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.6.m5.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.6.m5.1d">bold_W</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.7.m6.1"><semantics id="S4.SS3.SSS1.p4.7.m6.1a"><mi id="S4.SS3.SSS1.p4.7.m6.1.1" xref="S4.SS3.SSS1.p4.7.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.7.m6.1b"><ci id="S4.SS3.SSS1.p4.7.m6.1.1.cmml" xref="S4.SS3.SSS1.p4.7.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.7.m6.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.7.m6.1d">italic_b</annotation></semantics></math> are trainable weight matrix and bias term, <math alttext="\mathbf{h}^{D^{j}}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.8.m7.1"><semantics id="S4.SS3.SSS1.p4.8.m7.1a"><msubsup id="S4.SS3.SSS1.p4.8.m7.1.1" xref="S4.SS3.SSS1.p4.8.m7.1.1.cmml"><mi id="S4.SS3.SSS1.p4.8.m7.1.1.2.2" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS1.p4.8.m7.1.1.3" xref="S4.SS3.SSS1.p4.8.m7.1.1.3.cmml">t</mi><msup id="S4.SS3.SSS1.p4.8.m7.1.1.2.3" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3.cmml"><mi id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.2" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3.2.cmml">D</mi><mi id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.3" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3.3.cmml">j</mi></msup></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.8.m7.1b"><apply id="S4.SS3.SSS1.p4.8.m7.1.1.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.8.m7.1.1.1.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.8.m7.1.1.2.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.8.m7.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.8.m7.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.2">𝐡</ci><apply id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.1.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3">superscript</csymbol><ci id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.2.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3.2">𝐷</ci><ci id="S4.SS3.SSS1.p4.8.m7.1.1.2.3.3.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.2.3.3">𝑗</ci></apply></apply><ci id="S4.SS3.SSS1.p4.8.m7.1.1.3.cmml" xref="S4.SS3.SSS1.p4.8.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.8.m7.1c">\mathbf{h}^{D^{j}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.8.m7.1d">bold_h start_POSTSUPERSCRIPT italic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the sum of embeddings of diseases within <math alttext="\mathcal{D}^{j}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.9.m8.1"><semantics id="S4.SS3.SSS1.p4.9.m8.1a"><msubsup id="S4.SS3.SSS1.p4.9.m8.1.1" xref="S4.SS3.SSS1.p4.9.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p4.9.m8.1.1.2.2" xref="S4.SS3.SSS1.p4.9.m8.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS3.SSS1.p4.9.m8.1.1.3" xref="S4.SS3.SSS1.p4.9.m8.1.1.3.cmml">t</mi><mi id="S4.SS3.SSS1.p4.9.m8.1.1.2.3" xref="S4.SS3.SSS1.p4.9.m8.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.9.m8.1b"><apply id="S4.SS3.SSS1.p4.9.m8.1.1.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.9.m8.1.1.1.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.9.m8.1.1.2.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.9.m8.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.9.m8.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1.2.2">𝒟</ci><ci id="S4.SS3.SSS1.p4.9.m8.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1.2.3">𝑗</ci></apply><ci id="S4.SS3.SSS1.p4.9.m8.1.1.3.cmml" xref="S4.SS3.SSS1.p4.9.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.9.m8.1c">\mathcal{D}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.9.m8.1d">caligraphic_D start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{h}^{r}_{d}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.10.m9.1"><semantics id="S4.SS3.SSS1.p4.10.m9.1a"><msubsup id="S4.SS3.SSS1.p4.10.m9.1.1" xref="S4.SS3.SSS1.p4.10.m9.1.1.cmml"><mi id="S4.SS3.SSS1.p4.10.m9.1.1.2.2" xref="S4.SS3.SSS1.p4.10.m9.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS1.p4.10.m9.1.1.3" xref="S4.SS3.SSS1.p4.10.m9.1.1.3.cmml">d</mi><mi id="S4.SS3.SSS1.p4.10.m9.1.1.2.3" xref="S4.SS3.SSS1.p4.10.m9.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.10.m9.1b"><apply id="S4.SS3.SSS1.p4.10.m9.1.1.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.10.m9.1.1.1.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.10.m9.1.1.2.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.10.m9.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.10.m9.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS1.p4.10.m9.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.SSS1.p4.10.m9.1.1.3.cmml" xref="S4.SS3.SSS1.p4.10.m9.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.10.m9.1c">\mathbf{h}^{r}_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.10.m9.1d">bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the modified embedding of diseases. The same approach is extended to procedures and medications, yielding <math alttext="\mathbf{h}^{r}_{p}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.11.m10.1"><semantics id="S4.SS3.SSS1.p4.11.m10.1a"><msubsup id="S4.SS3.SSS1.p4.11.m10.1.1" xref="S4.SS3.SSS1.p4.11.m10.1.1.cmml"><mi id="S4.SS3.SSS1.p4.11.m10.1.1.2.2" xref="S4.SS3.SSS1.p4.11.m10.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS1.p4.11.m10.1.1.3" xref="S4.SS3.SSS1.p4.11.m10.1.1.3.cmml">p</mi><mi id="S4.SS3.SSS1.p4.11.m10.1.1.2.3" xref="S4.SS3.SSS1.p4.11.m10.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.11.m10.1b"><apply id="S4.SS3.SSS1.p4.11.m10.1.1.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.11.m10.1.1.1.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.11.m10.1.1.2.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.11.m10.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.11.m10.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS1.p4.11.m10.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.SSS1.p4.11.m10.1.1.3.cmml" xref="S4.SS3.SSS1.p4.11.m10.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.11.m10.1c">\mathbf{h}^{r}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.11.m10.1d">bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{r}_{m}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.12.m11.1"><semantics id="S4.SS3.SSS1.p4.12.m11.1a"><msubsup id="S4.SS3.SSS1.p4.12.m11.1.1" xref="S4.SS3.SSS1.p4.12.m11.1.1.cmml"><mi id="S4.SS3.SSS1.p4.12.m11.1.1.2.2" xref="S4.SS3.SSS1.p4.12.m11.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS1.p4.12.m11.1.1.3" xref="S4.SS3.SSS1.p4.12.m11.1.1.3.cmml">m</mi><mi id="S4.SS3.SSS1.p4.12.m11.1.1.2.3" xref="S4.SS3.SSS1.p4.12.m11.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.12.m11.1b"><apply id="S4.SS3.SSS1.p4.12.m11.1.1.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.12.m11.1.1.1.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1">subscript</csymbol><apply id="S4.SS3.SSS1.p4.12.m11.1.1.2.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.12.m11.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.12.m11.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS1.p4.12.m11.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.SSS1.p4.12.m11.1.1.3.cmml" xref="S4.SS3.SSS1.p4.12.m11.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.12.m11.1c">\mathbf{h}^{r}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p4.12.m11.1d">bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="399" id="S4.F4.g1" src="x5.png" width="831"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.8.4.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S4.F4.6.3" style="font-size:90%;">Using the classifier within DSA, we analyze the causal position of each node in the causal graph <math alttext="G^{d}_{v_{t}}" class="ltx_Math" display="inline" id="S4.F4.4.1.m1.1"><semantics id="S4.F4.4.1.m1.1b"><msubsup id="S4.F4.4.1.m1.1.1" xref="S4.F4.4.1.m1.1.1.cmml"><mi id="S4.F4.4.1.m1.1.1.2.2" xref="S4.F4.4.1.m1.1.1.2.2.cmml">G</mi><msub id="S4.F4.4.1.m1.1.1.3" xref="S4.F4.4.1.m1.1.1.3.cmml"><mi id="S4.F4.4.1.m1.1.1.3.2" xref="S4.F4.4.1.m1.1.1.3.2.cmml">v</mi><mi id="S4.F4.4.1.m1.1.1.3.3" xref="S4.F4.4.1.m1.1.1.3.3.cmml">t</mi></msub><mi id="S4.F4.4.1.m1.1.1.2.3" xref="S4.F4.4.1.m1.1.1.2.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.F4.4.1.m1.1c"><apply id="S4.F4.4.1.m1.1.1.cmml" xref="S4.F4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.4.1.m1.1.1.1.cmml" xref="S4.F4.4.1.m1.1.1">subscript</csymbol><apply id="S4.F4.4.1.m1.1.1.2.cmml" xref="S4.F4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.4.1.m1.1.1.2.1.cmml" xref="S4.F4.4.1.m1.1.1">superscript</csymbol><ci id="S4.F4.4.1.m1.1.1.2.2.cmml" xref="S4.F4.4.1.m1.1.1.2.2">𝐺</ci><ci id="S4.F4.4.1.m1.1.1.2.3.cmml" xref="S4.F4.4.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.F4.4.1.m1.1.1.3.cmml" xref="S4.F4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.F4.4.1.m1.1.1.3.1.cmml" xref="S4.F4.4.1.m1.1.1.3">subscript</csymbol><ci id="S4.F4.4.1.m1.1.1.3.2.cmml" xref="S4.F4.4.1.m1.1.1.3.2">𝑣</ci><ci id="S4.F4.4.1.m1.1.1.3.3.cmml" xref="S4.F4.4.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.1.m1.1d">G^{d}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.1.m1.1e">italic_G start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to gauge its influence on the patient’s current state. For instance, if <math alttext="d_{3}" class="ltx_Math" display="inline" id="S4.F4.5.2.m2.1"><semantics id="S4.F4.5.2.m2.1b"><msub id="S4.F4.5.2.m2.1.1" xref="S4.F4.5.2.m2.1.1.cmml"><mi id="S4.F4.5.2.m2.1.1.2" xref="S4.F4.5.2.m2.1.1.2.cmml">d</mi><mn id="S4.F4.5.2.m2.1.1.3" xref="S4.F4.5.2.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F4.5.2.m2.1c"><apply id="S4.F4.5.2.m2.1.1.cmml" xref="S4.F4.5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F4.5.2.m2.1.1.1.cmml" xref="S4.F4.5.2.m2.1.1">subscript</csymbol><ci id="S4.F4.5.2.m2.1.1.2.cmml" xref="S4.F4.5.2.m2.1.1.2">𝑑</ci><cn id="S4.F4.5.2.m2.1.1.3.cmml" type="integer" xref="S4.F4.5.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.2.m2.1d">d_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.5.2.m2.1e">italic_d start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> is identified as a causal disease, it is classified as <math alttext="{D}^{1}_{t}" class="ltx_Math" display="inline" id="S4.F4.6.3.m3.1"><semantics id="S4.F4.6.3.m3.1b"><msubsup id="S4.F4.6.3.m3.1.1" xref="S4.F4.6.3.m3.1.1.cmml"><mi id="S4.F4.6.3.m3.1.1.2.2" xref="S4.F4.6.3.m3.1.1.2.2.cmml">D</mi><mi id="S4.F4.6.3.m3.1.1.3" xref="S4.F4.6.3.m3.1.1.3.cmml">t</mi><mn id="S4.F4.6.3.m3.1.1.2.3" xref="S4.F4.6.3.m3.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.F4.6.3.m3.1c"><apply id="S4.F4.6.3.m3.1.1.cmml" xref="S4.F4.6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F4.6.3.m3.1.1.1.cmml" xref="S4.F4.6.3.m3.1.1">subscript</csymbol><apply id="S4.F4.6.3.m3.1.1.2.cmml" xref="S4.F4.6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F4.6.3.m3.1.1.2.1.cmml" xref="S4.F4.6.3.m3.1.1">superscript</csymbol><ci id="S4.F4.6.3.m3.1.1.2.2.cmml" xref="S4.F4.6.3.m3.1.1.2.2">𝐷</ci><cn id="S4.F4.6.3.m3.1.1.2.3.cmml" type="integer" xref="S4.F4.6.3.m3.1.1.2.3">1</cn></apply><ci id="S4.F4.6.3.m3.1.1.3.cmml" xref="S4.F4.6.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.3.m3.1d">{D}^{1}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.6.3.m3.1e">italic_D start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F4.9">\Description</span></div>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Heterogeneous Relationship Learning</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">As shown in the right half of the Health State Learning part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S2.F2" title="Figure 2 ‣ 2.1. Medication Recommendation ‣ 2. Related Work ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">2</span></a>.
At this stage, we update the representations of medical entities based on the correlations between diseases/procedures and medications obtained through causal estimation in relationship mining. This process aims to enhance the accuracy of entity representations.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.4">We utilize the causal effect matrices <math alttext="\mathbf{M}^{dm}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.1.m1.1"><semantics id="S4.SS3.SSS2.p2.1.m1.1a"><msup id="S4.SS3.SSS2.p2.1.m1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml">𝐌</mi><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">d</mi><mo id="S4.SS3.SSS2.p2.1.m1.1.1.3.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.1.m1.1b"><apply id="S4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.2">𝐌</ci><apply id="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3"><times id="S4.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2">𝑑</ci><ci id="S4.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.1.m1.1c">\mathbf{M}^{dm}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.1.m1.1d">bold_M start_POSTSUPERSCRIPT italic_d italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{M}^{pm}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.2.m2.1"><semantics id="S4.SS3.SSS2.p2.2.m2.1a"><msup id="S4.SS3.SSS2.p2.2.m2.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml">𝐌</mi><mrow id="S4.SS3.SSS2.p2.2.m2.1.1.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.2.m2.1.1.3.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.3.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.2.m2.1b"><apply id="S4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2">𝐌</ci><apply id="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.3"><times id="S4.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.2.m2.1c">\mathbf{M}^{pm}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.2.m2.1d">bold_M start_POSTSUPERSCRIPT italic_p italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> to construct disease-medication and procedure-medication complete bipartite graphs <math alttext="G^{dm}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.3.m3.1"><semantics id="S4.SS3.SSS2.p2.3.m3.1a"><msubsup id="S4.SS3.SSS2.p2.3.m3.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS2.p2.3.m3.1.1.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.3.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS2.p2.3.m3.1.1.3.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.3.cmml">t</mi></msub><mrow id="S4.SS3.SSS2.p2.3.m3.1.1.2.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml">d</mi><mo id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.3.m3.1b"><apply id="S4.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.2">𝐺</ci><apply id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3"><times id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2">𝑑</ci><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.3.m3.1c">G^{dm}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.3.m3.1d">italic_G start_POSTSUPERSCRIPT italic_d italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G^{pm}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.4.m4.1"><semantics id="S4.SS3.SSS2.p2.4.m4.1a"><msubsup id="S4.SS3.SSS2.p2.4.m4.1.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.cmml"><mi id="S4.SS3.SSS2.p2.4.m4.1.1.2.2" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS2.p2.4.m4.1.1.3" xref="S4.SS3.SSS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.4.m4.1.1.3.2" xref="S4.SS3.SSS2.p2.4.m4.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS2.p2.4.m4.1.1.3.3" xref="S4.SS3.SSS2.p2.4.m4.1.1.3.3.cmml">t</mi></msub><mrow id="S4.SS3.SSS2.p2.4.m4.1.1.2.3" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.2" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.3" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.3.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.4.m4.1b"><apply id="S4.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.2">𝐺</ci><apply id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3"><times id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.4.m4.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.4.m4.1c">G^{pm}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.4.m4.1d">italic_G start_POSTSUPERSCRIPT italic_p italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for single visit.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.5">Taking <math alttext="G^{dm}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.1.m1.1"><semantics id="S4.SS3.SSS2.p3.1.m1.1a"><msubsup id="S4.SS3.SSS2.p3.1.m1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS2.p3.1.m1.1.1.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.3.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS2.p3.1.m1.1.1.3.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.3.cmml">t</mi></msub><mrow id="S4.SS3.SSS2.p3.1.m1.1.1.2.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.2.cmml">d</mi><mo id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.3.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.1.m1.1b"><apply id="S4.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.2">𝐺</ci><apply id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3"><times id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.2">𝑑</ci><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.1.m1.1c">G^{dm}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.1.m1.1d">italic_G start_POSTSUPERSCRIPT italic_d italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as an example, the nodes encompass both <math alttext="\mathcal{D}_{t}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.2.m2.1"><semantics id="S4.SS3.SSS2.p3.2.m2.1a"><msub id="S4.SS3.SSS2.p3.2.m2.1.1" xref="S4.SS3.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.p3.2.m2.1.1.2" xref="S4.SS3.SSS2.p3.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS3.SSS2.p3.2.m2.1.1.3" xref="S4.SS3.SSS2.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.2.m2.1b"><apply id="S4.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1.2">𝒟</ci><ci id="S4.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.2.m2.1c">\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{M}_{t-1}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.3.m3.1"><semantics id="S4.SS3.SSS2.p3.3.m3.1a"><msub id="S4.SS3.SSS2.p3.3.m3.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.p3.3.m3.1.1.2" xref="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml">ℳ</mi><mrow id="S4.SS3.SSS2.p3.3.m3.1.1.3" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml"><mi id="S4.SS3.SSS2.p3.3.m3.1.1.3.2" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS3.SSS2.p3.3.m3.1.1.3.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS3.SSS2.p3.3.m3.1.1.3.3" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.3.m3.1b"><apply id="S4.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.2">ℳ</ci><apply id="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.3"><minus id="S4.SS3.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.1"></minus><ci id="S4.SS3.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.2">𝑡</ci><cn id="S4.SS3.SSS2.p3.3.m3.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.3.m3.1c">\mathcal{M}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
By utilizing Relational Graph Convolutional Networks (RGCN) <cite class="ltx_cite ltx_citemacro_citep">(Schlichtkrull et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib23" title="">2018</a>)</cite>, we categorize edges corresponding to relationships with similar causal effects into the same type. Subsequently, we establish point-to-point relationships between diseases and medications. The representation of <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.4.m4.1"><semantics id="S4.SS3.SSS2.p3.4.m4.1a"><msub id="S4.SS3.SSS2.p3.4.m4.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.cmml"><mi id="S4.SS3.SSS2.p3.4.m4.1.1.2" xref="S4.SS3.SSS2.p3.4.m4.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS2.p3.4.m4.1.1.3" xref="S4.SS3.SSS2.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.4.m4.1b"><apply id="S4.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1.2">𝑑</ci><ci id="S4.SS3.SSS2.p3.4.m4.1.1.3.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.4.m4.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.5.m5.1"><semantics id="S4.SS3.SSS2.p3.5.m5.1a"><mi id="S4.SS3.SSS2.p3.5.m5.1.1" xref="S4.SS3.SSS2.p3.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.5.m5.1b"><ci id="S4.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.5.m5.1d">italic_l</annotation></semantics></math> is then updated on the point-to-point relationship using the following formula:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx3">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{h}_{d_{i}}^{l+1}=\sigma(\mathbf{W}_{0}^{l}\cdot\mathbf{h}%
_{d_{i}}^{l}+\sum_{r\in\mathcal{R}}\mathbf{W}_{r}^{l}\cdot(\frac{1}{c_{{d_{i}}%
,r}}\sum_{j\in\mathcal{N}_{r}({d_{i}})}\mathbf{h}_{j}^{l}))," class="ltx_Math" display="block" id="S4.E7.m1.4"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml"><msubsup id="S4.E7.m1.4.4.1.1.3" xref="S4.E7.m1.4.4.1.1.3.cmml"><mi id="S4.E7.m1.4.4.1.1.3.2.2" xref="S4.E7.m1.4.4.1.1.3.2.2.cmml">𝐡</mi><msub id="S4.E7.m1.4.4.1.1.3.2.3" xref="S4.E7.m1.4.4.1.1.3.2.3.cmml"><mi id="S4.E7.m1.4.4.1.1.3.2.3.2" xref="S4.E7.m1.4.4.1.1.3.2.3.2.cmml">d</mi><mi id="S4.E7.m1.4.4.1.1.3.2.3.3" xref="S4.E7.m1.4.4.1.1.3.2.3.3.cmml">i</mi></msub><mrow id="S4.E7.m1.4.4.1.1.3.3" xref="S4.E7.m1.4.4.1.1.3.3.cmml"><mi id="S4.E7.m1.4.4.1.1.3.3.2" xref="S4.E7.m1.4.4.1.1.3.3.2.cmml">l</mi><mo id="S4.E7.m1.4.4.1.1.3.3.1" xref="S4.E7.m1.4.4.1.1.3.3.1.cmml">+</mo><mn id="S4.E7.m1.4.4.1.1.3.3.3" xref="S4.E7.m1.4.4.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.cmml"><mi id="S4.E7.m1.4.4.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.3.cmml">σ</mi><mo id="S4.E7.m1.4.4.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.cmml"><msubsup id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml">𝐖</mi><mn id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.3.cmml">0</mn><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.2.cmml">𝐡</mi><msub id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.2.cmml">d</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.3.cmml">l</mi></msubsup></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.2" rspace="0.055em" xref="S4.E7.m1.4.4.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><munder id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">ℛ</mi></mrow></munder><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mfrac id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml"><mn id="S4.E7.m1.2.2.4" xref="S4.E7.m1.2.2.4.cmml">1</mn><msub id="S4.E7.m1.2.2.2" xref="S4.E7.m1.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.4.cmml">c</mi><mrow id="S4.E7.m1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.cmml"><msub id="S4.E7.m1.2.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.1.2" xref="S4.E7.m1.2.2.2.2.2.2.1.2.cmml">d</mi><mi id="S4.E7.m1.2.2.2.2.2.2.1.3" xref="S4.E7.m1.2.2.2.2.2.2.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">r</mi></mrow></msub></mfrac><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><munder id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.2" movablelimits="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.cmml"><mi id="S4.E7.m1.3.3.1.3" xref="S4.E7.m1.3.3.1.3.cmml">j</mi><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.2.cmml">∈</mo><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><msub id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.3.1.1.3.2" xref="S4.E7.m1.3.3.1.1.3.2.cmml">𝒩</mi><mi id="S4.E7.m1.3.3.1.1.3.3" xref="S4.E7.m1.3.3.1.1.3.3.cmml">r</mi></msub><mo id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml">d</mi><mi id="S4.E7.m1.3.3.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.3.3.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><msubsup id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1"><eq id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2"></eq><apply id="S4.E7.m1.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2.2">𝐡</ci><apply id="S4.E7.m1.4.4.1.1.3.2.3.cmml" xref="S4.E7.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.3.2.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3.2.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.3.2.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2.3.2">𝑑</ci><ci id="S4.E7.m1.4.4.1.1.3.2.3.3.cmml" xref="S4.E7.m1.4.4.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S4.E7.m1.4.4.1.1.3.3.cmml" xref="S4.E7.m1.4.4.1.1.3.3"><plus id="S4.E7.m1.4.4.1.1.3.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3.3.1"></plus><ci id="S4.E7.m1.4.4.1.1.3.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.3.2">𝑙</ci><cn id="S4.E7.m1.4.4.1.1.3.3.3.cmml" type="integer" xref="S4.E7.m1.4.4.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1"><times id="S4.E7.m1.4.4.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2"></times><ci id="S4.E7.m1.4.4.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.3">𝜎</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1"><plus id="S4.E7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.2"></plus><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3"><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.2">𝐖</ci><cn id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.2.3">0</cn></apply><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.2">𝐡</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.2">𝑑</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1"><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.2"></sum><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3"><in id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.1"></in><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.3.3">ℛ</ci></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1"><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"><divide id="S4.E7.m1.2.2.3.cmml" xref="S4.E7.m1.2.2"></divide><cn id="S4.E7.m1.2.2.4.cmml" type="integer" xref="S4.E7.m1.2.2.4">1</cn><apply id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.4.cmml" xref="S4.E7.m1.2.2.2.4">𝑐</ci><list id="S4.E7.m1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2"><apply id="S4.E7.m1.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.2">𝑑</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">𝑟</ci></list></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.2"></sum><apply id="S4.E7.m1.3.3.1.cmml" xref="S4.E7.m1.3.3.1"><in id="S4.E7.m1.3.3.1.2.cmml" xref="S4.E7.m1.3.3.1.2"></in><ci id="S4.E7.m1.3.3.1.3.cmml" xref="S4.E7.m1.3.3.1.3">𝑗</ci><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1"><times id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2"></times><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2">𝒩</ci><ci id="S4.E7.m1.3.3.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3">𝑟</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.2">𝑑</ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐡</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\displaystyle\mathbf{h}_{d_{i}}^{l+1}=\sigma(\mathbf{W}_{0}^{l}\cdot\mathbf{h}%
_{d_{i}}^{l}+\sum_{r\in\mathcal{R}}\mathbf{W}_{r}^{l}\cdot(\frac{1}{c_{{d_{i}}%
,r}}\sum_{j\in\mathcal{N}_{r}({d_{i}})}\mathbf{h}_{j}^{l})),</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.4d">bold_h start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( bold_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ⋅ bold_h start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_r ∈ caligraphic_R end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ⋅ ( divide start_ARG 1 end_ARG start_ARG italic_c start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT bold_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{W}_{r}^{l}=I+\Theta_{r}^{l}," class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S4.E8.m1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.2.2.3.cmml">r</mi><mi id="S4.E8.m1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml">I</mi><mo id="S4.E8.m1.1.1.1.1.3.1" xref="S4.E8.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S4.E8.m1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.2.2" mathvariant="normal" xref="S4.E8.m1.1.1.1.1.3.3.2.2.cmml">Θ</mi><mi id="S4.E8.m1.1.1.1.1.3.3.2.3" xref="S4.E8.m1.1.1.1.1.3.3.2.3.cmml">r</mi><mi id="S4.E8.m1.1.1.1.1.3.3.3" xref="S4.E8.m1.1.1.1.1.3.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"></eq><apply id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.2">𝐖</ci><ci id="S4.E8.m1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3">𝑟</ci></apply><ci id="S4.E8.m1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><plus id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.1"></plus><ci id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2">𝐼</ci><apply id="S4.E8.m1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2.2">Θ</ci><ci id="S4.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2.3">𝑟</ci></apply><ci id="S4.E8.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\mathbf{W}_{r}^{l}=I+\Theta_{r}^{l},</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">bold_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_I + roman_Θ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS2.p3.21">Where <math alttext="\mathbf{W}_{r}^{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.6.m1.1"><semantics id="S4.SS3.SSS2.p3.6.m1.1a"><msubsup id="S4.SS3.SSS2.p3.6.m1.1.1" xref="S4.SS3.SSS2.p3.6.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.6.m1.1.1.2.2" xref="S4.SS3.SSS2.p3.6.m1.1.1.2.2.cmml">𝐖</mi><mi id="S4.SS3.SSS2.p3.6.m1.1.1.2.3" xref="S4.SS3.SSS2.p3.6.m1.1.1.2.3.cmml">r</mi><mi id="S4.SS3.SSS2.p3.6.m1.1.1.3" xref="S4.SS3.SSS2.p3.6.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.6.m1.1b"><apply id="S4.SS3.SSS2.p3.6.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.6.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p3.6.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.6.m1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.6.m1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1.2.2">𝐖</ci><ci id="S4.SS3.SSS2.p3.6.m1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.SSS2.p3.6.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p3.6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.6.m1.1c">\mathbf{W}_{r}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.6.m1.1d">bold_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight matrix for relation <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.7.m2.1"><semantics id="S4.SS3.SSS2.p3.7.m2.1a"><mi id="S4.SS3.SSS2.p3.7.m2.1.1" xref="S4.SS3.SSS2.p3.7.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.7.m2.1b"><ci id="S4.SS3.SSS2.p3.7.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.7.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.7.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.7.m2.1d">italic_r</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.8.m3.1"><semantics id="S4.SS3.SSS2.p3.8.m3.1a"><mi id="S4.SS3.SSS2.p3.8.m3.1.1" xref="S4.SS3.SSS2.p3.8.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.8.m3.1b"><ci id="S4.SS3.SSS2.p3.8.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.8.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.8.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.8.m3.1d">italic_l</annotation></semantics></math>, <math alttext="\mathbf{W}_{0}^{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.9.m4.1"><semantics id="S4.SS3.SSS2.p3.9.m4.1a"><msubsup id="S4.SS3.SSS2.p3.9.m4.1.1" xref="S4.SS3.SSS2.p3.9.m4.1.1.cmml"><mi id="S4.SS3.SSS2.p3.9.m4.1.1.2.2" xref="S4.SS3.SSS2.p3.9.m4.1.1.2.2.cmml">𝐖</mi><mn id="S4.SS3.SSS2.p3.9.m4.1.1.2.3" xref="S4.SS3.SSS2.p3.9.m4.1.1.2.3.cmml">0</mn><mi id="S4.SS3.SSS2.p3.9.m4.1.1.3" xref="S4.SS3.SSS2.p3.9.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.9.m4.1b"><apply id="S4.SS3.SSS2.p3.9.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.9.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p3.9.m4.1.1.2.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.9.m4.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.9.m4.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1.2.2">𝐖</ci><cn id="S4.SS3.SSS2.p3.9.m4.1.1.2.3.cmml" type="integer" xref="S4.SS3.SSS2.p3.9.m4.1.1.2.3">0</cn></apply><ci id="S4.SS3.SSS2.p3.9.m4.1.1.3.cmml" xref="S4.SS3.SSS2.p3.9.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.9.m4.1c">\mathbf{W}_{0}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.9.m4.1d">bold_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight matrix for the node itself, <math alttext="\mathcal{N}_{r}({d_{i}})" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.10.m5.1"><semantics id="S4.SS3.SSS2.p3.10.m5.1a"><mrow id="S4.SS3.SSS2.p3.10.m5.1.1" xref="S4.SS3.SSS2.p3.10.m5.1.1.cmml"><msub id="S4.SS3.SSS2.p3.10.m5.1.1.3" xref="S4.SS3.SSS2.p3.10.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.p3.10.m5.1.1.3.2" xref="S4.SS3.SSS2.p3.10.m5.1.1.3.2.cmml">𝒩</mi><mi id="S4.SS3.SSS2.p3.10.m5.1.1.3.3" xref="S4.SS3.SSS2.p3.10.m5.1.1.3.3.cmml">r</mi></msub><mo id="S4.SS3.SSS2.p3.10.m5.1.1.2" xref="S4.SS3.SSS2.p3.10.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p3.10.m5.1.1.1.1" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.2" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.3" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.10.m5.1b"><apply id="S4.SS3.SSS2.p3.10.m5.1.1.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1"><times id="S4.SS3.SSS2.p3.10.m5.1.1.2.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.2"></times><apply id="S4.SS3.SSS2.p3.10.m5.1.1.3.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.10.m5.1.1.3.1.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p3.10.m5.1.1.3.2.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.3.2">𝒩</ci><ci id="S4.SS3.SSS2.p3.10.m5.1.1.3.3.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.3.3">𝑟</ci></apply><apply id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.2">𝑑</ci><ci id="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.p3.10.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.10.m5.1c">\mathcal{N}_{r}({d_{i}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.10.m5.1d">caligraphic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the set of neighboring nodes of <math alttext="{d_{i}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.11.m6.1"><semantics id="S4.SS3.SSS2.p3.11.m6.1a"><msub id="S4.SS3.SSS2.p3.11.m6.1.1" xref="S4.SS3.SSS2.p3.11.m6.1.1.cmml"><mi id="S4.SS3.SSS2.p3.11.m6.1.1.2" xref="S4.SS3.SSS2.p3.11.m6.1.1.2.cmml">d</mi><mi id="S4.SS3.SSS2.p3.11.m6.1.1.3" xref="S4.SS3.SSS2.p3.11.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.11.m6.1b"><apply id="S4.SS3.SSS2.p3.11.m6.1.1.cmml" xref="S4.SS3.SSS2.p3.11.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.11.m6.1.1.1.cmml" xref="S4.SS3.SSS2.p3.11.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.11.m6.1.1.2.cmml" xref="S4.SS3.SSS2.p3.11.m6.1.1.2">𝑑</ci><ci id="S4.SS3.SSS2.p3.11.m6.1.1.3.cmml" xref="S4.SS3.SSS2.p3.11.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.11.m6.1c">{d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.11.m6.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for relation <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.12.m7.1"><semantics id="S4.SS3.SSS2.p3.12.m7.1a"><mi id="S4.SS3.SSS2.p3.12.m7.1.1" xref="S4.SS3.SSS2.p3.12.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.12.m7.1b"><ci id="S4.SS3.SSS2.p3.12.m7.1.1.cmml" xref="S4.SS3.SSS2.p3.12.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.12.m7.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.12.m7.1d">italic_r</annotation></semantics></math>, and <math alttext="c_{{d_{i}},r}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.13.m8.2"><semantics id="S4.SS3.SSS2.p3.13.m8.2a"><msub id="S4.SS3.SSS2.p3.13.m8.2.3" xref="S4.SS3.SSS2.p3.13.m8.2.3.cmml"><mi id="S4.SS3.SSS2.p3.13.m8.2.3.2" xref="S4.SS3.SSS2.p3.13.m8.2.3.2.cmml">c</mi><mrow id="S4.SS3.SSS2.p3.13.m8.2.2.2.2" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.3.cmml"><msub id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.cmml"><mi id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.2" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.2.cmml">d</mi><mi id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.3" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.3.cmml">i</mi></msub><mo id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.2" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS3.SSS2.p3.13.m8.1.1.1.1" xref="S4.SS3.SSS2.p3.13.m8.1.1.1.1.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.13.m8.2b"><apply id="S4.SS3.SSS2.p3.13.m8.2.3.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.13.m8.2.3.1.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.3">subscript</csymbol><ci id="S4.SS3.SSS2.p3.13.m8.2.3.2.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.3.2">𝑐</ci><list id="S4.SS3.SSS2.p3.13.m8.2.2.2.3.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2"><apply id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.1.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.2.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.2">𝑑</ci><ci id="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.3.cmml" xref="S4.SS3.SSS2.p3.13.m8.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.SS3.SSS2.p3.13.m8.1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.13.m8.1.1.1.1">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.13.m8.2c">c_{{d_{i}},r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.13.m8.2d">italic_c start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r end_POSTSUBSCRIPT</annotation></semantics></math> is a normalization factor. <math alttext="I" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.14.m9.1"><semantics id="S4.SS3.SSS2.p3.14.m9.1a"><mi id="S4.SS3.SSS2.p3.14.m9.1.1" xref="S4.SS3.SSS2.p3.14.m9.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.14.m9.1b"><ci id="S4.SS3.SSS2.p3.14.m9.1.1.cmml" xref="S4.SS3.SSS2.p3.14.m9.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.14.m9.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.14.m9.1d">italic_I</annotation></semantics></math> is the identity matrix, and <math alttext="\Theta_{r}^{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.15.m10.1"><semantics id="S4.SS3.SSS2.p3.15.m10.1a"><msubsup id="S4.SS3.SSS2.p3.15.m10.1.1" xref="S4.SS3.SSS2.p3.15.m10.1.1.cmml"><mi id="S4.SS3.SSS2.p3.15.m10.1.1.2.2" mathvariant="normal" xref="S4.SS3.SSS2.p3.15.m10.1.1.2.2.cmml">Θ</mi><mi id="S4.SS3.SSS2.p3.15.m10.1.1.2.3" xref="S4.SS3.SSS2.p3.15.m10.1.1.2.3.cmml">r</mi><mi id="S4.SS3.SSS2.p3.15.m10.1.1.3" xref="S4.SS3.SSS2.p3.15.m10.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.15.m10.1b"><apply id="S4.SS3.SSS2.p3.15.m10.1.1.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.15.m10.1.1.1.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p3.15.m10.1.1.2.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.15.m10.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.15.m10.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1.2.2">Θ</ci><ci id="S4.SS3.SSS2.p3.15.m10.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1.2.3">𝑟</ci></apply><ci id="S4.SS3.SSS2.p3.15.m10.1.1.3.cmml" xref="S4.SS3.SSS2.p3.15.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.15.m10.1c">\Theta_{r}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.15.m10.1d">roman_Θ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight update matrix for relation <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.16.m11.1"><semantics id="S4.SS3.SSS2.p3.16.m11.1a"><mi id="S4.SS3.SSS2.p3.16.m11.1.1" xref="S4.SS3.SSS2.p3.16.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.16.m11.1b"><ci id="S4.SS3.SSS2.p3.16.m11.1.1.cmml" xref="S4.SS3.SSS2.p3.16.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.16.m11.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.16.m11.1d">italic_r</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.17.m12.1"><semantics id="S4.SS3.SSS2.p3.17.m12.1a"><mi id="S4.SS3.SSS2.p3.17.m12.1.1" xref="S4.SS3.SSS2.p3.17.m12.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.17.m12.1b"><ci id="S4.SS3.SSS2.p3.17.m12.1.1.cmml" xref="S4.SS3.SSS2.p3.17.m12.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.17.m12.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.17.m12.1d">italic_l</annotation></semantics></math>. In <math alttext="G^{pm}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.18.m13.1"><semantics id="S4.SS3.SSS2.p3.18.m13.1a"><msubsup id="S4.SS3.SSS2.p3.18.m13.1.1" xref="S4.SS3.SSS2.p3.18.m13.1.1.cmml"><mi id="S4.SS3.SSS2.p3.18.m13.1.1.2.2" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.2.cmml">G</mi><msub id="S4.SS3.SSS2.p3.18.m13.1.1.3" xref="S4.SS3.SSS2.p3.18.m13.1.1.3.cmml"><mi id="S4.SS3.SSS2.p3.18.m13.1.1.3.2" xref="S4.SS3.SSS2.p3.18.m13.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS2.p3.18.m13.1.1.3.3" xref="S4.SS3.SSS2.p3.18.m13.1.1.3.3.cmml">t</mi></msub><mrow id="S4.SS3.SSS2.p3.18.m13.1.1.2.3" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.2" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.1" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.3" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.3.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.18.m13.1b"><apply id="S4.SS3.SSS2.p3.18.m13.1.1.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.18.m13.1.1.1.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p3.18.m13.1.1.2.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.18.m13.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p3.18.m13.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.2">𝐺</ci><apply id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3"><times id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p3.18.m13.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS3.SSS2.p3.18.m13.1.1.3.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.18.m13.1.1.3.1.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p3.18.m13.1.1.3.2.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS2.p3.18.m13.1.1.3.3.cmml" xref="S4.SS3.SSS2.p3.18.m13.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.18.m13.1c">G^{pm}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.18.m13.1d">italic_G start_POSTSUPERSCRIPT italic_p italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, we repeat this process to obtain entity embeddings <math alttext="\mathbf{h}^{e}_{d}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.19.m14.1"><semantics id="S4.SS3.SSS2.p3.19.m14.1a"><msubsup id="S4.SS3.SSS2.p3.19.m14.1.1" xref="S4.SS3.SSS2.p3.19.m14.1.1.cmml"><mi id="S4.SS3.SSS2.p3.19.m14.1.1.2.2" xref="S4.SS3.SSS2.p3.19.m14.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS2.p3.19.m14.1.1.3" xref="S4.SS3.SSS2.p3.19.m14.1.1.3.cmml">d</mi><mi id="S4.SS3.SSS2.p3.19.m14.1.1.2.3" xref="S4.SS3.SSS2.p3.19.m14.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.19.m14.1b"><apply id="S4.SS3.SSS2.p3.19.m14.1.1.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.19.m14.1.1.1.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p3.19.m14.1.1.2.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.19.m14.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p3.19.m14.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS2.p3.19.m14.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1.2.3">𝑒</ci></apply><ci id="S4.SS3.SSS2.p3.19.m14.1.1.3.cmml" xref="S4.SS3.SSS2.p3.19.m14.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.19.m14.1c">\mathbf{h}^{e}_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.19.m14.1d">bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}^{e}_{p}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.20.m15.1"><semantics id="S4.SS3.SSS2.p3.20.m15.1a"><msubsup id="S4.SS3.SSS2.p3.20.m15.1.1" xref="S4.SS3.SSS2.p3.20.m15.1.1.cmml"><mi id="S4.SS3.SSS2.p3.20.m15.1.1.2.2" xref="S4.SS3.SSS2.p3.20.m15.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS2.p3.20.m15.1.1.3" xref="S4.SS3.SSS2.p3.20.m15.1.1.3.cmml">p</mi><mi id="S4.SS3.SSS2.p3.20.m15.1.1.2.3" xref="S4.SS3.SSS2.p3.20.m15.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.20.m15.1b"><apply id="S4.SS3.SSS2.p3.20.m15.1.1.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.20.m15.1.1.1.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p3.20.m15.1.1.2.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.20.m15.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p3.20.m15.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS2.p3.20.m15.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1.2.3">𝑒</ci></apply><ci id="S4.SS3.SSS2.p3.20.m15.1.1.3.cmml" xref="S4.SS3.SSS2.p3.20.m15.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.20.m15.1c">\mathbf{h}^{e}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.20.m15.1d">bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{h}^{e}_{m}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.21.m16.1"><semantics id="S4.SS3.SSS2.p3.21.m16.1a"><msubsup id="S4.SS3.SSS2.p3.21.m16.1.1" xref="S4.SS3.SSS2.p3.21.m16.1.1.cmml"><mi id="S4.SS3.SSS2.p3.21.m16.1.1.2.2" xref="S4.SS3.SSS2.p3.21.m16.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS2.p3.21.m16.1.1.3" xref="S4.SS3.SSS2.p3.21.m16.1.1.3.cmml">m</mi><mi id="S4.SS3.SSS2.p3.21.m16.1.1.2.3" xref="S4.SS3.SSS2.p3.21.m16.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.21.m16.1b"><apply id="S4.SS3.SSS2.p3.21.m16.1.1.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.21.m16.1.1.1.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1">subscript</csymbol><apply id="S4.SS3.SSS2.p3.21.m16.1.1.2.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.21.m16.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p3.21.m16.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS2.p3.21.m16.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1.2.3">𝑒</ci></apply><ci id="S4.SS3.SSS2.p3.21.m16.1.1.3.cmml" xref="S4.SS3.SSS2.p3.21.m16.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.21.m16.1c">\mathbf{h}^{e}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.21.m16.1d">bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3. </span>Aggregation of Entity Information</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.4">We use the residual method to stack the embeddings after initialization and weighting. By aggregating the updated embeddings with element-wise addition, we obtain three set representations: <math alttext="\mathbf{h}_{\mathcal{D}_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.1.m1.1"><semantics id="S4.SS3.SSS3.p1.1.m1.1a"><msub id="S4.SS3.SSS3.p1.1.m1.1.1" xref="S4.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS3.p1.1.m1.1.1.2" xref="S4.SS3.SSS3.p1.1.m1.1.1.2.cmml">𝐡</mi><msub id="S4.SS3.SSS3.p1.1.m1.1.1.3" xref="S4.SS3.SSS3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p1.1.m1.1.1.3.2" xref="S4.SS3.SSS3.p1.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S4.SS3.SSS3.p1.1.m1.1.1.3.3" xref="S4.SS3.SSS3.p1.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.1.m1.1b"><apply id="S4.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1.2">𝐡</ci><apply id="S4.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1.3.2">𝒟</ci><ci id="S4.SS3.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.1.m1.1c">\mathbf{h}_{\mathcal{D}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.1.m1.1d">bold_h start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}_{\mathcal{P}_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.2.m2.1"><semantics id="S4.SS3.SSS3.p1.2.m2.1a"><msub id="S4.SS3.SSS3.p1.2.m2.1.1" xref="S4.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS3.p1.2.m2.1.1.2" xref="S4.SS3.SSS3.p1.2.m2.1.1.2.cmml">𝐡</mi><msub id="S4.SS3.SSS3.p1.2.m2.1.1.3" xref="S4.SS3.SSS3.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS3.p1.2.m2.1.1.3.2.cmml">𝒫</mi><mi id="S4.SS3.SSS3.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS3.p1.2.m2.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.2.m2.1b"><apply id="S4.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1.2">𝐡</ci><apply id="S4.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1.3.2">𝒫</ci><ci id="S4.SS3.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.2.m2.1c">\mathbf{h}_{\mathcal{P}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.2.m2.1d">bold_h start_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{h}_{\mathcal{M}_{t-1}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.3.m3.1"><semantics id="S4.SS3.SSS3.p1.3.m3.1a"><msub id="S4.SS3.SSS3.p1.3.m3.1.1" xref="S4.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS3.p1.3.m3.1.1.2" xref="S4.SS3.SSS3.p1.3.m3.1.1.2.cmml">𝐡</mi><msub id="S4.SS3.SSS3.p1.3.m3.1.1.3" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p1.3.m3.1.1.3.2" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.2.cmml">ℳ</mi><mrow id="S4.SS3.SSS3.p1.3.m3.1.1.3.3" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.2" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.2.cmml">t</mi><mo id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.1" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.1.cmml">−</mo><mn id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.3" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.3.cmml">1</mn></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.3.m3.1b"><apply id="S4.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.2">𝐡</ci><apply id="S4.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.2">ℳ</ci><apply id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3"><minus id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.1"></minus><ci id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.2">𝑡</ci><cn id="S4.SS3.SSS3.p1.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS3.SSS3.p1.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.3.m3.1c">\mathbf{h}_{\mathcal{M}_{t-1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.3.m3.1d">bold_h start_POSTSUBSCRIPT caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. These representations are then concatenated with the representation <math alttext="\mathbf{h}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.4.m4.1"><semantics id="S4.SS3.SSS3.p1.4.m4.1a"><msub id="S4.SS3.SSS3.p1.4.m4.1.1" xref="S4.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS3.p1.4.m4.1.1.2" xref="S4.SS3.SSS3.p1.4.m4.1.1.2.cmml">𝐡</mi><msub id="S4.SS3.SSS3.p1.4.m4.1.1.3" xref="S4.SS3.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS3.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS3.p1.4.m4.1.1.3.2.cmml">v</mi><mi id="S4.SS3.SSS3.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS3.p1.4.m4.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.4.m4.1b"><apply id="S4.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1.2">𝐡</ci><apply id="S4.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1.3.2">𝑣</ci><ci id="S4.SS3.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS3.p1.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.4.m4.1c">\mathbf{h}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.4.m4.1d">bold_h start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for the current clinical visit.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx4">
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\begin{gathered}\mathbf{h}_{\mathcal{D}_{t}}=\text{Agg}(\mathbf{h%
}^{r}_{d},\mathbf{h}^{e}_{d}),\mathbf{h}_{\mathcal{P}_{t}}=\text{Agg}(\mathbf{%
h}^{r}_{p},\mathbf{h}^{e}_{p}),\\
\mathbf{h}_{\mathcal{M}_{t-1}}=\text{Agg}(\mathbf{h}^{r}_{m},\mathbf{h}^{e}_{m%
}),\end{gathered}" class="ltx_Math" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mtable displaystyle="true" id="S4.E11.m1.1.1.2" rowspacing="0pt"><mtr id="S4.E11.m1.1.1.2a"><mtd id="S4.E11.m1.1.1.2b"><mrow id="S4.E9.29.29.29"><mrow id="S4.E9.29.29.29.1"><mrow id="S4.E9.29.29.29.1.1.1"><msub id="S4.E9.29.29.29.1.1.1.3"><mi id="S4.E9.1.1.1" xref="S4.E9.1.1.1.cmml">𝐡</mi><msub id="S4.E9.2.2.2.1" xref="S4.E9.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.2.2.2.1.2" xref="S4.E9.2.2.2.1.2.cmml">𝒟</mi><mi id="S4.E9.2.2.2.1.3" xref="S4.E9.2.2.2.1.3.cmml">t</mi></msub></msub><mo id="S4.E9.3.3.3" xref="S4.E9.3.3.3.cmml">=</mo><mrow id="S4.E9.29.29.29.1.1.1.2"><mtext id="S4.E9.4.4.4" xref="S4.E9.4.4.4a.cmml">Agg</mtext><mo id="S4.E9.29.29.29.1.1.1.2.3">⁢</mo><mrow id="S4.E9.29.29.29.1.1.1.2.2.2"><mo id="S4.E9.5.5.5" stretchy="false">(</mo><msubsup id="S4.E9.29.29.29.1.1.1.1.1.1.1"><mi id="S4.E9.6.6.6" xref="S4.E9.6.6.6.cmml">𝐡</mi><mi id="S4.E9.8.8.8.1" xref="S4.E9.8.8.8.1.cmml">d</mi><mi id="S4.E9.7.7.7.1" xref="S4.E9.7.7.7.1.cmml">r</mi></msubsup><mo id="S4.E9.9.9.9">,</mo><msubsup id="S4.E9.29.29.29.1.1.1.2.2.2.2"><mi id="S4.E9.10.10.10" xref="S4.E9.10.10.10.cmml">𝐡</mi><mi id="S4.E9.12.12.12.1" xref="S4.E9.12.12.12.1.cmml">d</mi><mi id="S4.E9.11.11.11.1" xref="S4.E9.11.11.11.1.cmml">e</mi></msubsup><mo id="S4.E9.13.13.13" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E9.14.14.14">,</mo><mrow id="S4.E9.29.29.29.1.2.2"><msub id="S4.E9.29.29.29.1.2.2.3"><mi id="S4.E9.15.15.15" xref="S4.E9.15.15.15.cmml">𝐡</mi><msub id="S4.E9.16.16.16.1" xref="S4.E9.16.16.16.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.16.16.16.1.2" xref="S4.E9.16.16.16.1.2.cmml">𝒫</mi><mi id="S4.E9.16.16.16.1.3" xref="S4.E9.16.16.16.1.3.cmml">t</mi></msub></msub><mo id="S4.E9.17.17.17" xref="S4.E9.17.17.17.cmml">=</mo><mrow id="S4.E9.29.29.29.1.2.2.2"><mtext id="S4.E9.18.18.18" xref="S4.E9.18.18.18a.cmml">Agg</mtext><mo id="S4.E9.29.29.29.1.2.2.2.3">⁢</mo><mrow id="S4.E9.29.29.29.1.2.2.2.2.2"><mo id="S4.E9.19.19.19" stretchy="false">(</mo><msubsup id="S4.E9.29.29.29.1.2.2.1.1.1.1"><mi id="S4.E9.20.20.20" xref="S4.E9.20.20.20.cmml">𝐡</mi><mi id="S4.E9.22.22.22.1" xref="S4.E9.22.22.22.1.cmml">p</mi><mi id="S4.E9.21.21.21.1" xref="S4.E9.21.21.21.1.cmml">r</mi></msubsup><mo id="S4.E9.23.23.23">,</mo><msubsup id="S4.E9.29.29.29.1.2.2.2.2.2.2"><mi id="S4.E9.24.24.24" xref="S4.E9.24.24.24.cmml">𝐡</mi><mi id="S4.E9.26.26.26.1" xref="S4.E9.26.26.26.1.cmml">p</mi><mi id="S4.E9.25.25.25.1" xref="S4.E9.25.25.25.1.cmml">e</mi></msubsup><mo id="S4.E9.27.27.27" stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E9.28.28.28">,</mo></mrow></mtd></mtr><mtr id="S4.E11.m1.1.1.2c"><mtd id="S4.E11.m1.1.1.2d"><mrow id="S4.E10.15.15.15"><mrow id="S4.E10.15.15.15.1"><msub id="S4.E10.15.15.15.1.3"><mi id="S4.E10.1.1.1" xref="S4.E10.1.1.1.cmml">𝐡</mi><msub id="S4.E10.2.2.2.1" xref="S4.E10.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.2.2.2.1.2" xref="S4.E10.2.2.2.1.2.cmml">ℳ</mi><mrow id="S4.E10.2.2.2.1.3" xref="S4.E10.2.2.2.1.3.cmml"><mi id="S4.E10.2.2.2.1.3.2" xref="S4.E10.2.2.2.1.3.2.cmml">t</mi><mo id="S4.E10.2.2.2.1.3.1" xref="S4.E10.2.2.2.1.3.1.cmml">−</mo><mn id="S4.E10.2.2.2.1.3.3" xref="S4.E10.2.2.2.1.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.E10.3.3.3" xref="S4.E10.3.3.3.cmml">=</mo><mrow id="S4.E10.15.15.15.1.2"><mtext id="S4.E10.4.4.4" xref="S4.E10.4.4.4a.cmml">Agg</mtext><mo id="S4.E10.15.15.15.1.2.3">⁢</mo><mrow id="S4.E10.15.15.15.1.2.2.2"><mo id="S4.E10.5.5.5" stretchy="false">(</mo><msubsup id="S4.E10.15.15.15.1.1.1.1.1"><mi id="S4.E10.6.6.6" xref="S4.E10.6.6.6.cmml">𝐡</mi><mi id="S4.E10.8.8.8.1" xref="S4.E10.8.8.8.1.cmml">m</mi><mi id="S4.E10.7.7.7.1" xref="S4.E10.7.7.7.1.cmml">r</mi></msubsup><mo id="S4.E10.9.9.9">,</mo><msubsup id="S4.E10.15.15.15.1.2.2.2.2"><mi id="S4.E10.10.10.10" xref="S4.E10.10.10.10.cmml">𝐡</mi><mi id="S4.E10.12.12.12.1" xref="S4.E10.12.12.12.1.cmml">m</mi><mi id="S4.E10.11.11.11.1" xref="S4.E10.11.11.11.1.cmml">e</mi></msubsup><mo id="S4.E10.13.13.13" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E10.14.14.14">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.cmml"><eq id="S4.E9.3.3.3.cmml" xref="S4.E9.3.3.3"></eq><apply id="S4.E11.m1.1.1.1.1.1.1.1.4.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.4.1.cmml">subscript</csymbol><ci id="S4.E9.1.1.1.cmml" xref="S4.E9.1.1.1">𝐡</ci><apply id="S4.E9.2.2.2.1.cmml" xref="S4.E9.2.2.2.1"><csymbol cd="ambiguous" id="S4.E9.2.2.2.1.1.cmml" xref="S4.E9.2.2.2.1">subscript</csymbol><ci id="S4.E9.2.2.2.1.2.cmml" xref="S4.E9.2.2.2.1.2">𝒟</ci><ci id="S4.E9.2.2.2.1.3.cmml" xref="S4.E9.2.2.2.1.3">𝑡</ci></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.cmml"><times id="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml"></times><ci id="S4.E9.4.4.4a.cmml" xref="S4.E9.4.4.4"><mtext id="S4.E9.4.4.4.cmml" xref="S4.E9.4.4.4">Agg</mtext></ci><interval closure="open" id="S4.E11.m1.1.1.1.1.1.1.1.2.2.3.cmml"><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S4.E9.6.6.6.cmml" xref="S4.E9.6.6.6">𝐡</ci><ci id="S4.E9.7.7.7.1.cmml" xref="S4.E9.7.7.7.1">𝑟</ci></apply><ci id="S4.E9.8.8.8.1.cmml" xref="S4.E9.8.8.8.1">𝑑</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">superscript</csymbol><ci id="S4.E9.10.10.10.cmml" xref="S4.E9.10.10.10">𝐡</ci><ci id="S4.E9.11.11.11.1.cmml" xref="S4.E9.11.11.11.1">𝑒</ci></apply><ci id="S4.E9.12.12.12.1.cmml" xref="S4.E9.12.12.12.1">𝑑</ci></apply></interval></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.cmml"><eq id="S4.E9.17.17.17.cmml" xref="S4.E9.17.17.17"></eq><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.4.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.4.1.cmml">subscript</csymbol><ci id="S4.E9.15.15.15.cmml" xref="S4.E9.15.15.15">𝐡</ci><apply id="S4.E9.16.16.16.1.cmml" xref="S4.E9.16.16.16.1"><csymbol cd="ambiguous" id="S4.E9.16.16.16.1.1.cmml" xref="S4.E9.16.16.16.1">subscript</csymbol><ci id="S4.E9.16.16.16.1.2.cmml" xref="S4.E9.16.16.16.1.2">𝒫</ci><ci id="S4.E9.16.16.16.1.3.cmml" xref="S4.E9.16.16.16.1.3">𝑡</ci></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.cmml"><times id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.3.cmml"></times><ci id="S4.E9.18.18.18a.cmml" xref="S4.E9.18.18.18"><mtext id="S4.E9.18.18.18.cmml" xref="S4.E9.18.18.18">Agg</mtext></ci><interval closure="open" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.2.3.cmml"><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S4.E9.20.20.20.cmml" xref="S4.E9.20.20.20">𝐡</ci><ci id="S4.E9.21.21.21.1.cmml" xref="S4.E9.21.21.21.1">𝑟</ci></apply><ci id="S4.E9.22.22.22.1.cmml" xref="S4.E9.22.22.22.1">𝑝</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.2.2.2.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.1.1.2.2.2.2.2.1.cmml">superscript</csymbol><ci id="S4.E9.24.24.24.cmml" xref="S4.E9.24.24.24">𝐡</ci><ci id="S4.E9.25.25.25.1.cmml" xref="S4.E9.25.25.25.1">𝑒</ci></apply><ci id="S4.E9.26.26.26.1.cmml" xref="S4.E9.26.26.26.1">𝑝</ci></apply></interval></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.cmml"><eq id="S4.E10.3.3.3.cmml" xref="S4.E10.3.3.3"></eq><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.4.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.4.1.cmml">subscript</csymbol><ci id="S4.E10.1.1.1.cmml" xref="S4.E10.1.1.1">𝐡</ci><apply id="S4.E10.2.2.2.1.cmml" xref="S4.E10.2.2.2.1"><csymbol cd="ambiguous" id="S4.E10.2.2.2.1.1.cmml" xref="S4.E10.2.2.2.1">subscript</csymbol><ci id="S4.E10.2.2.2.1.2.cmml" xref="S4.E10.2.2.2.1.2">ℳ</ci><apply id="S4.E10.2.2.2.1.3.cmml" xref="S4.E10.2.2.2.1.3"><minus id="S4.E10.2.2.2.1.3.1.cmml" xref="S4.E10.2.2.2.1.3.1"></minus><ci id="S4.E10.2.2.2.1.3.2.cmml" xref="S4.E10.2.2.2.1.3.2">𝑡</ci><cn id="S4.E10.2.2.2.1.3.3.cmml" type="integer" xref="S4.E10.2.2.2.1.3.3">1</cn></apply></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.cmml"><times id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.3.cmml"></times><ci id="S4.E10.4.4.4a.cmml" xref="S4.E10.4.4.4"><mtext id="S4.E10.4.4.4.cmml" xref="S4.E10.4.4.4">Agg</mtext></ci><interval closure="open" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.2.3.cmml"><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S4.E10.6.6.6.cmml" xref="S4.E10.6.6.6">𝐡</ci><ci id="S4.E10.7.7.7.1.cmml" xref="S4.E10.7.7.7.1">𝑟</ci></apply><ci id="S4.E10.8.8.8.1.cmml" xref="S4.E10.8.8.8.1">𝑚</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.2.2.2.1.cmml">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.1.cmml">superscript</csymbol><ci id="S4.E10.10.10.10.cmml" xref="S4.E10.10.10.10">𝐡</ci><ci id="S4.E10.11.11.11.1.cmml" xref="S4.E10.11.11.11.1">𝑒</ci></apply><ci id="S4.E10.12.12.12.1.cmml" xref="S4.E10.12.12.12.1">𝑚</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\displaystyle\begin{gathered}\mathbf{h}_{\mathcal{D}_{t}}=\text{Agg}(\mathbf{h%
}^{r}_{d},\mathbf{h}^{e}_{d}),\mathbf{h}_{\mathcal{P}_{t}}=\text{Agg}(\mathbf{%
h}^{r}_{p},\mathbf{h}^{e}_{p}),\\
\mathbf{h}_{\mathcal{M}_{t-1}}=\text{Agg}(\mathbf{h}^{r}_{m},\mathbf{h}^{e}_{m%
}),\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">start_ROW start_CELL bold_h start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = Agg ( bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ) , bold_h start_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = Agg ( bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) , end_CELL end_ROW start_ROW start_CELL bold_h start_POSTSUBSCRIPT caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = Agg ( bold_h start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{h}_{v_{t}}=[\mathbf{h}_{\mathcal{D}_{t}}||\mathbf{h}_{%
\mathcal{P}_{t}}||\mathbf{h}_{\mathcal{M}_{t-1}}]." class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.3.2.cmml">𝐡</mi><msub id="S4.E12.m1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.3.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.2" xref="S4.E12.m1.1.1.1.1.3.3.2.cmml">v</mi><mi id="S4.E12.m1.1.1.1.1.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.3.cmml">t</mi></msub></msub><mo id="S4.E12.m1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.3.2.cmml">𝐡</mi><msub id="S4.E12.m1.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msub></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒫</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.2a" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.4" xref="S4.E12.m1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.4.2" xref="S4.E12.m1.1.1.1.1.1.1.1.4.2.cmml">𝐡</mi><msub id="S4.E12.m1.1.1.1.1.1.1.1.4.3" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.4.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.2.cmml">ℳ</mi><mrow id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.2.cmml">t</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.1" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.1.cmml">−</mo><mn id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.3.cmml">1</mn></mrow></msub></msub></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E12.m1.1.1.1.2" lspace="0em" xref="S4.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"></eq><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2">𝐡</ci><apply id="S4.E12.m1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2">𝑣</ci><ci id="S4.E12.m1.1.1.1.1.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><times id="S4.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3.2">𝐡</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.2">𝒟</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.2">𝐡</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝒫</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.2">𝐡</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.2">ℳ</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3"><minus id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.1"></minus><ci id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.2">𝑡</ci><cn id="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.3.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.1.1.1.4.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\displaystyle\mathbf{h}_{v_{t}}=[\mathbf{h}_{\mathcal{D}_{t}}||\mathbf{h}_{%
\mathcal{P}_{t}}||\mathbf{h}_{\mathcal{M}_{t-1}}].</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">bold_h start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = [ bold_h start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | bold_h start_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | bold_h start_POSTSUBSCRIPT caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Medication Recommendation</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.5">To deeply mine personalized patient representations, we consider the patient’s medical history. Each medical record is represented and integrated to recommend medication combinations. Multiple GRUs capture temporal dependencies among visits, generating GRU output <math alttext="\mathbf{o}_{v_{t}}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">𝐨</mi><msub id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">v</mi><mi id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝐨</ci><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">𝑣</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mathbf{o}_{v_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and patient embedding <math alttext="\mathbf{h}_{\mathcal{H}}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">𝐡</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">ℋ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝐡</ci><ci id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\mathbf{h}_{\mathcal{H}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">bold_h start_POSTSUBSCRIPT caligraphic_H end_POSTSUBSCRIPT</annotation></semantics></math>. An MLP layer with activation function <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_σ</annotation></semantics></math> converts this into medication scores. Medications <math alttext="\hat{m}_{i}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mover accent="true" id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2.2" xref="S4.SS4.p1.4.m4.1.1.2.2.cmml">m</mi><mo id="S4.SS4.p1.4.m4.1.1.2.1" xref="S4.SS4.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2"><ci id="S4.SS4.p1.4.m4.1.1.2.1.cmml" xref="S4.SS4.p1.4.m4.1.1.2.1">^</ci><ci id="S4.SS4.p1.4.m4.1.1.2.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2.2">𝑚</ci></apply><ci id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\hat{m}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with scores exceeding <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m5.1"><semantics id="S4.SS4.p1.5.m5.1a"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><ci id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m5.1d">italic_δ</annotation></semantics></math> are chosen.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx5">
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{h}_{\mathcal{H}}=\mathbf{o}_{v_{t}}=\text{GRU}(\mathbf{o}%
_{v_{t-1}},\mathbf{h}_{v_{t}})," class="ltx_Math" display="block" id="S4.E13.m1.1"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.4" xref="S4.E13.m1.1.1.1.1.4.cmml"><mi id="S4.E13.m1.1.1.1.1.4.2" xref="S4.E13.m1.1.1.1.1.4.2.cmml">𝐡</mi><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.4.3" xref="S4.E13.m1.1.1.1.1.4.3.cmml">ℋ</mi></msub><mo id="S4.E13.m1.1.1.1.1.5" xref="S4.E13.m1.1.1.1.1.5.cmml">=</mo><msub id="S4.E13.m1.1.1.1.1.6" xref="S4.E13.m1.1.1.1.1.6.cmml"><mi id="S4.E13.m1.1.1.1.1.6.2" xref="S4.E13.m1.1.1.1.1.6.2.cmml">𝐨</mi><msub id="S4.E13.m1.1.1.1.1.6.3" xref="S4.E13.m1.1.1.1.1.6.3.cmml"><mi id="S4.E13.m1.1.1.1.1.6.3.2" xref="S4.E13.m1.1.1.1.1.6.3.2.cmml">v</mi><mi id="S4.E13.m1.1.1.1.1.6.3.3" xref="S4.E13.m1.1.1.1.1.6.3.3.cmml">t</mi></msub></msub><mo id="S4.E13.m1.1.1.1.1.7" xref="S4.E13.m1.1.1.1.1.7.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml"><mtext id="S4.E13.m1.1.1.1.1.2.4" xref="S4.E13.m1.1.1.1.1.2.4a.cmml">GRU</mtext><mo id="S4.E13.m1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.2.2.2" xref="S4.E13.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E13.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml">𝐨</mi><msub id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.E13.m1.1.1.1.1.2.2.2.4" xref="S4.E13.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E13.m1.1.1.1.1.2.2.2.2" xref="S4.E13.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E13.m1.1.1.1.1.2.2.2.2.2" xref="S4.E13.m1.1.1.1.1.2.2.2.2.2.cmml">𝐡</mi><msub id="S4.E13.m1.1.1.1.1.2.2.2.2.3" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3.2.cmml">v</mi><mi id="S4.E13.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3.3.cmml">t</mi></msub></msub><mo id="S4.E13.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E13.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><and id="S4.E13.m1.1.1.1.1a.cmml" xref="S4.E13.m1.1.1.1"></and><apply id="S4.E13.m1.1.1.1.1b.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.5.cmml" xref="S4.E13.m1.1.1.1.1.5"></eq><apply id="S4.E13.m1.1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.4.1.cmml" xref="S4.E13.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.4.2.cmml" xref="S4.E13.m1.1.1.1.1.4.2">𝐡</ci><ci id="S4.E13.m1.1.1.1.1.4.3.cmml" xref="S4.E13.m1.1.1.1.1.4.3">ℋ</ci></apply><apply id="S4.E13.m1.1.1.1.1.6.cmml" xref="S4.E13.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.6.1.cmml" xref="S4.E13.m1.1.1.1.1.6">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.6.2.cmml" xref="S4.E13.m1.1.1.1.1.6.2">𝐨</ci><apply id="S4.E13.m1.1.1.1.1.6.3.cmml" xref="S4.E13.m1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.6.3.1.cmml" xref="S4.E13.m1.1.1.1.1.6.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.6.3.2.cmml" xref="S4.E13.m1.1.1.1.1.6.3.2">𝑣</ci><ci id="S4.E13.m1.1.1.1.1.6.3.3.cmml" xref="S4.E13.m1.1.1.1.1.6.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E13.m1.1.1.1.1c.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.7.cmml" xref="S4.E13.m1.1.1.1.1.7"></eq><share href="https://arxiv.org/html/2404.12228v3#S4.E13.m1.1.1.1.1.6.cmml" id="S4.E13.m1.1.1.1.1d.cmml" xref="S4.E13.m1.1.1.1"></share><apply id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"><times id="S4.E13.m1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.3"></times><ci id="S4.E13.m1.1.1.1.1.2.4a.cmml" xref="S4.E13.m1.1.1.1.1.2.4"><mtext id="S4.E13.m1.1.1.1.1.2.4.cmml" xref="S4.E13.m1.1.1.1.1.2.4">GRU</mtext></ci><interval closure="open" id="S4.E13.m1.1.1.1.1.2.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2"><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2">𝐨</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3"><minus id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S4.E13.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2.2">𝐡</ci><apply id="S4.E13.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3.2">𝑣</ci><ci id="S4.E13.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E13.m1.1.1.1.1.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\displaystyle\mathbf{h}_{\mathcal{H}}=\mathbf{o}_{v_{t}}=\text{GRU}(\mathbf{o}%
_{v_{t-1}},\mathbf{h}_{v_{t}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">bold_h start_POSTSUBSCRIPT caligraphic_H end_POSTSUBSCRIPT = bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = GRU ( bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_h start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle score=\sigma(\text{MLP}(\mathbf{h}_{\mathcal{H}}))," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.3.2.cmml">s</mi><mo id="S4.E14.m1.1.1.1.1.3.1" xref="S4.E14.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.3.3.cmml">c</mi><mo id="S4.E14.m1.1.1.1.1.3.1a" xref="S4.E14.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.3.4" xref="S4.E14.m1.1.1.1.1.3.4.cmml">o</mi><mo id="S4.E14.m1.1.1.1.1.3.1b" xref="S4.E14.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.3.5" xref="S4.E14.m1.1.1.1.1.3.5.cmml">r</mi><mo id="S4.E14.m1.1.1.1.1.3.1c" xref="S4.E14.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.3.6" xref="S4.E14.m1.1.1.1.1.3.6.cmml">e</mi></mrow><mo id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E14.m1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E14.m1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ℋ</mi></msub><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2"></eq><apply id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3"><times id="S4.E14.m1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.1"></times><ci id="S4.E14.m1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E14.m1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3">𝑐</ci><ci id="S4.E14.m1.1.1.1.1.3.4.cmml" xref="S4.E14.m1.1.1.1.1.3.4">𝑜</ci><ci id="S4.E14.m1.1.1.1.1.3.5.cmml" xref="S4.E14.m1.1.1.1.1.3.5">𝑟</ci><ci id="S4.E14.m1.1.1.1.1.3.6.cmml" xref="S4.E14.m1.1.1.1.1.3.6">𝑒</ci></apply><apply id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><times id="S4.E14.m1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2"></times><ci id="S4.E14.m1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3">𝜎</ci><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><times id="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3"><mtext id="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3">ℋ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\displaystyle score=\sigma(\text{MLP}(\mathbf{h}_{\mathcal{H}})),</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">italic_s italic_c italic_o italic_r italic_e = italic_σ ( MLP ( bold_h start_POSTSUBSCRIPT caligraphic_H end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\hat{m}_{i}=\begin{cases}1,&amp;score_{m_{i}}\geq\delta\\
0,&amp;score_{m_{i}}&lt;\delta\end{cases}." class="ltx_Math" display="block" id="S4.E15.m1.5"><semantics id="S4.E15.m1.5a"><mrow id="S4.E15.m1.5.5.1" xref="S4.E15.m1.5.5.1.1.cmml"><mrow id="S4.E15.m1.5.5.1.1" xref="S4.E15.m1.5.5.1.1.cmml"><msub id="S4.E15.m1.5.5.1.1.2" xref="S4.E15.m1.5.5.1.1.2.cmml"><mover accent="true" id="S4.E15.m1.5.5.1.1.2.2" xref="S4.E15.m1.5.5.1.1.2.2.cmml"><mi id="S4.E15.m1.5.5.1.1.2.2.2" xref="S4.E15.m1.5.5.1.1.2.2.2.cmml">m</mi><mo id="S4.E15.m1.5.5.1.1.2.2.1" xref="S4.E15.m1.5.5.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E15.m1.5.5.1.1.2.3" xref="S4.E15.m1.5.5.1.1.2.3.cmml">i</mi></msub><mo id="S4.E15.m1.5.5.1.1.1" xref="S4.E15.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E15.m1.4.4" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mo id="S4.E15.m1.4.4.5" xref="S4.E15.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E15.m1.4.4.4" rowspacing="0pt" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mtr id="S4.E15.m1.4.4.4a" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E15.m1.4.4.4b" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mn id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S4.E15.m1.1.1.1.1.1.1.3.1" xref="S4.E15.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E15.m1.4.4.4c" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E15.m1.2.2.2.2.2.1" xref="S4.E15.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E15.m1.2.2.2.2.2.1.2" xref="S4.E15.m1.2.2.2.2.2.1.2.cmml"><mi id="S4.E15.m1.2.2.2.2.2.1.2.2" xref="S4.E15.m1.2.2.2.2.2.1.2.2.cmml">s</mi><mo id="S4.E15.m1.2.2.2.2.2.1.2.1" xref="S4.E15.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.2.2.2.2.2.1.2.3" xref="S4.E15.m1.2.2.2.2.2.1.2.3.cmml">c</mi><mo id="S4.E15.m1.2.2.2.2.2.1.2.1a" xref="S4.E15.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.2.2.2.2.2.1.2.4" xref="S4.E15.m1.2.2.2.2.2.1.2.4.cmml">o</mi><mo id="S4.E15.m1.2.2.2.2.2.1.2.1b" xref="S4.E15.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.2.2.2.2.2.1.2.5" xref="S4.E15.m1.2.2.2.2.2.1.2.5.cmml">r</mi><mo id="S4.E15.m1.2.2.2.2.2.1.2.1c" xref="S4.E15.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><msub id="S4.E15.m1.2.2.2.2.2.1.2.6" xref="S4.E15.m1.2.2.2.2.2.1.2.6.cmml"><mi id="S4.E15.m1.2.2.2.2.2.1.2.6.2" xref="S4.E15.m1.2.2.2.2.2.1.2.6.2.cmml">e</mi><msub id="S4.E15.m1.2.2.2.2.2.1.2.6.3" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3.cmml"><mi id="S4.E15.m1.2.2.2.2.2.1.2.6.3.2" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3.2.cmml">m</mi><mi id="S4.E15.m1.2.2.2.2.2.1.2.6.3.3" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3.3.cmml">i</mi></msub></msub></mrow><mo id="S4.E15.m1.2.2.2.2.2.1.1" xref="S4.E15.m1.2.2.2.2.2.1.1.cmml">≥</mo><mi id="S4.E15.m1.2.2.2.2.2.1.3" xref="S4.E15.m1.2.2.2.2.2.1.3.cmml">δ</mi></mrow></mtd></mtr><mtr id="S4.E15.m1.4.4.4d" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E15.m1.4.4.4e" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E15.m1.3.3.3.3.1.1.3" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mn id="S4.E15.m1.3.3.3.3.1.1.1" xref="S4.E15.m1.3.3.3.3.1.1.1.cmml">0</mn><mo id="S4.E15.m1.3.3.3.3.1.1.3.1" xref="S4.E15.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E15.m1.4.4.4f" xref="S4.E15.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E15.m1.4.4.4.4.2.1" xref="S4.E15.m1.4.4.4.4.2.1.cmml"><mrow id="S4.E15.m1.4.4.4.4.2.1.2" xref="S4.E15.m1.4.4.4.4.2.1.2.cmml"><mi id="S4.E15.m1.4.4.4.4.2.1.2.2" xref="S4.E15.m1.4.4.4.4.2.1.2.2.cmml">s</mi><mo id="S4.E15.m1.4.4.4.4.2.1.2.1" xref="S4.E15.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.4.4.4.4.2.1.2.3" xref="S4.E15.m1.4.4.4.4.2.1.2.3.cmml">c</mi><mo id="S4.E15.m1.4.4.4.4.2.1.2.1a" xref="S4.E15.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.4.4.4.4.2.1.2.4" xref="S4.E15.m1.4.4.4.4.2.1.2.4.cmml">o</mi><mo id="S4.E15.m1.4.4.4.4.2.1.2.1b" xref="S4.E15.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.4.4.4.4.2.1.2.5" xref="S4.E15.m1.4.4.4.4.2.1.2.5.cmml">r</mi><mo id="S4.E15.m1.4.4.4.4.2.1.2.1c" xref="S4.E15.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><msub id="S4.E15.m1.4.4.4.4.2.1.2.6" xref="S4.E15.m1.4.4.4.4.2.1.2.6.cmml"><mi id="S4.E15.m1.4.4.4.4.2.1.2.6.2" xref="S4.E15.m1.4.4.4.4.2.1.2.6.2.cmml">e</mi><msub id="S4.E15.m1.4.4.4.4.2.1.2.6.3" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3.cmml"><mi id="S4.E15.m1.4.4.4.4.2.1.2.6.3.2" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3.2.cmml">m</mi><mi id="S4.E15.m1.4.4.4.4.2.1.2.6.3.3" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3.3.cmml">i</mi></msub></msub></mrow><mo id="S4.E15.m1.4.4.4.4.2.1.1" xref="S4.E15.m1.4.4.4.4.2.1.1.cmml">&lt;</mo><mi id="S4.E15.m1.4.4.4.4.2.1.3" xref="S4.E15.m1.4.4.4.4.2.1.3.cmml">δ</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo id="S4.E15.m1.5.5.1.2" lspace="0em" xref="S4.E15.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.5b"><apply id="S4.E15.m1.5.5.1.1.cmml" xref="S4.E15.m1.5.5.1"><eq id="S4.E15.m1.5.5.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1"></eq><apply id="S4.E15.m1.5.5.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.2.1.cmml" xref="S4.E15.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E15.m1.5.5.1.1.2.2.cmml" xref="S4.E15.m1.5.5.1.1.2.2"><ci id="S4.E15.m1.5.5.1.1.2.2.1.cmml" xref="S4.E15.m1.5.5.1.1.2.2.1">^</ci><ci id="S4.E15.m1.5.5.1.1.2.2.2.cmml" xref="S4.E15.m1.5.5.1.1.2.2.2">𝑚</ci></apply><ci id="S4.E15.m1.5.5.1.1.2.3.cmml" xref="S4.E15.m1.5.5.1.1.2.3">𝑖</ci></apply><apply id="S4.E15.m1.5.5.1.1.3.1.cmml" xref="S4.E15.m1.4.4"><csymbol cd="latexml" id="S4.E15.m1.5.5.1.1.3.1.1.cmml" xref="S4.E15.m1.4.4.5">cases</csymbol><cn id="S4.E15.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.1.1.1">1</cn><apply id="S4.E15.m1.2.2.2.2.2.1.cmml" xref="S4.E15.m1.2.2.2.2.2.1"><geq id="S4.E15.m1.2.2.2.2.2.1.1.cmml" xref="S4.E15.m1.2.2.2.2.2.1.1"></geq><apply id="S4.E15.m1.2.2.2.2.2.1.2.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2"><times id="S4.E15.m1.2.2.2.2.2.1.2.1.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.1"></times><ci id="S4.E15.m1.2.2.2.2.2.1.2.2.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.2">𝑠</ci><ci id="S4.E15.m1.2.2.2.2.2.1.2.3.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.3">𝑐</ci><ci id="S4.E15.m1.2.2.2.2.2.1.2.4.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.4">𝑜</ci><ci id="S4.E15.m1.2.2.2.2.2.1.2.5.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.5">𝑟</ci><apply id="S4.E15.m1.2.2.2.2.2.1.2.6.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.2.1.2.6.1.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.2.1.2.6.2.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6.2">𝑒</ci><apply id="S4.E15.m1.2.2.2.2.2.1.2.6.3.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.2.1.2.6.3.1.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.2.1.2.6.3.2.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3.2">𝑚</ci><ci id="S4.E15.m1.2.2.2.2.2.1.2.6.3.3.cmml" xref="S4.E15.m1.2.2.2.2.2.1.2.6.3.3">𝑖</ci></apply></apply></apply><ci id="S4.E15.m1.2.2.2.2.2.1.3.cmml" xref="S4.E15.m1.2.2.2.2.2.1.3">𝛿</ci></apply><cn id="S4.E15.m1.3.3.3.3.1.1.1.cmml" type="integer" xref="S4.E15.m1.3.3.3.3.1.1.1">0</cn><apply id="S4.E15.m1.4.4.4.4.2.1.cmml" xref="S4.E15.m1.4.4.4.4.2.1"><lt id="S4.E15.m1.4.4.4.4.2.1.1.cmml" xref="S4.E15.m1.4.4.4.4.2.1.1"></lt><apply id="S4.E15.m1.4.4.4.4.2.1.2.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2"><times id="S4.E15.m1.4.4.4.4.2.1.2.1.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.1"></times><ci id="S4.E15.m1.4.4.4.4.2.1.2.2.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.2">𝑠</ci><ci id="S4.E15.m1.4.4.4.4.2.1.2.3.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.3">𝑐</ci><ci id="S4.E15.m1.4.4.4.4.2.1.2.4.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.4">𝑜</ci><ci id="S4.E15.m1.4.4.4.4.2.1.2.5.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.5">𝑟</ci><apply id="S4.E15.m1.4.4.4.4.2.1.2.6.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.4.2.1.2.6.1.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6">subscript</csymbol><ci id="S4.E15.m1.4.4.4.4.2.1.2.6.2.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6.2">𝑒</ci><apply id="S4.E15.m1.4.4.4.4.2.1.2.6.3.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.4.2.1.2.6.3.1.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3">subscript</csymbol><ci id="S4.E15.m1.4.4.4.4.2.1.2.6.3.2.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3.2">𝑚</ci><ci id="S4.E15.m1.4.4.4.4.2.1.2.6.3.3.cmml" xref="S4.E15.m1.4.4.4.4.2.1.2.6.3.3">𝑖</ci></apply></apply></apply><ci id="S4.E15.m1.4.4.4.4.2.1.3.cmml" xref="S4.E15.m1.4.4.4.4.2.1.3">𝛿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.5c">\displaystyle\hat{m}_{i}=\begin{cases}1,&amp;score_{m_{i}}\geq\delta\\
0,&amp;score_{m_{i}}&lt;\delta\end{cases}.</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.5d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ROW start_CELL 1 , end_CELL start_CELL italic_s italic_c italic_o italic_r italic_e start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ≥ italic_δ end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL italic_s italic_c italic_o italic_r italic_e start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT &lt; italic_δ end_CELL end_ROW .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.10.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.11.2" style="font-size:90%;">The performance of each model on the test set regarding accuracy and safety. The best and the runner-up results are highlighted in bold and underlined respectively under t-tests, at the level of 95% confidence level.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.8.9.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S4.T1.8.9.1.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.9.1.1.1">
<span class="ltx_p" id="S4.T1.8.9.1.1.1.1" style="width:39.8pt;"><span class="ltx_text" id="S4.T1.8.9.1.1.1.1.1">Model</span></span>
</span>
</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="5" id="S4.T1.8.9.1.2">MIMIC-III</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="5" id="S4.T1.8.9.1.3">MIMIC-IV</th>
</tr>
<tr class="ltx_tr" id="S4.T1.8.8">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.8.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.9.1">
<span class="ltx_p" id="S4.T1.8.8.9.1.1" style="width:39.8pt;"></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.1.1.1.1">
<span class="ltx_p" id="S4.T1.1.1.1.1.1" style="width:31.3pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.2.2.1">
<span class="ltx_p" id="S4.T1.2.2.2.1.1" style="width:31.3pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S4.T1.2.2.2.1.1.m1.1"><semantics id="S4.T1.2.2.2.1.1.m1.1a"><mo id="S4.T1.2.2.2.1.1.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.1.m1.1b"><ci id="S4.T1.2.2.2.1.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.3.3.1">
<span class="ltx_p" id="S4.T1.3.3.3.1.1" style="width:31.3pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.3.3.3.1.1.m1.1"><semantics id="S4.T1.3.3.3.1.1.m1.1a"><mo id="S4.T1.3.3.3.1.1.m1.1.1" stretchy="false" xref="S4.T1.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.1.m1.1b"><ci id="S4.T1.3.3.3.1.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.4.4.4.1">
<span class="ltx_p" id="S4.T1.4.4.4.1.1" style="width:31.3pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.4.4.4.1.1.m1.1"><semantics id="S4.T1.4.4.4.1.1.m1.1a"><mo id="S4.T1.4.4.4.1.1.m1.1.1" stretchy="false" xref="S4.T1.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.1.m1.1b"><ci id="S4.T1.4.4.4.1.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.8.8.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.10.1">
<span class="ltx_p" id="S4.T1.8.8.10.1.1" style="width:35.6pt;">Avg.#Med</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.5.5.5.1">
<span class="ltx_p" id="S4.T1.5.5.5.1.1" style="width:31.3pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.5.5.5.1.1.m1.1"><semantics id="S4.T1.5.5.5.1.1.m1.1a"><mo id="S4.T1.5.5.5.1.1.m1.1.1" stretchy="false" xref="S4.T1.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.1.m1.1b"><ci id="S4.T1.5.5.5.1.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.6.6.6.1">
<span class="ltx_p" id="S4.T1.6.6.6.1.1" style="width:31.3pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S4.T1.6.6.6.1.1.m1.1"><semantics id="S4.T1.6.6.6.1.1.m1.1a"><mo id="S4.T1.6.6.6.1.1.m1.1.1" stretchy="false" xref="S4.T1.6.6.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.1.m1.1b"><ci id="S4.T1.6.6.6.1.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.7.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.7.7.7.1">
<span class="ltx_p" id="S4.T1.7.7.7.1.1" style="width:31.3pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.7.7.7.1.1.m1.1"><semantics id="S4.T1.7.7.7.1.1.m1.1a"><mo id="S4.T1.7.7.7.1.1.m1.1.1" stretchy="false" xref="S4.T1.7.7.7.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.1.m1.1b"><ci id="S4.T1.7.7.7.1.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.7.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S4.T1.8.8.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.8.1">
<span class="ltx_p" id="S4.T1.8.8.8.1.1" style="width:31.3pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S4.T1.8.8.8.1.1.m1.1"><semantics id="S4.T1.8.8.8.1.1.m1.1a"><mo id="S4.T1.8.8.8.1.1.m1.1.1" stretchy="false" xref="S4.T1.8.8.8.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.1.1.m1.1b"><ci id="S4.T1.8.8.8.1.1.m1.1.1.cmml" xref="S4.T1.8.8.8.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.8.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.8.8.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.11.1">
<span class="ltx_p" id="S4.T1.8.8.11.1.1" style="width:35.6pt;">Avg.#Med</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.8.10.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.8.10.1.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.1.1">
<span class="ltx_p" id="S4.T1.8.10.1.1.1.1" style="width:39.8pt;">LR</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.2.1">
<span class="ltx_p" id="S4.T1.8.10.1.2.1.1" style="width:31.3pt;">0.4924</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.3.1">
<span class="ltx_p" id="S4.T1.8.10.1.3.1.1" style="width:31.3pt;">0.0830</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.4.1">
<span class="ltx_p" id="S4.T1.8.10.1.4.1.1" style="width:31.3pt;">0.6490</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.5.1">
<span class="ltx_p" id="S4.T1.8.10.1.5.1.1" style="width:31.3pt;">0.7548</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.8.10.1.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.6.1">
<span class="ltx_p" id="S4.T1.8.10.1.6.1.1" style="width:35.6pt;">16.0489</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.7.1">
<span class="ltx_p" id="S4.T1.8.10.1.7.1.1" style="width:31.3pt;">0.4569</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.8.1">
<span class="ltx_p" id="S4.T1.8.10.1.8.1.1" style="width:31.3pt;">0.0783</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.9.1">
<span class="ltx_p" id="S4.T1.8.10.1.9.1.1" style="width:31.3pt;">0.6064</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.8.10.1.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.10.1">
<span class="ltx_p" id="S4.T1.8.10.1.10.1.1" style="width:31.3pt;">0.6613</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.8.10.1.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.1.11.1">
<span class="ltx_p" id="S4.T1.8.10.1.11.1.1" style="width:35.6pt;">8.5746</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.11.2">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.11.2.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.1.1">
<span class="ltx_p" id="S4.T1.8.11.2.1.1.1" style="width:39.8pt;">ECC</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.2.1">
<span class="ltx_p" id="S4.T1.8.11.2.2.1.1" style="width:31.3pt;">0.4856</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.3.1">
<span class="ltx_p" id="S4.T1.8.11.2.3.1.1" style="width:31.3pt;">0.0817</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.4.1">
<span class="ltx_p" id="S4.T1.8.11.2.4.1.1" style="width:31.3pt;">0.6438</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.5.1">
<span class="ltx_p" id="S4.T1.8.11.2.5.1.1" style="width:31.3pt;">0.7590</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.11.2.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.6.1">
<span class="ltx_p" id="S4.T1.8.11.2.6.1.1" style="width:35.6pt;">16.2578</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.7.1">
<span class="ltx_p" id="S4.T1.8.11.2.7.1.1" style="width:31.3pt;">0.4327</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.8.1">
<span class="ltx_p" id="S4.T1.8.11.2.8.1.1" style="width:31.3pt;">0.0764</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.9.1">
<span class="ltx_p" id="S4.T1.8.11.2.9.1.1" style="width:31.3pt;">0.6129</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.11.2.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.10.1">
<span class="ltx_p" id="S4.T1.8.11.2.10.1.1" style="width:31.3pt;">0.6530</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.11.2.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.11.2.11.1">
<span class="ltx_p" id="S4.T1.8.11.2.11.1.1" style="width:35.6pt;">8.7934</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.12.3">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.12.3.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.1.1">
<span class="ltx_p" id="S4.T1.8.12.3.1.1.1" style="width:39.8pt;">RETAIN</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.2.1">
<span class="ltx_p" id="S4.T1.8.12.3.2.1.1" style="width:31.3pt;">0.4871</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.3.1">
<span class="ltx_p" id="S4.T1.8.12.3.3.1.1" style="width:31.3pt;">0.0879</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.4.1">
<span class="ltx_p" id="S4.T1.8.12.3.4.1.1" style="width:31.3pt;">0.6473</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.5.1">
<span class="ltx_p" id="S4.T1.8.12.3.5.1.1" style="width:31.3pt;">0.7600</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.12.3.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.6.1">
<span class="ltx_p" id="S4.T1.8.12.3.6.1.1" style="width:35.6pt;">19.4222</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.7.1">
<span class="ltx_p" id="S4.T1.8.12.3.7.1.1" style="width:31.3pt;">0.4234</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.8.1">
<span class="ltx_p" id="S4.T1.8.12.3.8.1.1" style="width:31.3pt;">0.0936</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.9.1">
<span class="ltx_p" id="S4.T1.8.12.3.9.1.1" style="width:31.3pt;">0.5785</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.12.3.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.10.1">
<span class="ltx_p" id="S4.T1.8.12.3.10.1.1" style="width:31.3pt;">0.6801</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.12.3.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.12.3.11.1">
<span class="ltx_p" id="S4.T1.8.12.3.11.1.1" style="width:35.6pt;">10.9576</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.13.4">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.13.4.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.1.1">
<span class="ltx_p" id="S4.T1.8.13.4.1.1.1" style="width:39.8pt;">LEAP</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.2.1">
<span class="ltx_p" id="S4.T1.8.13.4.2.1.1" style="width:31.3pt;">0.4526</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.3.1">
<span class="ltx_p" id="S4.T1.8.13.4.3.1.1" style="width:31.3pt;">0.0762</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.4.1">
<span class="ltx_p" id="S4.T1.8.13.4.4.1.1" style="width:31.3pt;">0.6147</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.5.1">
<span class="ltx_p" id="S4.T1.8.13.4.5.1.1" style="width:31.3pt;">0.6555</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.13.4.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.6.1">
<span class="ltx_p" id="S4.T1.8.13.4.6.1.1" style="width:35.6pt;">18.6240</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.7.1">
<span class="ltx_p" id="S4.T1.8.13.4.7.1.1" style="width:31.3pt;">0.4254</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.8.1">
<span class="ltx_p" id="S4.T1.8.13.4.8.1.1" style="width:31.3pt;">0.0688</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.9.1">
<span class="ltx_p" id="S4.T1.8.13.4.9.1.1" style="width:31.3pt;">0.5794</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.13.4.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.10.1">
<span class="ltx_p" id="S4.T1.8.13.4.10.1.1" style="width:31.3pt;">0.6059</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.13.4.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.13.4.11.1">
<span class="ltx_p" id="S4.T1.8.13.4.11.1.1" style="width:35.6pt;">11.3606</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.14.5">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.14.5.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.1.1">
<span class="ltx_p" id="S4.T1.8.14.5.1.1.1" style="width:39.8pt;">GAMENet</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.2.1">
<span class="ltx_p" id="S4.T1.8.14.5.2.1.1" style="width:31.3pt;">0.4994</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.3.1">
<span class="ltx_p" id="S4.T1.8.14.5.3.1.1" style="width:31.3pt;">0.0890</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.4.1">
<span class="ltx_p" id="S4.T1.8.14.5.4.1.1" style="width:31.3pt;">0.6560</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.5.1">
<span class="ltx_p" id="S4.T1.8.14.5.5.1.1" style="width:31.3pt;">0.7656</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.14.5.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.6.1">
<span class="ltx_p" id="S4.T1.8.14.5.6.1.1" style="width:35.6pt;">27.7703</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.7.1">
<span class="ltx_p" id="S4.T1.8.14.5.7.1.1" style="width:31.3pt;">0.4565</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.8.1">
<span class="ltx_p" id="S4.T1.8.14.5.8.1.1" style="width:31.3pt;">0.0898</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.9.1">
<span class="ltx_p" id="S4.T1.8.14.5.9.1.1" style="width:31.3pt;">0.6103</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.14.5.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.10.1">
<span class="ltx_p" id="S4.T1.8.14.5.10.1.1" style="width:31.3pt;">0.6829</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.14.5.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.14.5.11.1">
<span class="ltx_p" id="S4.T1.8.14.5.11.1.1" style="width:35.6pt;">18.5895</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.15.6">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.15.6.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.1.1">
<span class="ltx_p" id="S4.T1.8.15.6.1.1.1" style="width:39.8pt;">SafeDrug</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.2.1">
<span class="ltx_p" id="S4.T1.8.15.6.2.1.1" style="width:31.3pt;">0.5154</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.3.1">
<span class="ltx_p" id="S4.T1.8.15.6.3.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.15.6.3.1.1.1">0.0655</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.4.1">
<span class="ltx_p" id="S4.T1.8.15.6.4.1.1" style="width:31.3pt;">0.6722</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.5.1">
<span class="ltx_p" id="S4.T1.8.15.6.5.1.1" style="width:31.3pt;">0.7627</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.15.6.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.6.1">
<span class="ltx_p" id="S4.T1.8.15.6.6.1.1" style="width:35.6pt;">19.4111</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.7.1">
<span class="ltx_p" id="S4.T1.8.15.6.7.1.1" style="width:31.3pt;">0.4487</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.8.1">
<span class="ltx_p" id="S4.T1.8.15.6.8.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.15.6.8.1.1.1">0.0604</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.9.1">
<span class="ltx_p" id="S4.T1.8.15.6.9.1.1" style="width:31.3pt;">0.6014</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.15.6.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.10.1">
<span class="ltx_p" id="S4.T1.8.15.6.10.1.1" style="width:31.3pt;">0.6948</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.15.6.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.15.6.11.1">
<span class="ltx_p" id="S4.T1.8.15.6.11.1.1" style="width:35.6pt;">13.6943</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.16.7">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.16.7.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.1.1">
<span class="ltx_p" id="S4.T1.8.16.7.1.1.1" style="width:39.8pt;">MICRON</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.2.1">
<span class="ltx_p" id="S4.T1.8.16.7.2.1.1" style="width:31.3pt;">0.5219</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.3.1">
<span class="ltx_p" id="S4.T1.8.16.7.3.1.1" style="width:31.3pt;">0.0727</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.4.1">
<span class="ltx_p" id="S4.T1.8.16.7.4.1.1" style="width:31.3pt;">0.6761</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.5.1">
<span class="ltx_p" id="S4.T1.8.16.7.5.1.1" style="width:31.3pt;">0.7489</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.16.7.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.6.1">
<span class="ltx_p" id="S4.T1.8.16.7.6.1.1" style="width:35.6pt;">19.2505</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.7.1">
<span class="ltx_p" id="S4.T1.8.16.7.7.1.1" style="width:31.3pt;">0.4640</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.8.1">
<span class="ltx_p" id="S4.T1.8.16.7.8.1.1" style="width:31.3pt;">0.0691</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.9.1">
<span class="ltx_p" id="S4.T1.8.16.7.9.1.1" style="width:31.3pt;">0.6167</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.16.7.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.10.1">
<span class="ltx_p" id="S4.T1.8.16.7.10.1.1" style="width:31.3pt;">0.6919</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.16.7.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.16.7.11.1">
<span class="ltx_p" id="S4.T1.8.16.7.11.1.1" style="width:35.6pt;">12.7701</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.17.8">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.17.8.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.1.1">
<span class="ltx_p" id="S4.T1.8.17.8.1.1.1" style="width:39.8pt;">COGNet</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.2.1">
<span class="ltx_p" id="S4.T1.8.17.8.2.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.17.8.2.1.1.1">0.5312</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.3.1">
<span class="ltx_p" id="S4.T1.8.17.8.3.1.1" style="width:31.3pt;">0.0839</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.4.1">
<span class="ltx_p" id="S4.T1.8.17.8.4.1.1" style="width:31.3pt;">0.6744</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.5.1">
<span class="ltx_p" id="S4.T1.8.17.8.5.1.1" style="width:31.3pt;">0.7708</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.17.8.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.6.1">
<span class="ltx_p" id="S4.T1.8.17.8.6.1.1" style="width:35.6pt;">27.6335</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.7.1">
<span class="ltx_p" id="S4.T1.8.17.8.7.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.17.8.7.1.1.1">0.4775</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.8.1">
<span class="ltx_p" id="S4.T1.8.17.8.8.1.1" style="width:31.3pt;">0.0911</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.9.1">
<span class="ltx_p" id="S4.T1.8.17.8.9.1.1" style="width:31.3pt;">0.6233</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.17.8.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.10.1">
<span class="ltx_p" id="S4.T1.8.17.8.10.1.1" style="width:31.3pt;">0.6524</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.17.8.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.17.8.11.1">
<span class="ltx_p" id="S4.T1.8.17.8.11.1.1" style="width:35.6pt;">18.7235</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.18.9">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T1.8.18.9.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.1.1">
<span class="ltx_p" id="S4.T1.8.18.9.1.1.1" style="width:39.8pt;">MoleRec</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.2.1">
<span class="ltx_p" id="S4.T1.8.18.9.2.1.1" style="width:31.3pt;">0.5293</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.3.1">
<span class="ltx_p" id="S4.T1.8.18.9.3.1.1" style="width:31.3pt;">0.0726</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.4.1">
<span class="ltx_p" id="S4.T1.8.18.9.4.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.18.9.4.1.1.1">0.6834</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.5.1">
<span class="ltx_p" id="S4.T1.8.18.9.5.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.18.9.5.1.1.1">0.7746</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.18.9.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.6.1">
<span class="ltx_p" id="S4.T1.8.18.9.6.1.1" style="width:35.6pt;">22.0125</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.7.1">
<span class="ltx_p" id="S4.T1.8.18.9.7.1.1" style="width:31.3pt;">0.4744</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.8.1">
<span class="ltx_p" id="S4.T1.8.18.9.8.1.1" style="width:31.3pt;">0.0722</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.9.1">
<span class="ltx_p" id="S4.T1.8.18.9.9.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.18.9.9.1.1.1">0.6262</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.8.18.9.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.10.1">
<span class="ltx_p" id="S4.T1.8.18.9.10.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.18.9.10.1.1.1">0.7124</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.8.18.9.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.18.9.11.1">
<span class="ltx_p" id="S4.T1.8.18.9.11.1.1" style="width:35.6pt;">13.4806</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.19.10">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.8.19.10.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.1.1">
<span class="ltx_p" id="S4.T1.8.19.10.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.1.1.1.1">CausalMed</span></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.2.1">
<span class="ltx_p" id="S4.T1.8.19.10.2.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.2.1.1.1">0.5389</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.3.1">
<span class="ltx_p" id="S4.T1.8.19.10.3.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.19.10.3.1.1.1">0.0709</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.4.1">
<span class="ltx_p" id="S4.T1.8.19.10.4.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.4.1.1.1">0.6916</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.5.1">
<span class="ltx_p" id="S4.T1.8.19.10.5.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.5.1.1.1">0.7826</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.8.19.10.6">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.6.1">
<span class="ltx_p" id="S4.T1.8.19.10.6.1.1" style="width:35.6pt;">20.5419</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.7.1">
<span class="ltx_p" id="S4.T1.8.19.10.7.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.7.1.1.1">0.4899</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.8.1">
<span class="ltx_p" id="S4.T1.8.19.10.8.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.19.10.8.1.1.1">0.0677</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.9">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.9.1">
<span class="ltx_p" id="S4.T1.8.19.10.9.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.9.1.1.1">0.6412</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.8.19.10.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.10.1">
<span class="ltx_p" id="S4.T1.8.19.10.10.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.8.19.10.10.1.1.1">0.7338</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.8.19.10.11">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.19.10.11.1">
<span class="ltx_p" id="S4.T1.8.19.10.11.1.1" style="width:35.6pt;">14.4295</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Model Training and Inference</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.3">Our training and inference processes share the same pipeline. In training, we optimize all learnable parameters and define the following loss functions: binary cross-entropy loss <math alttext="\mathcal{L}_{bce}" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><msub id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml"><mi id="S4.SS5.p1.1.m1.1.1.3.2" xref="S4.SS5.p1.1.m1.1.1.3.2.cmml">b</mi><mo id="S4.SS5.p1.1.m1.1.1.3.1" xref="S4.SS5.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.1.m1.1.1.3.3" xref="S4.SS5.p1.1.m1.1.1.3.3.cmml">c</mi><mo id="S4.SS5.p1.1.m1.1.1.3.1a" xref="S4.SS5.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.1.m1.1.1.3.4" xref="S4.SS5.p1.1.m1.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">ℒ</ci><apply id="S4.SS5.p1.1.m1.1.1.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3"><times id="S4.SS5.p1.1.m1.1.1.3.1.cmml" xref="S4.SS5.p1.1.m1.1.1.3.1"></times><ci id="S4.SS5.p1.1.m1.1.1.3.2.cmml" xref="S4.SS5.p1.1.m1.1.1.3.2">𝑏</ci><ci id="S4.SS5.p1.1.m1.1.1.3.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3.3">𝑐</ci><ci id="S4.SS5.p1.1.m1.1.1.3.4.cmml" xref="S4.SS5.p1.1.m1.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\mathcal{L}_{bce}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, multi-label margin loss <math alttext="\mathcal{L}_{multi}" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><msub id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p1.2.m2.1.1.2" xref="S4.SS5.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S4.SS5.p1.2.m2.1.1.3" xref="S4.SS5.p1.2.m2.1.1.3.cmml"><mi id="S4.SS5.p1.2.m2.1.1.3.2" xref="S4.SS5.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS5.p1.2.m2.1.1.3.1" xref="S4.SS5.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.2.m2.1.1.3.3" xref="S4.SS5.p1.2.m2.1.1.3.3.cmml">u</mi><mo id="S4.SS5.p1.2.m2.1.1.3.1a" xref="S4.SS5.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.2.m2.1.1.3.4" xref="S4.SS5.p1.2.m2.1.1.3.4.cmml">l</mi><mo id="S4.SS5.p1.2.m2.1.1.3.1b" xref="S4.SS5.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.2.m2.1.1.3.5" xref="S4.SS5.p1.2.m2.1.1.3.5.cmml">t</mi><mo id="S4.SS5.p1.2.m2.1.1.3.1c" xref="S4.SS5.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.2.m2.1.1.3.6" xref="S4.SS5.p1.2.m2.1.1.3.6.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><apply id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.2.m2.1.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.p1.2.m2.1.1.2.cmml" xref="S4.SS5.p1.2.m2.1.1.2">ℒ</ci><apply id="S4.SS5.p1.2.m2.1.1.3.cmml" xref="S4.SS5.p1.2.m2.1.1.3"><times id="S4.SS5.p1.2.m2.1.1.3.1.cmml" xref="S4.SS5.p1.2.m2.1.1.3.1"></times><ci id="S4.SS5.p1.2.m2.1.1.3.2.cmml" xref="S4.SS5.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS5.p1.2.m2.1.1.3.3.cmml" xref="S4.SS5.p1.2.m2.1.1.3.3">𝑢</ci><ci id="S4.SS5.p1.2.m2.1.1.3.4.cmml" xref="S4.SS5.p1.2.m2.1.1.3.4">𝑙</ci><ci id="S4.SS5.p1.2.m2.1.1.3.5.cmml" xref="S4.SS5.p1.2.m2.1.1.3.5">𝑡</ci><ci id="S4.SS5.p1.2.m2.1.1.3.6.cmml" xref="S4.SS5.p1.2.m2.1.1.3.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\mathcal{L}_{multi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and DDI loss <math alttext="\mathcal{L}_{ddi}" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><msub id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p1.3.m3.1.1.2" xref="S4.SS5.p1.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.SS5.p1.3.m3.1.1.3" xref="S4.SS5.p1.3.m3.1.1.3.cmml"><mi id="S4.SS5.p1.3.m3.1.1.3.2" xref="S4.SS5.p1.3.m3.1.1.3.2.cmml">d</mi><mo id="S4.SS5.p1.3.m3.1.1.3.1" xref="S4.SS5.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.3.m3.1.1.3.3" xref="S4.SS5.p1.3.m3.1.1.3.3.cmml">d</mi><mo id="S4.SS5.p1.3.m3.1.1.3.1a" xref="S4.SS5.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS5.p1.3.m3.1.1.3.4" xref="S4.SS5.p1.3.m3.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.3.m3.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p1.3.m3.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.2">ℒ</ci><apply id="S4.SS5.p1.3.m3.1.1.3.cmml" xref="S4.SS5.p1.3.m3.1.1.3"><times id="S4.SS5.p1.3.m3.1.1.3.1.cmml" xref="S4.SS5.p1.3.m3.1.1.3.1"></times><ci id="S4.SS5.p1.3.m3.1.1.3.2.cmml" xref="S4.SS5.p1.3.m3.1.1.3.2">𝑑</ci><ci id="S4.SS5.p1.3.m3.1.1.3.3.cmml" xref="S4.SS5.p1.3.m3.1.1.3.3">𝑑</ci><ci id="S4.SS5.p1.3.m3.1.1.3.4.cmml" xref="S4.SS5.p1.3.m3.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\mathcal{L}_{ddi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx6">
<tbody id="S4.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{bce}=-\sum_{i=1}^{|\mathcal{M}|}{m_{i}}\log({\hat{m}%
_{i}})+(1-{m_{i}})\log(1-{\hat{m}_{i}})," class="ltx_Math" display="block" id="S4.E16.m1.4"><semantics id="S4.E16.m1.4a"><mrow id="S4.E16.m1.4.4.1" xref="S4.E16.m1.4.4.1.1.cmml"><mrow id="S4.E16.m1.4.4.1.1" xref="S4.E16.m1.4.4.1.1.cmml"><msub id="S4.E16.m1.4.4.1.1.5" xref="S4.E16.m1.4.4.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.4.4.1.1.5.2" xref="S4.E16.m1.4.4.1.1.5.2.cmml">ℒ</mi><mrow id="S4.E16.m1.4.4.1.1.5.3" xref="S4.E16.m1.4.4.1.1.5.3.cmml"><mi id="S4.E16.m1.4.4.1.1.5.3.2" xref="S4.E16.m1.4.4.1.1.5.3.2.cmml">b</mi><mo id="S4.E16.m1.4.4.1.1.5.3.1" xref="S4.E16.m1.4.4.1.1.5.3.1.cmml">⁢</mo><mi id="S4.E16.m1.4.4.1.1.5.3.3" xref="S4.E16.m1.4.4.1.1.5.3.3.cmml">c</mi><mo id="S4.E16.m1.4.4.1.1.5.3.1a" xref="S4.E16.m1.4.4.1.1.5.3.1.cmml">⁢</mo><mi id="S4.E16.m1.4.4.1.1.5.3.4" xref="S4.E16.m1.4.4.1.1.5.3.4.cmml">e</mi></mrow></msub><mo id="S4.E16.m1.4.4.1.1.4" xref="S4.E16.m1.4.4.1.1.4.cmml">=</mo><mrow id="S4.E16.m1.4.4.1.1.3" xref="S4.E16.m1.4.4.1.1.3.cmml"><mrow id="S4.E16.m1.4.4.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.cmml"><mo id="S4.E16.m1.4.4.1.1.1.1a" xref="S4.E16.m1.4.4.1.1.1.1.cmml">−</mo><mrow id="S4.E16.m1.4.4.1.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.1.cmml"><munderover id="S4.E16.m1.4.4.1.1.1.1.1.2" xref="S4.E16.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S4.E16.m1.4.4.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.1" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E16.m1.1.1.1.3" xref="S4.E16.m1.1.1.1.2.cmml"><mo id="S4.E16.m1.1.1.1.3.1" stretchy="false" xref="S4.E16.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.E16.m1.1.1.1.3.2" stretchy="false" xref="S4.E16.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E16.m1.4.4.1.1.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S4.E16.m1.4.4.1.1.1.1.1.1.3" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S4.E16.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3.2.cmml">m</mi><mi id="S4.E16.m1.4.4.1.1.1.1.1.1.3.3" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.E16.m1.4.4.1.1.1.1.1.1.2" lspace="0.167em" xref="S4.E16.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E16.m1.2.2" xref="S4.E16.m1.2.2.cmml">log</mi><mo id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1a" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mo id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E16.m1.4.4.1.1.3.4" xref="S4.E16.m1.4.4.1.1.3.4.cmml">+</mo><mrow id="S4.E16.m1.4.4.1.1.3.3" xref="S4.E16.m1.4.4.1.1.3.3.cmml"><mrow id="S4.E16.m1.4.4.1.1.2.2.1.1" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.cmml"><mo id="S4.E16.m1.4.4.1.1.2.2.1.1.2" stretchy="false" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.4.4.1.1.2.2.1.1.1" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.cmml"><mn id="S4.E16.m1.4.4.1.1.2.2.1.1.1.2" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E16.m1.4.4.1.1.2.2.1.1.1.1" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.cmml"><mi id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.2" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.2.cmml">m</mi><mi id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.3" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E16.m1.4.4.1.1.2.2.1.1.3" stretchy="false" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E16.m1.4.4.1.1.3.3.3" lspace="0.167em" xref="S4.E16.m1.4.4.1.1.3.3.3.cmml">⁢</mo><mrow id="S4.E16.m1.4.4.1.1.3.3.2.1" xref="S4.E16.m1.4.4.1.1.3.3.2.2.cmml"><mi id="S4.E16.m1.3.3" xref="S4.E16.m1.3.3.cmml">log</mi><mo id="S4.E16.m1.4.4.1.1.3.3.2.1a" xref="S4.E16.m1.4.4.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S4.E16.m1.4.4.1.1.3.3.2.1.1" xref="S4.E16.m1.4.4.1.1.3.3.2.2.cmml"><mo id="S4.E16.m1.4.4.1.1.3.3.2.1.1.2" stretchy="false" xref="S4.E16.m1.4.4.1.1.3.3.2.2.cmml">(</mo><mrow id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.cmml"><mn id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.2" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.1" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.1.cmml">−</mo><msub id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.cmml"><mi id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.2" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.2.cmml">m</mi><mo id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.1" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.3" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E16.m1.4.4.1.1.3.3.2.1.1.3" stretchy="false" xref="S4.E16.m1.4.4.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E16.m1.4.4.1.2" xref="S4.E16.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.4b"><apply id="S4.E16.m1.4.4.1.1.cmml" xref="S4.E16.m1.4.4.1"><eq id="S4.E16.m1.4.4.1.1.4.cmml" xref="S4.E16.m1.4.4.1.1.4"></eq><apply id="S4.E16.m1.4.4.1.1.5.cmml" xref="S4.E16.m1.4.4.1.1.5"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.5.1.cmml" xref="S4.E16.m1.4.4.1.1.5">subscript</csymbol><ci id="S4.E16.m1.4.4.1.1.5.2.cmml" xref="S4.E16.m1.4.4.1.1.5.2">ℒ</ci><apply id="S4.E16.m1.4.4.1.1.5.3.cmml" xref="S4.E16.m1.4.4.1.1.5.3"><times id="S4.E16.m1.4.4.1.1.5.3.1.cmml" xref="S4.E16.m1.4.4.1.1.5.3.1"></times><ci id="S4.E16.m1.4.4.1.1.5.3.2.cmml" xref="S4.E16.m1.4.4.1.1.5.3.2">𝑏</ci><ci id="S4.E16.m1.4.4.1.1.5.3.3.cmml" xref="S4.E16.m1.4.4.1.1.5.3.3">𝑐</ci><ci id="S4.E16.m1.4.4.1.1.5.3.4.cmml" xref="S4.E16.m1.4.4.1.1.5.3.4">𝑒</ci></apply></apply><apply id="S4.E16.m1.4.4.1.1.3.cmml" xref="S4.E16.m1.4.4.1.1.3"><plus id="S4.E16.m1.4.4.1.1.3.4.cmml" xref="S4.E16.m1.4.4.1.1.3.4"></plus><apply id="S4.E16.m1.4.4.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1"><minus id="S4.E16.m1.4.4.1.1.1.1.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1"></minus><apply id="S4.E16.m1.4.4.1.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1"><apply id="S4.E16.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E16.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E16.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3"><eq id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E16.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E16.m1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.3"><abs id="S4.E16.m1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.3.1"></abs><ci id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1">ℳ</ci></apply></apply><apply id="S4.E16.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1"><times id="S4.E16.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S4.E16.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E16.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.E16.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E16.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1"><log id="S4.E16.m1.2.2.cmml" xref="S4.E16.m1.2.2"></log><apply id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci></apply><ci id="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E16.m1.4.4.1.1.3.3.cmml" xref="S4.E16.m1.4.4.1.1.3.3"><times id="S4.E16.m1.4.4.1.1.3.3.3.cmml" xref="S4.E16.m1.4.4.1.1.3.3.3"></times><apply id="S4.E16.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1"><minus id="S4.E16.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.1"></minus><cn id="S4.E16.m1.4.4.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.2">1</cn><apply id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.2">𝑚</ci><ci id="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E16.m1.4.4.1.1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E16.m1.4.4.1.1.3.3.2.2.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1"><log id="S4.E16.m1.3.3.cmml" xref="S4.E16.m1.3.3"></log><apply id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1"><minus id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.1.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.1"></minus><cn id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.2">1</cn><apply id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.1.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2"><ci id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.1">^</ci><ci id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.2.2">𝑚</ci></apply><ci id="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.3.cmml" xref="S4.E16.m1.4.4.1.1.3.3.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.4c">\displaystyle\mathcal{L}_{bce}=-\sum_{i=1}^{|\mathcal{M}|}{m_{i}}\log({\hat{m}%
_{i}})+(1-{m_{i}})\log(1-{\hat{m}_{i}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{multi}=\sum_{i,j:{m_{i}}=1,{m_{j}}=0}\frac{\max(0,1-%
({\hat{m}_{i}}-{\hat{m}_{j}}))}{|\mathcal{M}|}," class="ltx_Math" display="block" id="S4.E17.m1.9"><semantics id="S4.E17.m1.9a"><mrow id="S4.E17.m1.9.9.1" xref="S4.E17.m1.9.9.1.1.cmml"><mrow id="S4.E17.m1.9.9.1.1" xref="S4.E17.m1.9.9.1.1.cmml"><msub id="S4.E17.m1.9.9.1.1.2" xref="S4.E17.m1.9.9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E17.m1.9.9.1.1.2.2" xref="S4.E17.m1.9.9.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E17.m1.9.9.1.1.2.3" xref="S4.E17.m1.9.9.1.1.2.3.cmml"><mi id="S4.E17.m1.9.9.1.1.2.3.2" xref="S4.E17.m1.9.9.1.1.2.3.2.cmml">m</mi><mo id="S4.E17.m1.9.9.1.1.2.3.1" xref="S4.E17.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E17.m1.9.9.1.1.2.3.3" xref="S4.E17.m1.9.9.1.1.2.3.3.cmml">u</mi><mo id="S4.E17.m1.9.9.1.1.2.3.1a" xref="S4.E17.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E17.m1.9.9.1.1.2.3.4" xref="S4.E17.m1.9.9.1.1.2.3.4.cmml">l</mi><mo id="S4.E17.m1.9.9.1.1.2.3.1b" xref="S4.E17.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E17.m1.9.9.1.1.2.3.5" xref="S4.E17.m1.9.9.1.1.2.3.5.cmml">t</mi><mo id="S4.E17.m1.9.9.1.1.2.3.1c" xref="S4.E17.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E17.m1.9.9.1.1.2.3.6" xref="S4.E17.m1.9.9.1.1.2.3.6.cmml">i</mi></mrow></msub><mo id="S4.E17.m1.9.9.1.1.1" rspace="0.111em" xref="S4.E17.m1.9.9.1.1.1.cmml">=</mo><mrow id="S4.E17.m1.9.9.1.1.3" xref="S4.E17.m1.9.9.1.1.3.cmml"><munder id="S4.E17.m1.9.9.1.1.3.1" xref="S4.E17.m1.9.9.1.1.3.1.cmml"><mo id="S4.E17.m1.9.9.1.1.3.1.2" movablelimits="false" xref="S4.E17.m1.9.9.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E17.m1.4.4.4" xref="S4.E17.m1.4.4.4.cmml"><mrow id="S4.E17.m1.4.4.4.6.2" xref="S4.E17.m1.4.4.4.6.1.cmml"><mi id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml">i</mi><mo id="S4.E17.m1.4.4.4.6.2.1" xref="S4.E17.m1.4.4.4.6.1.cmml">,</mo><mi id="S4.E17.m1.2.2.2.2" xref="S4.E17.m1.2.2.2.2.cmml">j</mi></mrow><mo id="S4.E17.m1.4.4.4.5" lspace="0.278em" rspace="0.278em" xref="S4.E17.m1.4.4.4.5.cmml">:</mo><mrow id="S4.E17.m1.4.4.4.4.2" xref="S4.E17.m1.4.4.4.4.3.cmml"><mrow id="S4.E17.m1.3.3.3.3.1.1" xref="S4.E17.m1.3.3.3.3.1.1.cmml"><msub id="S4.E17.m1.3.3.3.3.1.1.2" xref="S4.E17.m1.3.3.3.3.1.1.2.cmml"><mi id="S4.E17.m1.3.3.3.3.1.1.2.2" xref="S4.E17.m1.3.3.3.3.1.1.2.2.cmml">m</mi><mi id="S4.E17.m1.3.3.3.3.1.1.2.3" xref="S4.E17.m1.3.3.3.3.1.1.2.3.cmml">i</mi></msub><mo id="S4.E17.m1.3.3.3.3.1.1.1" xref="S4.E17.m1.3.3.3.3.1.1.1.cmml">=</mo><mn id="S4.E17.m1.3.3.3.3.1.1.3" xref="S4.E17.m1.3.3.3.3.1.1.3.cmml">1</mn></mrow><mo id="S4.E17.m1.4.4.4.4.2.3" xref="S4.E17.m1.4.4.4.4.3a.cmml">,</mo><mrow id="S4.E17.m1.4.4.4.4.2.2" xref="S4.E17.m1.4.4.4.4.2.2.cmml"><msub id="S4.E17.m1.4.4.4.4.2.2.2" xref="S4.E17.m1.4.4.4.4.2.2.2.cmml"><mi id="S4.E17.m1.4.4.4.4.2.2.2.2" xref="S4.E17.m1.4.4.4.4.2.2.2.2.cmml">m</mi><mi id="S4.E17.m1.4.4.4.4.2.2.2.3" xref="S4.E17.m1.4.4.4.4.2.2.2.3.cmml">j</mi></msub><mo id="S4.E17.m1.4.4.4.4.2.2.1" xref="S4.E17.m1.4.4.4.4.2.2.1.cmml">=</mo><mn id="S4.E17.m1.4.4.4.4.2.2.3" xref="S4.E17.m1.4.4.4.4.2.2.3.cmml">0</mn></mrow></mrow></mrow></munder><mfrac id="S4.E17.m1.8.8" xref="S4.E17.m1.8.8.cmml"><mrow id="S4.E17.m1.7.7.3.3" xref="S4.E17.m1.7.7.3.4.cmml"><mi id="S4.E17.m1.5.5.1.1" xref="S4.E17.m1.5.5.1.1.cmml">max</mi><mo id="S4.E17.m1.7.7.3.3a" xref="S4.E17.m1.7.7.3.4.cmml">⁡</mo><mrow id="S4.E17.m1.7.7.3.3.1" xref="S4.E17.m1.7.7.3.4.cmml"><mo id="S4.E17.m1.7.7.3.3.1.2" stretchy="false" xref="S4.E17.m1.7.7.3.4.cmml">(</mo><mn id="S4.E17.m1.6.6.2.2" xref="S4.E17.m1.6.6.2.2.cmml">0</mn><mo id="S4.E17.m1.7.7.3.3.1.3" xref="S4.E17.m1.7.7.3.4.cmml">,</mo><mrow id="S4.E17.m1.7.7.3.3.1.1" xref="S4.E17.m1.7.7.3.3.1.1.cmml"><mn id="S4.E17.m1.7.7.3.3.1.1.3" xref="S4.E17.m1.7.7.3.3.1.1.3.cmml">1</mn><mo id="S4.E17.m1.7.7.3.3.1.1.2" xref="S4.E17.m1.7.7.3.3.1.1.2.cmml">−</mo><mrow id="S4.E17.m1.7.7.3.3.1.1.1.1" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.cmml"><mo id="S4.E17.m1.7.7.3.3.1.1.1.1.2" stretchy="false" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.7.7.3.3.1.1.1.1.1" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.cmml"><msub id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.cmml"><mi id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.2" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.2.cmml">m</mi><mo id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.1" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.3" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E17.m1.7.7.3.3.1.1.1.1.1.1" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.cmml"><mi id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.2" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.2.cmml">m</mi><mo id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.1" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.3" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S4.E17.m1.7.7.3.3.1.1.1.1.3" stretchy="false" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E17.m1.7.7.3.3.1.4" stretchy="false" xref="S4.E17.m1.7.7.3.4.cmml">)</mo></mrow></mrow><mrow id="S4.E17.m1.8.8.4.3" xref="S4.E17.m1.8.8.4.2.cmml"><mo id="S4.E17.m1.8.8.4.3.1" stretchy="false" xref="S4.E17.m1.8.8.4.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E17.m1.8.8.4.1" xref="S4.E17.m1.8.8.4.1.cmml">ℳ</mi><mo id="S4.E17.m1.8.8.4.3.2" stretchy="false" xref="S4.E17.m1.8.8.4.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo id="S4.E17.m1.9.9.1.2" xref="S4.E17.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.9b"><apply id="S4.E17.m1.9.9.1.1.cmml" xref="S4.E17.m1.9.9.1"><eq id="S4.E17.m1.9.9.1.1.1.cmml" xref="S4.E17.m1.9.9.1.1.1"></eq><apply id="S4.E17.m1.9.9.1.1.2.cmml" xref="S4.E17.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.9.9.1.1.2.1.cmml" xref="S4.E17.m1.9.9.1.1.2">subscript</csymbol><ci id="S4.E17.m1.9.9.1.1.2.2.cmml" xref="S4.E17.m1.9.9.1.1.2.2">ℒ</ci><apply id="S4.E17.m1.9.9.1.1.2.3.cmml" xref="S4.E17.m1.9.9.1.1.2.3"><times id="S4.E17.m1.9.9.1.1.2.3.1.cmml" xref="S4.E17.m1.9.9.1.1.2.3.1"></times><ci id="S4.E17.m1.9.9.1.1.2.3.2.cmml" xref="S4.E17.m1.9.9.1.1.2.3.2">𝑚</ci><ci id="S4.E17.m1.9.9.1.1.2.3.3.cmml" xref="S4.E17.m1.9.9.1.1.2.3.3">𝑢</ci><ci id="S4.E17.m1.9.9.1.1.2.3.4.cmml" xref="S4.E17.m1.9.9.1.1.2.3.4">𝑙</ci><ci id="S4.E17.m1.9.9.1.1.2.3.5.cmml" xref="S4.E17.m1.9.9.1.1.2.3.5">𝑡</ci><ci id="S4.E17.m1.9.9.1.1.2.3.6.cmml" xref="S4.E17.m1.9.9.1.1.2.3.6">𝑖</ci></apply></apply><apply id="S4.E17.m1.9.9.1.1.3.cmml" xref="S4.E17.m1.9.9.1.1.3"><apply id="S4.E17.m1.9.9.1.1.3.1.cmml" xref="S4.E17.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S4.E17.m1.9.9.1.1.3.1.1.cmml" xref="S4.E17.m1.9.9.1.1.3.1">subscript</csymbol><sum id="S4.E17.m1.9.9.1.1.3.1.2.cmml" xref="S4.E17.m1.9.9.1.1.3.1.2"></sum><apply id="S4.E17.m1.4.4.4.cmml" xref="S4.E17.m1.4.4.4"><ci id="S4.E17.m1.4.4.4.5.cmml" xref="S4.E17.m1.4.4.4.5">:</ci><list id="S4.E17.m1.4.4.4.6.1.cmml" xref="S4.E17.m1.4.4.4.6.2"><ci id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1">𝑖</ci><ci id="S4.E17.m1.2.2.2.2.cmml" xref="S4.E17.m1.2.2.2.2">𝑗</ci></list><apply id="S4.E17.m1.4.4.4.4.3.cmml" xref="S4.E17.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S4.E17.m1.4.4.4.4.3a.cmml" xref="S4.E17.m1.4.4.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E17.m1.3.3.3.3.1.1.cmml" xref="S4.E17.m1.3.3.3.3.1.1"><eq id="S4.E17.m1.3.3.3.3.1.1.1.cmml" xref="S4.E17.m1.3.3.3.3.1.1.1"></eq><apply id="S4.E17.m1.3.3.3.3.1.1.2.cmml" xref="S4.E17.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.3.3.1.1.2.1.cmml" xref="S4.E17.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S4.E17.m1.3.3.3.3.1.1.2.2.cmml" xref="S4.E17.m1.3.3.3.3.1.1.2.2">𝑚</ci><ci id="S4.E17.m1.3.3.3.3.1.1.2.3.cmml" xref="S4.E17.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><cn id="S4.E17.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S4.E17.m1.3.3.3.3.1.1.3">1</cn></apply><apply id="S4.E17.m1.4.4.4.4.2.2.cmml" xref="S4.E17.m1.4.4.4.4.2.2"><eq id="S4.E17.m1.4.4.4.4.2.2.1.cmml" xref="S4.E17.m1.4.4.4.4.2.2.1"></eq><apply id="S4.E17.m1.4.4.4.4.2.2.2.cmml" xref="S4.E17.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E17.m1.4.4.4.4.2.2.2.1.cmml" xref="S4.E17.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S4.E17.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E17.m1.4.4.4.4.2.2.2.2">𝑚</ci><ci id="S4.E17.m1.4.4.4.4.2.2.2.3.cmml" xref="S4.E17.m1.4.4.4.4.2.2.2.3">𝑗</ci></apply><cn id="S4.E17.m1.4.4.4.4.2.2.3.cmml" type="integer" xref="S4.E17.m1.4.4.4.4.2.2.3">0</cn></apply></apply></apply></apply><apply id="S4.E17.m1.8.8.cmml" xref="S4.E17.m1.8.8"><divide id="S4.E17.m1.8.8.5.cmml" xref="S4.E17.m1.8.8"></divide><apply id="S4.E17.m1.7.7.3.4.cmml" xref="S4.E17.m1.7.7.3.3"><max id="S4.E17.m1.5.5.1.1.cmml" xref="S4.E17.m1.5.5.1.1"></max><cn id="S4.E17.m1.6.6.2.2.cmml" type="integer" xref="S4.E17.m1.6.6.2.2">0</cn><apply id="S4.E17.m1.7.7.3.3.1.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1"><minus id="S4.E17.m1.7.7.3.3.1.1.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.2"></minus><cn id="S4.E17.m1.7.7.3.3.1.1.3.cmml" type="integer" xref="S4.E17.m1.7.7.3.3.1.1.3">1</cn><apply id="S4.E17.m1.7.7.3.3.1.1.1.1.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1"><minus id="S4.E17.m1.7.7.3.3.1.1.1.1.1.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.1"></minus><apply id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2"><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.2.2">𝑚</ci></apply><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2"><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.1.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.2.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.2.2">𝑚</ci></apply><ci id="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E17.m1.7.7.3.3.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E17.m1.8.8.4.2.cmml" xref="S4.E17.m1.8.8.4.3"><abs id="S4.E17.m1.8.8.4.2.1.cmml" xref="S4.E17.m1.8.8.4.3.1"></abs><ci id="S4.E17.m1.8.8.4.1.cmml" xref="S4.E17.m1.8.8.4.1">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.9c">\displaystyle\mathcal{L}_{multi}=\sum_{i,j:{m_{i}}=1,{m_{j}}=0}\frac{\max(0,1-%
({\hat{m}_{i}}-{\hat{m}_{j}}))}{|\mathcal{M}|},</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.9d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i , italic_j : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 , italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT divide start_ARG roman_max ( 0 , 1 - ( over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG start_ARG | caligraphic_M | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{ddi}=\sum_{i=1}^{|\mathcal{M}|}\sum_{j=1}^{|\mathcal%
{M}|}\mathbf{M}^{ddi}_{ij}\cdot{\hat{m}_{i}}\cdot{\hat{m}_{j}}." class="ltx_Math" display="block" id="S4.E18.m1.3"><semantics id="S4.E18.m1.3a"><mrow id="S4.E18.m1.3.3.1" xref="S4.E18.m1.3.3.1.1.cmml"><mrow id="S4.E18.m1.3.3.1.1" xref="S4.E18.m1.3.3.1.1.cmml"><msub id="S4.E18.m1.3.3.1.1.2" xref="S4.E18.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.3.3.1.1.2.2" xref="S4.E18.m1.3.3.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E18.m1.3.3.1.1.2.3" xref="S4.E18.m1.3.3.1.1.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.2.3.2" xref="S4.E18.m1.3.3.1.1.2.3.2.cmml">d</mi><mo id="S4.E18.m1.3.3.1.1.2.3.1" xref="S4.E18.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.2.3.3" xref="S4.E18.m1.3.3.1.1.2.3.3.cmml">d</mi><mo id="S4.E18.m1.3.3.1.1.2.3.1a" xref="S4.E18.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.2.3.4" xref="S4.E18.m1.3.3.1.1.2.3.4.cmml">i</mi></mrow></msub><mo id="S4.E18.m1.3.3.1.1.1" rspace="0.111em" xref="S4.E18.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E18.m1.3.3.1.1.3" xref="S4.E18.m1.3.3.1.1.3.cmml"><munderover id="S4.E18.m1.3.3.1.1.3.1" xref="S4.E18.m1.3.3.1.1.3.1.cmml"><mo id="S4.E18.m1.3.3.1.1.3.1.2.2" movablelimits="false" rspace="0em" xref="S4.E18.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E18.m1.3.3.1.1.3.1.2.3" xref="S4.E18.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.3.1.2.3.2" xref="S4.E18.m1.3.3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E18.m1.3.3.1.1.3.1.2.3.1" xref="S4.E18.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E18.m1.3.3.1.1.3.1.2.3.3" xref="S4.E18.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E18.m1.1.1.1.3" xref="S4.E18.m1.1.1.1.2.cmml"><mo id="S4.E18.m1.1.1.1.3.1" stretchy="false" xref="S4.E18.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.E18.m1.1.1.1.3.2" stretchy="false" xref="S4.E18.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E18.m1.3.3.1.1.3.2" xref="S4.E18.m1.3.3.1.1.3.2.cmml"><munderover id="S4.E18.m1.3.3.1.1.3.2.1" xref="S4.E18.m1.3.3.1.1.3.2.1.cmml"><mo id="S4.E18.m1.3.3.1.1.3.2.1.2.2" movablelimits="false" xref="S4.E18.m1.3.3.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E18.m1.3.3.1.1.3.2.1.2.3" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.1.2.3.2" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="S4.E18.m1.3.3.1.1.3.2.1.2.3.1" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E18.m1.3.3.1.1.3.2.1.2.3.3" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E18.m1.2.2.1.3" xref="S4.E18.m1.2.2.1.2.cmml"><mo id="S4.E18.m1.2.2.1.3.1" stretchy="false" xref="S4.E18.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.2.2.1.1" xref="S4.E18.m1.2.2.1.1.cmml">ℳ</mi><mo id="S4.E18.m1.2.2.1.3.2" stretchy="false" xref="S4.E18.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E18.m1.3.3.1.1.3.2.2" xref="S4.E18.m1.3.3.1.1.3.2.2.cmml"><msubsup id="S4.E18.m1.3.3.1.1.3.2.2.2" xref="S4.E18.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.2.2" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.2.cmml">𝐌</mi><mrow id="S4.E18.m1.3.3.1.1.3.2.2.2.3" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.3.2" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.2.cmml">i</mi><mo id="S4.E18.m1.3.3.1.1.3.2.2.2.3.1" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.3.3" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.3.cmml">j</mi></mrow><mrow id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.2" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.2.cmml">d</mi><mo id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.3" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.3.cmml">d</mi><mo id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1a" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.4" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S4.E18.m1.3.3.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E18.m1.3.3.1.1.3.2.2.1.cmml">⋅</mo><msub id="S4.E18.m1.3.3.1.1.3.2.2.3" xref="S4.E18.m1.3.3.1.1.3.2.2.3.cmml"><mover accent="true" id="S4.E18.m1.3.3.1.1.3.2.2.3.2" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.2.3.2.2" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2.2.cmml">m</mi><mo id="S4.E18.m1.3.3.1.1.3.2.2.3.2.1" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2.1.cmml">^</mo></mover><mi id="S4.E18.m1.3.3.1.1.3.2.2.3.3" xref="S4.E18.m1.3.3.1.1.3.2.2.3.3.cmml">i</mi></msub><mo id="S4.E18.m1.3.3.1.1.3.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.E18.m1.3.3.1.1.3.2.2.1.cmml">⋅</mo><msub id="S4.E18.m1.3.3.1.1.3.2.2.4" xref="S4.E18.m1.3.3.1.1.3.2.2.4.cmml"><mover accent="true" id="S4.E18.m1.3.3.1.1.3.2.2.4.2" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2.2.4.2.2" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2.2.cmml">m</mi><mo id="S4.E18.m1.3.3.1.1.3.2.2.4.2.1" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2.1.cmml">^</mo></mover><mi id="S4.E18.m1.3.3.1.1.3.2.2.4.3" xref="S4.E18.m1.3.3.1.1.3.2.2.4.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><mo id="S4.E18.m1.3.3.1.2" lspace="0em" xref="S4.E18.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.3b"><apply id="S4.E18.m1.3.3.1.1.cmml" xref="S4.E18.m1.3.3.1"><eq id="S4.E18.m1.3.3.1.1.1.cmml" xref="S4.E18.m1.3.3.1.1.1"></eq><apply id="S4.E18.m1.3.3.1.1.2.cmml" xref="S4.E18.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.2.1.cmml" xref="S4.E18.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E18.m1.3.3.1.1.2.2.cmml" xref="S4.E18.m1.3.3.1.1.2.2">ℒ</ci><apply id="S4.E18.m1.3.3.1.1.2.3.cmml" xref="S4.E18.m1.3.3.1.1.2.3"><times id="S4.E18.m1.3.3.1.1.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.2.3.1"></times><ci id="S4.E18.m1.3.3.1.1.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.2.3.2">𝑑</ci><ci id="S4.E18.m1.3.3.1.1.2.3.3.cmml" xref="S4.E18.m1.3.3.1.1.2.3.3">𝑑</ci><ci id="S4.E18.m1.3.3.1.1.2.3.4.cmml" xref="S4.E18.m1.3.3.1.1.2.3.4">𝑖</ci></apply></apply><apply id="S4.E18.m1.3.3.1.1.3.cmml" xref="S4.E18.m1.3.3.1.1.3"><apply id="S4.E18.m1.3.3.1.1.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.1.1.cmml" xref="S4.E18.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S4.E18.m1.3.3.1.1.3.1.2.cmml" xref="S4.E18.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.1.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S4.E18.m1.3.3.1.1.3.1.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.1.2.2"></sum><apply id="S4.E18.m1.3.3.1.1.3.1.2.3.cmml" xref="S4.E18.m1.3.3.1.1.3.1.2.3"><eq id="S4.E18.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S4.E18.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E18.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E18.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.E18.m1.1.1.1.2.cmml" xref="S4.E18.m1.1.1.1.3"><abs id="S4.E18.m1.1.1.1.2.1.cmml" xref="S4.E18.m1.1.1.1.3.1"></abs><ci id="S4.E18.m1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1">ℳ</ci></apply></apply><apply id="S4.E18.m1.3.3.1.1.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2"><apply id="S4.E18.m1.3.3.1.1.3.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.1.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1">superscript</csymbol><apply id="S4.E18.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.1.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1">subscript</csymbol><sum id="S4.E18.m1.3.3.1.1.3.2.1.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1.2.2"></sum><apply id="S4.E18.m1.3.3.1.1.3.2.1.2.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3"><eq id="S4.E18.m1.3.3.1.1.3.2.1.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.1"></eq><ci id="S4.E18.m1.3.3.1.1.3.2.1.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.2">𝑗</ci><cn id="S4.E18.m1.3.3.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S4.E18.m1.3.3.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S4.E18.m1.2.2.1.2.cmml" xref="S4.E18.m1.2.2.1.3"><abs id="S4.E18.m1.2.2.1.2.1.cmml" xref="S4.E18.m1.2.2.1.3.1"></abs><ci id="S4.E18.m1.2.2.1.1.cmml" xref="S4.E18.m1.2.2.1.1">ℳ</ci></apply></apply><apply id="S4.E18.m1.3.3.1.1.3.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2"><ci id="S4.E18.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.1">⋅</ci><apply id="S4.E18.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2">subscript</csymbol><apply id="S4.E18.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.2.2.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2">superscript</csymbol><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.2">𝐌</ci><apply id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3"><times id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.1"></times><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.2">𝑑</ci><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.3">𝑑</ci><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.4.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.2.3.4">𝑖</ci></apply></apply><apply id="S4.E18.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3"><times id="S4.E18.m1.3.3.1.1.3.2.2.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.1"></times><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.2">𝑖</ci><ci id="S4.E18.m1.3.3.1.1.3.2.2.2.3.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.2.3.3">𝑗</ci></apply></apply><apply id="S4.E18.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3">subscript</csymbol><apply id="S4.E18.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2"><ci id="S4.E18.m1.3.3.1.1.3.2.2.3.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2.1">^</ci><ci id="S4.E18.m1.3.3.1.1.3.2.2.3.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3.2.2">𝑚</ci></apply><ci id="S4.E18.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.3.3">𝑖</ci></apply><apply id="S4.E18.m1.3.3.1.1.3.2.2.4.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.3.2.2.4.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4">subscript</csymbol><apply id="S4.E18.m1.3.3.1.1.3.2.2.4.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2"><ci id="S4.E18.m1.3.3.1.1.3.2.2.4.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2.1">^</ci><ci id="S4.E18.m1.3.3.1.1.3.2.2.4.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4.2.2">𝑚</ci></apply><ci id="S4.E18.m1.3.3.1.1.3.2.2.4.3.cmml" xref="S4.E18.m1.3.3.1.1.3.2.2.4.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.3c">\displaystyle\mathcal{L}_{ddi}=\sum_{i=1}^{|\mathcal{M}|}\sum_{j=1}^{|\mathcal%
{M}|}\mathbf{M}^{ddi}_{ij}\cdot{\hat{m}_{i}}\cdot{\hat{m}_{j}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ⋅ over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.5">We adopt a loss aggregation approach that aligns with the methodology used in prior work <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib40" title="">2023</a>)</cite>.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S6.EGx7">
<tbody id="S4.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(19)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}=\alpha(\beta\mathcal{L}_{bce}+(1-\beta)\mathcal{L}_{%
multi})+(1-\alpha)\mathcal{L}_{ddi}," class="ltx_Math" display="block" id="S4.E19.m1.1"><semantics id="S4.E19.m1.1a"><mrow id="S4.E19.m1.1.1.1" xref="S4.E19.m1.1.1.1.1.cmml"><mrow id="S4.E19.m1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E19.m1.1.1.1.1.4" xref="S4.E19.m1.1.1.1.1.4.cmml">ℒ</mi><mo id="S4.E19.m1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E19.m1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.2.cmml"><mrow id="S4.E19.m1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.3.cmml">α</mi><mo id="S4.E19.m1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">b</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">c</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1a" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.4" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml">e</mi></mrow></msub></mrow><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">u</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">t</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1c" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.6" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.6.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.1.1.1.1.2.3" xref="S4.E19.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="S4.E19.m1.1.1.1.1.2.2" xref="S4.E19.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E19.m1.1.1.1.1.2.2.1.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.1.1.1.1.2.2.1.1.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.cmml"><mn id="S4.E19.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mi id="S4.E19.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.3.cmml">α</mi></mrow><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E19.m1.1.1.1.1.2.2.2" xref="S4.E19.m1.1.1.1.1.2.2.2.cmml">⁢</mo><msub id="S4.E19.m1.1.1.1.1.2.2.3" xref="S4.E19.m1.1.1.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E19.m1.1.1.1.1.2.2.3.2" xref="S4.E19.m1.1.1.1.1.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E19.m1.1.1.1.1.2.2.3.3" xref="S4.E19.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.3.3.2" xref="S4.E19.m1.1.1.1.1.2.2.3.3.2.cmml">d</mi><mo id="S4.E19.m1.1.1.1.1.2.2.3.3.1" xref="S4.E19.m1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.2.2.3.3.3" xref="S4.E19.m1.1.1.1.1.2.2.3.3.3.cmml">d</mi><mo id="S4.E19.m1.1.1.1.1.2.2.3.3.1a" xref="S4.E19.m1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.2.2.3.3.4" xref="S4.E19.m1.1.1.1.1.2.2.3.3.4.cmml">i</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E19.m1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.1b"><apply id="S4.E19.m1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1"><eq id="S4.E19.m1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.3"></eq><ci id="S4.E19.m1.1.1.1.1.4.cmml" xref="S4.E19.m1.1.1.1.1.4">ℒ</ci><apply id="S4.E19.m1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.2"><plus id="S4.E19.m1.1.1.1.1.2.3.cmml" xref="S4.E19.m1.1.1.1.1.2.3"></plus><apply id="S4.E19.m1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1"><times id="S4.E19.m1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.2"></times><ci id="S4.E19.m1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3">𝛼</ci><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1"><plus id="S4.E19.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.2"></plus><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.2">ℒ</ci><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑏</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑐</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.3.3.3.4">𝑒</ci></apply></apply></apply><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑢</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.5">𝑡</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.6">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E19.m1.1.1.1.1.2.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2"><times id="S4.E19.m1.1.1.1.1.2.2.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.2"></times><apply id="S4.E19.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1"><minus id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1"></minus><cn id="S4.E19.m1.1.1.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.2">1</cn><ci id="S4.E19.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.3">𝛼</ci></apply><apply id="S4.E19.m1.1.1.1.1.2.2.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E19.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.2">ℒ</ci><apply id="S4.E19.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3"><times id="S4.E19.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.1"></times><ci id="S4.E19.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.2">𝑑</ci><ci id="S4.E19.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.3">𝑑</ci><ci id="S4.E19.m1.1.1.1.1.2.2.3.3.4.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.4">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.1c">\displaystyle\mathcal{L}=\alpha(\beta\mathcal{L}_{bce}+(1-\beta)\mathcal{L}_{%
multi})+(1-\alpha)\mathcal{L}_{ddi},</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.1d">caligraphic_L = italic_α ( italic_β caligraphic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT + ( 1 - italic_β ) caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_α ) caligraphic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(20)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\alpha=\begin{cases}1,&amp;\text{DDI rate}\leq\gamma\\
\max\{0,1-\frac{\text{DDI rate}-\gamma}{kp}\},&amp;\text{DDI rate}&gt;\gamma\end{%
cases}," class="ltx_Math" display="block" id="S4.E20.m1.5"><semantics id="S4.E20.m1.5a"><mrow id="S4.E20.m1.5.5.1" xref="S4.E20.m1.5.5.1.1.cmml"><mrow id="S4.E20.m1.5.5.1.1" xref="S4.E20.m1.5.5.1.1.cmml"><mi id="S4.E20.m1.5.5.1.1.2" xref="S4.E20.m1.5.5.1.1.2.cmml">α</mi><mo id="S4.E20.m1.5.5.1.1.1" xref="S4.E20.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E20.m1.4.4" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mo id="S4.E20.m1.4.4.5" xref="S4.E20.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E20.m1.4.4.4" rowspacing="0pt" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mtr id="S4.E20.m1.4.4.4a" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E20.m1.4.4.4b" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E20.m1.1.1.1.1.1.1.3" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mn id="S4.E20.m1.1.1.1.1.1.1.1" xref="S4.E20.m1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S4.E20.m1.1.1.1.1.1.1.3.1" xref="S4.E20.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E20.m1.4.4.4c" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E20.m1.2.2.2.2.2.1" xref="S4.E20.m1.2.2.2.2.2.1.cmml"><mtext id="S4.E20.m1.2.2.2.2.2.1.2" xref="S4.E20.m1.2.2.2.2.2.1.2a.cmml">DDI rate</mtext><mo id="S4.E20.m1.2.2.2.2.2.1.1" xref="S4.E20.m1.2.2.2.2.2.1.1.cmml">≤</mo><mi id="S4.E20.m1.2.2.2.2.2.1.3" xref="S4.E20.m1.2.2.2.2.2.1.3.cmml">γ</mi></mrow></mtd></mtr><mtr id="S4.E20.m1.4.4.4d" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E20.m1.4.4.4e" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E20.m1.3.3.3.3.1.1.3" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E20.m1.3.3.3.3.1.1.3.1.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml"><mi id="S4.E20.m1.3.3.3.3.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.1.cmml">max</mi><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1a" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml">⁡</mo><mrow id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml"><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.2" stretchy="false" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml">{</mo><mn id="S4.E20.m1.3.3.3.3.1.1.2" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml">0</mn><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.3" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml">,</mo><mrow id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.cmml"><mn id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.cmml">1</mn><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="false" id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.cmml"><mfrac id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3a" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.cmml"><mrow id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.cmml"><mtext id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2a.cmml">DDI rate</mtext><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.1.cmml">−</mo><mi id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.3" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.3.cmml">γ</mi></mrow><mrow id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.cmml"><mi id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.2" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.1" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.3" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.3.cmml">p</mi></mrow></mfrac></mstyle></mrow><mo id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.4" stretchy="false" xref="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml">}</mo></mrow></mrow><mo id="S4.E20.m1.3.3.3.3.1.1.3.2" xref="S4.E20.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E20.m1.4.4.4f" xref="S4.E20.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E20.m1.4.4.4.4.2.1" xref="S4.E20.m1.4.4.4.4.2.1.cmml"><mtext id="S4.E20.m1.4.4.4.4.2.1.2" xref="S4.E20.m1.4.4.4.4.2.1.2a.cmml">DDI rate</mtext><mo id="S4.E20.m1.4.4.4.4.2.1.1" xref="S4.E20.m1.4.4.4.4.2.1.1.cmml">&gt;</mo><mi id="S4.E20.m1.4.4.4.4.2.1.3" xref="S4.E20.m1.4.4.4.4.2.1.3.cmml">γ</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo id="S4.E20.m1.5.5.1.2" xref="S4.E20.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m1.5b"><apply id="S4.E20.m1.5.5.1.1.cmml" xref="S4.E20.m1.5.5.1"><eq id="S4.E20.m1.5.5.1.1.1.cmml" xref="S4.E20.m1.5.5.1.1.1"></eq><ci id="S4.E20.m1.5.5.1.1.2.cmml" xref="S4.E20.m1.5.5.1.1.2">𝛼</ci><apply id="S4.E20.m1.5.5.1.1.3.1.cmml" xref="S4.E20.m1.4.4"><csymbol cd="latexml" id="S4.E20.m1.5.5.1.1.3.1.1.cmml" xref="S4.E20.m1.4.4.5">cases</csymbol><cn id="S4.E20.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E20.m1.1.1.1.1.1.1.1">1</cn><apply id="S4.E20.m1.2.2.2.2.2.1.cmml" xref="S4.E20.m1.2.2.2.2.2.1"><leq id="S4.E20.m1.2.2.2.2.2.1.1.cmml" xref="S4.E20.m1.2.2.2.2.2.1.1"></leq><ci id="S4.E20.m1.2.2.2.2.2.1.2a.cmml" xref="S4.E20.m1.2.2.2.2.2.1.2"><mtext id="S4.E20.m1.2.2.2.2.2.1.2.cmml" xref="S4.E20.m1.2.2.2.2.2.1.2">DDI rate</mtext></ci><ci id="S4.E20.m1.2.2.2.2.2.1.3.cmml" xref="S4.E20.m1.2.2.2.2.2.1.3">𝛾</ci></apply><apply id="S4.E20.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1"><max id="S4.E20.m1.3.3.3.3.1.1.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.1"></max><cn id="S4.E20.m1.3.3.3.3.1.1.2.cmml" type="integer" xref="S4.E20.m1.3.3.3.3.1.1.2">0</cn><apply id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1"><minus id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.1"></minus><cn id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2.cmml" type="integer" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.2">1</cn><apply id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3"><divide id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3"></divide><apply id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2"><minus id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.1"></minus><ci id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2a.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2"><mtext id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2.cmml" mathsize="70%" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.2">DDI rate</mtext></ci><ci id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.3.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.2.3">𝛾</ci></apply><apply id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3"><times id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.1"></times><ci id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.2.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.2">𝑘</ci><ci id="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.3.cmml" xref="S4.E20.m1.3.3.3.3.1.1.3.1.1.1.1.3.3.3">𝑝</ci></apply></apply></apply></apply><apply id="S4.E20.m1.4.4.4.4.2.1.cmml" xref="S4.E20.m1.4.4.4.4.2.1"><gt id="S4.E20.m1.4.4.4.4.2.1.1.cmml" xref="S4.E20.m1.4.4.4.4.2.1.1"></gt><ci id="S4.E20.m1.4.4.4.4.2.1.2a.cmml" xref="S4.E20.m1.4.4.4.4.2.1.2"><mtext id="S4.E20.m1.4.4.4.4.2.1.2.cmml" xref="S4.E20.m1.4.4.4.4.2.1.2">DDI rate</mtext></ci><ci id="S4.E20.m1.4.4.4.4.2.1.3.cmml" xref="S4.E20.m1.4.4.4.4.2.1.3">𝛾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.5c">\displaystyle\alpha=\begin{cases}1,&amp;\text{DDI rate}\leq\gamma\\
\max\{0,1-\frac{\text{DDI rate}-\gamma}{kp}\},&amp;\text{DDI rate}&gt;\gamma\end{%
cases},</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m1.5d">italic_α = { start_ROW start_CELL 1 , end_CELL start_CELL DDI rate ≤ italic_γ end_CELL end_ROW start_ROW start_CELL roman_max { 0 , 1 - divide start_ARG DDI rate - italic_γ end_ARG start_ARG italic_k italic_p end_ARG } , end_CELL start_CELL DDI rate &gt; italic_γ end_CELL end_ROW ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS5.p2.4">where <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS5.p2.1.m1.1"><semantics id="S4.SS5.p2.1.m1.1a"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">italic_β</annotation></semantics></math> is hyperparameters, and the controllable factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS5.p2.2.m2.1"><semantics id="S4.SS5.p2.2.m2.1a"><mi id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><ci id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.2.m2.1d">italic_α</annotation></semantics></math> is relative to DDI rate, <math alttext="\gamma\in(0,1)" class="ltx_Math" display="inline" id="S4.SS5.p2.3.m3.2"><semantics id="S4.SS5.p2.3.m3.2a"><mrow id="S4.SS5.p2.3.m3.2.3" xref="S4.SS5.p2.3.m3.2.3.cmml"><mi id="S4.SS5.p2.3.m3.2.3.2" xref="S4.SS5.p2.3.m3.2.3.2.cmml">γ</mi><mo id="S4.SS5.p2.3.m3.2.3.1" xref="S4.SS5.p2.3.m3.2.3.1.cmml">∈</mo><mrow id="S4.SS5.p2.3.m3.2.3.3.2" xref="S4.SS5.p2.3.m3.2.3.3.1.cmml"><mo id="S4.SS5.p2.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS5.p2.3.m3.2.3.3.1.cmml">(</mo><mn id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml">0</mn><mo id="S4.SS5.p2.3.m3.2.3.3.2.2" xref="S4.SS5.p2.3.m3.2.3.3.1.cmml">,</mo><mn id="S4.SS5.p2.3.m3.2.2" xref="S4.SS5.p2.3.m3.2.2.cmml">1</mn><mo id="S4.SS5.p2.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS5.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.2b"><apply id="S4.SS5.p2.3.m3.2.3.cmml" xref="S4.SS5.p2.3.m3.2.3"><in id="S4.SS5.p2.3.m3.2.3.1.cmml" xref="S4.SS5.p2.3.m3.2.3.1"></in><ci id="S4.SS5.p2.3.m3.2.3.2.cmml" xref="S4.SS5.p2.3.m3.2.3.2">𝛾</ci><interval closure="open" id="S4.SS5.p2.3.m3.2.3.3.1.cmml" xref="S4.SS5.p2.3.m3.2.3.3.2"><cn id="S4.SS5.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS5.p2.3.m3.1.1">0</cn><cn id="S4.SS5.p2.3.m3.2.2.cmml" type="integer" xref="S4.SS5.p2.3.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.2c">\gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.3.m3.2d">italic_γ ∈ ( 0 , 1 )</annotation></semantics></math> is a DDI acceptance rate and <math alttext="kp" class="ltx_Math" display="inline" id="S4.SS5.p2.4.m4.1"><semantics id="S4.SS5.p2.4.m4.1a"><mrow id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml"><mi id="S4.SS5.p2.4.m4.1.1.2" xref="S4.SS5.p2.4.m4.1.1.2.cmml">k</mi><mo id="S4.SS5.p2.4.m4.1.1.1" xref="S4.SS5.p2.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p2.4.m4.1.1.3" xref="S4.SS5.p2.4.m4.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><apply id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1"><times id="S4.SS5.p2.4.m4.1.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1.1"></times><ci id="S4.SS5.p2.4.m4.1.1.2.cmml" xref="S4.SS5.p2.4.m4.1.1.2">𝑘</ci><ci id="S4.SS5.p2.4.m4.1.1.3.cmml" xref="S4.SS5.p2.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">kp</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.4.m4.1d">italic_k italic_p</annotation></semantics></math> is a correcting factor for the proportional signal.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we conduct extensive experiments aimed at answering the following key research questions (RQ):</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">RQ1</span>: Does CausalMed provide more accurate and safe recommendations than state-of-the-art medication recommendation systems?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">RQ2</span>: Can the two core modules proposed in this paper enhance the effectiveness of recommendations?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">RQ3</span>: Are the causal relationships used by CausalMed more appropriate for medication recommendations than the co-occurrence relationships used in previous medication recommendations?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">RQ4</span>: Why CausalMed can generate more personalized patient representations based on causality?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.1">RQ5</span>: Can the representation process of CausalMed be made transparent, and are its results interpretable?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experiments Setup</h3>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S5.T2.3.2" style="font-size:90%;">Statistics of the datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S5.T2.4.1.1.1">Item</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.4.1.1.2">MIMIC-III</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.4.1.1.3">MIMIC-IV</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.4.2.2.1"># patients</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.4.2.2.2">6,350</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.4.2.2.3">60,125</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T2.4.3.3.1"># clinical events</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.3.3.2">15,032</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.3.3.3">156,810</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T2.4.4.4.1"># diseases</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.4.4.2">1,958</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.4.4.3">2,000</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T2.4.5.5.1"># procedures</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.5.5.2">1,430</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.5.5.3">1,500</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T2.4.6.6.1"># medications</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.6.6.2">131</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.6.6.3">131</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T2.4.7.7.1">avg. # of visits</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.7.7.2">2.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.7.7.3">2.61</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r" id="S5.T2.4.8.8.1">avg. # of medications</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.4.8.8.2">11.44</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.4.8.8.3">6.66</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span>Datasets</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">We verify the model performance on the MIMIC-III <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib12" title="">2016</a>)</cite> and MIMIC-IV <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib11" title="">2023</a>)</cite>.
Our methodology for data processing and evaluation mirrored that of <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib39" title="">2021b</a>)</cite>, encompassing: 1) Data preprocessing, with outcomes detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.T2" title="Table 2 ‣ 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">2</span></a>; 2) Division of datasets into training, validation, and test sets in a 4/6-1/6-1/6 ratio; 3) A sampling approach involving the extraction of test data from the test set via ten rounds of bootstrap sampling.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">1)<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p1.1.1">Jaccard</span>: measures the overlap between predicted and actual sets, indicating similarity;
2) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p1.1.2">DDI-rate</span>: Assesses safety by indicating the potential for harmful medication interactions. A lower value signifies a safer medication combination;
3)<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p1.1.3">F1-Score</span>: Balances precision and recall, a generic evaluation metric for recommendation tasks;
4)Precision-Recall AUC (<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p1.1.4">PRAUC</span>): Represents the model’s ability to distinguish between classes across various thresholds.
5)<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p1.1.5">Avg.#Med</span>: Reflects the average number of medications recommended per clinical visit and is used for reference only, not indicative of the recommendation system’s overall quality.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.10.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S5.T3.11.2" style="font-size:90%;">The performance of multiple variants of CausalMed on evaluation metrics. The best and the runner-up results are highlighted in bold and underlined respectively under t-tests, at the level of 95% confidence level.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.8.9.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S5.T3.8.9.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.9.1.1.1">
<span class="ltx_p" id="S5.T3.8.9.1.1.1.1" style="width:85.4pt;"><span class="ltx_text" id="S5.T3.8.9.1.1.1.1.1">Model</span></span>
</span>
</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.T3.8.9.1.2">MIMIC-III</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.T3.8.9.1.3">MIMIC-IV</th>
</tr>
<tr class="ltx_tr" id="S5.T3.8.8">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S5.T3.8.8.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.8.9.1">
<span class="ltx_p" id="S5.T3.8.8.9.1.1" style="width:85.4pt;"></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.1.1.1">
<span class="ltx_p" id="S5.T3.1.1.1.1.1" style="width:37.0pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.1.1.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.1.1.m1.1a"><mo id="S5.T3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T3.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.2.2.2.1">
<span class="ltx_p" id="S5.T3.2.2.2.1.1" style="width:37.0pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T3.2.2.2.1.1.m1.1"><semantics id="S5.T3.2.2.2.1.1.m1.1a"><mo id="S5.T3.2.2.2.1.1.m1.1.1" stretchy="false" xref="S5.T3.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.1.1.m1.1b"><ci id="S5.T3.2.2.2.1.1.m1.1.1.cmml" xref="S5.T3.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.3.3.3.1">
<span class="ltx_p" id="S5.T3.3.3.3.1.1" style="width:37.0pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.3.3.3.1.1.m1.1"><semantics id="S5.T3.3.3.3.1.1.m1.1a"><mo id="S5.T3.3.3.3.1.1.m1.1.1" stretchy="false" xref="S5.T3.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.1.m1.1b"><ci id="S5.T3.3.3.3.1.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.3.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.4.4.4.1">
<span class="ltx_p" id="S5.T3.4.4.4.1.1" style="width:37.0pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.4.4.4.1.1.m1.1"><semantics id="S5.T3.4.4.4.1.1.m1.1a"><mo id="S5.T3.4.4.4.1.1.m1.1.1" stretchy="false" xref="S5.T3.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.1.1.m1.1b"><ci id="S5.T3.4.4.4.1.1.m1.1.1.cmml" xref="S5.T3.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.4.4.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.5.5.5.1">
<span class="ltx_p" id="S5.T3.5.5.5.1.1" style="width:37.0pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.5.5.5.1.1.m1.1"><semantics id="S5.T3.5.5.5.1.1.m1.1a"><mo id="S5.T3.5.5.5.1.1.m1.1.1" stretchy="false" xref="S5.T3.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.1.1.m1.1b"><ci id="S5.T3.5.5.5.1.1.m1.1.1.cmml" xref="S5.T3.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.5.5.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.6.6.6.1">
<span class="ltx_p" id="S5.T3.6.6.6.1.1" style="width:37.0pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T3.6.6.6.1.1.m1.1"><semantics id="S5.T3.6.6.6.1.1.m1.1a"><mo id="S5.T3.6.6.6.1.1.m1.1.1" stretchy="false" xref="S5.T3.6.6.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.1.1.m1.1b"><ci id="S5.T3.6.6.6.1.1.m1.1.1.cmml" xref="S5.T3.6.6.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.6.6.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T3.7.7.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.7.7.7.1">
<span class="ltx_p" id="S5.T3.7.7.7.1.1" style="width:37.0pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.7.7.7.1.1.m1.1"><semantics id="S5.T3.7.7.7.1.1.m1.1a"><mo id="S5.T3.7.7.7.1.1.m1.1.1" stretchy="false" xref="S5.T3.7.7.7.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.1.1.m1.1b"><ci id="S5.T3.7.7.7.1.1.m1.1.1.cmml" xref="S5.T3.7.7.7.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.7.7.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.8.8.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.8.8.1">
<span class="ltx_p" id="S5.T3.8.8.8.1.1" style="width:37.0pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T3.8.8.8.1.1.m1.1"><semantics id="S5.T3.8.8.8.1.1.m1.1a"><mo id="S5.T3.8.8.8.1.1.m1.1.1" stretchy="false" xref="S5.T3.8.8.8.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.1.1.m1.1b"><ci id="S5.T3.8.8.8.1.1.m1.1.1.cmml" xref="S5.T3.8.8.8.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.8.8.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.8.10.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.8.10.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.1.1">
<span class="ltx_p" id="S5.T3.8.10.1.1.1.1" style="width:85.4pt;">CausalMed w/o T</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.2.1">
<span class="ltx_p" id="S5.T3.8.10.1.2.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.2.1.1.1">0.5369</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.3.1">
<span class="ltx_p" id="S5.T3.8.10.1.3.1.1" style="width:37.0pt;">0.0734</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.4.1">
<span class="ltx_p" id="S5.T3.8.10.1.4.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.4.1.1.1">0.6900</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.8.10.1.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.5.1">
<span class="ltx_p" id="S5.T3.8.10.1.5.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.5.1.1.1">0.7824</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.6.1">
<span class="ltx_p" id="S5.T3.8.10.1.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.6.1.1.1">0.4878</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.7.1">
<span class="ltx_p" id="S5.T3.8.10.1.7.1.1" style="width:37.0pt;">0.0702</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.8.10.1.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.8.1">
<span class="ltx_p" id="S5.T3.8.10.1.8.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.8.1.1.1">0.6405</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.8.10.1.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.10.1.9.1">
<span class="ltx_p" id="S5.T3.8.10.1.9.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.10.1.9.1.1.1">0.7330</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.11.2">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T3.8.11.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.1.1">
<span class="ltx_p" id="S5.T3.8.11.2.1.1.1" style="width:85.4pt;">CausalMed w/o P</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.2.1">
<span class="ltx_p" id="S5.T3.8.11.2.2.1.1" style="width:37.0pt;">0.5324</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.3.1">
<span class="ltx_p" id="S5.T3.8.11.2.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.11.2.3.1.1.1">0.0731</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.4.1">
<span class="ltx_p" id="S5.T3.8.11.2.4.1.1" style="width:37.0pt;">0.6860</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T3.8.11.2.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.5.1">
<span class="ltx_p" id="S5.T3.8.11.2.5.1.1" style="width:37.0pt;">0.7745</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.6.1">
<span class="ltx_p" id="S5.T3.8.11.2.6.1.1" style="width:37.0pt;">0.4838</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.7.1">
<span class="ltx_p" id="S5.T3.8.11.2.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.11.2.7.1.1.1">0.0695</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.11.2.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.8.1">
<span class="ltx_p" id="S5.T3.8.11.2.8.1.1" style="width:37.0pt;">0.6355</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T3.8.11.2.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.11.2.9.1">
<span class="ltx_p" id="S5.T3.8.11.2.9.1.1" style="width:37.0pt;">0.7258</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.12.3">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T3.8.12.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.1.1">
<span class="ltx_p" id="S5.T3.8.12.3.1.1.1" style="width:85.4pt;">CausalMed w/o T+P</span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.2.1">
<span class="ltx_p" id="S5.T3.8.12.3.2.1.1" style="width:37.0pt;">0.5339</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.3.1">
<span class="ltx_p" id="S5.T3.8.12.3.3.1.1" style="width:37.0pt;">0.0740</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.4.1">
<span class="ltx_p" id="S5.T3.8.12.3.4.1.1" style="width:37.0pt;">0.6873</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T3.8.12.3.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.5.1">
<span class="ltx_p" id="S5.T3.8.12.3.5.1.1" style="width:37.0pt;">0.7788</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.6.1">
<span class="ltx_p" id="S5.T3.8.12.3.6.1.1" style="width:37.0pt;">0.4847</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.7.1">
<span class="ltx_p" id="S5.T3.8.12.3.7.1.1" style="width:37.0pt;">0.0711</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T3.8.12.3.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.8.1">
<span class="ltx_p" id="S5.T3.8.12.3.8.1.1" style="width:37.0pt;">0.6373</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T3.8.12.3.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.12.3.9.1">
<span class="ltx_p" id="S5.T3.8.12.3.9.1.1" style="width:37.0pt;">0.7309</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.13.4">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.8.13.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.1.1">
<span class="ltx_p" id="S5.T3.8.13.4.1.1.1" style="width:85.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.1.1.1.1">CausalMed</span></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.2.1">
<span class="ltx_p" id="S5.T3.8.13.4.2.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.2.1.1.1">0.5389</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.3.1">
<span class="ltx_p" id="S5.T3.8.13.4.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.3.1.1.1">0.0709</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.4.1">
<span class="ltx_p" id="S5.T3.8.13.4.4.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.4.1.1.1">0.6916</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.8.13.4.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.5.1">
<span class="ltx_p" id="S5.T3.8.13.4.5.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.5.1.1.1">0.7826</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.6.1">
<span class="ltx_p" id="S5.T3.8.13.4.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.6.1.1.1">0.4899</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.7.1">
<span class="ltx_p" id="S5.T3.8.13.4.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.7.1.1.1">0.0677</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.8.13.4.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.8.1">
<span class="ltx_p" id="S5.T3.8.13.4.8.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.8.1.1.1">0.6412</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.8.13.4.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.8.13.4.9.1">
<span class="ltx_p" id="S5.T3.8.13.4.9.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.8.13.4.9.1.1.1">0.7338</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3. </span>Baselines</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.1">LR</span> <cite class="ltx_cite ltx_citemacro_citep">(Indra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib10" title="">2016</a>)</cite> is a classifier for medication recommendation but doesn’t consider historical impacts on predictions.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.2">ECC</span> <cite class="ltx_cite ltx_citemacro_citep">(Read et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib21" title="">2011</a>)</cite> improves multi-label classification by splitting it into multiple binary problems.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.3">RETAIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib5" title="">2016b</a>)</cite> uses a reverse time attention mechanism to highlight influential historical events in sequential medical data.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.4">LEAP</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib42" title="">2017</a>)</cite> uses reinforcement learning to optimize medication strategies by predicting label dependencies and DDI.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.5">GAMENet</span> <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib25" title="">2019</a>)</cite> employs a graph-enhanced memory network to enhance the safety and efficacy of medication combinations.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.6">SafeDrug</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib39" title="">2021b</a>)</cite> predicts DDI by analyzing structural similarities between medication molecules.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.7">MICRON</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib38" title="">2021a</a>)</cite> uses a residual network to personalize medication recommendations by updating the latest combinations.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.8">COGNet</span> <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib36" title="">2022</a>)</cite> generates medication sets using cloning and prediction mechanisms, reintroducing significant past medications.
<span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p1.1.9">MoleRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib40" title="">2023</a>)</cite> analyzes molecular substructures to better predict medication properties and interactions.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4. </span>Implementation Details</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.7">In our study, as shown in subsection <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.SS4" title="5.4. Parameters Analysis ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">5.4</span></a>, we configure embedding dimensions at <math alttext="\text{dim}=64" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.1.m1.1"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><mrow id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml"><mtext id="S5.SS1.SSS4.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.p1.1.m1.1.1.2a.cmml">dim</mtext><mo id="S5.SS1.SSS4.p1.1.m1.1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><apply id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1"><eq id="S5.SS1.SSS4.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS4.p1.1.m1.1.1.2a.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.2"><mtext id="S5.SS1.SSS4.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.2">dim</mtext></ci><cn id="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.SSS4.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">\text{dim}=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.1.m1.1d">dim = 64</annotation></semantics></math>. The RGCN architecture consists of a 2-layer graph neural network segmented into 5 groups. For GRU and MLP, a single-layer network with a 64-dimensional hidden layer and ReLU activation is employed. The parameters, consistent with previous work <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#bib.bib40" title="">2023</a>)</cite>, include a dropout rate of 0.5, a threshold <math alttext="\delta=0.5" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.2.m2.1"><semantics id="S5.SS1.SSS4.p1.2.m2.1a"><mrow id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS4.p1.2.m2.1.1.2" xref="S5.SS1.SSS4.p1.2.m2.1.1.2.cmml">δ</mi><mo id="S5.SS1.SSS4.p1.2.m2.1.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.2.m2.1.1.3" xref="S5.SS1.SSS4.p1.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.1b"><apply id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1"><eq id="S5.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.SSS4.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1.2">𝛿</ci><cn id="S5.SS1.SSS4.p1.2.m2.1.1.3.cmml" type="float" xref="S5.SS1.SSS4.p1.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.1c">\delta=0.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.2.m2.1d">italic_δ = 0.5</annotation></semantics></math>, loss function parameters <math alttext="\beta=0.95" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.3.m3.1"><semantics id="S5.SS1.SSS4.p1.3.m3.1a"><mrow id="S5.SS1.SSS4.p1.3.m3.1.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS4.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml">β</mi><mo id="S5.SS1.SSS4.p1.3.m3.1.1.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.3.m3.1b"><apply id="S5.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1"><eq id="S5.SS1.SSS4.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.2">𝛽</ci><cn id="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml" type="float" xref="S5.SS1.SSS4.p1.3.m3.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.3.m3.1c">\beta=0.95</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.3.m3.1d">italic_β = 0.95</annotation></semantics></math>, <math alttext="kp=0.05" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.4.m4.1"><semantics id="S5.SS1.SSS4.p1.4.m4.1a"><mrow id="S5.SS1.SSS4.p1.4.m4.1.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.cmml"><mrow id="S5.SS1.SSS4.p1.4.m4.1.1.2" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.cmml"><mi id="S5.SS1.SSS4.p1.4.m4.1.1.2.2" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.2.cmml">k</mi><mo id="S5.SS1.SSS4.p1.4.m4.1.1.2.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.4.m4.1.1.2.3" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.3.cmml">p</mi></mrow><mo id="S5.SS1.SSS4.p1.4.m4.1.1.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.4.m4.1.1.3" xref="S5.SS1.SSS4.p1.4.m4.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.4.m4.1b"><apply id="S5.SS1.SSS4.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1"><eq id="S5.SS1.SSS4.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.1"></eq><apply id="S5.SS1.SSS4.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.2"><times id="S5.SS1.SSS4.p1.4.m4.1.1.2.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.1"></times><ci id="S5.SS1.SSS4.p1.4.m4.1.1.2.2.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.2">𝑘</ci><ci id="S5.SS1.SSS4.p1.4.m4.1.1.2.3.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.3">𝑝</ci></apply><cn id="S5.SS1.SSS4.p1.4.m4.1.1.3.cmml" type="float" xref="S5.SS1.SSS4.p1.4.m4.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.4.m4.1c">kp=0.05</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.4.m4.1d">italic_k italic_p = 0.05</annotation></semantics></math>, and an acceptance rate <math alttext="\gamma=0.06" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.5.m5.1"><semantics id="S5.SS1.SSS4.p1.5.m5.1a"><mrow id="S5.SS1.SSS4.p1.5.m5.1.1" xref="S5.SS1.SSS4.p1.5.m5.1.1.cmml"><mi id="S5.SS1.SSS4.p1.5.m5.1.1.2" xref="S5.SS1.SSS4.p1.5.m5.1.1.2.cmml">γ</mi><mo id="S5.SS1.SSS4.p1.5.m5.1.1.1" xref="S5.SS1.SSS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.5.m5.1.1.3" xref="S5.SS1.SSS4.p1.5.m5.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.5.m5.1b"><apply id="S5.SS1.SSS4.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1"><eq id="S5.SS1.SSS4.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1.1"></eq><ci id="S5.SS1.SSS4.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1.2">𝛾</ci><cn id="S5.SS1.SSS4.p1.5.m5.1.1.3.cmml" type="float" xref="S5.SS1.SSS4.p1.5.m5.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.5.m5.1c">\gamma=0.06</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.5.m5.1d">italic_γ = 0.06</annotation></semantics></math>. Training uses the Adam Optimizer with a learning rate of <math alttext="lr=0.0005" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.6.m6.1"><semantics id="S5.SS1.SSS4.p1.6.m6.1a"><mrow id="S5.SS1.SSS4.p1.6.m6.1.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.cmml"><mrow id="S5.SS1.SSS4.p1.6.m6.1.1.2" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.cmml"><mi id="S5.SS1.SSS4.p1.6.m6.1.1.2.2" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.2.cmml">l</mi><mo id="S5.SS1.SSS4.p1.6.m6.1.1.2.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.6.m6.1.1.2.3" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS1.SSS4.p1.6.m6.1.1.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.p1.6.m6.1.1.3" xref="S5.SS1.SSS4.p1.6.m6.1.1.3.cmml">0.0005</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.6.m6.1b"><apply id="S5.SS1.SSS4.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1"><eq id="S5.SS1.SSS4.p1.6.m6.1.1.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.1"></eq><apply id="S5.SS1.SSS4.p1.6.m6.1.1.2.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.2"><times id="S5.SS1.SSS4.p1.6.m6.1.1.2.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.1"></times><ci id="S5.SS1.SSS4.p1.6.m6.1.1.2.2.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.2">𝑙</ci><ci id="S5.SS1.SSS4.p1.6.m6.1.1.2.3.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.3">𝑟</ci></apply><cn id="S5.SS1.SSS4.p1.6.m6.1.1.3.cmml" type="float" xref="S5.SS1.SSS4.p1.6.m6.1.1.3">0.0005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.6.m6.1c">lr=0.0005</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.6.m6.1d">italic_l italic_r = 0.0005</annotation></semantics></math> and <math alttext="L2" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.7.m7.1"><semantics id="S5.SS1.SSS4.p1.7.m7.1a"><mrow id="S5.SS1.SSS4.p1.7.m7.1.1" xref="S5.SS1.SSS4.p1.7.m7.1.1.cmml"><mi id="S5.SS1.SSS4.p1.7.m7.1.1.2" xref="S5.SS1.SSS4.p1.7.m7.1.1.2.cmml">L</mi><mo id="S5.SS1.SSS4.p1.7.m7.1.1.1" xref="S5.SS1.SSS4.p1.7.m7.1.1.1.cmml">⁢</mo><mn id="S5.SS1.SSS4.p1.7.m7.1.1.3" xref="S5.SS1.SSS4.p1.7.m7.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.7.m7.1b"><apply id="S5.SS1.SSS4.p1.7.m7.1.1.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1"><times id="S5.SS1.SSS4.p1.7.m7.1.1.1.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1.1"></times><ci id="S5.SS1.SSS4.p1.7.m7.1.1.2.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1.2">𝐿</ci><cn id="S5.SS1.SSS4.p1.7.m7.1.1.3.cmml" type="integer" xref="S5.SS1.SSS4.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.7.m7.1c">L2</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.7.m7.1d">italic_L 2</annotation></semantics></math> regularization with a coefficient of 0.005. Experiments are conducted on an Ubuntu machine with 30GB memory, 12 CPUs, and a 24GB NVIDIA RTX3090 GPU.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Performance Comparison (RQ1)</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">To demonstrate the effectiveness of CausalMed, we conducted comparative experiments with several state-of-the-art baselines, and the results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S4.T1" title="Table 1 ‣ 4.4. Medication Recommendation ‣ 4. The Proposed Model: CausalMed ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">1</span></a>. In the realm of traditional machine learning-based methods, both LR and ECC demonstrate sub-optimal performance in terms of accuracy and safety.
Despite employing deep learning strategies, LEAP fails to consider patients’ longitudinal historical visit information, resulting in no significant improvement in outcomes. Although RETAIN and GAMENet effectively improve accuracy, they ignore the consideration of DDI issues. SafeDrug introduces the importance of molecules and uses molecular characterization to identify potential DDI problems, greatly improving safety. However, it fails to balance accuracy and safety, performing poorly in terms of accuracy. MICRON proposes using the residual network to learn the difference in patient status between two consecutive visits. It does not directly prescribe medication but updates the last prescription. The results are greatly improved. COGNet treats this task as a translation task and uses Transformer to further improve efficiency. However, due to insufficient consideration of safety, there are still certain flaws. MoleRec conducts further research on molecules, using the substructure of molecules to learn medication representations and recommendations, improving in multiple dimensions.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">CausalMed introduces a health state-centric framework, recommending personalized medication combinations based on causality. Experimental results demonstrate a significant enhancement of our proposed method compared to other baselines, validating the effectiveness of CausalMed.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.8.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S5.T4.9.2" style="font-size:90%;">The impact of three hyperparameters on the model. The best and the runner-up results are highlighted in bold and underlined respectively under t-tests, at the level of 95% confidence level. Parameters used in the final model are in bold.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.6.7.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S5.T4.6.7.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.7.1.1.1">
<span class="ltx_p" id="S5.T4.6.7.1.1.1.1" style="width:85.4pt;">parameter</span>
</span>
</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.T4.6.7.1.2">MIMIC-III</th>
<th class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.T4.6.7.1.3">MIMIC-IV</th>
</tr>
<tr class="ltx_tr" id="S5.T4.6.8.2">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.6.8.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.1.1">
<span class="ltx_p" id="S5.T4.6.8.2.1.1.1" style="width:85.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.8.2.1.1.1.1">Edge type</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.2.1">
<span class="ltx_p" id="S5.T4.6.8.2.2.1.1" style="width:37.0pt;">4</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.3.1">
<span class="ltx_p" id="S5.T4.6.8.2.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.8.2.3.1.1.1">5</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.4.1">
<span class="ltx_p" id="S5.T4.6.8.2.4.1.1" style="width:37.0pt;">6</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T4.6.8.2.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.5.1">
<span class="ltx_p" id="S5.T4.6.8.2.5.1.1" style="width:37.0pt;">7</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.6.1">
<span class="ltx_p" id="S5.T4.6.8.2.6.1.1" style="width:37.0pt;">4</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.7.1">
<span class="ltx_p" id="S5.T4.6.8.2.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.8.2.7.1.1.1">5</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="S5.T4.6.8.2.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.8.1">
<span class="ltx_p" id="S5.T4.6.8.2.8.1.1" style="width:37.0pt;">6</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T4.6.8.2.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.8.2.9.1">
<span class="ltx_p" id="S5.T4.6.8.2.9.1.1" style="width:37.0pt;">7</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.1.1">
<span class="ltx_p" id="S5.T4.1.1.1.1.1" style="width:85.4pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T4.1.1.1.1.1.m1.1"><semantics id="S5.T4.1.1.1.1.1.m1.1a"><mo id="S5.T4.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.2.1">
<span class="ltx_p" id="S5.T4.1.1.2.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.1.1.2.1.1.1">0.5377</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.3.1">
<span class="ltx_p" id="S5.T4.1.1.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.3.1.1.1">0.5389</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.4.1">
<span class="ltx_p" id="S5.T4.1.1.4.1.1" style="width:37.0pt;">0.5354</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.1.1.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.5.1">
<span class="ltx_p" id="S5.T4.1.1.5.1.1" style="width:37.0pt;">0.5363</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.6.1">
<span class="ltx_p" id="S5.T4.1.1.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.1.1.6.1.1.1">0.4856</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.7.1">
<span class="ltx_p" id="S5.T4.1.1.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.7.1.1.1">0.4899</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.8.1">
<span class="ltx_p" id="S5.T4.1.1.8.1.1" style="width:37.0pt;">0.4834</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.1.1.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.9.1">
<span class="ltx_p" id="S5.T4.1.1.9.1.1" style="width:37.0pt;">0.4846</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.2.2">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T4.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.1.1">
<span class="ltx_p" id="S5.T4.2.2.1.1.1" style="width:85.4pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T4.2.2.1.1.1.m1.1"><semantics id="S5.T4.2.2.1.1.1.m1.1a"><mo id="S5.T4.2.2.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.2.2.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.1.1.1.m1.1b"><ci id="S5.T4.2.2.1.1.1.m1.1.1.cmml" xref="S5.T4.2.2.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.2.1.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.2.1">
<span class="ltx_p" id="S5.T4.2.2.2.1.1" style="width:37.0pt;">0.0710</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.3.1">
<span class="ltx_p" id="S5.T4.2.2.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.2.2.3.1.1.1">0.0709</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.4.1">
<span class="ltx_p" id="S5.T4.2.2.4.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.2.2.4.1.1.1">0.0706</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T4.2.2.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.5.1">
<span class="ltx_p" id="S5.T4.2.2.5.1.1" style="width:37.0pt;">0.0713</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.6.1">
<span class="ltx_p" id="S5.T4.2.2.6.1.1" style="width:37.0pt;">0.0695</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.7.1">
<span class="ltx_p" id="S5.T4.2.2.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.2.2.7.1.1.1">0.0677</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.2.2.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.8.1">
<span class="ltx_p" id="S5.T4.2.2.8.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.2.2.8.1.1.1">0.0670</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T4.2.2.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.2.2.9.1">
<span class="ltx_p" id="S5.T4.2.2.9.1.1" style="width:37.0pt;">0.0708</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.9.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.6.9.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.1.1">
<span class="ltx_p" id="S5.T4.6.9.1.1.1.1" style="width:85.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.9.1.1.1.1.1">RGCN layer</span></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.2.1">
<span class="ltx_p" id="S5.T4.6.9.1.2.1.1" style="width:37.0pt;">1</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.3.1">
<span class="ltx_p" id="S5.T4.6.9.1.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.9.1.3.1.1.1">2</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.4.1">
<span class="ltx_p" id="S5.T4.6.9.1.4.1.1" style="width:37.0pt;">3</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.6.9.1.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.5.1">
<span class="ltx_p" id="S5.T4.6.9.1.5.1.1" style="width:37.0pt;">4</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.6.1">
<span class="ltx_p" id="S5.T4.6.9.1.6.1.1" style="width:37.0pt;">1</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.7.1">
<span class="ltx_p" id="S5.T4.6.9.1.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.9.1.7.1.1.1">2</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.9.1.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.8.1">
<span class="ltx_p" id="S5.T4.6.9.1.8.1.1" style="width:37.0pt;">3</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.6.9.1.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.9.1.9.1">
<span class="ltx_p" id="S5.T4.6.9.1.9.1.1" style="width:37.0pt;">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.3">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.1.1">
<span class="ltx_p" id="S5.T4.3.3.1.1.1" style="width:85.4pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T4.3.3.1.1.1.m1.1"><semantics id="S5.T4.3.3.1.1.1.m1.1a"><mo id="S5.T4.3.3.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.3.3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.1.1.1.m1.1b"><ci id="S5.T4.3.3.1.1.1.m1.1.1.cmml" xref="S5.T4.3.3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.3.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.2.1">
<span class="ltx_p" id="S5.T4.3.3.2.1.1" style="width:37.0pt;">0.5356</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.3.1">
<span class="ltx_p" id="S5.T4.3.3.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.3.3.3.1.1.1">0.5389</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.4.1">
<span class="ltx_p" id="S5.T4.3.3.4.1.1" style="width:37.0pt;">0.5349</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.3.3.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.5.1">
<span class="ltx_p" id="S5.T4.3.3.5.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.3.3.5.1.1.1">0.5368</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.6.1">
<span class="ltx_p" id="S5.T4.3.3.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.3.3.6.1.1.1">0.4874</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.7.1">
<span class="ltx_p" id="S5.T4.3.3.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.3.3.7.1.1.1">0.4899</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.3.3.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.8.1">
<span class="ltx_p" id="S5.T4.3.3.8.1.1" style="width:37.0pt;">0.4837</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.3.3.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.3.3.9.1">
<span class="ltx_p" id="S5.T4.3.3.9.1.1" style="width:37.0pt;">0.4854</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.4">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T4.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.1.1">
<span class="ltx_p" id="S5.T4.4.4.1.1.1" style="width:85.4pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T4.4.4.1.1.1.m1.1"><semantics id="S5.T4.4.4.1.1.1.m1.1a"><mo id="S5.T4.4.4.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.4.4.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.1.1.1.m1.1b"><ci id="S5.T4.4.4.1.1.1.m1.1.1.cmml" xref="S5.T4.4.4.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.4.1.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.2.1">
<span class="ltx_p" id="S5.T4.4.4.2.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.4.2.1.1.1">0.0707</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.3.1">
<span class="ltx_p" id="S5.T4.4.4.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.4.3.1.1.1">0.0709</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.4.1">
<span class="ltx_p" id="S5.T4.4.4.4.1.1" style="width:37.0pt;">0.0711</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T4.4.4.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.5.1">
<span class="ltx_p" id="S5.T4.4.4.5.1.1" style="width:37.0pt;">0.0724</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.6.1">
<span class="ltx_p" id="S5.T4.4.4.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.4.6.1.1.1">0.0698</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.7.1">
<span class="ltx_p" id="S5.T4.4.4.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.4.7.1.1.1">0.0677</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.4.4.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.8.1">
<span class="ltx_p" id="S5.T4.4.4.8.1.1" style="width:37.0pt;">0.0691</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T4.4.4.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.4.4.9.1">
<span class="ltx_p" id="S5.T4.4.4.9.1.1" style="width:37.0pt;">0.0701</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.10.2">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.6.10.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.1.1">
<span class="ltx_p" id="S5.T4.6.10.2.1.1.1" style="width:85.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.10.2.1.1.1.1">Embedding dim</span></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.2.1">
<span class="ltx_p" id="S5.T4.6.10.2.2.1.1" style="width:37.0pt;">32</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.3.1">
<span class="ltx_p" id="S5.T4.6.10.2.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.10.2.3.1.1.1">64</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.4.1">
<span class="ltx_p" id="S5.T4.6.10.2.4.1.1" style="width:37.0pt;">128</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.6.10.2.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.5.1">
<span class="ltx_p" id="S5.T4.6.10.2.5.1.1" style="width:37.0pt;">256</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.6.1">
<span class="ltx_p" id="S5.T4.6.10.2.6.1.1" style="width:37.0pt;">32</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.7.1">
<span class="ltx_p" id="S5.T4.6.10.2.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.10.2.7.1.1.1">64</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.6.10.2.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.8.1">
<span class="ltx_p" id="S5.T4.6.10.2.8.1.1" style="width:37.0pt;">128</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.6.10.2.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.10.2.9.1">
<span class="ltx_p" id="S5.T4.6.10.2.9.1.1" style="width:37.0pt;">256</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.5">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.1.1">
<span class="ltx_p" id="S5.T4.5.5.1.1.1" style="width:85.4pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T4.5.5.1.1.1.m1.1"><semantics id="S5.T4.5.5.1.1.1.m1.1a"><mo id="S5.T4.5.5.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.5.5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.1.1.1.m1.1b"><ci id="S5.T4.5.5.1.1.1.m1.1.1.cmml" xref="S5.T4.5.5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.5.5.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.2.1">
<span class="ltx_p" id="S5.T4.5.5.2.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.5.5.2.1.1.1">0.5371</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.3.1">
<span class="ltx_p" id="S5.T4.5.5.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.5.3.1.1.1">0.5389</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.4.1">
<span class="ltx_p" id="S5.T4.5.5.4.1.1" style="width:37.0pt;">0.5349</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.5.1">
<span class="ltx_p" id="S5.T4.5.5.5.1.1" style="width:37.0pt;">0.5311</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.6.1">
<span class="ltx_p" id="S5.T4.5.5.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.5.5.6.1.1.1">0.4862</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.7.1">
<span class="ltx_p" id="S5.T4.5.5.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.5.7.1.1.1">0.4899</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.5.5.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.8.1">
<span class="ltx_p" id="S5.T4.5.5.8.1.1" style="width:37.0pt;">0.4823</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T4.5.5.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.5.5.9.1">
<span class="ltx_p" id="S5.T4.5.5.9.1.1" style="width:37.0pt;">0.4806</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.6">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r" id="S5.T4.6.6.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.1.1">
<span class="ltx_p" id="S5.T4.6.6.1.1.1" style="width:85.4pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T4.6.6.1.1.1.m1.1"><semantics id="S5.T4.6.6.1.1.1.m1.1a"><mo id="S5.T4.6.6.1.1.1.m1.1.1" stretchy="false" xref="S5.T4.6.6.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.1.1.1.m1.1b"><ci id="S5.T4.6.6.1.1.1.m1.1.1.cmml" xref="S5.T4.6.6.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.6.6.1.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.2.1">
<span class="ltx_p" id="S5.T4.6.6.2.1.1" style="width:37.0pt;">0.0723</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.3.1">
<span class="ltx_p" id="S5.T4.6.6.3.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.6.3.1.1.1">0.0709</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.4.1">
<span class="ltx_p" id="S5.T4.6.6.4.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.6.6.4.1.1.1">0.0716</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r" id="S5.T4.6.6.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.5.1">
<span class="ltx_p" id="S5.T4.6.6.5.1.1" style="width:37.0pt;">0.0732</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.6.1">
<span class="ltx_p" id="S5.T4.6.6.6.1.1" style="width:37.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.6.6.6.1.1.1">0.0676</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.7.1">
<span class="ltx_p" id="S5.T4.6.6.7.1.1" style="width:37.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.6.6.7.1.1.1">0.0677</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.6.6.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.8.1">
<span class="ltx_p" id="S5.T4.6.6.8.1.1" style="width:37.0pt;">0.0707</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r" id="S5.T4.6.6.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.6.6.9.1">
<span class="ltx_p" id="S5.T4.6.6.9.1.1" style="width:37.0pt;">0.0723</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Ablation Study (RQ2&amp;RQ3&amp;RQ4)</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.3">To verify the effectiveness of our proposed innovations, we thoroughly evaluate three variant models. CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><divide id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></divide><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑤</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> T omits the causal effects and the refinement of the point-to-point relationships between diseases/procedures and medications. CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><divide id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></divide><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑤</ci><ci id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_w / italic_o</annotation></semantics></math> P excludes pathological relationships, thereby not identifying disease differences. CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.1"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mi id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><divide id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1"></divide><ci id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">𝑤</ci><ci id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.1d">italic_w / italic_o</annotation></semantics></math> T+P represents the model with the concurrent removal of both modules. Since the ablation versions originate from the same framework, we remove the Avg.#Med which only served as a reference.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.6">As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.T3" title="Table 3 ‣ 5.1.2. Evaluation Metrics ‣ 5.1. Experiments Setup ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">3</span></a>, the result indicates that compared to CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><divide id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></divide><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝑤</ci><ci id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_w / italic_o</annotation></semantics></math> T+P, both CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><divide id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1"></divide><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝑤</ci><ci id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_w / italic_o</annotation></semantics></math> T and CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><divide id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1"></divide><ci id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">𝑤</ci><ci id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">italic_w / italic_o</annotation></semantics></math> P show significant improvements in accuracy.
This indicates that CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.4.m4.1"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.4.m4.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><divide id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1"></divide><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">𝑤</ci><ci id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.4.m4.1d">italic_w / italic_o</annotation></semantics></math> T can identify causal point-to-point associations between diseases/surgeries and medications, providing a more accurate relational basis through the graph network process. At the same time, CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.5.m5.1"><semantics id="S5.SS3.p2.5.m5.1a"><mrow id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><mi id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.5.m5.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><divide id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1"></divide><ci id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2">𝑤</ci><ci id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.5.m5.1d">italic_w / italic_o</annotation></semantics></math> P can learn personalized representations based on the health state of the patient.
Notably, CausalMed <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p2.6.m6.1"><semantics id="S5.SS3.p2.6.m6.1a"><mrow id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.2" xref="S5.SS3.p2.6.m6.1.1.2.cmml">w</mi><mo id="S5.SS3.p2.6.m6.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.cmml">/</mo><mi id="S5.SS3.p2.6.m6.1.1.3" xref="S5.SS3.p2.6.m6.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><apply id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1"><divide id="S5.SS3.p2.6.m6.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1"></divide><ci id="S5.SS3.p2.6.m6.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.2">𝑤</ci><ci id="S5.SS3.p2.6.m6.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.6.m6.1d">italic_w / italic_o</annotation></semantics></math> P exhibits a significantly higher DDI rate. This is attributed to our modeling of inter-medication relationships during the health state learning stage, where we learn about the causal interactions between medications, thereby enhancing the safety of the outcomes.
The higher performance of CausalMed indicates that the two modules have a synergistic effect when used together, leading to a more pronounced enhancement.
Through the construction of these variant models, we can effectively verify the contributions of the different innovation points to our overall model.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Parameters Analysis</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">In this subsection, we investigate the impact of several hyperparameters. These parameters include the number of types of edges in the bipartite graph, the number of layers in the RGCN, and the embedding dimensions for each medical entity. We select four neighboring configurations and utilize the Jaccard and DDI rate to represent the accuracy and safety of the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.T4" title="Table 4 ‣ 5.2. Performance Comparison (RQ1) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">Our analysis indicates that optimal and balanced outcomes are achieved with a configuration of 5 edge types, 2 RGCN layers, and 64 dimensions. The number of edge types delineates the granularity of relationship categorization, where a limited number can result in too broad divisions, reducing the uniqueness of embeddings, and excess may lead to smaller sample sizes per category, compromising the embeddings’ representativeness. The two-layer RGCN facilitates the integration of the two node types within the graph, while additional layers could obscure the demarcation among embeddings. In terms of dimension, low dimensions risk insufficient training, and excessively high dimensions could impinge on both accuracy and safety, owing to overfitting.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Quality Study (RQ3)</h3>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_align_left ltx_img_landscape" height="399" id="S5.F5.sf1.g1" src="x6.png" width="831"/>
<figcaption class="ltx_caption ltx_align_left"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F5.sf1.3.2" style="font-size:90%;">Results of the co-occurrence relationship-based model on the training and validation sets.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_align_left ltx_img_landscape" height="399" id="S5.F5.sf2.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_align_left"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F5.sf2.3.2" style="font-size:90%;">Results of causality-based models on training and validation sets.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S5.F5.3.2" style="font-size:90%;">The performance of co-occurrence-based and causality-based methods on Jaccard.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F5.4">\Description</span></div>
</div>
</figure>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">To validate the significance of introducing causality, we compare the performance of causal relationships and co-occurrence relationships in our model.
We create a comparative model by replacing all causal relationships in CausalMed with co-occurrence relationships.
Specifically, we remove causal inference methods and replace the causal effects between diseases/procedures and medications with co-occurrence rates.
Since co-occurrence methods cannot capture the pathological relationships between medical entities, we remove an entire process of health state learning and fuse them using equal-weight addition.
The subsequent recommendation methods remain the same as the original model.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">The results for both methods on training and validation sets are illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F5" title="Figure 5 ‣ 5.5. Quality Study (RQ3) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">5</span></a>, indicating that the co-occurrence-based method is inferior to the causality-based method, whether on the training or validation set.
Firstly, the causal effects between diseases and medications modeled through causal estimation are characterized by point-to-point, offering finer details than co-occurrence rates derived from set-to-set relationships.
Furthermore, methods based on causal relationships can dynamically construct patient representation, whereas methods based on co-occurrence simply aggregate multiple entity embeddings.
Therefore, methods based on causality are more suitable for medication recommendation compared to those based on co-occurrence relationships.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6. </span>Case Study (RQ3&amp;RQ4&amp;RQ5)</h3>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="510" id="S5.F6.sf1.g1" src="x8.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F6.sf1.3.2" style="font-size:90%;">Quantitative relationships between specific diseases/adverse reactions and medications based on co-occurrence relationships.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="509" id="S5.F6.sf2.g1" src="x9.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F6.sf2.3.2" style="font-size:90%;">Quantitative relationships between specific diseases/adverse reactions and medications based on causal relationships.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_align_left ltx_img_square" height="690" id="S5.F6.sf3.g1" src="x10.png" width="831"/>
<figcaption class="ltx_caption ltx_align_left"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S5.F6.sf3.3.2" style="font-size:90%;">Prescription principles for a specific visit.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">The learning process under co-occurrence-based and causality-based approaches from the real clinical sample.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F6.4">\Description</span></div>
</div>
</figure>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.1">To more intuitively demonstrate how causality-based methods capture personalized patient representations, we employ the same co-occurrence-based comparative model as in the previous subsection and make transparent the learning process of patient representations in a real case under both approaches. This ultimately proves the rationality and interpretability of the recommended results in this study.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6" title="Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6</span></a> is derived from a clinical visit associated with gastric bleeding. Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf1" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(a)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf2" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(b)</span></a> illustrate the quantified relationships between diseases/procedures and medications, while Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf3" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(c)</span></a> provides a visualization of the learning results.</p>
</div>
<div class="ltx_para" id="S5.SS6.p2">
<p class="ltx_p" id="S5.SS6.p2.4">Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf1" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(a)</span></a> shows co-occurrence-based relationships between diseases/procedures and medications, which are ambiguous. Medications like <math alttext="m_{5}" class="ltx_Math" display="inline" id="S5.SS6.p2.1.m1.1"><semantics id="S5.SS6.p2.1.m1.1a"><msub id="S5.SS6.p2.1.m1.1.1" xref="S5.SS6.p2.1.m1.1.1.cmml"><mi id="S5.SS6.p2.1.m1.1.1.2" xref="S5.SS6.p2.1.m1.1.1.2.cmml">m</mi><mn id="S5.SS6.p2.1.m1.1.1.3" xref="S5.SS6.p2.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.m1.1b"><apply id="S5.SS6.p2.1.m1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.1.m1.1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS6.p2.1.m1.1.1.2.cmml" xref="S5.SS6.p2.1.m1.1.1.2">𝑚</ci><cn id="S5.SS6.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS6.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.m1.1c">m_{5}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.1.m1.1d">italic_m start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math> (analgesics), <math alttext="m_{6}" class="ltx_Math" display="inline" id="S5.SS6.p2.2.m2.1"><semantics id="S5.SS6.p2.2.m2.1a"><msub id="S5.SS6.p2.2.m2.1.1" xref="S5.SS6.p2.2.m2.1.1.cmml"><mi id="S5.SS6.p2.2.m2.1.1.2" xref="S5.SS6.p2.2.m2.1.1.2.cmml">m</mi><mn id="S5.SS6.p2.2.m2.1.1.3" xref="S5.SS6.p2.2.m2.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m2.1b"><apply id="S5.SS6.p2.2.m2.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.2.m2.1.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p2.2.m2.1.1.2.cmml" xref="S5.SS6.p2.2.m2.1.1.2">𝑚</ci><cn id="S5.SS6.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.SS6.p2.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m2.1c">m_{6}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.2.m2.1d">italic_m start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math> (intestinal anti-inflammatory agents), and <math alttext="m_{7}" class="ltx_Math" display="inline" id="S5.SS6.p2.3.m3.1"><semantics id="S5.SS6.p2.3.m3.1a"><msub id="S5.SS6.p2.3.m3.1.1" xref="S5.SS6.p2.3.m3.1.1.cmml"><mi id="S5.SS6.p2.3.m3.1.1.2" xref="S5.SS6.p2.3.m3.1.1.2.cmml">m</mi><mn id="S5.SS6.p2.3.m3.1.1.3" xref="S5.SS6.p2.3.m3.1.1.3.cmml">7</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.3.m3.1b"><apply id="S5.SS6.p2.3.m3.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.3.m3.1.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p2.3.m3.1.1.2.cmml" xref="S5.SS6.p2.3.m3.1.1.2">𝑚</ci><cn id="S5.SS6.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.SS6.p2.3.m3.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.3.m3.1c">m_{7}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.3.m3.1d">italic_m start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT</annotation></semantics></math> (sulfonamides) are frequently prescribed and show high co-occurrence rates with many diseases. In contrast, rare medications like <math alttext="m_{3}" class="ltx_Math" display="inline" id="S5.SS6.p2.4.m4.1"><semantics id="S5.SS6.p2.4.m4.1a"><msub id="S5.SS6.p2.4.m4.1.1" xref="S5.SS6.p2.4.m4.1.1.cmml"><mi id="S5.SS6.p2.4.m4.1.1.2" xref="S5.SS6.p2.4.m4.1.1.2.cmml">m</mi><mn id="S5.SS6.p2.4.m4.1.1.3" xref="S5.SS6.p2.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.4.m4.1b"><apply id="S5.SS6.p2.4.m4.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.4.m4.1.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS6.p2.4.m4.1.1.2.cmml" xref="S5.SS6.p2.4.m4.1.1.2">𝑚</ci><cn id="S5.SS6.p2.4.m4.1.1.3.cmml" type="integer" xref="S5.SS6.p2.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.4.m4.1c">m_{3}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.4.m4.1d">italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> (mineral supplements) have low co-occurrence rates, making specific associations difficult to determine. As depicted in the upper half of Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf3" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(c)</span></a>, this results in common medications being associated with nearly every disease/procedure while rare medications fail to establish appropriate relationships. Consequently, the model preferentially recommends common medications, overlooking rare ones, sometimes leading to positive feedback during training and amplifying the error.</p>
</div>
<div class="ltx_para" id="S5.SS6.p3">
<p class="ltx_p" id="S5.SS6.p3.5">In contrast, relationships based on causality are clearer, as shown in Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf2" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(b)</span></a>. Point-to-point causal estimation links each medication to its specific diseases or procedures, avoiding spurious correlations found in co-occurrence-based relationships. The lower half of Sub-figure <a class="ltx_ref" href="https://arxiv.org/html/2404.12228v3#S5.F6.sf3" title="In Figure 6 ‣ 5.6. Case Study (RQ3&amp;RQ4&amp;RQ5) ‣ 5. Experiments ‣ CausalMed: Causality-Based Personalized Medication Recommendation Centered on Patient Health State"><span class="ltx_text ltx_ref_tag">6(c)</span></a> shows that by analyzing differences in patients’ diseases/procedures, we create dynamic patient profiles. By integrating precise disease/procedure-medication relationships, we build more personalized patient representations. Our method learns that doctors only need to prescribe for <math alttext="d_{4}" class="ltx_Math" display="inline" id="S5.SS6.p3.1.m1.1"><semantics id="S5.SS6.p3.1.m1.1a"><msub id="S5.SS6.p3.1.m1.1.1" xref="S5.SS6.p3.1.m1.1.1.cmml"><mi id="S5.SS6.p3.1.m1.1.1.2" xref="S5.SS6.p3.1.m1.1.1.2.cmml">d</mi><mn id="S5.SS6.p3.1.m1.1.1.3" xref="S5.SS6.p3.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.1.m1.1b"><apply id="S5.SS6.p3.1.m1.1.1.cmml" xref="S5.SS6.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p3.1.m1.1.1.1.cmml" xref="S5.SS6.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS6.p3.1.m1.1.1.2.cmml" xref="S5.SS6.p3.1.m1.1.1.2">𝑑</ci><cn id="S5.SS6.p3.1.m1.1.1.3.cmml" type="integer" xref="S5.SS6.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.1.m1.1c">d_{4}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.1.m1.1d">italic_d start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> (Regional enteritis) and <math alttext="p_{1}" class="ltx_Math" display="inline" id="S5.SS6.p3.2.m2.1"><semantics id="S5.SS6.p3.2.m2.1a"><msub id="S5.SS6.p3.2.m2.1.1" xref="S5.SS6.p3.2.m2.1.1.cmml"><mi id="S5.SS6.p3.2.m2.1.1.2" xref="S5.SS6.p3.2.m2.1.1.2.cmml">p</mi><mn id="S5.SS6.p3.2.m2.1.1.3" xref="S5.SS6.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.2.m2.1b"><apply id="S5.SS6.p3.2.m2.1.1.cmml" xref="S5.SS6.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS6.p3.2.m2.1.1.1.cmml" xref="S5.SS6.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS6.p3.2.m2.1.1.2.cmml" xref="S5.SS6.p3.2.m2.1.1.2">𝑝</ci><cn id="S5.SS6.p3.2.m2.1.1.3.cmml" type="integer" xref="S5.SS6.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.2.m2.1c">p_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.2.m2.1d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> (Small bowel endoscopy) related to <math alttext="d_{1}" class="ltx_Math" display="inline" id="S5.SS6.p3.3.m3.1"><semantics id="S5.SS6.p3.3.m3.1a"><msub id="S5.SS6.p3.3.m3.1.1" xref="S5.SS6.p3.3.m3.1.1.cmml"><mi id="S5.SS6.p3.3.m3.1.1.2" xref="S5.SS6.p3.3.m3.1.1.2.cmml">d</mi><mn id="S5.SS6.p3.3.m3.1.1.3" xref="S5.SS6.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.3.m3.1b"><apply id="S5.SS6.p3.3.m3.1.1.cmml" xref="S5.SS6.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p3.3.m3.1.1.1.cmml" xref="S5.SS6.p3.3.m3.1.1">subscript</csymbol><ci id="S5.SS6.p3.3.m3.1.1.2.cmml" xref="S5.SS6.p3.3.m3.1.1.2">𝑑</ci><cn id="S5.SS6.p3.3.m3.1.1.3.cmml" type="integer" xref="S5.SS6.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.3.m3.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.3.m3.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> (Gastrointest hemorr), without prescribing specifically for <math alttext="d_{1}" class="ltx_Math" display="inline" id="S5.SS6.p3.4.m4.1"><semantics id="S5.SS6.p3.4.m4.1a"><msub id="S5.SS6.p3.4.m4.1.1" xref="S5.SS6.p3.4.m4.1.1.cmml"><mi id="S5.SS6.p3.4.m4.1.1.2" xref="S5.SS6.p3.4.m4.1.1.2.cmml">d</mi><mn id="S5.SS6.p3.4.m4.1.1.3" xref="S5.SS6.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.4.m4.1b"><apply id="S5.SS6.p3.4.m4.1.1.cmml" xref="S5.SS6.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p3.4.m4.1.1.1.cmml" xref="S5.SS6.p3.4.m4.1.1">subscript</csymbol><ci id="S5.SS6.p3.4.m4.1.1.2.cmml" xref="S5.SS6.p3.4.m4.1.1.2">𝑑</ci><cn id="S5.SS6.p3.4.m4.1.1.3.cmml" type="integer" xref="S5.SS6.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.4.m4.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.4.m4.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. In contrast, the co-occurrence-based method prescribes all these medications for <math alttext="d_{1}" class="ltx_Math" display="inline" id="S5.SS6.p3.5.m5.1"><semantics id="S5.SS6.p3.5.m5.1a"><msub id="S5.SS6.p3.5.m5.1.1" xref="S5.SS6.p3.5.m5.1.1.cmml"><mi id="S5.SS6.p3.5.m5.1.1.2" xref="S5.SS6.p3.5.m5.1.1.2.cmml">d</mi><mn id="S5.SS6.p3.5.m5.1.1.3" xref="S5.SS6.p3.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.5.m5.1b"><apply id="S5.SS6.p3.5.m5.1.1.cmml" xref="S5.SS6.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS6.p3.5.m5.1.1.1.cmml" xref="S5.SS6.p3.5.m5.1.1">subscript</csymbol><ci id="S5.SS6.p3.5.m5.1.1.2.cmml" xref="S5.SS6.p3.5.m5.1.1.2">𝑑</ci><cn id="S5.SS6.p3.5.m5.1.1.3.cmml" type="integer" xref="S5.SS6.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.5.m5.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.5.m5.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS6.p4">
<p class="ltx_p" id="S5.SS6.p4.1">We demonstrate how causality-based methods enhance medication recommendation personalization and validate our proposed framework’s reasonability, transparency and interpretability via comparative analysis.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We introduce a causality-based, patient health state-centric framework named CausalMed, which effectively addresses the issues of ambiguous relationships between diseases/procedures and medications and the challenge of capturing differences among diseases/ procedures, thereby significantly enhancing the personalization of patient representations. Extensive experiments on real-world datasets validate the efficacy of the proposed framework.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This work was supported by the Innovation Capability Improvement Plan Project of Hebei Province (No. 22567637H), the S&amp;T Program of Hebei(No. 236Z0302G), and HeBei Natural Science Foundation under Grant (No.G2021203010 &amp; No.F2021203038).

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bansal et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Mukesh Bansal, Jichen Yang, Charles Karan, Michael P Menden, James C Costello, Hao Tang, Guanghua Xiao, Yajuan Li, Jeffrey Allen, Rui Zhong, et al<span class="ltx_text" id="bib.bib2.3.1">.</span> 2014.

</span>
<span class="ltx_bibblock">A community computational challenge to predict the activity of pairs of compounds.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.4.1">Nature Biotechnology</em> 32, 12 (2014), 1213–1222.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Qianyu Chen, Xin Li, Kunnan Geng, and Mingzhong Wang. 2023.

</span>
<span class="ltx_bibblock">Context-aware safe medication recommendations with molecular graph and DDI graph embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 37. 7053–7060.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2016a)</span>
<span class="ltx_bibblock">
Edward Choi, Mohammad Taha Bahadori, Andy Schuetz, Walter F Stewart, and Jimeng Sun. 2016a.

</span>
<span class="ltx_bibblock">Doctor ai: Predicting clinical events via recurrent neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Machine Learning for Healthcare Conference</em>. PMLR, 301–318.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2016b)</span>
<span class="ltx_bibblock">
Edward Choi, Mohammad Taha Bahadori, Jimeng Sun, Joshua Kulas, Andy Schuetz, and Walter Stewart. 2016b.

</span>
<span class="ltx_bibblock">Retain: An interpretable predictive model for healthcare using reverse time attention mechanism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Advances in Neural Information Processing Systems</em> 29 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chen Gao, Yu Zheng, Wenjie Wang, Fuli Feng, Xiangnan He, and Yong Li. 2024.

</span>
<span class="ltx_bibblock">Causal inference in recommender systems: A survey and future directions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">ACM Transactions on Information Systems</em> 42, 4 (2024), 1–32.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gultchin et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Limor Gultchin, Matt Kusner, Varun Kanade, and Ricardo Silva. 2020.

</span>
<span class="ltx_bibblock">Differentiable causal backdoor discovery. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">International Conference on Artificial Intelligence and Statistics</em>. PMLR, 3970–3979.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hasan et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Uzma Hasan, Emam Hossain, and Md Osman Gani. 2023.

</span>
<span class="ltx_bibblock">A Survey on Causal Discovery Methods for Temporal and Non-Temporal Data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">arXiv preprint arXiv:2303.15027</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffman et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Keith B Hoffman, Mo Dimbil, Colin B Erdman, Nicholas P Tatonetti, and Brian M Overstreet. 2014.

</span>
<span class="ltx_bibblock">The Weber effect and the United States Food and Drug Administration’s Adverse Event Reporting System (FAERS): analysis of sixty-two drugs approved from 2006 to 2010.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Drug safety</em> 37 (2014), 283–294.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Indra et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
ST Indra, Liza Wikarsa, and Rinaldo Turang. 2016.

</span>
<span class="ltx_bibblock">Using logistic regression method to classify tweets into the selected topics. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">2016 international conference on advanced computer science and information systems (icacsis)</em>. IEEE, 385–390.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Alistair EW Johnson, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad Shammout, Steven Horng, Tom J Pollard, Sicheng Hao, Benjamin Moody, Brian Gow, et al<span class="ltx_text" id="bib.bib11.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">MIMIC-IV, a freely accessible electronic health record dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.4.1">Scientific data</em> 10, 1 (2023), 1.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Alistair EW Johnson, Tom J Pollard, Lu Shen, Li-wei H Lehman, Mengling Feng, Mohammad Ghassemi, Benjamin Moody, Peter Szolovits, Leo Anthony Celi, and Roger G Mark. 2016.

</span>
<span class="ltx_bibblock">MIMIC-III, a freely accessible critical care database.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Scientific data</em> 3, 1 (2016), 1–9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalainathan et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Diviyan Kalainathan, Olivier Goudet, and Ritik Dutta. 2020.

</span>
<span class="ltx_bibblock">Causal discovery toolbox: Uncovering causal relationships in python.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">The Journal of Machine Learning Research</em> 21, 1 (2020), 1406–1410.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Hung Le, Truyen Tran, and Svetha Venkatesh. 2018.

</span>
<span class="ltx_bibblock">Dual memory neural computer for asynchronous two-view sequential learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 1637–1645.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiang Li, Shunpan Liang, Yulei Hou, and Tengfei Ma. 2023.

</span>
<span class="ltx_bibblock">StratMed: Relevance stratification between biomedical entities for sparsity on medication recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Knowledge-Based Systems</em> (2023), 111239.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yiming Li, Yong Jiang, Zhifeng Li, and Shu-Tao Xia. 2022.

</span>
<span class="ltx_bibblock">Backdoor learning: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">IEEE Transactions on Neural Networks and Learning Systems</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Fenglong Ma, Yaqing Wang, Houping Xiao, Ye Yuan, Radha Chitta, Jing Zhou, and Jing Gao. 2018.

</span>
<span class="ltx_bibblock">A general framework for diagnosis prediction via incorporating medical code descriptions. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">2018 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</em>. IEEE, 1070–1075.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Tengfei Ma, Xuan Lin, Bosheng Song, Philip S. Yu, and Xiangxiang Zeng. 2023.

</span>
<span class="ltx_bibblock">KG-MTL: Knowledge Graph Enhanced Multi-Task Learning for Molecular Interaction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">IEEE Transactions on Knowledge and Data Engineering</em> 35, 7 (2023), 7068–7081.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TKDE.2022.3188154" title="">https://doi.org/10.1109/TKDE.2022.3188154</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nandy et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Preetam Nandy, Alain Hauser, and Marloes H Maathuis. 2018.

</span>
<span class="ltx_bibblock">Understanding consistency in hybrid causal structure learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Ann. Stat</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pearl and Mackenzie (2018)</span>
<span class="ltx_bibblock">
Judea Pearl and Dana Mackenzie. 2018.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">The book of why: the new science of cause and effect</em>.

</span>
<span class="ltx_bibblock">Basic books.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Read et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Jesse Read, Bernhard Pfahringer, Geoff Holmes, and Eibe Frank. 2011.

</span>
<span class="ltx_bibblock">Classifier chains for multi-label classification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Machine learning</em> 85 (2011), 333–359.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rosaci (2007)</span>
<span class="ltx_bibblock">
Domenico Rosaci. 2007.

</span>
<span class="ltx_bibblock">CILIOS: Connectionist inductive learning and inter-ontology similarities for recommending information agents.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Information systems</em> 32, 6 (2007), 793–825.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlichtkrull et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Michael Schlichtkrull, Thomas N Kipf, Peter Bloem, Rianne Van Den Berg, Ivan Titov, and Max Welling. 2018.

</span>
<span class="ltx_bibblock">Modeling relational data with graph convolutional networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">The Semantic Web: 15th International Conference, ESWC 2018, Heraklion, Crete, Greece, June 3–7, 2018, Proceedings 15</em>. Springer, 593–607.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Junyuan Shang, Shenda Hong, Yuxi Zhou, Meng Wu, and Hongyan Li. 2018.

</span>
<span class="ltx_bibblock">Knowledge guided multi-instance multi-label learning via neural networks in medicines prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Asian Conference on Machine Learning</em>. PMLR, 831–846.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Junyuan Shang, Cao Xiao, Tengfei Ma, Hongyan Li, and Jimeng Sun. 2019.

</span>
<span class="ltx_bibblock">Gamenet: Graph augmented memory networks for recommending medication combination. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 33. 1126–1133.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Si et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zihua Si, Xueran Han, Xiao Zhang, Jun Xu, Yue Yin, Yang Song, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">A model-agnostic causal learning framework for recommendation using search data. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the ACM Web Conference 2022</em>. 224–233.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Symeonidis et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Panagiotis Symeonidis, Stergios Chairistanidis, and Markus Zanker. 2021.

</span>
<span class="ltx_bibblock">Recommending what drug to prescribe next for accurate and explainable medical decisions. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">2021 IEEE 34th International Symposium on Computer-Based Medical Systems (CBMS)</em>. IEEE, 213–218.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shanshan Wang, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Jun Ma, and Maarten de Rijke. 2019.

</span>
<span class="ltx_bibblock">Order-free medicine combination prediction with graph convolutional reinforcement learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1623–1632.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Wenjie Wang, Fuli Feng, Liqiang Nie, and Tat-Seng Chua. 2022a.

</span>
<span class="ltx_bibblock">User-controllable recommendation against filter bubbles. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1251–1261.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2022c)</span>
<span class="ltx_bibblock">
Wenjie Wang, Xinyu Lin, Fuli Feng, Xiangnan He, Min Lin, and Tat-Seng Chua. 2022c.

</span>
<span class="ltx_bibblock">Causal representation learning for out-of-distribution recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the ACM Web Conference 2022</em>. 3562–3571.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiang Wang, Tinglin Huang, Dingxian Wang, Yancheng Yuan, Zhenguang Liu, Xiangnan He, and Tat-Seng Chua. 2021.

</span>
<span class="ltx_bibblock">Learning intents behind interactions with knowledge graph for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the web conference 2021</em>. 878–887.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Zisen Wang, Ying Liang, and Zhengjun Liu. 2022b.

</span>
<span class="ltx_bibblock">FFBDNet: Feature Fusion and Bipartite Decision Networks for Recommending Medication Combination. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Joint European Conference on Machine Learning and Knowledge Discovery in Databases</em>. Springer, 419–436.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2022d)</span>
<span class="ltx_bibblock">
Zhenlei Wang, Shiqi Shen, Zhipeng Wang, Bo Chen, Xu Chen, and Ji-Rong Wen. 2022d.

</span>
<span class="ltx_bibblock">Unbiased sequential recommendation with latent confounders. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the ACM Web Conference 2022</em>. 2195–2204.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Tianxin Wei, Fuli Feng, Jiawei Chen, Ziwei Wu, Jinfeng Yi, and Xiangnan He. 2021.

</span>
<span class="ltx_bibblock">Model-agnostic counterfactual reasoning for eliminating popularity bias in recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 1791–1800.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jialun Wu, Kai He, Rui Mao, Chen Li, and Erik Cambria. 2023.

</span>
<span class="ltx_bibblock">MEGACare: Knowledge-guided multi-view hypergraph predictive framework for healthcare.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Information Fusion</em> 100 (2023), 101939.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Rui Wu, Zhaopeng Qiu, Jiacheng Jiang, Guilin Qi, and Xian Wu. 2022.

</span>
<span class="ltx_bibblock">Conditional generation net for medication recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the ACM Web Conference 2022</em>. 935–945.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao and Wang (2022)</span>
<span class="ltx_bibblock">
Teng Xiao and Suhang Wang. 2022.

</span>
<span class="ltx_bibblock">Towards unbiased and robust causal ranking for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining</em>. 1158–1167.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Cao Xiao, Lucas Glass, and Jimeng Sun. 2021a.

</span>
<span class="ltx_bibblock">Change Matters: Medication Change Prediction with Recurrent Residual Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence 2021</em>. 3728–3734.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Cao Xiao, Fenglong Ma, Lucas Glass, and Jimeng Sun. 2021b.

</span>
<span class="ltx_bibblock">SafeDrug: Dual Molecular Graph Encoders for Safe Drug Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI 2021</em>. 3735–3741.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Nianzu Yang, Kaipeng Zeng, Qitian Wu, and Junchi Yan. 2023.

</span>
<span class="ltx_bibblock">Molerec: Combinatorial drug recommendation with substructure-aware molecular representation learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the ACM Web Conference 2023</em>. 4075–4085.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiao Zhang, Haonan Jia, Hanjing Su, Wenhan Wang, Jun Xu, and Ji-Rong Wen. 2021.

</span>
<span class="ltx_bibblock">Counterfactual reward modification for streaming recommendation with delayed feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 41–50.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Yutao Zhang, Robert Chen, Jie Tang, Walter F Stewart, and Jimeng Sun. 2017.

</span>
<span class="ltx_bibblock">LEAP: learning to prescribe effective and safe treatment combinations for multimorbidity. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>. 1315–1324.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Yu Zheng, Chen Gao, Xiang Li, Xiangnan He, Yong Li, and Depeng Jin. 2021a.

</span>
<span class="ltx_bibblock">Disentangling user interest and conformity for recommendation with causal embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the Web Conference 2021</em>. 2980–2991.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Zhi Zheng, Chao Wang, Tong Xu, Dazhong Shen, Penggang Qin, Baoxing Huai, Tongzhu Liu, and Enhong Chen. 2021b.

</span>
<span class="ltx_bibblock">Drug package recommendation via interaction-aware graph induction. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the Web Conference 2021</em>. 1284–1295.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhi Zheng, Chao Wang, Tong Xu, Dazhong Shen, Penggang Qin, Xiangyu Zhao, Baoxing Huai, Xian Wu, and Enhong Chen. 2023.

</span>
<span class="ltx_bibblock">Interaction-aware drug package recommendation via policy gradient.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">ACM Transactions on Information Systems</em> 41, 1 (2023), 1–32.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Jul 21 03:52:44 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
