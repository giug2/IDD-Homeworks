<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2207.08988] Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices</title><meta property="og:description" content="Federated Learning (FL) is a technique to train models using data distributed across devices.
Differential Privacy (DP) provides a formal privacy guarantee for sensitive data.
Our goal is to train a large neural networâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2207.08988">

<!--Generated on Wed Mar 13 14:26:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Training Large-Vocabulary Neural Language Models by 
<br class="ltx_break">Private Federated Learning for Resource-Constrained Devices</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mingbin Xu, Congzheng Song 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_bold">Ye Tian, Neha Agrawal, Filip Granqvist, Rogier van Dalen, Xiao Zhang</span> 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_bold">Arturo Argueta, Shiyi Han, Yaqiao Deng, Leo Liu, Anmol Walia, Alex Jin</span> 
<br class="ltx_break">Apple Inc. 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">{mingbin.xu, csong4, ytian2, neha_agrawal, fgranqvist, rogier_vandalen,</span> 
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">xiaoz, arturo_argueta, shan26, yaqiao_deng, lliu9, awalia, alex_jin}@apple.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Federated Learning (FL) is a technique to train models using data distributed across devices.
Differential Privacy (DP) provides a formal privacy guarantee for sensitive data.
Our goal is to train a large neural network language model (NNLM) on compute-constrained devices while preserving privacy using FL and DP.
However, the DP-noise introduced to the model increases as the model size grows, which often prevents convergence.
We propose Partial Embedding Updates (PEU), a novel technique to decrease noise by decreasing payload size.
Furthermore, we adopt Low Rank Adaptation (LoRA) and Noise Contrastive Estimation (NCE) to reduce the memory demands of large models on compute-constrained devices.
This combination of techniques makes it possible to train large-vocabulary language models while preserving accuracy and privacy.
</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Language Models (LMs) play an important role in many applications, including Automatic Speech Recognition (ASR), Machine Translation (MT), Information Retrieval (IR), and Natural Language Understanding (NLU).
The transformer-based <cite class="ltx_cite ltx_citemacro_cite">Vaswani etÂ al. (<a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite> neural network language model (NNLM) launched an era of large-scale LM pre-training and task-specific parameter fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Devlin etÂ al. (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>); Radford etÂ al. (<a href="#bib.bib25" title="" class="ltx_ref">2018</a>, <a href="#bib.bib26" title="" class="ltx_ref">2019</a>); Brown etÂ al. (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>); Shoeybi etÂ al. (<a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Data stored on userâ€™s device is private, and cannot be transmitted to the server.
<cite class="ltx_cite ltx_citemacro_citet">McMahan etÂ al. (<a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> present an federated learning (FL) method that trains a global model from a federation of edge devices that transmit gradients - instead of raw data - to the server.
However, mobile devices are constrained in terms of memory and bandwidth.
Many applications require a prohibitively large number of classes to model labels in the tail of the distribution.
Those tail cases are of greater interest from the user experience perspective <cite class="ltx_cite ltx_citemacro_cite">Saebi etÂ al. (<a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Lack of access to the raw data does not necessarily guarantee privacy.
Model gradients may reveal some information about user dataÂ <cite class="ltx_cite ltx_citemacro_cite">Melis etÂ al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>); Zhu etÂ al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>.
Neural networks tend to memorize training data Â <cite class="ltx_cite ltx_citemacro_cite">Carlini etÂ al. (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>.
While differential privacy (DP) <cite class="ltx_cite ltx_citemacro_cite">Dwork etÂ al. (<a href="#bib.bib10" title="" class="ltx_ref">2006</a>)</cite> meets the privacy demand of SGD-based algorithm <cite class="ltx_cite ltx_citemacro_cite">Abadi etÂ al. (<a href="#bib.bib1" title="" class="ltx_ref">2016</a>)</cite>, the DP-perturbation can quickly overwhelm the gradient signal as the model capacity grows, which creates a dilemma between accuracy and privacy <cite class="ltx_cite ltx_citemacro_cite">Bassily etÂ al. (<a href="#bib.bib4" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, differential privacy is used on top of federated learning to learn task-specific LMs while guaranteeing privacy.
We address resource limitations in federated learning with partial embedding updates, low-rank adaptation, and noise contrastive estimation, which co-jointly overcome the decreasing gradient utilization due to the increasing model size in the differentially private context.
We stabilize the training process and speed up convergence by exponentially decaying the moving average of the models.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.8" class="ltx_p">Federated Learning (FL)Â <cite class="ltx_cite ltx_citemacro_cite">McMahan etÂ al. (<a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> was introduced to train a user-independent model with data from multiple users while ensuring personal data never leaves the device.
At iteration <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">t</annotation></semantics></math> of FL, the server first samples a subset of devices <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">ğ’</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">ğ’</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\mathcal{C}</annotation></semantics></math> from the population.
Each sampled device <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="i\in\mathcal{C}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">i</mi><mo id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">ğ’</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><in id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1"></in><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">ğ‘–</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">ğ’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">i\in\mathcal{C}</annotation></semantics></math> then downloads the shared model parameters <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">Î¸</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">ğœƒ</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\theta_{t}</annotation></semantics></math> from the server and locally trains the model on its own data to produce a local model <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">Î¸</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">ğœƒ</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\theta_{i}</annotation></semantics></math>.
The model difference <math id="S2.SS1.p1.6.m6.2" class="ltx_Math" alttext="\Delta_{t,i}=\theta_{i}-\theta_{t}" display="inline"><semantics id="S2.SS1.p1.6.m6.2a"><mrow id="S2.SS1.p1.6.m6.2.3" xref="S2.SS1.p1.6.m6.2.3.cmml"><msub id="S2.SS1.p1.6.m6.2.3.2" xref="S2.SS1.p1.6.m6.2.3.2.cmml"><mi mathvariant="normal" id="S2.SS1.p1.6.m6.2.3.2.2" xref="S2.SS1.p1.6.m6.2.3.2.2.cmml">Î”</mi><mrow id="S2.SS1.p1.6.m6.2.2.2.4" xref="S2.SS1.p1.6.m6.2.2.2.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.cmml">t</mi><mo id="S2.SS1.p1.6.m6.2.2.2.4.1" xref="S2.SS1.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.6.m6.2.2.2.2" xref="S2.SS1.p1.6.m6.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S2.SS1.p1.6.m6.2.3.1" xref="S2.SS1.p1.6.m6.2.3.1.cmml">=</mo><mrow id="S2.SS1.p1.6.m6.2.3.3" xref="S2.SS1.p1.6.m6.2.3.3.cmml"><msub id="S2.SS1.p1.6.m6.2.3.3.2" xref="S2.SS1.p1.6.m6.2.3.3.2.cmml"><mi id="S2.SS1.p1.6.m6.2.3.3.2.2" xref="S2.SS1.p1.6.m6.2.3.3.2.2.cmml">Î¸</mi><mi id="S2.SS1.p1.6.m6.2.3.3.2.3" xref="S2.SS1.p1.6.m6.2.3.3.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.6.m6.2.3.3.1" xref="S2.SS1.p1.6.m6.2.3.3.1.cmml">âˆ’</mo><msub id="S2.SS1.p1.6.m6.2.3.3.3" xref="S2.SS1.p1.6.m6.2.3.3.3.cmml"><mi id="S2.SS1.p1.6.m6.2.3.3.3.2" xref="S2.SS1.p1.6.m6.2.3.3.3.2.cmml">Î¸</mi><mi id="S2.SS1.p1.6.m6.2.3.3.3.3" xref="S2.SS1.p1.6.m6.2.3.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.2b"><apply id="S2.SS1.p1.6.m6.2.3.cmml" xref="S2.SS1.p1.6.m6.2.3"><eq id="S2.SS1.p1.6.m6.2.3.1.cmml" xref="S2.SS1.p1.6.m6.2.3.1"></eq><apply id="S2.SS1.p1.6.m6.2.3.2.cmml" xref="S2.SS1.p1.6.m6.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.3.2.1.cmml" xref="S2.SS1.p1.6.m6.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.3.2.2.cmml" xref="S2.SS1.p1.6.m6.2.3.2.2">Î”</ci><list id="S2.SS1.p1.6.m6.2.2.2.3.cmml" xref="S2.SS1.p1.6.m6.2.2.2.4"><ci id="S2.SS1.p1.6.m6.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1">ğ‘¡</ci><ci id="S2.SS1.p1.6.m6.2.2.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2.2.2">ğ‘–</ci></list></apply><apply id="S2.SS1.p1.6.m6.2.3.3.cmml" xref="S2.SS1.p1.6.m6.2.3.3"><minus id="S2.SS1.p1.6.m6.2.3.3.1.cmml" xref="S2.SS1.p1.6.m6.2.3.3.1"></minus><apply id="S2.SS1.p1.6.m6.2.3.3.2.cmml" xref="S2.SS1.p1.6.m6.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.3.3.2.1.cmml" xref="S2.SS1.p1.6.m6.2.3.3.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.3.3.2.2.cmml" xref="S2.SS1.p1.6.m6.2.3.3.2.2">ğœƒ</ci><ci id="S2.SS1.p1.6.m6.2.3.3.2.3.cmml" xref="S2.SS1.p1.6.m6.2.3.3.2.3">ğ‘–</ci></apply><apply id="S2.SS1.p1.6.m6.2.3.3.3.cmml" xref="S2.SS1.p1.6.m6.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.2.3.3.3.1.cmml" xref="S2.SS1.p1.6.m6.2.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.6.m6.2.3.3.3.2.cmml" xref="S2.SS1.p1.6.m6.2.3.3.3.2">ğœƒ</ci><ci id="S2.SS1.p1.6.m6.2.3.3.3.3.cmml" xref="S2.SS1.p1.6.m6.2.3.3.3.3">ğ‘¡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.2c">\Delta_{t,i}=\theta_{i}-\theta_{t}</annotation></semantics></math> is sent back to the server.
The server aggregates the model differences as a â€œpseudo-gradientâ€ <math id="S2.SS1.p1.7.m7.3" class="ltx_Math" alttext="\Delta_{t}=\frac{1}{|\mathcal{C}|}\sum_{i\in\mathcal{C}}\Delta_{t,i}" display="inline"><semantics id="S2.SS1.p1.7.m7.3a"><mrow id="S2.SS1.p1.7.m7.3.4" xref="S2.SS1.p1.7.m7.3.4.cmml"><msub id="S2.SS1.p1.7.m7.3.4.2" xref="S2.SS1.p1.7.m7.3.4.2.cmml"><mi mathvariant="normal" id="S2.SS1.p1.7.m7.3.4.2.2" xref="S2.SS1.p1.7.m7.3.4.2.2.cmml">Î”</mi><mi id="S2.SS1.p1.7.m7.3.4.2.3" xref="S2.SS1.p1.7.m7.3.4.2.3.cmml">t</mi></msub><mo id="S2.SS1.p1.7.m7.3.4.1" xref="S2.SS1.p1.7.m7.3.4.1.cmml">=</mo><mrow id="S2.SS1.p1.7.m7.3.4.3" xref="S2.SS1.p1.7.m7.3.4.3.cmml"><mfrac id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mn id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">1</mn><mrow id="S2.SS1.p1.7.m7.1.1.1.3" xref="S2.SS1.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.1.1.1.3.1" xref="S2.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.1.1.1" xref="S2.SS1.p1.7.m7.1.1.1.1.cmml">ğ’</mi><mo stretchy="false" id="S2.SS1.p1.7.m7.1.1.1.3.2" xref="S2.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p1.7.m7.3.4.3.1" xref="S2.SS1.p1.7.m7.3.4.3.1.cmml">â€‹</mo><mrow id="S2.SS1.p1.7.m7.3.4.3.2" xref="S2.SS1.p1.7.m7.3.4.3.2.cmml"><msub id="S2.SS1.p1.7.m7.3.4.3.2.1" xref="S2.SS1.p1.7.m7.3.4.3.2.1.cmml"><mo id="S2.SS1.p1.7.m7.3.4.3.2.1.2" xref="S2.SS1.p1.7.m7.3.4.3.2.1.2.cmml">âˆ‘</mo><mrow id="S2.SS1.p1.7.m7.3.4.3.2.1.3" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.cmml"><mi id="S2.SS1.p1.7.m7.3.4.3.2.1.3.2" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.7.m7.3.4.3.2.1.3.1" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.3.4.3.2.1.3.3" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.3.cmml">ğ’</mi></mrow></msub><msub id="S2.SS1.p1.7.m7.3.4.3.2.2" xref="S2.SS1.p1.7.m7.3.4.3.2.2.cmml"><mi mathvariant="normal" id="S2.SS1.p1.7.m7.3.4.3.2.2.2" xref="S2.SS1.p1.7.m7.3.4.3.2.2.2.cmml">Î”</mi><mrow id="S2.SS1.p1.7.m7.3.3.2.4" xref="S2.SS1.p1.7.m7.3.3.2.3.cmml"><mi id="S2.SS1.p1.7.m7.2.2.1.1" xref="S2.SS1.p1.7.m7.2.2.1.1.cmml">t</mi><mo id="S2.SS1.p1.7.m7.3.3.2.4.1" xref="S2.SS1.p1.7.m7.3.3.2.3.cmml">,</mo><mi id="S2.SS1.p1.7.m7.3.3.2.2" xref="S2.SS1.p1.7.m7.3.3.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.3b"><apply id="S2.SS1.p1.7.m7.3.4.cmml" xref="S2.SS1.p1.7.m7.3.4"><eq id="S2.SS1.p1.7.m7.3.4.1.cmml" xref="S2.SS1.p1.7.m7.3.4.1"></eq><apply id="S2.SS1.p1.7.m7.3.4.2.cmml" xref="S2.SS1.p1.7.m7.3.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.3.4.2.1.cmml" xref="S2.SS1.p1.7.m7.3.4.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.3.4.2.2.cmml" xref="S2.SS1.p1.7.m7.3.4.2.2">Î”</ci><ci id="S2.SS1.p1.7.m7.3.4.2.3.cmml" xref="S2.SS1.p1.7.m7.3.4.2.3">ğ‘¡</ci></apply><apply id="S2.SS1.p1.7.m7.3.4.3.cmml" xref="S2.SS1.p1.7.m7.3.4.3"><times id="S2.SS1.p1.7.m7.3.4.3.1.cmml" xref="S2.SS1.p1.7.m7.3.4.3.1"></times><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><divide id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1"></divide><cn type="integer" id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">1</cn><apply id="S2.SS1.p1.7.m7.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.1.3"><abs id="S2.SS1.p1.7.m7.1.1.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1.3.1"></abs><ci id="S2.SS1.p1.7.m7.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1.1">ğ’</ci></apply></apply><apply id="S2.SS1.p1.7.m7.3.4.3.2.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2"><apply id="S2.SS1.p1.7.m7.3.4.3.2.1.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.3.4.3.2.1.1.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1">subscript</csymbol><sum id="S2.SS1.p1.7.m7.3.4.3.2.1.2.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1.2"></sum><apply id="S2.SS1.p1.7.m7.3.4.3.2.1.3.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3"><in id="S2.SS1.p1.7.m7.3.4.3.2.1.3.1.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.1"></in><ci id="S2.SS1.p1.7.m7.3.4.3.2.1.3.2.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.2">ğ‘–</ci><ci id="S2.SS1.p1.7.m7.3.4.3.2.1.3.3.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.1.3.3">ğ’</ci></apply></apply><apply id="S2.SS1.p1.7.m7.3.4.3.2.2.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.3.4.3.2.2.1.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.3.4.3.2.2.2.cmml" xref="S2.SS1.p1.7.m7.3.4.3.2.2.2">Î”</ci><list id="S2.SS1.p1.7.m7.3.3.2.3.cmml" xref="S2.SS1.p1.7.m7.3.3.2.4"><ci id="S2.SS1.p1.7.m7.2.2.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1">ğ‘¡</ci><ci id="S2.SS1.p1.7.m7.3.3.2.2.cmml" xref="S2.SS1.p1.7.m7.3.3.2.2">ğ‘–</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.3c">\Delta_{t}=\frac{1}{|\mathcal{C}|}\sum_{i\in\mathcal{C}}\Delta_{t,i}</annotation></semantics></math> and uses the peseudo-gradient to update <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><msub id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">Î¸</mi><mi id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">ğœƒ</ci><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\theta_{t}</annotation></semantics></math> with any standard optimizerÂ <cite class="ltx_cite ltx_citemacro_cite">Reddi etÂ al. (<a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Differential Privacy</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Differential privacy (DP) defines a privacy guarantee for SGD-based learning algorithms.
DP is formally defined as follows:</p>
</div>
<div id="Thmdefinition1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span></h6>
<div id="Thmdefinition1.p1" class="ltx_para">
<p id="Thmdefinition1.p1.5" class="ltx_p"><span id="Thmdefinition1.p1.5.5" class="ltx_text ltx_font_italic">Differential Privacy <cite class="ltx_cite ltx_citemacro_cite">Dwork etÂ al. (<a href="#bib.bib10" title="" class="ltx_ref">2006</a>)</cite>
A randomized algorithm <math id="Thmdefinition1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}:\mathcal{D}\mapsto\mathcal{R}" display="inline"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mrow id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.2.cmml">ğ’œ</mi><mo lspace="0.278em" rspace="0.278em" id="Thmdefinition1.p1.1.1.m1.1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.cmml">:</mo><mrow id="Thmdefinition1.p1.1.1.m1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.3.2" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml">ğ’Ÿ</mi><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.3.1" xref="Thmdefinition1.p1.1.1.m1.1.1.3.1.cmml">â†¦</mo><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.3.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml">â„›</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1">:</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.2">ğ’œ</ci><apply id="Thmdefinition1.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3"><csymbol cd="latexml" id="Thmdefinition1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.1">maps-to</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2">ğ’Ÿ</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3">â„›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">\mathcal{A}:\mathcal{D}\mapsto\mathcal{R}</annotation></semantics></math> is (<math id="Thmdefinition1.p1.2.2.m2.2" class="ltx_Math" alttext="\epsilon,\delta" display="inline"><semantics id="Thmdefinition1.p1.2.2.m2.2a"><mrow id="Thmdefinition1.p1.2.2.m2.2.3.2" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml">Ïµ</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.2.1" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.2.2.m2.2.2" xref="Thmdefinition1.p1.2.2.m2.2.2.cmml">Î´</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.2b"><list id="Thmdefinition1.p1.2.2.m2.2.3.1.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2"><ci id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">italic-Ïµ</ci><ci id="Thmdefinition1.p1.2.2.m2.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.2.2">ğ›¿</ci></list></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.2c">\epsilon,\delta</annotation></semantics></math>)-differentially private, if for any pair of neighboring training populations <math id="Thmdefinition1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="Thmdefinition1.p1.3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.1b"><ci id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.1c">\mathcal{D}</annotation></semantics></math> and <math id="Thmdefinition1.p1.4.4.m4.1" class="ltx_Math" alttext="\mathcal{D^{\prime}}" display="inline"><semantics id="Thmdefinition1.p1.4.4.m4.1a"><msup id="Thmdefinition1.p1.4.4.m4.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.4.4.m4.1.1.2" xref="Thmdefinition1.p1.4.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mo id="Thmdefinition1.p1.4.4.m4.1.1.3" xref="Thmdefinition1.p1.4.4.m4.1.1.3.cmml">â€²</mo></msup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.1b"><apply id="Thmdefinition1.p1.4.4.m4.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.4.4.m4.1.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1">superscript</csymbol><ci id="Thmdefinition1.p1.4.4.m4.1.1.2.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.2">ğ’Ÿ</ci><ci id="Thmdefinition1.p1.4.4.m4.1.1.3.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.3">â€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.1c">\mathcal{D^{\prime}}</annotation></semantics></math> and for any subset of outputs <math id="Thmdefinition1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathcal{S}\subseteq\mathcal{R}" display="inline"><semantics id="Thmdefinition1.p1.5.5.m5.1a"><mrow id="Thmdefinition1.p1.5.5.m5.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.5.5.m5.1.1.2" xref="Thmdefinition1.p1.5.5.m5.1.1.2.cmml">ğ’®</mi><mo id="Thmdefinition1.p1.5.5.m5.1.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.1.cmml">âŠ†</mo><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.5.5.m5.1.1.3" xref="Thmdefinition1.p1.5.5.m5.1.1.3.cmml">â„›</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.5.m5.1b"><apply id="Thmdefinition1.p1.5.5.m5.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"><subset id="Thmdefinition1.p1.5.5.m5.1.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.1"></subset><ci id="Thmdefinition1.p1.5.5.m5.1.1.2.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2">ğ’®</ci><ci id="Thmdefinition1.p1.5.5.m5.1.1.3.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.3">â„›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.5.m5.1c">\mathcal{S}\subseteq\mathcal{R}</annotation></semantics></math>, it holds that</span></p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\mathrm{Pr}[\mathcal{A}(\mathcal{D})\in\mathcal{S}]\leq e^{\epsilon}\cdot\mathrm{Pr}[\mathcal{A}(\mathcal{D^{\prime}})\in\mathcal{S}]+\delta." display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.3.cmml">Pr</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml">ğ’œ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.2.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml">â€‹</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.2.3.2.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">ğ’Ÿ</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.2.3.2.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml">ğ’®</mi></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">â‰¤</mo><mrow id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.1" xref="S2.E1.m1.2.2.1.1.2.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.1.3" xref="S2.E1.m1.2.2.1.1.2.1.3.cmml"><msup id="S2.E1.m1.2.2.1.1.2.1.3.2" xref="S2.E1.m1.2.2.1.1.2.1.3.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.3.2.2" xref="S2.E1.m1.2.2.1.1.2.1.3.2.2.cmml">e</mi><mi id="S2.E1.m1.2.2.1.1.2.1.3.2.3" xref="S2.E1.m1.2.2.1.1.2.1.3.2.3.cmml">Ïµ</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.2.2.1.1.2.1.3.1" xref="S2.E1.m1.2.2.1.1.2.1.3.1.cmml">â‹…</mo><mi id="S2.E1.m1.2.2.1.1.2.1.3.3" xref="S2.E1.m1.2.2.1.1.2.1.3.3.cmml">Pr</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.1.2" xref="S2.E1.m1.2.2.1.1.2.1.2.cmml">â€‹</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.3.cmml">ğ’œ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml">ğ’Ÿ</mi><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml">â€²</mo></msup><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.2.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.cmml">ğ’®</mi></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.2.cmml">+</mo><mi id="S2.E1.m1.2.2.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.3.cmml">Î´</mi></mrow></mrow><mo lspace="0em" id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><leq id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"></leq><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.3">Pr</ci><apply id="S2.E1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><in id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"></in><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2"><times id="S2.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.2">ğ’œ</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">ğ’Ÿ</ci></apply><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">ğ’®</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><plus id="S2.E1.m1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2"></plus><apply id="S2.E1.m1.2.2.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1"><times id="S2.E1.m1.2.2.1.1.2.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.2"></times><apply id="S2.E1.m1.2.2.1.1.2.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3"><ci id="S2.E1.m1.2.2.1.1.2.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.1">â‹…</ci><apply id="S2.E1.m1.2.2.1.1.2.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.2">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.2.2">ğ‘’</ci><ci id="S2.E1.m1.2.2.1.1.2.1.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.2.3">italic-Ïµ</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.3.3">Pr</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1"><in id="S2.E1.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.2"></in><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1"><times id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.3">ğ’œ</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">ğ’Ÿ</ci><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3">â€²</ci></apply></apply><ci id="S2.E1.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.1.1.3">ğ’®</ci></apply></apply></apply><ci id="S2.E1.m1.2.2.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.3">ğ›¿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\mathrm{Pr}[\mathcal{A}(\mathcal{D})\in\mathcal{S}]\leq e^{\epsilon}\cdot\mathrm{Pr}[\mathcal{A}(\mathcal{D^{\prime}})\in\mathcal{S}]+\delta.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.5" class="ltx_p">Training population <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D^{\prime}}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msup id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mo id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">â€²</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">â€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathcal{D^{\prime}}</annotation></semantics></math> is considered the neighbor of <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathcal{D}</annotation></semantics></math> if <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D^{\prime}}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msup id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">ğ’Ÿ</mi><mo id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">â€²</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">ğ’Ÿ</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">â€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathcal{D^{\prime}}</annotation></semantics></math> can be obtained by adding or removing one user from <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathcal{D}</annotation></semantics></math>, and vice versa.
The choice of <math id="S2.SS2.p2.5.m5.2" class="ltx_Math" alttext="(\epsilon,\delta)" display="inline"><semantics id="S2.SS2.p2.5.m5.2a"><mrow id="S2.SS2.p2.5.m5.2.3.2" xref="S2.SS2.p2.5.m5.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.5.m5.2.3.2.1" xref="S2.SS2.p2.5.m5.2.3.1.cmml">(</mo><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">Ïµ</mi><mo id="S2.SS2.p2.5.m5.2.3.2.2" xref="S2.SS2.p2.5.m5.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.5.m5.2.2" xref="S2.SS2.p2.5.m5.2.2.cmml">Î´</mi><mo stretchy="false" id="S2.SS2.p2.5.m5.2.3.2.3" xref="S2.SS2.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.2b"><interval closure="open" id="S2.SS2.p2.5.m5.2.3.1.cmml" xref="S2.SS2.p2.5.m5.2.3.2"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">italic-Ïµ</ci><ci id="S2.SS2.p2.5.m5.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2">ğ›¿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.2c">(\epsilon,\delta)</annotation></semantics></math> is a trade-off between accuracy and privacy.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.4" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">McMahan etÂ al. (<a href="#bib.bib18" title="" class="ltx_ref">2018</a>)</cite> proposed building a FL framework with DP, which moves the trust barrier to the user devices.
The interpretation of Equation <a href="#S2.E1" title="In Definition 1 â€£ 2.2 Differential Privacy â€£ 2 Preliminary â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> in the FL setup is that the participation of an individual user and its contribution cannot be detected or reverse-engineered by any means.
We call such systems Private Federated Learning (PFL) hereafter.
The Gaussian mechanism <cite class="ltx_cite ltx_citemacro_cite">Dwork and Roth (<a href="#bib.bib11" title="" class="ltx_ref">2014</a>)</cite> is widely adopted in PFL systems due to its simplicity and effectiveness.
On top of FL (<a href="#S2.SS1" title="2.1 Federated Learning â€£ 2 Preliminary â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>), for each iteration:</p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.4" class="ltx_p">Each sampled clientâ€™s model difference <math id="S2.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="\Delta_{t,i}" display="inline"><semantics id="S2.I1.i1.p1.1.m1.2a"><msub id="S2.I1.i1.p1.1.m1.2.3" xref="S2.I1.i1.p1.1.m1.2.3.cmml"><mi mathvariant="normal" id="S2.I1.i1.p1.1.m1.2.3.2" xref="S2.I1.i1.p1.1.m1.2.3.2.cmml">Î”</mi><mrow id="S2.I1.i1.p1.1.m1.2.2.2.4" xref="S2.I1.i1.p1.1.m1.2.2.2.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.1.1.cmml">t</mi><mo id="S2.I1.i1.p1.1.m1.2.2.2.4.1" xref="S2.I1.i1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.I1.i1.p1.1.m1.2.2.2.2" xref="S2.I1.i1.p1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.2b"><apply id="S2.I1.i1.p1.1.m1.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.2.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.2.3.2.cmml" xref="S2.I1.i1.p1.1.m1.2.3.2">Î”</ci><list id="S2.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.4"><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1">ğ‘¡</ci><ci id="S2.I1.i1.p1.1.m1.2.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2">ğ‘–</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.2c">\Delta_{t,i}</annotation></semantics></math> is clipped to a zero-centered <math id="S2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S2.I1.i1.p1.2.m2.1a"><msub id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml">L</mi><mn id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2">ğ¿</ci><cn type="integer" id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">L_{2}</annotation></semantics></math> ball with radius <math id="S2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.I1.i1.p1.3.m3.1a"><mi id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><ci id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">S</annotation></semantics></math> so as to bound the sensitivity of <math id="S2.I1.i1.p1.4.m4.2" class="ltx_Math" alttext="\Delta_{t,i}" display="inline"><semantics id="S2.I1.i1.p1.4.m4.2a"><msub id="S2.I1.i1.p1.4.m4.2.3" xref="S2.I1.i1.p1.4.m4.2.3.cmml"><mi mathvariant="normal" id="S2.I1.i1.p1.4.m4.2.3.2" xref="S2.I1.i1.p1.4.m4.2.3.2.cmml">Î”</mi><mrow id="S2.I1.i1.p1.4.m4.2.2.2.4" xref="S2.I1.i1.p1.4.m4.2.2.2.3.cmml"><mi id="S2.I1.i1.p1.4.m4.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.cmml">t</mi><mo id="S2.I1.i1.p1.4.m4.2.2.2.4.1" xref="S2.I1.i1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.I1.i1.p1.4.m4.2.2.2.2" xref="S2.I1.i1.p1.4.m4.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.2b"><apply id="S2.I1.i1.p1.4.m4.2.3.cmml" xref="S2.I1.i1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.2.3.1.cmml" xref="S2.I1.i1.p1.4.m4.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.2.3.2.cmml" xref="S2.I1.i1.p1.4.m4.2.3.2">Î”</ci><list id="S2.I1.i1.p1.4.m4.2.2.2.3.cmml" xref="S2.I1.i1.p1.4.m4.2.2.2.4"><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1">ğ‘¡</ci><ci id="S2.I1.i1.p1.4.m4.2.2.2.2.cmml" xref="S2.I1.i1.p1.4.m4.2.2.2.2">ğ‘–</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.2c">\Delta_{t,i}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.2" class="ltx_p">A Gaussian noise with covariance matrix <math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\sigma^{2}\mathcal{\textbf{I}}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><msup id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2.2" xref="S2.I1.i2.p1.1.m1.1.1.2.2.cmml">Ïƒ</mi><mn id="S2.I1.i2.p1.1.m1.1.1.2.3" xref="S2.I1.i2.p1.1.m1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.cmml">â€‹</mo><mtext class="ltx_mathvariant_bold" id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3a.cmml">I</mtext></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><times id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1"></times><apply id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">superscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2.2">ğœ</ci><cn type="integer" id="S2.I1.i2.p1.1.m1.1.1.2.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2.3">2</cn></apply><ci id="S2.I1.i2.p1.1.m1.1.1.3a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">I</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\sigma^{2}\mathcal{\textbf{I}}</annotation></semantics></math> is added to aggregation of <math id="S2.I1.i2.p1.2.m2.2" class="ltx_Math" alttext="\sum_{i\in\mathcal{C}}\Delta_{t,i}" display="inline"><semantics id="S2.I1.i2.p1.2.m2.2a"><mrow id="S2.I1.i2.p1.2.m2.2.3" xref="S2.I1.i2.p1.2.m2.2.3.cmml"><msub id="S2.I1.i2.p1.2.m2.2.3.1" xref="S2.I1.i2.p1.2.m2.2.3.1.cmml"><mo id="S2.I1.i2.p1.2.m2.2.3.1.2" xref="S2.I1.i2.p1.2.m2.2.3.1.2.cmml">âˆ‘</mo><mrow id="S2.I1.i2.p1.2.m2.2.3.1.3" xref="S2.I1.i2.p1.2.m2.2.3.1.3.cmml"><mi id="S2.I1.i2.p1.2.m2.2.3.1.3.2" xref="S2.I1.i2.p1.2.m2.2.3.1.3.2.cmml">i</mi><mo id="S2.I1.i2.p1.2.m2.2.3.1.3.1" xref="S2.I1.i2.p1.2.m2.2.3.1.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.2.m2.2.3.1.3.3" xref="S2.I1.i2.p1.2.m2.2.3.1.3.3.cmml">ğ’</mi></mrow></msub><msub id="S2.I1.i2.p1.2.m2.2.3.2" xref="S2.I1.i2.p1.2.m2.2.3.2.cmml"><mi mathvariant="normal" id="S2.I1.i2.p1.2.m2.2.3.2.2" xref="S2.I1.i2.p1.2.m2.2.3.2.2.cmml">Î”</mi><mrow id="S2.I1.i2.p1.2.m2.2.2.2.4" xref="S2.I1.i2.p1.2.m2.2.2.2.3.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="S2.I1.i2.p1.2.m2.2.2.2.4.1" xref="S2.I1.i2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S2.I1.i2.p1.2.m2.2.2.2.2" xref="S2.I1.i2.p1.2.m2.2.2.2.2.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.2b"><apply id="S2.I1.i2.p1.2.m2.2.3.cmml" xref="S2.I1.i2.p1.2.m2.2.3"><apply id="S2.I1.i2.p1.2.m2.2.3.1.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.2.3.1.1.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1">subscript</csymbol><sum id="S2.I1.i2.p1.2.m2.2.3.1.2.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1.2"></sum><apply id="S2.I1.i2.p1.2.m2.2.3.1.3.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1.3"><in id="S2.I1.i2.p1.2.m2.2.3.1.3.1.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1.3.1"></in><ci id="S2.I1.i2.p1.2.m2.2.3.1.3.2.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1.3.2">ğ‘–</ci><ci id="S2.I1.i2.p1.2.m2.2.3.1.3.3.cmml" xref="S2.I1.i2.p1.2.m2.2.3.1.3.3">ğ’</ci></apply></apply><apply id="S2.I1.i2.p1.2.m2.2.3.2.cmml" xref="S2.I1.i2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.2.3.2.1.cmml" xref="S2.I1.i2.p1.2.m2.2.3.2">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.2.3.2.2.cmml" xref="S2.I1.i2.p1.2.m2.2.3.2.2">Î”</ci><list id="S2.I1.i2.p1.2.m2.2.2.2.3.cmml" xref="S2.I1.i2.p1.2.m2.2.2.2.4"><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1">ğ‘¡</ci><ci id="S2.I1.i2.p1.2.m2.2.2.2.2.cmml" xref="S2.I1.i2.p1.2.m2.2.2.2.2">ğ‘–</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.2c">\sum_{i\in\mathcal{C}}\Delta_{t,i}</annotation></semantics></math>.</p>
</div>
</li>
</ol>
<p id="S2.SS2.p3.3" class="ltx_p">The noise standard deviation is calibrated by the moment accountantÂ <cite class="ltx_cite ltx_citemacro_cite">Abadi etÂ al. (<a href="#bib.bib1" title="" class="ltx_ref">2016</a>); Mironov (<a href="#bib.bib20" title="" class="ltx_ref">2017</a>); Mironov etÂ al. (<a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite> with fixed sampling rate <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">q</annotation></semantics></math> (fraction of clients sampled in each iteration), number of training iterations <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">T</annotation></semantics></math>, and privacy budgets <math id="S2.SS2.p3.3.m3.2" class="ltx_Math" alttext="(\epsilon,\delta)" display="inline"><semantics id="S2.SS2.p3.3.m3.2a"><mrow id="S2.SS2.p3.3.m3.2.3.2" xref="S2.SS2.p3.3.m3.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p3.3.m3.2.3.2.1" xref="S2.SS2.p3.3.m3.2.3.1.cmml">(</mo><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">Ïµ</mi><mo id="S2.SS2.p3.3.m3.2.3.2.2" xref="S2.SS2.p3.3.m3.2.3.1.cmml">,</mo><mi id="S2.SS2.p3.3.m3.2.2" xref="S2.SS2.p3.3.m3.2.2.cmml">Î´</mi><mo stretchy="false" id="S2.SS2.p3.3.m3.2.3.2.3" xref="S2.SS2.p3.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.2b"><interval closure="open" id="S2.SS2.p3.3.m3.2.3.1.cmml" xref="S2.SS2.p3.3.m3.2.3.2"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">italic-Ïµ</ci><ci id="S2.SS2.p3.3.m3.2.2.cmml" xref="S2.SS2.p3.3.m3.2.2">ğ›¿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.2c">(\epsilon,\delta)</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Partial Embedding Updates</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">Word frequency in natural language is highly skewed and long-tailed, and signal-to-DP-noise ratio (SNR) for rare words is thus insignificant.
We propose partial embedding updates (PEU), a sampling-based payload for the word embeddings.
At a high level, the server samples <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">m</annotation></semantics></math> words from the vocabulary.
Each device trains the full model but only sends back the updates for the sampled words.
DP noise is added to the update of these <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">m</annotation></semantics></math> words.
The update of unsampled words will be zero with no noise added.
Let</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.2" class="ltx_p"><math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="R(w)" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.2" xref="S3.I1.i1.p1.1.m1.1.2.cmml"><mi id="S3.I1.i1.p1.1.m1.1.2.2" xref="S3.I1.i1.p1.1.m1.1.2.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.2.1" xref="S3.I1.i1.p1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S3.I1.i1.p1.1.m1.1.2.3.2" xref="S3.I1.i1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.I1.i1.p1.1.m1.1.2.3.2.1" xref="S3.I1.i1.p1.1.m1.1.2.cmml">(</mo><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.I1.i1.p1.1.m1.1.2.3.2.2" xref="S3.I1.i1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.2"><times id="S3.I1.i1.p1.1.m1.1.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.2.1"></times><ci id="S3.I1.i1.p1.1.m1.1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.2.2">ğ‘…</ci><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">R(w)</annotation></semantics></math> be the probability of word <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">w</annotation></semantics></math> being sampled in each central iteration,</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.2" class="ltx_p"><math id="S3.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="Z\in\{0,1\}" display="inline"><semantics id="S3.I1.i2.p1.1.m1.2a"><mrow id="S3.I1.i2.p1.1.m1.2.3" xref="S3.I1.i2.p1.1.m1.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.2.3.2" xref="S3.I1.i2.p1.1.m1.2.3.2.cmml">Z</mi><mo id="S3.I1.i2.p1.1.m1.2.3.1" xref="S3.I1.i2.p1.1.m1.2.3.1.cmml">âˆˆ</mo><mrow id="S3.I1.i2.p1.1.m1.2.3.3.2" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.2.3.3.2.1" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">0</mn><mo id="S3.I1.i2.p1.1.m1.2.3.3.2.2" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.I1.i2.p1.1.m1.2.2" xref="S3.I1.i2.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.I1.i2.p1.1.m1.2.3.3.2.3" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.2b"><apply id="S3.I1.i2.p1.1.m1.2.3.cmml" xref="S3.I1.i2.p1.1.m1.2.3"><in id="S3.I1.i2.p1.1.m1.2.3.1.cmml" xref="S3.I1.i2.p1.1.m1.2.3.1"></in><ci id="S3.I1.i2.p1.1.m1.2.3.2.cmml" xref="S3.I1.i2.p1.1.m1.2.3.2">ğ‘</ci><set id="S3.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="S3.I1.i2.p1.1.m1.2.3.3.2"><cn type="integer" id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">0</cn><cn type="integer" id="S3.I1.i2.p1.1.m1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.2c">Z\in\{0,1\}</annotation></semantics></math> be a Bernoulli random variable where <math id="S3.I1.i2.p1.2.m2.2" class="ltx_Math" alttext="P(Z=1)=R(w)" display="inline"><semantics id="S3.I1.i2.p1.2.m2.2a"><mrow id="S3.I1.i2.p1.2.m2.2.2" xref="S3.I1.i2.p1.2.m2.2.2.cmml"><mrow id="S3.I1.i2.p1.2.m2.2.2.1" xref="S3.I1.i2.p1.2.m2.2.2.1.cmml"><mi id="S3.I1.i2.p1.2.m2.2.2.1.3" xref="S3.I1.i2.p1.2.m2.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.2.m2.2.2.1.2" xref="S3.I1.i2.p1.2.m2.2.2.1.2.cmml">â€‹</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i2.p1.2.m2.2.2.1.1.1.2" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml">Z</mi><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.cmml">=</mo><mn id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.3" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.I1.i2.p1.2.m2.2.2.1.1.1.3" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i2.p1.2.m2.2.2.2" xref="S3.I1.i2.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.3" xref="S3.I1.i2.p1.2.m2.2.2.3.cmml"><mi id="S3.I1.i2.p1.2.m2.2.2.3.2" xref="S3.I1.i2.p1.2.m2.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.2.m2.2.2.3.1" xref="S3.I1.i2.p1.2.m2.2.2.3.1.cmml">â€‹</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.3.3.2" xref="S3.I1.i2.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.I1.i2.p1.2.m2.2.2.3.3.2.1" xref="S3.I1.i2.p1.2.m2.2.2.3.cmml">(</mo><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">w</mi><mo stretchy="false" id="S3.I1.i2.p1.2.m2.2.2.3.3.2.2" xref="S3.I1.i2.p1.2.m2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.2b"><apply id="S3.I1.i2.p1.2.m2.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2"><eq id="S3.I1.i2.p1.2.m2.2.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.2"></eq><apply id="S3.I1.i2.p1.2.m2.2.2.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1"><times id="S3.I1.i2.p1.2.m2.2.2.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.2"></times><ci id="S3.I1.i2.p1.2.m2.2.2.1.3.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.3">ğ‘ƒ</ci><apply id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1"><eq id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1"></eq><ci id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2">ğ‘</ci><cn type="integer" id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.3">1</cn></apply></apply><apply id="S3.I1.i2.p1.2.m2.2.2.3.cmml" xref="S3.I1.i2.p1.2.m2.2.2.3"><times id="S3.I1.i2.p1.2.m2.2.2.3.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.3.1"></times><ci id="S3.I1.i2.p1.2.m2.2.2.3.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.3.2">ğ‘…</ci><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">ğ‘¤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.2c">P(Z=1)=R(w)</annotation></semantics></math>, and</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.3" class="ltx_p"><math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="E_{w}" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><msub id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">E</mi><mi id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">ğ¸</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">E_{w}</annotation></semantics></math> and <math id="S3.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="E_{w}^{0}" display="inline"><semantics id="S3.I1.i3.p1.2.m2.1a"><msubsup id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml"><mi id="S3.I1.i3.p1.2.m2.1.1.2.2" xref="S3.I1.i3.p1.2.m2.1.1.2.2.cmml">E</mi><mi id="S3.I1.i3.p1.2.m2.1.1.2.3" xref="S3.I1.i3.p1.2.m2.1.1.2.3.cmml">w</mi><mn id="S3.I1.i3.p1.2.m2.1.1.3" xref="S3.I1.i3.p1.2.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b"><apply id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.I1.i3.p1.2.m2.1.1.2.cmml" xref="S3.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.1.1.2.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.2.m2.1.1.2.2.cmml" xref="S3.I1.i3.p1.2.m2.1.1.2.2">ğ¸</ci><ci id="S3.I1.i3.p1.2.m2.1.1.2.3.cmml" xref="S3.I1.i3.p1.2.m2.1.1.2.3">ğ‘¤</ci></apply><cn type="integer" id="S3.I1.i3.p1.2.m2.1.1.3.cmml" xref="S3.I1.i3.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">E_{w}^{0}</annotation></semantics></math> be the word vector of <math id="S3.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.I1.i3.p1.3.m3.1a"><mi id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.1b"><ci id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.1c">w</annotation></semantics></math> <span id="S3.I1.i3.p1.3.1" class="ltx_text ltx_font_bold">after</span> and <span id="S3.I1.i3.p1.3.2" class="ltx_text ltx_font_bold">before</span> local update respectively,</p>
</div>
</li>
</ul>
<p id="S3.SS1.p1.3" class="ltx_p">which allows us to rewrite the gradient of <math id="S3.SS1.p1.3.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.3.m1.1a"><mi id="S3.SS1.p1.3.m1.1.1" xref="S3.SS1.p1.3.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><ci id="S3.SS1.p1.3.m1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">w</annotation></semantics></math> as</p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle E_{w}-E_{w}^{0}={}" display="inline"><semantics id="S3.E2X.2.1.1.m1.1a"><mrow id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml"><mrow id="S3.E2X.2.1.1.m1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.2.cmml"><msub id="S3.E2X.2.1.1.m1.1.1.2.2" xref="S3.E2X.2.1.1.m1.1.1.2.2.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.2.2.2" xref="S3.E2X.2.1.1.m1.1.1.2.2.2.cmml">E</mi><mi id="S3.E2X.2.1.1.m1.1.1.2.2.3" xref="S3.E2X.2.1.1.m1.1.1.2.2.3.cmml">w</mi></msub><mo id="S3.E2X.2.1.1.m1.1.1.2.1" xref="S3.E2X.2.1.1.m1.1.1.2.1.cmml">âˆ’</mo><msubsup id="S3.E2X.2.1.1.m1.1.1.2.3" xref="S3.E2X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.2.3.2.2" xref="S3.E2X.2.1.1.m1.1.1.2.3.2.2.cmml">E</mi><mi id="S3.E2X.2.1.1.m1.1.1.2.3.2.3" xref="S3.E2X.2.1.1.m1.1.1.2.3.2.3.cmml">w</mi><mn id="S3.E2X.2.1.1.m1.1.1.2.3.3" xref="S3.E2X.2.1.1.m1.1.1.2.3.3.cmml">0</mn></msubsup></mrow><mo id="S3.E2X.2.1.1.m1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E2X.2.1.1.m1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.1b"><apply id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1"><eq id="S3.E2X.2.1.1.m1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1"></eq><apply id="S3.E2X.2.1.1.m1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2"><minus id="S3.E2X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.1"></minus><apply id="S3.E2X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.2">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.2.2">ğ¸</ci><ci id="S3.E2X.2.1.1.m1.1.1.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.2.3">ğ‘¤</ci></apply><apply id="S3.E2X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.2.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.2.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3.2.2">ğ¸</ci><ci id="S3.E2X.2.1.1.m1.1.1.2.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3.2.3">ğ‘¤</ci></apply><cn type="integer" id="S3.E2X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.2.3.3">0</cn></apply></apply><csymbol cd="latexml" id="S3.E2X.2.1.1.m1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.1c">\displaystyle E_{w}-E_{w}^{0}={}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle R(w)\frac{1}{R(w)}(E_{w}-E_{w}^{0})" display="inline"><semantics id="S3.E2X.3.2.2.m1.3a"><mrow id="S3.E2X.3.2.2.m1.3.3" xref="S3.E2X.3.2.2.m1.3.3.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.3" xref="S3.E2X.3.2.2.m1.3.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E2X.3.2.2.m1.3.3.2" xref="S3.E2X.3.2.2.m1.3.3.2.cmml">â€‹</mo><mrow id="S3.E2X.3.2.2.m1.3.3.4.2" xref="S3.E2X.3.2.2.m1.3.3.cmml"><mo stretchy="false" id="S3.E2X.3.2.2.m1.3.3.4.2.1" xref="S3.E2X.3.2.2.m1.3.3.cmml">(</mo><mi id="S3.E2X.3.2.2.m1.2.2" xref="S3.E2X.3.2.2.m1.2.2.cmml">w</mi><mo stretchy="false" id="S3.E2X.3.2.2.m1.3.3.4.2.2" xref="S3.E2X.3.2.2.m1.3.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2X.3.2.2.m1.3.3.2a" xref="S3.E2X.3.2.2.m1.3.3.2.cmml">â€‹</mo><mstyle displaystyle="true" id="S3.E2X.3.2.2.m1.1.1" xref="S3.E2X.3.2.2.m1.1.1.cmml"><mfrac id="S3.E2X.3.2.2.m1.1.1a" xref="S3.E2X.3.2.2.m1.1.1.cmml"><mn id="S3.E2X.3.2.2.m1.1.1.3" xref="S3.E2X.3.2.2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2X.3.2.2.m1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.1.1.1.3" xref="S3.E2X.3.2.2.m1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E2X.3.2.2.m1.1.1.1.2" xref="S3.E2X.3.2.2.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2X.3.2.2.m1.1.1.1.4.2" xref="S3.E2X.3.2.2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E2X.3.2.2.m1.1.1.1.4.2.1" xref="S3.E2X.3.2.2.m1.1.1.1.cmml">(</mo><mi id="S3.E2X.3.2.2.m1.1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E2X.3.2.2.m1.1.1.1.4.2.2" xref="S3.E2X.3.2.2.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2X.3.2.2.m1.3.3.2b" xref="S3.E2X.3.2.2.m1.3.3.2.cmml">â€‹</mo><mrow id="S3.E2X.3.2.2.m1.3.3.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E2X.3.2.2.m1.3.3.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E2X.3.2.2.m1.3.3.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.cmml"><msub id="S3.E2X.3.2.2.m1.3.3.1.1.1.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.2.cmml">E</mi><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.3.cmml">w</mi></msub><mo id="S3.E2X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1.cmml">âˆ’</mo><msubsup id="S3.E2X.3.2.2.m1.3.3.1.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.cmml"><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.2" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.2.cmml">E</mi><mi id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.3.cmml">w</mi><mn id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.3.cmml">0</mn></msubsup></mrow><mo stretchy="false" id="S3.E2X.3.2.2.m1.3.3.1.1.3" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.3.2.2.m1.3b"><apply id="S3.E2X.3.2.2.m1.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3"><times id="S3.E2X.3.2.2.m1.3.3.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.2"></times><ci id="S3.E2X.3.2.2.m1.3.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.3">ğ‘…</ci><ci id="S3.E2X.3.2.2.m1.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2">ğ‘¤</ci><apply id="S3.E2X.3.2.2.m1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1"><divide id="S3.E2X.3.2.2.m1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.1.1"></divide><cn type="integer" id="S3.E2X.3.2.2.m1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.1.1.3">1</cn><apply id="S3.E2X.3.2.2.m1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1.1"><times id="S3.E2X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.2"></times><ci id="S3.E2X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.3">ğ‘…</ci><ci id="S3.E2X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1">ğ‘¤</ci></apply></apply><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1"><minus id="S3.E2X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.1"></minus><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.2">ğ¸</ci><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.2.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.2.3">ğ‘¤</ci></apply><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.1.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.2.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.2">ğ¸</ci><ci id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.2.3">ğ‘¤</ci></apply><cn type="integer" id="S3.E2X.3.2.2.m1.3.3.1.1.1.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.3.2.2.m1.3c">\displaystyle R(w)\frac{1}{R(w)}(E_{w}-E_{w}^{0})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle={}" display="inline"><semantics id="S3.E2Xa.2.1.1.m1.1a"><mo id="S3.E2Xa.2.1.1.m1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.1b"><eq id="S3.E2Xa.2.1.1.m1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.1c">\displaystyle={}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle P(Z=1)\cdot\frac{1}{R(w)}(E_{w}-E_{w}^{0})" display="inline"><semantics id="S3.E2Xa.3.2.2.m1.3a"><mrow id="S3.E2Xa.3.2.2.m1.3.3" xref="S3.E2Xa.3.2.2.m1.3.3.cmml"><mrow id="S3.E2Xa.3.2.2.m1.2.2.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.cmml"><mrow id="S3.E2Xa.3.2.2.m1.2.2.1.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E2Xa.3.2.2.m1.2.2.1.1.3" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.3.2.2.m1.2.2.1.1.2" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.2.cmml">â€‹</mo><mrow id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">Z</mi><mo id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">=</mo><mn id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E2Xa.3.2.2.m1.2.2.1.2" xref="S3.E2Xa.3.2.2.m1.2.2.1.2.cmml">â‹…</mo><mstyle displaystyle="true" id="S3.E2Xa.3.2.2.m1.1.1" xref="S3.E2Xa.3.2.2.m1.1.1.cmml"><mfrac id="S3.E2Xa.3.2.2.m1.1.1a" xref="S3.E2Xa.3.2.2.m1.1.1.cmml"><mn id="S3.E2Xa.3.2.2.m1.1.1.3" xref="S3.E2Xa.3.2.2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2Xa.3.2.2.m1.1.1.1" xref="S3.E2Xa.3.2.2.m1.1.1.1.cmml"><mi id="S3.E2Xa.3.2.2.m1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.3.2.2.m1.1.1.1.2" xref="S3.E2Xa.3.2.2.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2Xa.3.2.2.m1.1.1.1.4.2" xref="S3.E2Xa.3.2.2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.1.1.1.4.2.1" xref="S3.E2Xa.3.2.2.m1.1.1.1.cmml">(</mo><mi id="S3.E2Xa.3.2.2.m1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.1.1.1.4.2.2" xref="S3.E2Xa.3.2.2.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="S3.E2Xa.3.2.2.m1.3.3.3" xref="S3.E2Xa.3.2.2.m1.3.3.3.cmml">â€‹</mo><mrow id="S3.E2Xa.3.2.2.m1.3.3.2.1" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.3.3.2.1.2" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.cmml">(</mo><mrow id="S3.E2Xa.3.2.2.m1.3.3.2.1.1" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.cmml"><msub id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.cmml"><mi id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.2" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.2.cmml">E</mi><mi id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.3" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.3.cmml">w</mi></msub><mo id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.1" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.1.cmml">âˆ’</mo><msubsup id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.cmml"><mi id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.2" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.2.cmml">E</mi><mi id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.3" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.3.cmml">w</mi><mn id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.3" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.3.cmml">0</mn></msubsup></mrow><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.3.3.2.1.3" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.3.2.2.m1.3b"><apply id="S3.E2Xa.3.2.2.m1.3.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3"><times id="S3.E2Xa.3.2.2.m1.3.3.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.3"></times><apply id="S3.E2Xa.3.2.2.m1.2.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1"><ci id="S3.E2Xa.3.2.2.m1.2.2.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.2">â‹…</ci><apply id="S3.E2Xa.3.2.2.m1.2.2.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1"><times id="S3.E2Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.2"></times><ci id="S3.E2Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.3">ğ‘ƒ</ci><apply id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1"><eq id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1"></eq><ci id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2">ğ‘</ci><cn type="integer" id="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E2Xa.3.2.2.m1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.1.1"><divide id="S3.E2Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.1.1"></divide><cn type="integer" id="S3.E2Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.3">1</cn><apply id="S3.E2Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.1"><times id="S3.E2Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.1.2"></times><ci id="S3.E2Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.1.3">ğ‘…</ci><ci id="S3.E2Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.1.1">ğ‘¤</ci></apply></apply></apply><apply id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1"><minus id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.1"></minus><apply id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2">subscript</csymbol><ci id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.2.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.2">ğ¸</ci><ci id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.2.3">ğ‘¤</ci></apply><apply id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.1.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3">superscript</csymbol><apply id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3">subscript</csymbol><ci id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.2.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.2">ğ¸</ci><ci id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.2.3">ğ‘¤</ci></apply><cn type="integer" id="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3.2.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.3.2.2.m1.3c">\displaystyle P(Z=1)\cdot\frac{1}{R(w)}(E_{w}-E_{w}^{0})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle+P(Z=0)\cdot\textbf{0}" display="inline"><semantics id="S3.E2Xb.2.1.1.m1.1a"><mrow id="S3.E2Xb.2.1.1.m1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.cmml"><mo id="S3.E2Xb.2.1.1.m1.1.1a" xref="S3.E2Xb.2.1.1.m1.1.1.cmml">+</mo><mrow id="S3.E2Xb.2.1.1.m1.1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E2Xb.2.1.1.m1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E2Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">Z</mi><mo id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E2Xb.2.1.1.m1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.1.1.1.2.cmml">â‹…</mo><mtext class="ltx_mathvariant_bold" id="S3.E2Xb.2.1.1.m1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.1.1.1.3a.cmml">0</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xb.2.1.1.m1.1b"><apply id="S3.E2Xb.2.1.1.m1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1"><plus id="S3.E2Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.1.1"></plus><apply id="S3.E2Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1"><ci id="S3.E2Xb.2.1.1.m1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.2">â‹…</ci><apply id="S3.E2Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1"><times id="S3.E2Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.2"></times><ci id="S3.E2Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.3">ğ‘ƒ</ci><apply id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1"><eq id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2">ğ‘</ci><cn type="integer" id="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3">0</cn></apply></apply><ci id="S3.E2Xb.2.1.1.m1.1.1.1.3a.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E2Xb.2.1.1.m1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.1.1.1.3">0</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xb.2.1.1.m1.1c">\displaystyle+P(Z=0)\cdot\textbf{0}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E2Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle={}" display="inline"><semantics id="S3.E2Xc.2.1.1.m1.1a"><mo id="S3.E2Xc.2.1.1.m1.1.1" xref="S3.E2Xc.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E2Xc.2.1.1.m1.1b"><eq id="S3.E2Xc.2.1.1.m1.1.1.cmml" xref="S3.E2Xc.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xc.2.1.1.m1.1c">\displaystyle={}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xc.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\mathbb{E}_{z\sim P}[\frac{z}{R(w)}(E_{w}-E_{w}^{0})]" display="inline"><semantics id="S3.E2Xc.3.2.2.m1.2a"><mrow id="S3.E2Xc.3.2.2.m1.2.2" xref="S3.E2Xc.3.2.2.m1.2.2.cmml"><msub id="S3.E2Xc.3.2.2.m1.2.2.3" xref="S3.E2Xc.3.2.2.m1.2.2.3.cmml"><mi id="S3.E2Xc.3.2.2.m1.2.2.3.2" xref="S3.E2Xc.3.2.2.m1.2.2.3.2.cmml">ğ”¼</mi><mrow id="S3.E2Xc.3.2.2.m1.2.2.3.3" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.cmml"><mi id="S3.E2Xc.3.2.2.m1.2.2.3.3.2" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.2.cmml">z</mi><mo id="S3.E2Xc.3.2.2.m1.2.2.3.3.1" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.1.cmml">âˆ¼</mo><mi id="S3.E2Xc.3.2.2.m1.2.2.3.3.3" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.3.cmml">P</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2Xc.3.2.2.m1.2.2.2" xref="S3.E2Xc.3.2.2.m1.2.2.2.cmml">â€‹</mo><mrow id="S3.E2Xc.3.2.2.m1.2.2.1.1" xref="S3.E2Xc.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.2.2.1.1.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.2.1.cmml">[</mo><mrow id="S3.E2Xc.3.2.2.m1.2.2.1.1.1" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2Xc.3.2.2.m1.1.1" xref="S3.E2Xc.3.2.2.m1.1.1.cmml"><mfrac id="S3.E2Xc.3.2.2.m1.1.1a" xref="S3.E2Xc.3.2.2.m1.1.1.cmml"><mi id="S3.E2Xc.3.2.2.m1.1.1.3" xref="S3.E2Xc.3.2.2.m1.1.1.3.cmml">z</mi><mrow id="S3.E2Xc.3.2.2.m1.1.1.1" xref="S3.E2Xc.3.2.2.m1.1.1.1.cmml"><mi id="S3.E2Xc.3.2.2.m1.1.1.1.3" xref="S3.E2Xc.3.2.2.m1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E2Xc.3.2.2.m1.1.1.1.2" xref="S3.E2Xc.3.2.2.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2Xc.3.2.2.m1.1.1.1.4.2" xref="S3.E2Xc.3.2.2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.1.1.1.4.2.1" xref="S3.E2Xc.3.2.2.m1.1.1.1.cmml">(</mo><mi id="S3.E2Xc.3.2.2.m1.1.1.1.1" xref="S3.E2Xc.3.2.2.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.1.1.1.4.2.2" xref="S3.E2Xc.3.2.2.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">âˆ’</mo><msubsup id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">E</mi><mi id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">w</mi><mn id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml">0</mn></msubsup></mrow><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2Xc.3.2.2.m1.2.2.1.1.3" xref="S3.E2Xc.3.2.2.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xc.3.2.2.m1.2b"><apply id="S3.E2Xc.3.2.2.m1.2.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2"><times id="S3.E2Xc.3.2.2.m1.2.2.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.2"></times><apply id="S3.E2Xc.3.2.2.m1.2.2.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E2Xc.3.2.2.m1.2.2.3.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3">subscript</csymbol><ci id="S3.E2Xc.3.2.2.m1.2.2.3.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3.2">ğ”¼</ci><apply id="S3.E2Xc.3.2.2.m1.2.2.3.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3.3"><csymbol cd="latexml" id="S3.E2Xc.3.2.2.m1.2.2.3.3.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.1">similar-to</csymbol><ci id="S3.E2Xc.3.2.2.m1.2.2.3.3.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.2">ğ‘§</ci><ci id="S3.E2Xc.3.2.2.m1.2.2.3.3.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.3.3.3">ğ‘ƒ</ci></apply></apply><apply id="S3.E2Xc.3.2.2.m1.2.2.1.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1"><csymbol cd="latexml" id="S3.E2Xc.3.2.2.m1.2.2.1.2.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1"><times id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.E2Xc.3.2.2.m1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.1.1"><divide id="S3.E2Xc.3.2.2.m1.1.1.2.cmml" xref="S3.E2Xc.3.2.2.m1.1.1"></divide><ci id="S3.E2Xc.3.2.2.m1.1.1.3.cmml" xref="S3.E2Xc.3.2.2.m1.1.1.3">ğ‘§</ci><apply id="S3.E2Xc.3.2.2.m1.1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.1.1.1"><times id="S3.E2Xc.3.2.2.m1.1.1.1.2.cmml" xref="S3.E2Xc.3.2.2.m1.1.1.1.2"></times><ci id="S3.E2Xc.3.2.2.m1.1.1.1.3.cmml" xref="S3.E2Xc.3.2.2.m1.1.1.1.3">ğ‘…</ci><ci id="S3.E2Xc.3.2.2.m1.1.1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.1.1.1.1">ğ‘¤</ci></apply></apply><apply id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1"><minus id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2">ğ¸</ci><ci id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.3">ğ‘¤</ci></apply><apply id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2">ğ¸</ci><ci id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3">ğ‘¤</ci></apply><cn type="integer" id="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xc.3.2.2.m1.2c">\displaystyle\mathbb{E}_{z\sim P}[\frac{z}{R(w)}(E_{w}-E_{w}^{0})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p1.11" class="ltx_p">with <math id="S3.SS1.p1.4.m1.2" class="ltx_Math" alttext="R(w)=P(w\in\mathcal{W})" display="inline"><semantics id="S3.SS1.p1.4.m1.2a"><mrow id="S3.SS1.p1.4.m1.2.2" xref="S3.SS1.p1.4.m1.2.2.cmml"><mrow id="S3.SS1.p1.4.m1.2.2.3" xref="S3.SS1.p1.4.m1.2.2.3.cmml"><mi id="S3.SS1.p1.4.m1.2.2.3.2" xref="S3.SS1.p1.4.m1.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m1.2.2.3.1" xref="S3.SS1.p1.4.m1.2.2.3.1.cmml">â€‹</mo><mrow id="S3.SS1.p1.4.m1.2.2.3.3.2" xref="S3.SS1.p1.4.m1.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m1.2.2.3.3.2.1" xref="S3.SS1.p1.4.m1.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.4.m1.1.1" xref="S3.SS1.p1.4.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.4.m1.2.2.3.3.2.2" xref="S3.SS1.p1.4.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.4.m1.2.2.2" xref="S3.SS1.p1.4.m1.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.4.m1.2.2.1" xref="S3.SS1.p1.4.m1.2.2.1.cmml"><mi id="S3.SS1.p1.4.m1.2.2.1.3" xref="S3.SS1.p1.4.m1.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m1.2.2.1.2" xref="S3.SS1.p1.4.m1.2.2.1.2.cmml">â€‹</mo><mrow id="S3.SS1.p1.4.m1.2.2.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m1.2.2.1.1.1.2" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.4.m1.2.2.1.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m1.2.2.1.1.1.1.2" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.2.cmml">w</mi><mo id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m1.2.2.1.1.1.1.3" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.3.cmml">ğ’²</mi></mrow><mo stretchy="false" id="S3.SS1.p1.4.m1.2.2.1.1.1.3" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.2b"><apply id="S3.SS1.p1.4.m1.2.2.cmml" xref="S3.SS1.p1.4.m1.2.2"><eq id="S3.SS1.p1.4.m1.2.2.2.cmml" xref="S3.SS1.p1.4.m1.2.2.2"></eq><apply id="S3.SS1.p1.4.m1.2.2.3.cmml" xref="S3.SS1.p1.4.m1.2.2.3"><times id="S3.SS1.p1.4.m1.2.2.3.1.cmml" xref="S3.SS1.p1.4.m1.2.2.3.1"></times><ci id="S3.SS1.p1.4.m1.2.2.3.2.cmml" xref="S3.SS1.p1.4.m1.2.2.3.2">ğ‘…</ci><ci id="S3.SS1.p1.4.m1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1">ğ‘¤</ci></apply><apply id="S3.SS1.p1.4.m1.2.2.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1"><times id="S3.SS1.p1.4.m1.2.2.1.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.2"></times><ci id="S3.SS1.p1.4.m1.2.2.1.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3">ğ‘ƒ</ci><apply id="S3.SS1.p1.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1"><in id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1"></in><ci id="S3.SS1.p1.4.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.2">ğ‘¤</ci><ci id="S3.SS1.p1.4.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.3">ğ’²</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.2c">R(w)=P(w\in\mathcal{W})</annotation></semantics></math> where <math id="S3.SS1.p1.5.m2.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS1.p1.5.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml">ğ’²</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><ci id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">ğ’²</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">\mathcal{W}</annotation></semantics></math> is a set of <math id="S3.SS1.p1.6.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.6.m3.1a"><mi id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.1b"><ci id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.1c">m</annotation></semantics></math> words sampled with some distribution <math id="S3.SS1.p1.7.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.7.m4.1a"><mi id="S3.SS1.p1.7.m4.1.1" xref="S3.SS1.p1.7.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m4.1b"><ci id="S3.SS1.p1.7.m4.1.1.cmml" xref="S3.SS1.p1.7.m4.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m4.1c">Q</annotation></semantics></math> without replacement.
<math id="S3.SS1.p1.8.m5.1" class="ltx_Math" alttext="R(w)" display="inline"><semantics id="S3.SS1.p1.8.m5.1a"><mrow id="S3.SS1.p1.8.m5.1.2" xref="S3.SS1.p1.8.m5.1.2.cmml"><mi id="S3.SS1.p1.8.m5.1.2.2" xref="S3.SS1.p1.8.m5.1.2.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m5.1.2.1" xref="S3.SS1.p1.8.m5.1.2.1.cmml">â€‹</mo><mrow id="S3.SS1.p1.8.m5.1.2.3.2" xref="S3.SS1.p1.8.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m5.1.2.3.2.1" xref="S3.SS1.p1.8.m5.1.2.cmml">(</mo><mi id="S3.SS1.p1.8.m5.1.1" xref="S3.SS1.p1.8.m5.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.8.m5.1.2.3.2.2" xref="S3.SS1.p1.8.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m5.1b"><apply id="S3.SS1.p1.8.m5.1.2.cmml" xref="S3.SS1.p1.8.m5.1.2"><times id="S3.SS1.p1.8.m5.1.2.1.cmml" xref="S3.SS1.p1.8.m5.1.2.1"></times><ci id="S3.SS1.p1.8.m5.1.2.2.cmml" xref="S3.SS1.p1.8.m5.1.2.2">ğ‘…</ci><ci id="S3.SS1.p1.8.m5.1.1.cmml" xref="S3.SS1.p1.8.m5.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m5.1c">R(w)</annotation></semantics></math> does not seem to have a closed-form distribution if we choose a unigram distribution for <math id="S3.SS1.p1.9.m6.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.9.m6.1a"><mi id="S3.SS1.p1.9.m6.1.1" xref="S3.SS1.p1.9.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m6.1b"><ci id="S3.SS1.p1.9.m6.1.1.cmml" xref="S3.SS1.p1.9.m6.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m6.1c">Q</annotation></semantics></math>.
To make the computation tractable, in the actual implementation shown in Algorithm <a href="#alg1" title="Algorithm 1 â€£ 3.1 Partial Embedding Updates â€£ 3 Methods â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the expectation in Equation <a href="#S3.E2" title="In 3.1 Partial Embedding Updates â€£ 3 Methods â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is replaced by its Monte Carlo approximation and <math id="S3.SS1.p1.10.m7.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.10.m7.1a"><mi id="S3.SS1.p1.10.m7.1.1" xref="S3.SS1.p1.10.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m7.1b"><ci id="S3.SS1.p1.10.m7.1.1.cmml" xref="S3.SS1.p1.10.m7.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m7.1c">Q</annotation></semantics></math> is used to approximate <math id="S3.SS1.p1.11.m8.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.p1.11.m8.1a"><mi id="S3.SS1.p1.11.m8.1.1" xref="S3.SS1.p1.11.m8.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m8.1b"><ci id="S3.SS1.p1.11.m8.1.1.cmml" xref="S3.SS1.p1.11.m8.1.1">ğ‘…</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m8.1c">R</annotation></semantics></math>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Partial Embedding Updates on Client</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">procedure</span>Â <span id="alg1.l1.2" class="ltx_text ltx_font_smallcaps">PEU</span>(<math id="alg1.l1.m1.2" class="ltx_Math" alttext="model,\mathcal{W}" display="inline"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.1" xref="alg1.l1.m1.2.2.2.cmml"><mrow id="alg1.l1.m1.2.2.1.1" xref="alg1.l1.m1.2.2.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.2" xref="alg1.l1.m1.2.2.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.cmml">â€‹</mo><mi id="alg1.l1.m1.2.2.1.1.3" xref="alg1.l1.m1.2.2.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.1.1a" xref="alg1.l1.m1.2.2.1.1.1.cmml">â€‹</mo><mi id="alg1.l1.m1.2.2.1.1.4" xref="alg1.l1.m1.2.2.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.1.1b" xref="alg1.l1.m1.2.2.1.1.1.cmml">â€‹</mo><mi id="alg1.l1.m1.2.2.1.1.5" xref="alg1.l1.m1.2.2.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.1.1c" xref="alg1.l1.m1.2.2.1.1.1.cmml">â€‹</mo><mi id="alg1.l1.m1.2.2.1.1.6" xref="alg1.l1.m1.2.2.1.1.6.cmml">l</mi></mrow><mo id="alg1.l1.m1.2.2.1.2" xref="alg1.l1.m1.2.2.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">ğ’²</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><list id="alg1.l1.m1.2.2.2.cmml" xref="alg1.l1.m1.2.2.1"><apply id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1.1"><times id="alg1.l1.m1.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1"></times><ci id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.2">ğ‘š</ci><ci id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.3">ğ‘œ</ci><ci id="alg1.l1.m1.2.2.1.1.4.cmml" xref="alg1.l1.m1.2.2.1.1.4">ğ‘‘</ci><ci id="alg1.l1.m1.2.2.1.1.5.cmml" xref="alg1.l1.m1.2.2.1.1.5">ğ‘’</ci><ci id="alg1.l1.m1.2.2.1.1.6.cmml" xref="alg1.l1.m1.2.2.1.1.6">ğ‘™</ci></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ğ’²</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">model,\mathcal{W}</annotation></semantics></math>)

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>Â Â Â Â Â <math id="alg1.l2.m1.3" class="ltx_Math" alttext="\Delta_{E},\Delta_{other}\leftarrow SGD(model)" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml"><mrow id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.3.cmml"><msub id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l2.m1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.2.cmml">Î”</mi><mi id="alg1.l2.m1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.3.cmml">E</mi></msub><mo id="alg1.l2.m1.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="alg1.l2.m1.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.cmml">Î”</mi><mrow id="alg1.l2.m1.2.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.2.2.2.3.2" xref="alg1.l2.m1.2.2.2.2.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2.2.2.3.1" xref="alg1.l2.m1.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l2.m1.2.2.2.2.2.3.3" xref="alg1.l2.m1.2.2.2.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2.2.2.3.1a" xref="alg1.l2.m1.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l2.m1.2.2.2.2.2.3.4" xref="alg1.l2.m1.2.2.2.2.2.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2.2.2.3.1b" xref="alg1.l2.m1.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l2.m1.2.2.2.2.2.3.5" xref="alg1.l2.m1.2.2.2.2.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2.2.2.3.1c" xref="alg1.l2.m1.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l2.m1.2.2.2.2.2.3.6" xref="alg1.l2.m1.2.2.2.2.2.3.6.cmml">r</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.l2.m1.3.3.4" xref="alg1.l2.m1.3.3.4.cmml">â†</mo><mrow id="alg1.l2.m1.3.3.3" xref="alg1.l2.m1.3.3.3.cmml"><mi id="alg1.l2.m1.3.3.3.3" xref="alg1.l2.m1.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.2" xref="alg1.l2.m1.3.3.3.2.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.4" xref="alg1.l2.m1.3.3.3.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.2a" xref="alg1.l2.m1.3.3.3.2.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.5" xref="alg1.l2.m1.3.3.3.5.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.2b" xref="alg1.l2.m1.3.3.3.2.cmml">â€‹</mo><mrow id="alg1.l2.m1.3.3.3.1.1" xref="alg1.l2.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.3.3.3.1.1.2" xref="alg1.l2.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l2.m1.3.3.3.1.1.1" xref="alg1.l2.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.3.1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.1.1.1.1" xref="alg1.l2.m1.3.3.3.1.1.1.1.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.1.1.1.3" xref="alg1.l2.m1.3.3.3.1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.1.1.1.1a" xref="alg1.l2.m1.3.3.3.1.1.1.1.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.1.1.1.4" xref="alg1.l2.m1.3.3.3.1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.1.1.1.1b" xref="alg1.l2.m1.3.3.3.1.1.1.1.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.1.1.1.5" xref="alg1.l2.m1.3.3.3.1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.3.3.3.1.1.1.1c" xref="alg1.l2.m1.3.3.3.1.1.1.1.cmml">â€‹</mo><mi id="alg1.l2.m1.3.3.3.1.1.1.6" xref="alg1.l2.m1.3.3.3.1.1.1.6.cmml">l</mi></mrow><mo stretchy="false" id="alg1.l2.m1.3.3.3.1.1.3" xref="alg1.l2.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"><ci id="alg1.l2.m1.3.3.4.cmml" xref="alg1.l2.m1.3.3.4">â†</ci><list id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2"><apply id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.2">Î”</ci><ci id="alg1.l2.m1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.3">ğ¸</ci></apply><apply id="alg1.l2.m1.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m1.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2">Î”</ci><apply id="alg1.l2.m1.2.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.3"><times id="alg1.l2.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l2.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.2">ğ‘œ</ci><ci id="alg1.l2.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.3">ğ‘¡</ci><ci id="alg1.l2.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.4">â„</ci><ci id="alg1.l2.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.5">ğ‘’</ci><ci id="alg1.l2.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l2.m1.2.2.2.2.2.3.6">ğ‘Ÿ</ci></apply></apply></list><apply id="alg1.l2.m1.3.3.3.cmml" xref="alg1.l2.m1.3.3.3"><times id="alg1.l2.m1.3.3.3.2.cmml" xref="alg1.l2.m1.3.3.3.2"></times><ci id="alg1.l2.m1.3.3.3.3.cmml" xref="alg1.l2.m1.3.3.3.3">ğ‘†</ci><ci id="alg1.l2.m1.3.3.3.4.cmml" xref="alg1.l2.m1.3.3.3.4">ğº</ci><ci id="alg1.l2.m1.3.3.3.5.cmml" xref="alg1.l2.m1.3.3.3.5">ğ·</ci><apply id="alg1.l2.m1.3.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.3.1.1"><times id="alg1.l2.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.1"></times><ci id="alg1.l2.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.2">ğ‘š</ci><ci id="alg1.l2.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.3">ğ‘œ</ci><ci id="alg1.l2.m1.3.3.3.1.1.1.4.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.4">ğ‘‘</ci><ci id="alg1.l2.m1.3.3.3.1.1.1.5.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.5">ğ‘’</ci><ci id="alg1.l2.m1.3.3.3.1.1.1.6.cmml" xref="alg1.l2.m1.3.3.3.1.1.1.6">ğ‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">\Delta_{E},\Delta_{other}\leftarrow SGD(model)</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>Â Â Â Â Â <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\Delta_{E}^{\prime}\leftarrow newArray()" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msubsup id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l3.m1.1.1.2.2.2" xref="alg1.l3.m1.1.1.2.2.2.cmml">Î”</mi><mi id="alg1.l3.m1.1.1.2.2.3" xref="alg1.l3.m1.1.1.2.2.3.cmml">E</mi><mo id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">â€²</mo></msubsup><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">â†</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1a" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.4" xref="alg1.l3.m1.1.1.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1b" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.5" xref="alg1.l3.m1.1.1.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1c" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.6" xref="alg1.l3.m1.1.1.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1d" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.7" xref="alg1.l3.m1.1.1.3.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1e" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.8" xref="alg1.l3.m1.1.1.3.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1f" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l3.m1.1.1.3.9" xref="alg1.l3.m1.1.1.3.9.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1g" xref="alg1.l3.m1.1.1.3.1.cmml">â€‹</mo><mrow id="alg1.l3.m1.1.1.3.10.2" xref="alg1.l3.m1.1.1.3.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.3.10.2.1" xref="alg1.l3.m1.1.1.3.10.1.cmml">(</mo><mo stretchy="false" id="alg1.l3.m1.1.1.3.10.2.2" xref="alg1.l3.m1.1.1.3.10.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">â†</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">superscript</csymbol><apply id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.2.cmml" xref="alg1.l3.m1.1.1.2.2.2">Î”</ci><ci id="alg1.l3.m1.1.1.2.2.3.cmml" xref="alg1.l3.m1.1.1.2.2.3">ğ¸</ci></apply><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">â€²</ci></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">ğ‘›</ci><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">ğ‘’</ci><ci id="alg1.l3.m1.1.1.3.4.cmml" xref="alg1.l3.m1.1.1.3.4">ğ‘¤</ci><ci id="alg1.l3.m1.1.1.3.5.cmml" xref="alg1.l3.m1.1.1.3.5">ğ´</ci><ci id="alg1.l3.m1.1.1.3.6.cmml" xref="alg1.l3.m1.1.1.3.6">ğ‘Ÿ</ci><ci id="alg1.l3.m1.1.1.3.7.cmml" xref="alg1.l3.m1.1.1.3.7">ğ‘Ÿ</ci><ci id="alg1.l3.m1.1.1.3.8.cmml" xref="alg1.l3.m1.1.1.3.8">ğ‘</ci><ci id="alg1.l3.m1.1.1.3.9.cmml" xref="alg1.l3.m1.1.1.3.9">ğ‘¦</ci><list id="alg1.l3.m1.1.1.3.10.1.cmml" xref="alg1.l3.m1.1.1.3.10.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\Delta_{E}^{\prime}\leftarrow newArray()</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>Â Â Â Â Â <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l4.m1.1" class="ltx_Math" alttext="w\in sampledWords" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">w</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">âˆˆ</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1b" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.5" xref="alg1.l4.m1.1.1.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1c" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.6" xref="alg1.l4.m1.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1d" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.7" xref="alg1.l4.m1.1.1.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1e" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.8" xref="alg1.l4.m1.1.1.3.8.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1f" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.9" xref="alg1.l4.m1.1.1.3.9.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1g" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.10" xref="alg1.l4.m1.1.1.3.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1h" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.11" xref="alg1.l4.m1.1.1.3.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1i" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.12" xref="alg1.l4.m1.1.1.3.12.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1j" xref="alg1.l4.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l4.m1.1.1.3.13" xref="alg1.l4.m1.1.1.3.13.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">ğ‘¤</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">ğ‘ </ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">ğ‘</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">ğ‘š</ci><ci id="alg1.l4.m1.1.1.3.5.cmml" xref="alg1.l4.m1.1.1.3.5">ğ‘</ci><ci id="alg1.l4.m1.1.1.3.6.cmml" xref="alg1.l4.m1.1.1.3.6">ğ‘™</ci><ci id="alg1.l4.m1.1.1.3.7.cmml" xref="alg1.l4.m1.1.1.3.7">ğ‘’</ci><ci id="alg1.l4.m1.1.1.3.8.cmml" xref="alg1.l4.m1.1.1.3.8">ğ‘‘</ci><ci id="alg1.l4.m1.1.1.3.9.cmml" xref="alg1.l4.m1.1.1.3.9">ğ‘Š</ci><ci id="alg1.l4.m1.1.1.3.10.cmml" xref="alg1.l4.m1.1.1.3.10">ğ‘œ</ci><ci id="alg1.l4.m1.1.1.3.11.cmml" xref="alg1.l4.m1.1.1.3.11">ğ‘Ÿ</ci><ci id="alg1.l4.m1.1.1.3.12.cmml" xref="alg1.l4.m1.1.1.3.12">ğ‘‘</ci><ci id="alg1.l4.m1.1.1.3.13.cmml" xref="alg1.l4.m1.1.1.3.13">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">w\in sampledWords</annotation></semantics></math>Â <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>Â Â Â Â Â Â Â Â Â <math id="alg1.l5.m1.3" class="ltx_Math" alttext="append(\frac{1}{Q(w)}\Delta_{E_{w}},\Delta_{E}^{\prime})" display="inline"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><mi id="alg1.l5.m1.3.3.4" xref="alg1.l5.m1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mi id="alg1.l5.m1.3.3.5" xref="alg1.l5.m1.3.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3a" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mi id="alg1.l5.m1.3.3.6" xref="alg1.l5.m1.3.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3b" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mi id="alg1.l5.m1.3.3.7" xref="alg1.l5.m1.3.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3c" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mi id="alg1.l5.m1.3.3.8" xref="alg1.l5.m1.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3d" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mi id="alg1.l5.m1.3.3.9" xref="alg1.l5.m1.3.3.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.3e" xref="alg1.l5.m1.3.3.3.cmml">â€‹</mo><mrow id="alg1.l5.m1.3.3.2.2" xref="alg1.l5.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.3.3.2.2.3" xref="alg1.l5.m1.3.3.2.3.cmml">(</mo><mrow id="alg1.l5.m1.2.2.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.cmml"><mfrac id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">â€‹</mo><mrow id="alg1.l5.m1.1.1.1.4.2" xref="alg1.l5.m1.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.4.2.1" xref="alg1.l5.m1.1.1.1.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1.4.2.2" xref="alg1.l5.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l5.m1.2.2.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.cmml">â€‹</mo><msub id="alg1.l5.m1.2.2.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l5.m1.2.2.1.1.1.2.2" xref="alg1.l5.m1.2.2.1.1.1.2.2.cmml">Î”</mi><msub id="alg1.l5.m1.2.2.1.1.1.2.3" xref="alg1.l5.m1.2.2.1.1.1.2.3.cmml"><mi id="alg1.l5.m1.2.2.1.1.1.2.3.2" xref="alg1.l5.m1.2.2.1.1.1.2.3.2.cmml">E</mi><mi id="alg1.l5.m1.2.2.1.1.1.2.3.3" xref="alg1.l5.m1.2.2.1.1.1.2.3.3.cmml">w</mi></msub></msub></mrow><mo id="alg1.l5.m1.3.3.2.2.4" xref="alg1.l5.m1.3.3.2.3.cmml">,</mo><msubsup id="alg1.l5.m1.3.3.2.2.2" xref="alg1.l5.m1.3.3.2.2.2.cmml"><mi mathvariant="normal" id="alg1.l5.m1.3.3.2.2.2.2.2" xref="alg1.l5.m1.3.3.2.2.2.2.2.cmml">Î”</mi><mi id="alg1.l5.m1.3.3.2.2.2.2.3" xref="alg1.l5.m1.3.3.2.2.2.2.3.cmml">E</mi><mo id="alg1.l5.m1.3.3.2.2.2.3" xref="alg1.l5.m1.3.3.2.2.2.3.cmml">â€²</mo></msubsup><mo stretchy="false" id="alg1.l5.m1.3.3.2.2.5" xref="alg1.l5.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><times id="alg1.l5.m1.3.3.3.cmml" xref="alg1.l5.m1.3.3.3"></times><ci id="alg1.l5.m1.3.3.4.cmml" xref="alg1.l5.m1.3.3.4">ğ‘</ci><ci id="alg1.l5.m1.3.3.5.cmml" xref="alg1.l5.m1.3.3.5">ğ‘</ci><ci id="alg1.l5.m1.3.3.6.cmml" xref="alg1.l5.m1.3.3.6">ğ‘</ci><ci id="alg1.l5.m1.3.3.7.cmml" xref="alg1.l5.m1.3.3.7">ğ‘’</ci><ci id="alg1.l5.m1.3.3.8.cmml" xref="alg1.l5.m1.3.3.8">ğ‘›</ci><ci id="alg1.l5.m1.3.3.9.cmml" xref="alg1.l5.m1.3.3.9">ğ‘‘</ci><interval closure="open" id="alg1.l5.m1.3.3.2.3.cmml" xref="alg1.l5.m1.3.3.2.2"><apply id="alg1.l5.m1.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1"><times id="alg1.l5.m1.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1"></times><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><divide id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"></divide><cn type="integer" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">1</cn><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">ğ‘„</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">ğ‘¤</ci></apply></apply><apply id="alg1.l5.m1.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.2.2">Î”</ci><apply id="alg1.l5.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.2.3.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.2.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.1.2.3.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.2.3.2">ğ¸</ci><ci id="alg1.l5.m1.2.2.1.1.1.2.3.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.2.3.3">ğ‘¤</ci></apply></apply></apply><apply id="alg1.l5.m1.3.3.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.2.2.2">superscript</csymbol><apply id="alg1.l5.m1.3.3.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2.2.2">Î”</ci><ci id="alg1.l5.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.2.2.2.2.3">ğ¸</ci></apply><ci id="alg1.l5.m1.3.3.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.2.2.2.3">â€²</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">append(\frac{1}{Q(w)}\Delta_{E_{w}},\Delta_{E}^{\prime})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>Â Â Â Â Â <span id="alg1.l6.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>Â Â Â Â Â <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\Delta_{model}\leftarrow concat(\Delta_{E}^{\prime},\Delta_{other})" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msub id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"><mi mathvariant="normal" id="alg1.l7.m1.2.2.4.2" xref="alg1.l7.m1.2.2.4.2.cmml">Î”</mi><mrow id="alg1.l7.m1.2.2.4.3" xref="alg1.l7.m1.2.2.4.3.cmml"><mi id="alg1.l7.m1.2.2.4.3.2" xref="alg1.l7.m1.2.2.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.4.3.1" xref="alg1.l7.m1.2.2.4.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.4.3.3" xref="alg1.l7.m1.2.2.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.4.3.1a" xref="alg1.l7.m1.2.2.4.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.4.3.4" xref="alg1.l7.m1.2.2.4.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.4.3.1b" xref="alg1.l7.m1.2.2.4.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.4.3.5" xref="alg1.l7.m1.2.2.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.4.3.1c" xref="alg1.l7.m1.2.2.4.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.4.3.6" xref="alg1.l7.m1.2.2.4.3.6.cmml">l</mi></mrow></msub><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">â†</mo><mrow id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.4" xref="alg1.l7.m1.2.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.5" xref="alg1.l7.m1.2.2.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3a" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.6" xref="alg1.l7.m1.2.2.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3b" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.7" xref="alg1.l7.m1.2.2.2.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3c" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.8" xref="alg1.l7.m1.2.2.2.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3d" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.9" xref="alg1.l7.m1.2.2.2.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3e" xref="alg1.l7.m1.2.2.2.3.cmml">â€‹</mo><mrow id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml">Î”</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml">E</mi><mo id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">â€²</mo></msubsup><mo id="alg1.l7.m1.2.2.2.2.2.4" xref="alg1.l7.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="alg1.l7.m1.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.cmml">Î”</mi><mrow id="alg1.l7.m1.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.3.2" xref="alg1.l7.m1.2.2.2.2.2.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3.1" xref="alg1.l7.m1.2.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.2.2.2.3.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3.1a" xref="alg1.l7.m1.2.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.2.2.2.3.4" xref="alg1.l7.m1.2.2.2.2.2.2.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3.1b" xref="alg1.l7.m1.2.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.2.2.2.3.5" xref="alg1.l7.m1.2.2.2.2.2.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3.1c" xref="alg1.l7.m1.2.2.2.2.2.2.3.1.cmml">â€‹</mo><mi id="alg1.l7.m1.2.2.2.2.2.2.3.6" xref="alg1.l7.m1.2.2.2.2.2.2.3.6.cmml">r</mi></mrow></msub><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.5" xref="alg1.l7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">â†</ci><apply id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.4.1.cmml" xref="alg1.l7.m1.2.2.4">subscript</csymbol><ci id="alg1.l7.m1.2.2.4.2.cmml" xref="alg1.l7.m1.2.2.4.2">Î”</ci><apply id="alg1.l7.m1.2.2.4.3.cmml" xref="alg1.l7.m1.2.2.4.3"><times id="alg1.l7.m1.2.2.4.3.1.cmml" xref="alg1.l7.m1.2.2.4.3.1"></times><ci id="alg1.l7.m1.2.2.4.3.2.cmml" xref="alg1.l7.m1.2.2.4.3.2">ğ‘š</ci><ci id="alg1.l7.m1.2.2.4.3.3.cmml" xref="alg1.l7.m1.2.2.4.3.3">ğ‘œ</ci><ci id="alg1.l7.m1.2.2.4.3.4.cmml" xref="alg1.l7.m1.2.2.4.3.4">ğ‘‘</ci><ci id="alg1.l7.m1.2.2.4.3.5.cmml" xref="alg1.l7.m1.2.2.4.3.5">ğ‘’</ci><ci id="alg1.l7.m1.2.2.4.3.6.cmml" xref="alg1.l7.m1.2.2.4.3.6">ğ‘™</ci></apply></apply><apply id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2"><times id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.3"></times><ci id="alg1.l7.m1.2.2.2.4.cmml" xref="alg1.l7.m1.2.2.2.4">ğ‘</ci><ci id="alg1.l7.m1.2.2.2.5.cmml" xref="alg1.l7.m1.2.2.2.5">ğ‘œ</ci><ci id="alg1.l7.m1.2.2.2.6.cmml" xref="alg1.l7.m1.2.2.2.6">ğ‘›</ci><ci id="alg1.l7.m1.2.2.2.7.cmml" xref="alg1.l7.m1.2.2.2.7">ğ‘</ci><ci id="alg1.l7.m1.2.2.2.8.cmml" xref="alg1.l7.m1.2.2.2.8">ğ‘</ci><ci id="alg1.l7.m1.2.2.2.9.cmml" xref="alg1.l7.m1.2.2.2.9">ğ‘¡</ci><interval closure="open" id="alg1.l7.m1.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">Î”</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.3">ğ¸</ci></apply><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">â€²</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2">Î”</ci><apply id="alg1.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3"><times id="alg1.l7.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.1"></times><ci id="alg1.l7.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.2">ğ‘œ</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.3">ğ‘¡</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.4.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.4">â„</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.5.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.5">ğ‘’</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.6.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3.6">ğ‘Ÿ</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\Delta_{model}\leftarrow concat(\Delta_{E}^{\prime},\Delta_{other})</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>Â Â Â Â Â Send payload <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\Delta_{model}" display="inline"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">Î”</mi><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.1a" xref="alg1.l8.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l8.m1.1.1.3.4" xref="alg1.l8.m1.1.1.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.1b" xref="alg1.l8.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l8.m1.1.1.3.5" xref="alg1.l8.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.1c" xref="alg1.l8.m1.1.1.3.1.cmml">â€‹</mo><mi id="alg1.l8.m1.1.1.3.6" xref="alg1.l8.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">Î”</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><times id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">ğ‘š</ci><ci id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">ğ‘œ</ci><ci id="alg1.l8.m1.1.1.3.4.cmml" xref="alg1.l8.m1.1.1.3.4">ğ‘‘</ci><ci id="alg1.l8.m1.1.1.3.5.cmml" xref="alg1.l8.m1.1.1.3.5">ğ‘’</ci><ci id="alg1.l8.m1.1.1.3.6.cmml" xref="alg1.l8.m1.1.1.3.6">ğ‘™</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\Delta_{model}</annotation></semantics></math> to the server

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l9.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The dimension reduction of PEU benefits the PFL system in two important ways.
First, it decouples the model complexity requirement and the network requirement.
The number <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation></semantics></math> of sampled words can be determined by the payload budget.
Second, it increases the overall SNR because DP noise grows with the size of the model and tail words are less affected by DP noise.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Low-Rank Adaptation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Hu etÂ al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> developed LoRA, a generalized reparameterization approach to mitigate the immense memory requirement of fine-tuning large neural networks.
Since the major goal of LoRA is shrinking the trainable dimension, it benefits PFL in a similar fashion.
Prior to training, each dense matrix <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="W\in\mathbb{R}^{m\times n}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">W</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.3.3.1" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">Ã—</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">ğ‘Š</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">â„</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">ğ‘š</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">W\in\mathbb{R}^{m\times n}</annotation></semantics></math> is reformulated as a summation.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="W^{\prime}=W+L\cdot R" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msup id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">W</mi><mo id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml">â€²</mo></msup><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">W</mi><mo id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml">â‹…</mo><mi id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml">R</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">ğ‘Š</ci><ci id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3">â€²</ci></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><plus id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></plus><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">ğ‘Š</ci><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><ci id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1">â‹…</ci><ci id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2">ğ¿</ci><ci id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3">ğ‘…</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">W^{\prime}=W+L\cdot R</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.9" class="ltx_p">where <math id="S3.SS2.p1.2.m1.1" class="ltx_Math" alttext="L\in\mathbb{R}^{m\times r}" display="inline"><semantics id="S3.SS2.p1.2.m1.1a"><mrow id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml"><mi id="S3.SS2.p1.2.m1.1.1.2" xref="S3.SS2.p1.2.m1.1.1.2.cmml">L</mi><mo id="S3.SS2.p1.2.m1.1.1.1" xref="S3.SS2.p1.2.m1.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.p1.2.m1.1.1.3" xref="S3.SS2.p1.2.m1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m1.1.1.3.2" xref="S3.SS2.p1.2.m1.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.p1.2.m1.1.1.3.3" xref="S3.SS2.p1.2.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.2.m1.1.1.3.3.2" xref="S3.SS2.p1.2.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m1.1.1.3.3.1" xref="S3.SS2.p1.2.m1.1.1.3.3.1.cmml">Ã—</mo><mi id="S3.SS2.p1.2.m1.1.1.3.3.3" xref="S3.SS2.p1.2.m1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><apply id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1"><in id="S3.SS2.p1.2.m1.1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1.1"></in><ci id="S3.SS2.p1.2.m1.1.1.2.cmml" xref="S3.SS2.p1.2.m1.1.1.2">ğ¿</ci><apply id="S3.SS2.p1.2.m1.1.1.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m1.1.1.3.2">â„</ci><apply id="S3.SS2.p1.2.m1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3.3"><times id="S3.SS2.p1.2.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.2.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m1.1.1.3.3.2">ğ‘š</ci><ci id="S3.SS2.p1.2.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3.3.3">ğ‘Ÿ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">L\in\mathbb{R}^{m\times r}</annotation></semantics></math> is zero-initialized and <math id="S3.SS2.p1.3.m2.1" class="ltx_Math" alttext="R\in\mathbb{R}^{r\times n}" display="inline"><semantics id="S3.SS2.p1.3.m2.1a"><mrow id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml"><mi id="S3.SS2.p1.3.m2.1.1.2" xref="S3.SS2.p1.3.m2.1.1.2.cmml">R</mi><mo id="S3.SS2.p1.3.m2.1.1.1" xref="S3.SS2.p1.3.m2.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS2.p1.3.m2.1.1.3" xref="S3.SS2.p1.3.m2.1.1.3.cmml"><mi id="S3.SS2.p1.3.m2.1.1.3.2" xref="S3.SS2.p1.3.m2.1.1.3.2.cmml">â„</mi><mrow id="S3.SS2.p1.3.m2.1.1.3.3" xref="S3.SS2.p1.3.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.3.m2.1.1.3.3.2" xref="S3.SS2.p1.3.m2.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.3.m2.1.1.3.3.1" xref="S3.SS2.p1.3.m2.1.1.3.3.1.cmml">Ã—</mo><mi id="S3.SS2.p1.3.m2.1.1.3.3.3" xref="S3.SS2.p1.3.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><apply id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1"><in id="S3.SS2.p1.3.m2.1.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1.1"></in><ci id="S3.SS2.p1.3.m2.1.1.2.cmml" xref="S3.SS2.p1.3.m2.1.1.2">ğ‘…</ci><apply id="S3.SS2.p1.3.m2.1.1.3.cmml" xref="S3.SS2.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m2.1.1.3.1.cmml" xref="S3.SS2.p1.3.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m2.1.1.3.2.cmml" xref="S3.SS2.p1.3.m2.1.1.3.2">â„</ci><apply id="S3.SS2.p1.3.m2.1.1.3.3.cmml" xref="S3.SS2.p1.3.m2.1.1.3.3"><times id="S3.SS2.p1.3.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.3.m2.1.1.3.3.1"></times><ci id="S3.SS2.p1.3.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.3.m2.1.1.3.3.2">ğ‘Ÿ</ci><ci id="S3.SS2.p1.3.m2.1.1.3.3.3.cmml" xref="S3.SS2.p1.3.m2.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">R\in\mathbb{R}^{r\times n}</annotation></semantics></math> is randomly initialized.
Typically <math id="S3.SS2.p1.4.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.p1.4.m3.1a"><mi id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><ci id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">ğ‘Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">r</annotation></semantics></math> is one or two orders of magnitudes smaller than <math id="S3.SS2.p1.5.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p1.5.m4.1a"><mi id="S3.SS2.p1.5.m4.1.1" xref="S3.SS2.p1.5.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m4.1b"><ci id="S3.SS2.p1.5.m4.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m4.1c">m</annotation></semantics></math> and <math id="S3.SS2.p1.6.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p1.6.m5.1a"><mi id="S3.SS2.p1.6.m5.1.1" xref="S3.SS2.p1.6.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m5.1b"><ci id="S3.SS2.p1.6.m5.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m5.1c">n</annotation></semantics></math>.
<math id="S3.SS2.p1.7.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p1.7.m6.1a"><mi id="S3.SS2.p1.7.m6.1.1" xref="S3.SS2.p1.7.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m6.1b"><ci id="S3.SS2.p1.7.m6.1.1.cmml" xref="S3.SS2.p1.7.m6.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m6.1c">L</annotation></semantics></math> and <math id="S3.SS2.p1.8.m7.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.p1.8.m7.1a"><mi id="S3.SS2.p1.8.m7.1.1" xref="S3.SS2.p1.8.m7.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m7.1b"><ci id="S3.SS2.p1.8.m7.1.1.cmml" xref="S3.SS2.p1.8.m7.1.1">ğ‘…</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m7.1c">R</annotation></semantics></math> are trainable, and <math id="S3.SS2.p1.9.m8.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.9.m8.1a"><mi id="S3.SS2.p1.9.m8.1.1" xref="S3.SS2.p1.9.m8.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m8.1b"><ci id="S3.SS2.p1.9.m8.1.1.cmml" xref="S3.SS2.p1.9.m8.1.1">ğ‘Š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m8.1c">W</annotation></semantics></math> is frozen.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Exponentially-decayed Moving Average</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.5" class="ltx_p">Exponentially-decayed moving average (EMA) of trained model parameters often boosts the model performance in practiceÂ <cite class="ltx_cite ltx_citemacro_cite">Martens (<a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>.
To apply EMA in private federated learning, the server maintains an additional set of model parameters <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\phi</annotation></semantics></math> and updates <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\phi</annotation></semantics></math> each central iteration after the model parameters <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\theta</annotation></semantics></math> are updated.
Specifically, at central iteration <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">t</annotation></semantics></math>, <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\phi</annotation></semantics></math> is updated as</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\phi_{t+1}\leftarrow\gamma\phi_{t}+(1-\gamma)\theta_{t+1}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">Ï•</mi><mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.3.3.1" xref="S3.E4.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">â†</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">Î³</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">â€‹</mo><msub id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.3.3.2.cmml">Ï•</mi><mi id="S3.E4.m1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.3.3.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">Î³</mi></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">â€‹</mo><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">Î¸</mi><mrow id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">â†</ci><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">italic-Ï•</ci><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><plus id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1"></plus><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">ğ‘¡</ci><cn type="integer" id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><plus id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><times id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></times><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">ğ›¾</ci><apply id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2">italic-Ï•</ci><ci id="S3.E4.m1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3.3">ğ‘¡</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">ğ›¾</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ğœƒ</ci><apply id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><plus id="S3.E4.m1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1"></plus><ci id="S3.E4.m1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.2">ğ‘¡</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\phi_{t+1}\leftarrow\gamma\phi_{t}+(1-\gamma)\theta_{t+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.9" class="ltx_p">where <math id="S3.SS3.p1.6.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS3.p1.6.m1.1a"><mi id="S3.SS3.p1.6.m1.1.1" xref="S3.SS3.p1.6.m1.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m1.1b"><ci id="S3.SS3.p1.6.m1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m1.1c">\gamma</annotation></semantics></math> is the decaying rate between 0 and 1. The averaged parameters <math id="S3.SS3.p1.7.m2.1" class="ltx_Math" alttext="\phi_{t}" display="inline"><semantics id="S3.SS3.p1.7.m2.1a"><msub id="S3.SS3.p1.7.m2.1.1" xref="S3.SS3.p1.7.m2.1.1.cmml"><mi id="S3.SS3.p1.7.m2.1.1.2" xref="S3.SS3.p1.7.m2.1.1.2.cmml">Ï•</mi><mi id="S3.SS3.p1.7.m2.1.1.3" xref="S3.SS3.p1.7.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m2.1b"><apply id="S3.SS3.p1.7.m2.1.1.cmml" xref="S3.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m2.1.1.1.cmml" xref="S3.SS3.p1.7.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m2.1.1.2.cmml" xref="S3.SS3.p1.7.m2.1.1.2">italic-Ï•</ci><ci id="S3.SS3.p1.7.m2.1.1.3.cmml" xref="S3.SS3.p1.7.m2.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m2.1c">\phi_{t}</annotation></semantics></math> can potentially generalize better than model parameters <math id="S3.SS3.p1.8.m3.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S3.SS3.p1.8.m3.1a"><msub id="S3.SS3.p1.8.m3.1.1" xref="S3.SS3.p1.8.m3.1.1.cmml"><mi id="S3.SS3.p1.8.m3.1.1.2" xref="S3.SS3.p1.8.m3.1.1.2.cmml">Î¸</mi><mi id="S3.SS3.p1.8.m3.1.1.3" xref="S3.SS3.p1.8.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m3.1b"><apply id="S3.SS3.p1.8.m3.1.1.cmml" xref="S3.SS3.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m3.1.1.1.cmml" xref="S3.SS3.p1.8.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m3.1.1.2.cmml" xref="S3.SS3.p1.8.m3.1.1.2">ğœƒ</ci><ci id="S3.SS3.p1.8.m3.1.1.3.cmml" xref="S3.SS3.p1.8.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m3.1c">\theta_{t}</annotation></semantics></math> at any single iteration <math id="S3.SS3.p1.9.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.9.m4.1a"><mi id="S3.SS3.p1.9.m4.1.1" xref="S3.SS3.p1.9.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m4.1b"><ci id="S3.SS3.p1.9.m4.1.1.cmml" xref="S3.SS3.p1.9.m4.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m4.1c">t</annotation></semantics></math>.
Analogous to momentum SGD, EMA of the model parameters stabilizes the DP-noise during training and leads to quicker and sometimes better convergence.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Noise Contrastive Estimation</h3>

<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.4.5.1" class="ltx_tr">
<th id="S3.T1.4.5.1.1" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt"></th>
<th id="S3.T1.4.5.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S3.T1.4.5.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.5.1.2.1.1" class="ltx_p" style="width:52.0pt;"><span id="S3.T1.4.5.1.2.1.1.1" class="ltx_text ltx_font_bold">SoftMax</span></span>
</span>
</th>
<th id="S3.T1.4.5.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S3.T1.4.5.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.5.1.3.1.1" class="ltx_p" style="width:52.0pt;"><span id="S3.T1.4.5.1.3.1.1.1" class="ltx_text ltx_font_bold">NCE</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.4.6.1" class="ltx_tr">
<td id="S3.T1.4.6.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.4.6.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.6.1.1.1.1" class="ltx_p" style="width:65.0pt;">embed param</span>
</span>
</td>
<td id="S3.T1.4.6.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T1.4.6.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.6.1.2.1.1" class="ltx_p" style="width:52.0pt;">98 MB</span>
</span>
</td>
<td id="S3.T1.4.6.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T1.4.6.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.6.1.3.1.1" class="ltx_p" style="width:52.0pt;">98 MB</span>
</span>
</td>
</tr>
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S3.T1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.2.1.1" class="ltx_p" style="width:65.0pt;">gradient</span>
</span>
</td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S3.T1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.3.1.1" class="ltx_p" style="width:52.0pt;">98 MB</span>
</span>
</td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.1.1.1" class="ltx_p" style="width:52.0pt;"><math id="S3.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.T1.1.1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.m1.1b"><lt id="S3.T1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.m1.1c">&lt;</annotation></semantics></math> 1 MB</span>
</span>
</td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S3.T1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.2.2.1.1" class="ltx_p" style="width:65.0pt;">outputs</span>
</span>
</td>
<td id="S3.T1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S3.T1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.2.3.1.1" class="ltx_p" style="width:52.0pt;">200 MB</span>
</span>
</td>
<td id="S3.T1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.2.1.1.1" class="ltx_p" style="width:52.0pt;"><math id="S3.T1.2.2.1.1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.T1.2.2.1.1.1.m1.1a"><mo id="S3.T1.2.2.1.1.1.m1.1.1" xref="S3.T1.2.2.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.1.1.m1.1b"><lt id="S3.T1.2.2.1.1.1.m1.1.1.cmml" xref="S3.T1.2.2.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.1.1.m1.1c">&lt;</annotation></semantics></math> 5 MB</span>
</span>
</td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<td id="S3.T1.4.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t">
<span id="S3.T1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.4.3.1.1" class="ltx_p" style="width:65.0pt;"><span id="S3.T1.4.4.3.1.1.1" class="ltx_text ltx_font_bold">total</span></span>
</span>
</td>
<td id="S3.T1.3.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t">
<span id="S3.T1.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.1.1.1" class="ltx_p" style="width:52.0pt;"><math id="S3.T1.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S3.T1.3.3.1.1.1.m1.1a"><mo id="S3.T1.3.3.1.1.1.m1.1.1" xref="S3.T1.3.3.1.1.1.m1.1.1.cmml">â‰ˆ</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.1.1.m1.1b"><approx id="S3.T1.3.3.1.1.1.m1.1.1.cmml" xref="S3.T1.3.3.1.1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.1.1.m1.1c">\approx</annotation></semantics></math> 300 MB <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We assume SoftMax is implemented as in-place as possible and reuses output buffer for backpropagation. The gap is much larger in practice.</span></span></span></span>
</span>
</td>
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S3.T1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.4.2.1.1" class="ltx_p" style="width:52.0pt;"><math id="S3.T1.4.4.2.1.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S3.T1.4.4.2.1.1.m1.1a"><mo id="S3.T1.4.4.2.1.1.m1.1.1" xref="S3.T1.4.4.2.1.1.m1.1.1.cmml">â‰ˆ</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.2.1.1.m1.1b"><approx id="S3.T1.4.4.2.1.1.m1.1.1.cmml" xref="S3.T1.4.4.2.1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.2.1.1.m1.1c">\approx</annotation></semantics></math> 100 MB</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Word embedding memory requirement between SoftMax and NCE, assuming a <math id="S3.T1.7.m1.1" class="ltx_Math" alttext="10k\times 256" display="inline"><semantics id="S3.T1.7.m1.1b"><mrow id="S3.T1.7.m1.1.1" xref="S3.T1.7.m1.1.1.cmml"><mrow id="S3.T1.7.m1.1.1.2" xref="S3.T1.7.m1.1.1.2.cmml"><mn id="S3.T1.7.m1.1.1.2.2" xref="S3.T1.7.m1.1.1.2.2.cmml">10</mn><mo lspace="0em" rspace="0em" id="S3.T1.7.m1.1.1.2.1" xref="S3.T1.7.m1.1.1.2.1.cmml">â€‹</mo><mi id="S3.T1.7.m1.1.1.2.3" xref="S3.T1.7.m1.1.1.2.3.cmml">k</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.T1.7.m1.1.1.1" xref="S3.T1.7.m1.1.1.1.cmml">Ã—</mo><mn id="S3.T1.7.m1.1.1.3" xref="S3.T1.7.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.m1.1c"><apply id="S3.T1.7.m1.1.1.cmml" xref="S3.T1.7.m1.1.1"><times id="S3.T1.7.m1.1.1.1.cmml" xref="S3.T1.7.m1.1.1.1"></times><apply id="S3.T1.7.m1.1.1.2.cmml" xref="S3.T1.7.m1.1.1.2"><times id="S3.T1.7.m1.1.1.2.1.cmml" xref="S3.T1.7.m1.1.1.2.1"></times><cn type="integer" id="S3.T1.7.m1.1.1.2.2.cmml" xref="S3.T1.7.m1.1.1.2.2">10</cn><ci id="S3.T1.7.m1.1.1.2.3.cmml" xref="S3.T1.7.m1.1.1.2.3">ğ‘˜</ci></apply><cn type="integer" id="S3.T1.7.m1.1.1.3.cmml" xref="S3.T1.7.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.m1.1d">10k\times 256</annotation></semantics></math> word embedding and a <math id="S3.T1.8.m2.1" class="ltx_Math" alttext="32utterances/batch\times 16words/utterance" display="inline"><semantics id="S3.T1.8.m2.1b"><mrow id="S3.T1.8.m2.1.1" xref="S3.T1.8.m2.1.1.cmml"><mrow id="S3.T1.8.m2.1.1.2" xref="S3.T1.8.m2.1.1.2.cmml"><mrow id="S3.T1.8.m2.1.1.2.2" xref="S3.T1.8.m2.1.1.2.2.cmml"><mrow id="S3.T1.8.m2.1.1.2.2.2" xref="S3.T1.8.m2.1.1.2.2.2.cmml"><mrow id="S3.T1.8.m2.1.1.2.2.2.2" xref="S3.T1.8.m2.1.1.2.2.2.2.cmml"><mrow id="S3.T1.8.m2.1.1.2.2.2.2.2" xref="S3.T1.8.m2.1.1.2.2.2.2.2.cmml"><mrow id="S3.T1.8.m2.1.1.2.2.2.2.2.2" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.cmml"><mn id="S3.T1.8.m2.1.1.2.2.2.2.2.2.2" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.2.cmml">32</mn><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.3" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1b" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.4" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1c" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.5" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1d" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.6" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1e" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.7" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1f" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.8" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1g" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.9" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1h" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.10" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.10.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1i" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.11" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1j" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.2.12" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.12.cmml">s</mi></mrow><mo id="S3.T1.8.m2.1.1.2.2.2.2.2.1" xref="S3.T1.8.m2.1.1.2.2.2.2.2.1.cmml">/</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.2.3" xref="S3.T1.8.m2.1.1.2.2.2.2.2.3.cmml">b</mi></mrow><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.1" xref="S3.T1.8.m2.1.1.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.3" xref="S3.T1.8.m2.1.1.2.2.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.1b" xref="S3.T1.8.m2.1.1.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.4" xref="S3.T1.8.m2.1.1.2.2.2.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.1c" xref="S3.T1.8.m2.1.1.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.5" xref="S3.T1.8.m2.1.1.2.2.2.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.2.2.1d" xref="S3.T1.8.m2.1.1.2.2.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.2.2.6" xref="S3.T1.8.m2.1.1.2.2.2.2.6.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.T1.8.m2.1.1.2.2.2.1" xref="S3.T1.8.m2.1.1.2.2.2.1.cmml">Ã—</mo><mn id="S3.T1.8.m2.1.1.2.2.2.3" xref="S3.T1.8.m2.1.1.2.2.2.3.cmml">16</mn></mrow><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.1" xref="S3.T1.8.m2.1.1.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.3" xref="S3.T1.8.m2.1.1.2.2.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.1b" xref="S3.T1.8.m2.1.1.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.4" xref="S3.T1.8.m2.1.1.2.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.1c" xref="S3.T1.8.m2.1.1.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.5" xref="S3.T1.8.m2.1.1.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.1d" xref="S3.T1.8.m2.1.1.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.6" xref="S3.T1.8.m2.1.1.2.2.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.2.2.1e" xref="S3.T1.8.m2.1.1.2.2.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.2.2.7" xref="S3.T1.8.m2.1.1.2.2.7.cmml">s</mi></mrow><mo id="S3.T1.8.m2.1.1.2.1" xref="S3.T1.8.m2.1.1.2.1.cmml">/</mo><mi id="S3.T1.8.m2.1.1.2.3" xref="S3.T1.8.m2.1.1.2.3.cmml">u</mi></mrow><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.3" xref="S3.T1.8.m2.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1b" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.4" xref="S3.T1.8.m2.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1c" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.5" xref="S3.T1.8.m2.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1d" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.6" xref="S3.T1.8.m2.1.1.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1e" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.7" xref="S3.T1.8.m2.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1f" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.8" xref="S3.T1.8.m2.1.1.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1g" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.9" xref="S3.T1.8.m2.1.1.9.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.8.m2.1.1.1h" xref="S3.T1.8.m2.1.1.1.cmml">â€‹</mo><mi id="S3.T1.8.m2.1.1.10" xref="S3.T1.8.m2.1.1.10.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.m2.1c"><apply id="S3.T1.8.m2.1.1.cmml" xref="S3.T1.8.m2.1.1"><times id="S3.T1.8.m2.1.1.1.cmml" xref="S3.T1.8.m2.1.1.1"></times><apply id="S3.T1.8.m2.1.1.2.cmml" xref="S3.T1.8.m2.1.1.2"><divide id="S3.T1.8.m2.1.1.2.1.cmml" xref="S3.T1.8.m2.1.1.2.1"></divide><apply id="S3.T1.8.m2.1.1.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2"><times id="S3.T1.8.m2.1.1.2.2.1.cmml" xref="S3.T1.8.m2.1.1.2.2.1"></times><apply id="S3.T1.8.m2.1.1.2.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2.2"><times id="S3.T1.8.m2.1.1.2.2.2.1.cmml" xref="S3.T1.8.m2.1.1.2.2.2.1"></times><apply id="S3.T1.8.m2.1.1.2.2.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2"><times id="S3.T1.8.m2.1.1.2.2.2.2.1.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.1"></times><apply id="S3.T1.8.m2.1.1.2.2.2.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2"><divide id="S3.T1.8.m2.1.1.2.2.2.2.2.1.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.1"></divide><apply id="S3.T1.8.m2.1.1.2.2.2.2.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2"><times id="S3.T1.8.m2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.1"></times><cn type="integer" id="S3.T1.8.m2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.2">32</cn><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.3">ğ‘¢</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.4.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.4">ğ‘¡</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.5.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.5">ğ‘¡</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.6.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.6">ğ‘’</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.7.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.7">ğ‘Ÿ</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.8.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.8">ğ‘</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.9.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.9">ğ‘›</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.10.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.10">ğ‘</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.11.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.11">ğ‘’</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.2.12.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.2.12">ğ‘ </ci></apply><ci id="S3.T1.8.m2.1.1.2.2.2.2.2.3.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.2.3">ğ‘</ci></apply><ci id="S3.T1.8.m2.1.1.2.2.2.2.3.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.3">ğ‘</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.4.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.4">ğ‘¡</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.5.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.5">ğ‘</ci><ci id="S3.T1.8.m2.1.1.2.2.2.2.6.cmml" xref="S3.T1.8.m2.1.1.2.2.2.2.6">â„</ci></apply><cn type="integer" id="S3.T1.8.m2.1.1.2.2.2.3.cmml" xref="S3.T1.8.m2.1.1.2.2.2.3">16</cn></apply><ci id="S3.T1.8.m2.1.1.2.2.3.cmml" xref="S3.T1.8.m2.1.1.2.2.3">ğ‘¤</ci><ci id="S3.T1.8.m2.1.1.2.2.4.cmml" xref="S3.T1.8.m2.1.1.2.2.4">ğ‘œ</ci><ci id="S3.T1.8.m2.1.1.2.2.5.cmml" xref="S3.T1.8.m2.1.1.2.2.5">ğ‘Ÿ</ci><ci id="S3.T1.8.m2.1.1.2.2.6.cmml" xref="S3.T1.8.m2.1.1.2.2.6">ğ‘‘</ci><ci id="S3.T1.8.m2.1.1.2.2.7.cmml" xref="S3.T1.8.m2.1.1.2.2.7">ğ‘ </ci></apply><ci id="S3.T1.8.m2.1.1.2.3.cmml" xref="S3.T1.8.m2.1.1.2.3">ğ‘¢</ci></apply><ci id="S3.T1.8.m2.1.1.3.cmml" xref="S3.T1.8.m2.1.1.3">ğ‘¡</ci><ci id="S3.T1.8.m2.1.1.4.cmml" xref="S3.T1.8.m2.1.1.4">ğ‘¡</ci><ci id="S3.T1.8.m2.1.1.5.cmml" xref="S3.T1.8.m2.1.1.5">ğ‘’</ci><ci id="S3.T1.8.m2.1.1.6.cmml" xref="S3.T1.8.m2.1.1.6">ğ‘Ÿ</ci><ci id="S3.T1.8.m2.1.1.7.cmml" xref="S3.T1.8.m2.1.1.7">ğ‘</ci><ci id="S3.T1.8.m2.1.1.8.cmml" xref="S3.T1.8.m2.1.1.8">ğ‘›</ci><ci id="S3.T1.8.m2.1.1.9.cmml" xref="S3.T1.8.m2.1.1.9">ğ‘</ci><ci id="S3.T1.8.m2.1.1.10.cmml" xref="S3.T1.8.m2.1.1.10">ğ‘’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.m2.1d">32utterances/batch\times 16words/utterance</annotation></semantics></math> minibatch with vanilla SGD.</figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">Noise contrastive estimation (NCE) <cite class="ltx_cite ltx_citemacro_cite">Gutmann and HyvÃ¤rinen (<a href="#bib.bib12" title="" class="ltx_ref">2010</a>)</cite> is a sampling-based self-normalized approach that approximates SoftMax over large vocabulary efficiently <cite class="ltx_cite ltx_citemacro_cite">Mnih and Teh (<a href="#bib.bib22" title="" class="ltx_ref">2012</a>)</cite>.
If a word <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">w</annotation></semantics></math> is sampled from the corpus with auxiliary label <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="D=1" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">D</mi><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><eq id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></eq><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ğ·</ci><cn type="integer" id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">D=1</annotation></semantics></math>, and <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">k</annotation></semantics></math> other words are sampled from unigram <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="p_{uni}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">p</mi><mrow id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.1" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.1a" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS4.p1.4.m4.1.1.3.4" xref="S3.SS4.p1.4.m4.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">ğ‘</ci><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><times id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.1"></times><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">ğ‘¢</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3">ğ‘›</ci><ci id="S3.SS4.p1.4.m4.1.1.3.4.cmml" xref="S3.SS4.p1.4.m4.1.1.3.4">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">p_{uni}</annotation></semantics></math> with auxiliary label <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="D=0" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">D</mi><mo id="S3.SS4.p1.5.m5.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><eq id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1"></eq><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">ğ·</ci><cn type="integer" id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">D=0</annotation></semantics></math>.
The probability of <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">D</annotation></semantics></math> is a mixture of <math id="S3.SS4.p1.7.m7.2" class="ltx_Math" alttext="p_{\theta}(w,c)" display="inline"><semantics id="S3.SS4.p1.7.m7.2a"><mrow id="S3.SS4.p1.7.m7.2.3" xref="S3.SS4.p1.7.m7.2.3.cmml"><msub id="S3.SS4.p1.7.m7.2.3.2" xref="S3.SS4.p1.7.m7.2.3.2.cmml"><mi id="S3.SS4.p1.7.m7.2.3.2.2" xref="S3.SS4.p1.7.m7.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p1.7.m7.2.3.2.3" xref="S3.SS4.p1.7.m7.2.3.2.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.2.3.1" xref="S3.SS4.p1.7.m7.2.3.1.cmml">â€‹</mo><mrow id="S3.SS4.p1.7.m7.2.3.3.2" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.7.m7.2.3.3.2.1" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">(</mo><mi id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">w</mi><mo id="S3.SS4.p1.7.m7.2.3.3.2.2" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.7.m7.2.2" xref="S3.SS4.p1.7.m7.2.2.cmml">c</mi><mo stretchy="false" id="S3.SS4.p1.7.m7.2.3.3.2.3" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.2b"><apply id="S3.SS4.p1.7.m7.2.3.cmml" xref="S3.SS4.p1.7.m7.2.3"><times id="S3.SS4.p1.7.m7.2.3.1.cmml" xref="S3.SS4.p1.7.m7.2.3.1"></times><apply id="S3.SS4.p1.7.m7.2.3.2.cmml" xref="S3.SS4.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.2.3.2.1.cmml" xref="S3.SS4.p1.7.m7.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.7.m7.2.3.2.2.cmml" xref="S3.SS4.p1.7.m7.2.3.2.2">ğ‘</ci><ci id="S3.SS4.p1.7.m7.2.3.2.3.cmml" xref="S3.SS4.p1.7.m7.2.3.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.SS4.p1.7.m7.2.3.3.1.cmml" xref="S3.SS4.p1.7.m7.2.3.3.2"><ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">ğ‘¤</ci><ci id="S3.SS4.p1.7.m7.2.2.cmml" xref="S3.SS4.p1.7.m7.2.2">ğ‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.2c">p_{\theta}(w,c)</annotation></semantics></math> and <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="p_{uni}(w)" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><mrow id="S3.SS4.p1.8.m8.1.2" xref="S3.SS4.p1.8.m8.1.2.cmml"><msub id="S3.SS4.p1.8.m8.1.2.2" xref="S3.SS4.p1.8.m8.1.2.2.cmml"><mi id="S3.SS4.p1.8.m8.1.2.2.2" xref="S3.SS4.p1.8.m8.1.2.2.2.cmml">p</mi><mrow id="S3.SS4.p1.8.m8.1.2.2.3" xref="S3.SS4.p1.8.m8.1.2.2.3.cmml"><mi id="S3.SS4.p1.8.m8.1.2.2.3.2" xref="S3.SS4.p1.8.m8.1.2.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.2.2.3.1" xref="S3.SS4.p1.8.m8.1.2.2.3.1.cmml">â€‹</mo><mi id="S3.SS4.p1.8.m8.1.2.2.3.3" xref="S3.SS4.p1.8.m8.1.2.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.2.2.3.1a" xref="S3.SS4.p1.8.m8.1.2.2.3.1.cmml">â€‹</mo><mi id="S3.SS4.p1.8.m8.1.2.2.3.4" xref="S3.SS4.p1.8.m8.1.2.2.3.4.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.2.1" xref="S3.SS4.p1.8.m8.1.2.1.cmml">â€‹</mo><mrow id="S3.SS4.p1.8.m8.1.2.3.2" xref="S3.SS4.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m8.1.2.3.2.1" xref="S3.SS4.p1.8.m8.1.2.cmml">(</mo><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS4.p1.8.m8.1.2.3.2.2" xref="S3.SS4.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.2.cmml" xref="S3.SS4.p1.8.m8.1.2"><times id="S3.SS4.p1.8.m8.1.2.1.cmml" xref="S3.SS4.p1.8.m8.1.2.1"></times><apply id="S3.SS4.p1.8.m8.1.2.2.cmml" xref="S3.SS4.p1.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.2.2.1.cmml" xref="S3.SS4.p1.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.2.2.2.cmml" xref="S3.SS4.p1.8.m8.1.2.2.2">ğ‘</ci><apply id="S3.SS4.p1.8.m8.1.2.2.3.cmml" xref="S3.SS4.p1.8.m8.1.2.2.3"><times id="S3.SS4.p1.8.m8.1.2.2.3.1.cmml" xref="S3.SS4.p1.8.m8.1.2.2.3.1"></times><ci id="S3.SS4.p1.8.m8.1.2.2.3.2.cmml" xref="S3.SS4.p1.8.m8.1.2.2.3.2">ğ‘¢</ci><ci id="S3.SS4.p1.8.m8.1.2.2.3.3.cmml" xref="S3.SS4.p1.8.m8.1.2.2.3.3">ğ‘›</ci><ci id="S3.SS4.p1.8.m8.1.2.2.3.4.cmml" xref="S3.SS4.p1.8.m8.1.2.2.3.4">ğ‘–</ci></apply></apply><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">p_{uni}(w)</annotation></semantics></math>, where <math id="S3.SS4.p1.9.m9.2" class="ltx_Math" alttext="p_{\theta}(w,c)" display="inline"><semantics id="S3.SS4.p1.9.m9.2a"><mrow id="S3.SS4.p1.9.m9.2.3" xref="S3.SS4.p1.9.m9.2.3.cmml"><msub id="S3.SS4.p1.9.m9.2.3.2" xref="S3.SS4.p1.9.m9.2.3.2.cmml"><mi id="S3.SS4.p1.9.m9.2.3.2.2" xref="S3.SS4.p1.9.m9.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p1.9.m9.2.3.2.3" xref="S3.SS4.p1.9.m9.2.3.2.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m9.2.3.1" xref="S3.SS4.p1.9.m9.2.3.1.cmml">â€‹</mo><mrow id="S3.SS4.p1.9.m9.2.3.3.2" xref="S3.SS4.p1.9.m9.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.9.m9.2.3.3.2.1" xref="S3.SS4.p1.9.m9.2.3.3.1.cmml">(</mo><mi id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml">w</mi><mo id="S3.SS4.p1.9.m9.2.3.3.2.2" xref="S3.SS4.p1.9.m9.2.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.9.m9.2.2" xref="S3.SS4.p1.9.m9.2.2.cmml">c</mi><mo stretchy="false" id="S3.SS4.p1.9.m9.2.3.3.2.3" xref="S3.SS4.p1.9.m9.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.2b"><apply id="S3.SS4.p1.9.m9.2.3.cmml" xref="S3.SS4.p1.9.m9.2.3"><times id="S3.SS4.p1.9.m9.2.3.1.cmml" xref="S3.SS4.p1.9.m9.2.3.1"></times><apply id="S3.SS4.p1.9.m9.2.3.2.cmml" xref="S3.SS4.p1.9.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.2.3.2.1.cmml" xref="S3.SS4.p1.9.m9.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.9.m9.2.3.2.2.cmml" xref="S3.SS4.p1.9.m9.2.3.2.2">ğ‘</ci><ci id="S3.SS4.p1.9.m9.2.3.2.3.cmml" xref="S3.SS4.p1.9.m9.2.3.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.SS4.p1.9.m9.2.3.3.1.cmml" xref="S3.SS4.p1.9.m9.2.3.3.2"><ci id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">ğ‘¤</ci><ci id="S3.SS4.p1.9.m9.2.2.cmml" xref="S3.SS4.p1.9.m9.2.2">ğ‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.2c">p_{\theta}(w,c)</annotation></semantics></math> represents the probability of the word <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mi id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><ci id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">w</annotation></semantics></math> given the context <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><mi id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><ci id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">c</annotation></semantics></math>, modeled by the LM parameter <math id="S3.SS4.p1.12.m12.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS4.p1.12.m12.1a"><mi id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.1b"><ci id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.1c">\theta</annotation></semantics></math>:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle p(D=0|c,w)" display="inline"><semantics id="S3.E5X.2.1.1.m1.3a"><mrow id="S3.E5X.2.1.1.m1.3.3" xref="S3.E5X.2.1.1.m1.3.3.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.3" xref="S3.E5X.2.1.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.3.3.2" xref="S3.E5X.2.1.1.m1.3.3.2.cmml">â€‹</mo><mrow id="S3.E5X.2.1.1.m1.3.3.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.3.3.1.1.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.2.cmml">D</mi><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml">=</mo><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.cmml"><mn id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.2.cmml">0</mn><mo fence="false" id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.1.cmml">|</mo><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">c</mi><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.2.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E5X.2.1.1.m1.2.2" xref="S3.E5X.2.1.1.m1.2.2.cmml">w</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E5X.2.1.1.m1.3.3.1.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.3b"><apply id="S3.E5X.2.1.1.m1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3"><times id="S3.E5X.2.1.1.m1.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.2"></times><ci id="S3.E5X.2.1.1.m1.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.3">ğ‘</ci><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1"><eq id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1"></eq><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.2">ğ·</ci><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.2">0</cn><list id="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.3.3.2"><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">ğ‘</ci><ci id="S3.E5X.2.1.1.m1.2.2.cmml" xref="S3.E5X.2.1.1.m1.2.2">ğ‘¤</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.3c">\displaystyle p(D=0|c,w)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{k\times p_{uni}(w)}{p_{\theta}(w,c)+k\times p_{uni}(w)}" display="inline"><semantics id="S3.E5X.3.2.2.m1.4a"><mrow id="S3.E5X.3.2.2.m1.4.5" xref="S3.E5X.3.2.2.m1.4.5.cmml"><mi id="S3.E5X.3.2.2.m1.4.5.2" xref="S3.E5X.3.2.2.m1.4.5.2.cmml"></mi><mo id="S3.E5X.3.2.2.m1.4.5.1" xref="S3.E5X.3.2.2.m1.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.4.4" xref="S3.E5X.3.2.2.m1.4.4.cmml"><mfrac id="S3.E5X.3.2.2.m1.4.4a" xref="S3.E5X.3.2.2.m1.4.4.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.3.2.2.m1.1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.3.1.cmml">Ã—</mo><msub id="S3.E5X.3.2.2.m1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.2.cmml">p</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1.cmml">â€‹</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1.cmml">â€‹</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.4.cmml">i</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.4.2" xref="S3.E5X.3.2.2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.4.2.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.4.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5X.3.2.2.m1.4.4.4" xref="S3.E5X.3.2.2.m1.4.4.4.cmml"><mrow id="S3.E5X.3.2.2.m1.4.4.4.5" xref="S3.E5X.3.2.2.m1.4.4.4.5.cmml"><msub id="S3.E5X.3.2.2.m1.4.4.4.5.2" xref="S3.E5X.3.2.2.m1.4.4.4.5.2.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.4.5.2.2" xref="S3.E5X.3.2.2.m1.4.4.4.5.2.2.cmml">p</mi><mi id="S3.E5X.3.2.2.m1.4.4.4.5.2.3" xref="S3.E5X.3.2.2.m1.4.4.4.5.2.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.4.5.1" xref="S3.E5X.3.2.2.m1.4.4.4.5.1.cmml">â€‹</mo><mrow id="S3.E5X.3.2.2.m1.4.4.4.5.3.2" xref="S3.E5X.3.2.2.m1.4.4.4.5.3.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.4.5.3.2.1" xref="S3.E5X.3.2.2.m1.4.4.4.5.3.1.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.2.2.2.1" xref="S3.E5X.3.2.2.m1.2.2.2.1.cmml">w</mi><mo id="S3.E5X.3.2.2.m1.4.4.4.5.3.2.2" xref="S3.E5X.3.2.2.m1.4.4.4.5.3.1.cmml">,</mo><mi id="S3.E5X.3.2.2.m1.3.3.3.2" xref="S3.E5X.3.2.2.m1.3.3.3.2.cmml">c</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.4.5.3.2.3" xref="S3.E5X.3.2.2.m1.4.4.4.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5X.3.2.2.m1.4.4.4.4" xref="S3.E5X.3.2.2.m1.4.4.4.4.cmml">+</mo><mrow id="S3.E5X.3.2.2.m1.4.4.4.6" xref="S3.E5X.3.2.2.m1.4.4.4.6.cmml"><mrow id="S3.E5X.3.2.2.m1.4.4.4.6.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.4.6.2.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.3.2.2.m1.4.4.4.6.2.1" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.1.cmml">Ã—</mo><msub id="S3.E5X.3.2.2.m1.4.4.4.6.2.3" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.2.cmml">p</mi><mrow id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1.cmml">â€‹</mo><mi id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.3" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1a" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1.cmml">â€‹</mo><mi id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.4" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.4.cmml">i</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.4.4.4.6.1" xref="S3.E5X.3.2.2.m1.4.4.4.6.1.cmml">â€‹</mo><mrow id="S3.E5X.3.2.2.m1.4.4.4.6.3.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.4.6.3.2.1" xref="S3.E5X.3.2.2.m1.4.4.4.6.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.4.4.4.3" xref="S3.E5X.3.2.2.m1.4.4.4.3.cmml">w</mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.4.4.4.6.3.2.2" xref="S3.E5X.3.2.2.m1.4.4.4.6.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.4b"><apply id="S3.E5X.3.2.2.m1.4.5.cmml" xref="S3.E5X.3.2.2.m1.4.5"><eq id="S3.E5X.3.2.2.m1.4.5.1.cmml" xref="S3.E5X.3.2.2.m1.4.5.1"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.4.5.2.cmml" xref="S3.E5X.3.2.2.m1.4.5.2">absent</csymbol><apply id="S3.E5X.3.2.2.m1.4.4.cmml" xref="S3.E5X.3.2.2.m1.4.4"><divide id="S3.E5X.3.2.2.m1.4.4.5.cmml" xref="S3.E5X.3.2.2.m1.4.4"></divide><apply id="S3.E5X.3.2.2.m1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3"><times id="S3.E5X.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.2">ğ‘˜</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.2">ğ‘</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3"><times id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.2">ğ‘¢</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.3">ğ‘›</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.3.4">ğ‘–</ci></apply></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1">ğ‘¤</ci></apply><apply id="S3.E5X.3.2.2.m1.4.4.4.cmml" xref="S3.E5X.3.2.2.m1.4.4.4"><plus id="S3.E5X.3.2.2.m1.4.4.4.4.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.4"></plus><apply id="S3.E5X.3.2.2.m1.4.4.4.5.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5"><times id="S3.E5X.3.2.2.m1.4.4.4.5.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.1"></times><apply id="S3.E5X.3.2.2.m1.4.4.4.5.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.4.5.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.4.4.4.5.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.2.2">ğ‘</ci><ci id="S3.E5X.3.2.2.m1.4.4.4.5.2.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.E5X.3.2.2.m1.4.4.4.5.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.5.3.2"><ci id="S3.E5X.3.2.2.m1.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.2.1">ğ‘¤</ci><ci id="S3.E5X.3.2.2.m1.3.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.3.2">ğ‘</ci></interval></apply><apply id="S3.E5X.3.2.2.m1.4.4.4.6.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6"><times id="S3.E5X.3.2.2.m1.4.4.4.6.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.1"></times><apply id="S3.E5X.3.2.2.m1.4.4.4.6.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2"><times id="S3.E5X.3.2.2.m1.4.4.4.6.2.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.1"></times><ci id="S3.E5X.3.2.2.m1.4.4.4.6.2.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.2">ğ‘˜</ci><apply id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.2">ğ‘</ci><apply id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3"><times id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.1"></times><ci id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.2">ğ‘¢</ci><ci id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.3">ğ‘›</ci><ci id="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.4.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.6.2.3.3.4">ğ‘–</ci></apply></apply></apply><ci id="S3.E5X.3.2.2.m1.4.4.4.3.cmml" xref="S3.E5X.3.2.2.m1.4.4.4.3">ğ‘¤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.4c">\displaystyle=\frac{k\times p_{uni}(w)}{p_{\theta}(w,c)+k\times p_{uni}(w)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle p(D=1|c,w)" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.3a"><mrow id="S3.E5Xa.2.1.1.m1.3.3" xref="S3.E5Xa.2.1.1.m1.3.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.3.3.3" xref="S3.E5Xa.2.1.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.3.3.2" xref="S3.E5Xa.2.1.1.m1.3.3.2.cmml">â€‹</mo><mrow id="S3.E5Xa.2.1.1.m1.3.3.1.1" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.2.cmml">D</mi><mo id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.1.cmml">=</mo><mrow id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.cmml"><mn id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml">|</mo><mrow id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.2" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml">c</mi><mo id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.2.1" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E5Xa.2.1.1.m1.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.cmml">w</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.3b"><apply id="S3.E5Xa.2.1.1.m1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.3.3"><times id="S3.E5Xa.2.1.1.m1.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.2"></times><ci id="S3.E5Xa.2.1.1.m1.3.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3">ğ‘</ci><apply id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1"><eq id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.1"></eq><ci id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.2">ğ·</ci><apply id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.2">1</cn><list id="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.1.1.1.3.3.2"><ci id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">ğ‘</ci><ci id="S3.E5Xa.2.1.1.m1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2">ğ‘¤</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.3c">\displaystyle p(D=1|c,w)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=\frac{p_{\theta}(w,c)}{p_{\theta}(w,c)+k\times p_{uni}(w)}" display="inline"><semantics id="S3.E5Xa.3.2.2.m1.5a"><mrow id="S3.E5Xa.3.2.2.m1.5.6" xref="S3.E5Xa.3.2.2.m1.5.6.cmml"><mi id="S3.E5Xa.3.2.2.m1.5.6.2" xref="S3.E5Xa.3.2.2.m1.5.6.2.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.5.6.1" xref="S3.E5Xa.3.2.2.m1.5.6.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E5Xa.3.2.2.m1.5.5" xref="S3.E5Xa.3.2.2.m1.5.5.cmml"><mfrac id="S3.E5Xa.3.2.2.m1.5.5a" xref="S3.E5Xa.3.2.2.m1.5.5.cmml"><mrow id="S3.E5Xa.3.2.2.m1.2.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.2.cmml"><msub id="S3.E5Xa.3.2.2.m1.2.2.2.4" xref="S3.E5Xa.3.2.2.m1.2.2.2.4.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.2.4.2" xref="S3.E5Xa.3.2.2.m1.2.2.2.4.2.cmml">p</mi><mi id="S3.E5Xa.3.2.2.m1.2.2.2.4.3" xref="S3.E5Xa.3.2.2.m1.2.2.2.4.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.2.3.cmml">â€‹</mo><mrow id="S3.E5Xa.3.2.2.m1.2.2.2.5.2" xref="S3.E5Xa.3.2.2.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.2.2.2.5.2.1" xref="S3.E5Xa.3.2.2.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml">w</mi><mo id="S3.E5Xa.3.2.2.m1.2.2.2.5.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E5Xa.3.2.2.m1.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.2.2.cmml">c</mi><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.2.2.2.5.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5Xa.3.2.2.m1.5.5.5" xref="S3.E5Xa.3.2.2.m1.5.5.5.cmml"><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.5" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.cmml"><msub id="S3.E5Xa.3.2.2.m1.5.5.5.5.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2.2.cmml">p</mi><mi id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.5.5.5.5.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.1.cmml">â€‹</mo><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.5.3.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.3.1.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.5.5.5.5.3.2.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.3.1.cmml">(</mo><mi id="S3.E5Xa.3.2.2.m1.3.3.3.1" xref="S3.E5Xa.3.2.2.m1.3.3.3.1.cmml">w</mi><mo id="S3.E5Xa.3.2.2.m1.5.5.5.5.3.2.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.3.1.cmml">,</mo><mi id="S3.E5Xa.3.2.2.m1.4.4.4.2" xref="S3.E5Xa.3.2.2.m1.4.4.4.2.cmml">c</mi><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.5.5.5.5.3.2.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.5.5.5.4" xref="S3.E5Xa.3.2.2.m1.5.5.5.4.cmml">+</mo><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.6" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.cmml"><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.6.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.1.cmml">Ã—</mo><msub id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.2.cmml">p</mi><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1a" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1.cmml">â€‹</mo><mi id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.4" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.4.cmml">i</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.5.5.5.6.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.1.cmml">â€‹</mo><mrow id="S3.E5Xa.3.2.2.m1.5.5.5.6.3.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.5.5.5.6.3.2.1" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.cmml">(</mo><mi id="S3.E5Xa.3.2.2.m1.5.5.5.3" xref="S3.E5Xa.3.2.2.m1.5.5.5.3.cmml">w</mi><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.5.5.5.6.3.2.2" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.5b"><apply id="S3.E5Xa.3.2.2.m1.5.6.cmml" xref="S3.E5Xa.3.2.2.m1.5.6"><eq id="S3.E5Xa.3.2.2.m1.5.6.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.6.1"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.5.6.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.6.2">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.5.5.cmml" xref="S3.E5Xa.3.2.2.m1.5.5"><divide id="S3.E5Xa.3.2.2.m1.5.5.6.cmml" xref="S3.E5Xa.3.2.2.m1.5.5"></divide><apply id="S3.E5Xa.3.2.2.m1.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2"><times id="S3.E5Xa.3.2.2.m1.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.3"></times><apply id="S3.E5Xa.3.2.2.m1.2.2.2.4.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.2.2.2.4.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.4">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.2.2.2.4.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.4.2">ğ‘</ci><ci id="S3.E5Xa.3.2.2.m1.2.2.2.4.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.4.3">ğœƒ</ci></apply><interval closure="open" id="S3.E5Xa.3.2.2.m1.2.2.2.5.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.5.2"><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1">ğ‘¤</ci><ci id="S3.E5Xa.3.2.2.m1.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.2.2">ğ‘</ci></interval></apply><apply id="S3.E5Xa.3.2.2.m1.5.5.5.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5"><plus id="S3.E5Xa.3.2.2.m1.5.5.5.4.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.4"></plus><apply id="S3.E5Xa.3.2.2.m1.5.5.5.5.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5"><times id="S3.E5Xa.3.2.2.m1.5.5.5.5.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.1"></times><apply id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2.2">ğ‘</ci><ci id="S3.E5Xa.3.2.2.m1.5.5.5.5.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.E5Xa.3.2.2.m1.5.5.5.5.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.5.3.2"><ci id="S3.E5Xa.3.2.2.m1.3.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.3.3.3.1">ğ‘¤</ci><ci id="S3.E5Xa.3.2.2.m1.4.4.4.2.cmml" xref="S3.E5Xa.3.2.2.m1.4.4.4.2">ğ‘</ci></interval></apply><apply id="S3.E5Xa.3.2.2.m1.5.5.5.6.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6"><times id="S3.E5Xa.3.2.2.m1.5.5.5.6.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.1"></times><apply id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2"><times id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.1"></times><ci id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.2">ğ‘˜</ci><apply id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.2">ğ‘</ci><apply id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3"><times id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.1"></times><ci id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.2">ğ‘¢</ci><ci id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.3">ğ‘›</ci><ci id="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.4.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.6.2.3.3.4">ğ‘–</ci></apply></apply></apply><ci id="S3.E5Xa.3.2.2.m1.5.5.5.3.cmml" xref="S3.E5Xa.3.2.2.m1.5.5.5.3">ğ‘¤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.5c">\displaystyle=\frac{p_{\theta}(w,c)}{p_{\theta}(w,c)+k\times p_{uni}(w)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS4.p1.13" class="ltx_p">The LM distribution is learned by maximizing the log-likelihood of <math id="S3.SS4.p1.13.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS4.p1.13.m1.1a"><mi id="S3.SS4.p1.13.m1.1.1" xref="S3.SS4.p1.13.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m1.1b"><ci id="S3.SS4.p1.13.m1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m1.1c">D</annotation></semantics></math>:</p>
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle Loss_{NCE_{k}}\approx{}" display="inline"><semantics id="S3.E6X.2.1.1.m1.1a"><mrow id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml"><mrow id="S3.E6X.2.1.1.m1.1.1.2" xref="S3.E6X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.2" xref="S3.E6X.2.1.1.m1.1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.1.1.2.1" xref="S3.E6X.2.1.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="S3.E6X.2.1.1.m1.1.1.2.3" xref="S3.E6X.2.1.1.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.1.1.2.1a" xref="S3.E6X.2.1.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="S3.E6X.2.1.1.m1.1.1.2.4" xref="S3.E6X.2.1.1.m1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.1.1.2.1b" xref="S3.E6X.2.1.1.m1.1.1.2.1.cmml">â€‹</mo><msub id="S3.E6X.2.1.1.m1.1.1.2.5" xref="S3.E6X.2.1.1.m1.1.1.2.5.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.5.2" xref="S3.E6X.2.1.1.m1.1.1.2.5.2.cmml">s</mi><mrow id="S3.E6X.2.1.1.m1.1.1.2.5.3" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.5.3.2" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.1.1.2.5.3.1" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.1.cmml">â€‹</mo><mi id="S3.E6X.2.1.1.m1.1.1.2.5.3.3" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.1.1.2.5.3.1a" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.1.cmml">â€‹</mo><msub id="S3.E6X.2.1.1.m1.1.1.2.5.3.4" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.2" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4.2.cmml">E</mi><mi id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.3" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4.3.cmml">k</mi></msub></mrow></msub></mrow><mo id="S3.E6X.2.1.1.m1.1.1.1" xref="S3.E6X.2.1.1.m1.1.1.1.cmml">â‰ˆ</mo><mi id="S3.E6X.2.1.1.m1.1.1.3" xref="S3.E6X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b"><apply id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1"><approx id="S3.E6X.2.1.1.m1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.1"></approx><apply id="S3.E6X.2.1.1.m1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2"><times id="S3.E6X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.1"></times><ci id="S3.E6X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.2">ğ¿</ci><ci id="S3.E6X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.3">ğ‘œ</ci><ci id="S3.E6X.2.1.1.m1.1.1.2.4.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.4">ğ‘ </ci><apply id="S3.E6X.2.1.1.m1.1.1.2.5.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.2.5.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.1.1.2.5.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.2">ğ‘ </ci><apply id="S3.E6X.2.1.1.m1.1.1.2.5.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3"><times id="S3.E6X.2.1.1.m1.1.1.2.5.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.1"></times><ci id="S3.E6X.2.1.1.m1.1.1.2.5.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.2">ğ‘</ci><ci id="S3.E6X.2.1.1.m1.1.1.2.5.3.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.3">ğ¶</ci><apply id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4.2">ğ¸</ci><ci id="S3.E6X.2.1.1.m1.1.1.2.5.3.4.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.2.5.3.4.3">ğ‘˜</ci></apply></apply></apply></apply><csymbol cd="latexml" id="S3.E6X.2.1.1.m1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">\displaystyle Loss_{NCE_{k}}\approx{}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6X.3.2.2.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\sum_{(w,c)\in corpus}(log\ p(D=0|c,w)" display="inline"><semantics id="S3.E6X.3.2.2.m1.4a"><mrow id="S3.E6X.3.2.2.m1.4b"><mstyle displaystyle="true" id="S3.E6X.3.2.2.m1.4.5"><munder id="S3.E6X.3.2.2.m1.4.5a"><mo movablelimits="false" id="S3.E6X.3.2.2.m1.4.5.2">âˆ‘</mo><mrow id="S3.E6X.3.2.2.m1.2.2.2"><mrow id="S3.E6X.3.2.2.m1.2.2.2.4.2"><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.2.4.2.1">(</mo><mi id="S3.E6X.3.2.2.m1.1.1.1.1">w</mi><mo id="S3.E6X.3.2.2.m1.2.2.2.4.2.2">,</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.2">c</mi><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.2.4.2.3">)</mo></mrow><mo id="S3.E6X.3.2.2.m1.2.2.2.3">âˆˆ</mo><mrow id="S3.E6X.3.2.2.m1.2.2.2.5"><mi id="S3.E6X.3.2.2.m1.2.2.2.5.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.2.5.1">â€‹</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.5.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.2.5.1a">â€‹</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.5.4">r</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.2.5.1b">â€‹</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.5.5">p</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.2.5.1c">â€‹</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.5.6">u</mi><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.2.5.1d">â€‹</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.5.7">s</mi></mrow></mrow></munder></mstyle><mrow id="S3.E6X.3.2.2.m1.4.6"><mo stretchy="false" id="S3.E6X.3.2.2.m1.4.6.1">(</mo><mi id="S3.E6X.3.2.2.m1.4.6.2">l</mi><mi id="S3.E6X.3.2.2.m1.4.6.3">o</mi><mi id="S3.E6X.3.2.2.m1.4.6.4">g</mi><mi id="S3.E6X.3.2.2.m1.4.6.5">p</mi><mrow id="S3.E6X.3.2.2.m1.4.6.6"><mo stretchy="false" id="S3.E6X.3.2.2.m1.4.6.6.1">(</mo><mi id="S3.E6X.3.2.2.m1.4.6.6.2">D</mi><mo id="S3.E6X.3.2.2.m1.4.6.6.3">=</mo><mn id="S3.E6X.3.2.2.m1.4.6.6.4">0</mn><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E6X.3.2.2.m1.4.6.6.5">|</mo><mi id="S3.E6X.3.2.2.m1.3.3">c</mi><mo id="S3.E6X.3.2.2.m1.4.6.6.6">,</mo><mi id="S3.E6X.3.2.2.m1.4.4">w</mi><mo stretchy="false" id="S3.E6X.3.2.2.m1.4.6.6.7">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.4c">\displaystyle\sum_{(w,c)\in corpus}(log\ p(D=0|c,w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S3.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6Xa.2.1.1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle+\sum^{k}log\ p(D=0|c,\overline{w}))" display="inline"><semantics id="S3.E6Xa.2.1.1.m1.2a"><mrow id="S3.E6Xa.2.1.1.m1.2b"><mo id="S3.E6Xa.2.1.1.m1.2.3">+</mo><mstyle displaystyle="true" id="S3.E6Xa.2.1.1.m1.2.4"><mover id="S3.E6Xa.2.1.1.m1.2.4a"><mo movablelimits="false" id="S3.E6Xa.2.1.1.m1.2.4.2">âˆ‘</mo><mi id="S3.E6Xa.2.1.1.m1.2.4.3">k</mi></mover></mstyle><mi id="S3.E6Xa.2.1.1.m1.2.5">l</mi><mi id="S3.E6Xa.2.1.1.m1.2.6">o</mi><mi id="S3.E6Xa.2.1.1.m1.2.7">g</mi><mi id="S3.E6Xa.2.1.1.m1.2.8">p</mi><mrow id="S3.E6Xa.2.1.1.m1.2.9"><mo stretchy="false" id="S3.E6Xa.2.1.1.m1.2.9.1">(</mo><mi id="S3.E6Xa.2.1.1.m1.2.9.2">D</mi><mo id="S3.E6Xa.2.1.1.m1.2.9.3">=</mo><mn id="S3.E6Xa.2.1.1.m1.2.9.4">0</mn><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E6Xa.2.1.1.m1.2.9.5">|</mo><mi id="S3.E6Xa.2.1.1.m1.1.1">c</mi><mo id="S3.E6Xa.2.1.1.m1.2.9.6">,</mo><mover accent="true" id="S3.E6Xa.2.1.1.m1.2.2"><mi id="S3.E6Xa.2.1.1.m1.2.2.2">w</mi><mo id="S3.E6Xa.2.1.1.m1.2.2.1">Â¯</mo></mover><mo stretchy="false" id="S3.E6Xa.2.1.1.m1.2.9.7">)</mo></mrow><mo stretchy="false" id="S3.E6Xa.2.1.1.m1.2.10">)</mo></mrow><annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.2c">\displaystyle+\sum^{k}log\ p(D=0|c,\overline{w}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS4.p1.15" class="ltx_p"><math id="S3.SS4.p1.14.m1.2" class="ltx_Math" alttext="p_{\theta}(w,c)" display="inline"><semantics id="S3.SS4.p1.14.m1.2a"><mrow id="S3.SS4.p1.14.m1.2.3" xref="S3.SS4.p1.14.m1.2.3.cmml"><msub id="S3.SS4.p1.14.m1.2.3.2" xref="S3.SS4.p1.14.m1.2.3.2.cmml"><mi id="S3.SS4.p1.14.m1.2.3.2.2" xref="S3.SS4.p1.14.m1.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p1.14.m1.2.3.2.3" xref="S3.SS4.p1.14.m1.2.3.2.3.cmml">Î¸</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.14.m1.2.3.1" xref="S3.SS4.p1.14.m1.2.3.1.cmml">â€‹</mo><mrow id="S3.SS4.p1.14.m1.2.3.3.2" xref="S3.SS4.p1.14.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.14.m1.2.3.3.2.1" xref="S3.SS4.p1.14.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS4.p1.14.m1.1.1" xref="S3.SS4.p1.14.m1.1.1.cmml">w</mi><mo id="S3.SS4.p1.14.m1.2.3.3.2.2" xref="S3.SS4.p1.14.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.14.m1.2.2" xref="S3.SS4.p1.14.m1.2.2.cmml">c</mi><mo stretchy="false" id="S3.SS4.p1.14.m1.2.3.3.2.3" xref="S3.SS4.p1.14.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m1.2b"><apply id="S3.SS4.p1.14.m1.2.3.cmml" xref="S3.SS4.p1.14.m1.2.3"><times id="S3.SS4.p1.14.m1.2.3.1.cmml" xref="S3.SS4.p1.14.m1.2.3.1"></times><apply id="S3.SS4.p1.14.m1.2.3.2.cmml" xref="S3.SS4.p1.14.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.14.m1.2.3.2.1.cmml" xref="S3.SS4.p1.14.m1.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.14.m1.2.3.2.2.cmml" xref="S3.SS4.p1.14.m1.2.3.2.2">ğ‘</ci><ci id="S3.SS4.p1.14.m1.2.3.2.3.cmml" xref="S3.SS4.p1.14.m1.2.3.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.SS4.p1.14.m1.2.3.3.1.cmml" xref="S3.SS4.p1.14.m1.2.3.3.2"><ci id="S3.SS4.p1.14.m1.1.1.cmml" xref="S3.SS4.p1.14.m1.1.1">ğ‘¤</ci><ci id="S3.SS4.p1.14.m1.2.2.cmml" xref="S3.SS4.p1.14.m1.2.2">ğ‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m1.2c">p_{\theta}(w,c)</annotation></semantics></math> is the dot product of penultimate and <math id="S3.SS4.p1.15.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS4.p1.15.m2.1a"><mi id="S3.SS4.p1.15.m2.1.1" xref="S3.SS4.p1.15.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m2.1b"><ci id="S3.SS4.p1.15.m2.1.1.cmml" xref="S3.SS4.p1.15.m2.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m2.1c">w</annotation></semantics></math>â€™s embedding without normalization.
While the initial purpose of NCE is to reduce computation, its memory saving is more appealing to PFL.
The memory requirement for gradient and intermediate output are controllable by batch size and sampled words, independent of the embedding matrix size.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<table id="S3.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.2.2" class="ltx_tr">
<th id="S3.T2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><math id="S3.T2.1.1.1.m1.2" class="ltx_Math" alttext="(\epsilon,\delta)" display="inline"><semantics id="S3.T2.1.1.1.m1.2a"><mrow id="S3.T2.1.1.1.m1.2.3.2" xref="S3.T2.1.1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.T2.1.1.1.m1.2.3.2.1" xref="S3.T2.1.1.1.m1.2.3.1.cmml">(</mo><mi id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">Ïµ</mi><mo id="S3.T2.1.1.1.m1.2.3.2.2" xref="S3.T2.1.1.1.m1.2.3.1.cmml">,</mo><mi id="S3.T2.1.1.1.m1.2.2" xref="S3.T2.1.1.1.m1.2.2.cmml">Î´</mi><mo stretchy="false" id="S3.T2.1.1.1.m1.2.3.2.3" xref="S3.T2.1.1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.2b"><interval closure="open" id="S3.T2.1.1.1.m1.2.3.1.cmml" xref="S3.T2.1.1.1.m1.2.3.2"><ci id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">italic-Ïµ</ci><ci id="S3.T2.1.1.1.m1.2.2.cmml" xref="S3.T2.1.1.1.m1.2.2">ğ›¿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.2c">(\epsilon,\delta)</annotation></semantics></math></th>
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_left ltx_border_tt"><math id="S3.T2.2.2.2.m1.2" class="ltx_Math" alttext="(2,10^{-6})" display="inline"><semantics id="S3.T2.2.2.2.m1.2a"><mrow id="S3.T2.2.2.2.m1.2.2.1" xref="S3.T2.2.2.2.m1.2.2.2.cmml"><mo stretchy="false" id="S3.T2.2.2.2.m1.2.2.1.2" xref="S3.T2.2.2.2.m1.2.2.2.cmml">(</mo><mn id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">2</mn><mo id="S3.T2.2.2.2.m1.2.2.1.3" xref="S3.T2.2.2.2.m1.2.2.2.cmml">,</mo><msup id="S3.T2.2.2.2.m1.2.2.1.1" xref="S3.T2.2.2.2.m1.2.2.1.1.cmml"><mn id="S3.T2.2.2.2.m1.2.2.1.1.2" xref="S3.T2.2.2.2.m1.2.2.1.1.2.cmml">10</mn><mrow id="S3.T2.2.2.2.m1.2.2.1.1.3" xref="S3.T2.2.2.2.m1.2.2.1.1.3.cmml"><mo id="S3.T2.2.2.2.m1.2.2.1.1.3a" xref="S3.T2.2.2.2.m1.2.2.1.1.3.cmml">âˆ’</mo><mn id="S3.T2.2.2.2.m1.2.2.1.1.3.2" xref="S3.T2.2.2.2.m1.2.2.1.1.3.2.cmml">6</mn></mrow></msup><mo stretchy="false" id="S3.T2.2.2.2.m1.2.2.1.4" xref="S3.T2.2.2.2.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.2b"><interval closure="open" id="S3.T2.2.2.2.m1.2.2.2.cmml" xref="S3.T2.2.2.2.m1.2.2.1"><cn type="integer" id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">2</cn><apply id="S3.T2.2.2.2.m1.2.2.1.1.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.T2.2.2.2.m1.2.2.1.1.1.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1">superscript</csymbol><cn type="integer" id="S3.T2.2.2.2.m1.2.2.1.1.2.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1.2">10</cn><apply id="S3.T2.2.2.2.m1.2.2.1.1.3.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1.3"><minus id="S3.T2.2.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1.3"></minus><cn type="integer" id="S3.T2.2.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.T2.2.2.2.m1.2.2.1.1.3.2">6</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.2c">(2,10^{-6})</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.3.3" class="ltx_tr">
<th id="S3.T2.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">sampling rate</th>
<td id="S3.T2.3.3.1" class="ltx_td ltx_align_left"><math id="S3.T2.3.3.1.m1.1" class="ltx_Math" alttext="2\times 10^{-3}" display="inline"><semantics id="S3.T2.3.3.1.m1.1a"><mrow id="S3.T2.3.3.1.m1.1.1" xref="S3.T2.3.3.1.m1.1.1.cmml"><mn id="S3.T2.3.3.1.m1.1.1.2" xref="S3.T2.3.3.1.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S3.T2.3.3.1.m1.1.1.1" xref="S3.T2.3.3.1.m1.1.1.1.cmml">Ã—</mo><msup id="S3.T2.3.3.1.m1.1.1.3" xref="S3.T2.3.3.1.m1.1.1.3.cmml"><mn id="S3.T2.3.3.1.m1.1.1.3.2" xref="S3.T2.3.3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T2.3.3.1.m1.1.1.3.3" xref="S3.T2.3.3.1.m1.1.1.3.3.cmml"><mo id="S3.T2.3.3.1.m1.1.1.3.3a" xref="S3.T2.3.3.1.m1.1.1.3.3.cmml">âˆ’</mo><mn id="S3.T2.3.3.1.m1.1.1.3.3.2" xref="S3.T2.3.3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.1.m1.1b"><apply id="S3.T2.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1"><times id="S3.T2.3.3.1.m1.1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1.1"></times><cn type="integer" id="S3.T2.3.3.1.m1.1.1.2.cmml" xref="S3.T2.3.3.1.m1.1.1.2">2</cn><apply id="S3.T2.3.3.1.m1.1.1.3.cmml" xref="S3.T2.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.3.3.1.m1.1.1.3.1.cmml" xref="S3.T2.3.3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.T2.3.3.1.m1.1.1.3.2.cmml" xref="S3.T2.3.3.1.m1.1.1.3.2">10</cn><apply id="S3.T2.3.3.1.m1.1.1.3.3.cmml" xref="S3.T2.3.3.1.m1.1.1.3.3"><minus id="S3.T2.3.3.1.m1.1.1.3.3.1.cmml" xref="S3.T2.3.3.1.m1.1.1.3.3"></minus><cn type="integer" id="S3.T2.3.3.1.m1.1.1.3.3.2.cmml" xref="S3.T2.3.3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.1.m1.1c">2\times 10^{-3}</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.4.4" class="ltx_tr">
<th id="S3.T2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<math id="S3.T2.4.4.1.m1.1" class="ltx_Math" alttext="{L_{2}}" display="inline"><semantics id="S3.T2.4.4.1.m1.1a"><msub id="S3.T2.4.4.1.m1.1.1" xref="S3.T2.4.4.1.m1.1.1.cmml"><mi id="S3.T2.4.4.1.m1.1.1.2" xref="S3.T2.4.4.1.m1.1.1.2.cmml">L</mi><mn id="S3.T2.4.4.1.m1.1.1.3" xref="S3.T2.4.4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.1.m1.1b"><apply id="S3.T2.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.4.4.1.m1.1.1.1.cmml" xref="S3.T2.4.4.1.m1.1.1">subscript</csymbol><ci id="S3.T2.4.4.1.m1.1.1.2.cmml" xref="S3.T2.4.4.1.m1.1.1.2">ğ¿</ci><cn type="integer" id="S3.T2.4.4.1.m1.1.1.3.cmml" xref="S3.T2.4.4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.1.m1.1c">{L_{2}}</annotation></semantics></math> clipping bound</th>
<td id="S3.T2.4.4.2" class="ltx_td ltx_align_left">0.3</td>
</tr>
<tr id="S3.T2.4.5.1" class="ltx_tr">
<th id="S3.T2.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">batch size</th>
<td id="S3.T2.4.5.1.2" class="ltx_td ltx_align_left">16 utterances</td>
</tr>
<tr id="S3.T2.4.6.2" class="ltx_tr">
<th id="S3.T2.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">number of local epochs</th>
<td id="S3.T2.4.6.2.2" class="ltx_td ltx_align_left">1</td>
</tr>
<tr id="S3.T2.4.7.3" class="ltx_tr">
<th id="S3.T2.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">NCE noise size</th>
<td id="S3.T2.4.7.3.2" class="ltx_td ltx_align_left ltx_border_bb">1024</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Common hyper-parameters shared through out the experiments</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Stack Overflow</h3>

<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">train</th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">dev</th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">test</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<th id="S4.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">distinct users</th>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">342k</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">38k</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">204k</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<th id="S4.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">examples</th>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb">135m</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb">16m</td>
<td id="S4.T3.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb">16m</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Stack Overflow dataset summary</figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="width:86.7pt;">
<span id="S4.T4.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.1.1.1.1" class="ltx_p"><span id="S4.T4.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">setup</span></span>
</span>
</th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T4.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.1.2.1.1" class="ltx_p" style="width:30.4pt;"><span id="S4.T4.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">payload</span></span>
</span>
</th>
<th id="S4.T4.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T4.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.1.1.3.1.1" class="ltx_p" style="width:30.4pt;"><span id="S4.T4.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">PPL</span></span>
</span>
</th>
</tr>
<tr id="S4.T4.1.2.2" class="ltx_tr">
<th id="S4.T4.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="width:86.7pt;">
<span id="S4.T4.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.2.2.1.1.1" class="ltx_p">baseline</span>
</span>
</th>
<th id="S4.T4.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T4.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.2.2.2.1.1" class="ltx_p" style="width:30.4pt;">-</span>
</span>
</th>
<th id="S4.T4.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T4.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.2.2.3.1.1" class="ltx_p" style="width:30.4pt;">50.96</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.3.1" class="ltx_tr">
<th id="S4.T4.1.3.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:86.7pt;">
<span id="S4.T4.1.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.3.1.1.1.1" class="ltx_p">full model</span>
</span>
</th>
<td id="S4.T4.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T4.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.3.1.2.1.1" class="ltx_p" style="width:30.4pt;">112M</span>
</span>
</td>
<td id="S4.T4.1.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T4.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.3.1.3.1.1" class="ltx_p" style="width:30.4pt;">66.47</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.4.2" class="ltx_tr">
<th id="S4.T4.1.4.2.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.4.2.1.1.1" class="ltx_p">LoRA(48)</span>
</span>
</th>
<td id="S4.T4.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.4.2.2.1.1" class="ltx_p" style="width:30.4pt;">21M</span>
</span>
</td>
<td id="S4.T4.1.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.4.2.3.1.1" class="ltx_p" style="width:30.4pt;">85.24</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.5.3" class="ltx_tr">
<th id="S4.T4.1.5.3.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.5.3.1.1.1" class="ltx_p">LoRA(64)</span>
</span>
</th>
<td id="S4.T4.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.5.3.2.1.1" class="ltx_p" style="width:30.4pt;">28M</span>
</span>
</td>
<td id="S4.T4.1.5.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.5.3.3.1.1" class="ltx_p" style="width:30.4pt;">80.13</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.6.4" class="ltx_tr">
<th id="S4.T4.1.6.4.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.6.4.1.1.1" class="ltx_p">PEU(5k)</span>
</span>
</th>
<td id="S4.T4.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.6.4.2.1.1" class="ltx_p" style="width:30.4pt;"><span id="S4.T4.1.6.4.2.1.1.1" class="ltx_text ltx_font_bold">16M</span></span>
</span>
</td>
<td id="S4.T4.1.6.4.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.6.4.3.1.1" class="ltx_p" style="width:30.4pt;"><span id="S4.T4.1.6.4.3.1.1.1" class="ltx_text ltx_font_bold">64.77</span></span>
</span>
</td>
</tr>
<tr id="S4.T4.1.7.5" class="ltx_tr">
<th id="S4.T4.1.7.5.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.7.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.7.5.1.1.1" class="ltx_p">PEU(10k)</span>
</span>
</th>
<td id="S4.T4.1.7.5.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.7.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.7.5.2.1.1" class="ltx_p" style="width:30.4pt;">21M</span>
</span>
</td>
<td id="S4.T4.1.7.5.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.7.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.7.5.3.1.1" class="ltx_p" style="width:30.4pt;">65.06</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.8.6" class="ltx_tr">
<th id="S4.T4.1.8.6.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.8.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.8.6.1.1.1" class="ltx_p">PEU(20k)</span>
</span>
</th>
<td id="S4.T4.1.8.6.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.8.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.8.6.2.1.1" class="ltx_p" style="width:30.4pt;">31M</span>
</span>
</td>
<td id="S4.T4.1.8.6.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.8.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.8.6.3.1.1" class="ltx_p" style="width:30.4pt;">65.97</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.9.7" class="ltx_tr">
<th id="S4.T4.1.9.7.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.9.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.9.7.1.1.1" class="ltx_p">PEU(5k)+LoRA(64)</span>
</span>
</th>
<td id="S4.T4.1.9.7.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.9.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.9.7.2.1.1" class="ltx_p" style="width:30.4pt;">3.6M</span>
</span>
</td>
<td id="S4.T4.1.9.7.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T4.1.9.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.9.7.3.1.1" class="ltx_p" style="width:30.4pt;">77.79</span>
</span>
</td>
</tr>
<tr id="S4.T4.1.10.8" class="ltx_tr">
<th id="S4.T4.1.10.8.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="width:86.7pt;">
<span id="S4.T4.1.10.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.10.8.1.1.1" class="ltx_p">PEU(10k)+LoRA(64)</span>
</span>
</th>
<td id="S4.T4.1.10.8.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T4.1.10.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.10.8.2.1.1" class="ltx_p" style="width:30.4pt;">4.8M</span>
</span>
</td>
<td id="S4.T4.1.10.8.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T4.1.10.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T4.1.10.8.3.1.1" class="ltx_p" style="width:30.4pt;">77.43</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance on Stack Overflow.</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">This dataset is derived from Stack Overflow <cite class="ltx_cite ltx_citemacro_cite">Authors (<a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>.
The dataset is preprocessed by Tensorflow API <cite class="ltx_cite ltx_citemacro_cite">Abadi etÂ al. (<a href="#bib.bib2" title="" class="ltx_ref">2015</a>)</cite>.
Its statistics are summarized in Table <a href="#S4.T3" title="Table 3 â€£ 4.1 Stack Overflow â€£ 4 Experiments â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We build a 3rd-order FOFE <cite class="ltx_cite ltx_citemacro_cite">Zhang etÂ al. (<a href="#bib.bib31" title="" class="ltx_ref">2015</a>)</cite> baseline from scratch with BMSGD <cite class="ltx_cite ltx_citemacro_cite">Chen and Huo (<a href="#bib.bib8" title="" class="ltx_ref">2016</a>)</cite>. We apply our proposed methods in the PFL context.
We summarize the hyper-parameters in Table <a href="#S3.T2" title="Table 2 â€£ 3.4 Noise Contrastive Estimation â€£ 3 Methods â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
The model includes an IO-tied <cite class="ltx_cite ltx_citemacro_cite">Press and Wolf (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> 256-dimension word embedding of 100k vocabulary and 4 fully-connected layers of 768 nodes.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Speech Recognition on Virtual Assistant</h3>

<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="width:130.1pt;">
<span id="S4.T5.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.1.1.1.1.1" class="ltx_p"><span id="S4.T5.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">setup</span></span>
</span>
</th>
<td id="S4.T5.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S4.T5.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.1.1.2.1.1" class="ltx_p" style="width:19.1pt;"><span id="S4.T5.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">PPL</span></span>
</span>
</td>
<td id="S4.T5.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S4.T5.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.1.1.3.1.1" class="ltx_p" style="width:18.2pt;"><span id="S4.T5.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">WER</span></span>
</span>
</td>
</tr>
<tr id="S4.T5.1.2.2" class="ltx_tr">
<th id="S4.T5.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:130.1pt;">
<span id="S4.T5.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.2.2.1.1.1" class="ltx_p">baseline</span>
</span>
</th>
<td id="S4.T5.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.2.2.2.1.1" class="ltx_p" style="width:19.1pt;">67.33</span>
</span>
</td>
<td id="S4.T5.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.2.2.3.1.1" class="ltx_p" style="width:18.2pt;">3.97</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.3.3" class="ltx_tr">
<th id="S4.T5.1.3.3.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.3.3.1.1.1" class="ltx_p">am-ref</span>
</span>
</th>
<td id="S4.T5.1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.3.3.2.1.1" class="ltx_p" style="width:19.1pt;">71.81</span>
</span>
</td>
<td id="S4.T5.1.3.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.3.3.3.1.1" class="ltx_p" style="width:18.2pt;">4.29</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.4.4" class="ltx_tr">
<th id="S4.T5.1.4.4.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:130.1pt;">
<span id="S4.T5.1.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.4.4.1.1.1" class="ltx_p">full model</span>
</span>
</th>
<td id="S4.T5.1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.4.4.2.1.1" class="ltx_p" style="width:19.1pt;">67.19</span>
</span>
</td>
<td id="S4.T5.1.4.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.4.4.3.1.1" class="ltx_p" style="width:18.2pt;">4.09</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.5.5" class="ltx_tr">
<th id="S4.T5.1.5.5.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.5.5.1.1.1" class="ltx_p">LoRA(48)</span>
</span>
</th>
<td id="S4.T5.1.5.5.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.5.5.2.1.1" class="ltx_p" style="width:19.1pt;">67.67</span>
</span>
</td>
<td id="S4.T5.1.5.5.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.5.5.3.1.1" class="ltx_p" style="width:18.2pt;">4.10</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.6.6" class="ltx_tr">
<th id="S4.T5.1.6.6.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.6.6.1.1.1" class="ltx_p">LoRA(64)</span>
</span>
</th>
<td id="S4.T5.1.6.6.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.6.6.2.1.1" class="ltx_p" style="width:19.1pt;">67.56</span>
</span>
</td>
<td id="S4.T5.1.6.6.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.6.6.3.1.1" class="ltx_p" style="width:18.2pt;">4.10</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.7.7" class="ltx_tr">
<th id="S4.T5.1.7.7.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.7.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.7.7.1.1.1" class="ltx_p">PEU(5K)</span>
</span>
</th>
<td id="S4.T5.1.7.7.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.7.7.2.1.1" class="ltx_p" style="width:19.1pt;">67.12</span>
</span>
</td>
<td id="S4.T5.1.7.7.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.7.7.3.1.1" class="ltx_p" style="width:18.2pt;">4.08</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.8.8" class="ltx_tr">
<th id="S4.T5.1.8.8.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.8.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.8.8.1.1.1" class="ltx_p">PEU(10K)</span>
</span>
</th>
<td id="S4.T5.1.8.8.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.8.8.2.1.1" class="ltx_p" style="width:19.1pt;">67.10</span>
</span>
</td>
<td id="S4.T5.1.8.8.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.8.8.3.1.1" class="ltx_p" style="width:18.2pt;">4.09</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.9.9" class="ltx_tr">
<th id="S4.T5.1.9.9.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.9.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.9.9.1.1.1" class="ltx_p">PEU(20K)</span>
</span>
</th>
<td id="S4.T5.1.9.9.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.9.9.2.1.1" class="ltx_p" style="width:19.1pt;">67.04</span>
</span>
</td>
<td id="S4.T5.1.9.9.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.9.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.9.9.3.1.1" class="ltx_p" style="width:18.2pt;">4.08</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.10.10" class="ltx_tr">
<th id="S4.T5.1.10.10.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.10.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.10.10.1.1.1" class="ltx_p">PEU(10k) + LoRA(64)</span>
</span>
</th>
<td id="S4.T5.1.10.10.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.10.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.10.10.2.1.1" class="ltx_p" style="width:19.1pt;">67.47</span>
</span>
</td>
<td id="S4.T5.1.10.10.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T5.1.10.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.10.10.3.1.1" class="ltx_p" style="width:18.2pt;">4.09</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.11.11" class="ltx_tr">
<th id="S4.T5.1.11.11.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_r ltx_border_t" style="width:130.1pt;">
<span id="S4.T5.1.11.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.11.11.1.1.1" class="ltx_p"><span id="S4.T5.1.11.11.1.1.1.1" class="ltx_text ltx_font_bold">real device</span> PEU(10k)</span>
</span>
</th>
<td id="S4.T5.1.11.11.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.11.11.2.1.1" class="ltx_p" style="width:19.1pt;">67.60</span>
</span>
</td>
<td id="S4.T5.1.11.11.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T5.1.11.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.11.11.3.1.1" class="ltx_p" style="width:18.2pt;">4.13</span>
</span>
</td>
</tr>
<tr id="S4.T5.1.12.12" class="ltx_tr">
<th id="S4.T5.1.12.12.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="width:130.1pt;">
<span id="S4.T5.1.12.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.12.12.1.1.1" class="ltx_p"><span id="S4.T5.1.12.12.1.1.1.1" class="ltx_text ltx_font_bold">real device</span> PEU(10k)+LoRA(64)</span>
</span>
</th>
<td id="S4.T5.1.12.12.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T5.1.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.12.12.2.1.1" class="ltx_p" style="width:19.1pt;">67.46</span>
</span>
</td>
<td id="S4.T5.1.12.12.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T5.1.12.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T5.1.12.12.3.1.1" class="ltx_p" style="width:18.2pt;">4.12</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Performance on randomly sampled and anonymized virtual assistant queries. Payload is same as Table <a href="#S4.T4" title="Table 4 â€£ 4.1 Stack Overflow â€£ 4 Experiments â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In addition to next word prediction, we evaluate our approach on automatic speech recognition (ASR), which is measured by word error rate (WER).
We experiment with a hybrid ASR system that consists of acoustic model (AM), pronunciation dictionary and LM.
Each component is represented as a WFST <cite class="ltx_cite ltx_citemacro_cite">Mohri etÂ al. (<a href="#bib.bib23" title="" class="ltx_ref">2002</a>)</cite> and the recognition process is formulated as a beam search on the composed WFSTs.
The training corpus contains a large number of randomly sampled and anonymized automatically-transcribed virtual assistant queries and is supplemented with templated utterances based on knowledge base statistics.
We sampled 750 million sentences.
We curated 30 million anonymized human-labeled virtual assistant queries, from which we sampled 20k queries to form a PPL test set and another 20k to form a WER test set.
The remaining are used as AM training data.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">The baseline is trained identically to Section <a href="#S4.SS1" title="4.1 Stack Overflow â€£ 4 Experiments â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> except that virtual assistant data is used.
We build a weaker baseline that uses only the AM training data, referred to as <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_italic">am-ref</span>.
This will also serve as the initial checkpoint for PFL experiments.
We follow <cite class="ltx_cite ltx_citemacro_citet">Huang etÂ al. (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>â€™s recipe to produce an AM, which is used in all experiments.
Specifically, no ngram-LM is interpolated with NNLM.
We start with simulations.
To mimic the non-IID nature of the data present in FL, we separate the data into 500k partitions with the algorithm described in <cite class="ltx_cite ltx_citemacro_cite">Hsu etÂ al. (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> and treat each partition as an individual user device.
Finally, we replicate the results of the simulation on real user devices.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Result Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Results of various configurations are summarized in Table <a href="#S4.T4" title="Table 4 â€£ 4.1 Stack Overflow â€£ 4 Experiments â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T5" title="Table 5 â€£ 4.2 Speech Recognition on Virtual Assistant â€£ 4 Experiments â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Additional results for EMA comparison are described in AppendixÂ <a href="#A1" title="Appendix A Additional Results â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.
For both datasets, <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">PEU</span>-enabled settings converge to similar or better performance as their disabled counterparts.
Particularly in Stack Overflow, it outperforms <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">LoRA</span> significantly with the same payload budget, which shows that <span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_italic">PEU</span> is more suitable for training from scratch.
Compared to full model update, <span id="S4.SS3.p1.1.4" class="ltx_text ltx_font_italic">PEU</span> dramatically reduces the memory footprint and payload.
More importantly, because the reduction is irrelevant to the prediction space, larger models potentially benefit more from <span id="S4.SS3.p1.1.5" class="ltx_text ltx_font_italic">PEU</span>.
<span id="S4.SS3.p1.1.6" class="ltx_text ltx_font_italic">PEU</span> is compatible with <span id="S4.SS3.p1.1.7" class="ltx_text ltx_font_italic">LoRA</span>.
In virtual assistant queries, the combined setting drops the payload to less than 5% of the full model update, while maintaining accuracy of the non-private server-based baseline.
Finally, we replicate the results of the simulation on real user devices.
The results show that our proposed method is not only theoretically sound, but also feasible in production.
</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">With partial embedding updates, low-rank adaptation, noise contrastive estimation and exponential moving average on trained parameters, we train large-vocabulary language models using private federated learning on resource-constrained mobile devices and achieve accuracy parity.
Our approaches are attractive for applications that need to learn a language model from user devices in a privacy-preserving manner.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi etÂ al. (2016)</span>
<span class="ltx_bibblock">
MartÃ­n Abadi, Andy Chu, IanÂ J. Goodfellow, H.Â Brendan McMahan, Ilya
Mironov, Kunal Talwar, and LiÂ Zhang. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1145/2976749.2978318" title="" class="ltx_ref ltx_href">Deep learning with
differential privacy</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 ACM SIGSAC Conference on
Computer and Communications Security, Vienna, Austria, October 24-28, 2016</em>,
pages 308â€“318. ACM.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi etÂ al. (2015)</span>
<span class="ltx_bibblock">
MartÃ­n Abadi, Ashish Agarwal, Paul Barham, Eugene Brevdo, Zhifeng Chen, Craig
Citro, GregÂ S. Corrado, Andy Davis, Jeffrey Dean, Matthieu Devin, Sanjay
Ghemawat, Ian Goodfellow, Andrew Harp, Geoffrey Irving, Michael Isard, Rafal
Jozefowicz, Yangqing Jia, Lukasz Kaiser, Manjunath Kudlur, Josh Levenberg,
Dan ManÃ©, Mike Schuster, Rajat Monga, Sherry Moore, Derek Murray, Chris
Olah, Jonathon Shlens, Benoit Steiner, Ilya Sutskever, Kunal Talwar, Paul
Tucker, Vincent Vanhoucke, Vijay Vasudevan, Fernanda ViÃ©gas, Oriol Vinyals,
Pete Warden, Martin Wattenberg, Martin Wicke, Yuan Yu, and Xiaoqiang Zheng.
2015.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.5281/zenodo.4724125" title="" class="ltx_ref ltx_href">TensorFlow,
Large-scale machine learning on heterogeneous systems</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Authors (2019)</span>
<span class="ltx_bibblock">
The TensorflowÂ Federated Authors. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/stackoverflow/load_data" title="" class="ltx_ref ltx_href">tff.simulation.datasets.stackoverflow.load_data</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bassily etÂ al. (2014)</span>
<span class="ltx_bibblock">
Raef Bassily, Adam Smith, and Abhradeep Thakurta. 2014.

</span>
<span class="ltx_bibblock">Private empirical risk minimization: Efficient algorithms and tight
error bounds.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2014 IEEE 55th annual symposium on foundations of computer
science</em>, pages 464â€“473. IEEE.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown etÂ al. (2020)</span>
<span class="ltx_bibblock">
TomÂ B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan,
Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom
Henighan, Rewon Child, Aditya Ramesh, DanielÂ M. Ziegler, Jeffrey Wu, Clemens
Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott
Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec
Radford, Ilya Sutskever, and Dario Amodei. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html" title="" class="ltx_ref ltx_href">Language models are few-shot learners</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual
Conference on Neural Information Processing Systems 2020, NeurIPS 2020,
December 6-12, 2020, virtual</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini etÂ al. (2019)</span>
<span class="ltx_bibblock">
Nicholas Carlini, Chang Liu, Ãšlfar Erlingsson, Jernej Kos, and Dawn Song.
2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.usenix.org/conference/usenixsecurity19/presentation/carlini" title="" class="ltx_ref ltx_href">The secret sharer: Evaluating and testing unintended memorization in neural
networks</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">28th USENIX Security Symposium, USENIX Security 2019,
Santa Clara, CA, USA, August 14-16, 2019</em>, pages 267â€“284. USENIX
Association.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini etÂ al. (2021)</span>
<span class="ltx_bibblock">
Nicholas Carlini, Florian TramÃ¨r, Eric Wallace, Matthew Jagielski, Ariel
Herbert-Voss, Katherine Lee, Adam Roberts, TomÂ B. Brown, Dawn Song,
Ãšlfar Erlingsson, Alina Oprea, and Colin Raffel. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.usenix.org/conference/usenixsecurity21/presentation/carlini-extracting" title="" class="ltx_ref ltx_href">Extracting training data from large language models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">30th USENIX Security Symposium, USENIX Security 2021,
August 11-13, 2021</em>, pages 2633â€“2650. USENIX Association.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Huo (2016)</span>
<span class="ltx_bibblock">
Kai Chen and Qiang Huo. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP.2016.7472805" title="" class="ltx_ref ltx_href">Scalable
training of deep learning machines by incremental block training with
intra-block parallel optimization and blockwise model-update filtering</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">2016 IEEE International Conference on Acoustics, Speech
and Signal Processing, ICASSP 2016, Shanghai, China, March 20-25, 2016</em>,
pages 5880â€“5884. IEEE.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin etÂ al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/n19-1423" title="" class="ltx_ref ltx_href">BERT: pre-training of
deep bidirectional transformers for language understanding</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, NAACL-HLT 2019, Minneapolis, MN, USA, June 2-7, 2019, Volume
1 (Long and Short Papers)</em>, pages 4171â€“4186. Association for Computational
Linguistics.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork etÂ al. (2006)</span>
<span class="ltx_bibblock">
Cynthia Dwork, Frank McSherry, Kobbi Nissim, and AdamÂ D. Smith. 2006.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1007/11681878_14" title="" class="ltx_ref ltx_href">Calibrating noise to
sensitivity in private data analysis</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Theory of Cryptography, Third Theory of Cryptography
Conference, TCC 2006, New York, NY, USA, March 4-7, 2006, Proceedings</em>,
volume 3876 of <em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic">Lecture Notes in Computer Science</em>, pages 265â€“284.
Springer.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork and Roth (2014)</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron Roth. 2014.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1561/0400000042" title="" class="ltx_ref ltx_href">The algorithmic
foundations of differential privacy</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Found. Trends Theor. Comput. Sci.</em>, 9(3-4):211â€“407.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gutmann and HyvÃ¤rinen (2010)</span>
<span class="ltx_bibblock">
Michael Gutmann and Aapo HyvÃ¤rinen. 2010.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://proceedings.mlr.press/v9/gutmann10a.html" title="" class="ltx_ref ltx_href">Noise-contrastive estimation: A new estimation principle for unnormalized
statistical models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirteenth International Conference on
Artificial Intelligence and Statistics, AISTATS 2010, Chia Laguna Resort,
Sardinia, Italy, May 13-15, 2010</em>, volumeÂ 9 of <em id="bib.bib12.2.2" class="ltx_emph ltx_font_italic">JMLR Proceedings</em>,
pages 297â€“304. JMLR.org.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu etÂ al. (2019)</span>
<span class="ltx_bibblock">
Tzu-MingÂ Harry Hsu, Hang Qi, and Matthew Brown. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1909.06335" title="" class="ltx_ref ltx_href">Measuring the effects of
non-identical data distribution for federated visual classification</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1909.06335.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu etÂ al. (2021)</span>
<span class="ltx_bibblock">
EdwardÂ J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li,
Shean Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2106.09685" title="" class="ltx_ref ltx_href">Lora: Low-rank adaptation of
large language models</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2106.09685.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2020)</span>
<span class="ltx_bibblock">
Zhen Huang, Tim Ng, Leo Liu, Henry Mason, Xiaodan Zhuang, and Daben Liu. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/ICASSP40776.2020.9053973" title="" class="ltx_ref ltx_href">SNDCNN:
self-normalizing deep cnns with scaled exponential linear units for speech
recognition</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2020 IEEE International Conference on Acoustics, Speech
and Signal Processing, ICASSP 2020, Barcelona, Spain, May 4-8, 2020</em>, pages
6854â€“6858. IEEE.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martens (2020)</span>
<span class="ltx_bibblock">
James Martens. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://jmlr.org/papers/v21/17-678.html" title="" class="ltx_ref ltx_href">New insights and
perspectives on the natural gradient method</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">J. Mach. Learn. Res.</em>, 21:146:1â€“146:76.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan etÂ al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
BlaiseÂ AgÃ¼era yÂ Arcas. 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_href">Communication-efficient learning of deep networks from decentralized data</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics, AISTATS 2017, 20-22 April 2017,
Fort Lauderdale, FL, USA</em>, volumeÂ 54 of <em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine
Learning Research</em>, pages 1273â€“1282. PMLR.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan etÂ al. (2018)</span>
<span class="ltx_bibblock">
H.Â Brendan McMahan, Daniel Ramage, Kunal Talwar, and LiÂ Zhang. 2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://openreview.net/forum?id=BJ0hF1Z0b" title="" class="ltx_ref ltx_href">Learning
differentially private recurrent language models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">6th International Conference on Learning Representations,
ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track
Proceedings</em>. OpenReview.net.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis etÂ al. (2019)</span>
<span class="ltx_bibblock">
Luca Melis, Congzheng Song, EmilianoÂ De Cristofaro, and Vitaly Shmatikov. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/SP.2019.00029" title="" class="ltx_ref ltx_href">Exploiting unintended
feature leakage in collaborative learning</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Symposium on Security and Privacy, SP 2019,
San Francisco, CA, USA, May 19-23, 2019</em>, pages 691â€“706. IEEE.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mironov (2017)</span>
<span class="ltx_bibblock">
Ilya Mironov. 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1109/CSF.2017.11" title="" class="ltx_ref ltx_href">RÃ©nyi differential
privacy</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">30th IEEE Computer Security Foundations Symposium, CSF
2017, Santa Barbara, CA, USA, August 21-25, 2017</em>, pages 263â€“275. IEEE
Computer Society.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mironov etÂ al. (2019)</span>
<span class="ltx_bibblock">
Ilya Mironov, Kunal Talwar, and LiÂ Zhang. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1908.10530" title="" class="ltx_ref ltx_href">RÃ©nyi differential
privacy of the sampled gaussian mechanism</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1908.10530.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih and Teh (2012)</span>
<span class="ltx_bibblock">
Andriy Mnih and YeeÂ Whye Teh. 2012.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://icml.cc/2012/papers/855.pdf" title="" class="ltx_ref ltx_href">A fast and simple
algorithm for training neural probabilistic language models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 29th International Conference on Machine
Learning, ICML 2012, Edinburgh, Scotland, UK, June 26 - July 1, 2012</em>.
icml.cc / Omnipress.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri etÂ al. (2002)</span>
<span class="ltx_bibblock">
Mehryar Mohri, Fernando Pereira, and Michael Riley. 2002.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1006/csla.2001.0184" title="" class="ltx_ref ltx_href">Weighted finite-state
transducers in speech recognition</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Comput. Speech Lang.</em>, 16(1):69â€“88.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press and Wolf (2017)</span>
<span class="ltx_bibblock">
Ofir Press and Lior Wolf. 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/e17-2025" title="" class="ltx_ref ltx_href">Using the output
embedding to improve language models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 15th Conference of the European Chapter
of the Association for Computational Linguistics, EACL 2017, Valencia,
Spain, April 3-7, 2017, Volume 2: Short Papers</em>, pages 157â€“163. Association
for Computational Linguistics.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever. 2018.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, etÂ al. 2019.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">OpenAI blog</em>, 1(8):9.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi etÂ al. (2021)</span>
<span class="ltx_bibblock">
SashankÂ J. Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub KoneÄnÃ½, Sanjiv Kumar, and HughÂ Brendan McMahan. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://openreview.net/forum?id=LkFG3lB13U5" title="" class="ltx_ref ltx_href">Adaptive
federated optimization</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations,
ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saebi etÂ al. (2021)</span>
<span class="ltx_bibblock">
Mandana Saebi, Ernest Pusateri, Aaksha Meghawat, and ChristopheÂ Van Gysel.
2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.21437/Interspeech.2021-1767" title="" class="ltx_ref ltx_href">A
discriminative entity-aware language model for virtual assistants</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Interspeech 2021, 22nd Annual Conference of the
International Speech Communication Association, Brno, Czechia, 30 August - 3
September 2021</em>, pages 2032â€“2036. ISCA.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoeybi etÂ al. (2019)</span>
<span class="ltx_bibblock">
Mohammad Shoeybi, Mostofa Patwary, Raul Puri, Patrick LeGresley, Jared Casper,
and Bryan Catanzaro. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1909.08053" title="" class="ltx_ref ltx_href">Megatron-lm: Training
multi-billion parameter language models using model parallelism</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1909.08053.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani etÂ al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
AidanÂ N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="" class="ltx_ref ltx_href">Attention is all you need</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 30: Annual
Conference on Neural Information Processing Systems 2017, December 4-9, 2017,
Long Beach, CA, USA</em>, pages 5998â€“6008.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2015)</span>
<span class="ltx_bibblock">
Shiliang Zhang, Hui Jiang, Mingbin Xu, Junfeng Hou, and Li-Rong Dai. 2015.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.3115/v1/p15-2081" title="" class="ltx_ref ltx_href">The fixed-size
ordinally-forgetting encoding method for neural network language models</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 53rd Annual Meeting of the Association
for Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing of the Asian Federation of Natural Language
Processing, ACL 2015, July 26-31, 2015, Beijing, China, Volume 2: Short
Papers</em>, pages 495â€“500. The Association for Computer Linguistics.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu etÂ al. (2019)</span>
<span class="ltx_bibblock">
Ligeng Zhu, Zhijian Liu, and Song Han. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.neurips.cc/paper/2019/hash/60a6c4002cc7b29142def8871531281a-Abstract.html" title="" class="ltx_ref ltx_href">Deep leakage from gradients</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32: Annual
Conference on Neural Information Processing Systems 2019, NeurIPS 2019,
December 8-14, 2019, Vancouver, BC, Canada</em>, pages 14747â€“14756.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="A0.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2207.08988/assets/ema_so.png" id="A0.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="598" height="442" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2207.08988/assets/ema_msg.png" id="A0.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="598" height="442" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Effect of EMA (<math id="A0.F1.2.m1.1" class="ltx_Math" alttext="\gamma=0.999" display="inline"><semantics id="A0.F1.2.m1.1b"><mrow id="A0.F1.2.m1.1.1" xref="A0.F1.2.m1.1.1.cmml"><mi id="A0.F1.2.m1.1.1.2" xref="A0.F1.2.m1.1.1.2.cmml">Î³</mi><mo id="A0.F1.2.m1.1.1.1" xref="A0.F1.2.m1.1.1.1.cmml">=</mo><mn id="A0.F1.2.m1.1.1.3" xref="A0.F1.2.m1.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="A0.F1.2.m1.1c"><apply id="A0.F1.2.m1.1.1.cmml" xref="A0.F1.2.m1.1.1"><eq id="A0.F1.2.m1.1.1.1.cmml" xref="A0.F1.2.m1.1.1.1"></eq><ci id="A0.F1.2.m1.1.1.2.cmml" xref="A0.F1.2.m1.1.1.2">ğ›¾</ci><cn type="float" id="A0.F1.2.m1.1.1.3.cmml" xref="A0.F1.2.m1.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.F1.2.m1.1d">\gamma=0.999</annotation></semantics></math>) with <em id="A0.F1.5.1" class="ltx_emph ltx_font_italic">PEU</em> and <em id="A0.F1.6.2" class="ltx_emph ltx_font_italic">PEU + LoRA</em> setup. x-axis is the number of PFL rounds and y-axis is the perplexity on the dev set. </figcaption>
</figure>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Results</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">FigureÂ <a href="#A0.F1" title="Figure 1 â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates the effect of EMA described in SectionÂ <a href="#S3.SS3" title="3.3 Exponentially-decayed Moving Average â€£ 3 Methods â€£ Training Large-Vocabulary Neural Language Models by Private Federated Learning for Resource-Constrained Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.
For both <em id="A1.p1.1.1" class="ltx_emph ltx_font_italic">PEU</em> and <em id="A1.p1.1.2" class="ltx_emph ltx_font_italic">PEU + LoRA</em> setup on the StackOverflow dataset, EMA models achieved better perplexity and their convergence curves are much smoother due to the reason that moving average can smooth the DP noise.
For virtual assistant task, EMA models did produce a stabler curve but the perplexity values are similar to models without EMA.
We suspect it is because that virtual assistant models started from a pretrained model which was already close to a local minima and there is a little room for EMA to improve the convergence in this case.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2207.08987" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2207.08988" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2207.08988">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2207.08988" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2207.08989" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar 13 14:26:33 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
