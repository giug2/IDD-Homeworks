<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.14532] RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold</title><meta property="og:description" content="Training on model-generated synthetic data is a promising approach for finetuning LLMs, but it remains unclear when it helps or hurts. In this paper, we investigate this question for math reasoning via an empirical stuâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.14532">

<!--Generated on Fri Jul  5 22:16:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\correspondingauthor</span>
<p id="p1.2" class="ltx_p">Amrith Setlur; asetlur@andrew.cmu.edu. This work was done entirely at Carnegie Mellon University (CMU). 
<br class="ltx_break">Data and code will be released here: <a target="_blank" href="https://github.com/ars22/scaling-LLM-math-synthetic-data" title="" class="ltx_ref ltx_href">https://github.com/ars22/scaling-LLM-math-synthetic-data</a>.</p>
</div>
<h1 class="ltx_title ltx_title_document">RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Amrith Setlur
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Carnegie Mellon University
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Saurabh Garg
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Carnegie Mellon University
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xinyang (Young) Geng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Google DeepMind
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Naman Garg
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">MultiOn
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Virginia Smith
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Carnegie Mellon University
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aviral Kumar
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Google DeepMind
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Training on model-generated synthetic data is a promising approach for finetuning LLMs, but it remains unclear when it helps or hurts. In this paper, we investigate this question for math reasoning via an empirical study, followed by building a conceptual understanding of our observations.
First, we find that while the typical approach of finetuning a model on synthetic correct or <em id="id1.1.1" class="ltx_emph ltx_font_italic">positive</em> problem-solution pairs generated by capable models offers modest performance gains, sampling more correct solutions from the finetuned learner itself followed by subsequent fine-tuning on this self-generated data <span id="id1.1.2" class="ltx_text ltx_font_bold">doubles</span> the efficiency of the same synthetic problems. At the same time, training on model-generated positives can amplify various spurious correlations, resulting in flat or even inverse scaling trends as the amount of data increases. Surprisingly, we find that several of these issues can be addressed if we also utilize <em id="id1.1.3" class="ltx_emph ltx_font_italic">negative</em> responses, <em id="id1.1.4" class="ltx_emph ltx_font_italic">i.e.</em>,Â model-generated responses that are deemed incorrect by a final answer verifier. Crucially, these negatives must be constructed such that the training can appropriately recover the utility or advantage of each intermediate step in the negative response. With this <em id="id1.1.5" class="ltx_emph ltx_font_italic">per-step</em> scheme, we are able to attain consistent gains over only positive data, attaining performance similar to amplifying the amount of synthetic data by <math id="id1.1.m1.1" class="ltx_math_unparsed" alttext="\mathbf{8\times}" display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1b"><mn id="id1.1.m1.1.1">ğŸ–</mn><mo lspace="0.222em" id="id1.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="id1.1.m1.1c">\mathbf{8\times}</annotation></semantics></math>. We show that training on per-step negatives can help to unlearn spurious correlations in the positive data, and is equivalent to advantage-weighted reinforcement learning (RL),
implying that it inherits robustness benefits of RL over imitating positive data alone.</p>
</div>
<section id="S1" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h3>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Training large language models (LLMs) relies on the ability to train on large amounts of high-quality data. It is predicted that we will run out of high-quality internet data by 2026Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, necessitating training on model-generated data, or what is commonly referred to as <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">synthetic data</em>. Recent trends illustrate that scaling up synthetic data can lead to improvementsÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> on hard reasoning problems, while other results illustrate that training on synthetic data can steer the performance of the model into a downward spiralÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>â€”amplying biases, misinformation, and undesired stylistic properties. Thus while <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">in principle</em>, synthetic data could potentially address data scarcity, it must be designed in an appropriate manner to be effective. However, this has been hard due to a lack of an understanding of how synthetic data contributes to LLM behavior.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.5" class="ltx_p">To provide clarity on how synthetic data contributes to performance, we aim to understand its impact on LLM capabilities via a study on math reasoning, a prevalent scenario where synthetic data is used. Typically, in this setting, synthetic data corresponds to correct or <em id="S1.p2.5.1" class="ltx_emph ltx_font_italic">positive</em> model-generated responses for a novel set of initial problems synthesized by prompting capable modelsÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.
The resulting model is then evaluated on a held-out set of problems drawn from a test set. Perhaps as expected, we find that performance improves when finetuning models on positive synthetic responses, though the scaling rates for performance improvement are often substantially slower than those observed during pretraining. Concretely, we find that under the scaling law of <cite class="ltx_cite ltx_citemacro_citet">Zhang etÂ al. [<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>, the error rate scales as <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S1.p2.1.m1.1a"><mo id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">â‰ˆ</mo><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><approx id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\approx</annotation></semantics></math><math id="S1.p2.2.m2.1" class="ltx_Math" alttext="{D}^{-0.05}" display="inline"><semantics id="S1.p2.2.m2.1a"><msup id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mi id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">D</mi><mrow id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml"><mo id="S1.p2.2.m2.1.1.3a" xref="S1.p2.2.m2.1.1.3.cmml">âˆ’</mo><mn id="S1.p2.2.m2.1.1.3.2" xref="S1.p2.2.m2.1.1.3.2.cmml">0.05</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1">superscript</csymbol><ci id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2">ğ·</ci><apply id="S1.p2.2.m2.1.1.3.cmml" xref="S1.p2.2.m2.1.1.3"><minus id="S1.p2.2.m2.1.1.3.1.cmml" xref="S1.p2.2.m2.1.1.3"></minus><cn type="float" id="S1.p2.2.m2.1.1.3.2.cmml" xref="S1.p2.2.m2.1.1.3.2">0.05</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">{D}^{-0.05}</annotation></semantics></math> to <math id="S1.p2.3.m3.1" class="ltx_Math" alttext="{D}^{-0.15}" display="inline"><semantics id="S1.p2.3.m3.1a"><msup id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">D</mi><mrow id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml"><mo id="S1.p2.3.m3.1.1.3a" xref="S1.p2.3.m3.1.1.3.cmml">âˆ’</mo><mn id="S1.p2.3.m3.1.1.3.2" xref="S1.p2.3.m3.1.1.3.2.cmml">0.15</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1">superscript</csymbol><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">ğ·</ci><apply id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3"><minus id="S1.p2.3.m3.1.1.3.1.cmml" xref="S1.p2.3.m3.1.1.3"></minus><cn type="float" id="S1.p2.3.m3.1.1.3.2.cmml" xref="S1.p2.3.m3.1.1.3.2">0.15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">{D}^{-0.15}</annotation></semantics></math> in the size <math id="S1.p2.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S1.p2.4.m4.1a"><mi id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><ci id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">D</annotation></semantics></math> of synthetic dataset. Second, we observe that not all types of positive synthetic data are equally effective: often positive responses self-generated by the learner itself are as effective as <math id="S1.p2.5.m5.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S1.p2.5.m5.1a"><mrow id="S1.p2.5.m5.1b"><mn id="S1.p2.5.m5.1.1">2</mn><mo lspace="0.222em" id="S1.p2.5.m5.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">2\times</annotation></semantics></math> synthetic data from bigger models in improving performance. This is because responses from a similar model are â€œeasier-to-fitâ€ than those from a more capable model, resulting in reduced memorizationÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> during finetuning. We also observe that if the positive response contains incorrect/irrelevant intermediate steps, training on such data often incentivizes the model to overfit on spurious correlations, leading to a flat or even inverse scaling with more data.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2406.14532/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="341" height="89" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2406.14532/assets/x2.png" id="S1.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="97" height="87" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">

<em id="S1.F1.5.2.1" class="ltx_emph ltx_font_bold ltx_font_italic">Left: Positive/negative synthetic data:</em> Pictorial representation of our synthetic data pipeline, definitions for positive and negative synthetic data and how they are fed to supervised finetuning (SFT; positive synthetic data from more capable models), rejection finetuning (RFT; positive self-generated synthetic data from the SFT model) and step-level RL (via per-step DPO) algorithms we analyze in our work. <em id="S1.F1.5.2.2" class="ltx_emph ltx_font_bold ltx_font_italic">Right: An illustration of our main result:</em> using RFT on self-generated positives scales the efficiency of SFT on synthetic problems and responses by 2x, whereas using step-level RL with negative data scales the efficiency by 8x.
</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Perhaps surprisingly, we find that the aforementioned pathologies of training on positive data only can be addressed if we also utilize synthetic <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">negative</em> responses: responses generated by the model that do not result in obtaining a correct final answer. One way to utilize negative responses is via methods such as direct preference optimization (DPO)Â <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. While performance of standard DPOÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> largely flatlines as the number of synthetic problems are scaled up (FigureÂ <a href="#S6.F7" title="Figure 7 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), we are able to attain consistent improvements if the negative data is generated appropriately. A solution trace for a math problem typically comprises of multiple <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">reasoning steps</em> corresponding to intermediate results. Our insight is that instead of contrasting arbitrary correct and incorrect responses, we should contrast those positive and negative responses that depict good and bad choices for the more â€œcriticalâ€ intermediate steps: steps that the model must carefully produce so as to succeed at the problem. In other words, critical steps are those which the model is unable to recover from, and hence, must be emphasized. With this scheme, we are able to attain consistent gains over only positive data, <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">attaining performance similar to scaling up positive synthetic data by <math id="S1.p3.1.1.m1.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S1.p3.1.1.m1.1a"><mrow id="S1.p3.1.1.m1.1b"><mn id="S1.p3.1.1.m1.1.1">8</mn><mo lspace="0.222em" id="S1.p3.1.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S1.p3.1.1.m1.1c">8\times</annotation></semantics></math>.</span> We also show that training on this sort of negative data evades spurious steps amplified by training on positive data alone.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">To theoretically understand our findings, we build a conceptual model of how training on this data benefits performance. Formally, we show that this construction of negative data, which emphasizes â€œcriticalâ€ tokens (FigureÂ <a href="#S6.F6" title="Figure 6 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) enables us to perform credit assignment, and is equivalent to training the model with per-step advantage-weighted reinforcement learning (RL)Â <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> on a mixture of positive and negative synthetic data. Specifically, these advantage values are computed under an optimal value function induced by sampling multiple responses under the SFT policy obtained by training on only the positive data. This reduction of using negative data to advantage-weighted RL enables us to conceptually compare it to training on positive data, which corresponds to imitation learning (<em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">i.e.</em>,Â behavioral cloning) on positive data.
First, we are able to argue for the generalization gains of advantage-weighted RL through the lens of distribution robust objectives.
Second, building on theoretical results in RLÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, we are also able to show that when advantages can be estimated reliably, advantage-weighted RL will be significantly more sample-efficient compared to imitation.
Overall, this model explains the utility of negative data over only positive data.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.2" class="ltx_p">Our contribution is a study of the role of synthetic data in improving math reasoning capabilities of LLMs. We derive scaling laws for positive and negative data on common reasoning benchmarks such as GSM8KÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and MATHÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, and observe that: <span id="S1.p5.2.1" class="ltx_text ltx_font_bold">(a)</span> training on positive synthetic data from capable models results in scaling rates that are significantly slower than standard empirical risk minimization; <span id="S1.p5.2.2" class="ltx_text ltx_font_bold">(b)</span> training on model-generated positive synthetic data can improve sample efficiency by <math id="S1.p5.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1b"><mn id="S1.p5.1.m1.1.1">2</mn><mo lspace="0.222em" id="S1.p5.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">2\times</annotation></semantics></math> but also amplifies spurious correlations; <span id="S1.p5.2.3" class="ltx_text ltx_font_bold">(c)</span> appropriate ways of constructing learner-specific negative data with emphasis on critical steps, results in a performance boost equivalent to scaling up positive data <math id="S1.p5.2.m2.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S1.p5.2.m2.1a"><mrow id="S1.p5.2.m2.1b"><mn id="S1.p5.2.m2.1.1">8</mn><mo lspace="0.222em" id="S1.p5.2.m2.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">8\times</annotation></semantics></math>; <span id="S1.p5.2.4" class="ltx_text ltx_font_bold">(d)</span> training with negative data provides a mechanism to unlearn spurious correlations; and <span id="S1.p5.2.5" class="ltx_text ltx_font_bold">(e)</span> we present a conceptual model inspired from RL to explain our observations for synthetic data, and use it to explain the generalization benefits we see.</p>
</div>
</section>
<section id="S2" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h3>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">A standard procedure to finetune a pretrained LLM is teacher-forcing on expert data, <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">i.e.</em>,Â maximizing the likelihood of the next token given all previous tokensÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. In AppendixÂ <a href="#A3" title="Appendix C Additional Related Work â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a> we discuss some failure modes of this procedure for math reasoning that positive or negative synthetic data can address.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Positive synthetic data.</span>
Learning theory dictates that the SFT policy trained on more SFT data (<em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">e.g.</em>,Â 1.5M for DeepSeek-MathÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>) would have improved math reasoning capbabilities.
Thus, a common goal for generating synthetic data as close as possible to the SFT dataÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. That said, generating high quality math data can be challenging, since verification can often be hard.
When synthetic data is verified by larger modelsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, recent worksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> observe scaling similar to finetuning LLMs on expert dataÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, while another workÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> notes the compositional gains from SFT data for code generation.
Common sources of â€œgoodâ€ synthetic data include responses from stronger teachersÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>,
or data generated by the SFT policy
itself, in the framework of reinforced self-training (ReST) and STaR Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>.
In our work, we study and compare the performance scaling with positive synthetic data from bigger models like GPT-4 and Gemini 1.5 Pro with self-generated positive data. We connect our findings to evidence showing â€œease of learningâ€ generalizable features on self-generated completionsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> which often prevents undesirable memorizationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>.
Finally, our work also sheds light on several concerns about training on synthetic positive data amplifying biasesÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>, and leading to model collapseÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, especially due to overfitting onâ€œspuriousâ€ intermediate steps. We conceptually explain this phenomenon and also discuss how negative model-generated responses can help identify and unlearn those spurious steps.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Benefits and nuances of negative synthetic data.</span>
While most works on synthetic data for math reasoningÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> focus on training on positive (correct) answers, our work also studies complementary gains from negative (incorrect) completions generated by the SFT policyÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib67" title="" class="ltx_ref">67</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.
To leverage sub-optimal negative data, we adopt the generic framework of offline preference optimizationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>, where a preference pair is constructed using correct and incorrect responses for the same problemÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
Despite numerous studies on preference data compositionÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, it remains unclear what is the best approach to pose a reasoning problem as a preference optimization problem. Randomly pairing correct and incorrect completions in a preference pair can lead to poor performanceÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> due to objective mismatchÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite> and requires auxilliary losses to perform well. Another option is to utilize negative data for training verifiersÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> but this line of work still only trains the policy using positive data.
We introduce a conceptual model of negative data, where we understand how certain choices of negative data can assign per-step credits, which we then use to establish the equivalence of preference optimiztion to to advantage weighted RL. Self-explore method in <cite class="ltx_cite ltx_citemacro_citet">Hwang etÂ al. [<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> can be viewed as an special instance of our general framework. Another work exploiting per-step credit assignment is <cite class="ltx_cite ltx_citemacro_citet">Wang etÂ al. [<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>: through tree-based sampling they identify and use the reasoning subsequence that led to the most incorrect answers under the SFT policy for training a reward model. While this is indeed related, our conceptual model and analysis also aims to understand why assigning per-step credits can generalize better by unlearning spurious correlations, <span id="S2.p3.1.2" class="ltx_text ltx_font_italic">e.g.,</span> when the credits are given by the Q-function of the â€œbest-of-Kâ€ SFT policy.</p>
</div>
</section>
<section id="S3" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Setup and Synthetic Data Generation Pipeline</h3>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">Our goal in this paper is to understand the role of synthetic data in producing strong language model reasoners. Building on the recipe of <cite class="ltx_cite ltx_citemacro_citet">Li etÂ al. [<a href="#bib.bib29" title="" class="ltx_ref">29</a>], Liu etÂ al. [<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, we collect synthetic data consisting of both novel problems designed by capable models such as GPT4Â <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and Gemini 1.5 ProÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, and responses to these problems, obtained from the same models. Concretely, we focus on two mathematical reasoning benchmarks: GSM8KÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and MATHÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.16" class="ltx_p"><span id="S3.p2.16.1" class="ltx_text ltx_font_bold">Synthetic data pipeline.</span> First, given a dataset <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\text{real}}=\{(\mathbf{x}^{r}_{i},\mathbf{y}^{r}_{i})\}" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><msub id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">ğ’Ÿ</mi><mtext id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3a.cmml">real</mtext></msub><mo id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.2.cmml">{</mo><mrow id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.1.2.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.p2.1.m1.1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml">ğ±</mi><mi id="S3.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p2.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml">r</mi></msubsup><mo id="S3.p2.1.m1.1.1.1.1.1.2.4" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.p2.1.m1.1.1.1.1.1.2.2" xref="S3.p2.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml">ğ²</mi><mi id="S3.p2.1.m1.1.1.1.1.1.2.2.3" xref="S3.p2.1.m1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.p2.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.1.2.5" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><eq id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2"></eq><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">ğ’Ÿ</ci><ci id="S3.p2.1.m1.1.1.3.3a.cmml" xref="S3.p2.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3">real</mtext></ci></apply><set id="S3.p2.1.m1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1"><interval closure="open" id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2"><apply id="S3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1.2.2">ğ±</ci><ci id="S3.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1.2.3">ğ‘Ÿ</ci></apply><ci id="S3.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2.2.2">ğ²</ci><ci id="S3.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2.2.3">ğ‘Ÿ</ci></apply><ci id="S3.p2.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2.3">ğ‘–</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{D}_{\text{real}}=\{(\mathbf{x}^{r}_{i},\mathbf{y}^{r}_{i})\}</annotation></semantics></math> of problems <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}^{r}\sim p_{\text{real}}(\mathbf{x})" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.2" xref="S3.p2.2.m2.1.2.cmml"><msubsup id="S3.p2.2.m2.1.2.2" xref="S3.p2.2.m2.1.2.2.cmml"><mi id="S3.p2.2.m2.1.2.2.2.2" xref="S3.p2.2.m2.1.2.2.2.2.cmml">ğ±</mi><mi id="S3.p2.2.m2.1.2.2.2.3" xref="S3.p2.2.m2.1.2.2.2.3.cmml">i</mi><mi id="S3.p2.2.m2.1.2.2.3" xref="S3.p2.2.m2.1.2.2.3.cmml">r</mi></msubsup><mo id="S3.p2.2.m2.1.2.1" xref="S3.p2.2.m2.1.2.1.cmml">âˆ¼</mo><mrow id="S3.p2.2.m2.1.2.3" xref="S3.p2.2.m2.1.2.3.cmml"><msub id="S3.p2.2.m2.1.2.3.2" xref="S3.p2.2.m2.1.2.3.2.cmml"><mi id="S3.p2.2.m2.1.2.3.2.2" xref="S3.p2.2.m2.1.2.3.2.2.cmml">p</mi><mtext id="S3.p2.2.m2.1.2.3.2.3" xref="S3.p2.2.m2.1.2.3.2.3a.cmml">real</mtext></msub><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.2.3.1" xref="S3.p2.2.m2.1.2.3.1.cmml">â€‹</mo><mrow id="S3.p2.2.m2.1.2.3.3.2" xref="S3.p2.2.m2.1.2.3.cmml"><mo stretchy="false" id="S3.p2.2.m2.1.2.3.3.2.1" xref="S3.p2.2.m2.1.2.3.cmml">(</mo><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">ğ±</mi><mo stretchy="false" id="S3.p2.2.m2.1.2.3.3.2.2" xref="S3.p2.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.2.cmml" xref="S3.p2.2.m2.1.2"><csymbol cd="latexml" id="S3.p2.2.m2.1.2.1.cmml" xref="S3.p2.2.m2.1.2.1">similar-to</csymbol><apply id="S3.p2.2.m2.1.2.2.cmml" xref="S3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.2.1.cmml" xref="S3.p2.2.m2.1.2.2">superscript</csymbol><apply id="S3.p2.2.m2.1.2.2.2.cmml" xref="S3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.2.2.1.cmml" xref="S3.p2.2.m2.1.2.2">subscript</csymbol><ci id="S3.p2.2.m2.1.2.2.2.2.cmml" xref="S3.p2.2.m2.1.2.2.2.2">ğ±</ci><ci id="S3.p2.2.m2.1.2.2.2.3.cmml" xref="S3.p2.2.m2.1.2.2.2.3">ğ‘–</ci></apply><ci id="S3.p2.2.m2.1.2.2.3.cmml" xref="S3.p2.2.m2.1.2.2.3">ğ‘Ÿ</ci></apply><apply id="S3.p2.2.m2.1.2.3.cmml" xref="S3.p2.2.m2.1.2.3"><times id="S3.p2.2.m2.1.2.3.1.cmml" xref="S3.p2.2.m2.1.2.3.1"></times><apply id="S3.p2.2.m2.1.2.3.2.cmml" xref="S3.p2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.3.2.1.cmml" xref="S3.p2.2.m2.1.2.3.2">subscript</csymbol><ci id="S3.p2.2.m2.1.2.3.2.2.cmml" xref="S3.p2.2.m2.1.2.3.2.2">ğ‘</ci><ci id="S3.p2.2.m2.1.2.3.2.3a.cmml" xref="S3.p2.2.m2.1.2.3.2.3"><mtext mathsize="70%" id="S3.p2.2.m2.1.2.3.2.3.cmml" xref="S3.p2.2.m2.1.2.3.2.3">real</mtext></ci></apply><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">ğ±</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathbf{x}_{i}^{r}\sim p_{\text{real}}(\mathbf{x})</annotation></semantics></math> and solution traces <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{i}^{r}\sim p_{\text{real}}(\mathbf{y}\mid\mathbf{x}_{i})" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><msubsup id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.3.2.2" xref="S3.p2.3.m3.1.1.3.2.2.cmml">ğ²</mi><mi id="S3.p2.3.m3.1.1.3.2.3" xref="S3.p2.3.m3.1.1.3.2.3.cmml">i</mi><mi id="S3.p2.3.m3.1.1.3.3" xref="S3.p2.3.m3.1.1.3.3.cmml">r</mi></msubsup><mo id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">âˆ¼</mo><mrow id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml"><msub id="S3.p2.3.m3.1.1.1.3" xref="S3.p2.3.m3.1.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.1.3.2" xref="S3.p2.3.m3.1.1.1.3.2.cmml">p</mi><mtext id="S3.p2.3.m3.1.1.1.3.3" xref="S3.p2.3.m3.1.1.1.3.3a.cmml">real</mtext></msub><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.1.1.1.2" xref="S3.p2.3.m3.1.1.1.2.cmml">â€‹</mo><mrow id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.3.m3.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.1.2.cmml">ğ²</mi><mo id="S3.p2.3.m3.1.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.1.cmml">âˆ£</mo><msub id="S3.p2.3.m3.1.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.1.3.2" xref="S3.p2.3.m3.1.1.1.1.1.1.3.2.cmml">ğ±</mi><mi id="S3.p2.3.m3.1.1.1.1.1.1.3.3" xref="S3.p2.3.m3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="latexml" id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">similar-to</csymbol><apply id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.3">superscript</csymbol><apply id="S3.p2.3.m3.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.3.2.1.cmml" xref="S3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.3.2.2.cmml" xref="S3.p2.3.m3.1.1.3.2.2">ğ²</ci><ci id="S3.p2.3.m3.1.1.3.2.3.cmml" xref="S3.p2.3.m3.1.1.3.2.3">ğ‘–</ci></apply><ci id="S3.p2.3.m3.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3">ğ‘Ÿ</ci></apply><apply id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"><times id="S3.p2.3.m3.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.2"></times><apply id="S3.p2.3.m3.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.1.3.2">ğ‘</ci><ci id="S3.p2.3.m3.1.1.1.3.3a.cmml" xref="S3.p2.3.m3.1.1.1.3.3"><mtext mathsize="70%" id="S3.p2.3.m3.1.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.1.3.3">real</mtext></ci></apply><apply id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.2">ğ²</ci><apply id="S3.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.3.2">ğ±</ci><ci id="S3.p2.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathbf{y}_{i}^{r}\sim p_{\text{real}}(\mathbf{y}\mid\mathbf{x}_{i})</annotation></semantics></math>, we prompt one of the highly-capable models with a uniformly random sample <math id="S3.p2.4.m4.2" class="ltx_Math" alttext="(\mathbf{x}^{r}_{i},\mathbf{y}^{r}_{i})\in\mathcal{D}_{\text{real}}" display="inline"><semantics id="S3.p2.4.m4.2a"><mrow id="S3.p2.4.m4.2.2" xref="S3.p2.4.m4.2.2.cmml"><mrow id="S3.p2.4.m4.2.2.2.2" xref="S3.p2.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.4.m4.2.2.2.2.3" xref="S3.p2.4.m4.2.2.2.3.cmml">(</mo><msubsup id="S3.p2.4.m4.1.1.1.1.1" xref="S3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.p2.4.m4.1.1.1.1.1.2.2" xref="S3.p2.4.m4.1.1.1.1.1.2.2.cmml">ğ±</mi><mi id="S3.p2.4.m4.1.1.1.1.1.3" xref="S3.p2.4.m4.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p2.4.m4.1.1.1.1.1.2.3" xref="S3.p2.4.m4.1.1.1.1.1.2.3.cmml">r</mi></msubsup><mo id="S3.p2.4.m4.2.2.2.2.4" xref="S3.p2.4.m4.2.2.2.3.cmml">,</mo><msubsup id="S3.p2.4.m4.2.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.p2.4.m4.2.2.2.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.2.2.2.cmml">ğ²</mi><mi id="S3.p2.4.m4.2.2.2.2.2.3" xref="S3.p2.4.m4.2.2.2.2.2.3.cmml">i</mi><mi id="S3.p2.4.m4.2.2.2.2.2.2.3" xref="S3.p2.4.m4.2.2.2.2.2.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="S3.p2.4.m4.2.2.2.2.5" xref="S3.p2.4.m4.2.2.2.3.cmml">)</mo></mrow><mo id="S3.p2.4.m4.2.2.3" xref="S3.p2.4.m4.2.2.3.cmml">âˆˆ</mo><msub id="S3.p2.4.m4.2.2.4" xref="S3.p2.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.2.2.4.2" xref="S3.p2.4.m4.2.2.4.2.cmml">ğ’Ÿ</mi><mtext id="S3.p2.4.m4.2.2.4.3" xref="S3.p2.4.m4.2.2.4.3a.cmml">real</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.2b"><apply id="S3.p2.4.m4.2.2.cmml" xref="S3.p2.4.m4.2.2"><in id="S3.p2.4.m4.2.2.3.cmml" xref="S3.p2.4.m4.2.2.3"></in><interval closure="open" id="S3.p2.4.m4.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.2"><apply id="S3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.p2.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.p2.4.m4.1.1.1.1.1.2.2">ğ±</ci><ci id="S3.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.p2.4.m4.1.1.1.1.1.2.3">ğ‘Ÿ</ci></apply><ci id="S3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.p2.4.m4.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.p2.4.m4.2.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.p2.4.m4.2.2.2.2.2">subscript</csymbol><apply id="S3.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.p2.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S3.p2.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2.2">ğ²</ci><ci id="S3.p2.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2.3">ğ‘Ÿ</ci></apply><ci id="S3.p2.4.m4.2.2.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.2.2.3">ğ‘–</ci></apply></interval><apply id="S3.p2.4.m4.2.2.4.cmml" xref="S3.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.4.1.cmml" xref="S3.p2.4.m4.2.2.4">subscript</csymbol><ci id="S3.p2.4.m4.2.2.4.2.cmml" xref="S3.p2.4.m4.2.2.4.2">ğ’Ÿ</ci><ci id="S3.p2.4.m4.2.2.4.3a.cmml" xref="S3.p2.4.m4.2.2.4.3"><mtext mathsize="70%" id="S3.p2.4.m4.2.2.4.3.cmml" xref="S3.p2.4.m4.2.2.4.3">real</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.2c">(\mathbf{x}^{r}_{i},\mathbf{y}^{r}_{i})\in\mathcal{D}_{\text{real}}</annotation></semantics></math> and ask the model to generate a new problem <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">ğ±</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">ğ±</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathbf{x}_{i}</annotation></semantics></math> such that it is similar to the real problem <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{x}_{i}^{r}" display="inline"><semantics id="S3.p2.6.m6.1a"><msubsup id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2.2" xref="S3.p2.6.m6.1.1.2.2.cmml">ğ±</mi><mi id="S3.p2.6.m6.1.1.2.3" xref="S3.p2.6.m6.1.1.2.3.cmml">i</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">superscript</csymbol><apply id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.2.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.2.cmml" xref="S3.p2.6.m6.1.1.2.2">ğ±</ci><ci id="S3.p2.6.m6.1.1.2.3.cmml" xref="S3.p2.6.m6.1.1.2.3">ğ‘–</ci></apply><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">ğ‘Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\mathbf{x}_{i}^{r}</annotation></semantics></math>, in a way that a feasible solution exists.
Second, we ask the model to provide a solution trace answer <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{y}_{i}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">ğ²</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">ğ²</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\mathbf{y}_{i}</annotation></semantics></math> with step-by-step reasoning (exact prompts for <math id="S3.p2.8.m8.2" class="ltx_Math" alttext="\mathbf{x}_{i},\mathbf{y}_{i}" display="inline"><semantics id="S3.p2.8.m8.2a"><mrow id="S3.p2.8.m8.2.2.2" xref="S3.p2.8.m8.2.2.3.cmml"><msub id="S3.p2.8.m8.1.1.1.1" xref="S3.p2.8.m8.1.1.1.1.cmml"><mi id="S3.p2.8.m8.1.1.1.1.2" xref="S3.p2.8.m8.1.1.1.1.2.cmml">ğ±</mi><mi id="S3.p2.8.m8.1.1.1.1.3" xref="S3.p2.8.m8.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.8.m8.2.2.2.3" xref="S3.p2.8.m8.2.2.3.cmml">,</mo><msub id="S3.p2.8.m8.2.2.2.2" xref="S3.p2.8.m8.2.2.2.2.cmml"><mi id="S3.p2.8.m8.2.2.2.2.2" xref="S3.p2.8.m8.2.2.2.2.2.cmml">ğ²</mi><mi id="S3.p2.8.m8.2.2.2.2.3" xref="S3.p2.8.m8.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.2b"><list id="S3.p2.8.m8.2.2.3.cmml" xref="S3.p2.8.m8.2.2.2"><apply id="S3.p2.8.m8.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.1.1.2.cmml" xref="S3.p2.8.m8.1.1.1.1.2">ğ±</ci><ci id="S3.p2.8.m8.1.1.1.1.3.cmml" xref="S3.p2.8.m8.1.1.1.1.3">ğ‘–</ci></apply><apply id="S3.p2.8.m8.2.2.2.2.cmml" xref="S3.p2.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.8.m8.2.2.2.2.1.cmml" xref="S3.p2.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.p2.8.m8.2.2.2.2.2">ğ²</ci><ci id="S3.p2.8.m8.2.2.2.2.3.cmml" xref="S3.p2.8.m8.2.2.2.2.3">ğ‘–</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.2c">\mathbf{x}_{i},\mathbf{y}_{i}</annotation></semantics></math> are borrowed from <cite class="ltx_cite ltx_citemacro_citet">Li etÂ al. [<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, shown in AppendixÂ <a href="#A4" title="Appendix D Synthetic Data Generation â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>).
We assume that the answers generated via this process are accurate, and perform lightweight filtering step to remove duplicates, badly-formatted answer traces, and model failures.
Based on the above, for any synthetic problem and solution pair <math id="S3.p2.9.m9.2" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y})" display="inline"><semantics id="S3.p2.9.m9.2a"><mrow id="S3.p2.9.m9.2.3.2" xref="S3.p2.9.m9.2.3.1.cmml"><mo stretchy="false" id="S3.p2.9.m9.2.3.2.1" xref="S3.p2.9.m9.2.3.1.cmml">(</mo><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">ğ±</mi><mo id="S3.p2.9.m9.2.3.2.2" xref="S3.p2.9.m9.2.3.1.cmml">,</mo><mi id="S3.p2.9.m9.2.2" xref="S3.p2.9.m9.2.2.cmml">ğ²</mi><mo stretchy="false" id="S3.p2.9.m9.2.3.2.3" xref="S3.p2.9.m9.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.2b"><interval closure="open" id="S3.p2.9.m9.2.3.1.cmml" xref="S3.p2.9.m9.2.3.2"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">ğ±</ci><ci id="S3.p2.9.m9.2.2.cmml" xref="S3.p2.9.m9.2.2">ğ²</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.2c">(\mathbf{x},\mathbf{y})</annotation></semantics></math>, we can define a binary reward function
<math id="S3.p2.10.m10.4" class="ltx_Math" alttext="r(\mathbf{y},\hat{\mathbf{y}})\mapsto\{0,1\}" display="inline"><semantics id="S3.p2.10.m10.4a"><mrow id="S3.p2.10.m10.4.5" xref="S3.p2.10.m10.4.5.cmml"><mrow id="S3.p2.10.m10.4.5.2" xref="S3.p2.10.m10.4.5.2.cmml"><mi id="S3.p2.10.m10.4.5.2.2" xref="S3.p2.10.m10.4.5.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p2.10.m10.4.5.2.1" xref="S3.p2.10.m10.4.5.2.1.cmml">â€‹</mo><mrow id="S3.p2.10.m10.4.5.2.3.2" xref="S3.p2.10.m10.4.5.2.3.1.cmml"><mo stretchy="false" id="S3.p2.10.m10.4.5.2.3.2.1" xref="S3.p2.10.m10.4.5.2.3.1.cmml">(</mo><mi id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">ğ²</mi><mo id="S3.p2.10.m10.4.5.2.3.2.2" xref="S3.p2.10.m10.4.5.2.3.1.cmml">,</mo><mover accent="true" id="S3.p2.10.m10.2.2" xref="S3.p2.10.m10.2.2.cmml"><mi id="S3.p2.10.m10.2.2.2" xref="S3.p2.10.m10.2.2.2.cmml">ğ²</mi><mo id="S3.p2.10.m10.2.2.1" xref="S3.p2.10.m10.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p2.10.m10.4.5.2.3.2.3" xref="S3.p2.10.m10.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.p2.10.m10.4.5.1" xref="S3.p2.10.m10.4.5.1.cmml">â†¦</mo><mrow id="S3.p2.10.m10.4.5.3.2" xref="S3.p2.10.m10.4.5.3.1.cmml"><mo stretchy="false" id="S3.p2.10.m10.4.5.3.2.1" xref="S3.p2.10.m10.4.5.3.1.cmml">{</mo><mn id="S3.p2.10.m10.3.3" xref="S3.p2.10.m10.3.3.cmml">0</mn><mo id="S3.p2.10.m10.4.5.3.2.2" xref="S3.p2.10.m10.4.5.3.1.cmml">,</mo><mn id="S3.p2.10.m10.4.4" xref="S3.p2.10.m10.4.4.cmml">1</mn><mo stretchy="false" id="S3.p2.10.m10.4.5.3.2.3" xref="S3.p2.10.m10.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.4b"><apply id="S3.p2.10.m10.4.5.cmml" xref="S3.p2.10.m10.4.5"><csymbol cd="latexml" id="S3.p2.10.m10.4.5.1.cmml" xref="S3.p2.10.m10.4.5.1">maps-to</csymbol><apply id="S3.p2.10.m10.4.5.2.cmml" xref="S3.p2.10.m10.4.5.2"><times id="S3.p2.10.m10.4.5.2.1.cmml" xref="S3.p2.10.m10.4.5.2.1"></times><ci id="S3.p2.10.m10.4.5.2.2.cmml" xref="S3.p2.10.m10.4.5.2.2">ğ‘Ÿ</ci><interval closure="open" id="S3.p2.10.m10.4.5.2.3.1.cmml" xref="S3.p2.10.m10.4.5.2.3.2"><ci id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1">ğ²</ci><apply id="S3.p2.10.m10.2.2.cmml" xref="S3.p2.10.m10.2.2"><ci id="S3.p2.10.m10.2.2.1.cmml" xref="S3.p2.10.m10.2.2.1">^</ci><ci id="S3.p2.10.m10.2.2.2.cmml" xref="S3.p2.10.m10.2.2.2">ğ²</ci></apply></interval></apply><set id="S3.p2.10.m10.4.5.3.1.cmml" xref="S3.p2.10.m10.4.5.3.2"><cn type="integer" id="S3.p2.10.m10.3.3.cmml" xref="S3.p2.10.m10.3.3">0</cn><cn type="integer" id="S3.p2.10.m10.4.4.cmml" xref="S3.p2.10.m10.4.4">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.4c">r(\mathbf{y},\hat{\mathbf{y}})\mapsto\{0,1\}</annotation></semantics></math>,
which verifies if a new solution trace <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S3.p2.11.m11.1a"><mover accent="true" id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml"><mi id="S3.p2.11.m11.1.1.2" xref="S3.p2.11.m11.1.1.2.cmml">ğ²</mi><mo id="S3.p2.11.m11.1.1.1" xref="S3.p2.11.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><apply id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1"><ci id="S3.p2.11.m11.1.1.1.cmml" xref="S3.p2.11.m11.1.1.1">^</ci><ci id="S3.p2.11.m11.1.1.2.cmml" xref="S3.p2.11.m11.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">\hat{\mathbf{y}}</annotation></semantics></math> is correct or not. This is implemented with a set of answer extraction and string matching tools borrowed fromÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.
We say that a new trace <math id="S3.p2.12.m12.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S3.p2.12.m12.1a"><mover accent="true" id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml"><mi id="S3.p2.12.m12.1.1.2" xref="S3.p2.12.m12.1.1.2.cmml">ğ²</mi><mo id="S3.p2.12.m12.1.1.1" xref="S3.p2.12.m12.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><apply id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1"><ci id="S3.p2.12.m12.1.1.1.cmml" xref="S3.p2.12.m12.1.1.1">^</ci><ci id="S3.p2.12.m12.1.1.2.cmml" xref="S3.p2.12.m12.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">\hat{\mathbf{y}}</annotation></semantics></math>
is a <em id="S3.p2.16.2" class="ltx_emph ltx_font_italic">positive</em> trace if it produces the correct final answer
<em id="S3.p2.16.3" class="ltx_emph ltx_font_italic">i.e.</em>,Â <math id="S3.p2.13.m13.2" class="ltx_Math" alttext="r(\hat{\mathbf{y}},\mathbf{y})=1" display="inline"><semantics id="S3.p2.13.m13.2a"><mrow id="S3.p2.13.m13.2.3" xref="S3.p2.13.m13.2.3.cmml"><mrow id="S3.p2.13.m13.2.3.2" xref="S3.p2.13.m13.2.3.2.cmml"><mi id="S3.p2.13.m13.2.3.2.2" xref="S3.p2.13.m13.2.3.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p2.13.m13.2.3.2.1" xref="S3.p2.13.m13.2.3.2.1.cmml">â€‹</mo><mrow id="S3.p2.13.m13.2.3.2.3.2" xref="S3.p2.13.m13.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.p2.13.m13.2.3.2.3.2.1" xref="S3.p2.13.m13.2.3.2.3.1.cmml">(</mo><mover accent="true" id="S3.p2.13.m13.1.1" xref="S3.p2.13.m13.1.1.cmml"><mi id="S3.p2.13.m13.1.1.2" xref="S3.p2.13.m13.1.1.2.cmml">ğ²</mi><mo id="S3.p2.13.m13.1.1.1" xref="S3.p2.13.m13.1.1.1.cmml">^</mo></mover><mo id="S3.p2.13.m13.2.3.2.3.2.2" xref="S3.p2.13.m13.2.3.2.3.1.cmml">,</mo><mi id="S3.p2.13.m13.2.2" xref="S3.p2.13.m13.2.2.cmml">ğ²</mi><mo stretchy="false" id="S3.p2.13.m13.2.3.2.3.2.3" xref="S3.p2.13.m13.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.13.m13.2.3.1" xref="S3.p2.13.m13.2.3.1.cmml">=</mo><mn id="S3.p2.13.m13.2.3.3" xref="S3.p2.13.m13.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m13.2b"><apply id="S3.p2.13.m13.2.3.cmml" xref="S3.p2.13.m13.2.3"><eq id="S3.p2.13.m13.2.3.1.cmml" xref="S3.p2.13.m13.2.3.1"></eq><apply id="S3.p2.13.m13.2.3.2.cmml" xref="S3.p2.13.m13.2.3.2"><times id="S3.p2.13.m13.2.3.2.1.cmml" xref="S3.p2.13.m13.2.3.2.1"></times><ci id="S3.p2.13.m13.2.3.2.2.cmml" xref="S3.p2.13.m13.2.3.2.2">ğ‘Ÿ</ci><interval closure="open" id="S3.p2.13.m13.2.3.2.3.1.cmml" xref="S3.p2.13.m13.2.3.2.3.2"><apply id="S3.p2.13.m13.1.1.cmml" xref="S3.p2.13.m13.1.1"><ci id="S3.p2.13.m13.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1">^</ci><ci id="S3.p2.13.m13.1.1.2.cmml" xref="S3.p2.13.m13.1.1.2">ğ²</ci></apply><ci id="S3.p2.13.m13.2.2.cmml" xref="S3.p2.13.m13.2.2">ğ²</ci></interval></apply><cn type="integer" id="S3.p2.13.m13.2.3.3.cmml" xref="S3.p2.13.m13.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m13.2c">r(\hat{\mathbf{y}},\mathbf{y})=1</annotation></semantics></math>, and <em id="S3.p2.16.4" class="ltx_emph ltx_font_italic">negative</em> if it produces an incorrect final answer, <em id="S3.p2.16.5" class="ltx_emph ltx_font_italic">i.e.</em>,Â <math id="S3.p2.14.m14.2" class="ltx_Math" alttext="r(\hat{\mathbf{y}},\mathbf{y})=0" display="inline"><semantics id="S3.p2.14.m14.2a"><mrow id="S3.p2.14.m14.2.3" xref="S3.p2.14.m14.2.3.cmml"><mrow id="S3.p2.14.m14.2.3.2" xref="S3.p2.14.m14.2.3.2.cmml"><mi id="S3.p2.14.m14.2.3.2.2" xref="S3.p2.14.m14.2.3.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p2.14.m14.2.3.2.1" xref="S3.p2.14.m14.2.3.2.1.cmml">â€‹</mo><mrow id="S3.p2.14.m14.2.3.2.3.2" xref="S3.p2.14.m14.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.p2.14.m14.2.3.2.3.2.1" xref="S3.p2.14.m14.2.3.2.3.1.cmml">(</mo><mover accent="true" id="S3.p2.14.m14.1.1" xref="S3.p2.14.m14.1.1.cmml"><mi id="S3.p2.14.m14.1.1.2" xref="S3.p2.14.m14.1.1.2.cmml">ğ²</mi><mo id="S3.p2.14.m14.1.1.1" xref="S3.p2.14.m14.1.1.1.cmml">^</mo></mover><mo id="S3.p2.14.m14.2.3.2.3.2.2" xref="S3.p2.14.m14.2.3.2.3.1.cmml">,</mo><mi id="S3.p2.14.m14.2.2" xref="S3.p2.14.m14.2.2.cmml">ğ²</mi><mo stretchy="false" id="S3.p2.14.m14.2.3.2.3.2.3" xref="S3.p2.14.m14.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.14.m14.2.3.1" xref="S3.p2.14.m14.2.3.1.cmml">=</mo><mn id="S3.p2.14.m14.2.3.3" xref="S3.p2.14.m14.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.14.m14.2b"><apply id="S3.p2.14.m14.2.3.cmml" xref="S3.p2.14.m14.2.3"><eq id="S3.p2.14.m14.2.3.1.cmml" xref="S3.p2.14.m14.2.3.1"></eq><apply id="S3.p2.14.m14.2.3.2.cmml" xref="S3.p2.14.m14.2.3.2"><times id="S3.p2.14.m14.2.3.2.1.cmml" xref="S3.p2.14.m14.2.3.2.1"></times><ci id="S3.p2.14.m14.2.3.2.2.cmml" xref="S3.p2.14.m14.2.3.2.2">ğ‘Ÿ</ci><interval closure="open" id="S3.p2.14.m14.2.3.2.3.1.cmml" xref="S3.p2.14.m14.2.3.2.3.2"><apply id="S3.p2.14.m14.1.1.cmml" xref="S3.p2.14.m14.1.1"><ci id="S3.p2.14.m14.1.1.1.cmml" xref="S3.p2.14.m14.1.1.1">^</ci><ci id="S3.p2.14.m14.1.1.2.cmml" xref="S3.p2.14.m14.1.1.2">ğ²</ci></apply><ci id="S3.p2.14.m14.2.2.cmml" xref="S3.p2.14.m14.2.2">ğ²</ci></interval></apply><cn type="integer" id="S3.p2.14.m14.2.3.3.cmml" xref="S3.p2.14.m14.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m14.2c">r(\hat{\mathbf{y}},\mathbf{y})=0</annotation></semantics></math>.
By definition, <math id="S3.p2.15.m15.2" class="ltx_Math" alttext="r(\mathbf{y},\mathbf{y})=1" display="inline"><semantics id="S3.p2.15.m15.2a"><mrow id="S3.p2.15.m15.2.3" xref="S3.p2.15.m15.2.3.cmml"><mrow id="S3.p2.15.m15.2.3.2" xref="S3.p2.15.m15.2.3.2.cmml"><mi id="S3.p2.15.m15.2.3.2.2" xref="S3.p2.15.m15.2.3.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p2.15.m15.2.3.2.1" xref="S3.p2.15.m15.2.3.2.1.cmml">â€‹</mo><mrow id="S3.p2.15.m15.2.3.2.3.2" xref="S3.p2.15.m15.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.p2.15.m15.2.3.2.3.2.1" xref="S3.p2.15.m15.2.3.2.3.1.cmml">(</mo><mi id="S3.p2.15.m15.1.1" xref="S3.p2.15.m15.1.1.cmml">ğ²</mi><mo id="S3.p2.15.m15.2.3.2.3.2.2" xref="S3.p2.15.m15.2.3.2.3.1.cmml">,</mo><mi id="S3.p2.15.m15.2.2" xref="S3.p2.15.m15.2.2.cmml">ğ²</mi><mo stretchy="false" id="S3.p2.15.m15.2.3.2.3.2.3" xref="S3.p2.15.m15.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.15.m15.2.3.1" xref="S3.p2.15.m15.2.3.1.cmml">=</mo><mn id="S3.p2.15.m15.2.3.3" xref="S3.p2.15.m15.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.15.m15.2b"><apply id="S3.p2.15.m15.2.3.cmml" xref="S3.p2.15.m15.2.3"><eq id="S3.p2.15.m15.2.3.1.cmml" xref="S3.p2.15.m15.2.3.1"></eq><apply id="S3.p2.15.m15.2.3.2.cmml" xref="S3.p2.15.m15.2.3.2"><times id="S3.p2.15.m15.2.3.2.1.cmml" xref="S3.p2.15.m15.2.3.2.1"></times><ci id="S3.p2.15.m15.2.3.2.2.cmml" xref="S3.p2.15.m15.2.3.2.2">ğ‘Ÿ</ci><interval closure="open" id="S3.p2.15.m15.2.3.2.3.1.cmml" xref="S3.p2.15.m15.2.3.2.3.2"><ci id="S3.p2.15.m15.1.1.cmml" xref="S3.p2.15.m15.1.1">ğ²</ci><ci id="S3.p2.15.m15.2.2.cmml" xref="S3.p2.15.m15.2.2">ğ²</ci></interval></apply><cn type="integer" id="S3.p2.15.m15.2.3.3.cmml" xref="S3.p2.15.m15.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m15.2c">r(\mathbf{y},\mathbf{y})=1</annotation></semantics></math>, and the original trace <math id="S3.p2.16.m16.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S3.p2.16.m16.1a"><mi id="S3.p2.16.m16.1.1" xref="S3.p2.16.m16.1.1.cmml">ğ²</mi><annotation-xml encoding="MathML-Content" id="S3.p2.16.m16.1b"><ci id="S3.p2.16.m16.1.1.cmml" xref="S3.p2.16.m16.1.1">ğ²</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m16.1c">\mathbf{y}</annotation></semantics></math> is always positive.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.14" class="ltx_p"><span id="S3.p3.14.1" class="ltx_text ltx_font_bold">Positive and negative datasets.</span> The above process induces a joint distribution <math id="S3.p3.1.m1.2" class="ltx_Math" alttext="p_{\text{syn}}(\mathbf{x},\mathbf{y})" display="inline"><semantics id="S3.p3.1.m1.2a"><mrow id="S3.p3.1.m1.2.3" xref="S3.p3.1.m1.2.3.cmml"><msub id="S3.p3.1.m1.2.3.2" xref="S3.p3.1.m1.2.3.2.cmml"><mi id="S3.p3.1.m1.2.3.2.2" xref="S3.p3.1.m1.2.3.2.2.cmml">p</mi><mtext id="S3.p3.1.m1.2.3.2.3" xref="S3.p3.1.m1.2.3.2.3a.cmml">syn</mtext></msub><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.2.3.1" xref="S3.p3.1.m1.2.3.1.cmml">â€‹</mo><mrow id="S3.p3.1.m1.2.3.3.2" xref="S3.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.p3.1.m1.2.3.3.2.1" xref="S3.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">ğ±</mi><mo id="S3.p3.1.m1.2.3.3.2.2" xref="S3.p3.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.p3.1.m1.2.2" xref="S3.p3.1.m1.2.2.cmml">ğ²</mi><mo stretchy="false" id="S3.p3.1.m1.2.3.3.2.3" xref="S3.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.2b"><apply id="S3.p3.1.m1.2.3.cmml" xref="S3.p3.1.m1.2.3"><times id="S3.p3.1.m1.2.3.1.cmml" xref="S3.p3.1.m1.2.3.1"></times><apply id="S3.p3.1.m1.2.3.2.cmml" xref="S3.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.2.3.2.1.cmml" xref="S3.p3.1.m1.2.3.2">subscript</csymbol><ci id="S3.p3.1.m1.2.3.2.2.cmml" xref="S3.p3.1.m1.2.3.2.2">ğ‘</ci><ci id="S3.p3.1.m1.2.3.2.3a.cmml" xref="S3.p3.1.m1.2.3.2.3"><mtext mathsize="70%" id="S3.p3.1.m1.2.3.2.3.cmml" xref="S3.p3.1.m1.2.3.2.3">syn</mtext></ci></apply><interval closure="open" id="S3.p3.1.m1.2.3.3.1.cmml" xref="S3.p3.1.m1.2.3.3.2"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">ğ±</ci><ci id="S3.p3.1.m1.2.2.cmml" xref="S3.p3.1.m1.2.2">ğ²</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.2c">p_{\text{syn}}(\mathbf{x},\mathbf{y})</annotation></semantics></math>, <span id="S3.p3.14.2" class="ltx_text ltx_font_italic">iid</span> samples from which yields positive synthetic dataset <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.
We note that the sampling process for <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">ğ’Ÿ</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> is designed to ensure that the induced marginal distribution over synthetic problems <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="p_{\text{syn}}(\mathbf{x})" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.2" xref="S3.p3.4.m4.1.2.cmml"><msub id="S3.p3.4.m4.1.2.2" xref="S3.p3.4.m4.1.2.2.cmml"><mi id="S3.p3.4.m4.1.2.2.2" xref="S3.p3.4.m4.1.2.2.2.cmml">p</mi><mtext id="S3.p3.4.m4.1.2.2.3" xref="S3.p3.4.m4.1.2.2.3a.cmml">syn</mtext></msub><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.2.1" xref="S3.p3.4.m4.1.2.1.cmml">â€‹</mo><mrow id="S3.p3.4.m4.1.2.3.2" xref="S3.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S3.p3.4.m4.1.2.3.2.1" xref="S3.p3.4.m4.1.2.cmml">(</mo><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">ğ±</mi><mo stretchy="false" id="S3.p3.4.m4.1.2.3.2.2" xref="S3.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.2.cmml" xref="S3.p3.4.m4.1.2"><times id="S3.p3.4.m4.1.2.1.cmml" xref="S3.p3.4.m4.1.2.1"></times><apply id="S3.p3.4.m4.1.2.2.cmml" xref="S3.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.2.2.1.cmml" xref="S3.p3.4.m4.1.2.2">subscript</csymbol><ci id="S3.p3.4.m4.1.2.2.2.cmml" xref="S3.p3.4.m4.1.2.2.2">ğ‘</ci><ci id="S3.p3.4.m4.1.2.2.3a.cmml" xref="S3.p3.4.m4.1.2.2.3"><mtext mathsize="70%" id="S3.p3.4.m4.1.2.2.3.cmml" xref="S3.p3.4.m4.1.2.2.3">syn</mtext></ci></apply><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">ğ±</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">p_{\text{syn}}(\mathbf{x})</annotation></semantics></math> is close to <math id="S3.p3.5.m5.1" class="ltx_Math" alttext="p_{\text{real}}(\mathbf{x})" display="inline"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.2" xref="S3.p3.5.m5.1.2.cmml"><msub id="S3.p3.5.m5.1.2.2" xref="S3.p3.5.m5.1.2.2.cmml"><mi id="S3.p3.5.m5.1.2.2.2" xref="S3.p3.5.m5.1.2.2.2.cmml">p</mi><mtext id="S3.p3.5.m5.1.2.2.3" xref="S3.p3.5.m5.1.2.2.3a.cmml">real</mtext></msub><mo lspace="0em" rspace="0em" id="S3.p3.5.m5.1.2.1" xref="S3.p3.5.m5.1.2.1.cmml">â€‹</mo><mrow id="S3.p3.5.m5.1.2.3.2" xref="S3.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S3.p3.5.m5.1.2.3.2.1" xref="S3.p3.5.m5.1.2.cmml">(</mo><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">ğ±</mi><mo stretchy="false" id="S3.p3.5.m5.1.2.3.2.2" xref="S3.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.2.cmml" xref="S3.p3.5.m5.1.2"><times id="S3.p3.5.m5.1.2.1.cmml" xref="S3.p3.5.m5.1.2.1"></times><apply id="S3.p3.5.m5.1.2.2.cmml" xref="S3.p3.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.2.2.1.cmml" xref="S3.p3.5.m5.1.2.2">subscript</csymbol><ci id="S3.p3.5.m5.1.2.2.2.cmml" xref="S3.p3.5.m5.1.2.2.2">ğ‘</ci><ci id="S3.p3.5.m5.1.2.2.3a.cmml" xref="S3.p3.5.m5.1.2.2.3"><mtext mathsize="70%" id="S3.p3.5.m5.1.2.2.3.cmml" xref="S3.p3.5.m5.1.2.2.3">real</mtext></ci></apply><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">ğ±</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">p_{\text{real}}(\mathbf{x})</annotation></semantics></math>.
We will use <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{\pi}^{+}" display="inline"><semantics id="S3.p3.6.m6.1a"><msubsup id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m6.1.1.2.2" xref="S3.p3.6.m6.1.1.2.2.cmml">ğ’Ÿ</mi><mi id="S3.p3.6.m6.1.1.2.3" xref="S3.p3.6.m6.1.1.2.3.cmml">Ï€</mi><mo id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">superscript</csymbol><apply id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.1.cmml" xref="S3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2">ğ’Ÿ</ci><ci id="S3.p3.6.m6.1.1.2.3.cmml" xref="S3.p3.6.m6.1.1.2.3">ğœ‹</ci></apply><plus id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\mathcal{D}_{\pi}^{+}</annotation></semantics></math> to denote the positive dataset of <math id="S3.p3.7.m7.2" class="ltx_Math" alttext="(\mathbf{x},+\hat{\mathbf{y}})" display="inline"><semantics id="S3.p3.7.m7.2a"><mrow id="S3.p3.7.m7.2.2.1" xref="S3.p3.7.m7.2.2.2.cmml"><mo stretchy="false" id="S3.p3.7.m7.2.2.1.2" xref="S3.p3.7.m7.2.2.2.cmml">(</mo><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">ğ±</mi><mo id="S3.p3.7.m7.2.2.1.3" xref="S3.p3.7.m7.2.2.2.cmml">,</mo><mrow id="S3.p3.7.m7.2.2.1.1" xref="S3.p3.7.m7.2.2.1.1.cmml"><mo id="S3.p3.7.m7.2.2.1.1a" xref="S3.p3.7.m7.2.2.1.1.cmml">+</mo><mover accent="true" id="S3.p3.7.m7.2.2.1.1.2" xref="S3.p3.7.m7.2.2.1.1.2.cmml"><mi id="S3.p3.7.m7.2.2.1.1.2.2" xref="S3.p3.7.m7.2.2.1.1.2.2.cmml">ğ²</mi><mo id="S3.p3.7.m7.2.2.1.1.2.1" xref="S3.p3.7.m7.2.2.1.1.2.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S3.p3.7.m7.2.2.1.4" xref="S3.p3.7.m7.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.2b"><interval closure="open" id="S3.p3.7.m7.2.2.2.cmml" xref="S3.p3.7.m7.2.2.1"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">ğ±</ci><apply id="S3.p3.7.m7.2.2.1.1.cmml" xref="S3.p3.7.m7.2.2.1.1"><plus id="S3.p3.7.m7.2.2.1.1.1.cmml" xref="S3.p3.7.m7.2.2.1.1"></plus><apply id="S3.p3.7.m7.2.2.1.1.2.cmml" xref="S3.p3.7.m7.2.2.1.1.2"><ci id="S3.p3.7.m7.2.2.1.1.2.1.cmml" xref="S3.p3.7.m7.2.2.1.1.2.1">^</ci><ci id="S3.p3.7.m7.2.2.1.1.2.2.cmml" xref="S3.p3.7.m7.2.2.1.1.2.2">ğ²</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.2c">(\mathbf{x},+\hat{\mathbf{y}})</annotation></semantics></math> where <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S3.p3.8.m8.1a"><mrow id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><mo id="S3.p3.8.m8.1.1a" xref="S3.p3.8.m8.1.1.cmml">+</mo><mover accent="true" id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml"><mi id="S3.p3.8.m8.1.1.2.2" xref="S3.p3.8.m8.1.1.2.2.cmml">ğ²</mi><mo id="S3.p3.8.m8.1.1.2.1" xref="S3.p3.8.m8.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><plus id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1"></plus><apply id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2"><ci id="S3.p3.8.m8.1.1.2.1.cmml" xref="S3.p3.8.m8.1.1.2.1">^</ci><ci id="S3.p3.8.m8.1.1.2.2.cmml" xref="S3.p3.8.m8.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">+\hat{\mathbf{y}}</annotation></semantics></math> is a positive solution trace generated from some policy <math id="S3.p3.9.m9.1" class="ltx_math_unparsed" alttext="\pi(\cdot\mid\mathbf{x})" display="inline"><semantics id="S3.p3.9.m9.1a"><mrow id="S3.p3.9.m9.1b"><mi id="S3.p3.9.m9.1.1">Ï€</mi><mrow id="S3.p3.9.m9.1.2"><mo stretchy="false" id="S3.p3.9.m9.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S3.p3.9.m9.1.2.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S3.p3.9.m9.1.2.3">âˆ£</mo><mi id="S3.p3.9.m9.1.2.4">ğ±</mi><mo stretchy="false" id="S3.p3.9.m9.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\pi(\cdot\mid\mathbf{x})</annotation></semantics></math>.
For a positive <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S3.p3.10.m10.1a"><mrow id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mo id="S3.p3.10.m10.1.1a" xref="S3.p3.10.m10.1.1.cmml">+</mo><mover accent="true" id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml"><mi id="S3.p3.10.m10.1.1.2.2" xref="S3.p3.10.m10.1.1.2.2.cmml">ğ²</mi><mo id="S3.p3.10.m10.1.1.2.1" xref="S3.p3.10.m10.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><plus id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1"></plus><apply id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2"><ci id="S3.p3.10.m10.1.1.2.1.cmml" xref="S3.p3.10.m10.1.1.2.1">^</ci><ci id="S3.p3.10.m10.1.1.2.2.cmml" xref="S3.p3.10.m10.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">+\hat{\mathbf{y}}</annotation></semantics></math> and negative <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S3.p3.11.m11.1a"><mrow id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml"><mo id="S3.p3.11.m11.1.1a" xref="S3.p3.11.m11.1.1.cmml">âˆ’</mo><mover accent="true" id="S3.p3.11.m11.1.1.2" xref="S3.p3.11.m11.1.1.2.cmml"><mi id="S3.p3.11.m11.1.1.2.2" xref="S3.p3.11.m11.1.1.2.2.cmml">ğ²</mi><mo id="S3.p3.11.m11.1.1.2.1" xref="S3.p3.11.m11.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1"><minus id="S3.p3.11.m11.1.1.1.cmml" xref="S3.p3.11.m11.1.1"></minus><apply id="S3.p3.11.m11.1.1.2.cmml" xref="S3.p3.11.m11.1.1.2"><ci id="S3.p3.11.m11.1.1.2.1.cmml" xref="S3.p3.11.m11.1.1.2.1">^</ci><ci id="S3.p3.11.m11.1.1.2.2.cmml" xref="S3.p3.11.m11.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">-\hat{\mathbf{y}}</annotation></semantics></math> trace, sampled from the same policy <math id="S3.p3.12.m12.1" class="ltx_math_unparsed" alttext="\pi(\cdot\mid\mathbf{x})" display="inline"><semantics id="S3.p3.12.m12.1a"><mrow id="S3.p3.12.m12.1b"><mi id="S3.p3.12.m12.1.1">Ï€</mi><mrow id="S3.p3.12.m12.1.2"><mo stretchy="false" id="S3.p3.12.m12.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S3.p3.12.m12.1.2.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S3.p3.12.m12.1.2.3">âˆ£</mo><mi id="S3.p3.12.m12.1.2.4">ğ±</mi><mo stretchy="false" id="S3.p3.12.m12.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.p3.12.m12.1c">\pi(\cdot\mid\mathbf{x})</annotation></semantics></math>, we denote a dataset over problems and solution pairs: <math id="S3.p3.13.m13.3" class="ltx_Math" alttext="(\mathbf{x},+\hat{\mathbf{y}},-\hat{\mathbf{y}})" display="inline"><semantics id="S3.p3.13.m13.3a"><mrow id="S3.p3.13.m13.3.3.2" xref="S3.p3.13.m13.3.3.3.cmml"><mo stretchy="false" id="S3.p3.13.m13.3.3.2.3" xref="S3.p3.13.m13.3.3.3.cmml">(</mo><mi id="S3.p3.13.m13.1.1" xref="S3.p3.13.m13.1.1.cmml">ğ±</mi><mo id="S3.p3.13.m13.3.3.2.4" xref="S3.p3.13.m13.3.3.3.cmml">,</mo><mrow id="S3.p3.13.m13.2.2.1.1" xref="S3.p3.13.m13.2.2.1.1.cmml"><mo id="S3.p3.13.m13.2.2.1.1a" xref="S3.p3.13.m13.2.2.1.1.cmml">+</mo><mover accent="true" id="S3.p3.13.m13.2.2.1.1.2" xref="S3.p3.13.m13.2.2.1.1.2.cmml"><mi id="S3.p3.13.m13.2.2.1.1.2.2" xref="S3.p3.13.m13.2.2.1.1.2.2.cmml">ğ²</mi><mo id="S3.p3.13.m13.2.2.1.1.2.1" xref="S3.p3.13.m13.2.2.1.1.2.1.cmml">^</mo></mover></mrow><mo id="S3.p3.13.m13.3.3.2.5" xref="S3.p3.13.m13.3.3.3.cmml">,</mo><mrow id="S3.p3.13.m13.3.3.2.2" xref="S3.p3.13.m13.3.3.2.2.cmml"><mo id="S3.p3.13.m13.3.3.2.2a" xref="S3.p3.13.m13.3.3.2.2.cmml">âˆ’</mo><mover accent="true" id="S3.p3.13.m13.3.3.2.2.2" xref="S3.p3.13.m13.3.3.2.2.2.cmml"><mi id="S3.p3.13.m13.3.3.2.2.2.2" xref="S3.p3.13.m13.3.3.2.2.2.2.cmml">ğ²</mi><mo id="S3.p3.13.m13.3.3.2.2.2.1" xref="S3.p3.13.m13.3.3.2.2.2.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S3.p3.13.m13.3.3.2.6" xref="S3.p3.13.m13.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.13.m13.3b"><vector id="S3.p3.13.m13.3.3.3.cmml" xref="S3.p3.13.m13.3.3.2"><ci id="S3.p3.13.m13.1.1.cmml" xref="S3.p3.13.m13.1.1">ğ±</ci><apply id="S3.p3.13.m13.2.2.1.1.cmml" xref="S3.p3.13.m13.2.2.1.1"><plus id="S3.p3.13.m13.2.2.1.1.1.cmml" xref="S3.p3.13.m13.2.2.1.1"></plus><apply id="S3.p3.13.m13.2.2.1.1.2.cmml" xref="S3.p3.13.m13.2.2.1.1.2"><ci id="S3.p3.13.m13.2.2.1.1.2.1.cmml" xref="S3.p3.13.m13.2.2.1.1.2.1">^</ci><ci id="S3.p3.13.m13.2.2.1.1.2.2.cmml" xref="S3.p3.13.m13.2.2.1.1.2.2">ğ²</ci></apply></apply><apply id="S3.p3.13.m13.3.3.2.2.cmml" xref="S3.p3.13.m13.3.3.2.2"><minus id="S3.p3.13.m13.3.3.2.2.1.cmml" xref="S3.p3.13.m13.3.3.2.2"></minus><apply id="S3.p3.13.m13.3.3.2.2.2.cmml" xref="S3.p3.13.m13.3.3.2.2.2"><ci id="S3.p3.13.m13.3.3.2.2.2.1.cmml" xref="S3.p3.13.m13.3.3.2.2.2.1">^</ci><ci id="S3.p3.13.m13.3.3.2.2.2.2.cmml" xref="S3.p3.13.m13.3.3.2.2.2.2">ğ²</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m13.3c">(\mathbf{x},+\hat{\mathbf{y}},-\hat{\mathbf{y}})</annotation></semantics></math> as <math id="S3.p3.14.m14.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi}" display="inline"><semantics id="S3.p3.14.m14.1a"><msubsup id="S3.p3.14.m14.1.1" xref="S3.p3.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.14.m14.1.1.2.2" xref="S3.p3.14.m14.1.1.2.2.cmml">ğ’Ÿ</mi><mi id="S3.p3.14.m14.1.1.3" xref="S3.p3.14.m14.1.1.3.cmml">Ï€</mi><mo id="S3.p3.14.m14.1.1.2.3" xref="S3.p3.14.m14.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.14.m14.1b"><apply id="S3.p3.14.m14.1.1.cmml" xref="S3.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p3.14.m14.1.1.1.cmml" xref="S3.p3.14.m14.1.1">subscript</csymbol><apply id="S3.p3.14.m14.1.1.2.cmml" xref="S3.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p3.14.m14.1.1.2.1.cmml" xref="S3.p3.14.m14.1.1">superscript</csymbol><ci id="S3.p3.14.m14.1.1.2.2.cmml" xref="S3.p3.14.m14.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="S3.p3.14.m14.1.1.2.3.cmml" xref="S3.p3.14.m14.1.1.2.3">plus-or-minus</csymbol></apply><ci id="S3.p3.14.m14.1.1.3.cmml" xref="S3.p3.14.m14.1.1.3">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m14.1c">\mathcal{D}^{\pm}_{\pi}</annotation></semantics></math>.</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.8" class="ltx_p"><span id="S3.p4.8.1" class="ltx_text ltx_font_bold">Reasoning steps.</span> The trace <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{y}_{i}" display="inline"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">ğ²</mi><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">ğ²</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathbf{y}_{i}</annotation></semantics></math> consists of several intermediate steps, <math id="S3.p4.2.m2.7" class="ltx_Math" alttext="\mathbf{y}_{i}=\left[\mathbf{y}_{i,1},\ldots,\mathbf{y}_{i,L}\right]" display="inline"><semantics id="S3.p4.2.m2.7a"><mrow id="S3.p4.2.m2.7.7" xref="S3.p4.2.m2.7.7.cmml"><msub id="S3.p4.2.m2.7.7.4" xref="S3.p4.2.m2.7.7.4.cmml"><mi id="S3.p4.2.m2.7.7.4.2" xref="S3.p4.2.m2.7.7.4.2.cmml">ğ²</mi><mi id="S3.p4.2.m2.7.7.4.3" xref="S3.p4.2.m2.7.7.4.3.cmml">i</mi></msub><mo id="S3.p4.2.m2.7.7.3" xref="S3.p4.2.m2.7.7.3.cmml">=</mo><mrow id="S3.p4.2.m2.7.7.2.2" xref="S3.p4.2.m2.7.7.2.3.cmml"><mo id="S3.p4.2.m2.7.7.2.2.3" xref="S3.p4.2.m2.7.7.2.3.cmml">[</mo><msub id="S3.p4.2.m2.6.6.1.1.1" xref="S3.p4.2.m2.6.6.1.1.1.cmml"><mi id="S3.p4.2.m2.6.6.1.1.1.2" xref="S3.p4.2.m2.6.6.1.1.1.2.cmml">ğ²</mi><mrow id="S3.p4.2.m2.2.2.2.4" xref="S3.p4.2.m2.2.2.2.3.cmml"><mi id="S3.p4.2.m2.1.1.1.1" xref="S3.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.p4.2.m2.2.2.2.4.1" xref="S3.p4.2.m2.2.2.2.3.cmml">,</mo><mn id="S3.p4.2.m2.2.2.2.2" xref="S3.p4.2.m2.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.p4.2.m2.7.7.2.2.4" xref="S3.p4.2.m2.7.7.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p4.2.m2.5.5" xref="S3.p4.2.m2.5.5.cmml">â€¦</mi><mo id="S3.p4.2.m2.7.7.2.2.5" xref="S3.p4.2.m2.7.7.2.3.cmml">,</mo><msub id="S3.p4.2.m2.7.7.2.2.2" xref="S3.p4.2.m2.7.7.2.2.2.cmml"><mi id="S3.p4.2.m2.7.7.2.2.2.2" xref="S3.p4.2.m2.7.7.2.2.2.2.cmml">ğ²</mi><mrow id="S3.p4.2.m2.4.4.2.4" xref="S3.p4.2.m2.4.4.2.3.cmml"><mi id="S3.p4.2.m2.3.3.1.1" xref="S3.p4.2.m2.3.3.1.1.cmml">i</mi><mo id="S3.p4.2.m2.4.4.2.4.1" xref="S3.p4.2.m2.4.4.2.3.cmml">,</mo><mi id="S3.p4.2.m2.4.4.2.2" xref="S3.p4.2.m2.4.4.2.2.cmml">L</mi></mrow></msub><mo id="S3.p4.2.m2.7.7.2.2.6" xref="S3.p4.2.m2.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.7b"><apply id="S3.p4.2.m2.7.7.cmml" xref="S3.p4.2.m2.7.7"><eq id="S3.p4.2.m2.7.7.3.cmml" xref="S3.p4.2.m2.7.7.3"></eq><apply id="S3.p4.2.m2.7.7.4.cmml" xref="S3.p4.2.m2.7.7.4"><csymbol cd="ambiguous" id="S3.p4.2.m2.7.7.4.1.cmml" xref="S3.p4.2.m2.7.7.4">subscript</csymbol><ci id="S3.p4.2.m2.7.7.4.2.cmml" xref="S3.p4.2.m2.7.7.4.2">ğ²</ci><ci id="S3.p4.2.m2.7.7.4.3.cmml" xref="S3.p4.2.m2.7.7.4.3">ğ‘–</ci></apply><list id="S3.p4.2.m2.7.7.2.3.cmml" xref="S3.p4.2.m2.7.7.2.2"><apply id="S3.p4.2.m2.6.6.1.1.1.cmml" xref="S3.p4.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.6.6.1.1.1.1.cmml" xref="S3.p4.2.m2.6.6.1.1.1">subscript</csymbol><ci id="S3.p4.2.m2.6.6.1.1.1.2.cmml" xref="S3.p4.2.m2.6.6.1.1.1.2">ğ²</ci><list id="S3.p4.2.m2.2.2.2.3.cmml" xref="S3.p4.2.m2.2.2.2.4"><ci id="S3.p4.2.m2.1.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1.1">ğ‘–</ci><cn type="integer" id="S3.p4.2.m2.2.2.2.2.cmml" xref="S3.p4.2.m2.2.2.2.2">1</cn></list></apply><ci id="S3.p4.2.m2.5.5.cmml" xref="S3.p4.2.m2.5.5">â€¦</ci><apply id="S3.p4.2.m2.7.7.2.2.2.cmml" xref="S3.p4.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.p4.2.m2.7.7.2.2.2.1.cmml" xref="S3.p4.2.m2.7.7.2.2.2">subscript</csymbol><ci id="S3.p4.2.m2.7.7.2.2.2.2.cmml" xref="S3.p4.2.m2.7.7.2.2.2.2">ğ²</ci><list id="S3.p4.2.m2.4.4.2.3.cmml" xref="S3.p4.2.m2.4.4.2.4"><ci id="S3.p4.2.m2.3.3.1.1.cmml" xref="S3.p4.2.m2.3.3.1.1">ğ‘–</ci><ci id="S3.p4.2.m2.4.4.2.2.cmml" xref="S3.p4.2.m2.4.4.2.2">ğ¿</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.7c">\mathbf{y}_{i}=\left[\mathbf{y}_{i,1},\ldots,\mathbf{y}_{i,L}\right]</annotation></semantics></math>. We assume each trace has at most <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">L</annotation></semantics></math> steps, and use <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{y}_{1:t}" display="inline"><semantics id="S3.p4.4.m4.1a"><msub id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">ğ²</mi><mrow id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml"><mn id="S3.p4.4.m4.1.1.3.2" xref="S3.p4.4.m4.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p4.4.m4.1.1.3.1" xref="S3.p4.4.m4.1.1.3.1.cmml">:</mo><mi id="S3.p4.4.m4.1.1.3.3" xref="S3.p4.4.m4.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">ğ²</ci><apply id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3"><ci id="S3.p4.4.m4.1.1.3.1.cmml" xref="S3.p4.4.m4.1.1.3.1">:</ci><cn type="integer" id="S3.p4.4.m4.1.1.3.2.cmml" xref="S3.p4.4.m4.1.1.3.2">1</cn><ci id="S3.p4.4.m4.1.1.3.3.cmml" xref="S3.p4.4.m4.1.1.3.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\mathbf{y}_{1:t}</annotation></semantics></math> to denote the subsequence of first <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p4.5.m5.1a"><mi id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><ci id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">t</annotation></semantics></math> steps. Since mathematical reasoning problems require step-by-step computation, simply arriving at an incorrect final answer does not mean that all steps in a negative <math id="S3.p4.6.m6.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S3.p4.6.m6.1a"><mover accent="true" id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><mi id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml">ğ²</mi><mo id="S3.p4.6.m6.1.1.1" xref="S3.p4.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><ci id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1.1">^</ci><ci id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">\hat{\mathbf{y}}</annotation></semantics></math> are incorrect.
Similarly, a positive <math id="S3.p4.7.m7.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S3.p4.7.m7.1a"><mover accent="true" id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml"><mi id="S3.p4.7.m7.1.1.2" xref="S3.p4.7.m7.1.1.2.cmml">ğ²</mi><mo id="S3.p4.7.m7.1.1.1" xref="S3.p4.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1"><ci id="S3.p4.7.m7.1.1.1.cmml" xref="S3.p4.7.m7.1.1.1">^</ci><ci id="S3.p4.7.m7.1.1.2.cmml" xref="S3.p4.7.m7.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">\hat{\mathbf{y}}</annotation></semantics></math> may also have incorrect reasoning steps.
In fact, even the original answers generated by more capable models in <math id="S3.p4.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S3.p4.8.m8.1a"><msub id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.8.m8.1.1.2" xref="S3.p4.8.m8.1.1.2.cmml">ğ’Ÿ</mi><mi id="S3.p4.8.m8.1.1.3" xref="S3.p4.8.m8.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.1.cmml" xref="S3.p4.8.m8.1.1">subscript</csymbol><ci id="S3.p4.8.m8.1.1.2.cmml" xref="S3.p4.8.m8.1.1.2">ğ’Ÿ</ci><ci id="S3.p4.8.m8.1.1.3.cmml" xref="S3.p4.8.m8.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> may also contain incorrect reasoning steps, and training on such traces may actually lead to unintended consequences (SectionÂ <a href="#S5" title="5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
</section>
<section id="S4" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Learning from Synthetic Data</h3>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In this section, we discuss various algorithms for learning from the synthetic dataset <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> discussed in the previous section, as well as positive and negative solution traces generated using a model.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.12" class="ltx_p"><span id="S4.p2.12.1" class="ltx_text ltx_font_bold">Supervised and rejection finetuning (SFT and RFT).</span> Given positive synthetic <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, perhaps the most straightforward approach (and the most prevalent) is to learn <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">Ï€</mi><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">ğœ‹</ci><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> on this data via supervised next-token prediction: <math id="S4.p2.3.m3.2" class="ltx_math_unparsed" alttext="\pi_{\mathrm{sft}}(\cdot|\mathbf{x}):=\arg\max_{\pi}\mathbb{E}_{\mathbf{x},\mathbf{y}\sim\mathcal{D}_{\mathrm{syn}}}\left[\log\pi(\mathbf{y}|\mathbf{x})\right]" display="inline"><semantics id="S4.p2.3.m3.2a"><mrow id="S4.p2.3.m3.2b"><msub id="S4.p2.3.m3.2.3"><mi id="S4.p2.3.m3.2.3.2">Ï€</mi><mi id="S4.p2.3.m3.2.3.3">sft</mi></msub><mrow id="S4.p2.3.m3.2.4"><mo stretchy="false" id="S4.p2.3.m3.2.4.1">(</mo><mo lspace="0em" rspace="0em" id="S4.p2.3.m3.2.4.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.p2.3.m3.2.4.3">|</mo><mi id="S4.p2.3.m3.2.4.4">ğ±</mi><mo rspace="0.278em" stretchy="false" id="S4.p2.3.m3.2.4.5">)</mo></mrow><mo rspace="0.278em" id="S4.p2.3.m3.2.5">:=</mo><mi id="S4.p2.3.m3.2.6">arg</mi><msub id="S4.p2.3.m3.2.7"><mi id="S4.p2.3.m3.2.7.2">max</mi><mi id="S4.p2.3.m3.2.7.3">Ï€</mi></msub><msub id="S4.p2.3.m3.2.8"><mi id="S4.p2.3.m3.2.8.2">ğ”¼</mi><mrow id="S4.p2.3.m3.2.2.2"><mrow id="S4.p2.3.m3.2.2.2.4.2"><mi id="S4.p2.3.m3.1.1.1.1">ğ±</mi><mo id="S4.p2.3.m3.2.2.2.4.2.1">,</mo><mi id="S4.p2.3.m3.2.2.2.2">ğ²</mi></mrow><mo id="S4.p2.3.m3.2.2.2.3">âˆ¼</mo><msub id="S4.p2.3.m3.2.2.2.5"><mi class="ltx_font_mathcaligraphic" id="S4.p2.3.m3.2.2.2.5.2">ğ’Ÿ</mi><mi id="S4.p2.3.m3.2.2.2.5.3">syn</mi></msub></mrow></msub><mrow id="S4.p2.3.m3.2.9"><mo id="S4.p2.3.m3.2.9.1">[</mo><mi id="S4.p2.3.m3.2.9.2">log</mi><mi id="S4.p2.3.m3.2.9.3">Ï€</mi><mrow id="S4.p2.3.m3.2.9.4"><mo stretchy="false" id="S4.p2.3.m3.2.9.4.1">(</mo><mi id="S4.p2.3.m3.2.9.4.2">ğ²</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S4.p2.3.m3.2.9.4.3">|</mo><mi id="S4.p2.3.m3.2.9.4.4">ğ±</mi><mo stretchy="false" id="S4.p2.3.m3.2.9.4.5">)</mo></mrow><mo id="S4.p2.3.m3.2.9.5">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p2.3.m3.2c">\pi_{\mathrm{sft}}(\cdot|\mathbf{x}):=\arg\max_{\pi}\mathbb{E}_{\mathbf{x},\mathbf{y}\sim\mathcal{D}_{\mathrm{syn}}}\left[\log\pi(\mathbf{y}|\mathbf{x})\right]</annotation></semantics></math>. Another option is to train via supervised next-token prediction on problems in <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S4.p2.4.m4.1a"><msub id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mi id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">ğ’Ÿ</ci><ci id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, but when using a positive solution trace <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S4.p2.5.m5.1a"><mover accent="true" id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">ğ²</mi><mo id="S4.p2.5.m5.1.1.1" xref="S4.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><ci id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1">^</ci><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\hat{\mathbf{y}}</annotation></semantics></math> sampled from <math id="S4.p2.6.m6.1" class="ltx_math_unparsed" alttext="\pi_{\text{sft}}(\cdot|\mathbf{x})" display="inline"><semantics id="S4.p2.6.m6.1a"><mrow id="S4.p2.6.m6.1b"><msub id="S4.p2.6.m6.1.1"><mi id="S4.p2.6.m6.1.1.2">Ï€</mi><mtext id="S4.p2.6.m6.1.1.3">sft</mtext></msub><mrow id="S4.p2.6.m6.1.2"><mo stretchy="false" id="S4.p2.6.m6.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S4.p2.6.m6.1.2.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.p2.6.m6.1.2.3">|</mo><mi id="S4.p2.6.m6.1.2.4">ğ±</mi><mo stretchy="false" id="S4.p2.6.m6.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">\pi_{\text{sft}}(\cdot|\mathbf{x})</annotation></semantics></math>, instead of positive synthetic responses from the capable models in <math id="S4.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S4.p2.7.m7.1a"><msub id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">ğ’Ÿ</mi><mi id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">ğ’Ÿ</ci><ci id="S4.p2.7.m7.1.1.3.cmml" xref="S4.p2.7.m7.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.
Akin to rejection finetuning (RFTÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>) or STaRÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>,
sampling from <math id="S4.p2.8.m8.1" class="ltx_math_unparsed" alttext="\pi_{\text{sft}}(\cdot\mid\mathbf{x})" display="inline"><semantics id="S4.p2.8.m8.1a"><mrow id="S4.p2.8.m8.1b"><msub id="S4.p2.8.m8.1.1"><mi id="S4.p2.8.m8.1.1.2">Ï€</mi><mtext id="S4.p2.8.m8.1.1.3">sft</mtext></msub><mrow id="S4.p2.8.m8.1.2"><mo stretchy="false" id="S4.p2.8.m8.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S4.p2.8.m8.1.2.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S4.p2.8.m8.1.2.3">âˆ£</mo><mi id="S4.p2.8.m8.1.2.4">ğ±</mi><mo stretchy="false" id="S4.p2.8.m8.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\pi_{\text{sft}}(\cdot\mid\mathbf{x})</annotation></semantics></math> once is not guaranteed to give a positive response, and we instead sample <math id="S4.p2.9.m9.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.p2.9.m9.1a"><mi id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.1b"><ci id="S4.p2.9.m9.1.1.cmml" xref="S4.p2.9.m9.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.1c">M</annotation></semantics></math> times for each <math id="S4.p2.10.m10.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S4.p2.10.m10.1a"><mi id="S4.p2.10.m10.1.1" xref="S4.p2.10.m10.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.1b"><ci id="S4.p2.10.m10.1.1.cmml" xref="S4.p2.10.m10.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.1c">\mathbf{x}</annotation></semantics></math> and construct the dataset <math id="S4.p2.11.m11.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S4.p2.11.m11.1a"><msubsup id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.11.m11.1.1.2.2" xref="S4.p2.11.m11.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S4.p2.11.m11.1.1.3" xref="S4.p2.11.m11.1.1.3.cmml"><mi id="S4.p2.11.m11.1.1.3.2" xref="S4.p2.11.m11.1.1.3.2.cmml">Ï€</mi><mi id="S4.p2.11.m11.1.1.3.3" xref="S4.p2.11.m11.1.1.3.3.cmml">sft</mi></msub><mo id="S4.p2.11.m11.1.1.2.3" xref="S4.p2.11.m11.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><apply id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m11.1.1.1.cmml" xref="S4.p2.11.m11.1.1">subscript</csymbol><apply id="S4.p2.11.m11.1.1.2.cmml" xref="S4.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m11.1.1.2.1.cmml" xref="S4.p2.11.m11.1.1">superscript</csymbol><ci id="S4.p2.11.m11.1.1.2.2.cmml" xref="S4.p2.11.m11.1.1.2.2">ğ’Ÿ</ci><plus id="S4.p2.11.m11.1.1.2.3.cmml" xref="S4.p2.11.m11.1.1.2.3"></plus></apply><apply id="S4.p2.11.m11.1.1.3.cmml" xref="S4.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m11.1.1.3.1.cmml" xref="S4.p2.11.m11.1.1.3">subscript</csymbol><ci id="S4.p2.11.m11.1.1.3.2.cmml" xref="S4.p2.11.m11.1.1.3.2">ğœ‹</ci><ci id="S4.p2.11.m11.1.1.3.3.cmml" xref="S4.p2.11.m11.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> of SFT policy generated positive responses.
Then, we apply the next-token prediction loss on <math id="S4.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S4.p2.12.m12.1a"><msubsup id="S4.p2.12.m12.1.1" xref="S4.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.12.m12.1.1.2.2" xref="S4.p2.12.m12.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S4.p2.12.m12.1.1.3" xref="S4.p2.12.m12.1.1.3.cmml"><mi id="S4.p2.12.m12.1.1.3.2" xref="S4.p2.12.m12.1.1.3.2.cmml">Ï€</mi><mi id="S4.p2.12.m12.1.1.3.3" xref="S4.p2.12.m12.1.1.3.3.cmml">sft</mi></msub><mo id="S4.p2.12.m12.1.1.2.3" xref="S4.p2.12.m12.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.12.m12.1b"><apply id="S4.p2.12.m12.1.1.cmml" xref="S4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.1.cmml" xref="S4.p2.12.m12.1.1">subscript</csymbol><apply id="S4.p2.12.m12.1.1.2.cmml" xref="S4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.2.1.cmml" xref="S4.p2.12.m12.1.1">superscript</csymbol><ci id="S4.p2.12.m12.1.1.2.2.cmml" xref="S4.p2.12.m12.1.1.2.2">ğ’Ÿ</ci><plus id="S4.p2.12.m12.1.1.2.3.cmml" xref="S4.p2.12.m12.1.1.2.3"></plus></apply><apply id="S4.p2.12.m12.1.1.3.cmml" xref="S4.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.3.1.cmml" xref="S4.p2.12.m12.1.1.3">subscript</csymbol><ci id="S4.p2.12.m12.1.1.3.2.cmml" xref="S4.p2.12.m12.1.1.3.2">ğœ‹</ci><ci id="S4.p2.12.m12.1.1.3.3.cmml" xref="S4.p2.12.m12.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m12.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Preference optimization.</span> Beyond positive data, we can also learn from negative synthetic data generated from the SFT policy, especially when contrasted with positive responses.
However, learning from negative data presents multiple open design questions pertaining to the construction of negative traces, and the choice of the loss function, and simple supervised fine-tuning will not be a good choice since it will incentivize the model to produce more errors.
Therefore, we utilize a contrastive training approach, direct preference optimization (DPOÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>) for incorporating negative data from <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S4.p3.1.m1.1a"><msub id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">Ï€</mi><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">ğœ‹</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>. In a nutshell, DPO trains a policy using the following preference optimization objective:</p>
<table id="A7.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.9" class="ltx_Math" alttext="\displaystyle\min_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathcal{L}_{\text{DPO}}(\pi):=\mathbb{E}_{(\mathbf{x},+\mathbf{y},-\mathbf{y})\sim\mathcal{D}_{\pi_{\mathrm{sft}}}^{\pm}}\left[\sigma\left(\beta\log\frac{\pi(+\mathbf{y}\mid\mathbf{x})}{\pi_{\mathrm{sft}}(+\mathbf{y}\mid\mathbf{x})}-\beta\log\frac{\pi(-\mathbf{y}\mid\mathbf{x})}{\pi_{\mathrm{sft}}(-\mathbf{y}\mid\mathbf{x})}\right)\right]." display="inline"><semantics id="S4.E1.m1.9a"><mrow id="S4.E1.m1.9.9.1" xref="S4.E1.m1.9.9.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1" xref="S4.E1.m1.9.9.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1.2.2" xref="S4.E1.m1.9.9.1.1.2.3.cmml"><munder id="S4.E1.m1.9.9.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.1.1.1.cmml"><mi id="S4.E1.m1.9.9.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.1.1.2.cmml">min</mi><mi id="S4.E1.m1.9.9.1.1.1.1.1.3" xref="S4.E1.m1.9.9.1.1.1.1.1.3.cmml">Ï€</mi></munder><mspace width="1.167em" id="S4.E1.m1.9.9.1.1.2.2.3" xref="S4.E1.m1.9.9.1.1.2.3.cmml"></mspace><mrow id="S4.E1.m1.9.9.1.1.2.2.2" xref="S4.E1.m1.9.9.1.1.2.2.2.cmml"><msub id="S4.E1.m1.9.9.1.1.2.2.2.2" xref="S4.E1.m1.9.9.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.9.9.1.1.2.2.2.2.2" xref="S4.E1.m1.9.9.1.1.2.2.2.2.2.cmml">â„’</mi><mtext id="S4.E1.m1.9.9.1.1.2.2.2.2.3" xref="S4.E1.m1.9.9.1.1.2.2.2.2.3a.cmml">DPO</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.9.9.1.1.2.2.2.1" xref="S4.E1.m1.9.9.1.1.2.2.2.1.cmml">â€‹</mo><mrow id="S4.E1.m1.9.9.1.1.2.2.2.3.2" xref="S4.E1.m1.9.9.1.1.2.2.2.cmml"><mo stretchy="false" id="S4.E1.m1.9.9.1.1.2.2.2.3.2.1" xref="S4.E1.m1.9.9.1.1.2.2.2.cmml">(</mo><mi id="S4.E1.m1.8.8" xref="S4.E1.m1.8.8.cmml">Ï€</mi><mo rspace="0.278em" stretchy="false" id="S4.E1.m1.9.9.1.1.2.2.2.3.2.2" xref="S4.E1.m1.9.9.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.278em" id="S4.E1.m1.9.9.1.1.4" xref="S4.E1.m1.9.9.1.1.4.cmml">:=</mo><mrow id="S4.E1.m1.9.9.1.1.3" xref="S4.E1.m1.9.9.1.1.3.cmml"><msub id="S4.E1.m1.9.9.1.1.3.3" xref="S4.E1.m1.9.9.1.1.3.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.3.2" xref="S4.E1.m1.9.9.1.1.3.3.2.cmml">ğ”¼</mi><mrow id="S4.E1.m1.3.3.3" xref="S4.E1.m1.3.3.3.cmml"><mrow id="S4.E1.m1.3.3.3.3.2" xref="S4.E1.m1.3.3.3.3.3.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.3.3.2.3" xref="S4.E1.m1.3.3.3.3.3.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">ğ±</mi><mo id="S4.E1.m1.3.3.3.3.2.4" xref="S4.E1.m1.3.3.3.3.3.cmml">,</mo><mrow id="S4.E1.m1.2.2.2.2.1.1" xref="S4.E1.m1.2.2.2.2.1.1.cmml"><mo id="S4.E1.m1.2.2.2.2.1.1a" xref="S4.E1.m1.2.2.2.2.1.1.cmml">+</mo><mi id="S4.E1.m1.2.2.2.2.1.1.2" xref="S4.E1.m1.2.2.2.2.1.1.2.cmml">ğ²</mi></mrow><mo id="S4.E1.m1.3.3.3.3.2.5" xref="S4.E1.m1.3.3.3.3.3.cmml">,</mo><mrow id="S4.E1.m1.3.3.3.3.2.2" xref="S4.E1.m1.3.3.3.3.2.2.cmml"><mo id="S4.E1.m1.3.3.3.3.2.2a" xref="S4.E1.m1.3.3.3.3.2.2.cmml">âˆ’</mo><mi id="S4.E1.m1.3.3.3.3.2.2.2" xref="S4.E1.m1.3.3.3.3.2.2.2.cmml">ğ²</mi></mrow><mo stretchy="false" id="S4.E1.m1.3.3.3.3.2.6" xref="S4.E1.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S4.E1.m1.3.3.3.4" xref="S4.E1.m1.3.3.3.4.cmml">âˆ¼</mo><msubsup id="S4.E1.m1.3.3.3.5" xref="S4.E1.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.3.3.3.5.2.2" xref="S4.E1.m1.3.3.3.5.2.2.cmml">ğ’Ÿ</mi><msub id="S4.E1.m1.3.3.3.5.2.3" xref="S4.E1.m1.3.3.3.5.2.3.cmml"><mi id="S4.E1.m1.3.3.3.5.2.3.2" xref="S4.E1.m1.3.3.3.5.2.3.2.cmml">Ï€</mi><mi id="S4.E1.m1.3.3.3.5.2.3.3" xref="S4.E1.m1.3.3.3.5.2.3.3.cmml">sft</mi></msub><mo id="S4.E1.m1.3.3.3.5.3" xref="S4.E1.m1.3.3.3.5.3.cmml">Â±</mo></msubsup></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.2" xref="S4.E1.m1.9.9.1.1.3.2.cmml">â€‹</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1" xref="S4.E1.m1.9.9.1.1.3.1.2.cmml"><mo id="S4.E1.m1.9.9.1.1.3.1.1.2" xref="S4.E1.m1.9.9.1.1.3.1.2.1.cmml">[</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.cmml"><mi id="S4.E1.m1.9.9.1.1.3.1.1.1.3" xref="S4.E1.m1.9.9.1.1.3.1.1.1.3.cmml">Ïƒ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.1.1.1.2" xref="S4.E1.m1.9.9.1.1.3.1.1.1.2.cmml">â€‹</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.2" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.2.cmml">Î²</mi><mo lspace="0.167em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.1.cmml">â€‹</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3a" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.cmml">â¡</mo><mstyle displaystyle="true" id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml"><mfrac id="S4.E1.m1.5.5a" xref="S4.E1.m1.5.5.cmml"><mrow id="S4.E1.m1.4.4.1" xref="S4.E1.m1.4.4.1.cmml"><mi id="S4.E1.m1.4.4.1.3" xref="S4.E1.m1.4.4.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.2" xref="S4.E1.m1.4.4.1.2.cmml">â€‹</mo><mrow id="S4.E1.m1.4.4.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.4.4.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml"><mo id="S4.E1.m1.4.4.1.1.1.1a" xref="S4.E1.m1.4.4.1.1.1.1.cmml">+</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.2.2" xref="S4.E1.m1.4.4.1.1.1.1.2.2.cmml">ğ²</mi><mo id="S4.E1.m1.4.4.1.1.1.1.2.1" xref="S4.E1.m1.4.4.1.1.1.1.2.1.cmml">âˆ£</mo><mi id="S4.E1.m1.4.4.1.1.1.1.2.3" xref="S4.E1.m1.4.4.1.1.1.1.2.3.cmml">ğ±</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E1.m1.5.5.2" xref="S4.E1.m1.5.5.2.cmml"><msub id="S4.E1.m1.5.5.2.3" xref="S4.E1.m1.5.5.2.3.cmml"><mi id="S4.E1.m1.5.5.2.3.2" xref="S4.E1.m1.5.5.2.3.2.cmml">Ï€</mi><mi id="S4.E1.m1.5.5.2.3.3" xref="S4.E1.m1.5.5.2.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.2.2" xref="S4.E1.m1.5.5.2.2.cmml">â€‹</mo><mrow id="S4.E1.m1.5.5.2.1.1" xref="S4.E1.m1.5.5.2.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.5.5.2.1.1.2" xref="S4.E1.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.5.5.2.1.1.1" xref="S4.E1.m1.5.5.2.1.1.1.cmml"><mo id="S4.E1.m1.5.5.2.1.1.1a" xref="S4.E1.m1.5.5.2.1.1.1.cmml">+</mo><mrow id="S4.E1.m1.5.5.2.1.1.1.2" xref="S4.E1.m1.5.5.2.1.1.1.2.cmml"><mi id="S4.E1.m1.5.5.2.1.1.1.2.2" xref="S4.E1.m1.5.5.2.1.1.1.2.2.cmml">ğ²</mi><mo id="S4.E1.m1.5.5.2.1.1.1.2.1" xref="S4.E1.m1.5.5.2.1.1.1.2.1.cmml">âˆ£</mo><mi id="S4.E1.m1.5.5.2.1.1.1.2.3" xref="S4.E1.m1.5.5.2.1.1.1.2.3.cmml">ğ±</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.5.5.2.1.1.3" xref="S4.E1.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.1.cmml">âˆ’</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.2" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.2.cmml">Î²</mi><mo lspace="0.167em" rspace="0em" id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mrow id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.1" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3a" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.cmml">â¡</mo><mstyle displaystyle="true" id="S4.E1.m1.7.7" xref="S4.E1.m1.7.7.cmml"><mfrac id="S4.E1.m1.7.7a" xref="S4.E1.m1.7.7.cmml"><mrow id="S4.E1.m1.6.6.1" xref="S4.E1.m1.6.6.1.cmml"><mi id="S4.E1.m1.6.6.1.3" xref="S4.E1.m1.6.6.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.6.1.2" xref="S4.E1.m1.6.6.1.2.cmml">â€‹</mo><mrow id="S4.E1.m1.6.6.1.1.1" xref="S4.E1.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.6.6.1.1.1.2" xref="S4.E1.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.6.6.1.1.1.1" xref="S4.E1.m1.6.6.1.1.1.1.cmml"><mo id="S4.E1.m1.6.6.1.1.1.1a" xref="S4.E1.m1.6.6.1.1.1.1.cmml">âˆ’</mo><mrow id="S4.E1.m1.6.6.1.1.1.1.2" xref="S4.E1.m1.6.6.1.1.1.1.2.cmml"><mi id="S4.E1.m1.6.6.1.1.1.1.2.2" xref="S4.E1.m1.6.6.1.1.1.1.2.2.cmml">ğ²</mi><mo id="S4.E1.m1.6.6.1.1.1.1.2.1" xref="S4.E1.m1.6.6.1.1.1.1.2.1.cmml">âˆ£</mo><mi id="S4.E1.m1.6.6.1.1.1.1.2.3" xref="S4.E1.m1.6.6.1.1.1.1.2.3.cmml">ğ±</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.6.6.1.1.1.3" xref="S4.E1.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E1.m1.7.7.2" xref="S4.E1.m1.7.7.2.cmml"><msub id="S4.E1.m1.7.7.2.3" xref="S4.E1.m1.7.7.2.3.cmml"><mi id="S4.E1.m1.7.7.2.3.2" xref="S4.E1.m1.7.7.2.3.2.cmml">Ï€</mi><mi id="S4.E1.m1.7.7.2.3.3" xref="S4.E1.m1.7.7.2.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.2.2" xref="S4.E1.m1.7.7.2.2.cmml">â€‹</mo><mrow id="S4.E1.m1.7.7.2.1.1" xref="S4.E1.m1.7.7.2.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.7.7.2.1.1.2" xref="S4.E1.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.7.7.2.1.1.1" xref="S4.E1.m1.7.7.2.1.1.1.cmml"><mo id="S4.E1.m1.7.7.2.1.1.1a" xref="S4.E1.m1.7.7.2.1.1.1.cmml">âˆ’</mo><mrow id="S4.E1.m1.7.7.2.1.1.1.2" xref="S4.E1.m1.7.7.2.1.1.1.2.cmml"><mi id="S4.E1.m1.7.7.2.1.1.1.2.2" xref="S4.E1.m1.7.7.2.1.1.1.2.2.cmml">ğ²</mi><mo id="S4.E1.m1.7.7.2.1.1.1.2.1" xref="S4.E1.m1.7.7.2.1.1.1.2.1.cmml">âˆ£</mo><mi id="S4.E1.m1.7.7.2.1.1.1.2.3" xref="S4.E1.m1.7.7.2.1.1.1.2.3.cmml">ğ±</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.7.7.2.1.1.3" xref="S4.E1.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.3" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.3.1.1.3" xref="S4.E1.m1.9.9.1.1.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E1.m1.9.9.1.2" xref="S4.E1.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.9b"><apply id="S4.E1.m1.9.9.1.1.cmml" xref="S4.E1.m1.9.9.1"><csymbol cd="latexml" id="S4.E1.m1.9.9.1.1.4.cmml" xref="S4.E1.m1.9.9.1.1.4">assign</csymbol><list id="S4.E1.m1.9.9.1.1.2.3.cmml" xref="S4.E1.m1.9.9.1.1.2.2"><apply id="S4.E1.m1.9.9.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1">subscript</csymbol><min id="S4.E1.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.2"></min><ci id="S4.E1.m1.9.9.1.1.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.3">ğœ‹</ci></apply><apply id="S4.E1.m1.9.9.1.1.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2"><times id="S4.E1.m1.9.9.1.1.2.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.1"></times><apply id="S4.E1.m1.9.9.1.1.2.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.2.2">â„’</ci><ci id="S4.E1.m1.9.9.1.1.2.2.2.2.3a.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S4.E1.m1.9.9.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.9.9.1.1.2.2.2.2.3">DPO</mtext></ci></apply><ci id="S4.E1.m1.8.8.cmml" xref="S4.E1.m1.8.8">ğœ‹</ci></apply></list><apply id="S4.E1.m1.9.9.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.3"><times id="S4.E1.m1.9.9.1.1.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2"></times><apply id="S4.E1.m1.9.9.1.1.3.3.cmml" xref="S4.E1.m1.9.9.1.1.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.3">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.3.2">ğ”¼</ci><apply id="S4.E1.m1.3.3.3.cmml" xref="S4.E1.m1.3.3.3"><csymbol cd="latexml" id="S4.E1.m1.3.3.3.4.cmml" xref="S4.E1.m1.3.3.3.4">similar-to</csymbol><vector id="S4.E1.m1.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.3.3.2"><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">ğ±</ci><apply id="S4.E1.m1.2.2.2.2.1.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1"><plus id="S4.E1.m1.2.2.2.2.1.1.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1"></plus><ci id="S4.E1.m1.2.2.2.2.1.1.2.cmml" xref="S4.E1.m1.2.2.2.2.1.1.2">ğ²</ci></apply><apply id="S4.E1.m1.3.3.3.3.2.2.cmml" xref="S4.E1.m1.3.3.3.3.2.2"><minus id="S4.E1.m1.3.3.3.3.2.2.1.cmml" xref="S4.E1.m1.3.3.3.3.2.2"></minus><ci id="S4.E1.m1.3.3.3.3.2.2.2.cmml" xref="S4.E1.m1.3.3.3.3.2.2.2">ğ²</ci></apply></vector><apply id="S4.E1.m1.3.3.3.5.cmml" xref="S4.E1.m1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.5.1.cmml" xref="S4.E1.m1.3.3.3.5">superscript</csymbol><apply id="S4.E1.m1.3.3.3.5.2.cmml" xref="S4.E1.m1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.5.2.1.cmml" xref="S4.E1.m1.3.3.3.5">subscript</csymbol><ci id="S4.E1.m1.3.3.3.5.2.2.cmml" xref="S4.E1.m1.3.3.3.5.2.2">ğ’Ÿ</ci><apply id="S4.E1.m1.3.3.3.5.2.3.cmml" xref="S4.E1.m1.3.3.3.5.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.5.2.3.1.cmml" xref="S4.E1.m1.3.3.3.5.2.3">subscript</csymbol><ci id="S4.E1.m1.3.3.3.5.2.3.2.cmml" xref="S4.E1.m1.3.3.3.5.2.3.2">ğœ‹</ci><ci id="S4.E1.m1.3.3.3.5.2.3.3.cmml" xref="S4.E1.m1.3.3.3.5.2.3.3">sft</ci></apply></apply><csymbol cd="latexml" id="S4.E1.m1.3.3.3.5.3.cmml" xref="S4.E1.m1.3.3.3.5.3">plus-or-minus</csymbol></apply></apply></apply><apply id="S4.E1.m1.9.9.1.1.3.1.2.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1"><csymbol cd="latexml" id="S4.E1.m1.9.9.1.1.3.1.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.2">delimited-[]</csymbol><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1"><times id="S4.E1.m1.9.9.1.1.3.1.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.2"></times><ci id="S4.E1.m1.9.9.1.1.3.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.3">ğœ</ci><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1"><minus id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.1"></minus><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2"><times id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.1"></times><ci id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.2">ğ›½</ci><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3"><log id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.2.3.1"></log><apply id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5"><divide id="S4.E1.m1.5.5.3.cmml" xref="S4.E1.m1.5.5"></divide><apply id="S4.E1.m1.4.4.1.cmml" xref="S4.E1.m1.4.4.1"><times id="S4.E1.m1.4.4.1.2.cmml" xref="S4.E1.m1.4.4.1.2"></times><ci id="S4.E1.m1.4.4.1.3.cmml" xref="S4.E1.m1.4.4.1.3">ğœ‹</ci><apply id="S4.E1.m1.4.4.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1"><plus id="S4.E1.m1.4.4.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1"></plus><apply id="S4.E1.m1.4.4.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2.1">conditional</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2.2">ğ²</ci><ci id="S4.E1.m1.4.4.1.1.1.1.2.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2.3">ğ±</ci></apply></apply></apply><apply id="S4.E1.m1.5.5.2.cmml" xref="S4.E1.m1.5.5.2"><times id="S4.E1.m1.5.5.2.2.cmml" xref="S4.E1.m1.5.5.2.2"></times><apply id="S4.E1.m1.5.5.2.3.cmml" xref="S4.E1.m1.5.5.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.5.5.2.3.1.cmml" xref="S4.E1.m1.5.5.2.3">subscript</csymbol><ci id="S4.E1.m1.5.5.2.3.2.cmml" xref="S4.E1.m1.5.5.2.3.2">ğœ‹</ci><ci id="S4.E1.m1.5.5.2.3.3.cmml" xref="S4.E1.m1.5.5.2.3.3">sft</ci></apply><apply id="S4.E1.m1.5.5.2.1.1.1.cmml" xref="S4.E1.m1.5.5.2.1.1"><plus id="S4.E1.m1.5.5.2.1.1.1.1.cmml" xref="S4.E1.m1.5.5.2.1.1"></plus><apply id="S4.E1.m1.5.5.2.1.1.1.2.cmml" xref="S4.E1.m1.5.5.2.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.5.5.2.1.1.1.2.1.cmml" xref="S4.E1.m1.5.5.2.1.1.1.2.1">conditional</csymbol><ci id="S4.E1.m1.5.5.2.1.1.1.2.2.cmml" xref="S4.E1.m1.5.5.2.1.1.1.2.2">ğ²</ci><ci id="S4.E1.m1.5.5.2.1.1.1.2.3.cmml" xref="S4.E1.m1.5.5.2.1.1.1.2.3">ğ±</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3"><times id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.1"></times><ci id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.2">ğ›½</ci><apply id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3"><log id="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1.1.1.1.1.1.3.3.1"></log><apply id="S4.E1.m1.7.7.cmml" xref="S4.E1.m1.7.7"><divide id="S4.E1.m1.7.7.3.cmml" xref="S4.E1.m1.7.7"></divide><apply id="S4.E1.m1.6.6.1.cmml" xref="S4.E1.m1.6.6.1"><times id="S4.E1.m1.6.6.1.2.cmml" xref="S4.E1.m1.6.6.1.2"></times><ci id="S4.E1.m1.6.6.1.3.cmml" xref="S4.E1.m1.6.6.1.3">ğœ‹</ci><apply id="S4.E1.m1.6.6.1.1.1.1.cmml" xref="S4.E1.m1.6.6.1.1.1"><minus id="S4.E1.m1.6.6.1.1.1.1.1.cmml" xref="S4.E1.m1.6.6.1.1.1"></minus><apply id="S4.E1.m1.6.6.1.1.1.1.2.cmml" xref="S4.E1.m1.6.6.1.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.6.6.1.1.1.1.2.1.cmml" xref="S4.E1.m1.6.6.1.1.1.1.2.1">conditional</csymbol><ci id="S4.E1.m1.6.6.1.1.1.1.2.2.cmml" xref="S4.E1.m1.6.6.1.1.1.1.2.2">ğ²</ci><ci id="S4.E1.m1.6.6.1.1.1.1.2.3.cmml" xref="S4.E1.m1.6.6.1.1.1.1.2.3">ğ±</ci></apply></apply></apply><apply id="S4.E1.m1.7.7.2.cmml" xref="S4.E1.m1.7.7.2"><times id="S4.E1.m1.7.7.2.2.cmml" xref="S4.E1.m1.7.7.2.2"></times><apply id="S4.E1.m1.7.7.2.3.cmml" xref="S4.E1.m1.7.7.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.2.3.1.cmml" xref="S4.E1.m1.7.7.2.3">subscript</csymbol><ci id="S4.E1.m1.7.7.2.3.2.cmml" xref="S4.E1.m1.7.7.2.3.2">ğœ‹</ci><ci id="S4.E1.m1.7.7.2.3.3.cmml" xref="S4.E1.m1.7.7.2.3.3">sft</ci></apply><apply id="S4.E1.m1.7.7.2.1.1.1.cmml" xref="S4.E1.m1.7.7.2.1.1"><minus id="S4.E1.m1.7.7.2.1.1.1.1.cmml" xref="S4.E1.m1.7.7.2.1.1"></minus><apply id="S4.E1.m1.7.7.2.1.1.1.2.cmml" xref="S4.E1.m1.7.7.2.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.7.7.2.1.1.1.2.1.cmml" xref="S4.E1.m1.7.7.2.1.1.1.2.1">conditional</csymbol><ci id="S4.E1.m1.7.7.2.1.1.1.2.2.cmml" xref="S4.E1.m1.7.7.2.1.1.1.2.2">ğ²</ci><ci id="S4.E1.m1.7.7.2.1.1.1.2.3.cmml" xref="S4.E1.m1.7.7.2.1.1.1.2.3">ğ±</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.9c">\displaystyle\min_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathcal{L}_{\text{DPO}}(\pi):=\mathbb{E}_{(\mathbf{x},+\mathbf{y},-\mathbf{y})\sim\mathcal{D}_{\pi_{\mathrm{sft}}}^{\pm}}\left[\sigma\left(\beta\log\frac{\pi(+\mathbf{y}\mid\mathbf{x})}{\pi_{\mathrm{sft}}(+\mathbf{y}\mid\mathbf{x})}-\beta\log\frac{\pi(-\mathbf{y}\mid\mathbf{x})}{\pi_{\mathrm{sft}}(-\mathbf{y}\mid\mathbf{x})}\right)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.p3.13" class="ltx_p">We consider two objectives that construct negative data <math id="S4.p3.2.m1.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S4.p3.2.m1.1a"><mrow id="S4.p3.2.m1.1.1" xref="S4.p3.2.m1.1.1.cmml"><mo id="S4.p3.2.m1.1.1a" xref="S4.p3.2.m1.1.1.cmml">âˆ’</mo><mover accent="true" id="S4.p3.2.m1.1.1.2" xref="S4.p3.2.m1.1.1.2.cmml"><mi id="S4.p3.2.m1.1.1.2.2" xref="S4.p3.2.m1.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.2.m1.1.1.2.1" xref="S4.p3.2.m1.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m1.1b"><apply id="S4.p3.2.m1.1.1.cmml" xref="S4.p3.2.m1.1.1"><minus id="S4.p3.2.m1.1.1.1.cmml" xref="S4.p3.2.m1.1.1"></minus><apply id="S4.p3.2.m1.1.1.2.cmml" xref="S4.p3.2.m1.1.1.2"><ci id="S4.p3.2.m1.1.1.2.1.cmml" xref="S4.p3.2.m1.1.1.2.1">^</ci><ci id="S4.p3.2.m1.1.1.2.2.cmml" xref="S4.p3.2.m1.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m1.1c">-\hat{\mathbf{y}}</annotation></semantics></math> in distinct ways and subsequently train the model on that data using EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The first variant is <em id="S4.p3.13.1" class="ltx_emph ltx_font_bold ltx_font_italic">standard DPO</em>Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, which samples negative data <math id="S4.p3.3.m2.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S4.p3.3.m2.1a"><mrow id="S4.p3.3.m2.1.1" xref="S4.p3.3.m2.1.1.cmml"><mo id="S4.p3.3.m2.1.1a" xref="S4.p3.3.m2.1.1.cmml">âˆ’</mo><mover accent="true" id="S4.p3.3.m2.1.1.2" xref="S4.p3.3.m2.1.1.2.cmml"><mi id="S4.p3.3.m2.1.1.2.2" xref="S4.p3.3.m2.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.3.m2.1.1.2.1" xref="S4.p3.3.m2.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m2.1b"><apply id="S4.p3.3.m2.1.1.cmml" xref="S4.p3.3.m2.1.1"><minus id="S4.p3.3.m2.1.1.1.cmml" xref="S4.p3.3.m2.1.1"></minus><apply id="S4.p3.3.m2.1.1.2.cmml" xref="S4.p3.3.m2.1.1.2"><ci id="S4.p3.3.m2.1.1.2.1.cmml" xref="S4.p3.3.m2.1.1.2.1">^</ci><ci id="S4.p3.3.m2.1.1.2.2.cmml" xref="S4.p3.3.m2.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m2.1c">-\hat{\mathbf{y}}</annotation></semantics></math> from the SFT policy (with rejection sampling) and adds <math id="S4.p3.4.m3.3" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}})" display="inline"><semantics id="S4.p3.4.m3.3a"><mrow id="S4.p3.4.m3.3.3.1" xref="S4.p3.4.m3.3.3.2.cmml"><mo stretchy="false" id="S4.p3.4.m3.3.3.1.2" xref="S4.p3.4.m3.3.3.2.cmml">(</mo><mi id="S4.p3.4.m3.1.1" xref="S4.p3.4.m3.1.1.cmml">ğ±</mi><mo id="S4.p3.4.m3.3.3.1.3" xref="S4.p3.4.m3.3.3.2.cmml">,</mo><mi id="S4.p3.4.m3.2.2" xref="S4.p3.4.m3.2.2.cmml">ğ²</mi><mo id="S4.p3.4.m3.3.3.1.4" xref="S4.p3.4.m3.3.3.2.cmml">,</mo><mrow id="S4.p3.4.m3.3.3.1.1" xref="S4.p3.4.m3.3.3.1.1.cmml"><mo id="S4.p3.4.m3.3.3.1.1a" xref="S4.p3.4.m3.3.3.1.1.cmml">âˆ’</mo><mover accent="true" id="S4.p3.4.m3.3.3.1.1.2" xref="S4.p3.4.m3.3.3.1.1.2.cmml"><mi id="S4.p3.4.m3.3.3.1.1.2.2" xref="S4.p3.4.m3.3.3.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.4.m3.3.3.1.1.2.1" xref="S4.p3.4.m3.3.3.1.1.2.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S4.p3.4.m3.3.3.1.5" xref="S4.p3.4.m3.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m3.3b"><vector id="S4.p3.4.m3.3.3.2.cmml" xref="S4.p3.4.m3.3.3.1"><ci id="S4.p3.4.m3.1.1.cmml" xref="S4.p3.4.m3.1.1">ğ±</ci><ci id="S4.p3.4.m3.2.2.cmml" xref="S4.p3.4.m3.2.2">ğ²</ci><apply id="S4.p3.4.m3.3.3.1.1.cmml" xref="S4.p3.4.m3.3.3.1.1"><minus id="S4.p3.4.m3.3.3.1.1.1.cmml" xref="S4.p3.4.m3.3.3.1.1"></minus><apply id="S4.p3.4.m3.3.3.1.1.2.cmml" xref="S4.p3.4.m3.3.3.1.1.2"><ci id="S4.p3.4.m3.3.3.1.1.2.1.cmml" xref="S4.p3.4.m3.3.3.1.1.2.1">^</ci><ci id="S4.p3.4.m3.3.3.1.1.2.2.cmml" xref="S4.p3.4.m3.3.3.1.1.2.2">ğ²</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m3.3c">(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}})</annotation></semantics></math> to <math id="S4.p3.5.m4.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S4.p3.5.m4.1a"><msubsup id="S4.p3.5.m4.1.1" xref="S4.p3.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.5.m4.1.1.2.2" xref="S4.p3.5.m4.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S4.p3.5.m4.1.1.3" xref="S4.p3.5.m4.1.1.3.cmml"><mi id="S4.p3.5.m4.1.1.3.2" xref="S4.p3.5.m4.1.1.3.2.cmml">Ï€</mi><mi id="S4.p3.5.m4.1.1.3.3" xref="S4.p3.5.m4.1.1.3.3.cmml">sft</mi></msub><mo id="S4.p3.5.m4.1.1.2.3" xref="S4.p3.5.m4.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.5.m4.1b"><apply id="S4.p3.5.m4.1.1.cmml" xref="S4.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m4.1.1.1.cmml" xref="S4.p3.5.m4.1.1">subscript</csymbol><apply id="S4.p3.5.m4.1.1.2.cmml" xref="S4.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m4.1.1.2.1.cmml" xref="S4.p3.5.m4.1.1">superscript</csymbol><ci id="S4.p3.5.m4.1.1.2.2.cmml" xref="S4.p3.5.m4.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="S4.p3.5.m4.1.1.2.3.cmml" xref="S4.p3.5.m4.1.1.2.3">plus-or-minus</csymbol></apply><apply id="S4.p3.5.m4.1.1.3.cmml" xref="S4.p3.5.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p3.5.m4.1.1.3.1.cmml" xref="S4.p3.5.m4.1.1.3">subscript</csymbol><ci id="S4.p3.5.m4.1.1.3.2.cmml" xref="S4.p3.5.m4.1.1.3.2">ğœ‹</ci><ci id="S4.p3.5.m4.1.1.3.3.cmml" xref="S4.p3.5.m4.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m4.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>.
The second variant is <em id="S4.p3.13.2" class="ltx_emph ltx_font_bold ltx_font_italic">per-step DPO</em>Â <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, which first samples a complete solution trace <math id="S4.p3.6.m5.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{1:L}" display="inline"><semantics id="S4.p3.6.m5.1a"><msub id="S4.p3.6.m5.1.1" xref="S4.p3.6.m5.1.1.cmml"><mover accent="true" id="S4.p3.6.m5.1.1.2" xref="S4.p3.6.m5.1.1.2.cmml"><mi id="S4.p3.6.m5.1.1.2.2" xref="S4.p3.6.m5.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.6.m5.1.1.2.1" xref="S4.p3.6.m5.1.1.2.1.cmml">^</mo></mover><mrow id="S4.p3.6.m5.1.1.3" xref="S4.p3.6.m5.1.1.3.cmml"><mn id="S4.p3.6.m5.1.1.3.2" xref="S4.p3.6.m5.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p3.6.m5.1.1.3.1" xref="S4.p3.6.m5.1.1.3.1.cmml">:</mo><mi id="S4.p3.6.m5.1.1.3.3" xref="S4.p3.6.m5.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p3.6.m5.1b"><apply id="S4.p3.6.m5.1.1.cmml" xref="S4.p3.6.m5.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m5.1.1.1.cmml" xref="S4.p3.6.m5.1.1">subscript</csymbol><apply id="S4.p3.6.m5.1.1.2.cmml" xref="S4.p3.6.m5.1.1.2"><ci id="S4.p3.6.m5.1.1.2.1.cmml" xref="S4.p3.6.m5.1.1.2.1">^</ci><ci id="S4.p3.6.m5.1.1.2.2.cmml" xref="S4.p3.6.m5.1.1.2.2">ğ²</ci></apply><apply id="S4.p3.6.m5.1.1.3.cmml" xref="S4.p3.6.m5.1.1.3"><ci id="S4.p3.6.m5.1.1.3.1.cmml" xref="S4.p3.6.m5.1.1.3.1">:</ci><cn type="integer" id="S4.p3.6.m5.1.1.3.2.cmml" xref="S4.p3.6.m5.1.1.3.2">1</cn><ci id="S4.p3.6.m5.1.1.3.3.cmml" xref="S4.p3.6.m5.1.1.3.3">ğ¿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m5.1c">\hat{\mathbf{y}}_{1:L}</annotation></semantics></math> from <math id="S4.p3.7.m6.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S4.p3.7.m6.1a"><msub id="S4.p3.7.m6.1.1" xref="S4.p3.7.m6.1.1.cmml"><mi id="S4.p3.7.m6.1.1.2" xref="S4.p3.7.m6.1.1.2.cmml">Ï€</mi><mi id="S4.p3.7.m6.1.1.3" xref="S4.p3.7.m6.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.7.m6.1b"><apply id="S4.p3.7.m6.1.1.cmml" xref="S4.p3.7.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.7.m6.1.1.1.cmml" xref="S4.p3.7.m6.1.1">subscript</csymbol><ci id="S4.p3.7.m6.1.1.2.cmml" xref="S4.p3.7.m6.1.1.2">ğœ‹</ci><ci id="S4.p3.7.m6.1.1.3.cmml" xref="S4.p3.7.m6.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m6.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> and then determines the â€œfirst pitâ€ <math id="S4.p3.8.m7.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{c}" display="inline"><semantics id="S4.p3.8.m7.1a"><msub id="S4.p3.8.m7.1.1" xref="S4.p3.8.m7.1.1.cmml"><mover accent="true" id="S4.p3.8.m7.1.1.2" xref="S4.p3.8.m7.1.1.2.cmml"><mi id="S4.p3.8.m7.1.1.2.2" xref="S4.p3.8.m7.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.8.m7.1.1.2.1" xref="S4.p3.8.m7.1.1.2.1.cmml">^</mo></mover><mi id="S4.p3.8.m7.1.1.3" xref="S4.p3.8.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.8.m7.1b"><apply id="S4.p3.8.m7.1.1.cmml" xref="S4.p3.8.m7.1.1"><csymbol cd="ambiguous" id="S4.p3.8.m7.1.1.1.cmml" xref="S4.p3.8.m7.1.1">subscript</csymbol><apply id="S4.p3.8.m7.1.1.2.cmml" xref="S4.p3.8.m7.1.1.2"><ci id="S4.p3.8.m7.1.1.2.1.cmml" xref="S4.p3.8.m7.1.1.2.1">^</ci><ci id="S4.p3.8.m7.1.1.2.2.cmml" xref="S4.p3.8.m7.1.1.2.2">ğ²</ci></apply><ci id="S4.p3.8.m7.1.1.3.cmml" xref="S4.p3.8.m7.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m7.1c">\hat{\mathbf{y}}_{c}</annotation></semantics></math>. The first pit <math id="S4.p3.9.m8.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{c}" display="inline"><semantics id="S4.p3.9.m8.1a"><msub id="S4.p3.9.m8.1.1" xref="S4.p3.9.m8.1.1.cmml"><mover accent="true" id="S4.p3.9.m8.1.1.2" xref="S4.p3.9.m8.1.1.2.cmml"><mi id="S4.p3.9.m8.1.1.2.2" xref="S4.p3.9.m8.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.9.m8.1.1.2.1" xref="S4.p3.9.m8.1.1.2.1.cmml">^</mo></mover><mi id="S4.p3.9.m8.1.1.3" xref="S4.p3.9.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.9.m8.1b"><apply id="S4.p3.9.m8.1.1.cmml" xref="S4.p3.9.m8.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m8.1.1.1.cmml" xref="S4.p3.9.m8.1.1">subscript</csymbol><apply id="S4.p3.9.m8.1.1.2.cmml" xref="S4.p3.9.m8.1.1.2"><ci id="S4.p3.9.m8.1.1.2.1.cmml" xref="S4.p3.9.m8.1.1.2.1">^</ci><ci id="S4.p3.9.m8.1.1.2.2.cmml" xref="S4.p3.9.m8.1.1.2.2">ğ²</ci></apply><ci id="S4.p3.9.m8.1.1.3.cmml" xref="S4.p3.9.m8.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m8.1c">\hat{\mathbf{y}}_{c}</annotation></semantics></math> is the step where any completion following the step: <math id="S4.p3.10.m9.1" class="ltx_math_unparsed" alttext="\hat{\mathbf{y}}_{c+1:L}\sim\pi_{\text{sft}}(\cdot\mid\mathbf{x},\hat{\mathbf{y}}_{1:c})" display="inline"><semantics id="S4.p3.10.m9.1a"><mrow id="S4.p3.10.m9.1b"><msub id="S4.p3.10.m9.1.1"><mover accent="true" id="S4.p3.10.m9.1.1.2"><mi id="S4.p3.10.m9.1.1.2.2">ğ²</mi><mo id="S4.p3.10.m9.1.1.2.1">^</mo></mover><mrow id="S4.p3.10.m9.1.1.3"><mrow id="S4.p3.10.m9.1.1.3.2"><mi id="S4.p3.10.m9.1.1.3.2.2">c</mi><mo id="S4.p3.10.m9.1.1.3.2.1">+</mo><mn id="S4.p3.10.m9.1.1.3.2.3">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S4.p3.10.m9.1.1.3.1">:</mo><mi id="S4.p3.10.m9.1.1.3.3">L</mi></mrow></msub><mo id="S4.p3.10.m9.1.2">âˆ¼</mo><msub id="S4.p3.10.m9.1.3"><mi id="S4.p3.10.m9.1.3.2">Ï€</mi><mtext id="S4.p3.10.m9.1.3.3">sft</mtext></msub><mrow id="S4.p3.10.m9.1.4"><mo stretchy="false" id="S4.p3.10.m9.1.4.1">(</mo><mo lspace="0em" rspace="0em" id="S4.p3.10.m9.1.4.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S4.p3.10.m9.1.4.3">âˆ£</mo><mi id="S4.p3.10.m9.1.4.4">ğ±</mi><mo id="S4.p3.10.m9.1.4.5">,</mo><msub id="S4.p3.10.m9.1.4.6"><mover accent="true" id="S4.p3.10.m9.1.4.6.2"><mi id="S4.p3.10.m9.1.4.6.2.2">ğ²</mi><mo id="S4.p3.10.m9.1.4.6.2.1">^</mo></mover><mrow id="S4.p3.10.m9.1.4.6.3"><mn id="S4.p3.10.m9.1.4.6.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p3.10.m9.1.4.6.3.1">:</mo><mi id="S4.p3.10.m9.1.4.6.3.3">c</mi></mrow></msub><mo stretchy="false" id="S4.p3.10.m9.1.4.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p3.10.m9.1c">\hat{\mathbf{y}}_{c+1:L}\sim\pi_{\text{sft}}(\cdot\mid\mathbf{x},\hat{\mathbf{y}}_{1:c})</annotation></semantics></math> leads to incorrect answers in expectation under <math id="S4.p3.11.m10.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S4.p3.11.m10.1a"><msub id="S4.p3.11.m10.1.1" xref="S4.p3.11.m10.1.1.cmml"><mi id="S4.p3.11.m10.1.1.2" xref="S4.p3.11.m10.1.1.2.cmml">Ï€</mi><mi id="S4.p3.11.m10.1.1.3" xref="S4.p3.11.m10.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.11.m10.1b"><apply id="S4.p3.11.m10.1.1.cmml" xref="S4.p3.11.m10.1.1"><csymbol cd="ambiguous" id="S4.p3.11.m10.1.1.1.cmml" xref="S4.p3.11.m10.1.1">subscript</csymbol><ci id="S4.p3.11.m10.1.1.2.cmml" xref="S4.p3.11.m10.1.1.2">ğœ‹</ci><ci id="S4.p3.11.m10.1.1.3.cmml" xref="S4.p3.11.m10.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.11.m10.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>. The triplet <math id="S4.p3.12.m11.3" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y},\hat{\mathbf{y}}_{1:c})" display="inline"><semantics id="S4.p3.12.m11.3a"><mrow id="S4.p3.12.m11.3.3.1" xref="S4.p3.12.m11.3.3.2.cmml"><mo stretchy="false" id="S4.p3.12.m11.3.3.1.2" xref="S4.p3.12.m11.3.3.2.cmml">(</mo><mi id="S4.p3.12.m11.1.1" xref="S4.p3.12.m11.1.1.cmml">ğ±</mi><mo id="S4.p3.12.m11.3.3.1.3" xref="S4.p3.12.m11.3.3.2.cmml">,</mo><mi id="S4.p3.12.m11.2.2" xref="S4.p3.12.m11.2.2.cmml">ğ²</mi><mo id="S4.p3.12.m11.3.3.1.4" xref="S4.p3.12.m11.3.3.2.cmml">,</mo><msub id="S4.p3.12.m11.3.3.1.1" xref="S4.p3.12.m11.3.3.1.1.cmml"><mover accent="true" id="S4.p3.12.m11.3.3.1.1.2" xref="S4.p3.12.m11.3.3.1.1.2.cmml"><mi id="S4.p3.12.m11.3.3.1.1.2.2" xref="S4.p3.12.m11.3.3.1.1.2.2.cmml">ğ²</mi><mo id="S4.p3.12.m11.3.3.1.1.2.1" xref="S4.p3.12.m11.3.3.1.1.2.1.cmml">^</mo></mover><mrow id="S4.p3.12.m11.3.3.1.1.3" xref="S4.p3.12.m11.3.3.1.1.3.cmml"><mn id="S4.p3.12.m11.3.3.1.1.3.2" xref="S4.p3.12.m11.3.3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p3.12.m11.3.3.1.1.3.1" xref="S4.p3.12.m11.3.3.1.1.3.1.cmml">:</mo><mi id="S4.p3.12.m11.3.3.1.1.3.3" xref="S4.p3.12.m11.3.3.1.1.3.3.cmml">c</mi></mrow></msub><mo stretchy="false" id="S4.p3.12.m11.3.3.1.5" xref="S4.p3.12.m11.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.12.m11.3b"><vector id="S4.p3.12.m11.3.3.2.cmml" xref="S4.p3.12.m11.3.3.1"><ci id="S4.p3.12.m11.1.1.cmml" xref="S4.p3.12.m11.1.1">ğ±</ci><ci id="S4.p3.12.m11.2.2.cmml" xref="S4.p3.12.m11.2.2">ğ²</ci><apply id="S4.p3.12.m11.3.3.1.1.cmml" xref="S4.p3.12.m11.3.3.1.1"><csymbol cd="ambiguous" id="S4.p3.12.m11.3.3.1.1.1.cmml" xref="S4.p3.12.m11.3.3.1.1">subscript</csymbol><apply id="S4.p3.12.m11.3.3.1.1.2.cmml" xref="S4.p3.12.m11.3.3.1.1.2"><ci id="S4.p3.12.m11.3.3.1.1.2.1.cmml" xref="S4.p3.12.m11.3.3.1.1.2.1">^</ci><ci id="S4.p3.12.m11.3.3.1.1.2.2.cmml" xref="S4.p3.12.m11.3.3.1.1.2.2">ğ²</ci></apply><apply id="S4.p3.12.m11.3.3.1.1.3.cmml" xref="S4.p3.12.m11.3.3.1.1.3"><ci id="S4.p3.12.m11.3.3.1.1.3.1.cmml" xref="S4.p3.12.m11.3.3.1.1.3.1">:</ci><cn type="integer" id="S4.p3.12.m11.3.3.1.1.3.2.cmml" xref="S4.p3.12.m11.3.3.1.1.3.2">1</cn><ci id="S4.p3.12.m11.3.3.1.1.3.3.cmml" xref="S4.p3.12.m11.3.3.1.1.3.3">ğ‘</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.12.m11.3c">(\mathbf{x},\mathbf{y},\hat{\mathbf{y}}_{1:c})</annotation></semantics></math> is added to the preference dataset <math id="S4.p3.13.m12.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S4.p3.13.m12.1a"><msubsup id="S4.p3.13.m12.1.1" xref="S4.p3.13.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.13.m12.1.1.2.2" xref="S4.p3.13.m12.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S4.p3.13.m12.1.1.3" xref="S4.p3.13.m12.1.1.3.cmml"><mi id="S4.p3.13.m12.1.1.3.2" xref="S4.p3.13.m12.1.1.3.2.cmml">Ï€</mi><mi id="S4.p3.13.m12.1.1.3.3" xref="S4.p3.13.m12.1.1.3.3.cmml">sft</mi></msub><mo id="S4.p3.13.m12.1.1.2.3" xref="S4.p3.13.m12.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.13.m12.1b"><apply id="S4.p3.13.m12.1.1.cmml" xref="S4.p3.13.m12.1.1"><csymbol cd="ambiguous" id="S4.p3.13.m12.1.1.1.cmml" xref="S4.p3.13.m12.1.1">subscript</csymbol><apply id="S4.p3.13.m12.1.1.2.cmml" xref="S4.p3.13.m12.1.1"><csymbol cd="ambiguous" id="S4.p3.13.m12.1.1.2.1.cmml" xref="S4.p3.13.m12.1.1">superscript</csymbol><ci id="S4.p3.13.m12.1.1.2.2.cmml" xref="S4.p3.13.m12.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="S4.p3.13.m12.1.1.2.3.cmml" xref="S4.p3.13.m12.1.1.2.3">plus-or-minus</csymbol></apply><apply id="S4.p3.13.m12.1.1.3.cmml" xref="S4.p3.13.m12.1.1.3"><csymbol cd="ambiguous" id="S4.p3.13.m12.1.1.3.1.cmml" xref="S4.p3.13.m12.1.1.3">subscript</csymbol><ci id="S4.p3.13.m12.1.1.3.2.cmml" xref="S4.p3.13.m12.1.1.3.2">ğœ‹</ci><ci id="S4.p3.13.m12.1.1.3.3.cmml" xref="S4.p3.13.m12.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.13.m12.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Positive Data Improves Coverage, But Amplifies Spurious Correlations</h3>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We first analyze the influence of scaling up positive synthetic data on GSM8K and MATH. In this experiment, we fine-tune DeepSeek-Math-7BÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and LLama2-7BÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> models (details in AppendixÂ <a href="#A7" title="Appendix G Implementation Details â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">G</span></a>) on varying sizes of <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, constructed out of a 5:1 mixture of GPT-4-turboÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and Gemini-1.5 ProÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>
We use API versions of these models as of May 5, 2024. All experiments in this paper (including experiments with GPT and Gemini models) were performed entirely by Amrith Setlur and Saurabh Garg.
</span></span></span>.
We obtain a series of SFT policies on this data scaling ladder. We then train a series of models by running one iteration of RFT on data obtained from the SFT policies at each step.</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x3.png" id="S5.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="457" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(a)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x4.png" id="S5.F2.2.g1" class="ltx_graphics ltx_img_landscape" width="457" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(b)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x5.png" id="S5.F2.3.g1" class="ltx_graphics ltx_img_landscape" width="456" height="363" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(c)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.22.9.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><em id="S5.F2.23.10" class="ltx_emph ltx_font_bold ltx_font_italic" style="font-size:80%;">Positive data scaling laws:</em><span id="S5.F2.19.8" class="ltx_text" style="font-size:80%;"> On GSM8K (a) and MATH (b), we evaluate SFT trained on <math id="S5.F2.12.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.F2.12.1.m1.1b"><msub id="S5.F2.12.1.m1.1.1" xref="S5.F2.12.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.12.1.m1.1.1.2" xref="S5.F2.12.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.F2.12.1.m1.1.1.3" xref="S5.F2.12.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F2.12.1.m1.1c"><apply id="S5.F2.12.1.m1.1.1.cmml" xref="S5.F2.12.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F2.12.1.m1.1.1.1.cmml" xref="S5.F2.12.1.m1.1.1">subscript</csymbol><ci id="S5.F2.12.1.m1.1.1.2.cmml" xref="S5.F2.12.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.F2.12.1.m1.1.1.3.cmml" xref="S5.F2.12.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.12.1.m1.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> and RFT that uses SFT policy generated positives (<math id="S5.F2.13.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.F2.13.2.m2.1b"><msubsup id="S5.F2.13.2.m2.1.1" xref="S5.F2.13.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.13.2.m2.1.1.2.2" xref="S5.F2.13.2.m2.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.F2.13.2.m2.1.1.3" xref="S5.F2.13.2.m2.1.1.3.cmml"><mi id="S5.F2.13.2.m2.1.1.3.2" xref="S5.F2.13.2.m2.1.1.3.2.cmml">Ï€</mi><mi id="S5.F2.13.2.m2.1.1.3.3" xref="S5.F2.13.2.m2.1.1.3.3.cmml">sft</mi></msub><mo id="S5.F2.13.2.m2.1.1.2.3" xref="S5.F2.13.2.m2.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.F2.13.2.m2.1c"><apply id="S5.F2.13.2.m2.1.1.cmml" xref="S5.F2.13.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F2.13.2.m2.1.1.1.cmml" xref="S5.F2.13.2.m2.1.1">subscript</csymbol><apply id="S5.F2.13.2.m2.1.1.2.cmml" xref="S5.F2.13.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F2.13.2.m2.1.1.2.1.cmml" xref="S5.F2.13.2.m2.1.1">superscript</csymbol><ci id="S5.F2.13.2.m2.1.1.2.2.cmml" xref="S5.F2.13.2.m2.1.1.2.2">ğ’Ÿ</ci><plus id="S5.F2.13.2.m2.1.1.2.3.cmml" xref="S5.F2.13.2.m2.1.1.2.3"></plus></apply><apply id="S5.F2.13.2.m2.1.1.3.cmml" xref="S5.F2.13.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.F2.13.2.m2.1.1.3.1.cmml" xref="S5.F2.13.2.m2.1.1.3">subscript</csymbol><ci id="S5.F2.13.2.m2.1.1.3.2.cmml" xref="S5.F2.13.2.m2.1.1.3.2">ğœ‹</ci><ci id="S5.F2.13.2.m2.1.1.3.3.cmml" xref="S5.F2.13.2.m2.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.13.2.m2.1d">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>), as we scale <math id="S5.F2.14.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.F2.14.3.m3.1b"><msub id="S5.F2.14.3.m3.1.1" xref="S5.F2.14.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.14.3.m3.1.1.2" xref="S5.F2.14.3.m3.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.F2.14.3.m3.1.1.3" xref="S5.F2.14.3.m3.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F2.14.3.m3.1c"><apply id="S5.F2.14.3.m3.1.1.cmml" xref="S5.F2.14.3.m3.1.1"><csymbol cd="ambiguous" id="S5.F2.14.3.m3.1.1.1.cmml" xref="S5.F2.14.3.m3.1.1">subscript</csymbol><ci id="S5.F2.14.3.m3.1.1.2.cmml" xref="S5.F2.14.3.m3.1.1.2">ğ’Ÿ</ci><ci id="S5.F2.14.3.m3.1.1.3.cmml" xref="S5.F2.14.3.m3.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.14.3.m3.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, observing <math id="S5.F2.15.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.F2.15.4.m4.1b"><msubsup id="S5.F2.15.4.m4.1.1" xref="S5.F2.15.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.15.4.m4.1.1.2.2" xref="S5.F2.15.4.m4.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.F2.15.4.m4.1.1.3" xref="S5.F2.15.4.m4.1.1.3.cmml"><mi id="S5.F2.15.4.m4.1.1.3.2" xref="S5.F2.15.4.m4.1.1.3.2.cmml">Ï€</mi><mi id="S5.F2.15.4.m4.1.1.3.3" xref="S5.F2.15.4.m4.1.1.3.3.cmml">sft</mi></msub><mo id="S5.F2.15.4.m4.1.1.2.3" xref="S5.F2.15.4.m4.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.F2.15.4.m4.1c"><apply id="S5.F2.15.4.m4.1.1.cmml" xref="S5.F2.15.4.m4.1.1"><csymbol cd="ambiguous" id="S5.F2.15.4.m4.1.1.1.cmml" xref="S5.F2.15.4.m4.1.1">subscript</csymbol><apply id="S5.F2.15.4.m4.1.1.2.cmml" xref="S5.F2.15.4.m4.1.1"><csymbol cd="ambiguous" id="S5.F2.15.4.m4.1.1.2.1.cmml" xref="S5.F2.15.4.m4.1.1">superscript</csymbol><ci id="S5.F2.15.4.m4.1.1.2.2.cmml" xref="S5.F2.15.4.m4.1.1.2.2">ğ’Ÿ</ci><plus id="S5.F2.15.4.m4.1.1.2.3.cmml" xref="S5.F2.15.4.m4.1.1.2.3"></plus></apply><apply id="S5.F2.15.4.m4.1.1.3.cmml" xref="S5.F2.15.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.F2.15.4.m4.1.1.3.1.cmml" xref="S5.F2.15.4.m4.1.1.3">subscript</csymbol><ci id="S5.F2.15.4.m4.1.1.3.2.cmml" xref="S5.F2.15.4.m4.1.1.3.2">ğœ‹</ci><ci id="S5.F2.15.4.m4.1.1.3.3.cmml" xref="S5.F2.15.4.m4.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.15.4.m4.1d">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> to be <math id="S5.F2.16.5.m5.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.F2.16.5.m5.1b"><mrow id="S5.F2.16.5.m5.1c"><mn id="S5.F2.16.5.m5.1.1">2</mn><mo lspace="0.222em" id="S5.F2.16.5.m5.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S5.F2.16.5.m5.1d">2\times</annotation></semantics></math> as effective as <math id="S5.F2.17.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.F2.17.6.m6.1b"><msub id="S5.F2.17.6.m6.1.1" xref="S5.F2.17.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.17.6.m6.1.1.2" xref="S5.F2.17.6.m6.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.F2.17.6.m6.1.1.3" xref="S5.F2.17.6.m6.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F2.17.6.m6.1c"><apply id="S5.F2.17.6.m6.1.1.cmml" xref="S5.F2.17.6.m6.1.1"><csymbol cd="ambiguous" id="S5.F2.17.6.m6.1.1.1.cmml" xref="S5.F2.17.6.m6.1.1">subscript</csymbol><ci id="S5.F2.17.6.m6.1.1.2.cmml" xref="S5.F2.17.6.m6.1.1.2">ğ’Ÿ</ci><ci id="S5.F2.17.6.m6.1.1.3.cmml" xref="S5.F2.17.6.m6.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.17.6.m6.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. In (c), we plot performance of RFT the number of correct solutions in <math id="S5.F2.18.7.m7.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.F2.18.7.m7.1b"><msubsup id="S5.F2.18.7.m7.1.1" xref="S5.F2.18.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.18.7.m7.1.1.2.2" xref="S5.F2.18.7.m7.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.F2.18.7.m7.1.1.3" xref="S5.F2.18.7.m7.1.1.3.cmml"><mi id="S5.F2.18.7.m7.1.1.3.2" xref="S5.F2.18.7.m7.1.1.3.2.cmml">Ï€</mi><mi id="S5.F2.18.7.m7.1.1.3.3" xref="S5.F2.18.7.m7.1.1.3.3.cmml">sft</mi></msub><mo id="S5.F2.18.7.m7.1.1.2.3" xref="S5.F2.18.7.m7.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.F2.18.7.m7.1c"><apply id="S5.F2.18.7.m7.1.1.cmml" xref="S5.F2.18.7.m7.1.1"><csymbol cd="ambiguous" id="S5.F2.18.7.m7.1.1.1.cmml" xref="S5.F2.18.7.m7.1.1">subscript</csymbol><apply id="S5.F2.18.7.m7.1.1.2.cmml" xref="S5.F2.18.7.m7.1.1"><csymbol cd="ambiguous" id="S5.F2.18.7.m7.1.1.2.1.cmml" xref="S5.F2.18.7.m7.1.1">superscript</csymbol><ci id="S5.F2.18.7.m7.1.1.2.2.cmml" xref="S5.F2.18.7.m7.1.1.2.2">ğ’Ÿ</ci><plus id="S5.F2.18.7.m7.1.1.2.3.cmml" xref="S5.F2.18.7.m7.1.1.2.3"></plus></apply><apply id="S5.F2.18.7.m7.1.1.3.cmml" xref="S5.F2.18.7.m7.1.1.3"><csymbol cd="ambiguous" id="S5.F2.18.7.m7.1.1.3.1.cmml" xref="S5.F2.18.7.m7.1.1.3">subscript</csymbol><ci id="S5.F2.18.7.m7.1.1.3.2.cmml" xref="S5.F2.18.7.m7.1.1.3.2">ğœ‹</ci><ci id="S5.F2.18.7.m7.1.1.3.3.cmml" xref="S5.F2.18.7.m7.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.18.7.m7.1d">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> are scaled, for a fixed set of 8k/16k problems from <math id="S5.F2.19.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.F2.19.8.m8.1b"><msub id="S5.F2.19.8.m8.1.1" xref="S5.F2.19.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F2.19.8.m8.1.1.2" xref="S5.F2.19.8.m8.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.F2.19.8.m8.1.1.3" xref="S5.F2.19.8.m8.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F2.19.8.m8.1c"><apply id="S5.F2.19.8.m8.1.1.cmml" xref="S5.F2.19.8.m8.1.1"><csymbol cd="ambiguous" id="S5.F2.19.8.m8.1.1.1.cmml" xref="S5.F2.19.8.m8.1.1">subscript</csymbol><ci id="S5.F2.19.8.m8.1.1.2.cmml" xref="S5.F2.19.8.m8.1.1.2">ğ’Ÿ</ci><ci id="S5.F2.19.8.m8.1.1.3.cmml" xref="S5.F2.19.8.m8.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.19.8.m8.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, observing that scaling model positives can amplify spurious correlations.</span></figcaption>
</figure>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.13" class="ltx_p"><span id="S5.p2.13.1" class="ltx_text ltx_font_bold">Scaling results with positive synthetic data GPT-4 and Gemini-1.5 Pro.</span>
Since we assume that these more capable models generate correct solutions for new problems, by scaling <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> we are increasing <em id="S5.p2.13.2" class="ltx_emph ltx_font_italic">coverage</em> under <math id="S5.p2.2.m2.1" class="ltx_Math" alttext="p_{\mathrm{real}}" display="inline"><semantics id="S5.p2.2.m2.1a"><msub id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mi id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">p</mi><mi id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">real</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1">subscript</csymbol><ci id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">ğ‘</ci><ci id="S5.p2.2.m2.1.1.3.cmml" xref="S5.p2.2.m2.1.1.3">real</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">p_{\mathrm{real}}</annotation></semantics></math>, <em id="S5.p2.13.3" class="ltx_emph ltx_font_italic">i.e.</em>,Â adding new <math id="S5.p2.3.m3.2" class="ltx_Math" alttext="\mathbf{x},\mathbf{y}" display="inline"><semantics id="S5.p2.3.m3.2a"><mrow id="S5.p2.3.m3.2.3.2" xref="S5.p2.3.m3.2.3.1.cmml"><mi id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml">ğ±</mi><mo id="S5.p2.3.m3.2.3.2.1" xref="S5.p2.3.m3.2.3.1.cmml">,</mo><mi id="S5.p2.3.m3.2.2" xref="S5.p2.3.m3.2.2.cmml">ğ²</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.2b"><list id="S5.p2.3.m3.2.3.1.cmml" xref="S5.p2.3.m3.2.3.2"><ci id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1">ğ±</ci><ci id="S5.p2.3.m3.2.2.cmml" xref="S5.p2.3.m3.2.2">ğ²</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.2c">\mathbf{x},\mathbf{y}</annotation></semantics></math> with non-zero probability under <math id="S5.p2.4.m4.1" class="ltx_Math" alttext="p_{\mathrm{real}}" display="inline"><semantics id="S5.p2.4.m4.1a"><msub id="S5.p2.4.m4.1.1" xref="S5.p2.4.m4.1.1.cmml"><mi id="S5.p2.4.m4.1.1.2" xref="S5.p2.4.m4.1.1.2.cmml">p</mi><mi id="S5.p2.4.m4.1.1.3" xref="S5.p2.4.m4.1.1.3.cmml">real</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.4.m4.1b"><apply id="S5.p2.4.m4.1.1.cmml" xref="S5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p2.4.m4.1.1.1.cmml" xref="S5.p2.4.m4.1.1">subscript</csymbol><ci id="S5.p2.4.m4.1.1.2.cmml" xref="S5.p2.4.m4.1.1.2">ğ‘</ci><ci id="S5.p2.4.m4.1.1.3.cmml" xref="S5.p2.4.m4.1.1.3">real</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.4.m4.1c">p_{\mathrm{real}}</annotation></semantics></math>.
In FiguresÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b), we plot the test error rate of the SFT policy as <math id="S5.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p2.5.m5.1a"><msub id="S5.p2.5.m5.1.1" xref="S5.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.5.m5.1.1.2" xref="S5.p2.5.m5.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p2.5.m5.1.1.3" xref="S5.p2.5.m5.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.5.m5.1b"><apply id="S5.p2.5.m5.1.1.cmml" xref="S5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p2.5.m5.1.1.1.cmml" xref="S5.p2.5.m5.1.1">subscript</csymbol><ci id="S5.p2.5.m5.1.1.2.cmml" xref="S5.p2.5.m5.1.1.2">ğ’Ÿ</ci><ci id="S5.p2.5.m5.1.1.3.cmml" xref="S5.p2.5.m5.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.5.m5.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> is scaled. As expected, we observe that the test error rate on both GSM8K and MATH improves with more positive data.
Further, by simply fitting the parametric scaling law fromÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>, for <math id="S5.p2.6.m6.1" class="ltx_Math" alttext="D:=|\mathcal{D}_{\mathrm{syn}}|" display="inline"><semantics id="S5.p2.6.m6.1a"><mrow id="S5.p2.6.m6.1.1" xref="S5.p2.6.m6.1.1.cmml"><mi id="S5.p2.6.m6.1.1.3" xref="S5.p2.6.m6.1.1.3.cmml">D</mi><mo lspace="0.278em" rspace="0.278em" id="S5.p2.6.m6.1.1.2" xref="S5.p2.6.m6.1.1.2.cmml">:=</mo><mrow id="S5.p2.6.m6.1.1.1.1" xref="S5.p2.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S5.p2.6.m6.1.1.1.1.2" xref="S5.p2.6.m6.1.1.1.2.1.cmml">|</mo><msub id="S5.p2.6.m6.1.1.1.1.1" xref="S5.p2.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.6.m6.1.1.1.1.1.2" xref="S5.p2.6.m6.1.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p2.6.m6.1.1.1.1.1.3" xref="S5.p2.6.m6.1.1.1.1.1.3.cmml">syn</mi></msub><mo stretchy="false" id="S5.p2.6.m6.1.1.1.1.3" xref="S5.p2.6.m6.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.6.m6.1b"><apply id="S5.p2.6.m6.1.1.cmml" xref="S5.p2.6.m6.1.1"><csymbol cd="latexml" id="S5.p2.6.m6.1.1.2.cmml" xref="S5.p2.6.m6.1.1.2">assign</csymbol><ci id="S5.p2.6.m6.1.1.3.cmml" xref="S5.p2.6.m6.1.1.3">ğ·</ci><apply id="S5.p2.6.m6.1.1.1.2.cmml" xref="S5.p2.6.m6.1.1.1.1"><abs id="S5.p2.6.m6.1.1.1.2.1.cmml" xref="S5.p2.6.m6.1.1.1.1.2"></abs><apply id="S5.p2.6.m6.1.1.1.1.1.cmml" xref="S5.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p2.6.m6.1.1.1.1.1.1.cmml" xref="S5.p2.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S5.p2.6.m6.1.1.1.1.1.2.cmml" xref="S5.p2.6.m6.1.1.1.1.1.2">ğ’Ÿ</ci><ci id="S5.p2.6.m6.1.1.1.1.1.3.cmml" xref="S5.p2.6.m6.1.1.1.1.1.3">syn</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.6.m6.1c">D:=|\mathcal{D}_{\mathrm{syn}}|</annotation></semantics></math>, we find that the scaling trends decay as <math id="S5.p2.7.m7.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.p2.7.m7.1a"><mo id="S5.p2.7.m7.1.1" xref="S5.p2.7.m7.1.1.cmml">â‰ˆ</mo><annotation-xml encoding="MathML-Content" id="S5.p2.7.m7.1b"><approx id="S5.p2.7.m7.1.1.cmml" xref="S5.p2.7.m7.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.7.m7.1c">\approx</annotation></semantics></math><math id="S5.p2.8.m8.1" class="ltx_Math" alttext="D^{-0.15}" display="inline"><semantics id="S5.p2.8.m8.1a"><msup id="S5.p2.8.m8.1.1" xref="S5.p2.8.m8.1.1.cmml"><mi id="S5.p2.8.m8.1.1.2" xref="S5.p2.8.m8.1.1.2.cmml">D</mi><mrow id="S5.p2.8.m8.1.1.3" xref="S5.p2.8.m8.1.1.3.cmml"><mo id="S5.p2.8.m8.1.1.3a" xref="S5.p2.8.m8.1.1.3.cmml">âˆ’</mo><mn id="S5.p2.8.m8.1.1.3.2" xref="S5.p2.8.m8.1.1.3.2.cmml">0.15</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p2.8.m8.1b"><apply id="S5.p2.8.m8.1.1.cmml" xref="S5.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S5.p2.8.m8.1.1.1.cmml" xref="S5.p2.8.m8.1.1">superscript</csymbol><ci id="S5.p2.8.m8.1.1.2.cmml" xref="S5.p2.8.m8.1.1.2">ğ·</ci><apply id="S5.p2.8.m8.1.1.3.cmml" xref="S5.p2.8.m8.1.1.3"><minus id="S5.p2.8.m8.1.1.3.1.cmml" xref="S5.p2.8.m8.1.1.3"></minus><cn type="float" id="S5.p2.8.m8.1.1.3.2.cmml" xref="S5.p2.8.m8.1.1.3.2">0.15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.8.m8.1c">D^{-0.15}</annotation></semantics></math> on GSM8K and <math id="S5.p2.9.m9.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.p2.9.m9.1a"><mo id="S5.p2.9.m9.1.1" xref="S5.p2.9.m9.1.1.cmml">â‰ˆ</mo><annotation-xml encoding="MathML-Content" id="S5.p2.9.m9.1b"><approx id="S5.p2.9.m9.1.1.cmml" xref="S5.p2.9.m9.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.9.m9.1c">\approx</annotation></semantics></math><math id="S5.p2.10.m10.1" class="ltx_Math" alttext="D^{-0.05}" display="inline"><semantics id="S5.p2.10.m10.1a"><msup id="S5.p2.10.m10.1.1" xref="S5.p2.10.m10.1.1.cmml"><mi id="S5.p2.10.m10.1.1.2" xref="S5.p2.10.m10.1.1.2.cmml">D</mi><mrow id="S5.p2.10.m10.1.1.3" xref="S5.p2.10.m10.1.1.3.cmml"><mo id="S5.p2.10.m10.1.1.3a" xref="S5.p2.10.m10.1.1.3.cmml">âˆ’</mo><mn id="S5.p2.10.m10.1.1.3.2" xref="S5.p2.10.m10.1.1.3.2.cmml">0.05</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p2.10.m10.1b"><apply id="S5.p2.10.m10.1.1.cmml" xref="S5.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S5.p2.10.m10.1.1.1.cmml" xref="S5.p2.10.m10.1.1">superscript</csymbol><ci id="S5.p2.10.m10.1.1.2.cmml" xref="S5.p2.10.m10.1.1.2">ğ·</ci><apply id="S5.p2.10.m10.1.1.3.cmml" xref="S5.p2.10.m10.1.1.3"><minus id="S5.p2.10.m10.1.1.3.1.cmml" xref="S5.p2.10.m10.1.1.3"></minus><cn type="float" id="S5.p2.10.m10.1.1.3.2.cmml" xref="S5.p2.10.m10.1.1.3.2">0.05</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.10.m10.1c">D^{-0.05}</annotation></semantics></math> on the harder MATH dataset, with similar trends for the corresponding pass@<math id="S5.p2.11.m11.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.p2.11.m11.1a"><mn id="S5.p2.11.m11.1.1" xref="S5.p2.11.m11.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.p2.11.m11.1b"><cn type="integer" id="S5.p2.11.m11.1.1.cmml" xref="S5.p2.11.m11.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.11.m11.1c">5</annotation></semantics></math> error rates.
Since these scaling trends are much more underwhelming than those for pre-trainingÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, this perhaps implies that samples in <math id="S5.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p2.12.m12.1a"><msub id="S5.p2.12.m12.1.1" xref="S5.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.12.m12.1.1.2" xref="S5.p2.12.m12.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p2.12.m12.1.1.3" xref="S5.p2.12.m12.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.12.m12.1b"><apply id="S5.p2.12.m12.1.1.cmml" xref="S5.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S5.p2.12.m12.1.1.1.cmml" xref="S5.p2.12.m12.1.1">subscript</csymbol><ci id="S5.p2.12.m12.1.1.2.cmml" xref="S5.p2.12.m12.1.1.2">ğ’Ÿ</ci><ci id="S5.p2.12.m12.1.1.3.cmml" xref="S5.p2.12.m12.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.12.m12.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> are indeed improving coverage over samples in <math id="S5.p2.13.m13.2" class="ltx_Math" alttext="p_{\text{real}}(\mathbf{x},\mathbf{y})" display="inline"><semantics id="S5.p2.13.m13.2a"><mrow id="S5.p2.13.m13.2.3" xref="S5.p2.13.m13.2.3.cmml"><msub id="S5.p2.13.m13.2.3.2" xref="S5.p2.13.m13.2.3.2.cmml"><mi id="S5.p2.13.m13.2.3.2.2" xref="S5.p2.13.m13.2.3.2.2.cmml">p</mi><mtext id="S5.p2.13.m13.2.3.2.3" xref="S5.p2.13.m13.2.3.2.3a.cmml">real</mtext></msub><mo lspace="0em" rspace="0em" id="S5.p2.13.m13.2.3.1" xref="S5.p2.13.m13.2.3.1.cmml">â€‹</mo><mrow id="S5.p2.13.m13.2.3.3.2" xref="S5.p2.13.m13.2.3.3.1.cmml"><mo stretchy="false" id="S5.p2.13.m13.2.3.3.2.1" xref="S5.p2.13.m13.2.3.3.1.cmml">(</mo><mi id="S5.p2.13.m13.1.1" xref="S5.p2.13.m13.1.1.cmml">ğ±</mi><mo id="S5.p2.13.m13.2.3.3.2.2" xref="S5.p2.13.m13.2.3.3.1.cmml">,</mo><mi id="S5.p2.13.m13.2.2" xref="S5.p2.13.m13.2.2.cmml">ğ²</mi><mo stretchy="false" id="S5.p2.13.m13.2.3.3.2.3" xref="S5.p2.13.m13.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.13.m13.2b"><apply id="S5.p2.13.m13.2.3.cmml" xref="S5.p2.13.m13.2.3"><times id="S5.p2.13.m13.2.3.1.cmml" xref="S5.p2.13.m13.2.3.1"></times><apply id="S5.p2.13.m13.2.3.2.cmml" xref="S5.p2.13.m13.2.3.2"><csymbol cd="ambiguous" id="S5.p2.13.m13.2.3.2.1.cmml" xref="S5.p2.13.m13.2.3.2">subscript</csymbol><ci id="S5.p2.13.m13.2.3.2.2.cmml" xref="S5.p2.13.m13.2.3.2.2">ğ‘</ci><ci id="S5.p2.13.m13.2.3.2.3a.cmml" xref="S5.p2.13.m13.2.3.2.3"><mtext mathsize="70%" id="S5.p2.13.m13.2.3.2.3.cmml" xref="S5.p2.13.m13.2.3.2.3">real</mtext></ci></apply><interval closure="open" id="S5.p2.13.m13.2.3.3.1.cmml" xref="S5.p2.13.m13.2.3.3.2"><ci id="S5.p2.13.m13.1.1.cmml" xref="S5.p2.13.m13.1.1">ğ±</ci><ci id="S5.p2.13.m13.2.2.cmml" xref="S5.p2.13.m13.2.2">ğ²</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.13.m13.2c">p_{\text{real}}(\mathbf{x},\mathbf{y})</annotation></semantics></math>, but maybe not as efficiently as sampling <span id="S5.p2.13.4" class="ltx_text ltx_font_italic">i.i.d.</span> samples directly from this ground-truth distribution.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.11" class="ltx_p"><span id="S5.p3.11.1" class="ltx_text ltx_font_bold">Scaling results with positive synthetic data from 7B SFT policy.</span> Previously, we scaled problems in <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p3.1.m1.1a"><msub id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1">subscript</csymbol><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> by querying GPT-4 and Gemini-1.5.
Now, for existing problems in <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p3.2.m2.1a"><msub id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1">subscript</csymbol><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>
we generate new responses by sampling from the <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p3.3.m3.1a"><msub id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">Ï€</mi><mi id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1">subscript</csymbol><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">ğœ‹</ci><ci id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> trained on problems+solutions in <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p3.4.m4.1a"><msub id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1">subscript</csymbol><ci id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2">ğ’Ÿ</ci><ci id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.
For any <math id="S5.p3.5.m5.2" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y})\in\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p3.5.m5.2a"><mrow id="S5.p3.5.m5.2.3" xref="S5.p3.5.m5.2.3.cmml"><mrow id="S5.p3.5.m5.2.3.2.2" xref="S5.p3.5.m5.2.3.2.1.cmml"><mo stretchy="false" id="S5.p3.5.m5.2.3.2.2.1" xref="S5.p3.5.m5.2.3.2.1.cmml">(</mo><mi id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml">ğ±</mi><mo id="S5.p3.5.m5.2.3.2.2.2" xref="S5.p3.5.m5.2.3.2.1.cmml">,</mo><mi id="S5.p3.5.m5.2.2" xref="S5.p3.5.m5.2.2.cmml">ğ²</mi><mo stretchy="false" id="S5.p3.5.m5.2.3.2.2.3" xref="S5.p3.5.m5.2.3.2.1.cmml">)</mo></mrow><mo id="S5.p3.5.m5.2.3.1" xref="S5.p3.5.m5.2.3.1.cmml">âˆˆ</mo><msub id="S5.p3.5.m5.2.3.3" xref="S5.p3.5.m5.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p3.5.m5.2.3.3.2" xref="S5.p3.5.m5.2.3.3.2.cmml">ğ’Ÿ</mi><mi id="S5.p3.5.m5.2.3.3.3" xref="S5.p3.5.m5.2.3.3.3.cmml">syn</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.2b"><apply id="S5.p3.5.m5.2.3.cmml" xref="S5.p3.5.m5.2.3"><in id="S5.p3.5.m5.2.3.1.cmml" xref="S5.p3.5.m5.2.3.1"></in><interval closure="open" id="S5.p3.5.m5.2.3.2.1.cmml" xref="S5.p3.5.m5.2.3.2.2"><ci id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1">ğ±</ci><ci id="S5.p3.5.m5.2.2.cmml" xref="S5.p3.5.m5.2.2">ğ²</ci></interval><apply id="S5.p3.5.m5.2.3.3.cmml" xref="S5.p3.5.m5.2.3.3"><csymbol cd="ambiguous" id="S5.p3.5.m5.2.3.3.1.cmml" xref="S5.p3.5.m5.2.3.3">subscript</csymbol><ci id="S5.p3.5.m5.2.3.3.2.cmml" xref="S5.p3.5.m5.2.3.3.2">ğ’Ÿ</ci><ci id="S5.p3.5.m5.2.3.3.3.cmml" xref="S5.p3.5.m5.2.3.3.3">syn</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.2c">(\mathbf{x},\mathbf{y})\in\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> we generate verified positive solution traces <math id="S5.p3.6.m6.1" class="ltx_Math" alttext="\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p3.6.m6.1a"><mrow id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml"><mover accent="true" id="S5.p3.6.m6.1.1.2" xref="S5.p3.6.m6.1.1.2.cmml"><mi id="S5.p3.6.m6.1.1.2.2" xref="S5.p3.6.m6.1.1.2.2.cmml">ğ²</mi><mo id="S5.p3.6.m6.1.1.2.1" xref="S5.p3.6.m6.1.1.2.1.cmml">^</mo></mover><mo id="S5.p3.6.m6.1.1.1" xref="S5.p3.6.m6.1.1.1.cmml">âˆ¼</mo><msub id="S5.p3.6.m6.1.1.3" xref="S5.p3.6.m6.1.1.3.cmml"><mi id="S5.p3.6.m6.1.1.3.2" xref="S5.p3.6.m6.1.1.3.2.cmml">Ï€</mi><mi id="S5.p3.6.m6.1.1.3.3" xref="S5.p3.6.m6.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b"><apply id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1"><csymbol cd="latexml" id="S5.p3.6.m6.1.1.1.cmml" xref="S5.p3.6.m6.1.1.1">similar-to</csymbol><apply id="S5.p3.6.m6.1.1.2.cmml" xref="S5.p3.6.m6.1.1.2"><ci id="S5.p3.6.m6.1.1.2.1.cmml" xref="S5.p3.6.m6.1.1.2.1">^</ci><ci id="S5.p3.6.m6.1.1.2.2.cmml" xref="S5.p3.6.m6.1.1.2.2">ğ²</ci></apply><apply id="S5.p3.6.m6.1.1.3.cmml" xref="S5.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.p3.6.m6.1.1.3.1.cmml" xref="S5.p3.6.m6.1.1.3">subscript</csymbol><ci id="S5.p3.6.m6.1.1.3.2.cmml" xref="S5.p3.6.m6.1.1.3.2">ğœ‹</ci><ci id="S5.p3.6.m6.1.1.3.3.cmml" xref="S5.p3.6.m6.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}</annotation></semantics></math> s.t. <math id="S5.p3.7.m7.2" class="ltx_Math" alttext="r(\hat{\mathbf{y}},\mathbf{y})=1" display="inline"><semantics id="S5.p3.7.m7.2a"><mrow id="S5.p3.7.m7.2.3" xref="S5.p3.7.m7.2.3.cmml"><mrow id="S5.p3.7.m7.2.3.2" xref="S5.p3.7.m7.2.3.2.cmml"><mi id="S5.p3.7.m7.2.3.2.2" xref="S5.p3.7.m7.2.3.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p3.7.m7.2.3.2.1" xref="S5.p3.7.m7.2.3.2.1.cmml">â€‹</mo><mrow id="S5.p3.7.m7.2.3.2.3.2" xref="S5.p3.7.m7.2.3.2.3.1.cmml"><mo stretchy="false" id="S5.p3.7.m7.2.3.2.3.2.1" xref="S5.p3.7.m7.2.3.2.3.1.cmml">(</mo><mover accent="true" id="S5.p3.7.m7.1.1" xref="S5.p3.7.m7.1.1.cmml"><mi id="S5.p3.7.m7.1.1.2" xref="S5.p3.7.m7.1.1.2.cmml">ğ²</mi><mo id="S5.p3.7.m7.1.1.1" xref="S5.p3.7.m7.1.1.1.cmml">^</mo></mover><mo id="S5.p3.7.m7.2.3.2.3.2.2" xref="S5.p3.7.m7.2.3.2.3.1.cmml">,</mo><mi id="S5.p3.7.m7.2.2" xref="S5.p3.7.m7.2.2.cmml">ğ²</mi><mo stretchy="false" id="S5.p3.7.m7.2.3.2.3.2.3" xref="S5.p3.7.m7.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.p3.7.m7.2.3.1" xref="S5.p3.7.m7.2.3.1.cmml">=</mo><mn id="S5.p3.7.m7.2.3.3" xref="S5.p3.7.m7.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.7.m7.2b"><apply id="S5.p3.7.m7.2.3.cmml" xref="S5.p3.7.m7.2.3"><eq id="S5.p3.7.m7.2.3.1.cmml" xref="S5.p3.7.m7.2.3.1"></eq><apply id="S5.p3.7.m7.2.3.2.cmml" xref="S5.p3.7.m7.2.3.2"><times id="S5.p3.7.m7.2.3.2.1.cmml" xref="S5.p3.7.m7.2.3.2.1"></times><ci id="S5.p3.7.m7.2.3.2.2.cmml" xref="S5.p3.7.m7.2.3.2.2">ğ‘Ÿ</ci><interval closure="open" id="S5.p3.7.m7.2.3.2.3.1.cmml" xref="S5.p3.7.m7.2.3.2.3.2"><apply id="S5.p3.7.m7.1.1.cmml" xref="S5.p3.7.m7.1.1"><ci id="S5.p3.7.m7.1.1.1.cmml" xref="S5.p3.7.m7.1.1.1">^</ci><ci id="S5.p3.7.m7.1.1.2.cmml" xref="S5.p3.7.m7.1.1.2">ğ²</ci></apply><ci id="S5.p3.7.m7.2.2.cmml" xref="S5.p3.7.m7.2.2">ğ²</ci></interval></apply><cn type="integer" id="S5.p3.7.m7.2.3.3.cmml" xref="S5.p3.7.m7.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.7.m7.2c">r(\hat{\mathbf{y}},\mathbf{y})=1</annotation></semantics></math>.
Following Â <cite class="ltx_cite ltx_citemacro_citet">Yuan etÂ al. [<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>, to ensure we sample enough correct responses, we sample <math id="S5.p3.8.m8.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.p3.8.m8.1a"><mn id="S5.p3.8.m8.1.1" xref="S5.p3.8.m8.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.p3.8.m8.1b"><cn type="integer" id="S5.p3.8.m8.1.1.cmml" xref="S5.p3.8.m8.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.8.m8.1c">100</annotation></semantics></math> times from <math id="S5.p3.9.m9.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p3.9.m9.1a"><msub id="S5.p3.9.m9.1.1" xref="S5.p3.9.m9.1.1.cmml"><mi id="S5.p3.9.m9.1.1.2" xref="S5.p3.9.m9.1.1.2.cmml">Ï€</mi><mi id="S5.p3.9.m9.1.1.3" xref="S5.p3.9.m9.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.9.m9.1b"><apply id="S5.p3.9.m9.1.1.cmml" xref="S5.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S5.p3.9.m9.1.1.1.cmml" xref="S5.p3.9.m9.1.1">subscript</csymbol><ci id="S5.p3.9.m9.1.1.2.cmml" xref="S5.p3.9.m9.1.1.2">ğœ‹</ci><ci id="S5.p3.9.m9.1.1.3.cmml" xref="S5.p3.9.m9.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.9.m9.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> and generate RFT datasets <math id="S5.p3.10.m10.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p3.10.m10.1a"><msubsup id="S5.p3.10.m10.1.1" xref="S5.p3.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p3.10.m10.1.1.2.2" xref="S5.p3.10.m10.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p3.10.m10.1.1.3" xref="S5.p3.10.m10.1.1.3.cmml"><mi id="S5.p3.10.m10.1.1.3.2" xref="S5.p3.10.m10.1.1.3.2.cmml">Ï€</mi><mi id="S5.p3.10.m10.1.1.3.3" xref="S5.p3.10.m10.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p3.10.m10.1.1.2.3" xref="S5.p3.10.m10.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p3.10.m10.1b"><apply id="S5.p3.10.m10.1.1.cmml" xref="S5.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S5.p3.10.m10.1.1.1.cmml" xref="S5.p3.10.m10.1.1">subscript</csymbol><apply id="S5.p3.10.m10.1.1.2.cmml" xref="S5.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S5.p3.10.m10.1.1.2.1.cmml" xref="S5.p3.10.m10.1.1">superscript</csymbol><ci id="S5.p3.10.m10.1.1.2.2.cmml" xref="S5.p3.10.m10.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p3.10.m10.1.1.2.3.cmml" xref="S5.p3.10.m10.1.1.2.3"></plus></apply><apply id="S5.p3.10.m10.1.1.3.cmml" xref="S5.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S5.p3.10.m10.1.1.3.1.cmml" xref="S5.p3.10.m10.1.1.3">subscript</csymbol><ci id="S5.p3.10.m10.1.1.3.2.cmml" xref="S5.p3.10.m10.1.1.3.2">ğœ‹</ci><ci id="S5.p3.10.m10.1.1.3.3.cmml" xref="S5.p3.10.m10.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.10.m10.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>, where each problem has atmost <math id="S5.p3.11.m11.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S5.p3.11.m11.1a"><mn id="S5.p3.11.m11.1.1" xref="S5.p3.11.m11.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S5.p3.11.m11.1b"><cn type="integer" id="S5.p3.11.m11.1.1.cmml" xref="S5.p3.11.m11.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.11.m11.1c">4</annotation></semantics></math> correct and diverse solutions.
Note that while the number of questions in the SFT and RFT dataset remain the same, the RFT dataset contains more positive solutions per question.
Since final answer verification is cheap, we are able to take advantage and have more self-generated solution traces in the RFT data mixture to improve coverage over responses. Note however that the number of synthetic problems and queries to highly capable models remain the same with both RFT and SFT.
For completeness, we also study the setting when exactly one self-generated response per problem is provided in the RFT mixture and compare it to running SFT on data from more capable models later in this section.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.3" class="ltx_p">We finetune the pretrained DeepSeek-Math-7B model on these new series of RFT datasets and plot the performance on GSM8K and MATH (FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b)). First, <span id="S5.p4.1.1" class="ltx_text ltx_font_bold" style="color:#3873B3;">we observe that for any size of <math id="S5.p4.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p4.1.1.m1.1a"><msub id="S5.p4.1.1.m1.1.1" xref="S5.p4.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#3873B3" id="S5.p4.1.1.m1.1.1.2" xref="S5.p4.1.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi mathcolor="#3873B3" id="S5.p4.1.1.m1.1.1.3" xref="S5.p4.1.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p4.1.1.m1.1b"><apply id="S5.p4.1.1.m1.1.1.cmml" xref="S5.p4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p4.1.1.m1.1.1.1.cmml" xref="S5.p4.1.1.m1.1.1">subscript</csymbol><ci id="S5.p4.1.1.m1.1.1.2.cmml" xref="S5.p4.1.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.p4.1.1.m1.1.1.3.cmml" xref="S5.p4.1.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, the performance of the RFT model is better than the corresponding SFT model</span>, and the difference remains consistent as we scale <math id="S5.p4.2.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p4.2.m1.1a"><msub id="S5.p4.2.m1.1.1" xref="S5.p4.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p4.2.m1.1.1.2" xref="S5.p4.2.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p4.2.m1.1.1.3" xref="S5.p4.2.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p4.2.m1.1b"><apply id="S5.p4.2.m1.1.1.cmml" xref="S5.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S5.p4.2.m1.1.1.1.cmml" xref="S5.p4.2.m1.1.1">subscript</csymbol><ci id="S5.p4.2.m1.1.1.2.cmml" xref="S5.p4.2.m1.1.1.2">ğ’Ÿ</ci><ci id="S5.p4.2.m1.1.1.3.cmml" xref="S5.p4.2.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.
Surprisingly, this indicates that training on multiple positive answer traces from the 7B <math id="S5.p4.3.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}(\mathbf{y}\mid\mathbf{x})" display="inline"><semantics id="S5.p4.3.m2.1a"><mrow id="S5.p4.3.m2.1.1" xref="S5.p4.3.m2.1.1.cmml"><msub id="S5.p4.3.m2.1.1.3" xref="S5.p4.3.m2.1.1.3.cmml"><mi id="S5.p4.3.m2.1.1.3.2" xref="S5.p4.3.m2.1.1.3.2.cmml">Ï€</mi><mi id="S5.p4.3.m2.1.1.3.3" xref="S5.p4.3.m2.1.1.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="S5.p4.3.m2.1.1.2" xref="S5.p4.3.m2.1.1.2.cmml">â€‹</mo><mrow id="S5.p4.3.m2.1.1.1.1" xref="S5.p4.3.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p4.3.m2.1.1.1.1.2" xref="S5.p4.3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S5.p4.3.m2.1.1.1.1.1" xref="S5.p4.3.m2.1.1.1.1.1.cmml"><mi id="S5.p4.3.m2.1.1.1.1.1.2" xref="S5.p4.3.m2.1.1.1.1.1.2.cmml">ğ²</mi><mo id="S5.p4.3.m2.1.1.1.1.1.1" xref="S5.p4.3.m2.1.1.1.1.1.1.cmml">âˆ£</mo><mi id="S5.p4.3.m2.1.1.1.1.1.3" xref="S5.p4.3.m2.1.1.1.1.1.3.cmml">ğ±</mi></mrow><mo stretchy="false" id="S5.p4.3.m2.1.1.1.1.3" xref="S5.p4.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.3.m2.1b"><apply id="S5.p4.3.m2.1.1.cmml" xref="S5.p4.3.m2.1.1"><times id="S5.p4.3.m2.1.1.2.cmml" xref="S5.p4.3.m2.1.1.2"></times><apply id="S5.p4.3.m2.1.1.3.cmml" xref="S5.p4.3.m2.1.1.3"><csymbol cd="ambiguous" id="S5.p4.3.m2.1.1.3.1.cmml" xref="S5.p4.3.m2.1.1.3">subscript</csymbol><ci id="S5.p4.3.m2.1.1.3.2.cmml" xref="S5.p4.3.m2.1.1.3.2">ğœ‹</ci><ci id="S5.p4.3.m2.1.1.3.3.cmml" xref="S5.p4.3.m2.1.1.3.3">sft</ci></apply><apply id="S5.p4.3.m2.1.1.1.1.1.cmml" xref="S5.p4.3.m2.1.1.1.1"><csymbol cd="latexml" id="S5.p4.3.m2.1.1.1.1.1.1.cmml" xref="S5.p4.3.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S5.p4.3.m2.1.1.1.1.1.2.cmml" xref="S5.p4.3.m2.1.1.1.1.1.2">ğ²</ci><ci id="S5.p4.3.m2.1.1.1.1.1.3.cmml" xref="S5.p4.3.m2.1.1.1.1.1.3">ğ±</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.3.m2.1c">\pi_{\mathrm{sft}}(\mathbf{y}\mid\mathbf{x})</annotation></semantics></math> can lead to better performing policies than training on a single trace from capable models.</p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.19" class="ltx_p"><span id="S5.p5.1.1" class="ltx_text ltx_font_bold">What is the value of positives from <math id="S5.p5.1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}(\mathbf{y}\mid\mathbf{x})" display="inline"><semantics id="S5.p5.1.1.m1.1a"><mrow id="S5.p5.1.1.m1.1.1" xref="S5.p5.1.1.m1.1.1.cmml"><msub id="S5.p5.1.1.m1.1.1.3" xref="S5.p5.1.1.m1.1.1.3.cmml"><mi id="S5.p5.1.1.m1.1.1.3.2" xref="S5.p5.1.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.1.1.m1.1.1.3.3" xref="S5.p5.1.1.m1.1.1.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="S5.p5.1.1.m1.1.1.2" xref="S5.p5.1.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S5.p5.1.1.m1.1.1.1.1" xref="S5.p5.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p5.1.1.m1.1.1.1.1.2" xref="S5.p5.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.p5.1.1.m1.1.1.1.1.1" xref="S5.p5.1.1.m1.1.1.1.1.1.cmml"><mi id="S5.p5.1.1.m1.1.1.1.1.1.2" xref="S5.p5.1.1.m1.1.1.1.1.1.2.cmml">ğ²</mi><mo id="S5.p5.1.1.m1.1.1.1.1.1.1" xref="S5.p5.1.1.m1.1.1.1.1.1.1.cmml">âˆ£</mo><mi id="S5.p5.1.1.m1.1.1.1.1.1.3" xref="S5.p5.1.1.m1.1.1.1.1.1.3.cmml">ğ±</mi></mrow><mo stretchy="false" id="S5.p5.1.1.m1.1.1.1.1.3" xref="S5.p5.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.1.1.m1.1b"><apply id="S5.p5.1.1.m1.1.1.cmml" xref="S5.p5.1.1.m1.1.1"><times id="S5.p5.1.1.m1.1.1.2.cmml" xref="S5.p5.1.1.m1.1.1.2"></times><apply id="S5.p5.1.1.m1.1.1.3.cmml" xref="S5.p5.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.p5.1.1.m1.1.1.3.1.cmml" xref="S5.p5.1.1.m1.1.1.3">subscript</csymbol><ci id="S5.p5.1.1.m1.1.1.3.2.cmml" xref="S5.p5.1.1.m1.1.1.3.2">ğœ‹</ci><ci id="S5.p5.1.1.m1.1.1.3.3.cmml" xref="S5.p5.1.1.m1.1.1.3.3">sft</ci></apply><apply id="S5.p5.1.1.m1.1.1.1.1.1.cmml" xref="S5.p5.1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.p5.1.1.m1.1.1.1.1.1.1.cmml" xref="S5.p5.1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.p5.1.1.m1.1.1.1.1.1.2.cmml" xref="S5.p5.1.1.m1.1.1.1.1.1.2">ğ²</ci><ci id="S5.p5.1.1.m1.1.1.1.1.1.3.cmml" xref="S5.p5.1.1.m1.1.1.1.1.1.3">ğ±</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.1.m1.1c">\pi_{\mathrm{sft}}(\mathbf{y}\mid\mathbf{x})</annotation></semantics></math> compared to positives from â€œoracleâ€ highly-capable models?</span>
If sampling from <math id="S5.p5.2.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p5.2.m1.1a"><msub id="S5.p5.2.m1.1.1" xref="S5.p5.2.m1.1.1.cmml"><mi id="S5.p5.2.m1.1.1.2" xref="S5.p5.2.m1.1.1.2.cmml">Ï€</mi><mi id="S5.p5.2.m1.1.1.3" xref="S5.p5.2.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.2.m1.1b"><apply id="S5.p5.2.m1.1.1.cmml" xref="S5.p5.2.m1.1.1"><csymbol cd="ambiguous" id="S5.p5.2.m1.1.1.1.cmml" xref="S5.p5.2.m1.1.1">subscript</csymbol><ci id="S5.p5.2.m1.1.1.2.cmml" xref="S5.p5.2.m1.1.1.2">ğœ‹</ci><ci id="S5.p5.2.m1.1.1.3.cmml" xref="S5.p5.2.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> also improves coverage and
performance, then should we scale problems and solutions in <math id="S5.p5.3.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.3.m2.1a"><msub id="S5.p5.3.m2.1.1" xref="S5.p5.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.3.m2.1.1.2" xref="S5.p5.3.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.3.m2.1.1.3" xref="S5.p5.3.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.3.m2.1b"><apply id="S5.p5.3.m2.1.1.cmml" xref="S5.p5.3.m2.1.1"><csymbol cd="ambiguous" id="S5.p5.3.m2.1.1.1.cmml" xref="S5.p5.3.m2.1.1">subscript</csymbol><ci id="S5.p5.3.m2.1.1.2.cmml" xref="S5.p5.3.m2.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.3.m2.1.1.3.cmml" xref="S5.p5.3.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.3.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, or just solutions in <math id="S5.p5.4.m3.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.4.m3.1a"><msubsup id="S5.p5.4.m3.1.1" xref="S5.p5.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.4.m3.1.1.2.2" xref="S5.p5.4.m3.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.4.m3.1.1.3" xref="S5.p5.4.m3.1.1.3.cmml"><mi id="S5.p5.4.m3.1.1.3.2" xref="S5.p5.4.m3.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.4.m3.1.1.3.3" xref="S5.p5.4.m3.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p5.4.m3.1.1.2.3" xref="S5.p5.4.m3.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.4.m3.1b"><apply id="S5.p5.4.m3.1.1.cmml" xref="S5.p5.4.m3.1.1"><csymbol cd="ambiguous" id="S5.p5.4.m3.1.1.1.cmml" xref="S5.p5.4.m3.1.1">subscript</csymbol><apply id="S5.p5.4.m3.1.1.2.cmml" xref="S5.p5.4.m3.1.1"><csymbol cd="ambiguous" id="S5.p5.4.m3.1.1.2.1.cmml" xref="S5.p5.4.m3.1.1">superscript</csymbol><ci id="S5.p5.4.m3.1.1.2.2.cmml" xref="S5.p5.4.m3.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.4.m3.1.1.2.3.cmml" xref="S5.p5.4.m3.1.1.2.3"></plus></apply><apply id="S5.p5.4.m3.1.1.3.cmml" xref="S5.p5.4.m3.1.1.3"><csymbol cd="ambiguous" id="S5.p5.4.m3.1.1.3.1.cmml" xref="S5.p5.4.m3.1.1.3">subscript</csymbol><ci id="S5.p5.4.m3.1.1.3.2.cmml" xref="S5.p5.4.m3.1.1.3.2">ğœ‹</ci><ci id="S5.p5.4.m3.1.1.3.3.cmml" xref="S5.p5.4.m3.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.4.m3.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>? To answer this, we need to assess the importance of the RFT dataset <math id="S5.p5.5.m4.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.5.m4.1a"><msubsup id="S5.p5.5.m4.1.1" xref="S5.p5.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.5.m4.1.1.2.2" xref="S5.p5.5.m4.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.5.m4.1.1.3" xref="S5.p5.5.m4.1.1.3.cmml"><mi id="S5.p5.5.m4.1.1.3.2" xref="S5.p5.5.m4.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.5.m4.1.1.3.3" xref="S5.p5.5.m4.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p5.5.m4.1.1.2.3" xref="S5.p5.5.m4.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.5.m4.1b"><apply id="S5.p5.5.m4.1.1.cmml" xref="S5.p5.5.m4.1.1"><csymbol cd="ambiguous" id="S5.p5.5.m4.1.1.1.cmml" xref="S5.p5.5.m4.1.1">subscript</csymbol><apply id="S5.p5.5.m4.1.1.2.cmml" xref="S5.p5.5.m4.1.1"><csymbol cd="ambiguous" id="S5.p5.5.m4.1.1.2.1.cmml" xref="S5.p5.5.m4.1.1">superscript</csymbol><ci id="S5.p5.5.m4.1.1.2.2.cmml" xref="S5.p5.5.m4.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.5.m4.1.1.2.3.cmml" xref="S5.p5.5.m4.1.1.2.3"></plus></apply><apply id="S5.p5.5.m4.1.1.3.cmml" xref="S5.p5.5.m4.1.1.3"><csymbol cd="ambiguous" id="S5.p5.5.m4.1.1.3.1.cmml" xref="S5.p5.5.m4.1.1.3">subscript</csymbol><ci id="S5.p5.5.m4.1.1.3.2.cmml" xref="S5.p5.5.m4.1.1.3.2">ğœ‹</ci><ci id="S5.p5.5.m4.1.1.3.3.cmml" xref="S5.p5.5.m4.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.5.m4.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> in terms of <math id="S5.p5.6.m5.1" class="ltx_Math" alttext="|\mathcal{D}_{\mathrm{syn}}|" display="inline"><semantics id="S5.p5.6.m5.1a"><mrow id="S5.p5.6.m5.1.1.1" xref="S5.p5.6.m5.1.1.2.cmml"><mo stretchy="false" id="S5.p5.6.m5.1.1.1.2" xref="S5.p5.6.m5.1.1.2.1.cmml">|</mo><msub id="S5.p5.6.m5.1.1.1.1" xref="S5.p5.6.m5.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.6.m5.1.1.1.1.2" xref="S5.p5.6.m5.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.6.m5.1.1.1.1.3" xref="S5.p5.6.m5.1.1.1.1.3.cmml">syn</mi></msub><mo stretchy="false" id="S5.p5.6.m5.1.1.1.3" xref="S5.p5.6.m5.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.6.m5.1b"><apply id="S5.p5.6.m5.1.1.2.cmml" xref="S5.p5.6.m5.1.1.1"><abs id="S5.p5.6.m5.1.1.2.1.cmml" xref="S5.p5.6.m5.1.1.1.2"></abs><apply id="S5.p5.6.m5.1.1.1.1.cmml" xref="S5.p5.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S5.p5.6.m5.1.1.1.1.1.cmml" xref="S5.p5.6.m5.1.1.1.1">subscript</csymbol><ci id="S5.p5.6.m5.1.1.1.1.2.cmml" xref="S5.p5.6.m5.1.1.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.6.m5.1.1.1.1.3.cmml" xref="S5.p5.6.m5.1.1.1.1.3">syn</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.6.m5.1c">|\mathcal{D}_{\mathrm{syn}}|</annotation></semantics></math>. We do this by training SFT policies on <math id="S5.p5.7.m6.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.7.m6.1a"><msub id="S5.p5.7.m6.1.1" xref="S5.p5.7.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.7.m6.1.1.2" xref="S5.p5.7.m6.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.7.m6.1.1.3" xref="S5.p5.7.m6.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.7.m6.1b"><apply id="S5.p5.7.m6.1.1.cmml" xref="S5.p5.7.m6.1.1"><csymbol cd="ambiguous" id="S5.p5.7.m6.1.1.1.cmml" xref="S5.p5.7.m6.1.1">subscript</csymbol><ci id="S5.p5.7.m6.1.1.2.cmml" xref="S5.p5.7.m6.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.7.m6.1.1.3.cmml" xref="S5.p5.7.m6.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.7.m6.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> of sizes 8k and 16k, and then generating RFT datasets from the corresponding SFT policies where we only add more correct solution traces (for the same problems). In particular, for <math id="S5.p5.8.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.8.m7.1a"><msub id="S5.p5.8.m7.1.1" xref="S5.p5.8.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.8.m7.1.1.2" xref="S5.p5.8.m7.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.8.m7.1.1.3" xref="S5.p5.8.m7.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.8.m7.1b"><apply id="S5.p5.8.m7.1.1.cmml" xref="S5.p5.8.m7.1.1"><csymbol cd="ambiguous" id="S5.p5.8.m7.1.1.1.cmml" xref="S5.p5.8.m7.1.1">subscript</csymbol><ci id="S5.p5.8.m7.1.1.2.cmml" xref="S5.p5.8.m7.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.8.m7.1.1.3.cmml" xref="S5.p5.8.m7.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.8.m7.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> with 8k and 16k questions, we scale the corresponding RFT datasets from 10k to 50k by adding positive solution traces from <math id="S5.p5.9.m8.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p5.9.m8.1a"><msub id="S5.p5.9.m8.1.1" xref="S5.p5.9.m8.1.1.cmml"><mi id="S5.p5.9.m8.1.1.2" xref="S5.p5.9.m8.1.1.2.cmml">Ï€</mi><mi id="S5.p5.9.m8.1.1.3" xref="S5.p5.9.m8.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.9.m8.1b"><apply id="S5.p5.9.m8.1.1.cmml" xref="S5.p5.9.m8.1.1"><csymbol cd="ambiguous" id="S5.p5.9.m8.1.1.1.cmml" xref="S5.p5.9.m8.1.1">subscript</csymbol><ci id="S5.p5.9.m8.1.1.2.cmml" xref="S5.p5.9.m8.1.1.2">ğœ‹</ci><ci id="S5.p5.9.m8.1.1.3.cmml" xref="S5.p5.9.m8.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.9.m8.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> models trained on respective <math id="S5.p5.10.m9.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.10.m9.1a"><msub id="S5.p5.10.m9.1.1" xref="S5.p5.10.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.10.m9.1.1.2" xref="S5.p5.10.m9.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.10.m9.1.1.3" xref="S5.p5.10.m9.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.10.m9.1b"><apply id="S5.p5.10.m9.1.1.cmml" xref="S5.p5.10.m9.1.1"><csymbol cd="ambiguous" id="S5.p5.10.m9.1.1.1.cmml" xref="S5.p5.10.m9.1.1">subscript</csymbol><ci id="S5.p5.10.m9.1.1.2.cmml" xref="S5.p5.10.m9.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.10.m9.1.1.3.cmml" xref="S5.p5.10.m9.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.10.m9.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> where the solutions are from more capable models. For the RFT datasets constructed this way, we are fixing the number of questions and only scaling solutions, unlike the RFT datasets in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b) where both questions and answers scale. In FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c) we plot the error rate of DeepSeek-Math-7B finetuned on the different sizes of <math id="S5.p5.11.m10.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.11.m10.1a"><msubsup id="S5.p5.11.m10.1.1" xref="S5.p5.11.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.11.m10.1.1.2.2" xref="S5.p5.11.m10.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.11.m10.1.1.3" xref="S5.p5.11.m10.1.1.3.cmml"><mi id="S5.p5.11.m10.1.1.3.2" xref="S5.p5.11.m10.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.11.m10.1.1.3.3" xref="S5.p5.11.m10.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p5.11.m10.1.1.2.3" xref="S5.p5.11.m10.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.11.m10.1b"><apply id="S5.p5.11.m10.1.1.cmml" xref="S5.p5.11.m10.1.1"><csymbol cd="ambiguous" id="S5.p5.11.m10.1.1.1.cmml" xref="S5.p5.11.m10.1.1">subscript</csymbol><apply id="S5.p5.11.m10.1.1.2.cmml" xref="S5.p5.11.m10.1.1"><csymbol cd="ambiguous" id="S5.p5.11.m10.1.1.2.1.cmml" xref="S5.p5.11.m10.1.1">superscript</csymbol><ci id="S5.p5.11.m10.1.1.2.2.cmml" xref="S5.p5.11.m10.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.11.m10.1.1.2.3.cmml" xref="S5.p5.11.m10.1.1.2.3"></plus></apply><apply id="S5.p5.11.m10.1.1.3.cmml" xref="S5.p5.11.m10.1.1.3"><csymbol cd="ambiguous" id="S5.p5.11.m10.1.1.3.1.cmml" xref="S5.p5.11.m10.1.1.3">subscript</csymbol><ci id="S5.p5.11.m10.1.1.3.2.cmml" xref="S5.p5.11.m10.1.1.3.2">ğœ‹</ci><ci id="S5.p5.11.m10.1.1.3.3.cmml" xref="S5.p5.11.m10.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.11.m10.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>.
Comparing the lowest values of the curves in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c) with <math id="S5.p5.12.m11.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.12.m11.1a"><msub id="S5.p5.12.m11.1.1" xref="S5.p5.12.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.12.m11.1.1.2" xref="S5.p5.12.m11.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p5.12.m11.1.1.3" xref="S5.p5.12.m11.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.12.m11.1b"><apply id="S5.p5.12.m11.1.1.cmml" xref="S5.p5.12.m11.1.1"><csymbol cd="ambiguous" id="S5.p5.12.m11.1.1.1.cmml" xref="S5.p5.12.m11.1.1">subscript</csymbol><ci id="S5.p5.12.m11.1.1.2.cmml" xref="S5.p5.12.m11.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.12.m11.1.1.3.cmml" xref="S5.p5.12.m11.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.12.m11.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> scaling in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b), we note that <span id="S5.p5.16.5" class="ltx_text ltx_font_bold" style="color:#3873B3;">performance from <math id="S5.p5.13.2.m1.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.13.2.m1.1a"><msubsup id="S5.p5.13.2.m1.1.1" xref="S5.p5.13.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#3873B3" id="S5.p5.13.2.m1.1.1.2.2" xref="S5.p5.13.2.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.13.2.m1.1.1.3" xref="S5.p5.13.2.m1.1.1.3.cmml"><mi mathcolor="#3873B3" id="S5.p5.13.2.m1.1.1.3.2" xref="S5.p5.13.2.m1.1.1.3.2.cmml">Ï€</mi><mi mathcolor="#3873B3" id="S5.p5.13.2.m1.1.1.3.3" xref="S5.p5.13.2.m1.1.1.3.3.cmml">sft</mi></msub><mo mathcolor="#3873B3" id="S5.p5.13.2.m1.1.1.2.3" xref="S5.p5.13.2.m1.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.13.2.m1.1b"><apply id="S5.p5.13.2.m1.1.1.cmml" xref="S5.p5.13.2.m1.1.1"><csymbol cd="ambiguous" id="S5.p5.13.2.m1.1.1.1.cmml" xref="S5.p5.13.2.m1.1.1">subscript</csymbol><apply id="S5.p5.13.2.m1.1.1.2.cmml" xref="S5.p5.13.2.m1.1.1"><csymbol cd="ambiguous" id="S5.p5.13.2.m1.1.1.2.1.cmml" xref="S5.p5.13.2.m1.1.1">superscript</csymbol><ci id="S5.p5.13.2.m1.1.1.2.2.cmml" xref="S5.p5.13.2.m1.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.13.2.m1.1.1.2.3.cmml" xref="S5.p5.13.2.m1.1.1.2.3"></plus></apply><apply id="S5.p5.13.2.m1.1.1.3.cmml" xref="S5.p5.13.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.p5.13.2.m1.1.1.3.1.cmml" xref="S5.p5.13.2.m1.1.1.3">subscript</csymbol><ci id="S5.p5.13.2.m1.1.1.3.2.cmml" xref="S5.p5.13.2.m1.1.1.3.2">ğœ‹</ci><ci id="S5.p5.13.2.m1.1.1.3.3.cmml" xref="S5.p5.13.2.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.13.2.m1.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> is <math id="S5.p5.14.3.m2.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.p5.14.3.m2.1a"><mrow id="S5.p5.14.3.m2.1b"><mn mathcolor="#3873B3" id="S5.p5.14.3.m2.1.1">2</mn><mo lspace="0.222em" mathcolor="#3873B3" id="S5.p5.14.3.m2.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S5.p5.14.3.m2.1c">2\times</annotation></semantics></math> the size of <math id="S5.p5.15.4.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p5.15.4.m3.1a"><msub id="S5.p5.15.4.m3.1.1" xref="S5.p5.15.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#3873B3" id="S5.p5.15.4.m3.1.1.2" xref="S5.p5.15.4.m3.1.1.2.cmml">ğ’Ÿ</mi><mi mathcolor="#3873B3" id="S5.p5.15.4.m3.1.1.3" xref="S5.p5.15.4.m3.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.15.4.m3.1b"><apply id="S5.p5.15.4.m3.1.1.cmml" xref="S5.p5.15.4.m3.1.1"><csymbol cd="ambiguous" id="S5.p5.15.4.m3.1.1.1.cmml" xref="S5.p5.15.4.m3.1.1">subscript</csymbol><ci id="S5.p5.15.4.m3.1.1.2.cmml" xref="S5.p5.15.4.m3.1.1.2">ğ’Ÿ</ci><ci id="S5.p5.15.4.m3.1.1.3.cmml" xref="S5.p5.15.4.m3.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.15.4.m3.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> used to train <math id="S5.p5.16.5.m4.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p5.16.5.m4.1a"><msub id="S5.p5.16.5.m4.1.1" xref="S5.p5.16.5.m4.1.1.cmml"><mi mathcolor="#3873B3" id="S5.p5.16.5.m4.1.1.2" xref="S5.p5.16.5.m4.1.1.2.cmml">Ï€</mi><mi mathcolor="#3873B3" id="S5.p5.16.5.m4.1.1.3" xref="S5.p5.16.5.m4.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.16.5.m4.1b"><apply id="S5.p5.16.5.m4.1.1.cmml" xref="S5.p5.16.5.m4.1.1"><csymbol cd="ambiguous" id="S5.p5.16.5.m4.1.1.1.cmml" xref="S5.p5.16.5.m4.1.1">subscript</csymbol><ci id="S5.p5.16.5.m4.1.1.2.cmml" xref="S5.p5.16.5.m4.1.1.2">ğœ‹</ci><ci id="S5.p5.16.5.m4.1.1.3.cmml" xref="S5.p5.16.5.m4.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.16.5.m4.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>.</span>
We also note that performance can plateau (or worsen in the case of GSM8K) as we scale up <math id="S5.p5.17.m12.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.17.m12.1a"><msubsup id="S5.p5.17.m12.1.1" xref="S5.p5.17.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.17.m12.1.1.2.2" xref="S5.p5.17.m12.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.17.m12.1.1.3" xref="S5.p5.17.m12.1.1.3.cmml"><mi id="S5.p5.17.m12.1.1.3.2" xref="S5.p5.17.m12.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.17.m12.1.1.3.3" xref="S5.p5.17.m12.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p5.17.m12.1.1.2.3" xref="S5.p5.17.m12.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.17.m12.1b"><apply id="S5.p5.17.m12.1.1.cmml" xref="S5.p5.17.m12.1.1"><csymbol cd="ambiguous" id="S5.p5.17.m12.1.1.1.cmml" xref="S5.p5.17.m12.1.1">subscript</csymbol><apply id="S5.p5.17.m12.1.1.2.cmml" xref="S5.p5.17.m12.1.1"><csymbol cd="ambiguous" id="S5.p5.17.m12.1.1.2.1.cmml" xref="S5.p5.17.m12.1.1">superscript</csymbol><ci id="S5.p5.17.m12.1.1.2.2.cmml" xref="S5.p5.17.m12.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.17.m12.1.1.2.3.cmml" xref="S5.p5.17.m12.1.1.2.3"></plus></apply><apply id="S5.p5.17.m12.1.1.3.cmml" xref="S5.p5.17.m12.1.1.3"><csymbol cd="ambiguous" id="S5.p5.17.m12.1.1.3.1.cmml" xref="S5.p5.17.m12.1.1.3">subscript</csymbol><ci id="S5.p5.17.m12.1.1.3.2.cmml" xref="S5.p5.17.m12.1.1.3.2">ğœ‹</ci><ci id="S5.p5.17.m12.1.1.3.3.cmml" xref="S5.p5.17.m12.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.17.m12.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> by a lot.
This is because <math id="S5.p5.18.m13.2" class="ltx_Math" alttext="r(\cdot,\mathbf{y})" display="inline"><semantics id="S5.p5.18.m13.2a"><mrow id="S5.p5.18.m13.2.3" xref="S5.p5.18.m13.2.3.cmml"><mi id="S5.p5.18.m13.2.3.2" xref="S5.p5.18.m13.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p5.18.m13.2.3.1" xref="S5.p5.18.m13.2.3.1.cmml">â€‹</mo><mrow id="S5.p5.18.m13.2.3.3.2" xref="S5.p5.18.m13.2.3.3.1.cmml"><mo stretchy="false" id="S5.p5.18.m13.2.3.3.2.1" xref="S5.p5.18.m13.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.p5.18.m13.1.1" xref="S5.p5.18.m13.1.1.cmml">â‹…</mo><mo id="S5.p5.18.m13.2.3.3.2.2" xref="S5.p5.18.m13.2.3.3.1.cmml">,</mo><mi id="S5.p5.18.m13.2.2" xref="S5.p5.18.m13.2.2.cmml">ğ²</mi><mo stretchy="false" id="S5.p5.18.m13.2.3.3.2.3" xref="S5.p5.18.m13.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.18.m13.2b"><apply id="S5.p5.18.m13.2.3.cmml" xref="S5.p5.18.m13.2.3"><times id="S5.p5.18.m13.2.3.1.cmml" xref="S5.p5.18.m13.2.3.1"></times><ci id="S5.p5.18.m13.2.3.2.cmml" xref="S5.p5.18.m13.2.3.2">ğ‘Ÿ</ci><interval closure="open" id="S5.p5.18.m13.2.3.3.1.cmml" xref="S5.p5.18.m13.2.3.3.2"><ci id="S5.p5.18.m13.1.1.cmml" xref="S5.p5.18.m13.1.1">â‹…</ci><ci id="S5.p5.18.m13.2.2.cmml" xref="S5.p5.18.m13.2.2">ğ²</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.18.m13.2c">r(\cdot,\mathbf{y})</annotation></semantics></math> is unable to verify the correctness of each step a solution trace in <math id="S5.p5.19.m14.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p5.19.m14.1a"><msubsup id="S5.p5.19.m14.1.1" xref="S5.p5.19.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p5.19.m14.1.1.2.2" xref="S5.p5.19.m14.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p5.19.m14.1.1.3" xref="S5.p5.19.m14.1.1.3.cmml"><mi id="S5.p5.19.m14.1.1.3.2" xref="S5.p5.19.m14.1.1.3.2.cmml">Ï€</mi><mi id="S5.p5.19.m14.1.1.3.3" xref="S5.p5.19.m14.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p5.19.m14.1.1.2.3" xref="S5.p5.19.m14.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p5.19.m14.1b"><apply id="S5.p5.19.m14.1.1.cmml" xref="S5.p5.19.m14.1.1"><csymbol cd="ambiguous" id="S5.p5.19.m14.1.1.1.cmml" xref="S5.p5.19.m14.1.1">subscript</csymbol><apply id="S5.p5.19.m14.1.1.2.cmml" xref="S5.p5.19.m14.1.1"><csymbol cd="ambiguous" id="S5.p5.19.m14.1.1.2.1.cmml" xref="S5.p5.19.m14.1.1">superscript</csymbol><ci id="S5.p5.19.m14.1.1.2.2.cmml" xref="S5.p5.19.m14.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p5.19.m14.1.1.2.3.cmml" xref="S5.p5.19.m14.1.1.2.3"></plus></apply><apply id="S5.p5.19.m14.1.1.3.cmml" xref="S5.p5.19.m14.1.1.3"><csymbol cd="ambiguous" id="S5.p5.19.m14.1.1.3.1.cmml" xref="S5.p5.19.m14.1.1.3">subscript</csymbol><ci id="S5.p5.19.m14.1.1.3.2.cmml" xref="S5.p5.19.m14.1.1.3.2">ğœ‹</ci><ci id="S5.p5.19.m14.1.1.3.3.cmml" xref="S5.p5.19.m14.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.19.m14.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>. We will show how these incorrect steps can induce spurious correlations that get amplified with further training, explaining this drop.</p>
</div>
<figure id="S5.F3" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x6.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="341" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.4.2.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.2.1" class="ltx_text" style="font-size:80%;">Under base LLM, RFT data sampled from <math id="S5.F3.2.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.F3.2.1.m1.1b"><msub id="S5.F3.2.1.m1.1.1" xref="S5.F3.2.1.m1.1.1.cmml"><mi id="S5.F3.2.1.m1.1.1.2" xref="S5.F3.2.1.m1.1.1.2.cmml">Ï€</mi><mi id="S5.F3.2.1.m1.1.1.3" xref="S5.F3.2.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F3.2.1.m1.1c"><apply id="S5.F3.2.1.m1.1.1.cmml" xref="S5.F3.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F3.2.1.m1.1.1.1.cmml" xref="S5.F3.2.1.m1.1.1">subscript</csymbol><ci id="S5.F3.2.1.m1.1.1.2.cmml" xref="S5.F3.2.1.m1.1.1.2">ğœ‹</ci><ci id="S5.F3.2.1.m1.1.1.3.cmml" xref="S5.F3.2.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.2.1.m1.1d">\pi_{\mathrm{sft}}</annotation></semantics></math>, has higher likelihood than SFT data.</span></figcaption>
</figure>
<div id="S5.p6" class="ltx_para ltx_noindent">
<p id="S5.p6.5" class="ltx_p"><span id="S5.p6.5.1" class="ltx_text ltx_font_bold">Why is self-generated positive data more sample-efficient?</span>
From our result above, we find that solutions sampled from <math id="S5.p6.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p6.1.m1.1a"><msub id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml"><mi id="S5.p6.1.m1.1.1.2" xref="S5.p6.1.m1.1.1.2.cmml">Ï€</mi><mi id="S5.p6.1.m1.1.1.3" xref="S5.p6.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b"><apply id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p6.1.m1.1.1.1.cmml" xref="S5.p6.1.m1.1.1">subscript</csymbol><ci id="S5.p6.1.m1.1.1.2.cmml" xref="S5.p6.1.m1.1.1.2">ğœ‹</ci><ci id="S5.p6.1.m1.1.1.3.cmml" xref="S5.p6.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> (trained on <math id="S5.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p6.2.m2.1a"><msub id="S5.p6.2.m2.1.1" xref="S5.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p6.2.m2.1.1.2" xref="S5.p6.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p6.2.m2.1.1.3" xref="S5.p6.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.2.m2.1b"><apply id="S5.p6.2.m2.1.1.cmml" xref="S5.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p6.2.m2.1.1.1.cmml" xref="S5.p6.2.m2.1.1">subscript</csymbol><ci id="S5.p6.2.m2.1.1.2.cmml" xref="S5.p6.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S5.p6.2.m2.1.1.3.cmml" xref="S5.p6.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.2.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>) yield better models, as good as those trained on <math id="S5.p6.3.m3.1" class="ltx_Math" alttext="2\times|\mathcal{D}_{\mathrm{syn}}|" display="inline"><semantics id="S5.p6.3.m3.1a"><mrow id="S5.p6.3.m3.1.1" xref="S5.p6.3.m3.1.1.cmml"><mn id="S5.p6.3.m3.1.1.3" xref="S5.p6.3.m3.1.1.3.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p6.3.m3.1.1.2" xref="S5.p6.3.m3.1.1.2.cmml">Ã—</mo><mrow id="S5.p6.3.m3.1.1.1.1" xref="S5.p6.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S5.p6.3.m3.1.1.1.1.2" xref="S5.p6.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S5.p6.3.m3.1.1.1.1.1" xref="S5.p6.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p6.3.m3.1.1.1.1.1.2" xref="S5.p6.3.m3.1.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p6.3.m3.1.1.1.1.1.3" xref="S5.p6.3.m3.1.1.1.1.1.3.cmml">syn</mi></msub><mo stretchy="false" id="S5.p6.3.m3.1.1.1.1.3" xref="S5.p6.3.m3.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.3.m3.1b"><apply id="S5.p6.3.m3.1.1.cmml" xref="S5.p6.3.m3.1.1"><times id="S5.p6.3.m3.1.1.2.cmml" xref="S5.p6.3.m3.1.1.2"></times><cn type="integer" id="S5.p6.3.m3.1.1.3.cmml" xref="S5.p6.3.m3.1.1.3">2</cn><apply id="S5.p6.3.m3.1.1.1.2.cmml" xref="S5.p6.3.m3.1.1.1.1"><abs id="S5.p6.3.m3.1.1.1.2.1.cmml" xref="S5.p6.3.m3.1.1.1.1.2"></abs><apply id="S5.p6.3.m3.1.1.1.1.1.cmml" xref="S5.p6.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p6.3.m3.1.1.1.1.1.1.cmml" xref="S5.p6.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S5.p6.3.m3.1.1.1.1.1.2.cmml" xref="S5.p6.3.m3.1.1.1.1.1.2">ğ’Ÿ</ci><ci id="S5.p6.3.m3.1.1.1.1.1.3.cmml" xref="S5.p6.3.m3.1.1.1.1.1.3">syn</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.3.m3.1c">2\times|\mathcal{D}_{\mathrm{syn}}|</annotation></semantics></math> problems.
This finding is surprising since one might expect more capable GPT-4/Gemini models to present better solutions (especially on problems generated from the same models), training on which should lead to good performance, akin to distillationÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, but this is not the case.
Our results are consistent with the study of memorization in
LLMsÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, which shows that pretrained (base) LLMs tend to memorize â€œhard-to-fitâ€ and â€œout-of-pretraining-distributionâ€ responses during finetuning, resulting in imperfect generalization.
In contrast, correct response traces produced by <math id="S5.p6.4.m4.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p6.4.m4.1a"><msub id="S5.p6.4.m4.1.1" xref="S5.p6.4.m4.1.1.cmml"><mi id="S5.p6.4.m4.1.1.2" xref="S5.p6.4.m4.1.1.2.cmml">Ï€</mi><mi id="S5.p6.4.m4.1.1.3" xref="S5.p6.4.m4.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.4.m4.1b"><apply id="S5.p6.4.m4.1.1.cmml" xref="S5.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p6.4.m4.1.1.1.cmml" xref="S5.p6.4.m4.1.1">subscript</csymbol><ci id="S5.p6.4.m4.1.1.2.cmml" xref="S5.p6.4.m4.1.1.2">ğœ‹</ci><ci id="S5.p6.4.m4.1.1.3.cmml" xref="S5.p6.4.m4.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.4.m4.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> on problems from <math id="S5.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p6.5.m5.1a"><msub id="S5.p6.5.m5.1.1" xref="S5.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p6.5.m5.1.1.2" xref="S5.p6.5.m5.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p6.5.m5.1.1.3" xref="S5.p6.5.m5.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.5.m5.1b"><apply id="S5.p6.5.m5.1.1.cmml" xref="S5.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p6.5.m5.1.1.1.cmml" xref="S5.p6.5.m5.1.1">subscript</csymbol><ci id="S5.p6.5.m5.1.1.2.cmml" xref="S5.p6.5.m5.1.1.2">ğ’Ÿ</ci><ci id="S5.p6.5.m5.1.1.3.cmml" xref="S5.p6.5.m5.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.5.m5.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> are not as hard-to-fit or as out-of-distribution, since they are obtained from a model that is â€œcloseâ€ to the base LLM. We confirm this hypothesis
with a histogram of negative log-likelihood values of the SFT and RFT data under the base LLM (FigureÂ <a href="#S5.F3" title="Figure 3 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
Hence, we expect STaR/RFT to alleviate the memorization problem on a large chunk of examples.
This finding also corroborates <cite class="ltx_cite ltx_citemacro_citet">Yuan etÂ al. [<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>â€™s result that lower the perplexity of SFT data under the base model, the smaller the gap between SFT and RFT performance.</p>
</div>
<figure id="S5.F4" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x7.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="339" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.4.2" class="ltx_text" style="font-size:80%;">RFT data with a single (self-generated) correct solution per problem outperforms SFT data (from highly-capable models) of the same size.
</span></figcaption>
</figure>
<div id="S5.p7" class="ltx_para ltx_noindent">
<p id="S5.p7.11" class="ltx_p">Note that one may also attribute better performance of RFT to improved coverage from multiple responses in <math id="S5.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p7.1.m1.1a"><msubsup id="S5.p7.1.m1.1.1" xref="S5.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.1.m1.1.1.2.2" xref="S5.p7.1.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p7.1.m1.1.1.3" xref="S5.p7.1.m1.1.1.3.cmml"><mi id="S5.p7.1.m1.1.1.3.2" xref="S5.p7.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S5.p7.1.m1.1.1.3.3" xref="S5.p7.1.m1.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p7.1.m1.1.1.2.3" xref="S5.p7.1.m1.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p7.1.m1.1b"><apply id="S5.p7.1.m1.1.1.cmml" xref="S5.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p7.1.m1.1.1.1.cmml" xref="S5.p7.1.m1.1.1">subscript</csymbol><apply id="S5.p7.1.m1.1.1.2.cmml" xref="S5.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p7.1.m1.1.1.2.1.cmml" xref="S5.p7.1.m1.1.1">superscript</csymbol><ci id="S5.p7.1.m1.1.1.2.2.cmml" xref="S5.p7.1.m1.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p7.1.m1.1.1.2.3.cmml" xref="S5.p7.1.m1.1.1.2.3"></plus></apply><apply id="S5.p7.1.m1.1.1.3.cmml" xref="S5.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.p7.1.m1.1.1.3.1.cmml" xref="S5.p7.1.m1.1.1.3">subscript</csymbol><ci id="S5.p7.1.m1.1.1.3.2.cmml" xref="S5.p7.1.m1.1.1.3.2">ğœ‹</ci><ci id="S5.p7.1.m1.1.1.3.3.cmml" xref="S5.p7.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.1.m1.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> for each question in <math id="S5.p7.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p7.2.m2.1a"><msub id="S5.p7.2.m2.1.1" xref="S5.p7.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.2.m2.1.1.2" xref="S5.p7.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p7.2.m2.1.1.3" xref="S5.p7.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.2.m2.1b"><apply id="S5.p7.2.m2.1.1.cmml" xref="S5.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p7.2.m2.1.1.1.cmml" xref="S5.p7.2.m2.1.1">subscript</csymbol><ci id="S5.p7.2.m2.1.1.2.cmml" xref="S5.p7.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S5.p7.2.m2.1.1.3.cmml" xref="S5.p7.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.2.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. We find that even when RFT data is restricted to one solution per question, base LLMs finetuned on it outperform SFT consistently by <math id="S5.p7.3.m3.1" class="ltx_Math" alttext="&gt;1\%" display="inline"><semantics id="S5.p7.3.m3.1a"><mrow id="S5.p7.3.m3.1.1" xref="S5.p7.3.m3.1.1.cmml"><mi id="S5.p7.3.m3.1.1.2" xref="S5.p7.3.m3.1.1.2.cmml"></mi><mo id="S5.p7.3.m3.1.1.1" xref="S5.p7.3.m3.1.1.1.cmml">&gt;</mo><mrow id="S5.p7.3.m3.1.1.3" xref="S5.p7.3.m3.1.1.3.cmml"><mn id="S5.p7.3.m3.1.1.3.2" xref="S5.p7.3.m3.1.1.3.2.cmml">1</mn><mo id="S5.p7.3.m3.1.1.3.1" xref="S5.p7.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.3.m3.1b"><apply id="S5.p7.3.m3.1.1.cmml" xref="S5.p7.3.m3.1.1"><gt id="S5.p7.3.m3.1.1.1.cmml" xref="S5.p7.3.m3.1.1.1"></gt><csymbol cd="latexml" id="S5.p7.3.m3.1.1.2.cmml" xref="S5.p7.3.m3.1.1.2">absent</csymbol><apply id="S5.p7.3.m3.1.1.3.cmml" xref="S5.p7.3.m3.1.1.3"><csymbol cd="latexml" id="S5.p7.3.m3.1.1.3.1.cmml" xref="S5.p7.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S5.p7.3.m3.1.1.3.2.cmml" xref="S5.p7.3.m3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.3.m3.1c">&gt;1\%</annotation></semantics></math>.
In FigureÂ <a href="#S5.F4" title="Figure 4 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we plot the performance of DeepSeek-Math-7B finetuned on SFT data <math id="S5.p7.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p7.4.m4.1a"><msub id="S5.p7.4.m4.1.1" xref="S5.p7.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.4.m4.1.1.2" xref="S5.p7.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p7.4.m4.1.1.3" xref="S5.p7.4.m4.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.4.m4.1b"><apply id="S5.p7.4.m4.1.1.cmml" xref="S5.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p7.4.m4.1.1.1.cmml" xref="S5.p7.4.m4.1.1">subscript</csymbol><ci id="S5.p7.4.m4.1.1.2.cmml" xref="S5.p7.4.m4.1.1.2">ğ’Ÿ</ci><ci id="S5.p7.4.m4.1.1.3.cmml" xref="S5.p7.4.m4.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.4.m4.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> and RFT data <math id="S5.p7.5.m5.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p7.5.m5.1a"><msubsup id="S5.p7.5.m5.1.1" xref="S5.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.5.m5.1.1.2.2" xref="S5.p7.5.m5.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p7.5.m5.1.1.3" xref="S5.p7.5.m5.1.1.3.cmml"><mi id="S5.p7.5.m5.1.1.3.2" xref="S5.p7.5.m5.1.1.3.2.cmml">Ï€</mi><mi id="S5.p7.5.m5.1.1.3.3" xref="S5.p7.5.m5.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p7.5.m5.1.1.2.3" xref="S5.p7.5.m5.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p7.5.m5.1b"><apply id="S5.p7.5.m5.1.1.cmml" xref="S5.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p7.5.m5.1.1.1.cmml" xref="S5.p7.5.m5.1.1">subscript</csymbol><apply id="S5.p7.5.m5.1.1.2.cmml" xref="S5.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p7.5.m5.1.1.2.1.cmml" xref="S5.p7.5.m5.1.1">superscript</csymbol><ci id="S5.p7.5.m5.1.1.2.2.cmml" xref="S5.p7.5.m5.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p7.5.m5.1.1.2.3.cmml" xref="S5.p7.5.m5.1.1.2.3"></plus></apply><apply id="S5.p7.5.m5.1.1.3.cmml" xref="S5.p7.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.p7.5.m5.1.1.3.1.cmml" xref="S5.p7.5.m5.1.1.3">subscript</csymbol><ci id="S5.p7.5.m5.1.1.3.2.cmml" xref="S5.p7.5.m5.1.1.3.2">ğœ‹</ci><ci id="S5.p7.5.m5.1.1.3.3.cmml" xref="S5.p7.5.m5.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.5.m5.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> where <math id="S5.p7.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.p7.6.m6.1a"><msubsup id="S5.p7.6.m6.1.1" xref="S5.p7.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.6.m6.1.1.2.2" xref="S5.p7.6.m6.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.p7.6.m6.1.1.3" xref="S5.p7.6.m6.1.1.3.cmml"><mi id="S5.p7.6.m6.1.1.3.2" xref="S5.p7.6.m6.1.1.3.2.cmml">Ï€</mi><mi id="S5.p7.6.m6.1.1.3.3" xref="S5.p7.6.m6.1.1.3.3.cmml">sft</mi></msub><mo id="S5.p7.6.m6.1.1.2.3" xref="S5.p7.6.m6.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.p7.6.m6.1b"><apply id="S5.p7.6.m6.1.1.cmml" xref="S5.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S5.p7.6.m6.1.1.1.cmml" xref="S5.p7.6.m6.1.1">subscript</csymbol><apply id="S5.p7.6.m6.1.1.2.cmml" xref="S5.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S5.p7.6.m6.1.1.2.1.cmml" xref="S5.p7.6.m6.1.1">superscript</csymbol><ci id="S5.p7.6.m6.1.1.2.2.cmml" xref="S5.p7.6.m6.1.1.2.2">ğ’Ÿ</ci><plus id="S5.p7.6.m6.1.1.2.3.cmml" xref="S5.p7.6.m6.1.1.2.3"></plus></apply><apply id="S5.p7.6.m6.1.1.3.cmml" xref="S5.p7.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.p7.6.m6.1.1.3.1.cmml" xref="S5.p7.6.m6.1.1.3">subscript</csymbol><ci id="S5.p7.6.m6.1.1.3.2.cmml" xref="S5.p7.6.m6.1.1.3.2">ğœ‹</ci><ci id="S5.p7.6.m6.1.1.3.3.cmml" xref="S5.p7.6.m6.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.6.m6.1c">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> has the same questions as <math id="S5.p7.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p7.7.m7.1a"><msub id="S5.p7.7.m7.1.1" xref="S5.p7.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.7.m7.1.1.2" xref="S5.p7.7.m7.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p7.7.m7.1.1.3" xref="S5.p7.7.m7.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.7.m7.1b"><apply id="S5.p7.7.m7.1.1.cmml" xref="S5.p7.7.m7.1.1"><csymbol cd="ambiguous" id="S5.p7.7.m7.1.1.1.cmml" xref="S5.p7.7.m7.1.1">subscript</csymbol><ci id="S5.p7.7.m7.1.1.2.cmml" xref="S5.p7.7.m7.1.1.2">ğ’Ÿ</ci><ci id="S5.p7.7.m7.1.1.3.cmml" xref="S5.p7.7.m7.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.7.m7.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, and only one positive solution per question, sampled from <math id="S5.p7.8.m8.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p7.8.m8.1a"><msub id="S5.p7.8.m8.1.1" xref="S5.p7.8.m8.1.1.cmml"><mi id="S5.p7.8.m8.1.1.2" xref="S5.p7.8.m8.1.1.2.cmml">Ï€</mi><mi id="S5.p7.8.m8.1.1.3" xref="S5.p7.8.m8.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.8.m8.1b"><apply id="S5.p7.8.m8.1.1.cmml" xref="S5.p7.8.m8.1.1"><csymbol cd="ambiguous" id="S5.p7.8.m8.1.1.1.cmml" xref="S5.p7.8.m8.1.1">subscript</csymbol><ci id="S5.p7.8.m8.1.1.2.cmml" xref="S5.p7.8.m8.1.1.2">ğœ‹</ci><ci id="S5.p7.8.m8.1.1.3.cmml" xref="S5.p7.8.m8.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.8.m8.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> finetuned on <math id="S5.p7.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p7.9.m9.1a"><msub id="S5.p7.9.m9.1.1" xref="S5.p7.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p7.9.m9.1.1.2" xref="S5.p7.9.m9.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p7.9.m9.1.1.3" xref="S5.p7.9.m9.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.9.m9.1b"><apply id="S5.p7.9.m9.1.1.cmml" xref="S5.p7.9.m9.1.1"><csymbol cd="ambiguous" id="S5.p7.9.m9.1.1.1.cmml" xref="S5.p7.9.m9.1.1">subscript</csymbol><ci id="S5.p7.9.m9.1.1.2.cmml" xref="S5.p7.9.m9.1.1.2">ğ’Ÿ</ci><ci id="S5.p7.9.m9.1.1.3.cmml" xref="S5.p7.9.m9.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.9.m9.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. Thus, both SFT and RFT datasets are of the same size.
This means that a significant portion of the <math id="S5.p7.10.m10.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.p7.10.m10.1a"><mrow id="S5.p7.10.m10.1b"><mn id="S5.p7.10.m10.1.1">2</mn><mo lspace="0.222em" id="S5.p7.10.m10.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S5.p7.10.m10.1c">2\times</annotation></semantics></math> sample efficiency gains we observe for RFT in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b) can be attributed to RFT data from <math id="S5.p7.11.m11.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p7.11.m11.1a"><msub id="S5.p7.11.m11.1.1" xref="S5.p7.11.m11.1.1.cmml"><mi id="S5.p7.11.m11.1.1.2" xref="S5.p7.11.m11.1.1.2.cmml">Ï€</mi><mi id="S5.p7.11.m11.1.1.3" xref="S5.p7.11.m11.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p7.11.m11.1b"><apply id="S5.p7.11.m11.1.1.cmml" xref="S5.p7.11.m11.1.1"><csymbol cd="ambiguous" id="S5.p7.11.m11.1.1.1.cmml" xref="S5.p7.11.m11.1.1">subscript</csymbol><ci id="S5.p7.11.m11.1.1.2.cmml" xref="S5.p7.11.m11.1.1.2">ğœ‹</ci><ci id="S5.p7.11.m11.1.1.3.cmml" xref="S5.p7.11.m11.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.11.m11.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> being easier-to-fit, and not purely because RFT data improves coverage by finetuning on multiple solution traces per question.</p>
</div>
<div id="S5.p8" class="ltx_para">
<p id="S5.p8.1" class="ltx_p"><span id="S5.p8.1.1" class="ltx_text ltx_font_bold">SFT/RFT policy suffers from spurious correlations in positive synthetic data.</span>
While RFT data maybe â€œeasier-to-fitâ€, in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c) we also note that continuing to scale RFT data leads to test error saturation, or even worse test error. This is unlike scaling of problems and solutions in SFT data (in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b)).</p>
</div>
<figure id="S5.F5" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x8.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="331" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.10.3.1" class="ltx_text" style="font-size:113%;">Figure 5</span>: </span><span id="S5.F5.4.2" class="ltx_text" style="font-size:113%;">Running RFT on positive model-generated data <math id="S5.F5.3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S5.F5.3.1.m1.1b"><msubsup id="S5.F5.3.1.m1.1.1" xref="S5.F5.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F5.3.1.m1.1.1.2.2" xref="S5.F5.3.1.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S5.F5.3.1.m1.1.1.3" xref="S5.F5.3.1.m1.1.1.3.cmml"><mi id="S5.F5.3.1.m1.1.1.3.2" xref="S5.F5.3.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S5.F5.3.1.m1.1.1.3.3" xref="S5.F5.3.1.m1.1.1.3.3.cmml">sft</mi></msub><mo id="S5.F5.3.1.m1.1.1.2.3" xref="S5.F5.3.1.m1.1.1.2.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.F5.3.1.m1.1c"><apply id="S5.F5.3.1.m1.1.1.cmml" xref="S5.F5.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.1.cmml" xref="S5.F5.3.1.m1.1.1">subscript</csymbol><apply id="S5.F5.3.1.m1.1.1.2.cmml" xref="S5.F5.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.2.1.cmml" xref="S5.F5.3.1.m1.1.1">superscript</csymbol><ci id="S5.F5.3.1.m1.1.1.2.2.cmml" xref="S5.F5.3.1.m1.1.1.2.2">ğ’Ÿ</ci><plus id="S5.F5.3.1.m1.1.1.2.3.cmml" xref="S5.F5.3.1.m1.1.1.2.3"></plus></apply><apply id="S5.F5.3.1.m1.1.1.3.cmml" xref="S5.F5.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.F5.3.1.m1.1.1.3.1.cmml" xref="S5.F5.3.1.m1.1.1.3">subscript</csymbol><ci id="S5.F5.3.1.m1.1.1.3.2.cmml" xref="S5.F5.3.1.m1.1.1.3.2">ğœ‹</ci><ci id="S5.F5.3.1.m1.1.1.3.3.cmml" xref="S5.F5.3.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.3.1.m1.1d">\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> with spurious steps can be worse than running SFT on <math id="S5.F5.4.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.F5.4.2.m2.1b"><msub id="S5.F5.4.2.m2.1.1" xref="S5.F5.4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.F5.4.2.m2.1.1.2" xref="S5.F5.4.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.F5.4.2.m2.1.1.3" xref="S5.F5.4.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F5.4.2.m2.1c"><apply id="S5.F5.4.2.m2.1.1.cmml" xref="S5.F5.4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F5.4.2.m2.1.1.1.cmml" xref="S5.F5.4.2.m2.1.1">subscript</csymbol><ci id="S5.F5.4.2.m2.1.1.2.cmml" xref="S5.F5.4.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S5.F5.4.2.m2.1.1.3.cmml" xref="S5.F5.4.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.2.m2.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. Later we will discuss how this failure mode is fixed by per-step credit assignment with per-step DPO.</span></figcaption>
</figure>
<div id="S5.p9" class="ltx_para ltx_noindent">
<p id="S5.p9.10" class="ltx_p">This failure can be attributed to the presence of incorrect/irrelevant steps that are not detected by our verifier, since it only verifies the final answer (see AppendixÂ <a href="#A7" title="Appendix G Implementation Details â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">G</span></a>,Â <a href="#A5" title="Appendix E Negative Data Identifies Spurious Steps with Advantage Estimates â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a> for examples). For a problem <math id="S5.p9.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S5.p9.1.m1.1a"><mi id="S5.p9.1.m1.1.1" xref="S5.p9.1.m1.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S5.p9.1.m1.1b"><ci id="S5.p9.1.m1.1.1.cmml" xref="S5.p9.1.m1.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.1.m1.1c">\mathbf{x}</annotation></semantics></math>, when the
LLM is trained with supervised next-token prediction on some positive sub-optimal <math id="S5.p9.2.m2.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S5.p9.2.m2.1a"><mi id="S5.p9.2.m2.1.1" xref="S5.p9.2.m2.1.1.cmml">ğ²</mi><annotation-xml encoding="MathML-Content" id="S5.p9.2.m2.1b"><ci id="S5.p9.2.m2.1.1.cmml" xref="S5.p9.2.m2.1.1">ğ²</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.2.m2.1c">\mathbf{y}</annotation></semantics></math> in the RFT data, with incorrect or irrelevant step <math id="S5.p9.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{k}" display="inline"><semantics id="S5.p9.3.m3.1a"><msub id="S5.p9.3.m3.1.1" xref="S5.p9.3.m3.1.1.cmml"><mi id="S5.p9.3.m3.1.1.2" xref="S5.p9.3.m3.1.1.2.cmml">ğ²</mi><mi id="S5.p9.3.m3.1.1.3" xref="S5.p9.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p9.3.m3.1b"><apply id="S5.p9.3.m3.1.1.cmml" xref="S5.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p9.3.m3.1.1.1.cmml" xref="S5.p9.3.m3.1.1">subscript</csymbol><ci id="S5.p9.3.m3.1.1.2.cmml" xref="S5.p9.3.m3.1.1.2">ğ²</ci><ci id="S5.p9.3.m3.1.1.3.cmml" xref="S5.p9.3.m3.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.3.m3.1c">\mathbf{y}_{k}</annotation></semantics></math>, it is likely to develop incorrect causal associations between such â€œspuriousâ€ steps appearing in a prefix of the solution <math id="S5.p9.4.m4.1" class="ltx_Math" alttext="\mathbf{y}_{1:k}" display="inline"><semantics id="S5.p9.4.m4.1a"><msub id="S5.p9.4.m4.1.1" xref="S5.p9.4.m4.1.1.cmml"><mi id="S5.p9.4.m4.1.1.2" xref="S5.p9.4.m4.1.1.2.cmml">ğ²</mi><mrow id="S5.p9.4.m4.1.1.3" xref="S5.p9.4.m4.1.1.3.cmml"><mn id="S5.p9.4.m4.1.1.3.2" xref="S5.p9.4.m4.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S5.p9.4.m4.1.1.3.1" xref="S5.p9.4.m4.1.1.3.1.cmml">:</mo><mi id="S5.p9.4.m4.1.1.3.3" xref="S5.p9.4.m4.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p9.4.m4.1b"><apply id="S5.p9.4.m4.1.1.cmml" xref="S5.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p9.4.m4.1.1.1.cmml" xref="S5.p9.4.m4.1.1">subscript</csymbol><ci id="S5.p9.4.m4.1.1.2.cmml" xref="S5.p9.4.m4.1.1.2">ğ²</ci><apply id="S5.p9.4.m4.1.1.3.cmml" xref="S5.p9.4.m4.1.1.3"><ci id="S5.p9.4.m4.1.1.3.1.cmml" xref="S5.p9.4.m4.1.1.3.1">:</ci><cn type="integer" id="S5.p9.4.m4.1.1.3.2.cmml" xref="S5.p9.4.m4.1.1.3.2">1</cn><ci id="S5.p9.4.m4.1.1.3.3.cmml" xref="S5.p9.4.m4.1.1.3.3">ğ‘˜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.4.m4.1c">\mathbf{y}_{1:k}</annotation></semantics></math>, and the following valid step <math id="S5.p9.5.m5.1" class="ltx_Math" alttext="\mathbf{y}_{k+1}" display="inline"><semantics id="S5.p9.5.m5.1a"><msub id="S5.p9.5.m5.1.1" xref="S5.p9.5.m5.1.1.cmml"><mi id="S5.p9.5.m5.1.1.2" xref="S5.p9.5.m5.1.1.2.cmml">ğ²</mi><mrow id="S5.p9.5.m5.1.1.3" xref="S5.p9.5.m5.1.1.3.cmml"><mi id="S5.p9.5.m5.1.1.3.2" xref="S5.p9.5.m5.1.1.3.2.cmml">k</mi><mo id="S5.p9.5.m5.1.1.3.1" xref="S5.p9.5.m5.1.1.3.1.cmml">+</mo><mn id="S5.p9.5.m5.1.1.3.3" xref="S5.p9.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p9.5.m5.1b"><apply id="S5.p9.5.m5.1.1.cmml" xref="S5.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p9.5.m5.1.1.1.cmml" xref="S5.p9.5.m5.1.1">subscript</csymbol><ci id="S5.p9.5.m5.1.1.2.cmml" xref="S5.p9.5.m5.1.1.2">ğ²</ci><apply id="S5.p9.5.m5.1.1.3.cmml" xref="S5.p9.5.m5.1.1.3"><plus id="S5.p9.5.m5.1.1.3.1.cmml" xref="S5.p9.5.m5.1.1.3.1"></plus><ci id="S5.p9.5.m5.1.1.3.2.cmml" xref="S5.p9.5.m5.1.1.3.2">ğ‘˜</ci><cn type="integer" id="S5.p9.5.m5.1.1.3.3.cmml" xref="S5.p9.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.5.m5.1c">\mathbf{y}_{k+1}</annotation></semantics></math>, when trying to maximize <math id="S5.p9.6.m6.2" class="ltx_Math" alttext="\pi(\mathbf{y}_{k+1}|\mathbf{y}_{1:k},\mathbf{x})" display="inline"><semantics id="S5.p9.6.m6.2a"><mrow id="S5.p9.6.m6.2.2" xref="S5.p9.6.m6.2.2.cmml"><mi id="S5.p9.6.m6.2.2.3" xref="S5.p9.6.m6.2.2.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S5.p9.6.m6.2.2.2" xref="S5.p9.6.m6.2.2.2.cmml">â€‹</mo><mrow id="S5.p9.6.m6.2.2.1.1" xref="S5.p9.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S5.p9.6.m6.2.2.1.1.2" xref="S5.p9.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S5.p9.6.m6.2.2.1.1.1" xref="S5.p9.6.m6.2.2.1.1.1.cmml"><msub id="S5.p9.6.m6.2.2.1.1.1.3" xref="S5.p9.6.m6.2.2.1.1.1.3.cmml"><mi id="S5.p9.6.m6.2.2.1.1.1.3.2" xref="S5.p9.6.m6.2.2.1.1.1.3.2.cmml">ğ²</mi><mrow id="S5.p9.6.m6.2.2.1.1.1.3.3" xref="S5.p9.6.m6.2.2.1.1.1.3.3.cmml"><mi id="S5.p9.6.m6.2.2.1.1.1.3.3.2" xref="S5.p9.6.m6.2.2.1.1.1.3.3.2.cmml">k</mi><mo id="S5.p9.6.m6.2.2.1.1.1.3.3.1" xref="S5.p9.6.m6.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S5.p9.6.m6.2.2.1.1.1.3.3.3" xref="S5.p9.6.m6.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S5.p9.6.m6.2.2.1.1.1.2" xref="S5.p9.6.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S5.p9.6.m6.2.2.1.1.1.1.1" xref="S5.p9.6.m6.2.2.1.1.1.1.2.cmml"><msub id="S5.p9.6.m6.2.2.1.1.1.1.1.1" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S5.p9.6.m6.2.2.1.1.1.1.1.1.2" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.cmml"><mn id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.2" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.1" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.3" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S5.p9.6.m6.2.2.1.1.1.1.1.2" xref="S5.p9.6.m6.2.2.1.1.1.1.2.cmml">,</mo><mi id="S5.p9.6.m6.1.1" xref="S5.p9.6.m6.1.1.cmml">ğ±</mi></mrow></mrow><mo stretchy="false" id="S5.p9.6.m6.2.2.1.1.3" xref="S5.p9.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p9.6.m6.2b"><apply id="S5.p9.6.m6.2.2.cmml" xref="S5.p9.6.m6.2.2"><times id="S5.p9.6.m6.2.2.2.cmml" xref="S5.p9.6.m6.2.2.2"></times><ci id="S5.p9.6.m6.2.2.3.cmml" xref="S5.p9.6.m6.2.2.3">ğœ‹</ci><apply id="S5.p9.6.m6.2.2.1.1.1.cmml" xref="S5.p9.6.m6.2.2.1.1"><csymbol cd="latexml" id="S5.p9.6.m6.2.2.1.1.1.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.2">conditional</csymbol><apply id="S5.p9.6.m6.2.2.1.1.1.3.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.p9.6.m6.2.2.1.1.1.3.1.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S5.p9.6.m6.2.2.1.1.1.3.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3.2">ğ²</ci><apply id="S5.p9.6.m6.2.2.1.1.1.3.3.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3.3"><plus id="S5.p9.6.m6.2.2.1.1.1.3.3.1.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3.3.1"></plus><ci id="S5.p9.6.m6.2.2.1.1.1.3.3.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3.3.2">ğ‘˜</ci><cn type="integer" id="S5.p9.6.m6.2.2.1.1.1.3.3.3.cmml" xref="S5.p9.6.m6.2.2.1.1.1.3.3.3">1</cn></apply></apply><list id="S5.p9.6.m6.2.2.1.1.1.1.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1"><apply id="S5.p9.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p9.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.p9.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.2">ğ²</ci><apply id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3"><ci id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.2.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="S5.p9.6.m6.2.2.1.1.1.1.1.1.3.3">ğ‘˜</ci></apply></apply><ci id="S5.p9.6.m6.1.1.cmml" xref="S5.p9.6.m6.1.1">ğ±</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.6.m6.2c">\pi(\mathbf{y}_{k+1}|\mathbf{y}_{1:k},\mathbf{x})</annotation></semantics></math>. This is well known as the problem of â€œcausal confusionâ€Â <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> in the literature on imitation learning. To verify this hypothesis, we amplify the presence of these spurious steps. Specifically, for each question in <math id="S5.p9.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S5.p9.7.m7.1a"><msub id="S5.p9.7.m7.1.1" xref="S5.p9.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p9.7.m7.1.1.2" xref="S5.p9.7.m7.1.1.2.cmml">ğ’Ÿ</mi><mi id="S5.p9.7.m7.1.1.3" xref="S5.p9.7.m7.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p9.7.m7.1b"><apply id="S5.p9.7.m7.1.1.cmml" xref="S5.p9.7.m7.1.1"><csymbol cd="ambiguous" id="S5.p9.7.m7.1.1.1.cmml" xref="S5.p9.7.m7.1.1">subscript</csymbol><ci id="S5.p9.7.m7.1.1.2.cmml" xref="S5.p9.7.m7.1.1.2">ğ’Ÿ</ci><ci id="S5.p9.7.m7.1.1.3.cmml" xref="S5.p9.7.m7.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.7.m7.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> we sample â€œspurious stepsâ€ from <math id="S5.p9.8.m8.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p9.8.m8.1a"><msub id="S5.p9.8.m8.1.1" xref="S5.p9.8.m8.1.1.cmml"><mi id="S5.p9.8.m8.1.1.2" xref="S5.p9.8.m8.1.1.2.cmml">Ï€</mi><mi id="S5.p9.8.m8.1.1.3" xref="S5.p9.8.m8.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p9.8.m8.1b"><apply id="S5.p9.8.m8.1.1.cmml" xref="S5.p9.8.m8.1.1"><csymbol cd="ambiguous" id="S5.p9.8.m8.1.1.1.cmml" xref="S5.p9.8.m8.1.1">subscript</csymbol><ci id="S5.p9.8.m8.1.1.2.cmml" xref="S5.p9.8.m8.1.1.2">ğœ‹</ci><ci id="S5.p9.8.m8.1.1.3.cmml" xref="S5.p9.8.m8.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.8.m8.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> trained on it, <em id="S5.p9.10.1" class="ltx_emph ltx_font_italic">i.e.</em>,Â steps which lead to the incorrect answer with high probability under <math id="S5.p9.9.m9.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p9.9.m9.1a"><msub id="S5.p9.9.m9.1.1" xref="S5.p9.9.m9.1.1.cmml"><mi id="S5.p9.9.m9.1.1.2" xref="S5.p9.9.m9.1.1.2.cmml">Ï€</mi><mi id="S5.p9.9.m9.1.1.3" xref="S5.p9.9.m9.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p9.9.m9.1b"><apply id="S5.p9.9.m9.1.1.cmml" xref="S5.p9.9.m9.1.1"><csymbol cd="ambiguous" id="S5.p9.9.m9.1.1.1.cmml" xref="S5.p9.9.m9.1.1">subscript</csymbol><ci id="S5.p9.9.m9.1.1.2.cmml" xref="S5.p9.9.m9.1.1.2">ğœ‹</ci><ci id="S5.p9.9.m9.1.1.3.cmml" xref="S5.p9.9.m9.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.9.m9.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> (we sample multiple completions conditioned on the same spurious step to check how likely it leads to the correct final answer). Then, we interleave the solution traces in the RFT data with these spurious steps. Note, that all traces in the RFT data are still positive since, they all lead to the correct answer eventually. We find that an LLM trained on this spurious RFT data performs worse than the <math id="S5.p9.10.m10.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.p9.10.m10.1a"><msub id="S5.p9.10.m10.1.1" xref="S5.p9.10.m10.1.1.cmml"><mi id="S5.p9.10.m10.1.1.2" xref="S5.p9.10.m10.1.1.2.cmml">Ï€</mi><mi id="S5.p9.10.m10.1.1.3" xref="S5.p9.10.m10.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p9.10.m10.1b"><apply id="S5.p9.10.m10.1.1.cmml" xref="S5.p9.10.m10.1.1"><csymbol cd="ambiguous" id="S5.p9.10.m10.1.1.1.cmml" xref="S5.p9.10.m10.1.1">subscript</csymbol><ci id="S5.p9.10.m10.1.1.2.cmml" xref="S5.p9.10.m10.1.1.2">ğœ‹</ci><ci id="S5.p9.10.m10.1.1.3.cmml" xref="S5.p9.10.m10.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p9.10.m10.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> policy itself, often producing more of such incorrect steps in our qualitative probes (AppendixÂ <a href="#A5" title="Appendix E Negative Data Identifies Spurious Steps with Advantage Estimates â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>).</p>
</div>
<div id="S5.p10" class="ltx_para ltx_noindent">
<svg id="S5.p10.pic1" class="ltx_picture" height="87.45" overflow="visible" version="1.1" width="600"><g transform="translate(0,87.45) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 69.4 C 0 72.66 2.64 75.31 5.91 75.31 L 594.09 75.31 C 597.36 75.31 600 72.66 600 69.4 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F0F0FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 69.4 C 1.97 71.58 3.73 73.34 5.91 73.34 L 594.09 73.34 C 596.27 73.34 598.03 71.58 598.03 69.4 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 15 65.31)"><g class="ltx_nestedsvg" transform="matrix(1 0 0 1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#FFFFFF" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 293.53 22.14 C 295.16 22.14 296.48 20.82 296.48 19.19 L 296.48 2.95 C 296.48 1.32 295.16 0 293.53 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill="#000000" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 293.53 22.14 C 295.16 22.14 296.48 20.82 296.48 19.19 L 296.48 2.95 C 296.48 1.32 295.16 0 293.53 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 11.81 7.61)"><text transform="matrix(1 0 0 -1 0 0)" color="#000000">Takeaways for scaling positive synthetic data</text></g></g></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 11.44)"><foreignObject width="556.69" height="46.89" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="S5.p10.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="S5.I1" class="ltx_itemize">
<span id="S5.I1.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">â€¢</span> 
<span id="S5.I1.i1.p1" class="ltx_para">
<span id="S5.I1.i1.p1.1" class="ltx_p">While positive data from GPT-4/Gemini-1.5 improves coverage over new problems and solutions, positive data from SFT policy trained on it is <math id="S5.I1.i1.p1.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.I1.i1.p1.1.m1.1a"><mrow id="S5.I1.i1.p1.1.m1.1b"><mn id="S5.I1.i1.p1.1.m1.1.1">2</mn><mo lspace="0.222em" id="S5.I1.i1.p1.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">2\times</annotation></semantics></math> more sample efficient.</span>
</span></span>
<span id="S5.I1.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">â€¢</span> 
<span id="S5.I1.i2.p1" class="ltx_para ltx_noindent">
<span id="S5.I1.i2.p1.1" class="ltx_p">When positive data from <math id="S5.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S5.I1.i2.p1.1.m1.1a"><msub id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml"><mi id="S5.I1.i2.p1.1.m1.1.1.2" xref="S5.I1.i2.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="S5.I1.i2.p1.1.m1.1.1.3" xref="S5.I1.i2.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><apply id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.I1.i2.p1.1.m1.1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.I1.i2.p1.1.m1.1.1.2.cmml" xref="S5.I1.i2.p1.1.m1.1.1.2">ğœ‹</ci><ci id="S5.I1.i2.p1.1.m1.1.1.3.cmml" xref="S5.I1.i2.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> contains spurious steps, scaling synthetic data leads to worse test errors.</span>
</span></span>
</span>
</span></foreignObject></g></g></svg>
</div>
</section>
<section id="S6" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Negative Synthetic Data Enables Per-Step Credit Assignment</h3>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We saw in SectionÂ <a href="#S5" title="5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that fine-tuning on model-generated data can reinforce the modelâ€™s tendency to produce irrelevant or incorrect steps that are able to still steer the model towards the correct response on some training problems, but derail it otherwise. Since supervised fine-tuning on positive data with a low-cost verifier alone is unable to identify such problematic steps either, we would not expect this issue to go away even as the amount of synthetic positive data is scaled up substantially.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p">Perhaps surprisingly, we show that training on <em id="S6.p2.1.1" class="ltx_emph ltx_font_bold ltx_font_italic">negative data</em> for the same set of synthetic problems can address the failure modes of positive data as long as this negative data is carefully constructed. In particular, the construction of negatives should enable us to perform <em id="S6.p2.1.2" class="ltx_emph ltx_font_italic">per-step credit assignment</em>. We will develop a conceptual model to do so in this section and build a recipe for obtaining per-step credits.
We will formally show how DPO on a specific preference pair distribution implicitly conforms to our model of per-step credits.
We also show that per-step DPO from SectionÂ <a href="#S3" title="3 Problem Setup and Synthetic Data Generation Pipeline â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> is an approximate variant of this more general conceptual idea. Consequently, using per-step DPO we empirically verify the efficacy of negative data in enabling per-step credit assignment and its impact on the scaling laws.
Finally, we discuss how our conceptual model of using negatives is equivalent to advantage-weighted RL and explain the generalization benefits of using negative data by exploiting this connection, both theoretically and intuitively via a study on a didactic problem.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment</h4>

<div id="S6.SS1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.p1.10" class="ltx_p">While naÃ¯vely contrasing an entire positive response <math id="S6.SS1.p1.1.m1.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mo id="S6.SS1.p1.1.m1.1.1a" xref="S6.SS1.p1.1.m1.1.1.cmml">+</mo><mover accent="true" id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2.2" xref="S6.SS1.p1.1.m1.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.1.m1.1.1.2.1" xref="S6.SS1.p1.1.m1.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><plus id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"></plus><apply id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2"><ci id="S6.SS1.p1.1.m1.1.1.2.1.cmml" xref="S6.SS1.p1.1.m1.1.1.2.1">^</ci><ci id="S6.SS1.p1.1.m1.1.1.2.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">+\hat{\mathbf{y}}</annotation></semantics></math> against an entire negative response <math id="S6.SS1.p1.2.m2.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mo id="S6.SS1.p1.2.m2.1.1a" xref="S6.SS1.p1.2.m2.1.1.cmml">âˆ’</mo><mover accent="true" id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml"><mi id="S6.SS1.p1.2.m2.1.1.2.2" xref="S6.SS1.p1.2.m2.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.2.m2.1.1.2.1" xref="S6.SS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><minus id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"></minus><apply id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2"><ci id="S6.SS1.p1.2.m2.1.1.2.1.cmml" xref="S6.SS1.p1.2.m2.1.1.2.1">^</ci><ci id="S6.SS1.p1.2.m2.1.1.2.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">-\hat{\mathbf{y}}</annotation></semantics></math> will increase the likelihood of <em id="S6.SS1.p1.10.1" class="ltx_emph ltx_font_italic">each</em> step that appears in <math id="S6.SS1.p1.3.m3.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.3.m3.1a"><mrow id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml"><mo id="S6.SS1.p1.3.m3.1.1a" xref="S6.SS1.p1.3.m3.1.1.cmml">+</mo><mover accent="true" id="S6.SS1.p1.3.m3.1.1.2" xref="S6.SS1.p1.3.m3.1.1.2.cmml"><mi id="S6.SS1.p1.3.m3.1.1.2.2" xref="S6.SS1.p1.3.m3.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.3.m3.1.1.2.1" xref="S6.SS1.p1.3.m3.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><apply id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"><plus id="S6.SS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"></plus><apply id="S6.SS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2"><ci id="S6.SS1.p1.3.m3.1.1.2.1.cmml" xref="S6.SS1.p1.3.m3.1.1.2.1">^</ci><ci id="S6.SS1.p1.3.m3.1.1.2.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">+\hat{\mathbf{y}}</annotation></semantics></math> (even when incorrect or irrelevant) and reduce likelihood on each step appearing in <math id="S6.SS1.p1.4.m4.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.4.m4.1a"><mrow id="S6.SS1.p1.4.m4.1.1" xref="S6.SS1.p1.4.m4.1.1.cmml"><mo id="S6.SS1.p1.4.m4.1.1a" xref="S6.SS1.p1.4.m4.1.1.cmml">âˆ’</mo><mover accent="true" id="S6.SS1.p1.4.m4.1.1.2" xref="S6.SS1.p1.4.m4.1.1.2.cmml"><mi id="S6.SS1.p1.4.m4.1.1.2.2" xref="S6.SS1.p1.4.m4.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.4.m4.1.1.2.1" xref="S6.SS1.p1.4.m4.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.1b"><apply id="S6.SS1.p1.4.m4.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1"><minus id="S6.SS1.p1.4.m4.1.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1"></minus><apply id="S6.SS1.p1.4.m4.1.1.2.cmml" xref="S6.SS1.p1.4.m4.1.1.2"><ci id="S6.SS1.p1.4.m4.1.1.2.1.cmml" xref="S6.SS1.p1.4.m4.1.1.2.1">^</ci><ci id="S6.SS1.p1.4.m4.1.1.2.2.cmml" xref="S6.SS1.p1.4.m4.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">-\hat{\mathbf{y}}</annotation></semantics></math> (even when accurate and relevant), it does not account for the importance of each step. Formally, given a negative solution trace <math id="S6.SS1.p1.5.m5.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.5.m5.1a"><mrow id="S6.SS1.p1.5.m5.1.1" xref="S6.SS1.p1.5.m5.1.1.cmml"><mo id="S6.SS1.p1.5.m5.1.1a" xref="S6.SS1.p1.5.m5.1.1.cmml">âˆ’</mo><mover accent="true" id="S6.SS1.p1.5.m5.1.1.2" xref="S6.SS1.p1.5.m5.1.1.2.cmml"><mi id="S6.SS1.p1.5.m5.1.1.2.2" xref="S6.SS1.p1.5.m5.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.5.m5.1.1.2.1" xref="S6.SS1.p1.5.m5.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.5.m5.1b"><apply id="S6.SS1.p1.5.m5.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1"><minus id="S6.SS1.p1.5.m5.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1"></minus><apply id="S6.SS1.p1.5.m5.1.1.2.cmml" xref="S6.SS1.p1.5.m5.1.1.2"><ci id="S6.SS1.p1.5.m5.1.1.2.1.cmml" xref="S6.SS1.p1.5.m5.1.1.2.1">^</ci><ci id="S6.SS1.p1.5.m5.1.1.2.2.cmml" xref="S6.SS1.p1.5.m5.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.5.m5.1c">-\hat{\mathbf{y}}</annotation></semantics></math>, we would want to identify <em id="S6.SS1.p1.10.2" class="ltx_emph ltx_font_italic">critical</em> steps where the model introduces a flaw <math id="S6.SS1.p1.6.m6.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p1.6.m6.1a"><mrow id="S6.SS1.p1.6.m6.1.1" xref="S6.SS1.p1.6.m6.1.1.cmml"><mo id="S6.SS1.p1.6.m6.1.1a" xref="S6.SS1.p1.6.m6.1.1.cmml">âˆ’</mo><msub id="S6.SS1.p1.6.m6.1.1.2" xref="S6.SS1.p1.6.m6.1.1.2.cmml"><mover accent="true" id="S6.SS1.p1.6.m6.1.1.2.2" xref="S6.SS1.p1.6.m6.1.1.2.2.cmml"><mi id="S6.SS1.p1.6.m6.1.1.2.2.2" xref="S6.SS1.p1.6.m6.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.6.m6.1.1.2.2.1" xref="S6.SS1.p1.6.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="S6.SS1.p1.6.m6.1.1.2.3" xref="S6.SS1.p1.6.m6.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.6.m6.1b"><apply id="S6.SS1.p1.6.m6.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1"><minus id="S6.SS1.p1.6.m6.1.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1"></minus><apply id="S6.SS1.p1.6.m6.1.1.2.cmml" xref="S6.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.6.m6.1.1.2.1.cmml" xref="S6.SS1.p1.6.m6.1.1.2">subscript</csymbol><apply id="S6.SS1.p1.6.m6.1.1.2.2.cmml" xref="S6.SS1.p1.6.m6.1.1.2.2"><ci id="S6.SS1.p1.6.m6.1.1.2.2.1.cmml" xref="S6.SS1.p1.6.m6.1.1.2.2.1">^</ci><ci id="S6.SS1.p1.6.m6.1.1.2.2.2.cmml" xref="S6.SS1.p1.6.m6.1.1.2.2.2">ğ²</ci></apply><ci id="S6.SS1.p1.6.m6.1.1.2.3.cmml" xref="S6.SS1.p1.6.m6.1.1.2.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.6.m6.1c">-\hat{\mathbf{y}}_{i}</annotation></semantics></math>, and emphasize alternate correct completions starting from the previous state <math id="S6.SS1.p1.7.m7.2" class="ltx_Math" alttext="(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1})" display="inline"><semantics id="S6.SS1.p1.7.m7.2a"><mrow id="S6.SS1.p1.7.m7.2.2.1" xref="S6.SS1.p1.7.m7.2.2.2.cmml"><mo stretchy="false" id="S6.SS1.p1.7.m7.2.2.1.2" xref="S6.SS1.p1.7.m7.2.2.2.cmml">(</mo><mi id="S6.SS1.p1.7.m7.1.1" xref="S6.SS1.p1.7.m7.1.1.cmml">ğ±</mi><mo id="S6.SS1.p1.7.m7.2.2.1.3" xref="S6.SS1.p1.7.m7.2.2.2.cmml">,</mo><mrow id="S6.SS1.p1.7.m7.2.2.1.1" xref="S6.SS1.p1.7.m7.2.2.1.1.cmml"><mo id="S6.SS1.p1.7.m7.2.2.1.1a" xref="S6.SS1.p1.7.m7.2.2.1.1.cmml">âˆ’</mo><msub id="S6.SS1.p1.7.m7.2.2.1.1.2" xref="S6.SS1.p1.7.m7.2.2.1.1.2.cmml"><mover accent="true" id="S6.SS1.p1.7.m7.2.2.1.1.2.2" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2.cmml"><mi id="S6.SS1.p1.7.m7.2.2.1.1.2.2.2" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.7.m7.2.2.1.1.2.2.1" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2.1.cmml">^</mo></mover><mrow id="S6.SS1.p1.7.m7.2.2.1.1.2.3" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.cmml"><mn id="S6.SS1.p1.7.m7.2.2.1.1.2.3.2" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS1.p1.7.m7.2.2.1.1.2.3.1" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.1.cmml">:</mo><mrow id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.cmml"><mi id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.2" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.2.cmml">i</mi><mo id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.1" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.3" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo stretchy="false" id="S6.SS1.p1.7.m7.2.2.1.4" xref="S6.SS1.p1.7.m7.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.7.m7.2b"><interval closure="open" id="S6.SS1.p1.7.m7.2.2.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1"><ci id="S6.SS1.p1.7.m7.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1">ğ±</ci><apply id="S6.SS1.p1.7.m7.2.2.1.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1"><minus id="S6.SS1.p1.7.m7.2.2.1.1.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1"></minus><apply id="S6.SS1.p1.7.m7.2.2.1.1.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.7.m7.2.2.1.1.2.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2">subscript</csymbol><apply id="S6.SS1.p1.7.m7.2.2.1.1.2.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2"><ci id="S6.SS1.p1.7.m7.2.2.1.1.2.2.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2.1">^</ci><ci id="S6.SS1.p1.7.m7.2.2.1.1.2.2.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.2.2">ğ²</ci></apply><apply id="S6.SS1.p1.7.m7.2.2.1.1.2.3.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3"><ci id="S6.SS1.p1.7.m7.2.2.1.1.2.3.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.1">:</ci><cn type="integer" id="S6.SS1.p1.7.m7.2.2.1.1.2.3.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.2">1</cn><apply id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3"><minus id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.1.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.1"></minus><ci id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.2.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.3.cmml" xref="S6.SS1.p1.7.m7.2.2.1.1.2.3.3.3">1</cn></apply></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.7.m7.2c">(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1})</annotation></semantics></math>, that the model could have still produced. Likewise, given a positive solution trace, <math id="S6.SS1.p1.8.m8.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p1.8.m8.1a"><mrow id="S6.SS1.p1.8.m8.1.1" xref="S6.SS1.p1.8.m8.1.1.cmml"><mo id="S6.SS1.p1.8.m8.1.1a" xref="S6.SS1.p1.8.m8.1.1.cmml">+</mo><mover accent="true" id="S6.SS1.p1.8.m8.1.1.2" xref="S6.SS1.p1.8.m8.1.1.2.cmml"><mi id="S6.SS1.p1.8.m8.1.1.2.2" xref="S6.SS1.p1.8.m8.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.8.m8.1.1.2.1" xref="S6.SS1.p1.8.m8.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.8.m8.1b"><apply id="S6.SS1.p1.8.m8.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1"><plus id="S6.SS1.p1.8.m8.1.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1"></plus><apply id="S6.SS1.p1.8.m8.1.1.2.cmml" xref="S6.SS1.p1.8.m8.1.1.2"><ci id="S6.SS1.p1.8.m8.1.1.2.1.cmml" xref="S6.SS1.p1.8.m8.1.1.2.1">^</ci><ci id="S6.SS1.p1.8.m8.1.1.2.2.cmml" xref="S6.SS1.p1.8.m8.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.8.m8.1c">+\hat{\mathbf{y}}</annotation></semantics></math>, we would like to identify if a given step <math id="S6.SS1.p1.9.m9.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p1.9.m9.1a"><mrow id="S6.SS1.p1.9.m9.1.1" xref="S6.SS1.p1.9.m9.1.1.cmml"><mo id="S6.SS1.p1.9.m9.1.1a" xref="S6.SS1.p1.9.m9.1.1.cmml">+</mo><msub id="S6.SS1.p1.9.m9.1.1.2" xref="S6.SS1.p1.9.m9.1.1.2.cmml"><mover accent="true" id="S6.SS1.p1.9.m9.1.1.2.2" xref="S6.SS1.p1.9.m9.1.1.2.2.cmml"><mi id="S6.SS1.p1.9.m9.1.1.2.2.2" xref="S6.SS1.p1.9.m9.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.9.m9.1.1.2.2.1" xref="S6.SS1.p1.9.m9.1.1.2.2.1.cmml">^</mo></mover><mi id="S6.SS1.p1.9.m9.1.1.2.3" xref="S6.SS1.p1.9.m9.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.9.m9.1b"><apply id="S6.SS1.p1.9.m9.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1"><plus id="S6.SS1.p1.9.m9.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1"></plus><apply id="S6.SS1.p1.9.m9.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.9.m9.1.1.2.1.cmml" xref="S6.SS1.p1.9.m9.1.1.2">subscript</csymbol><apply id="S6.SS1.p1.9.m9.1.1.2.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2.2"><ci id="S6.SS1.p1.9.m9.1.1.2.2.1.cmml" xref="S6.SS1.p1.9.m9.1.1.2.2.1">^</ci><ci id="S6.SS1.p1.9.m9.1.1.2.2.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2.2.2">ğ²</ci></apply><ci id="S6.SS1.p1.9.m9.1.1.2.3.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.9.m9.1c">+\hat{\mathbf{y}}_{i}</annotation></semantics></math> does not make progress towards the solution by identifying if there exist more likely to succeed alternatives from its predecessor steps, <math id="S6.SS1.p1.10.m10.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{1:i-1}" display="inline"><semantics id="S6.SS1.p1.10.m10.1a"><mrow id="S6.SS1.p1.10.m10.1.1" xref="S6.SS1.p1.10.m10.1.1.cmml"><mo id="S6.SS1.p1.10.m10.1.1a" xref="S6.SS1.p1.10.m10.1.1.cmml">+</mo><msub id="S6.SS1.p1.10.m10.1.1.2" xref="S6.SS1.p1.10.m10.1.1.2.cmml"><mover accent="true" id="S6.SS1.p1.10.m10.1.1.2.2" xref="S6.SS1.p1.10.m10.1.1.2.2.cmml"><mi id="S6.SS1.p1.10.m10.1.1.2.2.2" xref="S6.SS1.p1.10.m10.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS1.p1.10.m10.1.1.2.2.1" xref="S6.SS1.p1.10.m10.1.1.2.2.1.cmml">^</mo></mover><mrow id="S6.SS1.p1.10.m10.1.1.2.3" xref="S6.SS1.p1.10.m10.1.1.2.3.cmml"><mn id="S6.SS1.p1.10.m10.1.1.2.3.2" xref="S6.SS1.p1.10.m10.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS1.p1.10.m10.1.1.2.3.1" xref="S6.SS1.p1.10.m10.1.1.2.3.1.cmml">:</mo><mrow id="S6.SS1.p1.10.m10.1.1.2.3.3" xref="S6.SS1.p1.10.m10.1.1.2.3.3.cmml"><mi id="S6.SS1.p1.10.m10.1.1.2.3.3.2" xref="S6.SS1.p1.10.m10.1.1.2.3.3.2.cmml">i</mi><mo id="S6.SS1.p1.10.m10.1.1.2.3.3.1" xref="S6.SS1.p1.10.m10.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="S6.SS1.p1.10.m10.1.1.2.3.3.3" xref="S6.SS1.p1.10.m10.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.10.m10.1b"><apply id="S6.SS1.p1.10.m10.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1"><plus id="S6.SS1.p1.10.m10.1.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1"></plus><apply id="S6.SS1.p1.10.m10.1.1.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.10.m10.1.1.2.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2">subscript</csymbol><apply id="S6.SS1.p1.10.m10.1.1.2.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.2"><ci id="S6.SS1.p1.10.m10.1.1.2.2.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2.2.1">^</ci><ci id="S6.SS1.p1.10.m10.1.1.2.2.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.2.2">ğ²</ci></apply><apply id="S6.SS1.p1.10.m10.1.1.2.3.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3"><ci id="S6.SS1.p1.10.m10.1.1.2.3.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.1">:</ci><cn type="integer" id="S6.SS1.p1.10.m10.1.1.2.3.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.2">1</cn><apply id="S6.SS1.p1.10.m10.1.1.2.3.3.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.3"><minus id="S6.SS1.p1.10.m10.1.1.2.3.3.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.3.1"></minus><ci id="S6.SS1.p1.10.m10.1.1.2.3.3.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p1.10.m10.1.1.2.3.3.3.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.10.m10.1c">+\hat{\mathbf{y}}_{1:i-1}</annotation></semantics></math>, which now presents a key decision-making point. <span id="S6.SS1.p1.10.3" class="ltx_text ltx_font_bold">What are these critical steps and how can we identify them procedurally?</span></p>
</div>
<div id="S6.SS1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.p2.9" class="ltx_p"><span id="S6.SS1.p2.9.1" class="ltx_text ltx_font_bold">Value functions.</span> We formalize the notion of per-step credit using value functions from reinforcement learning (RL). Recall that both <math id="S6.SS1.p2.1.m1.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p2.1.m1.1a"><mrow id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml"><mo id="S6.SS1.p2.1.m1.1.1a" xref="S6.SS1.p2.1.m1.1.1.cmml">+</mo><mover accent="true" id="S6.SS1.p2.1.m1.1.1.2" xref="S6.SS1.p2.1.m1.1.1.2.cmml"><mi id="S6.SS1.p2.1.m1.1.1.2.2" xref="S6.SS1.p2.1.m1.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.1.m1.1.1.2.1" xref="S6.SS1.p2.1.m1.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"><plus id="S6.SS1.p2.1.m1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"></plus><apply id="S6.SS1.p2.1.m1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2"><ci id="S6.SS1.p2.1.m1.1.1.2.1.cmml" xref="S6.SS1.p2.1.m1.1.1.2.1">^</ci><ci id="S6.SS1.p2.1.m1.1.1.2.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">+\hat{\mathbf{y}}</annotation></semantics></math> and <math id="S6.SS1.p2.2.m2.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p2.2.m2.1a"><mrow id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml"><mo id="S6.SS1.p2.2.m2.1.1a" xref="S6.SS1.p2.2.m2.1.1.cmml">âˆ’</mo><mover accent="true" id="S6.SS1.p2.2.m2.1.1.2" xref="S6.SS1.p2.2.m2.1.1.2.cmml"><mi id="S6.SS1.p2.2.m2.1.1.2.2" xref="S6.SS1.p2.2.m2.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.2.m2.1.1.2.1" xref="S6.SS1.p2.2.m2.1.1.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.1b"><apply id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"><minus id="S6.SS1.p2.2.m2.1.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"></minus><apply id="S6.SS1.p2.2.m2.1.1.2.cmml" xref="S6.SS1.p2.2.m2.1.1.2"><ci id="S6.SS1.p2.2.m2.1.1.2.1.cmml" xref="S6.SS1.p2.2.m2.1.1.2.1">^</ci><ci id="S6.SS1.p2.2.m2.1.1.2.2.cmml" xref="S6.SS1.p2.2.m2.1.1.2.2">ğ²</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.1c">-\hat{\mathbf{y}}</annotation></semantics></math> are sampled from <math id="S6.SS1.p2.3.m3.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS1.p2.3.m3.1a"><msub id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">ğœ‹</ci><ci id="S6.SS1.p2.3.m3.1.1.3.cmml" xref="S6.SS1.p2.3.m3.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>. For problem <math id="S6.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S6.SS1.p2.4.m4.1a"><mi id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><ci id="S6.SS1.p2.4.m4.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">\mathbf{x}</annotation></semantics></math>, with correct solution <math id="S6.SS1.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S6.SS1.p2.5.m5.1a"><mi id="S6.SS1.p2.5.m5.1.1" xref="S6.SS1.p2.5.m5.1.1.cmml">ğ²</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.5.m5.1b"><ci id="S6.SS1.p2.5.m5.1.1.cmml" xref="S6.SS1.p2.5.m5.1.1">ğ²</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.5.m5.1c">\mathbf{y}</annotation></semantics></math>, a response <math id="S6.SS1.p2.6.m6.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S6.SS1.p2.6.m6.1a"><mover accent="true" id="S6.SS1.p2.6.m6.1.1" xref="S6.SS1.p2.6.m6.1.1.cmml"><mi id="S6.SS1.p2.6.m6.1.1.2" xref="S6.SS1.p2.6.m6.1.1.2.cmml">ğ²</mi><mo id="S6.SS1.p2.6.m6.1.1.1" xref="S6.SS1.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.6.m6.1b"><apply id="S6.SS1.p2.6.m6.1.1.cmml" xref="S6.SS1.p2.6.m6.1.1"><ci id="S6.SS1.p2.6.m6.1.1.1.cmml" xref="S6.SS1.p2.6.m6.1.1.1">^</ci><ci id="S6.SS1.p2.6.m6.1.1.2.cmml" xref="S6.SS1.p2.6.m6.1.1.2">ğ²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.6.m6.1c">\hat{\mathbf{y}}</annotation></semantics></math> with a sequence of steps <math id="S6.SS1.p2.7.m7.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{1:i-1}" display="inline"><semantics id="S6.SS1.p2.7.m7.1a"><msub id="S6.SS1.p2.7.m7.1.1" xref="S6.SS1.p2.7.m7.1.1.cmml"><mover accent="true" id="S6.SS1.p2.7.m7.1.1.2" xref="S6.SS1.p2.7.m7.1.1.2.cmml"><mi id="S6.SS1.p2.7.m7.1.1.2.2" xref="S6.SS1.p2.7.m7.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.7.m7.1.1.2.1" xref="S6.SS1.p2.7.m7.1.1.2.1.cmml">^</mo></mover><mrow id="S6.SS1.p2.7.m7.1.1.3" xref="S6.SS1.p2.7.m7.1.1.3.cmml"><mn id="S6.SS1.p2.7.m7.1.1.3.2" xref="S6.SS1.p2.7.m7.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS1.p2.7.m7.1.1.3.1" xref="S6.SS1.p2.7.m7.1.1.3.1.cmml">:</mo><mrow id="S6.SS1.p2.7.m7.1.1.3.3" xref="S6.SS1.p2.7.m7.1.1.3.3.cmml"><mi id="S6.SS1.p2.7.m7.1.1.3.3.2" xref="S6.SS1.p2.7.m7.1.1.3.3.2.cmml">i</mi><mo id="S6.SS1.p2.7.m7.1.1.3.3.1" xref="S6.SS1.p2.7.m7.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.SS1.p2.7.m7.1.1.3.3.3" xref="S6.SS1.p2.7.m7.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.7.m7.1b"><apply id="S6.SS1.p2.7.m7.1.1.cmml" xref="S6.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.7.m7.1.1.1.cmml" xref="S6.SS1.p2.7.m7.1.1">subscript</csymbol><apply id="S6.SS1.p2.7.m7.1.1.2.cmml" xref="S6.SS1.p2.7.m7.1.1.2"><ci id="S6.SS1.p2.7.m7.1.1.2.1.cmml" xref="S6.SS1.p2.7.m7.1.1.2.1">^</ci><ci id="S6.SS1.p2.7.m7.1.1.2.2.cmml" xref="S6.SS1.p2.7.m7.1.1.2.2">ğ²</ci></apply><apply id="S6.SS1.p2.7.m7.1.1.3.cmml" xref="S6.SS1.p2.7.m7.1.1.3"><ci id="S6.SS1.p2.7.m7.1.1.3.1.cmml" xref="S6.SS1.p2.7.m7.1.1.3.1">:</ci><cn type="integer" id="S6.SS1.p2.7.m7.1.1.3.2.cmml" xref="S6.SS1.p2.7.m7.1.1.3.2">1</cn><apply id="S6.SS1.p2.7.m7.1.1.3.3.cmml" xref="S6.SS1.p2.7.m7.1.1.3.3"><minus id="S6.SS1.p2.7.m7.1.1.3.3.1.cmml" xref="S6.SS1.p2.7.m7.1.1.3.3.1"></minus><ci id="S6.SS1.p2.7.m7.1.1.3.3.2.cmml" xref="S6.SS1.p2.7.m7.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p2.7.m7.1.1.3.3.3.cmml" xref="S6.SS1.p2.7.m7.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.7.m7.1c">\hat{\mathbf{y}}_{1:i-1}</annotation></semantics></math> (state), and a candidate step <math id="S6.SS1.p2.8.m8.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p2.8.m8.1a"><msub id="S6.SS1.p2.8.m8.1.1" xref="S6.SS1.p2.8.m8.1.1.cmml"><mover accent="true" id="S6.SS1.p2.8.m8.1.1.2" xref="S6.SS1.p2.8.m8.1.1.2.cmml"><mi id="S6.SS1.p2.8.m8.1.1.2.2" xref="S6.SS1.p2.8.m8.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.8.m8.1.1.2.1" xref="S6.SS1.p2.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S6.SS1.p2.8.m8.1.1.3" xref="S6.SS1.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.8.m8.1b"><apply id="S6.SS1.p2.8.m8.1.1.cmml" xref="S6.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.8.m8.1.1.1.cmml" xref="S6.SS1.p2.8.m8.1.1">subscript</csymbol><apply id="S6.SS1.p2.8.m8.1.1.2.cmml" xref="S6.SS1.p2.8.m8.1.1.2"><ci id="S6.SS1.p2.8.m8.1.1.2.1.cmml" xref="S6.SS1.p2.8.m8.1.1.2.1">^</ci><ci id="S6.SS1.p2.8.m8.1.1.2.2.cmml" xref="S6.SS1.p2.8.m8.1.1.2.2">ğ²</ci></apply><ci id="S6.SS1.p2.8.m8.1.1.3.cmml" xref="S6.SS1.p2.8.m8.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.8.m8.1c">\hat{\mathbf{y}}_{i}</annotation></semantics></math> (action), we define the Q-function under policy <math id="S6.SS1.p2.9.m9.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p2.9.m9.1a"><mover accent="true" id="S6.SS1.p2.9.m9.1.1" xref="S6.SS1.p2.9.m9.1.1.cmml"><mi id="S6.SS1.p2.9.m9.1.1.2" xref="S6.SS1.p2.9.m9.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p2.9.m9.1.1.1" xref="S6.SS1.p2.9.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.9.m9.1b"><apply id="S6.SS1.p2.9.m9.1.1.cmml" xref="S6.SS1.p2.9.m9.1.1"><ci id="S6.SS1.p2.9.m9.1.1.1.cmml" xref="S6.SS1.p2.9.m9.1.1.1">~</ci><ci id="S6.SS1.p2.9.m9.1.1.2.cmml" xref="S6.SS1.p2.9.m9.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.9.m9.1c">\tilde{\pi}</annotation></semantics></math> in EquationÂ <a href="#S6.E2" title="In 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
<table id="A7.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E2.m1.7" class="ltx_math_unparsed" alttext="\displaystyle Q_{\tilde{\pi}}(\underbrace{\mathbf{x},\hat{\mathbf{y}}_{1:i-1}}_{\text{state}};\underbrace{\hat{\mathbf{y}}_{i}}_{\text{action}})=\underbrace{\mathbb{E}_{{\mathbf{y}^{\mathrm{new}}_{i+1:L}\sim\tilde{\pi}(\cdot|\mathbf{x},\hat{\mathbf{y}}_{1:i})}}\Big{[}r\left([\hat{\mathbf{y}}_{1:i},\mathbf{y}^{\mathrm{new}}_{i+1:L}],\mathbf{y}\right)\Big{]}}_{\text{expected future reward under new actions (i.e., steps) sampled by policy }\tilde{\pi}}" display="inline"><semantics id="S6.E2.m1.7a"><mrow id="S6.E2.m1.7.7"><mrow id="S6.E2.m1.7.7.2"><msub id="S6.E2.m1.7.7.2.4"><mi id="S6.E2.m1.7.7.2.4.2">Q</mi><mover accent="true" id="S6.E2.m1.7.7.2.4.3"><mi id="S6.E2.m1.7.7.2.4.3.2">Ï€</mi><mo id="S6.E2.m1.7.7.2.4.3.1">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.E2.m1.7.7.2.3">â€‹</mo><mrow id="S6.E2.m1.7.7.2.2.2"><mo stretchy="false" id="S6.E2.m1.7.7.2.2.2.3">(</mo><munder id="S6.E2.m1.6.6.1.1.1.1"><munder accentunder="true" id="S6.E2.m1.2.2"><mrow id="S6.E2.m1.2.2.2.2"><mi id="S6.E2.m1.1.1.1.1">ğ±</mi><mo id="S6.E2.m1.2.2.2.2.2">,</mo><msub id="S6.E2.m1.2.2.2.2.1"><mover accent="true" id="S6.E2.m1.2.2.2.2.1.2"><mi id="S6.E2.m1.2.2.2.2.1.2.2">ğ²</mi><mo id="S6.E2.m1.2.2.2.2.1.2.1">^</mo></mover><mrow id="S6.E2.m1.2.2.2.2.1.3"><mn id="S6.E2.m1.2.2.2.2.1.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E2.m1.2.2.2.2.1.3.1">:</mo><mrow id="S6.E2.m1.2.2.2.2.1.3.3"><mi id="S6.E2.m1.2.2.2.2.1.3.3.2">i</mi><mo id="S6.E2.m1.2.2.2.2.1.3.3.1">âˆ’</mo><mn id="S6.E2.m1.2.2.2.2.1.3.3.3">1</mn></mrow></mrow></msub></mrow><mo id="S6.E2.m1.2.2.3">âŸ</mo></munder><mtext id="S6.E2.m1.6.6.1.1.1.1.2">state</mtext></munder><mo id="S6.E2.m1.7.7.2.2.2.4">;</mo><munder id="S6.E2.m1.7.7.2.2.2.2"><munder accentunder="true" id="S6.E2.m1.7.7.2.2.2.2.2"><msub id="S6.E2.m1.7.7.2.2.2.2.2.2"><mover accent="true" id="S6.E2.m1.7.7.2.2.2.2.2.2.2"><mi id="S6.E2.m1.7.7.2.2.2.2.2.2.2.2">ğ²</mi><mo id="S6.E2.m1.7.7.2.2.2.2.2.2.2.1">^</mo></mover><mi id="S6.E2.m1.7.7.2.2.2.2.2.2.3">i</mi></msub><mo id="S6.E2.m1.7.7.2.2.2.2.2.1">âŸ</mo></munder><mtext id="S6.E2.m1.7.7.2.2.2.2.3">action</mtext></munder><mo stretchy="false" id="S6.E2.m1.7.7.2.2.2.5">)</mo></mrow></mrow><mo id="S6.E2.m1.7.7.3">=</mo><munder id="S6.E2.m1.7.7.4"><munder accentunder="true" id="S6.E2.m1.5.5"><mrow id="S6.E2.m1.5.5.3"><msub id="S6.E2.m1.5.5.3.5"><mi id="S6.E2.m1.5.5.3.5.2">ğ”¼</mi><mrow id="S6.E2.m1.3.3.1.1.1"><msubsup id="S6.E2.m1.3.3.1.1.1.2"><mi id="S6.E2.m1.3.3.1.1.1.2.2.2">ğ²</mi><mrow id="S6.E2.m1.3.3.1.1.1.2.3"><mrow id="S6.E2.m1.3.3.1.1.1.2.3.2"><mi id="S6.E2.m1.3.3.1.1.1.2.3.2.2">i</mi><mo id="S6.E2.m1.3.3.1.1.1.2.3.2.1">+</mo><mn id="S6.E2.m1.3.3.1.1.1.2.3.2.3">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S6.E2.m1.3.3.1.1.1.2.3.1">:</mo><mi id="S6.E2.m1.3.3.1.1.1.2.3.3">L</mi></mrow><mi id="S6.E2.m1.3.3.1.1.1.2.2.3">new</mi></msubsup><mo id="S6.E2.m1.3.3.1.1.1.3">âˆ¼</mo><mover accent="true" id="S6.E2.m1.3.3.1.1.1.4"><mi id="S6.E2.m1.3.3.1.1.1.4.2">Ï€</mi><mo id="S6.E2.m1.3.3.1.1.1.4.1">~</mo></mover><mrow id="S6.E2.m1.3.3.1.1.1.5"><mo stretchy="false" id="S6.E2.m1.3.3.1.1.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="S6.E2.m1.3.3.1.1.1.5.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S6.E2.m1.3.3.1.1.1.5.3">|</mo><mi id="S6.E2.m1.3.3.1.1.1.1">ğ±</mi><mo id="S6.E2.m1.3.3.1.1.1.5.4">,</mo><msub id="S6.E2.m1.3.3.1.1.1.5.5"><mover accent="true" id="S6.E2.m1.3.3.1.1.1.5.5.2"><mi id="S6.E2.m1.3.3.1.1.1.5.5.2.2">ğ²</mi><mo id="S6.E2.m1.3.3.1.1.1.5.5.2.1">^</mo></mover><mrow id="S6.E2.m1.3.3.1.1.1.5.5.3"><mn id="S6.E2.m1.3.3.1.1.1.5.5.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E2.m1.3.3.1.1.1.5.5.3.1">:</mo><mi id="S6.E2.m1.3.3.1.1.1.5.5.3.3">i</mi></mrow></msub><mo stretchy="false" id="S6.E2.m1.3.3.1.1.1.5.6">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S6.E2.m1.5.5.3.4">â€‹</mo><mrow id="S6.E2.m1.5.5.3.3.1"><mo maxsize="160%" minsize="160%" id="S6.E2.m1.5.5.3.3.1.2">[</mo><mrow id="S6.E2.m1.5.5.3.3.1.1"><mi id="S6.E2.m1.5.5.3.3.1.1.3">r</mi><mo lspace="0em" rspace="0em" id="S6.E2.m1.5.5.3.3.1.1.2">â€‹</mo><mrow id="S6.E2.m1.5.5.3.3.1.1.1.1"><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.2">(</mo><mrow id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2"><mo stretchy="false" id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.3">[</mo><msub id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1"><mover accent="true" id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.2"><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.2.2">ğ²</mi><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.2.1">^</mo></mover><mrow id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.3"><mn id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.3.1">:</mo><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.1.1.3.3">i</mi></mrow></msub><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.4">,</mo><msubsup id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2"><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.2.2">ğ²</mi><mrow id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3"><mrow id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.2"><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.2.2">i</mi><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.2.1">+</mo><mn id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.2.3">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.1">:</mo><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.3.3">L</mi></mrow><mi id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.2.2.3">new</mi></msubsup><mo stretchy="false" id="S6.E2.m1.5.5.3.3.1.1.1.1.1.2.5">]</mo></mrow><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.3">,</mo><mi id="S6.E2.m1.4.4.2.2">ğ²</mi><mo id="S6.E2.m1.5.5.3.3.1.1.1.1.4">)</mo></mrow></mrow><mo maxsize="160%" minsize="160%" id="S6.E2.m1.5.5.3.3.1.3">]</mo></mrow></mrow><mo id="S6.E2.m1.5.5.4">âŸ</mo></munder><mrow id="S6.E2.m1.7.7.4.2"><mtext id="S6.E2.m1.7.7.4.2.2">expected future reward under new actions (i.e., steps) sampled by policyÂ </mtext><mo lspace="0em" rspace="0em" id="S6.E2.m1.7.7.4.2.1">â€‹</mo><mover accent="true" id="S6.E2.m1.7.7.4.2.3"><mi id="S6.E2.m1.7.7.4.2.3.2">Ï€</mi><mo id="S6.E2.m1.7.7.4.2.3.1">~</mo></mover></mrow></munder></mrow><annotation encoding="application/x-tex" id="S6.E2.m1.7b">\displaystyle Q_{\tilde{\pi}}(\underbrace{\mathbf{x},\hat{\mathbf{y}}_{1:i-1}}_{\text{state}};\underbrace{\hat{\mathbf{y}}_{i}}_{\text{action}})=\underbrace{\mathbb{E}_{{\mathbf{y}^{\mathrm{new}}_{i+1:L}\sim\tilde{\pi}(\cdot|\mathbf{x},\hat{\mathbf{y}}_{1:i})}}\Big{[}r\left([\hat{\mathbf{y}}_{1:i},\mathbf{y}^{\mathrm{new}}_{i+1:L}],\mathbf{y}\right)\Big{]}}_{\text{expected future reward under new actions (i.e., steps) sampled by policy }\tilde{\pi}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S6.SS1.p2.25" class="ltx_p">To interpret this expression, for any partial solution upto <math id="S6.SS1.p2.10.m1.1" class="ltx_Math" alttext="i-1" display="inline"><semantics id="S6.SS1.p2.10.m1.1a"><mrow id="S6.SS1.p2.10.m1.1.1" xref="S6.SS1.p2.10.m1.1.1.cmml"><mi id="S6.SS1.p2.10.m1.1.1.2" xref="S6.SS1.p2.10.m1.1.1.2.cmml">i</mi><mo id="S6.SS1.p2.10.m1.1.1.1" xref="S6.SS1.p2.10.m1.1.1.1.cmml">âˆ’</mo><mn id="S6.SS1.p2.10.m1.1.1.3" xref="S6.SS1.p2.10.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.10.m1.1b"><apply id="S6.SS1.p2.10.m1.1.1.cmml" xref="S6.SS1.p2.10.m1.1.1"><minus id="S6.SS1.p2.10.m1.1.1.1.cmml" xref="S6.SS1.p2.10.m1.1.1.1"></minus><ci id="S6.SS1.p2.10.m1.1.1.2.cmml" xref="S6.SS1.p2.10.m1.1.1.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p2.10.m1.1.1.3.cmml" xref="S6.SS1.p2.10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.10.m1.1c">i-1</annotation></semantics></math> steps (current state: <math id="S6.SS1.p2.11.m2.2" class="ltx_Math" alttext="(\mathbf{x},\hat{\mathbf{y}}_{1:i-1})" display="inline"><semantics id="S6.SS1.p2.11.m2.2a"><mrow id="S6.SS1.p2.11.m2.2.2.1" xref="S6.SS1.p2.11.m2.2.2.2.cmml"><mo stretchy="false" id="S6.SS1.p2.11.m2.2.2.1.2" xref="S6.SS1.p2.11.m2.2.2.2.cmml">(</mo><mi id="S6.SS1.p2.11.m2.1.1" xref="S6.SS1.p2.11.m2.1.1.cmml">ğ±</mi><mo id="S6.SS1.p2.11.m2.2.2.1.3" xref="S6.SS1.p2.11.m2.2.2.2.cmml">,</mo><msub id="S6.SS1.p2.11.m2.2.2.1.1" xref="S6.SS1.p2.11.m2.2.2.1.1.cmml"><mover accent="true" id="S6.SS1.p2.11.m2.2.2.1.1.2" xref="S6.SS1.p2.11.m2.2.2.1.1.2.cmml"><mi id="S6.SS1.p2.11.m2.2.2.1.1.2.2" xref="S6.SS1.p2.11.m2.2.2.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.11.m2.2.2.1.1.2.1" xref="S6.SS1.p2.11.m2.2.2.1.1.2.1.cmml">^</mo></mover><mrow id="S6.SS1.p2.11.m2.2.2.1.1.3" xref="S6.SS1.p2.11.m2.2.2.1.1.3.cmml"><mn id="S6.SS1.p2.11.m2.2.2.1.1.3.2" xref="S6.SS1.p2.11.m2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS1.p2.11.m2.2.2.1.1.3.1" xref="S6.SS1.p2.11.m2.2.2.1.1.3.1.cmml">:</mo><mrow id="S6.SS1.p2.11.m2.2.2.1.1.3.3" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.cmml"><mi id="S6.SS1.p2.11.m2.2.2.1.1.3.3.2" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.2.cmml">i</mi><mo id="S6.SS1.p2.11.m2.2.2.1.1.3.3.1" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.SS1.p2.11.m2.2.2.1.1.3.3.3" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S6.SS1.p2.11.m2.2.2.1.4" xref="S6.SS1.p2.11.m2.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.11.m2.2b"><interval closure="open" id="S6.SS1.p2.11.m2.2.2.2.cmml" xref="S6.SS1.p2.11.m2.2.2.1"><ci id="S6.SS1.p2.11.m2.1.1.cmml" xref="S6.SS1.p2.11.m2.1.1">ğ±</ci><apply id="S6.SS1.p2.11.m2.2.2.1.1.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.11.m2.2.2.1.1.1.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1">subscript</csymbol><apply id="S6.SS1.p2.11.m2.2.2.1.1.2.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.2"><ci id="S6.SS1.p2.11.m2.2.2.1.1.2.1.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.2.1">^</ci><ci id="S6.SS1.p2.11.m2.2.2.1.1.2.2.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.2.2">ğ²</ci></apply><apply id="S6.SS1.p2.11.m2.2.2.1.1.3.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3"><ci id="S6.SS1.p2.11.m2.2.2.1.1.3.1.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.1">:</ci><cn type="integer" id="S6.SS1.p2.11.m2.2.2.1.1.3.2.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.2">1</cn><apply id="S6.SS1.p2.11.m2.2.2.1.1.3.3.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3"><minus id="S6.SS1.p2.11.m2.2.2.1.1.3.3.1.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.1"></minus><ci id="S6.SS1.p2.11.m2.2.2.1.1.3.3.2.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p2.11.m2.2.2.1.1.3.3.3.cmml" xref="S6.SS1.p2.11.m2.2.2.1.1.3.3.3">1</cn></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.11.m2.2c">(\mathbf{x},\hat{\mathbf{y}}_{1:i-1})</annotation></semantics></math>), and the next step <math id="S6.SS1.p2.12.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S6.SS1.p2.12.m3.1a"><mi id="S6.SS1.p2.12.m3.1.1" xref="S6.SS1.p2.12.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.12.m3.1b"><ci id="S6.SS1.p2.12.m3.1.1.cmml" xref="S6.SS1.p2.12.m3.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.12.m3.1c">i</annotation></semantics></math> (next action: <math id="S6.SS1.p2.13.m4.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p2.13.m4.1a"><msub id="S6.SS1.p2.13.m4.1.1" xref="S6.SS1.p2.13.m4.1.1.cmml"><mover accent="true" id="S6.SS1.p2.13.m4.1.1.2" xref="S6.SS1.p2.13.m4.1.1.2.cmml"><mi id="S6.SS1.p2.13.m4.1.1.2.2" xref="S6.SS1.p2.13.m4.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.13.m4.1.1.2.1" xref="S6.SS1.p2.13.m4.1.1.2.1.cmml">^</mo></mover><mi id="S6.SS1.p2.13.m4.1.1.3" xref="S6.SS1.p2.13.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.13.m4.1b"><apply id="S6.SS1.p2.13.m4.1.1.cmml" xref="S6.SS1.p2.13.m4.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.13.m4.1.1.1.cmml" xref="S6.SS1.p2.13.m4.1.1">subscript</csymbol><apply id="S6.SS1.p2.13.m4.1.1.2.cmml" xref="S6.SS1.p2.13.m4.1.1.2"><ci id="S6.SS1.p2.13.m4.1.1.2.1.cmml" xref="S6.SS1.p2.13.m4.1.1.2.1">^</ci><ci id="S6.SS1.p2.13.m4.1.1.2.2.cmml" xref="S6.SS1.p2.13.m4.1.1.2.2">ğ²</ci></apply><ci id="S6.SS1.p2.13.m4.1.1.3.cmml" xref="S6.SS1.p2.13.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.13.m4.1c">\hat{\mathbf{y}}_{i}</annotation></semantics></math>), the above Q-function evaluates the probability of success given the remaining budget of <math id="S6.SS1.p2.14.m5.1" class="ltx_Math" alttext="L-i" display="inline"><semantics id="S6.SS1.p2.14.m5.1a"><mrow id="S6.SS1.p2.14.m5.1.1" xref="S6.SS1.p2.14.m5.1.1.cmml"><mi id="S6.SS1.p2.14.m5.1.1.2" xref="S6.SS1.p2.14.m5.1.1.2.cmml">L</mi><mo id="S6.SS1.p2.14.m5.1.1.1" xref="S6.SS1.p2.14.m5.1.1.1.cmml">âˆ’</mo><mi id="S6.SS1.p2.14.m5.1.1.3" xref="S6.SS1.p2.14.m5.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.14.m5.1b"><apply id="S6.SS1.p2.14.m5.1.1.cmml" xref="S6.SS1.p2.14.m5.1.1"><minus id="S6.SS1.p2.14.m5.1.1.1.cmml" xref="S6.SS1.p2.14.m5.1.1.1"></minus><ci id="S6.SS1.p2.14.m5.1.1.2.cmml" xref="S6.SS1.p2.14.m5.1.1.2">ğ¿</ci><ci id="S6.SS1.p2.14.m5.1.1.3.cmml" xref="S6.SS1.p2.14.m5.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.14.m5.1c">L-i</annotation></semantics></math> more steps, in expectation over all possible futures sampled from some policy <math id="S6.SS1.p2.15.m6.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p2.15.m6.1a"><mover accent="true" id="S6.SS1.p2.15.m6.1.1" xref="S6.SS1.p2.15.m6.1.1.cmml"><mi id="S6.SS1.p2.15.m6.1.1.2" xref="S6.SS1.p2.15.m6.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p2.15.m6.1.1.1" xref="S6.SS1.p2.15.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.15.m6.1b"><apply id="S6.SS1.p2.15.m6.1.1.cmml" xref="S6.SS1.p2.15.m6.1.1"><ci id="S6.SS1.p2.15.m6.1.1.1.cmml" xref="S6.SS1.p2.15.m6.1.1.1">~</ci><ci id="S6.SS1.p2.15.m6.1.1.2.cmml" xref="S6.SS1.p2.15.m6.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.15.m6.1c">\tilde{\pi}</annotation></semantics></math>. Our conceptual model treats the policy <math id="S6.SS1.p2.16.m7.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p2.16.m7.1a"><mover accent="true" id="S6.SS1.p2.16.m7.1.1" xref="S6.SS1.p2.16.m7.1.1.cmml"><mi id="S6.SS1.p2.16.m7.1.1.2" xref="S6.SS1.p2.16.m7.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p2.16.m7.1.1.1" xref="S6.SS1.p2.16.m7.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.16.m7.1b"><apply id="S6.SS1.p2.16.m7.1.1.cmml" xref="S6.SS1.p2.16.m7.1.1"><ci id="S6.SS1.p2.16.m7.1.1.1.cmml" xref="S6.SS1.p2.16.m7.1.1.1">~</ci><ci id="S6.SS1.p2.16.m7.1.1.2.cmml" xref="S6.SS1.p2.16.m7.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.16.m7.1c">\tilde{\pi}</annotation></semantics></math> as an algorithmic design choice that can differ for algorithms using negative data. As we see later, choosing <math id="S6.SS1.p2.17.m8.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p2.17.m8.1a"><mover accent="true" id="S6.SS1.p2.17.m8.1.1" xref="S6.SS1.p2.17.m8.1.1.cmml"><mi id="S6.SS1.p2.17.m8.1.1.2" xref="S6.SS1.p2.17.m8.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p2.17.m8.1.1.1" xref="S6.SS1.p2.17.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.17.m8.1b"><apply id="S6.SS1.p2.17.m8.1.1.cmml" xref="S6.SS1.p2.17.m8.1.1"><ci id="S6.SS1.p2.17.m8.1.1.1.cmml" xref="S6.SS1.p2.17.m8.1.1.1">~</ci><ci id="S6.SS1.p2.17.m8.1.1.2.cmml" xref="S6.SS1.p2.17.m8.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.17.m8.1c">\tilde{\pi}</annotation></semantics></math> as the best-of-K distribution around <math id="S6.SS1.p2.18.m9.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS1.p2.18.m9.1a"><msub id="S6.SS1.p2.18.m9.1.1" xref="S6.SS1.p2.18.m9.1.1.cmml"><mi id="S6.SS1.p2.18.m9.1.1.2" xref="S6.SS1.p2.18.m9.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p2.18.m9.1.1.3" xref="S6.SS1.p2.18.m9.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.18.m9.1b"><apply id="S6.SS1.p2.18.m9.1.1.cmml" xref="S6.SS1.p2.18.m9.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.18.m9.1.1.1.cmml" xref="S6.SS1.p2.18.m9.1.1">subscript</csymbol><ci id="S6.SS1.p2.18.m9.1.1.2.cmml" xref="S6.SS1.p2.18.m9.1.1.2">ğœ‹</ci><ci id="S6.SS1.p2.18.m9.1.1.3.cmml" xref="S6.SS1.p2.18.m9.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.18.m9.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> (denoted as <math id="S6.SS1.p2.19.m10.1" class="ltx_Math" alttext="\text{BoK}(\pi_{\mathrm{sft}})" display="inline"><semantics id="S6.SS1.p2.19.m10.1a"><mrow id="S6.SS1.p2.19.m10.1.1" xref="S6.SS1.p2.19.m10.1.1.cmml"><mtext id="S6.SS1.p2.19.m10.1.1.3" xref="S6.SS1.p2.19.m10.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS1.p2.19.m10.1.1.2" xref="S6.SS1.p2.19.m10.1.1.2.cmml">â€‹</mo><mrow id="S6.SS1.p2.19.m10.1.1.1.1" xref="S6.SS1.p2.19.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS1.p2.19.m10.1.1.1.1.2" xref="S6.SS1.p2.19.m10.1.1.1.1.1.cmml">(</mo><msub id="S6.SS1.p2.19.m10.1.1.1.1.1" xref="S6.SS1.p2.19.m10.1.1.1.1.1.cmml"><mi id="S6.SS1.p2.19.m10.1.1.1.1.1.2" xref="S6.SS1.p2.19.m10.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p2.19.m10.1.1.1.1.1.3" xref="S6.SS1.p2.19.m10.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS1.p2.19.m10.1.1.1.1.3" xref="S6.SS1.p2.19.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.19.m10.1b"><apply id="S6.SS1.p2.19.m10.1.1.cmml" xref="S6.SS1.p2.19.m10.1.1"><times id="S6.SS1.p2.19.m10.1.1.2.cmml" xref="S6.SS1.p2.19.m10.1.1.2"></times><ci id="S6.SS1.p2.19.m10.1.1.3a.cmml" xref="S6.SS1.p2.19.m10.1.1.3"><mtext id="S6.SS1.p2.19.m10.1.1.3.cmml" xref="S6.SS1.p2.19.m10.1.1.3">BoK</mtext></ci><apply id="S6.SS1.p2.19.m10.1.1.1.1.1.cmml" xref="S6.SS1.p2.19.m10.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.19.m10.1.1.1.1.1.1.cmml" xref="S6.SS1.p2.19.m10.1.1.1.1">subscript</csymbol><ci id="S6.SS1.p2.19.m10.1.1.1.1.1.2.cmml" xref="S6.SS1.p2.19.m10.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS1.p2.19.m10.1.1.1.1.1.3.cmml" xref="S6.SS1.p2.19.m10.1.1.1.1.1.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.19.m10.1c">\text{BoK}(\pi_{\mathrm{sft}})</annotation></semantics></math>) enables a particularly interesting tradeoff between <math id="S6.SS1.p2.20.m11.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S6.SS1.p2.20.m11.1a"><mi id="S6.SS1.p2.20.m11.1.1" xref="S6.SS1.p2.20.m11.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.20.m11.1b"><ci id="S6.SS1.p2.20.m11.1.1.cmml" xref="S6.SS1.p2.20.m11.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.20.m11.1c">Q</annotation></semantics></math>-value estimation and policy improvement. Another common choice is <math id="S6.SS1.p2.21.m12.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS1.p2.21.m12.1a"><msub id="S6.SS1.p2.21.m12.1.1" xref="S6.SS1.p2.21.m12.1.1.cmml"><mi id="S6.SS1.p2.21.m12.1.1.2" xref="S6.SS1.p2.21.m12.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p2.21.m12.1.1.3" xref="S6.SS1.p2.21.m12.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.21.m12.1b"><apply id="S6.SS1.p2.21.m12.1.1.cmml" xref="S6.SS1.p2.21.m12.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.21.m12.1.1.1.cmml" xref="S6.SS1.p2.21.m12.1.1">subscript</csymbol><ci id="S6.SS1.p2.21.m12.1.1.2.cmml" xref="S6.SS1.p2.21.m12.1.1.2">ğœ‹</ci><ci id="S6.SS1.p2.21.m12.1.1.3.cmml" xref="S6.SS1.p2.21.m12.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.21.m12.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> itself.
Now, for any given step <math id="S6.SS1.p2.22.m13.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p2.22.m13.1a"><msub id="S6.SS1.p2.22.m13.1.1" xref="S6.SS1.p2.22.m13.1.1.cmml"><mover accent="true" id="S6.SS1.p2.22.m13.1.1.2" xref="S6.SS1.p2.22.m13.1.1.2.cmml"><mi id="S6.SS1.p2.22.m13.1.1.2.2" xref="S6.SS1.p2.22.m13.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.22.m13.1.1.2.1" xref="S6.SS1.p2.22.m13.1.1.2.1.cmml">^</mo></mover><mi id="S6.SS1.p2.22.m13.1.1.3" xref="S6.SS1.p2.22.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.22.m13.1b"><apply id="S6.SS1.p2.22.m13.1.1.cmml" xref="S6.SS1.p2.22.m13.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.22.m13.1.1.1.cmml" xref="S6.SS1.p2.22.m13.1.1">subscript</csymbol><apply id="S6.SS1.p2.22.m13.1.1.2.cmml" xref="S6.SS1.p2.22.m13.1.1.2"><ci id="S6.SS1.p2.22.m13.1.1.2.1.cmml" xref="S6.SS1.p2.22.m13.1.1.2.1">^</ci><ci id="S6.SS1.p2.22.m13.1.1.2.2.cmml" xref="S6.SS1.p2.22.m13.1.1.2.2">ğ²</ci></apply><ci id="S6.SS1.p2.22.m13.1.1.3.cmml" xref="S6.SS1.p2.22.m13.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.22.m13.1c">\hat{\mathbf{y}}_{i}</annotation></semantics></math>, we can define its <em id="S6.SS1.p2.25.1" class="ltx_emph ltx_font_bold ltx_font_italic">advantage</em> as the relative change in <math id="S6.SS1.p2.23.m14.1" class="ltx_Math" alttext="Q_{\tilde{\pi}}" display="inline"><semantics id="S6.SS1.p2.23.m14.1a"><msub id="S6.SS1.p2.23.m14.1.1" xref="S6.SS1.p2.23.m14.1.1.cmml"><mi id="S6.SS1.p2.23.m14.1.1.2" xref="S6.SS1.p2.23.m14.1.1.2.cmml">Q</mi><mover accent="true" id="S6.SS1.p2.23.m14.1.1.3" xref="S6.SS1.p2.23.m14.1.1.3.cmml"><mi id="S6.SS1.p2.23.m14.1.1.3.2" xref="S6.SS1.p2.23.m14.1.1.3.2.cmml">Ï€</mi><mo id="S6.SS1.p2.23.m14.1.1.3.1" xref="S6.SS1.p2.23.m14.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.23.m14.1b"><apply id="S6.SS1.p2.23.m14.1.1.cmml" xref="S6.SS1.p2.23.m14.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.23.m14.1.1.1.cmml" xref="S6.SS1.p2.23.m14.1.1">subscript</csymbol><ci id="S6.SS1.p2.23.m14.1.1.2.cmml" xref="S6.SS1.p2.23.m14.1.1.2">ğ‘„</ci><apply id="S6.SS1.p2.23.m14.1.1.3.cmml" xref="S6.SS1.p2.23.m14.1.1.3"><ci id="S6.SS1.p2.23.m14.1.1.3.1.cmml" xref="S6.SS1.p2.23.m14.1.1.3.1">~</ci><ci id="S6.SS1.p2.23.m14.1.1.3.2.cmml" xref="S6.SS1.p2.23.m14.1.1.3.2">ğœ‹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.23.m14.1c">Q_{\tilde{\pi}}</annotation></semantics></math> when adding step <math id="S6.SS1.p2.24.m15.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p2.24.m15.1a"><msub id="S6.SS1.p2.24.m15.1.1" xref="S6.SS1.p2.24.m15.1.1.cmml"><mover accent="true" id="S6.SS1.p2.24.m15.1.1.2" xref="S6.SS1.p2.24.m15.1.1.2.cmml"><mi id="S6.SS1.p2.24.m15.1.1.2.2" xref="S6.SS1.p2.24.m15.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.24.m15.1.1.2.1" xref="S6.SS1.p2.24.m15.1.1.2.1.cmml">^</mo></mover><mi id="S6.SS1.p2.24.m15.1.1.3" xref="S6.SS1.p2.24.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.24.m15.1b"><apply id="S6.SS1.p2.24.m15.1.1.cmml" xref="S6.SS1.p2.24.m15.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.24.m15.1.1.1.cmml" xref="S6.SS1.p2.24.m15.1.1">subscript</csymbol><apply id="S6.SS1.p2.24.m15.1.1.2.cmml" xref="S6.SS1.p2.24.m15.1.1.2"><ci id="S6.SS1.p2.24.m15.1.1.2.1.cmml" xref="S6.SS1.p2.24.m15.1.1.2.1">^</ci><ci id="S6.SS1.p2.24.m15.1.1.2.2.cmml" xref="S6.SS1.p2.24.m15.1.1.2.2">ğ²</ci></apply><ci id="S6.SS1.p2.24.m15.1.1.3.cmml" xref="S6.SS1.p2.24.m15.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.24.m15.1c">\hat{\mathbf{y}}_{i}</annotation></semantics></math> in comparison with other possible candidates for step <math id="S6.SS1.p2.25.m16.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S6.SS1.p2.25.m16.1a"><mi id="S6.SS1.p2.25.m16.1.1" xref="S6.SS1.p2.25.m16.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.25.m16.1b"><ci id="S6.SS1.p2.25.m16.1.1.cmml" xref="S6.SS1.p2.25.m16.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.25.m16.1c">i</annotation></semantics></math> as follows:</p>
<table id="A7.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E3.m1.4" class="ltx_Math" alttext="\displaystyle A_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-1};\hat{\mathbf{y}}_{i})=Q_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-1};\hat{\mathbf{y}}_{i})-Q_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-2};\hat{\mathbf{y}}_{i-1})." display="inline"><semantics id="S6.E3.m1.4a"><mrow id="S6.E3.m1.4.4.1" xref="S6.E3.m1.4.4.1.1.cmml"><mrow id="S6.E3.m1.4.4.1.1" xref="S6.E3.m1.4.4.1.1.cmml"><mrow id="S6.E3.m1.4.4.1.1.2" xref="S6.E3.m1.4.4.1.1.2.cmml"><msub id="S6.E3.m1.4.4.1.1.2.4" xref="S6.E3.m1.4.4.1.1.2.4.cmml"><mi id="S6.E3.m1.4.4.1.1.2.4.2" xref="S6.E3.m1.4.4.1.1.2.4.2.cmml">A</mi><mover accent="true" id="S6.E3.m1.4.4.1.1.2.4.3" xref="S6.E3.m1.4.4.1.1.2.4.3.cmml"><mi id="S6.E3.m1.4.4.1.1.2.4.3.2" xref="S6.E3.m1.4.4.1.1.2.4.3.2.cmml">Ï€</mi><mo id="S6.E3.m1.4.4.1.1.2.4.3.1" xref="S6.E3.m1.4.4.1.1.2.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.E3.m1.4.4.1.1.2.3" xref="S6.E3.m1.4.4.1.1.2.3.cmml">â€‹</mo><mrow id="S6.E3.m1.4.4.1.1.2.2.2" xref="S6.E3.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="S6.E3.m1.4.4.1.1.2.2.2.3" xref="S6.E3.m1.4.4.1.1.2.2.3.cmml">(</mo><mi id="S6.E3.m1.1.1" xref="S6.E3.m1.1.1.cmml">ğ±</mi><mo id="S6.E3.m1.4.4.1.1.2.2.2.4" xref="S6.E3.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="S6.E3.m1.4.4.1.1.1.1.1.1" xref="S6.E3.m1.4.4.1.1.1.1.1.1.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.1.1.1.1.2" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S6.E3.m1.4.4.1.1.1.1.1.1.2.2" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.1.1.1.1.2.1" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S6.E3.m1.4.4.1.1.1.1.1.1.3" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.cmml"><mn id="S6.E3.m1.4.4.1.1.1.1.1.1.3.2" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E3.m1.4.4.1.1.1.1.1.1.3.1" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.1" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S6.E3.m1.4.4.1.1.2.2.2.5" xref="S6.E3.m1.4.4.1.1.2.2.3.cmml">;</mo><msub id="S6.E3.m1.4.4.1.1.2.2.2.2" xref="S6.E3.m1.4.4.1.1.2.2.2.2.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.2.2.2.2.2" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S6.E3.m1.4.4.1.1.2.2.2.2.2.2" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.2.2.2.2.2.1" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S6.E3.m1.4.4.1.1.2.2.2.2.3" xref="S6.E3.m1.4.4.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S6.E3.m1.4.4.1.1.2.2.2.6" xref="S6.E3.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S6.E3.m1.4.4.1.1.7" xref="S6.E3.m1.4.4.1.1.7.cmml">=</mo><mrow id="S6.E3.m1.4.4.1.1.6" xref="S6.E3.m1.4.4.1.1.6.cmml"><mrow id="S6.E3.m1.4.4.1.1.4.2" xref="S6.E3.m1.4.4.1.1.4.2.cmml"><msub id="S6.E3.m1.4.4.1.1.4.2.4" xref="S6.E3.m1.4.4.1.1.4.2.4.cmml"><mi id="S6.E3.m1.4.4.1.1.4.2.4.2" xref="S6.E3.m1.4.4.1.1.4.2.4.2.cmml">Q</mi><mover accent="true" id="S6.E3.m1.4.4.1.1.4.2.4.3" xref="S6.E3.m1.4.4.1.1.4.2.4.3.cmml"><mi id="S6.E3.m1.4.4.1.1.4.2.4.3.2" xref="S6.E3.m1.4.4.1.1.4.2.4.3.2.cmml">Ï€</mi><mo id="S6.E3.m1.4.4.1.1.4.2.4.3.1" xref="S6.E3.m1.4.4.1.1.4.2.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.E3.m1.4.4.1.1.4.2.3" xref="S6.E3.m1.4.4.1.1.4.2.3.cmml">â€‹</mo><mrow id="S6.E3.m1.4.4.1.1.4.2.2.2" xref="S6.E3.m1.4.4.1.1.4.2.2.3.cmml"><mo stretchy="false" id="S6.E3.m1.4.4.1.1.4.2.2.2.3" xref="S6.E3.m1.4.4.1.1.4.2.2.3.cmml">(</mo><mi id="S6.E3.m1.2.2" xref="S6.E3.m1.2.2.cmml">ğ±</mi><mo id="S6.E3.m1.4.4.1.1.4.2.2.2.4" xref="S6.E3.m1.4.4.1.1.4.2.2.3.cmml">,</mo><msub id="S6.E3.m1.4.4.1.1.3.1.1.1.1" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.cmml"><mi id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.2" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.1" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.cmml"><mn id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.2" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.1" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.1.cmml">:</mo><mrow id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.cmml"><mi id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.2" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.2.cmml">i</mi><mo id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.1" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.3" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S6.E3.m1.4.4.1.1.4.2.2.2.5" xref="S6.E3.m1.4.4.1.1.4.2.2.3.cmml">;</mo><msub id="S6.E3.m1.4.4.1.1.4.2.2.2.2" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.cmml"><mi id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.2" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.1" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S6.E3.m1.4.4.1.1.4.2.2.2.2.3" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S6.E3.m1.4.4.1.1.4.2.2.2.6" xref="S6.E3.m1.4.4.1.1.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S6.E3.m1.4.4.1.1.6.5" xref="S6.E3.m1.4.4.1.1.6.5.cmml">âˆ’</mo><mrow id="S6.E3.m1.4.4.1.1.6.4" xref="S6.E3.m1.4.4.1.1.6.4.cmml"><msub id="S6.E3.m1.4.4.1.1.6.4.4" xref="S6.E3.m1.4.4.1.1.6.4.4.cmml"><mi id="S6.E3.m1.4.4.1.1.6.4.4.2" xref="S6.E3.m1.4.4.1.1.6.4.4.2.cmml">Q</mi><mover accent="true" id="S6.E3.m1.4.4.1.1.6.4.4.3" xref="S6.E3.m1.4.4.1.1.6.4.4.3.cmml"><mi id="S6.E3.m1.4.4.1.1.6.4.4.3.2" xref="S6.E3.m1.4.4.1.1.6.4.4.3.2.cmml">Ï€</mi><mo id="S6.E3.m1.4.4.1.1.6.4.4.3.1" xref="S6.E3.m1.4.4.1.1.6.4.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.E3.m1.4.4.1.1.6.4.3" xref="S6.E3.m1.4.4.1.1.6.4.3.cmml">â€‹</mo><mrow id="S6.E3.m1.4.4.1.1.6.4.2.2" xref="S6.E3.m1.4.4.1.1.6.4.2.3.cmml"><mo stretchy="false" id="S6.E3.m1.4.4.1.1.6.4.2.2.3" xref="S6.E3.m1.4.4.1.1.6.4.2.3.cmml">(</mo><mi id="S6.E3.m1.3.3" xref="S6.E3.m1.3.3.cmml">ğ±</mi><mo id="S6.E3.m1.4.4.1.1.6.4.2.2.4" xref="S6.E3.m1.4.4.1.1.6.4.2.3.cmml">,</mo><msub id="S6.E3.m1.4.4.1.1.5.3.1.1.1" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.cmml"><mi id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.2" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.1" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.1.cmml">^</mo></mover><mrow id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.cmml"><mn id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.2" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.1" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.1.cmml">:</mo><mrow id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.cmml"><mi id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.2" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.2.cmml">i</mi><mo id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.1" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.3" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.3.cmml">2</mn></mrow></mrow></msub><mo id="S6.E3.m1.4.4.1.1.6.4.2.2.5" xref="S6.E3.m1.4.4.1.1.6.4.2.3.cmml">;</mo><msub id="S6.E3.m1.4.4.1.1.6.4.2.2.2" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.cmml"><mover accent="true" id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.cmml"><mi id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.2" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.2.cmml">ğ²</mi><mo id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.1" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.1.cmml">^</mo></mover><mrow id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.cmml"><mi id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.2" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.2.cmml">i</mi><mo id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.1" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.1.cmml">âˆ’</mo><mn id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.3" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S6.E3.m1.4.4.1.1.6.4.2.2.6" xref="S6.E3.m1.4.4.1.1.6.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S6.E3.m1.4.4.1.2" xref="S6.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.E3.m1.4b"><apply id="S6.E3.m1.4.4.1.1.cmml" xref="S6.E3.m1.4.4.1"><eq id="S6.E3.m1.4.4.1.1.7.cmml" xref="S6.E3.m1.4.4.1.1.7"></eq><apply id="S6.E3.m1.4.4.1.1.2.cmml" xref="S6.E3.m1.4.4.1.1.2"><times id="S6.E3.m1.4.4.1.1.2.3.cmml" xref="S6.E3.m1.4.4.1.1.2.3"></times><apply id="S6.E3.m1.4.4.1.1.2.4.cmml" xref="S6.E3.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.2.4.1.cmml" xref="S6.E3.m1.4.4.1.1.2.4">subscript</csymbol><ci id="S6.E3.m1.4.4.1.1.2.4.2.cmml" xref="S6.E3.m1.4.4.1.1.2.4.2">ğ´</ci><apply id="S6.E3.m1.4.4.1.1.2.4.3.cmml" xref="S6.E3.m1.4.4.1.1.2.4.3"><ci id="S6.E3.m1.4.4.1.1.2.4.3.1.cmml" xref="S6.E3.m1.4.4.1.1.2.4.3.1">~</ci><ci id="S6.E3.m1.4.4.1.1.2.4.3.2.cmml" xref="S6.E3.m1.4.4.1.1.2.4.3.2">ğœ‹</ci></apply></apply><vector id="S6.E3.m1.4.4.1.1.2.2.3.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2"><ci id="S6.E3.m1.1.1.cmml" xref="S6.E3.m1.1.1">ğ±</ci><apply id="S6.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2"><ci id="S6.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.2.2">ğ²</ci></apply><apply id="S6.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3"><ci id="S6.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.2">1</cn><apply id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3"><minus id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.1"></minus><ci id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S6.E3.m1.4.4.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S6.E3.m1.4.4.1.1.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2"><ci id="S6.E3.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2.2.2">ğ²</ci></apply><ci id="S6.E3.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S6.E3.m1.4.4.1.1.2.2.2.2.3">ğ‘–</ci></apply></vector></apply><apply id="S6.E3.m1.4.4.1.1.6.cmml" xref="S6.E3.m1.4.4.1.1.6"><minus id="S6.E3.m1.4.4.1.1.6.5.cmml" xref="S6.E3.m1.4.4.1.1.6.5"></minus><apply id="S6.E3.m1.4.4.1.1.4.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2"><times id="S6.E3.m1.4.4.1.1.4.2.3.cmml" xref="S6.E3.m1.4.4.1.1.4.2.3"></times><apply id="S6.E3.m1.4.4.1.1.4.2.4.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.4.2.4.1.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4">subscript</csymbol><ci id="S6.E3.m1.4.4.1.1.4.2.4.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4.2">ğ‘„</ci><apply id="S6.E3.m1.4.4.1.1.4.2.4.3.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4.3"><ci id="S6.E3.m1.4.4.1.1.4.2.4.3.1.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4.3.1">~</ci><ci id="S6.E3.m1.4.4.1.1.4.2.4.3.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2.4.3.2">ğœ‹</ci></apply></apply><vector id="S6.E3.m1.4.4.1.1.4.2.2.3.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2"><ci id="S6.E3.m1.2.2.cmml" xref="S6.E3.m1.2.2">ğ±</ci><apply id="S6.E3.m1.4.4.1.1.3.1.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.3.1.1.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2"><ci id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.1.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.2.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.2.2">ğ²</ci></apply><apply id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3"><ci id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.1.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.1">:</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.2.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.2">1</cn><apply id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3"><minus id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.1.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.1"></minus><ci id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.2.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.3.cmml" xref="S6.E3.m1.4.4.1.1.3.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S6.E3.m1.4.4.1.1.4.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.4.2.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2"><ci id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.2.2">ğ²</ci></apply><ci id="S6.E3.m1.4.4.1.1.4.2.2.2.2.3.cmml" xref="S6.E3.m1.4.4.1.1.4.2.2.2.2.3">ğ‘–</ci></apply></vector></apply><apply id="S6.E3.m1.4.4.1.1.6.4.cmml" xref="S6.E3.m1.4.4.1.1.6.4"><times id="S6.E3.m1.4.4.1.1.6.4.3.cmml" xref="S6.E3.m1.4.4.1.1.6.4.3"></times><apply id="S6.E3.m1.4.4.1.1.6.4.4.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.6.4.4.1.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4">subscript</csymbol><ci id="S6.E3.m1.4.4.1.1.6.4.4.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4.2">ğ‘„</ci><apply id="S6.E3.m1.4.4.1.1.6.4.4.3.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4.3"><ci id="S6.E3.m1.4.4.1.1.6.4.4.3.1.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4.3.1">~</ci><ci id="S6.E3.m1.4.4.1.1.6.4.4.3.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.4.3.2">ğœ‹</ci></apply></apply><vector id="S6.E3.m1.4.4.1.1.6.4.2.3.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2"><ci id="S6.E3.m1.3.3.cmml" xref="S6.E3.m1.3.3">ğ±</ci><apply id="S6.E3.m1.4.4.1.1.5.3.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.5.3.1.1.1.1.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2"><ci id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.1.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.2.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.2.2">ğ²</ci></apply><apply id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3"><ci id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.1.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.1">:</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.2.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.2">1</cn><apply id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3"><minus id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.1.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.1"></minus><ci id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.2.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.3.cmml" xref="S6.E3.m1.4.4.1.1.5.3.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S6.E3.m1.4.4.1.1.6.4.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2"><csymbol cd="ambiguous" id="S6.E3.m1.4.4.1.1.6.4.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2">subscript</csymbol><apply id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2"><ci id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.1.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.1">^</ci><ci id="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.2.2">ğ²</ci></apply><apply id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3"><minus id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.1.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.1"></minus><ci id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.2.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.3.cmml" xref="S6.E3.m1.4.4.1.1.6.4.2.2.2.3.3">1</cn></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E3.m1.4c">\displaystyle A_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-1};\hat{\mathbf{y}}_{i})=Q_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-1};\hat{\mathbf{y}}_{i})-Q_{\tilde{\pi}}(\mathbf{x},\hat{\mathbf{y}}_{1:i-2};\hat{\mathbf{y}}_{i-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S6.SS1.p2.27" class="ltx_p">EquationÂ <a href="#S6.E3" title="In 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> is identical to the definition of advantage of an action (<em id="S6.SS1.p2.27.1" class="ltx_emph ltx_font_italic">i.e.</em>,Â <math id="S6.SS1.p2.26.m1.1" class="ltx_Math" alttext="\hat{\mathbf{y}}_{i}" display="inline"><semantics id="S6.SS1.p2.26.m1.1a"><msub id="S6.SS1.p2.26.m1.1.1" xref="S6.SS1.p2.26.m1.1.1.cmml"><mover accent="true" id="S6.SS1.p2.26.m1.1.1.2" xref="S6.SS1.p2.26.m1.1.1.2.cmml"><mi id="S6.SS1.p2.26.m1.1.1.2.2" xref="S6.SS1.p2.26.m1.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.26.m1.1.1.2.1" xref="S6.SS1.p2.26.m1.1.1.2.1.cmml">^</mo></mover><mi id="S6.SS1.p2.26.m1.1.1.3" xref="S6.SS1.p2.26.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.26.m1.1b"><apply id="S6.SS1.p2.26.m1.1.1.cmml" xref="S6.SS1.p2.26.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.26.m1.1.1.1.cmml" xref="S6.SS1.p2.26.m1.1.1">subscript</csymbol><apply id="S6.SS1.p2.26.m1.1.1.2.cmml" xref="S6.SS1.p2.26.m1.1.1.2"><ci id="S6.SS1.p2.26.m1.1.1.2.1.cmml" xref="S6.SS1.p2.26.m1.1.1.2.1">^</ci><ci id="S6.SS1.p2.26.m1.1.1.2.2.cmml" xref="S6.SS1.p2.26.m1.1.1.2.2">ğ²</ci></apply><ci id="S6.SS1.p2.26.m1.1.1.3.cmml" xref="S6.SS1.p2.26.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.26.m1.1c">\hat{\mathbf{y}}_{i}</annotation></semantics></math>) at a state (<math id="S6.SS1.p2.27.m2.2" class="ltx_Math" alttext="\mathbf{x},\hat{\mathbf{y}}_{1:i-1}" display="inline"><semantics id="S6.SS1.p2.27.m2.2a"><mrow id="S6.SS1.p2.27.m2.2.2.1" xref="S6.SS1.p2.27.m2.2.2.2.cmml"><mi id="S6.SS1.p2.27.m2.1.1" xref="S6.SS1.p2.27.m2.1.1.cmml">ğ±</mi><mo id="S6.SS1.p2.27.m2.2.2.1.2" xref="S6.SS1.p2.27.m2.2.2.2.cmml">,</mo><msub id="S6.SS1.p2.27.m2.2.2.1.1" xref="S6.SS1.p2.27.m2.2.2.1.1.cmml"><mover accent="true" id="S6.SS1.p2.27.m2.2.2.1.1.2" xref="S6.SS1.p2.27.m2.2.2.1.1.2.cmml"><mi id="S6.SS1.p2.27.m2.2.2.1.1.2.2" xref="S6.SS1.p2.27.m2.2.2.1.1.2.2.cmml">ğ²</mi><mo id="S6.SS1.p2.27.m2.2.2.1.1.2.1" xref="S6.SS1.p2.27.m2.2.2.1.1.2.1.cmml">^</mo></mover><mrow id="S6.SS1.p2.27.m2.2.2.1.1.3" xref="S6.SS1.p2.27.m2.2.2.1.1.3.cmml"><mn id="S6.SS1.p2.27.m2.2.2.1.1.3.2" xref="S6.SS1.p2.27.m2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS1.p2.27.m2.2.2.1.1.3.1" xref="S6.SS1.p2.27.m2.2.2.1.1.3.1.cmml">:</mo><mrow id="S6.SS1.p2.27.m2.2.2.1.1.3.3" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.cmml"><mi id="S6.SS1.p2.27.m2.2.2.1.1.3.3.2" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.2.cmml">i</mi><mo id="S6.SS1.p2.27.m2.2.2.1.1.3.3.1" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.1.cmml">âˆ’</mo><mn id="S6.SS1.p2.27.m2.2.2.1.1.3.3.3" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.27.m2.2b"><list id="S6.SS1.p2.27.m2.2.2.2.cmml" xref="S6.SS1.p2.27.m2.2.2.1"><ci id="S6.SS1.p2.27.m2.1.1.cmml" xref="S6.SS1.p2.27.m2.1.1">ğ±</ci><apply id="S6.SS1.p2.27.m2.2.2.1.1.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.27.m2.2.2.1.1.1.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1">subscript</csymbol><apply id="S6.SS1.p2.27.m2.2.2.1.1.2.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.2"><ci id="S6.SS1.p2.27.m2.2.2.1.1.2.1.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.2.1">^</ci><ci id="S6.SS1.p2.27.m2.2.2.1.1.2.2.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.2.2">ğ²</ci></apply><apply id="S6.SS1.p2.27.m2.2.2.1.1.3.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3"><ci id="S6.SS1.p2.27.m2.2.2.1.1.3.1.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.1">:</ci><cn type="integer" id="S6.SS1.p2.27.m2.2.2.1.1.3.2.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.2">1</cn><apply id="S6.SS1.p2.27.m2.2.2.1.1.3.3.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3"><minus id="S6.SS1.p2.27.m2.2.2.1.1.3.3.1.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.1"></minus><ci id="S6.SS1.p2.27.m2.2.2.1.1.3.3.2.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="S6.SS1.p2.27.m2.2.2.1.1.3.3.3.cmml" xref="S6.SS1.p2.27.m2.2.2.1.1.3.3.3">1</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.27.m2.2c">\mathbf{x},\hat{\mathbf{y}}_{1:i-1}</annotation></semantics></math>) from reinforcement learningÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. It is the gap between the Q-value of a state-action pair and the value function of the state (which is equal to the Q-value of the <em id="S6.SS1.p2.27.2" class="ltx_emph ltx_font_italic">previous</em> step due to deterministic dynamics).</p>
</div>
<figure id="S6.F6" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x9.png" id="S6.F6.g1" class="ltx_graphics ltx_img_landscape" width="456" height="257" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.3.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S6.F6.4.2" class="ltx_text" style="font-size:80%;">Illustration of advantage estimation from negative data on a didactic example in synthetic model generations. Critical steps are those with high advantage values.
</span></figcaption>
</figure>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.2" class="ltx_p"><span id="S6.SS1.p3.2.1" class="ltx_text ltx_font_bold">Critical steps, per-step DPO, and advantage-weighted RL.</span> We can use advantages (EquationÂ <a href="#S6.E3" title="In 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) to characterize critical steps.
<span id="S6.SS1.p3.2.2" class="ltx_text" style="color:#3873B3;">Steps that attain a higher advantage value than others are <span id="S6.SS1.p3.2.2.1" class="ltx_text ltx_font_bold">critical</span> since they need to be generated more precisely to solve the problem. In contrast, steps that with very low advantage values are likely worse and must be unlearned.</span>
Our definition of the advantage function implies that one can calculate advantages for each step in a response via additional Monte Carlo rollouts starting from prefixes defined by partial solutions.
One could then use these advantage estimates (EquationÂ <a href="#S6.E3" title="In 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) for training the model, for example, by running advantage-weighted reinforcement learningÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. An alternate option would be to skip the computation of advantage estimates but instead rely on implicit approaches that optimize the advantage-weighted objective without computing their values. TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a> shows that DPO performed over a precise pair distribution contrasting positive and negative traces obtained via additional rollouts from <math id="S6.SS1.p3.1.m1.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p3.1.m1.1a"><mover accent="true" id="S6.SS1.p3.1.m1.1.1" xref="S6.SS1.p3.1.m1.1.1.cmml"><mi id="S6.SS1.p3.1.m1.1.1.2" xref="S6.SS1.p3.1.m1.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p3.1.m1.1.1.1" xref="S6.SS1.p3.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.1b"><apply id="S6.SS1.p3.1.m1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1"><ci id="S6.SS1.p3.1.m1.1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1.1">~</ci><ci id="S6.SS1.p3.1.m1.1.1.2.cmml" xref="S6.SS1.p3.1.m1.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.1c">\tilde{\pi}</annotation></semantics></math>, on prefixes of a response sampled from <math id="S6.SS1.p3.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS1.p3.2.m2.1a"><msub id="S6.SS1.p3.2.m2.1.1" xref="S6.SS1.p3.2.m2.1.1.cmml"><mi id="S6.SS1.p3.2.m2.1.1.2" xref="S6.SS1.p3.2.m2.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p3.2.m2.1.1.3" xref="S6.SS1.p3.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.2.m2.1b"><apply id="S6.SS1.p3.2.m2.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.p3.2.m2.1.1.1.cmml" xref="S6.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S6.SS1.p3.2.m2.1.1.2.cmml" xref="S6.SS1.p3.2.m2.1.1.2">ğœ‹</ci><ci id="S6.SS1.p3.2.m2.1.1.3.cmml" xref="S6.SS1.p3.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>
is equivalent to advantage-weighted RL.
A proof of TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a> is in AppendixÂ <a href="#A1" title="Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>. Note that unlike the standard reduction of DPO to the RL objective under <em id="S6.SS1.p3.2.3" class="ltx_emph ltx_font_italic">some</em> reward functionÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a> is stronger in that it identifies the value function induced by per-step DPO.</p>
</div>
<div id="S6.Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S6.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem 6.1</span></span><span id="S6.Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(Equivalence of advantage-weighted RL and DPO with per-step pairs)<span id="S6.Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S6.Thmtheorem1.p1" class="ltx_para">
<p id="S6.Thmtheorem1.p1.5" class="ltx_p"><span id="S6.Thmtheorem1.p1.5.5" class="ltx_text ltx_font_italic">The optimal policy from EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with <math id="S6.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S6.Thmtheorem1.p1.1.1.m1.1a"><msubsup id="S6.Thmtheorem1.p1.1.1.m1.1.1" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.2" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S6.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3.cmml"><mi id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.2" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.3" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml">sft</mi></msub><mo id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.3" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="S6.Thmtheorem1.p1.1.1.m1.1b"><apply id="S6.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><apply id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.1.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1">superscript</csymbol><ci id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.2.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="S6.Thmtheorem1.p1.1.1.m1.1.1.2.3.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.2.3">plus-or-minus</csymbol></apply><apply id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3">subscript</csymbol><ci id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3.2">ğœ‹</ci><ci id="S6.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.1.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Thmtheorem1.p1.1.1.m1.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> given by <math id="S6.Thmtheorem1.p1.2.2.m2.3" class="ltx_Math" alttext="(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])" display="inline"><semantics id="S6.Thmtheorem1.p1.2.2.m2.3a"><mrow id="S6.Thmtheorem1.p1.2.2.m2.3.3.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">(</mo><mi id="S6.Thmtheorem1.p1.2.2.m2.1.1" xref="S6.Thmtheorem1.p1.2.2.m2.1.1.cmml">ğ±</mi><mo id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.4" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">,</mo><mrow id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.3" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">[</mo><msub id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.cmml"><mn id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.4" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">,</mo><mrow id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml"><mo id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2a" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml">+</mo><msub id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.5" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">]</mo></mrow><mo id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.5" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">,</mo><mrow id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">[</mo><msub id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.cmml"><mn id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1.cmml">:</mo><mi id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.4" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">,</mo><mrow id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml"><mo id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2a" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml">âˆ’</mo><msub id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.cmml"><mi id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2.cmml">i</mi><mo id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1.cmml">+</mo><mn id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.5" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">]</mo></mrow><mo stretchy="false" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.6" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Thmtheorem1.p1.2.2.m2.3b"><vector id="S6.Thmtheorem1.p1.2.2.m2.3.3.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2"><ci id="S6.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.1.1">ğ±</ci><interval closure="closed" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2"><apply id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3"><ci id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2">1</cn><ci id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3">ğ‘–</ci></apply></apply><apply id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2"><plus id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2"></plus><apply id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3"><plus id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1"></plus><ci id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></apply></interval><interval closure="closed" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2"><apply id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1">subscript</csymbol><ci id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3"><ci id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1">:</ci><cn type="integer" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2">1</cn><ci id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2"><minus id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2"></minus><apply id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2">subscript</csymbol><ci id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3"><plus id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1"></plus><ci id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3.cmml" xref="S6.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3">1</cn></apply></apply></apply></interval></vector></annotation-xml><annotation encoding="application/x-tex" id="S6.Thmtheorem1.p1.2.2.m2.3c">(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])</annotation></semantics></math> where the positive and negative traces share prefix <math id="S6.Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{1:i}\sim\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.Thmtheorem1.p1.3.3.m3.1a"><mrow id="S6.Thmtheorem1.p1.3.3.m3.1.1" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.cmml"><msub id="S6.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.cmml"><mi id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.2" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.cmml"><mn id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.2" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.1" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.1.cmml">:</mo><mi id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.3" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S6.Thmtheorem1.p1.3.3.m3.1.1.1" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.1.cmml">âˆ¼</mo><msub id="S6.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><mi id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml">Ï€</mi><mi id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.Thmtheorem1.p1.3.3.m3.1b"><apply id="S6.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="latexml" id="S6.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.1">similar-to</csymbol><apply id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.1.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2">subscript</csymbol><ci id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3"><ci id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.1.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.1">:</ci><cn type="integer" id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.2.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.2">1</cn><ci id="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.3.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.2.3.3">ğ‘–</ci></apply></apply><apply id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3">subscript</csymbol><ci id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3.2">ğœ‹</ci><ci id="S6.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.3.3.m3.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Thmtheorem1.p1.3.3.m3.1c">\mathbf{y}_{1:i}\sim\pi_{\mathrm{sft}}</annotation></semantics></math>, and <math id="S6.Thmtheorem1.p1.4.4.m4.1" class="ltx_math_unparsed" alttext="-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{1:i})" display="inline"><semantics id="S6.Thmtheorem1.p1.4.4.m4.1a"><mrow id="S6.Thmtheorem1.p1.4.4.m4.1b"><mo id="S6.Thmtheorem1.p1.4.4.m4.1.1">âˆ’</mo><msub id="S6.Thmtheorem1.p1.4.4.m4.1.2"><mi id="S6.Thmtheorem1.p1.4.4.m4.1.2.2">ğ²</mi><mrow id="S6.Thmtheorem1.p1.4.4.m4.1.2.3"><mi id="S6.Thmtheorem1.p1.4.4.m4.1.2.3.2">i</mi><mo id="S6.Thmtheorem1.p1.4.4.m4.1.2.3.1">+</mo><mn id="S6.Thmtheorem1.p1.4.4.m4.1.2.3.3">1</mn></mrow></msub><mo id="S6.Thmtheorem1.p1.4.4.m4.1.3">âˆ¼</mo><msub id="S6.Thmtheorem1.p1.4.4.m4.1.4"><mi id="S6.Thmtheorem1.p1.4.4.m4.1.4.2">Ï€</mi><mi id="S6.Thmtheorem1.p1.4.4.m4.1.4.3">sft</mi></msub><mrow id="S6.Thmtheorem1.p1.4.4.m4.1.5"><mo stretchy="false" id="S6.Thmtheorem1.p1.4.4.m4.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="S6.Thmtheorem1.p1.4.4.m4.1.5.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S6.Thmtheorem1.p1.4.4.m4.1.5.3">|</mo><mi id="S6.Thmtheorem1.p1.4.4.m4.1.5.4">ğ±</mi><mo id="S6.Thmtheorem1.p1.4.4.m4.1.5.5">,</mo><msub id="S6.Thmtheorem1.p1.4.4.m4.1.5.6"><mi id="S6.Thmtheorem1.p1.4.4.m4.1.5.6.2">ğ²</mi><mrow id="S6.Thmtheorem1.p1.4.4.m4.1.5.6.3"><mn id="S6.Thmtheorem1.p1.4.4.m4.1.5.6.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.4.4.m4.1.5.6.3.1">:</mo><mi id="S6.Thmtheorem1.p1.4.4.m4.1.5.6.3.3">i</mi></mrow></msub><mo stretchy="false" id="S6.Thmtheorem1.p1.4.4.m4.1.5.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.Thmtheorem1.p1.4.4.m4.1c">-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{1:i})</annotation></semantics></math>, <math id="S6.Thmtheorem1.p1.5.5.m5.4" class="ltx_Math" alttext="+\mathbf{y}_{i+1}\sim\sigma(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};\cdot)-A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};-\mathbf{y}_{i+1}))" display="inline"><semantics id="S6.Thmtheorem1.p1.5.5.m5.4a"><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.cmml"><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.cmml"><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.3a" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.cmml">+</mo><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2.cmml">i</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1.cmml">+</mo><mn id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.2.cmml">âˆ¼</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.3.cmml">Ïƒ</mi><mo lspace="0em" rspace="0em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.2.cmml">â€‹</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml">(</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml"><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.cmml"><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2.cmml">A</mi><mover accent="true" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2.cmml">Ï€</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S6.Thmtheorem1.p1.5.5.m5.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.1.1.cmml">ğ±</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">,</mo><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.cmml"><mn id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo rspace="0em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.4" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S6.Thmtheorem1.p1.5.5.m5.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.2.2.cmml">â‹…</mo><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.5" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4.cmml">âˆ’</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.cmml"><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2.cmml">A</mi><mover accent="true" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2.cmml">Ï€</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3.cmml">â€‹</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml"><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">(</mo><mi id="S6.Thmtheorem1.p1.5.5.m5.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.3.3.cmml">ğ±</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.4" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">,</mo><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.cmml"><mn id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1.cmml">:</mo><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.5" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">;</mo><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml"><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2a" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml">âˆ’</mo><msub id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2.cmml">ğ²</mi><mrow id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.cmml"><mi id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2.cmml">i</mi><mo id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1.cmml">+</mo><mn id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.6" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.3" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Thmtheorem1.p1.5.5.m5.4b"><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4"><csymbol cd="latexml" id="S6.Thmtheorem1.p1.5.5.m5.4.4.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.2">similar-to</csymbol><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3"><plus id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3"></plus><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3"><plus id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1"></plus><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2">ğ‘–</ci><cn type="integer" id="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3">1</cn></apply></apply></apply><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1"><times id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.2"></times><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.3">ğœ</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1"><minus id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4"></minus><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1"><times id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2"></times><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2">ğ´</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3"><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1">~</ci><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2">ğœ‹</ci></apply></apply><vector id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1"><ci id="S6.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.1.1">ğ±</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3"><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply><ci id="S6.Thmtheorem1.p1.5.5.m5.2.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.2.2">â‹…</ci></vector></apply><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3"><times id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3"></times><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2">ğ´</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3"><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1">~</ci><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2">ğœ‹</ci></apply></apply><vector id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2"><ci id="S6.Thmtheorem1.p1.5.5.m5.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.3.3">ğ±</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3"><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1">:</ci><cn type="integer" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2">1</cn><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3">ğ‘–</ci></apply></apply><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2"><minus id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2"></minus><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2">ğ²</ci><apply id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3"><plus id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1"></plus><ci id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3.cmml" xref="S6.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3">1</cn></apply></apply></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Thmtheorem1.p1.5.5.m5.4c">+\mathbf{y}_{i+1}\sim\sigma(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};\cdot)-A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};-\mathbf{y}_{i+1}))</annotation></semantics></math>,
is identical to the optima of the advantage-weighted RL objective:</span></p>
<table id="A7.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E4.m1.1" class="ltx_Math" alttext="\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ " display="inline"><semantics id="S6.E4.m1.1a"><mrow id="S6.E4.m1.1.1.1" xref="S6.E4.m1.1.1.1.1.cmml"><munder id="S6.E4.m1.1.1.1.1" xref="S6.E4.m1.1.1.1.1.cmml"><mi id="S6.E4.m1.1.1.1.1.2" xref="S6.E4.m1.1.1.1.1.2.cmml">max</mi><mi id="S6.E4.m1.1.1.1.1.3" xref="S6.E4.m1.1.1.1.1.3.cmml">Ï€</mi></munder><mspace width="1.167em" id="S6.E4.m1.1.1.1.2" xref="S6.E4.m1.1.1.1.1.cmml"></mspace></mrow><annotation-xml encoding="MathML-Content" id="S6.E4.m1.1b"><apply id="S6.E4.m1.1.1.1.1.cmml" xref="S6.E4.m1.1.1.1"><csymbol cd="ambiguous" id="S6.E4.m1.1.1.1.1.1.cmml" xref="S6.E4.m1.1.1.1">subscript</csymbol><max id="S6.E4.m1.1.1.1.1.2.cmml" xref="S6.E4.m1.1.1.1.1.2"></max><ci id="S6.E4.m1.1.1.1.1.3.cmml" xref="S6.E4.m1.1.1.1.1.3">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E4.m1.1c">\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ </annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E4.m2.5" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim p_{\mathrm{syn}}(\mathbf{x}),\mathbf{y}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x})}\left[\sum_{i=1}^{L}\log\pi(\mathbf{y}_{i}\big{|}\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1};\mathbf{y}_{i})/\beta\right)\right].\vspace{-0.5cm}" display="inline"><semantics id="S6.E4.m2.5a"><mrow id="S6.E4.m2.5.5.1"><mrow id="S6.E4.m2.5.5.1.1"><msub id="S6.E4.m2.5.5.1.1.3"><mi id="S6.E4.m2.5.5.1.1.3.2">ğ”¼</mi><mrow id="S6.E4.m2.1.1.1"><mi id="S6.E4.m2.1.1.1.2">ğ±</mi><mo id="S6.E4.m2.1.1.1.3">âˆ¼</mo><msub id="S6.E4.m2.1.1.1.4"><mi id="S6.E4.m2.1.1.1.4.2">p</mi><mi id="S6.E4.m2.1.1.1.4.3">syn</mi></msub><mrow id="S6.E4.m2.1.1.1.5"><mo stretchy="false" id="S6.E4.m2.1.1.1.5.1">(</mo><mi id="S6.E4.m2.1.1.1.1">ğ±</mi><mo stretchy="false" id="S6.E4.m2.1.1.1.5.2">)</mo></mrow><mo id="S6.E4.m2.1.1.1.6">,</mo><mi id="S6.E4.m2.1.1.1.7">ğ²</mi><mo id="S6.E4.m2.1.1.1.8">âˆ¼</mo><msub id="S6.E4.m2.1.1.1.9"><mi id="S6.E4.m2.1.1.1.9.2">Ï€</mi><mi id="S6.E4.m2.1.1.1.9.3">sft</mi></msub><mrow id="S6.E4.m2.1.1.1.10"><mo stretchy="false" id="S6.E4.m2.1.1.1.10.1">(</mo><mo lspace="0em" rspace="0em" id="S6.E4.m2.1.1.1.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S6.E4.m2.1.1.1.10.3">|</mo><mi id="S6.E4.m2.1.1.1.10.4">ğ±</mi><mo stretchy="false" id="S6.E4.m2.1.1.1.10.5">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S6.E4.m2.5.5.1.1.2">â€‹</mo><mrow id="S6.E4.m2.5.5.1.1.1.1"><mo id="S6.E4.m2.5.5.1.1.1.1.2">[</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1"><mstyle displaystyle="true" id="S6.E4.m2.5.5.1.1.1.1.1.3"><munderover id="S6.E4.m2.5.5.1.1.1.1.1.3a"><mo movablelimits="false" id="S6.E4.m2.5.5.1.1.1.1.1.3.2.2">âˆ‘</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.3.2.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.3.2.3.2">i</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.3.2.3.1">=</mo><mn id="S6.E4.m2.5.5.1.1.1.1.1.3.2.3.3">1</mn></mrow><mi id="S6.E4.m2.5.5.1.1.1.1.1.3.3">L</mi></munderover></mstyle><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2"><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1"><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.3a">â¡</mo><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.3.2">Ï€</mi></mrow><mo lspace="0em" rspace="0em" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.2">â€‹</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.2">(</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1"><msub id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2">ğ²</mi><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3">i</mi></msub><mo fence="false" mathsize="120%" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.2">|</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S6.E4.m2.2.2">ğ±</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">,</mo><msub id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">i</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S6.E4.m2.5.5.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo rspace="0.222em" id="S6.E4.m2.5.5.1.1.1.1.1.2.3">â‹…</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1"><mi id="S6.E4.m2.4.4">exp</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1a">â¡</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1"><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.2">(</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1"><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2"><msub id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4"><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.2">A</mi><mover accent="true" id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3.2">Ï€</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3.1">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.3">â€‹</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2"><mo stretchy="false" id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.3">(</mo><mi id="S6.E4.m2.3.3">ğ±</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.4">,</mo><msub id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1"><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3"><mn id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1">:</mo><mrow id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3"><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.2">i</mi><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.5">;</mo><msub id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2"><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2.2">ğ²</mi><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2.3">i</mi></msub><mo stretchy="false" id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.6">)</mo></mrow></mrow><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.3">/</mo><mi id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.1.4">Î²</mi></mrow><mo id="S6.E4.m2.5.5.1.1.1.1.1.2.2.1.1.3">)</mo></mrow></mrow></mrow></mrow><mo id="S6.E4.m2.5.5.1.1.1.1.3">]</mo></mrow></mrow><mo lspace="0em" id="S6.E4.m2.5.5.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="S6.E4.m2.5b">\displaystyle\mathbb{E}_{\mathbf{x}\sim p_{\mathrm{syn}}(\mathbf{x}),\mathbf{y}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x})}\left[\sum_{i=1}^{L}\log\pi(\mathbf{y}_{i}\big{|}\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1};\mathbf{y}_{i})/\beta\right)\right].\vspace{-0.5cm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S6.SS1.p4" class="ltx_para">
<p id="S6.SS1.p4.14" class="ltx_p"><span id="S6.SS1.p4.14.1" class="ltx_text ltx_font_bold">Practical instantation of DPO with per-step pairs.</span> In most of our experiments, we instantiate a practical version of the above framework, following the scheme in <cite class="ltx_cite ltx_citemacro_citet">Hwang etÂ al. [<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. This is a special case (Part 1) of the complete algorithm shown in AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Unless otherwise mentioned, we use â€œper-step DPOâ€ to refer to this version (Part 1 only) in practice. We will also experiment with the complete version (parts 1 and 2) later in SectionÂ <a href="#S6.SS3.SSS3" title="6.3.3 But, Attaining Low Generalization Error Requires Low Advantage Estimation Error â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3.3</span></a>.
Instead of computing advantage estimates for each step, and then sampling preference pairs, as described in TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>, we approximate this by only Q-value estimates on <math id="S6.SS1.p4.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S6.SS1.p4.1.m1.1a"><mn id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.1b"><cn type="integer" id="S6.SS1.p4.1.m1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.1c">8</annotation></semantics></math> negative responses for each question in the synthetic dataset,
with <math id="S6.SS1.p4.2.m2.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p4.2.m2.1a"><mover accent="true" id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml"><mi id="S6.SS1.p4.2.m2.1.1.2" xref="S6.SS1.p4.2.m2.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p4.2.m2.1.1.1" xref="S6.SS1.p4.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.1b"><apply id="S6.SS1.p4.2.m2.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1"><ci id="S6.SS1.p4.2.m2.1.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1.1">~</ci><ci id="S6.SS1.p4.2.m2.1.1.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.1c">\tilde{\pi}</annotation></semantics></math> chosen to be the best-of-K policy, <math id="S6.SS1.p4.3.m3.1" class="ltx_Math" alttext="\text{BoK}(\pi_{\mathrm{sft}})" display="inline"><semantics id="S6.SS1.p4.3.m3.1a"><mrow id="S6.SS1.p4.3.m3.1.1" xref="S6.SS1.p4.3.m3.1.1.cmml"><mtext id="S6.SS1.p4.3.m3.1.1.3" xref="S6.SS1.p4.3.m3.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS1.p4.3.m3.1.1.2" xref="S6.SS1.p4.3.m3.1.1.2.cmml">â€‹</mo><mrow id="S6.SS1.p4.3.m3.1.1.1.1" xref="S6.SS1.p4.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS1.p4.3.m3.1.1.1.1.2" xref="S6.SS1.p4.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S6.SS1.p4.3.m3.1.1.1.1.1" xref="S6.SS1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS1.p4.3.m3.1.1.1.1.1.2" xref="S6.SS1.p4.3.m3.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p4.3.m3.1.1.1.1.1.3" xref="S6.SS1.p4.3.m3.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS1.p4.3.m3.1.1.1.1.3" xref="S6.SS1.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.3.m3.1b"><apply id="S6.SS1.p4.3.m3.1.1.cmml" xref="S6.SS1.p4.3.m3.1.1"><times id="S6.SS1.p4.3.m3.1.1.2.cmml" xref="S6.SS1.p4.3.m3.1.1.2"></times><ci id="S6.SS1.p4.3.m3.1.1.3a.cmml" xref="S6.SS1.p4.3.m3.1.1.3"><mtext id="S6.SS1.p4.3.m3.1.1.3.cmml" xref="S6.SS1.p4.3.m3.1.1.3">BoK</mtext></ci><apply id="S6.SS1.p4.3.m3.1.1.1.1.1.cmml" xref="S6.SS1.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S6.SS1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS1.p4.3.m3.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS1.p4.3.m3.1.1.1.1.1.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.3.m3.1c">\text{BoK}(\pi_{\mathrm{sft}})</annotation></semantics></math> where <math id="S6.SS1.p4.4.m4.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S6.SS1.p4.4.m4.1a"><mrow id="S6.SS1.p4.4.m4.1.1" xref="S6.SS1.p4.4.m4.1.1.cmml"><mi id="S6.SS1.p4.4.m4.1.1.2" xref="S6.SS1.p4.4.m4.1.1.2.cmml">K</mi><mo id="S6.SS1.p4.4.m4.1.1.1" xref="S6.SS1.p4.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.4.m4.1.1.3" xref="S6.SS1.p4.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.4.m4.1b"><apply id="S6.SS1.p4.4.m4.1.1.cmml" xref="S6.SS1.p4.4.m4.1.1"><eq id="S6.SS1.p4.4.m4.1.1.1.cmml" xref="S6.SS1.p4.4.m4.1.1.1"></eq><ci id="S6.SS1.p4.4.m4.1.1.2.cmml" xref="S6.SS1.p4.4.m4.1.1.2">ğ¾</ci><cn type="integer" id="S6.SS1.p4.4.m4.1.1.3.cmml" xref="S6.SS1.p4.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.4.m4.1c">K=5</annotation></semantics></math>. There are two benefits associated with this choice of <math id="S6.SS1.p4.5.m5.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS1.p4.5.m5.1a"><mover accent="true" id="S6.SS1.p4.5.m5.1.1" xref="S6.SS1.p4.5.m5.1.1.cmml"><mi id="S6.SS1.p4.5.m5.1.1.2" xref="S6.SS1.p4.5.m5.1.1.2.cmml">Ï€</mi><mo id="S6.SS1.p4.5.m5.1.1.1" xref="S6.SS1.p4.5.m5.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.5.m5.1b"><apply id="S6.SS1.p4.5.m5.1.1.cmml" xref="S6.SS1.p4.5.m5.1.1"><ci id="S6.SS1.p4.5.m5.1.1.1.cmml" xref="S6.SS1.p4.5.m5.1.1.1">~</ci><ci id="S6.SS1.p4.5.m5.1.1.2.cmml" xref="S6.SS1.p4.5.m5.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.5.m5.1c">\tilde{\pi}</annotation></semantics></math>, especially a higher value of <math id="S6.SS1.p4.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS1.p4.6.m6.1a"><mi id="S6.SS1.p4.6.m6.1.1" xref="S6.SS1.p4.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.6.m6.1b"><ci id="S6.SS1.p4.6.m6.1.1.cmml" xref="S6.SS1.p4.6.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.6.m6.1c">K</annotation></semantics></math>: <span id="S6.SS1.p4.14.2" class="ltx_text ltx_font_bold">(i)</span> estimating the advantage in
EquationÂ <a href="#S6.E3" title="In 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> with Monte Carlo rollouts exhibits lower variance when <math id="S6.SS1.p4.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS1.p4.7.m7.1a"><mi id="S6.SS1.p4.7.m7.1.1" xref="S6.SS1.p4.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.7.m7.1b"><ci id="S6.SS1.p4.7.m7.1.1.cmml" xref="S6.SS1.p4.7.m7.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.7.m7.1c">K</annotation></semantics></math> is large, since a larger budget <math id="S6.SS1.p4.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS1.p4.8.m8.1a"><mi id="S6.SS1.p4.8.m8.1.1" xref="S6.SS1.p4.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.8.m8.1b"><ci id="S6.SS1.p4.8.m8.1.1.cmml" xref="S6.SS1.p4.8.m8.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.8.m8.1c">K</annotation></semantics></math> would lead most steps to have higher Q-values and the variance of Bernoulli reduces as Q-value <math id="S6.SS1.p4.9.m9.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S6.SS1.p4.9.m9.1a"><mo stretchy="false" id="S6.SS1.p4.9.m9.1.1" xref="S6.SS1.p4.9.m9.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.9.m9.1b"><ci id="S6.SS1.p4.9.m9.1.1.cmml" xref="S6.SS1.p4.9.m9.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.9.m9.1c">\rightarrow</annotation></semantics></math> <math id="S6.SS1.p4.10.m10.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S6.SS1.p4.10.m10.1a"><mn id="S6.SS1.p4.10.m10.1.1" xref="S6.SS1.p4.10.m10.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.10.m10.1b"><cn type="integer" id="S6.SS1.p4.10.m10.1.1.cmml" xref="S6.SS1.p4.10.m10.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.10.m10.1c">1</annotation></semantics></math>;
and <span id="S6.SS1.p4.14.3" class="ltx_text ltx_font_bold">(ii)</span> <math id="S6.SS1.p4.11.m11.1" class="ltx_Math" alttext="Q_{\text{BoK}({\pi_{\mathrm{sft}}})}" display="inline"><semantics id="S6.SS1.p4.11.m11.1a"><msub id="S6.SS1.p4.11.m11.1.2" xref="S6.SS1.p4.11.m11.1.2.cmml"><mi id="S6.SS1.p4.11.m11.1.2.2" xref="S6.SS1.p4.11.m11.1.2.2.cmml">Q</mi><mrow id="S6.SS1.p4.11.m11.1.1.1" xref="S6.SS1.p4.11.m11.1.1.1.cmml"><mtext id="S6.SS1.p4.11.m11.1.1.1.3" xref="S6.SS1.p4.11.m11.1.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS1.p4.11.m11.1.1.1.2" xref="S6.SS1.p4.11.m11.1.1.1.2.cmml">â€‹</mo><mrow id="S6.SS1.p4.11.m11.1.1.1.1.1" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS1.p4.11.m11.1.1.1.1.1.2" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.cmml">(</mo><msub id="S6.SS1.p4.11.m11.1.1.1.1.1.1" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.cmml"><mi id="S6.SS1.p4.11.m11.1.1.1.1.1.1.2" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p4.11.m11.1.1.1.1.1.1.3" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS1.p4.11.m11.1.1.1.1.1.3" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.11.m11.1b"><apply id="S6.SS1.p4.11.m11.1.2.cmml" xref="S6.SS1.p4.11.m11.1.2"><csymbol cd="ambiguous" id="S6.SS1.p4.11.m11.1.2.1.cmml" xref="S6.SS1.p4.11.m11.1.2">subscript</csymbol><ci id="S6.SS1.p4.11.m11.1.2.2.cmml" xref="S6.SS1.p4.11.m11.1.2.2">ğ‘„</ci><apply id="S6.SS1.p4.11.m11.1.1.1.cmml" xref="S6.SS1.p4.11.m11.1.1.1"><times id="S6.SS1.p4.11.m11.1.1.1.2.cmml" xref="S6.SS1.p4.11.m11.1.1.1.2"></times><ci id="S6.SS1.p4.11.m11.1.1.1.3a.cmml" xref="S6.SS1.p4.11.m11.1.1.1.3"><mtext mathsize="70%" id="S6.SS1.p4.11.m11.1.1.1.3.cmml" xref="S6.SS1.p4.11.m11.1.1.1.3">BoK</mtext></ci><apply id="S6.SS1.p4.11.m11.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p4.11.m11.1.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S6.SS1.p4.11.m11.1.1.1.1.1.1.2.cmml" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS1.p4.11.m11.1.1.1.1.1.1.3.cmml" xref="S6.SS1.p4.11.m11.1.1.1.1.1.1.3">sft</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.11.m11.1c">Q_{\text{BoK}({\pi_{\mathrm{sft}}})}</annotation></semantics></math> is a non-decreasing function in <math id="S6.SS1.p4.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS1.p4.12.m12.1a"><mi id="S6.SS1.p4.12.m12.1.1" xref="S6.SS1.p4.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.12.m12.1b"><ci id="S6.SS1.p4.12.m12.1.1.cmml" xref="S6.SS1.p4.12.m12.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.12.m12.1c">K</annotation></semantics></math> for any state-action, which implies that the solution of advantage-weighted RL objective, in principle, can now improve over a better policy <math id="S6.SS1.p4.13.m13.1" class="ltx_Math" alttext="\text{BoK}({\pi_{\mathrm{sft}}})" display="inline"><semantics id="S6.SS1.p4.13.m13.1a"><mrow id="S6.SS1.p4.13.m13.1.1" xref="S6.SS1.p4.13.m13.1.1.cmml"><mtext id="S6.SS1.p4.13.m13.1.1.3" xref="S6.SS1.p4.13.m13.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS1.p4.13.m13.1.1.2" xref="S6.SS1.p4.13.m13.1.1.2.cmml">â€‹</mo><mrow id="S6.SS1.p4.13.m13.1.1.1.1" xref="S6.SS1.p4.13.m13.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS1.p4.13.m13.1.1.1.1.2" xref="S6.SS1.p4.13.m13.1.1.1.1.1.cmml">(</mo><msub id="S6.SS1.p4.13.m13.1.1.1.1.1" xref="S6.SS1.p4.13.m13.1.1.1.1.1.cmml"><mi id="S6.SS1.p4.13.m13.1.1.1.1.1.2" xref="S6.SS1.p4.13.m13.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p4.13.m13.1.1.1.1.1.3" xref="S6.SS1.p4.13.m13.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS1.p4.13.m13.1.1.1.1.3" xref="S6.SS1.p4.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.13.m13.1b"><apply id="S6.SS1.p4.13.m13.1.1.cmml" xref="S6.SS1.p4.13.m13.1.1"><times id="S6.SS1.p4.13.m13.1.1.2.cmml" xref="S6.SS1.p4.13.m13.1.1.2"></times><ci id="S6.SS1.p4.13.m13.1.1.3a.cmml" xref="S6.SS1.p4.13.m13.1.1.3"><mtext id="S6.SS1.p4.13.m13.1.1.3.cmml" xref="S6.SS1.p4.13.m13.1.1.3">BoK</mtext></ci><apply id="S6.SS1.p4.13.m13.1.1.1.1.1.cmml" xref="S6.SS1.p4.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p4.13.m13.1.1.1.1.1.1.cmml" xref="S6.SS1.p4.13.m13.1.1.1.1">subscript</csymbol><ci id="S6.SS1.p4.13.m13.1.1.1.1.1.2.cmml" xref="S6.SS1.p4.13.m13.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS1.p4.13.m13.1.1.1.1.1.3.cmml" xref="S6.SS1.p4.13.m13.1.1.1.1.1.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.13.m13.1c">\text{BoK}({\pi_{\mathrm{sft}}})</annotation></semantics></math>, compared to <math id="S6.SS1.p4.14.m14.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS1.p4.14.m14.1a"><msub id="S6.SS1.p4.14.m14.1.1" xref="S6.SS1.p4.14.m14.1.1.cmml"><mi id="S6.SS1.p4.14.m14.1.1.2" xref="S6.SS1.p4.14.m14.1.1.2.cmml">Ï€</mi><mi id="S6.SS1.p4.14.m14.1.1.3" xref="S6.SS1.p4.14.m14.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.14.m14.1b"><apply id="S6.SS1.p4.14.m14.1.1.cmml" xref="S6.SS1.p4.14.m14.1.1"><csymbol cd="ambiguous" id="S6.SS1.p4.14.m14.1.1.1.cmml" xref="S6.SS1.p4.14.m14.1.1">subscript</csymbol><ci id="S6.SS1.p4.14.m14.1.1.2.cmml" xref="S6.SS1.p4.14.m14.1.1.2">ğœ‹</ci><ci id="S6.SS1.p4.14.m14.1.1.3.cmml" xref="S6.SS1.p4.14.m14.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.14.m14.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>.
We will next discuss scaling results for negative data, and then in SectionÂ <a href="#S6.SS3" title="6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3</span></a> show how per-step credit assignment improves generalization and suppresses irrelevant and incorrect steps appearing in a response, making it possible to make more use of the same synthetic data.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Per-step DPO (<span id="alg1.5.2" class="ltx_text" style="color:#3873B3;">Part 1:</span> Practical version for most experiments; <span id="alg1.6.3" class="ltx_text" style="color:#3873B3;">Parts 1 + 2:</span> Complete version)</figcaption>
<div id="alg1.7" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Synthetic dataset: <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">ğ’Ÿ</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, SFT policy finetuned on <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">ğ’Ÿ</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>: <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">Ï€</mi><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">ğœ‹</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>, sampling policy <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="alg1.l1.m4.1a"><mover accent="true" id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">Ï€</mi><mo id="alg1.l1.m4.1.1.1" xref="alg1.l1.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><ci id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1.1">~</ci><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\tilde{\pi}</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Initialize per-step DPO dataset <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\{\}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msubsup id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.2.2.2" xref="alg1.l2.m1.1.1.2.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml"><mi id="alg1.l2.m1.1.1.2.3.2" xref="alg1.l2.m1.1.1.2.3.2.cmml">Ï€</mi><mi id="alg1.l2.m1.1.1.2.3.3" xref="alg1.l2.m1.1.1.2.3.3.cmml">sft</mi></msub><mo id="alg1.l2.m1.1.1.2.2.3" xref="alg1.l2.m1.1.1.2.2.3.cmml">Â±</mo></msubsup><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">â†</mo><mrow id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.1" xref="alg1.l2.m1.1.1.3.1.cmml">{</mo><mo stretchy="false" id="alg1.l2.m1.1.1.3.2.2" xref="alg1.l2.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">â†</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><apply id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.2.1.cmml" xref="alg1.l2.m1.1.1.2">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.2.cmml" xref="alg1.l2.m1.1.1.2.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l2.m1.1.1.2.2.3.cmml" xref="alg1.l2.m1.1.1.2.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.3.1.cmml" xref="alg1.l2.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.3.2.cmml" xref="alg1.l2.m1.1.1.2.3.2">ğœ‹</ci><ci id="alg1.l2.m1.1.1.2.3.3.cmml" xref="alg1.l2.m1.1.1.2.3.3">sft</ci></apply></apply><list id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\{\}</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l3.m1.2" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y})\in\mathcal{D}_{\mathrm{syn}}\cup\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mrow id="alg1.l3.m1.2.3.2.2" xref="alg1.l3.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg1.l3.m1.2.3.2.2.1" xref="alg1.l3.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">ğ±</mi><mo id="alg1.l3.m1.2.3.2.2.2" xref="alg1.l3.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">ğ²</mi><mo stretchy="false" id="alg1.l3.m1.2.3.2.2.3" xref="alg1.l3.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l3.m1.2.3.1" xref="alg1.l3.m1.2.3.1.cmml">âˆˆ</mo><mrow id="alg1.l3.m1.2.3.3" xref="alg1.l3.m1.2.3.3.cmml"><msub id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.2.3.3.2.2" xref="alg1.l3.m1.2.3.3.2.2.cmml">ğ’Ÿ</mi><mi id="alg1.l3.m1.2.3.3.2.3" xref="alg1.l3.m1.2.3.3.2.3.cmml">syn</mi></msub><mo id="alg1.l3.m1.2.3.3.1" xref="alg1.l3.m1.2.3.3.1.cmml">âˆª</mo><msubsup id="alg1.l3.m1.2.3.3.3" xref="alg1.l3.m1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.2.3.3.3.2.2" xref="alg1.l3.m1.2.3.3.3.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l3.m1.2.3.3.3.3" xref="alg1.l3.m1.2.3.3.3.3.cmml"><mi id="alg1.l3.m1.2.3.3.3.3.2" xref="alg1.l3.m1.2.3.3.3.3.2.cmml">Ï€</mi><mi id="alg1.l3.m1.2.3.3.3.3.3" xref="alg1.l3.m1.2.3.3.3.3.3.cmml">sft</mi></msub><mo id="alg1.l3.m1.2.3.3.3.2.3" xref="alg1.l3.m1.2.3.3.3.2.3.cmml">+</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><in id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1"></in><interval closure="open" id="alg1.l3.m1.2.3.2.1.cmml" xref="alg1.l3.m1.2.3.2.2"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">ğ±</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">ğ²</ci></interval><apply id="alg1.l3.m1.2.3.3.cmml" xref="alg1.l3.m1.2.3.3"><union id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.1"></union><apply id="alg1.l3.m1.2.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.3.3.2.1.cmml" xref="alg1.l3.m1.2.3.3.2">subscript</csymbol><ci id="alg1.l3.m1.2.3.3.2.2.cmml" xref="alg1.l3.m1.2.3.3.2.2">ğ’Ÿ</ci><ci id="alg1.l3.m1.2.3.3.2.3.cmml" xref="alg1.l3.m1.2.3.3.2.3">syn</ci></apply><apply id="alg1.l3.m1.2.3.3.3.cmml" xref="alg1.l3.m1.2.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.3.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.3">subscript</csymbol><apply id="alg1.l3.m1.2.3.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.3.3.3.2.1.cmml" xref="alg1.l3.m1.2.3.3.3">superscript</csymbol><ci id="alg1.l3.m1.2.3.3.3.2.2.cmml" xref="alg1.l3.m1.2.3.3.3.2.2">ğ’Ÿ</ci><plus id="alg1.l3.m1.2.3.3.3.2.3.cmml" xref="alg1.l3.m1.2.3.3.3.2.3"></plus></apply><apply id="alg1.l3.m1.2.3.3.3.3.cmml" xref="alg1.l3.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.3.3.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.3.3">subscript</csymbol><ci id="alg1.l3.m1.2.3.3.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.3.3.2">ğœ‹</ci><ci id="alg1.l3.m1.2.3.3.3.3.3.cmml" xref="alg1.l3.m1.2.3.3.3.3.3">sft</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">(\mathbf{x},\mathbf{y})\in\mathcal{D}_{\mathrm{syn}}\cup\mathcal{D}^{+}_{\pi_{\mathrm{sft}}}</annotation></semantics></math>Â <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Â Â Â <span id="alg1.l4.2" class="ltx_text" style="color:#3873B3;"># <span id="alg1.l4.2.1" class="ltx_text ltx_font_bold">Part 1: </span>Identify critical steps in incorrect responses</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Â Â Â Sample multiple incorrect answers <math id="alg1.l5.m1.1" class="ltx_math_unparsed" alttext="-\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1b"><mo id="alg1.l5.m1.1.1">âˆ’</mo><mover accent="true" id="alg1.l5.m1.1.2"><mi id="alg1.l5.m1.1.2.2">ğ²</mi><mo id="alg1.l5.m1.1.2.1">^</mo></mover><mo id="alg1.l5.m1.1.3">âˆ¼</mo><msub id="alg1.l5.m1.1.4"><mi id="alg1.l5.m1.1.4.2">Ï€</mi><mi id="alg1.l5.m1.1.4.3">sft</mi></msub><mrow id="alg1.l5.m1.1.5"><mo stretchy="false" id="alg1.l5.m1.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.5.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="alg1.l5.m1.1.5.3">âˆ£</mo><mi id="alg1.l5.m1.1.5.4">ğ±</mi><mo stretchy="false" id="alg1.l5.m1.1.5.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">-\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})</annotation></semantics></math>, and collect them in set <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\mathcal{C}(\mathbf{x})" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.2" xref="alg1.l5.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.2.2" xref="alg1.l5.m2.1.2.2.cmml">ğ’</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.2.1" xref="alg1.l5.m2.1.2.1.cmml">â€‹</mo><mrow id="alg1.l5.m2.1.2.3.2" xref="alg1.l5.m2.1.2.cmml"><mo stretchy="false" id="alg1.l5.m2.1.2.3.2.1" xref="alg1.l5.m2.1.2.cmml">(</mo><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">ğ±</mi><mo stretchy="false" id="alg1.l5.m2.1.2.3.2.2" xref="alg1.l5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.2.cmml" xref="alg1.l5.m2.1.2"><times id="alg1.l5.m2.1.2.1.cmml" xref="alg1.l5.m2.1.2.1"></times><ci id="alg1.l5.m2.1.2.2.cmml" xref="alg1.l5.m2.1.2.2">ğ’</ci><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">ğ±</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\mathcal{C}(\mathbf{x})</annotation></semantics></math>.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â Â Â Â <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l6.m1.4" class="ltx_Math" alttext="-\hat{\mathbf{y}}:=\left[-\hat{\mathbf{y}}_{1},\ldots,-\hat{\mathbf{y}}_{L}\right]\in\mathcal{C}(\mathbf{x})" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mrow id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml"><mo id="alg1.l6.m1.4.4.4a" xref="alg1.l6.m1.4.4.4.cmml">âˆ’</mo><mover accent="true" id="alg1.l6.m1.4.4.4.2" xref="alg1.l6.m1.4.4.4.2.cmml"><mi id="alg1.l6.m1.4.4.4.2.2" xref="alg1.l6.m1.4.4.4.2.2.cmml">ğ²</mi><mo id="alg1.l6.m1.4.4.4.2.1" xref="alg1.l6.m1.4.4.4.2.1.cmml">^</mo></mover></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l6.m1.4.4.5" xref="alg1.l6.m1.4.4.5.cmml">:=</mo><mrow id="alg1.l6.m1.4.4.2.2" xref="alg1.l6.m1.4.4.2.3.cmml"><mo id="alg1.l6.m1.4.4.2.2.3" xref="alg1.l6.m1.4.4.2.3.cmml">[</mo><mrow id="alg1.l6.m1.3.3.1.1.1" xref="alg1.l6.m1.3.3.1.1.1.cmml"><mo id="alg1.l6.m1.3.3.1.1.1a" xref="alg1.l6.m1.3.3.1.1.1.cmml">âˆ’</mo><msub id="alg1.l6.m1.3.3.1.1.1.2" xref="alg1.l6.m1.3.3.1.1.1.2.cmml"><mover accent="true" id="alg1.l6.m1.3.3.1.1.1.2.2" xref="alg1.l6.m1.3.3.1.1.1.2.2.cmml"><mi id="alg1.l6.m1.3.3.1.1.1.2.2.2" xref="alg1.l6.m1.3.3.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l6.m1.3.3.1.1.1.2.2.1" xref="alg1.l6.m1.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg1.l6.m1.3.3.1.1.1.2.3" xref="alg1.l6.m1.3.3.1.1.1.2.3.cmml">1</mn></msub></mrow><mo id="alg1.l6.m1.4.4.2.2.4" xref="alg1.l6.m1.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">â€¦</mi><mo id="alg1.l6.m1.4.4.2.2.5" xref="alg1.l6.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.l6.m1.4.4.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.cmml"><mo id="alg1.l6.m1.4.4.2.2.2a" xref="alg1.l6.m1.4.4.2.2.2.cmml">âˆ’</mo><msub id="alg1.l6.m1.4.4.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.cmml"><mover accent="true" id="alg1.l6.m1.4.4.2.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.4.4.2.2.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l6.m1.4.4.2.2.2.2.2.1" xref="alg1.l6.m1.4.4.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l6.m1.4.4.2.2.2.2.3" xref="alg1.l6.m1.4.4.2.2.2.2.3.cmml">L</mi></msub></mrow><mo id="alg1.l6.m1.4.4.2.2.6" xref="alg1.l6.m1.4.4.2.3.cmml">]</mo></mrow><mo id="alg1.l6.m1.4.4.6" xref="alg1.l6.m1.4.4.6.cmml">âˆˆ</mo><mrow id="alg1.l6.m1.4.4.7" xref="alg1.l6.m1.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.4.4.7.2" xref="alg1.l6.m1.4.4.7.2.cmml">ğ’</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.7.1" xref="alg1.l6.m1.4.4.7.1.cmml">â€‹</mo><mrow id="alg1.l6.m1.4.4.7.3.2" xref="alg1.l6.m1.4.4.7.cmml"><mo stretchy="false" id="alg1.l6.m1.4.4.7.3.2.1" xref="alg1.l6.m1.4.4.7.cmml">(</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">ğ±</mi><mo stretchy="false" id="alg1.l6.m1.4.4.7.3.2.2" xref="alg1.l6.m1.4.4.7.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><and id="alg1.l6.m1.4.4a.cmml" xref="alg1.l6.m1.4.4"></and><apply id="alg1.l6.m1.4.4b.cmml" xref="alg1.l6.m1.4.4"><csymbol cd="latexml" id="alg1.l6.m1.4.4.5.cmml" xref="alg1.l6.m1.4.4.5">assign</csymbol><apply id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4"><minus id="alg1.l6.m1.4.4.4.1.cmml" xref="alg1.l6.m1.4.4.4"></minus><apply id="alg1.l6.m1.4.4.4.2.cmml" xref="alg1.l6.m1.4.4.4.2"><ci id="alg1.l6.m1.4.4.4.2.1.cmml" xref="alg1.l6.m1.4.4.4.2.1">^</ci><ci id="alg1.l6.m1.4.4.4.2.2.cmml" xref="alg1.l6.m1.4.4.4.2.2">ğ²</ci></apply></apply><list id="alg1.l6.m1.4.4.2.3.cmml" xref="alg1.l6.m1.4.4.2.2"><apply id="alg1.l6.m1.3.3.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1"><minus id="alg1.l6.m1.3.3.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1"></minus><apply id="alg1.l6.m1.3.3.1.1.1.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.2">subscript</csymbol><apply id="alg1.l6.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.2.2"><ci id="alg1.l6.m1.3.3.1.1.1.2.2.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.2.2.1">^</ci><ci id="alg1.l6.m1.3.3.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.2.2.2">ğ²</ci></apply><cn type="integer" id="alg1.l6.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.2.3">1</cn></apply></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">â€¦</ci><apply id="alg1.l6.m1.4.4.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2"><minus id="alg1.l6.m1.4.4.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.2.2.2"></minus><apply id="alg1.l6.m1.4.4.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.2.2.2.2">subscript</csymbol><apply id="alg1.l6.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.2"><ci id="alg1.l6.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.2.1">^</ci><ci id="alg1.l6.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l6.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.3">ğ¿</ci></apply></apply></list></apply><apply id="alg1.l6.m1.4.4c.cmml" xref="alg1.l6.m1.4.4"><in id="alg1.l6.m1.4.4.6.cmml" xref="alg1.l6.m1.4.4.6"></in><share href="#alg1.l6.m1.4.4.2.cmml" id="alg1.l6.m1.4.4d.cmml" xref="alg1.l6.m1.4.4"></share><apply id="alg1.l6.m1.4.4.7.cmml" xref="alg1.l6.m1.4.4.7"><times id="alg1.l6.m1.4.4.7.1.cmml" xref="alg1.l6.m1.4.4.7.1"></times><ci id="alg1.l6.m1.4.4.7.2.cmml" xref="alg1.l6.m1.4.4.7.2">ğ’</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">ğ±</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">-\hat{\mathbf{y}}:=\left[-\hat{\mathbf{y}}_{1},\ldots,-\hat{\mathbf{y}}_{L}\right]\in\mathcal{C}(\mathbf{x})</annotation></semantics></math>Â <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â Â Â Â Â Â Â Â Compute the Monte Carlo estimate for <math id="alg1.l7.m1.3" class="ltx_Math" alttext="Q_{\tilde{\pi}}(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1};-\hat{\mathbf{y}}_{i})" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><msub id="alg1.l7.m1.3.3.4" xref="alg1.l7.m1.3.3.4.cmml"><mi id="alg1.l7.m1.3.3.4.2" xref="alg1.l7.m1.3.3.4.2.cmml">Q</mi><mover accent="true" id="alg1.l7.m1.3.3.4.3" xref="alg1.l7.m1.3.3.4.3.cmml"><mi id="alg1.l7.m1.3.3.4.3.2" xref="alg1.l7.m1.3.3.4.3.2.cmml">Ï€</mi><mo id="alg1.l7.m1.3.3.4.3.1" xref="alg1.l7.m1.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.3" xref="alg1.l7.m1.3.3.3.cmml">â€‹</mo><mrow id="alg1.l7.m1.3.3.2.2" xref="alg1.l7.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.2.2.3" xref="alg1.l7.m1.3.3.2.3.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">ğ±</mi><mo id="alg1.l7.m1.3.3.2.2.4" xref="alg1.l7.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l7.m1.2.2.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.cmml"><mo id="alg1.l7.m1.2.2.1.1.1a" xref="alg1.l7.m1.2.2.1.1.1.cmml">âˆ’</mo><msub id="alg1.l7.m1.2.2.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.2.cmml"><mover accent="true" id="alg1.l7.m1.2.2.1.1.1.2.2" xref="alg1.l7.m1.2.2.1.1.1.2.2.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.2.2.2" xref="alg1.l7.m1.2.2.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l7.m1.2.2.1.1.1.2.2.1" xref="alg1.l7.m1.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l7.m1.2.2.1.1.1.2.3" xref="alg1.l7.m1.2.2.1.1.1.2.3.cmml"><mn id="alg1.l7.m1.2.2.1.1.1.2.3.2" xref="alg1.l7.m1.2.2.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l7.m1.2.2.1.1.1.2.3.1" xref="alg1.l7.m1.2.2.1.1.1.2.3.1.cmml">:</mo><mrow id="alg1.l7.m1.2.2.1.1.1.2.3.3" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.2.3.3.2" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.2.cmml">i</mi><mo id="alg1.l7.m1.2.2.1.1.1.2.3.3.1" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="alg1.l7.m1.2.2.1.1.1.2.3.3.3" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="alg1.l7.m1.3.3.2.2.5" xref="alg1.l7.m1.3.3.2.3.cmml">;</mo><mrow id="alg1.l7.m1.3.3.2.2.2" xref="alg1.l7.m1.3.3.2.2.2.cmml"><mo id="alg1.l7.m1.3.3.2.2.2a" xref="alg1.l7.m1.3.3.2.2.2.cmml">âˆ’</mo><msub id="alg1.l7.m1.3.3.2.2.2.2" xref="alg1.l7.m1.3.3.2.2.2.2.cmml"><mover accent="true" id="alg1.l7.m1.3.3.2.2.2.2.2" xref="alg1.l7.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.3.3.2.2.2.2.2.2" xref="alg1.l7.m1.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l7.m1.3.3.2.2.2.2.2.1" xref="alg1.l7.m1.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l7.m1.3.3.2.2.2.2.3" xref="alg1.l7.m1.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.2.2.6" xref="alg1.l7.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><times id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.3"></times><apply id="alg1.l7.m1.3.3.4.cmml" xref="alg1.l7.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.4.1.cmml" xref="alg1.l7.m1.3.3.4">subscript</csymbol><ci id="alg1.l7.m1.3.3.4.2.cmml" xref="alg1.l7.m1.3.3.4.2">ğ‘„</ci><apply id="alg1.l7.m1.3.3.4.3.cmml" xref="alg1.l7.m1.3.3.4.3"><ci id="alg1.l7.m1.3.3.4.3.1.cmml" xref="alg1.l7.m1.3.3.4.3.1">~</ci><ci id="alg1.l7.m1.3.3.4.3.2.cmml" xref="alg1.l7.m1.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="alg1.l7.m1.3.3.2.3.cmml" xref="alg1.l7.m1.3.3.2.2"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">ğ±</ci><apply id="alg1.l7.m1.2.2.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1"><minus id="alg1.l7.m1.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1"></minus><apply id="alg1.l7.m1.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.2">subscript</csymbol><apply id="alg1.l7.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.2"><ci id="alg1.l7.m1.2.2.1.1.1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.2.1">^</ci><ci id="alg1.l7.m1.2.2.1.1.1.2.2.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l7.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3"><ci id="alg1.l7.m1.2.2.1.1.1.2.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l7.m1.2.2.1.1.1.2.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.2">1</cn><apply id="alg1.l7.m1.2.2.1.1.1.2.3.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.3"><minus id="alg1.l7.m1.2.2.1.1.1.2.3.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.1"></minus><ci id="alg1.l7.m1.2.2.1.1.1.2.3.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="alg1.l7.m1.2.2.1.1.1.2.3.3.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l7.m1.3.3.2.2.2.cmml" xref="alg1.l7.m1.3.3.2.2.2"><minus id="alg1.l7.m1.3.3.2.2.2.1.cmml" xref="alg1.l7.m1.3.3.2.2.2"></minus><apply id="alg1.l7.m1.3.3.2.2.2.2.cmml" xref="alg1.l7.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l7.m1.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l7.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l7.m1.3.3.2.2.2.2.2"><ci id="alg1.l7.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.3.3.2.2.2.2.2.1">^</ci><ci id="alg1.l7.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.3.3.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l7.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l7.m1.3.3.2.2.2.2.3">ğ‘–</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">Q_{\tilde{\pi}}(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1};-\hat{\mathbf{y}}_{i})</annotation></semantics></math> for each step <math id="alg1.l7.m2.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}_{i}" display="inline"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mo id="alg1.l7.m2.1.1a" xref="alg1.l7.m2.1.1.cmml">âˆ’</mo><msub id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml"><mover accent="true" id="alg1.l7.m2.1.1.2.2" xref="alg1.l7.m2.1.1.2.2.cmml"><mi id="alg1.l7.m2.1.1.2.2.2" xref="alg1.l7.m2.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l7.m2.1.1.2.2.1" xref="alg1.l7.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="alg1.l7.m2.1.1.2.3" xref="alg1.l7.m2.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><minus id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1"></minus><apply id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.2.1.cmml" xref="alg1.l7.m2.1.1.2">subscript</csymbol><apply id="alg1.l7.m2.1.1.2.2.cmml" xref="alg1.l7.m2.1.1.2.2"><ci id="alg1.l7.m2.1.1.2.2.1.cmml" xref="alg1.l7.m2.1.1.2.2.1">^</ci><ci id="alg1.l7.m2.1.1.2.2.2.cmml" xref="alg1.l7.m2.1.1.2.2.2">ğ²</ci></apply><ci id="alg1.l7.m2.1.1.2.3.cmml" xref="alg1.l7.m2.1.1.2.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">-\hat{\mathbf{y}}_{i}</annotation></semantics></math>.

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Â Â Â Â Â Â Â If <math id="alg1.l8.m1.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}_{c}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mo id="alg1.l8.m1.1.1a" xref="alg1.l8.m1.1.1.cmml">âˆ’</mo><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mover accent="true" id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml"><mi id="alg1.l8.m1.1.1.2.2.2" xref="alg1.l8.m1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l8.m1.1.1.2.2.1" xref="alg1.l8.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><minus id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1"></minus><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><apply id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2"><ci id="alg1.l8.m1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.2.2.1">^</ci><ci id="alg1.l8.m1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.2.2.2">ğ²</ci></apply><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">-\hat{\mathbf{y}}_{c}</annotation></semantics></math> is the first step with least <math id="alg1.l8.m2.3" class="ltx_Math" alttext="Q_{\tilde{\pi}}(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1};-\hat{\mathbf{y}}_{i})" display="inline"><semantics id="alg1.l8.m2.3a"><mrow id="alg1.l8.m2.3.3" xref="alg1.l8.m2.3.3.cmml"><msub id="alg1.l8.m2.3.3.4" xref="alg1.l8.m2.3.3.4.cmml"><mi id="alg1.l8.m2.3.3.4.2" xref="alg1.l8.m2.3.3.4.2.cmml">Q</mi><mover accent="true" id="alg1.l8.m2.3.3.4.3" xref="alg1.l8.m2.3.3.4.3.cmml"><mi id="alg1.l8.m2.3.3.4.3.2" xref="alg1.l8.m2.3.3.4.3.2.cmml">Ï€</mi><mo id="alg1.l8.m2.3.3.4.3.1" xref="alg1.l8.m2.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m2.3.3.3" xref="alg1.l8.m2.3.3.3.cmml">â€‹</mo><mrow id="alg1.l8.m2.3.3.2.2" xref="alg1.l8.m2.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l8.m2.3.3.2.2.3" xref="alg1.l8.m2.3.3.2.3.cmml">(</mo><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">ğ±</mi><mo id="alg1.l8.m2.3.3.2.2.4" xref="alg1.l8.m2.3.3.2.3.cmml">,</mo><mrow id="alg1.l8.m2.2.2.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.cmml"><mo id="alg1.l8.m2.2.2.1.1.1a" xref="alg1.l8.m2.2.2.1.1.1.cmml">âˆ’</mo><msub id="alg1.l8.m2.2.2.1.1.1.2" xref="alg1.l8.m2.2.2.1.1.1.2.cmml"><mover accent="true" id="alg1.l8.m2.2.2.1.1.1.2.2" xref="alg1.l8.m2.2.2.1.1.1.2.2.cmml"><mi id="alg1.l8.m2.2.2.1.1.1.2.2.2" xref="alg1.l8.m2.2.2.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l8.m2.2.2.1.1.1.2.2.1" xref="alg1.l8.m2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l8.m2.2.2.1.1.1.2.3" xref="alg1.l8.m2.2.2.1.1.1.2.3.cmml"><mn id="alg1.l8.m2.2.2.1.1.1.2.3.2" xref="alg1.l8.m2.2.2.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l8.m2.2.2.1.1.1.2.3.1" xref="alg1.l8.m2.2.2.1.1.1.2.3.1.cmml">:</mo><mrow id="alg1.l8.m2.2.2.1.1.1.2.3.3" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.cmml"><mi id="alg1.l8.m2.2.2.1.1.1.2.3.3.2" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.2.cmml">i</mi><mo id="alg1.l8.m2.2.2.1.1.1.2.3.3.1" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="alg1.l8.m2.2.2.1.1.1.2.3.3.3" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="alg1.l8.m2.3.3.2.2.5" xref="alg1.l8.m2.3.3.2.3.cmml">;</mo><mrow id="alg1.l8.m2.3.3.2.2.2" xref="alg1.l8.m2.3.3.2.2.2.cmml"><mo id="alg1.l8.m2.3.3.2.2.2a" xref="alg1.l8.m2.3.3.2.2.2.cmml">âˆ’</mo><msub id="alg1.l8.m2.3.3.2.2.2.2" xref="alg1.l8.m2.3.3.2.2.2.2.cmml"><mover accent="true" id="alg1.l8.m2.3.3.2.2.2.2.2" xref="alg1.l8.m2.3.3.2.2.2.2.2.cmml"><mi id="alg1.l8.m2.3.3.2.2.2.2.2.2" xref="alg1.l8.m2.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l8.m2.3.3.2.2.2.2.2.1" xref="alg1.l8.m2.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l8.m2.3.3.2.2.2.2.3" xref="alg1.l8.m2.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l8.m2.3.3.2.2.6" xref="alg1.l8.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.3b"><apply id="alg1.l8.m2.3.3.cmml" xref="alg1.l8.m2.3.3"><times id="alg1.l8.m2.3.3.3.cmml" xref="alg1.l8.m2.3.3.3"></times><apply id="alg1.l8.m2.3.3.4.cmml" xref="alg1.l8.m2.3.3.4"><csymbol cd="ambiguous" id="alg1.l8.m2.3.3.4.1.cmml" xref="alg1.l8.m2.3.3.4">subscript</csymbol><ci id="alg1.l8.m2.3.3.4.2.cmml" xref="alg1.l8.m2.3.3.4.2">ğ‘„</ci><apply id="alg1.l8.m2.3.3.4.3.cmml" xref="alg1.l8.m2.3.3.4.3"><ci id="alg1.l8.m2.3.3.4.3.1.cmml" xref="alg1.l8.m2.3.3.4.3.1">~</ci><ci id="alg1.l8.m2.3.3.4.3.2.cmml" xref="alg1.l8.m2.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="alg1.l8.m2.3.3.2.3.cmml" xref="alg1.l8.m2.3.3.2.2"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">ğ±</ci><apply id="alg1.l8.m2.2.2.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1"><minus id="alg1.l8.m2.2.2.1.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1"></minus><apply id="alg1.l8.m2.2.2.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.1.2.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.2">subscript</csymbol><apply id="alg1.l8.m2.2.2.1.1.1.2.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.2"><ci id="alg1.l8.m2.2.2.1.1.1.2.2.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.2.1">^</ci><ci id="alg1.l8.m2.2.2.1.1.1.2.2.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l8.m2.2.2.1.1.1.2.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3"><ci id="alg1.l8.m2.2.2.1.1.1.2.3.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l8.m2.2.2.1.1.1.2.3.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.2">1</cn><apply id="alg1.l8.m2.2.2.1.1.1.2.3.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.3"><minus id="alg1.l8.m2.2.2.1.1.1.2.3.3.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.1"></minus><ci id="alg1.l8.m2.2.2.1.1.1.2.3.3.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="alg1.l8.m2.2.2.1.1.1.2.3.3.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l8.m2.3.3.2.2.2.cmml" xref="alg1.l8.m2.3.3.2.2.2"><minus id="alg1.l8.m2.3.3.2.2.2.1.cmml" xref="alg1.l8.m2.3.3.2.2.2"></minus><apply id="alg1.l8.m2.3.3.2.2.2.2.cmml" xref="alg1.l8.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m2.3.3.2.2.2.2.1.cmml" xref="alg1.l8.m2.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l8.m2.3.3.2.2.2.2.2.cmml" xref="alg1.l8.m2.3.3.2.2.2.2.2"><ci id="alg1.l8.m2.3.3.2.2.2.2.2.1.cmml" xref="alg1.l8.m2.3.3.2.2.2.2.2.1">^</ci><ci id="alg1.l8.m2.3.3.2.2.2.2.2.2.cmml" xref="alg1.l8.m2.3.3.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l8.m2.3.3.2.2.2.2.3.cmml" xref="alg1.l8.m2.3.3.2.2.2.2.3">ğ‘–</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.3c">Q_{\tilde{\pi}}(\mathbf{x},-\hat{\mathbf{y}}_{1:i-1};-\hat{\mathbf{y}}_{i})</annotation></semantics></math>, then <math id="alg1.l8.m3.3" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\cup\{(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}}_{1:c})\}" display="inline"><semantics id="alg1.l8.m3.3a"><mrow id="alg1.l8.m3.3.3" xref="alg1.l8.m3.3.3.cmml"><msubsup id="alg1.l8.m3.3.3.3" xref="alg1.l8.m3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.3.3.3.2.2" xref="alg1.l8.m3.3.3.3.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l8.m3.3.3.3.3" xref="alg1.l8.m3.3.3.3.3.cmml"><mi id="alg1.l8.m3.3.3.3.3.2" xref="alg1.l8.m3.3.3.3.3.2.cmml">Ï€</mi><mi id="alg1.l8.m3.3.3.3.3.3" xref="alg1.l8.m3.3.3.3.3.3.cmml">sft</mi></msub><mo id="alg1.l8.m3.3.3.3.2.3" xref="alg1.l8.m3.3.3.3.2.3.cmml">Â±</mo></msubsup><mo stretchy="false" id="alg1.l8.m3.3.3.2" xref="alg1.l8.m3.3.3.2.cmml">â†</mo><mrow id="alg1.l8.m3.3.3.1" xref="alg1.l8.m3.3.3.1.cmml"><msubsup id="alg1.l8.m3.3.3.1.3" xref="alg1.l8.m3.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.3.3.1.3.2.2" xref="alg1.l8.m3.3.3.1.3.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l8.m3.3.3.1.3.3" xref="alg1.l8.m3.3.3.1.3.3.cmml"><mi id="alg1.l8.m3.3.3.1.3.3.2" xref="alg1.l8.m3.3.3.1.3.3.2.cmml">Ï€</mi><mi id="alg1.l8.m3.3.3.1.3.3.3" xref="alg1.l8.m3.3.3.1.3.3.3.cmml">sft</mi></msub><mo id="alg1.l8.m3.3.3.1.3.2.3" xref="alg1.l8.m3.3.3.1.3.2.3.cmml">Â±</mo></msubsup><mo id="alg1.l8.m3.3.3.1.2" xref="alg1.l8.m3.3.3.1.2.cmml">âˆª</mo><mrow id="alg1.l8.m3.3.3.1.1.1" xref="alg1.l8.m3.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m3.3.3.1.1.1.2" xref="alg1.l8.m3.3.3.1.1.2.cmml">{</mo><mrow id="alg1.l8.m3.3.3.1.1.1.1.1" xref="alg1.l8.m3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m3.3.3.1.1.1.1.1.2" xref="alg1.l8.m3.3.3.1.1.1.1.2.cmml">(</mo><mi id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">ğ±</mi><mo id="alg1.l8.m3.3.3.1.1.1.1.1.3" xref="alg1.l8.m3.3.3.1.1.1.1.2.cmml">,</mo><mi id="alg1.l8.m3.2.2" xref="alg1.l8.m3.2.2.cmml">ğ²</mi><mo id="alg1.l8.m3.3.3.1.1.1.1.1.4" xref="alg1.l8.m3.3.3.1.1.1.1.2.cmml">,</mo><mrow id="alg1.l8.m3.3.3.1.1.1.1.1.1" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.cmml"><mo id="alg1.l8.m3.3.3.1.1.1.1.1.1a" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.cmml">âˆ’</mo><msub id="alg1.l8.m3.3.3.1.1.1.1.1.1.2" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.2" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.1" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.cmml"><mn id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.2" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.1" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.3" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.l8.m3.3.3.1.1.1.1.1.5" xref="alg1.l8.m3.3.3.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l8.m3.3.3.1.1.1.3" xref="alg1.l8.m3.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.3b"><apply id="alg1.l8.m3.3.3.cmml" xref="alg1.l8.m3.3.3"><ci id="alg1.l8.m3.3.3.2.cmml" xref="alg1.l8.m3.3.3.2">â†</ci><apply id="alg1.l8.m3.3.3.3.cmml" xref="alg1.l8.m3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.3.1.cmml" xref="alg1.l8.m3.3.3.3">subscript</csymbol><apply id="alg1.l8.m3.3.3.3.2.cmml" xref="alg1.l8.m3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.3.2.1.cmml" xref="alg1.l8.m3.3.3.3">superscript</csymbol><ci id="alg1.l8.m3.3.3.3.2.2.cmml" xref="alg1.l8.m3.3.3.3.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l8.m3.3.3.3.2.3.cmml" xref="alg1.l8.m3.3.3.3.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l8.m3.3.3.3.3.cmml" xref="alg1.l8.m3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.3.3.1.cmml" xref="alg1.l8.m3.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m3.3.3.3.3.2.cmml" xref="alg1.l8.m3.3.3.3.3.2">ğœ‹</ci><ci id="alg1.l8.m3.3.3.3.3.3.cmml" xref="alg1.l8.m3.3.3.3.3.3">sft</ci></apply></apply><apply id="alg1.l8.m3.3.3.1.cmml" xref="alg1.l8.m3.3.3.1"><union id="alg1.l8.m3.3.3.1.2.cmml" xref="alg1.l8.m3.3.3.1.2"></union><apply id="alg1.l8.m3.3.3.1.3.cmml" xref="alg1.l8.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.1.3.1.cmml" xref="alg1.l8.m3.3.3.1.3">subscript</csymbol><apply id="alg1.l8.m3.3.3.1.3.2.cmml" xref="alg1.l8.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.1.3.2.1.cmml" xref="alg1.l8.m3.3.3.1.3">superscript</csymbol><ci id="alg1.l8.m3.3.3.1.3.2.2.cmml" xref="alg1.l8.m3.3.3.1.3.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l8.m3.3.3.1.3.2.3.cmml" xref="alg1.l8.m3.3.3.1.3.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l8.m3.3.3.1.3.3.cmml" xref="alg1.l8.m3.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.1.3.3.1.cmml" xref="alg1.l8.m3.3.3.1.3.3">subscript</csymbol><ci id="alg1.l8.m3.3.3.1.3.3.2.cmml" xref="alg1.l8.m3.3.3.1.3.3.2">ğœ‹</ci><ci id="alg1.l8.m3.3.3.1.3.3.3.cmml" xref="alg1.l8.m3.3.3.1.3.3.3">sft</ci></apply></apply><set id="alg1.l8.m3.3.3.1.1.2.cmml" xref="alg1.l8.m3.3.3.1.1.1"><vector id="alg1.l8.m3.3.3.1.1.1.1.2.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1"><ci id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">ğ±</ci><ci id="alg1.l8.m3.2.2.cmml" xref="alg1.l8.m3.2.2">ğ²</ci><apply id="alg1.l8.m3.3.3.1.1.1.1.1.1.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1"><minus id="alg1.l8.m3.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1"></minus><apply id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2"><ci id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3"><ci id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.2">1</cn><ci id="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l8.m3.3.3.1.1.1.1.1.1.2.3.3">ğ‘</ci></apply></apply></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.3c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\cup\{(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}}_{1:c})\}</annotation></semantics></math>.

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Â Â Â <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â Â Â Â <span id="alg1.l10.2" class="ltx_text" style="color:#3873B3;"># <span id="alg1.l10.2.1" class="ltx_text ltx_font_bold">Part 2: </span>Identify spurious steps in correct responses</span>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>Â Â Â Â Â Sample multiple correct answers <math id="alg1.l11.m1.1" class="ltx_math_unparsed" alttext="+\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1b"><mo id="alg1.l11.m1.1.1">+</mo><mover accent="true" id="alg1.l11.m1.1.2"><mi id="alg1.l11.m1.1.2.2">ğ²</mi><mo id="alg1.l11.m1.1.2.1">^</mo></mover><mo id="alg1.l11.m1.1.3">âˆ¼</mo><msub id="alg1.l11.m1.1.4"><mi id="alg1.l11.m1.1.4.2">Ï€</mi><mi id="alg1.l11.m1.1.4.3">sft</mi></msub><mrow id="alg1.l11.m1.1.5"><mo stretchy="false" id="alg1.l11.m1.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.5.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="alg1.l11.m1.1.5.3">âˆ£</mo><mi id="alg1.l11.m1.1.5.4">ğ±</mi><mo stretchy="false" id="alg1.l11.m1.1.5.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">+\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})</annotation></semantics></math>, and collect them in set <math id="alg1.l11.m2.1" class="ltx_Math" alttext="\mathcal{C}^{\prime}(\mathbf{x})" display="inline"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.2" xref="alg1.l11.m2.1.2.cmml"><msup id="alg1.l11.m2.1.2.2" xref="alg1.l11.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m2.1.2.2.2" xref="alg1.l11.m2.1.2.2.2.cmml">ğ’</mi><mo id="alg1.l11.m2.1.2.2.3" xref="alg1.l11.m2.1.2.2.3.cmml">â€²</mo></msup><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.2.1" xref="alg1.l11.m2.1.2.1.cmml">â€‹</mo><mrow id="alg1.l11.m2.1.2.3.2" xref="alg1.l11.m2.1.2.cmml"><mo stretchy="false" id="alg1.l11.m2.1.2.3.2.1" xref="alg1.l11.m2.1.2.cmml">(</mo><mi id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">ğ±</mi><mo stretchy="false" id="alg1.l11.m2.1.2.3.2.2" xref="alg1.l11.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.2.cmml" xref="alg1.l11.m2.1.2"><times id="alg1.l11.m2.1.2.1.cmml" xref="alg1.l11.m2.1.2.1"></times><apply id="alg1.l11.m2.1.2.2.cmml" xref="alg1.l11.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l11.m2.1.2.2.1.cmml" xref="alg1.l11.m2.1.2.2">superscript</csymbol><ci id="alg1.l11.m2.1.2.2.2.cmml" xref="alg1.l11.m2.1.2.2.2">ğ’</ci><ci id="alg1.l11.m2.1.2.2.3.cmml" xref="alg1.l11.m2.1.2.2.3">â€²</ci></apply><ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">ğ±</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\mathcal{C}^{\prime}(\mathbf{x})</annotation></semantics></math>.

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>Â Â Â Â Â <span id="alg1.l12.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l12.m1.4" class="ltx_Math" alttext="+\hat{\mathbf{y}}:=\left[+\hat{\mathbf{y}}_{1},\ldots,+\hat{\mathbf{y}}_{L}\right]\in\mathcal{C}^{\prime}(\mathbf{x})" display="inline"><semantics id="alg1.l12.m1.4a"><mrow id="alg1.l12.m1.4.4" xref="alg1.l12.m1.4.4.cmml"><mrow id="alg1.l12.m1.4.4.4" xref="alg1.l12.m1.4.4.4.cmml"><mo id="alg1.l12.m1.4.4.4a" xref="alg1.l12.m1.4.4.4.cmml">+</mo><mover accent="true" id="alg1.l12.m1.4.4.4.2" xref="alg1.l12.m1.4.4.4.2.cmml"><mi id="alg1.l12.m1.4.4.4.2.2" xref="alg1.l12.m1.4.4.4.2.2.cmml">ğ²</mi><mo id="alg1.l12.m1.4.4.4.2.1" xref="alg1.l12.m1.4.4.4.2.1.cmml">^</mo></mover></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l12.m1.4.4.5" xref="alg1.l12.m1.4.4.5.cmml">:=</mo><mrow id="alg1.l12.m1.4.4.2.2" xref="alg1.l12.m1.4.4.2.3.cmml"><mo id="alg1.l12.m1.4.4.2.2.3" xref="alg1.l12.m1.4.4.2.3.cmml">[</mo><mrow id="alg1.l12.m1.3.3.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.cmml"><mo id="alg1.l12.m1.3.3.1.1.1a" xref="alg1.l12.m1.3.3.1.1.1.cmml">+</mo><msub id="alg1.l12.m1.3.3.1.1.1.2" xref="alg1.l12.m1.3.3.1.1.1.2.cmml"><mover accent="true" id="alg1.l12.m1.3.3.1.1.1.2.2" xref="alg1.l12.m1.3.3.1.1.1.2.2.cmml"><mi id="alg1.l12.m1.3.3.1.1.1.2.2.2" xref="alg1.l12.m1.3.3.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l12.m1.3.3.1.1.1.2.2.1" xref="alg1.l12.m1.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg1.l12.m1.3.3.1.1.1.2.3" xref="alg1.l12.m1.3.3.1.1.1.2.3.cmml">1</mn></msub></mrow><mo id="alg1.l12.m1.4.4.2.2.4" xref="alg1.l12.m1.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">â€¦</mi><mo id="alg1.l12.m1.4.4.2.2.5" xref="alg1.l12.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.l12.m1.4.4.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.cmml"><mo id="alg1.l12.m1.4.4.2.2.2a" xref="alg1.l12.m1.4.4.2.2.2.cmml">+</mo><msub id="alg1.l12.m1.4.4.2.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.2.cmml"><mover accent="true" id="alg1.l12.m1.4.4.2.2.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l12.m1.4.4.2.2.2.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l12.m1.4.4.2.2.2.2.2.1" xref="alg1.l12.m1.4.4.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l12.m1.4.4.2.2.2.2.3" xref="alg1.l12.m1.4.4.2.2.2.2.3.cmml">L</mi></msub></mrow><mo id="alg1.l12.m1.4.4.2.2.6" xref="alg1.l12.m1.4.4.2.3.cmml">]</mo></mrow><mo id="alg1.l12.m1.4.4.6" xref="alg1.l12.m1.4.4.6.cmml">âˆˆ</mo><mrow id="alg1.l12.m1.4.4.7" xref="alg1.l12.m1.4.4.7.cmml"><msup id="alg1.l12.m1.4.4.7.2" xref="alg1.l12.m1.4.4.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.4.4.7.2.2" xref="alg1.l12.m1.4.4.7.2.2.cmml">ğ’</mi><mo id="alg1.l12.m1.4.4.7.2.3" xref="alg1.l12.m1.4.4.7.2.3.cmml">â€²</mo></msup><mo lspace="0em" rspace="0em" id="alg1.l12.m1.4.4.7.1" xref="alg1.l12.m1.4.4.7.1.cmml">â€‹</mo><mrow id="alg1.l12.m1.4.4.7.3.2" xref="alg1.l12.m1.4.4.7.cmml"><mo stretchy="false" id="alg1.l12.m1.4.4.7.3.2.1" xref="alg1.l12.m1.4.4.7.cmml">(</mo><mi id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">ğ±</mi><mo stretchy="false" id="alg1.l12.m1.4.4.7.3.2.2" xref="alg1.l12.m1.4.4.7.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.4b"><apply id="alg1.l12.m1.4.4.cmml" xref="alg1.l12.m1.4.4"><and id="alg1.l12.m1.4.4a.cmml" xref="alg1.l12.m1.4.4"></and><apply id="alg1.l12.m1.4.4b.cmml" xref="alg1.l12.m1.4.4"><csymbol cd="latexml" id="alg1.l12.m1.4.4.5.cmml" xref="alg1.l12.m1.4.4.5">assign</csymbol><apply id="alg1.l12.m1.4.4.4.cmml" xref="alg1.l12.m1.4.4.4"><plus id="alg1.l12.m1.4.4.4.1.cmml" xref="alg1.l12.m1.4.4.4"></plus><apply id="alg1.l12.m1.4.4.4.2.cmml" xref="alg1.l12.m1.4.4.4.2"><ci id="alg1.l12.m1.4.4.4.2.1.cmml" xref="alg1.l12.m1.4.4.4.2.1">^</ci><ci id="alg1.l12.m1.4.4.4.2.2.cmml" xref="alg1.l12.m1.4.4.4.2.2">ğ²</ci></apply></apply><list id="alg1.l12.m1.4.4.2.3.cmml" xref="alg1.l12.m1.4.4.2.2"><apply id="alg1.l12.m1.3.3.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1"><plus id="alg1.l12.m1.3.3.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1"></plus><apply id="alg1.l12.m1.3.3.1.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.2">subscript</csymbol><apply id="alg1.l12.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.2.2"><ci id="alg1.l12.m1.3.3.1.1.1.2.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.2.2.1">^</ci><ci id="alg1.l12.m1.3.3.1.1.1.2.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.2.2.2">ğ²</ci></apply><cn type="integer" id="alg1.l12.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l12.m1.3.3.1.1.1.2.3">1</cn></apply></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">â€¦</ci><apply id="alg1.l12.m1.4.4.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2"><plus id="alg1.l12.m1.4.4.2.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.2.2"></plus><apply id="alg1.l12.m1.4.4.2.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.2.2.2">subscript</csymbol><apply id="alg1.l12.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.2"><ci id="alg1.l12.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.2.1">^</ci><ci id="alg1.l12.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l12.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.3">ğ¿</ci></apply></apply></list></apply><apply id="alg1.l12.m1.4.4c.cmml" xref="alg1.l12.m1.4.4"><in id="alg1.l12.m1.4.4.6.cmml" xref="alg1.l12.m1.4.4.6"></in><share href="#alg1.l12.m1.4.4.2.cmml" id="alg1.l12.m1.4.4d.cmml" xref="alg1.l12.m1.4.4"></share><apply id="alg1.l12.m1.4.4.7.cmml" xref="alg1.l12.m1.4.4.7"><times id="alg1.l12.m1.4.4.7.1.cmml" xref="alg1.l12.m1.4.4.7.1"></times><apply id="alg1.l12.m1.4.4.7.2.cmml" xref="alg1.l12.m1.4.4.7.2"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.7.2.1.cmml" xref="alg1.l12.m1.4.4.7.2">superscript</csymbol><ci id="alg1.l12.m1.4.4.7.2.2.cmml" xref="alg1.l12.m1.4.4.7.2.2">ğ’</ci><ci id="alg1.l12.m1.4.4.7.2.3.cmml" xref="alg1.l12.m1.4.4.7.2.3">â€²</ci></apply><ci id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">ğ±</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.4c">+\hat{\mathbf{y}}:=\left[+\hat{\mathbf{y}}_{1},\ldots,+\hat{\mathbf{y}}_{L}\right]\in\mathcal{C}^{\prime}(\mathbf{x})</annotation></semantics></math>Â <span id="alg1.l12.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>Â Â Â Â Â Â Â Â Â Compute the Monte Carlo estimate for <math id="alg1.l13.m1.3" class="ltx_Math" alttext="Q_{\tilde{\pi}}(\mathbf{x},+\hat{\mathbf{y}}_{1:i-1};+\hat{\mathbf{y}}_{i})" display="inline"><semantics id="alg1.l13.m1.3a"><mrow id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml"><msub id="alg1.l13.m1.3.3.4" xref="alg1.l13.m1.3.3.4.cmml"><mi id="alg1.l13.m1.3.3.4.2" xref="alg1.l13.m1.3.3.4.2.cmml">Q</mi><mover accent="true" id="alg1.l13.m1.3.3.4.3" xref="alg1.l13.m1.3.3.4.3.cmml"><mi id="alg1.l13.m1.3.3.4.3.2" xref="alg1.l13.m1.3.3.4.3.2.cmml">Ï€</mi><mo id="alg1.l13.m1.3.3.4.3.1" xref="alg1.l13.m1.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m1.3.3.3" xref="alg1.l13.m1.3.3.3.cmml">â€‹</mo><mrow id="alg1.l13.m1.3.3.2.2" xref="alg1.l13.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l13.m1.3.3.2.2.3" xref="alg1.l13.m1.3.3.2.3.cmml">(</mo><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">ğ±</mi><mo id="alg1.l13.m1.3.3.2.2.4" xref="alg1.l13.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l13.m1.2.2.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.cmml"><mo id="alg1.l13.m1.2.2.1.1.1a" xref="alg1.l13.m1.2.2.1.1.1.cmml">+</mo><msub id="alg1.l13.m1.2.2.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.2.cmml"><mover accent="true" id="alg1.l13.m1.2.2.1.1.1.2.2" xref="alg1.l13.m1.2.2.1.1.1.2.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.2.2.2" xref="alg1.l13.m1.2.2.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l13.m1.2.2.1.1.1.2.2.1" xref="alg1.l13.m1.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l13.m1.2.2.1.1.1.2.3" xref="alg1.l13.m1.2.2.1.1.1.2.3.cmml"><mn id="alg1.l13.m1.2.2.1.1.1.2.3.2" xref="alg1.l13.m1.2.2.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l13.m1.2.2.1.1.1.2.3.1" xref="alg1.l13.m1.2.2.1.1.1.2.3.1.cmml">:</mo><mrow id="alg1.l13.m1.2.2.1.1.1.2.3.3" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.2.3.3.2" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.2.cmml">i</mi><mo id="alg1.l13.m1.2.2.1.1.1.2.3.3.1" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="alg1.l13.m1.2.2.1.1.1.2.3.3.3" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="alg1.l13.m1.3.3.2.2.5" xref="alg1.l13.m1.3.3.2.3.cmml">;</mo><mrow id="alg1.l13.m1.3.3.2.2.2" xref="alg1.l13.m1.3.3.2.2.2.cmml"><mo id="alg1.l13.m1.3.3.2.2.2a" xref="alg1.l13.m1.3.3.2.2.2.cmml">+</mo><msub id="alg1.l13.m1.3.3.2.2.2.2" xref="alg1.l13.m1.3.3.2.2.2.2.cmml"><mover accent="true" id="alg1.l13.m1.3.3.2.2.2.2.2" xref="alg1.l13.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.3.3.2.2.2.2.2.2" xref="alg1.l13.m1.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l13.m1.3.3.2.2.2.2.2.1" xref="alg1.l13.m1.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l13.m1.3.3.2.2.2.2.3" xref="alg1.l13.m1.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l13.m1.3.3.2.2.6" xref="alg1.l13.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.3b"><apply id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3"><times id="alg1.l13.m1.3.3.3.cmml" xref="alg1.l13.m1.3.3.3"></times><apply id="alg1.l13.m1.3.3.4.cmml" xref="alg1.l13.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.4.1.cmml" xref="alg1.l13.m1.3.3.4">subscript</csymbol><ci id="alg1.l13.m1.3.3.4.2.cmml" xref="alg1.l13.m1.3.3.4.2">ğ‘„</ci><apply id="alg1.l13.m1.3.3.4.3.cmml" xref="alg1.l13.m1.3.3.4.3"><ci id="alg1.l13.m1.3.3.4.3.1.cmml" xref="alg1.l13.m1.3.3.4.3.1">~</ci><ci id="alg1.l13.m1.3.3.4.3.2.cmml" xref="alg1.l13.m1.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="alg1.l13.m1.3.3.2.3.cmml" xref="alg1.l13.m1.3.3.2.2"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">ğ±</ci><apply id="alg1.l13.m1.2.2.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1"><plus id="alg1.l13.m1.2.2.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1"></plus><apply id="alg1.l13.m1.2.2.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.2">subscript</csymbol><apply id="alg1.l13.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.2"><ci id="alg1.l13.m1.2.2.1.1.1.2.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.2.1">^</ci><ci id="alg1.l13.m1.2.2.1.1.1.2.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l13.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3"><ci id="alg1.l13.m1.2.2.1.1.1.2.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l13.m1.2.2.1.1.1.2.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.2">1</cn><apply id="alg1.l13.m1.2.2.1.1.1.2.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.3"><minus id="alg1.l13.m1.2.2.1.1.1.2.3.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.1"></minus><ci id="alg1.l13.m1.2.2.1.1.1.2.3.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="alg1.l13.m1.2.2.1.1.1.2.3.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l13.m1.3.3.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2"><plus id="alg1.l13.m1.3.3.2.2.2.1.cmml" xref="alg1.l13.m1.3.3.2.2.2"></plus><apply id="alg1.l13.m1.3.3.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l13.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2"><ci id="alg1.l13.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.1">^</ci><ci id="alg1.l13.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l13.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.3">ğ‘–</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.3c">Q_{\tilde{\pi}}(\mathbf{x},+\hat{\mathbf{y}}_{1:i-1};+\hat{\mathbf{y}}_{i})</annotation></semantics></math> for each step <math id="alg1.l13.m2.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{i}" display="inline"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mo id="alg1.l13.m2.1.1a" xref="alg1.l13.m2.1.1.cmml">+</mo><msub id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml"><mover accent="true" id="alg1.l13.m2.1.1.2.2" xref="alg1.l13.m2.1.1.2.2.cmml"><mi id="alg1.l13.m2.1.1.2.2.2" xref="alg1.l13.m2.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l13.m2.1.1.2.2.1" xref="alg1.l13.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="alg1.l13.m2.1.1.2.3" xref="alg1.l13.m2.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><plus id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1"></plus><apply id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.2.1.cmml" xref="alg1.l13.m2.1.1.2">subscript</csymbol><apply id="alg1.l13.m2.1.1.2.2.cmml" xref="alg1.l13.m2.1.1.2.2"><ci id="alg1.l13.m2.1.1.2.2.1.cmml" xref="alg1.l13.m2.1.1.2.2.1">^</ci><ci id="alg1.l13.m2.1.1.2.2.2.cmml" xref="alg1.l13.m2.1.1.2.2.2">ğ²</ci></apply><ci id="alg1.l13.m2.1.1.2.3.cmml" xref="alg1.l13.m2.1.1.2.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">+\hat{\mathbf{y}}_{i}</annotation></semantics></math>.

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>Â Â Â Â Â Â Â Â Â If <math id="alg1.l14.m1.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{c}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mo id="alg1.l14.m1.1.1a" xref="alg1.l14.m1.1.1.cmml">+</mo><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mover accent="true" id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml"><mi id="alg1.l14.m1.1.1.2.2.2" xref="alg1.l14.m1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l14.m1.1.1.2.2.1" xref="alg1.l14.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><plus id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1"></plus><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><apply id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2"><ci id="alg1.l14.m1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.2.2.1">^</ci><ci id="alg1.l14.m1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.2.2.2">ğ²</ci></apply><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">+\hat{\mathbf{y}}_{c}</annotation></semantics></math> is the first step with least <math id="alg1.l14.m2.3" class="ltx_Math" alttext="Q_{\tilde{\pi}}(\mathbf{x},+\hat{\mathbf{y}}_{1:i-1};+\hat{\mathbf{y}}_{i})" display="inline"><semantics id="alg1.l14.m2.3a"><mrow id="alg1.l14.m2.3.3" xref="alg1.l14.m2.3.3.cmml"><msub id="alg1.l14.m2.3.3.4" xref="alg1.l14.m2.3.3.4.cmml"><mi id="alg1.l14.m2.3.3.4.2" xref="alg1.l14.m2.3.3.4.2.cmml">Q</mi><mover accent="true" id="alg1.l14.m2.3.3.4.3" xref="alg1.l14.m2.3.3.4.3.cmml"><mi id="alg1.l14.m2.3.3.4.3.2" xref="alg1.l14.m2.3.3.4.3.2.cmml">Ï€</mi><mo id="alg1.l14.m2.3.3.4.3.1" xref="alg1.l14.m2.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="alg1.l14.m2.3.3.3" xref="alg1.l14.m2.3.3.3.cmml">â€‹</mo><mrow id="alg1.l14.m2.3.3.2.2" xref="alg1.l14.m2.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l14.m2.3.3.2.2.3" xref="alg1.l14.m2.3.3.2.3.cmml">(</mo><mi id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml">ğ±</mi><mo id="alg1.l14.m2.3.3.2.2.4" xref="alg1.l14.m2.3.3.2.3.cmml">,</mo><mrow id="alg1.l14.m2.2.2.1.1.1" xref="alg1.l14.m2.2.2.1.1.1.cmml"><mo id="alg1.l14.m2.2.2.1.1.1a" xref="alg1.l14.m2.2.2.1.1.1.cmml">+</mo><msub id="alg1.l14.m2.2.2.1.1.1.2" xref="alg1.l14.m2.2.2.1.1.1.2.cmml"><mover accent="true" id="alg1.l14.m2.2.2.1.1.1.2.2" xref="alg1.l14.m2.2.2.1.1.1.2.2.cmml"><mi id="alg1.l14.m2.2.2.1.1.1.2.2.2" xref="alg1.l14.m2.2.2.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l14.m2.2.2.1.1.1.2.2.1" xref="alg1.l14.m2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l14.m2.2.2.1.1.1.2.3" xref="alg1.l14.m2.2.2.1.1.1.2.3.cmml"><mn id="alg1.l14.m2.2.2.1.1.1.2.3.2" xref="alg1.l14.m2.2.2.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m2.2.2.1.1.1.2.3.1" xref="alg1.l14.m2.2.2.1.1.1.2.3.1.cmml">:</mo><mrow id="alg1.l14.m2.2.2.1.1.1.2.3.3" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.cmml"><mi id="alg1.l14.m2.2.2.1.1.1.2.3.3.2" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.2.cmml">i</mi><mo id="alg1.l14.m2.2.2.1.1.1.2.3.3.1" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="alg1.l14.m2.2.2.1.1.1.2.3.3.3" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="alg1.l14.m2.3.3.2.2.5" xref="alg1.l14.m2.3.3.2.3.cmml">;</mo><mrow id="alg1.l14.m2.3.3.2.2.2" xref="alg1.l14.m2.3.3.2.2.2.cmml"><mo id="alg1.l14.m2.3.3.2.2.2a" xref="alg1.l14.m2.3.3.2.2.2.cmml">+</mo><msub id="alg1.l14.m2.3.3.2.2.2.2" xref="alg1.l14.m2.3.3.2.2.2.2.cmml"><mover accent="true" id="alg1.l14.m2.3.3.2.2.2.2.2" xref="alg1.l14.m2.3.3.2.2.2.2.2.cmml"><mi id="alg1.l14.m2.3.3.2.2.2.2.2.2" xref="alg1.l14.m2.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mo id="alg1.l14.m2.3.3.2.2.2.2.2.1" xref="alg1.l14.m2.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l14.m2.3.3.2.2.2.2.3" xref="alg1.l14.m2.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l14.m2.3.3.2.2.6" xref="alg1.l14.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.3b"><apply id="alg1.l14.m2.3.3.cmml" xref="alg1.l14.m2.3.3"><times id="alg1.l14.m2.3.3.3.cmml" xref="alg1.l14.m2.3.3.3"></times><apply id="alg1.l14.m2.3.3.4.cmml" xref="alg1.l14.m2.3.3.4"><csymbol cd="ambiguous" id="alg1.l14.m2.3.3.4.1.cmml" xref="alg1.l14.m2.3.3.4">subscript</csymbol><ci id="alg1.l14.m2.3.3.4.2.cmml" xref="alg1.l14.m2.3.3.4.2">ğ‘„</ci><apply id="alg1.l14.m2.3.3.4.3.cmml" xref="alg1.l14.m2.3.3.4.3"><ci id="alg1.l14.m2.3.3.4.3.1.cmml" xref="alg1.l14.m2.3.3.4.3.1">~</ci><ci id="alg1.l14.m2.3.3.4.3.2.cmml" xref="alg1.l14.m2.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="alg1.l14.m2.3.3.2.3.cmml" xref="alg1.l14.m2.3.3.2.2"><ci id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1">ğ±</ci><apply id="alg1.l14.m2.2.2.1.1.1.cmml" xref="alg1.l14.m2.2.2.1.1.1"><plus id="alg1.l14.m2.2.2.1.1.1.1.cmml" xref="alg1.l14.m2.2.2.1.1.1"></plus><apply id="alg1.l14.m2.2.2.1.1.1.2.cmml" xref="alg1.l14.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m2.2.2.1.1.1.2.1.cmml" xref="alg1.l14.m2.2.2.1.1.1.2">subscript</csymbol><apply id="alg1.l14.m2.2.2.1.1.1.2.2.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.2"><ci id="alg1.l14.m2.2.2.1.1.1.2.2.1.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.2.1">^</ci><ci id="alg1.l14.m2.2.2.1.1.1.2.2.2.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l14.m2.2.2.1.1.1.2.3.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3"><ci id="alg1.l14.m2.2.2.1.1.1.2.3.1.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l14.m2.2.2.1.1.1.2.3.2.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.2">1</cn><apply id="alg1.l14.m2.2.2.1.1.1.2.3.3.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.3"><minus id="alg1.l14.m2.2.2.1.1.1.2.3.3.1.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.1"></minus><ci id="alg1.l14.m2.2.2.1.1.1.2.3.3.2.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.2">ğ‘–</ci><cn type="integer" id="alg1.l14.m2.2.2.1.1.1.2.3.3.3.cmml" xref="alg1.l14.m2.2.2.1.1.1.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l14.m2.3.3.2.2.2.cmml" xref="alg1.l14.m2.3.3.2.2.2"><plus id="alg1.l14.m2.3.3.2.2.2.1.cmml" xref="alg1.l14.m2.3.3.2.2.2"></plus><apply id="alg1.l14.m2.3.3.2.2.2.2.cmml" xref="alg1.l14.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m2.3.3.2.2.2.2.1.cmml" xref="alg1.l14.m2.3.3.2.2.2.2">subscript</csymbol><apply id="alg1.l14.m2.3.3.2.2.2.2.2.cmml" xref="alg1.l14.m2.3.3.2.2.2.2.2"><ci id="alg1.l14.m2.3.3.2.2.2.2.2.1.cmml" xref="alg1.l14.m2.3.3.2.2.2.2.2.1">^</ci><ci id="alg1.l14.m2.3.3.2.2.2.2.2.2.cmml" xref="alg1.l14.m2.3.3.2.2.2.2.2.2">ğ²</ci></apply><ci id="alg1.l14.m2.3.3.2.2.2.2.3.cmml" xref="alg1.l14.m2.3.3.2.2.2.2.3">ğ‘–</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.3c">Q_{\tilde{\pi}}(\mathbf{x},+\hat{\mathbf{y}}_{1:i-1};+\hat{\mathbf{y}}_{i})</annotation></semantics></math>, then <math id="alg1.l14.m3.3" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\cup\{(\mathbf{x},\mathbf{y},+\hat{\mathbf{y}}_{1:c})\}" display="inline"><semantics id="alg1.l14.m3.3a"><mrow id="alg1.l14.m3.3.3" xref="alg1.l14.m3.3.3.cmml"><msubsup id="alg1.l14.m3.3.3.3" xref="alg1.l14.m3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m3.3.3.3.2.2" xref="alg1.l14.m3.3.3.3.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l14.m3.3.3.3.3" xref="alg1.l14.m3.3.3.3.3.cmml"><mi id="alg1.l14.m3.3.3.3.3.2" xref="alg1.l14.m3.3.3.3.3.2.cmml">Ï€</mi><mi id="alg1.l14.m3.3.3.3.3.3" xref="alg1.l14.m3.3.3.3.3.3.cmml">sft</mi></msub><mo id="alg1.l14.m3.3.3.3.2.3" xref="alg1.l14.m3.3.3.3.2.3.cmml">Â±</mo></msubsup><mo stretchy="false" id="alg1.l14.m3.3.3.2" xref="alg1.l14.m3.3.3.2.cmml">â†</mo><mrow id="alg1.l14.m3.3.3.1" xref="alg1.l14.m3.3.3.1.cmml"><msubsup id="alg1.l14.m3.3.3.1.3" xref="alg1.l14.m3.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m3.3.3.1.3.2.2" xref="alg1.l14.m3.3.3.1.3.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l14.m3.3.3.1.3.3" xref="alg1.l14.m3.3.3.1.3.3.cmml"><mi id="alg1.l14.m3.3.3.1.3.3.2" xref="alg1.l14.m3.3.3.1.3.3.2.cmml">Ï€</mi><mi id="alg1.l14.m3.3.3.1.3.3.3" xref="alg1.l14.m3.3.3.1.3.3.3.cmml">sft</mi></msub><mo id="alg1.l14.m3.3.3.1.3.2.3" xref="alg1.l14.m3.3.3.1.3.2.3.cmml">Â±</mo></msubsup><mo id="alg1.l14.m3.3.3.1.2" xref="alg1.l14.m3.3.3.1.2.cmml">âˆª</mo><mrow id="alg1.l14.m3.3.3.1.1.1" xref="alg1.l14.m3.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m3.3.3.1.1.1.2" xref="alg1.l14.m3.3.3.1.1.2.cmml">{</mo><mrow id="alg1.l14.m3.3.3.1.1.1.1.1" xref="alg1.l14.m3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m3.3.3.1.1.1.1.1.2" xref="alg1.l14.m3.3.3.1.1.1.1.2.cmml">(</mo><mi id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml">ğ±</mi><mo id="alg1.l14.m3.3.3.1.1.1.1.1.3" xref="alg1.l14.m3.3.3.1.1.1.1.2.cmml">,</mo><mi id="alg1.l14.m3.2.2" xref="alg1.l14.m3.2.2.cmml">ğ²</mi><mo id="alg1.l14.m3.3.3.1.1.1.1.1.4" xref="alg1.l14.m3.3.3.1.1.1.1.2.cmml">,</mo><mrow id="alg1.l14.m3.3.3.1.1.1.1.1.1" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.cmml"><mo id="alg1.l14.m3.3.3.1.1.1.1.1.1a" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.cmml">+</mo><msub id="alg1.l14.m3.3.3.1.1.1.1.1.1.2" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.2" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.2.cmml">ğ²</mi><mo id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.1" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.cmml"><mn id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.2" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.1" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.3" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="alg1.l14.m3.3.3.1.1.1.1.1.5" xref="alg1.l14.m3.3.3.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l14.m3.3.3.1.1.1.3" xref="alg1.l14.m3.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.3b"><apply id="alg1.l14.m3.3.3.cmml" xref="alg1.l14.m3.3.3"><ci id="alg1.l14.m3.3.3.2.cmml" xref="alg1.l14.m3.3.3.2">â†</ci><apply id="alg1.l14.m3.3.3.3.cmml" xref="alg1.l14.m3.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.3.1.cmml" xref="alg1.l14.m3.3.3.3">subscript</csymbol><apply id="alg1.l14.m3.3.3.3.2.cmml" xref="alg1.l14.m3.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.3.2.1.cmml" xref="alg1.l14.m3.3.3.3">superscript</csymbol><ci id="alg1.l14.m3.3.3.3.2.2.cmml" xref="alg1.l14.m3.3.3.3.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l14.m3.3.3.3.2.3.cmml" xref="alg1.l14.m3.3.3.3.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l14.m3.3.3.3.3.cmml" xref="alg1.l14.m3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.3.3.1.cmml" xref="alg1.l14.m3.3.3.3.3">subscript</csymbol><ci id="alg1.l14.m3.3.3.3.3.2.cmml" xref="alg1.l14.m3.3.3.3.3.2">ğœ‹</ci><ci id="alg1.l14.m3.3.3.3.3.3.cmml" xref="alg1.l14.m3.3.3.3.3.3">sft</ci></apply></apply><apply id="alg1.l14.m3.3.3.1.cmml" xref="alg1.l14.m3.3.3.1"><union id="alg1.l14.m3.3.3.1.2.cmml" xref="alg1.l14.m3.3.3.1.2"></union><apply id="alg1.l14.m3.3.3.1.3.cmml" xref="alg1.l14.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.1.3.1.cmml" xref="alg1.l14.m3.3.3.1.3">subscript</csymbol><apply id="alg1.l14.m3.3.3.1.3.2.cmml" xref="alg1.l14.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.1.3.2.1.cmml" xref="alg1.l14.m3.3.3.1.3">superscript</csymbol><ci id="alg1.l14.m3.3.3.1.3.2.2.cmml" xref="alg1.l14.m3.3.3.1.3.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l14.m3.3.3.1.3.2.3.cmml" xref="alg1.l14.m3.3.3.1.3.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l14.m3.3.3.1.3.3.cmml" xref="alg1.l14.m3.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.1.3.3.1.cmml" xref="alg1.l14.m3.3.3.1.3.3">subscript</csymbol><ci id="alg1.l14.m3.3.3.1.3.3.2.cmml" xref="alg1.l14.m3.3.3.1.3.3.2">ğœ‹</ci><ci id="alg1.l14.m3.3.3.1.3.3.3.cmml" xref="alg1.l14.m3.3.3.1.3.3.3">sft</ci></apply></apply><set id="alg1.l14.m3.3.3.1.1.2.cmml" xref="alg1.l14.m3.3.3.1.1.1"><vector id="alg1.l14.m3.3.3.1.1.1.1.2.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1"><ci id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1">ğ±</ci><ci id="alg1.l14.m3.2.2.cmml" xref="alg1.l14.m3.2.2">ğ²</ci><apply id="alg1.l14.m3.3.3.1.1.1.1.1.1.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1"><plus id="alg1.l14.m3.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1"></plus><apply id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2"><ci id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.2.2">ğ²</ci></apply><apply id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3"><ci id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.2">1</cn><ci id="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l14.m3.3.3.1.1.1.1.1.1.2.3.3">ğ‘</ci></apply></apply></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.3c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\leftarrow\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}\cup\{(\mathbf{x},\mathbf{y},+\hat{\mathbf{y}}_{1:c})\}</annotation></semantics></math>.

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>Â Â Â Â Â <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>Optimize DPO loss in EquationÂ (<a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) on <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="alg1.l17.m1.1a"><msubsup id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">Ï€</mi><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">sft</mi></msub><mo id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1">superscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">plus-or-minus</csymbol></apply><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">ğœ‹</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> with <math id="alg1.l17.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="alg1.l17.m2.1a"><msub id="alg1.l17.m2.1.1" xref="alg1.l17.m2.1.1.cmml"><mi id="alg1.l17.m2.1.1.2" xref="alg1.l17.m2.1.1.2.cmml">Ï€</mi><mi id="alg1.l17.m2.1.1.3" xref="alg1.l17.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.1b"><apply id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1"><csymbol cd="ambiguous" id="alg1.l17.m2.1.1.1.cmml" xref="alg1.l17.m2.1.1">subscript</csymbol><ci id="alg1.l17.m2.1.1.2.cmml" xref="alg1.l17.m2.1.1.2">ğœ‹</ci><ci id="alg1.l17.m2.1.1.3.cmml" xref="alg1.l17.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> as the reference policy.

</div>
</div>
</figure>
<figure id="S6.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x10.png" id="S6.F7.1.g1" class="ltx_graphics ltx_img_landscape" width="457" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(a)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x11.png" id="S6.F7.2.g1" class="ltx_graphics ltx_img_landscape" width="457" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(b)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x12.png" id="S6.F7.3.g1" class="ltx_graphics ltx_img_square" width="456" height="369" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(c)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F7.14.5.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><em id="S6.F7.15.6" class="ltx_emph ltx_font_bold ltx_font_italic" style="font-size:80%;">Negative data scaling laws:</em><span id="S6.F7.11.4" class="ltx_text" style="font-size:80%;"> We evaluate algorithms that consume negative data as we scale <math id="S6.F7.8.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.F7.8.1.m1.1b"><msub id="S6.F7.8.1.m1.1.1" xref="S6.F7.8.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.F7.8.1.m1.1.1.2" xref="S6.F7.8.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.F7.8.1.m1.1.1.3" xref="S6.F7.8.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F7.8.1.m1.1c"><apply id="S6.F7.8.1.m1.1.1.cmml" xref="S6.F7.8.1.m1.1.1"><csymbol cd="ambiguous" id="S6.F7.8.1.m1.1.1.1.cmml" xref="S6.F7.8.1.m1.1.1">subscript</csymbol><ci id="S6.F7.8.1.m1.1.1.2.cmml" xref="S6.F7.8.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S6.F7.8.1.m1.1.1.3.cmml" xref="S6.F7.8.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.8.1.m1.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, and compare them with only positive training (SFT) on <math id="S6.F7.9.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.F7.9.2.m2.1b"><msub id="S6.F7.9.2.m2.1.1" xref="S6.F7.9.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.F7.9.2.m2.1.1.2" xref="S6.F7.9.2.m2.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.F7.9.2.m2.1.1.3" xref="S6.F7.9.2.m2.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F7.9.2.m2.1c"><apply id="S6.F7.9.2.m2.1.1.cmml" xref="S6.F7.9.2.m2.1.1"><csymbol cd="ambiguous" id="S6.F7.9.2.m2.1.1.1.cmml" xref="S6.F7.9.2.m2.1.1">subscript</csymbol><ci id="S6.F7.9.2.m2.1.1.2.cmml" xref="S6.F7.9.2.m2.1.1.2">ğ’Ÿ</ci><ci id="S6.F7.9.2.m2.1.1.3.cmml" xref="S6.F7.9.2.m2.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.9.2.m2.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. On GSM8K (a) and MATH (b), we observe an <math id="S6.F7.10.3.m3.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S6.F7.10.3.m3.1b"><mrow id="S6.F7.10.3.m3.1c"><mn id="S6.F7.10.3.m3.1.1">8</mn><mo lspace="0.222em" id="S6.F7.10.3.m3.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S6.F7.10.3.m3.1d">8\times</annotation></semantics></math> gain from per-step DPO (SectionÂ <a href="#S4" title="4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) which aligns with our model of negative data that enables per-step credit assignment. In (c) we compare different negative data construction algorithms, and particularly note that naÃ¯vely pairing positives and negativesÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> leads to worse performance as we scale the number of synthetic problems in <math id="S6.F7.11.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.F7.11.4.m4.1b"><msub id="S6.F7.11.4.m4.1.1" xref="S6.F7.11.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.F7.11.4.m4.1.1.2" xref="S6.F7.11.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.F7.11.4.m4.1.1.3" xref="S6.F7.11.4.m4.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F7.11.4.m4.1c"><apply id="S6.F7.11.4.m4.1.1.cmml" xref="S6.F7.11.4.m4.1.1"><csymbol cd="ambiguous" id="S6.F7.11.4.m4.1.1.1.cmml" xref="S6.F7.11.4.m4.1.1">subscript</csymbol><ci id="S6.F7.11.4.m4.1.1.2.cmml" xref="S6.F7.11.4.m4.1.1.2">ğ’Ÿ</ci><ci id="S6.F7.11.4.m4.1.1.3.cmml" xref="S6.F7.11.4.m4.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.11.4.m4.1d">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Scaling Results for Negative Data</h4>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS2.p1.6" class="ltx_p">We present the results for scaling up negative data for training the DeepSeek-Math-7B and LLama2-7B models on GSM8K and MATH in FigureÂ <a href="#S6.F7" title="Figure 7 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>(a,b).
Observe in FigureÂ <a href="#S6.F7" title="Figure 7 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>(a,b), that for both DeepSeek-Math-7B and LLama2-7B models, per-step DPO improves performance beyond the SFT policy and the performance continues to scale favorably as data size increases. In fact, also note that for any given size of <math id="S6.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.SS2.p1.1.m1.1a"><msub id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p1.1.m1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.SS2.p1.1.m1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><apply id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.1.m1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.p1.1.m1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S6.SS2.p1.1.m1.1.1.3.cmml" xref="S6.SS2.p1.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>, per-step DPO also substantially improves over RFT (FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) on both datasets, and overall, <span id="S6.SS2.p1.5.4" class="ltx_text ltx_font_bold" style="color:#3873B3;">while RFT improved effective data size of <math id="S6.SS2.p1.2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.SS2.p1.2.1.m1.1a"><msub id="S6.SS2.p1.2.1.m1.1.1" xref="S6.SS2.p1.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#3873B3" id="S6.SS2.p1.2.1.m1.1.1.2" xref="S6.SS2.p1.2.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi mathcolor="#3873B3" id="S6.SS2.p1.2.1.m1.1.1.3" xref="S6.SS2.p1.2.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.1.m1.1b"><apply id="S6.SS2.p1.2.1.m1.1.1.cmml" xref="S6.SS2.p1.2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.2.1.m1.1.1.1.cmml" xref="S6.SS2.p1.2.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.p1.2.1.m1.1.1.2.cmml" xref="S6.SS2.p1.2.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S6.SS2.p1.2.1.m1.1.1.3.cmml" xref="S6.SS2.p1.2.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> by <math id="S6.SS2.p1.3.2.m2.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S6.SS2.p1.3.2.m2.1a"><mrow id="S6.SS2.p1.3.2.m2.1b"><mn mathcolor="#3873B3" id="S6.SS2.p1.3.2.m2.1.1">2</mn><mo lspace="0.222em" mathcolor="#3873B3" id="S6.SS2.p1.3.2.m2.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S6.SS2.p1.3.2.m2.1c">2\times</annotation></semantics></math>, additionally training on negative data extends the performance improvement to <math id="S6.SS2.p1.4.3.m3.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S6.SS2.p1.4.3.m3.1a"><mrow id="S6.SS2.p1.4.3.m3.1b"><mn mathcolor="#3873B3" id="S6.SS2.p1.4.3.m3.1.1">8</mn><mo lspace="0.222em" mathcolor="#3873B3" id="S6.SS2.p1.4.3.m3.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S6.SS2.p1.4.3.m3.1c">8\times</annotation></semantics></math> the size of <math id="S6.SS2.p1.5.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.SS2.p1.5.4.m4.1a"><msub id="S6.SS2.p1.5.4.m4.1.1" xref="S6.SS2.p1.5.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#3873B3" id="S6.SS2.p1.5.4.m4.1.1.2" xref="S6.SS2.p1.5.4.m4.1.1.2.cmml">ğ’Ÿ</mi><mi mathcolor="#3873B3" id="S6.SS2.p1.5.4.m4.1.1.3" xref="S6.SS2.p1.5.4.m4.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.5.4.m4.1b"><apply id="S6.SS2.p1.5.4.m4.1.1.cmml" xref="S6.SS2.p1.5.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.5.4.m4.1.1.1.cmml" xref="S6.SS2.p1.5.4.m4.1.1">subscript</csymbol><ci id="S6.SS2.p1.5.4.m4.1.1.2.cmml" xref="S6.SS2.p1.5.4.m4.1.1.2">ğ’Ÿ</ci><ci id="S6.SS2.p1.5.4.m4.1.1.3.cmml" xref="S6.SS2.p1.5.4.m4.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.5.4.m4.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.</span> Additionally, since per-step DPO estimates advantage of each step under the Best-of-K policy (with <math id="S6.SS2.p1.6.m2.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S6.SS2.p1.6.m2.1a"><mrow id="S6.SS2.p1.6.m2.1.1" xref="S6.SS2.p1.6.m2.1.1.cmml"><mi id="S6.SS2.p1.6.m2.1.1.2" xref="S6.SS2.p1.6.m2.1.1.2.cmml">K</mi><mo id="S6.SS2.p1.6.m2.1.1.1" xref="S6.SS2.p1.6.m2.1.1.1.cmml">=</mo><mn id="S6.SS2.p1.6.m2.1.1.3" xref="S6.SS2.p1.6.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.6.m2.1b"><apply id="S6.SS2.p1.6.m2.1.1.cmml" xref="S6.SS2.p1.6.m2.1.1"><eq id="S6.SS2.p1.6.m2.1.1.1.cmml" xref="S6.SS2.p1.6.m2.1.1.1"></eq><ci id="S6.SS2.p1.6.m2.1.1.2.cmml" xref="S6.SS2.p1.6.m2.1.1.2">ğ¾</ci><cn type="integer" id="S6.SS2.p1.6.m2.1.1.3.cmml" xref="S6.SS2.p1.6.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.6.m2.1c">K=5</annotation></semantics></math> in this setting), one might expect a saturation in the pass@5 performance of the per-step DPO solution. On the contrary, we find that pass@5 performance also improves consistently.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS2.p2.2" class="ltx_p"><span id="S6.SS2.p2.2.1" class="ltx_text ltx_font_bold">Choice of negative data has significant impact.</span>
In FigureÂ <a href="#S6.F7" title="Figure 7 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>(c) we plot negative data scaling laws where the choice of negative data (and thereby pairs for DPO in EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) differs.
Observe that standard pairing of positive and negative responses in <math id="S6.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S6.SS2.p2.1.m1.1a"><msubsup id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p2.1.m1.1.1.2.2" xref="S6.SS2.p2.1.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="S6.SS2.p2.1.m1.1.1.3" xref="S6.SS2.p2.1.m1.1.1.3.cmml"><mi id="S6.SS2.p2.1.m1.1.1.3.2" xref="S6.SS2.p2.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S6.SS2.p2.1.m1.1.1.3.3" xref="S6.SS2.p2.1.m1.1.1.3.3.cmml">sft</mi></msub><mo id="S6.SS2.p2.1.m1.1.1.2.3" xref="S6.SS2.p2.1.m1.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><apply id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.1.m1.1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">subscript</csymbol><apply id="S6.SS2.p2.1.m1.1.1.2.cmml" xref="S6.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.1.m1.1.1.2.1.cmml" xref="S6.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S6.SS2.p2.1.m1.1.1.2.2.cmml" xref="S6.SS2.p2.1.m1.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="S6.SS2.p2.1.m1.1.1.2.3.cmml" xref="S6.SS2.p2.1.m1.1.1.2.3">plus-or-minus</csymbol></apply><apply id="S6.SS2.p2.1.m1.1.1.3.cmml" xref="S6.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p2.1.m1.1.1.3.1.cmml" xref="S6.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S6.SS2.p2.1.m1.1.1.3.2.cmml" xref="S6.SS2.p2.1.m1.1.1.3.2">ğœ‹</ci><ci id="S6.SS2.p2.1.m1.1.1.3.3.cmml" xref="S6.SS2.p2.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> for DPOÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> does not improve upon the SFT policy. As such, we needed to tune <math id="S6.SS2.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S6.SS2.p2.2.m2.1a"><mi id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml">Î²</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><ci id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1">ğ›½</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">\beta</annotation></semantics></math> in EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for DPO but could not fully avoid performance degradation.
Our conceptual model explains this result: since contrasting arbitrary positives and negatives would result in an incorrect induced advantage function, training with DPO will exacerbate spurious correlations that maximize this induced advantage functionÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>. In fact, <cite class="ltx_cite ltx_citemacro_citet">Pal etÂ al. [<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> also find similar concerns with random pairing and instead pair positives and negatives that with highest edit distance, which leads to some improvement over standard DPO (FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c)) but still performs poorer than per-step DPO that accounts for credit.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para ltx_noindent">
<svg id="S6.SS2.p3.pic1" class="ltx_picture" height="87.45" overflow="visible" version="1.1" width="600"><g transform="translate(0,87.45) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 69.4 C 0 72.66 2.64 75.31 5.91 75.31 L 594.09 75.31 C 597.36 75.31 600 72.66 600 69.4 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F0F0FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 69.4 C 1.97 71.58 3.73 73.34 5.91 73.34 L 594.09 73.34 C 596.27 73.34 598.03 71.58 598.03 69.4 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 15 65.31)"><g class="ltx_nestedsvg" transform="matrix(1 0 0 1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#FFFFFF" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 296.91 22.14 C 298.54 22.14 299.86 20.82 299.86 19.19 L 299.86 2.95 C 299.86 1.32 298.54 0 296.91 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill="#000000" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 296.91 22.14 C 298.54 22.14 299.86 20.82 299.86 19.19 L 299.86 2.95 C 299.86 1.32 298.54 0 296.91 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 11.81 7.61)"><text transform="matrix(1 0 0 -1 0 0)" color="#000000">Takeaways for scaling negative synthetic data</text></g></g></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 11.44)"><foreignObject width="556.69" height="46.89" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="S6.SS2.p3.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="S6.I1" class="ltx_itemize">
<span id="S6.I1.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">â€¢</span> 
<span id="S6.I1.i1.p1" class="ltx_para">
<span id="S6.I1.i1.p1.1" class="ltx_p">Negative data can identify high-advantage (critical) steps in model-generated responses.</span>
</span></span>
<span id="S6.I1.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">â€¢</span> 
<span id="S6.I1.i2.p1" class="ltx_para ltx_noindent">
<span id="S6.I1.i2.p1.1" class="ltx_p">We can construct negative data distribution that equates DPO to advantage-weighted RL. Negative data used in this way improves the sample efficiency of synthetic data by <math id="S6.I1.i2.p1.1.m1.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S6.I1.i2.p1.1.m1.1a"><mrow id="S6.I1.i2.p1.1.m1.1b"><mn id="S6.I1.i2.p1.1.m1.1.1">8</mn><mo lspace="0.222em" id="S6.I1.i2.p1.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S6.I1.i2.p1.1.m1.1c">8\times</annotation></semantics></math>.</span>
</span></span>
</span>
</span></foreignObject></g></g></svg>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Why Does Credit Assignment from Negative Data Improve Model Generalization?</h4>

<div id="S6.SS3.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.p1.1" class="ltx_p">Recall that when we sample preference pairs from the distribution in TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>, per-step DPO is equivalent to advantage-weighted RL.
In other words, our conceptual model illustrates that per-step DPO can perform credit assignment,
and identify critical steps over irrelevant or incorrect ones by computing advantage estimates.
We see that this improves test performance and scaling trends (in SectionÂ <a href="#S6.SS2" title="6.2 Scaling Results for Negative Data â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>) over SFT and standard DPOÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> with the same data. To explain these results, we need to understand the generalization gains afforded by the advantage-weighted RL objective.</p>
</div>
<section id="S6.SS3.SSS1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.1 </span>Advantage-Weighted RL De-Emphasizes Spurious Steps and Emphasizes Critical Steps</h5>

<div id="S6.SS3.SSS1.p1" class="ltx_para">
<p id="S6.SS3.SSS1.p1.1" class="ltx_p">We first explain how <em id="S6.SS3.SSS1.p1.1.1" class="ltx_emph ltx_font_italic">online</em> model-specific interventions and advantage estimation would emphasize critical steps and de-emphasize spurious ones. Consider <math id="S6.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\tilde{\pi}=\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS1.p1.1.m1.1a"><mrow id="S6.SS3.SSS1.p1.1.m1.1.1" xref="S6.SS3.SSS1.p1.1.m1.1.1.cmml"><mover accent="true" id="S6.SS3.SSS1.p1.1.m1.1.1.2" xref="S6.SS3.SSS1.p1.1.m1.1.1.2.cmml"><mi id="S6.SS3.SSS1.p1.1.m1.1.1.2.2" xref="S6.SS3.SSS1.p1.1.m1.1.1.2.2.cmml">Ï€</mi><mo id="S6.SS3.SSS1.p1.1.m1.1.1.2.1" xref="S6.SS3.SSS1.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mo id="S6.SS3.SSS1.p1.1.m1.1.1.1" xref="S6.SS3.SSS1.p1.1.m1.1.1.1.cmml">=</mo><msub id="S6.SS3.SSS1.p1.1.m1.1.1.3" xref="S6.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S6.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S6.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="S6.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S6.SS3.SSS1.p1.1.m1.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p1.1.m1.1b"><apply id="S6.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1"><eq id="S6.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.1"></eq><apply id="S6.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.2"><ci id="S6.SS3.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.2.1">~</ci><ci id="S6.SS3.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.2.2">ğœ‹</ci></apply><apply id="S6.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.3">subscript</csymbol><ci id="S6.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.3.2">ğœ‹</ci><ci id="S6.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S6.SS3.SSS1.p1.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p1.1.m1.1c">\tilde{\pi}=\pi_{\mathrm{sft}}</annotation></semantics></math>, <span id="S6.SS3.SSS1.p1.1.2" class="ltx_text ltx_font_italic">i.e.</span>, the advantage estimates are computed under</p>
</div>
<figure id="S6.F8" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x13.png" id="S6.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="341" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S6.F8.4.2" class="ltx_text" style="font-size:90%;"> <span id="S6.F8.4.2.1" class="ltx_text" style="font-size:89%;">Per-step DPO improves Q-values at each step, standard DPO only improves at irrelevant steps.</span></span></figcaption>
</figure>
<div id="S6.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS1.p2.5" class="ltx_p">the base policy itself. If some spurious (<span id="S6.SS3.SSS1.p2.5.1" class="ltx_text ltx_font_italic">i.e.</span>, incorrect or distracting) step <math id="S6.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{y}_{s}" display="inline"><semantics id="S6.SS3.SSS1.p2.1.m1.1a"><msub id="S6.SS3.SSS1.p2.1.m1.1.1" xref="S6.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S6.SS3.SSS1.p2.1.m1.1.1.2" xref="S6.SS3.SSS1.p2.1.m1.1.1.2.cmml">ğ²</mi><mi id="S6.SS3.SSS1.p2.1.m1.1.1.3" xref="S6.SS3.SSS1.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p2.1.m1.1b"><apply id="S6.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S6.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S6.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S6.SS3.SSS1.p2.1.m1.1.1.2">ğ²</ci><ci id="S6.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S6.SS3.SSS1.p2.1.m1.1.1.3">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p2.1.m1.1c">\mathbf{y}_{s}</annotation></semantics></math> is imperfectly cloned under <math id="S6.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS1.p2.2.m2.1a"><msub id="S6.SS3.SSS1.p2.2.m2.1.1" xref="S6.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S6.SS3.SSS1.p2.2.m2.1.1.2" xref="S6.SS3.SSS1.p2.2.m2.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS1.p2.2.m2.1.1.3" xref="S6.SS3.SSS1.p2.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p2.2.m2.1b"><apply id="S6.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S6.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S6.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S6.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S6.SS3.SSS1.p2.2.m2.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S6.SS3.SSS1.p2.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p2.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>, then while the average teacher-forcing loss is misleadingly low, the loss on just the spurious step would remain high. This would mean that when using autoregressive decoding during inference, the rollouts may not replicate steps in the training data perfectly. Due to this imperfect replication, spurious steps will present low advantage estimates: concretely, if a step <math id="S6.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{s}" display="inline"><semantics id="S6.SS3.SSS1.p2.3.m3.1a"><msub id="S6.SS3.SSS1.p2.3.m3.1.1" xref="S6.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S6.SS3.SSS1.p2.3.m3.1.1.2" xref="S6.SS3.SSS1.p2.3.m3.1.1.2.cmml">ğ²</mi><mi id="S6.SS3.SSS1.p2.3.m3.1.1.3" xref="S6.SS3.SSS1.p2.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p2.3.m3.1b"><apply id="S6.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S6.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S6.SS3.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S6.SS3.SSS1.p2.3.m3.1.1.2">ğ²</ci><ci id="S6.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S6.SS3.SSS1.p2.3.m3.1.1.3">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p2.3.m3.1c">\mathbf{y}_{s}</annotation></semantics></math> is imperfectly cloned and enough samples are drawn from <math id="S6.SS3.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS1.p2.4.m4.1a"><msub id="S6.SS3.SSS1.p2.4.m4.1.1" xref="S6.SS3.SSS1.p2.4.m4.1.1.cmml"><mi id="S6.SS3.SSS1.p2.4.m4.1.1.2" xref="S6.SS3.SSS1.p2.4.m4.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS1.p2.4.m4.1.1.3" xref="S6.SS3.SSS1.p2.4.m4.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p2.4.m4.1b"><apply id="S6.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S6.SS3.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S6.SS3.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S6.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S6.SS3.SSS1.p2.4.m4.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S6.SS3.SSS1.p2.4.m4.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p2.4.m4.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> conditioned on <math id="S6.SS3.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{y}_{1:s}" display="inline"><semantics id="S6.SS3.SSS1.p2.5.m5.1a"><msub id="S6.SS3.SSS1.p2.5.m5.1.1" xref="S6.SS3.SSS1.p2.5.m5.1.1.cmml"><mi id="S6.SS3.SSS1.p2.5.m5.1.1.2" xref="S6.SS3.SSS1.p2.5.m5.1.1.2.cmml">ğ²</mi><mrow id="S6.SS3.SSS1.p2.5.m5.1.1.3" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.cmml"><mn id="S6.SS3.SSS1.p2.5.m5.1.1.3.2" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS3.SSS1.p2.5.m5.1.1.3.1" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.1.cmml">:</mo><mi id="S6.SS3.SSS1.p2.5.m5.1.1.3.3" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p2.5.m5.1b"><apply id="S6.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS1.p2.5.m5.1.1.1.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S6.SS3.SSS1.p2.5.m5.1.1.2.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1.2">ğ²</ci><apply id="S6.SS3.SSS1.p2.5.m5.1.1.3.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1.3"><ci id="S6.SS3.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.1">:</ci><cn type="integer" id="S6.SS3.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.2">1</cn><ci id="S6.SS3.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S6.SS3.SSS1.p2.5.m5.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p2.5.m5.1c">\mathbf{y}_{1:s}</annotation></semantics></math>, many of them would lead to incorrect final answers. On the other hand, if all steps in the SFT data are perfectly cloned, then during inference, the rollouts would reproduce the solutions that end with correct answers. Thus, all steps in this solution would have a higher advantage estimates. Thus in this case, training with RL would de-emphasize spurious steps and emphasize critical steps.</p>
</div>
<div id="S6.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS1.p3.2" class="ltx_p">To verify this explanation in practice, we recall that running per-step training with negative data generated by the RFT model that has overfit on distracting steps improved accuracy by <math id="S6.SS3.SSS1.p3.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S6.SS3.SSS1.p3.1.m1.1a"><mo id="S6.SS3.SSS1.p3.1.m1.1.1" xref="S6.SS3.SSS1.p3.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p3.1.m1.1b"><gt id="S6.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S6.SS3.SSS1.p3.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p3.1.m1.1c">&gt;</annotation></semantics></math><math id="S6.SS3.SSS1.p3.2.m2.1" class="ltx_Math" alttext="6\%" display="inline"><semantics id="S6.SS3.SSS1.p3.2.m2.1a"><mrow id="S6.SS3.SSS1.p3.2.m2.1.1" xref="S6.SS3.SSS1.p3.2.m2.1.1.cmml"><mn id="S6.SS3.SSS1.p3.2.m2.1.1.2" xref="S6.SS3.SSS1.p3.2.m2.1.1.2.cmml">6</mn><mo id="S6.SS3.SSS1.p3.2.m2.1.1.1" xref="S6.SS3.SSS1.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS1.p3.2.m2.1b"><apply id="S6.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S6.SS3.SSS1.p3.2.m2.1.1"><csymbol cd="latexml" id="S6.SS3.SSS1.p3.2.m2.1.1.1.cmml" xref="S6.SS3.SSS1.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S6.SS3.SSS1.p3.2.m2.1.1.2.cmml" xref="S6.SS3.SSS1.p3.2.m2.1.1.2">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS1.p3.2.m2.1c">6\%</annotation></semantics></math> in FigureÂ <a href="#S5.F5" title="Figure 5 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We visualize advantages against real examples appearing in this fine-tuning dataset in AppendixÂ <a href="#A5" title="Appendix E Negative Data Identifies Spurious Steps with Advantage Estimates â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>, and observe that advantage estimates indeed de-emphasize spurious steps. Aggregating over examples, in FigureÂ <a href="#S6.F8" title="Figure 8 â€£ 6.3.1 Advantage-Weighted RL De-Emphasizes Spurious Steps and Emphasizes Critical Steps â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we plot the average Q-value of a step for different negative data schemes, and note that only per-step DPO improves the Q-values attained at every step compared to SFT, as expected based on the connection to advantage-weighted RL (TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>), indicating that per-step DPO trains the model to emphasize the more critical steps.</p>
</div>
<figure id="S6.F9" class="ltx_figure"><svg id="S6.F9.pic1" class="ltx_picture ltx_centering" height="124.88" overflow="visible" version="1.1" width="600"><g transform="translate(0,124.88) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 118.98 C 0 122.24 2.64 124.88 5.91 124.88 L 594.09 124.88 C 597.36 124.88 600 122.24 600 118.98 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 103.23 L 598.03 103.23 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 109.14)"><foreignObject width="556.69" height="9.84" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="S6.F9.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="S6.F9.pic1.1.1.1.1.1.1" class="ltx_p"><span id="S6.F9.pic1.1.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Advantage Estimates Computed Over a Positive Model Generated Sample</span></span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="77.64" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="S6.F9.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="S6.F9.pic1.2.2.2.1.1.1" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Question:</span><span id="S6.F9.pic1.2.2.2.1.1.1.2" class="ltx_text" style="font-size:80%;"></span></span>
<span id="S6.F9.pic1.2.2.2.1.1.2" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.2.1" class="ltx_text" style="font-size:80%;">Betty wants a new wallet which costs $100. Betty has only half of the money she needs. Her parents give her $15 for that purpose, and her grandparents twice as much as her parents. How much more money does Betty need?</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.3" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Positive response with identified spurious step: </span><span id="S6.F9.pic1.2.2.2.1.1.3.2" class="ltx_text" style="font-size:80%;"></span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4" class="ltx_p">
<span id="S6.F9.pic1.2.2.2.1.1.4.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="S6.F9.pic1.2.2.2.1.1.4.1.1" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.1.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">Bettyâ€™s</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.2" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.2.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">parents</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.3" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.3.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">gave</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.4" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.4.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">her</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.5" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.5.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">15,</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.6" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.6.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">so</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.7" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.7.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">her</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.8" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.8.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">grandparents</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.9" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.9.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">gave</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.10" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.10.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">her</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.11" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.11.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">2</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.12" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.12.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">*</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.13" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.13.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">15</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.14" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.14.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">=</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.15" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.15.1" class="ltx_text" style="font-size:80%;background-color:#FFCCCC;">&lt;&lt;15*2=30&gt;&gt;30.</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.16" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.16.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">In</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.17" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.17.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">total,</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.18" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.18.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">Betty</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.19" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.19.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">received</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.20" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.20.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">30</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.21" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.21.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">+</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.22" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.22.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">15</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.23" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.23.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">=</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.24" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.24.1" class="ltx_text" style="font-size:80%;background-color:#FFD4D4;">&lt;&lt;30+15=45&gt;&gt;45.</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.25" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.25.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">The</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.26" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.26.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">total</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.27" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.27.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">amount</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.28" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.28.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">of</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.29" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.29.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">money</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.30" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.30.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">Betty</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.31" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.31.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">needs</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.32" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.32.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">is</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.33" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.33.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">100</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.34" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.34.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">*</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.35" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.35.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">2</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.36" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.36.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">=</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.37" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.37.1" class="ltx_text" style="font-size:80%;background-color:#FF5E5E;">&lt;&lt;100*2=200&gt;&gt;200.</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.38" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.38.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">Betty</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.39" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.39.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">needs</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.40" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.40.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">100</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.41" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.41.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">/</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.42" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.42.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">2</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.43" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.43.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">=</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.44" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.44.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">&lt;&lt;100/2=50&gt;&gt;50</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.45" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.45.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">in</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.46" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.46.1" class="ltx_text" style="font-size:80%;background-color:#FFC4C4;">total.</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.47" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.47.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">Betty</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.48" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.48.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">still</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.49" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.49.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">needs</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.50" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.50.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">to</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.51" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.51.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">save</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.52" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.52.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">50</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.53" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.53.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">-</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.54" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.54.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">45</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.55" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.55.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">=</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.56" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.56.1" class="ltx_text" style="font-size:80%;background-color:#FFA0A0;">&lt;&lt;50-45=5&gt;&gt;5.</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.57" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.57.1" class="ltx_text" style="font-size:80%;background-color:#FFC1C1;">The</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.58" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.58.1" class="ltx_text" style="font-size:80%;background-color:#FFC1C1;">answer</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.59" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.59.1" class="ltx_text" style="font-size:80%;background-color:#FFC1C1;">is</span></span>
<span id="S6.F9.pic1.2.2.2.1.1.4.1.60" class="ltx_p"><span id="S6.F9.pic1.2.2.2.1.1.4.1.60.1" class="ltx_text" style="font-size:80%;background-color:#FFC1C1;">5</span></span>
</span></span>
</span></foreignObject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F9.4.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S6.F9.5.2" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:80%;">Spurious steps have low advantage values:</span><span id="S6.F9.6.3" class="ltx_text" style="font-size:80%;"> For each step in a correct (positive) response sampled from the SFT policy we compute the advantage values (lower values are darker) and find that the advantage estimates indeed identify the spurious step. </span></figcaption>
</figure>
</section>
<section id="S6.SS3.SSS2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.2 </span>Why Does Generalization Improve?: Connecting Advantage-Weighted RL to DRO</h5>

<div id="S6.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS2.p1.1" class="ltx_p">In the previous section, we discussed how advantage-weighted RL preferentially weighs the next-token prediction loss at each step. Now, we attempt to conceptually understand why this could improve generalization. For this, we present an intuitive explanation by drawing a connection between advantage-weighted RL and a distributionally robust optimization (DRO) algorithm, named Group DRO, commonly used to improve worst-group robustness in supervised learningÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.</p>
</div>
<div id="S6.SS3.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS2.p2.2" class="ltx_p"><span id="S6.SS3.SSS2.p2.2.1" class="ltx_text ltx_font_bold">Intuitive explanation.</span> During inference, the SFT policy can fail even on training problems, especially in scenarios where the SFT policy has failed to perfectly clone the next step at each intermediate step in the SFT data. As previously discussed, these steps also present with low advantage values. One way to reduce the chance of compounding inference time errorsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> is to preferentially minimize the negative log-likelihood loss <em id="S6.SS3.SSS2.p2.2.2" class="ltx_emph ltx_font_italic">more</em> for the critical step, i.e., those steps from where the model is more likely to arrive at a wrong answer. If we iteratively update the policy with gradient steps computed over a re-weighted next-step prediction objective where each step is weighted by its advantage estimate, then the resulting algorithm intuitively exhibits this characteristic similarly to distributionally robust optimizers (DRO)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
Similar to how DRO solutions guarantee that all subpopulations â€“ both majority and minority subpopulations â€“ in the training data achieve low loss values, the solution for the advantage-weighted RL objective guarantees that the negative log-likelihood of the critical steps with high advantage estimates under <math id="S6.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS3.SSS2.p2.1.m1.1a"><mover accent="true" id="S6.SS3.SSS2.p2.1.m1.1.1" xref="S6.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S6.SS3.SSS2.p2.1.m1.1.1.2" xref="S6.SS3.SSS2.p2.1.m1.1.1.2.cmml">Ï€</mi><mo id="S6.SS3.SSS2.p2.1.m1.1.1.1" xref="S6.SS3.SSS2.p2.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS2.p2.1.m1.1b"><apply id="S6.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S6.SS3.SSS2.p2.1.m1.1.1"><ci id="S6.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S6.SS3.SSS2.p2.1.m1.1.1.1">~</ci><ci id="S6.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S6.SS3.SSS2.p2.1.m1.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS2.p2.1.m1.1c">\tilde{\pi}</annotation></semantics></math> (which of per-step DPO is <math id="S6.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\text{BoK}(\pi_{\mathrm{sft}})" display="inline"><semantics id="S6.SS3.SSS2.p2.2.m2.1a"><mrow id="S6.SS3.SSS2.p2.2.m2.1.1" xref="S6.SS3.SSS2.p2.2.m2.1.1.cmml"><mtext id="S6.SS3.SSS2.p2.2.m2.1.1.3" xref="S6.SS3.SSS2.p2.2.m2.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS3.SSS2.p2.2.m2.1.1.2" xref="S6.SS3.SSS2.p2.2.m2.1.1.2.cmml">â€‹</mo><mrow id="S6.SS3.SSS2.p2.2.m2.1.1.1.1" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.2" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.2" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.3" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.3" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS2.p2.2.m2.1b"><apply id="S6.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1"><times id="S6.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.2"></times><ci id="S6.SS3.SSS2.p2.2.m2.1.1.3a.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.3"><mtext id="S6.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.3">BoK</mtext></ci><apply id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS3.SSS2.p2.2.m2.1.1.1.1.1.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS2.p2.2.m2.1c">\text{BoK}(\pi_{\mathrm{sft}})</annotation></semantics></math>) is also low, to a similar extent as the other more prevalent non-critical steps.</p>
</div>
<div id="S6.SS3.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS2.p3.1" class="ltx_p">In other words, <span id="S6.SS3.SSS2.p3.1.1" class="ltx_text ltx_font_bold">our insight</span> is that weighting steps using advantages in EquationÂ <a href="#S6.E4" title="In Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> upweights the likelihood of the underrepresented critical states while down-weighting it for the spurious ones.
The guarantees on the training data (<math id="S6.SS3.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.SS3.SSS2.p3.1.m1.1a"><msub id="S6.SS3.SSS2.p3.1.m1.1.1" xref="S6.SS3.SSS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.SSS2.p3.1.m1.1.1.2" xref="S6.SS3.SSS2.p3.1.m1.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.SS3.SSS2.p3.1.m1.1.1.3" xref="S6.SS3.SSS2.p3.1.m1.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS2.p3.1.m1.1b"><apply id="S6.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S6.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S6.SS3.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S6.SS3.SSS2.p3.1.m1.1.1.2">ğ’Ÿ</ci><ci id="S6.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S6.SS3.SSS2.p3.1.m1.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS2.p3.1.m1.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>) also translate to the population level objective when the weights for on-policy samples (advantage estimates) are accurateÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> and the policy is sufficiently regularizedÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>.
Since correct behavior at critical steps determine the correctness of the overall solution, an elevated degree of correctness at executing critical steps at the population level implies a higher test accuracy on the reasoning task.</p>
</div>
</section>
<section id="S6.SS3.SSS3" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.3 </span>But, Attaining Low Generalization Error Requires Low Advantage Estimation Error</h5>

<div id="S6.SS3.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS3.p1.7" class="ltx_p">The practical efficacy of algorithms that use negative data for credit assignment requires the advantage estimates to be fairly accurate when estimated using just a few rollouts from <math id="S6.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="S6.SS3.SSS3.p1.1.m1.1a"><mover accent="true" id="S6.SS3.SSS3.p1.1.m1.1.1" xref="S6.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.SSS3.p1.1.m1.1.1.2" xref="S6.SS3.SSS3.p1.1.m1.1.1.2.cmml">Ï€</mi><mo id="S6.SS3.SSS3.p1.1.m1.1.1.1" xref="S6.SS3.SSS3.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.1.m1.1b"><apply id="S6.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S6.SS3.SSS3.p1.1.m1.1.1"><ci id="S6.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.SSS3.p1.1.m1.1.1.1">~</ci><ci id="S6.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.SSS3.p1.1.m1.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.1.m1.1c">\tilde{\pi}</annotation></semantics></math>. For understanding this, let us consider a simple example when we set <math id="S6.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\tilde{\pi}=\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS3.p1.2.m2.1a"><mrow id="S6.SS3.SSS3.p1.2.m2.1.1" xref="S6.SS3.SSS3.p1.2.m2.1.1.cmml"><mover accent="true" id="S6.SS3.SSS3.p1.2.m2.1.1.2" xref="S6.SS3.SSS3.p1.2.m2.1.1.2.cmml"><mi id="S6.SS3.SSS3.p1.2.m2.1.1.2.2" xref="S6.SS3.SSS3.p1.2.m2.1.1.2.2.cmml">Ï€</mi><mo id="S6.SS3.SSS3.p1.2.m2.1.1.2.1" xref="S6.SS3.SSS3.p1.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="S6.SS3.SSS3.p1.2.m2.1.1.1" xref="S6.SS3.SSS3.p1.2.m2.1.1.1.cmml">=</mo><msub id="S6.SS3.SSS3.p1.2.m2.1.1.3" xref="S6.SS3.SSS3.p1.2.m2.1.1.3.cmml"><mi id="S6.SS3.SSS3.p1.2.m2.1.1.3.2" xref="S6.SS3.SSS3.p1.2.m2.1.1.3.2.cmml">Ï€</mi><mi id="S6.SS3.SSS3.p1.2.m2.1.1.3.3" xref="S6.SS3.SSS3.p1.2.m2.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.2.m2.1b"><apply id="S6.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1"><eq id="S6.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.1"></eq><apply id="S6.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.2"><ci id="S6.SS3.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.2.1">~</ci><ci id="S6.SS3.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.2.2">ğœ‹</ci></apply><apply id="S6.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S6.SS3.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.3.2">ğœ‹</ci><ci id="S6.SS3.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S6.SS3.SSS3.p1.2.m2.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.2.m2.1c">\tilde{\pi}=\pi_{\mathrm{sft}}</annotation></semantics></math>.
If the initial advantage of a spurious step is incorrectly over-estimated, advantage-weighted RL via negative data would up-weight the likelihood further. To see why, consider a scenario when most Monte Carlo rollouts from <math id="S6.SS3.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\tilde{\pi}=\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS3.p1.3.m3.1a"><mrow id="S6.SS3.SSS3.p1.3.m3.1.1" xref="S6.SS3.SSS3.p1.3.m3.1.1.cmml"><mover accent="true" id="S6.SS3.SSS3.p1.3.m3.1.1.2" xref="S6.SS3.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S6.SS3.SSS3.p1.3.m3.1.1.2.2" xref="S6.SS3.SSS3.p1.3.m3.1.1.2.2.cmml">Ï€</mi><mo id="S6.SS3.SSS3.p1.3.m3.1.1.2.1" xref="S6.SS3.SSS3.p1.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="S6.SS3.SSS3.p1.3.m3.1.1.1" xref="S6.SS3.SSS3.p1.3.m3.1.1.1.cmml">=</mo><msub id="S6.SS3.SSS3.p1.3.m3.1.1.3" xref="S6.SS3.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S6.SS3.SSS3.p1.3.m3.1.1.3.2" xref="S6.SS3.SSS3.p1.3.m3.1.1.3.2.cmml">Ï€</mi><mi id="S6.SS3.SSS3.p1.3.m3.1.1.3.3" xref="S6.SS3.SSS3.p1.3.m3.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.3.m3.1b"><apply id="S6.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1"><eq id="S6.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.1"></eq><apply id="S6.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.2"><ci id="S6.SS3.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.2.1">~</ci><ci id="S6.SS3.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.2.2">ğœ‹</ci></apply><apply id="S6.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S6.SS3.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.3.2">ğœ‹</ci><ci id="S6.SS3.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S6.SS3.SSS3.p1.3.m3.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.3.m3.1c">\tilde{\pi}=\pi_{\mathrm{sft}}</annotation></semantics></math> contain the spurious step.
Since the model is still able to generate the correct final answer even after it produces a spurious step on training problems, subsequent rollouts from the model would estimate higher <math id="S6.SS3.SSS3.p1.4.m4.1" class="ltx_Math" alttext="A_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="S6.SS3.SSS3.p1.4.m4.1a"><msub id="S6.SS3.SSS3.p1.4.m4.1.1" xref="S6.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S6.SS3.SSS3.p1.4.m4.1.1.2" xref="S6.SS3.SSS3.p1.4.m4.1.1.2.cmml">A</mi><msub id="S6.SS3.SSS3.p1.4.m4.1.1.3" xref="S6.SS3.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S6.SS3.SSS3.p1.4.m4.1.1.3.2" xref="S6.SS3.SSS3.p1.4.m4.1.1.3.2.cmml">Ï€</mi><mi id="S6.SS3.SSS3.p1.4.m4.1.1.3.3" xref="S6.SS3.SSS3.p1.4.m4.1.1.3.3.cmml">sft</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.4.m4.1b"><apply id="S6.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S6.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1.2">ğ´</ci><apply id="S6.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S6.SS3.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1.3.2">ğœ‹</ci><ci id="S6.SS3.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S6.SS3.SSS3.p1.4.m4.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.4.m4.1c">A_{\pi_{\mathrm{sft}}}</annotation></semantics></math> for this step, and further advantage-weighted RL training would emphasize this step. This would result in a downward spiral: the model is trained to use the spurious step, which then results in even higher advantage values for this step, which in turns reinforces the same step over and over again. In this scenario, we would not expect advantage-weighted RL to unlearn the spurious step at all or improve generalization, in fact it would only amplify the dependence on this step.
On the other hand, when <math id="S6.SS3.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\tilde{\pi}=\text{BoK}(\pi_{\mathrm{sft}})" display="inline"><semantics id="S6.SS3.SSS3.p1.5.m5.1a"><mrow id="S6.SS3.SSS3.p1.5.m5.1.1" xref="S6.SS3.SSS3.p1.5.m5.1.1.cmml"><mover accent="true" id="S6.SS3.SSS3.p1.5.m5.1.1.3" xref="S6.SS3.SSS3.p1.5.m5.1.1.3.cmml"><mi id="S6.SS3.SSS3.p1.5.m5.1.1.3.2" xref="S6.SS3.SSS3.p1.5.m5.1.1.3.2.cmml">Ï€</mi><mo id="S6.SS3.SSS3.p1.5.m5.1.1.3.1" xref="S6.SS3.SSS3.p1.5.m5.1.1.3.1.cmml">~</mo></mover><mo id="S6.SS3.SSS3.p1.5.m5.1.1.2" xref="S6.SS3.SSS3.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S6.SS3.SSS3.p1.5.m5.1.1.1" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.cmml"><mtext id="S6.SS3.SSS3.p1.5.m5.1.1.1.3" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="S6.SS3.SSS3.p1.5.m5.1.1.1.2" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.2.cmml">â€‹</mo><mrow id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.2" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><msub id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.2" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.3" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.3" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.5.m5.1b"><apply id="S6.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1"><eq id="S6.SS3.SSS3.p1.5.m5.1.1.2.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.2"></eq><apply id="S6.SS3.SSS3.p1.5.m5.1.1.3.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.3"><ci id="S6.SS3.SSS3.p1.5.m5.1.1.3.1.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.3.1">~</ci><ci id="S6.SS3.SSS3.p1.5.m5.1.1.3.2.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.3.2">ğœ‹</ci></apply><apply id="S6.SS3.SSS3.p1.5.m5.1.1.1.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1"><times id="S6.SS3.SSS3.p1.5.m5.1.1.1.2.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.2"></times><ci id="S6.SS3.SSS3.p1.5.m5.1.1.1.3a.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.3"><mtext id="S6.SS3.SSS3.p1.5.m5.1.1.1.3.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.3">BoK</mtext></ci><apply id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S6.SS3.SSS3.p1.5.m5.1.1.1.1.1.1.3">sft</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.5.m5.1c">\tilde{\pi}=\text{BoK}(\pi_{\mathrm{sft}})</annotation></semantics></math> for a higher value of <math id="S6.SS3.SSS3.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS3.SSS3.p1.6.m6.1a"><mi id="S6.SS3.SSS3.p1.6.m6.1.1" xref="S6.SS3.SSS3.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.6.m6.1b"><ci id="S6.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S6.SS3.SSS3.p1.6.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.6.m6.1c">K</annotation></semantics></math>, the Monte Carlo advantage estimator has a lower variance. This justifies the choice of <math id="S6.SS3.SSS3.p1.7.m7.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S6.SS3.SSS3.p1.7.m7.1a"><mrow id="S6.SS3.SSS3.p1.7.m7.1.1" xref="S6.SS3.SSS3.p1.7.m7.1.1.cmml"><mi id="S6.SS3.SSS3.p1.7.m7.1.1.2" xref="S6.SS3.SSS3.p1.7.m7.1.1.2.cmml">K</mi><mo id="S6.SS3.SSS3.p1.7.m7.1.1.1" xref="S6.SS3.SSS3.p1.7.m7.1.1.1.cmml">=</mo><mn id="S6.SS3.SSS3.p1.7.m7.1.1.3" xref="S6.SS3.SSS3.p1.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p1.7.m7.1b"><apply id="S6.SS3.SSS3.p1.7.m7.1.1.cmml" xref="S6.SS3.SSS3.p1.7.m7.1.1"><eq id="S6.SS3.SSS3.p1.7.m7.1.1.1.cmml" xref="S6.SS3.SSS3.p1.7.m7.1.1.1"></eq><ci id="S6.SS3.SSS3.p1.7.m7.1.1.2.cmml" xref="S6.SS3.SSS3.p1.7.m7.1.1.2">ğ¾</ci><cn type="integer" id="S6.SS3.SSS3.p1.7.m7.1.1.3.cmml" xref="S6.SS3.SSS3.p1.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p1.7.m7.1c">K=5</annotation></semantics></math>, which is large enough given our computational budget.</p>
</div>
<figure id="S6.F10" class="ltx_figure ltx_align_floatright"><img src="/html/2406.14532/assets/x14.png" id="S6.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="287" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F10.4.2.1" class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span id="S6.F10.2.1" class="ltx_text" style="font-size:90%;"> <span id="S6.F10.2.1.1" class="ltx_text" style="font-size:89%;">On MATH, improving advantage estimates by computing advantages over both positive and negative traces sampled from <math id="S6.F10.2.1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.F10.2.1.1.m1.1b"><msub id="S6.F10.2.1.1.m1.1.1" xref="S6.F10.2.1.1.m1.1.1.cmml"><mi id="S6.F10.2.1.1.m1.1.1.2" xref="S6.F10.2.1.1.m1.1.1.2.cmml">Ï€</mi><mi id="S6.F10.2.1.1.m1.1.1.3" xref="S6.F10.2.1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F10.2.1.1.m1.1c"><apply id="S6.F10.2.1.1.m1.1.1.cmml" xref="S6.F10.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.F10.2.1.1.m1.1.1.1.cmml" xref="S6.F10.2.1.1.m1.1.1">subscript</csymbol><ci id="S6.F10.2.1.1.m1.1.1.2.cmml" xref="S6.F10.2.1.1.m1.1.1.2">ğœ‹</ci><ci id="S6.F10.2.1.1.m1.1.1.3.cmml" xref="S6.F10.2.1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F10.2.1.1.m1.1d">\pi_{\mathrm{sft}}</annotation></semantics></math> improves estimation error and final performance for per-step DPO.</span></span></figcaption>
</figure>
<div id="S6.SS3.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS3.p2.12" class="ltx_p"><span id="S6.SS3.SSS3.p2.12.1" class="ltx_text ltx_font_bold">Improving per-step DPOÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> with a closer approximation of advantage-weighted RL (Parts 1 + 2 in AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</span> Now, we discuss an experiment that improves the performance of per-step DPOÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> by running the full version of the per-step DPO algorithm (AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). In particular, we add new preference pairs to the dataset of per-step DPO algorithm starting from positive samples.
Recall from SectionÂ <a href="#S4" title="4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, that for a problem <math id="S6.SS3.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S6.SS3.SSS3.p2.1.m1.1a"><mi id="S6.SS3.SSS3.p2.1.m1.1.1" xref="S6.SS3.SSS3.p2.1.m1.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.1.m1.1b"><ci id="S6.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S6.SS3.SSS3.p2.1.m1.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.1.m1.1c">\mathbf{x}</annotation></semantics></math>, with correct answer <math id="S6.SS3.SSS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S6.SS3.SSS3.p2.2.m2.1a"><mi id="S6.SS3.SSS3.p2.2.m2.1.1" xref="S6.SS3.SSS3.p2.2.m2.1.1.cmml">ğ²</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.2.m2.1b"><ci id="S6.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S6.SS3.SSS3.p2.2.m2.1.1">ğ²</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.2.m2.1c">\mathbf{y}</annotation></semantics></math> given by SFT or RFT data, Part 1 of per-step DPO estimates the expected accuracy (Q-value) of each step in a negative rollout <math id="S6.SS3.SSS3.p2.3.m3.1" class="ltx_math_unparsed" alttext="-\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})" display="inline"><semantics id="S6.SS3.SSS3.p2.3.m3.1a"><mrow id="S6.SS3.SSS3.p2.3.m3.1b"><mo id="S6.SS3.SSS3.p2.3.m3.1.1">âˆ’</mo><mover accent="true" id="S6.SS3.SSS3.p2.3.m3.1.2"><mi id="S6.SS3.SSS3.p2.3.m3.1.2.2">ğ²</mi><mo id="S6.SS3.SSS3.p2.3.m3.1.2.1">^</mo></mover><mo id="S6.SS3.SSS3.p2.3.m3.1.3">âˆ¼</mo><msub id="S6.SS3.SSS3.p2.3.m3.1.4"><mi id="S6.SS3.SSS3.p2.3.m3.1.4.2">Ï€</mi><mi id="S6.SS3.SSS3.p2.3.m3.1.4.3">sft</mi></msub><mrow id="S6.SS3.SSS3.p2.3.m3.1.5"><mo stretchy="false" id="S6.SS3.SSS3.p2.3.m3.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="S6.SS3.SSS3.p2.3.m3.1.5.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S6.SS3.SSS3.p2.3.m3.1.5.3">âˆ£</mo><mi id="S6.SS3.SSS3.p2.3.m3.1.5.4">ğ±</mi><mo stretchy="false" id="S6.SS3.SSS3.p2.3.m3.1.5.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.3.m3.1c">-\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})</annotation></semantics></math> sampled from the SFT policy. For each step <math id="S6.SS3.SSS3.p2.4.m4.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}_{c}" display="inline"><semantics id="S6.SS3.SSS3.p2.4.m4.1a"><mrow id="S6.SS3.SSS3.p2.4.m4.1.1" xref="S6.SS3.SSS3.p2.4.m4.1.1.cmml"><mo id="S6.SS3.SSS3.p2.4.m4.1.1a" xref="S6.SS3.SSS3.p2.4.m4.1.1.cmml">âˆ’</mo><msub id="S6.SS3.SSS3.p2.4.m4.1.1.2" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.4.m4.1.1.2.2" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.4.m4.1.1.2.2.2" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.4.m4.1.1.2.2.1" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S6.SS3.SSS3.p2.4.m4.1.1.2.3" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.4.m4.1b"><apply id="S6.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1"><minus id="S6.SS3.SSS3.p2.4.m4.1.1.1.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1"></minus><apply id="S6.SS3.SSS3.p2.4.m4.1.1.2.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.4.m4.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.4.m4.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2"><ci id="S6.SS3.SSS3.p2.4.m4.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.4.m4.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.2.2">ğ²</ci></apply><ci id="S6.SS3.SSS3.p2.4.m4.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.4.m4.1.1.2.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.4.m4.1c">-\hat{\mathbf{y}}_{c}</annotation></semantics></math> the Q-value is computed conditioned on <math id="S6.SS3.SSS3.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S6.SS3.SSS3.p2.5.m5.1a"><mi id="S6.SS3.SSS3.p2.5.m5.1.1" xref="S6.SS3.SSS3.p2.5.m5.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.5.m5.1b"><ci id="S6.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S6.SS3.SSS3.p2.5.m5.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.5.m5.1c">\mathbf{x}</annotation></semantics></math> and previous steps <math id="S6.SS3.SSS3.p2.6.m6.1" class="ltx_Math" alttext="-\hat{\mathbf{y}}_{1:c-1}" display="inline"><semantics id="S6.SS3.SSS3.p2.6.m6.1a"><mrow id="S6.SS3.SSS3.p2.6.m6.1.1" xref="S6.SS3.SSS3.p2.6.m6.1.1.cmml"><mo id="S6.SS3.SSS3.p2.6.m6.1.1a" xref="S6.SS3.SSS3.p2.6.m6.1.1.cmml">âˆ’</mo><msub id="S6.SS3.SSS3.p2.6.m6.1.1.2" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.6.m6.1.1.2.2" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.6.m6.1.1.2.2.2" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.6.m6.1.1.2.2.1" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2.1.cmml">^</mo></mover><mrow id="S6.SS3.SSS3.p2.6.m6.1.1.2.3" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.cmml"><mn id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.2" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.1" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.1.cmml">:</mo><mrow id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.cmml"><mi id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.2" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.2.cmml">c</mi><mo id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.1" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.1.cmml">âˆ’</mo><mn id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.3" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.6.m6.1b"><apply id="S6.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1"><minus id="S6.SS3.SSS3.p2.6.m6.1.1.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1"></minus><apply id="S6.SS3.SSS3.p2.6.m6.1.1.2.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.6.m6.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.6.m6.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2"><ci id="S6.SS3.SSS3.p2.6.m6.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.6.m6.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.2.2">ğ²</ci></apply><apply id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3"><ci id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.1">:</ci><cn type="integer" id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.2.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.2">1</cn><apply id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3"><minus id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.1.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.1"></minus><ci id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.2.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.2">ğ‘</ci><cn type="integer" id="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.3.cmml" xref="S6.SS3.SSS3.p2.6.m6.1.1.2.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.6.m6.1c">-\hat{\mathbf{y}}_{1:c-1}</annotation></semantics></math>. It then adds the triplet <math id="S6.SS3.SSS3.p2.7.m7.3" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}}_{1:c})" display="inline"><semantics id="S6.SS3.SSS3.p2.7.m7.3a"><mrow id="S6.SS3.SSS3.p2.7.m7.3.3.1" xref="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml"><mo stretchy="false" id="S6.SS3.SSS3.p2.7.m7.3.3.1.2" xref="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml">(</mo><mi id="S6.SS3.SSS3.p2.7.m7.1.1" xref="S6.SS3.SSS3.p2.7.m7.1.1.cmml">ğ±</mi><mo id="S6.SS3.SSS3.p2.7.m7.3.3.1.3" xref="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml">,</mo><mi id="S6.SS3.SSS3.p2.7.m7.2.2" xref="S6.SS3.SSS3.p2.7.m7.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.7.m7.3.3.1.4" xref="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml">,</mo><mrow id="S6.SS3.SSS3.p2.7.m7.3.3.1.1" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.cmml"><mo id="S6.SS3.SSS3.p2.7.m7.3.3.1.1a" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.cmml">âˆ’</mo><msub id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.2" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.1" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.1.cmml">^</mo></mover><mrow id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.cmml"><mn id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.2" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.1" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.1.cmml">:</mo><mi id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.3" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S6.SS3.SSS3.p2.7.m7.3.3.1.5" xref="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.7.m7.3b"><vector id="S6.SS3.SSS3.p2.7.m7.3.3.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1"><ci id="S6.SS3.SSS3.p2.7.m7.1.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.1.1">ğ±</ci><ci id="S6.SS3.SSS3.p2.7.m7.2.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.2.2">ğ²</ci><apply id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1"><minus id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1"></minus><apply id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2"><ci id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.2.2">ğ²</ci></apply><apply id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3"><ci id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.1.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.1">:</ci><cn type="integer" id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.2.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.2">1</cn><ci id="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.3.cmml" xref="S6.SS3.SSS3.p2.7.m7.3.3.1.1.2.3.3">ğ‘</ci></apply></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.7.m7.3c">(\mathbf{x},\mathbf{y},-\hat{\mathbf{y}}_{1:c})</annotation></semantics></math> to the DPO dataset.
We improve the coverage and accuracy of advantage estimates via Part 2, i.e., repeating this process for steps appearing on a positive trace <math id="S6.SS3.SSS3.p2.8.m8.1" class="ltx_math_unparsed" alttext="+\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})" display="inline"><semantics id="S6.SS3.SSS3.p2.8.m8.1a"><mrow id="S6.SS3.SSS3.p2.8.m8.1b"><mo id="S6.SS3.SSS3.p2.8.m8.1.1">+</mo><mover accent="true" id="S6.SS3.SSS3.p2.8.m8.1.2"><mi id="S6.SS3.SSS3.p2.8.m8.1.2.2">ğ²</mi><mo id="S6.SS3.SSS3.p2.8.m8.1.2.1">^</mo></mover><mo id="S6.SS3.SSS3.p2.8.m8.1.3">âˆ¼</mo><msub id="S6.SS3.SSS3.p2.8.m8.1.4"><mi id="S6.SS3.SSS3.p2.8.m8.1.4.2">Ï€</mi><mi id="S6.SS3.SSS3.p2.8.m8.1.4.3">sft</mi></msub><mrow id="S6.SS3.SSS3.p2.8.m8.1.5"><mo stretchy="false" id="S6.SS3.SSS3.p2.8.m8.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="S6.SS3.SSS3.p2.8.m8.1.5.2">â‹…</mo><mo lspace="0em" rspace="0.167em" id="S6.SS3.SSS3.p2.8.m8.1.5.3">âˆ£</mo><mi id="S6.SS3.SSS3.p2.8.m8.1.5.4">ğ±</mi><mo stretchy="false" id="S6.SS3.SSS3.p2.8.m8.1.5.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.8.m8.1c">+\hat{\mathbf{y}}\sim\pi_{\mathrm{sft}}(\cdot\mid\mathbf{x})</annotation></semantics></math> as well. Specifically, we add <math id="S6.SS3.SSS3.p2.9.m9.3" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y},+\hat{\mathbf{y}}_{1:c})" display="inline"><semantics id="S6.SS3.SSS3.p2.9.m9.3a"><mrow id="S6.SS3.SSS3.p2.9.m9.3.3.1" xref="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml"><mo stretchy="false" id="S6.SS3.SSS3.p2.9.m9.3.3.1.2" xref="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml">(</mo><mi id="S6.SS3.SSS3.p2.9.m9.1.1" xref="S6.SS3.SSS3.p2.9.m9.1.1.cmml">ğ±</mi><mo id="S6.SS3.SSS3.p2.9.m9.3.3.1.3" xref="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml">,</mo><mi id="S6.SS3.SSS3.p2.9.m9.2.2" xref="S6.SS3.SSS3.p2.9.m9.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.9.m9.3.3.1.4" xref="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml">,</mo><mrow id="S6.SS3.SSS3.p2.9.m9.3.3.1.1" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.cmml"><mo id="S6.SS3.SSS3.p2.9.m9.3.3.1.1a" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.cmml">+</mo><msub id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.2" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.1" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.1.cmml">^</mo></mover><mrow id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.cmml"><mn id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.2" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.1" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.1.cmml">:</mo><mi id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.3" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.3.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S6.SS3.SSS3.p2.9.m9.3.3.1.5" xref="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.9.m9.3b"><vector id="S6.SS3.SSS3.p2.9.m9.3.3.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1"><ci id="S6.SS3.SSS3.p2.9.m9.1.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.1.1">ğ±</ci><ci id="S6.SS3.SSS3.p2.9.m9.2.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.2.2">ğ²</ci><apply id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1"><plus id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1"></plus><apply id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2"><ci id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.2.2">ğ²</ci></apply><apply id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3"><ci id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.1.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.1">:</ci><cn type="integer" id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.2.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.2">1</cn><ci id="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.3.cmml" xref="S6.SS3.SSS3.p2.9.m9.3.3.1.1.2.3.3">ğ‘</ci></apply></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.9.m9.3c">(\mathbf{x},\mathbf{y},+\hat{\mathbf{y}}_{1:c})</annotation></semantics></math> to the DPO dataset, where the step <math id="S6.SS3.SSS3.p2.10.m10.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{c}" display="inline"><semantics id="S6.SS3.SSS3.p2.10.m10.1a"><mrow id="S6.SS3.SSS3.p2.10.m10.1.1" xref="S6.SS3.SSS3.p2.10.m10.1.1.cmml"><mo id="S6.SS3.SSS3.p2.10.m10.1.1a" xref="S6.SS3.SSS3.p2.10.m10.1.1.cmml">+</mo><msub id="S6.SS3.SSS3.p2.10.m10.1.1.2" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.10.m10.1.1.2.2" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.10.m10.1.1.2.2.2" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.10.m10.1.1.2.2.1" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2.1.cmml">^</mo></mover><mi id="S6.SS3.SSS3.p2.10.m10.1.1.2.3" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.10.m10.1b"><apply id="S6.SS3.SSS3.p2.10.m10.1.1.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1"><plus id="S6.SS3.SSS3.p2.10.m10.1.1.1.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1"></plus><apply id="S6.SS3.SSS3.p2.10.m10.1.1.2.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.10.m10.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.10.m10.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2"><ci id="S6.SS3.SSS3.p2.10.m10.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.10.m10.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.2.2">ğ²</ci></apply><ci id="S6.SS3.SSS3.p2.10.m10.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.10.m10.1.1.2.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.10.m10.1c">+\hat{\mathbf{y}}_{c}</annotation></semantics></math> is the first step in the positive trace to have a low Q-value (as dicated by a relative threshold on the Q-value), which indicates that <math id="S6.SS3.SSS3.p2.11.m11.1" class="ltx_Math" alttext="+\hat{\mathbf{y}}_{c}" display="inline"><semantics id="S6.SS3.SSS3.p2.11.m11.1a"><mrow id="S6.SS3.SSS3.p2.11.m11.1.1" xref="S6.SS3.SSS3.p2.11.m11.1.1.cmml"><mo id="S6.SS3.SSS3.p2.11.m11.1.1a" xref="S6.SS3.SSS3.p2.11.m11.1.1.cmml">+</mo><msub id="S6.SS3.SSS3.p2.11.m11.1.1.2" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.cmml"><mover accent="true" id="S6.SS3.SSS3.p2.11.m11.1.1.2.2" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2.cmml"><mi id="S6.SS3.SSS3.p2.11.m11.1.1.2.2.2" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2.2.cmml">ğ²</mi><mo id="S6.SS3.SSS3.p2.11.m11.1.1.2.2.1" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2.1.cmml">^</mo></mover><mi id="S6.SS3.SSS3.p2.11.m11.1.1.2.3" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.11.m11.1b"><apply id="S6.SS3.SSS3.p2.11.m11.1.1.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1"><plus id="S6.SS3.SSS3.p2.11.m11.1.1.1.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1"></plus><apply id="S6.SS3.SSS3.p2.11.m11.1.1.2.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.11.m11.1.1.2.1.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2">subscript</csymbol><apply id="S6.SS3.SSS3.p2.11.m11.1.1.2.2.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2"><ci id="S6.SS3.SSS3.p2.11.m11.1.1.2.2.1.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2.1">^</ci><ci id="S6.SS3.SSS3.p2.11.m11.1.1.2.2.2.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.2.2">ğ²</ci></apply><ci id="S6.SS3.SSS3.p2.11.m11.1.1.2.3.cmml" xref="S6.SS3.SSS3.p2.11.m11.1.1.2.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.11.m11.1c">+\hat{\mathbf{y}}_{c}</annotation></semantics></math> is likely a spurious step that the SFT model generated. For individual steps that are more likely to occur in either positive or negative traces we improve coverage of alternate possible steps, and for steps that occur in both positive and negative traces, we lower the variance (and error) of the advantage estimate.
In FigureÂ <a href="#S6.F10" title="Figure 10 â€£ 6.3.3 But, Attaining Low Generalization Error Requires Low Advantage Estimation Error â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, we compare the performance of per-step DPO runs with the datasets constructed from only negative vs. both positive and negative traces, and find that the latter has a lower test error for all sizes of <math id="S6.SS3.SSS3.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="S6.SS3.SSS3.p2.12.m12.1a"><msub id="S6.SS3.SSS3.p2.12.m12.1.1" xref="S6.SS3.SSS3.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.SSS3.p2.12.m12.1.1.2" xref="S6.SS3.SSS3.p2.12.m12.1.1.2.cmml">ğ’Ÿ</mi><mi id="S6.SS3.SSS3.p2.12.m12.1.1.3" xref="S6.SS3.SSS3.p2.12.m12.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS3.p2.12.m12.1b"><apply id="S6.SS3.SSS3.p2.12.m12.1.1.cmml" xref="S6.SS3.SSS3.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS3.p2.12.m12.1.1.1.cmml" xref="S6.SS3.SSS3.p2.12.m12.1.1">subscript</csymbol><ci id="S6.SS3.SSS3.p2.12.m12.1.1.2.cmml" xref="S6.SS3.SSS3.p2.12.m12.1.1.2">ğ’Ÿ</ci><ci id="S6.SS3.SSS3.p2.12.m12.1.1.3.cmml" xref="S6.SS3.SSS3.p2.12.m12.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS3.p2.12.m12.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S6.SS3.SSS4" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.4 </span>Validating Claims About Generalization: Controlled Analysis on a Didactic Problem</h5>

<div id="S6.SS3.SSS4.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS4.p1.3" class="ltx_p">With the above insights and intuitive arguments, we now study the influence of <math id="S6.SS3.SSS4.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p1.1.m1.1a"><msub id="S6.SS3.SSS4.p1.1.m1.1.1" xref="S6.SS3.SSS4.p1.1.m1.1.1.cmml"><mi id="S6.SS3.SSS4.p1.1.m1.1.1.2" xref="S6.SS3.SSS4.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p1.1.m1.1.1.3" xref="S6.SS3.SSS4.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p1.1.m1.1b"><apply id="S6.SS3.SSS4.p1.1.m1.1.1.cmml" xref="S6.SS3.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p1.1.m1.1.1.1.cmml" xref="S6.SS3.SSS4.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p1.1.m1.1.1.2.cmml" xref="S6.SS3.SSS4.p1.1.m1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p1.1.m1.1.1.3.cmml" xref="S6.SS3.SSS4.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> on the generalization effects of per-step DPO. For our analysis, we consider a didactic star graph problem (AppendixÂ <a href="#A6" title="Appendix F Details on Star Graph Problem â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>) from <cite class="ltx_cite ltx_citemacro_citet">Bachmann and Nagarajan [<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, where given a graph in the shape of a star and a query (center/end node), the model is asked to output the full path between the start/end nodes. This task highlights the failure of SFT at planning problems (akin to math reasoning). They show that <math id="S6.SS3.SSS4.p1.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p1.2.m2.1a"><msub id="S6.SS3.SSS4.p1.2.m2.1.1" xref="S6.SS3.SSS4.p1.2.m2.1.1.cmml"><mi id="S6.SS3.SSS4.p1.2.m2.1.1.2" xref="S6.SS3.SSS4.p1.2.m2.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p1.2.m2.1.1.3" xref="S6.SS3.SSS4.p1.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p1.2.m2.1b"><apply id="S6.SS3.SSS4.p1.2.m2.1.1.cmml" xref="S6.SS3.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p1.2.m2.1.1.1.cmml" xref="S6.SS3.SSS4.p1.2.m2.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p1.2.m2.1.1.2.cmml" xref="S6.SS3.SSS4.p1.2.m2.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p1.2.m2.1.1.3.cmml" xref="S6.SS3.SSS4.p1.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p1.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> minimizes SFT loss by memorizing the â€œhard-to-predictâ€ node adjacent to the center, and copying the rest from the input graph.
It is clear that the failure stems from not being able to identify the critical adjacent token. We will show how credit assignment with negative data accurately upweights the critical token and unlearns the memorized token.
The advantage value is estimated online, <em id="S6.SS3.SSS4.p1.3.1" class="ltx_emph ltx_font_italic">i.e.</em>,Â at each time step we sample a batch of data (graphs), rollout steps from the current policy, and estimate the advantage for each step. This allows us to exactly sample from the per-step DPO pair distribution in TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>.
As we will see, the initialization for per-step DPO has a significant role to play in the generalization gains we observe.
To vary the choice of <math id="S6.SS3.SSS4.p1.3.m3.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p1.3.m3.1a"><msub id="S6.SS3.SSS4.p1.3.m3.1.1" xref="S6.SS3.SSS4.p1.3.m3.1.1.cmml"><mi id="S6.SS3.SSS4.p1.3.m3.1.1.2" xref="S6.SS3.SSS4.p1.3.m3.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p1.3.m3.1.1.3" xref="S6.SS3.SSS4.p1.3.m3.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p1.3.m3.1b"><apply id="S6.SS3.SSS4.p1.3.m3.1.1.cmml" xref="S6.SS3.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p1.3.m3.1.1.1.cmml" xref="S6.SS3.SSS4.p1.3.m3.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p1.3.m3.1.1.2.cmml" xref="S6.SS3.SSS4.p1.3.m3.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p1.3.m3.1.1.3.cmml" xref="S6.SS3.SSS4.p1.3.m3.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p1.3.m3.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>, we choose several intermediate checkpoints obtained during supervised finetuning for synthetic negative data generation. We consider three initializations: <span id="S6.SS3.SSS4.p1.3.2" class="ltx_text ltx_font_bold">(1)</span> an under-trained SFT model with a large training and test loss, and <span id="S6.SS3.SSS4.p1.3.3" class="ltx_text ltx_font_bold">(2)</span> an SFT model obtained by early-stopping based on a held-out validation set, where the validation loss is the lowest, and <span id="S6.SS3.SSS4.p1.3.4" class="ltx_text ltx_font_bold">(3)</span> an over-trained SFT checkpoint, with a low training but high validation loss.</p>
</div>
<figure id="S6.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F11.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x15.png" id="S6.F11.1.g1" class="ltx_graphics ltx_img_landscape" width="456" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(a)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F11.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.14532/assets/x16.png" id="S6.F11.2.g1" class="ltx_graphics ltx_img_landscape" width="456" height="347" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(b)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F11.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="" id="S6.F11.3.g1" class="ltx_graphics ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering">(c)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F11.7.1.1" class="ltx_text" style="font-size:90%;">Figure 11</span>: </span><em id="S6.F11.8.2" class="ltx_emph ltx_font_bold ltx_font_italic" style="font-size:80%;">Didactic analysis on star graph:</em><span id="S6.F11.9.3" class="ltx_text" style="font-size:80%;"> In (a) we plot the SFT loss and Q-value of the critical token (adjacent node) for SFT and per-step DPO (starting from iter 60). Indicative of memorization SFT loss decreases at a slow rate, matching the slow rate of increase in the Q-value. In contrast per-step DPO loss sharply decreases during training. In (b) we notice a corresponding phase transition in the test error of per-step DPO starting from different under-trained SFT checkpoints, which does not happen for an over-trained SFT checkpoint in (c).</span></figcaption>
</figure>
<div id="S6.SS3.SSS4.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS4.p2.3" class="ltx_p"><span id="S6.SS3.SSS4.p2.1.1" class="ltx_text ltx_font_bold">(1) &amp; (2): Training on negative data from an under-trained or early-stopped <math id="S6.SS3.SSS4.p2.1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p2.1.1.m1.1a"><msub id="S6.SS3.SSS4.p2.1.1.m1.1.1" xref="S6.SS3.SSS4.p2.1.1.m1.1.1.cmml"><mi id="S6.SS3.SSS4.p2.1.1.m1.1.1.2" xref="S6.SS3.SSS4.p2.1.1.m1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p2.1.1.m1.1.1.3" xref="S6.SS3.SSS4.p2.1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p2.1.1.m1.1b"><apply id="S6.SS3.SSS4.p2.1.1.m1.1.1.cmml" xref="S6.SS3.SSS4.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p2.1.1.m1.1.1.1.cmml" xref="S6.SS3.SSS4.p2.1.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p2.1.1.m1.1.1.2.cmml" xref="S6.SS3.SSS4.p2.1.1.m1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p2.1.1.m1.1.1.3.cmml" xref="S6.SS3.SSS4.p2.1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p2.1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> improves both training loss and test performance.</span> As shown in FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(a,b), we find that when training with negative data from iteration 60 (under-trained <math id="S6.SS3.SSS4.p2.2.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p2.2.m1.1a"><msub id="S6.SS3.SSS4.p2.2.m1.1.1" xref="S6.SS3.SSS4.p2.2.m1.1.1.cmml"><mi id="S6.SS3.SSS4.p2.2.m1.1.1.2" xref="S6.SS3.SSS4.p2.2.m1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p2.2.m1.1.1.3" xref="S6.SS3.SSS4.p2.2.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p2.2.m1.1b"><apply id="S6.SS3.SSS4.p2.2.m1.1.1.cmml" xref="S6.SS3.SSS4.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p2.2.m1.1.1.1.cmml" xref="S6.SS3.SSS4.p2.2.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p2.2.m1.1.1.2.cmml" xref="S6.SS3.SSS4.p2.2.m1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p2.2.m1.1.1.3.cmml" xref="S6.SS3.SSS4.p2.2.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p2.2.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>) and iteration 200 (early-stopped <math id="S6.SS3.SSS4.p2.3.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p2.3.m2.1a"><msub id="S6.SS3.SSS4.p2.3.m2.1.1" xref="S6.SS3.SSS4.p2.3.m2.1.1.cmml"><mi id="S6.SS3.SSS4.p2.3.m2.1.1.2" xref="S6.SS3.SSS4.p2.3.m2.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p2.3.m2.1.1.3" xref="S6.SS3.SSS4.p2.3.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p2.3.m2.1b"><apply id="S6.SS3.SSS4.p2.3.m2.1.1.cmml" xref="S6.SS3.SSS4.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p2.3.m2.1.1.1.cmml" xref="S6.SS3.SSS4.p2.3.m2.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p2.3.m2.1.1.2.cmml" xref="S6.SS3.SSS4.p2.3.m2.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p2.3.m2.1.1.3.cmml" xref="S6.SS3.SSS4.p2.3.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p2.3.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>), utilizing per-step DPO reduces the training loss very aggressively. These benefits translate to test losses and performance as well (FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(b), orange and green). In contrast, supervised fine-tuning exhibits a nearly-flat test loss landscape, although the train loss reduces slowly. Upon a closer inspection, we find that training on positive data via SFT only tends to memorize the critical token in the training data using non-generalizable features, and hence, the resulting model does not generalize to novel problems. This is corroborated by the slowly increasing Q-values of the critical token (FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(b) red) as more gradient updates are performed. More training with SFT is unable to â€œunlearnâ€ the non-generalizable feature behind this spurious step and is hence unable to reduce the loss function. On the other hand, per-step DPO with negative data is able to unlearn this spurious step and drives improvement, as evident by the drastic improvement on train and test. This experiment corroborates the connection between advantage-weighted RL and DRO from SectionÂ <a href="#S6.SS3.SSS2" title="6.3.2 Why Does Generalization Improve?: Connecting Advantage-Weighted RL to DRO â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3.2</span></a>. For the under-trained SFT model, the Q-value of the critical token (first node of the correct path) is not as high as the rest of the â€œeasy-to-predictâ€ tokens corresponding to nodes on the path that can be copied from the graph given the first node. When we optimize the advantage-weighted RL objective, this disparity in Q-values is reduced by re-weighting the next-token loss with advantage estimates, and training is able to preferentially minimize the loss at the critical token. In this scenario, this results in the model picking upon the ground-truth generalizable feature.</p>
</div>
<div id="S6.SS3.SSS4.p3" class="ltx_para ltx_noindent">
<p id="S6.SS3.SSS4.p3.1" class="ltx_p"><span id="S6.SS3.SSS4.p3.1.1" class="ltx_text ltx_font_bold">(3) Training on negative data from an over-trained SFT initialization leads to model collapse.</span> When training with negative data on an over-trained <math id="S6.SS3.SSS4.p3.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="S6.SS3.SSS4.p3.1.m1.1a"><msub id="S6.SS3.SSS4.p3.1.m1.1.1" xref="S6.SS3.SSS4.p3.1.m1.1.1.cmml"><mi id="S6.SS3.SSS4.p3.1.m1.1.1.2" xref="S6.SS3.SSS4.p3.1.m1.1.1.2.cmml">Ï€</mi><mi id="S6.SS3.SSS4.p3.1.m1.1.1.3" xref="S6.SS3.SSS4.p3.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.SSS4.p3.1.m1.1b"><apply id="S6.SS3.SSS4.p3.1.m1.1.1.cmml" xref="S6.SS3.SSS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.SSS4.p3.1.m1.1.1.1.cmml" xref="S6.SS3.SSS4.p3.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.SSS4.p3.1.m1.1.1.2.cmml" xref="S6.SS3.SSS4.p3.1.m1.1.1.2">ğœ‹</ci><ci id="S6.SS3.SSS4.p3.1.m1.1.1.3.cmml" xref="S6.SS3.SSS4.p3.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.SSS4.p3.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> (iteration 580) in FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(c), we observe that both SFT and per-step DPO exhibit identical test errors since advantage estimates for the critical token are already high and similar to other tokens. Hence, per-step DPO would not re-weight this token any more than other tokens. Thus, training with per-step DPO would be similar to training with the standard SFT objective.
In particular, Monte Carlo samples from the over-trained checkpoint estimate a high advantage since Q-value is already high at iteration 500 (in FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(a)), when the SFT policy has sufficiently memorized the training data using noisy features, training further is unable to unlearn this dependence. Hence, in this regime, negative data leads to no improvement over finetuning on only positive data.</p>
</div>
<div id="S6.SS3.SSS4.p4" class="ltx_para ltx_noindent">
<svg id="S6.SS3.SSS4.p4.pic1" class="ltx_picture" height="102.67" overflow="visible" version="1.1" width="600"><g transform="translate(0,102.67) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 84.62 C 0 87.88 2.64 90.53 5.91 90.53 L 594.09 90.53 C 597.36 90.53 600 87.88 600 84.62 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F0F0FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 84.62 C 1.97 86.8 3.73 88.56 5.91 88.56 L 594.09 88.56 C 596.27 88.56 598.03 86.8 598.03 84.62 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 15 80.53)"><g class="ltx_nestedsvg" transform="matrix(1 0 0 1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#FFFFFF" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 468.57 22.14 C 470.2 22.14 471.52 20.82 471.52 19.19 L 471.52 2.95 C 471.52 1.32 470.2 0 468.57 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill="#000000" fill-opacity="1.0"><path d="M 0 2.95 L 0 19.19 C 0 20.82 1.32 22.14 2.95 22.14 L 468.57 22.14 C 470.2 22.14 471.52 20.82 471.52 19.19 L 471.52 2.95 C 471.52 1.32 470.2 0 468.57 0 L 2.95 0 C 1.32 0 0 1.32 0 2.95 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 11.81 7.61)"><text transform="matrix(1 0 0 -1 0 0)" color="#000000">Takeaways for generalization and spurious correlations with negative data</text></g></g></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 11.44)"><foreignObject width="556.69" height="62.11" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="S6.SS3.SSS4.p4.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="S6.SS3.SSS4.p4.pic1.1.1.1.1.1.1" class="ltx_p">Advantage-weighted RL can unlearn spurious steps and, hence, improves generalization when: (i) advantage estimation error is low; and (ii) the base model initialization is under-trained that imperfectly cloned spurious steps have low advantage, such that they can be identified with negative data.</span>
</span></foreignObject></g></g></svg>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion and Conclusion</h3>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.2" class="ltx_p">Our work studies the role of synthetic data for improving math reasoning capabilities of LLMs. We find that while the typical approach of collecting new questions and corresponding positive (correct) solutions from capable models like GPT-4/Gemini-1.5 presents underwhelming data scaling. The sample efficiency of the same data can be improved up to <math id="S7.p1.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S7.p1.1.m1.1a"><mrow id="S7.p1.1.m1.1b"><mn id="S7.p1.1.m1.1.1">2</mn><mo lspace="0.222em" id="S7.p1.1.m1.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">2\times</annotation></semantics></math> by sampling more positive traces from the 7B sized models SFT-ed on the original data. However, training on positive self-generated synthetic data alone often amplifies the modelâ€™s dependence on spurious steps, that erroneously appear to lead to a good solution but do not generalize to novel problems and hurt test performance.
That said, surprisingly, we show that negative (incorrect) traces sampled from the same SFT model can be used to address the failure modes of training on only positive data. In particular, negative data can be used to estimate advantage values for every step, and using these advantage estimates via RL enables us to address this problem. We show how the advantages can be used implicitly by preference optimization objectives. We show how training on an instance of this objective leads to <math id="S7.p1.2.m2.1" class="ltx_math_unparsed" alttext="8\times" display="inline"><semantics id="S7.p1.2.m2.1a"><mrow id="S7.p1.2.m2.1b"><mn id="S7.p1.2.m2.1.1">8</mn><mo lspace="0.222em" id="S7.p1.2.m2.1.2">Ã—</mo></mrow><annotation encoding="application/x-tex" id="S7.p1.2.m2.1c">8\times</annotation></semantics></math> improvements in sample efficiency of the synthetic data used.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p"><span id="S7.p2.1.1" class="ltx_text ltx_font_bold">Limitations.</span> While our work provides some results and conceptual models to understand the role of synthetic data for reasoning, there are still many open questions that need to be answered to fully understand its utility. While synthetic data from LLMs like Gemini and GPT-4 holds great potential, for more complex reasoning problems (more complicated than the datasets evaluated in our work),
synthetic data generated from more capable models can contain errors. Generating negative/positive data by referencing synthetic data answers can reinforce unwanted spurious correlations highlighted in our work. This means that novel recipes for generating synthetic problems may be utilized in the future, and our analysis might need to be re-done. That said, we believe that our insights about algorithmic behavior with synthetic data are still quite general and should transfer to these novel settings as well. Ultimately, we would want that training on synthetic data improves transfer and generalization abilities of the model in general reasoning scenarios, and to this end, an evaluation of transfer capabilities is an important avenue that future work should focus on.</p>
</div>
</section>
<section id="Sx1" class="ltx_section" lang="en">
<h3 class="ltx_title ltx_title_section">Acknowledgements</h3>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">This work was done at CMU. We thank Vaishnavh Nagarajan, Yi Su, Aleksandra Faust, Christina Baek, Charlie Snell, Seohong Park, Gaurav Ghosal, Aditi Raghunathan, Katie Kang, Don Dennis, Dhruv Malik, and Pratiksha Thaker for informative discussions and feedback on an earlier version of this paper. This work was supported by compute donations from Google Cloud (TRC) and MultiOn. AS thanks OpenAI and Google respectively for providing GPT4-Turbo and Gemini-1.5 Pro credits for academic use. AK and YG thank Tianhe Yu for feedback on the paper.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography" lang="en">
<h3 class="ltx_title ltx_title_bibliography">References</h3>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam etÂ al. [2023]</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, FlorenciaÂ Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, etÂ al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal etÂ al. [2019]</span>
<span class="ltx_bibblock">
Alekh Agarwal, Nan Jiang, ShamÂ M Kakade, and Wen Sun.

</span>
<span class="ltx_bibblock">Reinforcement learning: Theory and algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">CS Dept., UW Seattle, Seattle, WA, USA, Tech. Rep</em>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alemohammad etÂ al. [2023]</span>
<span class="ltx_bibblock">
Sina Alemohammad, Josue Casco-Rodriguez, Lorenzo Luzi, AhmedÂ Imtiaz Humayun, Hossein Babaei, Daniel LeJeune, Ali Siahkoohi, and RichardÂ G Baraniuk.

</span>
<span class="ltx_bibblock">Self-consuming generative models go mad.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.01850</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bachmann and Nagarajan [2024]</span>
<span class="ltx_bibblock">
Gregor Bachmann and Vaishnavh Nagarajan.

</span>
<span class="ltx_bibblock">The pitfalls of next-token prediction, 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bi etÂ al. [2024]</span>
<span class="ltx_bibblock">
Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen, Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong, Qiushi Du, Zhe Fu, etÂ al.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley and Terry [1952]</span>
<span class="ltx_bibblock">
RalphÂ Allan Bradley and MiltonÂ E Terry.

</span>
<span class="ltx_bibblock">Rank analysis of incomplete block designs: I. the method of paired comparisons.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Biometrika</em>, 39(3/4):324â€“345, 1952.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown etÂ al. [2020]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, JaredÂ D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, etÂ al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877â€“1901, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. [2024]</span>
<span class="ltx_bibblock">
Zixiang Chen, Yihe Deng, Huizhuo Yuan, Kaixuan Ji, and Quanquan Gu.

</span>
<span class="ltx_bibblock">Self-play fine-tuning converts weak language models to strong language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.01335</em>, 2024.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng etÂ al. [2023]</span>
<span class="ltx_bibblock">
Pengyu Cheng, Yifan Yang, Jian Li, Yong Dai, and Nan Du.

</span>
<span class="ltx_bibblock">Adversarial preference optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.08045</em>, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang etÂ al. [2023]</span>
<span class="ltx_bibblock">
Wei-Lin Chiang, Zhuohan Li, ZiÂ Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, JosephÂ E. Gonzalez, Ion Stoica, and EricÂ P. Xing.

</span>
<span class="ltx_bibblock">Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality, March 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://lmsys.org/blog/2023-03-30-vicuna/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://lmsys.org/blog/2023-03-30-vicuna/</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe etÂ al. [2021]</span>
<span class="ltx_bibblock">
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeÂ Haan etÂ al. [2019]</span>
<span class="ltx_bibblock">
Pim DeÂ Haan, Dinesh Jayaraman, and Sergey Levine.

</span>
<span class="ltx_bibblock">Causal confusion in imitation learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dohmatob etÂ al. [2024]</span>
<span class="ltx_bibblock">
Elvis Dohmatob, Yunzhen Feng, and Julia Kempe.

</span>
<span class="ltx_bibblock">Model collapse demystified: The case of regression, 2024.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong etÂ al. [2023]</span>
<span class="ltx_bibblock">
Guanting Dong, Hongyi Yuan, Keming Lu, Chengpeng Li, Mingfeng Xue, Dayiheng Liu, Wei Wang, Zheng Yuan, Chang Zhou, and Jingren Zhou.

</span>
<span class="ltx_bibblock">How abilities in large language models are affected by supervised fine-tuning data composition.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.05492</em>, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dziri etÂ al. [2024]</span>
<span class="ltx_bibblock">
Nouha Dziri, Ximing Lu, Melanie Sclar, XiangÂ Lorraine Li, Liwei Jiang, BillÂ Yuchen Lin, Sean Welleck, Peter West, Chandra Bhagavatula, Ronan LeÂ Bras, etÂ al.

</span>
<span class="ltx_bibblock">Faith and fate: Limits of transformers on compositionality.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ethayarajh etÂ al. [2024]</span>
<span class="ltx_bibblock">
Kawin Ethayarajh, Winnie Xu, Niklas Muennighoff, Dan Jurafsky, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Kto: Model alignment as prospect theoretic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.01306</em>, 2024.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gerstgrasser etÂ al. [2024]</span>
<span class="ltx_bibblock">
Matthias Gerstgrasser, Rylan Schaeffer, Apratim Dey, Rafael Rafailov, Henry Sleight, John Hughes, Tomasz Korbak, Rajashree Agrawal, Dhruv Pai, Andrey Gromov, DanielÂ A. Roberts, Diyi Yang, DavidÂ L. Donoho, and Sanmi Koyejo.

</span>
<span class="ltx_bibblock">Is model collapse inevitable? breaking the curse of recursion by accumulating real and synthetic data, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hartmann etÂ al. [2023]</span>
<span class="ltx_bibblock">
Valentin Hartmann, Anshuman Suri, Vincent Bindschaedler, David Evans, Shruti Tople, and Robert West.

</span>
<span class="ltx_bibblock">Sok: Memorization in general-purpose large language models, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks etÂ al. [2021]</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring mathematical problem solving with the math dataset.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann etÂ al. [2022]</span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego deÂ Las Casas, LisaÂ Anne Hendricks, Johannes Welbl, Aidan Clark, etÂ al.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.15556</em>, 2022.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong etÂ al. [2024]</span>
<span class="ltx_bibblock">
Jiwoo Hong, Noah Lee, and James Thorne.

</span>
<span class="ltx_bibblock">Reference-free monolithic preference optimization with odds ratio.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.07691</em>, 2024.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosseini etÂ al. [2024]</span>
<span class="ltx_bibblock">
Arian Hosseini, Xingdi Yuan, Nikolay Malkin, Aaron Courville, Alessandro Sordoni, and Rishabh Agarwal.

</span>
<span class="ltx_bibblock">V-star: Training verifiers for self-taught reasoners.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.06457</em>, 2024.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hwang etÂ al. [2024]</span>
<span class="ltx_bibblock">
Hyeonbin Hwang, Doyoung Kim, Seungone Kim, Seonghyeon Ye, and Minjoon Seo.

</span>
<span class="ltx_bibblock">Self-explore to avoid the pit: Improving the reasoning capabilities of language models with fine-grained rewards.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.10346</em>, 2024.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">KÃ¤Ã¤riÃ¤inen [2006]</span>
<span class="ltx_bibblock">
Matti KÃ¤Ã¤riÃ¤inen.

</span>
<span class="ltx_bibblock">Lower bounds for reductions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Atomic Learning Workshop</em>, 2006.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kakade and Langford [2002]</span>
<span class="ltx_bibblock">
Sham Kakade and John Langford.

</span>
<span class="ltx_bibblock">Approximately optimal approximate reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning (ICML)</em>, volumeÂ 2, 2002.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang etÂ al. [2024]</span>
<span class="ltx_bibblock">
Katie Kang, Eric Wallace, Claire Tomlin, Aviral Kumar, and Sergey Levine.

</span>
<span class="ltx_bibblock">Unfamiliar finetuning examples control how language models hallucinate, 2024.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar etÂ al. [2022]</span>
<span class="ltx_bibblock">
Aviral Kumar, Joey Hong, Anikait Singh, and Sergey Levine.

</span>
<span class="ltx_bibblock">When Should We Prefer Offline Reinforcement Learning over Behavioral Cloning?

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levy etÂ al. [2020]</span>
<span class="ltx_bibblock">
Daniel Levy, Yair Carmon, JohnÂ C Duchi, and Aaron Sidford.

</span>
<span class="ltx_bibblock">Large-scale methods for distributionally robust optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:8847â€“8860, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al. [2024]</span>
<span class="ltx_bibblock">
Chen Li, Weiqi Wang, Jingcheng Hu, Yixuan Wei, Nanning Zheng, Han Hu, Zheng Zhang, and Houwen Peng.

</span>
<span class="ltx_bibblock">Common 7b language models already possess strong math capabilities.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.04706</em>, 2024.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lightman etÂ al. [2023]</span>
<span class="ltx_bibblock">
Hunter Lightman, Vineet Kosaraju, Yura Burda, Harri Edwards, Bowen Baker, Teddy Lee, Jan Leike, John Schulman, Ilya Sutskever, and Karl Cobbe.

</span>
<span class="ltx_bibblock">Letâ€™s verify step by step, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. [2023]</span>
<span class="ltx_bibblock">
Hao Liu, Matei Zaharia, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Exploration with principles for diverse ai supervision.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.08899</em>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. [2024]</span>
<span class="ltx_bibblock">
Ruibo Liu, Jerry Wei, Fangyu Liu, Chenglei Si, Yanzhe Zhang, Jinmeng Rao, Steven Zheng, Daiyi Peng, Diyi Yang, Denny Zhou, and AndrewÂ M. Dai.

</span>
<span class="ltx_bibblock">Best practices and lessons learned on synthetic data for language models, 2024.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo etÂ al. [2023]</span>
<span class="ltx_bibblock">
Haipeng Luo, Qingfeng Sun, Can Xu, PuÂ Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang.

</span>
<span class="ltx_bibblock">Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McCoy etÂ al. [2023]</span>
<span class="ltx_bibblock">
RÂ Thomas McCoy, Shunyu Yao, Dan Friedman, Matthew Hardy, and ThomasÂ L Griffiths.

</span>
<span class="ltx_bibblock">Embers of autoregression: Understanding large language models through the problem they are trained to solve.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.13638</em>, 2023.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Momennejad etÂ al. [2024]</span>
<span class="ltx_bibblock">
Ida Momennejad, Hosein Hasanbeig, Felipe VieiraÂ Frujeri, Hiteshi Sharma, Nebojsa Jojic, Hamid Palangi, Robert Ness, and Jonathan Larson.

</span>
<span class="ltx_bibblock">Evaluating cognitive maps and planning in large language models with cogeval.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munos etÂ al. [2023]</span>
<span class="ltx_bibblock">
RÃ©mi Munos, Michal Valko, Daniele Calandriello, MohammadÂ Gheshlaghi Azar, Mark Rowland, ZhaohanÂ Daniel Guo, Yunhao Tang, Matthieu Geist, Thomas Mesnard, Andrea Michi, etÂ al.

</span>
<span class="ltx_bibblock">Nash learning from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.00886</em>, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pal etÂ al. [2024]</span>
<span class="ltx_bibblock">
Arka Pal, Deep Karkhanis, Samuel Dooley, Manley Roberts, Siddartha Naidu, and Colin White.

</span>
<span class="ltx_bibblock">Smaug: Fixing failure modes of preference optimisation with dpo-positive.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.13228</em>, 2024.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang etÂ al. [2024]</span>
<span class="ltx_bibblock">
RichardÂ Yuanzhe Pang, Weizhe Yuan, Kyunghyun Cho, HeÂ He, Sainbayar Sukhbaatar, and Jason Weston.

</span>
<span class="ltx_bibblock">Iterative reasoning preference optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.19733</em>, 2024.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng etÂ al. [2019]</span>
<span class="ltx_bibblock">
XueÂ Bin Peng, Aviral Kumar, Grace Zhang, and Sergey Levine.

</span>
<span class="ltx_bibblock">Advantage-weighted regression: Simple and scalable off-policy reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.00177</em>, 2019.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov etÂ al. [2023]</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano Ermon, ChristopherÂ D Manning, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.18290</em>, 2023.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov etÂ al. [2024]</span>
<span class="ltx_bibblock">
Rafael Rafailov, Joey Hejna, Ryan Park, and Chelsea Finn.

</span>
<span class="ltx_bibblock">From <math id="bib.bib41.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="bib.bib41.1.m1.1a"><mi id="bib.bib41.1.m1.1.1" xref="bib.bib41.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="bib.bib41.1.m1.1b"><ci id="bib.bib41.1.m1.1.1.cmml" xref="bib.bib41.1.m1.1.1">ğ‘Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.1.m1.1c">r</annotation></semantics></math> to <math id="bib.bib41.2.m2.1" class="ltx_Math" alttext="q^{*}" display="inline"><semantics id="bib.bib41.2.m2.1a"><msup id="bib.bib41.2.m2.1.1" xref="bib.bib41.2.m2.1.1.cmml"><mi id="bib.bib41.2.m2.1.1.2" xref="bib.bib41.2.m2.1.1.2.cmml">q</mi><mo id="bib.bib41.2.m2.1.1.3" xref="bib.bib41.2.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib41.2.m2.1b"><apply id="bib.bib41.2.m2.1.1.cmml" xref="bib.bib41.2.m2.1.1"><csymbol cd="ambiguous" id="bib.bib41.2.m2.1.1.1.cmml" xref="bib.bib41.2.m2.1.1">superscript</csymbol><ci id="bib.bib41.2.m2.1.1.2.cmml" xref="bib.bib41.2.m2.1.1.2">ğ‘</ci><times id="bib.bib41.2.m2.1.1.3.cmml" xref="bib.bib41.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.2.m2.1c">q^{*}</annotation></semantics></math>: Your language model is secretly a q-function, 2024.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rahimian and Mehrotra [2019]</span>
<span class="ltx_bibblock">
Hamed Rahimian and Sanjay Mehrotra.

</span>
<span class="ltx_bibblock">Distributionally robust optimization: A review.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1908.05659</em>, 2019.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid etÂ al. [2024]</span>
<span class="ltx_bibblock">
Machel Reid, Nikolay Savinov, Denis Teplyashin, Dmitry Lepikhin, Timothy Lillicrap, Jean-baptiste Alayrac, Radu Soricut, Angeliki Lazaridou, Orhan Firat, Julian Schrittwieser, etÂ al.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.05530</em>, 2024.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ross and Bagnell [2010]</span>
<span class="ltx_bibblock">
StÃ©phane Ross and Drew Bagnell.

</span>
<span class="ltx_bibblock">Efficient reductions for imitation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics (AISTATS)</em>, pages 661â€“668, 2010.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saeidi etÂ al. [2024]</span>
<span class="ltx_bibblock">
Amir Saeidi, Shivanshu Verma, and Chitta Baral.

</span>
<span class="ltx_bibblock">Insights into alignment: Evaluating dpo and its variants across multiple tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.14723</em>, 2024.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagawa etÂ al. [2019]</span>
<span class="ltx_bibblock">
Shiori Sagawa, PangÂ Wei Koh, TatsunoriÂ B Hashimoto, and Percy Liang.

</span>
<span class="ltx_bibblock">Distributionally robust neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seddik etÂ al. [2024]</span>
<span class="ltx_bibblock">
Mohamed ElÂ Amine Seddik, Suei-Wen Chen, Soufiane Hayou, Pierre Youssef, and Merouane Debbah.

</span>
<span class="ltx_bibblock">How bad is training on synthetic data? a statistical analysis of language model collapse, 2024.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Setlur etÂ al. [2023]</span>
<span class="ltx_bibblock">
Amrith Setlur, Don Dennis, Benjamin Eysenbach, Aditi Raghunathan, Chelsea Finn, Virginia Smith, and Sergey Levine.

</span>
<span class="ltx_bibblock">Bitrate-constrained dro: Beyond worst case robustness to unknown group shifts.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.02931</em>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharma etÂ al. [2024]</span>
<span class="ltx_bibblock">
Archit Sharma, Sedrick Keh, Eric Mitchell, Chelsea Finn, Kushal Arora, and Thomas Kollar.

</span>
<span class="ltx_bibblock">A critical evaluation of ai feedback for aligning large language models, 2024.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shumailov etÂ al. [2023]</span>
<span class="ltx_bibblock">
Ilia Shumailov, Zakhar Shumaylov, Yiren Zhao, Yarin Gal, Nicolas Papernot, and Ross Anderson.

</span>
<span class="ltx_bibblock">The curse of recursion: Training on generated data makes models forget.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.17493</em>, 2023.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh etÂ al. [2024]</span>
<span class="ltx_bibblock">
Avi Singh, JohnÂ D. Co-Reyes, Rishabh Agarwal, Ankesh Anand, Piyush Patil, Xavier Garcia, PeterÂ J. Liu, James Harrison, Jaehoon Lee, Kelvin Xu, Aaron Parisi, Abhishek Kumar, Alex Alemi, Alex Rizkowsky, Azade Nova, Ben Adlam, Bernd Bohnet, Gamaleldin Elsayed, Hanie Sedghi, Igor Mordatch, Isabelle Simpson, Izzeddin Gur, Jasper Snoek, Jeffrey Pennington, Jiri Hron, Kathleen Kenealy, Kevin Swersky, Kshiteej Mahajan, Laura Culp, Lechao Xiao, MaxwellÂ L. Bileschi, Noah Constant, Roman Novak, Rosanne Liu, Tris Warkentin, Yundi Qian, Yamini Bansal, Ethan Dyer, Behnam Neyshabur, Jascha Sohl-Dickstein, and Noah Fiedel.

</span>
<span class="ltx_bibblock">Beyond human data: Scaling self-training for problem-solving with language models, 2024.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto [2018]</span>
<span class="ltx_bibblock">
RichardÂ S Sutton and AndrewÂ G Barto.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Reinforcement learning: An introduction</em>.

</span>
<span class="ltx_bibblock">The MIT Press, second edition, 2018.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swamy etÂ al. [2024]</span>
<span class="ltx_bibblock">
Gokul Swamy, Christoph Dann, Rahul Kidambi, ZhiweiÂ Steven Wu, and Alekh Agarwal.

</span>
<span class="ltx_bibblock">A minimaximalist approach to reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.04056</em>, 2024.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tajwar etÂ al. [ICML 2024]</span>
<span class="ltx_bibblock">
Fahim Tajwar, Anikait Singh, Archit Sharma, Rafael Rafailov, Jeff Schneider, Tengyang Xie, Stefano Ermon, Chelsea Finn, and Aviral Kumar.

</span>
<span class="ltx_bibblock">Preference Fine-Tuning of LLMs Should Leverage Suboptimal, On-Policy Data, ICML 2024.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tirumala etÂ al. [2022]</span>
<span class="ltx_bibblock">
Kushal Tirumala, Aram Markosyan, Luke Zettlemoyer, and Armen Aghajanyan.

</span>
<span class="ltx_bibblock">Memorization without overfitting: Analyzing the training dynamics of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:38274â€“38290, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron etÂ al. [2023]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, etÂ al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villalobos etÂ al. [2022]</span>
<span class="ltx_bibblock">
Pablo Villalobos, Jaime Sevilla, Lennart Heim, Tamay Besiroglu, Marius Hobbhahn, and Anson Ho.

</span>
<span class="ltx_bibblock">Will we run out of data? an analysis of the limits of scaling datasets in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.04325</em>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. [2024]</span>
<span class="ltx_bibblock">
Peiyi Wang, Lei Li, Zhihong Shao, R.Â X. Xu, Damai Dai, Yifei Li, Deli Chen, Y.Â Wu, and Zhifang Sui.

</span>
<span class="ltx_bibblock">Math-shepherd: Verify and reinforce llms step-by-step without human annotations, 2024.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. [2023]</span>
<span class="ltx_bibblock">
Yuanhao Wang, Qinghua Liu, and Chi Jin.

</span>
<span class="ltx_bibblock">Is rlhf more difficult than standard rl?

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.14111</em>, 2023.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams and Zipser [1989]</span>
<span class="ltx_bibblock">
RonaldÂ J Williams and David Zipser.

</span>
<span class="ltx_bibblock">A learning algorithm for continually running fully recurrent neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 1(2):270â€“280, 1989.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu etÂ al. [2023]</span>
<span class="ltx_bibblock">
Tianhao Wu, Banghua Zhu, Ruoyu Zhang, Zhaojin Wen, Kannan Ramchandran, and Jiantao Jiao.

</span>
<span class="ltx_bibblock">Pairwise proximal policy optimization: Harnessing relative feedback for llm alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.00212</em>, 2023.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wyllie etÂ al. [2024]</span>
<span class="ltx_bibblock">
Sierra Wyllie, Ilia Shumailov, and Nicolas Papernot.

</span>
<span class="ltx_bibblock">Fairness feedback loops: Training on synthetic data amplifies bias, 2024.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu etÂ al. [2024]</span>
<span class="ltx_bibblock">
Haoran Xu, Amr Sharaf, Yunmo Chen, Weiting Tan, Lingfeng Shen, Benjamin VanÂ Durme, Kenton Murray, and YoungÂ Jin Kim.

</span>
<span class="ltx_bibblock">Contrastive preference optimization: Pushing the boundaries of llm performance in machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.08417</em>, 2024.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu etÂ al. [2023]</span>
<span class="ltx_bibblock">
Fei Yu, Anningzhe Gao, and Benyou Wang.

</span>
<span class="ltx_bibblock">Outcome-supervised verifiers for planning in mathematical reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.09724</em>, 2023.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu etÂ al. [2024]</span>
<span class="ltx_bibblock">
Longhui Yu, Weisen Jiang, Han Shi, Jincheng Yu, Zhengying Liu, YuÂ Zhang, JamesÂ T. Kwok, Zhenguo Li, Adrian Weller, and Weiyang Liu.

</span>
<span class="ltx_bibblock">Metamath: Bootstrap your own mathematical questions for large language models, 2024.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan etÂ al. [2024a]</span>
<span class="ltx_bibblock">
Lifan Yuan, Ganqu Cui, Hanbin Wang, Ning Ding, Xingyao Wang, Jia Deng, Boji Shan, Huimin Chen, Ruobing Xie, Yankai Lin, etÂ al.

</span>
<span class="ltx_bibblock">Advancing llm reasoning generalists with preference trees.

</span>
<span class="ltx_bibblock"><em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.02078</em>, 2024a.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan etÂ al. [2024b]</span>
<span class="ltx_bibblock">
Weizhe Yuan, RichardÂ Yuanzhe Pang, Kyunghyun Cho, Sainbayar Sukhbaatar, Jing Xu, and Jason Weston.

</span>
<span class="ltx_bibblock">Self-rewarding language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.10020</em>, 2024b.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan etÂ al. [2023]</span>
<span class="ltx_bibblock">
Zheng Yuan, Hongyi Yuan, Chengpeng Li, Guanting Dong, Chuanqi Tan, and Chang Zhou.

</span>
<span class="ltx_bibblock">Scaling relationship on learning mathematical reasoning with large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.01825</em>, 2023.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelikman etÂ al. [2022]</span>
<span class="ltx_bibblock">
Eric Zelikman, Yuhuai Wu, Jesse Mu, and Noah Goodman.

</span>
<span class="ltx_bibblock">Star: Bootstrapping reasoning with reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:15476â€“15488, 2022.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. [2024a]</span>
<span class="ltx_bibblock">
Biao Zhang, Zhongtao Liu, Colin Cherry, and Orhan Firat.

</span>
<span class="ltx_bibblock">When scaling meets llm finetuning: The effect of data, model and finetuning method, 2024a.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. [2024b]</span>
<span class="ltx_bibblock">
Ruiqi Zhang, Licong Lin, YuÂ Bai, and Song Mei.

</span>
<span class="ltx_bibblock">Negative preference optimization: From catastrophic collapse to effective unlearning.

</span>
<span class="ltx_bibblock"><em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.05868</em>, 2024b.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao etÂ al. [2022]</span>
<span class="ltx_bibblock">
Yao Zhao, Mikhail Khalman, Rishabh Joshi, Shashi Narayan, Mohammad Saleh, and PeterÂ J Liu.

</span>
<span class="ltx_bibblock">Calibrating sequence likelihood improves conditional language generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning Representations</em>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ptx1" class="ltx_part" lang="en">
<h2 class="ltx_title ltx_title_part">Appendices</h2>

<section id="A1" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Proof of TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>
</h3>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">We first restate the theorem statement and then provide a proof for this below. Our main goal in this theorem is to show that training with per-step DPO is equivalent to running advantage-weighted RL shown in the theoretical result.</p>
</div>
<div id="A1.Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="A1.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem A.1</span></span><span id="A1.Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(Equivalence of advantage-weighted RL and DPO with per-step pairs)<span id="A1.Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="A1.Thmtheorem1.p1" class="ltx_para">
<p id="A1.Thmtheorem1.p1.5" class="ltx_p"><span id="A1.Thmtheorem1.p1.5.5" class="ltx_text ltx_font_italic">The optimal policy from EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with <math id="A1.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}" display="inline"><semantics id="A1.Thmtheorem1.p1.1.1.m1.1a"><msubsup id="A1.Thmtheorem1.p1.1.1.m1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2.2.cmml">ğ’Ÿ</mi><msub id="A1.Thmtheorem1.p1.1.1.m1.1.1.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml">Ï€</mi><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml">sft</mi></msub><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2.3.cmml">Â±</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.1.1.m1.1b"><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1">superscript</csymbol><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2.2">ğ’Ÿ</ci><csymbol cd="latexml" id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2.3">plus-or-minus</csymbol></apply><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2">ğœ‹</ci><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.1.1.m1.1c">\mathcal{D}^{\pm}_{\pi_{\mathrm{sft}}}</annotation></semantics></math> given by <math id="A1.Thmtheorem1.p1.2.2.m2.3" class="ltx_Math" alttext="(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])" display="inline"><semantics id="A1.Thmtheorem1.p1.2.2.m2.3a"><mrow id="A1.Thmtheorem1.p1.2.2.m2.3.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">(</mo><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml">ğ±</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.4" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">,</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">[</mo><msub id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.cmml"><mn id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.4" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">,</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2a" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml">+</mo><msub id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.5" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml">]</mo></mrow><mo id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.5" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">,</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">[</mo><msub id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.cmml"><mn id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1.cmml">:</mo><mi id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.4" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">,</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2a" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml">âˆ’</mo><msub id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2.cmml">i</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1.cmml">+</mo><mn id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.5" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml">]</mo></mrow><mo stretchy="false" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.6" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.2.2.m2.3b"><vector id="A1.Thmtheorem1.p1.2.2.m2.3.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2"><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1">ğ±</ci><interval closure="closed" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2"><apply id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3"><ci id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.2">1</cn><ci id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2"><plus id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2"></plus><apply id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3"><plus id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.1"></plus><ci id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></apply></interval><interval closure="closed" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2"><apply id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3"><ci id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.1">:</ci><cn type="integer" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.2">1</cn><ci id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2"><minus id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2"></minus><apply id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3"><plus id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.1"></plus><ci id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.3.3.2.2.2.2.2.3.3">1</cn></apply></apply></apply></interval></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.2.2.m2.3c">(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])</annotation></semantics></math> where the positive and negative traces share prefix <math id="A1.Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{1:i}\sim\pi_{\mathrm{sft}}" display="inline"><semantics id="A1.Thmtheorem1.p1.3.3.m3.1a"><mrow id="A1.Thmtheorem1.p1.3.3.m3.1.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml"><msub id="A1.Thmtheorem1.p1.3.3.m3.1.1.2" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.2" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.cmml"><mn id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.1.cmml">:</mo><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A1.Thmtheorem1.p1.3.3.m3.1.1.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.1.cmml">âˆ¼</mo><msub id="A1.Thmtheorem1.p1.3.3.m3.1.1.3" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml">Ï€</mi><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml">sft</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.3.3.m3.1b"><apply id="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.1">similar-to</csymbol><apply id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3"><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.1">:</ci><cn type="integer" id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.2">1</cn><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.3.3">ğ‘–</ci></apply></apply><apply id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.2">ğœ‹</ci><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.3.3.m3.1c">\mathbf{y}_{1:i}\sim\pi_{\mathrm{sft}}</annotation></semantics></math>, and <math id="A1.Thmtheorem1.p1.4.4.m4.1" class="ltx_math_unparsed" alttext="-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{1:i})" display="inline"><semantics id="A1.Thmtheorem1.p1.4.4.m4.1a"><mrow id="A1.Thmtheorem1.p1.4.4.m4.1b"><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1">âˆ’</mo><msub id="A1.Thmtheorem1.p1.4.4.m4.1.2"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.2.2">ğ²</mi><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.2.3"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.2.3.2">i</mi><mo id="A1.Thmtheorem1.p1.4.4.m4.1.2.3.1">+</mo><mn id="A1.Thmtheorem1.p1.4.4.m4.1.2.3.3">1</mn></mrow></msub><mo id="A1.Thmtheorem1.p1.4.4.m4.1.3">âˆ¼</mo><msub id="A1.Thmtheorem1.p1.4.4.m4.1.4"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.4.2">Ï€</mi><mi id="A1.Thmtheorem1.p1.4.4.m4.1.4.3">sft</mi></msub><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.5"><mo stretchy="false" id="A1.Thmtheorem1.p1.4.4.m4.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="A1.Thmtheorem1.p1.4.4.m4.1.5.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Thmtheorem1.p1.4.4.m4.1.5.3">|</mo><mi id="A1.Thmtheorem1.p1.4.4.m4.1.5.4">ğ±</mi><mo id="A1.Thmtheorem1.p1.4.4.m4.1.5.5">,</mo><msub id="A1.Thmtheorem1.p1.4.4.m4.1.5.6"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.5.6.2">ğ²</mi><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.5.6.3"><mn id="A1.Thmtheorem1.p1.4.4.m4.1.5.6.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.4.4.m4.1.5.6.3.1">:</mo><mi id="A1.Thmtheorem1.p1.4.4.m4.1.5.6.3.3">i</mi></mrow></msub><mo stretchy="false" id="A1.Thmtheorem1.p1.4.4.m4.1.5.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.4.4.m4.1c">-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{1:i})</annotation></semantics></math>, <math id="A1.Thmtheorem1.p1.5.5.m5.4" class="ltx_Math" alttext="+\mathbf{y}_{i+1}\sim\sigma(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};\cdot)-A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};-\mathbf{y}_{i+1}))" display="inline"><semantics id="A1.Thmtheorem1.p1.5.5.m5.4a"><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.cmml"><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.cmml"><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.3a" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.cmml">+</mo><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2.cmml">i</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1.cmml">+</mo><mn id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.2.cmml">âˆ¼</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.3.cmml">Ïƒ</mi><mo lspace="0em" rspace="0em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.2.cmml">â€‹</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.cmml"><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2.cmml">A</mi><mover accent="true" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2.cmml">Ï€</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Thmtheorem1.p1.5.5.m5.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.1.1.cmml">ğ±</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">,</mo><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.cmml"><mn id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo rspace="0em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.4" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="A1.Thmtheorem1.p1.5.5.m5.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.2.2.cmml">â‹…</mo><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.5" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4.cmml">âˆ’</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.cmml"><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2.cmml">A</mi><mover accent="true" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2.cmml">Ï€</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3.cmml">â€‹</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml"><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">(</mo><mi id="A1.Thmtheorem1.p1.5.5.m5.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.3.3.cmml">ğ±</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.4" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">,</mo><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.cmml"><mn id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1.cmml">:</mo><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.5" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">;</mo><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml"><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2a" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml">âˆ’</mo><msub id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2.cmml">ğ²</mi><mrow id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.cmml"><mi id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2.cmml">i</mi><mo id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1.cmml">+</mo><mn id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.6" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.3" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.5.5.m5.4b"><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.5.5.m5.4.4.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.2">similar-to</csymbol><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3"><plus id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3"></plus><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3"><plus id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.1"></plus><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.2">ğ‘–</ci><cn type="integer" id="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.3.2.3.3">1</cn></apply></apply></apply><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1"><times id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.2"></times><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.3">ğœ</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1"><minus id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.4"></minus><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1"><times id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.2"></times><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.2">ğ´</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3"><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.1">~</ci><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.3.3.2">ğœ‹</ci></apply></apply><vector id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1"><ci id="A1.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.1.1">ğ±</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3"><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply><ci id="A1.Thmtheorem1.p1.5.5.m5.2.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.2.2">â‹…</ci></vector></apply><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3"><times id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.3"></times><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.2">ğ´</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3"><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.1">~</ci><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.4.3.2">ğœ‹</ci></apply></apply><vector id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2"><ci id="A1.Thmtheorem1.p1.5.5.m5.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.3.3">ğ±</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3"><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.1">:</ci><cn type="integer" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.2">1</cn><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.2.1.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2"><minus id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2"></minus><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.2">ğ²</ci><apply id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3"><plus id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.1"></plus><ci id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.4.4.1.1.1.1.3.2.2.2.2.3.3">1</cn></apply></apply></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.5.5.m5.4c">+\mathbf{y}_{i+1}\sim\sigma(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};\cdot)-A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{1:i};-\mathbf{y}_{i+1}))</annotation></semantics></math>,
is identical to the optima of the advantage-weighted RL objective:</span></p>
<table id="A7.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E5.m1.1" class="ltx_Math" alttext="\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ " display="inline"><semantics id="A1.E5.m1.1a"><mrow id="A1.E5.m1.1.1.1" xref="A1.E5.m1.1.1.1.1.cmml"><munder id="A1.E5.m1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.cmml"><mi id="A1.E5.m1.1.1.1.1.2" xref="A1.E5.m1.1.1.1.1.2.cmml">max</mi><mi id="A1.E5.m1.1.1.1.1.3" xref="A1.E5.m1.1.1.1.1.3.cmml">Ï€</mi></munder><mspace width="1.167em" id="A1.E5.m1.1.1.1.2" xref="A1.E5.m1.1.1.1.1.cmml"></mspace></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.1b"><apply id="A1.E5.m1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1">subscript</csymbol><max id="A1.E5.m1.1.1.1.1.2.cmml" xref="A1.E5.m1.1.1.1.1.2"></max><ci id="A1.E5.m1.1.1.1.1.3.cmml" xref="A1.E5.m1.1.1.1.1.3">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.1c">\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ </annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E5.m2.5" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim p_{\mathrm{syn}}(\mathbf{x}),\mathbf{y}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x})}\left[\sum_{i=1}^{L}\log\pi(\mathbf{y}_{i}\big{|}\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})/\beta\right)\right].\vspace{-0.5cm}" display="inline"><semantics id="A1.E5.m2.5a"><mrow id="A1.E5.m2.5.5.1"><mrow id="A1.E5.m2.5.5.1.1"><msub id="A1.E5.m2.5.5.1.1.3"><mi id="A1.E5.m2.5.5.1.1.3.2">ğ”¼</mi><mrow id="A1.E5.m2.1.1.1"><mi id="A1.E5.m2.1.1.1.2">ğ±</mi><mo id="A1.E5.m2.1.1.1.3">âˆ¼</mo><msub id="A1.E5.m2.1.1.1.4"><mi id="A1.E5.m2.1.1.1.4.2">p</mi><mi id="A1.E5.m2.1.1.1.4.3">syn</mi></msub><mrow id="A1.E5.m2.1.1.1.5"><mo stretchy="false" id="A1.E5.m2.1.1.1.5.1">(</mo><mi id="A1.E5.m2.1.1.1.1">ğ±</mi><mo stretchy="false" id="A1.E5.m2.1.1.1.5.2">)</mo></mrow><mo id="A1.E5.m2.1.1.1.6">,</mo><mi id="A1.E5.m2.1.1.1.7">ğ²</mi><mo id="A1.E5.m2.1.1.1.8">âˆ¼</mo><msub id="A1.E5.m2.1.1.1.9"><mi id="A1.E5.m2.1.1.1.9.2">Ï€</mi><mi id="A1.E5.m2.1.1.1.9.3">sft</mi></msub><mrow id="A1.E5.m2.1.1.1.10"><mo stretchy="false" id="A1.E5.m2.1.1.1.10.1">(</mo><mo lspace="0em" rspace="0em" id="A1.E5.m2.1.1.1.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E5.m2.1.1.1.10.3">|</mo><mi id="A1.E5.m2.1.1.1.10.4">ğ±</mi><mo stretchy="false" id="A1.E5.m2.1.1.1.10.5">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E5.m2.5.5.1.1.2">â€‹</mo><mrow id="A1.E5.m2.5.5.1.1.1.1"><mo id="A1.E5.m2.5.5.1.1.1.1.2">[</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1"><mstyle displaystyle="true" id="A1.E5.m2.5.5.1.1.1.1.1.3"><munderover id="A1.E5.m2.5.5.1.1.1.1.1.3a"><mo movablelimits="false" id="A1.E5.m2.5.5.1.1.1.1.1.3.2.2">âˆ‘</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.3.2.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.3.2.3.2">i</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.3.2.3.1">=</mo><mn id="A1.E5.m2.5.5.1.1.1.1.1.3.2.3.3">1</mn></mrow><mi id="A1.E5.m2.5.5.1.1.1.1.1.3.3">L</mi></munderover></mstyle><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2"><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1"><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.3a">â¡</mo><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.3.2">Ï€</mi></mrow><mo lspace="0em" rspace="0em" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.2">â€‹</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.2">(</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1"><msub id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2">ğ²</mi><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3">i</mi></msub><mo fence="false" mathsize="120%" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.2">|</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E5.m2.2.2">ğ±</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">,</mo><msub id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">i</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="A1.E5.m2.5.5.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo rspace="0.222em" id="A1.E5.m2.5.5.1.1.1.1.1.2.3">â‹…</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1"><mi id="A1.E5.m2.4.4">exp</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1a">â¡</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1"><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.2">(</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1"><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2"><msub id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4"><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.2">A</mi><mover accent="true" id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3.2">Ï€</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.4.3.1">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.3">â€‹</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2"><mo stretchy="false" id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.3">(</mo><mi id="A1.E5.m2.3.3">ğ±</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.4">,</mo><msub id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1"><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3"><mn id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.1">:</mo><mrow id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3"><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.2">i</mi><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.5">,</mo><msub id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2"><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2.2">ğ²</mi><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.2.3">i</mi></msub><mo stretchy="false" id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.2.2.2.6">)</mo></mrow></mrow><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.3">/</mo><mi id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.1.4">Î²</mi></mrow><mo id="A1.E5.m2.5.5.1.1.1.1.1.2.2.1.1.3">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E5.m2.5.5.1.1.1.1.3">]</mo></mrow></mrow><mo lspace="0em" id="A1.E5.m2.5.5.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E5.m2.5b">\displaystyle\mathbb{E}_{\mathbf{x}\sim p_{\mathrm{syn}}(\mathbf{x}),\mathbf{y}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x})}\left[\sum_{i=1}^{L}\log\pi(\mathbf{y}_{i}\big{|}\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})/\beta\right)\right].\vspace{-0.5cm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div id="A1.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A1.1.p1" class="ltx_para">
<p id="A1.1.p1.3" class="ltx_p">To prove this statement, we make the following observation: DPOÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> is equivalent to optimizing a KL-divergence penalized expected reward objective in an induced Bradly-Terry model of preferences defined by the reward function. That is, for any reward function <math id="A1.1.p1.1.m1.2" class="ltx_Math" alttext="r(\mathbf{x},\mathbf{y})" display="inline"><semantics id="A1.1.p1.1.m1.2a"><mrow id="A1.1.p1.1.m1.2.3" xref="A1.1.p1.1.m1.2.3.cmml"><mi id="A1.1.p1.1.m1.2.3.2" xref="A1.1.p1.1.m1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.1.p1.1.m1.2.3.1" xref="A1.1.p1.1.m1.2.3.1.cmml">â€‹</mo><mrow id="A1.1.p1.1.m1.2.3.3.2" xref="A1.1.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A1.1.p1.1.m1.2.3.3.2.1" xref="A1.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.1.p1.1.m1.1.1" xref="A1.1.p1.1.m1.1.1.cmml">ğ±</mi><mo id="A1.1.p1.1.m1.2.3.3.2.2" xref="A1.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.1.p1.1.m1.2.2" xref="A1.1.p1.1.m1.2.2.cmml">ğ²</mi><mo stretchy="false" id="A1.1.p1.1.m1.2.3.3.2.3" xref="A1.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.1.m1.2b"><apply id="A1.1.p1.1.m1.2.3.cmml" xref="A1.1.p1.1.m1.2.3"><times id="A1.1.p1.1.m1.2.3.1.cmml" xref="A1.1.p1.1.m1.2.3.1"></times><ci id="A1.1.p1.1.m1.2.3.2.cmml" xref="A1.1.p1.1.m1.2.3.2">ğ‘Ÿ</ci><interval closure="open" id="A1.1.p1.1.m1.2.3.3.1.cmml" xref="A1.1.p1.1.m1.2.3.3.2"><ci id="A1.1.p1.1.m1.1.1.cmml" xref="A1.1.p1.1.m1.1.1">ğ±</ci><ci id="A1.1.p1.1.m1.2.2.cmml" xref="A1.1.p1.1.m1.2.2">ğ²</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.1.m1.2c">r(\mathbf{x},\mathbf{y})</annotation></semantics></math> over contexts <math id="A1.1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{x}\sim\mu" display="inline"><semantics id="A1.1.p1.2.m2.1a"><mrow id="A1.1.p1.2.m2.1.1" xref="A1.1.p1.2.m2.1.1.cmml"><mi id="A1.1.p1.2.m2.1.1.2" xref="A1.1.p1.2.m2.1.1.2.cmml">ğ±</mi><mo id="A1.1.p1.2.m2.1.1.1" xref="A1.1.p1.2.m2.1.1.1.cmml">âˆ¼</mo><mi id="A1.1.p1.2.m2.1.1.3" xref="A1.1.p1.2.m2.1.1.3.cmml">Î¼</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.2.m2.1b"><apply id="A1.1.p1.2.m2.1.1.cmml" xref="A1.1.p1.2.m2.1.1"><csymbol cd="latexml" id="A1.1.p1.2.m2.1.1.1.cmml" xref="A1.1.p1.2.m2.1.1.1">similar-to</csymbol><ci id="A1.1.p1.2.m2.1.1.2.cmml" xref="A1.1.p1.2.m2.1.1.2">ğ±</ci><ci id="A1.1.p1.2.m2.1.1.3.cmml" xref="A1.1.p1.2.m2.1.1.3">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.2.m2.1c">\mathbf{x}\sim\mu</annotation></semantics></math> and responses <math id="A1.1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="A1.1.p1.3.m3.1a"><mi id="A1.1.p1.3.m3.1.1" xref="A1.1.p1.3.m3.1.1.cmml">ğ²</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.3.m3.1b"><ci id="A1.1.p1.3.m3.1.1.cmml" xref="A1.1.p1.3.m3.1.1">ğ²</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.3.m3.1c">\mathbf{y}</annotation></semantics></math>, the optimal solution to the following RL objective:</p>
<table id="A7.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E6.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}_{\mathbf{x}\sim\mu,\mathbf{y}\sim\pi(\cdot|\mathbf{x})}\left[r(\mathbf{x},\mathbf{y})\right]-\beta D_{\mathrm{KL}}(\pi(\cdot|\mathbf{x})||\pi_{\mathrm{sft}}(\cdot|\mathbf{x}))," display="inline"><semantics id="A1.E6.m1.2a"><mrow id="A1.E6.m1.2b"><munder id="A1.E6.m1.2.3"><mi id="A1.E6.m1.2.3.2">max</mi><mi id="A1.E6.m1.2.3.3">Ï€</mi></munder><mspace width="1.167em" id="A1.E6.m1.2.4"></mspace><msub id="A1.E6.m1.2.5"><mi id="A1.E6.m1.2.5.2">ğ”¼</mi><mrow id="A1.E6.m1.2.5.3"><mi id="A1.E6.m1.2.5.3.1">ğ±</mi><mo id="A1.E6.m1.2.5.3.2">âˆ¼</mo><mi id="A1.E6.m1.2.5.3.3">Î¼</mi><mo id="A1.E6.m1.2.5.3.4">,</mo><mi id="A1.E6.m1.2.5.3.5">ğ²</mi><mo id="A1.E6.m1.2.5.3.6">âˆ¼</mo><mi id="A1.E6.m1.2.5.3.7">Ï€</mi><mrow id="A1.E6.m1.2.5.3.8"><mo stretchy="false" id="A1.E6.m1.2.5.3.8.1">(</mo><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.5.3.8.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E6.m1.2.5.3.8.3">|</mo><mi id="A1.E6.m1.2.5.3.8.4">ğ±</mi><mo stretchy="false" id="A1.E6.m1.2.5.3.8.5">)</mo></mrow></mrow></msub><mrow id="A1.E6.m1.2.6"><mo id="A1.E6.m1.2.6.1">[</mo><mi id="A1.E6.m1.2.6.2">r</mi><mrow id="A1.E6.m1.2.6.3"><mo stretchy="false" id="A1.E6.m1.2.6.3.1">(</mo><mi id="A1.E6.m1.1.1">ğ±</mi><mo id="A1.E6.m1.2.6.3.2">,</mo><mi id="A1.E6.m1.2.2">ğ²</mi><mo stretchy="false" id="A1.E6.m1.2.6.3.3">)</mo></mrow><mo id="A1.E6.m1.2.6.4">]</mo></mrow><mo id="A1.E6.m1.2.7">âˆ’</mo><mi id="A1.E6.m1.2.8">Î²</mi><msub id="A1.E6.m1.2.9"><mi id="A1.E6.m1.2.9.2">D</mi><mi id="A1.E6.m1.2.9.3">KL</mi></msub><mrow id="A1.E6.m1.2.10"><mo stretchy="false" id="A1.E6.m1.2.10.1">(</mo><mi id="A1.E6.m1.2.10.2">Ï€</mi><mrow id="A1.E6.m1.2.10.3"><mo stretchy="false" id="A1.E6.m1.2.10.3.1">(</mo><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.10.3.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E6.m1.2.10.3.3">|</mo><mi id="A1.E6.m1.2.10.3.4">ğ±</mi><mo stretchy="false" id="A1.E6.m1.2.10.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E6.m1.2.10.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E6.m1.2.10.5">|</mo><msub id="A1.E6.m1.2.10.6"><mi id="A1.E6.m1.2.10.6.2">Ï€</mi><mi id="A1.E6.m1.2.10.6.3">sft</mi></msub><mrow id="A1.E6.m1.2.10.7"><mo stretchy="false" id="A1.E6.m1.2.10.7.1">(</mo><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.10.7.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.E6.m1.2.10.7.3">|</mo><mi id="A1.E6.m1.2.10.7.4">ğ±</mi><mo stretchy="false" id="A1.E6.m1.2.10.7.5">)</mo></mrow><mo stretchy="false" id="A1.E6.m1.2.10.8">)</mo></mrow><mo id="A1.E6.m1.2.11">,</mo></mrow><annotation encoding="application/x-tex" id="A1.E6.m1.2c">\displaystyle\max_{\pi}\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}_{\mathbf{x}\sim\mu,\mathbf{y}\sim\pi(\cdot|\mathbf{x})}\left[r(\mathbf{x},\mathbf{y})\right]-\beta D_{\mathrm{KL}}(\pi(\cdot|\mathbf{x})||\pi_{\mathrm{sft}}(\cdot|\mathbf{x})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="A1.1.p1.4" class="ltx_p">is given by the following advantage-weighted optimal policy, <math id="A1.1.p1.4.m1.1" class="ltx_math_unparsed" alttext="\pi^{*}(\cdot|\cdot)" display="inline"><semantics id="A1.1.p1.4.m1.1a"><mrow id="A1.1.p1.4.m1.1b"><msup id="A1.1.p1.4.m1.1.1"><mi id="A1.1.p1.4.m1.1.1.2">Ï€</mi><mo id="A1.1.p1.4.m1.1.1.3">âˆ—</mo></msup><mrow id="A1.1.p1.4.m1.1.2"><mo stretchy="false" id="A1.1.p1.4.m1.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="A1.1.p1.4.m1.1.2.2">â‹…</mo><mo fence="false" stretchy="false" id="A1.1.p1.4.m1.1.2.3">|</mo><mo lspace="0em" rspace="0em" id="A1.1.p1.4.m1.1.2.4">â‹…</mo><mo stretchy="false" id="A1.1.p1.4.m1.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.1.p1.4.m1.1c">\pi^{*}(\cdot|\cdot)</annotation></semantics></math>:</p>
<table id="A7.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E7.m1.5" class="ltx_Math" alttext="\displaystyle\forall\mathbf{x},\mathbf{y},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi^{*}(\mathbf{y}|\mathbf{x})\propto\pi_{\mathrm{sft}}(\mathbf{y}|\mathbf{x})\cdot\exp\left(\frac{r(\mathbf{x},\mathbf{y})}{\beta}\right)," display="inline"><semantics id="A1.E7.m1.5a"><mrow id="A1.E7.m1.5.5.1" xref="A1.E7.m1.5.5.1.1.cmml"><mrow id="A1.E7.m1.5.5.1.1" xref="A1.E7.m1.5.5.1.1.cmml"><mrow id="A1.E7.m1.5.5.1.1.2.2" xref="A1.E7.m1.5.5.1.1.2.3.cmml"><mrow id="A1.E7.m1.5.5.1.1.1.1.1" xref="A1.E7.m1.5.5.1.1.1.1.1.cmml"><mo rspace="0.167em" id="A1.E7.m1.5.5.1.1.1.1.1.1" xref="A1.E7.m1.5.5.1.1.1.1.1.1.cmml">âˆ€</mo><mi id="A1.E7.m1.5.5.1.1.1.1.1.2" xref="A1.E7.m1.5.5.1.1.1.1.1.2.cmml">ğ±</mi></mrow><mo id="A1.E7.m1.5.5.1.1.2.2.3" xref="A1.E7.m1.5.5.1.1.2.3.cmml">,</mo><mi id="A1.E7.m1.4.4" xref="A1.E7.m1.4.4.cmml">ğ²</mi><mo rspace="1.167em" id="A1.E7.m1.5.5.1.1.2.2.4" xref="A1.E7.m1.5.5.1.1.2.3.cmml">,</mo><mrow id="A1.E7.m1.5.5.1.1.2.2.2" xref="A1.E7.m1.5.5.1.1.2.2.2.cmml"><msup id="A1.E7.m1.5.5.1.1.2.2.2.3" xref="A1.E7.m1.5.5.1.1.2.2.2.3.cmml"><mi id="A1.E7.m1.5.5.1.1.2.2.2.3.2" xref="A1.E7.m1.5.5.1.1.2.2.2.3.2.cmml">Ï€</mi><mo id="A1.E7.m1.5.5.1.1.2.2.2.3.3" xref="A1.E7.m1.5.5.1.1.2.2.2.3.3.cmml">âˆ—</mo></msup><mo lspace="0em" rspace="0em" id="A1.E7.m1.5.5.1.1.2.2.2.2" xref="A1.E7.m1.5.5.1.1.2.2.2.2.cmml">â€‹</mo><mrow id="A1.E7.m1.5.5.1.1.2.2.2.1.1" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A1.E7.m1.5.5.1.1.2.2.2.1.1.2" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.2" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.2.cmml">ğ²</mi><mo fence="false" id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.1" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.3" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.3.cmml">ğ±</mi></mrow><mo stretchy="false" id="A1.E7.m1.5.5.1.1.2.2.2.1.1.3" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E7.m1.5.5.1.1.4" xref="A1.E7.m1.5.5.1.1.4.cmml">âˆ</mo><mrow id="A1.E7.m1.5.5.1.1.3" xref="A1.E7.m1.5.5.1.1.3.cmml"><mrow id="A1.E7.m1.5.5.1.1.3.1" xref="A1.E7.m1.5.5.1.1.3.1.cmml"><msub id="A1.E7.m1.5.5.1.1.3.1.3" xref="A1.E7.m1.5.5.1.1.3.1.3.cmml"><mi id="A1.E7.m1.5.5.1.1.3.1.3.2" xref="A1.E7.m1.5.5.1.1.3.1.3.2.cmml">Ï€</mi><mi id="A1.E7.m1.5.5.1.1.3.1.3.3" xref="A1.E7.m1.5.5.1.1.3.1.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="A1.E7.m1.5.5.1.1.3.1.2" xref="A1.E7.m1.5.5.1.1.3.1.2.cmml">â€‹</mo><mrow id="A1.E7.m1.5.5.1.1.3.1.1.1" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="A1.E7.m1.5.5.1.1.3.1.1.1.2" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.5.5.1.1.3.1.1.1.1" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.cmml"><mi id="A1.E7.m1.5.5.1.1.3.1.1.1.1.2" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.2.cmml">ğ²</mi><mo fence="false" id="A1.E7.m1.5.5.1.1.3.1.1.1.1.1" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.1.cmml">|</mo><mi id="A1.E7.m1.5.5.1.1.3.1.1.1.1.3" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.3.cmml">ğ±</mi></mrow><mo rspace="0.055em" stretchy="false" id="A1.E7.m1.5.5.1.1.3.1.1.1.3" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A1.E7.m1.5.5.1.1.3.2" xref="A1.E7.m1.5.5.1.1.3.2.cmml">â‹…</mo><mrow id="A1.E7.m1.5.5.1.1.3.3.2" xref="A1.E7.m1.5.5.1.1.3.3.1.cmml"><mi id="A1.E7.m1.3.3" xref="A1.E7.m1.3.3.cmml">exp</mi><mo id="A1.E7.m1.5.5.1.1.3.3.2a" xref="A1.E7.m1.5.5.1.1.3.3.1.cmml">â¡</mo><mrow id="A1.E7.m1.5.5.1.1.3.3.2.1" xref="A1.E7.m1.5.5.1.1.3.3.1.cmml"><mo id="A1.E7.m1.5.5.1.1.3.3.2.1.1" xref="A1.E7.m1.5.5.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="A1.E7.m1.2.2" xref="A1.E7.m1.2.2.cmml"><mfrac id="A1.E7.m1.2.2a" xref="A1.E7.m1.2.2.cmml"><mrow id="A1.E7.m1.2.2.2" xref="A1.E7.m1.2.2.2.cmml"><mi id="A1.E7.m1.2.2.2.4" xref="A1.E7.m1.2.2.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E7.m1.2.2.2.3" xref="A1.E7.m1.2.2.2.3.cmml">â€‹</mo><mrow id="A1.E7.m1.2.2.2.5.2" xref="A1.E7.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="A1.E7.m1.2.2.2.5.2.1" xref="A1.E7.m1.2.2.2.5.1.cmml">(</mo><mi id="A1.E7.m1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.cmml">ğ±</mi><mo id="A1.E7.m1.2.2.2.5.2.2" xref="A1.E7.m1.2.2.2.5.1.cmml">,</mo><mi id="A1.E7.m1.2.2.2.2" xref="A1.E7.m1.2.2.2.2.cmml">ğ²</mi><mo stretchy="false" id="A1.E7.m1.2.2.2.5.2.3" xref="A1.E7.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow><mi id="A1.E7.m1.2.2.4" xref="A1.E7.m1.2.2.4.cmml">Î²</mi></mfrac></mstyle><mo id="A1.E7.m1.5.5.1.1.3.3.2.1.2" xref="A1.E7.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E7.m1.5.5.1.2" xref="A1.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.5b"><apply id="A1.E7.m1.5.5.1.1.cmml" xref="A1.E7.m1.5.5.1"><csymbol cd="latexml" id="A1.E7.m1.5.5.1.1.4.cmml" xref="A1.E7.m1.5.5.1.1.4">proportional-to</csymbol><list id="A1.E7.m1.5.5.1.1.2.3.cmml" xref="A1.E7.m1.5.5.1.1.2.2"><apply id="A1.E7.m1.5.5.1.1.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.1.1.1.1">for-all</csymbol><ci id="A1.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E7.m1.5.5.1.1.1.1.1.2">ğ±</ci></apply><ci id="A1.E7.m1.4.4.cmml" xref="A1.E7.m1.4.4">ğ²</ci><apply id="A1.E7.m1.5.5.1.1.2.2.2.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2"><times id="A1.E7.m1.5.5.1.1.2.2.2.2.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.2"></times><apply id="A1.E7.m1.5.5.1.1.2.2.2.3.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.5.5.1.1.2.2.2.3.1.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.3">superscript</csymbol><ci id="A1.E7.m1.5.5.1.1.2.2.2.3.2.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.3.2">ğœ‹</ci><times id="A1.E7.m1.5.5.1.1.2.2.2.3.3.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.3.3"></times></apply><apply id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1"><csymbol cd="latexml" id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.2">ğ²</ci><ci id="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E7.m1.5.5.1.1.2.2.2.1.1.1.3">ğ±</ci></apply></apply></list><apply id="A1.E7.m1.5.5.1.1.3.cmml" xref="A1.E7.m1.5.5.1.1.3"><ci id="A1.E7.m1.5.5.1.1.3.2.cmml" xref="A1.E7.m1.5.5.1.1.3.2">â‹…</ci><apply id="A1.E7.m1.5.5.1.1.3.1.cmml" xref="A1.E7.m1.5.5.1.1.3.1"><times id="A1.E7.m1.5.5.1.1.3.1.2.cmml" xref="A1.E7.m1.5.5.1.1.3.1.2"></times><apply id="A1.E7.m1.5.5.1.1.3.1.3.cmml" xref="A1.E7.m1.5.5.1.1.3.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.5.5.1.1.3.1.3.1.cmml" xref="A1.E7.m1.5.5.1.1.3.1.3">subscript</csymbol><ci id="A1.E7.m1.5.5.1.1.3.1.3.2.cmml" xref="A1.E7.m1.5.5.1.1.3.1.3.2">ğœ‹</ci><ci id="A1.E7.m1.5.5.1.1.3.1.3.3.cmml" xref="A1.E7.m1.5.5.1.1.3.1.3.3">sft</ci></apply><apply id="A1.E7.m1.5.5.1.1.3.1.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.3.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.5.5.1.1.3.1.1.1.1.1.cmml" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.1">conditional</csymbol><ci id="A1.E7.m1.5.5.1.1.3.1.1.1.1.2.cmml" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.2">ğ²</ci><ci id="A1.E7.m1.5.5.1.1.3.1.1.1.1.3.cmml" xref="A1.E7.m1.5.5.1.1.3.1.1.1.1.3">ğ±</ci></apply></apply><apply id="A1.E7.m1.5.5.1.1.3.3.1.cmml" xref="A1.E7.m1.5.5.1.1.3.3.2"><exp id="A1.E7.m1.3.3.cmml" xref="A1.E7.m1.3.3"></exp><apply id="A1.E7.m1.2.2.cmml" xref="A1.E7.m1.2.2"><divide id="A1.E7.m1.2.2.3.cmml" xref="A1.E7.m1.2.2"></divide><apply id="A1.E7.m1.2.2.2.cmml" xref="A1.E7.m1.2.2.2"><times id="A1.E7.m1.2.2.2.3.cmml" xref="A1.E7.m1.2.2.2.3"></times><ci id="A1.E7.m1.2.2.2.4.cmml" xref="A1.E7.m1.2.2.2.4">ğ‘Ÿ</ci><interval closure="open" id="A1.E7.m1.2.2.2.5.1.cmml" xref="A1.E7.m1.2.2.2.5.2"><ci id="A1.E7.m1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1">ğ±</ci><ci id="A1.E7.m1.2.2.2.2.cmml" xref="A1.E7.m1.2.2.2.2">ğ²</ci></interval></apply><ci id="A1.E7.m1.2.2.4.cmml" xref="A1.E7.m1.2.2.4">ğ›½</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.5c">\displaystyle\forall\mathbf{x},\mathbf{y},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi^{*}(\mathbf{y}|\mathbf{x})\propto\pi_{\mathrm{sft}}(\mathbf{y}|\mathbf{x})\cdot\exp\left(\frac{r(\mathbf{x},\mathbf{y})}{\beta}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="A1.1.p1.6" class="ltx_p">and one can learn this optimal policy by running DPO on preference tuples <math id="A1.1.p1.5.m1.3" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{2})" display="inline"><semantics id="A1.1.p1.5.m1.3a"><mrow id="A1.1.p1.5.m1.3.3.2" xref="A1.1.p1.5.m1.3.3.3.cmml"><mo stretchy="false" id="A1.1.p1.5.m1.3.3.2.3" xref="A1.1.p1.5.m1.3.3.3.cmml">(</mo><mi id="A1.1.p1.5.m1.1.1" xref="A1.1.p1.5.m1.1.1.cmml">ğ±</mi><mo id="A1.1.p1.5.m1.3.3.2.4" xref="A1.1.p1.5.m1.3.3.3.cmml">,</mo><msub id="A1.1.p1.5.m1.2.2.1.1" xref="A1.1.p1.5.m1.2.2.1.1.cmml"><mi id="A1.1.p1.5.m1.2.2.1.1.2" xref="A1.1.p1.5.m1.2.2.1.1.2.cmml">ğ²</mi><mn id="A1.1.p1.5.m1.2.2.1.1.3" xref="A1.1.p1.5.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.1.p1.5.m1.3.3.2.5" xref="A1.1.p1.5.m1.3.3.3.cmml">,</mo><msub id="A1.1.p1.5.m1.3.3.2.2" xref="A1.1.p1.5.m1.3.3.2.2.cmml"><mi id="A1.1.p1.5.m1.3.3.2.2.2" xref="A1.1.p1.5.m1.3.3.2.2.2.cmml">ğ²</mi><mn id="A1.1.p1.5.m1.3.3.2.2.3" xref="A1.1.p1.5.m1.3.3.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="A1.1.p1.5.m1.3.3.2.6" xref="A1.1.p1.5.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.5.m1.3b"><vector id="A1.1.p1.5.m1.3.3.3.cmml" xref="A1.1.p1.5.m1.3.3.2"><ci id="A1.1.p1.5.m1.1.1.cmml" xref="A1.1.p1.5.m1.1.1">ğ±</ci><apply id="A1.1.p1.5.m1.2.2.1.1.cmml" xref="A1.1.p1.5.m1.2.2.1.1"><csymbol cd="ambiguous" id="A1.1.p1.5.m1.2.2.1.1.1.cmml" xref="A1.1.p1.5.m1.2.2.1.1">subscript</csymbol><ci id="A1.1.p1.5.m1.2.2.1.1.2.cmml" xref="A1.1.p1.5.m1.2.2.1.1.2">ğ²</ci><cn type="integer" id="A1.1.p1.5.m1.2.2.1.1.3.cmml" xref="A1.1.p1.5.m1.2.2.1.1.3">1</cn></apply><apply id="A1.1.p1.5.m1.3.3.2.2.cmml" xref="A1.1.p1.5.m1.3.3.2.2"><csymbol cd="ambiguous" id="A1.1.p1.5.m1.3.3.2.2.1.cmml" xref="A1.1.p1.5.m1.3.3.2.2">subscript</csymbol><ci id="A1.1.p1.5.m1.3.3.2.2.2.cmml" xref="A1.1.p1.5.m1.3.3.2.2.2">ğ²</ci><cn type="integer" id="A1.1.p1.5.m1.3.3.2.2.3.cmml" xref="A1.1.p1.5.m1.3.3.2.2.3">2</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.5.m1.3c">(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{2})</annotation></semantics></math> sampled by the Bradly-Terry modelÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> induced by the reward function <math id="A1.1.p1.6.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A1.1.p1.6.m2.1a"><mi id="A1.1.p1.6.m2.1.1" xref="A1.1.p1.6.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.6.m2.1b"><ci id="A1.1.p1.6.m2.1.1.cmml" xref="A1.1.p1.6.m2.1.1">ğ‘Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.6.m2.1c">r</annotation></semantics></math>:</p>
<table id="A7.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E8.m1.10" class="ltx_Math" alttext="\displaystyle p\left(\mathbf{y}_{1}\succcurlyeq\mathbf{y}_{2}|\mathbf{x}\right)=\frac{\exp(r(\mathbf{x},\mathbf{y}_{1}))}{\exp(r(\mathbf{x},\mathbf{y}_{1}))+\exp(r(\mathbf{x},\mathbf{y}_{2}))}." display="inline"><semantics id="A1.E8.m1.10a"><mrow id="A1.E8.m1.10.10.1" xref="A1.E8.m1.10.10.1.1.cmml"><mrow id="A1.E8.m1.10.10.1.1" xref="A1.E8.m1.10.10.1.1.cmml"><mrow id="A1.E8.m1.10.10.1.1.1" xref="A1.E8.m1.10.10.1.1.1.cmml"><mi id="A1.E8.m1.10.10.1.1.1.3" xref="A1.E8.m1.10.10.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.10.10.1.1.1.2" xref="A1.E8.m1.10.10.1.1.1.2.cmml">â€‹</mo><mrow id="A1.E8.m1.10.10.1.1.1.1.1" xref="A1.E8.m1.10.10.1.1.1.1.1.1.cmml"><mo id="A1.E8.m1.10.10.1.1.1.1.1.2" xref="A1.E8.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E8.m1.10.10.1.1.1.1.1.1" xref="A1.E8.m1.10.10.1.1.1.1.1.1.cmml"><msub id="A1.E8.m1.10.10.1.1.1.1.1.1.2" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2.cmml"><mi id="A1.E8.m1.10.10.1.1.1.1.1.1.2.2" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2.2.cmml">ğ²</mi><mn id="A1.E8.m1.10.10.1.1.1.1.1.1.2.3" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.E8.m1.10.10.1.1.1.1.1.1.1" xref="A1.E8.m1.10.10.1.1.1.1.1.1.1.cmml">â‰½</mo><mrow id="A1.E8.m1.10.10.1.1.1.1.1.1.3" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.cmml"><msub id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.2" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.2.cmml">ğ²</mi><mn id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.3" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo fence="false" id="A1.E8.m1.10.10.1.1.1.1.1.1.3.1" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.E8.m1.10.10.1.1.1.1.1.1.3.3" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.3.cmml">ğ±</mi></mrow></mrow><mo id="A1.E8.m1.10.10.1.1.1.1.1.3" xref="A1.E8.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.10.10.1.1.2" xref="A1.E8.m1.10.10.1.1.2.cmml">=</mo><mstyle displaystyle="true" id="A1.E8.m1.9.9" xref="A1.E8.m1.9.9.cmml"><mfrac id="A1.E8.m1.9.9a" xref="A1.E8.m1.9.9.cmml"><mrow id="A1.E8.m1.3.3.3.3" xref="A1.E8.m1.3.3.3.4.cmml"><mi id="A1.E8.m1.2.2.2.2" xref="A1.E8.m1.2.2.2.2.cmml">exp</mi><mo id="A1.E8.m1.3.3.3.3a" xref="A1.E8.m1.3.3.3.4.cmml">â¡</mo><mrow id="A1.E8.m1.3.3.3.3.1" xref="A1.E8.m1.3.3.3.4.cmml"><mo stretchy="false" id="A1.E8.m1.3.3.3.3.1.2" xref="A1.E8.m1.3.3.3.4.cmml">(</mo><mrow id="A1.E8.m1.3.3.3.3.1.1" xref="A1.E8.m1.3.3.3.3.1.1.cmml"><mi id="A1.E8.m1.3.3.3.3.1.1.3" xref="A1.E8.m1.3.3.3.3.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.3.3.3.3.1.1.2" xref="A1.E8.m1.3.3.3.3.1.1.2.cmml">â€‹</mo><mrow id="A1.E8.m1.3.3.3.3.1.1.1.1" xref="A1.E8.m1.3.3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="A1.E8.m1.3.3.3.3.1.1.1.1.2" xref="A1.E8.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="A1.E8.m1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml">ğ±</mi><mo id="A1.E8.m1.3.3.3.3.1.1.1.1.3" xref="A1.E8.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msub id="A1.E8.m1.3.3.3.3.1.1.1.1.1" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="A1.E8.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1.2.cmml">ğ²</mi><mn id="A1.E8.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="A1.E8.m1.3.3.3.3.1.1.1.1.4" xref="A1.E8.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E8.m1.3.3.3.3.1.3" xref="A1.E8.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.E8.m1.9.9.9" xref="A1.E8.m1.9.9.9.cmml"><mrow id="A1.E8.m1.8.8.8.5.1" xref="A1.E8.m1.8.8.8.5.2.cmml"><mi id="A1.E8.m1.5.5.5.2" xref="A1.E8.m1.5.5.5.2.cmml">exp</mi><mo id="A1.E8.m1.8.8.8.5.1a" xref="A1.E8.m1.8.8.8.5.2.cmml">â¡</mo><mrow id="A1.E8.m1.8.8.8.5.1.1" xref="A1.E8.m1.8.8.8.5.2.cmml"><mo stretchy="false" id="A1.E8.m1.8.8.8.5.1.1.2" xref="A1.E8.m1.8.8.8.5.2.cmml">(</mo><mrow id="A1.E8.m1.8.8.8.5.1.1.1" xref="A1.E8.m1.8.8.8.5.1.1.1.cmml"><mi id="A1.E8.m1.8.8.8.5.1.1.1.3" xref="A1.E8.m1.8.8.8.5.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.8.8.8.5.1.1.1.2" xref="A1.E8.m1.8.8.8.5.1.1.1.2.cmml">â€‹</mo><mrow id="A1.E8.m1.8.8.8.5.1.1.1.1.1" xref="A1.E8.m1.8.8.8.5.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E8.m1.8.8.8.5.1.1.1.1.1.2" xref="A1.E8.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="A1.E8.m1.4.4.4.1" xref="A1.E8.m1.4.4.4.1.cmml">ğ±</mi><mo id="A1.E8.m1.8.8.8.5.1.1.1.1.1.3" xref="A1.E8.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msub id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.2" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">ğ²</mi><mn id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.3" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="A1.E8.m1.8.8.8.5.1.1.1.1.1.4" xref="A1.E8.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E8.m1.8.8.8.5.1.1.3" xref="A1.E8.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.9.9.9.7" xref="A1.E8.m1.9.9.9.7.cmml">+</mo><mrow id="A1.E8.m1.9.9.9.6.1" xref="A1.E8.m1.9.9.9.6.2.cmml"><mi id="A1.E8.m1.7.7.7.4" xref="A1.E8.m1.7.7.7.4.cmml">exp</mi><mo id="A1.E8.m1.9.9.9.6.1a" xref="A1.E8.m1.9.9.9.6.2.cmml">â¡</mo><mrow id="A1.E8.m1.9.9.9.6.1.1" xref="A1.E8.m1.9.9.9.6.2.cmml"><mo stretchy="false" id="A1.E8.m1.9.9.9.6.1.1.2" xref="A1.E8.m1.9.9.9.6.2.cmml">(</mo><mrow id="A1.E8.m1.9.9.9.6.1.1.1" xref="A1.E8.m1.9.9.9.6.1.1.1.cmml"><mi id="A1.E8.m1.9.9.9.6.1.1.1.3" xref="A1.E8.m1.9.9.9.6.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.9.9.9.6.1.1.1.2" xref="A1.E8.m1.9.9.9.6.1.1.1.2.cmml">â€‹</mo><mrow id="A1.E8.m1.9.9.9.6.1.1.1.1.1" xref="A1.E8.m1.9.9.9.6.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E8.m1.9.9.9.6.1.1.1.1.1.2" xref="A1.E8.m1.9.9.9.6.1.1.1.1.2.cmml">(</mo><mi id="A1.E8.m1.6.6.6.3" xref="A1.E8.m1.6.6.6.3.cmml">ğ±</mi><mo id="A1.E8.m1.9.9.9.6.1.1.1.1.1.3" xref="A1.E8.m1.9.9.9.6.1.1.1.1.2.cmml">,</mo><msub id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.2" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">ğ²</mi><mn id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.3" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="A1.E8.m1.9.9.9.6.1.1.1.1.1.4" xref="A1.E8.m1.9.9.9.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E8.m1.9.9.9.6.1.1.3" xref="A1.E8.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo lspace="0em" id="A1.E8.m1.10.10.1.2" xref="A1.E8.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.10b"><apply id="A1.E8.m1.10.10.1.1.cmml" xref="A1.E8.m1.10.10.1"><eq id="A1.E8.m1.10.10.1.1.2.cmml" xref="A1.E8.m1.10.10.1.1.2"></eq><apply id="A1.E8.m1.10.10.1.1.1.cmml" xref="A1.E8.m1.10.10.1.1.1"><times id="A1.E8.m1.10.10.1.1.1.2.cmml" xref="A1.E8.m1.10.10.1.1.1.2"></times><ci id="A1.E8.m1.10.10.1.1.1.3.cmml" xref="A1.E8.m1.10.10.1.1.1.3">ğ‘</ci><apply id="A1.E8.m1.10.10.1.1.1.1.1.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="A1.E8.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.1">succeeds-or-equals</csymbol><apply id="A1.E8.m1.10.10.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E8.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2.2">ğ²</ci><cn type="integer" id="A1.E8.m1.10.10.1.1.1.1.1.1.2.3.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.E8.m1.10.10.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E8.m1.10.10.1.1.1.1.1.1.3.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.2">ğ²</ci><cn type="integer" id="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="A1.E8.m1.10.10.1.1.1.1.1.1.3.3.cmml" xref="A1.E8.m1.10.10.1.1.1.1.1.1.3.3">ğ±</ci></apply></apply></apply><apply id="A1.E8.m1.9.9.cmml" xref="A1.E8.m1.9.9"><divide id="A1.E8.m1.9.9.10.cmml" xref="A1.E8.m1.9.9"></divide><apply id="A1.E8.m1.3.3.3.4.cmml" xref="A1.E8.m1.3.3.3.3"><exp id="A1.E8.m1.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2"></exp><apply id="A1.E8.m1.3.3.3.3.1.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1"><times id="A1.E8.m1.3.3.3.3.1.1.2.cmml" xref="A1.E8.m1.3.3.3.3.1.1.2"></times><ci id="A1.E8.m1.3.3.3.3.1.1.3.cmml" xref="A1.E8.m1.3.3.3.3.1.1.3">ğ‘Ÿ</ci><interval closure="open" id="A1.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.1"><ci id="A1.E8.m1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1">ğ±</ci><apply id="A1.E8.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1.2">ğ²</ci><cn type="integer" id="A1.E8.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="A1.E8.m1.9.9.9.cmml" xref="A1.E8.m1.9.9.9"><plus id="A1.E8.m1.9.9.9.7.cmml" xref="A1.E8.m1.9.9.9.7"></plus><apply id="A1.E8.m1.8.8.8.5.2.cmml" xref="A1.E8.m1.8.8.8.5.1"><exp id="A1.E8.m1.5.5.5.2.cmml" xref="A1.E8.m1.5.5.5.2"></exp><apply id="A1.E8.m1.8.8.8.5.1.1.1.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1"><times id="A1.E8.m1.8.8.8.5.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.2"></times><ci id="A1.E8.m1.8.8.8.5.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.3">ğ‘Ÿ</ci><interval closure="open" id="A1.E8.m1.8.8.8.5.1.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1"><ci id="A1.E8.m1.4.4.4.1.cmml" xref="A1.E8.m1.4.4.4.1">ğ±</ci><apply id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.2">ğ²</ci><cn type="integer" id="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.5.1.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="A1.E8.m1.9.9.9.6.2.cmml" xref="A1.E8.m1.9.9.9.6.1"><exp id="A1.E8.m1.7.7.7.4.cmml" xref="A1.E8.m1.7.7.7.4"></exp><apply id="A1.E8.m1.9.9.9.6.1.1.1.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1"><times id="A1.E8.m1.9.9.9.6.1.1.1.2.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.2"></times><ci id="A1.E8.m1.9.9.9.6.1.1.1.3.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.3">ğ‘Ÿ</ci><interval closure="open" id="A1.E8.m1.9.9.9.6.1.1.1.1.2.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1"><ci id="A1.E8.m1.6.6.6.3.cmml" xref="A1.E8.m1.6.6.6.3">ğ±</ci><apply id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.2">ğ²</ci><cn type="integer" id="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.9.9.9.6.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.10c">\displaystyle p\left(\mathbf{y}_{1}\succcurlyeq\mathbf{y}_{2}|\mathbf{x}\right)=\frac{\exp(r(\mathbf{x},\mathbf{y}_{1}))}{\exp(r(\mathbf{x},\mathbf{y}_{1}))+\exp(r(\mathbf{x},\mathbf{y}_{2}))}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="A1.1.p1.10" class="ltx_p">Given this background information, we know that the optimal advantage-weighted RL policy optimizing EquationÂ <a href="#A1.E5" title="In Theorem A.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is given by:</p>
<table id="A7.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E9.m1.7" class="ltx_Math" alttext="\displaystyle\forall\mathbf{x},\mathbf{y}_{0:i},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi(\mathbf{y}_{i}|\mathbf{x},\mathbf{y}_{0:i-1})\propto\pi_{\mathrm{sft}}(\mathbf{y}_{i}|\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(\frac{A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})}{\beta}\right)." display="inline"><semantics id="A1.E9.m1.7a"><mrow id="A1.E9.m1.7.7.1" xref="A1.E9.m1.7.7.1.1.cmml"><mrow id="A1.E9.m1.7.7.1.1" xref="A1.E9.m1.7.7.1.1.cmml"><mrow id="A1.E9.m1.7.7.1.1.3.3" xref="A1.E9.m1.7.7.1.1.3.4.cmml"><mrow id="A1.E9.m1.7.7.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.cmml"><mo rspace="0.167em" id="A1.E9.m1.7.7.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.1.1.1.1.cmml">âˆ€</mo><mi id="A1.E9.m1.7.7.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.1.1.1.2.cmml">ğ±</mi></mrow><mo id="A1.E9.m1.7.7.1.1.3.3.4" xref="A1.E9.m1.7.7.1.1.3.4.cmml">,</mo><msub id="A1.E9.m1.7.7.1.1.2.2.2" xref="A1.E9.m1.7.7.1.1.2.2.2.cmml"><mi id="A1.E9.m1.7.7.1.1.2.2.2.2" xref="A1.E9.m1.7.7.1.1.2.2.2.2.cmml">ğ²</mi><mrow id="A1.E9.m1.7.7.1.1.2.2.2.3" xref="A1.E9.m1.7.7.1.1.2.2.2.3.cmml"><mn id="A1.E9.m1.7.7.1.1.2.2.2.3.2" xref="A1.E9.m1.7.7.1.1.2.2.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E9.m1.7.7.1.1.2.2.2.3.1" xref="A1.E9.m1.7.7.1.1.2.2.2.3.1.cmml">:</mo><mi id="A1.E9.m1.7.7.1.1.2.2.2.3.3" xref="A1.E9.m1.7.7.1.1.2.2.2.3.3.cmml">i</mi></mrow></msub><mo rspace="1.167em" id="A1.E9.m1.7.7.1.1.3.3.5" xref="A1.E9.m1.7.7.1.1.3.4.cmml">,</mo><mrow id="A1.E9.m1.7.7.1.1.3.3.3" xref="A1.E9.m1.7.7.1.1.3.3.3.cmml"><mi id="A1.E9.m1.7.7.1.1.3.3.3.3" xref="A1.E9.m1.7.7.1.1.3.3.3.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="A1.E9.m1.7.7.1.1.3.3.3.2" xref="A1.E9.m1.7.7.1.1.3.3.3.2.cmml">â€‹</mo><mrow id="A1.E9.m1.7.7.1.1.3.3.3.1.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.cmml"><msub id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.cmml"><mi id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.2.cmml">ğ²</mi><mi id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.2.cmml">|</mo><mrow id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.2.cmml"><mi id="A1.E9.m1.4.4" xref="A1.E9.m1.4.4.cmml">ğ±</mi><mo id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.2.cmml">,</mo><msub id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.cmml"><mn id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.2" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.1" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.3" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E9.m1.7.7.1.1.5" xref="A1.E9.m1.7.7.1.1.5.cmml">âˆ</mo><mrow id="A1.E9.m1.7.7.1.1.4" xref="A1.E9.m1.7.7.1.1.4.cmml"><mrow id="A1.E9.m1.7.7.1.1.4.1" xref="A1.E9.m1.7.7.1.1.4.1.cmml"><msub id="A1.E9.m1.7.7.1.1.4.1.3" xref="A1.E9.m1.7.7.1.1.4.1.3.cmml"><mi id="A1.E9.m1.7.7.1.1.4.1.3.2" xref="A1.E9.m1.7.7.1.1.4.1.3.2.cmml">Ï€</mi><mi id="A1.E9.m1.7.7.1.1.4.1.3.3" xref="A1.E9.m1.7.7.1.1.4.1.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="A1.E9.m1.7.7.1.1.4.1.2" xref="A1.E9.m1.7.7.1.1.4.1.2.cmml">â€‹</mo><mrow id="A1.E9.m1.7.7.1.1.4.1.1.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.cmml"><mo stretchy="false" id="A1.E9.m1.7.7.1.1.4.1.1.1.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.7.7.1.1.4.1.1.1.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.cmml"><msub id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.cmml"><mi id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.2.cmml">ğ²</mi><mi id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.2.cmml">|</mo><mrow id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.2.cmml"><mi id="A1.E9.m1.5.5" xref="A1.E9.m1.5.5.cmml">ğ±</mi><mo id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.2.cmml">,</mo><msub id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.cmml"><mn id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.2" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.1" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="A1.E9.m1.7.7.1.1.4.1.1.1.3" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A1.E9.m1.7.7.1.1.4.2" xref="A1.E9.m1.7.7.1.1.4.2.cmml">â‹…</mo><mrow id="A1.E9.m1.7.7.1.1.4.3.2" xref="A1.E9.m1.7.7.1.1.4.3.1.cmml"><mi id="A1.E9.m1.6.6" xref="A1.E9.m1.6.6.cmml">exp</mi><mo id="A1.E9.m1.7.7.1.1.4.3.2a" xref="A1.E9.m1.7.7.1.1.4.3.1.cmml">â¡</mo><mrow id="A1.E9.m1.7.7.1.1.4.3.2.1" xref="A1.E9.m1.7.7.1.1.4.3.1.cmml"><mo id="A1.E9.m1.7.7.1.1.4.3.2.1.1" xref="A1.E9.m1.7.7.1.1.4.3.1.cmml">(</mo><mstyle displaystyle="true" id="A1.E9.m1.3.3" xref="A1.E9.m1.3.3.cmml"><mfrac id="A1.E9.m1.3.3a" xref="A1.E9.m1.3.3.cmml"><mrow id="A1.E9.m1.3.3.3" xref="A1.E9.m1.3.3.3.cmml"><msub id="A1.E9.m1.3.3.3.5" xref="A1.E9.m1.3.3.3.5.cmml"><mi id="A1.E9.m1.3.3.3.5.2" xref="A1.E9.m1.3.3.3.5.2.cmml">A</mi><mover accent="true" id="A1.E9.m1.3.3.3.5.3" xref="A1.E9.m1.3.3.3.5.3.cmml"><mi id="A1.E9.m1.3.3.3.5.3.2" xref="A1.E9.m1.3.3.3.5.3.2.cmml">Ï€</mi><mo id="A1.E9.m1.3.3.3.5.3.1" xref="A1.E9.m1.3.3.3.5.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A1.E9.m1.3.3.3.4" xref="A1.E9.m1.3.3.3.4.cmml">â€‹</mo><mrow id="A1.E9.m1.3.3.3.3.2" xref="A1.E9.m1.3.3.3.3.3.cmml"><mo stretchy="false" id="A1.E9.m1.3.3.3.3.2.3" xref="A1.E9.m1.3.3.3.3.3.cmml">(</mo><mi id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">ğ±</mi><mo id="A1.E9.m1.3.3.3.3.2.4" xref="A1.E9.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E9.m1.2.2.2.2.1.1" xref="A1.E9.m1.2.2.2.2.1.1.cmml"><mi id="A1.E9.m1.2.2.2.2.1.1.2" xref="A1.E9.m1.2.2.2.2.1.1.2.cmml">ğ²</mi><mrow id="A1.E9.m1.2.2.2.2.1.1.3" xref="A1.E9.m1.2.2.2.2.1.1.3.cmml"><mn id="A1.E9.m1.2.2.2.2.1.1.3.2" xref="A1.E9.m1.2.2.2.2.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.E9.m1.2.2.2.2.1.1.3.1" xref="A1.E9.m1.2.2.2.2.1.1.3.1.cmml">:</mo><mrow id="A1.E9.m1.2.2.2.2.1.1.3.3" xref="A1.E9.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A1.E9.m1.2.2.2.2.1.1.3.3.2" xref="A1.E9.m1.2.2.2.2.1.1.3.3.2.cmml">i</mi><mo id="A1.E9.m1.2.2.2.2.1.1.3.3.1" xref="A1.E9.m1.2.2.2.2.1.1.3.3.1.cmml">âˆ’</mo><mn id="A1.E9.m1.2.2.2.2.1.1.3.3.3" xref="A1.E9.m1.2.2.2.2.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A1.E9.m1.3.3.3.3.2.5" xref="A1.E9.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E9.m1.3.3.3.3.2.2" xref="A1.E9.m1.3.3.3.3.2.2.cmml"><mi id="A1.E9.m1.3.3.3.3.2.2.2" xref="A1.E9.m1.3.3.3.3.2.2.2.cmml">ğ²</mi><mi id="A1.E9.m1.3.3.3.3.2.2.3" xref="A1.E9.m1.3.3.3.3.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E9.m1.3.3.3.3.2.6" xref="A1.E9.m1.3.3.3.3.3.cmml">)</mo></mrow></mrow><mi id="A1.E9.m1.3.3.5" xref="A1.E9.m1.3.3.5.cmml">Î²</mi></mfrac></mstyle><mo id="A1.E9.m1.7.7.1.1.4.3.2.1.2" xref="A1.E9.m1.7.7.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E9.m1.7.7.1.2" xref="A1.E9.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.7b"><apply id="A1.E9.m1.7.7.1.1.cmml" xref="A1.E9.m1.7.7.1"><csymbol cd="latexml" id="A1.E9.m1.7.7.1.1.5.cmml" xref="A1.E9.m1.7.7.1.1.5">proportional-to</csymbol><list id="A1.E9.m1.7.7.1.1.3.4.cmml" xref="A1.E9.m1.7.7.1.1.3.3"><apply id="A1.E9.m1.7.7.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.7.7.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.1">for-all</csymbol><ci id="A1.E9.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.1.1.1.2">ğ±</ci></apply><apply id="A1.E9.m1.7.7.1.1.2.2.2.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.2.2.2.1.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.2.2.2.2.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2.2">ğ²</ci><apply id="A1.E9.m1.7.7.1.1.2.2.2.3.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2.3"><ci id="A1.E9.m1.7.7.1.1.2.2.2.3.1.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2.3.1">:</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.2.2.2.3.2.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2.3.2">0</cn><ci id="A1.E9.m1.7.7.1.1.2.2.2.3.3.cmml" xref="A1.E9.m1.7.7.1.1.2.2.2.3.3">ğ‘–</ci></apply></apply><apply id="A1.E9.m1.7.7.1.1.3.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3"><times id="A1.E9.m1.7.7.1.1.3.3.3.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.2"></times><ci id="A1.E9.m1.7.7.1.1.3.3.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.3">ğœ‹</ci><apply id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1"><csymbol cd="latexml" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.2">conditional</csymbol><apply id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.2">ğ²</ci><ci id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.3.3">ğ‘–</ci></apply><list id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1"><ci id="A1.E9.m1.4.4.cmml" xref="A1.E9.m1.4.4">ğ±</ci><apply id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.2">ğ²</ci><apply id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3"><ci id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.2">0</cn><apply id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3"><minus id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.7.7.1.1.3.3.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></list></apply></apply></list><apply id="A1.E9.m1.7.7.1.1.4.cmml" xref="A1.E9.m1.7.7.1.1.4"><ci id="A1.E9.m1.7.7.1.1.4.2.cmml" xref="A1.E9.m1.7.7.1.1.4.2">â‹…</ci><apply id="A1.E9.m1.7.7.1.1.4.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1"><times id="A1.E9.m1.7.7.1.1.4.1.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.2"></times><apply id="A1.E9.m1.7.7.1.1.4.1.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.4.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.3">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.4.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.3.2">ğœ‹</ci><ci id="A1.E9.m1.7.7.1.1.4.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.3.3">sft</ci></apply><apply id="A1.E9.m1.7.7.1.1.4.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.2">conditional</csymbol><apply id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.2">ğ²</ci><ci id="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.3.3">ğ‘–</ci></apply><list id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1"><ci id="A1.E9.m1.5.5.cmml" xref="A1.E9.m1.5.5">ğ±</ci><apply id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.2">ğ²</ci><apply id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3"><ci id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.2">0</cn><apply id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3"><minus id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.7.7.1.1.4.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></list></apply></apply><apply id="A1.E9.m1.7.7.1.1.4.3.1.cmml" xref="A1.E9.m1.7.7.1.1.4.3.2"><exp id="A1.E9.m1.6.6.cmml" xref="A1.E9.m1.6.6"></exp><apply id="A1.E9.m1.3.3.cmml" xref="A1.E9.m1.3.3"><divide id="A1.E9.m1.3.3.4.cmml" xref="A1.E9.m1.3.3"></divide><apply id="A1.E9.m1.3.3.3.cmml" xref="A1.E9.m1.3.3.3"><times id="A1.E9.m1.3.3.3.4.cmml" xref="A1.E9.m1.3.3.3.4"></times><apply id="A1.E9.m1.3.3.3.5.cmml" xref="A1.E9.m1.3.3.3.5"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.3.5.1.cmml" xref="A1.E9.m1.3.3.3.5">subscript</csymbol><ci id="A1.E9.m1.3.3.3.5.2.cmml" xref="A1.E9.m1.3.3.3.5.2">ğ´</ci><apply id="A1.E9.m1.3.3.3.5.3.cmml" xref="A1.E9.m1.3.3.3.5.3"><ci id="A1.E9.m1.3.3.3.5.3.1.cmml" xref="A1.E9.m1.3.3.3.5.3.1">~</ci><ci id="A1.E9.m1.3.3.3.5.3.2.cmml" xref="A1.E9.m1.3.3.3.5.3.2">ğœ‹</ci></apply></apply><vector id="A1.E9.m1.3.3.3.3.3.cmml" xref="A1.E9.m1.3.3.3.3.2"><ci id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">ğ±</ci><apply id="A1.E9.m1.2.2.2.2.1.1.cmml" xref="A1.E9.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.2.2.2.2.1.1.1.cmml" xref="A1.E9.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E9.m1.2.2.2.2.1.1.2.cmml" xref="A1.E9.m1.2.2.2.2.1.1.2">ğ²</ci><apply id="A1.E9.m1.2.2.2.2.1.1.3.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3"><ci id="A1.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.1">:</ci><cn type="integer" id="A1.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.2">0</cn><apply id="A1.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.3"><minus id="A1.E9.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.3.1"></minus><ci id="A1.E9.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A1.E9.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A1.E9.m1.2.2.2.2.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A1.E9.m1.3.3.3.3.2.2.cmml" xref="A1.E9.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.3.3.2.2.1.cmml" xref="A1.E9.m1.3.3.3.3.2.2">subscript</csymbol><ci id="A1.E9.m1.3.3.3.3.2.2.2.cmml" xref="A1.E9.m1.3.3.3.3.2.2.2">ğ²</ci><ci id="A1.E9.m1.3.3.3.3.2.2.3.cmml" xref="A1.E9.m1.3.3.3.3.2.2.3">ğ‘–</ci></apply></vector></apply><ci id="A1.E9.m1.3.3.5.cmml" xref="A1.E9.m1.3.3.5">ğ›½</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.7c">\displaystyle\forall\mathbf{x},\mathbf{y}_{0:i},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi(\mathbf{y}_{i}|\mathbf{x},\mathbf{y}_{0:i-1})\propto\pi_{\mathrm{sft}}(\mathbf{y}_{i}|\mathbf{x},\mathbf{y}_{0:i-1})\cdot\exp\left(\frac{A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})}{\beta}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="A1.1.p1.9" class="ltx_p">Combining EquationÂ <a href="#A1.E9" title="In Proof. â€£ Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> with the equivalence between EquationÂ <a href="#A1.E7" title="In Proof. â€£ Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and the Bradly-Terry model (EquationÂ <a href="#A1.E8" title="In Proof. â€£ Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), we obtain that, if preference pairs <math id="A1.1.p1.7.m1.3" class="ltx_Math" alttext="(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])" display="inline"><semantics id="A1.1.p1.7.m1.3a"><mrow id="A1.1.p1.7.m1.3.3.2" xref="A1.1.p1.7.m1.3.3.3.cmml"><mo stretchy="false" id="A1.1.p1.7.m1.3.3.2.3" xref="A1.1.p1.7.m1.3.3.3.cmml">(</mo><mi id="A1.1.p1.7.m1.1.1" xref="A1.1.p1.7.m1.1.1.cmml">ğ±</mi><mo id="A1.1.p1.7.m1.3.3.2.4" xref="A1.1.p1.7.m1.3.3.3.cmml">,</mo><mrow id="A1.1.p1.7.m1.2.2.1.1.2" xref="A1.1.p1.7.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="A1.1.p1.7.m1.2.2.1.1.2.3" xref="A1.1.p1.7.m1.2.2.1.1.3.cmml">[</mo><msub id="A1.1.p1.7.m1.2.2.1.1.1.1" xref="A1.1.p1.7.m1.2.2.1.1.1.1.cmml"><mi id="A1.1.p1.7.m1.2.2.1.1.1.1.2" xref="A1.1.p1.7.m1.2.2.1.1.1.1.2.cmml">ğ²</mi><mrow id="A1.1.p1.7.m1.2.2.1.1.1.1.3" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.cmml"><mn id="A1.1.p1.7.m1.2.2.1.1.1.1.3.2" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.1.p1.7.m1.2.2.1.1.1.1.3.1" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="A1.1.p1.7.m1.2.2.1.1.1.1.3.3" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.1.p1.7.m1.2.2.1.1.2.4" xref="A1.1.p1.7.m1.2.2.1.1.3.cmml">,</mo><mrow id="A1.1.p1.7.m1.2.2.1.1.2.2" xref="A1.1.p1.7.m1.2.2.1.1.2.2.cmml"><mo id="A1.1.p1.7.m1.2.2.1.1.2.2a" xref="A1.1.p1.7.m1.2.2.1.1.2.2.cmml">+</mo><msub id="A1.1.p1.7.m1.2.2.1.1.2.2.2" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.cmml"><mi id="A1.1.p1.7.m1.2.2.1.1.2.2.2.2" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.2.cmml">ğ²</mi><mrow id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.2" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.1" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.3" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A1.1.p1.7.m1.2.2.1.1.2.5" xref="A1.1.p1.7.m1.2.2.1.1.3.cmml">]</mo></mrow><mo id="A1.1.p1.7.m1.3.3.2.5" xref="A1.1.p1.7.m1.3.3.3.cmml">,</mo><mrow id="A1.1.p1.7.m1.3.3.2.2.2" xref="A1.1.p1.7.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="A1.1.p1.7.m1.3.3.2.2.2.3" xref="A1.1.p1.7.m1.3.3.2.2.3.cmml">[</mo><msub id="A1.1.p1.7.m1.3.3.2.2.1.1" xref="A1.1.p1.7.m1.3.3.2.2.1.1.cmml"><mi id="A1.1.p1.7.m1.3.3.2.2.1.1.2" xref="A1.1.p1.7.m1.3.3.2.2.1.1.2.cmml">ğ²</mi><mrow id="A1.1.p1.7.m1.3.3.2.2.1.1.3" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.cmml"><mn id="A1.1.p1.7.m1.3.3.2.2.1.1.3.2" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.1.p1.7.m1.3.3.2.2.1.1.3.1" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.1.cmml">:</mo><mi id="A1.1.p1.7.m1.3.3.2.2.1.1.3.3" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.1.p1.7.m1.3.3.2.2.2.4" xref="A1.1.p1.7.m1.3.3.2.2.3.cmml">,</mo><mrow id="A1.1.p1.7.m1.3.3.2.2.2.2" xref="A1.1.p1.7.m1.3.3.2.2.2.2.cmml"><mo id="A1.1.p1.7.m1.3.3.2.2.2.2a" xref="A1.1.p1.7.m1.3.3.2.2.2.2.cmml">âˆ’</mo><msub id="A1.1.p1.7.m1.3.3.2.2.2.2.2" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.cmml"><mi id="A1.1.p1.7.m1.3.3.2.2.2.2.2.2" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.2.cmml">ğ²</mi><mrow id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.cmml"><mi id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.2" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.2.cmml">i</mi><mo id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.1" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.1.cmml">+</mo><mn id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.3" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A1.1.p1.7.m1.3.3.2.2.2.5" xref="A1.1.p1.7.m1.3.3.2.2.3.cmml">]</mo></mrow><mo stretchy="false" id="A1.1.p1.7.m1.3.3.2.6" xref="A1.1.p1.7.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.7.m1.3b"><vector id="A1.1.p1.7.m1.3.3.3.cmml" xref="A1.1.p1.7.m1.3.3.2"><ci id="A1.1.p1.7.m1.1.1.cmml" xref="A1.1.p1.7.m1.1.1">ğ±</ci><interval closure="closed" id="A1.1.p1.7.m1.2.2.1.1.3.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2"><apply id="A1.1.p1.7.m1.2.2.1.1.1.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.1.p1.7.m1.2.2.1.1.1.1.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="A1.1.p1.7.m1.2.2.1.1.1.1.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1.2">ğ²</ci><apply id="A1.1.p1.7.m1.2.2.1.1.1.1.3.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3"><ci id="A1.1.p1.7.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.1.p1.7.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.2">1</cn><ci id="A1.1.p1.7.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.1.p1.7.m1.2.2.1.1.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A1.1.p1.7.m1.2.2.1.1.2.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2"><plus id="A1.1.p1.7.m1.2.2.1.1.2.2.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2"></plus><apply id="A1.1.p1.7.m1.2.2.1.1.2.2.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.1.p1.7.m1.2.2.1.1.2.2.2.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.1.p1.7.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.2">ğ²</ci><apply id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3"><plus id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.1"></plus><ci id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A1.1.p1.7.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></apply></interval><interval closure="closed" id="A1.1.p1.7.m1.3.3.2.2.3.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2"><apply id="A1.1.p1.7.m1.3.3.2.2.1.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A1.1.p1.7.m1.3.3.2.2.1.1.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1">subscript</csymbol><ci id="A1.1.p1.7.m1.3.3.2.2.1.1.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1.2">ğ²</ci><apply id="A1.1.p1.7.m1.3.3.2.2.1.1.3.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3"><ci id="A1.1.p1.7.m1.3.3.2.2.1.1.3.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.1">:</ci><cn type="integer" id="A1.1.p1.7.m1.3.3.2.2.1.1.3.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.2">1</cn><ci id="A1.1.p1.7.m1.3.3.2.2.1.1.3.3.cmml" xref="A1.1.p1.7.m1.3.3.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A1.1.p1.7.m1.3.3.2.2.2.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2"><minus id="A1.1.p1.7.m1.3.3.2.2.2.2.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2"></minus><apply id="A1.1.p1.7.m1.3.3.2.2.2.2.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.1.p1.7.m1.3.3.2.2.2.2.2.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="A1.1.p1.7.m1.3.3.2.2.2.2.2.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.2">ğ²</ci><apply id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3"><plus id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.1.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.1"></plus><ci id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.2.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.2">ğ‘–</ci><cn type="integer" id="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.3.cmml" xref="A1.1.p1.7.m1.3.3.2.2.2.2.2.3.3">1</cn></apply></apply></apply></interval></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.7.m1.3c">(\mathbf{x},[\mathbf{y}_{1:i},+\mathbf{y}_{i+1}],[\mathbf{y}_{1:i},-\mathbf{y}_{i+1}])</annotation></semantics></math> were sampled from the SFT policy: <math id="A1.1.p1.8.m2.1" class="ltx_math_unparsed" alttext="+\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:i})" display="inline"><semantics id="A1.1.p1.8.m2.1a"><mrow id="A1.1.p1.8.m2.1b"><mo id="A1.1.p1.8.m2.1.1">+</mo><msub id="A1.1.p1.8.m2.1.2"><mi id="A1.1.p1.8.m2.1.2.2">ğ²</mi><mrow id="A1.1.p1.8.m2.1.2.3"><mi id="A1.1.p1.8.m2.1.2.3.2">i</mi><mo id="A1.1.p1.8.m2.1.2.3.1">+</mo><mn id="A1.1.p1.8.m2.1.2.3.3">1</mn></mrow></msub><mo id="A1.1.p1.8.m2.1.3">âˆ¼</mo><msub id="A1.1.p1.8.m2.1.4"><mi id="A1.1.p1.8.m2.1.4.2">Ï€</mi><mi id="A1.1.p1.8.m2.1.4.3">sft</mi></msub><mrow id="A1.1.p1.8.m2.1.5"><mo stretchy="false" id="A1.1.p1.8.m2.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="A1.1.p1.8.m2.1.5.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.1.p1.8.m2.1.5.3">|</mo><mi id="A1.1.p1.8.m2.1.5.4">ğ±</mi><mo id="A1.1.p1.8.m2.1.5.5">,</mo><msub id="A1.1.p1.8.m2.1.5.6"><mi id="A1.1.p1.8.m2.1.5.6.2">ğ²</mi><mrow id="A1.1.p1.8.m2.1.5.6.3"><mn id="A1.1.p1.8.m2.1.5.6.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.1.p1.8.m2.1.5.6.3.1">:</mo><mi id="A1.1.p1.8.m2.1.5.6.3.3">i</mi></mrow></msub><mo stretchy="false" id="A1.1.p1.8.m2.1.5.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.1.p1.8.m2.1c">+\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:i})</annotation></semantics></math> and <math id="A1.1.p1.9.m3.1" class="ltx_math_unparsed" alttext="-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:i})" display="inline"><semantics id="A1.1.p1.9.m3.1a"><mrow id="A1.1.p1.9.m3.1b"><mo id="A1.1.p1.9.m3.1.1">âˆ’</mo><msub id="A1.1.p1.9.m3.1.2"><mi id="A1.1.p1.9.m3.1.2.2">ğ²</mi><mrow id="A1.1.p1.9.m3.1.2.3"><mi id="A1.1.p1.9.m3.1.2.3.2">i</mi><mo id="A1.1.p1.9.m3.1.2.3.1">+</mo><mn id="A1.1.p1.9.m3.1.2.3.3">1</mn></mrow></msub><mo id="A1.1.p1.9.m3.1.3">âˆ¼</mo><msub id="A1.1.p1.9.m3.1.4"><mi id="A1.1.p1.9.m3.1.4.2">Ï€</mi><mi id="A1.1.p1.9.m3.1.4.3">sft</mi></msub><mrow id="A1.1.p1.9.m3.1.5"><mo stretchy="false" id="A1.1.p1.9.m3.1.5.1">(</mo><mo lspace="0em" rspace="0em" id="A1.1.p1.9.m3.1.5.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.1.p1.9.m3.1.5.3">|</mo><mi id="A1.1.p1.9.m3.1.5.4">ğ±</mi><mo id="A1.1.p1.9.m3.1.5.5">,</mo><msub id="A1.1.p1.9.m3.1.5.6"><mi id="A1.1.p1.9.m3.1.5.6.2">ğ²</mi><mrow id="A1.1.p1.9.m3.1.5.6.3"><mn id="A1.1.p1.9.m3.1.5.6.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A1.1.p1.9.m3.1.5.6.3.1">:</mo><mi id="A1.1.p1.9.m3.1.5.6.3.3">i</mi></mrow></msub><mo stretchy="false" id="A1.1.p1.9.m3.1.5.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.1.p1.9.m3.1c">-\mathbf{y}_{i+1}\sim\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:i})</annotation></semantics></math>, and labeled according to EquationÂ <a href="#A1.E8" title="In Proof. â€£ Appendix A Proof of Theorem 6.1 â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> applied on advantage estimates, then we obtain the desired equivalence result.
âˆ</p>
</div>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Theory: Why Does Negative Data Improve Generalization?</h3>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.3" class="ltx_p">We saw in SectionÂ <a href="#S6.SS3" title="6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3</span></a> that collecting negative data from an appropriate SFT policy <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.p1.1.m1.1a"><msub id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">ğœ‹</ci><ci id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> and an appropriate <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.p1.2.m2.1a"><mi id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">K</annotation></semantics></math>, and training on this data improves generalization performance of the resulting model. In this section, building on the equivalence to advantage-weighted RL (TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>), we attempt to formalize this observation into a performance guarantee. In particular, we show below that training on negative data implies that we are able to improve over the SFT policy, especially via the detection of critical steps, that attain high advantages, <math id="A2.p1.3.m3.3" class="ltx_Math" alttext="A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})" display="inline"><semantics id="A2.p1.3.m3.3a"><mrow id="A2.p1.3.m3.3.3" xref="A2.p1.3.m3.3.3.cmml"><msub id="A2.p1.3.m3.3.3.4" xref="A2.p1.3.m3.3.3.4.cmml"><mi id="A2.p1.3.m3.3.3.4.2" xref="A2.p1.3.m3.3.3.4.2.cmml">A</mi><mover accent="true" id="A2.p1.3.m3.3.3.4.3" xref="A2.p1.3.m3.3.3.4.3.cmml"><mi id="A2.p1.3.m3.3.3.4.3.2" xref="A2.p1.3.m3.3.3.4.3.2.cmml">Ï€</mi><mo id="A2.p1.3.m3.3.3.4.3.1" xref="A2.p1.3.m3.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.3.3.3" xref="A2.p1.3.m3.3.3.3.cmml">â€‹</mo><mrow id="A2.p1.3.m3.3.3.2.2" xref="A2.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="A2.p1.3.m3.3.3.2.2.3" xref="A2.p1.3.m3.3.3.2.3.cmml">(</mo><mi id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">ğ±</mi><mo id="A2.p1.3.m3.3.3.2.2.4" xref="A2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="A2.p1.3.m3.2.2.1.1.1" xref="A2.p1.3.m3.2.2.1.1.1.cmml"><mi id="A2.p1.3.m3.2.2.1.1.1.2" xref="A2.p1.3.m3.2.2.1.1.1.2.cmml">ğ²</mi><mrow id="A2.p1.3.m3.2.2.1.1.1.3" xref="A2.p1.3.m3.2.2.1.1.1.3.cmml"><mn id="A2.p1.3.m3.2.2.1.1.1.3.2" xref="A2.p1.3.m3.2.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.p1.3.m3.2.2.1.1.1.3.1" xref="A2.p1.3.m3.2.2.1.1.1.3.1.cmml">:</mo><mrow id="A2.p1.3.m3.2.2.1.1.1.3.3" xref="A2.p1.3.m3.2.2.1.1.1.3.3.cmml"><mi id="A2.p1.3.m3.2.2.1.1.1.3.3.2" xref="A2.p1.3.m3.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="A2.p1.3.m3.2.2.1.1.1.3.3.1" xref="A2.p1.3.m3.2.2.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="A2.p1.3.m3.2.2.1.1.1.3.3.3" xref="A2.p1.3.m3.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A2.p1.3.m3.3.3.2.2.5" xref="A2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="A2.p1.3.m3.3.3.2.2.2" xref="A2.p1.3.m3.3.3.2.2.2.cmml"><mi id="A2.p1.3.m3.3.3.2.2.2.2" xref="A2.p1.3.m3.3.3.2.2.2.2.cmml">ğ²</mi><mi id="A2.p1.3.m3.3.3.2.2.2.3" xref="A2.p1.3.m3.3.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A2.p1.3.m3.3.3.2.2.6" xref="A2.p1.3.m3.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.3b"><apply id="A2.p1.3.m3.3.3.cmml" xref="A2.p1.3.m3.3.3"><times id="A2.p1.3.m3.3.3.3.cmml" xref="A2.p1.3.m3.3.3.3"></times><apply id="A2.p1.3.m3.3.3.4.cmml" xref="A2.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="A2.p1.3.m3.3.3.4.1.cmml" xref="A2.p1.3.m3.3.3.4">subscript</csymbol><ci id="A2.p1.3.m3.3.3.4.2.cmml" xref="A2.p1.3.m3.3.3.4.2">ğ´</ci><apply id="A2.p1.3.m3.3.3.4.3.cmml" xref="A2.p1.3.m3.3.3.4.3"><ci id="A2.p1.3.m3.3.3.4.3.1.cmml" xref="A2.p1.3.m3.3.3.4.3.1">~</ci><ci id="A2.p1.3.m3.3.3.4.3.2.cmml" xref="A2.p1.3.m3.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="A2.p1.3.m3.3.3.2.3.cmml" xref="A2.p1.3.m3.3.3.2.2"><ci id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">ğ±</ci><apply id="A2.p1.3.m3.2.2.1.1.1.cmml" xref="A2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.p1.3.m3.2.2.1.1.1.1.cmml" xref="A2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="A2.p1.3.m3.2.2.1.1.1.2.cmml" xref="A2.p1.3.m3.2.2.1.1.1.2">ğ²</ci><apply id="A2.p1.3.m3.2.2.1.1.1.3.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3"><ci id="A2.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.1">:</ci><cn type="integer" id="A2.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.2">0</cn><apply id="A2.p1.3.m3.2.2.1.1.1.3.3.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.3"><minus id="A2.p1.3.m3.2.2.1.1.1.3.3.1.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.3.1"></minus><ci id="A2.p1.3.m3.2.2.1.1.1.3.3.2.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A2.p1.3.m3.2.2.1.1.1.3.3.3.cmml" xref="A2.p1.3.m3.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A2.p1.3.m3.3.3.2.2.2.cmml" xref="A2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.p1.3.m3.3.3.2.2.2.1.cmml" xref="A2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="A2.p1.3.m3.3.3.2.2.2.2.cmml" xref="A2.p1.3.m3.3.3.2.2.2.2">ğ²</ci><ci id="A2.p1.3.m3.3.3.2.2.2.3.cmml" xref="A2.p1.3.m3.3.3.2.2.2.3">ğ‘–</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.3c">A_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})</annotation></semantics></math>, that are otherwise not prioritized by training on positive data alone. Our theoretical result extends guarantees from the RL literatureÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> comparing RL with imitation learning to show that indeed the use of RL (and hence negative data) improves over imitation alone.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.2" class="ltx_p"><span id="A2.p2.2.1" class="ltx_text ltx_font_bold">Notation and setup.</span> Define the policy obtained after advantage-weighted RL training as <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.p2.1.m1.1a"><msub id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml">Ï€</mi><mtext id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1">subscript</csymbol><ci id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">ğœ‹</ci><ci id="A2.p2.1.m1.1.1.3a.cmml" xref="A2.p2.1.m1.1.1.3"><mtext mathsize="70%" id="A2.p2.1.m1.1.1.3.cmml" xref="A2.p2.1.m1.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\pi_{\text{neg}}</annotation></semantics></math>. Concretely, <math id="A2.p2.2.m2.1" class="ltx_Math" alttext="\pi_{\text{neg}}(\mathbf{y}|\mathbf{x})" display="inline"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><msub id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml"><mi id="A2.p2.2.m2.1.1.3.2" xref="A2.p2.2.m2.1.1.3.2.cmml">Ï€</mi><mtext id="A2.p2.2.m2.1.1.3.3" xref="A2.p2.2.m2.1.1.3.3a.cmml">neg</mtext></msub><mo lspace="0em" rspace="0em" id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml">â€‹</mo><mrow id="A2.p2.2.m2.1.1.1.1" xref="A2.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.p2.2.m2.1.1.1.1.2" xref="A2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A2.p2.2.m2.1.1.1.1.1" xref="A2.p2.2.m2.1.1.1.1.1.cmml"><mi id="A2.p2.2.m2.1.1.1.1.1.2" xref="A2.p2.2.m2.1.1.1.1.1.2.cmml">ğ²</mi><mo fence="false" id="A2.p2.2.m2.1.1.1.1.1.1" xref="A2.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A2.p2.2.m2.1.1.1.1.1.3" xref="A2.p2.2.m2.1.1.1.1.1.3.cmml">ğ±</mi></mrow><mo stretchy="false" id="A2.p2.2.m2.1.1.1.1.3" xref="A2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><times id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2"></times><apply id="A2.p2.2.m2.1.1.3.cmml" xref="A2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.p2.2.m2.1.1.3.1.cmml" xref="A2.p2.2.m2.1.1.3">subscript</csymbol><ci id="A2.p2.2.m2.1.1.3.2.cmml" xref="A2.p2.2.m2.1.1.3.2">ğœ‹</ci><ci id="A2.p2.2.m2.1.1.3.3a.cmml" xref="A2.p2.2.m2.1.1.3.3"><mtext mathsize="70%" id="A2.p2.2.m2.1.1.3.3.cmml" xref="A2.p2.2.m2.1.1.3.3">neg</mtext></ci></apply><apply id="A2.p2.2.m2.1.1.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="A2.p2.2.m2.1.1.1.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="A2.p2.2.m2.1.1.1.1.1.2.cmml" xref="A2.p2.2.m2.1.1.1.1.1.2">ğ²</ci><ci id="A2.p2.2.m2.1.1.1.1.1.3.cmml" xref="A2.p2.2.m2.1.1.1.1.1.3">ğ±</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\pi_{\text{neg}}(\mathbf{y}|\mathbf{x})</annotation></semantics></math> is given as:</p>
<table id="A7.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E10.m1.9" class="ltx_Math" alttext="\displaystyle\!\!\!\!\!\!\!\!\!\!\forall\mathbf{x},\mathbf{y}_{0:j+1},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi_{\text{neg}}(\mathbf{y}_{j+1}|\mathbf{x},\mathbf{y}_{0:j})=\frac{1}{\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})}\pi_{\mathrm{sft}}(\mathbf{y}_{j+1}|\mathbf{x},\mathbf{y}_{0:j})\cdot\exp\left(\frac{\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:j},\mathbf{y}_{j+1})}{\beta}\right)," display="inline"><semantics id="A2.E10.m1.9a"><mrow id="A2.E10.m1.9.9.1" xref="A2.E10.m1.9.9.1.1.cmml"><mrow id="A2.E10.m1.9.9.1.1" xref="A2.E10.m1.9.9.1.1.cmml"><mrow id="A2.E10.m1.9.9.1.1.3.3" xref="A2.E10.m1.9.9.1.1.3.4.cmml"><mrow id="A2.E10.m1.9.9.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.1.1.1.cmml"><mo rspace="0.167em" id="A2.E10.m1.9.9.1.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.1.1.1.1.cmml">âˆ€</mo><mi id="A2.E10.m1.9.9.1.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.1.1.1.2.cmml">ğ±</mi></mrow><mo id="A2.E10.m1.9.9.1.1.3.3.4" xref="A2.E10.m1.9.9.1.1.3.4.cmml">,</mo><msub id="A2.E10.m1.9.9.1.1.2.2.2" xref="A2.E10.m1.9.9.1.1.2.2.2.cmml"><mi id="A2.E10.m1.9.9.1.1.2.2.2.2" xref="A2.E10.m1.9.9.1.1.2.2.2.2.cmml">ğ²</mi><mrow id="A2.E10.m1.9.9.1.1.2.2.2.3" xref="A2.E10.m1.9.9.1.1.2.2.2.3.cmml"><mn id="A2.E10.m1.9.9.1.1.2.2.2.3.2" xref="A2.E10.m1.9.9.1.1.2.2.2.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.E10.m1.9.9.1.1.2.2.2.3.1" xref="A2.E10.m1.9.9.1.1.2.2.2.3.1.cmml">:</mo><mrow id="A2.E10.m1.9.9.1.1.2.2.2.3.3" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.cmml"><mi id="A2.E10.m1.9.9.1.1.2.2.2.3.3.2" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.2.cmml">j</mi><mo id="A2.E10.m1.9.9.1.1.2.2.2.3.3.1" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.1.cmml">+</mo><mn id="A2.E10.m1.9.9.1.1.2.2.2.3.3.3" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo rspace="1.167em" id="A2.E10.m1.9.9.1.1.3.3.5" xref="A2.E10.m1.9.9.1.1.3.4.cmml">,</mo><mrow id="A2.E10.m1.9.9.1.1.3.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.cmml"><msub id="A2.E10.m1.9.9.1.1.3.3.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.3.cmml"><mi id="A2.E10.m1.9.9.1.1.3.3.3.3.2" xref="A2.E10.m1.9.9.1.1.3.3.3.3.2.cmml">Ï€</mi><mtext id="A2.E10.m1.9.9.1.1.3.3.3.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.3.3a.cmml">neg</mtext></msub><mo lspace="0em" rspace="0em" id="A2.E10.m1.9.9.1.1.3.3.3.2" xref="A2.E10.m1.9.9.1.1.3.3.3.2.cmml">â€‹</mo><mrow id="A2.E10.m1.9.9.1.1.3.3.3.1.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.cmml">(</mo><mrow id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.cmml"><msub id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.cmml"><mi id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.2.cmml">ğ²</mi><mrow id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.cmml"><mi id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.2.cmml">j</mi><mo id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.1.cmml">+</mo><mn id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.2.cmml">|</mo><mrow id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.2.cmml"><mi id="A2.E10.m1.6.6" xref="A2.E10.m1.6.6.cmml">ğ±</mi><mo id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.2.cmml">,</mo><msub id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.cmml"><mi id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.cmml"><mn id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.2" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.1" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.3" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E10.m1.9.9.1.1.5" xref="A2.E10.m1.9.9.1.1.5.cmml">=</mo><mrow id="A2.E10.m1.9.9.1.1.4" xref="A2.E10.m1.9.9.1.1.4.cmml"><mrow id="A2.E10.m1.9.9.1.1.4.1" xref="A2.E10.m1.9.9.1.1.4.1.cmml"><mstyle displaystyle="true" id="A2.E10.m1.2.2" xref="A2.E10.m1.2.2.cmml"><mfrac id="A2.E10.m1.2.2a" xref="A2.E10.m1.2.2.cmml"><mn id="A2.E10.m1.2.2.4" xref="A2.E10.m1.2.2.4.cmml">1</mn><mrow id="A2.E10.m1.2.2.2" xref="A2.E10.m1.2.2.2.cmml"><mover accent="true" id="A2.E10.m1.2.2.2.4" xref="A2.E10.m1.2.2.2.4.cmml"><mi id="A2.E10.m1.2.2.2.4.2" xref="A2.E10.m1.2.2.2.4.2.cmml">â„¤</mi><mo id="A2.E10.m1.2.2.2.4.1" xref="A2.E10.m1.2.2.2.4.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.E10.m1.2.2.2.3" xref="A2.E10.m1.2.2.2.3.cmml">â€‹</mo><mrow id="A2.E10.m1.2.2.2.2.1" xref="A2.E10.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="A2.E10.m1.2.2.2.2.1.2" xref="A2.E10.m1.2.2.2.2.2.cmml">(</mo><mi id="A2.E10.m1.1.1.1.1" xref="A2.E10.m1.1.1.1.1.cmml">ğ±</mi><mo id="A2.E10.m1.2.2.2.2.1.3" xref="A2.E10.m1.2.2.2.2.2.cmml">,</mo><msub id="A2.E10.m1.2.2.2.2.1.1" xref="A2.E10.m1.2.2.2.2.1.1.cmml"><mi id="A2.E10.m1.2.2.2.2.1.1.2" xref="A2.E10.m1.2.2.2.2.1.1.2.cmml">ğ²</mi><mrow id="A2.E10.m1.2.2.2.2.1.1.3" xref="A2.E10.m1.2.2.2.2.1.1.3.cmml"><mn id="A2.E10.m1.2.2.2.2.1.1.3.2" xref="A2.E10.m1.2.2.2.2.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.E10.m1.2.2.2.2.1.1.3.1" xref="A2.E10.m1.2.2.2.2.1.1.3.1.cmml">:</mo><mi id="A2.E10.m1.2.2.2.2.1.1.3.3" xref="A2.E10.m1.2.2.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="A2.E10.m1.2.2.2.2.1.4" xref="A2.E10.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A2.E10.m1.9.9.1.1.4.1.2" xref="A2.E10.m1.9.9.1.1.4.1.2.cmml">â€‹</mo><msub id="A2.E10.m1.9.9.1.1.4.1.3" xref="A2.E10.m1.9.9.1.1.4.1.3.cmml"><mi id="A2.E10.m1.9.9.1.1.4.1.3.2" xref="A2.E10.m1.9.9.1.1.4.1.3.2.cmml">Ï€</mi><mi id="A2.E10.m1.9.9.1.1.4.1.3.3" xref="A2.E10.m1.9.9.1.1.4.1.3.3.cmml">sft</mi></msub><mo lspace="0em" rspace="0em" id="A2.E10.m1.9.9.1.1.4.1.2a" xref="A2.E10.m1.9.9.1.1.4.1.2.cmml">â€‹</mo><mrow id="A2.E10.m1.9.9.1.1.4.1.1.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.cmml"><mo stretchy="false" id="A2.E10.m1.9.9.1.1.4.1.1.1.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.cmml">(</mo><mrow id="A2.E10.m1.9.9.1.1.4.1.1.1.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.cmml"><msub id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.cmml"><mi id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.2.cmml">ğ²</mi><mrow id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.cmml"><mi id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.2.cmml">j</mi><mo id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.1.cmml">+</mo><mn id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.2.cmml">|</mo><mrow id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.2.cmml"><mi id="A2.E10.m1.7.7" xref="A2.E10.m1.7.7.cmml">ğ±</mi><mo id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.2.cmml">,</mo><msub id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.cmml"><mi id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.2.cmml">ğ²</mi><mrow id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.cmml"><mn id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.2" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.1" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="A2.E10.m1.9.9.1.1.4.1.1.1.3" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A2.E10.m1.9.9.1.1.4.2" xref="A2.E10.m1.9.9.1.1.4.2.cmml">â‹…</mo><mrow id="A2.E10.m1.9.9.1.1.4.3.2" xref="A2.E10.m1.9.9.1.1.4.3.1.cmml"><mi id="A2.E10.m1.8.8" xref="A2.E10.m1.8.8.cmml">exp</mi><mo id="A2.E10.m1.9.9.1.1.4.3.2a" xref="A2.E10.m1.9.9.1.1.4.3.1.cmml">â¡</mo><mrow id="A2.E10.m1.9.9.1.1.4.3.2.1" xref="A2.E10.m1.9.9.1.1.4.3.1.cmml"><mo id="A2.E10.m1.9.9.1.1.4.3.2.1.1" xref="A2.E10.m1.9.9.1.1.4.3.1.cmml">(</mo><mstyle displaystyle="true" id="A2.E10.m1.5.5" xref="A2.E10.m1.5.5.cmml"><mfrac id="A2.E10.m1.5.5a" xref="A2.E10.m1.5.5.cmml"><mrow id="A2.E10.m1.5.5.3" xref="A2.E10.m1.5.5.3.cmml"><msub id="A2.E10.m1.5.5.3.5" xref="A2.E10.m1.5.5.3.5.cmml"><mover accent="true" id="A2.E10.m1.5.5.3.5.2" xref="A2.E10.m1.5.5.3.5.2.cmml"><mi id="A2.E10.m1.5.5.3.5.2.2" xref="A2.E10.m1.5.5.3.5.2.2.cmml">A</mi><mo id="A2.E10.m1.5.5.3.5.2.1" xref="A2.E10.m1.5.5.3.5.2.1.cmml">^</mo></mover><mover accent="true" id="A2.E10.m1.5.5.3.5.3" xref="A2.E10.m1.5.5.3.5.3.cmml"><mi id="A2.E10.m1.5.5.3.5.3.2" xref="A2.E10.m1.5.5.3.5.3.2.cmml">Ï€</mi><mo id="A2.E10.m1.5.5.3.5.3.1" xref="A2.E10.m1.5.5.3.5.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.E10.m1.5.5.3.4" xref="A2.E10.m1.5.5.3.4.cmml">â€‹</mo><mrow id="A2.E10.m1.5.5.3.3.2" xref="A2.E10.m1.5.5.3.3.3.cmml"><mo stretchy="false" id="A2.E10.m1.5.5.3.3.2.3" xref="A2.E10.m1.5.5.3.3.3.cmml">(</mo><mi id="A2.E10.m1.3.3.1.1" xref="A2.E10.m1.3.3.1.1.cmml">ğ±</mi><mo id="A2.E10.m1.5.5.3.3.2.4" xref="A2.E10.m1.5.5.3.3.3.cmml">,</mo><msub id="A2.E10.m1.4.4.2.2.1.1" xref="A2.E10.m1.4.4.2.2.1.1.cmml"><mi id="A2.E10.m1.4.4.2.2.1.1.2" xref="A2.E10.m1.4.4.2.2.1.1.2.cmml">ğ²</mi><mrow id="A2.E10.m1.4.4.2.2.1.1.3" xref="A2.E10.m1.4.4.2.2.1.1.3.cmml"><mn id="A2.E10.m1.4.4.2.2.1.1.3.2" xref="A2.E10.m1.4.4.2.2.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.E10.m1.4.4.2.2.1.1.3.1" xref="A2.E10.m1.4.4.2.2.1.1.3.1.cmml">:</mo><mi id="A2.E10.m1.4.4.2.2.1.1.3.3" xref="A2.E10.m1.4.4.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo id="A2.E10.m1.5.5.3.3.2.5" xref="A2.E10.m1.5.5.3.3.3.cmml">,</mo><msub id="A2.E10.m1.5.5.3.3.2.2" xref="A2.E10.m1.5.5.3.3.2.2.cmml"><mi id="A2.E10.m1.5.5.3.3.2.2.2" xref="A2.E10.m1.5.5.3.3.2.2.2.cmml">ğ²</mi><mrow id="A2.E10.m1.5.5.3.3.2.2.3" xref="A2.E10.m1.5.5.3.3.2.2.3.cmml"><mi id="A2.E10.m1.5.5.3.3.2.2.3.2" xref="A2.E10.m1.5.5.3.3.2.2.3.2.cmml">j</mi><mo id="A2.E10.m1.5.5.3.3.2.2.3.1" xref="A2.E10.m1.5.5.3.3.2.2.3.1.cmml">+</mo><mn id="A2.E10.m1.5.5.3.3.2.2.3.3" xref="A2.E10.m1.5.5.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="A2.E10.m1.5.5.3.3.2.6" xref="A2.E10.m1.5.5.3.3.3.cmml">)</mo></mrow></mrow><mi id="A2.E10.m1.5.5.5" xref="A2.E10.m1.5.5.5.cmml">Î²</mi></mfrac></mstyle><mo id="A2.E10.m1.9.9.1.1.4.3.2.1.2" xref="A2.E10.m1.9.9.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A2.E10.m1.9.9.1.2" xref="A2.E10.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E10.m1.9b"><apply id="A2.E10.m1.9.9.1.1.cmml" xref="A2.E10.m1.9.9.1"><eq id="A2.E10.m1.9.9.1.1.5.cmml" xref="A2.E10.m1.9.9.1.1.5"></eq><list id="A2.E10.m1.9.9.1.1.3.4.cmml" xref="A2.E10.m1.9.9.1.1.3.3"><apply id="A2.E10.m1.9.9.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="A2.E10.m1.9.9.1.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.1.1.1.1">for-all</csymbol><ci id="A2.E10.m1.9.9.1.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.1.1.1.2">ğ±</ci></apply><apply id="A2.E10.m1.9.9.1.1.2.2.2.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.2.2.2.1.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.2.2.2.2.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.2">ğ²</ci><apply id="A2.E10.m1.9.9.1.1.2.2.2.3.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3"><ci id="A2.E10.m1.9.9.1.1.2.2.2.3.1.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.1">:</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.2.2.2.3.2.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.2">0</cn><apply id="A2.E10.m1.9.9.1.1.2.2.2.3.3.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3"><plus id="A2.E10.m1.9.9.1.1.2.2.2.3.3.1.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.1"></plus><ci id="A2.E10.m1.9.9.1.1.2.2.2.3.3.2.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.2">ğ‘—</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.2.2.2.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="A2.E10.m1.9.9.1.1.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3"><times id="A2.E10.m1.9.9.1.1.3.3.3.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.2"></times><apply id="A2.E10.m1.9.9.1.1.3.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.3.3.3.3.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.3">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.3.3.3.3.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.3.2">ğœ‹</ci><ci id="A2.E10.m1.9.9.1.1.3.3.3.3.3a.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.3.3"><mtext mathsize="70%" id="A2.E10.m1.9.9.1.1.3.3.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.3.3">neg</mtext></ci></apply><apply id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1"><csymbol cd="latexml" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.2">conditional</csymbol><apply id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.2">ğ²</ci><apply id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3"><plus id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.1"></plus><ci id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.2">ğ‘—</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.3.3.3">1</cn></apply></apply><list id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1"><ci id="A2.E10.m1.6.6.cmml" xref="A2.E10.m1.6.6">ğ±</ci><apply id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.2">ğ²</ci><apply id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3"><ci id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.2">0</cn><ci id="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="A2.E10.m1.9.9.1.1.3.3.3.1.1.1.1.1.1.3.3">ğ‘—</ci></apply></apply></list></apply></apply></list><apply id="A2.E10.m1.9.9.1.1.4.cmml" xref="A2.E10.m1.9.9.1.1.4"><ci id="A2.E10.m1.9.9.1.1.4.2.cmml" xref="A2.E10.m1.9.9.1.1.4.2">â‹…</ci><apply id="A2.E10.m1.9.9.1.1.4.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1"><times id="A2.E10.m1.9.9.1.1.4.1.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.2"></times><apply id="A2.E10.m1.2.2.cmml" xref="A2.E10.m1.2.2"><divide id="A2.E10.m1.2.2.3.cmml" xref="A2.E10.m1.2.2"></divide><cn type="integer" id="A2.E10.m1.2.2.4.cmml" xref="A2.E10.m1.2.2.4">1</cn><apply id="A2.E10.m1.2.2.2.cmml" xref="A2.E10.m1.2.2.2"><times id="A2.E10.m1.2.2.2.3.cmml" xref="A2.E10.m1.2.2.2.3"></times><apply id="A2.E10.m1.2.2.2.4.cmml" xref="A2.E10.m1.2.2.2.4"><ci id="A2.E10.m1.2.2.2.4.1.cmml" xref="A2.E10.m1.2.2.2.4.1">^</ci><ci id="A2.E10.m1.2.2.2.4.2.cmml" xref="A2.E10.m1.2.2.2.4.2">â„¤</ci></apply><interval closure="open" id="A2.E10.m1.2.2.2.2.2.cmml" xref="A2.E10.m1.2.2.2.2.1"><ci id="A2.E10.m1.1.1.1.1.cmml" xref="A2.E10.m1.1.1.1.1">ğ±</ci><apply id="A2.E10.m1.2.2.2.2.1.1.cmml" xref="A2.E10.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E10.m1.2.2.2.2.1.1.1.cmml" xref="A2.E10.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A2.E10.m1.2.2.2.2.1.1.2.cmml" xref="A2.E10.m1.2.2.2.2.1.1.2">ğ²</ci><apply id="A2.E10.m1.2.2.2.2.1.1.3.cmml" xref="A2.E10.m1.2.2.2.2.1.1.3"><ci id="A2.E10.m1.2.2.2.2.1.1.3.1.cmml" xref="A2.E10.m1.2.2.2.2.1.1.3.1">:</ci><cn type="integer" id="A2.E10.m1.2.2.2.2.1.1.3.2.cmml" xref="A2.E10.m1.2.2.2.2.1.1.3.2">0</cn><ci id="A2.E10.m1.2.2.2.2.1.1.3.3.cmml" xref="A2.E10.m1.2.2.2.2.1.1.3.3">ğ‘—</ci></apply></apply></interval></apply></apply><apply id="A2.E10.m1.9.9.1.1.4.1.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.3"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.4.1.3.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.3">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.4.1.3.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.3.2">ğœ‹</ci><ci id="A2.E10.m1.9.9.1.1.4.1.3.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.3.3">sft</ci></apply><apply id="A2.E10.m1.9.9.1.1.4.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1"><csymbol cd="latexml" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.2">conditional</csymbol><apply id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.2">ğ²</ci><apply id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3"><plus id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.1"></plus><ci id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.2">ğ‘—</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.3.3.3">1</cn></apply></apply><list id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1"><ci id="A2.E10.m1.7.7.cmml" xref="A2.E10.m1.7.7">ğ±</ci><apply id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.2">ğ²</ci><apply id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3"><ci id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.2">0</cn><ci id="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E10.m1.9.9.1.1.4.1.1.1.1.1.1.1.3.3">ğ‘—</ci></apply></apply></list></apply></apply><apply id="A2.E10.m1.9.9.1.1.4.3.1.cmml" xref="A2.E10.m1.9.9.1.1.4.3.2"><exp id="A2.E10.m1.8.8.cmml" xref="A2.E10.m1.8.8"></exp><apply id="A2.E10.m1.5.5.cmml" xref="A2.E10.m1.5.5"><divide id="A2.E10.m1.5.5.4.cmml" xref="A2.E10.m1.5.5"></divide><apply id="A2.E10.m1.5.5.3.cmml" xref="A2.E10.m1.5.5.3"><times id="A2.E10.m1.5.5.3.4.cmml" xref="A2.E10.m1.5.5.3.4"></times><apply id="A2.E10.m1.5.5.3.5.cmml" xref="A2.E10.m1.5.5.3.5"><csymbol cd="ambiguous" id="A2.E10.m1.5.5.3.5.1.cmml" xref="A2.E10.m1.5.5.3.5">subscript</csymbol><apply id="A2.E10.m1.5.5.3.5.2.cmml" xref="A2.E10.m1.5.5.3.5.2"><ci id="A2.E10.m1.5.5.3.5.2.1.cmml" xref="A2.E10.m1.5.5.3.5.2.1">^</ci><ci id="A2.E10.m1.5.5.3.5.2.2.cmml" xref="A2.E10.m1.5.5.3.5.2.2">ğ´</ci></apply><apply id="A2.E10.m1.5.5.3.5.3.cmml" xref="A2.E10.m1.5.5.3.5.3"><ci id="A2.E10.m1.5.5.3.5.3.1.cmml" xref="A2.E10.m1.5.5.3.5.3.1">~</ci><ci id="A2.E10.m1.5.5.3.5.3.2.cmml" xref="A2.E10.m1.5.5.3.5.3.2">ğœ‹</ci></apply></apply><vector id="A2.E10.m1.5.5.3.3.3.cmml" xref="A2.E10.m1.5.5.3.3.2"><ci id="A2.E10.m1.3.3.1.1.cmml" xref="A2.E10.m1.3.3.1.1">ğ±</ci><apply id="A2.E10.m1.4.4.2.2.1.1.cmml" xref="A2.E10.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A2.E10.m1.4.4.2.2.1.1.1.cmml" xref="A2.E10.m1.4.4.2.2.1.1">subscript</csymbol><ci id="A2.E10.m1.4.4.2.2.1.1.2.cmml" xref="A2.E10.m1.4.4.2.2.1.1.2">ğ²</ci><apply id="A2.E10.m1.4.4.2.2.1.1.3.cmml" xref="A2.E10.m1.4.4.2.2.1.1.3"><ci id="A2.E10.m1.4.4.2.2.1.1.3.1.cmml" xref="A2.E10.m1.4.4.2.2.1.1.3.1">:</ci><cn type="integer" id="A2.E10.m1.4.4.2.2.1.1.3.2.cmml" xref="A2.E10.m1.4.4.2.2.1.1.3.2">0</cn><ci id="A2.E10.m1.4.4.2.2.1.1.3.3.cmml" xref="A2.E10.m1.4.4.2.2.1.1.3.3">ğ‘—</ci></apply></apply><apply id="A2.E10.m1.5.5.3.3.2.2.cmml" xref="A2.E10.m1.5.5.3.3.2.2"><csymbol cd="ambiguous" id="A2.E10.m1.5.5.3.3.2.2.1.cmml" xref="A2.E10.m1.5.5.3.3.2.2">subscript</csymbol><ci id="A2.E10.m1.5.5.3.3.2.2.2.cmml" xref="A2.E10.m1.5.5.3.3.2.2.2">ğ²</ci><apply id="A2.E10.m1.5.5.3.3.2.2.3.cmml" xref="A2.E10.m1.5.5.3.3.2.2.3"><plus id="A2.E10.m1.5.5.3.3.2.2.3.1.cmml" xref="A2.E10.m1.5.5.3.3.2.2.3.1"></plus><ci id="A2.E10.m1.5.5.3.3.2.2.3.2.cmml" xref="A2.E10.m1.5.5.3.3.2.2.3.2">ğ‘—</ci><cn type="integer" id="A2.E10.m1.5.5.3.3.2.2.3.3.cmml" xref="A2.E10.m1.5.5.3.3.2.2.3.3">1</cn></apply></apply></vector></apply><ci id="A2.E10.m1.5.5.5.cmml" xref="A2.E10.m1.5.5.5">ğ›½</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E10.m1.9c">\displaystyle\!\!\!\!\!\!\!\!\!\!\forall\mathbf{x},\mathbf{y}_{0:j+1},\leavevmode\nobreak\ \leavevmode\nobreak\ \pi_{\text{neg}}(\mathbf{y}_{j+1}|\mathbf{x},\mathbf{y}_{0:j})=\frac{1}{\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})}\pi_{\mathrm{sft}}(\mathbf{y}_{j+1}|\mathbf{x},\mathbf{y}_{0:j})\cdot\exp\left(\frac{\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:j},\mathbf{y}_{j+1})}{\beta}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="A2.p2.3" class="ltx_p">where the normalization factoris given by <math id="A2.p2.3.m1.2" class="ltx_Math" alttext="\mathbb{Z}(\mathbf{x},\mathbf{y}_{0:j})" display="inline"><semantics id="A2.p2.3.m1.2a"><mrow id="A2.p2.3.m1.2.2" xref="A2.p2.3.m1.2.2.cmml"><mi id="A2.p2.3.m1.2.2.3" xref="A2.p2.3.m1.2.2.3.cmml">â„¤</mi><mo lspace="0em" rspace="0em" id="A2.p2.3.m1.2.2.2" xref="A2.p2.3.m1.2.2.2.cmml">â€‹</mo><mrow id="A2.p2.3.m1.2.2.1.1" xref="A2.p2.3.m1.2.2.1.2.cmml"><mo stretchy="false" id="A2.p2.3.m1.2.2.1.1.2" xref="A2.p2.3.m1.2.2.1.2.cmml">(</mo><mi id="A2.p2.3.m1.1.1" xref="A2.p2.3.m1.1.1.cmml">ğ±</mi><mo id="A2.p2.3.m1.2.2.1.1.3" xref="A2.p2.3.m1.2.2.1.2.cmml">,</mo><msub id="A2.p2.3.m1.2.2.1.1.1" xref="A2.p2.3.m1.2.2.1.1.1.cmml"><mi id="A2.p2.3.m1.2.2.1.1.1.2" xref="A2.p2.3.m1.2.2.1.1.1.2.cmml">ğ²</mi><mrow id="A2.p2.3.m1.2.2.1.1.1.3" xref="A2.p2.3.m1.2.2.1.1.1.3.cmml"><mn id="A2.p2.3.m1.2.2.1.1.1.3.2" xref="A2.p2.3.m1.2.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.p2.3.m1.2.2.1.1.1.3.1" xref="A2.p2.3.m1.2.2.1.1.1.3.1.cmml">:</mo><mi id="A2.p2.3.m1.2.2.1.1.1.3.3" xref="A2.p2.3.m1.2.2.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="A2.p2.3.m1.2.2.1.1.4" xref="A2.p2.3.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m1.2b"><apply id="A2.p2.3.m1.2.2.cmml" xref="A2.p2.3.m1.2.2"><times id="A2.p2.3.m1.2.2.2.cmml" xref="A2.p2.3.m1.2.2.2"></times><ci id="A2.p2.3.m1.2.2.3.cmml" xref="A2.p2.3.m1.2.2.3">â„¤</ci><interval closure="open" id="A2.p2.3.m1.2.2.1.2.cmml" xref="A2.p2.3.m1.2.2.1.1"><ci id="A2.p2.3.m1.1.1.cmml" xref="A2.p2.3.m1.1.1">ğ±</ci><apply id="A2.p2.3.m1.2.2.1.1.1.cmml" xref="A2.p2.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.p2.3.m1.2.2.1.1.1.1.cmml" xref="A2.p2.3.m1.2.2.1.1.1">subscript</csymbol><ci id="A2.p2.3.m1.2.2.1.1.1.2.cmml" xref="A2.p2.3.m1.2.2.1.1.1.2">ğ²</ci><apply id="A2.p2.3.m1.2.2.1.1.1.3.cmml" xref="A2.p2.3.m1.2.2.1.1.1.3"><ci id="A2.p2.3.m1.2.2.1.1.1.3.1.cmml" xref="A2.p2.3.m1.2.2.1.1.1.3.1">:</ci><cn type="integer" id="A2.p2.3.m1.2.2.1.1.1.3.2.cmml" xref="A2.p2.3.m1.2.2.1.1.1.3.2">0</cn><ci id="A2.p2.3.m1.2.2.1.1.1.3.3.cmml" xref="A2.p2.3.m1.2.2.1.1.1.3.3">ğ‘—</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m1.2c">\mathbb{Z}(\mathbf{x},\mathbf{y}_{0:j})</annotation></semantics></math> for each of the per-step policy distributions. This normalization factor is a critical factor that will drive the core of the theoretical result. We also note that the normalization factor in EquationÂ <a href="#A2.E10" title="In Appendix B Theory: Why Does Negative Data Improve Generalization? â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> is derived from <em id="A2.p2.3.1" class="ltx_emph ltx_font_italic">empirical</em> advantage estimates and not from the expected estimates for the advantage value.
Following <cite class="ltx_cite ltx_citemacro_citet">Agarwal etÂ al. [<a href="#bib.bib2" title="" class="ltx_ref">2</a>], Kumar etÂ al. [<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, we operate in a tabular setting with a discrete (but combinatorially-large and variable-length) action space of responses, and our proof follows Theorem 4.4 in <cite class="ltx_cite ltx_citemacro_citet">Kumar etÂ al. [<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<div id="A2.Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="A2.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem B.1</span></span><span id="A2.Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(Utility of negative data over positive data.)<span id="A2.Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="A2.Thmtheorem1.p1" class="ltx_para">
<p id="A2.Thmtheorem1.p1.6" class="ltx_p"><span id="A2.Thmtheorem1.p1.6.6" class="ltx_text ltx_font_italic">Let <math id="A2.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.Thmtheorem1.p1.1.1.m1.1a"><msub id="A2.Thmtheorem1.p1.1.1.m1.1.1" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="A2.Thmtheorem1.p1.1.1.m1.1.1.2" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">Ï€</mi><mtext class="ltx_mathvariant_italic" id="A2.Thmtheorem1.p1.1.1.m1.1.1.3" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.1.1.m1.1b"><apply id="A2.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="A2.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="A2.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.2">ğœ‹</ci><ci id="A2.Thmtheorem1.p1.1.1.m1.1.1.3a.cmml" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A2.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="A2.Thmtheorem1.p1.1.1.m1.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.1.1.m1.1c">\pi_{\text{neg}}</annotation></semantics></math> denote the policy obtained after advantage-weighted RL (EquationÂ <a href="#A2.E10" title="In Appendix B Theory: Why Does Negative Data Improve Generalization? â€£ Appendices â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) under an empirical distribution <math id="A2.Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="\hat{\mu}" display="inline"><semantics id="A2.Thmtheorem1.p1.2.2.m2.1a"><mover accent="true" id="A2.Thmtheorem1.p1.2.2.m2.1.1" xref="A2.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="A2.Thmtheorem1.p1.2.2.m2.1.1.2" xref="A2.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">Î¼</mi><mo id="A2.Thmtheorem1.p1.2.2.m2.1.1.1" xref="A2.Thmtheorem1.p1.2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.2.2.m2.1b"><apply id="A2.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="A2.Thmtheorem1.p1.2.2.m2.1.1"><ci id="A2.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="A2.Thmtheorem1.p1.2.2.m2.1.1.1">^</ci><ci id="A2.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="A2.Thmtheorem1.p1.2.2.m2.1.1.2">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.2.2.m2.1c">\hat{\mu}</annotation></semantics></math> over prompts <math id="A2.Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="A2.Thmtheorem1.p1.3.3.m3.1a"><mi id="A2.Thmtheorem1.p1.3.3.m3.1.1" xref="A2.Thmtheorem1.p1.3.3.m3.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.3.3.m3.1b"><ci id="A2.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="A2.Thmtheorem1.p1.3.3.m3.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.3.3.m3.1c">\mathbf{x}</annotation></semantics></math>. Then the difference between the expected reward (i.e., task success rate), <math id="A2.Thmtheorem1.p1.4.4.m4.1" class="ltx_Math" alttext="J(\cdot)" display="inline"><semantics id="A2.Thmtheorem1.p1.4.4.m4.1a"><mrow id="A2.Thmtheorem1.p1.4.4.m4.1.2" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.cmml"><mi id="A2.Thmtheorem1.p1.4.4.m4.1.2.2" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.2.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Thmtheorem1.p1.4.4.m4.1.2.1" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.1.cmml">â€‹</mo><mrow id="A2.Thmtheorem1.p1.4.4.m4.1.2.3.2" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.cmml"><mo stretchy="false" id="A2.Thmtheorem1.p1.4.4.m4.1.2.3.2.1" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A2.Thmtheorem1.p1.4.4.m4.1.1" xref="A2.Thmtheorem1.p1.4.4.m4.1.1.cmml">â‹…</mo><mo stretchy="false" id="A2.Thmtheorem1.p1.4.4.m4.1.2.3.2.2" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.4.4.m4.1b"><apply id="A2.Thmtheorem1.p1.4.4.m4.1.2.cmml" xref="A2.Thmtheorem1.p1.4.4.m4.1.2"><times id="A2.Thmtheorem1.p1.4.4.m4.1.2.1.cmml" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.1"></times><ci id="A2.Thmtheorem1.p1.4.4.m4.1.2.2.cmml" xref="A2.Thmtheorem1.p1.4.4.m4.1.2.2">ğ½</ci><ci id="A2.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="A2.Thmtheorem1.p1.4.4.m4.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.4.4.m4.1c">J(\cdot)</annotation></semantics></math>, attained by <math id="A2.Thmtheorem1.p1.5.5.m5.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.Thmtheorem1.p1.5.5.m5.1a"><msub id="A2.Thmtheorem1.p1.5.5.m5.1.1" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="A2.Thmtheorem1.p1.5.5.m5.1.1.2" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">Ï€</mi><mtext class="ltx_mathvariant_italic" id="A2.Thmtheorem1.p1.5.5.m5.1.1.3" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.5.5.m5.1b"><apply id="A2.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="A2.Thmtheorem1.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.5.5.m5.1.1.1.cmml" xref="A2.Thmtheorem1.p1.5.5.m5.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.2">ğœ‹</ci><ci id="A2.Thmtheorem1.p1.5.5.m5.1.1.3a.cmml" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A2.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="A2.Thmtheorem1.p1.5.5.m5.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.5.5.m5.1c">\pi_{\text{neg}}</annotation></semantics></math> and <math id="A2.Thmtheorem1.p1.6.6.m6.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.Thmtheorem1.p1.6.6.m6.1a"><msub id="A2.Thmtheorem1.p1.6.6.m6.1.1" xref="A2.Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="A2.Thmtheorem1.p1.6.6.m6.1.1.2" xref="A2.Thmtheorem1.p1.6.6.m6.1.1.2.cmml">Ï€</mi><mi id="A2.Thmtheorem1.p1.6.6.m6.1.1.3" xref="A2.Thmtheorem1.p1.6.6.m6.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.6.6.m6.1b"><apply id="A2.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="A2.Thmtheorem1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="A2.Thmtheorem1.p1.6.6.m6.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="A2.Thmtheorem1.p1.6.6.m6.1.1.2">ğœ‹</ci><ci id="A2.Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="A2.Thmtheorem1.p1.6.6.m6.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.6.6.m6.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> is lower-bounded as:</span></p>
<table id="A7.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle J(\pi_{\text{neg}})-J(\pi_{\mathrm{sft}})\gtrsim" display="inline"><semantics id="A2.Ex1.m1.2a"><mrow id="A2.Ex1.m1.2.2" xref="A2.Ex1.m1.2.2.cmml"><mrow id="A2.Ex1.m1.2.2.2" xref="A2.Ex1.m1.2.2.2.cmml"><mrow id="A2.Ex1.m1.1.1.1.1" xref="A2.Ex1.m1.1.1.1.1.cmml"><mi id="A2.Ex1.m1.1.1.1.1.3" xref="A2.Ex1.m1.1.1.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex1.m1.1.1.1.1.2" xref="A2.Ex1.m1.1.1.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex1.m1.1.1.1.1.1.1" xref="A2.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex1.m1.1.1.1.1.1.1.2" xref="A2.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex1.m1.1.1.1.1.1.1.1" xref="A2.Ex1.m1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex1.m1.1.1.1.1.1.1.1.2" xref="A2.Ex1.m1.1.1.1.1.1.1.1.2.cmml">Ï€</mi><mtext class="ltx_mathvariant_italic" id="A2.Ex1.m1.1.1.1.1.1.1.1.3" xref="A2.Ex1.m1.1.1.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex1.m1.1.1.1.1.1.1.3" xref="A2.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex1.m1.2.2.2.3" xref="A2.Ex1.m1.2.2.2.3.cmml">âˆ’</mo><mrow id="A2.Ex1.m1.2.2.2.2" xref="A2.Ex1.m1.2.2.2.2.cmml"><mi id="A2.Ex1.m1.2.2.2.2.3" xref="A2.Ex1.m1.2.2.2.2.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex1.m1.2.2.2.2.2" xref="A2.Ex1.m1.2.2.2.2.2.cmml">â€‹</mo><mrow id="A2.Ex1.m1.2.2.2.2.1.1" xref="A2.Ex1.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex1.m1.2.2.2.2.1.1.2" xref="A2.Ex1.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="A2.Ex1.m1.2.2.2.2.1.1.1" xref="A2.Ex1.m1.2.2.2.2.1.1.1.cmml"><mi id="A2.Ex1.m1.2.2.2.2.1.1.1.2" xref="A2.Ex1.m1.2.2.2.2.1.1.1.2.cmml">Ï€</mi><mi id="A2.Ex1.m1.2.2.2.2.1.1.1.3" xref="A2.Ex1.m1.2.2.2.2.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A2.Ex1.m1.2.2.2.2.1.1.3" xref="A2.Ex1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex1.m1.2.2.3" xref="A2.Ex1.m1.2.2.3.cmml">â‰³</mo><mi id="A2.Ex1.m1.2.2.4" xref="A2.Ex1.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex1.m1.2b"><apply id="A2.Ex1.m1.2.2.cmml" xref="A2.Ex1.m1.2.2"><csymbol cd="latexml" id="A2.Ex1.m1.2.2.3.cmml" xref="A2.Ex1.m1.2.2.3">greater-than-or-equivalent-to</csymbol><apply id="A2.Ex1.m1.2.2.2.cmml" xref="A2.Ex1.m1.2.2.2"><minus id="A2.Ex1.m1.2.2.2.3.cmml" xref="A2.Ex1.m1.2.2.2.3"></minus><apply id="A2.Ex1.m1.1.1.1.1.cmml" xref="A2.Ex1.m1.1.1.1.1"><times id="A2.Ex1.m1.1.1.1.1.2.cmml" xref="A2.Ex1.m1.1.1.1.1.2"></times><ci id="A2.Ex1.m1.1.1.1.1.3.cmml" xref="A2.Ex1.m1.1.1.1.1.3">ğ½</ci><apply id="A2.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="A2.Ex1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex1.m1.1.1.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex1.m1.1.1.1.1.1.1.1.3a.cmml" xref="A2.Ex1.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A2.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex1.m1.1.1.1.1.1.1.1.3">neg</mtext></ci></apply></apply><apply id="A2.Ex1.m1.2.2.2.2.cmml" xref="A2.Ex1.m1.2.2.2.2"><times id="A2.Ex1.m1.2.2.2.2.2.cmml" xref="A2.Ex1.m1.2.2.2.2.2"></times><ci id="A2.Ex1.m1.2.2.2.2.3.cmml" xref="A2.Ex1.m1.2.2.2.2.3">ğ½</ci><apply id="A2.Ex1.m1.2.2.2.2.1.1.1.cmml" xref="A2.Ex1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex1.m1.2.2.2.2.1.1.1.1.cmml" xref="A2.Ex1.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A2.Ex1.m1.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex1.m1.2.2.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.Ex1.m1.2.2.2.2.1.1.1.3.cmml" xref="A2.Ex1.m1.2.2.2.2.1.1.1.3">sft</ci></apply></apply></apply><csymbol cd="latexml" id="A2.Ex1.m1.2.2.4.cmml" xref="A2.Ex1.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex1.m1.2c">\displaystyle J(\pi_{\text{neg}})-J(\pi_{\mathrm{sft}})\gtrsim</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex1.m2.5" class="ltx_math_unparsed" alttext="\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \beta\cdot\mathbb{E}_{\mathbf{x}_{i}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x}_{i})}\left[\sum_{j=1}^{L}\log\mathbb{Z}(\mathbf{x}_{i},\mathbf{y}_{i,0:j})\right]" display="inline"><semantics id="A2.Ex1.m2.5a"><mrow id="A2.Ex1.m2.5.5"><mrow id="A2.Ex1.m2.5.5.3"><mi id="A2.Ex1.m2.5.5.3.2">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex1.m2.5.5.3.1">â‹…</mo><msub id="A2.Ex1.m2.5.5.3.3"><mi id="A2.Ex1.m2.5.5.3.3.2">ğ”¼</mi><mrow id="A2.Ex1.m2.2.2.2"><msub id="A2.Ex1.m2.2.2.2.3"><mi id="A2.Ex1.m2.2.2.2.3.2">ğ±</mi><mi id="A2.Ex1.m2.2.2.2.3.3">i</mi></msub><mo id="A2.Ex1.m2.2.2.2.4">âˆ¼</mo><mover accent="true" id="A2.Ex1.m2.2.2.2.5"><mi id="A2.Ex1.m2.2.2.2.5.2">Î¼</mi><mo id="A2.Ex1.m2.2.2.2.5.1">^</mo></mover><mo id="A2.Ex1.m2.2.2.2.6">,</mo><msub id="A2.Ex1.m2.2.2.2.7"><mi id="A2.Ex1.m2.2.2.2.7.2">ğ²</mi><mrow id="A2.Ex1.m2.2.2.2.2.2"><mrow id="A2.Ex1.m2.2.2.2.2.2.4.2"><mi id="A2.Ex1.m2.1.1.1.1.1.1">i</mi><mo id="A2.Ex1.m2.2.2.2.2.2.4.2.1">,</mo><mn id="A2.Ex1.m2.2.2.2.2.2.2">0</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="A2.Ex1.m2.2.2.2.2.2.3">:</mo><mi id="A2.Ex1.m2.2.2.2.2.2.5">L</mi></mrow></msub><mo id="A2.Ex1.m2.2.2.2.8">âˆ¼</mo><msub id="A2.Ex1.m2.2.2.2.9"><mi id="A2.Ex1.m2.2.2.2.9.2">Ï€</mi><mtext class="ltx_mathvariant_italic" id="A2.Ex1.m2.2.2.2.9.3">neg</mtext></msub><mrow id="A2.Ex1.m2.2.2.2.10"><mo stretchy="false" id="A2.Ex1.m2.2.2.2.10.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex1.m2.2.2.2.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex1.m2.2.2.2.10.3">|</mo><msub id="A2.Ex1.m2.2.2.2.10.4"><mi id="A2.Ex1.m2.2.2.2.10.4.2">ğ±</mi><mi id="A2.Ex1.m2.2.2.2.10.4.3">i</mi></msub><mo stretchy="false" id="A2.Ex1.m2.2.2.2.10.5">)</mo></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A2.Ex1.m2.5.5.2">â€‹</mo><mrow id="A2.Ex1.m2.5.5.1.1"><mo id="A2.Ex1.m2.5.5.1.1.2">[</mo><mrow id="A2.Ex1.m2.5.5.1.1.1"><mstyle displaystyle="true" id="A2.Ex1.m2.5.5.1.1.1.3"><munderover id="A2.Ex1.m2.5.5.1.1.1.3a"><mo movablelimits="false" id="A2.Ex1.m2.5.5.1.1.1.3.2.2">âˆ‘</mo><mrow id="A2.Ex1.m2.5.5.1.1.1.3.2.3"><mi id="A2.Ex1.m2.5.5.1.1.1.3.2.3.2">j</mi><mo id="A2.Ex1.m2.5.5.1.1.1.3.2.3.1">=</mo><mn id="A2.Ex1.m2.5.5.1.1.1.3.2.3.3">1</mn></mrow><mi id="A2.Ex1.m2.5.5.1.1.1.3.3">L</mi></munderover></mstyle><mrow id="A2.Ex1.m2.5.5.1.1.1.2"><mrow id="A2.Ex1.m2.5.5.1.1.1.2.4"><mi id="A2.Ex1.m2.5.5.1.1.1.2.4.1">log</mi><mo lspace="0.167em" id="A2.Ex1.m2.5.5.1.1.1.2.4a">â¡</mo><mi id="A2.Ex1.m2.5.5.1.1.1.2.4.2">â„¤</mi></mrow><mo lspace="0em" rspace="0em" id="A2.Ex1.m2.5.5.1.1.1.2.3">â€‹</mo><mrow id="A2.Ex1.m2.5.5.1.1.1.2.2.2"><mo stretchy="false" id="A2.Ex1.m2.5.5.1.1.1.2.2.2.3">(</mo><msub id="A2.Ex1.m2.5.5.1.1.1.1.1.1.1"><mi id="A2.Ex1.m2.5.5.1.1.1.1.1.1.1.2">ğ±</mi><mi id="A2.Ex1.m2.5.5.1.1.1.1.1.1.1.3">i</mi></msub><mo id="A2.Ex1.m2.5.5.1.1.1.2.2.2.4">,</mo><msub id="A2.Ex1.m2.5.5.1.1.1.2.2.2.2"><mi id="A2.Ex1.m2.5.5.1.1.1.2.2.2.2.2">ğ²</mi><mrow id="A2.Ex1.m2.4.4.2"><mrow id="A2.Ex1.m2.4.4.2.4.2"><mi id="A2.Ex1.m2.3.3.1.1">i</mi><mo id="A2.Ex1.m2.4.4.2.4.2.1">,</mo><mn id="A2.Ex1.m2.4.4.2.2">0</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="A2.Ex1.m2.4.4.2.3">:</mo><mi id="A2.Ex1.m2.4.4.2.5">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex1.m2.5.5.1.1.1.2.2.2.5">)</mo></mrow></mrow></mrow><mo id="A2.Ex1.m2.5.5.1.1.3">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A2.Ex1.m2.5b">\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \beta\cdot\mathbb{E}_{\mathbf{x}_{i}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x}_{i})}\left[\sum_{j=1}^{L}\log\mathbb{Z}(\mathbf{x}_{i},\mathbf{y}_{i,0:j})\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex2.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ -\text{(overestimation in }\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i}))+\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}}," display="inline"><semantics id="A2.Ex2.m1.2a"><mrow id="A2.Ex2.m1.2b"><mo id="A2.Ex2.m1.2.3">âˆ’</mo><mtext class="ltx_mathvariant_italic" id="A2.Ex2.m1.2.4">(overestimation inÂ </mtext><msub id="A2.Ex2.m1.2.5"><mover accent="true" id="A2.Ex2.m1.2.5.2"><mi id="A2.Ex2.m1.2.5.2.2">A</mi><mo id="A2.Ex2.m1.2.5.2.1">^</mo></mover><mover accent="true" id="A2.Ex2.m1.2.5.3"><mi id="A2.Ex2.m1.2.5.3.2">Ï€</mi><mo id="A2.Ex2.m1.2.5.3.1">~</mo></mover></msub><mrow id="A2.Ex2.m1.2.6"><mo stretchy="false" id="A2.Ex2.m1.2.6.1">(</mo><mi id="A2.Ex2.m1.2.2">ğ±</mi><mo id="A2.Ex2.m1.2.6.2">,</mo><msub id="A2.Ex2.m1.2.6.3"><mi id="A2.Ex2.m1.2.6.3.2">ğ²</mi><mrow id="A2.Ex2.m1.2.6.3.3"><mn id="A2.Ex2.m1.2.6.3.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex2.m1.2.6.3.3.1">:</mo><mrow id="A2.Ex2.m1.2.6.3.3.3"><mi id="A2.Ex2.m1.2.6.3.3.3.2">i</mi><mo id="A2.Ex2.m1.2.6.3.3.3.1">âˆ’</mo><mn id="A2.Ex2.m1.2.6.3.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex2.m1.2.6.4">,</mo><msub id="A2.Ex2.m1.2.6.5"><mi id="A2.Ex2.m1.2.6.5.2">ğ²</mi><mi id="A2.Ex2.m1.2.6.5.3">i</mi></msub><mo stretchy="false" id="A2.Ex2.m1.2.6.6">)</mo></mrow><mo stretchy="false" id="A2.Ex2.m1.2.7">)</mo><mo id="A2.Ex2.m1.2.8">+</mo><mstyle displaystyle="true" id="A2.Ex2.m1.1.1"><mfrac id="A2.Ex2.m1.1.1a"><msub id="A2.Ex2.m1.1.1.3"><mi id="A2.Ex2.m1.1.1.3.2">c</mi><mn id="A2.Ex2.m1.1.1.3.3">0</mn></msub><msqrt id="A2.Ex2.m1.1.1.1"><mrow id="A2.Ex2.m1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex2.m1.1.1.1.1.1.1.2">|</mo><msub id="A2.Ex2.m1.1.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="A2.Ex2.m1.1.1.1.1.1.1.1.2">ğ’Ÿ</mi><mi id="A2.Ex2.m1.1.1.1.1.1.1.1.3">syn</mi></msub><mo stretchy="false" id="A2.Ex2.m1.1.1.1.1.1.1.3">|</mo></mrow></msqrt></mfrac></mstyle><mo id="A2.Ex2.m1.2.9">,</mo></mrow><annotation encoding="application/x-tex" id="A2.Ex2.m1.2c">\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ -\text{(overestimation in }\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i}))+\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.Thmtheorem1.p1.10" class="ltx_p"><span id="A2.Thmtheorem1.p1.10.4" class="ltx_text ltx_font_italic">where <math id="A2.Thmtheorem1.p1.7.1.m1.2" class="ltx_Math" alttext="\mathbb{Z}(\clubsuit,\circ)" display="inline"><semantics id="A2.Thmtheorem1.p1.7.1.m1.2a"><mrow id="A2.Thmtheorem1.p1.7.1.m1.2.3" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.cmml"><mi id="A2.Thmtheorem1.p1.7.1.m1.2.3.2" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.2.cmml">â„¤</mi><mo lspace="0em" rspace="0em" id="A2.Thmtheorem1.p1.7.1.m1.2.3.1" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.1.cmml">â€‹</mo><mrow id="A2.Thmtheorem1.p1.7.1.m1.2.3.3.2" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A2.Thmtheorem1.p1.7.1.m1.2.3.3.2.1" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.3.1.cmml">(</mo><mi mathvariant="normal" id="A2.Thmtheorem1.p1.7.1.m1.1.1" xref="A2.Thmtheorem1.p1.7.1.m1.1.1.cmml">â™£</mi><mo rspace="0em" id="A2.Thmtheorem1.p1.7.1.m1.2.3.3.2.2" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A2.Thmtheorem1.p1.7.1.m1.2.2" xref="A2.Thmtheorem1.p1.7.1.m1.2.2.cmml">âˆ˜</mo><mo stretchy="false" id="A2.Thmtheorem1.p1.7.1.m1.2.3.3.2.3" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.7.1.m1.2b"><apply id="A2.Thmtheorem1.p1.7.1.m1.2.3.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.2.3"><times id="A2.Thmtheorem1.p1.7.1.m1.2.3.1.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.1"></times><ci id="A2.Thmtheorem1.p1.7.1.m1.2.3.2.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.2">â„¤</ci><interval closure="open" id="A2.Thmtheorem1.p1.7.1.m1.2.3.3.1.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.2.3.3.2"><ci id="A2.Thmtheorem1.p1.7.1.m1.1.1.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.1.1">â™£</ci><compose id="A2.Thmtheorem1.p1.7.1.m1.2.2.cmml" xref="A2.Thmtheorem1.p1.7.1.m1.2.2"></compose></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.7.1.m1.2c">\mathbb{Z}(\clubsuit,\circ)</annotation></semantics></math> denotes the sum over exponentiated differences of the advantage and log likelihood values under <math id="A2.Thmtheorem1.p1.8.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.Thmtheorem1.p1.8.2.m2.1a"><msub id="A2.Thmtheorem1.p1.8.2.m2.1.1" xref="A2.Thmtheorem1.p1.8.2.m2.1.1.cmml"><mi id="A2.Thmtheorem1.p1.8.2.m2.1.1.2" xref="A2.Thmtheorem1.p1.8.2.m2.1.1.2.cmml">Ï€</mi><mi id="A2.Thmtheorem1.p1.8.2.m2.1.1.3" xref="A2.Thmtheorem1.p1.8.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.8.2.m2.1b"><apply id="A2.Thmtheorem1.p1.8.2.m2.1.1.cmml" xref="A2.Thmtheorem1.p1.8.2.m2.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.8.2.m2.1.1.1.cmml" xref="A2.Thmtheorem1.p1.8.2.m2.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.8.2.m2.1.1.2.cmml" xref="A2.Thmtheorem1.p1.8.2.m2.1.1.2">ğœ‹</ci><ci id="A2.Thmtheorem1.p1.8.2.m2.1.1.3.cmml" xref="A2.Thmtheorem1.p1.8.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.8.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> for all possible candidate steps given a problem <math id="A2.Thmtheorem1.p1.9.3.m3.1" class="ltx_Math" alttext="\clubsuit" display="inline"><semantics id="A2.Thmtheorem1.p1.9.3.m3.1a"><mi mathvariant="normal" id="A2.Thmtheorem1.p1.9.3.m3.1.1" xref="A2.Thmtheorem1.p1.9.3.m3.1.1.cmml">â™£</mi><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.9.3.m3.1b"><ci id="A2.Thmtheorem1.p1.9.3.m3.1.1.cmml" xref="A2.Thmtheorem1.p1.9.3.m3.1.1">â™£</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.9.3.m3.1c">\clubsuit</annotation></semantics></math> and a partial solution <math id="A2.Thmtheorem1.p1.10.4.m4.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="A2.Thmtheorem1.p1.10.4.m4.1a"><mo id="A2.Thmtheorem1.p1.10.4.m4.1.1" xref="A2.Thmtheorem1.p1.10.4.m4.1.1.cmml">âˆ˜</mo><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.10.4.m4.1b"><compose id="A2.Thmtheorem1.p1.10.4.m4.1.1.cmml" xref="A2.Thmtheorem1.p1.10.4.m4.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.10.4.m4.1c">\circ</annotation></semantics></math>. That is,</span></p>
<table id="A7.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex3.m1.9" class="ltx_Math" alttext="\displaystyle\mathbb{Z}(\clubsuit,\circ):=\sum_{\spadesuit\in\leavevmode\nobreak\ \text{step candidates}}\exp\left(\frac{{A}_{\tilde{\pi}}(\clubsuit,\circ;\spadesuit)}{\beta}+\log\pi_{\mathrm{sft}}(\spadesuit|\clubsuit,\circ)\right)," display="inline"><semantics id="A2.Ex3.m1.9a"><mrow id="A2.Ex3.m1.9.9.1" xref="A2.Ex3.m1.9.9.1.1.cmml"><mrow id="A2.Ex3.m1.9.9.1.1" xref="A2.Ex3.m1.9.9.1.1.cmml"><mrow id="A2.Ex3.m1.9.9.1.1.3" xref="A2.Ex3.m1.9.9.1.1.3.cmml"><mi id="A2.Ex3.m1.9.9.1.1.3.2" xref="A2.Ex3.m1.9.9.1.1.3.2.cmml">â„¤</mi><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.9.9.1.1.3.1" xref="A2.Ex3.m1.9.9.1.1.3.1.cmml">â€‹</mo><mrow id="A2.Ex3.m1.9.9.1.1.3.3.2" xref="A2.Ex3.m1.9.9.1.1.3.3.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.9.9.1.1.3.3.2.1" xref="A2.Ex3.m1.9.9.1.1.3.3.1.cmml">(</mo><mi mathvariant="normal" id="A2.Ex3.m1.4.4" xref="A2.Ex3.m1.4.4.cmml">â™£</mi><mo rspace="0em" id="A2.Ex3.m1.9.9.1.1.3.3.2.2" xref="A2.Ex3.m1.9.9.1.1.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.5.5" xref="A2.Ex3.m1.5.5.cmml">âˆ˜</mo><mo rspace="0.278em" stretchy="false" id="A2.Ex3.m1.9.9.1.1.3.3.2.3" xref="A2.Ex3.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="A2.Ex3.m1.9.9.1.1.2" xref="A2.Ex3.m1.9.9.1.1.2.cmml">:=</mo><mrow id="A2.Ex3.m1.9.9.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex3.m1.9.9.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.2.cmml"><munder id="A2.Ex3.m1.9.9.1.1.1.2a" xref="A2.Ex3.m1.9.9.1.1.1.2.cmml"><mo movablelimits="false" id="A2.Ex3.m1.9.9.1.1.1.2.2" xref="A2.Ex3.m1.9.9.1.1.1.2.2.cmml">âˆ‘</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.2.3" xref="A2.Ex3.m1.9.9.1.1.1.2.3.cmml"><mi mathvariant="normal" id="A2.Ex3.m1.9.9.1.1.1.2.3.2" xref="A2.Ex3.m1.9.9.1.1.1.2.3.2.cmml">â™ </mi><mo rspace="0.628em" id="A2.Ex3.m1.9.9.1.1.1.2.3.1" xref="A2.Ex3.m1.9.9.1.1.1.2.3.1.cmml">âˆˆ</mo><mtext class="ltx_mathvariant_italic" id="A2.Ex3.m1.9.9.1.1.1.2.3.3" xref="A2.Ex3.m1.9.9.1.1.1.2.3.3a.cmml">step candidates</mtext></mrow></munder></mstyle><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml"><mi id="A2.Ex3.m1.8.8" xref="A2.Ex3.m1.8.8.cmml">exp</mi><mo id="A2.Ex3.m1.9.9.1.1.1.1.1a" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml">â¡</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml"><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml">(</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex3.m1.3.3" xref="A2.Ex3.m1.3.3.cmml"><mfrac id="A2.Ex3.m1.3.3a" xref="A2.Ex3.m1.3.3.cmml"><mrow id="A2.Ex3.m1.3.3.3" xref="A2.Ex3.m1.3.3.3.cmml"><msub id="A2.Ex3.m1.3.3.3.5" xref="A2.Ex3.m1.3.3.3.5.cmml"><mi id="A2.Ex3.m1.3.3.3.5.2" xref="A2.Ex3.m1.3.3.3.5.2.cmml">A</mi><mover accent="true" id="A2.Ex3.m1.3.3.3.5.3" xref="A2.Ex3.m1.3.3.3.5.3.cmml"><mi id="A2.Ex3.m1.3.3.3.5.3.2" xref="A2.Ex3.m1.3.3.3.5.3.2.cmml">Ï€</mi><mo id="A2.Ex3.m1.3.3.3.5.3.1" xref="A2.Ex3.m1.3.3.3.5.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.3.3.3.4" xref="A2.Ex3.m1.3.3.3.4.cmml">â€‹</mo><mrow id="A2.Ex3.m1.3.3.3.6.2" xref="A2.Ex3.m1.3.3.3.6.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.3.3.3.6.2.1" xref="A2.Ex3.m1.3.3.3.6.1.cmml">(</mo><mi mathvariant="normal" id="A2.Ex3.m1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.cmml">â™£</mi><mo rspace="0em" id="A2.Ex3.m1.3.3.3.6.2.2" xref="A2.Ex3.m1.3.3.3.6.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.2.2.2.2" xref="A2.Ex3.m1.2.2.2.2.cmml">âˆ˜</mo><mo id="A2.Ex3.m1.3.3.3.6.2.3" xref="A2.Ex3.m1.3.3.3.6.1.cmml">;</mo><mi mathvariant="normal" id="A2.Ex3.m1.3.3.3.3" xref="A2.Ex3.m1.3.3.3.3.cmml">â™ </mi><mo stretchy="false" id="A2.Ex3.m1.3.3.3.6.2.4" xref="A2.Ex3.m1.3.3.3.6.1.cmml">)</mo></mrow></mrow><mi id="A2.Ex3.m1.3.3.5" xref="A2.Ex3.m1.3.3.5.cmml">Î²</mi></mfrac></mstyle><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3a" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">â¡</mo><msub id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.2.cmml">Ï€</mi><mi id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.3.cmml">sft</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">â™ </mi><mo fence="false" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mi mathvariant="normal" id="A2.Ex3.m1.6.6" xref="A2.Ex3.m1.6.6.cmml">â™£</mi><mo rspace="0em" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.7.7" xref="A2.Ex3.m1.7.7.cmml">âˆ˜</mo></mrow></mrow><mo stretchy="false" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex3.m1.9.9.1.1.1.1.1.1.3" xref="A2.Ex3.m1.9.9.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A2.Ex3.m1.9.9.1.2" xref="A2.Ex3.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex3.m1.9b"><apply id="A2.Ex3.m1.9.9.1.1.cmml" xref="A2.Ex3.m1.9.9.1"><csymbol cd="latexml" id="A2.Ex3.m1.9.9.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.2">assign</csymbol><apply id="A2.Ex3.m1.9.9.1.1.3.cmml" xref="A2.Ex3.m1.9.9.1.1.3"><times id="A2.Ex3.m1.9.9.1.1.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.3.1"></times><ci id="A2.Ex3.m1.9.9.1.1.3.2.cmml" xref="A2.Ex3.m1.9.9.1.1.3.2">â„¤</ci><interval closure="open" id="A2.Ex3.m1.9.9.1.1.3.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.3.3.2"><ci id="A2.Ex3.m1.4.4.cmml" xref="A2.Ex3.m1.4.4">â™£</ci><compose id="A2.Ex3.m1.5.5.cmml" xref="A2.Ex3.m1.5.5"></compose></interval></apply><apply id="A2.Ex3.m1.9.9.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1"><apply id="A2.Ex3.m1.9.9.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.9.9.1.1.1.2.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2">subscript</csymbol><sum id="A2.Ex3.m1.9.9.1.1.1.2.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.2"></sum><apply id="A2.Ex3.m1.9.9.1.1.1.2.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.3"><in id="A2.Ex3.m1.9.9.1.1.1.2.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.3.1"></in><ci id="A2.Ex3.m1.9.9.1.1.1.2.3.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.3.2">â™ </ci><ci id="A2.Ex3.m1.9.9.1.1.1.2.3.3a.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.3.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A2.Ex3.m1.9.9.1.1.1.2.3.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.2.3.3">step candidates</mtext></ci></apply></apply><apply id="A2.Ex3.m1.9.9.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1"><exp id="A2.Ex3.m1.8.8.cmml" xref="A2.Ex3.m1.8.8"></exp><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1"><plus id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.2"></plus><apply id="A2.Ex3.m1.3.3.cmml" xref="A2.Ex3.m1.3.3"><divide id="A2.Ex3.m1.3.3.4.cmml" xref="A2.Ex3.m1.3.3"></divide><apply id="A2.Ex3.m1.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3"><times id="A2.Ex3.m1.3.3.3.4.cmml" xref="A2.Ex3.m1.3.3.3.4"></times><apply id="A2.Ex3.m1.3.3.3.5.cmml" xref="A2.Ex3.m1.3.3.3.5"><csymbol cd="ambiguous" id="A2.Ex3.m1.3.3.3.5.1.cmml" xref="A2.Ex3.m1.3.3.3.5">subscript</csymbol><ci id="A2.Ex3.m1.3.3.3.5.2.cmml" xref="A2.Ex3.m1.3.3.3.5.2">ğ´</ci><apply id="A2.Ex3.m1.3.3.3.5.3.cmml" xref="A2.Ex3.m1.3.3.3.5.3"><ci id="A2.Ex3.m1.3.3.3.5.3.1.cmml" xref="A2.Ex3.m1.3.3.3.5.3.1">~</ci><ci id="A2.Ex3.m1.3.3.3.5.3.2.cmml" xref="A2.Ex3.m1.3.3.3.5.3.2">ğœ‹</ci></apply></apply><vector id="A2.Ex3.m1.3.3.3.6.1.cmml" xref="A2.Ex3.m1.3.3.3.6.2"><ci id="A2.Ex3.m1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1">â™£</ci><compose id="A2.Ex3.m1.2.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2"></compose><ci id="A2.Ex3.m1.3.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3.3">â™ </ci></vector></apply><ci id="A2.Ex3.m1.3.3.5.cmml" xref="A2.Ex3.m1.3.3.5">ğ›½</ci></apply><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1"><times id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.2"></times><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3"><log id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.1"></log><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.2">ğœ‹</ci><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.3.2.3">sft</ci></apply></apply><apply id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2">â™ </ci><list id="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="A2.Ex3.m1.6.6.cmml" xref="A2.Ex3.m1.6.6">â™£</ci><compose id="A2.Ex3.m1.7.7.cmml" xref="A2.Ex3.m1.7.7"></compose></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex3.m1.9c">\displaystyle\mathbb{Z}(\clubsuit,\circ):=\sum_{\spadesuit\in\leavevmode\nobreak\ \text{step candidates}}\exp\left(\frac{{A}_{\tilde{\pi}}(\clubsuit,\circ;\spadesuit)}{\beta}+\log\pi_{\mathrm{sft}}(\spadesuit|\clubsuit,\circ)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.Thmtheorem1.p1.13" class="ltx_p"><math id="A2.Thmtheorem1.p1.11.m1.1" class="ltx_Math" alttext="c_{0}" display="inline"><semantics id="A2.Thmtheorem1.p1.11.m1.1a"><msub id="A2.Thmtheorem1.p1.11.m1.1.1" xref="A2.Thmtheorem1.p1.11.m1.1.1.cmml"><mi id="A2.Thmtheorem1.p1.11.m1.1.1.2" xref="A2.Thmtheorem1.p1.11.m1.1.1.2.cmml">c</mi><mn id="A2.Thmtheorem1.p1.11.m1.1.1.3" xref="A2.Thmtheorem1.p1.11.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.11.m1.1b"><apply id="A2.Thmtheorem1.p1.11.m1.1.1.cmml" xref="A2.Thmtheorem1.p1.11.m1.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.11.m1.1.1.1.cmml" xref="A2.Thmtheorem1.p1.11.m1.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.11.m1.1.1.2.cmml" xref="A2.Thmtheorem1.p1.11.m1.1.1.2">ğ‘</ci><cn type="integer" id="A2.Thmtheorem1.p1.11.m1.1.1.3.cmml" xref="A2.Thmtheorem1.p1.11.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.11.m1.1c">c_{0}</annotation></semantics></math><span id="A2.Thmtheorem1.p1.13.2" class="ltx_text ltx_font_italic"> is a constant depending upon the Rademacher complexity of the space of policies <math id="A2.Thmtheorem1.p1.12.1.m1.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.Thmtheorem1.p1.12.1.m1.1a"><msub id="A2.Thmtheorem1.p1.12.1.m1.1.1" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.cmml"><mi id="A2.Thmtheorem1.p1.12.1.m1.1.1.2" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.2.cmml">Ï€</mi><mtext class="ltx_mathvariant_italic" id="A2.Thmtheorem1.p1.12.1.m1.1.1.3" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.12.1.m1.1b"><apply id="A2.Thmtheorem1.p1.12.1.m1.1.1.cmml" xref="A2.Thmtheorem1.p1.12.1.m1.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.12.1.m1.1.1.1.cmml" xref="A2.Thmtheorem1.p1.12.1.m1.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.12.1.m1.1.1.2.cmml" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.2">ğœ‹</ci><ci id="A2.Thmtheorem1.p1.12.1.m1.1.1.3a.cmml" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A2.Thmtheorem1.p1.12.1.m1.1.1.3.cmml" xref="A2.Thmtheorem1.p1.12.1.m1.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.12.1.m1.1c">\pi_{\text{neg}}</annotation></semantics></math> close to the SFT policy under the KL-divergence, <math id="A2.Thmtheorem1.p1.13.2.m2.1" class="ltx_Math" alttext="|\mathcal{D}_{\mathrm{syn}}|" display="inline"><semantics id="A2.Thmtheorem1.p1.13.2.m2.1a"><mrow id="A2.Thmtheorem1.p1.13.2.m2.1.1.1" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.2.cmml"><mo stretchy="false" id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.2" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.2.1.cmml">|</mo><msub id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.2" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.2.cmml">ğ’Ÿ</mi><mi id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.3" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.3.cmml">syn</mi></msub><mo stretchy="false" id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.3" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Thmtheorem1.p1.13.2.m2.1b"><apply id="A2.Thmtheorem1.p1.13.2.m2.1.1.2.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1"><abs id="A2.Thmtheorem1.p1.13.2.m2.1.1.2.1.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.2"></abs><apply id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.1.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1">subscript</csymbol><ci id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.2.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.2">ğ’Ÿ</ci><ci id="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.3.cmml" xref="A2.Thmtheorem1.p1.13.2.m2.1.1.1.1.3">syn</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Thmtheorem1.p1.13.2.m2.1c">|\mathcal{D}_{\mathrm{syn}}|</annotation></semantics></math> denotes the size of synthetic training prompts.</span></p>
</div>
</div>
<div id="A2.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A2.1.p1" class="ltx_para">
<p id="A2.1.p1.4" class="ltx_p">To begin the proof, we recall that we are operating in a discrete action space of steps <math id="A2.1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{y}_{i}" display="inline"><semantics id="A2.1.p1.1.m1.1a"><msub id="A2.1.p1.1.m1.1.1" xref="A2.1.p1.1.m1.1.1.cmml"><mi id="A2.1.p1.1.m1.1.1.2" xref="A2.1.p1.1.m1.1.1.2.cmml">ğ²</mi><mi id="A2.1.p1.1.m1.1.1.3" xref="A2.1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.1.m1.1b"><apply id="A2.1.p1.1.m1.1.1.cmml" xref="A2.1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.1.p1.1.m1.1.1.1.cmml" xref="A2.1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.1.p1.1.m1.1.1.2.cmml" xref="A2.1.p1.1.m1.1.1.2">ğ²</ci><ci id="A2.1.p1.1.m1.1.1.3.cmml" xref="A2.1.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.1.m1.1c">\mathbf{y}_{i}</annotation></semantics></math>, although this space is exponentially large. Since we operate in discrete action spaces, we invoke Lemma 5 from <cite class="ltx_cite ltx_citemacro_citet">Agarwal etÂ al. [<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> for analyzing softmax policy gradient methods (this Lemma was extended by Lemma B.11 from <cite class="ltx_cite ltx_citemacro_citet">Kumar etÂ al. [<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> for comparing BC vs offline RL). Denote by <math id="A2.1.p1.2.m2.1" class="ltx_Math" alttext="\widehat{J}(\pi)" display="inline"><semantics id="A2.1.p1.2.m2.1a"><mrow id="A2.1.p1.2.m2.1.2" xref="A2.1.p1.2.m2.1.2.cmml"><mover accent="true" id="A2.1.p1.2.m2.1.2.2" xref="A2.1.p1.2.m2.1.2.2.cmml"><mi id="A2.1.p1.2.m2.1.2.2.2" xref="A2.1.p1.2.m2.1.2.2.2.cmml">J</mi><mo id="A2.1.p1.2.m2.1.2.2.1" xref="A2.1.p1.2.m2.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.1.p1.2.m2.1.2.1" xref="A2.1.p1.2.m2.1.2.1.cmml">â€‹</mo><mrow id="A2.1.p1.2.m2.1.2.3.2" xref="A2.1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="A2.1.p1.2.m2.1.2.3.2.1" xref="A2.1.p1.2.m2.1.2.cmml">(</mo><mi id="A2.1.p1.2.m2.1.1" xref="A2.1.p1.2.m2.1.1.cmml">Ï€</mi><mo stretchy="false" id="A2.1.p1.2.m2.1.2.3.2.2" xref="A2.1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.2.m2.1b"><apply id="A2.1.p1.2.m2.1.2.cmml" xref="A2.1.p1.2.m2.1.2"><times id="A2.1.p1.2.m2.1.2.1.cmml" xref="A2.1.p1.2.m2.1.2.1"></times><apply id="A2.1.p1.2.m2.1.2.2.cmml" xref="A2.1.p1.2.m2.1.2.2"><ci id="A2.1.p1.2.m2.1.2.2.1.cmml" xref="A2.1.p1.2.m2.1.2.2.1">^</ci><ci id="A2.1.p1.2.m2.1.2.2.2.cmml" xref="A2.1.p1.2.m2.1.2.2.2">ğ½</ci></apply><ci id="A2.1.p1.2.m2.1.1.cmml" xref="A2.1.p1.2.m2.1.1">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.2.m2.1c">\widehat{J}(\pi)</annotation></semantics></math>, the reward attained by policy <math id="A2.1.p1.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A2.1.p1.3.m3.1a"><mi id="A2.1.p1.3.m3.1.1" xref="A2.1.p1.3.m3.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="A2.1.p1.3.m3.1b"><ci id="A2.1.p1.3.m3.1.1.cmml" xref="A2.1.p1.3.m3.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.3.m3.1c">\pi</annotation></semantics></math> in expectation over the empirical distribution <math id="A2.1.p1.4.m4.1" class="ltx_Math" alttext="\widehat{\mu}" display="inline"><semantics id="A2.1.p1.4.m4.1a"><mover accent="true" id="A2.1.p1.4.m4.1.1" xref="A2.1.p1.4.m4.1.1.cmml"><mi id="A2.1.p1.4.m4.1.1.2" xref="A2.1.p1.4.m4.1.1.2.cmml">Î¼</mi><mo id="A2.1.p1.4.m4.1.1.1" xref="A2.1.p1.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.1.p1.4.m4.1b"><apply id="A2.1.p1.4.m4.1.1.cmml" xref="A2.1.p1.4.m4.1.1"><ci id="A2.1.p1.4.m4.1.1.1.cmml" xref="A2.1.p1.4.m4.1.1.1">^</ci><ci id="A2.1.p1.4.m4.1.1.2.cmml" xref="A2.1.p1.4.m4.1.1.2">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.4.m4.1c">\widehat{\mu}</annotation></semantics></math>:</p>
<table id="A7.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E11.m1.4" class="ltx_Math" alttext="\displaystyle\widehat{J}(\pi_{\text{neg}})-\widehat{J}(\pi_{\mathrm{sft}}):=\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\widehat{V}^{\pi_{\text{neg}}}(\mathbf{x})\right]-\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\widehat{V}^{\pi_{\mathrm{sft}}}(\mathbf{x})\right]\geq\beta\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\log\widehat{\mathbb{Z}}(\mathbf{x})\right]." display="inline"><semantics id="A2.E11.m1.4a"><mrow id="A2.E11.m1.4.4.1" xref="A2.E11.m1.4.4.1.1.cmml"><mrow id="A2.E11.m1.4.4.1.1" xref="A2.E11.m1.4.4.1.1.cmml"><mrow id="A2.E11.m1.4.4.1.1.2" xref="A2.E11.m1.4.4.1.1.2.cmml"><mrow id="A2.E11.m1.4.4.1.1.1.1" xref="A2.E11.m1.4.4.1.1.1.1.cmml"><mover accent="true" id="A2.E11.m1.4.4.1.1.1.1.3" xref="A2.E11.m1.4.4.1.1.1.1.3.cmml"><mi id="A2.E11.m1.4.4.1.1.1.1.3.2" xref="A2.E11.m1.4.4.1.1.1.1.3.2.cmml">J</mi><mo id="A2.E11.m1.4.4.1.1.1.1.3.1" xref="A2.E11.m1.4.4.1.1.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.1.1.2" xref="A2.E11.m1.4.4.1.1.1.1.2.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.1.1.1.1" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E11.m1.4.4.1.1.1.1.1.1.2" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.E11.m1.4.4.1.1.1.1.1.1.1" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="A2.E11.m1.4.4.1.1.1.1.1.1.1.2" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.2.cmml">Ï€</mi><mtext id="A2.E11.m1.4.4.1.1.1.1.1.1.1.3" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.E11.m1.4.4.1.1.1.1.1.1.3" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.2.3" xref="A2.E11.m1.4.4.1.1.2.3.cmml">âˆ’</mo><mrow id="A2.E11.m1.4.4.1.1.2.2" xref="A2.E11.m1.4.4.1.1.2.2.cmml"><mover accent="true" id="A2.E11.m1.4.4.1.1.2.2.3" xref="A2.E11.m1.4.4.1.1.2.2.3.cmml"><mi id="A2.E11.m1.4.4.1.1.2.2.3.2" xref="A2.E11.m1.4.4.1.1.2.2.3.2.cmml">J</mi><mo id="A2.E11.m1.4.4.1.1.2.2.3.1" xref="A2.E11.m1.4.4.1.1.2.2.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.2.2.2" xref="A2.E11.m1.4.4.1.1.2.2.2.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.2.2.1.1" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.E11.m1.4.4.1.1.2.2.1.1.2" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.cmml">(</mo><msub id="A2.E11.m1.4.4.1.1.2.2.1.1.1" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.cmml"><mi id="A2.E11.m1.4.4.1.1.2.2.1.1.1.2" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.2.cmml">Ï€</mi><mi id="A2.E11.m1.4.4.1.1.2.2.1.1.1.3" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.3.cmml">sft</mi></msub><mo rspace="0.278em" stretchy="false" id="A2.E11.m1.4.4.1.1.2.2.1.1.3" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.278em" id="A2.E11.m1.4.4.1.1.7" xref="A2.E11.m1.4.4.1.1.7.cmml">:=</mo><mrow id="A2.E11.m1.4.4.1.1.4" xref="A2.E11.m1.4.4.1.1.4.cmml"><mrow id="A2.E11.m1.4.4.1.1.3.1" xref="A2.E11.m1.4.4.1.1.3.1.cmml"><msub id="A2.E11.m1.4.4.1.1.3.1.3" xref="A2.E11.m1.4.4.1.1.3.1.3.cmml"><mi id="A2.E11.m1.4.4.1.1.3.1.3.2" xref="A2.E11.m1.4.4.1.1.3.1.3.2.cmml">ğ”¼</mi><mrow id="A2.E11.m1.4.4.1.1.3.1.3.3" xref="A2.E11.m1.4.4.1.1.3.1.3.3.cmml"><mi id="A2.E11.m1.4.4.1.1.3.1.3.3.2" xref="A2.E11.m1.4.4.1.1.3.1.3.3.2.cmml">ğ±</mi><mo id="A2.E11.m1.4.4.1.1.3.1.3.3.1" xref="A2.E11.m1.4.4.1.1.3.1.3.3.1.cmml">âˆ¼</mo><mover accent="true" id="A2.E11.m1.4.4.1.1.3.1.3.3.3" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3.cmml"><mi id="A2.E11.m1.4.4.1.1.3.1.3.3.3.2" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3.2.cmml">Î¼</mi><mo id="A2.E11.m1.4.4.1.1.3.1.3.3.3.1" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3.1.cmml">^</mo></mover></mrow></msub><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.3.1.2" xref="A2.E11.m1.4.4.1.1.3.1.2.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.3.1.1.1" xref="A2.E11.m1.4.4.1.1.3.1.1.2.cmml"><mo id="A2.E11.m1.4.4.1.1.3.1.1.1.2" xref="A2.E11.m1.4.4.1.1.3.1.1.2.1.cmml">[</mo><mrow id="A2.E11.m1.4.4.1.1.3.1.1.1.1" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.cmml"><msup id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.cmml"><mover accent="true" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.cmml"><mi id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.2.cmml">V</mi><mo id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.1" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.1.cmml">^</mo></mover><msub id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.cmml"><mi id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.2.cmml">Ï€</mi><mtext id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3a.cmml">neg</mtext></msub></msup><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.1" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.1.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.3.1.1.1.1.3.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.3.2.1" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.cmml">(</mo><mi id="A2.E11.m1.1.1" xref="A2.E11.m1.1.1.cmml">ğ±</mi><mo stretchy="false" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.3.2.2" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.3.1.1.1.3" xref="A2.E11.m1.4.4.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.4.3" xref="A2.E11.m1.4.4.1.1.4.3.cmml">âˆ’</mo><mrow id="A2.E11.m1.4.4.1.1.4.2" xref="A2.E11.m1.4.4.1.1.4.2.cmml"><msub id="A2.E11.m1.4.4.1.1.4.2.3" xref="A2.E11.m1.4.4.1.1.4.2.3.cmml"><mi id="A2.E11.m1.4.4.1.1.4.2.3.2" xref="A2.E11.m1.4.4.1.1.4.2.3.2.cmml">ğ”¼</mi><mrow id="A2.E11.m1.4.4.1.1.4.2.3.3" xref="A2.E11.m1.4.4.1.1.4.2.3.3.cmml"><mi id="A2.E11.m1.4.4.1.1.4.2.3.3.2" xref="A2.E11.m1.4.4.1.1.4.2.3.3.2.cmml">ğ±</mi><mo id="A2.E11.m1.4.4.1.1.4.2.3.3.1" xref="A2.E11.m1.4.4.1.1.4.2.3.3.1.cmml">âˆ¼</mo><mover accent="true" id="A2.E11.m1.4.4.1.1.4.2.3.3.3" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3.cmml"><mi id="A2.E11.m1.4.4.1.1.4.2.3.3.3.2" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3.2.cmml">Î¼</mi><mo id="A2.E11.m1.4.4.1.1.4.2.3.3.3.1" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3.1.cmml">^</mo></mover></mrow></msub><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.4.2.2" xref="A2.E11.m1.4.4.1.1.4.2.2.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.4.2.1.1" xref="A2.E11.m1.4.4.1.1.4.2.1.2.cmml"><mo id="A2.E11.m1.4.4.1.1.4.2.1.1.2" xref="A2.E11.m1.4.4.1.1.4.2.1.2.1.cmml">[</mo><mrow id="A2.E11.m1.4.4.1.1.4.2.1.1.1" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.cmml"><msup id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.cmml"><mover accent="true" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.cmml"><mi id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.2.cmml">V</mi><mo id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.1" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.1.cmml">^</mo></mover><msub id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.cmml"><mi id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.2.cmml">Ï€</mi><mi id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.3" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.3.cmml">sft</mi></msub></msup><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.1" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.1.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.4.2.1.1.1.3.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.cmml"><mo stretchy="false" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.3.2.1" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.cmml">(</mo><mi id="A2.E11.m1.2.2" xref="A2.E11.m1.2.2.cmml">ğ±</mi><mo stretchy="false" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.3.2.2" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.4.2.1.1.3" xref="A2.E11.m1.4.4.1.1.4.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.8" xref="A2.E11.m1.4.4.1.1.8.cmml">â‰¥</mo><mrow id="A2.E11.m1.4.4.1.1.5" xref="A2.E11.m1.4.4.1.1.5.cmml"><mi id="A2.E11.m1.4.4.1.1.5.3" xref="A2.E11.m1.4.4.1.1.5.3.cmml">Î²</mi><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.5.2" xref="A2.E11.m1.4.4.1.1.5.2.cmml">â€‹</mo><msub id="A2.E11.m1.4.4.1.1.5.4" xref="A2.E11.m1.4.4.1.1.5.4.cmml"><mi id="A2.E11.m1.4.4.1.1.5.4.2" xref="A2.E11.m1.4.4.1.1.5.4.2.cmml">ğ”¼</mi><mrow id="A2.E11.m1.4.4.1.1.5.4.3" xref="A2.E11.m1.4.4.1.1.5.4.3.cmml"><mi id="A2.E11.m1.4.4.1.1.5.4.3.2" xref="A2.E11.m1.4.4.1.1.5.4.3.2.cmml">ğ±</mi><mo id="A2.E11.m1.4.4.1.1.5.4.3.1" xref="A2.E11.m1.4.4.1.1.5.4.3.1.cmml">âˆ¼</mo><mover accent="true" id="A2.E11.m1.4.4.1.1.5.4.3.3" xref="A2.E11.m1.4.4.1.1.5.4.3.3.cmml"><mi id="A2.E11.m1.4.4.1.1.5.4.3.3.2" xref="A2.E11.m1.4.4.1.1.5.4.3.3.2.cmml">Î¼</mi><mo id="A2.E11.m1.4.4.1.1.5.4.3.3.1" xref="A2.E11.m1.4.4.1.1.5.4.3.3.1.cmml">^</mo></mover></mrow></msub><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.5.2a" xref="A2.E11.m1.4.4.1.1.5.2.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.5.1.1" xref="A2.E11.m1.4.4.1.1.5.1.2.cmml"><mo id="A2.E11.m1.4.4.1.1.5.1.1.2" xref="A2.E11.m1.4.4.1.1.5.1.2.1.cmml">[</mo><mrow id="A2.E11.m1.4.4.1.1.5.1.1.1" xref="A2.E11.m1.4.4.1.1.5.1.1.1.cmml"><mrow id="A2.E11.m1.4.4.1.1.5.1.1.1.2" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.cmml"><mi id="A2.E11.m1.4.4.1.1.5.1.1.1.2.1" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="A2.E11.m1.4.4.1.1.5.1.1.1.2a" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.cmml">â¡</mo><mover accent="true" id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.cmml"><mi id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.2" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.2.cmml">â„¤</mi><mo id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.1" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.1.cmml">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="A2.E11.m1.4.4.1.1.5.1.1.1.1" xref="A2.E11.m1.4.4.1.1.5.1.1.1.1.cmml">â€‹</mo><mrow id="A2.E11.m1.4.4.1.1.5.1.1.1.3.2" xref="A2.E11.m1.4.4.1.1.5.1.1.1.cmml"><mo stretchy="false" id="A2.E11.m1.4.4.1.1.5.1.1.1.3.2.1" xref="A2.E11.m1.4.4.1.1.5.1.1.1.cmml">(</mo><mi id="A2.E11.m1.3.3" xref="A2.E11.m1.3.3.cmml">ğ±</mi><mo stretchy="false" id="A2.E11.m1.4.4.1.1.5.1.1.1.3.2.2" xref="A2.E11.m1.4.4.1.1.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.4.4.1.1.5.1.1.3" xref="A2.E11.m1.4.4.1.1.5.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="A2.E11.m1.4.4.1.2" xref="A2.E11.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E11.m1.4b"><apply id="A2.E11.m1.4.4.1.1.cmml" xref="A2.E11.m1.4.4.1"><and id="A2.E11.m1.4.4.1.1a.cmml" xref="A2.E11.m1.4.4.1"></and><apply id="A2.E11.m1.4.4.1.1b.cmml" xref="A2.E11.m1.4.4.1"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.7.cmml" xref="A2.E11.m1.4.4.1.1.7">assign</csymbol><apply id="A2.E11.m1.4.4.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.2"><minus id="A2.E11.m1.4.4.1.1.2.3.cmml" xref="A2.E11.m1.4.4.1.1.2.3"></minus><apply id="A2.E11.m1.4.4.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.1.1"><times id="A2.E11.m1.4.4.1.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.1.1.2"></times><apply id="A2.E11.m1.4.4.1.1.1.1.3.cmml" xref="A2.E11.m1.4.4.1.1.1.1.3"><ci id="A2.E11.m1.4.4.1.1.1.1.3.1.cmml" xref="A2.E11.m1.4.4.1.1.1.1.3.1">^</ci><ci id="A2.E11.m1.4.4.1.1.1.1.3.2.cmml" xref="A2.E11.m1.4.4.1.1.1.1.3.2">ğ½</ci></apply><apply id="A2.E11.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.E11.m1.4.4.1.1.1.1.1.1.1.3a.cmml" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="A2.E11.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A2.E11.m1.4.4.1.1.1.1.1.1.1.3">neg</mtext></ci></apply></apply><apply id="A2.E11.m1.4.4.1.1.2.2.cmml" xref="A2.E11.m1.4.4.1.1.2.2"><times id="A2.E11.m1.4.4.1.1.2.2.2.cmml" xref="A2.E11.m1.4.4.1.1.2.2.2"></times><apply id="A2.E11.m1.4.4.1.1.2.2.3.cmml" xref="A2.E11.m1.4.4.1.1.2.2.3"><ci id="A2.E11.m1.4.4.1.1.2.2.3.1.cmml" xref="A2.E11.m1.4.4.1.1.2.2.3.1">^</ci><ci id="A2.E11.m1.4.4.1.1.2.2.3.2.cmml" xref="A2.E11.m1.4.4.1.1.2.2.3.2">ğ½</ci></apply><apply id="A2.E11.m1.4.4.1.1.2.2.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.2.2.1.1">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.E11.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="A2.E11.m1.4.4.1.1.2.2.1.1.1.3">sft</ci></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1.4.cmml" xref="A2.E11.m1.4.4.1.1.4"><minus id="A2.E11.m1.4.4.1.1.4.3.cmml" xref="A2.E11.m1.4.4.1.1.4.3"></minus><apply id="A2.E11.m1.4.4.1.1.3.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1"><times id="A2.E11.m1.4.4.1.1.3.1.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.2"></times><apply id="A2.E11.m1.4.4.1.1.3.1.3.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.3.1.3.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.3.1.3.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.2">ğ”¼</ci><apply id="A2.E11.m1.4.4.1.1.3.1.3.3.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.3.1.3.3.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3.1">similar-to</csymbol><ci id="A2.E11.m1.4.4.1.1.3.1.3.3.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3.2">ğ±</ci><apply id="A2.E11.m1.4.4.1.1.3.1.3.3.3.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3"><ci id="A2.E11.m1.4.4.1.1.3.1.3.3.3.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3.1">^</ci><ci id="A2.E11.m1.4.4.1.1.3.1.3.3.3.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.3.3.3.2">ğœ‡</ci></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1.3.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.3.1.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="A2.E11.m1.4.4.1.1.3.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1"><times id="A2.E11.m1.4.4.1.1.3.1.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.1"></times><apply id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2">superscript</csymbol><apply id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2"><ci id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.1">^</ci><ci id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.2.2">ğ‘‰</ci></apply><apply id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.1.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.2.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.2">ğœ‹</ci><ci id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3a.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3"><mtext mathsize="50%" id="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3.cmml" xref="A2.E11.m1.4.4.1.1.3.1.1.1.1.2.3.3">neg</mtext></ci></apply></apply><ci id="A2.E11.m1.1.1.cmml" xref="A2.E11.m1.1.1">ğ±</ci></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1.4.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2"><times id="A2.E11.m1.4.4.1.1.4.2.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.2"></times><apply id="A2.E11.m1.4.4.1.1.4.2.3.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.4.2.3.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.4.2.3.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.2">ğ”¼</ci><apply id="A2.E11.m1.4.4.1.1.4.2.3.3.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.4.2.3.3.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3.1">similar-to</csymbol><ci id="A2.E11.m1.4.4.1.1.4.2.3.3.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3.2">ğ±</ci><apply id="A2.E11.m1.4.4.1.1.4.2.3.3.3.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3"><ci id="A2.E11.m1.4.4.1.1.4.2.3.3.3.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3.1">^</ci><ci id="A2.E11.m1.4.4.1.1.4.2.3.3.3.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.3.3.3.2">ğœ‡</ci></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1.4.2.1.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.4.2.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.2">delimited-[]</csymbol><apply id="A2.E11.m1.4.4.1.1.4.2.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1"><times id="A2.E11.m1.4.4.1.1.4.2.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.1"></times><apply id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2">superscript</csymbol><apply id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2"><ci id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.1">^</ci><ci id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.2.2">ğ‘‰</ci></apply><apply id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.1.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.2.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.2">ğœ‹</ci><ci id="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.3.cmml" xref="A2.E11.m1.4.4.1.1.4.2.1.1.1.2.3.3">sft</ci></apply></apply><ci id="A2.E11.m1.2.2.cmml" xref="A2.E11.m1.2.2">ğ±</ci></apply></apply></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1c.cmml" xref="A2.E11.m1.4.4.1"><geq id="A2.E11.m1.4.4.1.1.8.cmml" xref="A2.E11.m1.4.4.1.1.8"></geq><share href="#A2.E11.m1.4.4.1.1.4.cmml" id="A2.E11.m1.4.4.1.1d.cmml" xref="A2.E11.m1.4.4.1"></share><apply id="A2.E11.m1.4.4.1.1.5.cmml" xref="A2.E11.m1.4.4.1.1.5"><times id="A2.E11.m1.4.4.1.1.5.2.cmml" xref="A2.E11.m1.4.4.1.1.5.2"></times><ci id="A2.E11.m1.4.4.1.1.5.3.cmml" xref="A2.E11.m1.4.4.1.1.5.3">ğ›½</ci><apply id="A2.E11.m1.4.4.1.1.5.4.cmml" xref="A2.E11.m1.4.4.1.1.5.4"><csymbol cd="ambiguous" id="A2.E11.m1.4.4.1.1.5.4.1.cmml" xref="A2.E11.m1.4.4.1.1.5.4">subscript</csymbol><ci id="A2.E11.m1.4.4.1.1.5.4.2.cmml" xref="A2.E11.m1.4.4.1.1.5.4.2">ğ”¼</ci><apply id="A2.E11.m1.4.4.1.1.5.4.3.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.5.4.3.1.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3.1">similar-to</csymbol><ci id="A2.E11.m1.4.4.1.1.5.4.3.2.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3.2">ğ±</ci><apply id="A2.E11.m1.4.4.1.1.5.4.3.3.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3.3"><ci id="A2.E11.m1.4.4.1.1.5.4.3.3.1.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3.3.1">^</ci><ci id="A2.E11.m1.4.4.1.1.5.4.3.3.2.cmml" xref="A2.E11.m1.4.4.1.1.5.4.3.3.2">ğœ‡</ci></apply></apply></apply><apply id="A2.E11.m1.4.4.1.1.5.1.2.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1"><csymbol cd="latexml" id="A2.E11.m1.4.4.1.1.5.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.2">delimited-[]</csymbol><apply id="A2.E11.m1.4.4.1.1.5.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1"><times id="A2.E11.m1.4.4.1.1.5.1.1.1.1.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.1"></times><apply id="A2.E11.m1.4.4.1.1.5.1.1.1.2.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2"><log id="A2.E11.m1.4.4.1.1.5.1.1.1.2.1.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.1"></log><apply id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2"><ci id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.1.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.1">^</ci><ci id="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.2.cmml" xref="A2.E11.m1.4.4.1.1.5.1.1.1.2.2.2">â„¤</ci></apply></apply><ci id="A2.E11.m1.3.3.cmml" xref="A2.E11.m1.3.3">ğ±</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E11.m1.4c">\displaystyle\widehat{J}(\pi_{\text{neg}})-\widehat{J}(\pi_{\mathrm{sft}}):=\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\widehat{V}^{\pi_{\text{neg}}}(\mathbf{x})\right]-\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\widehat{V}^{\pi_{\mathrm{sft}}}(\mathbf{x})\right]\geq\beta\mathbb{E}_{\mathbf{x}\sim\widehat{\mu}}\left[\log\widehat{\mathbb{Z}}(\mathbf{x})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="A2.1.p1.5" class="ltx_p">We utilize the performance difference lemmaÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> on the MDP induced by the set of initial problems in the training distribution <math id="A2.1.p1.5.m1.1" class="ltx_Math" alttext="\widehat{\mu}" display="inline"><semantics id="A2.1.p1.5.m1.1a"><mover accent="true" id="A2.1.p1.5.m1.1.1" xref="A2.1.p1.5.m1.1.1.cmml"><mi id="A2.1.p1.5.m1.1.1.2" xref="A2.1.p1.5.m1.1.1.2.cmml">Î¼</mi><mo id="A2.1.p1.5.m1.1.1.1" xref="A2.1.p1.5.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.1.p1.5.m1.1b"><apply id="A2.1.p1.5.m1.1.1.cmml" xref="A2.1.p1.5.m1.1.1"><ci id="A2.1.p1.5.m1.1.1.1.cmml" xref="A2.1.p1.5.m1.1.1.1">^</ci><ci id="A2.1.p1.5.m1.1.1.2.cmml" xref="A2.1.p1.5.m1.1.1.2">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.5.m1.1c">\widehat{\mu}</annotation></semantics></math>, and the model induced deterministic dynamics distribution:</p>
<table id="A7.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle\widehat{J}(\pi_{\text{neg}})" display="inline"><semantics id="A2.Ex4.m1.1a"><mrow id="A2.Ex4.m1.1.1" xref="A2.Ex4.m1.1.1.cmml"><mover accent="true" id="A2.Ex4.m1.1.1.3" xref="A2.Ex4.m1.1.1.3.cmml"><mi id="A2.Ex4.m1.1.1.3.2" xref="A2.Ex4.m1.1.1.3.2.cmml">J</mi><mo id="A2.Ex4.m1.1.1.3.1" xref="A2.Ex4.m1.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.1.1.2" xref="A2.Ex4.m1.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex4.m1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex4.m1.1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.2.cmml">Ï€</mi><mtext id="A2.Ex4.m1.1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex4.m1.1b"><apply id="A2.Ex4.m1.1.1.cmml" xref="A2.Ex4.m1.1.1"><times id="A2.Ex4.m1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.2"></times><apply id="A2.Ex4.m1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.3"><ci id="A2.Ex4.m1.1.1.3.1.cmml" xref="A2.Ex4.m1.1.1.3.1">^</ci><ci id="A2.Ex4.m1.1.1.3.2.cmml" xref="A2.Ex4.m1.1.1.3.2">ğ½</ci></apply><apply id="A2.Ex4.m1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex4.m1.1.1.1.1.1.3a.cmml" xref="A2.Ex4.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="A2.Ex4.m1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.3">neg</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex4.m1.1c">\displaystyle\widehat{J}(\pi_{\text{neg}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex4.m2.4" class="ltx_math_unparsed" alttext="\displaystyle-\widehat{J}(\pi_{\mathrm{sft}})=\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{\mathbf{y}_{j}}\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})\right]" display="inline"><semantics id="A2.Ex4.m2.4a"><mrow id="A2.Ex4.m2.4.4"><mrow id="A2.Ex4.m2.3.3.1"><mo id="A2.Ex4.m2.3.3.1a">âˆ’</mo><mrow id="A2.Ex4.m2.3.3.1.1"><mover accent="true" id="A2.Ex4.m2.3.3.1.1.3"><mi id="A2.Ex4.m2.3.3.1.1.3.2">J</mi><mo id="A2.Ex4.m2.3.3.1.1.3.1">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.3.3.1.1.2">â€‹</mo><mrow id="A2.Ex4.m2.3.3.1.1.1.1"><mo stretchy="false" id="A2.Ex4.m2.3.3.1.1.1.1.2">(</mo><msub id="A2.Ex4.m2.3.3.1.1.1.1.1"><mi id="A2.Ex4.m2.3.3.1.1.1.1.1.2">Ï€</mi><mi id="A2.Ex4.m2.3.3.1.1.1.1.1.3">sft</mi></msub><mo stretchy="false" id="A2.Ex4.m2.3.3.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo id="A2.Ex4.m2.4.4.3">=</mo><mrow id="A2.Ex4.m2.4.4.2"><mstyle displaystyle="true" id="A2.Ex4.m2.4.4.2.2"><munderover id="A2.Ex4.m2.4.4.2.2a"><mo movablelimits="false" id="A2.Ex4.m2.4.4.2.2.2.2">âˆ‘</mo><mrow id="A2.Ex4.m2.4.4.2.2.2.3"><mi id="A2.Ex4.m2.4.4.2.2.2.3.2">j</mi><mo id="A2.Ex4.m2.4.4.2.2.2.3.1">=</mo><mn id="A2.Ex4.m2.4.4.2.2.2.3.3">1</mn></mrow><mi id="A2.Ex4.m2.4.4.2.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex4.m2.4.4.2.1"><msub id="A2.Ex4.m2.4.4.2.1.3"><mi id="A2.Ex4.m2.4.4.2.1.3.2">ğ”¼</mi><mrow id="A2.Ex4.m2.4.4.2.1.3.3"><mi id="A2.Ex4.m2.4.4.2.1.3.3.1">ğ±</mi><mo id="A2.Ex4.m2.4.4.2.1.3.3.2">âˆ¼</mo><mover accent="true" id="A2.Ex4.m2.4.4.2.1.3.3.3"><mi id="A2.Ex4.m2.4.4.2.1.3.3.3.2">Î¼</mi><mo id="A2.Ex4.m2.4.4.2.1.3.3.3.1">^</mo></mover><mo id="A2.Ex4.m2.4.4.2.1.3.3.4">,</mo><msub id="A2.Ex4.m2.4.4.2.1.3.3.5"><mi id="A2.Ex4.m2.4.4.2.1.3.3.5.2">ğ²</mi><mrow id="A2.Ex4.m2.4.4.2.1.3.3.5.3"><mn id="A2.Ex4.m2.4.4.2.1.3.3.5.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex4.m2.4.4.2.1.3.3.5.3.1">:</mo><mrow id="A2.Ex4.m2.4.4.2.1.3.3.5.3.3"><mi id="A2.Ex4.m2.4.4.2.1.3.3.5.3.3.2">j</mi><mo id="A2.Ex4.m2.4.4.2.1.3.3.5.3.3.1">âˆ’</mo><mn id="A2.Ex4.m2.4.4.2.1.3.3.5.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex4.m2.4.4.2.1.3.3.6">âˆ¼</mo><msub id="A2.Ex4.m2.4.4.2.1.3.3.7"><mi id="A2.Ex4.m2.4.4.2.1.3.3.7.2">Ï€</mi><mtext id="A2.Ex4.m2.4.4.2.1.3.3.7.3">neg</mtext></msub><mrow id="A2.Ex4.m2.4.4.2.1.3.3.8"><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.3.3.8.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.4.4.2.1.3.3.8.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex4.m2.4.4.2.1.3.3.8.3">|</mo><mi id="A2.Ex4.m2.4.4.2.1.3.3.8.4">ğ±</mi><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.3.3.8.5">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.4.4.2.1.2">â€‹</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1"><mo id="A2.Ex4.m2.4.4.2.1.1.1.2">[</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex4.m2.4.4.2.1.1.1.1.4"><munder id="A2.Ex4.m2.4.4.2.1.1.1.1.4a"><mo movablelimits="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.4.2">âˆ‘</mo><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.4.3"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.4.3.2">ğ²</mi><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.4.3.3">j</mi></msub></munder></mstyle><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.3"><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.3.5"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.3.5.2">Ï€</mi><mtext id="A2.Ex4.m2.4.4.2.1.1.1.1.3.5.3">neg</mtext></msub><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.4">â€‹</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.2">(</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1"><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.3"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.3.2">ğ²</mi><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.3.3">j</mi></msub><mo fence="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.2">|</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex4.m2.1.1">ğ±</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.2">,</mo><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.3"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2">j</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.1.1.1.3">)</mo></mrow><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.4a">â€‹</mo><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6"><mover accent="true" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.2"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.2.2">A</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.2.1">^</mo></mover><mover accent="true" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.3"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.3.2">Ï€</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.3.6.3.1">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.4b">â€‹</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2"><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.3">(</mo><mi id="A2.Ex4.m2.2.2">ğ±</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.4">,</mo><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.2">ğ²</mi><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3"><mn id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.1">:</mo><mrow id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.3"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.3.2">i</mi><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.3.1">âˆ’</mo><mn id="A2.Ex4.m2.4.4.2.1.1.1.1.2.2.1.1.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.5">,</mo><msub id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.2"><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.2.2">ğ²</mi><mi id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.2.3">i</mi></msub><mo stretchy="false" id="A2.Ex4.m2.4.4.2.1.1.1.1.3.3.2.6">)</mo></mrow></mrow></mrow><mo id="A2.Ex4.m2.4.4.2.1.1.1.3">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A2.Ex4.m2.4b">\displaystyle-\widehat{J}(\pi_{\mathrm{sft}})=\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{\mathbf{y}_{j}}\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\hat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex5.m1.8" class="ltx_math_unparsed" alttext="\displaystyle=\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{\mathbf{y}_{j}}\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\log\frac{\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\cdot\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})}{\pi_{\mathrm{sft}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})}\right]" display="inline"><semantics id="A2.Ex5.m1.8a"><mrow id="A2.Ex5.m1.8.8"><mi id="A2.Ex5.m1.8.8.3"></mi><mo id="A2.Ex5.m1.8.8.2">=</mo><mrow id="A2.Ex5.m1.8.8.1"><mstyle displaystyle="true" id="A2.Ex5.m1.8.8.1.2"><munderover id="A2.Ex5.m1.8.8.1.2a"><mo movablelimits="false" id="A2.Ex5.m1.8.8.1.2.2.2">âˆ‘</mo><mrow id="A2.Ex5.m1.8.8.1.2.2.3"><mi id="A2.Ex5.m1.8.8.1.2.2.3.2">j</mi><mo id="A2.Ex5.m1.8.8.1.2.2.3.1">=</mo><mn id="A2.Ex5.m1.8.8.1.2.2.3.3">1</mn></mrow><mi id="A2.Ex5.m1.8.8.1.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex5.m1.8.8.1.1"><msub id="A2.Ex5.m1.8.8.1.1.3"><mi id="A2.Ex5.m1.8.8.1.1.3.2">ğ”¼</mi><mrow id="A2.Ex5.m1.8.8.1.1.3.3"><mi id="A2.Ex5.m1.8.8.1.1.3.3.1">ğ±</mi><mo id="A2.Ex5.m1.8.8.1.1.3.3.2">âˆ¼</mo><mover accent="true" id="A2.Ex5.m1.8.8.1.1.3.3.3"><mi id="A2.Ex5.m1.8.8.1.1.3.3.3.2">Î¼</mi><mo id="A2.Ex5.m1.8.8.1.1.3.3.3.1">^</mo></mover><mo id="A2.Ex5.m1.8.8.1.1.3.3.4">,</mo><msub id="A2.Ex5.m1.8.8.1.1.3.3.5"><mi id="A2.Ex5.m1.8.8.1.1.3.3.5.2">ğ²</mi><mrow id="A2.Ex5.m1.8.8.1.1.3.3.5.3"><mn id="A2.Ex5.m1.8.8.1.1.3.3.5.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex5.m1.8.8.1.1.3.3.5.3.1">:</mo><mrow id="A2.Ex5.m1.8.8.1.1.3.3.5.3.3"><mi id="A2.Ex5.m1.8.8.1.1.3.3.5.3.3.2">j</mi><mo id="A2.Ex5.m1.8.8.1.1.3.3.5.3.3.1">âˆ’</mo><mn id="A2.Ex5.m1.8.8.1.1.3.3.5.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex5.m1.8.8.1.1.3.3.6">âˆ¼</mo><msub id="A2.Ex5.m1.8.8.1.1.3.3.7"><mi id="A2.Ex5.m1.8.8.1.1.3.3.7.2">Ï€</mi><mtext id="A2.Ex5.m1.8.8.1.1.3.3.7.3">neg</mtext></msub><mrow id="A2.Ex5.m1.8.8.1.1.3.3.8"><mo stretchy="false" id="A2.Ex5.m1.8.8.1.1.3.3.8.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.8.8.1.1.3.3.8.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex5.m1.8.8.1.1.3.3.8.3">|</mo><mi id="A2.Ex5.m1.8.8.1.1.3.3.8.4">ğ±</mi><mo stretchy="false" id="A2.Ex5.m1.8.8.1.1.3.3.8.5">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.8.8.1.1.2">â€‹</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1"><mo id="A2.Ex5.m1.8.8.1.1.1.1.2">[</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex5.m1.8.8.1.1.1.1.1.2"><munder id="A2.Ex5.m1.8.8.1.1.1.1.1.2a"><mo movablelimits="false" id="A2.Ex5.m1.8.8.1.1.1.1.1.2.2">âˆ‘</mo><msub id="A2.Ex5.m1.8.8.1.1.1.1.1.2.3"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.2.3.2">ğ²</mi><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.2.3.3">j</mi></msub></munder></mstyle><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1"><msub id="A2.Ex5.m1.8.8.1.1.1.1.1.1.3"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.3.2">Ï€</mi><mtext id="A2.Ex5.m1.8.8.1.1.1.1.1.1.3.3">neg</mtext></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2">(</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1"><msub id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.3"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.3.2">ğ²</mi><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.3.3">j</mi></msub><mo fence="false" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.2">|</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex5.m1.7.7">ğ±</mi><mo id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2">,</mo><msub id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">j</mi><mo id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.2a">â€‹</mo><mrow id="A2.Ex5.m1.8.8.1.1.1.1.1.1.4"><mi id="A2.Ex5.m1.8.8.1.1.1.1.1.1.4.1">log</mi><mo lspace="0.167em" id="A2.Ex5.m1.8.8.1.1.1.1.1.1.4a">â¡</mo><mstyle displaystyle="true" id="A2.Ex5.m1.6.6"><mfrac id="A2.Ex5.m1.6.6a"><mrow id="A2.Ex5.m1.4.4.4"><mrow id="A2.Ex5.m1.3.3.3.3"><mrow id="A2.Ex5.m1.3.3.3.3.1"><msub id="A2.Ex5.m1.3.3.3.3.1.3"><mi id="A2.Ex5.m1.3.3.3.3.1.3.2">Ï€</mi><mtext id="A2.Ex5.m1.3.3.3.3.1.3.3">neg</mtext></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.3.3.3.3.1.2">â€‹</mo><mrow id="A2.Ex5.m1.3.3.3.3.1.1.1"><mo stretchy="false" id="A2.Ex5.m1.3.3.3.3.1.1.1.2">(</mo><mrow id="A2.Ex5.m1.3.3.3.3.1.1.1.1"><msub id="A2.Ex5.m1.3.3.3.3.1.1.1.1.3"><mi id="A2.Ex5.m1.3.3.3.3.1.1.1.1.3.2">ğ²</mi><mi id="A2.Ex5.m1.3.3.3.3.1.1.1.1.3.3">j</mi></msub><mo fence="false" id="A2.Ex5.m1.3.3.3.3.1.1.1.1.2">|</mo><mrow id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1"><mi id="A2.Ex5.m1.1.1.1.1">ğ±</mi><mo id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.2">,</mo><msub id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1"><mi id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3"><mn id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.1">:</mo><mrow id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.3"><mi id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.2">j</mi><mo id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A2.Ex5.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="A2.Ex5.m1.3.3.3.3.1.1.1.3">)</mo></mrow></mrow><mo rspace="0.222em" id="A2.Ex5.m1.3.3.3.3.2">â‹…</mo><mover accent="true" id="A2.Ex5.m1.3.3.3.3.3"><mi id="A2.Ex5.m1.3.3.3.3.3.2">â„¤</mi><mo id="A2.Ex5.m1.3.3.3.3.3.1">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.4.4.4.5">â€‹</mo><mrow id="A2.Ex5.m1.4.4.4.4.1"><mo stretchy="false" id="A2.Ex5.m1.4.4.4.4.1.2">(</mo><mi id="A2.Ex5.m1.2.2.2.2">ğ±</mi><mo id="A2.Ex5.m1.4.4.4.4.1.3">,</mo><msub id="A2.Ex5.m1.4.4.4.4.1.1"><mi id="A2.Ex5.m1.4.4.4.4.1.1.2">ğ²</mi><mrow id="A2.Ex5.m1.4.4.4.4.1.1.3"><mn id="A2.Ex5.m1.4.4.4.4.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex5.m1.4.4.4.4.1.1.3.1">:</mo><mi id="A2.Ex5.m1.4.4.4.4.1.1.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex5.m1.4.4.4.4.1.4">)</mo></mrow></mrow><mrow id="A2.Ex5.m1.6.6.6"><msub id="A2.Ex5.m1.6.6.6.4"><mi id="A2.Ex5.m1.6.6.6.4.2">Ï€</mi><mi id="A2.Ex5.m1.6.6.6.4.3">sft</mi></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.6.6.6.3">â€‹</mo><mrow id="A2.Ex5.m1.6.6.6.2.1"><mo stretchy="false" id="A2.Ex5.m1.6.6.6.2.1.2">(</mo><mrow id="A2.Ex5.m1.6.6.6.2.1.1"><msub id="A2.Ex5.m1.6.6.6.2.1.1.3"><mi id="A2.Ex5.m1.6.6.6.2.1.1.3.2">ğ²</mi><mi id="A2.Ex5.m1.6.6.6.2.1.1.3.3">j</mi></msub><mo fence="false" id="A2.Ex5.m1.6.6.6.2.1.1.2">|</mo><mrow id="A2.Ex5.m1.6.6.6.2.1.1.1.1"><mi id="A2.Ex5.m1.5.5.5.1">ğ±</mi><mo id="A2.Ex5.m1.6.6.6.2.1.1.1.1.2">,</mo><msub id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1"><mi id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3"><mn id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.1">:</mo><mrow id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.3"><mi id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.3.2">j</mi><mo id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.3.1">âˆ’</mo><mn id="A2.Ex5.m1.6.6.6.2.1.1.1.1.1.3.3.3">1</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="A2.Ex5.m1.6.6.6.2.1.3">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="A2.Ex5.m1.8.8.1.1.1.1.3">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A2.Ex5.m1.8b">\displaystyle=\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{\mathbf{y}_{j}}\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\log\frac{\pi_{\text{neg}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})\cdot\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})}{\pi_{\mathrm{sft}}(\mathbf{y}_{j}|\mathbf{x},\mathbf{y}_{0:j-1})}\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex6.m1.1" class="ltx_math_unparsed" alttext="\displaystyle=\beta\cdot\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[D_{\mathrm{KL}}\left(\pi_{\text{neg}}(\cdot|\mathbf{x},\mathbf{y}_{0:j-1}),\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:j-1})\right)+\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]" display="inline"><semantics id="A2.Ex6.m1.1a"><mrow id="A2.Ex6.m1.1b"><mo id="A2.Ex6.m1.1.1">=</mo><mi id="A2.Ex6.m1.1.2">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex6.m1.1.3">â‹…</mo><mstyle displaystyle="true" id="A2.Ex6.m1.1.4"><munderover id="A2.Ex6.m1.1.4a"><mo movablelimits="false" id="A2.Ex6.m1.1.4.2.2">âˆ‘</mo><mrow id="A2.Ex6.m1.1.4.2.3"><mi id="A2.Ex6.m1.1.4.2.3.2">j</mi><mo id="A2.Ex6.m1.1.4.2.3.1">=</mo><mn id="A2.Ex6.m1.1.4.2.3.3">1</mn></mrow><mi id="A2.Ex6.m1.1.4.3">L</mi></munderover></mstyle><msub id="A2.Ex6.m1.1.5"><mi id="A2.Ex6.m1.1.5.2">ğ”¼</mi><mrow id="A2.Ex6.m1.1.5.3"><mi id="A2.Ex6.m1.1.5.3.1">ğ±</mi><mo id="A2.Ex6.m1.1.5.3.2">âˆ¼</mo><mover accent="true" id="A2.Ex6.m1.1.5.3.3"><mi id="A2.Ex6.m1.1.5.3.3.2">Î¼</mi><mo id="A2.Ex6.m1.1.5.3.3.1">^</mo></mover><mo id="A2.Ex6.m1.1.5.3.4">,</mo><msub id="A2.Ex6.m1.1.5.3.5"><mi id="A2.Ex6.m1.1.5.3.5.2">ğ²</mi><mrow id="A2.Ex6.m1.1.5.3.5.3"><mn id="A2.Ex6.m1.1.5.3.5.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex6.m1.1.5.3.5.3.1">:</mo><mrow id="A2.Ex6.m1.1.5.3.5.3.3"><mi id="A2.Ex6.m1.1.5.3.5.3.3.2">j</mi><mo id="A2.Ex6.m1.1.5.3.5.3.3.1">âˆ’</mo><mn id="A2.Ex6.m1.1.5.3.5.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex6.m1.1.5.3.6">âˆ¼</mo><msub id="A2.Ex6.m1.1.5.3.7"><mi id="A2.Ex6.m1.1.5.3.7.2">Ï€</mi><mtext id="A2.Ex6.m1.1.5.3.7.3">neg</mtext></msub><mrow id="A2.Ex6.m1.1.5.3.8"><mo stretchy="false" id="A2.Ex6.m1.1.5.3.8.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex6.m1.1.5.3.8.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex6.m1.1.5.3.8.3">|</mo><mi id="A2.Ex6.m1.1.5.3.8.4">ğ±</mi><mo stretchy="false" id="A2.Ex6.m1.1.5.3.8.5">)</mo></mrow></mrow></msub><mrow id="A2.Ex6.m1.1.6"><mo id="A2.Ex6.m1.1.6.1">[</mo><msub id="A2.Ex6.m1.1.6.2"><mi id="A2.Ex6.m1.1.6.2.2">D</mi><mi id="A2.Ex6.m1.1.6.2.3">KL</mi></msub><mrow id="A2.Ex6.m1.1.6.3"><mo id="A2.Ex6.m1.1.6.3.1">(</mo><msub id="A2.Ex6.m1.1.6.3.2"><mi id="A2.Ex6.m1.1.6.3.2.2">Ï€</mi><mtext id="A2.Ex6.m1.1.6.3.2.3">neg</mtext></msub><mrow id="A2.Ex6.m1.1.6.3.3"><mo stretchy="false" id="A2.Ex6.m1.1.6.3.3.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex6.m1.1.6.3.3.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex6.m1.1.6.3.3.3">|</mo><mi id="A2.Ex6.m1.1.6.3.3.4">ğ±</mi><mo id="A2.Ex6.m1.1.6.3.3.5">,</mo><msub id="A2.Ex6.m1.1.6.3.3.6"><mi id="A2.Ex6.m1.1.6.3.3.6.2">ğ²</mi><mrow id="A2.Ex6.m1.1.6.3.3.6.3"><mn id="A2.Ex6.m1.1.6.3.3.6.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex6.m1.1.6.3.3.6.3.1">:</mo><mrow id="A2.Ex6.m1.1.6.3.3.6.3.3"><mi id="A2.Ex6.m1.1.6.3.3.6.3.3.2">j</mi><mo id="A2.Ex6.m1.1.6.3.3.6.3.3.1">âˆ’</mo><mn id="A2.Ex6.m1.1.6.3.3.6.3.3.3">1</mn></mrow></mrow></msub><mo stretchy="false" id="A2.Ex6.m1.1.6.3.3.7">)</mo></mrow><mo id="A2.Ex6.m1.1.6.3.4">,</mo><msub id="A2.Ex6.m1.1.6.3.5"><mi id="A2.Ex6.m1.1.6.3.5.2">Ï€</mi><mi id="A2.Ex6.m1.1.6.3.5.3">sft</mi></msub><mrow id="A2.Ex6.m1.1.6.3.6"><mo stretchy="false" id="A2.Ex6.m1.1.6.3.6.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex6.m1.1.6.3.6.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex6.m1.1.6.3.6.3">|</mo><mi id="A2.Ex6.m1.1.6.3.6.4">ğ±</mi><mo id="A2.Ex6.m1.1.6.3.6.5">,</mo><msub id="A2.Ex6.m1.1.6.3.6.6"><mi id="A2.Ex6.m1.1.6.3.6.6.2">ğ²</mi><mrow id="A2.Ex6.m1.1.6.3.6.6.3"><mn id="A2.Ex6.m1.1.6.3.6.6.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex6.m1.1.6.3.6.6.3.1">:</mo><mrow id="A2.Ex6.m1.1.6.3.6.6.3.3"><mi id="A2.Ex6.m1.1.6.3.6.6.3.3.2">j</mi><mo id="A2.Ex6.m1.1.6.3.6.6.3.3.1">âˆ’</mo><mn id="A2.Ex6.m1.1.6.3.6.6.3.3.3">1</mn></mrow></mrow></msub><mo stretchy="false" id="A2.Ex6.m1.1.6.3.6.7">)</mo></mrow><mo id="A2.Ex6.m1.1.6.3.7">)</mo></mrow><mo id="A2.Ex6.m1.1.6.4">+</mo><mi id="A2.Ex6.m1.1.6.5">log</mi><mover accent="true" id="A2.Ex6.m1.1.6.6"><mi id="A2.Ex6.m1.1.6.6.2">â„¤</mi><mo id="A2.Ex6.m1.1.6.6.1">^</mo></mover><mrow id="A2.Ex6.m1.1.6.7"><mo stretchy="false" id="A2.Ex6.m1.1.6.7.1">(</mo><mi id="A2.Ex6.m1.1.6.7.2">ğ±</mi><mo id="A2.Ex6.m1.1.6.7.3">,</mo><msub id="A2.Ex6.m1.1.6.7.4"><mi id="A2.Ex6.m1.1.6.7.4.2">ğ²</mi><mrow id="A2.Ex6.m1.1.6.7.4.3"><mn id="A2.Ex6.m1.1.6.7.4.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex6.m1.1.6.7.4.3.1">:</mo><mi id="A2.Ex6.m1.1.6.7.4.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex6.m1.1.6.7.5">)</mo></mrow><mo id="A2.Ex6.m1.1.6.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A2.Ex6.m1.1c">\displaystyle=\beta\cdot\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[D_{\mathrm{KL}}\left(\pi_{\text{neg}}(\cdot|\mathbf{x},\mathbf{y}_{0:j-1}),\pi_{\mathrm{sft}}(\cdot|\mathbf{x},\mathbf{y}_{0:j-1})\right)+\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex7.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\geq\beta\cdot\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]." display="inline"><semantics id="A2.Ex7.m1.2a"><mrow id="A2.Ex7.m1.2.2.1"><mrow id="A2.Ex7.m1.2.2.1.1"><mi id="A2.Ex7.m1.2.2.1.1.3"></mi><mo id="A2.Ex7.m1.2.2.1.1.2">â‰¥</mo><mrow id="A2.Ex7.m1.2.2.1.1.1"><mi id="A2.Ex7.m1.2.2.1.1.1.3">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex7.m1.2.2.1.1.1.2">â‹…</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex7.m1.2.2.1.1.1.1.2"><munderover id="A2.Ex7.m1.2.2.1.1.1.1.2a"><mo movablelimits="false" id="A2.Ex7.m1.2.2.1.1.1.1.2.2.2">âˆ‘</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1.2.2.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.2.2.3.2">j</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.2.2.3.1">=</mo><mn id="A2.Ex7.m1.2.2.1.1.1.1.2.2.3.3">1</mn></mrow><mi id="A2.Ex7.m1.2.2.1.1.1.1.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1"><msub id="A2.Ex7.m1.2.2.1.1.1.1.1.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.2">ğ”¼</mi><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.1">ğ±</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.2">âˆ¼</mo><mover accent="true" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.3.2">Î¼</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.3.1">^</mo></mover><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.4">,</mo><msub id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.2">ğ²</mi><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3"><mn id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.1">:</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.3.2">j</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.3.1">âˆ’</mo><mn id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.5.3.3.3">1</mn></mrow></mrow></msub><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.6">âˆ¼</mo><msub id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.7"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.7.2">Ï€</mi><mtext id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.7.3">neg</mtext></msub><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8"><mo stretchy="false" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8.3">|</mo><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8.4">ğ±</mi><mo stretchy="false" id="A2.Ex7.m1.2.2.1.1.1.1.1.3.3.8.5">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A2.Ex7.m1.2.2.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1"><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.2">[</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1"><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3a">â¡</mo><mover accent="true" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">â„¤</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2.1">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">(</mo><mi id="A2.Ex7.m1.1.1">ğ±</mi><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">,</mo><msub id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mi id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.4">)</mo></mrow></mrow><mo id="A2.Ex7.m1.2.2.1.1.1.1.1.1.1.3">]</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A2.Ex7.m1.2.2.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="A2.Ex7.m1.2b">\displaystyle\geq\beta\cdot\sum_{j=1}^{L}\mathbb{E}_{\mathbf{x}\sim\widehat{\mu},\mathbf{y}_{0:j-1}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex8.m1.4" class="ltx_math_unparsed" alttext="\displaystyle=\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log\mathbb{Z}(\mathbf{x},\mathbf{y}_{0:j})\right]." display="inline"><semantics id="A2.Ex8.m1.4a"><mrow id="A2.Ex8.m1.4.4.1"><mrow id="A2.Ex8.m1.4.4.1.1"><mi id="A2.Ex8.m1.4.4.1.1.3"></mi><mo id="A2.Ex8.m1.4.4.1.1.2">=</mo><mrow id="A2.Ex8.m1.4.4.1.1.1"><mrow id="A2.Ex8.m1.4.4.1.1.1.3"><mi id="A2.Ex8.m1.4.4.1.1.1.3.2">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex8.m1.4.4.1.1.1.3.1">â‹…</mo><msub id="A2.Ex8.m1.4.4.1.1.1.3.3"><mi id="A2.Ex8.m1.4.4.1.1.1.3.3.2">ğ”¼</mi><mrow id="A2.Ex8.m1.2.2.2"><mi id="A2.Ex8.m1.2.2.2.3">ğ±</mi><mo id="A2.Ex8.m1.2.2.2.4">âˆ¼</mo><mover accent="true" id="A2.Ex8.m1.2.2.2.5"><mi id="A2.Ex8.m1.2.2.2.5.2">Î¼</mi><mo id="A2.Ex8.m1.2.2.2.5.1">^</mo></mover><mo id="A2.Ex8.m1.2.2.2.6">,</mo><msub id="A2.Ex8.m1.2.2.2.7"><mi id="A2.Ex8.m1.2.2.2.7.2">ğ²</mi><mrow id="A2.Ex8.m1.2.2.2.2.2"><mrow id="A2.Ex8.m1.2.2.2.2.2.4.2"><mi id="A2.Ex8.m1.1.1.1.1.1.1">i</mi><mo id="A2.Ex8.m1.2.2.2.2.2.4.2.1">,</mo><mn id="A2.Ex8.m1.2.2.2.2.2.2">0</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="A2.Ex8.m1.2.2.2.2.2.3">:</mo><mi id="A2.Ex8.m1.2.2.2.2.2.5">L</mi></mrow></msub><mo id="A2.Ex8.m1.2.2.2.8">âˆ¼</mo><msub id="A2.Ex8.m1.2.2.2.9"><mi id="A2.Ex8.m1.2.2.2.9.2">Ï€</mi><mtext id="A2.Ex8.m1.2.2.2.9.3">neg</mtext></msub><mrow id="A2.Ex8.m1.2.2.2.10"><mo stretchy="false" id="A2.Ex8.m1.2.2.2.10.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex8.m1.2.2.2.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex8.m1.2.2.2.10.3">|</mo><mi id="A2.Ex8.m1.2.2.2.10.4">ğ±</mi><mo stretchy="false" id="A2.Ex8.m1.2.2.2.10.5">)</mo></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A2.Ex8.m1.4.4.1.1.1.2">â€‹</mo><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1"><mo id="A2.Ex8.m1.4.4.1.1.1.1.1.2">[</mo><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2"><munderover id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2a"><mo movablelimits="false" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.2.2">âˆ‘</mo><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.2.3"><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.2.3.2">j</mi><mo id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.2.3.1">=</mo><mn id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</mn></mrow><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1"><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.3"><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.3a">â¡</mo><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2">â„¤</mi></mrow><mo lspace="0em" rspace="0em" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.2">(</mo><mi id="A2.Ex8.m1.3.3">ğ±</mi><mo id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.3">,</mo><msub id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mi id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.4">)</mo></mrow></mrow></mrow><mo id="A2.Ex8.m1.4.4.1.1.1.1.1.3">]</mo></mrow></mrow></mrow><mo lspace="0em" id="A2.Ex8.m1.4.4.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="A2.Ex8.m1.4b">\displaystyle=\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log\mathbb{Z}(\mathbf{x},\mathbf{y}_{0:j})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.1.p1.7" class="ltx_p">Now, we can prove the desired result by accounting for the gap in the success rate between the actual distribution over <math id="A2.1.p1.6.m1.1" class="ltx_Math" alttext="\mathbf{x}\sim\mu" display="inline"><semantics id="A2.1.p1.6.m1.1a"><mrow id="A2.1.p1.6.m1.1.1" xref="A2.1.p1.6.m1.1.1.cmml"><mi id="A2.1.p1.6.m1.1.1.2" xref="A2.1.p1.6.m1.1.1.2.cmml">ğ±</mi><mo id="A2.1.p1.6.m1.1.1.1" xref="A2.1.p1.6.m1.1.1.1.cmml">âˆ¼</mo><mi id="A2.1.p1.6.m1.1.1.3" xref="A2.1.p1.6.m1.1.1.3.cmml">Î¼</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.6.m1.1b"><apply id="A2.1.p1.6.m1.1.1.cmml" xref="A2.1.p1.6.m1.1.1"><csymbol cd="latexml" id="A2.1.p1.6.m1.1.1.1.cmml" xref="A2.1.p1.6.m1.1.1.1">similar-to</csymbol><ci id="A2.1.p1.6.m1.1.1.2.cmml" xref="A2.1.p1.6.m1.1.1.2">ğ±</ci><ci id="A2.1.p1.6.m1.1.1.3.cmml" xref="A2.1.p1.6.m1.1.1.3">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.6.m1.1c">\mathbf{x}\sim\mu</annotation></semantics></math> and the empirical distribution induced by problems in the dataset <math id="A2.1.p1.7.m2.1" class="ltx_Math" alttext="\widehat{\mu}" display="inline"><semantics id="A2.1.p1.7.m2.1a"><mover accent="true" id="A2.1.p1.7.m2.1.1" xref="A2.1.p1.7.m2.1.1.cmml"><mi id="A2.1.p1.7.m2.1.1.2" xref="A2.1.p1.7.m2.1.1.2.cmml">Î¼</mi><mo id="A2.1.p1.7.m2.1.1.1" xref="A2.1.p1.7.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A2.1.p1.7.m2.1b"><apply id="A2.1.p1.7.m2.1.1.cmml" xref="A2.1.p1.7.m2.1.1"><ci id="A2.1.p1.7.m2.1.1.1.cmml" xref="A2.1.p1.7.m2.1.1.1">^</ci><ci id="A2.1.p1.7.m2.1.1.2.cmml" xref="A2.1.p1.7.m2.1.1.2">ğœ‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.7.m2.1c">\widehat{\mu}</annotation></semantics></math>:</p>
<table id="A7.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex9.m1.2" class="ltx_Math" alttext="\displaystyle J(\pi_{\text{neg}})-J(\pi_{\mathrm{sft}})" display="inline"><semantics id="A2.Ex9.m1.2a"><mrow id="A2.Ex9.m1.2.2" xref="A2.Ex9.m1.2.2.cmml"><mrow id="A2.Ex9.m1.1.1.1" xref="A2.Ex9.m1.1.1.1.cmml"><mi id="A2.Ex9.m1.1.1.1.3" xref="A2.Ex9.m1.1.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex9.m1.1.1.1.2" xref="A2.Ex9.m1.1.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex9.m1.1.1.1.1.1" xref="A2.Ex9.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m1.1.1.1.1.1.2" xref="A2.Ex9.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex9.m1.1.1.1.1.1.1" xref="A2.Ex9.m1.1.1.1.1.1.1.cmml"><mi id="A2.Ex9.m1.1.1.1.1.1.1.2" xref="A2.Ex9.m1.1.1.1.1.1.1.2.cmml">Ï€</mi><mtext id="A2.Ex9.m1.1.1.1.1.1.1.3" xref="A2.Ex9.m1.1.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex9.m1.1.1.1.1.1.3" xref="A2.Ex9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex9.m1.2.2.3" xref="A2.Ex9.m1.2.2.3.cmml">âˆ’</mo><mrow id="A2.Ex9.m1.2.2.2" xref="A2.Ex9.m1.2.2.2.cmml"><mi id="A2.Ex9.m1.2.2.2.3" xref="A2.Ex9.m1.2.2.2.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex9.m1.2.2.2.2" xref="A2.Ex9.m1.2.2.2.2.cmml">â€‹</mo><mrow id="A2.Ex9.m1.2.2.2.1.1" xref="A2.Ex9.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m1.2.2.2.1.1.2" xref="A2.Ex9.m1.2.2.2.1.1.1.cmml">(</mo><msub id="A2.Ex9.m1.2.2.2.1.1.1" xref="A2.Ex9.m1.2.2.2.1.1.1.cmml"><mi id="A2.Ex9.m1.2.2.2.1.1.1.2" xref="A2.Ex9.m1.2.2.2.1.1.1.2.cmml">Ï€</mi><mi id="A2.Ex9.m1.2.2.2.1.1.1.3" xref="A2.Ex9.m1.2.2.2.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A2.Ex9.m1.2.2.2.1.1.3" xref="A2.Ex9.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex9.m1.2b"><apply id="A2.Ex9.m1.2.2.cmml" xref="A2.Ex9.m1.2.2"><minus id="A2.Ex9.m1.2.2.3.cmml" xref="A2.Ex9.m1.2.2.3"></minus><apply id="A2.Ex9.m1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1"><times id="A2.Ex9.m1.1.1.1.2.cmml" xref="A2.Ex9.m1.1.1.1.2"></times><ci id="A2.Ex9.m1.1.1.1.3.cmml" xref="A2.Ex9.m1.1.1.1.3">ğ½</ci><apply id="A2.Ex9.m1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex9.m1.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.1.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m1.1.1.1.1.1.1.3a.cmml" xref="A2.Ex9.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="A2.Ex9.m1.1.1.1.1.1.1.3.cmml" xref="A2.Ex9.m1.1.1.1.1.1.1.3">neg</mtext></ci></apply></apply><apply id="A2.Ex9.m1.2.2.2.cmml" xref="A2.Ex9.m1.2.2.2"><times id="A2.Ex9.m1.2.2.2.2.cmml" xref="A2.Ex9.m1.2.2.2.2"></times><ci id="A2.Ex9.m1.2.2.2.3.cmml" xref="A2.Ex9.m1.2.2.2.3">ğ½</ci><apply id="A2.Ex9.m1.2.2.2.1.1.1.cmml" xref="A2.Ex9.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m1.2.2.2.1.1.1.1.cmml" xref="A2.Ex9.m1.2.2.2.1.1">subscript</csymbol><ci id="A2.Ex9.m1.2.2.2.1.1.1.2.cmml" xref="A2.Ex9.m1.2.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m1.2.2.2.1.1.1.3.cmml" xref="A2.Ex9.m1.2.2.2.1.1.1.3">sft</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex9.m1.2c">\displaystyle J(\pi_{\text{neg}})-J(\pi_{\mathrm{sft}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex9.m2.6" class="ltx_Math" alttext="\displaystyle\geq\underbrace{J(\pi_{\text{neg}})-\widehat{J}(\pi_{\text{neg}})}_{\text{(a)}}+\underbrace{\widehat{J}(\pi_{\text{neg}})-\widehat{J}(\pi_{\mathrm{sft}})}_{\text{(b)}}-\underbrace{J(\pi_{\mathrm{sft}})-\widehat{J}(\pi_{\mathrm{sft}})}_{\text{(c)}}" display="inline"><semantics id="A2.Ex9.m2.6a"><mrow id="A2.Ex9.m2.6.7" xref="A2.Ex9.m2.6.7.cmml"><mi id="A2.Ex9.m2.6.7.2" xref="A2.Ex9.m2.6.7.2.cmml"></mi><mo id="A2.Ex9.m2.6.7.1" xref="A2.Ex9.m2.6.7.1.cmml">â‰¥</mo><mrow id="A2.Ex9.m2.6.7.3" xref="A2.Ex9.m2.6.7.3.cmml"><mrow id="A2.Ex9.m2.6.7.3.2" xref="A2.Ex9.m2.6.7.3.2.cmml"><munder id="A2.Ex9.m2.6.7.3.2.2" xref="A2.Ex9.m2.6.7.3.2.2.cmml"><munder accentunder="true" id="A2.Ex9.m2.2.2" xref="A2.Ex9.m2.2.2.cmml"><mrow id="A2.Ex9.m2.2.2.2" xref="A2.Ex9.m2.2.2.2.cmml"><mrow id="A2.Ex9.m2.1.1.1.1" xref="A2.Ex9.m2.1.1.1.1.cmml"><mi id="A2.Ex9.m2.1.1.1.1.3" xref="A2.Ex9.m2.1.1.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.1.1.1.1.2" xref="A2.Ex9.m2.1.1.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.1.1.1.1.1.1" xref="A2.Ex9.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.1.1.1.1.1.1.2" xref="A2.Ex9.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.1.1.1.1.1.1.1" xref="A2.Ex9.m2.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex9.m2.1.1.1.1.1.1.1.2" xref="A2.Ex9.m2.1.1.1.1.1.1.1.2.cmml">Ï€</mi><mtext id="A2.Ex9.m2.1.1.1.1.1.1.1.3" xref="A2.Ex9.m2.1.1.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex9.m2.1.1.1.1.1.1.3" xref="A2.Ex9.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex9.m2.2.2.2.3" xref="A2.Ex9.m2.2.2.2.3.cmml">âˆ’</mo><mrow id="A2.Ex9.m2.2.2.2.2" xref="A2.Ex9.m2.2.2.2.2.cmml"><mover accent="true" id="A2.Ex9.m2.2.2.2.2.3" xref="A2.Ex9.m2.2.2.2.2.3.cmml"><mi id="A2.Ex9.m2.2.2.2.2.3.2" xref="A2.Ex9.m2.2.2.2.2.3.2.cmml">J</mi><mo id="A2.Ex9.m2.2.2.2.2.3.1" xref="A2.Ex9.m2.2.2.2.2.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.2.2.2.2.2" xref="A2.Ex9.m2.2.2.2.2.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.2.2.2.2.1.1" xref="A2.Ex9.m2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.2.2.2.2.1.1.2" xref="A2.Ex9.m2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.2.2.2.2.1.1.1" xref="A2.Ex9.m2.2.2.2.2.1.1.1.cmml"><mi id="A2.Ex9.m2.2.2.2.2.1.1.1.2" xref="A2.Ex9.m2.2.2.2.2.1.1.1.2.cmml">Ï€</mi><mtext id="A2.Ex9.m2.2.2.2.2.1.1.1.3" xref="A2.Ex9.m2.2.2.2.2.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex9.m2.2.2.2.2.1.1.3" xref="A2.Ex9.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex9.m2.2.2.3" xref="A2.Ex9.m2.2.2.3.cmml">âŸ</mo></munder><mtext id="A2.Ex9.m2.6.7.3.2.2.2" xref="A2.Ex9.m2.6.7.3.2.2.2a.cmml">(a)</mtext></munder><mo id="A2.Ex9.m2.6.7.3.2.1" xref="A2.Ex9.m2.6.7.3.2.1.cmml">+</mo><munder id="A2.Ex9.m2.6.7.3.2.3" xref="A2.Ex9.m2.6.7.3.2.3.cmml"><munder accentunder="true" id="A2.Ex9.m2.4.4" xref="A2.Ex9.m2.4.4.cmml"><mrow id="A2.Ex9.m2.4.4.2" xref="A2.Ex9.m2.4.4.2.cmml"><mrow id="A2.Ex9.m2.3.3.1.1" xref="A2.Ex9.m2.3.3.1.1.cmml"><mover accent="true" id="A2.Ex9.m2.3.3.1.1.3" xref="A2.Ex9.m2.3.3.1.1.3.cmml"><mi id="A2.Ex9.m2.3.3.1.1.3.2" xref="A2.Ex9.m2.3.3.1.1.3.2.cmml">J</mi><mo id="A2.Ex9.m2.3.3.1.1.3.1" xref="A2.Ex9.m2.3.3.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.3.3.1.1.2" xref="A2.Ex9.m2.3.3.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.3.3.1.1.1.1" xref="A2.Ex9.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.3.3.1.1.1.1.2" xref="A2.Ex9.m2.3.3.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.3.3.1.1.1.1.1" xref="A2.Ex9.m2.3.3.1.1.1.1.1.cmml"><mi id="A2.Ex9.m2.3.3.1.1.1.1.1.2" xref="A2.Ex9.m2.3.3.1.1.1.1.1.2.cmml">Ï€</mi><mtext id="A2.Ex9.m2.3.3.1.1.1.1.1.3" xref="A2.Ex9.m2.3.3.1.1.1.1.1.3a.cmml">neg</mtext></msub><mo stretchy="false" id="A2.Ex9.m2.3.3.1.1.1.1.3" xref="A2.Ex9.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex9.m2.4.4.2.3" xref="A2.Ex9.m2.4.4.2.3.cmml">âˆ’</mo><mrow id="A2.Ex9.m2.4.4.2.2" xref="A2.Ex9.m2.4.4.2.2.cmml"><mover accent="true" id="A2.Ex9.m2.4.4.2.2.3" xref="A2.Ex9.m2.4.4.2.2.3.cmml"><mi id="A2.Ex9.m2.4.4.2.2.3.2" xref="A2.Ex9.m2.4.4.2.2.3.2.cmml">J</mi><mo id="A2.Ex9.m2.4.4.2.2.3.1" xref="A2.Ex9.m2.4.4.2.2.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.4.4.2.2.2" xref="A2.Ex9.m2.4.4.2.2.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.4.4.2.2.1.1" xref="A2.Ex9.m2.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.4.4.2.2.1.1.2" xref="A2.Ex9.m2.4.4.2.2.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.4.4.2.2.1.1.1" xref="A2.Ex9.m2.4.4.2.2.1.1.1.cmml"><mi id="A2.Ex9.m2.4.4.2.2.1.1.1.2" xref="A2.Ex9.m2.4.4.2.2.1.1.1.2.cmml">Ï€</mi><mi id="A2.Ex9.m2.4.4.2.2.1.1.1.3" xref="A2.Ex9.m2.4.4.2.2.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A2.Ex9.m2.4.4.2.2.1.1.3" xref="A2.Ex9.m2.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex9.m2.4.4.3" xref="A2.Ex9.m2.4.4.3.cmml">âŸ</mo></munder><mtext id="A2.Ex9.m2.6.7.3.2.3.2" xref="A2.Ex9.m2.6.7.3.2.3.2a.cmml">(b)</mtext></munder></mrow><mo id="A2.Ex9.m2.6.7.3.1" xref="A2.Ex9.m2.6.7.3.1.cmml">âˆ’</mo><munder id="A2.Ex9.m2.6.7.3.3" xref="A2.Ex9.m2.6.7.3.3.cmml"><munder accentunder="true" id="A2.Ex9.m2.6.6" xref="A2.Ex9.m2.6.6.cmml"><mrow id="A2.Ex9.m2.6.6.2" xref="A2.Ex9.m2.6.6.2.cmml"><mrow id="A2.Ex9.m2.5.5.1.1" xref="A2.Ex9.m2.5.5.1.1.cmml"><mi id="A2.Ex9.m2.5.5.1.1.3" xref="A2.Ex9.m2.5.5.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.5.5.1.1.2" xref="A2.Ex9.m2.5.5.1.1.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.5.5.1.1.1.1" xref="A2.Ex9.m2.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.5.5.1.1.1.1.2" xref="A2.Ex9.m2.5.5.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.5.5.1.1.1.1.1" xref="A2.Ex9.m2.5.5.1.1.1.1.1.cmml"><mi id="A2.Ex9.m2.5.5.1.1.1.1.1.2" xref="A2.Ex9.m2.5.5.1.1.1.1.1.2.cmml">Ï€</mi><mi id="A2.Ex9.m2.5.5.1.1.1.1.1.3" xref="A2.Ex9.m2.5.5.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A2.Ex9.m2.5.5.1.1.1.1.3" xref="A2.Ex9.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex9.m2.6.6.2.3" xref="A2.Ex9.m2.6.6.2.3.cmml">âˆ’</mo><mrow id="A2.Ex9.m2.6.6.2.2" xref="A2.Ex9.m2.6.6.2.2.cmml"><mover accent="true" id="A2.Ex9.m2.6.6.2.2.3" xref="A2.Ex9.m2.6.6.2.2.3.cmml"><mi id="A2.Ex9.m2.6.6.2.2.3.2" xref="A2.Ex9.m2.6.6.2.2.3.2.cmml">J</mi><mo id="A2.Ex9.m2.6.6.2.2.3.1" xref="A2.Ex9.m2.6.6.2.2.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="A2.Ex9.m2.6.6.2.2.2" xref="A2.Ex9.m2.6.6.2.2.2.cmml">â€‹</mo><mrow id="A2.Ex9.m2.6.6.2.2.1.1" xref="A2.Ex9.m2.6.6.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex9.m2.6.6.2.2.1.1.2" xref="A2.Ex9.m2.6.6.2.2.1.1.1.cmml">(</mo><msub id="A2.Ex9.m2.6.6.2.2.1.1.1" xref="A2.Ex9.m2.6.6.2.2.1.1.1.cmml"><mi id="A2.Ex9.m2.6.6.2.2.1.1.1.2" xref="A2.Ex9.m2.6.6.2.2.1.1.1.2.cmml">Ï€</mi><mi id="A2.Ex9.m2.6.6.2.2.1.1.1.3" xref="A2.Ex9.m2.6.6.2.2.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A2.Ex9.m2.6.6.2.2.1.1.3" xref="A2.Ex9.m2.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.Ex9.m2.6.6.3" xref="A2.Ex9.m2.6.6.3.cmml">âŸ</mo></munder><mtext id="A2.Ex9.m2.6.7.3.3.2" xref="A2.Ex9.m2.6.7.3.3.2a.cmml">(c)</mtext></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex9.m2.6b"><apply id="A2.Ex9.m2.6.7.cmml" xref="A2.Ex9.m2.6.7"><geq id="A2.Ex9.m2.6.7.1.cmml" xref="A2.Ex9.m2.6.7.1"></geq><csymbol cd="latexml" id="A2.Ex9.m2.6.7.2.cmml" xref="A2.Ex9.m2.6.7.2">absent</csymbol><apply id="A2.Ex9.m2.6.7.3.cmml" xref="A2.Ex9.m2.6.7.3"><minus id="A2.Ex9.m2.6.7.3.1.cmml" xref="A2.Ex9.m2.6.7.3.1"></minus><apply id="A2.Ex9.m2.6.7.3.2.cmml" xref="A2.Ex9.m2.6.7.3.2"><plus id="A2.Ex9.m2.6.7.3.2.1.cmml" xref="A2.Ex9.m2.6.7.3.2.1"></plus><apply id="A2.Ex9.m2.6.7.3.2.2.cmml" xref="A2.Ex9.m2.6.7.3.2.2"><csymbol cd="ambiguous" id="A2.Ex9.m2.6.7.3.2.2.1.cmml" xref="A2.Ex9.m2.6.7.3.2.2">subscript</csymbol><apply id="A2.Ex9.m2.2.2.cmml" xref="A2.Ex9.m2.2.2"><ci id="A2.Ex9.m2.2.2.3.cmml" xref="A2.Ex9.m2.2.2.3">âŸ</ci><apply id="A2.Ex9.m2.2.2.2.cmml" xref="A2.Ex9.m2.2.2.2"><minus id="A2.Ex9.m2.2.2.2.3.cmml" xref="A2.Ex9.m2.2.2.2.3"></minus><apply id="A2.Ex9.m2.1.1.1.1.cmml" xref="A2.Ex9.m2.1.1.1.1"><times id="A2.Ex9.m2.1.1.1.1.2.cmml" xref="A2.Ex9.m2.1.1.1.1.2"></times><ci id="A2.Ex9.m2.1.1.1.1.3.cmml" xref="A2.Ex9.m2.1.1.1.1.3">ğ½</ci><apply id="A2.Ex9.m2.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex9.m2.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m2.1.1.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.1.1.1.1.1.1.1.3a.cmml" xref="A2.Ex9.m2.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="A2.Ex9.m2.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex9.m2.1.1.1.1.1.1.1.3">neg</mtext></ci></apply></apply><apply id="A2.Ex9.m2.2.2.2.2.cmml" xref="A2.Ex9.m2.2.2.2.2"><times id="A2.Ex9.m2.2.2.2.2.2.cmml" xref="A2.Ex9.m2.2.2.2.2.2"></times><apply id="A2.Ex9.m2.2.2.2.2.3.cmml" xref="A2.Ex9.m2.2.2.2.2.3"><ci id="A2.Ex9.m2.2.2.2.2.3.1.cmml" xref="A2.Ex9.m2.2.2.2.2.3.1">^</ci><ci id="A2.Ex9.m2.2.2.2.2.3.2.cmml" xref="A2.Ex9.m2.2.2.2.2.3.2">ğ½</ci></apply><apply id="A2.Ex9.m2.2.2.2.2.1.1.1.cmml" xref="A2.Ex9.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.2.2.2.2.1.1.1.1.cmml" xref="A2.Ex9.m2.2.2.2.2.1.1">subscript</csymbol><ci id="A2.Ex9.m2.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex9.m2.2.2.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.2.2.2.2.1.1.1.3a.cmml" xref="A2.Ex9.m2.2.2.2.2.1.1.1.3"><mtext mathsize="70%" id="A2.Ex9.m2.2.2.2.2.1.1.1.3.cmml" xref="A2.Ex9.m2.2.2.2.2.1.1.1.3">neg</mtext></ci></apply></apply></apply></apply><ci id="A2.Ex9.m2.6.7.3.2.2.2a.cmml" xref="A2.Ex9.m2.6.7.3.2.2.2"><mtext mathsize="70%" id="A2.Ex9.m2.6.7.3.2.2.2.cmml" xref="A2.Ex9.m2.6.7.3.2.2.2">(a)</mtext></ci></apply><apply id="A2.Ex9.m2.6.7.3.2.3.cmml" xref="A2.Ex9.m2.6.7.3.2.3"><csymbol cd="ambiguous" id="A2.Ex9.m2.6.7.3.2.3.1.cmml" xref="A2.Ex9.m2.6.7.3.2.3">subscript</csymbol><apply id="A2.Ex9.m2.4.4.cmml" xref="A2.Ex9.m2.4.4"><ci id="A2.Ex9.m2.4.4.3.cmml" xref="A2.Ex9.m2.4.4.3">âŸ</ci><apply id="A2.Ex9.m2.4.4.2.cmml" xref="A2.Ex9.m2.4.4.2"><minus id="A2.Ex9.m2.4.4.2.3.cmml" xref="A2.Ex9.m2.4.4.2.3"></minus><apply id="A2.Ex9.m2.3.3.1.1.cmml" xref="A2.Ex9.m2.3.3.1.1"><times id="A2.Ex9.m2.3.3.1.1.2.cmml" xref="A2.Ex9.m2.3.3.1.1.2"></times><apply id="A2.Ex9.m2.3.3.1.1.3.cmml" xref="A2.Ex9.m2.3.3.1.1.3"><ci id="A2.Ex9.m2.3.3.1.1.3.1.cmml" xref="A2.Ex9.m2.3.3.1.1.3.1">^</ci><ci id="A2.Ex9.m2.3.3.1.1.3.2.cmml" xref="A2.Ex9.m2.3.3.1.1.3.2">ğ½</ci></apply><apply id="A2.Ex9.m2.3.3.1.1.1.1.1.cmml" xref="A2.Ex9.m2.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.3.3.1.1.1.1.1.1.cmml" xref="A2.Ex9.m2.3.3.1.1.1.1">subscript</csymbol><ci id="A2.Ex9.m2.3.3.1.1.1.1.1.2.cmml" xref="A2.Ex9.m2.3.3.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.3.3.1.1.1.1.1.3a.cmml" xref="A2.Ex9.m2.3.3.1.1.1.1.1.3"><mtext mathsize="70%" id="A2.Ex9.m2.3.3.1.1.1.1.1.3.cmml" xref="A2.Ex9.m2.3.3.1.1.1.1.1.3">neg</mtext></ci></apply></apply><apply id="A2.Ex9.m2.4.4.2.2.cmml" xref="A2.Ex9.m2.4.4.2.2"><times id="A2.Ex9.m2.4.4.2.2.2.cmml" xref="A2.Ex9.m2.4.4.2.2.2"></times><apply id="A2.Ex9.m2.4.4.2.2.3.cmml" xref="A2.Ex9.m2.4.4.2.2.3"><ci id="A2.Ex9.m2.4.4.2.2.3.1.cmml" xref="A2.Ex9.m2.4.4.2.2.3.1">^</ci><ci id="A2.Ex9.m2.4.4.2.2.3.2.cmml" xref="A2.Ex9.m2.4.4.2.2.3.2">ğ½</ci></apply><apply id="A2.Ex9.m2.4.4.2.2.1.1.1.cmml" xref="A2.Ex9.m2.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.4.4.2.2.1.1.1.1.cmml" xref="A2.Ex9.m2.4.4.2.2.1.1">subscript</csymbol><ci id="A2.Ex9.m2.4.4.2.2.1.1.1.2.cmml" xref="A2.Ex9.m2.4.4.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.4.4.2.2.1.1.1.3.cmml" xref="A2.Ex9.m2.4.4.2.2.1.1.1.3">sft</ci></apply></apply></apply></apply><ci id="A2.Ex9.m2.6.7.3.2.3.2a.cmml" xref="A2.Ex9.m2.6.7.3.2.3.2"><mtext mathsize="70%" id="A2.Ex9.m2.6.7.3.2.3.2.cmml" xref="A2.Ex9.m2.6.7.3.2.3.2">(b)</mtext></ci></apply></apply><apply id="A2.Ex9.m2.6.7.3.3.cmml" xref="A2.Ex9.m2.6.7.3.3"><csymbol cd="ambiguous" id="A2.Ex9.m2.6.7.3.3.1.cmml" xref="A2.Ex9.m2.6.7.3.3">subscript</csymbol><apply id="A2.Ex9.m2.6.6.cmml" xref="A2.Ex9.m2.6.6"><ci id="A2.Ex9.m2.6.6.3.cmml" xref="A2.Ex9.m2.6.6.3">âŸ</ci><apply id="A2.Ex9.m2.6.6.2.cmml" xref="A2.Ex9.m2.6.6.2"><minus id="A2.Ex9.m2.6.6.2.3.cmml" xref="A2.Ex9.m2.6.6.2.3"></minus><apply id="A2.Ex9.m2.5.5.1.1.cmml" xref="A2.Ex9.m2.5.5.1.1"><times id="A2.Ex9.m2.5.5.1.1.2.cmml" xref="A2.Ex9.m2.5.5.1.1.2"></times><ci id="A2.Ex9.m2.5.5.1.1.3.cmml" xref="A2.Ex9.m2.5.5.1.1.3">ğ½</ci><apply id="A2.Ex9.m2.5.5.1.1.1.1.1.cmml" xref="A2.Ex9.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.5.5.1.1.1.1.1.1.cmml" xref="A2.Ex9.m2.5.5.1.1.1.1">subscript</csymbol><ci id="A2.Ex9.m2.5.5.1.1.1.1.1.2.cmml" xref="A2.Ex9.m2.5.5.1.1.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.5.5.1.1.1.1.1.3.cmml" xref="A2.Ex9.m2.5.5.1.1.1.1.1.3">sft</ci></apply></apply><apply id="A2.Ex9.m2.6.6.2.2.cmml" xref="A2.Ex9.m2.6.6.2.2"><times id="A2.Ex9.m2.6.6.2.2.2.cmml" xref="A2.Ex9.m2.6.6.2.2.2"></times><apply id="A2.Ex9.m2.6.6.2.2.3.cmml" xref="A2.Ex9.m2.6.6.2.2.3"><ci id="A2.Ex9.m2.6.6.2.2.3.1.cmml" xref="A2.Ex9.m2.6.6.2.2.3.1">^</ci><ci id="A2.Ex9.m2.6.6.2.2.3.2.cmml" xref="A2.Ex9.m2.6.6.2.2.3.2">ğ½</ci></apply><apply id="A2.Ex9.m2.6.6.2.2.1.1.1.cmml" xref="A2.Ex9.m2.6.6.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex9.m2.6.6.2.2.1.1.1.1.cmml" xref="A2.Ex9.m2.6.6.2.2.1.1">subscript</csymbol><ci id="A2.Ex9.m2.6.6.2.2.1.1.1.2.cmml" xref="A2.Ex9.m2.6.6.2.2.1.1.1.2">ğœ‹</ci><ci id="A2.Ex9.m2.6.6.2.2.1.1.1.3.cmml" xref="A2.Ex9.m2.6.6.2.2.1.1.1.3">sft</ci></apply></apply></apply></apply><ci id="A2.Ex9.m2.6.7.3.3.2a.cmml" xref="A2.Ex9.m2.6.7.3.3.2"><mtext mathsize="70%" id="A2.Ex9.m2.6.7.3.3.2.cmml" xref="A2.Ex9.m2.6.7.3.3.2">(c)</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex9.m2.6c">\displaystyle\geq\underbrace{J(\pi_{\text{neg}})-\widehat{J}(\pi_{\text{neg}})}_{\text{(a)}}+\underbrace{\widehat{J}(\pi_{\text{neg}})-\widehat{J}(\pi_{\mathrm{sft}})}_{\text{(b)}}-\underbrace{J(\pi_{\mathrm{sft}})-\widehat{J}(\pi_{\mathrm{sft}})}_{\text{(c)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex10.m1.5" class="ltx_math_unparsed" alttext="\displaystyle\geq\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]-\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}}" display="inline"><semantics id="A2.Ex10.m1.5a"><mrow id="A2.Ex10.m1.5.5"><mi id="A2.Ex10.m1.5.5.3"></mi><mo id="A2.Ex10.m1.5.5.2">â‰¥</mo><mrow id="A2.Ex10.m1.5.5.1"><mrow id="A2.Ex10.m1.5.5.1.1"><mrow id="A2.Ex10.m1.5.5.1.1.3"><mi id="A2.Ex10.m1.5.5.1.1.3.2">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex10.m1.5.5.1.1.3.1">â‹…</mo><msub id="A2.Ex10.m1.5.5.1.1.3.3"><mi id="A2.Ex10.m1.5.5.1.1.3.3.2">ğ”¼</mi><mrow id="A2.Ex10.m1.2.2.2"><mi id="A2.Ex10.m1.2.2.2.3">ğ±</mi><mo id="A2.Ex10.m1.2.2.2.4">âˆ¼</mo><mover accent="true" id="A2.Ex10.m1.2.2.2.5"><mi id="A2.Ex10.m1.2.2.2.5.2">Î¼</mi><mo id="A2.Ex10.m1.2.2.2.5.1">^</mo></mover><mo id="A2.Ex10.m1.2.2.2.6">,</mo><msub id="A2.Ex10.m1.2.2.2.7"><mi id="A2.Ex10.m1.2.2.2.7.2">ğ²</mi><mrow id="A2.Ex10.m1.2.2.2.2.2"><mrow id="A2.Ex10.m1.2.2.2.2.2.4.2"><mi id="A2.Ex10.m1.1.1.1.1.1.1">i</mi><mo id="A2.Ex10.m1.2.2.2.2.2.4.2.1">,</mo><mn id="A2.Ex10.m1.2.2.2.2.2.2">0</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="A2.Ex10.m1.2.2.2.2.2.3">:</mo><mi id="A2.Ex10.m1.2.2.2.2.2.5">L</mi></mrow></msub><mo id="A2.Ex10.m1.2.2.2.8">âˆ¼</mo><msub id="A2.Ex10.m1.2.2.2.9"><mi id="A2.Ex10.m1.2.2.2.9.2">Ï€</mi><mtext id="A2.Ex10.m1.2.2.2.9.3">neg</mtext></msub><mrow id="A2.Ex10.m1.2.2.2.10"><mo stretchy="false" id="A2.Ex10.m1.2.2.2.10.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex10.m1.2.2.2.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex10.m1.2.2.2.10.3">|</mo><mi id="A2.Ex10.m1.2.2.2.10.4">ğ±</mi><mo stretchy="false" id="A2.Ex10.m1.2.2.2.10.5">)</mo></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A2.Ex10.m1.5.5.1.1.2">â€‹</mo><mrow id="A2.Ex10.m1.5.5.1.1.1.1"><mo id="A2.Ex10.m1.5.5.1.1.1.1.2">[</mo><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex10.m1.5.5.1.1.1.1.1.2"><munderover id="A2.Ex10.m1.5.5.1.1.1.1.1.2a"><mo movablelimits="false" id="A2.Ex10.m1.5.5.1.1.1.1.1.2.2.2">âˆ‘</mo><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1.2.2.3"><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.2.2.3.2">j</mi><mo id="A2.Ex10.m1.5.5.1.1.1.1.1.2.2.3.1">=</mo><mn id="A2.Ex10.m1.5.5.1.1.1.1.1.2.2.3.3">1</mn></mrow><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1.1"><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3"><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3a">â¡</mo><mover accent="true" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3.2"><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3.2.2">â„¤</mi><mo id="A2.Ex10.m1.5.5.1.1.1.1.1.1.3.2.1">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.2">(</mo><mi id="A2.Ex10.m1.4.4">ğ±</mi><mo id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.3">,</mo><msub id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.3.1">:</mo><mi id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex10.m1.5.5.1.1.1.1.1.1.1.1.4">)</mo></mrow></mrow></mrow><mo id="A2.Ex10.m1.5.5.1.1.1.1.3">]</mo></mrow></mrow><mo id="A2.Ex10.m1.5.5.1.2">âˆ’</mo><mstyle displaystyle="true" id="A2.Ex10.m1.3.3"><mfrac id="A2.Ex10.m1.3.3a"><msub id="A2.Ex10.m1.3.3.3"><mi id="A2.Ex10.m1.3.3.3.2">c</mi><mn id="A2.Ex10.m1.3.3.3.3">0</mn></msub><msqrt id="A2.Ex10.m1.3.3.1"><mrow id="A2.Ex10.m1.3.3.1.1.1.1"><mo stretchy="false" id="A2.Ex10.m1.3.3.1.1.1.1.2">|</mo><msub id="A2.Ex10.m1.3.3.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="A2.Ex10.m1.3.3.1.1.1.1.1.2">ğ’Ÿ</mi><mi id="A2.Ex10.m1.3.3.1.1.1.1.1.3">syn</mi></msub><mo stretchy="false" id="A2.Ex10.m1.3.3.1.1.1.1.3">|</mo></mrow></msqrt></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex" id="A2.Ex10.m1.5b">\displaystyle\geq\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log\widehat{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]-\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex11.m1.5" class="ltx_math_unparsed" alttext="\displaystyle\geq\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]-\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}}+\Delta," display="inline"><semantics id="A2.Ex11.m1.5a"><mrow id="A2.Ex11.m1.5.5.1"><mrow id="A2.Ex11.m1.5.5.1.1"><mi id="A2.Ex11.m1.5.5.1.1.3"></mi><mo id="A2.Ex11.m1.5.5.1.1.2">â‰¥</mo><mrow id="A2.Ex11.m1.5.5.1.1.1"><mrow id="A2.Ex11.m1.5.5.1.1.1.1"><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1"><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.3"><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.3.2">Î²</mi><mo lspace="0.222em" rspace="0.222em" id="A2.Ex11.m1.5.5.1.1.1.1.1.3.1">â‹…</mo><msub id="A2.Ex11.m1.5.5.1.1.1.1.1.3.3"><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.3.3.2">ğ”¼</mi><mrow id="A2.Ex11.m1.2.2.2"><mi id="A2.Ex11.m1.2.2.2.3">ğ±</mi><mo id="A2.Ex11.m1.2.2.2.4">âˆ¼</mo><mover accent="true" id="A2.Ex11.m1.2.2.2.5"><mi id="A2.Ex11.m1.2.2.2.5.2">Î¼</mi><mo id="A2.Ex11.m1.2.2.2.5.1">^</mo></mover><mo id="A2.Ex11.m1.2.2.2.6">,</mo><msub id="A2.Ex11.m1.2.2.2.7"><mi id="A2.Ex11.m1.2.2.2.7.2">ğ²</mi><mrow id="A2.Ex11.m1.2.2.2.2.2"><mrow id="A2.Ex11.m1.2.2.2.2.2.4.2"><mi id="A2.Ex11.m1.1.1.1.1.1.1">i</mi><mo id="A2.Ex11.m1.2.2.2.2.2.4.2.1">,</mo><mn id="A2.Ex11.m1.2.2.2.2.2.2">0</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="A2.Ex11.m1.2.2.2.2.2.3">:</mo><mi id="A2.Ex11.m1.2.2.2.2.2.5">L</mi></mrow></msub><mo id="A2.Ex11.m1.2.2.2.8">âˆ¼</mo><msub id="A2.Ex11.m1.2.2.2.9"><mi id="A2.Ex11.m1.2.2.2.9.2">Ï€</mi><mtext id="A2.Ex11.m1.2.2.2.9.3">neg</mtext></msub><mrow id="A2.Ex11.m1.2.2.2.10"><mo stretchy="false" id="A2.Ex11.m1.2.2.2.10.1">(</mo><mo lspace="0em" rspace="0em" id="A2.Ex11.m1.2.2.2.10.2">â‹…</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A2.Ex11.m1.2.2.2.10.3">|</mo><mi id="A2.Ex11.m1.2.2.2.10.4">ğ±</mi><mo stretchy="false" id="A2.Ex11.m1.2.2.2.10.5">)</mo></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A2.Ex11.m1.5.5.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1"><mo id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.2">[</mo><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1"><mstyle displaystyle="true" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2"><munderover id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2a"><mo movablelimits="false" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">âˆ‘</mo><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.2.3"><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.2">j</mi><mo id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.1">=</mo><mn id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.3">1</mn></mrow><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.2.3">L</mi></munderover></mstyle><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1"><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.3"><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.3.1">log</mi><mo lspace="0.167em" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.3a">â¡</mo><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">â„¤</mi></mrow><mo lspace="0em" rspace="0em" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.2">â€‹</mo><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">(</mo><mi id="A2.Ex11.m1.4.4">ğ±</mi><mo id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">,</mo><msub id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ²</mi><mrow id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3"><mn id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</mo><mi id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3">j</mi></mrow></msub><mo stretchy="false" id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.4">)</mo></mrow></mrow></mrow><mo id="A2.Ex11.m1.5.5.1.1.1.1.1.1.1.3">]</mo></mrow></mrow><mo id="A2.Ex11.m1.5.5.1.1.1.1.2">âˆ’</mo><mstyle displaystyle="true" id="A2.Ex11.m1.3.3"><mfrac id="A2.Ex11.m1.3.3a"><msub id="A2.Ex11.m1.3.3.3"><mi id="A2.Ex11.m1.3.3.3.2">c</mi><mn id="A2.Ex11.m1.3.3.3.3">0</mn></msub><msqrt id="A2.Ex11.m1.3.3.1"><mrow id="A2.Ex11.m1.3.3.1.1.1.1"><mo stretchy="false" id="A2.Ex11.m1.3.3.1.1.1.1.2">|</mo><msub id="A2.Ex11.m1.3.3.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="A2.Ex11.m1.3.3.1.1.1.1.1.2">ğ’Ÿ</mi><mi id="A2.Ex11.m1.3.3.1.1.1.1.1.3">syn</mi></msub><mo stretchy="false" id="A2.Ex11.m1.3.3.1.1.1.1.3">|</mo></mrow></msqrt></mfrac></mstyle></mrow><mo id="A2.Ex11.m1.5.5.1.1.1.2">+</mo><mi mathvariant="normal" id="A2.Ex11.m1.5.5.1.1.1.3">Î”</mi></mrow></mrow><mo id="A2.Ex11.m1.5.5.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="A2.Ex11.m1.5b">\displaystyle\geq\beta\cdot\mathbb{E}_{\mathbf{x}\sim\hat{\mu},\mathbf{y}_{i,0:L}\sim\pi_{\text{neg}}(\cdot|\mathbf{x})}\left[\sum_{j=1}^{L}\log{\mathbb{Z}}(\mathbf{x},\mathbf{y}_{0:j})\right]-\frac{c_{0}}{\sqrt{|\mathcal{D}_{\mathrm{syn}}|}}+\Delta,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.1.p1.18" class="ltx_p">where <math id="A2.1.p1.8.m1.1" class="ltx_Math" alttext="c_{0}" display="inline"><semantics id="A2.1.p1.8.m1.1a"><msub id="A2.1.p1.8.m1.1.1" xref="A2.1.p1.8.m1.1.1.cmml"><mi id="A2.1.p1.8.m1.1.1.2" xref="A2.1.p1.8.m1.1.1.2.cmml">c</mi><mn id="A2.1.p1.8.m1.1.1.3" xref="A2.1.p1.8.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.8.m1.1b"><apply id="A2.1.p1.8.m1.1.1.cmml" xref="A2.1.p1.8.m1.1.1"><csymbol cd="ambiguous" id="A2.1.p1.8.m1.1.1.1.cmml" xref="A2.1.p1.8.m1.1.1">subscript</csymbol><ci id="A2.1.p1.8.m1.1.1.2.cmml" xref="A2.1.p1.8.m1.1.1.2">ğ‘</ci><cn type="integer" id="A2.1.p1.8.m1.1.1.3.cmml" xref="A2.1.p1.8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.8.m1.1c">c_{0}</annotation></semantics></math> is a constant that depends on the Rademacher complexity of the function class of policies <math id="A2.1.p1.9.m2.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.1.p1.9.m2.1a"><msub id="A2.1.p1.9.m2.1.1" xref="A2.1.p1.9.m2.1.1.cmml"><mi id="A2.1.p1.9.m2.1.1.2" xref="A2.1.p1.9.m2.1.1.2.cmml">Ï€</mi><mtext id="A2.1.p1.9.m2.1.1.3" xref="A2.1.p1.9.m2.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.9.m2.1b"><apply id="A2.1.p1.9.m2.1.1.cmml" xref="A2.1.p1.9.m2.1.1"><csymbol cd="ambiguous" id="A2.1.p1.9.m2.1.1.1.cmml" xref="A2.1.p1.9.m2.1.1">subscript</csymbol><ci id="A2.1.p1.9.m2.1.1.2.cmml" xref="A2.1.p1.9.m2.1.1.2">ğœ‹</ci><ci id="A2.1.p1.9.m2.1.1.3a.cmml" xref="A2.1.p1.9.m2.1.1.3"><mtext mathsize="70%" id="A2.1.p1.9.m2.1.1.3.cmml" xref="A2.1.p1.9.m2.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.9.m2.1c">\pi_{\text{neg}}</annotation></semantics></math> (coming from a uniform bound that we invokve to bound term <span id="A2.1.p1.18.1" class="ltx_text ltx_font_italic">(a)</span>, since <math id="A2.1.p1.10.m3.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.1.p1.10.m3.1a"><msub id="A2.1.p1.10.m3.1.1" xref="A2.1.p1.10.m3.1.1.cmml"><mi id="A2.1.p1.10.m3.1.1.2" xref="A2.1.p1.10.m3.1.1.2.cmml">Ï€</mi><mtext id="A2.1.p1.10.m3.1.1.3" xref="A2.1.p1.10.m3.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.10.m3.1b"><apply id="A2.1.p1.10.m3.1.1.cmml" xref="A2.1.p1.10.m3.1.1"><csymbol cd="ambiguous" id="A2.1.p1.10.m3.1.1.1.cmml" xref="A2.1.p1.10.m3.1.1">subscript</csymbol><ci id="A2.1.p1.10.m3.1.1.2.cmml" xref="A2.1.p1.10.m3.1.1.2">ğœ‹</ci><ci id="A2.1.p1.10.m3.1.1.3a.cmml" xref="A2.1.p1.10.m3.1.1.3"><mtext mathsize="70%" id="A2.1.p1.10.m3.1.1.3.cmml" xref="A2.1.p1.10.m3.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.10.m3.1c">\pi_{\text{neg}}</annotation></semantics></math> depends on the dataset samples), and this term arises since the empirical distribution over prompts is not the same as the true population. This concentration term decays as the size of the synthetic data (number of problems) are scaled up. The term <math id="A2.1.p1.11.m4.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A2.1.p1.11.m4.1a"><mi mathvariant="normal" id="A2.1.p1.11.m4.1.1" xref="A2.1.p1.11.m4.1.1.cmml">Î”</mi><annotation-xml encoding="MathML-Content" id="A2.1.p1.11.m4.1b"><ci id="A2.1.p1.11.m4.1.1.cmml" xref="A2.1.p1.11.m4.1.1">Î”</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.11.m4.1c">\Delta</annotation></semantics></math> denotes the overestimation error between the estimated advantages <math id="A2.1.p1.12.m5.3" class="ltx_Math" alttext="\widehat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})" display="inline"><semantics id="A2.1.p1.12.m5.3a"><mrow id="A2.1.p1.12.m5.3.3" xref="A2.1.p1.12.m5.3.3.cmml"><msub id="A2.1.p1.12.m5.3.3.4" xref="A2.1.p1.12.m5.3.3.4.cmml"><mover accent="true" id="A2.1.p1.12.m5.3.3.4.2" xref="A2.1.p1.12.m5.3.3.4.2.cmml"><mi id="A2.1.p1.12.m5.3.3.4.2.2" xref="A2.1.p1.12.m5.3.3.4.2.2.cmml">A</mi><mo id="A2.1.p1.12.m5.3.3.4.2.1" xref="A2.1.p1.12.m5.3.3.4.2.1.cmml">^</mo></mover><mover accent="true" id="A2.1.p1.12.m5.3.3.4.3" xref="A2.1.p1.12.m5.3.3.4.3.cmml"><mi id="A2.1.p1.12.m5.3.3.4.3.2" xref="A2.1.p1.12.m5.3.3.4.3.2.cmml">Ï€</mi><mo id="A2.1.p1.12.m5.3.3.4.3.1" xref="A2.1.p1.12.m5.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.1.p1.12.m5.3.3.3" xref="A2.1.p1.12.m5.3.3.3.cmml">â€‹</mo><mrow id="A2.1.p1.12.m5.3.3.2.2" xref="A2.1.p1.12.m5.3.3.2.3.cmml"><mo stretchy="false" id="A2.1.p1.12.m5.3.3.2.2.3" xref="A2.1.p1.12.m5.3.3.2.3.cmml">(</mo><mi id="A2.1.p1.12.m5.1.1" xref="A2.1.p1.12.m5.1.1.cmml">ğ±</mi><mo id="A2.1.p1.12.m5.3.3.2.2.4" xref="A2.1.p1.12.m5.3.3.2.3.cmml">,</mo><msub id="A2.1.p1.12.m5.2.2.1.1.1" xref="A2.1.p1.12.m5.2.2.1.1.1.cmml"><mi id="A2.1.p1.12.m5.2.2.1.1.1.2" xref="A2.1.p1.12.m5.2.2.1.1.1.2.cmml">ğ²</mi><mrow id="A2.1.p1.12.m5.2.2.1.1.1.3" xref="A2.1.p1.12.m5.2.2.1.1.1.3.cmml"><mn id="A2.1.p1.12.m5.2.2.1.1.1.3.2" xref="A2.1.p1.12.m5.2.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.1.p1.12.m5.2.2.1.1.1.3.1" xref="A2.1.p1.12.m5.2.2.1.1.1.3.1.cmml">:</mo><mrow id="A2.1.p1.12.m5.2.2.1.1.1.3.3" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.cmml"><mi id="A2.1.p1.12.m5.2.2.1.1.1.3.3.2" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="A2.1.p1.12.m5.2.2.1.1.1.3.3.1" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="A2.1.p1.12.m5.2.2.1.1.1.3.3.3" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A2.1.p1.12.m5.3.3.2.2.5" xref="A2.1.p1.12.m5.3.3.2.3.cmml">,</mo><msub id="A2.1.p1.12.m5.3.3.2.2.2" xref="A2.1.p1.12.m5.3.3.2.2.2.cmml"><mi id="A2.1.p1.12.m5.3.3.2.2.2.2" xref="A2.1.p1.12.m5.3.3.2.2.2.2.cmml">ğ²</mi><mi id="A2.1.p1.12.m5.3.3.2.2.2.3" xref="A2.1.p1.12.m5.3.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A2.1.p1.12.m5.3.3.2.2.6" xref="A2.1.p1.12.m5.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.12.m5.3b"><apply id="A2.1.p1.12.m5.3.3.cmml" xref="A2.1.p1.12.m5.3.3"><times id="A2.1.p1.12.m5.3.3.3.cmml" xref="A2.1.p1.12.m5.3.3.3"></times><apply id="A2.1.p1.12.m5.3.3.4.cmml" xref="A2.1.p1.12.m5.3.3.4"><csymbol cd="ambiguous" id="A2.1.p1.12.m5.3.3.4.1.cmml" xref="A2.1.p1.12.m5.3.3.4">subscript</csymbol><apply id="A2.1.p1.12.m5.3.3.4.2.cmml" xref="A2.1.p1.12.m5.3.3.4.2"><ci id="A2.1.p1.12.m5.3.3.4.2.1.cmml" xref="A2.1.p1.12.m5.3.3.4.2.1">^</ci><ci id="A2.1.p1.12.m5.3.3.4.2.2.cmml" xref="A2.1.p1.12.m5.3.3.4.2.2">ğ´</ci></apply><apply id="A2.1.p1.12.m5.3.3.4.3.cmml" xref="A2.1.p1.12.m5.3.3.4.3"><ci id="A2.1.p1.12.m5.3.3.4.3.1.cmml" xref="A2.1.p1.12.m5.3.3.4.3.1">~</ci><ci id="A2.1.p1.12.m5.3.3.4.3.2.cmml" xref="A2.1.p1.12.m5.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="A2.1.p1.12.m5.3.3.2.3.cmml" xref="A2.1.p1.12.m5.3.3.2.2"><ci id="A2.1.p1.12.m5.1.1.cmml" xref="A2.1.p1.12.m5.1.1">ğ±</ci><apply id="A2.1.p1.12.m5.2.2.1.1.1.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.1.p1.12.m5.2.2.1.1.1.1.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1">subscript</csymbol><ci id="A2.1.p1.12.m5.2.2.1.1.1.2.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.2">ğ²</ci><apply id="A2.1.p1.12.m5.2.2.1.1.1.3.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3"><ci id="A2.1.p1.12.m5.2.2.1.1.1.3.1.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.1">:</ci><cn type="integer" id="A2.1.p1.12.m5.2.2.1.1.1.3.2.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.2">0</cn><apply id="A2.1.p1.12.m5.2.2.1.1.1.3.3.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3"><minus id="A2.1.p1.12.m5.2.2.1.1.1.3.3.1.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.1"></minus><ci id="A2.1.p1.12.m5.2.2.1.1.1.3.3.2.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A2.1.p1.12.m5.2.2.1.1.1.3.3.3.cmml" xref="A2.1.p1.12.m5.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A2.1.p1.12.m5.3.3.2.2.2.cmml" xref="A2.1.p1.12.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.1.p1.12.m5.3.3.2.2.2.1.cmml" xref="A2.1.p1.12.m5.3.3.2.2.2">subscript</csymbol><ci id="A2.1.p1.12.m5.3.3.2.2.2.2.cmml" xref="A2.1.p1.12.m5.3.3.2.2.2.2">ğ²</ci><ci id="A2.1.p1.12.m5.3.3.2.2.2.3.cmml" xref="A2.1.p1.12.m5.3.3.2.2.2.3">ğ‘–</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.12.m5.3c">\widehat{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})</annotation></semantics></math> and the true advantages <math id="A2.1.p1.13.m6.3" class="ltx_Math" alttext="{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})" display="inline"><semantics id="A2.1.p1.13.m6.3a"><mrow id="A2.1.p1.13.m6.3.3" xref="A2.1.p1.13.m6.3.3.cmml"><msub id="A2.1.p1.13.m6.3.3.4" xref="A2.1.p1.13.m6.3.3.4.cmml"><mi id="A2.1.p1.13.m6.3.3.4.2" xref="A2.1.p1.13.m6.3.3.4.2.cmml">A</mi><mover accent="true" id="A2.1.p1.13.m6.3.3.4.3" xref="A2.1.p1.13.m6.3.3.4.3.cmml"><mi id="A2.1.p1.13.m6.3.3.4.3.2" xref="A2.1.p1.13.m6.3.3.4.3.2.cmml">Ï€</mi><mo id="A2.1.p1.13.m6.3.3.4.3.1" xref="A2.1.p1.13.m6.3.3.4.3.1.cmml">~</mo></mover></msub><mo lspace="0em" rspace="0em" id="A2.1.p1.13.m6.3.3.3" xref="A2.1.p1.13.m6.3.3.3.cmml">â€‹</mo><mrow id="A2.1.p1.13.m6.3.3.2.2" xref="A2.1.p1.13.m6.3.3.2.3.cmml"><mo stretchy="false" id="A2.1.p1.13.m6.3.3.2.2.3" xref="A2.1.p1.13.m6.3.3.2.3.cmml">(</mo><mi id="A2.1.p1.13.m6.1.1" xref="A2.1.p1.13.m6.1.1.cmml">ğ±</mi><mo id="A2.1.p1.13.m6.3.3.2.2.4" xref="A2.1.p1.13.m6.3.3.2.3.cmml">,</mo><msub id="A2.1.p1.13.m6.2.2.1.1.1" xref="A2.1.p1.13.m6.2.2.1.1.1.cmml"><mi id="A2.1.p1.13.m6.2.2.1.1.1.2" xref="A2.1.p1.13.m6.2.2.1.1.1.2.cmml">ğ²</mi><mrow id="A2.1.p1.13.m6.2.2.1.1.1.3" xref="A2.1.p1.13.m6.2.2.1.1.1.3.cmml"><mn id="A2.1.p1.13.m6.2.2.1.1.1.3.2" xref="A2.1.p1.13.m6.2.2.1.1.1.3.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="A2.1.p1.13.m6.2.2.1.1.1.3.1" xref="A2.1.p1.13.m6.2.2.1.1.1.3.1.cmml">:</mo><mrow id="A2.1.p1.13.m6.2.2.1.1.1.3.3" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.cmml"><mi id="A2.1.p1.13.m6.2.2.1.1.1.3.3.2" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="A2.1.p1.13.m6.2.2.1.1.1.3.3.1" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="A2.1.p1.13.m6.2.2.1.1.1.3.3.3" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A2.1.p1.13.m6.3.3.2.2.5" xref="A2.1.p1.13.m6.3.3.2.3.cmml">,</mo><msub id="A2.1.p1.13.m6.3.3.2.2.2" xref="A2.1.p1.13.m6.3.3.2.2.2.cmml"><mi id="A2.1.p1.13.m6.3.3.2.2.2.2" xref="A2.1.p1.13.m6.3.3.2.2.2.2.cmml">ğ²</mi><mi id="A2.1.p1.13.m6.3.3.2.2.2.3" xref="A2.1.p1.13.m6.3.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A2.1.p1.13.m6.3.3.2.2.6" xref="A2.1.p1.13.m6.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.1.p1.13.m6.3b"><apply id="A2.1.p1.13.m6.3.3.cmml" xref="A2.1.p1.13.m6.3.3"><times id="A2.1.p1.13.m6.3.3.3.cmml" xref="A2.1.p1.13.m6.3.3.3"></times><apply id="A2.1.p1.13.m6.3.3.4.cmml" xref="A2.1.p1.13.m6.3.3.4"><csymbol cd="ambiguous" id="A2.1.p1.13.m6.3.3.4.1.cmml" xref="A2.1.p1.13.m6.3.3.4">subscript</csymbol><ci id="A2.1.p1.13.m6.3.3.4.2.cmml" xref="A2.1.p1.13.m6.3.3.4.2">ğ´</ci><apply id="A2.1.p1.13.m6.3.3.4.3.cmml" xref="A2.1.p1.13.m6.3.3.4.3"><ci id="A2.1.p1.13.m6.3.3.4.3.1.cmml" xref="A2.1.p1.13.m6.3.3.4.3.1">~</ci><ci id="A2.1.p1.13.m6.3.3.4.3.2.cmml" xref="A2.1.p1.13.m6.3.3.4.3.2">ğœ‹</ci></apply></apply><vector id="A2.1.p1.13.m6.3.3.2.3.cmml" xref="A2.1.p1.13.m6.3.3.2.2"><ci id="A2.1.p1.13.m6.1.1.cmml" xref="A2.1.p1.13.m6.1.1">ğ±</ci><apply id="A2.1.p1.13.m6.2.2.1.1.1.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.1.p1.13.m6.2.2.1.1.1.1.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1">subscript</csymbol><ci id="A2.1.p1.13.m6.2.2.1.1.1.2.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.2">ğ²</ci><apply id="A2.1.p1.13.m6.2.2.1.1.1.3.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3"><ci id="A2.1.p1.13.m6.2.2.1.1.1.3.1.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.1">:</ci><cn type="integer" id="A2.1.p1.13.m6.2.2.1.1.1.3.2.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.2">0</cn><apply id="A2.1.p1.13.m6.2.2.1.1.1.3.3.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3"><minus id="A2.1.p1.13.m6.2.2.1.1.1.3.3.1.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.1"></minus><ci id="A2.1.p1.13.m6.2.2.1.1.1.3.3.2.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.2">ğ‘–</ci><cn type="integer" id="A2.1.p1.13.m6.2.2.1.1.1.3.3.3.cmml" xref="A2.1.p1.13.m6.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A2.1.p1.13.m6.3.3.2.2.2.cmml" xref="A2.1.p1.13.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.1.p1.13.m6.3.3.2.2.2.1.cmml" xref="A2.1.p1.13.m6.3.3.2.2.2">subscript</csymbol><ci id="A2.1.p1.13.m6.3.3.2.2.2.2.cmml" xref="A2.1.p1.13.m6.3.3.2.2.2.2">ğ²</ci><ci id="A2.1.p1.13.m6.3.3.2.2.2.3.cmml" xref="A2.1.p1.13.m6.3.3.2.2.2.3">ğ‘–</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.13.m6.3c">{A}_{\tilde{\pi}}(\mathbf{x},\mathbf{y}_{0:i-1},\mathbf{y}_{i})</annotation></semantics></math>, in expectation under the distribution of the learned policy. The estimation error <math id="A2.1.p1.14.m7.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A2.1.p1.14.m7.1a"><mi mathvariant="normal" id="A2.1.p1.14.m7.1.1" xref="A2.1.p1.14.m7.1.1.cmml">Î”</mi><annotation-xml encoding="MathML-Content" id="A2.1.p1.14.m7.1b"><ci id="A2.1.p1.14.m7.1.1.cmml" xref="A2.1.p1.14.m7.1.1">Î”</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.14.m7.1c">\Delta</annotation></semantics></math> depends on <math id="A2.1.p1.15.m8.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.1.p1.15.m8.1a"><msub id="A2.1.p1.15.m8.1.1" xref="A2.1.p1.15.m8.1.1.cmml"><mi id="A2.1.p1.15.m8.1.1.2" xref="A2.1.p1.15.m8.1.1.2.cmml">Ï€</mi><mi id="A2.1.p1.15.m8.1.1.3" xref="A2.1.p1.15.m8.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.15.m8.1b"><apply id="A2.1.p1.15.m8.1.1.cmml" xref="A2.1.p1.15.m8.1.1"><csymbol cd="ambiguous" id="A2.1.p1.15.m8.1.1.1.cmml" xref="A2.1.p1.15.m8.1.1">subscript</csymbol><ci id="A2.1.p1.15.m8.1.1.2.cmml" xref="A2.1.p1.15.m8.1.1.2">ğœ‹</ci><ci id="A2.1.p1.15.m8.1.1.3.cmml" xref="A2.1.p1.15.m8.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.15.m8.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> and the value of <math id="A2.1.p1.16.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.1.p1.16.m9.1a"><mi id="A2.1.p1.16.m9.1.1" xref="A2.1.p1.16.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.1.p1.16.m9.1b"><ci id="A2.1.p1.16.m9.1.1.cmml" xref="A2.1.p1.16.m9.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.16.m9.1c">K</annotation></semantics></math> used if the rollout policy <math id="A2.1.p1.17.m10.1" class="ltx_Math" alttext="\tilde{\pi}" display="inline"><semantics id="A2.1.p1.17.m10.1a"><mover accent="true" id="A2.1.p1.17.m10.1.1" xref="A2.1.p1.17.m10.1.1.cmml"><mi id="A2.1.p1.17.m10.1.1.2" xref="A2.1.p1.17.m10.1.1.2.cmml">Ï€</mi><mo id="A2.1.p1.17.m10.1.1.1" xref="A2.1.p1.17.m10.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A2.1.p1.17.m10.1b"><apply id="A2.1.p1.17.m10.1.1.cmml" xref="A2.1.p1.17.m10.1.1"><ci id="A2.1.p1.17.m10.1.1.1.cmml" xref="A2.1.p1.17.m10.1.1.1">~</ci><ci id="A2.1.p1.17.m10.1.1.2.cmml" xref="A2.1.p1.17.m10.1.1.2">ğœ‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.17.m10.1c">\tilde{\pi}</annotation></semantics></math> corresponds to the BoK(<math id="A2.1.p1.18.m11.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.1.p1.18.m11.1a"><msub id="A2.1.p1.18.m11.1.1" xref="A2.1.p1.18.m11.1.1.cmml"><mi id="A2.1.p1.18.m11.1.1.2" xref="A2.1.p1.18.m11.1.1.2.cmml">Ï€</mi><mi id="A2.1.p1.18.m11.1.1.3" xref="A2.1.p1.18.m11.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.1.p1.18.m11.1b"><apply id="A2.1.p1.18.m11.1.1.cmml" xref="A2.1.p1.18.m11.1.1"><csymbol cd="ambiguous" id="A2.1.p1.18.m11.1.1.1.cmml" xref="A2.1.p1.18.m11.1.1">subscript</csymbol><ci id="A2.1.p1.18.m11.1.1.2.cmml" xref="A2.1.p1.18.m11.1.1.2">ğœ‹</ci><ci id="A2.1.p1.18.m11.1.1.3.cmml" xref="A2.1.p1.18.m11.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.1.p1.18.m11.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>) policy. This proves the theorem.
âˆ</p>
</div>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.10" class="ltx_p"><span id="A2.p3.10.1" class="ltx_text ltx_font_bold">Interpretation &amp; perspectives.</span> Also note that the improvement in performance between <math id="A2.p3.1.m1.1" class="ltx_Math" alttext="\pi_{\text{neg}}" display="inline"><semantics id="A2.p3.1.m1.1a"><msub id="A2.p3.1.m1.1.1" xref="A2.p3.1.m1.1.1.cmml"><mi id="A2.p3.1.m1.1.1.2" xref="A2.p3.1.m1.1.1.2.cmml">Ï€</mi><mtext id="A2.p3.1.m1.1.1.3" xref="A2.p3.1.m1.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.1b"><apply id="A2.p3.1.m1.1.1.cmml" xref="A2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p3.1.m1.1.1.1.cmml" xref="A2.p3.1.m1.1.1">subscript</csymbol><ci id="A2.p3.1.m1.1.1.2.cmml" xref="A2.p3.1.m1.1.1.2">ğœ‹</ci><ci id="A2.p3.1.m1.1.1.3a.cmml" xref="A2.p3.1.m1.1.1.3"><mtext mathsize="70%" id="A2.p3.1.m1.1.1.3.cmml" xref="A2.p3.1.m1.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.1.m1.1c">\pi_{\text{neg}}</annotation></semantics></math> and <math id="A2.p3.2.m2.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.p3.2.m2.1a"><msub id="A2.p3.2.m2.1.1" xref="A2.p3.2.m2.1.1.cmml"><mi id="A2.p3.2.m2.1.1.2" xref="A2.p3.2.m2.1.1.2.cmml">Ï€</mi><mi id="A2.p3.2.m2.1.1.3" xref="A2.p3.2.m2.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.1b"><apply id="A2.p3.2.m2.1.1.cmml" xref="A2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A2.p3.2.m2.1.1.1.cmml" xref="A2.p3.2.m2.1.1">subscript</csymbol><ci id="A2.p3.2.m2.1.1.2.cmml" xref="A2.p3.2.m2.1.1.2">ğœ‹</ci><ci id="A2.p3.2.m2.1.1.3.cmml" xref="A2.p3.2.m2.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.2.m2.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> depends on the advantage estimate: if the advantage estimates are high, then this term is large, meaning that the more the fraction of high-advantage critical states, the higher the improvement. In addition, the bound also says that if the over-estimation <math id="A2.p3.3.m3.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="A2.p3.3.m3.1a"><mi mathvariant="normal" id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml">Î”</mi><annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.1b"><ci id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1">Î”</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.3.m3.1c">\Delta</annotation></semantics></math> in the advantage estimate is large, the performance improvement is small. This is perhaps expected: consider the scenario when the BoK(<math id="A2.p3.4.m4.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A2.p3.4.m4.1a"><msub id="A2.p3.4.m4.1.1" xref="A2.p3.4.m4.1.1.cmml"><mi id="A2.p3.4.m4.1.1.2" xref="A2.p3.4.m4.1.1.2.cmml">Ï€</mi><mi id="A2.p3.4.m4.1.1.3" xref="A2.p3.4.m4.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p3.4.m4.1b"><apply id="A2.p3.4.m4.1.1.cmml" xref="A2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A2.p3.4.m4.1.1.1.cmml" xref="A2.p3.4.m4.1.1">subscript</csymbol><ci id="A2.p3.4.m4.1.1.2.cmml" xref="A2.p3.4.m4.1.1.2">ğœ‹</ci><ci id="A2.p3.4.m4.1.1.3.cmml" xref="A2.p3.4.m4.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.4.m4.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>) policy is used to collect data, for a large <math id="A2.p3.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.p3.5.m5.1a"><mi id="A2.p3.5.m5.1.1" xref="A2.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p3.5.m5.1b"><ci id="A2.p3.5.m5.1.1.cmml" xref="A2.p3.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.5.m5.1c">K</annotation></semantics></math>. In this scenario, the divergence between the empirical advantage estimate <math id="A2.p3.6.m6.1" class="ltx_Math" alttext="\widehat{A}_{\tilde{\pi}}" display="inline"><semantics id="A2.p3.6.m6.1a"><msub id="A2.p3.6.m6.1.1" xref="A2.p3.6.m6.1.1.cmml"><mover accent="true" id="A2.p3.6.m6.1.1.2" xref="A2.p3.6.m6.1.1.2.cmml"><mi id="A2.p3.6.m6.1.1.2.2" xref="A2.p3.6.m6.1.1.2.2.cmml">A</mi><mo id="A2.p3.6.m6.1.1.2.1" xref="A2.p3.6.m6.1.1.2.1.cmml">^</mo></mover><mover accent="true" id="A2.p3.6.m6.1.1.3" xref="A2.p3.6.m6.1.1.3.cmml"><mi id="A2.p3.6.m6.1.1.3.2" xref="A2.p3.6.m6.1.1.3.2.cmml">Ï€</mi><mo id="A2.p3.6.m6.1.1.3.1" xref="A2.p3.6.m6.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml encoding="MathML-Content" id="A2.p3.6.m6.1b"><apply id="A2.p3.6.m6.1.1.cmml" xref="A2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="A2.p3.6.m6.1.1.1.cmml" xref="A2.p3.6.m6.1.1">subscript</csymbol><apply id="A2.p3.6.m6.1.1.2.cmml" xref="A2.p3.6.m6.1.1.2"><ci id="A2.p3.6.m6.1.1.2.1.cmml" xref="A2.p3.6.m6.1.1.2.1">^</ci><ci id="A2.p3.6.m6.1.1.2.2.cmml" xref="A2.p3.6.m6.1.1.2.2">ğ´</ci></apply><apply id="A2.p3.6.m6.1.1.3.cmml" xref="A2.p3.6.m6.1.1.3"><ci id="A2.p3.6.m6.1.1.3.1.cmml" xref="A2.p3.6.m6.1.1.3.1">~</ci><ci id="A2.p3.6.m6.1.1.3.2.cmml" xref="A2.p3.6.m6.1.1.3.2">ğœ‹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.6.m6.1c">\widehat{A}_{\tilde{\pi}}</annotation></semantics></math> and the expected estimate <math id="A2.p3.7.m7.1" class="ltx_Math" alttext="A_{\tilde{\pi}}" display="inline"><semantics id="A2.p3.7.m7.1a"><msub id="A2.p3.7.m7.1.1" xref="A2.p3.7.m7.1.1.cmml"><mi id="A2.p3.7.m7.1.1.2" xref="A2.p3.7.m7.1.1.2.cmml">A</mi><mover accent="true" id="A2.p3.7.m7.1.1.3" xref="A2.p3.7.m7.1.1.3.cmml"><mi id="A2.p3.7.m7.1.1.3.2" xref="A2.p3.7.m7.1.1.3.2.cmml">Ï€</mi><mo id="A2.p3.7.m7.1.1.3.1" xref="A2.p3.7.m7.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml encoding="MathML-Content" id="A2.p3.7.m7.1b"><apply id="A2.p3.7.m7.1.1.cmml" xref="A2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="A2.p3.7.m7.1.1.1.cmml" xref="A2.p3.7.m7.1.1">subscript</csymbol><ci id="A2.p3.7.m7.1.1.2.cmml" xref="A2.p3.7.m7.1.1.2">ğ´</ci><apply id="A2.p3.7.m7.1.1.3.cmml" xref="A2.p3.7.m7.1.1.3"><ci id="A2.p3.7.m7.1.1.3.1.cmml" xref="A2.p3.7.m7.1.1.3.1">~</ci><ci id="A2.p3.7.m7.1.1.3.2.cmml" xref="A2.p3.7.m7.1.1.3.2">ğœ‹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.7.m7.1c">A_{\tilde{\pi}}</annotation></semantics></math> is likely large. In the worst case, the estimate <math id="A2.p3.8.m8.1" class="ltx_Math" alttext="\widehat{A}_{\tilde{\pi}}" display="inline"><semantics id="A2.p3.8.m8.1a"><msub id="A2.p3.8.m8.1.1" xref="A2.p3.8.m8.1.1.cmml"><mover accent="true" id="A2.p3.8.m8.1.1.2" xref="A2.p3.8.m8.1.1.2.cmml"><mi id="A2.p3.8.m8.1.1.2.2" xref="A2.p3.8.m8.1.1.2.2.cmml">A</mi><mo id="A2.p3.8.m8.1.1.2.1" xref="A2.p3.8.m8.1.1.2.1.cmml">^</mo></mover><mover accent="true" id="A2.p3.8.m8.1.1.3" xref="A2.p3.8.m8.1.1.3.cmml"><mi id="A2.p3.8.m8.1.1.3.2" xref="A2.p3.8.m8.1.1.3.2.cmml">Ï€</mi><mo id="A2.p3.8.m8.1.1.3.1" xref="A2.p3.8.m8.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml encoding="MathML-Content" id="A2.p3.8.m8.1b"><apply id="A2.p3.8.m8.1.1.cmml" xref="A2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="A2.p3.8.m8.1.1.1.cmml" xref="A2.p3.8.m8.1.1">subscript</csymbol><apply id="A2.p3.8.m8.1.1.2.cmml" xref="A2.p3.8.m8.1.1.2"><ci id="A2.p3.8.m8.1.1.2.1.cmml" xref="A2.p3.8.m8.1.1.2.1">^</ci><ci id="A2.p3.8.m8.1.1.2.2.cmml" xref="A2.p3.8.m8.1.1.2.2">ğ´</ci></apply><apply id="A2.p3.8.m8.1.1.3.cmml" xref="A2.p3.8.m8.1.1.3"><ci id="A2.p3.8.m8.1.1.3.1.cmml" xref="A2.p3.8.m8.1.1.3.1">~</ci><ci id="A2.p3.8.m8.1.1.3.2.cmml" xref="A2.p3.8.m8.1.1.3.2">ğœ‹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.8.m8.1c">\widehat{A}_{\tilde{\pi}}</annotation></semantics></math> can arbitrarily overestimate <math id="A2.p3.9.m9.1" class="ltx_Math" alttext="A_{\tilde{\pi}}" display="inline"><semantics id="A2.p3.9.m9.1a"><msub id="A2.p3.9.m9.1.1" xref="A2.p3.9.m9.1.1.cmml"><mi id="A2.p3.9.m9.1.1.2" xref="A2.p3.9.m9.1.1.2.cmml">A</mi><mover accent="true" id="A2.p3.9.m9.1.1.3" xref="A2.p3.9.m9.1.1.3.cmml"><mi id="A2.p3.9.m9.1.1.3.2" xref="A2.p3.9.m9.1.1.3.2.cmml">Ï€</mi><mo id="A2.p3.9.m9.1.1.3.1" xref="A2.p3.9.m9.1.1.3.1.cmml">~</mo></mover></msub><annotation-xml encoding="MathML-Content" id="A2.p3.9.m9.1b"><apply id="A2.p3.9.m9.1.1.cmml" xref="A2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="A2.p3.9.m9.1.1.1.cmml" xref="A2.p3.9.m9.1.1">subscript</csymbol><ci id="A2.p3.9.m9.1.1.2.cmml" xref="A2.p3.9.m9.1.1.2">ğ´</ci><apply id="A2.p3.9.m9.1.1.3.cmml" xref="A2.p3.9.m9.1.1.3"><ci id="A2.p3.9.m9.1.1.3.1.cmml" xref="A2.p3.9.m9.1.1.3.1">~</ci><ci id="A2.p3.9.m9.1.1.3.2.cmml" xref="A2.p3.9.m9.1.1.3.2">ğœ‹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.9.m9.1c">A_{\tilde{\pi}}</annotation></semantics></math>, as it would take on a high value even if there is just <em id="A2.p3.10.2" class="ltx_emph ltx_font_italic">one</em> sequence among the <math id="A2.p3.10.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.p3.10.m10.1a"><mi id="A2.p3.10.m10.1.1" xref="A2.p3.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p3.10.m10.1b"><ci id="A2.p3.10.m10.1.1.cmml" xref="A2.p3.10.m10.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.10.m10.1c">K</annotation></semantics></math> rollouts that successfully solves the problem. For example, a spurious step may be labeled incorrectly as critical in this case and training on negative data may not improve (consistent with running per-step DPO on an over-trained SFT checkpoint in FigureÂ <a href="#S6.F11" title="Figure 11 â€£ 6.3.4 Validating Claims About Generalization: Controlled Analysis on a Didactic Problem â€£ 6.3 Why Does Credit Assignment from Negative Data Improve Model Generalization? â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>). On the other hand, if advantages are more accurate, training on negative data should improve performance.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Related Work</h3>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_bold">Failure modes for supervised finetuning (SFT).</span>
First, since SFT induces an open-loopÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> next-token prediction loss, prediction errors on even a single token can snowball during inference, leading to poor performance on the prompts appearing in the dataitselfÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Second, even when an LLM has perfectly cloned the SFT data, it is prone to memorize â€œhard to learnâ€ tokensÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, especially in planning and lookahead tasksÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, which is critical for math reasoning.
This leads to poor generalizationÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and hallucination on new novel, test-tim promptsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. In this work, we study how synthetic data methods can address these failures via: (i) maximizing likelihood on positive data generated from both the SFT policy and a stronger teacher that enjoys improved coverage over new states,
and (ii) preference optimization using the negative data generated from the SFT policy.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Synthetic Data Generation</h3>

<div id="A4.p1" class="ltx_para ltx_noindent">
<svg id="A4.p1.pic1" class="ltx_picture" height="279.4" overflow="visible" version="1.1" width="600"><g transform="translate(0,279.4) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 273.49 C 0 276.75 2.64 279.4 5.91 279.4 L 594.09 279.4 C 597.36 279.4 600 276.75 600 273.49 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 253.75 L 598.03 253.75 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 259.65)"><foreignObject width="556.69" height="13.84" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A4.p1.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A4.p1.pic1.1.1.1.1.1.1" class="ltx_p">Prompt used for GSM8K/MATH synthetic dataÂ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite></span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="228.16" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A4.p1.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A4.p1.pic1.2.2.2.1.1.1" class="ltx_p">Please act as a professional math teacher.
Your goal is to create high quality math problems to help students learn math.
You will be given a math question. Please create a new question based on the Given Question and following
instructions.</span>
<span id="A4.p1.pic1.2.2.2.1.1.2" class="ltx_p">To achieve the goal, you have one job.</span>
<span id="A4.p1.pic1.2.2.2.1.1.3" class="ltx_p"># Please generate a similar but new question according to the Given Question.</span>
<span id="A4.p1.pic1.2.2.2.1.1.4" class="ltx_p">You have four principles to do this.
# Ensure the new question only asks for one thing, be reasonable, be based on the Given Question, and can be
answered with only a number(float or integer). For example, DO NOT ask, â€˜what is the amount of A, B and
C?â€™.</span>
<span id="A4.p1.pic1.2.2.2.1.1.5" class="ltx_p"># Ensure the new question is in line with common sense of life. For example, the amount someone has or pays
must be a positive number, and the number of people must be an integer.</span>
<span id="A4.p1.pic1.2.2.2.1.1.6" class="ltx_p"># Ensure your student can answer the new question without the given question. If you want to use some
numbers, conditions or background in the given question, please restate them to ensure no information is
omitted in your new question.</span>
<span id="A4.p1.pic1.2.2.2.1.1.7" class="ltx_p"># You only need to create the new question. Please DO NOT solve it.</span>
<span id="A4.p1.pic1.2.2.2.1.1.8" class="ltx_p">Given Question: &lt;insert question from original dataset here&gt;</span>
<span id="A4.p1.pic1.2.2.2.1.1.9" class="ltx_p">Your output should be in the following format:</span>
<span id="A4.p1.pic1.2.2.2.1.1.10" class="ltx_p">CREATED QUESTION: &lt;your created question&gt;</span>
</span></foreignObject></g></g></svg>
</div>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p">For GSM8K, we replace the phrase â€œYour goal is to create high quality math problems to help students learn math.â€ with â€œYour goal is to create high quality math <em id="A4.p2.1.1" class="ltx_emph ltx_font_italic">word</em> problems to help students learn math.â€, as we found this to produce problems that were closer to GSM-style problems.</p>
</div>
<div id="A4.p3" class="ltx_para ltx_noindent">
<p id="A4.p3.1" class="ltx_p">To generate the synthetic data, we used OpenAI credits worth approximately 3000 US dollars.</p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Negative Data Identifies Spurious Steps with Advantage Estimates</h3>

<div id="A5.p1" class="ltx_para ltx_noindent">
<p id="A5.p1.1" class="ltx_p">In this section, we present several examples from the GSM8K and MATH synthetic datasets of model-generated (from <math id="A5.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A5.p1.1.m1.1a"><msub id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml"><mi id="A5.p1.1.m1.1.1.2" xref="A5.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="A5.p1.1.m1.1.1.3" xref="A5.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><apply id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A5.p1.1.m1.1.1.1.cmml" xref="A5.p1.1.m1.1.1">subscript</csymbol><ci id="A5.p1.1.m1.1.1.2.cmml" xref="A5.p1.1.m1.1.1.2">ğœ‹</ci><ci id="A5.p1.1.m1.1.1.3.cmml" xref="A5.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>) positive data with spurious steps. Then, we show how computing advantage values accurately identify the spurious steps. We highlight the steps that were deemed to be low or high advantage based on the estimated advantage value. The darker the intensity of the color, the lower the advantage of that step. With this qualitative probe, we see that the steps that are darkest are indeed either incorrect or correct but involve a reasoning step that is irrelevant for solving the problem at hand.</p>
</div>
<div id="A5.p2" class="ltx_para ltx_noindent">
<svg id="A5.p2.pic1" class="ltx_picture" height="262.64" overflow="visible" version="1.1" width="600"><g transform="translate(0,262.64) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 256.73 C 0 259.99 2.64 262.64 5.91 262.64 L 594.09 262.64 C 597.36 262.64 600 259.99 600 256.73 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 238.53 L 598.03 238.53 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 244.43)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A5.p2.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p2.pic1.1.1.1.1.1.1" class="ltx_p">Spurious step identified by negative data</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="212.94" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A5.p2.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p2.pic1.2.2.2.1.1.1" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold">Question:</span>
Ken created a care package to send to his brother, who was away at boarding school. Ken placed a box on a scale, and then he poured into the box enough jelly beans to bring the weight to 2 pounds. Then, he added enough brownies to cause the weight to triple. Next, he added another 2 pounds of jelly beans. And finally, he added enough gummy worms to double the weight once again. What was the final weight of the box of goodies, in pounds?</span>
<span id="A5.p2.pic1.2.2.2.1.1.2" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.2.1" class="ltx_text ltx_font_bold">Positive response with identified spurious step: </span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3" class="ltx_p">
<span id="A5.p2.pic1.2.2.2.1.1.3.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="A5.p2.pic1.2.2.2.1.1.3.1.1" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.1.1" class="ltx_text" style="background-color:#FFABAB;">When</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.2" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.2.1" class="ltx_text" style="background-color:#FFABAB;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.3" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.3.1" class="ltx_text" style="background-color:#FFABAB;">weight</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.4" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.4.1" class="ltx_text" style="background-color:#FFABAB;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.5" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.5.1" class="ltx_text" style="background-color:#FFABAB;">originally</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.6" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.6.1" class="ltx_text" style="background-color:#FFABAB;">on</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.7" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.7.1" class="ltx_text" style="background-color:#FFABAB;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.8" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.8.1" class="ltx_text" style="background-color:#FFABAB;">scale,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.9" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.9.1" class="ltx_text" style="background-color:#FFABAB;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.10" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.10.1" class="ltx_text" style="background-color:#FFABAB;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.11" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.11.1" class="ltx_text" style="background-color:#FFABAB;">weighed</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.12" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.12.1" class="ltx_text" style="background-color:#FFABAB;">0</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.13" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.13.1" class="ltx_text" style="background-color:#FFABAB;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.14" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.14.1" class="ltx_text" style="background-color:#FFECEC;">After</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.15" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.15.1" class="ltx_text" style="background-color:#FFECEC;">Ken</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.16" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.16.1" class="ltx_text" style="background-color:#FFECEC;">added</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.17" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.17.1" class="ltx_text" style="background-color:#FFECEC;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.18" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.18.1" class="ltx_text" style="background-color:#FFECEC;">jelly</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.19" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.19.1" class="ltx_text" style="background-color:#FFECEC;">beans</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.20" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.20.1" class="ltx_text" style="background-color:#FFECEC;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.21" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.21.1" class="ltx_text" style="background-color:#FFECEC;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.22" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.22.1" class="ltx_text" style="background-color:#FFECEC;">box,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.23" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.23.1" class="ltx_text" style="background-color:#FFECEC;">its</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.24" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.24.1" class="ltx_text" style="background-color:#FFECEC;">weight</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.25" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.25.1" class="ltx_text" style="background-color:#FFECEC;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.26" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.26.1" class="ltx_text" style="background-color:#FFECEC;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.27" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.27.1" class="ltx_text" style="background-color:#FFECEC;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.28" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.28.1" class="ltx_text" style="background-color:#FFECEC;">-</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.29" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.29.1" class="ltx_text" style="background-color:#FFECEC;">0</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.30" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.30.1" class="ltx_text" style="background-color:#FFECEC;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.31" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.31.1" class="ltx_text" style="background-color:#FFECEC;">=</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.32" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.32.1" class="ltx_text" style="background-color:#FFECEC;">&lt;&lt;2-0=2&gt;&gt;2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.33" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.33.1" class="ltx_text" style="background-color:#FFECEC;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.34" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.34.1" class="ltx_text" style="background-color:#FFC9C9;">Then</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.35" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.35.1" class="ltx_text" style="background-color:#FFC9C9;">Ken</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.36" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.36.1" class="ltx_text" style="background-color:#FFC9C9;">added</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.37" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.37.1" class="ltx_text" style="background-color:#FFC9C9;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.38" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.38.1" class="ltx_text" style="background-color:#FFC9C9;">brownies</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.39" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.39.1" class="ltx_text" style="background-color:#FFC9C9;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.40" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.40.1" class="ltx_text" style="background-color:#FFC9C9;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.41" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.41.1" class="ltx_text" style="background-color:#FFC9C9;">box,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.42" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.42.1" class="ltx_text" style="background-color:#FFC9C9;">which</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.43" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.43.1" class="ltx_text" style="background-color:#FFC9C9;">caused</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.44" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.44.1" class="ltx_text" style="background-color:#FFC9C9;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.45" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.45.1" class="ltx_text" style="background-color:#FFC9C9;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.46" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.46.1" class="ltx_text" style="background-color:#FFC9C9;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.47" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.47.1" class="ltx_text" style="background-color:#FFC9C9;">weigh</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.48" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.48.1" class="ltx_text" style="background-color:#FFC9C9;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.49" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.49.1" class="ltx_text" style="background-color:#FFC9C9;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.50" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.50.1" class="ltx_text" style="background-color:#FFC9C9;">*</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.51" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.51.1" class="ltx_text" style="background-color:#FFC9C9;">3</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.52" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.52.1" class="ltx_text" style="background-color:#FFC9C9;">=</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.53" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.53.1" class="ltx_text" style="background-color:#FFC9C9;">&lt;&lt;2*3=6&gt;&gt;6</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.54" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.54.1" class="ltx_text" style="background-color:#FFC9C9;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.55" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.55.1" class="ltx_text" style="background-color:#FFB3B3;">The</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.56" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.56.1" class="ltx_text" style="background-color:#FFB3B3;">next</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.57" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.57.1" class="ltx_text" style="background-color:#FFB3B3;">step</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.58" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.58.1" class="ltx_text" style="background-color:#FFB3B3;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.59" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.59.1" class="ltx_text" style="background-color:#FFB3B3;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.60" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.60.1" class="ltx_text" style="background-color:#FFB3B3;">add</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.61" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.61.1" class="ltx_text" style="background-color:#FFB3B3;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.62" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.62.1" class="ltx_text" style="background-color:#FFB3B3;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.63" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.63.1" class="ltx_text" style="background-color:#FFB3B3;">of</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.64" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.64.1" class="ltx_text" style="background-color:#FFB3B3;">jelly</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.65" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.65.1" class="ltx_text" style="background-color:#FFB3B3;">beans,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.66" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.66.1" class="ltx_text" style="background-color:#FFB3B3;">which</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.67" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.67.1" class="ltx_text" style="background-color:#FFB3B3;">caused</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.68" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.68.1" class="ltx_text" style="background-color:#FFB3B3;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.69" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.69.1" class="ltx_text" style="background-color:#FFB3B3;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.70" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.70.1" class="ltx_text" style="background-color:#FFB3B3;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.71" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.71.1" class="ltx_text" style="background-color:#FFB3B3;">weigh</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.72" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.72.1" class="ltx_text" style="background-color:#FFB3B3;">6</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.73" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.73.1" class="ltx_text" style="background-color:#FFB3B3;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.74" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.74.1" class="ltx_text" style="background-color:#FFB3B3;">+</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.75" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.75.1" class="ltx_text" style="background-color:#FFB3B3;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.76" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.76.1" class="ltx_text" style="background-color:#FFB3B3;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.77" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.77.1" class="ltx_text" style="background-color:#FFB3B3;">=</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.78" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.78.1" class="ltx_text" style="background-color:#FFB3B3;">&lt;&lt;6+2=8&gt;&gt;8</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.79" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.79.1" class="ltx_text" style="background-color:#FFB3B3;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.80" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.80.1" class="ltx_text" style="background-color:#FF6161;">First,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.81" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.81.1" class="ltx_text" style="background-color:#FF6161;">we</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.82" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.82.1" class="ltx_text" style="background-color:#FF6161;">need</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.83" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.83.1" class="ltx_text" style="background-color:#FF6161;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.84" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.84.1" class="ltx_text" style="background-color:#FF6161;">figure</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.85" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.85.1" class="ltx_text" style="background-color:#FF6161;">out</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.86" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.86.1" class="ltx_text" style="background-color:#FF6161;">what</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.87" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.87.1" class="ltx_text" style="background-color:#FF6161;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.88" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.88.1" class="ltx_text" style="background-color:#FF6161;">weight</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.89" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.89.1" class="ltx_text" style="background-color:#FF6161;">of</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.90" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.90.1" class="ltx_text" style="background-color:#FF6161;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.91" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.91.1" class="ltx_text" style="background-color:#FF6161;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.92" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.92.1" class="ltx_text" style="background-color:#FF6161;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.93" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.93.1" class="ltx_text" style="background-color:#FF6161;">when</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.94" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.94.1" class="ltx_text" style="background-color:#FF6161;">Ken</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.95" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.95.1" class="ltx_text" style="background-color:#FF6161;">put</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.96" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.96.1" class="ltx_text" style="background-color:#FF6161;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.97" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.97.1" class="ltx_text" style="background-color:#FF6161;">jelly</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.98" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.98.1" class="ltx_text" style="background-color:#FF6161;">beans</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.99" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.99.1" class="ltx_text" style="background-color:#FF6161;">in</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.100" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.100.1" class="ltx_text" style="background-color:#FF6161;">it.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.101" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.101.1" class="ltx_text" style="background-color:#FF6161;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.102" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.102.1" class="ltx_text" style="background-color:#FF6161;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.103" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.103.1" class="ltx_text" style="background-color:#FF6161;">of</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.104" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.104.1" class="ltx_text" style="background-color:#FF6161;">jelly</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.105" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.105.1" class="ltx_text" style="background-color:#FF6161;">beans</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.106" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.106.1" class="ltx_text" style="background-color:#FF6161;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.107" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.107.1" class="ltx_text" style="background-color:#FF6161;">enough</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.108" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.108.1" class="ltx_text" style="background-color:#FF6161;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.109" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.109.1" class="ltx_text" style="background-color:#FF6161;">triple</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.110" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.110.1" class="ltx_text" style="background-color:#FF6161;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.111" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.111.1" class="ltx_text" style="background-color:#FF6161;">weight,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.112" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.112.1" class="ltx_text" style="background-color:#FF6161;">so</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.113" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.113.1" class="ltx_text" style="background-color:#FF6161;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.114" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.114.1" class="ltx_text" style="background-color:#FF6161;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.115" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.115.1" class="ltx_text" style="background-color:#FF6161;">was</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.116" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.116.1" class="ltx_text" style="background-color:#FF6161;">at</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.117" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.117.1" class="ltx_text" style="background-color:#FF6161;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.118" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.118.1" class="ltx_text" style="background-color:#FF6161;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.119" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.119.1" class="ltx_text" style="background-color:#FF6161;">/</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.120" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.120.1" class="ltx_text" style="background-color:#FF6161;">3</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.121" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.121.1" class="ltx_text" style="background-color:#FF6161;">=</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.122" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.122.1" class="ltx_text" style="background-color:#FF6161;">&lt;&lt;2/3=.6666666666666667&gt;&gt;.6666666666666667</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.123" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.123.1" class="ltx_text" style="background-color:#FF6161;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.124" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.124.1" class="ltx_text" style="background-color:#FFB2B2;">Finally,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.125" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.125.1" class="ltx_text" style="background-color:#FFB2B2;">Ken</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.126" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.126.1" class="ltx_text" style="background-color:#FFB2B2;">added</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.127" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.127.1" class="ltx_text" style="background-color:#FFB2B2;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.128" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.128.1" class="ltx_text" style="background-color:#FFB2B2;">gummy</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.129" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.129.1" class="ltx_text" style="background-color:#FFB2B2;">worms,</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.130" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.130.1" class="ltx_text" style="background-color:#FFB2B2;">causing</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.131" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.131.1" class="ltx_text" style="background-color:#FFB2B2;">the</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.132" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.132.1" class="ltx_text" style="background-color:#FFB2B2;">box</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.133" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.133.1" class="ltx_text" style="background-color:#FFB2B2;">to</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.134" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.134.1" class="ltx_text" style="background-color:#FFB2B2;">weigh</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.135" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.135.1" class="ltx_text" style="background-color:#FFB2B2;">8</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.136" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.136.1" class="ltx_text" style="background-color:#FFB2B2;">pounds</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.137" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.137.1" class="ltx_text" style="background-color:#FFB2B2;">*</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.138" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.138.1" class="ltx_text" style="background-color:#FFB2B2;">2</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.139" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.139.1" class="ltx_text" style="background-color:#FFB2B2;">=</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.140" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.140.1" class="ltx_text" style="background-color:#FFB2B2;">&lt;&lt;8*2=16&gt;&gt;16</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.141" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.141.1" class="ltx_text" style="background-color:#FFB2B2;">pounds.</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.142" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.142.1" class="ltx_text" style="background-color:#FFF4F4;">The</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.143" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.143.1" class="ltx_text" style="background-color:#FFF4F4;">answer</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.144" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.144.1" class="ltx_text" style="background-color:#FFF4F4;">is</span></span>
<span id="A5.p2.pic1.2.2.2.1.1.3.1.145" class="ltx_p"><span id="A5.p2.pic1.2.2.2.1.1.3.1.145.1" class="ltx_text" style="background-color:#FFF4F4;">16</span></span>
</span></span>
</span></foreignObject></g></g></svg>
</div>
<div id="A5.p3" class="ltx_para ltx_noindent">
<svg id="A5.p3.pic1" class="ltx_picture" height="160.32" overflow="visible" version="1.1" width="600"><g transform="translate(0,160.32) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 154.41 C 0 157.68 2.64 160.32 5.91 160.32 L 594.09 160.32 C 597.36 160.32 600 157.68 600 154.41 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 136.21 L 598.03 136.21 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 142.12)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A5.p3.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p3.pic1.1.1.1.1.1.1" class="ltx_p">Spurious step identified by negative data</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="110.62" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A5.p3.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p3.pic1.2.2.2.1.1.1" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold">Question:</span>
Betty is saving money for a new wallet which costs $100. Betty has only half of the money she needs. Her parents decided to give her $15 for that purpose, and her grandparents twice as much as her parents. How much more money does Betty need to buy the wallet?</span>
<span id="A5.p3.pic1.2.2.2.1.1.2" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.2.1" class="ltx_text ltx_font_bold">Positive response with identified spurious step: </span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3" class="ltx_p">
<span id="A5.p3.pic1.2.2.2.1.1.3.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="A5.p3.pic1.2.2.2.1.1.3.1.1" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.1.1" class="ltx_text" style="background-color:#FFCCCC;">Bettyâ€™s</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.2" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.2.1" class="ltx_text" style="background-color:#FFCCCC;">parents</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.3" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.3.1" class="ltx_text" style="background-color:#FFCCCC;">gave</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.4" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.4.1" class="ltx_text" style="background-color:#FFCCCC;">her</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.5" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.5.1" class="ltx_text" style="background-color:#FFCCCC;">15,</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.6" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.6.1" class="ltx_text" style="background-color:#FFCCCC;">so</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.7" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.7.1" class="ltx_text" style="background-color:#FFCCCC;">her</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.8" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.8.1" class="ltx_text" style="background-color:#FFCCCC;">grandparents</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.9" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.9.1" class="ltx_text" style="background-color:#FFCCCC;">gave</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.10" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.10.1" class="ltx_text" style="background-color:#FFCCCC;">her</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.11" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.11.1" class="ltx_text" style="background-color:#FFCCCC;">2</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.12" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.12.1" class="ltx_text" style="background-color:#FFCCCC;">*</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.13" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.13.1" class="ltx_text" style="background-color:#FFCCCC;">15</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.14" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.14.1" class="ltx_text" style="background-color:#FFCCCC;">=</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.15" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.15.1" class="ltx_text" style="background-color:#FFCCCC;">&lt;&lt;15*2=30&gt;&gt;30.</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.16" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.16.1" class="ltx_text" style="background-color:#FFD4D4;">In</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.17" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.17.1" class="ltx_text" style="background-color:#FFD4D4;">total,</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.18" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.18.1" class="ltx_text" style="background-color:#FFD4D4;">Betty</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.19" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.19.1" class="ltx_text" style="background-color:#FFD4D4;">received</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.20" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.20.1" class="ltx_text" style="background-color:#FFD4D4;">30</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.21" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.21.1" class="ltx_text" style="background-color:#FFD4D4;">+</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.22" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.22.1" class="ltx_text" style="background-color:#FFD4D4;">15</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.23" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.23.1" class="ltx_text" style="background-color:#FFD4D4;">=</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.24" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.24.1" class="ltx_text" style="background-color:#FFD4D4;">&lt;&lt;30+15=45&gt;&gt;45.</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.25" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.25.1" class="ltx_text" style="background-color:#FF5E5E;">The</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.26" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.26.1" class="ltx_text" style="background-color:#FF5E5E;">total</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.27" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.27.1" class="ltx_text" style="background-color:#FF5E5E;">amount</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.28" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.28.1" class="ltx_text" style="background-color:#FF5E5E;">of</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.29" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.29.1" class="ltx_text" style="background-color:#FF5E5E;">money</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.30" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.30.1" class="ltx_text" style="background-color:#FF5E5E;">Betty</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.31" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.31.1" class="ltx_text" style="background-color:#FF5E5E;">needs</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.32" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.32.1" class="ltx_text" style="background-color:#FF5E5E;">is</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.33" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.33.1" class="ltx_text" style="background-color:#FF5E5E;">100</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.34" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.34.1" class="ltx_text" style="background-color:#FF5E5E;">*</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.35" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.35.1" class="ltx_text" style="background-color:#FF5E5E;">2</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.36" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.36.1" class="ltx_text" style="background-color:#FF5E5E;">=</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.37" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.37.1" class="ltx_text" style="background-color:#FF5E5E;">&lt;&lt;100*2=200&gt;&gt;200.</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.38" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.38.1" class="ltx_text" style="background-color:#FFC4C4;">Betty</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.39" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.39.1" class="ltx_text" style="background-color:#FFC4C4;">needs</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.40" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.40.1" class="ltx_text" style="background-color:#FFC4C4;">100</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.41" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.41.1" class="ltx_text" style="background-color:#FFC4C4;">/</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.42" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.42.1" class="ltx_text" style="background-color:#FFC4C4;">2</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.43" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.43.1" class="ltx_text" style="background-color:#FFC4C4;">=</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.44" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.44.1" class="ltx_text" style="background-color:#FFC4C4;">&lt;&lt;100/2=50&gt;&gt;50</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.45" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.45.1" class="ltx_text" style="background-color:#FFC4C4;">in</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.46" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.46.1" class="ltx_text" style="background-color:#FFC4C4;">total.</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.47" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.47.1" class="ltx_text" style="background-color:#FFA0A0;">Betty</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.48" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.48.1" class="ltx_text" style="background-color:#FFA0A0;">still</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.49" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.49.1" class="ltx_text" style="background-color:#FFA0A0;">needs</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.50" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.50.1" class="ltx_text" style="background-color:#FFA0A0;">to</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.51" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.51.1" class="ltx_text" style="background-color:#FFA0A0;">save</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.52" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.52.1" class="ltx_text" style="background-color:#FFA0A0;">50</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.53" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.53.1" class="ltx_text" style="background-color:#FFA0A0;">-</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.54" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.54.1" class="ltx_text" style="background-color:#FFA0A0;">45</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.55" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.55.1" class="ltx_text" style="background-color:#FFA0A0;">=</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.56" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.56.1" class="ltx_text" style="background-color:#FFA0A0;">&lt;&lt;50-45=5&gt;&gt;5.</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.57" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.57.1" class="ltx_text" style="background-color:#FFC1C1;">The</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.58" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.58.1" class="ltx_text" style="background-color:#FFC1C1;">answer</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.59" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.59.1" class="ltx_text" style="background-color:#FFC1C1;">is</span></span>
<span id="A5.p3.pic1.2.2.2.1.1.3.1.60" class="ltx_p"><span id="A5.p3.pic1.2.2.2.1.1.3.1.60.1" class="ltx_text" style="background-color:#FFC1C1;">5</span></span>
</span></span>
</span></foreignObject></g></g></svg>
</div>
<div id="A5.p4" class="ltx_para ltx_noindent">
<svg id="A5.p4.pic1" class="ltx_picture" height="147.94" overflow="visible" version="1.1" width="600"><g transform="translate(0,147.94) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 142.04 C 0 145.3 2.64 147.94 5.91 147.94 L 594.09 147.94 C 597.36 147.94 600 145.3 600 142.04 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 123.83 L 598.03 123.83 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 129.74)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A5.p4.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p4.pic1.1.1.1.1.1.1" class="ltx_p">Spurious step identified by negative data</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="98.24" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A5.p4.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p4.pic1.2.2.2.1.1.1" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold">Question:</span>
To make pizza, together with other ingredients, Kimber needs 10 cups of water, 16 cups of flour, and 1/2 times as many teaspoons of salt as the number of cups of flour. Calculate the combined total number of cups of water, flour, and teaspoons of salt that she needs to make the pizza.</span>
<span id="A5.p4.pic1.2.2.2.1.1.2" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.2.1" class="ltx_text ltx_font_bold">Positive response with identified spurious step:</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3" class="ltx_p">
<span id="A5.p4.pic1.2.2.2.1.1.3.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="A5.p4.pic1.2.2.2.1.1.3.1.1" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.1.1" class="ltx_text" style="background-color:#FFC4C4;">Since</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.2" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.2.1" class="ltx_text" style="background-color:#FFC4C4;">1</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.3" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.3.1" class="ltx_text" style="background-color:#FFC4C4;">cup</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.4" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.4.1" class="ltx_text" style="background-color:#FFC4C4;">is</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.5" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.5.1" class="ltx_text" style="background-color:#FFC4C4;">equal</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.6" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.6.1" class="ltx_text" style="background-color:#FFC4C4;">to</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.7" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.7.1" class="ltx_text" style="background-color:#FFC4C4;">16</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.8" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.8.1" class="ltx_text" style="background-color:#FFC4C4;">teaspoons,</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.9" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.9.1" class="ltx_text" style="background-color:#FFC4C4;">then</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.10" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.10.1" class="ltx_text" style="background-color:#FFC4C4;">Kimber</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.11" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.11.1" class="ltx_text" style="background-color:#FFC4C4;">needs</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.12" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.12.1" class="ltx_text" style="background-color:#FFC4C4;">128/16</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.13" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.13.1" class="ltx_text" style="background-color:#FFC4C4;">=</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.14" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.14.1" class="ltx_text" style="background-color:#FFC4C4;">&lt;&lt;128/16=8&gt;&gt;8</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.15" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.15.1" class="ltx_text" style="background-color:#FFC4C4;">cups</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.16" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.16.1" class="ltx_text" style="background-color:#FFC4C4;">of</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.17" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.17.1" class="ltx_text" style="background-color:#FFC4C4;">salt.</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.18" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.18.1" class="ltx_text" style="background-color:#FFC2C2;">So</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.19" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.19.1" class="ltx_text" style="background-color:#FFC2C2;">in</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.20" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.20.1" class="ltx_text" style="background-color:#FFC2C2;">total,</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.21" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.21.1" class="ltx_text" style="background-color:#FFC2C2;">she</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.22" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.22.1" class="ltx_text" style="background-color:#FFC2C2;">needs</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.23" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.23.1" class="ltx_text" style="background-color:#FFC2C2;">10+16+8</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.24" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.24.1" class="ltx_text" style="background-color:#FFC2C2;">=</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.25" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.25.1" class="ltx_text" style="background-color:#FFC2C2;">&lt;&lt;10+16+8=34&gt;&gt;34</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.26" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.26.1" class="ltx_text" style="background-color:#FFC2C2;">cups</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.27" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.27.1" class="ltx_text" style="background-color:#FFC2C2;">of</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.28" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.28.1" class="ltx_text" style="background-color:#FFC2C2;">water,</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.29" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.29.1" class="ltx_text" style="background-color:#FFC2C2;">flour,</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.30" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.30.1" class="ltx_text" style="background-color:#FFC2C2;">and</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.31" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.31.1" class="ltx_text" style="background-color:#FFC2C2;">salt.</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.32" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.32.1" class="ltx_text" style="background-color:#FF3434;">In</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.33" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.33.1" class="ltx_text" style="background-color:#FF3434;">cups,</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.34" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.34.1" class="ltx_text" style="background-color:#FF3434;">the</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.35" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.35.1" class="ltx_text" style="background-color:#FF3434;">amount</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.36" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.36.1" class="ltx_text" style="background-color:#FF3434;">of</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.37" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.37.1" class="ltx_text" style="background-color:#FF3434;">salt</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.38" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.38.1" class="ltx_text" style="background-color:#FF3434;">is</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.39" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.39.1" class="ltx_text" style="background-color:#FF3434;">128/6</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.40" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.40.1" class="ltx_text" style="background-color:#FF3434;">=</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.41" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.41.1" class="ltx_text" style="background-color:#FF3434;">&lt;&lt;128/6=21.33&gt;&gt;21.33</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.42" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.42.1" class="ltx_text" style="background-color:#FF3434;">cups</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.43" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.43.1" class="ltx_text" style="background-color:#FFE5E5;">The</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.44" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.44.1" class="ltx_text" style="background-color:#FFE5E5;">answer</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.45" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.45.1" class="ltx_text" style="background-color:#FFE5E5;">is</span></span>
<span id="A5.p4.pic1.2.2.2.1.1.3.1.46" class="ltx_p"><span id="A5.p4.pic1.2.2.2.1.1.3.1.46.1" class="ltx_text" style="background-color:#FFE5E5;">34</span></span>
</span></span>
</span></foreignObject></g></g></svg>
</div>
<div id="A5.p5" class="ltx_para ltx_noindent">
<svg id="A5.p5.pic1" class="ltx_picture" height="330.59" overflow="visible" version="1.1" width="600"><g transform="translate(0,330.59) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 324.69 C 0 327.95 2.64 330.59 5.91 330.59 L 594.09 330.59 C 597.36 330.59 600 327.95 600 324.69 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 306.48 L 598.03 306.48 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 312.39)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A5.p5.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p5.pic1.2.2.2.1.1.1" class="ltx_p">Spurious step identified by negative data</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="280.89" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Question:</span>
Eight friends compete in a pie eating contest. The chart displays the number of pies each person consumed. Emily ate the most pies, and Mike ate the least. How many more pies did Emily eat compared to Mike?</span><pre id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" class="ltx_verbatim ltx_font_typewriter">
    [asy]\ndefaultpen(linewidth(1pt)+fontsize(10pt));
    \npair[] yaxis = new pair[10];\nfor( int i = 0 ; i &lt; 10 ; ++i )
    {\n\nyaxis[i] = (0,i);\n\ndraw(yaxis[i]--yaxis[i]+(17,0));\n}
    \ndraw((0,0)--(0,9));\ndraw((17,9)--(17,0));
    \n\nfill((1,0)--(1,5)--(2,5)--(2,0)--cycle,grey);
    \nfill((3,0)--(3,8)--(4,8)--(4,0)--cycle,grey);
    \nfill((5,0)--(5,3)--(6,3)--(6,0)--cycle,grey);
    \n\nlabel("0",yaxis[0],W);
    \nlabel("1",yaxis[1],W);\nlabel("2",yaxis[2],W);
    \nlabel("3",yaxis[3],W);\nlabel("4",yaxis[4],W);
    \nlabel("5",yaxis[5],W);\nlabel("6",yaxis[6],W);
    \nlabel("7",yaxis[7],W);\nlabel("8",yaxis[8],W);
    \nlabel("Friends/Participants",(8.5,0),S);
    \nlabel("Results of a Pie Eating Contest",(8.5,9),N);
    \nlabel(rotate(90)*"$\\#$ of Pies Eaten",(-1,4.5),W);[/asy]
</pre>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Positive response with identified spurious step: </span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_p">
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" class="ltx_text" style="background-color:#FFC7C7;">To</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" class="ltx_text" style="background-color:#FFC7C7;">solve</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.1" class="ltx_text" style="background-color:#FFC7C7;">this</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.5" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.5.1" class="ltx_text" style="background-color:#FFC7C7;">problem,</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.6" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.6.1" class="ltx_text" style="background-color:#FFC7C7;">we</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.7" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.7.1" class="ltx_text" style="background-color:#FFC7C7;">need</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.8" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.8.1" class="ltx_text" style="background-color:#FFC7C7;">to</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.9" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.9.1" class="ltx_text" style="background-color:#FFC7C7;">identify</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.10" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.10.1" class="ltx_text" style="background-color:#FFC7C7;">the</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.11" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.11.1" class="ltx_text" style="background-color:#FFC7C7;">number</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.12" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.12.1" class="ltx_text" style="background-color:#FFC7C7;">of</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.13" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.13.1" class="ltx_text" style="background-color:#FFC7C7;">pies</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.14" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.14.1" class="ltx_text" style="background-color:#FFC7C7;">Emily</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.15" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.15.1" class="ltx_text" style="background-color:#FFC7C7;">and</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.16" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.16.1" class="ltx_text" style="background-color:#FFC7C7;">Mike</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.17" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.17.1" class="ltx_text" style="background-color:#FFC7C7;">consumed,</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.18" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.18.1" class="ltx_text" style="background-color:#FFC7C7;">and</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.19" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.19.1" class="ltx_text" style="background-color:#FFC7C7;">then</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.20" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.20.1" class="ltx_text" style="background-color:#FFC7C7;">find</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.21" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.21.1" class="ltx_text" style="background-color:#FFC7C7;">the</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.22" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.22.1" class="ltx_text" style="background-color:#FFC7C7;">difference</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.23" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.23.1" class="ltx_text" style="background-color:#FFC7C7;">between</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.24" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.24.1" class="ltx_text" style="background-color:#FFC7C7;">their</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.25" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.25.1" class="ltx_text" style="background-color:#FFC7C7;">consumption.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.26" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.26.1" class="ltx_text" style="background-color:#FFC7C7;">From</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.27" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.27.1" class="ltx_text" style="background-color:#FFC7C7;">the</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.28" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.28.1" class="ltx_text" style="background-color:#FFC7C7;">chart</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.29" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.29.1" class="ltx_text" style="background-color:#FFC7C7;">provided:</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.30" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.30.1" class="ltx_text" style="background-color:#FF9C9C;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.31" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.31.1" class="ltx_text" style="background-color:#FF9C9C;">Emily:</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.32" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.32.1" class="ltx_text" style="background-color:#FF9C9C;">Consumed</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.33" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.33.1" class="ltx_text" style="background-color:#FF9C9C;">8</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.34" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.34.1" class="ltx_text" style="background-color:#FF9C9C;">pies.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.35" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.35.1" class="ltx_text" style="background-color:#FFF0F0;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.36" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.36.1" class="ltx_text" style="background-color:#FFF0F0;">Mike:</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.37" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.37.1" class="ltx_text" style="background-color:#FFF0F0;">Consumed</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.38" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.38.1" class="ltx_text" style="background-color:#FFF0F0;">1</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.39" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.39.1" class="ltx_text" style="background-color:#FFF0F0;">pie.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.40" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.40.1" class="ltx_text" style="background-color:#FF3F3F;">To</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.41" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.41.1" class="ltx_text" style="background-color:#FF3F3F;">determine</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.42" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.42.1" class="ltx_text" style="background-color:#FF3F3F;">how</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.43" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.43.1" class="ltx_text" style="background-color:#FF3F3F;">many</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.44" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.44.1" class="ltx_text" style="background-color:#FF3F3F;">more</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.45" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.45.1" class="ltx_text" style="background-color:#FF3F3F;">pies</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.46" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.46.1" class="ltx_text" style="background-color:#FF3F3F;">Emily</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.47" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.47.1" class="ltx_text" style="background-color:#FF3F3F;">ate</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.48" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.48.1" class="ltx_text" style="background-color:#FF3F3F;">compared</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.49" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.49.1" class="ltx_text" style="background-color:#FF3F3F;">to</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.50" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.50.1" class="ltx_text" style="background-color:#FF3F3F;">Mike,</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.51" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.51.1" class="ltx_text" style="background-color:#FF3F3F;">we</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.52" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.52.1" class="ltx_text" style="background-color:#FF3F3F;">first</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.53" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.53.1" class="ltx_text" style="background-color:#FF3F3F;">identify</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.54" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.54.1" class="ltx_text" style="background-color:#FF3F3F;">how</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.55" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.55.1" class="ltx_text" style="background-color:#FF3F3F;">many</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.56" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.56.1" class="ltx_text" style="background-color:#FF3F3F;">pies</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.57" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.57.1" class="ltx_text" style="background-color:#FF3F3F;">each</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.58" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.58.1" class="ltx_text" style="background-color:#FF3F3F;">person</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.59" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.59.1" class="ltx_text" style="background-color:#FF3F3F;">ate.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.60" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.60.1" class="ltx_text" style="background-color:#FF3F3F;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.61" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.61.1" class="ltx_text" style="background-color:#FF3F3F;">Emily</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.62" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.62.1" class="ltx_text" style="background-color:#FF3F3F;">ate</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.63" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.63.1" class="ltx_text" style="background-color:#FF3F3F;">5</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.64" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.64.1" class="ltx_text" style="background-color:#FF3F3F;">pies.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.65" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.65.1" class="ltx_text" style="background-color:#FF3F3F;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.66" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.66.1" class="ltx_text" style="background-color:#FF3F3F;">Mike</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.67" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.67.1" class="ltx_text" style="background-color:#FF3F3F;">ate</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.68" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.68.1" class="ltx_text" style="background-color:#FF3F3F;">1</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.69" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.69.1" class="ltx_text" style="background-color:#FF3F3F;">pie.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.70" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.70.1" class="ltx_text" style="background-color:#FFDCDC;">Now,</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.71" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.71.1" class="ltx_text" style="background-color:#FFDCDC;">calculating</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.72" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.72.1" class="ltx_text" style="background-color:#FFDCDC;">the</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.73" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.73.1" class="ltx_text" style="background-color:#FFDCDC;">difference</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.74" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.74.1" class="ltx_text" style="background-color:#FFDCDC;">between</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.75" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.75.1" class="ltx_text" style="background-color:#FFDCDC;">Emilyâ€™s</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.76" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.76.1" class="ltx_text" style="background-color:#FFDCDC;">and</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.77" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.77.1" class="ltx_text" style="background-color:#FFDCDC;">Mikeâ€™s</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.78" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.78.1" class="ltx_text" style="background-color:#FFDCDC;">consumption:</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.79" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.79.1" class="ltx_text" style="background-color:#FFA9A9;">[</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.80" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.80.1" class="ltx_text" style="background-color:#FFEBEB;">Difference</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.81" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.81.1" class="ltx_text" style="background-color:#FFEBEB;">=</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.82" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.82.1" class="ltx_text" style="background-color:#FFEBEB;">Emilyâ€™s</span><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.82.2" class="ltx_text" style="background-color:#FFEBEB;"> <span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.82.2.1" class="ltx_text">consumption</span></span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.83" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.83.1" class="ltx_text" style="background-color:#FFEBEB;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.84" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.84.1" class="ltx_text" style="background-color:#FFEBEB;">Mikeâ€™s</span><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.84.2" class="ltx_text" style="background-color:#FFEBEB;"> <span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.84.2.1" class="ltx_text">consumption</span></span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.85" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.85.1" class="ltx_text" style="background-color:#FFEBEB;">=</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.86" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.86.1" class="ltx_text" style="background-color:#FFEBEB;">8</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.87" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.87.1" class="ltx_text" style="background-color:#FFEBEB;">-</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.88" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.88.1" class="ltx_text" style="background-color:#FFEBEB;">1</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.89" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.89.1" class="ltx_text" style="background-color:#FFEBEB;">=</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.90" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.90.1" class="ltx_text" style="background-color:#FFEBEB;">7.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.91" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.91.1" class="ltx_text" style="background-color:#FFB2B2;">]</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.92" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.92.1" class="ltx_text" style="background-color:#FFF4F4;">Therefore,</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.93" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.93.1" class="ltx_text" style="background-color:#FFF4F4;">Emily</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.94" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.94.1" class="ltx_text" style="background-color:#FFF4F4;">ate</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.95" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.95.1" class="ltx_text" style="background-color:#FFF4F4;">7</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.96" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.96.1" class="ltx_text" style="background-color:#FFF4F4;">more</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.97" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.97.1" class="ltx_text" style="background-color:#FFF4F4;">pies</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.98" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.98.1" class="ltx_text" style="background-color:#FFF4F4;">than</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.99" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.99.1" class="ltx_text" style="background-color:#FFF4F4;">Mike.</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.100" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.100.1" class="ltx_text" style="background-color:#FFC0C0;">The</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.101" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.101.1" class="ltx_text" style="background-color:#FFC0C0;">answer</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.102" class="ltx_p"><span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.102.1" class="ltx_text" style="background-color:#FFC0C0;">is</span></span>
<span id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_p"><math id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math ltx_framed ltx_framed_rectangle" style="background-color:#FFC0C0;" display="block"><semantics id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathbackground="#FFC0C0" id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="integer" id="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A5.p5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">7</cn></annotation-xml></semantics></math></span>
</span></span>
</span></foreignObject></g></g></svg>
</div>
<div id="A5.p6" class="ltx_para ltx_noindent">
<svg id="A5.p6.pic1" class="ltx_picture" height="214.36" overflow="visible" version="1.1" width="600"><g transform="translate(0,214.36) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 208.46 C 0 211.72 2.64 214.36 5.91 214.36 L 594.09 214.36 C 597.36 214.36 600 211.72 600 208.46 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 190.25 L 598.03 190.25 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 196.16)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A5.p6.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p6.pic1.2.2.2.1.1.1" class="ltx_p">Spurious step identified by negative data</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="164.66" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Question:</span>
When the base-16 number <math id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="1AB3_{16}" display="inline"><semantics id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mn id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">â€‹</mo><mi id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1a" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">â€‹</mo><mi id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.4" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.4.cmml">B</mi><mo lspace="0em" rspace="0em" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1b" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">â€‹</mo><msub id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.cmml"><mn id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.2" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.2.cmml">3</mn><mn id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.3" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.3.cmml">16</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><times id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"></times><cn type="integer" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">1</cn><ci id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">ğ´</ci><ci id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.4.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.4">ğµ</ci><apply id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5"><csymbol cd="ambiguous" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.1.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5">subscript</csymbol><cn type="integer" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.2.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.2">3</cn><cn type="integer" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.3.cmml" xref="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.5.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">1AB3_{16}</annotation></semantics></math> is written in base 2, how many base-2 digits (bits) does it have?</span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Positive response with identified spurious step: </span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" class="ltx_p">
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:433.6pt;background-color:#F2F2FF;">
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1" class="ltx_text" style="background-color:#FFB9B9;">To</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.1" class="ltx_text" style="background-color:#FFB9B9;">solve</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3.1" class="ltx_text" style="background-color:#FFB9B9;">this</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.4" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.4.1" class="ltx_text" style="background-color:#FFB9B9;">problem,</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.5" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.5.1" class="ltx_text" style="background-color:#FFB9B9;">we</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.6" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.6.1" class="ltx_text" style="background-color:#FFB9B9;">first</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.7" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.7.1" class="ltx_text" style="background-color:#FFB9B9;">need</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.8" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.8.1" class="ltx_text" style="background-color:#FFB9B9;">to</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.9" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.9.1" class="ltx_text" style="background-color:#FFB9B9;">convert</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.10" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.10.1" class="ltx_text" style="background-color:#FFB9B9;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.11" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.11.1" class="ltx_text" style="background-color:#FFB9B9;">base-16</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.12" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.12.1" class="ltx_text" style="background-color:#FFB9B9;">number</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.13" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.13.1" class="ltx_text" style="background-color:#FFB9B9;">1AB3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.14" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.14.1" class="ltx_text" style="background-color:#FFB9B9;">to</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.15" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.15.1" class="ltx_text" style="background-color:#FFB9B9;">base-2.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.16" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.16.1" class="ltx_text" style="background-color:#FFB1B1;">Step</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.17" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.17.1" class="ltx_text" style="background-color:#FFB1B1;">1:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.18" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.18.1" class="ltx_text" style="background-color:#FFB1B1;">Convert</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.19" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.19.1" class="ltx_text" style="background-color:#FFB1B1;">each</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.20" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.20.1" class="ltx_text" style="background-color:#FFB1B1;">digit</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.21" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.21.1" class="ltx_text" style="background-color:#FFB1B1;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.22" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.22.1" class="ltx_text" style="background-color:#FFB1B1;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.23" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.23.1" class="ltx_text" style="background-color:#FFB1B1;">number</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.24" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.24.1" class="ltx_text" style="background-color:#FFB1B1;">from</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.25" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.25.1" class="ltx_text" style="background-color:#FFB1B1;">base-16</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.26" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.26.1" class="ltx_text" style="background-color:#FFB1B1;">to</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.27" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.27.1" class="ltx_text" style="background-color:#FFB1B1;">base-2.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.28" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.28.1" class="ltx_text" style="background-color:#FFECEC;">The</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.29" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.29.1" class="ltx_text" style="background-color:#FFECEC;">number</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.30" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.30.1" class="ltx_text" style="background-color:#FFECEC;">1AB3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.31" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.31.1" class="ltx_text" style="background-color:#FFECEC;">consists</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.32" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.32.1" class="ltx_text" style="background-color:#FFECEC;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.33" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.33.1" class="ltx_text" style="background-color:#FFECEC;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.34" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.34.1" class="ltx_text" style="background-color:#FFECEC;">digits</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.35" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.35.1" class="ltx_text" style="background-color:#FFECEC;">1,</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.36" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.36.1" class="ltx_text" style="background-color:#FFECEC;">A,</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.37" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.37.1" class="ltx_text" style="background-color:#FFECEC;">B,</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.38" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.38.1" class="ltx_text" style="background-color:#FFECEC;">and</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.39" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.39.1" class="ltx_text" style="background-color:#FFECEC;">3.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.40" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.40.1" class="ltx_text" style="background-color:#FFEFEF;">Step</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.41" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.41.1" class="ltx_text" style="background-color:#FFEFEF;">2:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.42" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.42.1" class="ltx_text" style="background-color:#FFEFEF;">Convert</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.43" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.43.1" class="ltx_text" style="background-color:#FFEFEF;">each</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.44" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.44.1" class="ltx_text" style="background-color:#FFEFEF;">digit</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.45" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.45.1" class="ltx_text" style="background-color:#FFEFEF;">individually</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.46" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.46.1" class="ltx_text" style="background-color:#FFEFEF;">to</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.47" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.47.1" class="ltx_text" style="background-color:#FFEFEF;">base-2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.48" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.48.1" class="ltx_text" style="background-color:#FFEFEF;">representation.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.49" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.49.1" class="ltx_text" style="background-color:#FFD1D1;">-</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.50" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.50.1" class="ltx_text" style="background-color:#FFD1D1;">1_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.51" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.51.1" class="ltx_text" style="background-color:#FFD1D1;">=</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.52" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.52.1" class="ltx_text" style="background-color:#FFD1D1;">0001_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.53" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.53.1" class="ltx_text" style="background-color:#FFC1C1;">-</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.54" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.54.1" class="ltx_text" style="background-color:#FFC1C1;">A_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.55" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.55.1" class="ltx_text" style="background-color:#FFC1C1;">=</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.56" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.56.1" class="ltx_text" style="background-color:#FFC1C1;">1010_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.57" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.57.1" class="ltx_text" style="background-color:#FFA3A3;">-</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.58" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.58.1" class="ltx_text" style="background-color:#FFA3A3;">B_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.59" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.59.1" class="ltx_text" style="background-color:#FFA3A3;">=</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.60" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.60.1" class="ltx_text" style="background-color:#FFA3A3;">1011_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.61" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.61.1" class="ltx_text" style="background-color:#FFF5F5;">-</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.62" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.62.1" class="ltx_text" style="background-color:#FFF5F5;">3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.63" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.63.1" class="ltx_text" style="background-color:#FFF5F5;">=</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.64" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.64.1" class="ltx_text" style="background-color:#FFF5F5;">0011_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.65" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.65.1" class="ltx_text" style="background-color:#FFAAAA;">Step</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.66" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.66.1" class="ltx_text" style="background-color:#FFAAAA;">3:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.67" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.67.1" class="ltx_text" style="background-color:#FFAAAA;">Combine</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.68" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.68.1" class="ltx_text" style="background-color:#FFAAAA;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.69" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.69.1" class="ltx_text" style="background-color:#FFAAAA;">base-2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.70" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.70.1" class="ltx_text" style="background-color:#FFAAAA;">representations</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.71" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.71.1" class="ltx_text" style="background-color:#FFAAAA;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.72" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.72.1" class="ltx_text" style="background-color:#FFAAAA;">each</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.73" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.73.1" class="ltx_text" style="background-color:#FFAAAA;">digit.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.74" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.74.1" class="ltx_text" style="background-color:#FFD5D5;">Concatenating</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.75" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.75.1" class="ltx_text" style="background-color:#FFD5D5;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.76" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.76.1" class="ltx_text" style="background-color:#FFD5D5;">individual</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.77" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.77.1" class="ltx_text" style="background-color:#FFD5D5;">base-2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.78" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.78.1" class="ltx_text" style="background-color:#FFD5D5;">representations,</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.79" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.79.1" class="ltx_text" style="background-color:#FFD5D5;">we</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.80" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.80.1" class="ltx_text" style="background-color:#FFD5D5;">get:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.81" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.81.1" class="ltx_text" style="background-color:#FFA0A0;">1AB3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.82" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.82.1" class="ltx_text" style="background-color:#FFA0A0;">=</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.83" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.83.1" class="ltx_text" style="background-color:#FFA0A0;">0001101010110011_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.84" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.84.1" class="ltx_text" style="background-color:#FFB9B9;">Step</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.85" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.85.1" class="ltx_text" style="background-color:#FFB9B9;">4:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.86" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.86.1" class="ltx_text" style="background-color:#FFB9B9;">Count</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.87" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.87.1" class="ltx_text" style="background-color:#FFB9B9;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.88" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.88.1" class="ltx_text" style="background-color:#FFB9B9;">total</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.89" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.89.1" class="ltx_text" style="background-color:#FFB9B9;">number</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.90" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.90.1" class="ltx_text" style="background-color:#FFB9B9;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.91" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.91.1" class="ltx_text" style="background-color:#FFB9B9;">digits</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.92" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.92.1" class="ltx_text" style="background-color:#FFB9B9;">in</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.93" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.93.1" class="ltx_text" style="background-color:#FFB9B9;">the</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.94" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.94.1" class="ltx_text" style="background-color:#FFB9B9;">base-2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.95" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.95.1" class="ltx_text" style="background-color:#FFB9B9;">representation.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.96" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.96.1" class="ltx_text" style="background-color:#FFECEC;">The</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.97" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.97.1" class="ltx_text" style="background-color:#FFECEC;">base-2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.98" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.98.1" class="ltx_text" style="background-color:#FFECEC;">representation</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.99" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.99.1" class="ltx_text" style="background-color:#FFECEC;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.100" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.100.1" class="ltx_text" style="background-color:#FFECEC;">1AB3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.101" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.101.1" class="ltx_text" style="background-color:#FFECEC;">is:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.102" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.102.1" class="ltx_text" style="background-color:#FFA0A0;">0001101010110011_2</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.103" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.103.1" class="ltx_text" style="background-color:#FF3232;">The</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.104" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.104.1" class="ltx_text" style="background-color:#FF3232;">base-16</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.105" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.105.1" class="ltx_text" style="background-color:#FF3232;">number</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.106" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.106.1" class="ltx_text" style="background-color:#FF3232;">(1AB3_{16}</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.107" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.107.1" class="ltx_text" style="background-color:#FF3232;">)</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.108" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.108.1" class="ltx_text" style="background-color:#FF3232;">can</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.109" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.109.1" class="ltx_text" style="background-color:#FF3232;">be</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.110" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.110.1" class="ltx_text" style="background-color:#FF3232;">written</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.111" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.111.1" class="ltx_text" style="background-color:#FF3232;">in</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.112" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.112.1" class="ltx_text" style="background-color:#FF3232;">base</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.113" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.113.1" class="ltx_text" style="background-color:#FF3232;">10</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.114" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.114.1" class="ltx_text" style="background-color:#FF3232;">(decimal)</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.115" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.115.1" class="ltx_text" style="background-color:#FF3232;">as:</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.116" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.116.1" class="ltx_text" style="background-color:#FF3232;">[</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.117" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.117.1" class="ltx_text" style="background-color:#FF3232;">1</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.118" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.118.1" class="ltx_text" style="background-color:#FF3232;">times</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.119" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.119.1" class="ltx_text" style="background-color:#FF3232;">163Ì‚</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.120" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.120.1" class="ltx_text" style="background-color:#FF3232;">+</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.121" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.121.1" class="ltx_text" style="background-color:#FF3232;">A</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.122" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.122.1" class="ltx_text" style="background-color:#FF3232;">times</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.123" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.123.1" class="ltx_text" style="background-color:#FF3232;">162Ì‚</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.124" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.124.1" class="ltx_text" style="background-color:#FF3232;">+</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.125" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.125.1" class="ltx_text" style="background-color:#FF3232;">B</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.126" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.126.1" class="ltx_text" style="background-color:#FF3232;">times</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.127" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.127.1" class="ltx_text" style="background-color:#FF3232;">16</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.128" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.128.1" class="ltx_text" style="background-color:#FF3232;">+</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.129" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.129.1" class="ltx_text" style="background-color:#FF3232;">3</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.130" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.130.1" class="ltx_text" style="background-color:#FF3232;">]</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.131" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.131.1" class="ltx_text" style="background-color:#FF3232;">where</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.132" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.132.1" class="ltx_text" style="background-color:#FF3232;">(A</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.133" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.133.1" class="ltx_text" style="background-color:#FF3232;">)</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.134" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.134.1" class="ltx_text" style="background-color:#FF3232;">and</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.135" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.135.1" class="ltx_text" style="background-color:#FF3232;">(B</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.136" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.136.1" class="ltx_text" style="background-color:#FF3232;">)</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.137" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.137.1" class="ltx_text" style="background-color:#FF3232;">are</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.138" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.138.1" class="ltx_text" style="background-color:#FF3232;">decimal</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.139" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.139.1" class="ltx_text" style="background-color:#FF3232;">digits.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.140" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.140.1" class="ltx_text" style="background-color:#FFE2E2;">This</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.141" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.141.1" class="ltx_text" style="background-color:#FFE2E2;">sequence</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.142" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.142.1" class="ltx_text" style="background-color:#FFE2E2;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.143" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.143.1" class="ltx_text" style="background-color:#FFE2E2;">digits</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.144" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.144.1" class="ltx_text" style="background-color:#FFE2E2;">has</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.145" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.145.1" class="ltx_text" style="background-color:#FFE2E2;">a</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.146" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.146.1" class="ltx_text" style="background-color:#FFE2E2;">total</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.147" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.147.1" class="ltx_text" style="background-color:#FFE2E2;">of</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.148" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.148.1" class="ltx_text" style="background-color:#FFE2E2;">16</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.149" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.149.1" class="ltx_text" style="background-color:#FFE2E2;">digits.</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.150" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.150.1" class="ltx_text" style="background-color:#FFC1C1;">The</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.151" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.151.1" class="ltx_text" style="background-color:#FFC1C1;">answer</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.152" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.152.1" class="ltx_text" style="background-color:#FFC1C1;">is</span></span>
<span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.153" class="ltx_p"><span id="A5.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.153.1" class="ltx_text" style="background-color:#FFC1C1;">boxed{16}</span></span>
</span></span>
</span></foreignObject></g></g></svg>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Details on Star Graph Problem</h3>

<div id="A6.p1" class="ltx_para ltx_noindent">
<p id="A6.p1.1" class="ltx_p">The star graph problem we study is borrowed from Â <cite class="ltx_cite ltx_citemacro_citet">Bachmann and Nagarajan [<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, where given a graph in the shape of a star and a query (center/end node pair), the model is asked to output the full path between the start/end nodes.</p>
</div>
<div id="A6.p2" class="ltx_para ltx_noindent">
<p id="A6.p2.1" class="ltx_p"><span id="A6.p2.1.1" class="ltx_text ltx_font_bold">Goal.</span> <cite class="ltx_cite ltx_citemacro_citet">Bachmann and Nagarajan [<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> show that <math id="A6.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A6.p2.1.m1.1a"><msub id="A6.p2.1.m1.1.1" xref="A6.p2.1.m1.1.1.cmml"><mi id="A6.p2.1.m1.1.1.2" xref="A6.p2.1.m1.1.1.2.cmml">Ï€</mi><mi id="A6.p2.1.m1.1.1.3" xref="A6.p2.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A6.p2.1.m1.1b"><apply id="A6.p2.1.m1.1.1.cmml" xref="A6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A6.p2.1.m1.1.1.1.cmml" xref="A6.p2.1.m1.1.1">subscript</csymbol><ci id="A6.p2.1.m1.1.1.2.cmml" xref="A6.p2.1.m1.1.1.2">ğœ‹</ci><ci id="A6.p2.1.m1.1.1.3.cmml" xref="A6.p2.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> minimizes SFT loss by memorizing the â€œhard-to-predictâ€ node adjacent to the center, and copying the rest of the path from the input graph. This task is highlights the failure of SFT at planning problems (akin to math reasoning).
Thus, we use this as a case study to understand:</p>
</div>
<div id="A6.p3" class="ltx_para ltx_noindent">
<ul id="A6.I1" class="ltx_itemize">
<li id="A6.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A6.I1.i1.p1" class="ltx_para">
<p id="A6.I1.i1.p1.1" class="ltx_p">when accurate advantage estimation is possible with few negative samples from the <math id="A6.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A6.I1.i1.p1.1.m1.1a"><msub id="A6.I1.i1.p1.1.m1.1.1" xref="A6.I1.i1.p1.1.m1.1.1.cmml"><mi id="A6.I1.i1.p1.1.m1.1.1.2" xref="A6.I1.i1.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="A6.I1.i1.p1.1.m1.1.1.3" xref="A6.I1.i1.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A6.I1.i1.p1.1.m1.1b"><apply id="A6.I1.i1.p1.1.m1.1.1.cmml" xref="A6.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A6.I1.i1.p1.1.m1.1.1.1.cmml" xref="A6.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="A6.I1.i1.p1.1.m1.1.1.2.cmml" xref="A6.I1.i1.p1.1.m1.1.1.2">ğœ‹</ci><ci id="A6.I1.i1.p1.1.m1.1.1.3.cmml" xref="A6.I1.i1.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I1.i1.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> model.</p>
</div>
</li>
<li id="A6.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A6.I1.i2.p1" class="ltx_para">
<p id="A6.I1.i2.p1.1" class="ltx_p">whether there are generalization benefits of advantage-weighted RL when advantage estimates are accurate</p>
</div>
</li>
<li id="A6.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A6.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="A6.I1.i3.p1.1" class="ltx_p">when advantage-weighted RL can unlearn the memorized feature that causes <math id="A6.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A6.I1.i3.p1.1.m1.1a"><msub id="A6.I1.i3.p1.1.m1.1.1" xref="A6.I1.i3.p1.1.m1.1.1.cmml"><mi id="A6.I1.i3.p1.1.m1.1.1.2" xref="A6.I1.i3.p1.1.m1.1.1.2.cmml">Ï€</mi><mi id="A6.I1.i3.p1.1.m1.1.1.3" xref="A6.I1.i3.p1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A6.I1.i3.p1.1.m1.1b"><apply id="A6.I1.i3.p1.1.m1.1.1.cmml" xref="A6.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A6.I1.i3.p1.1.m1.1.1.1.cmml" xref="A6.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="A6.I1.i3.p1.1.m1.1.1.2.cmml" xref="A6.I1.i3.p1.1.m1.1.1.2">ğœ‹</ci><ci id="A6.I1.i3.p1.1.m1.1.1.3.cmml" xref="A6.I1.i3.p1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.I1.i3.p1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math> to fail.</p>
</div>
</li>
</ul>
</div>
<div id="A6.p4" class="ltx_para ltx_noindent">
<p id="A6.p4.1" class="ltx_p"><span id="A6.p4.1.1" class="ltx_text ltx_font_bold">SFT dataset.</span> The data we use for supervised fine-tuning consists of 30000 of random star graphs (see examples below) where each graph has a centre node with out degree 2. Hence, there are two paths that originate from the centre node. Each path from the center to one of the end nodes is of length 4. Each node on the path is denoted with a randomly sampled number from 0 to 20.
For example, in the sample â€œ8,3|3,10|14,13|10,1|17,14|8,17/8,13=8,17,14,13â€. The graph is given by the adjacency list â€œ8,3|3,10|14,13|10,1|17,14|8,17/8,13â€, the query is denoted by â€œ8,13â€, and the correct path is given by â€œ8,17,14,13â€.</p>
</div>
<div id="A6.p5" class="ltx_para ltx_noindent">
<p id="A6.p5.3" class="ltx_p"><span id="A6.p5.3.1" class="ltx_text ltx_font_bold">Test-time inference from the model.</span> At test time, the input to the LLM is only thw graph and the query: â€œ8,3|3,10|14,13|10,1|17,14|8,17/8,13=â€ and the model is expected to generate the full path from start node 8 to end node 13. When evaluating the test performance of an LLM, we calculate <math id="A6.p5.1.m1.1" class="ltx_Math" alttext="0/1" display="inline"><semantics id="A6.p5.1.m1.1a"><mrow id="A6.p5.1.m1.1.1" xref="A6.p5.1.m1.1.1.cmml"><mn id="A6.p5.1.m1.1.1.2" xref="A6.p5.1.m1.1.1.2.cmml">0</mn><mo id="A6.p5.1.m1.1.1.1" xref="A6.p5.1.m1.1.1.1.cmml">/</mo><mn id="A6.p5.1.m1.1.1.3" xref="A6.p5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p5.1.m1.1b"><apply id="A6.p5.1.m1.1.1.cmml" xref="A6.p5.1.m1.1.1"><divide id="A6.p5.1.m1.1.1.1.cmml" xref="A6.p5.1.m1.1.1.1"></divide><cn type="integer" id="A6.p5.1.m1.1.1.2.cmml" xref="A6.p5.1.m1.1.1.2">0</cn><cn type="integer" id="A6.p5.1.m1.1.1.3.cmml" xref="A6.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.1.m1.1c">0/1</annotation></semantics></math> accuracy averaged over <math id="A6.p5.2.m2.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="A6.p5.2.m2.1a"><mn id="A6.p5.2.m2.1.1" xref="A6.p5.2.m2.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="A6.p5.2.m2.1b"><cn type="integer" id="A6.p5.2.m2.1.1.cmml" xref="A6.p5.2.m2.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.2.m2.1c">1000</annotation></semantics></math> test star graphs (that are different from train star graphs). The accuracy on a sample is <math id="A6.p5.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A6.p5.3.m3.1a"><mn id="A6.p5.3.m3.1.1" xref="A6.p5.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A6.p5.3.m3.1b"><cn type="integer" id="A6.p5.3.m3.1.1.cmml" xref="A6.p5.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.3.m3.1c">1</annotation></semantics></math> when the LLM accurately predicts all nodes in the graph.</p>
</div>
<div id="A6.p6" class="ltx_para ltx_noindent">
<p id="A6.p6.2" class="ltx_p"><span id="A6.p6.1.1" class="ltx_text ltx_font_bold">Failure models of the SFT model, <math id="A6.p6.1.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A6.p6.1.1.m1.1a"><msub id="A6.p6.1.1.m1.1.1" xref="A6.p6.1.1.m1.1.1.cmml"><mi id="A6.p6.1.1.m1.1.1.2" xref="A6.p6.1.1.m1.1.1.2.cmml">Ï€</mi><mi id="A6.p6.1.1.m1.1.1.3" xref="A6.p6.1.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A6.p6.1.1.m1.1b"><apply id="A6.p6.1.1.m1.1.1.cmml" xref="A6.p6.1.1.m1.1.1"><csymbol cd="ambiguous" id="A6.p6.1.1.m1.1.1.1.cmml" xref="A6.p6.1.1.m1.1.1">subscript</csymbol><ci id="A6.p6.1.1.m1.1.1.2.cmml" xref="A6.p6.1.1.m1.1.1.2">ğœ‹</ci><ci id="A6.p6.1.1.m1.1.1.3.cmml" xref="A6.p6.1.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p6.1.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>.</span> A model with perfect accuracy (0 error) would be the one that has accurately learned the correct feature of backtracking the path from the end node to the start node, and then producing it in reverse.
This computation is precisely what makes the adjacent token â€œhard-to-fitâ€.
On the other hand, if the LLM minimizes next-token prediction loss during SFT by instead memorizing the hard-to-fit adjacent token by overfitting on the random input graph instance, at test time the accuracy would be zero. An intermediate solution that SFT model instead learns is to output a path that is adjacent to the node. At training time, it only needs to memorize which of the two possible path to predict. Note that even this solution does not require the model to backtrack, and is thus easier to quickly learn with a few samples. This would quickly minimize the loss on all but the adjacent node, which the model memorizes as training progresses. On the test set, this model would then have <math id="A6.p6.2.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="A6.p6.2.m1.1a"><mrow id="A6.p6.2.m1.1.1" xref="A6.p6.2.m1.1.1.cmml"><mn id="A6.p6.2.m1.1.1.2" xref="A6.p6.2.m1.1.1.2.cmml">50</mn><mo id="A6.p6.2.m1.1.1.1" xref="A6.p6.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p6.2.m1.1b"><apply id="A6.p6.2.m1.1.1.cmml" xref="A6.p6.2.m1.1.1"><csymbol cd="latexml" id="A6.p6.2.m1.1.1.1.cmml" xref="A6.p6.2.m1.1.1.1">percent</csymbol><cn type="integer" id="A6.p6.2.m1.1.1.2.cmml" xref="A6.p6.2.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p6.2.m1.1c">50\%</annotation></semantics></math> test accuracy.
Note, that as we increase the size of the graph or the node vocabulary size it becomes easier for the model to overfit on the hard to predict adjacent token given random combinations of the input graph. Thus, we choose the vocabulary size to be 20, which is higher than what is needed to represent any input graph of this size.</p>
</div>
<div id="A6.p7" class="ltx_para ltx_noindent">
<p id="A6.p7.1" class="ltx_p">Below we provide examples from degree two, path length 4, node 20 problem, where</p>
</div>
<div id="A6.p8" class="ltx_para ltx_noindent">
<svg id="A6.p8.pic1" class="ltx_picture" height="111.12" overflow="visible" version="1.1" width="600"><g transform="translate(0,111.12) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 105.22 C 0 108.48 2.64 111.12 5.91 111.12 L 594.09 111.12 C 597.36 111.12 600 108.48 600 105.22 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 87.01 L 598.03 87.01 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 92.92)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A6.p8.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A6.p8.pic1.1.1.1.1.1.1" class="ltx_p">Examples of 20 node path length 4 star graph problem</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="61.42" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A6.p8.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A6.p8.pic1.2.2.2.1.1.1" class="ltx_p">Example 1: <span id="A6.p8.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_typewriter">8,3|3,10|14,13|10,1|17,14|8,17/8,13=8,17,14,13</span></span>
<span id="A6.p8.pic1.2.2.2.1.1.2" class="ltx_p">Example 2: <span id="A6.p8.pic1.2.2.2.1.1.2.1" class="ltx_text ltx_font_typewriter">14,16|8,10|9,5|3,14|9,3|5,8/9,16=9,3,14,16</span></span>
<span id="A6.p8.pic1.2.2.2.1.1.3" class="ltx_p">Example 3: <span id="A6.p8.pic1.2.2.2.1.1.3.1" class="ltx_text ltx_font_typewriter">14,1|10,4|9,7|10,17|4,9|17,14/10,7=10,4,9,7</span></span>
<span id="A6.p8.pic1.2.2.2.1.1.4" class="ltx_p">Example 4: <span id="A6.p8.pic1.2.2.2.1.1.4.1" class="ltx_text ltx_font_typewriter">19,8|7,18|14,15|15,7|14,19|8,10/14,10=14,19,8,10</span></span>
<span id="A6.p8.pic1.2.2.2.1.1.5" class="ltx_p">Example 5: <span id="A6.p8.pic1.2.2.2.1.1.5.1" class="ltx_text ltx_font_typewriter">1,6|10,1|6,12|10,17|17,18|18,5/10,12=10,1,6,12</span></span>
</span></foreignObject></g></g></svg>
</div>
<div id="A6.p9" class="ltx_para ltx_noindent">
<p id="A6.p9.1" class="ltx_p"><span id="A6.p9.1.1" class="ltx_text ltx_font_bold">SFT Training details.</span> We finetune a pretrained GPT-2 model with 125 million parameters. We train with a batch size of 128, Adam without any weight decay, and a constant learning rate of <math id="A6.p9.1.m1.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="A6.p9.1.m1.1a"><mrow id="A6.p9.1.m1.1.1" xref="A6.p9.1.m1.1.1.cmml"><mrow id="A6.p9.1.m1.1.1.2" xref="A6.p9.1.m1.1.1.2.cmml"><mn id="A6.p9.1.m1.1.1.2.2" xref="A6.p9.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A6.p9.1.m1.1.1.2.1" xref="A6.p9.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="A6.p9.1.m1.1.1.2.3" xref="A6.p9.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A6.p9.1.m1.1.1.1" xref="A6.p9.1.m1.1.1.1.cmml">âˆ’</mo><mn id="A6.p9.1.m1.1.1.3" xref="A6.p9.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p9.1.m1.1b"><apply id="A6.p9.1.m1.1.1.cmml" xref="A6.p9.1.m1.1.1"><minus id="A6.p9.1.m1.1.1.1.cmml" xref="A6.p9.1.m1.1.1.1"></minus><apply id="A6.p9.1.m1.1.1.2.cmml" xref="A6.p9.1.m1.1.1.2"><times id="A6.p9.1.m1.1.1.2.1.cmml" xref="A6.p9.1.m1.1.1.2.1"></times><cn type="integer" id="A6.p9.1.m1.1.1.2.2.cmml" xref="A6.p9.1.m1.1.1.2.2">1</cn><ci id="A6.p9.1.m1.1.1.2.3.cmml" xref="A6.p9.1.m1.1.1.2.3">ğ‘’</ci></apply><cn type="integer" id="A6.p9.1.m1.1.1.3.cmml" xref="A6.p9.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p9.1.m1.1c">1e-5</annotation></semantics></math> .</p>
</div>
<div id="A6.p10" class="ltx_para ltx_noindent">
<p id="A6.p10.5" class="ltx_p"><span id="A6.p10.5.1" class="ltx_text ltx_font_bold">Advantage estimation and per-step DPO training equivalent to advantage-weighted RL.</span> For a sample from <math id="A6.p10.1.m1.1" class="ltx_Math" alttext="\pi_{\mathrm{sft}}" display="inline"><semantics id="A6.p10.1.m1.1a"><msub id="A6.p10.1.m1.1.1" xref="A6.p10.1.m1.1.1.cmml"><mi id="A6.p10.1.m1.1.1.2" xref="A6.p10.1.m1.1.1.2.cmml">Ï€</mi><mi id="A6.p10.1.m1.1.1.3" xref="A6.p10.1.m1.1.1.3.cmml">sft</mi></msub><annotation-xml encoding="MathML-Content" id="A6.p10.1.m1.1b"><apply id="A6.p10.1.m1.1.1.cmml" xref="A6.p10.1.m1.1.1"><csymbol cd="ambiguous" id="A6.p10.1.m1.1.1.1.cmml" xref="A6.p10.1.m1.1.1">subscript</csymbol><ci id="A6.p10.1.m1.1.1.2.cmml" xref="A6.p10.1.m1.1.1.2">ğœ‹</ci><ci id="A6.p10.1.m1.1.1.3.cmml" xref="A6.p10.1.m1.1.1.3">sft</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p10.1.m1.1c">\pi_{\mathrm{sft}}</annotation></semantics></math>, we estimate the advantage of each step by sampling <math id="A6.p10.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A6.p10.2.m2.1a"><mn id="A6.p10.2.m2.1.1" xref="A6.p10.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A6.p10.2.m2.1b"><cn type="integer" id="A6.p10.2.m2.1.1.cmml" xref="A6.p10.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A6.p10.2.m2.1c">5</annotation></semantics></math> rollouts conditioned on the subsequence uptill the step. We then pair subsequences with shared prefix, <math id="A6.p10.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{1:i}" display="inline"><semantics id="A6.p10.3.m3.1a"><msub id="A6.p10.3.m3.1.1" xref="A6.p10.3.m3.1.1.cmml"><mi id="A6.p10.3.m3.1.1.2" xref="A6.p10.3.m3.1.1.2.cmml">ğ²</mi><mrow id="A6.p10.3.m3.1.1.3" xref="A6.p10.3.m3.1.1.3.cmml"><mn id="A6.p10.3.m3.1.1.3.2" xref="A6.p10.3.m3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A6.p10.3.m3.1.1.3.1" xref="A6.p10.3.m3.1.1.3.1.cmml">:</mo><mi id="A6.p10.3.m3.1.1.3.3" xref="A6.p10.3.m3.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A6.p10.3.m3.1b"><apply id="A6.p10.3.m3.1.1.cmml" xref="A6.p10.3.m3.1.1"><csymbol cd="ambiguous" id="A6.p10.3.m3.1.1.1.cmml" xref="A6.p10.3.m3.1.1">subscript</csymbol><ci id="A6.p10.3.m3.1.1.2.cmml" xref="A6.p10.3.m3.1.1.2">ğ²</ci><apply id="A6.p10.3.m3.1.1.3.cmml" xref="A6.p10.3.m3.1.1.3"><ci id="A6.p10.3.m3.1.1.3.1.cmml" xref="A6.p10.3.m3.1.1.3.1">:</ci><cn type="integer" id="A6.p10.3.m3.1.1.3.2.cmml" xref="A6.p10.3.m3.1.1.3.2">1</cn><ci id="A6.p10.3.m3.1.1.3.3.cmml" xref="A6.p10.3.m3.1.1.3.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p10.3.m3.1c">\mathbf{y}_{1:i}</annotation></semantics></math> differing in the last step <math id="A6.p10.4.m4.1" class="ltx_Math" alttext="+\mathbf{y}_{i+1}" display="inline"><semantics id="A6.p10.4.m4.1a"><mrow id="A6.p10.4.m4.1.1" xref="A6.p10.4.m4.1.1.cmml"><mo id="A6.p10.4.m4.1.1a" xref="A6.p10.4.m4.1.1.cmml">+</mo><msub id="A6.p10.4.m4.1.1.2" xref="A6.p10.4.m4.1.1.2.cmml"><mi id="A6.p10.4.m4.1.1.2.2" xref="A6.p10.4.m4.1.1.2.2.cmml">ğ²</mi><mrow id="A6.p10.4.m4.1.1.2.3" xref="A6.p10.4.m4.1.1.2.3.cmml"><mi id="A6.p10.4.m4.1.1.2.3.2" xref="A6.p10.4.m4.1.1.2.3.2.cmml">i</mi><mo id="A6.p10.4.m4.1.1.2.3.1" xref="A6.p10.4.m4.1.1.2.3.1.cmml">+</mo><mn id="A6.p10.4.m4.1.1.2.3.3" xref="A6.p10.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A6.p10.4.m4.1b"><apply id="A6.p10.4.m4.1.1.cmml" xref="A6.p10.4.m4.1.1"><plus id="A6.p10.4.m4.1.1.1.cmml" xref="A6.p10.4.m4.1.1"></plus><apply id="A6.p10.4.m4.1.1.2.cmml" xref="A6.p10.4.m4.1.1.2"><csymbol cd="ambiguous" id="A6.p10.4.m4.1.1.2.1.cmml" xref="A6.p10.4.m4.1.1.2">subscript</csymbol><ci id="A6.p10.4.m4.1.1.2.2.cmml" xref="A6.p10.4.m4.1.1.2.2">ğ²</ci><apply id="A6.p10.4.m4.1.1.2.3.cmml" xref="A6.p10.4.m4.1.1.2.3"><plus id="A6.p10.4.m4.1.1.2.3.1.cmml" xref="A6.p10.4.m4.1.1.2.3.1"></plus><ci id="A6.p10.4.m4.1.1.2.3.2.cmml" xref="A6.p10.4.m4.1.1.2.3.2">ğ‘–</ci><cn type="integer" id="A6.p10.4.m4.1.1.2.3.3.cmml" xref="A6.p10.4.m4.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p10.4.m4.1c">+\mathbf{y}_{i+1}</annotation></semantics></math> vs. <math id="A6.p10.5.m5.1" class="ltx_Math" alttext="-\mathbf{y}_{i+1}" display="inline"><semantics id="A6.p10.5.m5.1a"><mrow id="A6.p10.5.m5.1.1" xref="A6.p10.5.m5.1.1.cmml"><mo id="A6.p10.5.m5.1.1a" xref="A6.p10.5.m5.1.1.cmml">âˆ’</mo><msub id="A6.p10.5.m5.1.1.2" xref="A6.p10.5.m5.1.1.2.cmml"><mi id="A6.p10.5.m5.1.1.2.2" xref="A6.p10.5.m5.1.1.2.2.cmml">ğ²</mi><mrow id="A6.p10.5.m5.1.1.2.3" xref="A6.p10.5.m5.1.1.2.3.cmml"><mi id="A6.p10.5.m5.1.1.2.3.2" xref="A6.p10.5.m5.1.1.2.3.2.cmml">i</mi><mo id="A6.p10.5.m5.1.1.2.3.1" xref="A6.p10.5.m5.1.1.2.3.1.cmml">+</mo><mn id="A6.p10.5.m5.1.1.2.3.3" xref="A6.p10.5.m5.1.1.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A6.p10.5.m5.1b"><apply id="A6.p10.5.m5.1.1.cmml" xref="A6.p10.5.m5.1.1"><minus id="A6.p10.5.m5.1.1.1.cmml" xref="A6.p10.5.m5.1.1"></minus><apply id="A6.p10.5.m5.1.1.2.cmml" xref="A6.p10.5.m5.1.1.2"><csymbol cd="ambiguous" id="A6.p10.5.m5.1.1.2.1.cmml" xref="A6.p10.5.m5.1.1.2">subscript</csymbol><ci id="A6.p10.5.m5.1.1.2.2.cmml" xref="A6.p10.5.m5.1.1.2.2">ğ²</ci><apply id="A6.p10.5.m5.1.1.2.3.cmml" xref="A6.p10.5.m5.1.1.2.3"><plus id="A6.p10.5.m5.1.1.2.3.1.cmml" xref="A6.p10.5.m5.1.1.2.3.1"></plus><ci id="A6.p10.5.m5.1.1.2.3.2.cmml" xref="A6.p10.5.m5.1.1.2.3.2">ğ‘–</ci><cn type="integer" id="A6.p10.5.m5.1.1.2.3.3.cmml" xref="A6.p10.5.m5.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p10.5.m5.1c">-\mathbf{y}_{i+1}</annotation></semantics></math>, where the former is the one with the highest estimated advantage and the latter is the one with the lowest estimated advantage. Note that this preference pair construction, closely approximates the preference pair distribution in TheoremÂ <a href="#S6.Thmtheorem1" title="Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>, which would imply that the DPO objective being optimized closely approximates advantage weighred RL in EquationÂ <a href="#S6.E4" title="In Theorem 6.1 (Equivalence of advantage-weighted RL and DPO with per-step pairs). â€£ 6.1 Conceptual Model: Constructing Negatives to Enable Per-Step Credit Assignment â€£ 6 Negative Synthetic Data Enables Per-Step Credit Assignment â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="A6.p11" class="ltx_para ltx_noindent">
<p id="A6.p11.1" class="ltx_p">Given these pairs for a batch of star graph problems in SFT data, we update the model with a single gradient step on the DPO objective in EquationÂ <a href="#S4.E1" title="In 4 Learning from Synthetic Data â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In the next iteration, advantage is estimated and pairs are constructed on a fresh batch of star graphs. We set <math id="A6.p11.1.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A6.p11.1.m1.1a"><mrow id="A6.p11.1.m1.1.1" xref="A6.p11.1.m1.1.1.cmml"><mi id="A6.p11.1.m1.1.1.2" xref="A6.p11.1.m1.1.1.2.cmml">Î²</mi><mo id="A6.p11.1.m1.1.1.1" xref="A6.p11.1.m1.1.1.1.cmml">=</mo><mn id="A6.p11.1.m1.1.1.3" xref="A6.p11.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p11.1.m1.1b"><apply id="A6.p11.1.m1.1.1.cmml" xref="A6.p11.1.m1.1.1"><eq id="A6.p11.1.m1.1.1.1.cmml" xref="A6.p11.1.m1.1.1.1"></eq><ci id="A6.p11.1.m1.1.1.2.cmml" xref="A6.p11.1.m1.1.1.2">ğ›½</ci><cn type="float" id="A6.p11.1.m1.1.1.3.cmml" xref="A6.p11.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p11.1.m1.1c">\beta=0.1</annotation></semantics></math> in the DPO objective and use the same batch size (one preference pair per star graph). Starting from an SFT checkpoint we train in the above manner for at least 200 iterations. The SFT model is trained for over 600 iterations.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Implementation Details</h3>

<div id="A7.p1" class="ltx_para ltx_noindent">
<p id="A7.p1.1" class="ltx_p"><span id="A7.p1.1.1" class="ltx_text ltx_font_bold">Datasets and pretrained LLMs.</span> We run all our experiments on GSM8K and MATH datasets. Each dataset has about 7.5k training examples. The GSM8K has about 1.3k and MATH has 5k test examples. We conduct experiments with DeepSeek-Math-7B pretrained LLM and LLama2-7B, both of which have pretrained weights publicly available on Huggingface.</p>
</div>
<div id="A7.p2" class="ltx_para ltx_noindent">
<p id="A7.p2.9" class="ltx_p"><span id="A7.p2.9.1" class="ltx_text ltx_font_bold">Details for SFT/RFT training.</span> For our positive data scaling results, the SFT model is trained for 5 epochs with a learning rate of <math id="A7.p2.1.m1.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="A7.p2.1.m1.1a"><mrow id="A7.p2.1.m1.1.1" xref="A7.p2.1.m1.1.1.cmml"><mrow id="A7.p2.1.m1.1.1.2" xref="A7.p2.1.m1.1.1.2.cmml"><mn id="A7.p2.1.m1.1.1.2.2" xref="A7.p2.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A7.p2.1.m1.1.1.2.1" xref="A7.p2.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="A7.p2.1.m1.1.1.2.3" xref="A7.p2.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A7.p2.1.m1.1.1.1" xref="A7.p2.1.m1.1.1.1.cmml">âˆ’</mo><mn id="A7.p2.1.m1.1.1.3" xref="A7.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.1.m1.1b"><apply id="A7.p2.1.m1.1.1.cmml" xref="A7.p2.1.m1.1.1"><minus id="A7.p2.1.m1.1.1.1.cmml" xref="A7.p2.1.m1.1.1.1"></minus><apply id="A7.p2.1.m1.1.1.2.cmml" xref="A7.p2.1.m1.1.1.2"><times id="A7.p2.1.m1.1.1.2.1.cmml" xref="A7.p2.1.m1.1.1.2.1"></times><cn type="integer" id="A7.p2.1.m1.1.1.2.2.cmml" xref="A7.p2.1.m1.1.1.2.2">1</cn><ci id="A7.p2.1.m1.1.1.2.3.cmml" xref="A7.p2.1.m1.1.1.2.3">ğ‘’</ci></apply><cn type="integer" id="A7.p2.1.m1.1.1.3.cmml" xref="A7.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.1.m1.1c">1e-5</annotation></semantics></math>, and a batch size of <math id="A7.p2.2.m2.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A7.p2.2.m2.1a"><mn id="A7.p2.2.m2.1.1" xref="A7.p2.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A7.p2.2.m2.1b"><cn type="integer" id="A7.p2.2.m2.1.1.cmml" xref="A7.p2.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.2.m2.1c">64</annotation></semantics></math> for all sizes of <math id="A7.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="A7.p2.3.m3.1a"><msub id="A7.p2.3.m3.1.1" xref="A7.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p2.3.m3.1.1.2" xref="A7.p2.3.m3.1.1.2.cmml">ğ’Ÿ</mi><mi id="A7.p2.3.m3.1.1.3" xref="A7.p2.3.m3.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p2.3.m3.1b"><apply id="A7.p2.3.m3.1.1.cmml" xref="A7.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A7.p2.3.m3.1.1.1.cmml" xref="A7.p2.3.m3.1.1">subscript</csymbol><ci id="A7.p2.3.m3.1.1.2.cmml" xref="A7.p2.3.m3.1.1.2">ğ’Ÿ</ci><ci id="A7.p2.3.m3.1.1.3.cmml" xref="A7.p2.3.m3.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.3.m3.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math>. We use a holdout validation set to choose the checkpoint and report the performance of the best performing checkpoint across the five epochs. To generate RFT data we only train the SFT model for <math id="A7.p2.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A7.p2.4.m4.1a"><mn id="A7.p2.4.m4.1.1" xref="A7.p2.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A7.p2.4.m4.1b"><cn type="integer" id="A7.p2.4.m4.1.1.cmml" xref="A7.p2.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.4.m4.1c">2</annotation></semantics></math> epochs (under-trained checkpoint). For each question we sample <math id="A7.p2.5.m5.1" class="ltx_Math" alttext="M=100" display="inline"><semantics id="A7.p2.5.m5.1a"><mrow id="A7.p2.5.m5.1.1" xref="A7.p2.5.m5.1.1.cmml"><mi id="A7.p2.5.m5.1.1.2" xref="A7.p2.5.m5.1.1.2.cmml">M</mi><mo id="A7.p2.5.m5.1.1.1" xref="A7.p2.5.m5.1.1.1.cmml">=</mo><mn id="A7.p2.5.m5.1.1.3" xref="A7.p2.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.5.m5.1b"><apply id="A7.p2.5.m5.1.1.cmml" xref="A7.p2.5.m5.1.1"><eq id="A7.p2.5.m5.1.1.1.cmml" xref="A7.p2.5.m5.1.1.1"></eq><ci id="A7.p2.5.m5.1.1.2.cmml" xref="A7.p2.5.m5.1.1.2">ğ‘€</ci><cn type="integer" id="A7.p2.5.m5.1.1.3.cmml" xref="A7.p2.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.5.m5.1c">M=100</annotation></semantics></math> times, with a temperature of <math id="A7.p2.6.m6.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="A7.p2.6.m6.1a"><mn id="A7.p2.6.m6.1.1" xref="A7.p2.6.m6.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="A7.p2.6.m6.1b"><cn type="float" id="A7.p2.6.m6.1.1.cmml" xref="A7.p2.6.m6.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.6.m6.1c">0.7</annotation></semantics></math> and following Â <cite class="ltx_cite ltx_citemacro_citet">Yuan etÂ al. [<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> we retain at most <math id="A7.p2.7.m7.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A7.p2.7.m7.1a"><mn id="A7.p2.7.m7.1.1" xref="A7.p2.7.m7.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A7.p2.7.m7.1b"><cn type="integer" id="A7.p2.7.m7.1.1.cmml" xref="A7.p2.7.m7.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.7.m7.1c">4</annotation></semantics></math> most diverse (based on edit distance) and correct completions. This is for our results in FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a,b). For FigureÂ <a href="#S5.F2" title="Figure 2 â€£ 5 Positive Data Improves Coverage, But Amplifies Spurious Correlations â€£ RL on Incorrect Synthetic Data Scales the Efficiency of LLM Math Reasoning by Eight-Fold" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c), we sample more than <math id="A7.p2.8.m8.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A7.p2.8.m8.1a"><mn id="A7.p2.8.m8.1.1" xref="A7.p2.8.m8.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A7.p2.8.m8.1b"><cn type="integer" id="A7.p2.8.m8.1.1.cmml" xref="A7.p2.8.m8.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.8.m8.1c">4</annotation></semantics></math> correct solutions and keep sampling responses until we have a dataset of size 10k, 20k, â€¦, 50k, when questions are given by the <math id="A7.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="A7.p2.9.m9.1a"><msub id="A7.p2.9.m9.1.1" xref="A7.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p2.9.m9.1.1.2" xref="A7.p2.9.m9.1.1.2.cmml">ğ’Ÿ</mi><mi id="A7.p2.9.m9.1.1.3" xref="A7.p2.9.m9.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p2.9.m9.1b"><apply id="A7.p2.9.m9.1.1.cmml" xref="A7.p2.9.m9.1.1"><csymbol cd="ambiguous" id="A7.p2.9.m9.1.1.1.cmml" xref="A7.p2.9.m9.1.1">subscript</csymbol><ci id="A7.p2.9.m9.1.1.2.cmml" xref="A7.p2.9.m9.1.1.2">ğ’Ÿ</ci><ci id="A7.p2.9.m9.1.1.3.cmml" xref="A7.p2.9.m9.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.9.m9.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> of size 8k and 16k.
For our experiment on the RFT dataset with purposely inserted spurious steps, as we describe in the main paper, we obtain spurious steps by computing which intermediate steps in a negative response lead to most incorrect solutions and randomly insert this in between reasoning steps for a positive solution in RFT data. See examples below.</p>
</div>
<div id="A7.p3" class="ltx_para ltx_noindent">
<p id="A7.p3.9" class="ltx_p"><span id="A7.p3.9.1" class="ltx_text ltx_font_bold">Details for per-step DPO training.</span>
Training data for DPO is generated in the procedure outlined in Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. The value of <math id="A7.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A7.p3.1.m1.1a"><mi id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b"><ci id="A7.p3.1.m1.1.1.cmml" xref="A7.p3.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">K</annotation></semantics></math> is <math id="A7.p3.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A7.p3.2.m2.1a"><mn id="A7.p3.2.m2.1.1" xref="A7.p3.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A7.p3.2.m2.1b"><cn type="integer" id="A7.p3.2.m2.1.1.cmml" xref="A7.p3.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.2.m2.1c">5</annotation></semantics></math> for the <math id="A7.p3.3.m3.1" class="ltx_Math" alttext="\text{BoK}(\pi_{\mathrm{sft}})" display="inline"><semantics id="A7.p3.3.m3.1a"><mrow id="A7.p3.3.m3.1.1" xref="A7.p3.3.m3.1.1.cmml"><mtext id="A7.p3.3.m3.1.1.3" xref="A7.p3.3.m3.1.1.3a.cmml">BoK</mtext><mo lspace="0em" rspace="0em" id="A7.p3.3.m3.1.1.2" xref="A7.p3.3.m3.1.1.2.cmml">â€‹</mo><mrow id="A7.p3.3.m3.1.1.1.1" xref="A7.p3.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p3.3.m3.1.1.1.1.2" xref="A7.p3.3.m3.1.1.1.1.1.cmml">(</mo><msub id="A7.p3.3.m3.1.1.1.1.1" xref="A7.p3.3.m3.1.1.1.1.1.cmml"><mi id="A7.p3.3.m3.1.1.1.1.1.2" xref="A7.p3.3.m3.1.1.1.1.1.2.cmml">Ï€</mi><mi id="A7.p3.3.m3.1.1.1.1.1.3" xref="A7.p3.3.m3.1.1.1.1.1.3.cmml">sft</mi></msub><mo stretchy="false" id="A7.p3.3.m3.1.1.1.1.3" xref="A7.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.3.m3.1b"><apply id="A7.p3.3.m3.1.1.cmml" xref="A7.p3.3.m3.1.1"><times id="A7.p3.3.m3.1.1.2.cmml" xref="A7.p3.3.m3.1.1.2"></times><ci id="A7.p3.3.m3.1.1.3a.cmml" xref="A7.p3.3.m3.1.1.3"><mtext id="A7.p3.3.m3.1.1.3.cmml" xref="A7.p3.3.m3.1.1.3">BoK</mtext></ci><apply id="A7.p3.3.m3.1.1.1.1.1.cmml" xref="A7.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A7.p3.3.m3.1.1.1.1.1.1.cmml" xref="A7.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="A7.p3.3.m3.1.1.1.1.1.2.cmml" xref="A7.p3.3.m3.1.1.1.1.1.2">ğœ‹</ci><ci id="A7.p3.3.m3.1.1.1.1.1.3.cmml" xref="A7.p3.3.m3.1.1.1.1.1.3">sft</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.3.m3.1c">\text{BoK}(\pi_{\mathrm{sft}})</annotation></semantics></math> policy used to estimate the advantage, and a single rollout from the best-of-K policy is used to estimate the advantage of each step in â€œrejectedâ€ response, where the â€œchosenâ€ and â€œrejectedâ€ pairs for each question are generated from the RFT data, using the method in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
We train per-step DPO with <math id="A7.p3.4.m4.1" class="ltx_Math" alttext="\beta=0.3" display="inline"><semantics id="A7.p3.4.m4.1a"><mrow id="A7.p3.4.m4.1.1" xref="A7.p3.4.m4.1.1.cmml"><mi id="A7.p3.4.m4.1.1.2" xref="A7.p3.4.m4.1.1.2.cmml">Î²</mi><mo id="A7.p3.4.m4.1.1.1" xref="A7.p3.4.m4.1.1.1.cmml">=</mo><mn id="A7.p3.4.m4.1.1.3" xref="A7.p3.4.m4.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.4.m4.1b"><apply id="A7.p3.4.m4.1.1.cmml" xref="A7.p3.4.m4.1.1"><eq id="A7.p3.4.m4.1.1.1.cmml" xref="A7.p3.4.m4.1.1.1"></eq><ci id="A7.p3.4.m4.1.1.2.cmml" xref="A7.p3.4.m4.1.1.2">ğ›½</ci><cn type="float" id="A7.p3.4.m4.1.1.3.cmml" xref="A7.p3.4.m4.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.4.m4.1c">\beta=0.3</annotation></semantics></math> for all <math id="A7.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="A7.p3.5.m5.1a"><msub id="A7.p3.5.m5.1.1" xref="A7.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p3.5.m5.1.1.2" xref="A7.p3.5.m5.1.1.2.cmml">ğ’Ÿ</mi><mi id="A7.p3.5.m5.1.1.3" xref="A7.p3.5.m5.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p3.5.m5.1b"><apply id="A7.p3.5.m5.1.1.cmml" xref="A7.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A7.p3.5.m5.1.1.1.cmml" xref="A7.p3.5.m5.1.1">subscript</csymbol><ci id="A7.p3.5.m5.1.1.2.cmml" xref="A7.p3.5.m5.1.1.2">ğ’Ÿ</ci><ci id="A7.p3.5.m5.1.1.3.cmml" xref="A7.p3.5.m5.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.5.m5.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> from GSM8K, and <math id="A7.p3.6.m6.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A7.p3.6.m6.1a"><mrow id="A7.p3.6.m6.1.1" xref="A7.p3.6.m6.1.1.cmml"><mi id="A7.p3.6.m6.1.1.2" xref="A7.p3.6.m6.1.1.2.cmml">Î²</mi><mo id="A7.p3.6.m6.1.1.1" xref="A7.p3.6.m6.1.1.1.cmml">=</mo><mn id="A7.p3.6.m6.1.1.3" xref="A7.p3.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.6.m6.1b"><apply id="A7.p3.6.m6.1.1.cmml" xref="A7.p3.6.m6.1.1"><eq id="A7.p3.6.m6.1.1.1.cmml" xref="A7.p3.6.m6.1.1.1"></eq><ci id="A7.p3.6.m6.1.1.2.cmml" xref="A7.p3.6.m6.1.1.2">ğ›½</ci><cn type="float" id="A7.p3.6.m6.1.1.3.cmml" xref="A7.p3.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.6.m6.1c">\beta=0.1</annotation></semantics></math> for all <math id="A7.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{syn}}" display="inline"><semantics id="A7.p3.7.m7.1a"><msub id="A7.p3.7.m7.1.1" xref="A7.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p3.7.m7.1.1.2" xref="A7.p3.7.m7.1.1.2.cmml">ğ’Ÿ</mi><mi id="A7.p3.7.m7.1.1.3" xref="A7.p3.7.m7.1.1.3.cmml">syn</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p3.7.m7.1b"><apply id="A7.p3.7.m7.1.1.cmml" xref="A7.p3.7.m7.1.1"><csymbol cd="ambiguous" id="A7.p3.7.m7.1.1.1.cmml" xref="A7.p3.7.m7.1.1">subscript</csymbol><ci id="A7.p3.7.m7.1.1.2.cmml" xref="A7.p3.7.m7.1.1.2">ğ’Ÿ</ci><ci id="A7.p3.7.m7.1.1.3.cmml" xref="A7.p3.7.m7.1.1.3">syn</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.7.m7.1c">\mathcal{D}_{\mathrm{syn}}</annotation></semantics></math> from MATH. We train for three epochs, with a learning rate of <math id="A7.p3.8.m8.1" class="ltx_Math" alttext="1e-6" display="inline"><semantics id="A7.p3.8.m8.1a"><mrow id="A7.p3.8.m8.1.1" xref="A7.p3.8.m8.1.1.cmml"><mrow id="A7.p3.8.m8.1.1.2" xref="A7.p3.8.m8.1.1.2.cmml"><mn id="A7.p3.8.m8.1.1.2.2" xref="A7.p3.8.m8.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A7.p3.8.m8.1.1.2.1" xref="A7.p3.8.m8.1.1.2.1.cmml">â€‹</mo><mi id="A7.p3.8.m8.1.1.2.3" xref="A7.p3.8.m8.1.1.2.3.cmml">e</mi></mrow><mo id="A7.p3.8.m8.1.1.1" xref="A7.p3.8.m8.1.1.1.cmml">âˆ’</mo><mn id="A7.p3.8.m8.1.1.3" xref="A7.p3.8.m8.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.8.m8.1b"><apply id="A7.p3.8.m8.1.1.cmml" xref="A7.p3.8.m8.1.1"><minus id="A7.p3.8.m8.1.1.1.cmml" xref="A7.p3.8.m8.1.1.1"></minus><apply id="A7.p3.8.m8.1.1.2.cmml" xref="A7.p3.8.m8.1.1.2"><times id="A7.p3.8.m8.1.1.2.1.cmml" xref="A7.p3.8.m8.1.1.2.1"></times><cn type="integer" id="A7.p3.8.m8.1.1.2.2.cmml" xref="A7.p3.8.m8.1.1.2.2">1</cn><ci id="A7.p3.8.m8.1.1.2.3.cmml" xref="A7.p3.8.m8.1.1.2.3">ğ‘’</ci></apply><cn type="integer" id="A7.p3.8.m8.1.1.3.cmml" xref="A7.p3.8.m8.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.8.m8.1c">1e-6</annotation></semantics></math> and a batch size of <math id="A7.p3.9.m9.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A7.p3.9.m9.1a"><mn id="A7.p3.9.m9.1.1" xref="A7.p3.9.m9.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A7.p3.9.m9.1b"><cn type="integer" id="A7.p3.9.m9.1.1.cmml" xref="A7.p3.9.m9.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.9.m9.1c">64</annotation></semantics></math> prompts. We use the rmsprop optimizer and a cosine learning rate decay with a warmpup ratio of 0.1.</p>
</div>
<div id="A7.p4" class="ltx_para ltx_noindent">
<p id="A7.p4.1" class="ltx_p">Overall, to replicate our experiments, we need approximately 1000 hours of compute on H100 clusters with 8 GPUs.</p>
</div>
<div id="A7.p5" class="ltx_para ltx_noindent">
<svg id="A7.p5.pic1" class="ltx_picture" height="275.17" overflow="visible" version="1.1" width="600"><g transform="translate(0,275.17) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 269.26 C 0 272.52 2.64 275.17 5.91 275.17 L 594.09 275.17 C 597.36 275.17 600 272.52 600 269.26 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 251.06 L 598.03 251.06 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 256.96)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A7.p5.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A7.p5.pic1.1.1.1.1.1.1" class="ltx_p">RFT data with spurious steps highlighted</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="225.47" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A7.p5.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A7.p5.pic1.2.2.2.1.1.1" class="ltx_p"><span id="A7.p5.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold">Prompt:</span></span>
<span id="A7.p5.pic1.2.2.2.1.1.2" class="ltx_p">Karenâ€™s work tote bag is twice the weight of her husband Kevinâ€™s briefcase when the briefcase is empty. When Kevin puts his laptop and work papers in his briefcase, it is twice the weight of Karenâ€™s tote. Kevinâ€™s work papers are a sixth of the weight of the contents of his full briefcase. If Karenâ€™s tote weighs 8 pounds, how many more pounds does Kevinâ€™s laptop weigh than Karenâ€™s tote?</span>
<span id="A7.p5.pic1.2.2.2.1.1.3" class="ltx_p"><span id="A7.p5.pic1.2.2.2.1.1.3.1" class="ltx_text ltx_font_bold">Response:</span></span>
<span id="A7.p5.pic1.2.2.2.1.1.4" class="ltx_p">If Karenâ€™s tote weighs 8 pounds, and it is twice the weight of Kevinâ€™s empty briefcase, then Kevinâ€™s empty briefcase weighs 8/2 = &lt;&lt;8/2=4&gt;&gt;4 pounds.  In words, â€œKarenâ€™s tote weighs 8 poundsâ€ is â€œT = 8â€, so thus Keven is 2 pounds. When Kevin puts his laptop and work papers in his briefcase, it is twice the weight of Karenâ€™s tote at 8 pounds, so the briefcase now weighs 8+4 = &lt;&lt;8+4=12&gt;&gt;12 pounds. Kevinâ€™s work papers are a sixth of the weight of the contents of his full briefcase, which weighs 12 pounds, so the work papers weigh 12/6 = &lt;&lt;12/6=2&gt;&gt;2 pounds. If Kevinâ€™s laptop and work papers weigh 12 pounds in total, and the work papers weigh 2 pounds, then the laptop weighs 12-2 = &lt;&lt;12-2=10&gt;&gt;10 pounds. Thus, Kevinâ€™s laptop is 10-8 = &lt;&lt;10-8=2&gt;&gt;2 pounds heavier than Karenâ€™s tote. The answer is 2.</span>
</span></foreignObject></g></g></svg>
</div>
<div id="A7.p6" class="ltx_para ltx_noindent">
<svg id="A7.p6.pic1" class="ltx_picture" height="243.11" overflow="visible" version="1.1" width="600"><g transform="translate(0,243.11) matrix(1 0 0 -1 0 0)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g fill="#0000BF" fill-opacity="1.0"><path d="M 0 5.91 L 0 237.21 C 0 240.47 2.64 243.11 5.91 243.11 L 594.09 243.11 C 597.36 243.11 600 240.47 600 237.21 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2FF" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 219 L 598.03 219 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 224.91)"><foreignObject width="556.69" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#FFFFFF">
<span id="A7.p6.pic1.1.1.1.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A7.p6.pic1.1.1.1.1.1.1" class="ltx_p">RFT data with spurious steps highlighted</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject width="556.69" height="193.41" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible" color="#000000">
<span id="A7.p6.pic1.2.2.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_bottom" style="width:402.3pt;">
<span id="A7.p6.pic1.2.2.2.1.1.1" class="ltx_p"><span id="A7.p6.pic1.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold">Prompt:</span></span>
<span id="A7.p6.pic1.2.2.2.1.1.2" class="ltx_p">Carl has a jar full of marbles. He takes out 12 marbles to play a game with, but he accidentally drops them and 1/2 the marbles get lost. So Carl takes out 10 more marbles. While he is playing his game his mother comes home with another bag of marbles for him, which has 25 marbles in it. If Carl canâ€™t find his lost marbles, then how many marbles is he going to put in the jar after he plays his game, from both his original marbles and the new ones?</span>
<span id="A7.p6.pic1.2.2.2.1.1.3" class="ltx_p"><span id="A7.p6.pic1.2.2.2.1.1.3.1" class="ltx_text ltx_font_bold">Response:</span></span>
<span id="A7.p6.pic1.2.2.2.1.1.4" class="ltx_p">First find out how many marbles Carl loses: 12 marbles * 1/2 = &lt;&lt;12*1/2=6&gt;&gt;6 marbles Then add that number to the number of marbles Carl takes out of the jar to play his game to find out how many total marbles he takes out: 6 marbles + 10 marbles = &lt;&lt;6+10=16&gt;&gt;16 marble.  Now add that number to the number of marbles in the jar to find out how many marbles are left: 16 marbles + 12 marbles = &lt;&lt;16+12=28&gt;&gt;28 marbles.
Then add in the marbles Carl gets from his mother to find out how many marbles he has in total: 16 marbles + 25 marbles = &lt;&lt;16+25=41&gt;&gt;41 marbles. The answer is 41.</span>
</span></foreignObject></g></g></svg>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.14531" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.14532" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.14532">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.14532" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.14533" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 22:16:23 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
