<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2111.07462] Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting</title><meta property="og:description" content="Electrical load prediction has become an integral part of power system operation. Deep learning models have found popularity for this purpose. However, to achieve a desired prediction accuracy, they require huge amount…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2111.07462">

<!--Generated on Tue Mar 19 16:23:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nastaran Gholizadeh
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Petr Musilek
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_address">Electrical and Computer Engineering, University of Alberta, Edmonton, Alberta, Canada
</span>
<span class="ltx_contact ltx_role_address">Applied Cybernetics, University of Hradec Králové, Hradec Králové, Czech Republic
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Electrical load prediction has become an integral part of power system operation. Deep learning models have found popularity for this purpose. However, to achieve a desired prediction accuracy, they require huge amounts of data for training. Sharing electricity consumption data of individual households for load prediction may compromise user privacy and can be expensive in terms of communication resources. Therefore, edge computing methods, such as federated learning, are gaining more importance for this purpose. These methods can take advantage of the data without centrally storing it. This paper evaluates the performance of federated learning for short-term forecasting of individual house loads as well as the aggregate load. It discusses the advantages and disadvantages of this method by comparing it to centralized and local learning schemes. Moreover, a new client clustering method is proposed to reduce the convergence time of federated learning. The results show that federated learning has a good performance with a minimum root mean squared error (RMSE) of 0.117kWh for individual load forecasting.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Federated learning, electricity load forecasting, edge computing, LSTM, decentralized learning

</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Journal of <span id="id1.1" class="ltx_text ltx_LaTeX_logo" style="letter-spacing:-0.2em; margin-right:0.1em;">L<span id="id1.1.1" class="ltx_text" style="position:relative; bottom:0.4ex;font-variant:small-caps;;">a</span>T<span id="id1.1.2" class="ltx_text" style="position:relative; bottom:-0.2ex;font-variant:small-caps;font-size:120%;">e</span>X</span> Templates</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Internet of Things</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Short-term load forecasting is a fundamental part of resource scheduling task in power systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Some recent studies focus on short-term load forecasting of individual buildings for decentralized monitoring and control of power systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. This has become important due to the distributed placement of intermittent renewable energy resources. However, load forecasting of individual households is a challenging task since the house load profile is highly dependent on the stochastic behavior of its residents <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Many algorithms have been proposed for short-term load forecasting in literature. They include Auto Regressive Integrated Moving Average (ARIMA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> model, Markov-chain Mixture (MCM) distribution model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, Quantile Regression (QR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> method, Support Vector Regression (SVR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and deep learning models. Especially, certain deep learning models, such as Long Short Term Memory (LSTM) networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, hybrid Convolutional Neural Network (CNN) and LSTM networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, and some other types of hybrid recurrent neural networks and CNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, have shown good performance for short-term load forecasting. These methods require high volumes of historical data for training and they store the data centrally. Transferring and centrally storing the historical energy consumption data of individual buildings is expensive in terms of communication resources and it can compromise electricity user’s privacy. Moreover, with the proliferation of advanced metering infrastructure such as smart meters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, it is infeasible to centrally store and manage the massive amounts of data produced by these devices. Edge computing and distributed learning methods are promising solutions to overcome these issues by eliminating the need for central data storage and processing. These methods also reduce the computational burden of training deep learning models by dividing the processing task among multiple edge devices.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated learning, introduced by Google in 2017 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, is a type of distributed machine learning mechanism that allows training a global model by cooperation of edge devices and without sharing the training data. In this method, the training is performed by the edge devices and the resultant weights are shared with the central server to perform weight updates. The updated weights are then sent back to the edge devices for another round of training. This iteration continues until model accuracy is high enough <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Since no raw data is exchanged between the edge devices and each edge device carries out a part of the training task, federated learning preserves data privacy and has higher scalability compared to centralized learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Due to the numerous benefits it offers, federated learning is quickly expanding to various research areas such as healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, communications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, language modeling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, transportation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and many others . A few studies have also used federated learning for short-term electrical load forecasting. To this end, Savi and Olivadese <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> developed a federated LSTM model to forecast electrcity demand of individual houses and compared it to the centralized model. To enhance the forecasting accuracy, customers were clustered based on socioeconomic affinities and consumption similarities such as average, total, and lowest energy consumption. However, these indices may not properly reflect the consumption patterns of consumers. Therefore, clustering might not enhance the model performance. Taïk and Cherkaoui <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> used federated LSTM for the same purpose but without customer clustering. The results showed that the performance of federated learning for load forecasting was not good even after a few rounds of personalization. Personalization is the process of taking the global model and running a few local training rounds on it to increase prediction accuracy. Tun et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> used bidirectional LSTM with OPTICS clustering method to group consumers based on house type, region, facing direction, number of rental units, and heating type. However, these attributes cannot reflect consumer behavior and load shape properly as they remain constant even if the residents of a dwelling change. Horizontal and vertical federated learning were applied by Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> for power consumption prediction without customer clustering. The main goal was to demonstrate how much federated learning can preserve privacy.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Although there have been a few studies published in the area of federated learning for energy forecasting, its performance for forecasting of individual buildings’ energy consumption and aggregate demands has not been thoroughly studied yet. This paper assesses the performance of federated learning for predicting both individual house electrical loads as well as aggregate electricity demand by comparing them to centralized and local forecasting schemes. Moreover, a new customer clustering method is introduced which does not require sharing any confidential customer data. The main contributions of this paper are as follows:</p>
</div>
<div id="S1.p6" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Conducting a thorough study of federated learning performance compared to centralized and local forecasting for predicting single and aggregate electrical demands;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Proposing a new consumer clustering technique that better reflects consumer consumption pattern and does not require sharing confidential consumer data;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Implementing an algorithm into the federated learning that detects and removes consumers that deter the global model.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The remainder of this paper is organized as follows. Section <a href="#S2" title="2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> describes the federated learning framework used in this study. Simulation setup, used data, and results are presented in Section <a href="#S3" title="3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Finally, the concluding remarks are drawn in Section <a href="#S4" title="4 Conclusion ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>System Model</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">This section describes the system model for applying federated learning and edge computing to forecast the the electrical demand of single houses as well as the aggregate demands.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning Model</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.8" class="ltx_p">The architecture of the system used in this study is illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Federated Learning Model ‣ 2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The system is divided into two subsystems: central server (cloud) and clients (individual houses). Each client contains a smart meter device that measures the electricity consumption and communicates with the central server. Direct smart meter to cloud communication is feasible using the current technology <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. In addition, it is assumed that these smart meters contain processing units to train simple neural networks using the historical energy consumption data stored within them. In federated learning, the central server sends the initial weight values to clients to start the training. After one or more steps of training by each client, the obtained weights are sent back to the central server to perform wight update after aggregating weights from all clients. The central server uses FedAvg for this purpose. FedAvg method basically performs a weighted averaging on the weights obtained from all clients. This can be shown as</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\mathbb{w}_{k+1}=\sum_{c=1}^{C}\frac{n_{c}}{n}\nabla\mathbb{w}_{c}," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml">𝕨</mi><mrow id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.1.1.1.1.2.3.1" xref="S2.E1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.E1.m1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><munderover id="S2.E1.m1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.1.1.1.1.3.1.2.2" xref="S2.E1.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.1.1.1.1.3.1.2.3" xref="S2.E1.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.1.2.3.2" xref="S2.E1.m1.1.1.1.1.3.1.2.3.2.cmml">c</mi><mo id="S2.E1.m1.1.1.1.1.3.1.2.3.1" xref="S2.E1.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.1.1.1.1.3.1.2.3.3" xref="S2.E1.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.1.1.1.1.3.1.3" xref="S2.E1.m1.1.1.1.1.3.1.3.cmml">C</mi></munderover><mrow id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml"><mfrac id="S2.E1.m1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.cmml"><msub id="S2.E1.m1.1.1.1.1.3.2.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.2.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S2.E1.m1.1.1.1.1.3.2.2.2.3" xref="S2.E1.m1.1.1.1.1.3.2.2.2.3.cmml">c</mi></msub><mi id="S2.E1.m1.1.1.1.1.3.2.2.3" xref="S2.E1.m1.1.1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0.167em" rspace="0em" id="S2.E1.m1.1.1.1.1.3.2.1" xref="S2.E1.m1.1.1.1.1.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.cmml"><mo rspace="0.167em" id="S2.E1.m1.1.1.1.1.3.2.3.1" xref="S2.E1.m1.1.1.1.1.3.2.3.1.cmml">∇</mo><msub id="S2.E1.m1.1.1.1.1.3.2.3.2" xref="S2.E1.m1.1.1.1.1.3.2.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.3.2.2.cmml">𝕨</mi><mi id="S2.E1.m1.1.1.1.1.3.2.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.2.3.cmml">c</mi></msub></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"></eq><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2">𝕨</ci><apply id="S2.E1.m1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3"><plus id="S2.E1.m1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1"></plus><ci id="S2.E1.m1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><apply id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.3.1.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3"><eq id="S2.E1.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.E1.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.2">𝑐</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.1.1.1.1.3.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.3">𝐶</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2"><times id="S2.E1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.1"></times><apply id="S2.E1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2"><divide id="S2.E1.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2"></divide><apply id="S2.E1.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S2.E1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.2.3">𝑐</ci></apply><ci id="S2.E1.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3"><ci id="S2.E1.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.1">∇</ci><apply id="S2.E1.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.2.2">𝕨</ci><ci id="S2.E1.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.2.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathbb{w}_{k+1}=\sum_{c=1}^{C}\frac{n_{c}}{n}\nabla\mathbb{w}_{c},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.7" class="ltx_p">where <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbb{w}_{k+1}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝕨</mi><mrow id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">k</mi><mo id="S2.SS1.p1.1.m1.1.1.3.1" xref="S2.SS1.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝕨</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><plus id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.1"></plus><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">𝑘</ci><cn type="integer" id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbb{w}_{k+1}</annotation></semantics></math> is the updated weights sent by the central server in the <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="(k+1)" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.2.cmml">k</mi><mo id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p1.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"><plus id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1"></plus><ci id="S2.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2">𝑘</ci><cn type="integer" id="S2.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">(k+1)</annotation></semantics></math>th round of communication and <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbb{w}_{c}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">𝕨</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝕨</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathbb{w}_{c}</annotation></semantics></math> is the weights sent by the client <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">c</annotation></semantics></math> to the central server. Parameter <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">n</annotation></semantics></math> is the total number of data points used for training the global model and <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">n</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑛</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">n_{c}</annotation></semantics></math> is the total number of data points used by client <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">c</annotation></semantics></math> for training.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2111.07462/assets/FLnew.png" id="S2.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="345" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Federated learning scheme</figcaption>
</figure>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">The central server sends the updated weights back to the clients for another round of training and this iteration between clients and the central server continues until desired training accuracy is achieved. As can be understood from this process, FedAvg attempts to fit a general model to the clients’ data and each client contributes to the global model based on the amount of data it used for training. The process of federated learning is shown in Algorithm <a href="#algorithm1" title="In 2.1 Federated Learning Model ‣ 2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> in more details.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.12" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.12.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.13.1.1.1" class="ltx_text" style="font-size:80%;">1</span></span>
<span id="algorithm1.12.13.2" class="ltx_text ltx_font_bold" style="font-size:80%;">Input:<span id="algorithm1.12.13.2.1" class="ltx_text ltx_font_medium">   Hyperparameter data of clients </span></span>
</div>
<div id="algorithm1.12.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.14.1.1.1" class="ltx_text" style="font-size:80%;">2</span></span><span id="algorithm1.12.14.2" class="ltx_text" style="font-size:80%;"><span id="algorithm1.12.14.2.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="algorithm1.12.14.3" class="ltx_text" style="font-size:80%;">Cluster-specific trained models</span>
</div>
<div id="algorithm1.12.15" class="ltx_listingline">
<span id="algorithm1.12.15.1" class="ltx_text" style="font-size:80%;"> </span>
</div>
<div id="algorithm1.1.1" class="ltx_listingline">
<math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mo mathsize="80%" id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\triangleright</annotation></semantics></math><span id="algorithm1.1.1.1" class="ltx_text" style="font-size:80%;">  Initialization </span>
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.3.3.3.1.1" class="ltx_text" style="font-size:80%;">3</span></span><span id="algorithm1.3.3.4" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="algorithm1.3.3.5" class="ltx_text" style="font-size:80%;"> </span><em id="algorithm1.3.3.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">each cluster <math id="algorithm1.2.2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.2.2.1.m1.1a"><mi id="algorithm1.2.2.1.m1.1.1" xref="algorithm1.2.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.1.m1.1b"><ci id="algorithm1.2.2.1.m1.1.1.cmml" xref="algorithm1.2.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.1.m1.1c">k</annotation></semantics></math> with <math id="algorithm1.3.3.2.m2.4" class="ltx_Math" alttext="k=1,2,...,N" display="inline"><semantics id="algorithm1.3.3.2.m2.4a"><mrow id="algorithm1.3.3.2.m2.4.5" xref="algorithm1.3.3.2.m2.4.5.cmml"><mi id="algorithm1.3.3.2.m2.4.5.2" xref="algorithm1.3.3.2.m2.4.5.2.cmml">k</mi><mo id="algorithm1.3.3.2.m2.4.5.1" xref="algorithm1.3.3.2.m2.4.5.1.cmml">=</mo><mrow id="algorithm1.3.3.2.m2.4.5.3.2" xref="algorithm1.3.3.2.m2.4.5.3.1.cmml"><mn id="algorithm1.3.3.2.m2.1.1" xref="algorithm1.3.3.2.m2.1.1.cmml">1</mn><mo id="algorithm1.3.3.2.m2.4.5.3.2.1" xref="algorithm1.3.3.2.m2.4.5.3.1.cmml">,</mo><mn id="algorithm1.3.3.2.m2.2.2" xref="algorithm1.3.3.2.m2.2.2.cmml">2</mn><mo id="algorithm1.3.3.2.m2.4.5.3.2.2" xref="algorithm1.3.3.2.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.3.3.2.m2.3.3" xref="algorithm1.3.3.2.m2.3.3.cmml">…</mi><mo id="algorithm1.3.3.2.m2.4.5.3.2.3" xref="algorithm1.3.3.2.m2.4.5.3.1.cmml">,</mo><mi id="algorithm1.3.3.2.m2.4.4" xref="algorithm1.3.3.2.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.2.m2.4b"><apply id="algorithm1.3.3.2.m2.4.5.cmml" xref="algorithm1.3.3.2.m2.4.5"><eq id="algorithm1.3.3.2.m2.4.5.1.cmml" xref="algorithm1.3.3.2.m2.4.5.1"></eq><ci id="algorithm1.3.3.2.m2.4.5.2.cmml" xref="algorithm1.3.3.2.m2.4.5.2">𝑘</ci><list id="algorithm1.3.3.2.m2.4.5.3.1.cmml" xref="algorithm1.3.3.2.m2.4.5.3.2"><cn type="integer" id="algorithm1.3.3.2.m2.1.1.cmml" xref="algorithm1.3.3.2.m2.1.1">1</cn><cn type="integer" id="algorithm1.3.3.2.m2.2.2.cmml" xref="algorithm1.3.3.2.m2.2.2">2</cn><ci id="algorithm1.3.3.2.m2.3.3.cmml" xref="algorithm1.3.3.2.m2.3.3">…</ci><ci id="algorithm1.3.3.2.m2.4.4.cmml" xref="algorithm1.3.3.2.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.2.m2.4c">k=1,2,...,N</annotation></semantics></math> <span id="algorithm1.3.3.2.1" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em><span id="algorithm1.3.3.6" class="ltx_text" style="font-size:80%;"> </span><span id="algorithm1.3.3.7" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span>
</div>
<div id="algorithm1.4.4" class="ltx_listingline">
<span id="algorithm1.4.4.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.4.4.2" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.4.4.3.1.1" class="ltx_text" style="font-size:80%;">4</span></span><span id="algorithm1.4.4.4" class="ltx_text" style="font-size:80%;">
</span><span id="algorithm1.4.4.5" class="ltx_text" style="font-size:80%;">Initialize weights </span><math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="w_{c}" display="inline"><semantics id="algorithm1.4.4.m1.1a"><msub id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><mi mathsize="80%" id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml">w</mi><mi mathsize="80%" id="algorithm1.4.4.m1.1.1.3" xref="algorithm1.4.4.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1">subscript</csymbol><ci id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2">𝑤</ci><ci id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">w_{c}</annotation></semantics></math><span id="algorithm1.4.4.6" class="ltx_text" style="font-size:80%;"> </span>
</div>
<div id="algorithm1.12.16" class="ltx_listingline">
<span id="algorithm1.12.16.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.16.2" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.16.3.1.1" class="ltx_text" style="font-size:80%;">5</span></span><span id="algorithm1.12.16.4" class="ltx_text" style="font-size:80%;">Update local models of clients using these weights </span>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span id="algorithm1.5.5.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.5.5.2" class="ltx_text" style="font-size:80%;">   </span><math id="algorithm1.5.5.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.5.5.m1.1a"><mo mathsize="80%" id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><ci id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">\triangleright</annotation></semantics></math><span id="algorithm1.5.5.3" class="ltx_text" style="font-size:80%;">  Communication loop </span>
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span id="algorithm1.6.6.2" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.6.6.3" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.6.6.4.1.1" class="ltx_text" style="font-size:80%;">6</span></span><span id="algorithm1.6.6.5" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="algorithm1.6.6.6" class="ltx_text" style="font-size:80%;"> </span><em id="algorithm1.6.6.1" class="ltx_emph ltx_font_italic" style="font-size:80%;">Communication round <math id="algorithm1.6.6.1.m1.4" class="ltx_Math" alttext="t=1,2,...,T" display="inline"><semantics id="algorithm1.6.6.1.m1.4a"><mrow id="algorithm1.6.6.1.m1.4.5" xref="algorithm1.6.6.1.m1.4.5.cmml"><mi id="algorithm1.6.6.1.m1.4.5.2" xref="algorithm1.6.6.1.m1.4.5.2.cmml">t</mi><mo id="algorithm1.6.6.1.m1.4.5.1" xref="algorithm1.6.6.1.m1.4.5.1.cmml">=</mo><mrow id="algorithm1.6.6.1.m1.4.5.3.2" xref="algorithm1.6.6.1.m1.4.5.3.1.cmml"><mn id="algorithm1.6.6.1.m1.1.1" xref="algorithm1.6.6.1.m1.1.1.cmml">1</mn><mo id="algorithm1.6.6.1.m1.4.5.3.2.1" xref="algorithm1.6.6.1.m1.4.5.3.1.cmml">,</mo><mn id="algorithm1.6.6.1.m1.2.2" xref="algorithm1.6.6.1.m1.2.2.cmml">2</mn><mo id="algorithm1.6.6.1.m1.4.5.3.2.2" xref="algorithm1.6.6.1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.6.6.1.m1.3.3" xref="algorithm1.6.6.1.m1.3.3.cmml">…</mi><mo id="algorithm1.6.6.1.m1.4.5.3.2.3" xref="algorithm1.6.6.1.m1.4.5.3.1.cmml">,</mo><mi id="algorithm1.6.6.1.m1.4.4" xref="algorithm1.6.6.1.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.1.m1.4b"><apply id="algorithm1.6.6.1.m1.4.5.cmml" xref="algorithm1.6.6.1.m1.4.5"><eq id="algorithm1.6.6.1.m1.4.5.1.cmml" xref="algorithm1.6.6.1.m1.4.5.1"></eq><ci id="algorithm1.6.6.1.m1.4.5.2.cmml" xref="algorithm1.6.6.1.m1.4.5.2">𝑡</ci><list id="algorithm1.6.6.1.m1.4.5.3.1.cmml" xref="algorithm1.6.6.1.m1.4.5.3.2"><cn type="integer" id="algorithm1.6.6.1.m1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1">1</cn><cn type="integer" id="algorithm1.6.6.1.m1.2.2.cmml" xref="algorithm1.6.6.1.m1.2.2">2</cn><ci id="algorithm1.6.6.1.m1.3.3.cmml" xref="algorithm1.6.6.1.m1.3.3">…</ci><ci id="algorithm1.6.6.1.m1.4.4.cmml" xref="algorithm1.6.6.1.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.1.m1.4c">t=1,2,...,T</annotation></semantics></math></em><span id="algorithm1.6.6.7" class="ltx_text" style="font-size:80%;"> </span><span id="algorithm1.6.6.8" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span>
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span id="algorithm1.8.8.3" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.8.8.4" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.8.8.5" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.8.8.6.1.1" class="ltx_text" style="font-size:80%;">7</span></span><span id="algorithm1.8.8.7" class="ltx_text" style="font-size:80%;">
</span><span id="algorithm1.8.8.8" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="algorithm1.8.8.9" class="ltx_text" style="font-size:80%;"> </span><em id="algorithm1.8.8.2" class="ltx_emph ltx_font_italic" style="font-size:80%;">each client <math id="algorithm1.7.7.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.7.7.1.m1.1a"><mi id="algorithm1.7.7.1.m1.1.1" xref="algorithm1.7.7.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.m1.1b"><ci id="algorithm1.7.7.1.m1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.m1.1c">c</annotation></semantics></math> with <math id="algorithm1.8.8.2.m2.4" class="ltx_Math" alttext="c=1,2,...,C" display="inline"><semantics id="algorithm1.8.8.2.m2.4a"><mrow id="algorithm1.8.8.2.m2.4.5" xref="algorithm1.8.8.2.m2.4.5.cmml"><mi id="algorithm1.8.8.2.m2.4.5.2" xref="algorithm1.8.8.2.m2.4.5.2.cmml">c</mi><mo id="algorithm1.8.8.2.m2.4.5.1" xref="algorithm1.8.8.2.m2.4.5.1.cmml">=</mo><mrow id="algorithm1.8.8.2.m2.4.5.3.2" xref="algorithm1.8.8.2.m2.4.5.3.1.cmml"><mn id="algorithm1.8.8.2.m2.1.1" xref="algorithm1.8.8.2.m2.1.1.cmml">1</mn><mo id="algorithm1.8.8.2.m2.4.5.3.2.1" xref="algorithm1.8.8.2.m2.4.5.3.1.cmml">,</mo><mn id="algorithm1.8.8.2.m2.2.2" xref="algorithm1.8.8.2.m2.2.2.cmml">2</mn><mo id="algorithm1.8.8.2.m2.4.5.3.2.2" xref="algorithm1.8.8.2.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.8.8.2.m2.3.3" xref="algorithm1.8.8.2.m2.3.3.cmml">…</mi><mo id="algorithm1.8.8.2.m2.4.5.3.2.3" xref="algorithm1.8.8.2.m2.4.5.3.1.cmml">,</mo><mi id="algorithm1.8.8.2.m2.4.4" xref="algorithm1.8.8.2.m2.4.4.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.2.m2.4b"><apply id="algorithm1.8.8.2.m2.4.5.cmml" xref="algorithm1.8.8.2.m2.4.5"><eq id="algorithm1.8.8.2.m2.4.5.1.cmml" xref="algorithm1.8.8.2.m2.4.5.1"></eq><ci id="algorithm1.8.8.2.m2.4.5.2.cmml" xref="algorithm1.8.8.2.m2.4.5.2">𝑐</ci><list id="algorithm1.8.8.2.m2.4.5.3.1.cmml" xref="algorithm1.8.8.2.m2.4.5.3.2"><cn type="integer" id="algorithm1.8.8.2.m2.1.1.cmml" xref="algorithm1.8.8.2.m2.1.1">1</cn><cn type="integer" id="algorithm1.8.8.2.m2.2.2.cmml" xref="algorithm1.8.8.2.m2.2.2">2</cn><ci id="algorithm1.8.8.2.m2.3.3.cmml" xref="algorithm1.8.8.2.m2.3.3">…</ci><ci id="algorithm1.8.8.2.m2.4.4.cmml" xref="algorithm1.8.8.2.m2.4.4">𝐶</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.2.m2.4c">c=1,2,...,C</annotation></semantics></math> <span id="algorithm1.8.8.2.1" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em><span id="algorithm1.8.8.10" class="ltx_text" style="font-size:80%;"> </span><span id="algorithm1.8.8.11" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span>
</div>
<div id="algorithm1.12.17" class="ltx_listingline">
<span id="algorithm1.12.17.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.17.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.17.3" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.17.4" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.17.5.1.1" class="ltx_text" style="font-size:80%;">8</span></span><span id="algorithm1.12.17.6" class="ltx_text" style="font-size:80%;">
</span><span id="algorithm1.12.17.7" class="ltx_text" style="font-size:80%;">Train and update the local model using local data </span>
</div>
<div id="algorithm1.12.18" class="ltx_listingline">
<span id="algorithm1.12.18.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.18.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.18.3" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.18.4" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.18.5.1.1" class="ltx_text" style="font-size:80%;">9</span></span><span id="algorithm1.12.18.6" class="ltx_text" style="font-size:80%;">Send updated weights to the central server</span>
</div>
<div id="algorithm1.12.19" class="ltx_listingline">
<span id="algorithm1.12.19.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.19.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.19.3" class="ltx_text" style="font-size:80%;">   </span>
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.9.9.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.9.9.3" class="ltx_text" style="font-size:80%;">   </span><math id="algorithm1.9.9.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.9.9.m1.1a"><mo mathsize="80%" id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><ci id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">\triangleright</annotation></semantics></math><span id="algorithm1.9.9.4" class="ltx_text" style="font-size:80%;">  Detecting and removing clients that deter the model </span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span id="algorithm1.10.10.2" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.10.10.3" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.10.10.4" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.10.10.5.1.1" class="ltx_text" style="font-size:80%;">10</span></span><span id="algorithm1.10.10.6" class="ltx_text ltx_font_bold" style="font-size:80%;">if</span><span id="algorithm1.10.10.7" class="ltx_text" style="font-size:80%;"> </span><em id="algorithm1.10.10.1" class="ltx_emph ltx_font_italic" style="font-size:80%;"><math id="algorithm1.10.10.1.m1.4" class="ltx_Math" alttext="loss_{c,T}&gt;1.6\times loss_{c,T-20}" display="inline"><semantics id="algorithm1.10.10.1.m1.4a"><mrow id="algorithm1.10.10.1.m1.4.5" xref="algorithm1.10.10.1.m1.4.5.cmml"><mrow id="algorithm1.10.10.1.m1.4.5.2" xref="algorithm1.10.10.1.m1.4.5.2.cmml"><mi id="algorithm1.10.10.1.m1.4.5.2.2" xref="algorithm1.10.10.1.m1.4.5.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.2.1" xref="algorithm1.10.10.1.m1.4.5.2.1.cmml">​</mo><mi id="algorithm1.10.10.1.m1.4.5.2.3" xref="algorithm1.10.10.1.m1.4.5.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.2.1a" xref="algorithm1.10.10.1.m1.4.5.2.1.cmml">​</mo><mi id="algorithm1.10.10.1.m1.4.5.2.4" xref="algorithm1.10.10.1.m1.4.5.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.2.1b" xref="algorithm1.10.10.1.m1.4.5.2.1.cmml">​</mo><msub id="algorithm1.10.10.1.m1.4.5.2.5" xref="algorithm1.10.10.1.m1.4.5.2.5.cmml"><mi id="algorithm1.10.10.1.m1.4.5.2.5.2" xref="algorithm1.10.10.1.m1.4.5.2.5.2.cmml">s</mi><mrow id="algorithm1.10.10.1.m1.2.2.2.4" xref="algorithm1.10.10.1.m1.2.2.2.3.cmml"><mi id="algorithm1.10.10.1.m1.1.1.1.1" xref="algorithm1.10.10.1.m1.1.1.1.1.cmml">c</mi><mo id="algorithm1.10.10.1.m1.2.2.2.4.1" xref="algorithm1.10.10.1.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.10.10.1.m1.2.2.2.2" xref="algorithm1.10.10.1.m1.2.2.2.2.cmml">T</mi></mrow></msub></mrow><mo id="algorithm1.10.10.1.m1.4.5.1" xref="algorithm1.10.10.1.m1.4.5.1.cmml">&gt;</mo><mrow id="algorithm1.10.10.1.m1.4.5.3" xref="algorithm1.10.10.1.m1.4.5.3.cmml"><mrow id="algorithm1.10.10.1.m1.4.5.3.2" xref="algorithm1.10.10.1.m1.4.5.3.2.cmml"><mn id="algorithm1.10.10.1.m1.4.5.3.2.2" xref="algorithm1.10.10.1.m1.4.5.3.2.2.cmml">1.6</mn><mo lspace="0.222em" rspace="0.222em" id="algorithm1.10.10.1.m1.4.5.3.2.1" xref="algorithm1.10.10.1.m1.4.5.3.2.1.cmml">×</mo><mi id="algorithm1.10.10.1.m1.4.5.3.2.3" xref="algorithm1.10.10.1.m1.4.5.3.2.3.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.3.1" xref="algorithm1.10.10.1.m1.4.5.3.1.cmml">​</mo><mi id="algorithm1.10.10.1.m1.4.5.3.3" xref="algorithm1.10.10.1.m1.4.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.3.1a" xref="algorithm1.10.10.1.m1.4.5.3.1.cmml">​</mo><mi id="algorithm1.10.10.1.m1.4.5.3.4" xref="algorithm1.10.10.1.m1.4.5.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.1.m1.4.5.3.1b" xref="algorithm1.10.10.1.m1.4.5.3.1.cmml">​</mo><msub id="algorithm1.10.10.1.m1.4.5.3.5" xref="algorithm1.10.10.1.m1.4.5.3.5.cmml"><mi id="algorithm1.10.10.1.m1.4.5.3.5.2" xref="algorithm1.10.10.1.m1.4.5.3.5.2.cmml">s</mi><mrow id="algorithm1.10.10.1.m1.4.4.2.2" xref="algorithm1.10.10.1.m1.4.4.2.3.cmml"><mi id="algorithm1.10.10.1.m1.3.3.1.1" xref="algorithm1.10.10.1.m1.3.3.1.1.cmml">c</mi><mo id="algorithm1.10.10.1.m1.4.4.2.2.2" xref="algorithm1.10.10.1.m1.4.4.2.3.cmml">,</mo><mrow id="algorithm1.10.10.1.m1.4.4.2.2.1" xref="algorithm1.10.10.1.m1.4.4.2.2.1.cmml"><mi id="algorithm1.10.10.1.m1.4.4.2.2.1.2" xref="algorithm1.10.10.1.m1.4.4.2.2.1.2.cmml">T</mi><mo id="algorithm1.10.10.1.m1.4.4.2.2.1.1" xref="algorithm1.10.10.1.m1.4.4.2.2.1.1.cmml">−</mo><mn id="algorithm1.10.10.1.m1.4.4.2.2.1.3" xref="algorithm1.10.10.1.m1.4.4.2.2.1.3.cmml">20</mn></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.4b"><apply id="algorithm1.10.10.1.m1.4.5.cmml" xref="algorithm1.10.10.1.m1.4.5"><gt id="algorithm1.10.10.1.m1.4.5.1.cmml" xref="algorithm1.10.10.1.m1.4.5.1"></gt><apply id="algorithm1.10.10.1.m1.4.5.2.cmml" xref="algorithm1.10.10.1.m1.4.5.2"><times id="algorithm1.10.10.1.m1.4.5.2.1.cmml" xref="algorithm1.10.10.1.m1.4.5.2.1"></times><ci id="algorithm1.10.10.1.m1.4.5.2.2.cmml" xref="algorithm1.10.10.1.m1.4.5.2.2">𝑙</ci><ci id="algorithm1.10.10.1.m1.4.5.2.3.cmml" xref="algorithm1.10.10.1.m1.4.5.2.3">𝑜</ci><ci id="algorithm1.10.10.1.m1.4.5.2.4.cmml" xref="algorithm1.10.10.1.m1.4.5.2.4">𝑠</ci><apply id="algorithm1.10.10.1.m1.4.5.2.5.cmml" xref="algorithm1.10.10.1.m1.4.5.2.5"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.4.5.2.5.1.cmml" xref="algorithm1.10.10.1.m1.4.5.2.5">subscript</csymbol><ci id="algorithm1.10.10.1.m1.4.5.2.5.2.cmml" xref="algorithm1.10.10.1.m1.4.5.2.5.2">𝑠</ci><list id="algorithm1.10.10.1.m1.2.2.2.3.cmml" xref="algorithm1.10.10.1.m1.2.2.2.4"><ci id="algorithm1.10.10.1.m1.1.1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1.1.1">𝑐</ci><ci id="algorithm1.10.10.1.m1.2.2.2.2.cmml" xref="algorithm1.10.10.1.m1.2.2.2.2">𝑇</ci></list></apply></apply><apply id="algorithm1.10.10.1.m1.4.5.3.cmml" xref="algorithm1.10.10.1.m1.4.5.3"><times id="algorithm1.10.10.1.m1.4.5.3.1.cmml" xref="algorithm1.10.10.1.m1.4.5.3.1"></times><apply id="algorithm1.10.10.1.m1.4.5.3.2.cmml" xref="algorithm1.10.10.1.m1.4.5.3.2"><times id="algorithm1.10.10.1.m1.4.5.3.2.1.cmml" xref="algorithm1.10.10.1.m1.4.5.3.2.1"></times><cn type="float" id="algorithm1.10.10.1.m1.4.5.3.2.2.cmml" xref="algorithm1.10.10.1.m1.4.5.3.2.2">1.6</cn><ci id="algorithm1.10.10.1.m1.4.5.3.2.3.cmml" xref="algorithm1.10.10.1.m1.4.5.3.2.3">𝑙</ci></apply><ci id="algorithm1.10.10.1.m1.4.5.3.3.cmml" xref="algorithm1.10.10.1.m1.4.5.3.3">𝑜</ci><ci id="algorithm1.10.10.1.m1.4.5.3.4.cmml" xref="algorithm1.10.10.1.m1.4.5.3.4">𝑠</ci><apply id="algorithm1.10.10.1.m1.4.5.3.5.cmml" xref="algorithm1.10.10.1.m1.4.5.3.5"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.4.5.3.5.1.cmml" xref="algorithm1.10.10.1.m1.4.5.3.5">subscript</csymbol><ci id="algorithm1.10.10.1.m1.4.5.3.5.2.cmml" xref="algorithm1.10.10.1.m1.4.5.3.5.2">𝑠</ci><list id="algorithm1.10.10.1.m1.4.4.2.3.cmml" xref="algorithm1.10.10.1.m1.4.4.2.2"><ci id="algorithm1.10.10.1.m1.3.3.1.1.cmml" xref="algorithm1.10.10.1.m1.3.3.1.1">𝑐</ci><apply id="algorithm1.10.10.1.m1.4.4.2.2.1.cmml" xref="algorithm1.10.10.1.m1.4.4.2.2.1"><minus id="algorithm1.10.10.1.m1.4.4.2.2.1.1.cmml" xref="algorithm1.10.10.1.m1.4.4.2.2.1.1"></minus><ci id="algorithm1.10.10.1.m1.4.4.2.2.1.2.cmml" xref="algorithm1.10.10.1.m1.4.4.2.2.1.2">𝑇</ci><cn type="integer" id="algorithm1.10.10.1.m1.4.4.2.2.1.3.cmml" xref="algorithm1.10.10.1.m1.4.4.2.2.1.3">20</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.4c">loss_{c,T}&gt;1.6\times loss_{c,T-20}</annotation></semantics></math></em><span id="algorithm1.10.10.8" class="ltx_text" style="font-size:80%;"> </span><span id="algorithm1.10.10.9" class="ltx_text ltx_font_bold" style="font-size:80%;">then</span>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span id="algorithm1.11.11.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.11.11.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.11.11.3" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.11.11.4" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.11.11.5.1.1" class="ltx_text" style="font-size:80%;">11</span></span><span id="algorithm1.11.11.6" class="ltx_text" style="font-size:80%;">
</span><span id="algorithm1.11.11.7" class="ltx_text" style="font-size:80%;">Remove client </span><math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mi mathsize="80%" id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><ci id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">c</annotation></semantics></math>
</div>
<div id="algorithm1.12.20" class="ltx_listingline">
<span id="algorithm1.12.20.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.20.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.20.3" class="ltx_text" style="font-size:80%;">   </span>
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span id="algorithm1.12.12.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.12.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.12.3" class="ltx_text" style="font-size:80%;">   </span><math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.12.12.m1.1a"><mo mathsize="80%" id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><ci id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\triangleright</annotation></semantics></math><span id="algorithm1.12.12.4" class="ltx_text" style="font-size:80%;">  Federated averaging </span>
</div>
<div id="algorithm1.12.21" class="ltx_listingline">
<span id="algorithm1.12.21.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.21.2" class="ltx_text" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.21.3" class="ltx_text" style="font-size:80%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.12.21.4.1.1" class="ltx_text" style="font-size:80%;">12</span></span><span id="algorithm1.12.21.5" class="ltx_text" style="font-size:80%;">Aggregate weights and update global model using FedAvg method in Eq. </span><a href="#S2.E1" title="In 2.1 Federated Learning Model ‣ 2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref" style="font-size:80%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="algorithm1.12.21.6" class="ltx_text" style="font-size:80%;"> </span>
</div>
<div id="algorithm1.12.22" class="ltx_listingline">
<span id="algorithm1.12.22.1" class="ltx_text" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.12.22.2" class="ltx_text" style="font-size:80%;">   </span>
</div>
<div id="algorithm1.12.23" class="ltx_listingline">
<span id="algorithm1.12.23.1" class="ltx_text" style="font-size:80%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.17.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span><span id="algorithm1.18.2" class="ltx_text ltx_font_bold">Federated learning with clustered aggregation</span> </figcaption>
</figure>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">As it can be seen, the three-layer IoT architecture is used here. The perception and network layers consist of smart meters that measure energy consumption and send it to the central server. The application layer includes a central server that performs computations on the data received from clients. The smart meters use MQTT paired with TCP/IP internet protocol suite for sending data to the central server. Each smart meter pushes weight data to the central server and polls weight updates from the server. Each smart meter is specified by its respective client throughout this paper. Details regarding IoT communication and security requirements are out of the scope of this paper.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>LSTM Model</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">LSTM networks are a special type of recurrent neural networks (RNN) that are able to learn long-term temporal correlations in data sequences and were developed to solve the vanishing gradient problem in original RNNs. They have a forget gate that decides what information to keep or throw away during the learning phase. Recent research suggests that LSTM and its variants have the best performance for time-series forecasting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Therefore, this paper uses LSTM networks for the training phase inside the clients. In this study, the time series data is sampled into sliding windows with look-back size of 24 hours. These sliding windows are the inputs to the LSTM model and the output is the next-hour electricity load. The structure of the LSTM network used in this study is shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 LSTM Model ‣ 2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. This structure is similar to the model developed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. The proposed network has one hidden LSTM layer and two fully connected layers.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2111.07462/assets/LSTM.png" id="S2.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="201" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Structure of the LSTM network used in this study</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">It should be noted that the local training using historical data and LSTM networks is performed inside each client while the global update is performed by the central server after aggregating the neural network weights obtained by the clients. The overall framework is called federated learning.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Customer Clustering</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Since in the FedAvg method, the obtained local weights are averaged by the central server, it is important for clients’ load profiles to have similar patterns. Otherwise, the heterogeneity in data may lead to misconvergence of the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. For example, a client with a very different and unique load profile might affect the global model weights to fit its own data. This will cause the global model to diverge from fitting other clients’ data and, consequently, the error of the obtained model will remain high. To prevent this issue, the clients must be grouped based on their similarities. However, since the global model has no access to client data in federated learning, customer clustering is a challenging task.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Some research works have used clustering based on socioeconomic affinities, metrics such as average, total, and lowest energy consumption, and some other data such as house type, region, facing direction, and number of rental units. However, none of these metrics can reveal consumption patterns properly. A method was proposed by Xu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> to cluster clients based on their obtained weights after the first communication round with the central server. This method might not be accurate either since it takes more training rounds for client weights to converge. In fact, the initial weights adjusted by the central server are the same for all clients at the beginning of the training and might not significantly change after only a few training steps.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">This paper proposes a new clustering method that is able to reveal the similarity between load profiles of various clients. Since all clients are equipped with processing units needed for training, they can also perform hyperparameter tuning for a simple neural network using their data. In this method, the central server asks clients to perform hyperparameter tuning for their training network or another simpler neural network. These hyperparameters can include number of neurons in each hidden layer, number of epochs for training, learning rates, etc., and the tuning can be easily performed using GridSearchCV method. Each client updates its hyperparameter tuning results from time to time and shares this non-sensitive data with the central server. The central server clusters the clients based on their hyperparameters when performing federated learning. This way, the clients are more likely to be grouped based on their data similarities as their hyperparameters are selected based on the historical data stored in each client. In previous studies, the neural network structure for all of the clusters was the same. In the proposed method, the central server fits a specific neural network model to each cluster based on the obtained hyperparameters for that cluster. <span id="S2.SS3.p3.1.1" class="ltx_text" style="color:#000000;">The number of clusters is determined by the central server based on various factors such as accuracy, communication/computation cost, or trade-off between communication/computation cost and accuracy. In addition, the proposed method has the flexibility to adapt to changes in number of clients or their consumption patterns.</span></p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">In this paper, an algorithm is implemented within the federated learning process that detects and removes clients that deter the global model. For this purpose, the training loss of clients in each round is assessed and compared to previous rounds to check whether it is getting smaller or not. In this study, the clients whose loss is 60% worse compared to 20 rounds ago are removed from the federated learning process as shown by lines 10-11 in Algorithm <a href="#algorithm1" title="In 2.1 Federated Learning Model ‣ 2 System Model ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Simulation and Results</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section describes the dataset and the parameters of the model used in this study. Subsequently, it presents, discusses, and compares the obtained results.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Simulation Data</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">This study was conducted using data from 75 locations within the City of Edmonton. The data was provided by EPCOR distribution company under the APIC-alliance project and is not available online. <span id="S3.SS1.p1.1.1" class="ltx_text" style="color:#000000;">The data from residential buildings is used in this study and clustering is used to group them based on similarity in their consumption behavior.</span> The proposed LSTM network consists of one hidden layer. The output of this layer is given to two fully connected hidden layers. Each client performs hyperparameter tuning for this network using its local data to find the best number of neurons for the first and second fully connected layers as well as the number of training epochs. The clients share this data with the central server and the server groups the clients into five clusters using the k-means clustering method. The hyperparameters with the highest number of occurrences within each cluster are chosen for the general structure of that cluster. Inside each client, 75% of data is used for training and 25% for testing. The programming was performed in Python using PyTorch library, on a 3.6GHz processor with 48GB RAM.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The hyperparameters for each cluster are given in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Simulation Data ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. <span id="S3.SS1.p2.1.1" class="ltx_text" style="color:#000000;">To determine the best number of customer clusters in this study, k-means clustering was repeated for various number of clusters and the obtained inertia (sum of squared distances of samples to their closest cluster center) was plotted against the number of clusters as shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Simulation Data ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The five-cluster model was selected since after this point in the plot, there is no significant decrease in inertia. This choice of the lowest acceptable number of clusters optimizes the communication/computation cost of distributed learning.</span></p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Hyperparameters for clusters</figcaption>
<div id="S3.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:325.2pt;height:90.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.0pt,8.6pt) scale(0.839925593528046,0.839925593528046) ;">
<table id="S3.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Cluster#</th>
<th id="S3.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">First layer neurons</th>
<th id="S3.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Second layer neurons</th>
<th id="S3.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Epochs</th>
<th id="S3.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Number of clients</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Cluster 1</th>
<td id="S3.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44</td>
<td id="S3.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">127</td>
<td id="S3.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">148</td>
<td id="S3.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11</td>
</tr>
<tr id="S3.T1.1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Cluster 2</th>
<td id="S3.T1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68</td>
<td id="S3.T1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">198</td>
<td id="S3.T1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">247</td>
<td id="S3.T1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9</td>
</tr>
<tr id="S3.T1.1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Cluster 3</th>
<td id="S3.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56</td>
<td id="S3.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">198</td>
<td id="S3.T1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">103</td>
<td id="S3.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15</td>
</tr>
<tr id="S3.T1.1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Cluster 4</th>
<td id="S3.T1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">32</td>
<td id="S3.T1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85</td>
<td id="S3.T1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">291</td>
<td id="S3.T1.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17</td>
</tr>
<tr id="S3.T1.1.1.6.5" class="ltx_tr">
<th id="S3.T1.1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Cluster 5</th>
<td id="S3.T1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">32</td>
<td id="S3.T1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">127</td>
<td id="S3.T1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">103</td>
<td id="S3.T1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">23</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2111.07462/assets/kmeans2.png" id="S3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="359" height="276" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.3.1" class="ltx_text" style="color:#000000;">Clustering inertia for various numbers of clusters using k-means clustering</span></figcaption>
</figure>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">Mean squared error (MSE) is used as the loss function in this study</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E2.m1.2" class="ltx_Math" alttext="MSE=\frac{\sum_{i=1}^{N}(y_{i}-\hat{y_{i}})^{2}}{N}," display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.1" xref="S3.E2.m1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.2.3" xref="S3.E2.m1.2.2.1.1.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.1a" xref="S3.E2.m1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.2.4" xref="S3.E2.m1.2.2.1.1.2.4.cmml">E</mi></mrow><mo id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml">=</mo><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.2.3.cmml">N</mi></msubsup><msup id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">2</mn></msup></mrow><mi id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">N</mi></mfrac></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"></eq><apply id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"><times id="S3.E2.m1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.1"></times><ci id="S3.E2.m1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2">𝑀</ci><ci id="S3.E2.m1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.3">𝑆</ci><ci id="S3.E2.m1.2.2.1.1.2.4.cmml" xref="S3.E2.m1.2.2.1.1.2.4">𝐸</ci></apply><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.2.2.3"><eq id="S3.E2.m1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1">^</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3">2</cn></apply></apply><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">MSE=\frac{\sum_{i=1}^{N}(y_{i}-\hat{y_{i}})^{2}}{N},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.3" class="ltx_p">where <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">y</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑦</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">y_{i}</annotation></semantics></math> is the actual value, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mover accent="true" id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><msub id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS1.p3.2.m2.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><ci id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1">^</ci><apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\hat{y_{i}}</annotation></semantics></math> is the predicted value, and <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">N</annotation></semantics></math> is the total number of predicted values.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Simulation Results</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">To evaluate the performance of federated learning for individual load prediction (ILP) and aggregate load prediction (ALP), the results are compared with local and centralized forecasts. Local and centralized learning are defined as follows:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">Centralized learning: data is gathered from all clients and a single central server performs training and forecasting.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">Local learning: data stays within each client and each client performs training and forecasting for its local data.</p>
</div>
</li>
</ul>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Root mean squared error (RMSE) is selected as the evaluation criteria in this study as it has the same unit as the actual load and can be easily compared to it. Mean absolute percentage error (MAPE) is not preferred for load forecast problems since load values, especially in ILP, are usually small. This can result in large MAPE values which do not correctly reflect the performance of the forecasting algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the obtained RMSE results for cluster 1. The best obtained results are typeset in bold. The forecasting RMSE can be compared with the maximum and minimum energy consumption given in the same table to get a sense of prediction accuracy. As can be seen, the performance of federated learning for ILP is comparable and, in some cases, even better than local learning. <span id="S3.SS2.p4.1.1" class="ltx_text" style="color:#000000;">It was also observed that,</span> depending on the initial random weights, the performance of local learning can vary to a large extent and easily get trapped in a local minimum. However, the global updates in federated learning can circumvent <span id="S3.SS2.p4.1.2" class="ltx_text" style="color:#000000;">this problem</span>. <span id="S3.SS2.p4.1.3" class="ltx_text" style="color:#000000;">To mitigate the local minimum issue in local learning, three different optimization algorithms (stochastic gradient descent, RMSprop, and Adam) were tested, and Adam was selected due to its better performance. In addition, the learning rate, number of neurons in each layer, and number of iterations were selected to minimize the mean squared error. The parameters were consistent in federated, local, and central learning to allow fair comparison. The mean RMSE in the same table reveals that, on average, local learning performs best for ILP.</span> For the ALP, centralized learning performs better than local and federated learning. It should be noted that, in local learning for ALP, each client performs the forecast individually and the results are summed up to get the aggregate demand.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Prediction results for cluster 1 (units in kWh)</figcaption>
<div id="S3.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:169.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.9pt,14.3pt) scale(0.85587383580001,0.85587383580001) ;">
<table id="S3.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.1.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_r" colspan="3"></th>
<th id="S3.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Federated learning</th>
<th id="S3.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Centralized learning</th>
<th id="S3.T2.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Local learning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1.2.1" class="ltx_tr">
<td id="S3.T2.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T2.1.1.2.1.1.1" class="ltx_text">Test Dataset</span></td>
<td id="S3.T2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T2.1.1.2.1.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T2.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T2.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.187</td>
<td id="S3.T2.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1</td>
<td id="S3.T2.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.2.1.6.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.159</span></td>
</tr>
<tr id="S3.T2.1.1.3.2" class="ltx_tr">
<td id="S3.T2.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T2.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.597</td>
<td id="S3.T2.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.115</td>
<td id="S3.T2.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.3.2.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.504</span></td>
</tr>
<tr id="S3.T2.1.1.4.3" class="ltx_tr">
<td id="S3.T2.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T2.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.418</td>
<td id="S3.T2.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.062</td>
<td id="S3.T2.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.4.3.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.334</span></td>
</tr>
<tr id="S3.T2.1.1.5.4" class="ltx_tr">
<td id="S3.T2.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T2.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T2.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.205</td>
<td id="S3.T2.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.5.4.4.1" class="ltx_text ltx_font_bold">1.152</span></td>
<td id="S3.T2.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.5.4.5.1" class="ltx_text" style="color:#000000;">1.176</span></td>
</tr>
<tr id="S3.T2.1.1.6.5" class="ltx_tr">
<td id="S3.T2.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T2.1.1.6.5.1.1" class="ltx_text">Train Dataset</span></td>
<td id="S3.T2.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T2.1.1.6.5.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T2.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T2.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.205</td>
<td id="S3.T2.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.005</td>
<td id="S3.T2.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.6.5.6.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.139</span></td>
</tr>
<tr id="S3.T2.1.1.7.6" class="ltx_tr">
<td id="S3.T2.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T2.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.7.6.2.1" class="ltx_text ltx_font_bold">0.396</span></td>
<td id="S3.T2.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.63</td>
<td id="S3.T2.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.7.6.4.1" class="ltx_text" style="color:#000000;">0.512</span></td>
</tr>
<tr id="S3.T2.1.1.8.7" class="ltx_tr">
<td id="S3.T2.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T2.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.4</td>
<td id="S3.T2.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.06</td>
<td id="S3.T2.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.8.7.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.306</span></td>
</tr>
<tr id="S3.T2.1.1.9.8" class="ltx_tr">
<td id="S3.T2.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T2.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T2.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.022</td>
<td id="S3.T2.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.022</td>
<td id="S3.T2.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.1.9.8.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.981</span></td>
</tr>
<tr id="S3.T2.1.1.10.9" class="ltx_tr">
<td id="S3.T2.1.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max client energy consumption</td>
<td id="S3.T2.1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.378</td>
<td id="S3.T2.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean client energy consumption</td>
<td id="S3.T2.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.546</td>
</tr>
<tr id="S3.T2.1.1.11.10" class="ltx_tr">
<td id="S3.T2.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max aggregate energy consumption</td>
<td id="S3.T2.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">12.832</td>
<td id="S3.T2.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean aggregate energy consumption</td>
<td id="S3.T2.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">4.37</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Prediction results for cluster 2 are given in Table <a href="#S3.T3" title="Table 3 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Similar to cluster 1, federated learning performs better than centralized learning and is comparable to local learning for ILP. <span id="S3.SS2.p5.1.1" class="ltx_text" style="color:#000000;">Centralized learning has the best performance for ALP and local learning has similar results.
<br class="ltx_break"></span></p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Prediction results for cluster 2 (units in kWh)</figcaption>
<div id="S3.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:169.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.9pt,14.3pt) scale(0.85587383580001,0.85587383580001) ;">
<table id="S3.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.1.1.1.1" class="ltx_tr">
<th id="S3.T3.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_r" colspan="3"></th>
<th id="S3.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Federated learning</th>
<th id="S3.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Centralized learning</th>
<th id="S3.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Local learning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.1.1.2.1" class="ltx_tr">
<td id="S3.T3.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T3.1.1.2.1.1.1" class="ltx_text">Test Dataset</span></td>
<td id="S3.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T3.1.1.2.1.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T3.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.308</td>
<td id="S3.T3.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.342</td>
<td id="S3.T3.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.2.1.6.1" class="ltx_text ltx_font_bold">0.272</span></td>
</tr>
<tr id="S3.T3.1.1.3.2" class="ltx_tr">
<td id="S3.T3.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T3.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.3.2.2.1" class="ltx_text ltx_font_bold">1.055</span></td>
<td id="S3.T3.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.903</td>
<td id="S3.T3.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.3.2.4.1" class="ltx_text" style="color:#000000;">1.155</span></td>
</tr>
<tr id="S3.T3.1.1.4.3" class="ltx_tr">
<td id="S3.T3.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T3.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.607</td>
<td id="S3.T3.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.627</td>
<td id="S3.T3.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.4.3.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.479</span></td>
</tr>
<tr id="S3.T3.1.1.5.4" class="ltx_tr">
<td id="S3.T3.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T3.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T3.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.904</td>
<td id="S3.T3.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.5.4.4.1" class="ltx_text ltx_font_bold">1.448</span></td>
<td id="S3.T3.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.5.4.5.1" class="ltx_text" style="color:#000000;">1.741</span></td>
</tr>
<tr id="S3.T3.1.1.6.5" class="ltx_tr">
<td id="S3.T3.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T3.1.1.6.5.1.1" class="ltx_text">Train Dataset</span></td>
<td id="S3.T3.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T3.1.1.6.5.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T3.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T3.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.213</td>
<td id="S3.T3.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.124</td>
<td id="S3.T3.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.6.5.6.1" class="ltx_text ltx_font_bold">0.17</span></td>
</tr>
<tr id="S3.T3.1.1.7.6" class="ltx_tr">
<td id="S3.T3.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T3.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.288</td>
<td id="S3.T3.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.903</td>
<td id="S3.T3.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.7.6.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.713</span></td>
</tr>
<tr id="S3.T3.1.1.8.7" class="ltx_tr">
<td id="S3.T3.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T3.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.568</td>
<td id="S3.T3.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.614</td>
<td id="S3.T3.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.8.7.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.330</span></td>
</tr>
<tr id="S3.T3.1.1.9.8" class="ltx_tr">
<td id="S3.T3.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T3.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T3.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.003</td>
<td id="S3.T3.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.272</td>
<td id="S3.T3.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T3.1.1.9.8.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">1.162</span></td>
</tr>
<tr id="S3.T3.1.1.10.9" class="ltx_tr">
<td id="S3.T3.1.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max client energy consumption</td>
<td id="S3.T3.1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.959</td>
<td id="S3.T3.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean client energy consumption</td>
<td id="S3.T3.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.33</td>
</tr>
<tr id="S3.T3.1.1.11.10" class="ltx_tr">
<td id="S3.T3.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max aggregate energy consumption</td>
<td id="S3.T3.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">22.399</td>
<td id="S3.T3.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean aggregate energy consumption</td>
<td id="S3.T3.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">11.978</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">Tables <a href="#S3.T4" title="Table 4 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>-<a href="#S3.T6" title="Table 6 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> show the results obtained for clusters 3-5. The observed results show a similar trend as clusters 1 and 2 <span id="S3.SS2.p6.1.1" class="ltx_text" style="color:#000000;">except that, in clusters 3 and 4, local learning performs slightly better for ALP</span>. In general, <span id="S3.SS2.p6.1.2" class="ltx_text" style="color:#000000;">the best case for federated learning is cluster 5 with an average RMSE of 0.433 kWh that is 14.55% higher than the average RMSE</span> using local learning. In the worst case, which occurs <span id="S3.SS2.p6.1.3" class="ltx_text" style="color:#000000;">for cluster 4, the average RMSE obtained using federated learning is 0.874 kWh which is 40.74%</span> higher than the <span id="S3.SS2.p6.1.4" class="ltx_text" style="color:#000000;">mean</span> RMSE obtained by local learning.</p>
</div>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Prediction results for cluster 3 (units in kWh)</figcaption>
<div id="S3.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:170.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.1pt,13.6pt) scale(0.862706164089336,0.862706164089336) ;">
<table id="S3.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.1.1.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_r" colspan="3"></th>
<th id="S3.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Federated learning</th>
<th id="S3.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Centralized learning</th>
<th id="S3.T4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Local learning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.1.1.2.1" class="ltx_tr">
<td id="S3.T4.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T4.1.1.2.1.1.1" class="ltx_text">Test Dataset</span></td>
<td id="S3.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T4.1.1.2.1.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T4.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.186</td>
<td id="S3.T4.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.81</td>
<td id="S3.T4.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.2.1.6.1" class="ltx_text ltx_font_bold">0.173</span></td>
</tr>
<tr id="S3.T4.1.1.3.2" class="ltx_tr">
<td id="S3.T4.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T4.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.276</td>
<td id="S3.T4.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.347</td>
<td id="S3.T4.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.3.2.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">1.033</span></td>
</tr>
<tr id="S3.T4.1.1.4.3" class="ltx_tr">
<td id="S3.T4.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T4.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.627</td>
<td id="S3.T4.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.153</td>
<td id="S3.T4.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.4.3.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.534</span></td>
</tr>
<tr id="S3.T4.1.1.5.4" class="ltx_tr">
<td id="S3.T4.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T4.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T4.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.016</td>
<td id="S3.T4.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.944</td>
<td id="S3.T4.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.5.4.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">2.782</span></td>
</tr>
<tr id="S3.T4.1.1.6.5" class="ltx_tr">
<td id="S3.T4.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T4.1.1.6.5.1.1" class="ltx_text">Train Dataset</span></td>
<td id="S3.T4.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T4.1.1.6.5.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T4.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T4.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.189</td>
<td id="S3.T4.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.784</td>
<td id="S3.T4.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.6.5.6.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.176</span></td>
</tr>
<tr id="S3.T4.1.1.7.6" class="ltx_tr">
<td id="S3.T4.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T4.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.331</td>
<td id="S3.T4.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.334</td>
<td id="S3.T4.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.7.6.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">1.00</span></td>
</tr>
<tr id="S3.T4.1.1.8.7" class="ltx_tr">
<td id="S3.T4.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T4.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.606</td>
<td id="S3.T4.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.14</td>
<td id="S3.T4.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.8.7.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.487</span></td>
</tr>
<tr id="S3.T4.1.1.9.8" class="ltx_tr">
<td id="S3.T4.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T4.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T4.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.953</td>
<td id="S3.T4.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.620</td>
<td id="S3.T4.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T4.1.1.9.8.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">2.557</span></td>
</tr>
<tr id="S3.T4.1.1.10.9" class="ltx_tr">
<td id="S3.T4.1.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max client energy consumption</td>
<td id="S3.T4.1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.927</td>
<td id="S3.T4.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean client energy consumption</td>
<td id="S3.T4.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.286</td>
</tr>
<tr id="S3.T4.1.1.11.10" class="ltx_tr">
<td id="S3.T4.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max aggregate energy consumption</td>
<td id="S3.T4.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">36.93</td>
<td id="S3.T4.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean aggregate energy consumption</td>
<td id="S3.T4.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">19.298</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S3.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Prediction results for cluster 4 (units in kWh)</figcaption>
<div id="S3.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:169.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.9pt,14.3pt) scale(0.85587383580001,0.85587383580001) ;">
<table id="S3.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T5.1.1.1.1" class="ltx_tr">
<th id="S3.T5.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_r" colspan="3"></th>
<th id="S3.T5.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Federated learning</th>
<th id="S3.T5.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Centralized learning</th>
<th id="S3.T5.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Local learning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T5.1.1.2.1" class="ltx_tr">
<td id="S3.T5.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T5.1.1.2.1.1.1" class="ltx_text">Test Dataset</span></td>
<td id="S3.T5.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T5.1.1.2.1.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T5.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T5.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.237</td>
<td id="S3.T5.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.973</td>
<td id="S3.T5.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.2.1.6.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.130</span></td>
</tr>
<tr id="S3.T5.1.1.3.2" class="ltx_tr">
<td id="S3.T5.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T5.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.199</td>
<td id="S3.T5.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.706</td>
<td id="S3.T5.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.3.2.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">1.653</span></td>
</tr>
<tr id="S3.T5.1.1.4.3" class="ltx_tr">
<td id="S3.T5.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T5.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.874</td>
<td id="S3.T5.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.314</td>
<td id="S3.T5.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.4.3.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.621</span></td>
</tr>
<tr id="S3.T5.1.1.5.4" class="ltx_tr">
<td id="S3.T5.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T5.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T5.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.939</td>
<td id="S3.T5.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.265</td>
<td id="S3.T5.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.5.4.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">2.865</span></td>
</tr>
<tr id="S3.T5.1.1.6.5" class="ltx_tr">
<td id="S3.T5.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T5.1.1.6.5.1.1" class="ltx_text">Train Dataset</span></td>
<td id="S3.T5.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T5.1.1.6.5.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T5.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T5.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.268</td>
<td id="S3.T5.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.013</td>
<td id="S3.T5.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.6.5.6.1" class="ltx_text ltx_font_bold">0.119</span></td>
</tr>
<tr id="S3.T5.1.1.7.6" class="ltx_tr">
<td id="S3.T5.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T5.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.337</td>
<td id="S3.T5.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.703</td>
<td id="S3.T5.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.7.6.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">1.548</span></td>
</tr>
<tr id="S3.T5.1.1.8.7" class="ltx_tr">
<td id="S3.T5.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T5.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.888</td>
<td id="S3.T5.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.329</td>
<td id="S3.T5.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.8.7.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.555</span></td>
</tr>
<tr id="S3.T5.1.1.9.8" class="ltx_tr">
<td id="S3.T5.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T5.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T5.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.235</td>
<td id="S3.T5.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.498</td>
<td id="S3.T5.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T5.1.1.9.8.5.1" class="ltx_text ltx_font_bold" style="color:#000000;">2.860</span></td>
</tr>
<tr id="S3.T5.1.1.10.9" class="ltx_tr">
<td id="S3.T5.1.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max client energy consumption</td>
<td id="S3.T5.1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.515</td>
<td id="S3.T5.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean client energy consumption</td>
<td id="S3.T5.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.593</td>
</tr>
<tr id="S3.T5.1.1.11.10" class="ltx_tr">
<td id="S3.T5.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max aggregate energy consumption</td>
<td id="S3.T5.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">50.155</td>
<td id="S3.T5.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean aggregate energy consumption</td>
<td id="S3.T5.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">25.494</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S3.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Prediction results for cluster 5 (units in kWh)</figcaption>
<div id="S3.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:169.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.9pt,14.3pt) scale(0.85587383580001,0.85587383580001) ;">
<table id="S3.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T6.1.1.1.1" class="ltx_tr">
<th id="S3.T6.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_r" colspan="3"></th>
<th id="S3.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Federated learning</th>
<th id="S3.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Centralized learning</th>
<th id="S3.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Local learning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T6.1.1.2.1" class="ltx_tr">
<td id="S3.T6.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T6.1.1.2.1.1.1" class="ltx_text">Test Dataset</span></td>
<td id="S3.T6.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T6.1.1.2.1.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T6.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.117</td>
<td id="S3.T6.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.236</td>
<td id="S3.T6.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.2.1.6.1" class="ltx_text ltx_font_bold">0.088</span></td>
</tr>
<tr id="S3.T6.1.1.3.2" class="ltx_tr">
<td id="S3.T6.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T6.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.3.2.2.1" class="ltx_text ltx_font_bold">1.095</span></td>
<td id="S3.T6.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.836</td>
<td id="S3.T6.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.3.2.4.1" class="ltx_text" style="color:#000000;">1.471</span></td>
</tr>
<tr id="S3.T6.1.1.4.3" class="ltx_tr">
<td id="S3.T6.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T6.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.433</td>
<td id="S3.T6.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.676</td>
<td id="S3.T6.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.4.3.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.378</span></td>
</tr>
<tr id="S3.T6.1.1.5.4" class="ltx_tr">
<td id="S3.T6.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T6.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T6.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.7</td>
<td id="S3.T6.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.5.4.4.1" class="ltx_text ltx_font_bold">2.194</span></td>
<td id="S3.T6.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.5.4.5.1" class="ltx_text" style="color:#000000;">2.630</span></td>
</tr>
<tr id="S3.T6.1.1.6.5" class="ltx_tr">
<td id="S3.T6.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="4"><span id="S3.T6.1.1.6.5.1.1" class="ltx_text">Train Dataset</span></td>
<td id="S3.T6.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S3.T6.1.1.6.5.2.1" class="ltx_text">RMSE (ILP)</span></td>
<td id="S3.T6.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S3.T6.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.13</td>
<td id="S3.T6.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.204</td>
<td id="S3.T6.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.6.5.6.1" class="ltx_text ltx_font_bold">0.097</span></td>
</tr>
<tr id="S3.T6.1.1.7.6" class="ltx_tr">
<td id="S3.T6.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S3.T6.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.088</td>
<td id="S3.T6.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.831</td>
<td id="S3.T6.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.7.6.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.759</span></td>
</tr>
<tr id="S3.T6.1.1.8.7" class="ltx_tr">
<td id="S3.T6.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S3.T6.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.406</td>
<td id="S3.T6.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.686</td>
<td id="S3.T6.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.8.7.4.1" class="ltx_text ltx_font_bold" style="color:#000000;">0.338</span></td>
</tr>
<tr id="S3.T6.1.1.9.8" class="ltx_tr">
<td id="S3.T6.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RMSE (ALP)</td>
<td id="S3.T6.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T6.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.429</td>
<td id="S3.T6.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.9.8.4.1" class="ltx_text ltx_font_bold">0.311</span></td>
<td id="S3.T6.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T6.1.1.9.8.5.1" class="ltx_text" style="color:#000000;">2.068</span></td>
</tr>
<tr id="S3.T6.1.1.10.9" class="ltx_tr">
<td id="S3.T6.1.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max client energy consumption</td>
<td id="S3.T6.1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.011</td>
<td id="S3.T6.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean client energy consumption</td>
<td id="S3.T6.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.717</td>
</tr>
<tr id="S3.T6.1.1.11.10" class="ltx_tr">
<td id="S3.T6.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Max aggregate energy consumption</td>
<td id="S3.T6.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">29.631</td>
<td id="S3.T6.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">Mean aggregate energy consumption</td>
<td id="S3.T6.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">16.496</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.1" class="ltx_p">Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates the federated and local forecast for ILP on the test dataset of client 7 inside cluster 3. It can be observed that, in this case, federated learning performs better than local learning. On the other hand, Figure <a href="#S3.F5" title="Figure 5 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows an example where local learning performs better than federated learning for ILP. Centralized learning does not perform well for ILP and cannot be compared to federated and local learning. Therefore, it is not presented in these figures. <span id="S3.SS2.p7.1.1" class="ltx_text" style="color:#000000;">It can be observed that although federated learning was trained using heterogeneous data from all customers, it still has the capability to perform well on ILP. Considering other benefits that federated learning offers, such as increased data privacy, reduced need for central data storage, and reduced computational burden due to the use of edge computing, it can be a good alternative to local and central learning for ILP.</span></p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2111.07462/assets/f2.png" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="355" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Forecast results for electrical load of client 7 inside cluster 3 using federated and local learning</figcaption>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2111.07462/assets/f3.png" id="S3.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="346" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Forecast results for electrical load of client 4 inside cluster 2 using federated and local learning</figcaption>
</figure>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.1" class="ltx_p">Figure <a href="#S3.F6" title="Figure 6 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> compares the forecast results from federated, centralized, and local learning for ALP. As seen before, the centralized forecast performs best for ALP <span id="S3.SS2.p8.1.1" class="ltx_text" style="color:#000000;">and is closely followed by local forecast. However, in absolute terms, federated learning’s performance for ALP is not good enough. Therefore, it should only be used in cases where centralized learning and access to data is not possible.</span> An example of such a case is forecasting the aggregate demand of houses that are not connected to the same distribution substation while preserving privacy of users.
<br class="ltx_break"></p>
</div>
<figure id="S3.F6" class="ltx_figure"><img src="/html/2111.07462/assets/newFig6.png" id="S3.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="373" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Forecast results for aggregate load of cluster 5 using federated, centralized, and local learning</figcaption>
</figure>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.1" class="ltx_p">To show the effectiveness of the clustering method proposed in this study, MSE of federated learning with and without clustering for client 7 inside cluster 3 is illustrated in Figure <a href="#S3.F7" title="Figure 7 ‣ 3.2 Simulation Results ‣ 3 Simulation and Results ‣ Federated Learning with Hyperparameter-based Clustering for Electrical Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. It can be inferred from this figure that, the training loss without clustering takes more epochs to converge and is higher compared to training with clustering. The results were repeated and verified using data from other clients as well.</p>
</div>
<figure id="S3.F7" class="ltx_figure"><img src="/html/2111.07462/assets/f5.png" id="S3.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="339" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>A comparison of the convergence of federated learning with and without hyperparameter-based clustering for client 7 (cluster 3)</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Federated learning with clustered aggregation was implemented and compared to centralized and local learning for individual and aggregate load forecast problems. A new clustering method based on hyperparameter tuning was proposed and tested in this study. This new approach clusters the clients based on their data similarity while preserving their privacy. The results confirmed that the proposed clustering method reduces the convergence time of federated learning. The study was conducted by dividing the data from 76 houses into five clusters. The results showed that, <span id="S4.p1.1.1" class="ltx_text" style="color:#000000;">on average,</span> federated learning’s performance was weaker than local learning for forecasting individual loads. <span id="S4.p1.1.2" class="ltx_text" style="color:#000000;">In the worst case, federated learning’s mean RMSE within the cluster was 40.74% higher and in the best case, it was 14.55% higher than local learning. However, assessing the results for each house revealed that in some cases, federated learning had lower RMSE than local learning.</span> In addition, it is very common that local learning gets trapped in a local minimum during the training process. <span id="S4.p1.1.3" class="ltx_text" style="color:#000000;">Such problems never occurred during the federated learning due to the global updates.</span> The federated learning’s performance was always better than centralized learning for individual load forecast. <span id="S4.p1.1.4" class="ltx_text" style="color:#000000;">In the aggregate load forecast problem, federated learning did not perform well in any of the clusters.</span></p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">In general, it can be concluded that federated learning often gives reliable results for the individual load forecast problem and it can be used in cases where access to training data is not possible or it is restricted due to privacy issues. Using federated learning for aggregate demand prediction is not recommended except in cases where access to aggregate data is not possible, as discussed in the paper. Future research should focus on optimizing the number of local training epochs by each client to synchronize the communication time with the central server and to increase the overall forecasting accuracy of federated learning.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Acknowledgments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This research was funded by the Natural Sciences and Engineering Research Council (NSERC) of Canada grant number ALLRP 549804-19 and by Alberta Electric System Operator, AltaLink, ATCO Electric, ENMAX, EPCOR Inc., and FortisAlberta.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
X. Luo, L. O. Oyedele, A. O. Ajayi, O. O. Akinade, J. M. D. Delgado, H. A.
Owolabi, A. Ahmed, Genetic algorithm-determined deep feedforward neural
network architecture for predicting electricity consumption in real
buildings, Energy and AI 2 (2020) 100015.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
E. Skomski, J.-Y. Lee, W. Kim, V. Chandan, S. Katipamula, B. Hutchinson,
Sequence-to-sequence neural networks for short-term electrical load
forecasting in commercial office buildings, Energy and Buildings 226 (2020)
110350.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Y. Kim, H. gu Son, S. Kim, Short term electricity load forecasting for
institutional buildings, Energy Reports 5 (2019) 1270–1280.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. Chen, Y. Ren, D. Friedrich, Z. Yu, J. Yu, Prediction of office building
electricity demand using artificial neural network by splitting the time
horizon for different occupancy rates, Energy and AI 5 (2021) 100093.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. van der Meer, M. Shepero, A. Svensson, J. Widén, J. Munkhammar,
Probabilistic forecasting of electricity consumption, photovoltaic power
generation and net demand of an individual building using gaussian processes,
Applied Energy 213 (2018) 195–207.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Munkhammar, D. van der Meer, J. Widén, Very short term load forecasting
of residential electricity consumption using the markov-chain mixture
distribution (MCM) model, Applied Energy 282 (2021) 116180.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Ben Taieb, R. Huser, R. J. Hyndman, M. G. Genton, Forecasting uncertainty in
electricity smart meter data by boosting additive quantile regression, IEEE
Transactions on Smart Grid 7 (5) (2016) 2448–2455.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Zarnani, S. Karimi, P. Musilek, Quantile regression and clustering models of
prediction intervals for weather forecasts: A comparative study, Forecasting
1 (1) (2019) 169–188.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Yaslan, B. Bican, Empirical mode decomposition based denoising method with
support vector regression for time series prediction: A case study for
electricity load forecasting, Measurement 103 (2017) 52–61.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
W. Kim, Y. Han, K. J. Kim, K.-W. Song, Electricity load forecasting using
advanced feature selection and optimal deep learning model for the variable
refrigerant flow systems, Energy Reports 6 (2020) 2604–2618.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
G. Memarzadeh, F. Keynia, Short-term electricity load and price forecasting by
a new optimal LSTM-NN based prediction algorithm, Electric Power Systems
Research 192 (2021) 106995.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
X. Guo, Q. Zhao, D. Zheng, Y. Ning, Y. Gao, A short-term load forecasting model
of multi-scale cnn-lstm hybrid neural network considering the real-time
electricity price, Energy Reports 6 (2020) 1046–1053, 2020 The 7th
International Conference on Power and Energy Systems Engineering.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Sajjad, Z. A. Khan, A. Ullah, T. Hussain, W. Ullah, M. Y. Lee, S. W. Baik, A
novel CNN-GRU-based hybrid approach for short-term residential load
forecasting, IEEE Access 8 (2020) 143759–143768.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
J. de Godoy, K. Otrel-Cass, K. H. Toft, Transformations of trust in society: A
systematic review of how access to big data in energy systems challenges
scandinavian culture, Energy and AI 5 (2021) 100079.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
G. Mor, J. Vilaplana, S. Danov, J. Cipriano, F. Solsona, D. Chemisana,
Empowering, a smart big data framework for sustainable electricity suppliers,
IEEE Access 6 (2018) 71132–71142.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. B. McMahan, E. Moore, D. Ramage, S. Hampson, B. A. y Arcas,
Communication-efficient learning of deep networks from decentralized data
(2017).

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_href"><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">arXiv:1602.05629</span></a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
N. Gholizadeh, P. Musilek, Distributed learning applications in power systems:
A review of methods, gaps, and challenges, Energies 14 (12).

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. Messaoud, A. Bradai, S. H. R. Bukhari, P. T. A. Quang, O. B. Ahmed, M. Atri,
A survey on machine learning in internet of things: Algorithms, strategies,
and applications, Internet of Things 12 (2020) 100314.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. S. Brisimi, R. Chen, T. Mela, A. Olshevsky, I. C. Paschalidis, W. Shi,
Federated learning of predictive models from federated electronic health
records, International Journal of Medical Informatics 112 (2018) 59–67.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
T. Subramanya, R. Riggio, Centralized and federated learning for predictive vnf
autoscaling in multi-domain 5G networks and beyond, IEEE Transactions on
Network and Service Management 18 (1) (2021) 63–78.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
X. Wu, Z. Liang, J. Wang, Fedmed: A federated learning framework for language
modeling, Sensors 20 (14).

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
G. Hua, L. Zhu, J. Wu, C. Shen, L. Zhou, Q. Lin, Blockchain-based federated
learning for intelligent control in heavy haul railway, IEEE Access 8 (2020)
176830–176839.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
M. Savi, F. Olivadese, Short-term energy consumption forecasting at the edge: A
federated learning approach, IEEE Access 9 (2021) 95949–95969.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Taïk, S. Cherkaoui, Electrical load forecasting using edge computing and
federated learning, in: ICC 2020 - 2020 IEEE International Conference on
Communications (ICC), 2020, pp. 1–6.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. L. Tun, K. Thar, C. M. Thwal, C. S. Hong, Federated learning based energy
demand prediction with clustered aggregation, in: 2021 IEEE International
Conference on Big Data and Smart Computing (BigComp), 2021, pp. 164–167.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
H. Liu, X. Zhang, X. Shen, H. Sun, A federated learning framework for smart
grids: Securing power traces in collaborative learning (2021).

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2103.11870" title="" class="ltx_ref ltx_href"><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">arXiv:2103.11870</span></a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
M. Pau, E. Patti, L. Barbierato, A. Estebsari, E. Pons, F. Ponci, A. Monti, A
cloud-based smart metering infrastructure for distribution grid services and
automation, Sustainable Energy, Grids and Networks 15 (2018) 14–25,
technologies and Methodologies in Modern Distribution Grid Automation.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
An introduction to smart meter communication,
<a target="_blank" href="https://www.emnify.com/en/resources/smart-meter" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.emnify.com/en/resources/smart-meter</a>, accessed: October 2021
(September 2021).

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
S. Muzaffar, A. Afshari, Short-term load forecasts using lstm networks, Energy
Procedia 158 (2019) 2922–2927, innovative Solutions for Energy Transitions.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
E. Kharlova, D. May, P. Musilek, Forecasting photovoltaic power production
using a deep learning sequence to sequence model with attention, in: 2020
International Joint Conference on Neural Networks (IJCNN), 2020, pp. 1–7.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. Xiao, M. A. Sotelo, Y. Ma, B. Cao, Y. Zhou, Y. Xu, R. Wang, Z. Li, An
improved lstm model for behavior recognition of intelligent vehicles, IEEE
Access 8 (2020) 101514–101527.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
L. Li, Y. Fan, M. Tse, K.-Y. Lin, A review of applications in federated
learning, Computers &amp; Industrial Engineering 149 (2020) 106854.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
H. Xu, J. Li, H. Xiong, H. Lu, Fedmax: Enabling a highly-efficient federated
learning framework, in: 2020 IEEE 13th International Conference on Cloud
Computing (CLOUD), 2020, pp. 426–434.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Davydenko, R. Fildes, Measuring Forecasting Accuracy: Problems and
Recommendations (by the Example of SKU-Level Judgmental Adjustments),
Springer Berlin Heidelberg, Berlin, Heidelberg, 2014, pp. 43–70.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2111.07461" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2111.07462" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2111.07462">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2111.07462" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2111.07463" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 16:23:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
