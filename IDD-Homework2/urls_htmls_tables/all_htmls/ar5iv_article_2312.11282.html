<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Yuxuan Huang
    <br class="ltx_break"/>
    College of Software
    <br class="ltx_break"/>
    Jilin University
    <br class="ltx_break"/>
    Changchun, China
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id1.1.id1">
     airoura@163.com
    </span>
    &amp;Lida Shi
    <br class="ltx_break"/>
    School of Artificial Intelligence
    <br class="ltx_break"/>
    Jilin University
    <br class="ltx_break"/>
    Changchun, China
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id2.2.id2">
     shild21@mails.jlu.edu.cn
    </span>
    <br class="ltx_break"/>
    <span class="ltx_ERROR undefined" id="id3.3.id3">
     \AND
    </span>
    Anqi Liu
    <br class="ltx_break"/>
    School of New Media and Communication
    <br class="ltx_break"/>
    Tianjin University
    <br class="ltx_break"/>
    Tianjin, China
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id4.4.id4">
     anqi_liu@tju.edu.cn
    </span>
    <br class="ltx_break"/>
    &amp;Hao Xu
    <sup class="ltx_sup" id="id5.5.id5">
     *
    </sup>
    <br class="ltx_break"/>
    College of Computer Science and Technology
    <br class="ltx_break"/>
    Jilin University
    <br class="ltx_break"/>
    Changchun, China
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id6.6.id6">
     xuhao@jlu.edu.cn
    </span>
    <br class="ltx_break"/>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id7.id1">
   The development of large language models (LLMs) has been catalyzed by advancements in pre-training techniques. These models have demonstrated robust reasoning capabilities through manually designed prompts. In this work, we evaluate the conversational reasoning capabilities of the current state-of-the-art LLM (GPT-4) on knowledge graphs (KGs). However, the performance of LLMs is constrained due to a lack of KG environment awareness and the difficulties in developing effective optimization mechanisms for intermediary reasoning stages. We further introduce LLM-ARK, a LLM grounded KG reasoning agent designed to deliver precise and adaptable predictions on KG paths. LLM-ARK leverages Full Textual Environment (FTE) prompt to assimilate state information within each reasoning step. We reframe the challenge of multi-hop reasoning on the KG as a sequential decision-making task. Utilizing the Proximal Policy Optimization (PPO) online policy gradient reinforcement learning algorithm, our model is optimized to learn from rich reward signals. Additionally, we conduct an evaluation of our model and GPT-4 on the OpenDialKG dataset. The experimental results reveal that LLaMA-2-7B-ARK outperforms the current state-of-the-art model by 5.28 percentage points, with a performance rate of 36.39% on the target@1 evaluation metric. Meanwhile, GPT-4 scored 14.91%, further demonstrating the effectiveness of our method.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para ltx_noindent" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    With significant progress in large language models (LLMs), researchers have recognized their superior capabilities in the field of natural language processing (NLP)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Liu et al.,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2023
     </a>
     ; Shakarian et al.,
     <a class="ltx_ref" href="#bib.bib19" title="">
      2023
     </a>
     ; Lai et al.,
     <a class="ltx_ref" href="#bib.bib9" title="">
      2023
     </a>
     )
    </cite>
    . Reasoning ability stands as the most demonstrative of AI intelligence. Recently, to boost the performance of LLMs in reasoning tasks, we noted various optimization strategies adopted by researchers such as Chain of Thought (COT)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wei et al.,
     <a class="ltx_ref" href="#bib.bib27" title="">
      2023
     </a>
     )
    </cite>
    and decomposing subtasks
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kazemi et al.,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2023
     </a>
     )
    </cite>
    . Currently, the reasoning method of LLMs have received limited attention in the conversational KG reasoning task. This research aims to address this gap in the field.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Knowledge Graphs composed of vertices or entities connected by edges or relations, gaining popularity in knowledge-based dialogue systems for its structured disposition. Conversational reasoning models are able to traverse the KG based on conversational context to introduce diverse entities and attributes to make replies more engaging, as well as to improve the logic of the model to mitigate illusions
    <cite class="ltx_cite ltx_citemacro_citep">
     (Rawte et al.,
     <a class="ltx_ref" href="#bib.bib17" title="">
      2023
     </a>
     ; Dong et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022
     </a>
     )
    </cite>
    . Previous work
    <cite class="ltx_cite ltx_citemacro_citep">
     (Moon et al.,
     <a class="ltx_ref" href="#bib.bib12" title="">
      2019
     </a>
     ; Zhang et al.,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2020
     </a>
     ; Ni et al.,
     <a class="ltx_ref" href="#bib.bib13" title="">
      2022
     </a>
     ; Tuan et al.,
     <a class="ltx_ref" href="#bib.bib25" title="">
      2022
     </a>
     )
    </cite>
    mainly relied on supervised learning methods. To assess the capabilities of current SOTA LLM: GPT-4
    <cite class="ltx_cite ltx_citemacro_citep">
     (OpenAI,
     <a class="ltx_ref" href="#bib.bib14" title="">
      2023
     </a>
     )
    </cite>
    , we initially examine the proficiency of LLMs on KG reasoning, as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    , determining their potential application in the KG domain. Empirical studies reveal that, despite demonstrating reasonable performance on KG tasks, indicative of their proficiency in managing complex problems, understanding contextual relationships, and utilizing pre-training knowledge, LLMs still present issues and fall short when compared with state-of-the-art models.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="130" id="S1.F1.1.g1" src="/html/2312.11282/assets/x1.png" width="461"/>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    Manual prompts on the OpenDialKG dataset. Compare to GPT-4-Standard, GPT-4-Normal has more awareness of dialog context and path history, while GPT-4-OPA has more awareness of 2-hop exit path subgraphs compared to the former two. The experimental results show that the more environmental information GPT-4 perceives, the higher the knowledge graph reasoning path@1 evaluation metric score.
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    There are two main challenges applying LLM-based agents. On the one hand, LLMs suffer from a limited perception of variable reasoning environments. The alignment between LLMs’ knowledge and the environment can be wrong and limit functional competence due to lack of grounding
    <cite class="ltx_cite ltx_citemacro_citep">
     (Carta et al.,
     <a class="ltx_ref" href="#bib.bib1" title="">
      2023
     </a>
     )
    </cite>
    . If properly grounded, the model’s structure would be both simplified and effective. For KG reasoning tasks, as shown in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    , the agent achieved better scores when provided with as much information about the environment as possible, such as dialog history, inference path history, and all exit paths. Although LLMs are not designed to take actions,
    <cite class="ltx_cite ltx_citemacro_citet">
     Peng et al. (
     <a class="ltx_ref" href="#bib.bib16" title="">
      2023
     </a>
     ); Carta et al. (
     <a class="ltx_ref" href="#bib.bib1" title="">
      2023
     </a>
     ); Du et al. (
     <a class="ltx_ref" href="#bib.bib3" title="">
      2023
     </a>
     )
    </cite>
    found that it can be achieved good results in downstream decision making by simply feeding full textual representations as inputs to LLMs.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    On the other hand,
    <cite class="ltx_cite ltx_citemacro_citet">
     Yao et al. (
     <a class="ltx_ref" href="#bib.bib28" title="">
      2023
     </a>
     )
    </cite>
    indicate that there is a lack of systematic methods for consistent model refinement. In essence, LLMs fall short in possessing essential mechanisms for optimizing intermediary reasoning processes in multi-hop reasoning tasks. This is mainly attributed to the fact that manual prompt tuning is widely used in many application scenarios. It has been observed that LLM-based agents can easily fall into infinite loops if state is not handled properly, and inevitably run into prompt length problems when the trajectory becomes longer. In addition, the design of prompt is also a challenge because an entity may have more than 100 exit edges, all of which are formatted into prompt which is impractical in a knowledge graph environment. LLMs often encounter these issues because they are not designed or trained for action-agent applications.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    We introduce
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">
     LLM-ARK
    </span>
    , an effective framework that employs
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.2">
     LLM
    </span>
    as an
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">
     Agent
    </span>
    for
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.4">
     R
    </span>
    easoning on
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.5">
     K
    </span>
    nowledge Graphs. We employ LLMs as agent and express the Large model KG inference task as a reinforcement learning sequential decision-making problem, and using a Full-Textual-Environment prompt to aggregate multiscale inputs. Moreover, our agent architecture does not necessitate access to LLM parameters or gradient propagation through it. Instead, we adopt a policy gradient approach where the Actor LLM functions as part of the environment. This configuration enables the model to learn from diverse reward signals across varied tasks and environments. In summary, our contributions are as follows:
   </p>
   <ul class="ltx_itemize" id="S1.I1">
    <li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i1.p1">
      <p class="ltx_p" id="S1.I1.i1.p1.1">
       We assess the capabilities of state-of-the-art LLM: GPT-4, on large-scale KG inference datasets and analyze the experimental results in detail to understand the causes of their inferior performance.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i2.p1">
      <p class="ltx_p" id="S1.I1.i2.p1.1">
       To enhance the performance of the LLM agents, we introduce LLM-ARK. Our method expresses the KG dialog inference problem as a reinforcement learning sequential decision-making issue, using a Full-Textual-Environment prompt to aggregate multiscale inputs, dual-environment sensing on the state and decision side and leverage LLMs to explore on KGs.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
      <p class="ltx_p" id="S1.I1.i3.p1.1">
       Furthermore, we update only the parameters of the PA-MLP that are part of the our agent using the policy gradient method, freezing the parameters of the LLM. This approach enables learning from diverse reward signals during interactions with the environment and improves the efficiency of training.
      </p>
     </div>
    </li>
   </ul>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <section class="ltx_subsection" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    KG Reasoning on Dialog Systems
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.1">
     Given its structured nature, Knowledge Graphs are becoming an increasingly popular external information source in knowledge-based systems.
     <cite class="ltx_cite ltx_citemacro_citet">
      Moon et al. (
      <a class="ltx_ref" href="#bib.bib12" title="">
       2019
      </a>
      )
     </cite>
     developed a retrieval system designed to generate responses based on a graph reasoning task. They employed a graph walker to navigate the graph, propelled by the symbol transformation conditions of the dialog context.
     <cite class="ltx_cite ltx_citemacro_citet">
      Jung et al. (
      <a class="ltx_ref" href="#bib.bib6" title="">
       2020
      </a>
      )
     </cite>
     utilizing graph attention techniques to navigate the conditional graph of a conversation within a KG dialogue system. The model computes an incoming attention fow to represent entities and an outgoing attention fow to select KG paths. However, this approach cannot be extended to long KG path prediction due to the exponential increase in computational complexity.
     <cite class="ltx_cite ltx_citemacro_citet">
      Ni et al. (
      <a class="ltx_ref" href="#bib.bib13" title="">
       2022
      </a>
      )
     </cite>
     introduced a hierarchical reinforcement learning KG inference model that aggregates multiple inputs utilizing an attention mechanism. This approach instructs the model to reason in one step and then fine-tunes it using a goal-directed reinforcement learning.
     <cite class="ltx_cite ltx_citemacro_citet">
      Tuan et al. (
      <a class="ltx_ref" href="#bib.bib25" title="">
       2022
      </a>
      )
     </cite>
     employed a single transformer model that walks directly over large-scale KGs, reasoning over fine-tunable KGs to generate responses. Similarly,
     <cite class="ltx_cite ltx_citemacro_citet">
      Luo et al. (
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      )
     </cite>
     initially create relational paths derived from KGs as high-confidence plans, which are later utilized to extract valid reasoning paths from KGs for confident reasoning.
     <cite class="ltx_cite ltx_citemacro_citet">
      Sun et al. (
      <a class="ltx_ref" href="#bib.bib22" title="">
       2023
      </a>
      )
     </cite>
     leverage KGs to augment LLMs for deep and responsible reasoning. The framework explores and infers by identifying entities relevant to a given question and retrieving relevant triples from external KGs. This iterative process generates multiple inference paths until enough information is gathered to answer the question or maximum depth is reached.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    LLMs with Reinforcement Learning
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS2.p1">
    <p class="ltx_p" id="S2.SS2.p1.1">
     Reinforcement learning and large models are divided into two main aspects of the combination, the first aspect further improves the ability of LLM to understand and follow user instructions through reinforcement learning based methods
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ouyang et al.,
      <a class="ltx_ref" href="#bib.bib15" title="">
       2022
      </a>
      )
     </cite>
     .
     <cite class="ltx_cite ltx_citemacro_citet">
      Yao et al. (
      <a class="ltx_ref" href="#bib.bib28" title="">
       2023
      </a>
      )
     </cite>
     employed a special RLHF technique to tailor the model to human preferences, generating beneficial, non-toxic, and safe data for training while also training reward models to evaluate LLMs. Retroformer, a significant improvement over Chain of Thought (COT), is primarily applied to reasoning tasks and uses a unique RLHF method.
     <cite class="ltx_cite ltx_citemacro_citet">
      Shinn et al. (
      <a class="ltx_ref" href="#bib.bib20" title="">
       2023
      </a>
      )
     </cite>
     introduce a novel framework, Reflexion, that strengthens linguistic agents through linguistic feedback, rather than updating weights. The Reflexion agent verbally reflects on task feedback signals, and then stores its reflection text in an episodic memory buffer to make better decisions in subsequent trials.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S2.SS2.p2">
    <p class="ltx_p" id="S2.SS2.p2.1">
     The second aspect is to further improve the applicability of LLM on real-world tasks through a reinforcement learning-based approach, since training a LLM public NLP task/dataset can only cover a small portion of the real world, and reinforcement learning can train LLM-based intelligences to explore the realization of various real-world goals.
     <cite class="ltx_cite ltx_citemacro_citet">
      Carta et al. (
      <a class="ltx_ref" href="#bib.bib1" title="">
       2023
      </a>
      )
     </cite>
     studied LLMs interaction with physical environments. Using an interactive textual environment designed to study a series of spatial and navigational tasks and using online reinforcement learning to improve its performance to solve goals.
     <cite class="ltx_cite ltx_citemacro_citet">
      Huang et al. (
      <a class="ltx_ref" href="#bib.bib5" title="">
       2022
      </a>
      )
     </cite>
     consistently integrate feedback from diverse sources into the planning language cues of the LLM, thereby enabling it to reason and replan to solve complex problems in both simulated and real-world environments.
     <cite class="ltx_cite ltx_citemacro_citet">
      Singh et al. (
      <a class="ltx_ref" href="#bib.bib21" title="">
       2022
      </a>
      )
     </cite>
     propose a procedural LLM hint structure that facilitates plan generation functionality in contextual environments, robot capabilities, and tasks.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Methods
  </h2>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Overview
   </h3>
   <figure class="ltx_figure" id="S3.F2">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="199" id="S3.F2.1.g1" src="/html/2312.11282/assets/x2.png" width="461"/>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      Figure 2:
     </span>
     The overall architecture of LLM-ARK.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.1">
     As shown in Figure
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.1 Overview ‣ 3 Methods ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , our model has the following main components, FTE (Full-Textual-Environment), LLM (Large Language Model) and RL(Reinforcement Learning). FTE can be seen as state manager, using a Full-Textual-Environment prompt to aggregate multi-scale inputs, updating and maintaining state transfers between itself and the environment. At first LLMs obtain a richly informative representation of state embeddings. To capture the path embedding information of the KG, we pre-train the KG on TransE
     <cite class="ltx_cite ltx_citemacro_citep">
      (Fan et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2014
      </a>
      )
     </cite>
     . Rather than directly introducing the probability distribution of the action space, our Actor feeds the probability distribution along with the path embedding, subsequently eliminating invalid paths (we utilise ’Pad’ for this adaptation process) before outputting a precise and legitimate action. We formulate the large model KG inference task within an online reinforcement learning framework and continuously optimize the decision network based on the collected experience in replay buffer. Finally, we refine the adapter using the Proximal Policy Optimization (PPO) online reinforcement learning method. In this section, we will first describe the method used to evaluate GPT-4, and then present each of the modules of our model in turn.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Manual Prompt Tuning
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.2">
     As illustrated in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , we detail the prompting schemes, encompassing the standard prompt, normal prompt and out path aware prompt. To guide LLMs in performing specific dialogue tasks, we can formulate the standard prompt and normal prompt scheme as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle p(r|D,C)" class="ltx_Math" display="inline" id="S3.E1X.2.1.1.m1.3">
         <semantics id="S3.E1X.2.1.1.m1.3a">
          <mrow id="S3.E1X.2.1.1.m1.3.3" xref="S3.E1X.2.1.1.m1.3.3.cmml">
           <mi id="S3.E1X.2.1.1.m1.3.3.3" xref="S3.E1X.2.1.1.m1.3.3.3.cmml">
            p
           </mi>
           <mo id="S3.E1X.2.1.1.m1.3.3.2" lspace="0em" rspace="0em" xref="S3.E1X.2.1.1.m1.3.3.2.cmml">
            ​
           </mo>
           <mrow id="S3.E1X.2.1.1.m1.3.3.1.1" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.cmml">
            <mo id="S3.E1X.2.1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.cmml">
             (
            </mo>
            <mrow id="S3.E1X.2.1.1.m1.3.3.1.1.1" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.cmml">
             <mi id="S3.E1X.2.1.1.m1.3.3.1.1.1.2" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.2.cmml">
              r
             </mi>
             <mo fence="false" id="S3.E1X.2.1.1.m1.3.3.1.1.1.1" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.1.cmml">
              |
             </mo>
             <mrow id="S3.E1X.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.3.1.cmml">
              <mi id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml">
               D
              </mi>
              <mo id="S3.E1X.2.1.1.m1.3.3.1.1.1.3.2.1" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.3.1.cmml">
               ,
              </mo>
              <mi id="S3.E1X.2.1.1.m1.2.2" xref="S3.E1X.2.1.1.m1.2.2.cmml">
               C
              </mi>
             </mrow>
            </mrow>
            <mo id="S3.E1X.2.1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.3b">
           <apply id="S3.E1X.2.1.1.m1.3.3.cmml" xref="S3.E1X.2.1.1.m1.3.3">
            <times id="S3.E1X.2.1.1.m1.3.3.2.cmml" xref="S3.E1X.2.1.1.m1.3.3.2">
            </times>
            <ci id="S3.E1X.2.1.1.m1.3.3.3.cmml" xref="S3.E1X.2.1.1.m1.3.3.3">
             𝑝
            </ci>
            <apply id="S3.E1X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.3.3.1.1">
             <csymbol cd="latexml" id="S3.E1X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.1">
              conditional
             </csymbol>
             <ci id="S3.E1X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.2">
              𝑟
             </ci>
             <list id="S3.E1X.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1X.2.1.1.m1.3.3.1.1.1.3.2">
              <ci id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">
               𝐷
              </ci>
              <ci id="S3.E1X.2.1.1.m1.2.2.cmml" xref="S3.E1X.2.1.1.m1.2.2">
               𝐶
              </ci>
             </list>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.3c">
           \displaystyle p(r|D,C)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p1.3">
     Given the task background D and the conversation history C, instruct the LLM to generate the response r. More complex path aware prompt aims to provide alternative options for LLMs to decide what kinds of actions should be taken in the response, instead of simply responding to the instruction. It can be formulated as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle p(a,r|D,C,A)" class="ltx_Math" display="inline" id="S3.E2X.2.1.1.m1.5">
         <semantics id="S3.E2X.2.1.1.m1.5a">
          <mrow id="S3.E2X.2.1.1.m1.5.5" xref="S3.E2X.2.1.1.m1.5.5.cmml">
           <mi id="S3.E2X.2.1.1.m1.5.5.3" xref="S3.E2X.2.1.1.m1.5.5.3.cmml">
            p
           </mi>
           <mo id="S3.E2X.2.1.1.m1.5.5.2" lspace="0em" rspace="0em" xref="S3.E2X.2.1.1.m1.5.5.2.cmml">
            ​
           </mo>
           <mrow id="S3.E2X.2.1.1.m1.5.5.1.1" xref="S3.E2X.2.1.1.m1.5.5.1.2.cmml">
            <mo id="S3.E2X.2.1.1.m1.5.5.1.1.2" stretchy="false" xref="S3.E2X.2.1.1.m1.5.5.1.2.cmml">
             (
            </mo>
            <mi id="S3.E2X.2.1.1.m1.4.4" xref="S3.E2X.2.1.1.m1.4.4.cmml">
             a
            </mi>
            <mo id="S3.E2X.2.1.1.m1.5.5.1.1.3" xref="S3.E2X.2.1.1.m1.5.5.1.2.cmml">
             ,
            </mo>
            <mrow id="S3.E2X.2.1.1.m1.5.5.1.1.1" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.cmml">
             <mi id="S3.E2X.2.1.1.m1.5.5.1.1.1.2" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.2.cmml">
              r
             </mi>
             <mo fence="false" id="S3.E2X.2.1.1.m1.5.5.1.1.1.1" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.1.cmml">
              |
             </mo>
             <mrow id="S3.E2X.2.1.1.m1.5.5.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.3.1.cmml">
              <mi id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml">
               D
              </mi>
              <mo id="S3.E2X.2.1.1.m1.5.5.1.1.1.3.2.1" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.3.1.cmml">
               ,
              </mo>
              <mi id="S3.E2X.2.1.1.m1.2.2" xref="S3.E2X.2.1.1.m1.2.2.cmml">
               C
              </mi>
              <mo id="S3.E2X.2.1.1.m1.5.5.1.1.1.3.2.2" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.3.1.cmml">
               ,
              </mo>
              <mi id="S3.E2X.2.1.1.m1.3.3" xref="S3.E2X.2.1.1.m1.3.3.cmml">
               A
              </mi>
             </mrow>
            </mrow>
            <mo id="S3.E2X.2.1.1.m1.5.5.1.1.4" stretchy="false" xref="S3.E2X.2.1.1.m1.5.5.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.5b">
           <apply id="S3.E2X.2.1.1.m1.5.5.cmml" xref="S3.E2X.2.1.1.m1.5.5">
            <times id="S3.E2X.2.1.1.m1.5.5.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2">
            </times>
            <ci id="S3.E2X.2.1.1.m1.5.5.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.3">
             𝑝
            </ci>
            <interval closure="open" id="S3.E2X.2.1.1.m1.5.5.1.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.1.1">
             <ci id="S3.E2X.2.1.1.m1.4.4.cmml" xref="S3.E2X.2.1.1.m1.4.4">
              𝑎
             </ci>
             <apply id="S3.E2X.2.1.1.m1.5.5.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.1.1.1">
              <csymbol cd="latexml" id="S3.E2X.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.1">
               conditional
              </csymbol>
              <ci id="S3.E2X.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.2">
               𝑟
              </ci>
              <list id="S3.E2X.2.1.1.m1.5.5.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.1.1.1.3.2">
               <ci id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">
                𝐷
               </ci>
               <ci id="S3.E2X.2.1.1.m1.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2">
                𝐶
               </ci>
               <ci id="S3.E2X.2.1.1.m1.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3">
                𝐴
               </ci>
              </list>
             </apply>
            </interval>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.5c">
           \displaystyle p(a,r|D,C,A)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p1.1">
     Given the task background D, conversation history C, and a set of potential dialogue acts A, the LLM is guided to select the most appropriate dialogue act
     <math alttext="a\in" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
      <semantics id="S3.SS2.p1.1.m1.1a">
       <mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
        <mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">
         a
        </mi>
        <mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
        <apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
         <in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">
         </in>
         <ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">
          𝑎
         </ci>
         <csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">
          absent
         </csymbol>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">
        a\in
       </annotation>
      </semantics>
     </math>
     A, which then generates the response r.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    LLM-ARK
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.14">
     Knowledge Graphs are structured knowledge networks composed of vertices, interpreted as entities, associated via edges or relationships. Let
     <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1">
      <semantics id="S3.SS3.p1.1.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">
        ℰ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b">
        <ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">
         ℰ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">
        \mathcal{E}
       </annotation>
      </semantics>
     </math>
     stand for a collection of entities and
     <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1">
      <semantics id="S3.SS3.p1.2.m2.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">
        ℛ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b">
        <ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">
         ℛ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">
        \mathcal{R}
       </annotation>
      </semantics>
     </math>
     for a collection of relations. We represent the external KG as
     <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1">
      <semantics id="S3.SS3.p1.3.m3.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">
        𝒢
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b">
        <ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">
         𝒢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">
        \mathcal{G}
       </annotation>
      </semantics>
     </math>
     = {V,E,
     <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1">
      <semantics id="S3.SS3.p1.4.m4.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">
        ℛ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b">
        <ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">
         ℛ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">
        \mathcal{R}
       </annotation>
      </semantics>
     </math>
     }, where V and E denote the vertices and edges of the graph, respectively. Note that V =
     <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1">
      <semantics id="S3.SS3.p1.5.m5.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">
        ℰ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b">
        <ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">
         ℰ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">
        \mathcal{E}
       </annotation>
      </semantics>
     </math>
     and E
     <math alttext="\subseteq V" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1">
      <semantics id="S3.SS3.p1.6.m6.1a">
       <mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">
        <mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">
        </mi>
        <mo id="S3.SS3.p1.6.m6.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.cmml">
         ⊆
        </mo>
        <mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">
         V
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b">
        <apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">
         <subset id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1">
         </subset>
         <csymbol cd="latexml" id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">
          absent
         </csymbol>
         <ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">
          𝑉
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">
        \subseteq V
       </annotation>
      </semantics>
     </math>
     ×
     <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1">
      <semantics id="S3.SS3.p1.7.m7.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">
        ℛ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b">
        <ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">
         ℛ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">
        \mathcal{R}
       </annotation>
      </semantics>
     </math>
     × V. Let
     <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1">
      <semantics id="S3.SS3.p1.8.m8.1a">
       <mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">
        v
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b">
        <ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">
         𝑣
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">
        v
       </annotation>
      </semantics>
     </math>
     denote a node and
     <math alttext="e" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1">
      <semantics id="S3.SS3.p1.9.m9.1a">
       <mi id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">
        e
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b">
        <ci id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">
         𝑒
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">
        e
       </annotation>
      </semantics>
     </math>
     denote an edge in
     <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1">
      <semantics id="S3.SS3.p1.10.m10.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml">
        𝒢
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b">
        <ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">
         𝒢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">
        \mathcal{G}
       </annotation>
      </semantics>
     </math>
     . Given dialog context
     <math alttext="X=" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1">
      <semantics id="S3.SS3.p1.11.m11.1a">
       <mrow id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml">
        <mi id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml">
         X
        </mi>
        <mo id="S3.SS3.p1.11.m11.1.1.1" xref="S3.SS3.p1.11.m11.1.1.1.cmml">
         =
        </mo>
        <mi id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b">
        <apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">
         <eq id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1.1">
         </eq>
         <ci id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2">
          𝑋
         </ci>
         <csymbol cd="latexml" id="S3.SS3.p1.11.m11.1.1.3.cmml" xref="S3.SS3.p1.11.m11.1.1.3">
          absent
         </csymbol>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">
        X=
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m12.1">
      <semantics id="S3.SS3.p1.12.m12.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml">
        𝒢
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b">
        <ci id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1">
         𝒢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">
        \mathcal{G}
       </annotation>
      </semantics>
     </math>
     , we can identify an entity in the KG (e.g., an entity name The Wondering Earth) and and represent it as
     <math alttext="v_{s},v_{s}\in V" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m13.2">
      <semantics id="S3.SS3.p1.13.m13.2a">
       <mrow id="S3.SS3.p1.13.m13.2.2" xref="S3.SS3.p1.13.m13.2.2.cmml">
        <mrow id="S3.SS3.p1.13.m13.2.2.2.2" xref="S3.SS3.p1.13.m13.2.2.2.3.cmml">
         <msub id="S3.SS3.p1.13.m13.1.1.1.1.1" xref="S3.SS3.p1.13.m13.1.1.1.1.1.cmml">
          <mi id="S3.SS3.p1.13.m13.1.1.1.1.1.2" xref="S3.SS3.p1.13.m13.1.1.1.1.1.2.cmml">
           v
          </mi>
          <mi id="S3.SS3.p1.13.m13.1.1.1.1.1.3" xref="S3.SS3.p1.13.m13.1.1.1.1.1.3.cmml">
           s
          </mi>
         </msub>
         <mo id="S3.SS3.p1.13.m13.2.2.2.2.3" xref="S3.SS3.p1.13.m13.2.2.2.3.cmml">
          ,
         </mo>
         <msub id="S3.SS3.p1.13.m13.2.2.2.2.2" xref="S3.SS3.p1.13.m13.2.2.2.2.2.cmml">
          <mi id="S3.SS3.p1.13.m13.2.2.2.2.2.2" xref="S3.SS3.p1.13.m13.2.2.2.2.2.2.cmml">
           v
          </mi>
          <mi id="S3.SS3.p1.13.m13.2.2.2.2.2.3" xref="S3.SS3.p1.13.m13.2.2.2.2.2.3.cmml">
           s
          </mi>
         </msub>
        </mrow>
        <mo id="S3.SS3.p1.13.m13.2.2.3" xref="S3.SS3.p1.13.m13.2.2.3.cmml">
         ∈
        </mo>
        <mi id="S3.SS3.p1.13.m13.2.2.4" xref="S3.SS3.p1.13.m13.2.2.4.cmml">
         V
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m13.2b">
        <apply id="S3.SS3.p1.13.m13.2.2.cmml" xref="S3.SS3.p1.13.m13.2.2">
         <in id="S3.SS3.p1.13.m13.2.2.3.cmml" xref="S3.SS3.p1.13.m13.2.2.3">
         </in>
         <list id="S3.SS3.p1.13.m13.2.2.2.3.cmml" xref="S3.SS3.p1.13.m13.2.2.2.2">
          <apply id="S3.SS3.p1.13.m13.1.1.1.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p1.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS3.p1.13.m13.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.13.m13.1.1.1.1.1.2">
            𝑣
           </ci>
           <ci id="S3.SS3.p1.13.m13.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.13.m13.1.1.1.1.1.3">
            𝑠
           </ci>
          </apply>
          <apply id="S3.SS3.p1.13.m13.2.2.2.2.2.cmml" xref="S3.SS3.p1.13.m13.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS3.p1.13.m13.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.13.m13.2.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS3.p1.13.m13.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.13.m13.2.2.2.2.2.2">
            𝑣
           </ci>
           <ci id="S3.SS3.p1.13.m13.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.13.m13.2.2.2.2.2.3">
            𝑠
           </ci>
          </apply>
         </list>
         <ci id="S3.SS3.p1.13.m13.2.2.4.cmml" xref="S3.SS3.p1.13.m13.2.2.4">
          𝑉
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.13.m13.2c">
        v_{s},v_{s}\in V
       </annotation>
      </semantics>
     </math>
     . The goal is to select a proper edge
     <math alttext="e_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m14.1">
      <semantics id="S3.SS3.p1.14.m14.1a">
       <msub id="S3.SS3.p1.14.m14.1.1" xref="S3.SS3.p1.14.m14.1.1.cmml">
        <mi id="S3.SS3.p1.14.m14.1.1.2" xref="S3.SS3.p1.14.m14.1.1.2.cmml">
         e
        </mi>
        <mi id="S3.SS3.p1.14.m14.1.1.3" xref="S3.SS3.p1.14.m14.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m14.1b">
        <apply id="S3.SS3.p1.14.m14.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.1.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS3.p1.14.m14.1.1.2.cmml" xref="S3.SS3.p1.14.m14.1.1.2">
          𝑒
         </ci>
         <ci id="S3.SS3.p1.14.m14.1.1.3.cmml" xref="S3.SS3.p1.14.m14.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.14.m14.1c">
        e_{t}
       </annotation>
      </semantics>
     </math>
     at the t-th timestamp for one-hop reasoning.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.1">
     Graph attention-based models require significant annotation effort since all potential paths must be evaluated, which can be computationally expensive for large Knowledge Bases (KBs) with millions of entities. To overcome this challenge, our study employs a policy gradient model that efficiently traverses the KG to select relationships and ultimately achieves the target, demonstrating proficiency in multi-hop reasoning.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.2">
     KG reasoning naturally reduces to a finite horizon, deterministic partially observed Markov decision process that lie on a KG
     <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1">
      <semantics id="S3.SS3.p3.1.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">
        𝒢
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b">
        <ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">
         𝒢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">
        \mathcal{G}
       </annotation>
      </semantics>
     </math>
     . We formulate KG reasoning as a Markov Decision Process (MDP) described by a five-tuple
     <math alttext="(S,O,A,T,R,\gamma)" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.6">
      <semantics id="S3.SS3.p3.2.m2.6a">
       <mrow id="S3.SS3.p3.2.m2.6.7.2" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
        <mo id="S3.SS3.p3.2.m2.6.7.2.1" stretchy="false" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         (
        </mo>
        <mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">
         S
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.2" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml">
         O
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.3" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p3.2.m2.3.3" xref="S3.SS3.p3.2.m2.3.3.cmml">
         A
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.4" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p3.2.m2.4.4" xref="S3.SS3.p3.2.m2.4.4.cmml">
         T
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.5" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p3.2.m2.5.5" xref="S3.SS3.p3.2.m2.5.5.cmml">
         R
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.6" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p3.2.m2.6.6" xref="S3.SS3.p3.2.m2.6.6.cmml">
         γ
        </mi>
        <mo id="S3.SS3.p3.2.m2.6.7.2.7" stretchy="false" xref="S3.SS3.p3.2.m2.6.7.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.6b">
        <vector id="S3.SS3.p3.2.m2.6.7.1.cmml" xref="S3.SS3.p3.2.m2.6.7.2">
         <ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">
          𝑆
         </ci>
         <ci id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2">
          𝑂
         </ci>
         <ci id="S3.SS3.p3.2.m2.3.3.cmml" xref="S3.SS3.p3.2.m2.3.3">
          𝐴
         </ci>
         <ci id="S3.SS3.p3.2.m2.4.4.cmml" xref="S3.SS3.p3.2.m2.4.4">
          𝑇
         </ci>
         <ci id="S3.SS3.p3.2.m2.5.5.cmml" xref="S3.SS3.p3.2.m2.5.5">
          𝑅
         </ci>
         <ci id="S3.SS3.p3.2.m2.6.6.cmml" xref="S3.SS3.p3.2.m2.6.6">
          𝛾
         </ci>
        </vector>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.6c">
        (S,O,A,T,R,\gamma)
       </annotation>
      </semantics>
     </math>
     :
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p4">
    <ul class="ltx_itemize" id="S3.I1">
     <li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i1.p1">
       <p class="ltx_p" id="S3.I1.i1.p1.8">
        State.
        <math alttext="S" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1">
         <semantics id="S3.I1.i1.p1.1.m1.1a">
          <mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">
           S
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b">
           <ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">
            𝑆
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">
           S
          </annotation>
         </semantics>
        </math>
        is an infinite set of environment states, which encode information stored in Working Memory, including task background
        <math alttext="tb" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1">
         <semantics id="S3.I1.i1.p1.2.m2.1a">
          <mrow id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">
           <mi id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">
            t
           </mi>
           <mo id="S3.I1.i1.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml">
            b
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b">
           <apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">
            <times id="S3.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1">
            </times>
            <ci id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2">
             𝑡
            </ci>
            <ci id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">
             𝑏
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">
           tb
          </annotation>
         </semantics>
        </math>
        , user query
        <math alttext="q" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.1">
         <semantics id="S3.I1.i1.p1.3.m3.1a">
          <mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">
           q
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b">
           <ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">
            𝑞
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">
           q
          </annotation>
         </semantics>
        </math>
        , dialog history
        <math alttext="h" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.1">
         <semantics id="S3.I1.i1.p1.4.m4.1a">
          <mi id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml">
           h
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b">
           <ci id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1">
            ℎ
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">
           h
          </annotation>
         </semantics>
        </math>
        , current entity
        <math alttext="v_{c}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.5.m5.1">
         <semantics id="S3.I1.i1.p1.5.m5.1a">
          <msub id="S3.I1.i1.p1.5.m5.1.1" xref="S3.I1.i1.p1.5.m5.1.1.cmml">
           <mi id="S3.I1.i1.p1.5.m5.1.1.2" xref="S3.I1.i1.p1.5.m5.1.1.2.cmml">
            v
           </mi>
           <mi id="S3.I1.i1.p1.5.m5.1.1.3" xref="S3.I1.i1.p1.5.m5.1.1.3.cmml">
            c
           </mi>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.1b">
           <apply id="S3.I1.i1.p1.5.m5.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1">
            <csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1">
             subscript
            </csymbol>
            <ci id="S3.I1.i1.p1.5.m5.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.1.1.2">
             𝑣
            </ci>
            <ci id="S3.I1.i1.p1.5.m5.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.1.1.3">
             𝑐
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.1c">
           v_{c}
          </annotation>
         </semantics>
        </math>
        , path history
        <math alttext="ph" class="ltx_Math" display="inline" id="S3.I1.i1.p1.6.m6.1">
         <semantics id="S3.I1.i1.p1.6.m6.1a">
          <mrow id="S3.I1.i1.p1.6.m6.1.1" xref="S3.I1.i1.p1.6.m6.1.1.cmml">
           <mi id="S3.I1.i1.p1.6.m6.1.1.2" xref="S3.I1.i1.p1.6.m6.1.1.2.cmml">
            p
           </mi>
           <mo id="S3.I1.i1.p1.6.m6.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.6.m6.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.I1.i1.p1.6.m6.1.1.3" xref="S3.I1.i1.p1.6.m6.1.1.3.cmml">
            h
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.6.m6.1b">
           <apply id="S3.I1.i1.p1.6.m6.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1">
            <times id="S3.I1.i1.p1.6.m6.1.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.1">
            </times>
            <ci id="S3.I1.i1.p1.6.m6.1.1.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2">
             𝑝
            </ci>
            <ci id="S3.I1.i1.p1.6.m6.1.1.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3">
             ℎ
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.6.m6.1c">
           ph
          </annotation>
         </semantics>
        </math>
        , current step
        <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.i1.p1.7.m7.1">
         <semantics id="S3.I1.i1.p1.7.m7.1a">
          <mi id="S3.I1.i1.p1.7.m7.1.1" xref="S3.I1.i1.p1.7.m7.1.1.cmml">
           t
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.7.m7.1b">
           <ci id="S3.I1.i1.p1.7.m7.1.1.cmml" xref="S3.I1.i1.p1.7.m7.1.1">
            𝑡
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.7.m7.1c">
           t
          </annotation>
         </semantics>
        </math>
        , The normal state is represented using a six-tuple:
        <math alttext="S=(tb,q,h,v_{c},ph,t)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.8.m8.6">
         <semantics id="S3.I1.i1.p1.8.m8.6a">
          <mrow id="S3.I1.i1.p1.8.m8.6.6" xref="S3.I1.i1.p1.8.m8.6.6.cmml">
           <mi id="S3.I1.i1.p1.8.m8.6.6.5" xref="S3.I1.i1.p1.8.m8.6.6.5.cmml">
            S
           </mi>
           <mo id="S3.I1.i1.p1.8.m8.6.6.4" xref="S3.I1.i1.p1.8.m8.6.6.4.cmml">
            =
           </mo>
           <mrow id="S3.I1.i1.p1.8.m8.6.6.3.3" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.4" stretchy="false" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             (
            </mo>
            <mrow id="S3.I1.i1.p1.8.m8.4.4.1.1.1" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.cmml">
             <mi id="S3.I1.i1.p1.8.m8.4.4.1.1.1.2" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.2.cmml">
              t
             </mi>
             <mo id="S3.I1.i1.p1.8.m8.4.4.1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i1.p1.8.m8.4.4.1.1.1.3" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.3.cmml">
              b
             </mi>
            </mrow>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.5" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i1.p1.8.m8.1.1" xref="S3.I1.i1.p1.8.m8.1.1.cmml">
             q
            </mi>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.6" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i1.p1.8.m8.2.2" xref="S3.I1.i1.p1.8.m8.2.2.cmml">
             h
            </mi>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.7" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             ,
            </mo>
            <msub id="S3.I1.i1.p1.8.m8.5.5.2.2.2" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2.cmml">
             <mi id="S3.I1.i1.p1.8.m8.5.5.2.2.2.2" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2.2.cmml">
              v
             </mi>
             <mi id="S3.I1.i1.p1.8.m8.5.5.2.2.2.3" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2.3.cmml">
              c
             </mi>
            </msub>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.8" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             ,
            </mo>
            <mrow id="S3.I1.i1.p1.8.m8.6.6.3.3.3" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.cmml">
             <mi id="S3.I1.i1.p1.8.m8.6.6.3.3.3.2" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.2.cmml">
              p
             </mi>
             <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.3.1" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i1.p1.8.m8.6.6.3.3.3.3" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.3.cmml">
              h
             </mi>
            </mrow>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.9" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i1.p1.8.m8.3.3" xref="S3.I1.i1.p1.8.m8.3.3.cmml">
             t
            </mi>
            <mo id="S3.I1.i1.p1.8.m8.6.6.3.3.10" stretchy="false" xref="S3.I1.i1.p1.8.m8.6.6.3.4.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.8.m8.6b">
           <apply id="S3.I1.i1.p1.8.m8.6.6.cmml" xref="S3.I1.i1.p1.8.m8.6.6">
            <eq id="S3.I1.i1.p1.8.m8.6.6.4.cmml" xref="S3.I1.i1.p1.8.m8.6.6.4">
            </eq>
            <ci id="S3.I1.i1.p1.8.m8.6.6.5.cmml" xref="S3.I1.i1.p1.8.m8.6.6.5">
             𝑆
            </ci>
            <vector id="S3.I1.i1.p1.8.m8.6.6.3.4.cmml" xref="S3.I1.i1.p1.8.m8.6.6.3.3">
             <apply id="S3.I1.i1.p1.8.m8.4.4.1.1.1.cmml" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1">
              <times id="S3.I1.i1.p1.8.m8.4.4.1.1.1.1.cmml" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.1">
              </times>
              <ci id="S3.I1.i1.p1.8.m8.4.4.1.1.1.2.cmml" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.2">
               𝑡
              </ci>
              <ci id="S3.I1.i1.p1.8.m8.4.4.1.1.1.3.cmml" xref="S3.I1.i1.p1.8.m8.4.4.1.1.1.3">
               𝑏
              </ci>
             </apply>
             <ci id="S3.I1.i1.p1.8.m8.1.1.cmml" xref="S3.I1.i1.p1.8.m8.1.1">
              𝑞
             </ci>
             <ci id="S3.I1.i1.p1.8.m8.2.2.cmml" xref="S3.I1.i1.p1.8.m8.2.2">
              ℎ
             </ci>
             <apply id="S3.I1.i1.p1.8.m8.5.5.2.2.2.cmml" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2">
              <csymbol cd="ambiguous" id="S3.I1.i1.p1.8.m8.5.5.2.2.2.1.cmml" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2">
               subscript
              </csymbol>
              <ci id="S3.I1.i1.p1.8.m8.5.5.2.2.2.2.cmml" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2.2">
               𝑣
              </ci>
              <ci id="S3.I1.i1.p1.8.m8.5.5.2.2.2.3.cmml" xref="S3.I1.i1.p1.8.m8.5.5.2.2.2.3">
               𝑐
              </ci>
             </apply>
             <apply id="S3.I1.i1.p1.8.m8.6.6.3.3.3.cmml" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3">
              <times id="S3.I1.i1.p1.8.m8.6.6.3.3.3.1.cmml" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.1">
              </times>
              <ci id="S3.I1.i1.p1.8.m8.6.6.3.3.3.2.cmml" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.2">
               𝑝
              </ci>
              <ci id="S3.I1.i1.p1.8.m8.6.6.3.3.3.3.cmml" xref="S3.I1.i1.p1.8.m8.6.6.3.3.3.3">
               ℎ
              </ci>
             </apply>
             <ci id="S3.I1.i1.p1.8.m8.3.3.cmml" xref="S3.I1.i1.p1.8.m8.3.3">
              𝑡
             </ci>
            </vector>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.8.m8.6c">
           S=(tb,q,h,v_{c},ph,t)
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i2.p1">
       <p class="ltx_p" id="S3.I1.i2.p1.1">
        Observation. The complete state of the environment can be observed. Formally, the observation function
        <math alttext="O=S" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1">
         <semantics id="S3.I1.i2.p1.1.m1.1a">
          <mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">
           <mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">
            O
           </mi>
           <mo id="S3.I1.i2.p1.1.m1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.cmml">
            =
           </mo>
           <mi id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">
            S
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b">
           <apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">
            <eq id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1">
            </eq>
            <ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">
             𝑂
            </ci>
            <ci id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">
             𝑆
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">
           O=S
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i3.p1">
       <p class="ltx_p" id="S3.I1.i3.p1.3">
        Action. The set of possible actions
        <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1">
         <semantics id="S3.I1.i3.p1.1.m1.1a">
          <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">
           𝒜
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b">
           <ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">
            𝒜
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">
           \mathcal{A}
          </annotation>
         </semantics>
        </math>
        from a state
        <math alttext="S" class="ltx_Math" display="inline" id="S3.I1.i3.p1.2.m2.1">
         <semantics id="S3.I1.i3.p1.2.m2.1a">
          <mi id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml">
           S
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b">
           <ci id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">
            𝑆
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">
           S
          </annotation>
         </semantics>
        </math>
        consists of all the environment information. Formally
        <math alttext="\mathcal{A}_{s}=\{e\in E\colon S\}\cup\{(s,\varnothing,s)\}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.3.m3.6">
         <semantics id="S3.I1.i3.p1.3.m3.6a">
          <mrow id="S3.I1.i3.p1.3.m3.6.6" xref="S3.I1.i3.p1.3.m3.6.6.cmml">
           <msub id="S3.I1.i3.p1.3.m3.6.6.4" xref="S3.I1.i3.p1.3.m3.6.6.4.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.3.m3.6.6.4.2" xref="S3.I1.i3.p1.3.m3.6.6.4.2.cmml">
             𝒜
            </mi>
            <mi id="S3.I1.i3.p1.3.m3.6.6.4.3" xref="S3.I1.i3.p1.3.m3.6.6.4.3.cmml">
             s
            </mi>
           </msub>
           <mo id="S3.I1.i3.p1.3.m3.6.6.3" xref="S3.I1.i3.p1.3.m3.6.6.3.cmml">
            =
           </mo>
           <mrow id="S3.I1.i3.p1.3.m3.6.6.2" xref="S3.I1.i3.p1.3.m3.6.6.2.cmml">
            <mrow id="S3.I1.i3.p1.3.m3.5.5.1.1.1" xref="S3.I1.i3.p1.3.m3.5.5.1.1.2.cmml">
             <mo id="S3.I1.i3.p1.3.m3.5.5.1.1.1.2" stretchy="false" xref="S3.I1.i3.p1.3.m3.5.5.1.1.2.1.cmml">
              {
             </mo>
             <mrow id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.cmml">
              <mi id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.2" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.2.cmml">
               e
              </mi>
              <mo id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.1" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.1.cmml">
               ∈
              </mo>
              <mi id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.3" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.3.cmml">
               E
              </mi>
             </mrow>
             <mo id="S3.I1.i3.p1.3.m3.5.5.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S3.I1.i3.p1.3.m3.5.5.1.1.2.1.cmml">
              :
             </mo>
             <mi id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml">
              S
             </mi>
             <mo id="S3.I1.i3.p1.3.m3.5.5.1.1.1.4" stretchy="false" xref="S3.I1.i3.p1.3.m3.5.5.1.1.2.1.cmml">
              }
             </mo>
            </mrow>
            <mo id="S3.I1.i3.p1.3.m3.6.6.2.3" xref="S3.I1.i3.p1.3.m3.6.6.2.3.cmml">
             ∪
            </mo>
            <mrow id="S3.I1.i3.p1.3.m3.6.6.2.2.1" xref="S3.I1.i3.p1.3.m3.6.6.2.2.2.cmml">
             <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.2" stretchy="false" xref="S3.I1.i3.p1.3.m3.6.6.2.2.2.cmml">
              {
             </mo>
             <mrow id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml">
              <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2.1" stretchy="false" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml">
               (
              </mo>
              <mi id="S3.I1.i3.p1.3.m3.2.2" xref="S3.I1.i3.p1.3.m3.2.2.cmml">
               s
              </mi>
              <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2.2" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml">
               ,
              </mo>
              <mi id="S3.I1.i3.p1.3.m3.3.3" mathvariant="normal" xref="S3.I1.i3.p1.3.m3.3.3.cmml">
               ∅
              </mi>
              <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2.3" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml">
               ,
              </mo>
              <mi id="S3.I1.i3.p1.3.m3.4.4" xref="S3.I1.i3.p1.3.m3.4.4.cmml">
               s
              </mi>
              <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2.4" stretchy="false" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml">
               )
              </mo>
             </mrow>
             <mo id="S3.I1.i3.p1.3.m3.6.6.2.2.1.3" stretchy="false" xref="S3.I1.i3.p1.3.m3.6.6.2.2.2.cmml">
              }
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.6b">
           <apply id="S3.I1.i3.p1.3.m3.6.6.cmml" xref="S3.I1.i3.p1.3.m3.6.6">
            <eq id="S3.I1.i3.p1.3.m3.6.6.3.cmml" xref="S3.I1.i3.p1.3.m3.6.6.3">
            </eq>
            <apply id="S3.I1.i3.p1.3.m3.6.6.4.cmml" xref="S3.I1.i3.p1.3.m3.6.6.4">
             <csymbol cd="ambiguous" id="S3.I1.i3.p1.3.m3.6.6.4.1.cmml" xref="S3.I1.i3.p1.3.m3.6.6.4">
              subscript
             </csymbol>
             <ci id="S3.I1.i3.p1.3.m3.6.6.4.2.cmml" xref="S3.I1.i3.p1.3.m3.6.6.4.2">
              𝒜
             </ci>
             <ci id="S3.I1.i3.p1.3.m3.6.6.4.3.cmml" xref="S3.I1.i3.p1.3.m3.6.6.4.3">
              𝑠
             </ci>
            </apply>
            <apply id="S3.I1.i3.p1.3.m3.6.6.2.cmml" xref="S3.I1.i3.p1.3.m3.6.6.2">
             <union id="S3.I1.i3.p1.3.m3.6.6.2.3.cmml" xref="S3.I1.i3.p1.3.m3.6.6.2.3">
             </union>
             <apply id="S3.I1.i3.p1.3.m3.5.5.1.1.2.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1">
              <csymbol cd="latexml" id="S3.I1.i3.p1.3.m3.5.5.1.1.2.1.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.2">
               conditional-set
              </csymbol>
              <apply id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1">
               <in id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.1">
               </in>
               <ci id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.2">
                𝑒
               </ci>
               <ci id="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.3.cmml" xref="S3.I1.i3.p1.3.m3.5.5.1.1.1.1.3">
                𝐸
               </ci>
              </apply>
              <ci id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">
               𝑆
              </ci>
             </apply>
             <set id="S3.I1.i3.p1.3.m3.6.6.2.2.2.cmml" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1">
              <vector id="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.1.cmml" xref="S3.I1.i3.p1.3.m3.6.6.2.2.1.1.2">
               <ci id="S3.I1.i3.p1.3.m3.2.2.cmml" xref="S3.I1.i3.p1.3.m3.2.2">
                𝑠
               </ci>
               <emptyset id="S3.I1.i3.p1.3.m3.3.3.cmml" xref="S3.I1.i3.p1.3.m3.3.3">
               </emptyset>
               <ci id="S3.I1.i3.p1.3.m3.4.4.cmml" xref="S3.I1.i3.p1.3.m3.4.4">
                𝑠
               </ci>
              </vector>
             </set>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.6c">
           \mathcal{A}_{s}=\{e\in E\colon S\}\cup\{(s,\varnothing,s)\}
          </annotation>
         </semantics>
        </math>
        . This means that each state’s agent can choose one of all output edges of the current entity.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i4.p1">
       <p class="ltx_p" id="S3.I1.i4.p1.5">
        Transition. Depending on the edge selected by the agent at time step
        <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.i4.p1.1.m1.1">
         <semantics id="S3.I1.i4.p1.1.m1.1a">
          <mi id="S3.I1.i4.p1.1.m1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.cmml">
           t
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.1.m1.1b">
           <ci id="S3.I1.i4.p1.1.m1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1">
            𝑡
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i4.p1.1.m1.1c">
           t
          </annotation>
         </semantics>
        </math>
        , the environment is changed deterministically by updating the state to the new environment. For single turn dialogue, we update current entity, path history and step.
Formally, the transition function
        <math alttext="\colon\mathcal{\delta\colon S\times A\rightarrow S}" class="ltx_math_unparsed" display="inline" id="S3.I1.i4.p1.2.m2.1">
         <semantics id="S3.I1.i4.p1.2.m2.1a">
          <mrow id="S3.I1.i4.p1.2.m2.1b">
           <mo id="S3.I1.i4.p1.2.m2.1.1" rspace="0.278em">
            :
           </mo>
           <mi id="S3.I1.i4.p1.2.m2.1.2">
            δ
           </mi>
           <mo id="S3.I1.i4.p1.2.m2.1.3" lspace="0.278em" rspace="0.278em">
            :
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i4.p1.2.m2.1.4">
            𝒮
           </mi>
           <mo id="S3.I1.i4.p1.2.m2.1.5" lspace="0.222em" rspace="0.222em">
            ×
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i4.p1.2.m2.1.6">
            𝒜
           </mi>
           <mo id="S3.I1.i4.p1.2.m2.1.7" stretchy="false">
            →
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i4.p1.2.m2.1.8">
            𝒮
           </mi>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.I1.i4.p1.2.m2.1c">
           \colon\mathcal{\delta\colon S\times A\rightarrow S}
          </annotation>
         </semantics>
        </math>
        is defined by
        <math alttext="\mathcal{\delta}(S,A)=(tb,q,h,v_{c}^{{}^{\prime}},ph^{{}^{\prime}},t^{{}^{\prime}})" class="ltx_Math" display="inline" id="S3.I1.i4.p1.3.m3.8">
         <semantics id="S3.I1.i4.p1.3.m3.8a">
          <mrow id="S3.I1.i4.p1.3.m3.8.8" xref="S3.I1.i4.p1.3.m3.8.8.cmml">
           <mrow id="S3.I1.i4.p1.3.m3.8.8.6" xref="S3.I1.i4.p1.3.m3.8.8.6.cmml">
            <mi id="S3.I1.i4.p1.3.m3.8.8.6.2" xref="S3.I1.i4.p1.3.m3.8.8.6.2.cmml">
             δ
            </mi>
            <mo id="S3.I1.i4.p1.3.m3.8.8.6.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.3.m3.8.8.6.1.cmml">
             ​
            </mo>
            <mrow id="S3.I1.i4.p1.3.m3.8.8.6.3.2" xref="S3.I1.i4.p1.3.m3.8.8.6.3.1.cmml">
             <mo id="S3.I1.i4.p1.3.m3.8.8.6.3.2.1" stretchy="false" xref="S3.I1.i4.p1.3.m3.8.8.6.3.1.cmml">
              (
             </mo>
             <mi id="S3.I1.i4.p1.3.m3.1.1" xref="S3.I1.i4.p1.3.m3.1.1.cmml">
              S
             </mi>
             <mo id="S3.I1.i4.p1.3.m3.8.8.6.3.2.2" xref="S3.I1.i4.p1.3.m3.8.8.6.3.1.cmml">
              ,
             </mo>
             <mi id="S3.I1.i4.p1.3.m3.2.2" xref="S3.I1.i4.p1.3.m3.2.2.cmml">
              A
             </mi>
             <mo id="S3.I1.i4.p1.3.m3.8.8.6.3.2.3" stretchy="false" xref="S3.I1.i4.p1.3.m3.8.8.6.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.I1.i4.p1.3.m3.8.8.5" xref="S3.I1.i4.p1.3.m3.8.8.5.cmml">
            =
           </mo>
           <mrow id="S3.I1.i4.p1.3.m3.8.8.4.4" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.5" stretchy="false" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             (
            </mo>
            <mrow id="S3.I1.i4.p1.3.m3.5.5.1.1.1" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.cmml">
             <mi id="S3.I1.i4.p1.3.m3.5.5.1.1.1.2" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.2.cmml">
              t
             </mi>
             <mo id="S3.I1.i4.p1.3.m3.5.5.1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i4.p1.3.m3.5.5.1.1.1.3" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.3.cmml">
              b
             </mi>
            </mrow>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.6" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             ,
            </mo>
            <mi id="S3.I1.i4.p1.3.m3.3.3" xref="S3.I1.i4.p1.3.m3.3.3.cmml">
             q
            </mi>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.7" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             ,
            </mo>
            <mi id="S3.I1.i4.p1.3.m3.4.4" xref="S3.I1.i4.p1.3.m3.4.4.cmml">
             h
            </mi>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.8" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             ,
            </mo>
            <msubsup id="S3.I1.i4.p1.3.m3.6.6.2.2.2" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.cmml">
             <mi id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.2" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.2.cmml">
              v
             </mi>
             <mi id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.3" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.3.cmml">
              c
             </mi>
             <msup id="S3.I1.i4.p1.3.m3.6.6.2.2.2.3" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.cmml">
              <mi id="S3.I1.i4.p1.3.m3.6.6.2.2.2.3a" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.1" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.1.cmml">
               ′
              </mo>
             </msup>
            </msubsup>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.9" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             ,
            </mo>
            <mrow id="S3.I1.i4.p1.3.m3.7.7.3.3.3" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.cmml">
             <mi id="S3.I1.i4.p1.3.m3.7.7.3.3.3.2" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.2.cmml">
              p
             </mi>
             <mo id="S3.I1.i4.p1.3.m3.7.7.3.3.3.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.1.cmml">
              ​
             </mo>
             <msup id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.cmml">
              <mi id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.2" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.2.cmml">
               h
              </mi>
              <msup id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.cmml">
               <mi id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3a" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.cmml">
               </mi>
               <mo id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.1" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.1.cmml">
                ′
               </mo>
              </msup>
             </msup>
            </mrow>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.10" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             ,
            </mo>
            <msup id="S3.I1.i4.p1.3.m3.8.8.4.4.4" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.cmml">
             <mi id="S3.I1.i4.p1.3.m3.8.8.4.4.4.2" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.2.cmml">
              t
             </mi>
             <msup id="S3.I1.i4.p1.3.m3.8.8.4.4.4.3" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.cmml">
              <mi id="S3.I1.i4.p1.3.m3.8.8.4.4.4.3a" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.1" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i4.p1.3.m3.8.8.4.4.11" stretchy="false" xref="S3.I1.i4.p1.3.m3.8.8.4.5.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.3.m3.8b">
           <apply id="S3.I1.i4.p1.3.m3.8.8.cmml" xref="S3.I1.i4.p1.3.m3.8.8">
            <eq id="S3.I1.i4.p1.3.m3.8.8.5.cmml" xref="S3.I1.i4.p1.3.m3.8.8.5">
            </eq>
            <apply id="S3.I1.i4.p1.3.m3.8.8.6.cmml" xref="S3.I1.i4.p1.3.m3.8.8.6">
             <times id="S3.I1.i4.p1.3.m3.8.8.6.1.cmml" xref="S3.I1.i4.p1.3.m3.8.8.6.1">
             </times>
             <ci id="S3.I1.i4.p1.3.m3.8.8.6.2.cmml" xref="S3.I1.i4.p1.3.m3.8.8.6.2">
              𝛿
             </ci>
             <interval closure="open" id="S3.I1.i4.p1.3.m3.8.8.6.3.1.cmml" xref="S3.I1.i4.p1.3.m3.8.8.6.3.2">
              <ci id="S3.I1.i4.p1.3.m3.1.1.cmml" xref="S3.I1.i4.p1.3.m3.1.1">
               𝑆
              </ci>
              <ci id="S3.I1.i4.p1.3.m3.2.2.cmml" xref="S3.I1.i4.p1.3.m3.2.2">
               𝐴
              </ci>
             </interval>
            </apply>
            <vector id="S3.I1.i4.p1.3.m3.8.8.4.5.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4">
             <apply id="S3.I1.i4.p1.3.m3.5.5.1.1.1.cmml" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1">
              <times id="S3.I1.i4.p1.3.m3.5.5.1.1.1.1.cmml" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.1">
              </times>
              <ci id="S3.I1.i4.p1.3.m3.5.5.1.1.1.2.cmml" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.2">
               𝑡
              </ci>
              <ci id="S3.I1.i4.p1.3.m3.5.5.1.1.1.3.cmml" xref="S3.I1.i4.p1.3.m3.5.5.1.1.1.3">
               𝑏
              </ci>
             </apply>
             <ci id="S3.I1.i4.p1.3.m3.3.3.cmml" xref="S3.I1.i4.p1.3.m3.3.3">
              𝑞
             </ci>
             <ci id="S3.I1.i4.p1.3.m3.4.4.cmml" xref="S3.I1.i4.p1.3.m3.4.4">
              ℎ
             </ci>
             <apply id="S3.I1.i4.p1.3.m3.6.6.2.2.2.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.3.m3.6.6.2.2.2.1.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2">
               superscript
              </csymbol>
              <apply id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2">
               <csymbol cd="ambiguous" id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.1.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2">
                subscript
               </csymbol>
               <ci id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.2.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.2">
                𝑣
               </ci>
               <ci id="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.3.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.2.3">
                𝑐
               </ci>
              </apply>
              <apply id="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.3">
               <ci id="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.1.cmml" xref="S3.I1.i4.p1.3.m3.6.6.2.2.2.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.3.m3.7.7.3.3.3.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3">
              <times id="S3.I1.i4.p1.3.m3.7.7.3.3.3.1.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.1">
              </times>
              <ci id="S3.I1.i4.p1.3.m3.7.7.3.3.3.2.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.2">
               𝑝
              </ci>
              <apply id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3">
               <csymbol cd="ambiguous" id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.1.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3">
                superscript
               </csymbol>
               <ci id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.2.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.2">
                ℎ
               </ci>
               <apply id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3">
                <ci id="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.1.cmml" xref="S3.I1.i4.p1.3.m3.7.7.3.3.3.3.3.1">
                 ′
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.3.m3.8.8.4.4.4.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.3.m3.8.8.4.4.4.1.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4">
               superscript
              </csymbol>
              <ci id="S3.I1.i4.p1.3.m3.8.8.4.4.4.2.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.2">
               𝑡
              </ci>
              <apply id="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.3">
               <ci id="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.1.cmml" xref="S3.I1.i4.p1.3.m3.8.8.4.4.4.3.1">
                ′
               </ci>
              </apply>
             </apply>
            </vector>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i4.p1.3.m3.8c">
           \mathcal{\delta}(S,A)=(tb,q,h,v_{c}^{{}^{\prime}},ph^{{}^{\prime}},t^{{}^{\prime}})
          </annotation>
         </semantics>
        </math>
        ,
For multi-turn dialogue wo also need to update user query and dialogue history.
        <math alttext="\mathcal{\delta}(S,A)=(tb,q^{{}^{\prime}},h^{{}^{\prime}},v_{c}^{{}^{\prime}},ph^{{}^{\prime}},t^{{}^{\prime}})" class="ltx_Math" display="inline" id="S3.I1.i4.p1.4.m4.8">
         <semantics id="S3.I1.i4.p1.4.m4.8a">
          <mrow id="S3.I1.i4.p1.4.m4.8.8" xref="S3.I1.i4.p1.4.m4.8.8.cmml">
           <mrow id="S3.I1.i4.p1.4.m4.8.8.8" xref="S3.I1.i4.p1.4.m4.8.8.8.cmml">
            <mi id="S3.I1.i4.p1.4.m4.8.8.8.2" xref="S3.I1.i4.p1.4.m4.8.8.8.2.cmml">
             δ
            </mi>
            <mo id="S3.I1.i4.p1.4.m4.8.8.8.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.4.m4.8.8.8.1.cmml">
             ​
            </mo>
            <mrow id="S3.I1.i4.p1.4.m4.8.8.8.3.2" xref="S3.I1.i4.p1.4.m4.8.8.8.3.1.cmml">
             <mo id="S3.I1.i4.p1.4.m4.8.8.8.3.2.1" stretchy="false" xref="S3.I1.i4.p1.4.m4.8.8.8.3.1.cmml">
              (
             </mo>
             <mi id="S3.I1.i4.p1.4.m4.1.1" xref="S3.I1.i4.p1.4.m4.1.1.cmml">
              S
             </mi>
             <mo id="S3.I1.i4.p1.4.m4.8.8.8.3.2.2" xref="S3.I1.i4.p1.4.m4.8.8.8.3.1.cmml">
              ,
             </mo>
             <mi id="S3.I1.i4.p1.4.m4.2.2" xref="S3.I1.i4.p1.4.m4.2.2.cmml">
              A
             </mi>
             <mo id="S3.I1.i4.p1.4.m4.8.8.8.3.2.3" stretchy="false" xref="S3.I1.i4.p1.4.m4.8.8.8.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.I1.i4.p1.4.m4.8.8.7" xref="S3.I1.i4.p1.4.m4.8.8.7.cmml">
            =
           </mo>
           <mrow id="S3.I1.i4.p1.4.m4.8.8.6.6" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.7" stretchy="false" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             (
            </mo>
            <mrow id="S3.I1.i4.p1.4.m4.3.3.1.1.1" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.cmml">
             <mi id="S3.I1.i4.p1.4.m4.3.3.1.1.1.2" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.2.cmml">
              t
             </mi>
             <mo id="S3.I1.i4.p1.4.m4.3.3.1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i4.p1.4.m4.3.3.1.1.1.3" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.3.cmml">
              b
             </mi>
            </mrow>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.8" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i4.p1.4.m4.4.4.2.2.2" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.cmml">
             <mi id="S3.I1.i4.p1.4.m4.4.4.2.2.2.2" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.2.cmml">
              q
             </mi>
             <msup id="S3.I1.i4.p1.4.m4.4.4.2.2.2.3" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.cmml">
              <mi id="S3.I1.i4.p1.4.m4.4.4.2.2.2.3a" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.1" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.9" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i4.p1.4.m4.5.5.3.3.3" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.cmml">
             <mi id="S3.I1.i4.p1.4.m4.5.5.3.3.3.2" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.2.cmml">
              h
             </mi>
             <msup id="S3.I1.i4.p1.4.m4.5.5.3.3.3.3" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.cmml">
              <mi id="S3.I1.i4.p1.4.m4.5.5.3.3.3.3a" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.1" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.10" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             ,
            </mo>
            <msubsup id="S3.I1.i4.p1.4.m4.6.6.4.4.4" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.cmml">
             <mi id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.2" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.2.cmml">
              v
             </mi>
             <mi id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.3" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.3.cmml">
              c
             </mi>
             <msup id="S3.I1.i4.p1.4.m4.6.6.4.4.4.3" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.cmml">
              <mi id="S3.I1.i4.p1.4.m4.6.6.4.4.4.3a" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.1" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.1.cmml">
               ′
              </mo>
             </msup>
            </msubsup>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.11" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             ,
            </mo>
            <mrow id="S3.I1.i4.p1.4.m4.7.7.5.5.5" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.cmml">
             <mi id="S3.I1.i4.p1.4.m4.7.7.5.5.5.2" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.2.cmml">
              p
             </mi>
             <mo id="S3.I1.i4.p1.4.m4.7.7.5.5.5.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.1.cmml">
              ​
             </mo>
             <msup id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.cmml">
              <mi id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.2" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.2.cmml">
               h
              </mi>
              <msup id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.cmml">
               <mi id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3a" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.cmml">
               </mi>
               <mo id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.1" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.1.cmml">
                ′
               </mo>
              </msup>
             </msup>
            </mrow>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.12" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i4.p1.4.m4.8.8.6.6.6" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.cmml">
             <mi id="S3.I1.i4.p1.4.m4.8.8.6.6.6.2" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.2.cmml">
              t
             </mi>
             <msup id="S3.I1.i4.p1.4.m4.8.8.6.6.6.3" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.cmml">
              <mi id="S3.I1.i4.p1.4.m4.8.8.6.6.6.3a" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.cmml">
              </mi>
              <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.1" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i4.p1.4.m4.8.8.6.6.13" stretchy="false" xref="S3.I1.i4.p1.4.m4.8.8.6.7.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.4.m4.8b">
           <apply id="S3.I1.i4.p1.4.m4.8.8.cmml" xref="S3.I1.i4.p1.4.m4.8.8">
            <eq id="S3.I1.i4.p1.4.m4.8.8.7.cmml" xref="S3.I1.i4.p1.4.m4.8.8.7">
            </eq>
            <apply id="S3.I1.i4.p1.4.m4.8.8.8.cmml" xref="S3.I1.i4.p1.4.m4.8.8.8">
             <times id="S3.I1.i4.p1.4.m4.8.8.8.1.cmml" xref="S3.I1.i4.p1.4.m4.8.8.8.1">
             </times>
             <ci id="S3.I1.i4.p1.4.m4.8.8.8.2.cmml" xref="S3.I1.i4.p1.4.m4.8.8.8.2">
              𝛿
             </ci>
             <interval closure="open" id="S3.I1.i4.p1.4.m4.8.8.8.3.1.cmml" xref="S3.I1.i4.p1.4.m4.8.8.8.3.2">
              <ci id="S3.I1.i4.p1.4.m4.1.1.cmml" xref="S3.I1.i4.p1.4.m4.1.1">
               𝑆
              </ci>
              <ci id="S3.I1.i4.p1.4.m4.2.2.cmml" xref="S3.I1.i4.p1.4.m4.2.2">
               𝐴
              </ci>
             </interval>
            </apply>
            <vector id="S3.I1.i4.p1.4.m4.8.8.6.7.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6">
             <apply id="S3.I1.i4.p1.4.m4.3.3.1.1.1.cmml" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1">
              <times id="S3.I1.i4.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.1">
              </times>
              <ci id="S3.I1.i4.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.2">
               𝑡
              </ci>
              <ci id="S3.I1.i4.p1.4.m4.3.3.1.1.1.3.cmml" xref="S3.I1.i4.p1.4.m4.3.3.1.1.1.3">
               𝑏
              </ci>
             </apply>
             <apply id="S3.I1.i4.p1.4.m4.4.4.2.2.2.cmml" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.4.4.2.2.2.1.cmml" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2">
               superscript
              </csymbol>
              <ci id="S3.I1.i4.p1.4.m4.4.4.2.2.2.2.cmml" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.2">
               𝑞
              </ci>
              <apply id="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.cmml" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.3">
               <ci id="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.1.cmml" xref="S3.I1.i4.p1.4.m4.4.4.2.2.2.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.4.m4.5.5.3.3.3.cmml" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.5.5.3.3.3.1.cmml" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3">
               superscript
              </csymbol>
              <ci id="S3.I1.i4.p1.4.m4.5.5.3.3.3.2.cmml" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.2">
               ℎ
              </ci>
              <apply id="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.cmml" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.3">
               <ci id="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.1.cmml" xref="S3.I1.i4.p1.4.m4.5.5.3.3.3.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.4.m4.6.6.4.4.4.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.6.6.4.4.4.1.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4">
               superscript
              </csymbol>
              <apply id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4">
               <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.1.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4">
                subscript
               </csymbol>
               <ci id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.2.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.2">
                𝑣
               </ci>
               <ci id="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.3.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.2.3">
                𝑐
               </ci>
              </apply>
              <apply id="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.3">
               <ci id="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.1.cmml" xref="S3.I1.i4.p1.4.m4.6.6.4.4.4.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.4.m4.7.7.5.5.5.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5">
              <times id="S3.I1.i4.p1.4.m4.7.7.5.5.5.1.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.1">
              </times>
              <ci id="S3.I1.i4.p1.4.m4.7.7.5.5.5.2.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.2">
               𝑝
              </ci>
              <apply id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3">
               <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.1.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3">
                superscript
               </csymbol>
               <ci id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.2.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.2">
                ℎ
               </ci>
               <apply id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3">
                <ci id="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.1.cmml" xref="S3.I1.i4.p1.4.m4.7.7.5.5.5.3.3.1">
                 ′
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S3.I1.i4.p1.4.m4.8.8.6.6.6.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.4.m4.8.8.6.6.6.1.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6">
               superscript
              </csymbol>
              <ci id="S3.I1.i4.p1.4.m4.8.8.6.6.6.2.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.2">
               𝑡
              </ci>
              <apply id="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.3">
               <ci id="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.1.cmml" xref="S3.I1.i4.p1.4.m4.8.8.6.6.6.3.1">
                ′
               </ci>
              </apply>
             </apply>
            </vector>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i4.p1.4.m4.8c">
           \mathcal{\delta}(S,A)=(tb,q^{{}^{\prime}},h^{{}^{\prime}},v_{c}^{{}^{\prime}},ph^{{}^{\prime}},t^{{}^{\prime}})
          </annotation>
         </semantics>
        </math>
        ,
where
        <math alttext="S=(tb,q,h,v_{c},ph,t)" class="ltx_Math" display="inline" id="S3.I1.i4.p1.5.m5.6">
         <semantics id="S3.I1.i4.p1.5.m5.6a">
          <mrow id="S3.I1.i4.p1.5.m5.6.6" xref="S3.I1.i4.p1.5.m5.6.6.cmml">
           <mi id="S3.I1.i4.p1.5.m5.6.6.5" xref="S3.I1.i4.p1.5.m5.6.6.5.cmml">
            S
           </mi>
           <mo id="S3.I1.i4.p1.5.m5.6.6.4" xref="S3.I1.i4.p1.5.m5.6.6.4.cmml">
            =
           </mo>
           <mrow id="S3.I1.i4.p1.5.m5.6.6.3.3" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.4" stretchy="false" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             (
            </mo>
            <mrow id="S3.I1.i4.p1.5.m5.4.4.1.1.1" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.cmml">
             <mi id="S3.I1.i4.p1.5.m5.4.4.1.1.1.2" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.2.cmml">
              t
             </mi>
             <mo id="S3.I1.i4.p1.5.m5.4.4.1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i4.p1.5.m5.4.4.1.1.1.3" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.3.cmml">
              b
             </mi>
            </mrow>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.5" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i4.p1.5.m5.1.1" xref="S3.I1.i4.p1.5.m5.1.1.cmml">
             q
            </mi>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.6" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i4.p1.5.m5.2.2" xref="S3.I1.i4.p1.5.m5.2.2.cmml">
             h
            </mi>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.7" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             ,
            </mo>
            <msub id="S3.I1.i4.p1.5.m5.5.5.2.2.2" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2.cmml">
             <mi id="S3.I1.i4.p1.5.m5.5.5.2.2.2.2" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2.2.cmml">
              v
             </mi>
             <mi id="S3.I1.i4.p1.5.m5.5.5.2.2.2.3" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2.3.cmml">
              c
             </mi>
            </msub>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.8" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             ,
            </mo>
            <mrow id="S3.I1.i4.p1.5.m5.6.6.3.3.3" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.cmml">
             <mi id="S3.I1.i4.p1.5.m5.6.6.3.3.3.2" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.2.cmml">
              p
             </mi>
             <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.3.1" lspace="0em" rspace="0em" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i4.p1.5.m5.6.6.3.3.3.3" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.3.cmml">
              h
             </mi>
            </mrow>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.9" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             ,
            </mo>
            <mi id="S3.I1.i4.p1.5.m5.3.3" xref="S3.I1.i4.p1.5.m5.3.3.cmml">
             t
            </mi>
            <mo id="S3.I1.i4.p1.5.m5.6.6.3.3.10" stretchy="false" xref="S3.I1.i4.p1.5.m5.6.6.3.4.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.5.m5.6b">
           <apply id="S3.I1.i4.p1.5.m5.6.6.cmml" xref="S3.I1.i4.p1.5.m5.6.6">
            <eq id="S3.I1.i4.p1.5.m5.6.6.4.cmml" xref="S3.I1.i4.p1.5.m5.6.6.4">
            </eq>
            <ci id="S3.I1.i4.p1.5.m5.6.6.5.cmml" xref="S3.I1.i4.p1.5.m5.6.6.5">
             𝑆
            </ci>
            <vector id="S3.I1.i4.p1.5.m5.6.6.3.4.cmml" xref="S3.I1.i4.p1.5.m5.6.6.3.3">
             <apply id="S3.I1.i4.p1.5.m5.4.4.1.1.1.cmml" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1">
              <times id="S3.I1.i4.p1.5.m5.4.4.1.1.1.1.cmml" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.1">
              </times>
              <ci id="S3.I1.i4.p1.5.m5.4.4.1.1.1.2.cmml" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.2">
               𝑡
              </ci>
              <ci id="S3.I1.i4.p1.5.m5.4.4.1.1.1.3.cmml" xref="S3.I1.i4.p1.5.m5.4.4.1.1.1.3">
               𝑏
              </ci>
             </apply>
             <ci id="S3.I1.i4.p1.5.m5.1.1.cmml" xref="S3.I1.i4.p1.5.m5.1.1">
              𝑞
             </ci>
             <ci id="S3.I1.i4.p1.5.m5.2.2.cmml" xref="S3.I1.i4.p1.5.m5.2.2">
              ℎ
             </ci>
             <apply id="S3.I1.i4.p1.5.m5.5.5.2.2.2.cmml" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2">
              <csymbol cd="ambiguous" id="S3.I1.i4.p1.5.m5.5.5.2.2.2.1.cmml" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2">
               subscript
              </csymbol>
              <ci id="S3.I1.i4.p1.5.m5.5.5.2.2.2.2.cmml" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2.2">
               𝑣
              </ci>
              <ci id="S3.I1.i4.p1.5.m5.5.5.2.2.2.3.cmml" xref="S3.I1.i4.p1.5.m5.5.5.2.2.2.3">
               𝑐
              </ci>
             </apply>
             <apply id="S3.I1.i4.p1.5.m5.6.6.3.3.3.cmml" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3">
              <times id="S3.I1.i4.p1.5.m5.6.6.3.3.3.1.cmml" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.1">
              </times>
              <ci id="S3.I1.i4.p1.5.m5.6.6.3.3.3.2.cmml" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.2">
               𝑝
              </ci>
              <ci id="S3.I1.i4.p1.5.m5.6.6.3.3.3.3.cmml" xref="S3.I1.i4.p1.5.m5.6.6.3.3.3.3">
               ℎ
              </ci>
             </apply>
             <ci id="S3.I1.i4.p1.5.m5.3.3.cmml" xref="S3.I1.i4.p1.5.m5.3.3">
              𝑡
             </ci>
            </vector>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i4.p1.5.m5.6c">
           S=(tb,q,h,v_{c},ph,t)
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i5.p1">
       <p class="ltx_p" id="S3.I1.i5.p1.3">
        Reward. We have a final reward of +1 if the current entity is the target entity
        <math alttext="v_{g}" class="ltx_Math" display="inline" id="S3.I1.i5.p1.1.m1.1">
         <semantics id="S3.I1.i5.p1.1.m1.1a">
          <msub id="S3.I1.i5.p1.1.m1.1.1" xref="S3.I1.i5.p1.1.m1.1.1.cmml">
           <mi id="S3.I1.i5.p1.1.m1.1.1.2" xref="S3.I1.i5.p1.1.m1.1.1.2.cmml">
            v
           </mi>
           <mi id="S3.I1.i5.p1.1.m1.1.1.3" xref="S3.I1.i5.p1.1.m1.1.1.3.cmml">
            g
           </mi>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.1.m1.1b">
           <apply id="S3.I1.i5.p1.1.m1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S3.I1.i5.p1.1.m1.1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="S3.I1.i5.p1.1.m1.1.1.2.cmml" xref="S3.I1.i5.p1.1.m1.1.1.2">
             𝑣
            </ci>
            <ci id="S3.I1.i5.p1.1.m1.1.1.3.cmml" xref="S3.I1.i5.p1.1.m1.1.1.3">
             𝑔
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i5.p1.1.m1.1c">
           v_{g}
          </annotation>
         </semantics>
        </math>
        and -1 otherwise. if
        <math alttext="S_{t}=(tb,q^{{}^{\prime}},h^{{}^{\prime}},v_{c}^{{}^{\prime}},ph^{{}^{\prime}},k^{{}^{\prime}})" class="ltx_Math" display="inline" id="S3.I1.i5.p1.2.m2.6">
         <semantics id="S3.I1.i5.p1.2.m2.6a">
          <mrow id="S3.I1.i5.p1.2.m2.6.6" xref="S3.I1.i5.p1.2.m2.6.6.cmml">
           <msub id="S3.I1.i5.p1.2.m2.6.6.8" xref="S3.I1.i5.p1.2.m2.6.6.8.cmml">
            <mi id="S3.I1.i5.p1.2.m2.6.6.8.2" xref="S3.I1.i5.p1.2.m2.6.6.8.2.cmml">
             S
            </mi>
            <mi id="S3.I1.i5.p1.2.m2.6.6.8.3" xref="S3.I1.i5.p1.2.m2.6.6.8.3.cmml">
             t
            </mi>
           </msub>
           <mo id="S3.I1.i5.p1.2.m2.6.6.7" xref="S3.I1.i5.p1.2.m2.6.6.7.cmml">
            =
           </mo>
           <mrow id="S3.I1.i5.p1.2.m2.6.6.6.6" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.7" stretchy="false" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             (
            </mo>
            <mrow id="S3.I1.i5.p1.2.m2.1.1.1.1.1" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.cmml">
             <mi id="S3.I1.i5.p1.2.m2.1.1.1.1.1.2" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.2.cmml">
              t
             </mi>
             <mo id="S3.I1.i5.p1.2.m2.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml">
              ​
             </mo>
             <mi id="S3.I1.i5.p1.2.m2.1.1.1.1.1.3" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.3.cmml">
              b
             </mi>
            </mrow>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.8" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i5.p1.2.m2.2.2.2.2.2" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.cmml">
             <mi id="S3.I1.i5.p1.2.m2.2.2.2.2.2.2" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.2.cmml">
              q
             </mi>
             <msup id="S3.I1.i5.p1.2.m2.2.2.2.2.2.3" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.cmml">
              <mi id="S3.I1.i5.p1.2.m2.2.2.2.2.2.3a" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.cmml">
              </mi>
              <mo id="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.1" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.9" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i5.p1.2.m2.3.3.3.3.3" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.cmml">
             <mi id="S3.I1.i5.p1.2.m2.3.3.3.3.3.2" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.2.cmml">
              h
             </mi>
             <msup id="S3.I1.i5.p1.2.m2.3.3.3.3.3.3" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.cmml">
              <mi id="S3.I1.i5.p1.2.m2.3.3.3.3.3.3a" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.cmml">
              </mi>
              <mo id="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.1" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.10" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             ,
            </mo>
            <msubsup id="S3.I1.i5.p1.2.m2.4.4.4.4.4" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.cmml">
             <mi id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.2" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.2.cmml">
              v
             </mi>
             <mi id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.3" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.3.cmml">
              c
             </mi>
             <msup id="S3.I1.i5.p1.2.m2.4.4.4.4.4.3" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.cmml">
              <mi id="S3.I1.i5.p1.2.m2.4.4.4.4.4.3a" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.cmml">
              </mi>
              <mo id="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.1" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.1.cmml">
               ′
              </mo>
             </msup>
            </msubsup>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.11" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             ,
            </mo>
            <mrow id="S3.I1.i5.p1.2.m2.5.5.5.5.5" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.cmml">
             <mi id="S3.I1.i5.p1.2.m2.5.5.5.5.5.2" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.2.cmml">
              p
             </mi>
             <mo id="S3.I1.i5.p1.2.m2.5.5.5.5.5.1" lspace="0em" rspace="0em" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.1.cmml">
              ​
             </mo>
             <msup id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.cmml">
              <mi id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.2" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.2.cmml">
               h
              </mi>
              <msup id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.cmml">
               <mi id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3a" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.cmml">
               </mi>
               <mo id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.1" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.1.cmml">
                ′
               </mo>
              </msup>
             </msup>
            </mrow>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.12" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             ,
            </mo>
            <msup id="S3.I1.i5.p1.2.m2.6.6.6.6.6" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.cmml">
             <mi id="S3.I1.i5.p1.2.m2.6.6.6.6.6.2" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.2.cmml">
              k
             </mi>
             <msup id="S3.I1.i5.p1.2.m2.6.6.6.6.6.3" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.cmml">
              <mi id="S3.I1.i5.p1.2.m2.6.6.6.6.6.3a" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.cmml">
              </mi>
              <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.1" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.1.cmml">
               ′
              </mo>
             </msup>
            </msup>
            <mo id="S3.I1.i5.p1.2.m2.6.6.6.6.13" stretchy="false" xref="S3.I1.i5.p1.2.m2.6.6.6.7.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.2.m2.6b">
           <apply id="S3.I1.i5.p1.2.m2.6.6.cmml" xref="S3.I1.i5.p1.2.m2.6.6">
            <eq id="S3.I1.i5.p1.2.m2.6.6.7.cmml" xref="S3.I1.i5.p1.2.m2.6.6.7">
            </eq>
            <apply id="S3.I1.i5.p1.2.m2.6.6.8.cmml" xref="S3.I1.i5.p1.2.m2.6.6.8">
             <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.6.6.8.1.cmml" xref="S3.I1.i5.p1.2.m2.6.6.8">
              subscript
             </csymbol>
             <ci id="S3.I1.i5.p1.2.m2.6.6.8.2.cmml" xref="S3.I1.i5.p1.2.m2.6.6.8.2">
              𝑆
             </ci>
             <ci id="S3.I1.i5.p1.2.m2.6.6.8.3.cmml" xref="S3.I1.i5.p1.2.m2.6.6.8.3">
              𝑡
             </ci>
            </apply>
            <vector id="S3.I1.i5.p1.2.m2.6.6.6.7.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6">
             <apply id="S3.I1.i5.p1.2.m2.1.1.1.1.1.cmml" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1">
              <times id="S3.I1.i5.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.1">
              </times>
              <ci id="S3.I1.i5.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.2">
               𝑡
              </ci>
              <ci id="S3.I1.i5.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.I1.i5.p1.2.m2.1.1.1.1.1.3">
               𝑏
              </ci>
             </apply>
             <apply id="S3.I1.i5.p1.2.m2.2.2.2.2.2.cmml" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2">
               superscript
              </csymbol>
              <ci id="S3.I1.i5.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.2">
               𝑞
              </ci>
              <apply id="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.3">
               <ci id="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.I1.i5.p1.2.m2.2.2.2.2.2.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i5.p1.2.m2.3.3.3.3.3.cmml" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3">
              <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.3.3.3.3.3.1.cmml" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3">
               superscript
              </csymbol>
              <ci id="S3.I1.i5.p1.2.m2.3.3.3.3.3.2.cmml" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.2">
               ℎ
              </ci>
              <apply id="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.cmml" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.3">
               <ci id="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.1.cmml" xref="S3.I1.i5.p1.2.m2.3.3.3.3.3.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i5.p1.2.m2.4.4.4.4.4.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4">
              <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.4.4.4.4.4.1.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4">
               superscript
              </csymbol>
              <apply id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4">
               <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.1.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4">
                subscript
               </csymbol>
               <ci id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.2.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.2">
                𝑣
               </ci>
               <ci id="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.3.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.2.3">
                𝑐
               </ci>
              </apply>
              <apply id="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.3">
               <ci id="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.1.cmml" xref="S3.I1.i5.p1.2.m2.4.4.4.4.4.3.1">
                ′
               </ci>
              </apply>
             </apply>
             <apply id="S3.I1.i5.p1.2.m2.5.5.5.5.5.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5">
              <times id="S3.I1.i5.p1.2.m2.5.5.5.5.5.1.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.1">
              </times>
              <ci id="S3.I1.i5.p1.2.m2.5.5.5.5.5.2.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.2">
               𝑝
              </ci>
              <apply id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3">
               <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.1.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3">
                superscript
               </csymbol>
               <ci id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.2.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.2">
                ℎ
               </ci>
               <apply id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3">
                <ci id="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.1.cmml" xref="S3.I1.i5.p1.2.m2.5.5.5.5.5.3.3.1">
                 ′
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S3.I1.i5.p1.2.m2.6.6.6.6.6.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6">
              <csymbol cd="ambiguous" id="S3.I1.i5.p1.2.m2.6.6.6.6.6.1.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6">
               superscript
              </csymbol>
              <ci id="S3.I1.i5.p1.2.m2.6.6.6.6.6.2.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.2">
               𝑘
              </ci>
              <apply id="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.3">
               <ci id="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.1.cmml" xref="S3.I1.i5.p1.2.m2.6.6.6.6.6.3.1">
                ′
               </ci>
              </apply>
             </apply>
            </vector>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i5.p1.2.m2.6c">
           S_{t}=(tb,q^{{}^{\prime}},h^{{}^{\prime}},v_{c}^{{}^{\prime}},ph^{{}^{\prime}},k^{{}^{\prime}})
          </annotation>
         </semantics>
        </math>
        is the final state, then we have a final reward of +1 if
        <math alttext="v_{c}^{{}^{\prime}}=v_{g}" class="ltx_Math" display="inline" id="S3.I1.i5.p1.3.m3.1">
         <semantics id="S3.I1.i5.p1.3.m3.1a">
          <mrow id="S3.I1.i5.p1.3.m3.1.1" xref="S3.I1.i5.p1.3.m3.1.1.cmml">
           <msubsup id="S3.I1.i5.p1.3.m3.1.1.2" xref="S3.I1.i5.p1.3.m3.1.1.2.cmml">
            <mi id="S3.I1.i5.p1.3.m3.1.1.2.2.2" xref="S3.I1.i5.p1.3.m3.1.1.2.2.2.cmml">
             v
            </mi>
            <mi id="S3.I1.i5.p1.3.m3.1.1.2.2.3" xref="S3.I1.i5.p1.3.m3.1.1.2.2.3.cmml">
             c
            </mi>
            <msup id="S3.I1.i5.p1.3.m3.1.1.2.3" xref="S3.I1.i5.p1.3.m3.1.1.2.3.cmml">
             <mi id="S3.I1.i5.p1.3.m3.1.1.2.3a" xref="S3.I1.i5.p1.3.m3.1.1.2.3.cmml">
             </mi>
             <mo id="S3.I1.i5.p1.3.m3.1.1.2.3.1" xref="S3.I1.i5.p1.3.m3.1.1.2.3.1.cmml">
              ′
             </mo>
            </msup>
           </msubsup>
           <mo id="S3.I1.i5.p1.3.m3.1.1.1" xref="S3.I1.i5.p1.3.m3.1.1.1.cmml">
            =
           </mo>
           <msub id="S3.I1.i5.p1.3.m3.1.1.3" xref="S3.I1.i5.p1.3.m3.1.1.3.cmml">
            <mi id="S3.I1.i5.p1.3.m3.1.1.3.2" xref="S3.I1.i5.p1.3.m3.1.1.3.2.cmml">
             v
            </mi>
            <mi id="S3.I1.i5.p1.3.m3.1.1.3.3" xref="S3.I1.i5.p1.3.m3.1.1.3.3.cmml">
             g
            </mi>
           </msub>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.3.m3.1b">
           <apply id="S3.I1.i5.p1.3.m3.1.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1">
            <eq id="S3.I1.i5.p1.3.m3.1.1.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.1">
            </eq>
            <apply id="S3.I1.i5.p1.3.m3.1.1.2.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2">
             <csymbol cd="ambiguous" id="S3.I1.i5.p1.3.m3.1.1.2.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2">
              superscript
             </csymbol>
             <apply id="S3.I1.i5.p1.3.m3.1.1.2.2.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2">
              <csymbol cd="ambiguous" id="S3.I1.i5.p1.3.m3.1.1.2.2.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2">
               subscript
              </csymbol>
              <ci id="S3.I1.i5.p1.3.m3.1.1.2.2.2.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2.2.2">
               𝑣
              </ci>
              <ci id="S3.I1.i5.p1.3.m3.1.1.2.2.3.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2.2.3">
               𝑐
              </ci>
             </apply>
             <apply id="S3.I1.i5.p1.3.m3.1.1.2.3.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2.3">
              <ci id="S3.I1.i5.p1.3.m3.1.1.2.3.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.2.3.1">
               ′
              </ci>
             </apply>
            </apply>
            <apply id="S3.I1.i5.p1.3.m3.1.1.3.cmml" xref="S3.I1.i5.p1.3.m3.1.1.3">
             <csymbol cd="ambiguous" id="S3.I1.i5.p1.3.m3.1.1.3.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.3">
              subscript
             </csymbol>
             <ci id="S3.I1.i5.p1.3.m3.1.1.3.2.cmml" xref="S3.I1.i5.p1.3.m3.1.1.3.2">
              𝑣
             </ci>
             <ci id="S3.I1.i5.p1.3.m3.1.1.3.3.cmml" xref="S3.I1.i5.p1.3.m3.1.1.3.3">
              𝑔
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i5.p1.3.m3.1c">
           v_{c}^{{}^{\prime}}=v_{g}
          </annotation>
         </semantics>
        </math>
        , else -1.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i6" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I1.i6.p1">
       <p class="ltx_p" id="S3.I1.i6.p1.2">
        <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.I1.i6.p1.1.m1.1">
         <semantics id="S3.I1.i6.p1.1.m1.1a">
          <mi id="S3.I1.i6.p1.1.m1.1.1" xref="S3.I1.i6.p1.1.m1.1.1.cmml">
           γ
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i6.p1.1.m1.1b">
           <ci id="S3.I1.i6.p1.1.m1.1.1.cmml" xref="S3.I1.i6.p1.1.m1.1.1">
            𝛾
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i6.p1.1.m1.1c">
           \gamma
          </annotation>
         </semantics>
        </math>
        denote reward discounts factor are used to compute the reward information of each intermediate process when agent reaches the goal, or the end of the maximum step
        <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.i6.p1.2.m2.1">
         <semantics id="S3.I1.i6.p1.2.m2.1a">
          <mi id="S3.I1.i6.p1.2.m2.1.1" xref="S3.I1.i6.p1.2.m2.1.1.cmml">
           t
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i6.p1.2.m2.1b">
           <ci id="S3.I1.i6.p1.2.m2.1.1.cmml" xref="S3.I1.i6.p1.2.m2.1.1">
            𝑡
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i6.p1.2.m2.1c">
           t
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
    </ul>
   </div>
   <section class="ltx_subsubsection" id="S3.SS3.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      3.3.1
     </span>
     Full Textual Environment
    </h4>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p1">
     <p class="ltx_p" id="S3.SS3.SSS1.p1.1">
      This module tracks the agent’s state that captures all essential information in the conversation so far. FTE is a text dictionary structure, the same as Prompt Engineering’s normal prompt format.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S3.SS3.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      3.3.2
     </span>
     Agent
    </h4>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p1">
     <p class="ltx_p" id="S3.SS3.SSS2.p1.1">
      Inference to previous work
      <cite class="ltx_cite ltx_citemacro_citet">
       Carta et al. (
       <a class="ltx_ref" href="#bib.bib1" title="">
        2023
       </a>
       )
      </cite>
      , we use standard RL practices by adding action heads - a Multi-Layer Perceptron (MLP) on top of the LLM. Thus, we can use only pretrained operations from the LLM and leverage language modeling heads’ prior, this method is robust to any action space and can thus be used on any textual environment with no change. Agent has two components: LLM and PA-MLP.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p2">
     <p class="ltx_p" id="S3.SS3.SSS2.p2.2">
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p2.2.1">
       LLM
      </span>
      We initially utilize a LLM to encode the state
      <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1">
       <semantics id="S3.SS3.SSS2.p2.1.m1.1a">
        <mi id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml">
         S
        </mi>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b">
         <ci id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">
          𝑆
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">
         S
        </annotation>
       </semantics>
      </math>
      into a continuous vector
      <math alttext="s\in\mathcal{\mathbb{R}}^{2d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1">
       <semantics id="S3.SS3.SSS2.p2.2.m2.1a">
        <mrow id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml">
         <mi id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">
          s
         </mi>
         <mo id="S3.SS3.SSS2.p2.2.m2.1.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml">
          ∈
         </mo>
         <msup id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml">
          <mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">
           ℝ
          </mi>
          <mrow id="S3.SS3.SSS2.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml">
           <mn id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.2.cmml">
            2
           </mn>
           <mo id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.3.cmml">
            d
           </mi>
          </mrow>
         </msup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b">
         <apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">
          <in id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1">
          </in>
          <ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">
           𝑠
          </ci>
          <apply id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3">
           <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3">
            superscript
           </csymbol>
           <ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2">
            ℝ
           </ci>
           <apply id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3">
            <times id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.1">
            </times>
            <cn id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.2">
             2
            </cn>
            <ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.3">
             𝑑
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">
         s\in\mathcal{\mathbb{R}}^{2d}
        </annotation>
       </semantics>
      </math>
      .
As a rule of thumb, for BERT models the cls token is used to represent the semantics of the whole sequence, while standard transformers and GPT-like LLMs use the embedding of the last token. We used the model on huggingface hub as well as the code to get the sequence vector representation
      <span class="ltx_note ltx_role_footnote" id="footnote1">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_note_outer">
        <span class="ltx_note_content">
         <sup class="ltx_note_mark">
          1
         </sup>
         <span class="ltx_tag ltx_tag_note">
          1
         </span>
         <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co" target="_blank" title="">
          https://huggingface.co
         </a>
        </span>
       </span>
      </span>
      .
It is defined by:
     </p>
     <table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
      <tbody>
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle s=llm(fte)" class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.1">
          <semantics id="S3.E3X.2.1.1.m1.1a">
           <mrow id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml">
            <mi id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml">
             s
            </mi>
            <mo id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2.cmml">
             =
            </mo>
            <mrow id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.cmml">
             <mi id="S3.E3X.2.1.1.m1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.3.cmml">
              l
             </mi>
             <mo id="S3.E3X.2.1.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">
              ​
             </mo>
             <mi id="S3.E3X.2.1.1.m1.1.1.1.4" xref="S3.E3X.2.1.1.m1.1.1.1.4.cmml">
              l
             </mi>
             <mo id="S3.E3X.2.1.1.m1.1.1.1.2a" lspace="0em" rspace="0em" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">
              ​
             </mo>
             <mi id="S3.E3X.2.1.1.m1.1.1.1.5" xref="S3.E3X.2.1.1.m1.1.1.1.5.cmml">
              m
             </mi>
             <mo id="S3.E3X.2.1.1.m1.1.1.1.2b" lspace="0em" rspace="0em" xref="S3.E3X.2.1.1.m1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E3X.2.1.1.m1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml">
              <mo id="S3.E3X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S3.E3X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml">
               <mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.2.cmml">
                f
               </mi>
               <mo id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                ​
               </mo>
               <mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.3.cmml">
                t
               </mi>
               <mo id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1a" lspace="0em" rspace="0em" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                ​
               </mo>
               <mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.4" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.4.cmml">
                e
               </mi>
              </mrow>
              <mo id="S3.E3X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b">
            <apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">
             <eq id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2">
             </eq>
             <ci id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3">
              𝑠
             </ci>
             <apply id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1">
              <times id="S3.E3X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.2">
              </times>
              <ci id="S3.E3X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.3">
               𝑙
              </ci>
              <ci id="S3.E3X.2.1.1.m1.1.1.1.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.4">
               𝑙
              </ci>
              <ci id="S3.E3X.2.1.1.m1.1.1.1.5.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.5">
               𝑚
              </ci>
              <apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1">
               <times id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1">
               </times>
               <ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.2">
                𝑓
               </ci>
               <ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.3">
                𝑡
               </ci>
               <ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.4">
                𝑒
               </ci>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">
            \displaystyle s=llm(fte)
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
         <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
          (3)
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S3.SS3.SSS2.p2.10">
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p2.10.1">
       PA-MLP
      </span>
      Instead of just adding an MLP with a single output for the value on top of the last layer of the first decoder block as in the conventional multicategorization task, to enhance the ability of the large model to perceive the environment, we further fused the hidden state after the MLP with the Knowledge Graph exit path information, called PA-MLP (
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p2.10.2">
       P
      </span>
      ath
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p2.10.3">
       A
      </span>
      ware MLP).
Recall that each possible action represents an outgoing edge
      <math alttext="e" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m1.1">
       <semantics id="S3.SS3.SSS2.p2.3.m1.1a">
        <mi id="S3.SS3.SSS2.p2.3.m1.1.1" xref="S3.SS3.SSS2.p2.3.m1.1.1.cmml">
         e
        </mi>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m1.1b">
         <ci id="S3.SS3.SSS2.p2.3.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m1.1.1">
          𝑒
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m1.1c">
         e
        </annotation>
       </semantics>
      </math>
      with information about the edge relation label
      <math alttext="r_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m2.1">
       <semantics id="S3.SS3.SSS2.p2.4.m2.1a">
        <msub id="S3.SS3.SSS2.p2.4.m2.1.1" xref="S3.SS3.SSS2.p2.4.m2.1.1.cmml">
         <mi id="S3.SS3.SSS2.p2.4.m2.1.1.2" xref="S3.SS3.SSS2.p2.4.m2.1.1.2.cmml">
          r
         </mi>
         <mi id="S3.SS3.SSS2.p2.4.m2.1.1.3" xref="S3.SS3.SSS2.p2.4.m2.1.1.3.cmml">
          l
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m2.1b">
         <apply id="S3.SS3.SSS2.p2.4.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m2.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m2.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS3.SSS2.p2.4.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.4.m2.1.1.2">
           𝑟
          </ci>
          <ci id="S3.SS3.SSS2.p2.4.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.4.m2.1.1.3">
           𝑙
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m2.1c">
         r_{l}
        </annotation>
       </semantics>
      </math>
      and the target vertex/entity
      <math alttext="v_{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m3.1">
       <semantics id="S3.SS3.SSS2.p2.5.m3.1a">
        <msub id="S3.SS3.SSS2.p2.5.m3.1.1" xref="S3.SS3.SSS2.p2.5.m3.1.1.cmml">
         <mi id="S3.SS3.SSS2.p2.5.m3.1.1.2" xref="S3.SS3.SSS2.p2.5.m3.1.1.2.cmml">
          v
         </mi>
         <mi id="S3.SS3.SSS2.p2.5.m3.1.1.3" xref="S3.SS3.SSS2.p2.5.m3.1.1.3.cmml">
          d
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m3.1b">
         <apply id="S3.SS3.SSS2.p2.5.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m3.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m3.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS3.SSS2.p2.5.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m3.1.1.2">
           𝑣
          </ci>
          <ci id="S3.SS3.SSS2.p2.5.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m3.1.1.3">
           𝑑
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m3.1c">
         v_{d}
        </annotation>
       </semantics>
      </math>
      . So the embedding for each
      <math alttext="A_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m4.1">
       <semantics id="S3.SS3.SSS2.p2.6.m4.1a">
        <msub id="S3.SS3.SSS2.p2.6.m4.1.1" xref="S3.SS3.SSS2.p2.6.m4.1.1.cmml">
         <mi id="S3.SS3.SSS2.p2.6.m4.1.1.2" xref="S3.SS3.SSS2.p2.6.m4.1.1.2.cmml">
          A
         </mi>
         <mi id="S3.SS3.SSS2.p2.6.m4.1.1.3" xref="S3.SS3.SSS2.p2.6.m4.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m4.1b">
         <apply id="S3.SS3.SSS2.p2.6.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m4.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m4.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS3.SSS2.p2.6.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m4.1.1.2">
           𝐴
          </ci>
          <ci id="S3.SS3.SSS2.p2.6.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m4.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m4.1c">
         A_{t}
        </annotation>
       </semantics>
      </math>
      is
      <math alttext="[r_{l};v_{d}]" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m5.2">
       <semantics id="S3.SS3.SSS2.p2.7.m5.2a">
        <mrow id="S3.SS3.SSS2.p2.7.m5.2.2.2" xref="S3.SS3.SSS2.p2.7.m5.2.2.3.cmml">
         <mo id="S3.SS3.SSS2.p2.7.m5.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p2.7.m5.2.2.3.cmml">
          [
         </mo>
         <msub id="S3.SS3.SSS2.p2.7.m5.1.1.1.1" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1.cmml">
          <mi id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.2" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1.2.cmml">
           r
          </mi>
          <mi id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.3" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1.3.cmml">
           l
          </mi>
         </msub>
         <mo id="S3.SS3.SSS2.p2.7.m5.2.2.2.4" xref="S3.SS3.SSS2.p2.7.m5.2.2.3.cmml">
          ;
         </mo>
         <msub id="S3.SS3.SSS2.p2.7.m5.2.2.2.2" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2.cmml">
          <mi id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.2" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2.2.cmml">
           v
          </mi>
          <mi id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.3" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2.3.cmml">
           d
          </mi>
         </msub>
         <mo id="S3.SS3.SSS2.p2.7.m5.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p2.7.m5.2.2.3.cmml">
          ]
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m5.2b">
         <list id="S3.SS3.SSS2.p2.7.m5.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m5.2.2.2">
          <apply id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1.2">
            𝑟
           </ci>
           <ci id="S3.SS3.SSS2.p2.7.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m5.1.1.1.1.3">
            𝑙
           </ci>
          </apply>
          <apply id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2.2">
            𝑣
           </ci>
           <ci id="S3.SS3.SSS2.p2.7.m5.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m5.2.2.2.2.3">
            𝑑
           </ci>
          </apply>
         </list>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m5.2c">
         [r_{l};v_{d}]
        </annotation>
       </semantics>
      </math>
      , and stacking the embeddings for all outgoing edges we get the matrix
      <math alttext="A_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m6.1">
       <semantics id="S3.SS3.SSS2.p2.8.m6.1a">
        <msub id="S3.SS3.SSS2.p2.8.m6.1.1" xref="S3.SS3.SSS2.p2.8.m6.1.1.cmml">
         <mi id="S3.SS3.SSS2.p2.8.m6.1.1.2" xref="S3.SS3.SSS2.p2.8.m6.1.1.2.cmml">
          A
         </mi>
         <mi id="S3.SS3.SSS2.p2.8.m6.1.1.3" xref="S3.SS3.SSS2.p2.8.m6.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m6.1b">
         <apply id="S3.SS3.SSS2.p2.8.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m6.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m6.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS3.SSS2.p2.8.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.8.m6.1.1.2">
           𝐴
          </ci>
          <ci id="S3.SS3.SSS2.p2.8.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.8.m6.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m6.1c">
         A_{t}
        </annotation>
       </semantics>
      </math>
      . The network taking this as input is parameterized as a three-layer feed-forward network (MLP) with
      <math alttext="\tanh" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.9.m7.1">
       <semantics id="S3.SS3.SSS2.p2.9.m7.1a">
        <mi id="S3.SS3.SSS2.p2.9.m7.1.1" xref="S3.SS3.SSS2.p2.9.m7.1.1.cmml">
         tanh
        </mi>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m7.1b">
         <tanh id="S3.SS3.SSS2.p2.9.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m7.1.1">
         </tanh>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m7.1c">
         \tanh
        </annotation>
       </semantics>
      </math>
      nonlinearity, which takes the FTE representation
      <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.10.m8.1">
       <semantics id="S3.SS3.SSS2.p2.10.m8.1a">
        <mi id="S3.SS3.SSS2.p2.10.m8.1.1" xref="S3.SS3.SSS2.p2.10.m8.1.1.cmml">
         s
        </mi>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m8.1b">
         <ci id="S3.SS3.SSS2.p2.10.m8.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m8.1.1">
          𝑠
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m8.1c">
         s
        </annotation>
       </semantics>
      </math>
      and the embedding for the outgoing paths embedding and outputs a probability distribution over the possible actions from which a discrete action is sampled. The dimension of the MLP output hidden state is equal to the dimension of the path embedding. Finally, formulated as:
     </p>
     <table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
      <tbody>
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathbf{h}_{\mathbf{t}}" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.1">
          <semantics id="S3.E4X.2.1.1.m1.1a">
           <msub id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml">
            <mi id="S3.E4X.2.1.1.m1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.2.cmml">
             𝐡
            </mi>
            <mi id="S3.E4X.2.1.1.m1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.cmml">
             𝐭
            </mi>
           </msub>
           <annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b">
            <apply id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">
             <csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">
              subscript
             </csymbol>
             <ci id="S3.E4X.2.1.1.m1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2">
              𝐡
             </ci>
             <ci id="S3.E4X.2.1.1.m1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3">
              𝐭
             </ci>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">
            \displaystyle\mathbf{h}_{\mathbf{t}}
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_td ltx_align_left ltx_eqn_cell">
         <math alttext="\displaystyle=\mathbf{A}_{\mathbf{t}}\left(\mathbf{W}_{\mathbf{3}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{2}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{1}}\left(s_{t}\right)\right)\right)\right)\right)\right)" class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.3">
          <semantics id="S3.E4X.3.2.2.m1.3a">
           <mrow id="S3.E4X.3.2.2.m1.3.3" xref="S3.E4X.3.2.2.m1.3.3.cmml">
            <mi id="S3.E4X.3.2.2.m1.3.3.3" xref="S3.E4X.3.2.2.m1.3.3.3.cmml">
            </mi>
            <mo id="S3.E4X.3.2.2.m1.3.3.2" xref="S3.E4X.3.2.2.m1.3.3.2.cmml">
             =
            </mo>
            <mrow id="S3.E4X.3.2.2.m1.3.3.1" xref="S3.E4X.3.2.2.m1.3.3.1.cmml">
             <msub id="S3.E4X.3.2.2.m1.3.3.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.3.cmml">
              <mi id="S3.E4X.3.2.2.m1.3.3.1.3.2" xref="S3.E4X.3.2.2.m1.3.3.1.3.2.cmml">
               𝐀
              </mi>
              <mi id="S3.E4X.3.2.2.m1.3.3.1.3.3" xref="S3.E4X.3.2.2.m1.3.3.1.3.3.cmml">
               𝐭
              </mi>
             </msub>
             <mo id="S3.E4X.3.2.2.m1.3.3.1.2" lspace="0em" rspace="0em" xref="S3.E4X.3.2.2.m1.3.3.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
              <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
               <msub id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.cmml">
                <mi id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.2.cmml">
                 𝐖
                </mi>
                <mn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.3.cmml">
                 𝟑
                </mn>
               </msub>
               <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
                <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                 <mi id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml">
                  tanh
                 </mi>
                 <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1a" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                  ⁡
                 </mo>
                 <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                  <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                   (
                  </mo>
                  <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                   <msub id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mi id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                     𝐖
                    </mi>
                    <mn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                     𝟐
                    </mn>
                   </msub>
                   <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                    <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                     (
                    </mo>
                    <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     <mi id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">
                      tanh
                     </mi>
                     <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                      ⁡
                     </mo>
                     <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                      <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                       (
                      </mo>
                      <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                       <msub id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                        <mi id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                         𝐖
                        </mi>
                        <mn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                         𝟏
                        </mn>
                       </msub>
                       <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                        ​
                       </mo>
                       <mrow id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                        <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                         (
                        </mo>
                        <msub id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                         <mi id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                          s
                         </mi>
                         <mi id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                          t
                         </mi>
                        </msub>
                        <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                         )
                        </mo>
                       </mrow>
                      </mrow>
                      <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                       )
                      </mo>
                     </mrow>
                    </mrow>
                    <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E4X.3.2.2.m1.3.3.1.1.1.3" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.3b">
            <apply id="S3.E4X.3.2.2.m1.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3">
             <eq id="S3.E4X.3.2.2.m1.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2">
             </eq>
             <csymbol cd="latexml" id="S3.E4X.3.2.2.m1.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.3">
              absent
             </csymbol>
             <apply id="S3.E4X.3.2.2.m1.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1">
              <times id="S3.E4X.3.2.2.m1.3.3.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.2">
              </times>
              <apply id="S3.E4X.3.2.2.m1.3.3.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.3">
               <csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.3">
                subscript
               </csymbol>
               <ci id="S3.E4X.3.2.2.m1.3.3.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.3.2">
                𝐀
               </ci>
               <ci id="S3.E4X.3.2.2.m1.3.3.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.3.3">
                𝐭
               </ci>
              </apply>
              <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1">
               <times id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.2">
               </times>
               <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.2">
                 𝐖
                </ci>
                <cn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.3.3">
                 3
                </cn>
               </apply>
               <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1">
                <ci id="S3.E4X.3.2.2.m1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2">
                 tanh
                </ci>
                <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                 <times id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">
                 </times>
                 <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <ci id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">
                   𝐖
                  </ci>
                  <cn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">
                   2
                  </cn>
                 </apply>
                 <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  <ci id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1">
                   tanh
                  </ci>
                  <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                   <times id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                   </times>
                   <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                     𝐖
                    </ci>
                    <cn id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     1
                    </cn>
                   </apply>
                   <apply id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                     𝑠
                    </ci>
                    <ci id="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                     𝑡
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.3c">
            \displaystyle=\mathbf{A}_{\mathbf{t}}\left(\mathbf{W}_{\mathbf{3}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{2}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{1}}\left(s_{t}\right)\right)\right)\right)\right)\right)
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2">
         <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
          (4)
         </span>
        </td>
       </tr>
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4Xa">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle a_{t}" class="ltx_Math" display="inline" id="S3.E4Xa.2.1.1.m1.1">
          <semantics id="S3.E4Xa.2.1.1.m1.1a">
           <msub id="S3.E4Xa.2.1.1.m1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.cmml">
            <mi id="S3.E4Xa.2.1.1.m1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.2.cmml">
             a
            </mi>
            <mi id="S3.E4Xa.2.1.1.m1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b">
            <apply id="S3.E4Xa.2.1.1.m1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1">
             <csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1">
              subscript
             </csymbol>
             <ci id="S3.E4Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.2">
              𝑎
             </ci>
             <ci id="S3.E4Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.3">
              𝑡
             </ci>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">
            \displaystyle a_{t}
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_td ltx_align_left ltx_eqn_cell">
         <math alttext="\displaystyle\sim\text{ Categorical }\left(\operatorname{softmax}\left(\mathbf{h}_{\mathbf{t}}\right)\right)" class="ltx_Math" display="inline" id="S3.E4Xa.3.2.2.m1.2">
          <semantics id="S3.E4Xa.3.2.2.m1.2a">
           <mrow id="S3.E4Xa.3.2.2.m1.2.2" xref="S3.E4Xa.3.2.2.m1.2.2.cmml">
            <mi id="S3.E4Xa.3.2.2.m1.2.2.3" xref="S3.E4Xa.3.2.2.m1.2.2.3.cmml">
            </mi>
            <mo id="S3.E4Xa.3.2.2.m1.2.2.2" xref="S3.E4Xa.3.2.2.m1.2.2.2.cmml">
             ∼
            </mo>
            <mrow id="S3.E4Xa.3.2.2.m1.2.2.1" xref="S3.E4Xa.3.2.2.m1.2.2.1.cmml">
             <mtext id="S3.E4Xa.3.2.2.m1.2.2.1.3" xref="S3.E4Xa.3.2.2.m1.2.2.1.3a.cmml">
              Categorical
             </mtext>
             <mo id="S3.E4Xa.3.2.2.m1.2.2.1.2" lspace="0em" rspace="0em" xref="S3.E4Xa.3.2.2.m1.2.2.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E4Xa.3.2.2.m1.2.2.1.1.1" xref="S3.E4Xa.3.2.2.m1.2.2.1.cmml">
              <mo id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.2.2.1.cmml">
               (
              </mo>
              <mrow id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">
               <mi id="S3.E4Xa.3.2.2.m1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.cmml">
                softmax
               </mi>
               <mo id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1a" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">
                ⁡
               </mo>
               <mrow id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">
                <mo id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">
                 (
                </mo>
                <msub id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">
                 <mi id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">
                  𝐡
                 </mi>
                 <mi id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml">
                  𝐭
                 </mi>
                </msub>
                <mo id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.2.2.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S3.E4Xa.3.2.2.m1.2b">
            <apply id="S3.E4Xa.3.2.2.m1.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2">
             <csymbol cd="latexml" id="S3.E4Xa.3.2.2.m1.2.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.2">
              similar-to
             </csymbol>
             <csymbol cd="latexml" id="S3.E4Xa.3.2.2.m1.2.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.3">
              absent
             </csymbol>
             <apply id="S3.E4Xa.3.2.2.m1.2.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1">
              <times id="S3.E4Xa.3.2.2.m1.2.2.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.2">
              </times>
              <ci id="S3.E4Xa.3.2.2.m1.2.2.1.3a.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.3">
               <mtext id="S3.E4Xa.3.2.2.m1.2.2.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.3">
                Categorical
               </mtext>
              </ci>
              <apply id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1">
               <ci id="S3.E4Xa.3.2.2.m1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1">
                softmax
               </ci>
               <apply id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">
                 𝐡
                </ci>
                <ci id="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3">
                 𝐭
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E4Xa.3.2.2.m1.2c">
            \displaystyle\sim\text{ Categorical }\left(\operatorname{softmax}\left(\mathbf{h}_{\mathbf{t}}\right)\right)
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S3.SS3.SSS3">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      3.3.3
     </span>
     Training
    </h4>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p1">
     <p class="ltx_p" id="S3.SS3.SSS3.p1.2">
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p1.2.1">
       Optimizer
      </span>
      Our model is optimized by utilizing the experience accumulated by agent during KG reasoning. More formally, for the above policy network (
      <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1">
       <semantics id="S3.SS3.SSS3.p1.1.m1.1a">
        <msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml">
         <mi id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">
          π
         </mi>
         <mi id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml">
          θ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b">
         <apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">
           𝜋
          </ci>
          <ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">
         \pi_{\theta}
        </annotation>
       </semantics>
      </math>
      ), we want to find the parameter
      <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1">
       <semantics id="S3.SS3.SSS3.p1.2.m2.1a">
        <mi id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml">
         θ
        </mi>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b">
         <ci id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">
          𝜃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">
         \theta
        </annotation>
       </semantics>
      </math>
      that maximizes the reward.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p2">
     <table class="ltx_equation ltx_eqn_table" id="S3.E5">
      <tbody>
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_eqn_cell ltx_align_center">
         <math alttext="\begin{split}J(\theta)=\mathbb{E}_{\left(e_{s},\mathcal{P},e_{g}\right)\sim D}\mathbb{E}_{A_{1},\ldots,A_{T-1}\sim\pi_{\theta}}\\
\left[R\left(S_{t}\right)\mid S_{1}=\left(s_{1}\right)\right],\end{split}" class="ltx_Math" display="block" id="S3.E5.m1.27">
          <semantics id="S3.E5.m1.27a">
           <mtable displaystyle="true" id="S3.E5.m1.27.27.2" rowspacing="0pt">
            <mtr id="S3.E5.m1.27.27.2a">
             <mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.27.27.2b">
              <mrow id="S3.E5.m1.9.9.9.9.9">
               <mrow id="S3.E5.m1.9.9.9.9.9.10">
                <mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">
                 J
                </mi>
                <mo id="S3.E5.m1.9.9.9.9.9.10.1" lspace="0em" rspace="0em" xref="S3.E5.m1.26.26.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="S3.E5.m1.9.9.9.9.9.10.2">
                 <mo id="S3.E5.m1.2.2.2.2.2.2" stretchy="false" xref="S3.E5.m1.26.26.1.1.1.cmml">
                  (
                 </mo>
                 <mi id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">
                  θ
                 </mi>
                 <mo id="S3.E5.m1.4.4.4.4.4.4" stretchy="false" xref="S3.E5.m1.26.26.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">
                =
               </mo>
               <mrow id="S3.E5.m1.9.9.9.9.9.11">
                <msub id="S3.E5.m1.9.9.9.9.9.11.2">
                 <mi id="S3.E5.m1.6.6.6.6.6.6" xref="S3.E5.m1.6.6.6.6.6.6.cmml">
                  𝔼
                 </mi>
                 <mrow id="S3.E5.m1.7.7.7.7.7.7.1" xref="S3.E5.m1.7.7.7.7.7.7.1.cmml">
                  <mrow id="S3.E5.m1.7.7.7.7.7.7.1.3.2" xref="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml">
                   <mo id="S3.E5.m1.7.7.7.7.7.7.1.3.2.3" xref="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml">
                    (
                   </mo>
                   <msub id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.cmml">
                    <mi id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.2" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.2.cmml">
                     e
                    </mi>
                    <mi id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.3" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.3.cmml">
                     s
                    </mi>
                   </msub>
                   <mo id="S3.E5.m1.7.7.7.7.7.7.1.3.2.4" xref="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml">
                    ,
                   </mo>
                   <mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.7.7.7.7.7.7.1.1" xref="S3.E5.m1.7.7.7.7.7.7.1.1.cmml">
                    𝒫
                   </mi>
                   <mo id="S3.E5.m1.7.7.7.7.7.7.1.3.2.5" xref="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml">
                    ,
                   </mo>
                   <msub id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.cmml">
                    <mi id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.2" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.2.cmml">
                     e
                    </mi>
                    <mi id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.3" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.3.cmml">
                     g
                    </mi>
                   </msub>
                   <mo id="S3.E5.m1.7.7.7.7.7.7.1.3.2.6" xref="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml">
                    )
                   </mo>
                  </mrow>
                  <mo id="S3.E5.m1.7.7.7.7.7.7.1.4" xref="S3.E5.m1.7.7.7.7.7.7.1.4.cmml">
                   ∼
                  </mo>
                  <mi id="S3.E5.m1.7.7.7.7.7.7.1.5" xref="S3.E5.m1.7.7.7.7.7.7.1.5.cmml">
                   D
                  </mi>
                 </mrow>
                </msub>
                <mo id="S3.E5.m1.9.9.9.9.9.11.1" lspace="0em" rspace="0em" xref="S3.E5.m1.26.26.1.1.1.cmml">
                 ​
                </mo>
                <msub id="S3.E5.m1.9.9.9.9.9.11.3">
                 <mi id="S3.E5.m1.8.8.8.8.8.8" xref="S3.E5.m1.8.8.8.8.8.8.cmml">
                  𝔼
                 </mi>
                 <mrow id="S3.E5.m1.9.9.9.9.9.9.1" xref="S3.E5.m1.9.9.9.9.9.9.1.cmml">
                  <mrow id="S3.E5.m1.9.9.9.9.9.9.1.3.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.3.cmml">
                   <msub id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml">
                    <mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.2" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.2.cmml">
                     A
                    </mi>
                    <mn id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.3" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.3.cmml">
                     1
                    </mn>
                   </msub>
                   <mo id="S3.E5.m1.9.9.9.9.9.9.1.3.2.3" xref="S3.E5.m1.9.9.9.9.9.9.1.3.3.cmml">
                    ,
                   </mo>
                   <mi id="S3.E5.m1.9.9.9.9.9.9.1.1" mathvariant="normal" xref="S3.E5.m1.9.9.9.9.9.9.1.1.cmml">
                    …
                   </mi>
                   <mo id="S3.E5.m1.9.9.9.9.9.9.1.3.2.4" xref="S3.E5.m1.9.9.9.9.9.9.1.3.3.cmml">
                    ,
                   </mo>
                   <msub id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.cmml">
                    <mi id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.2.cmml">
                     A
                    </mi>
                    <mrow id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.cmml">
                     <mi id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.2.cmml">
                      T
                     </mi>
                     <mo id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.1" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.1.cmml">
                      −
                     </mo>
                     <mn id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.3" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.3.cmml">
                      1
                     </mn>
                    </mrow>
                   </msub>
                  </mrow>
                  <mo id="S3.E5.m1.9.9.9.9.9.9.1.4" xref="S3.E5.m1.9.9.9.9.9.9.1.4.cmml">
                   ∼
                  </mo>
                  <msub id="S3.E5.m1.9.9.9.9.9.9.1.5" xref="S3.E5.m1.9.9.9.9.9.9.1.5.cmml">
                   <mi id="S3.E5.m1.9.9.9.9.9.9.1.5.2" xref="S3.E5.m1.9.9.9.9.9.9.1.5.2.cmml">
                    π
                   </mi>
                   <mi id="S3.E5.m1.9.9.9.9.9.9.1.5.3" xref="S3.E5.m1.9.9.9.9.9.9.1.5.3.cmml">
                    θ
                   </mi>
                  </msub>
                 </mrow>
                </msub>
               </mrow>
              </mrow>
             </mtd>
            </mtr>
            <mtr id="S3.E5.m1.27.27.2c">
             <mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.27.27.2d">
              <mrow id="S3.E5.m1.27.27.2.26.17.17.17">
               <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1">
                <mo id="S3.E5.m1.10.10.10.1.1.1" xref="S3.E5.m1.26.26.1.1.1.cmml">
                 [
                </mo>
                <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1">
                 <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1">
                  <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1.1">
                   <mi id="S3.E5.m1.11.11.11.2.2.2" xref="S3.E5.m1.11.11.11.2.2.2.cmml">
                    R
                   </mi>
                   <mo id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E5.m1.26.26.1.1.1.cmml">
                    ​
                   </mo>
                   <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1.1.1.1">
                    <mo id="S3.E5.m1.12.12.12.3.3.3" xref="S3.E5.m1.26.26.1.1.1.cmml">
                     (
                    </mo>
                    <msub id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1.1.1.1.1">
                     <mi id="S3.E5.m1.13.13.13.4.4.4" xref="S3.E5.m1.13.13.13.4.4.4.cmml">
                      S
                     </mi>
                     <mi id="S3.E5.m1.14.14.14.5.5.5.1" xref="S3.E5.m1.14.14.14.5.5.5.1.cmml">
                      t
                     </mi>
                    </msub>
                    <mo id="S3.E5.m1.15.15.15.6.6.6" xref="S3.E5.m1.26.26.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="S3.E5.m1.16.16.16.7.7.7" xref="S3.E5.m1.16.16.16.7.7.7.cmml">
                   ∣
                  </mo>
                  <msub id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.1.2">
                   <mi id="S3.E5.m1.17.17.17.8.8.8" xref="S3.E5.m1.17.17.17.8.8.8.cmml">
                    S
                   </mi>
                   <mn id="S3.E5.m1.18.18.18.9.9.9.1" xref="S3.E5.m1.18.18.18.9.9.9.1.cmml">
                    1
                   </mn>
                  </msub>
                 </mrow>
                 <mo id="S3.E5.m1.19.19.19.10.10.10" xref="S3.E5.m1.19.19.19.10.10.10.cmml">
                  =
                 </mo>
                 <mrow id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.2.1">
                  <mo id="S3.E5.m1.20.20.20.11.11.11" xref="S3.E5.m1.26.26.1.1.1.cmml">
                   (
                  </mo>
                  <msub id="S3.E5.m1.27.27.2.26.17.17.17.1.1.1.2.1.1">
                   <mi id="S3.E5.m1.21.21.21.12.12.12" xref="S3.E5.m1.21.21.21.12.12.12.cmml">
                    s
                   </mi>
                   <mn id="S3.E5.m1.22.22.22.13.13.13.1" xref="S3.E5.m1.22.22.22.13.13.13.1.cmml">
                    1
                   </mn>
                  </msub>
                  <mo id="S3.E5.m1.23.23.23.14.14.14" xref="S3.E5.m1.26.26.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E5.m1.24.24.24.15.15.15" xref="S3.E5.m1.26.26.1.1.1.cmml">
                 ]
                </mo>
               </mrow>
               <mo id="S3.E5.m1.25.25.25.16.16.16" xref="S3.E5.m1.26.26.1.1.1.cmml">
                ,
               </mo>
              </mrow>
             </mtd>
            </mtr>
           </mtable>
           <annotation-xml encoding="MathML-Content" id="S3.E5.m1.27b">
            <apply id="S3.E5.m1.26.26.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
             <eq id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">
             </eq>
             <apply id="S3.E5.m1.26.26.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
              <times id="S3.E5.m1.26.26.1.1.1.3.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
              </times>
              <ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">
               𝐽
              </ci>
              <ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">
               𝜃
              </ci>
             </apply>
             <apply id="S3.E5.m1.26.26.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
              <times id="S3.E5.m1.26.26.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
              </times>
              <apply id="S3.E5.m1.26.26.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
               <csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.3.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                subscript
               </csymbol>
               <ci id="S3.E5.m1.6.6.6.6.6.6.cmml" xref="S3.E5.m1.6.6.6.6.6.6">
                𝔼
               </ci>
               <apply id="S3.E5.m1.7.7.7.7.7.7.1.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1">
                <csymbol cd="latexml" id="S3.E5.m1.7.7.7.7.7.7.1.4.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.4">
                 similar-to
                </csymbol>
                <vector id="S3.E5.m1.7.7.7.7.7.7.1.3.3.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2">
                 <apply id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1">
                  <csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.1.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1">
                   subscript
                  </csymbol>
                  <ci id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.2.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.2">
                   𝑒
                  </ci>
                  <ci id="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.3.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.2.1.1.3">
                   𝑠
                  </ci>
                 </apply>
                 <ci id="S3.E5.m1.7.7.7.7.7.7.1.1.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.1">
                  𝒫
                 </ci>
                 <apply id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2">
                  <csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.1.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2">
                   subscript
                  </csymbol>
                  <ci id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.2.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.2">
                   𝑒
                  </ci>
                  <ci id="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.3.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.3.2.2.3">
                   𝑔
                  </ci>
                 </apply>
                </vector>
                <ci id="S3.E5.m1.7.7.7.7.7.7.1.5.cmml" xref="S3.E5.m1.7.7.7.7.7.7.1.5">
                 𝐷
                </ci>
               </apply>
              </apply>
              <apply id="S3.E5.m1.26.26.1.1.1.1.4.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
               <csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.4.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                subscript
               </csymbol>
               <ci id="S3.E5.m1.8.8.8.8.8.8.cmml" xref="S3.E5.m1.8.8.8.8.8.8">
                𝔼
               </ci>
               <apply id="S3.E5.m1.9.9.9.9.9.9.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1">
                <csymbol cd="latexml" id="S3.E5.m1.9.9.9.9.9.9.1.4.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.4">
                 similar-to
                </csymbol>
                <list id="S3.E5.m1.9.9.9.9.9.9.1.3.3.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2">
                 <apply id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1">
                  <csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1">
                   subscript
                  </csymbol>
                  <ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.2">
                   𝐴
                  </ci>
                  <cn id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.3.cmml" type="integer" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.3">
                   1
                  </cn>
                 </apply>
                 <ci id="S3.E5.m1.9.9.9.9.9.9.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.1">
                  …
                 </ci>
                 <apply id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2">
                  <csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2">
                   subscript
                  </csymbol>
                  <ci id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.2">
                   𝐴
                  </ci>
                  <apply id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3">
                   <minus id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.1">
                   </minus>
                   <ci id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.2">
                    𝑇
                   </ci>
                   <cn id="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.9.9.9.9.9.9.1.3.2.2.3.3">
                    1
                   </cn>
                  </apply>
                 </apply>
                </list>
                <apply id="S3.E5.m1.9.9.9.9.9.9.1.5.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.5">
                 <csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.9.9.9.1.5.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.5">
                  subscript
                 </csymbol>
                 <ci id="S3.E5.m1.9.9.9.9.9.9.1.5.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.5.2">
                  𝜋
                 </ci>
                 <ci id="S3.E5.m1.9.9.9.9.9.9.1.5.3.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.5.3">
                  𝜃
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="S3.E5.m1.26.26.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
               <csymbol cd="latexml" id="S3.E5.m1.26.26.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                delimited-[]
               </csymbol>
               <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                <eq id="S3.E5.m1.19.19.19.10.10.10.cmml" xref="S3.E5.m1.19.19.19.10.10.10">
                </eq>
                <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                 <csymbol cd="latexml" id="S3.E5.m1.16.16.16.7.7.7.cmml" xref="S3.E5.m1.16.16.16.7.7.7">
                  conditional
                 </csymbol>
                 <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                  <times id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                  </times>
                  <ci id="S3.E5.m1.11.11.11.2.2.2.cmml" xref="S3.E5.m1.11.11.11.2.2.2">
                   𝑅
                  </ci>
                  <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                   <csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                    subscript
                   </csymbol>
                   <ci id="S3.E5.m1.13.13.13.4.4.4.cmml" xref="S3.E5.m1.13.13.13.4.4.4">
                    𝑆
                   </ci>
                   <ci id="S3.E5.m1.14.14.14.5.5.5.1.cmml" xref="S3.E5.m1.14.14.14.5.5.5.1">
                    𝑡
                   </ci>
                  </apply>
                 </apply>
                 <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                  <csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                   subscript
                  </csymbol>
                  <ci id="S3.E5.m1.17.17.17.8.8.8.cmml" xref="S3.E5.m1.17.17.17.8.8.8">
                   𝑆
                  </ci>
                  <cn id="S3.E5.m1.18.18.18.9.9.9.1.cmml" type="integer" xref="S3.E5.m1.18.18.18.9.9.9.1">
                   1
                  </cn>
                 </apply>
                </apply>
                <apply id="S3.E5.m1.26.26.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                 <csymbol cd="ambiguous" id="S3.E5.m1.26.26.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.10.1">
                  subscript
                 </csymbol>
                 <ci id="S3.E5.m1.21.21.21.12.12.12.cmml" xref="S3.E5.m1.21.21.21.12.12.12">
                  𝑠
                 </ci>
                 <cn id="S3.E5.m1.22.22.22.13.13.13.1.cmml" type="integer" xref="S3.E5.m1.22.22.22.13.13.13.1">
                  1
                 </cn>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E5.m1.27c">
            \begin{split}J(\theta)=\mathbb{E}_{\left(e_{s},\mathcal{P},e_{g}\right)\sim D}\mathbb{E}_{A_{1},\ldots,A_{T-1}\sim\pi_{\theta}}\\
\left[R\left(S_{t}\right)\mid S_{1}=\left(s_{1}\right)\right],\end{split}
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_right">
          (5)
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S3.SS3.SSS3.p2.1">
      where we assume that there is a true underlying distribution
      <math alttext="(e1,r,e2)\sim\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.3">
       <semantics id="S3.SS3.SSS3.p2.1.m1.3a">
        <mrow id="S3.SS3.SSS3.p2.1.m1.3.3" xref="S3.SS3.SSS3.p2.1.m1.3.3.cmml">
         <mrow id="S3.SS3.SSS3.p2.1.m1.3.3.2.2" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml">
          <mo id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml">
           (
          </mo>
          <mrow id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.cmml">
           <mi id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2.cmml">
            e
           </mi>
           <mo id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.1.cmml">
            ​
           </mo>
           <mn id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3.cmml">
            1
           </mn>
          </mrow>
          <mo id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.4" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml">
           ,
          </mo>
          <mi id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml">
           r
          </mi>
          <mo id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.5" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml">
           ,
          </mo>
          <mrow id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.cmml">
           <mi id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2.cmml">
            e
           </mi>
           <mo id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.1.cmml">
            ​
           </mo>
           <mn id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3.cmml">
            2
           </mn>
          </mrow>
          <mo id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml">
           )
          </mo>
         </mrow>
         <mo id="S3.SS3.SSS3.p2.1.m1.3.3.3" xref="S3.SS3.SSS3.p2.1.m1.3.3.3.cmml">
          ∼
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p2.1.m1.3.3.4" xref="S3.SS3.SSS3.p2.1.m1.3.3.4.cmml">
          𝒫
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.3b">
         <apply id="S3.SS3.SSS3.p2.1.m1.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3">
          <csymbol cd="latexml" id="S3.SS3.SSS3.p2.1.m1.3.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.3">
           similar-to
          </csymbol>
          <vector id="S3.SS3.SSS3.p2.1.m1.3.3.2.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2">
           <apply id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1">
            <times id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.1">
            </times>
            <ci id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2">
             𝑒
            </ci>
            <cn id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3">
             1
            </cn>
           </apply>
           <ci id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">
            𝑟
           </ci>
           <apply id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2">
            <times id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.1">
            </times>
            <ci id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2">
             𝑒
            </ci>
            <cn id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3">
             2
            </cn>
           </apply>
          </vector>
          <ci id="S3.SS3.SSS3.p2.1.m1.3.3.4.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.4">
           𝒫
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.3c">
         (e1,r,e2)\sim\mathcal{P}
        </annotation>
       </semantics>
      </math>
      . To address this optimization challenge, we adopt an online reinforcement learning policy gradient algorithm, Proximal Policy Optimization (PPO). PPO is a family of policy optimization methods that use multiple epochs of stochastic gradient ascent to perform each policy update. These methods have the stability and reliability of trust-region methods
      <cite class="ltx_cite ltx_citemacro_citep">
       (Schulman et al.,
       <a class="ltx_ref" href="#bib.bib18" title="">
        2017
       </a>
       )
      </cite>
      .
For value approximation, we include a three-layer feed-forward network with a single output for the value, given by:
     </p>
     <table class="ltx_equationgroup ltx_eqn_table" id="S3.E6">
      <tbody>
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6X">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathbf{V}" class="ltx_Math" display="inline" id="S3.E6X.2.1.1.m1.1">
          <semantics id="S3.E6X.2.1.1.m1.1a">
           <mi id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml">
            𝐕
           </mi>
           <annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b">
            <ci id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">
             𝐕
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">
            \displaystyle\mathbf{V}
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_td ltx_align_left ltx_eqn_cell">
         <math alttext="\displaystyle=\mathbf{W}_{\mathbf{3}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{2}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{1}}\left(s_{t}\right)\right)\right)\right)\right)" class="ltx_Math" display="inline" id="S3.E6X.3.2.2.m1.3">
          <semantics id="S3.E6X.3.2.2.m1.3a">
           <mrow id="S3.E6X.3.2.2.m1.3.3" xref="S3.E6X.3.2.2.m1.3.3.cmml">
            <mi id="S3.E6X.3.2.2.m1.3.3.3" xref="S3.E6X.3.2.2.m1.3.3.3.cmml">
            </mi>
            <mo id="S3.E6X.3.2.2.m1.3.3.2" xref="S3.E6X.3.2.2.m1.3.3.2.cmml">
             =
            </mo>
            <mrow id="S3.E6X.3.2.2.m1.3.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.cmml">
             <msub id="S3.E6X.3.2.2.m1.3.3.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.3.cmml">
              <mi id="S3.E6X.3.2.2.m1.3.3.1.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.3.2.cmml">
               𝐖
              </mi>
              <mn id="S3.E6X.3.2.2.m1.3.3.1.3.3" xref="S3.E6X.3.2.2.m1.3.3.1.3.3.cmml">
               𝟑
              </mn>
             </msub>
             <mo id="S3.E6X.3.2.2.m1.3.3.1.2" lspace="0em" rspace="0em" xref="S3.E6X.3.2.2.m1.3.3.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.cmml">
              <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.cmml">
               (
              </mo>
              <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
               <mi id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml">
                tanh
               </mi>
               <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1a" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
                ⁡
               </mo>
               <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
                 (
                </mo>
                <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">
                 <msub id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml">
                  <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">
                   𝐖
                  </mi>
                  <mn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">
                   𝟐
                  </mn>
                 </msub>
                 <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">
                  <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   <mi id="S3.E6X.3.2.2.m1.1.1" xref="S3.E6X.3.2.2.m1.1.1.cmml">
                    tanh
                   </mi>
                   <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    ⁡
                   </mo>
                   <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     (
                    </mo>
                    <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                     <msub id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                      <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                       𝐖
                      </mi>
                      <mn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                       𝟏
                      </mn>
                     </msub>
                     <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                      ​
                     </mo>
                     <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                      <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                       (
                      </mo>
                      <msub id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                       <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                        s
                       </mi>
                       <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                        t
                       </mi>
                      </msub>
                      <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                       )
                      </mo>
                     </mrow>
                    </mrow>
                    <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.3b">
            <apply id="S3.E6X.3.2.2.m1.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3">
             <eq id="S3.E6X.3.2.2.m1.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.2">
             </eq>
             <csymbol cd="latexml" id="S3.E6X.3.2.2.m1.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.3">
              absent
             </csymbol>
             <apply id="S3.E6X.3.2.2.m1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1">
              <times id="S3.E6X.3.2.2.m1.3.3.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2">
              </times>
              <apply id="S3.E6X.3.2.2.m1.3.3.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.3">
               <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.3">
                subscript
               </csymbol>
               <ci id="S3.E6X.3.2.2.m1.3.3.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.3.2">
                𝐖
               </ci>
               <cn id="S3.E6X.3.2.2.m1.3.3.1.3.3.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.3.3">
                3
               </cn>
              </apply>
              <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1">
               <ci id="S3.E6X.3.2.2.m1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2">
                tanh
               </ci>
               <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1">
                <times id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2">
                </times>
                <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.2">
                  𝐖
                 </ci>
                 <cn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.3">
                  2
                 </cn>
                </apply>
                <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">
                 <ci id="S3.E6X.3.2.2.m1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1">
                  tanh
                 </ci>
                 <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  <times id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                  </times>
                  <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                    subscript
                   </csymbol>
                   <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                    𝐖
                   </ci>
                   <cn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                    1
                   </cn>
                  </apply>
                  <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                    𝑠
                   </ci>
                   <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                    𝑡
                   </ci>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.3c">
            \displaystyle=\mathbf{W}_{\mathbf{3}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{2}}\left(\operatorname{tanh}\left(\mathbf{W}_{\mathbf{1}}\left(s_{t}\right)\right)\right)\right)\right)
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
         <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
          (6)
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S3.SS3.SSS3.p2.2">
      Significantly, the LLM remains frozen for both the actor and critic modules, with only the linear forward layer being trained.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p3">
     <p class="ltx_p" id="S3.SS3.SSS3.p3.1">
      <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p3.1.1">
       Replay Buffer
      </span>
      The replay buffer stores the triplets
      <math alttext="rb=(v_{c},s,logit,a,s^{{}^{\prime}},done)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.1.m1.6">
       <semantics id="S3.SS3.SSS3.p3.1.m1.6a">
        <mrow id="S3.SS3.SSS3.p3.1.m1.6.6" xref="S3.SS3.SSS3.p3.1.m1.6.6.cmml">
         <mrow id="S3.SS3.SSS3.p3.1.m1.6.6.6" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.cmml">
          <mi id="S3.SS3.SSS3.p3.1.m1.6.6.6.2" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.2.cmml">
           r
          </mi>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.6.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.1.cmml">
           ​
          </mo>
          <mi id="S3.SS3.SSS3.p3.1.m1.6.6.6.3" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.3.cmml">
           b
          </mi>
         </mrow>
         <mo id="S3.SS3.SSS3.p3.1.m1.6.6.5" xref="S3.SS3.SSS3.p3.1.m1.6.6.5.cmml">
          =
         </mo>
         <mrow id="S3.SS3.SSS3.p3.1.m1.6.6.4.4" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.5" stretchy="false" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           (
          </mo>
          <msub id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.cmml">
           <mi id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.2" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.2.cmml">
            v
           </mi>
           <mi id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.3" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.3.cmml">
            c
           </mi>
          </msub>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.6" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           ,
          </mo>
          <mi id="S3.SS3.SSS3.p3.1.m1.1.1" xref="S3.SS3.SSS3.p3.1.m1.1.1.cmml">
           s
          </mi>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.7" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           ,
          </mo>
          <mrow id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.cmml">
           <mi id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.2" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.2.cmml">
            l
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.3" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.3.cmml">
            o
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1a" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.4" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.4.cmml">
            g
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1b" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.5" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.5.cmml">
            i
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1c" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.6" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.6.cmml">
            t
           </mi>
          </mrow>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.8" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           ,
          </mo>
          <mi id="S3.SS3.SSS3.p3.1.m1.2.2" xref="S3.SS3.SSS3.p3.1.m1.2.2.cmml">
           a
          </mi>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.9" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           ,
          </mo>
          <msup id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.cmml">
           <mi id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.2" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.2.cmml">
            s
           </mi>
           <msup id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.cmml">
            <mi id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3a" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.cmml">
            </mi>
            <mo id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.1" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.1.cmml">
             ′
            </mo>
           </msup>
          </msup>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.10" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           ,
          </mo>
          <mrow id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.cmml">
           <mi id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.2" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.2.cmml">
            d
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.3" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.3.cmml">
            o
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1a" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.4" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.4.cmml">
            n
           </mi>
           <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1b" lspace="0em" rspace="0em" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1.cmml">
            ​
           </mo>
           <mi id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.5" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.5.cmml">
            e
           </mi>
          </mrow>
          <mo id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.11" stretchy="false" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.1.m1.6b">
         <apply id="S3.SS3.SSS3.p3.1.m1.6.6.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6">
          <eq id="S3.SS3.SSS3.p3.1.m1.6.6.5.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.5">
          </eq>
          <apply id="S3.SS3.SSS3.p3.1.m1.6.6.6.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.6">
           <times id="S3.SS3.SSS3.p3.1.m1.6.6.6.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.1">
           </times>
           <ci id="S3.SS3.SSS3.p3.1.m1.6.6.6.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.2">
            𝑟
           </ci>
           <ci id="S3.SS3.SSS3.p3.1.m1.6.6.6.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.6.3">
            𝑏
           </ci>
          </apply>
          <vector id="S3.SS3.SSS3.p3.1.m1.6.6.4.5.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4">
           <apply id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1">
             subscript
            </csymbol>
            <ci id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.2">
             𝑣
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.3.3.1.1.1.3">
             𝑐
            </ci>
           </apply>
           <ci id="S3.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1">
            𝑠
           </ci>
           <apply id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2">
            <times id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.1">
            </times>
            <ci id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.2">
             𝑙
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.3">
             𝑜
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.4.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.4">
             𝑔
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.5.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.5">
             𝑖
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.6.cmml" xref="S3.SS3.SSS3.p3.1.m1.4.4.2.2.2.6">
             𝑡
            </ci>
           </apply>
           <ci id="S3.SS3.SSS3.p3.1.m1.2.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.2.2">
            𝑎
           </ci>
           <apply id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3">
            <csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3">
             superscript
            </csymbol>
            <ci id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.2">
             𝑠
            </ci>
            <apply id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3">
             <ci id="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.5.5.3.3.3.3.1">
              ′
             </ci>
            </apply>
           </apply>
           <apply id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4">
            <times id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.1">
            </times>
            <ci id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.2">
             𝑑
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.3">
             𝑜
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.4.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.4">
             𝑛
            </ci>
            <ci id="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.5.cmml" xref="S3.SS3.SSS3.p3.1.m1.6.6.4.4.4.5">
             𝑒
            </ci>
           </apply>
          </vector>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.1.m1.6c">
         rb=(v_{c},s,logit,a,s^{{}^{\prime}},done)
        </annotation>
       </semantics>
      </math>
      of the reflection prompt, indicating the current entity, the current state, logits, the selected action, the next state, and whether the episode has ended. The reason for recording the current entity is that we need to get all exit paths of the current entity for further fusion
      <a class="ltx_ref" href="#S3.E4" title="Equation 4 ‣ 3.3.2 Agent ‣ 3.3 LLM-ARK ‣ 3 Methods ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </a>
      .
     </p>
    </div>
   </section>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Experiments and Results
  </h2>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Datasets
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     OpenDialKG is a publicly available parallel corpus of conversations and Knowledge Graphs consisting of 91,000 conversations, each supplemented by paths connecting Knowledge Graph entities and their relationships. The purpose of the corpus is to present the implicit reasoning processes of human dialog as explicit computer operations on the Knowledge Graph. Following previous work described in
     <cite class="ltx_cite ltx_citemacro_citet">
      Moon et al. (
      <a class="ltx_ref" href="#bib.bib12" title="">
       2019
      </a>
      )
     </cite>
     , we split this dataset into a 70% training set, a 15% validation set, and a 15% test set.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Baselines
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     We compared our results with these baseline models: Tri-LSTM, Seq2Seq, Seq2Path, DialKG Walker
     <cite class="ltx_cite ltx_citemacro_citep">
      (Young et al.,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2018
      </a>
      ; Moon et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2019
      </a>
      )
     </cite>
     , DiffKG, AttnFlow, AttnIO
     <cite class="ltx_cite ltx_citemacro_citep">
      (Jung et al.,
      <a class="ltx_ref" href="#bib.bib6" title="">
       2020
      </a>
      )
     </cite>
     and HiTKG
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ni et al.,
      <a class="ltx_ref" href="#bib.bib13" title="">
       2022
      </a>
      )
     </cite>
     .
HiTKG is a hierarchical transformer-based tool that uses diverse inputs to predict KG paths. Our team chose HiTKG as a strong baseline. To evaluate the performance of the state-of-the-art LLMs on the KG inference task, we designed three prompt methods: GPT4-Standard, GPT4-Normal and GPT4-OPA. The difference between GPT4-Standard, GPT4-Normal is that GPT4-Normal has more awareness of dialog context and path history, while GPT4-OPA has more awareness of 2-hop exit path subgraphs compared to the former two. See appendix
     <a class="ltx_ref" href="#A1.SS4" title="A.4 GPT4 Prompts ‣ Appendix A Appendix ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       A.4
      </span>
     </a>
     for full prompt.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    Implement Details
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS3.p1">
    <p class="ltx_p" id="S4.SS3.p1.1">
     The training was conducted on A40. Informed by prior research from
     <cite class="ltx_cite ltx_citemacro_citet">
      Jung et al. (
      <a class="ltx_ref" href="#bib.bib6" title="">
       2020
      </a>
      ); Ni et al. (
      <a class="ltx_ref" href="#bib.bib13" title="">
       2022
      </a>
      )
     </cite>
     , we pre-trained the knowledge graph using TransE
     <cite class="ltx_cite ltx_citemacro_citep">
      (Fan et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2014
      </a>
      )
     </cite>
     based on this GitHub repository
     <span class="ltx_note ltx_role_footnote" id="footnote2">
      <sup class="ltx_note_mark">
       2
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         2
        </sup>
        <span class="ltx_tag ltx_tag_note">
         2
        </span>
        <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/thunlp/OpenKE" target="_blank" title="">
         https://github.com/thunlp/OpenKE
        </a>
       </span>
      </span>
     </span>
     . The objective was to unearth and explore entity relationships, expand the knowledge graph for connection prediction, and enable diverse reward function design. To facilitate reproducibility, we adopt an open-source
LLM, i.e., LLaMA-2-7B
     <cite class="ltx_cite ltx_citemacro_citep">
      (Touvron et al.,
      <a class="ltx_ref" href="#bib.bib24" title="">
       2023b
      </a>
      )
     </cite>
     . To reduce GPU memory usage and increase the pace of training, all experiments - excluding LLaMA-2-7B-ARK-FP32 were carried out with BFLOAT16
     <cite class="ltx_cite ltx_citemacro_citep">
      (Kalamkar et al.,
      <a class="ltx_ref" href="#bib.bib7" title="">
       2019
      </a>
      )
     </cite>
     half-precision format. Since all true paths in OpenDialKG are at most 2 hops, we set the maximum path length to
     <math alttext="t=2" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1">
      <semantics id="S4.SS3.p1.1.m1.1a">
       <mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">
        <mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">
         t
        </mi>
        <mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">
         2
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b">
        <apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">
         <eq id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1">
         </eq>
         <ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">
          𝑡
         </ci>
         <cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">
        t=2
       </annotation>
      </semantics>
     </math>
     . We included ”Equal” to ensure that the model stops automatically after the second hop. To ensure fairness, we randomly shuffled the exit paths of the knowledge graph. We set max patience to 5, meaning that training is terminated if there is no boost for 5 rewards on the validation set. Further information on the hyperparameters is available in the Appendix
     <a class="ltx_ref" href="#A1.T8" title="Table 8 ‣ A.5 HyperParameters ‣ Appendix A Appendix ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.4
    </span>
    Evaluation Metrics
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS4.p1">
    <p class="ltx_p" id="S4.SS4.p1.1">
     In line with the baselines, we utilize recall@k as the evaluation metric for both path-level (path@k) and target entity-level (target@k) correctness.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.5
    </span>
    Comparative Experiments
   </h3>
   <figure class="ltx_table" id="S4.T1">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.1" style="width:433.6pt;height:183.5pt;vertical-align:-0.7pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-82.0pt,34.6pt) scale(0.725486284579586,0.725486284579586) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1.1">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S4.T1.1.1.1.1">
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1.1" rowspan="2">
          <span class="ltx_text" id="S4.T1.1.1.1.1.1.1">
           Model
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S4.T1.1.1.1.1.2">
          path@k
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S4.T1.1.1.1.1.3">
          target@k
         </th>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.2.2">
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.1">
          path@1
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.2">
          path@3
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.3">
          path@5
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.4">
          path@10
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.5">
          path@25
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.6">
          target@1
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.7">
          target@3
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.8">
          target@5
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.9">
          target@10
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.2.2.10">
          target@25
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S4.T1.1.1.3.1">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.1">
          Tri-LSTM
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.2">
          3.2
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.3">
          14.2
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.4">
          22.6
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.5">
          36.3
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.6">
          56.2
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.7">
          -
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.8">
          -
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.9">
          -
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.10">
          -
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3.1.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.4.2">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.1">
          Seq2Seq
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.2">
          3.1
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.3">
          18.3
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.4">
          29.7
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.5">
          44.1
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.6">
          60.2
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.7">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.8">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.9">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.4.2.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.5.3">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.1">
          DialKG Walker
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.2">
          13.2
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.3">
          26.1
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.4">
          35.3
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.5">
          47.9
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.6">
          62.2
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.7">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.8">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.9">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.3.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.6.4">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.1">
          Seq2Path
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.2">
          14.92
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.3">
          24.95
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.4">
          31.1
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.5">
          38.68
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.6">
          48.15
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.7">
          15.65
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.8">
          27.04
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.9">
          33.86
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.10">
          42.52
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.6.4.11">
          53.28
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.7.5">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.1">
          AttnFlow
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.2">
          17.37
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.3">
          24.84
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.4">
          30.68
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.5">
          39.48
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.6">
          51.4
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.7">
          18.97
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.8">
          36.23
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.9">
          45.48
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.10">
          58.84
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.7.5.11">
          71.35
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.8.6">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.1">
          AttnIO
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.2">
          23.72
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.3">
          37.53
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.4">
          43.57
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.5">
          52.17
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.6">
          62.86
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.7">
          24.98
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.8">
          43.78
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.9">
          53.49
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.10">
          65.48
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.8.6.11">
          78.79
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.9.7">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.1">
          HiTKG
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.2">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.9.7.2.1">
           25.99
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.3">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.9.7.3.1">
           38.67
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.4">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.9.7.4.1">
           49.18
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.5">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.9.7.5.1">
           59.32
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.6">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.9.7.6.1">
           71.27
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.7">
          31.11
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.8">
          46.29
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.9">
          55.59
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.10">
          71.61
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.9.7.11">
          86.09
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.10.8">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.1">
          T5-DiffKG
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.2">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.3">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.4">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.5">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.6">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.7">
          26.80
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.8">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.10.8.8.1">
           54.33
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.9">
          61.75
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.10.8.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.11.9">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.1">
          GPT-4-Standard
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.2">
          0.007
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.3">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.4">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.5">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.6">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.7">
          14.91
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.8">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.9">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.11.9.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.12.10">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.1">
          GPT-4-Normal
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.2">
          0.02
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.3">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.4">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.5">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.6">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.7">
          13.30
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.8">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.9">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.12.10.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.13.11">
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.1">
          GPT-4-OPA
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.2">
          0.09
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.3">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.4">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.5">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.6">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.7">
          12.19
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.8">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.9">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.10">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T1.1.1.13.11.11">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T1.1.1.14.12">
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.1">
          LLaMA-2-7B-ARK
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.2">
          16.59
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.3">
          27.17
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.4">
          34.85
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.5">
          47.88
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.6">
          62.32
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.7">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.14.12.7.1">
           36.39
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.8">
          53.63
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.9">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.14.12.9.1">
           65.68
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.10">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.14.12.10.1">
           80.20
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.14.12.11">
          <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.14.12.11.1">
           89.68
          </span>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 1:
     </span>
     Path-level (path@k) and target-level (target@k) performance of KG path reasoning. LLM-ARK is benchmarked against several state-of-the-art baselines models on the OpenDialKG dataset.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p1">
    <p class="ltx_p" id="S4.SS5.p1.1">
     For the KG reasoning task, we assessed path recall at different K values (1, 3, 5, 10, 25) and target entity recall at position K (1, 3, 5, 10, 25). As presented in Table
     <a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Results ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , the result demonstrate that our proposed model LLaMA-2-7b-ARK performs better than all benchmarked baselines in target@1, 5, 10, 25 metrics. The performance gain is signifcant, especially in recalls with taget@1, 10: there is a 5.28% relative improvement in target@1 and 9.59% in target@10. Unfortunately, our model’s path@k evaluation matrix socores do not outperform the current state-of-the-art (SOTA) model HiTKG because we trained using only the target arrival reward function, but we are very extensible and there is potential for improvement. As described in this paper, we evaluate the performance of GPT-4 in performing dialog inference using manual prompt constructed with different environmental information. Therefore, we also report the performance of GPT-4 with different prompts on the same dataset.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p2">
    <p class="ltx_p" id="S4.SS5.p2.1">
     At the decoding stage of AttnIO, AttnFlow and DiffKG, KG paths are predicted by scoring entity paths and relation paths respectively, and then rerank which makes it harder to achieve optimum. While a KG triple is composed of both, our model uses PA-MLP to aggregate all the exit path information to improve the perception of the agent, which is a more reasonable modeling approach.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p3">
    <p class="ltx_p" id="S4.SS5.p3.1">
     HiTKG is state-of-the-art KG walker, which build
a multi-hierarchy attention block to aggregate the multiscale information. However, different types of input data sources are difficult to aggregate, and how well they are aggregated directly affects the performance of the model. We unify all the multi-scale input sources into the prompt, and due to the large model has a large number of instruction comprehension ability to get a rich information encoding representation.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p4">
    <p class="ltx_p" id="S4.SS5.p4.1">
     The GPT-4-Standard and GPT-4-Normal methods are deficient in path awareness. GPT-4-OPA exhibit improved outcomes with the addition of path awareness. The generation of GPT-4 paths is entirely dependent on the background knowledge in the dataset during the training phase, and the GPT-4 generative model itself is not designed for sequential decision-making tasks, and achieving such a score has impressed us. Although we added states to GPT-4 through prompt, this is limited by the length of the prompt, which is fundamentally due to the fact that GPT-4 is inherently memoryless. Based on these factors, optimizing GPT-4 on multi-hop inference datasets of the Knowledge Graph to further improve its performance, generating human-preferred inference paths on large-scale Knowledge Graph datasets is still a challenge.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p5">
    <p class="ltx_p" id="S4.SS5.p5.1">
     Considering LLMs as agents that explore a knowledge graph to acquire experience can benefit benefits from the positive-negative feedback optimization mechanism of the Reinforcement Learning Policy Supervisor Algorithm. This method enhances the training of our model to perform flexible reasoning on KGs in multi-step scenarios, outperforming not only GPT-4 but also smaller models. The model’s superior performance corroborates the effectiveness of our approach.
    </p>
   </div>
   <figure class="ltx_table" id="S4.T2">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.1" style="width:433.6pt;height:88.2pt;vertical-align:-0.7pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-95.4pt,19.2pt) scale(0.694500514966282,0.694500514966282) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.1.1">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S4.T2.1.1.1.1">
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.1.1" rowspan="2">
          <span class="ltx_text" id="S4.T2.1.1.1.1.1.1">
           Model
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S4.T2.1.1.1.1.2">
          path@k
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S4.T2.1.1.1.1.3">
          target@k
         </th>
        </tr>
        <tr class="ltx_tr" id="S4.T2.1.1.2.2">
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.1">
          path@1
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.2">
          path@3
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.3">
          path@5
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.4">
          path@10
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.5">
          path@25
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.6">
          target@1
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.7">
          target@3
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.8">
          target@5
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.9">
          target@10
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.10">
          target@25
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S4.T2.1.1.3.1">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.1">
          LLaMA-2-7B-ARK
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.2">
          16.59
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.3">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.3.1">
           27.17
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.4">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.4.1">
           34.85
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.5">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.5.1">
           47.88
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.6">
          62.32
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.7">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.7.1">
           36.39
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.8">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.8.1">
           53.63
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.9">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.9.1">
           65.68
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.10">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.3.1.10.1">
           80.20
          </span>
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.11">
          89.68
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.1.1.4.2">
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.1">
          LLaMA-2-7B-ARK-UI
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.2">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.2.2.1">
           16.87
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.3">
          27.01
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.4">
          34.35
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.5">
          47.67
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.6">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.2.6.1">
           63.03
          </span>
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.7">
          34.70
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.8">
          52.02
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.9">
          62.66
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.10">
          78.09
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.11">
          88.65
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.1.1.5.3">
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.1">
          LLaMA-2-7B-ARK-FP32
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.2">
          14.59
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.3">
          24.64
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.4">
          32.24
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.5">
          45.80
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.6">
          61.75
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.7">
          34.35
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.8">
          52.57
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.9">
          62.51
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.10">
          79.18
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.11">
          88.51
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.1.1.6.4">
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.1">
          LLaMA-2-7B-ARK-WT
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.2">
          1.10
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.3">
          3.44
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.4">
          5.71
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.5">
          10.47
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.6">
          15.42
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.7">
          9.45
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.8">
          19.46
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.9">
          50.94
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.10">
          71.43
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.11">
          <span class="ltx_text ltx_font_bold" id="S4.T2.1.1.6.4.11.1">
           94.03
          </span>
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.1.1.7.5">
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.1">
          LLaMA-2-7B-ARK-WP
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.2">
          0.98
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.3">
          2.53
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.4">
          3.28
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.5">
          4.88
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.6">
          5.52
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.7">
          18.90
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.8">
          40.67
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.9">
          54.76
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.10">
          77.25
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.7.5.11">
          93.08
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     Path-level (path@k) and target-level (target@k) performance of supervised KG path reasoning ( metric:
recall@k). LLM-ARK is benchmarked against several ablation models on the OpenDialKG dataset.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S4.T3">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.5" style="width:433.6pt;height:280.8pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-101.0pt,65.4pt) scale(0.682297773355532,0.682297773355532) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.5.5">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S4.T3.5.5.6.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3" id="S4.T3.5.5.6.1.1">
          <table class="ltx_tabular ltx_align_middle" id="S4.T3.5.5.6.1.1.1">
           <tr class="ltx_tr" id="S4.T3.5.5.6.1.1.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.6.1.1.1.1.1">
             ### Task Background:
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.6.1.1.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.6.1.1.1.2.1">
             Performing 2-hop reasoning on the knowledge graph.
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.6.1.1.1.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.6.1.1.1.3.1">
             ### Instruction
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.6.1.1.1.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.6.1.1.1.4.1">
             If you don’t think it’s necessary to perform the second hop in reasoning, stop the reasoning with the ’Equal’ relation.
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.6.1.1.1.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.6.1.1.1.5.1">
             Given the Task Background and the Environment, directly output this path in triplet format without any other content.
            </td>
           </tr>
          </table>
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S4.T3.5.5.7.1">
         <td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.5.5.7.1.1" rowspan="3">
          <span class="ltx_text" id="S4.T3.5.5.7.1.1.1">
           Success
          </span>
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.5.5.7.1.2">
          FTE
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.5.5.7.1.3">
          <table class="ltx_tabular ltx_align_middle" id="S4.T3.5.5.7.1.3.1">
           <tr class="ltx_tr" id="S4.T3.5.5.7.1.3.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.7.1.3.1.1.1">
             ### Environment:
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.7.1.3.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.7.1.3.1.2.1">
             Dialog History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.7.1.3.1.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.7.1.3.1.3.1">
             Utterance: Could you recommend popular books by Gail Carson Levine?
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.7.1.3.1.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.7.1.3.1.4.1">
             Path History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.5.5.7.1.3.1.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.5.5.7.1.3.1.5.1">
             Current Entity: Gail Carson Levine
            </td>
           </tr>
          </table>
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T3.1.1.1">
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.1.1.1.2">
          Ground Truth Path
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1">
          [”Gail Carson Levine”,”
          <math alttext="\sim" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1">
           <semantics id="S4.T3.1.1.1.1.m1.1a">
            <mo id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">
             ∼
            </mo>
            <annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b">
             <csymbol cd="latexml" id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">
              similar-to
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">
             \sim
            </annotation>
           </semantics>
          </math>
          written_by”,”The Two Princesses of Bamarre”]
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T3.2.2.2">
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.2.2.2.2">
          LLM-ARK Reasoning Path
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.2.2.2.1">
          [[”Gail Carson Levine”,”
          <math alttext="\sim" class="ltx_Math" display="inline" id="S4.T3.2.2.2.1.m1.1">
           <semantics id="S4.T3.2.2.2.1.m1.1a">
            <mo id="S4.T3.2.2.2.1.m1.1.1" xref="S4.T3.2.2.2.1.m1.1.1.cmml">
             ∼
            </mo>
            <annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.1.m1.1b">
             <csymbol cd="latexml" id="S4.T3.2.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.2.1.m1.1.1">
              similar-to
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.T3.2.2.2.1.m1.1c">
             \sim
            </annotation>
           </semantics>
          </math>
          written_by”,”The Two Princesses of Bamarre”], [”The Two Princesses of Bamarre”,”Equal”,”The Two Princesses of Bamarre”]]
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T3.3.3.3">
         <td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.3.3.3.2" rowspan="3">
          <span class="ltx_text" id="S4.T3.3.3.3.2.1">
           Failed
          </span>
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.3.3.3.3">
          FTE
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.3.3.3.1">
          <table class="ltx_tabular ltx_align_middle" id="S4.T3.3.3.3.1.1">
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.2.1">
             ### Environment:
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.3.1">
             Dialog History: [”user: Can you recommend a movie like the Shooter?”,
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.4.1">
             ”assistant: A movie similar to Shooter is Nothing to Lose.”]
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.5.1">
             Utterance: ”Ok who is in that one?”
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.1.1">
             Path History: [[”Shooter”,”has_genre”,”Thriller”],[”Thriller”,”
             <math alttext="\sim" class="ltx_Math" display="inline" id="S4.T3.3.3.3.1.1.1.1.m1.1">
              <semantics id="S4.T3.3.3.3.1.1.1.1.m1.1a">
               <mo id="S4.T3.3.3.3.1.1.1.1.m1.1.1" xref="S4.T3.3.3.3.1.1.1.1.m1.1.1.cmml">
                ∼
               </mo>
               <annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.1.1.1.1.m1.1b">
                <csymbol cd="latexml" id="S4.T3.3.3.3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.3.3.3.1.1.1.1.m1.1.1">
                 similar-to
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S4.T3.3.3.3.1.1.1.1.m1.1c">
                \sim
               </annotation>
              </semantics>
             </math>
             has_genre”,”Nothing to Lose”],[”Nothing to Lose”,”starred_actors”,”Michael McKean”]]
            </td>
           </tr>
           <tr class="ltx_tr" id="S4.T3.3.3.3.1.1.6">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T3.3.3.3.1.1.6.1">
             Current Entity: ”Michael McKean”
            </td>
           </tr>
          </table>
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T3.4.4.4">
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.4.4.4.2">
          Ground Truth Path
         </td>
         <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.4.4.4.1">
          [”Michael McKean”,”
          <math alttext="\sim" class="ltx_Math" display="inline" id="S4.T3.4.4.4.1.m1.1">
           <semantics id="S4.T3.4.4.4.1.m1.1a">
            <mo id="S4.T3.4.4.4.1.m1.1.1" xref="S4.T3.4.4.4.1.m1.1.1.cmml">
             ∼
            </mo>
            <annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.1.m1.1b">
             <csymbol cd="latexml" id="S4.T3.4.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1">
              similar-to
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.T3.4.4.4.1.m1.1c">
             \sim
            </annotation>
           </semantics>
          </math>
          starred_actors”,”Nothing to Lose”]
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T3.5.5.5">
         <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.5.5.5.2">
          LLM-ARK Reasoning Path
         </td>
         <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.5.5.5.1">
          [[”Michael McKean”,”
          <math alttext="\sim" class="ltx_Math" display="inline" id="S4.T3.5.5.5.1.m1.1">
           <semantics id="S4.T3.5.5.5.1.m1.1a">
            <mo id="S4.T3.5.5.5.1.m1.1.1" xref="S4.T3.5.5.5.1.m1.1.1.cmml">
             ∼
            </mo>
            <annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.1.m1.1b">
             <csymbol cd="latexml" id="S4.T3.5.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.5.1.m1.1.1">
              similar-to
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.T3.5.5.5.1.m1.1c">
             \sim
            </annotation>
           </semantics>
          </math>
          starred_actors”,”Used Cars”],[”Used Cars”, ”Equal”, ”Used Cars”]]
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     Successes and failures of our model when performing inference tasks on the OpenDialKG dataset.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S4.SS6">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.6
    </span>
    Analysis Experiment
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS6.p1">
    <p class="ltx_p" id="S4.SS6.p1.1">
     As shown in Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Results ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , LLM-ARK was benchmarked against multiple ablation models on the OpenDialKG dataset.
     <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.1">
      (1)
     </span>
     First, to evaluate the impact of instructions on model performance, we trained the LLaMA-2-7B-ARK-UI model without instruction. The results of this model are the closest to those of LLaMA-2-7B-ARK, indicating that the presence or absence of commands has an effect on the model’s results, but not a serious one.
     <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.2">
      (2)
     </span>
     Then, we have implemented IEEE 754 floating-point format (FP32) operations for our experiments. The results show that using the BFLOAT16 tensor for training, recall@K gives better results than FP32 without changing the hyperparameters.
     <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.3">
      (3)
     </span>
     Next, LLaMA-2-7B-ARK-WT that was trained by randomly initializing relation and entity embedding. The decrease in performance indicates that the absence of knowledge graph representation learning has negatively impacted the training process.
     <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.4">
      (4)
     </span>
     We conducted the fourth ablation experiment LLaMA-2-7B-ARK-WP and found that the performance of our export environment-aware sub-module PA-MLP decreases substantially if we do not consider the exit paths. The score for path@1 is only 0.98%, which is 15.61% lower than LLaMA-2-7B-ARK. These ablation experiments and results demonstrate the contribution and necessity of our subcomponents to the model.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS7">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.7
    </span>
    Case Study
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS7.p1">
    <p class="ltx_p" id="S4.SS7.p1.1">
     We resort to a case study, for a clear
presentation of LLM-ARK’s path reasoning process as shown in Table
     <a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Results ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     .
Note that there are hundreds of neighbor nodes connected to each entity in the external KG. Intuitively, there could be diverse knowledge paths as response to the user’s question.
As the success story shows, our model makes good use of FTE information and exit path information to make decisions, rather than making decisions based on relationships alone, because Gail Carson Levine’s work is not limited to The Two Princesses of Bamarre.
As shown in the error case, our model still reasons about wrong paths, partly due to the dataset itself, because OpenDialKG is an open-domain conversational knowledge graph inference dataset, and similar contexts and the same starting entities in the training set choose different Groud Truth exit paths, and so it can interfere with the training of our model. It is worth mentioning that OpenDialKG is not a unique path inference; there are many potential paths to reach the target entity. To summarize, our model would have the potential for better performance on non-open-domain conversational knowledge graph inference datasets.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Conclusion
  </h2>
  <div class="ltx_para ltx_noindent" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    This paper evaluates the ability of current state-of-the-art LLM-based dialog systems in handling KG conversational reasoning tasks. To enhance LLM’s performance on this task, we introduce LLM-ARK, a full-text environment-aware Knowledge Graph inference agent optimized using online reinforcement learning. Empirical analysis demonstrates that our model outperforms GPT-4 and smaller models. The experiments also sheds light on the model’s performance can be seriously affected by the mismatch between the LLMs and the environment information. Our method can inspire subsequent researchers to pay attention to the critical role of considering various factors during model optimization in the field of LLM-based conversational KG reasoning tasks.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Carta et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Thomas Carta, Clément Romac, Thomas Wolf, Sylvain Lamprier, Olivier Sigaud,
and Pierre-Yves Oudeyer. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2302.02662" target="_blank" title="">
      Grounding large language
models in interactive environments with online reinforcement learning
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Dong et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Yue Dong, John Wieting, and Pat Verga. 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2204.13761" target="_blank" title="">
      Faithful to the document or
to the world? mitigating hallucinations via entity-linked knowledge in
abstractive summarization
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Du et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yuqing Du, Olivia Watkins, Zihan Wang, Cédric Colas, Trevor Darrell, Pieter
Abbeel, Abhishek Gupta, and Jacob Andreas. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v202/du23f.html" target="_blank" title="">
      Guiding
pretraining in reinforcement learning with large language models
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      Proceedings of the 40th International Conference on Machine
Learning
     </em>
     , volume 202 of
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.2.2">
      Proceedings of Machine Learning Research
     </em>
     ,
pages 8657–8677. PMLR.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Fan et al. [2014]
    </span>
    <span class="ltx_bibblock">
     Miao Fan, Qiang Zhou, Emily Chang, and Thomas Fang Zheng. 2014.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://aclanthology.org/Y14-1039" target="_blank" title="">
      Transition-based knowledge
graph embedding with relational mapping properties
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      Proceedings of the 28th Pacific Asia Conference on Language,
Information and Computing
     </em>
     , pages 328–337, Phuket,Thailand. Department of
Linguistics, Chulalongkorn University.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Wenlong Huang, Fei Xia, Ted Xiao, Harris Chan, Jacky Liang, Pete Florence, Andy
Zeng, Jonathan Tompson, Igor Mordatch, Yevgen Chebotar, Pierre Sermanet, Noah
Brown, Tomas Jackson, Linda Luu, Sergey Levine, Karol Hausman, and Brian
Ichter. 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2207.05608" target="_blank" title="">
      Inner monologue: Embodied
reasoning through planning with language models
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jung et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Jaehun Jung, Bokyung Son, and Sungwon Lyu. 2020.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.emnlp-main.280" target="_blank" title="">
      AttnIO:
Knowledge Graph Exploration with In-and-Out Attention Flow for
Knowledge-Grounded Dialogue
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      Proceedings of the 2020 Conference on Empirical Methods in
Natural Language Processing (EMNLP)
     </em>
     , pages 3484–3497, Online. Association
for Computational Linguistics.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kalamkar et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Dhiraj Kalamkar, Dheevatsa Mudigere, Naveen Mellempudi, Dipankar Das, Kunal
Banerjee, Sasikanth Avancha, Dharma Teja Vooturi, Nataraj Jammalamadaka,
Jianyu Huang, Hector Yuen, Jiyan Yang, Jongsoo Park, Alexander Heinecke,
Evangelos Georganas, Sudarshan Srinivasan, Abhisek Kundu, Misha Smelyanskiy,
Bharat Kaul, and Pradeep Dubey. 2019.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1905.12322" target="_blank" title="">
      A study of bfloat16 for deep
learning training
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kazemi et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Mehran Kazemi, Najoung Kim, Deepti Bhatia, Xin Xu, and Deepak Ramachandran.
2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2212.13894" target="_blank" title="">
      Lambada: Backward chaining
for automated reasoning in natural language
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lai et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Viet Dac Lai, Nghia Trung Ngo, Amir Pouran Ben Veyseh, Hieu Man, Franck
Dernoncourt, Trung Bui, and Thien Huu Nguyen. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2304.05613" target="_blank" title="">
      Chatgpt beyond english:
Towards a comprehensive evaluation of large language models in multilingual
learning
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Aiwei Liu, Xuming Hu, Lijie Wen, and Philip S. Yu. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2303.13547" target="_blank" title="">
      A comprehensive evaluation
of chatgpt’s zero-shot text-to-sql capability
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Luo et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Linhao Luo, Yuan-Fang Li, Gholamreza Haffari, and Shirui Pan. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2310.01061" target="_blank" title="">
      Reasoning on graphs:
Faithful and interpretable large language model reasoning
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Moon et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Seungwhan Moon, Pararth Shah, Anuj Kumar, and Rajen Subba. 2019.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/P19-1081" target="_blank" title="">
      OpenDialKG:
Explainable conversational reasoning with attention-based walks over
knowledge graphs
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      Proceedings of the 57th Annual Meeting of the Association
for Computational Linguistics
     </em>
     , pages 845–854, Florence, Italy. Association
for Computational Linguistics.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ni et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Jinjie Ni, Vlad Pandelea, Tom Young, Haicang Zhou, and Erik Cambria. 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.1609/aaai.v36i10.21360" target="_blank" title="">
      Hitkg: Towards
goal-oriented conversations via multi-hierarchy learning
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      Proceedings of the AAAI Conference on Artificial Intelligence
     </em>
     ,
36(10):11112–11120.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI [2023]
    </span>
    <span class="ltx_bibblock">
     OpenAI. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2303.08774" target="_blank" title="">
      Gpt-4 technical report
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela
Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John
Schulman, Jacob Hilton, Fraser Kelton, Luke E. Miller, Maddie Simens, Amanda
Askell, Peter Welinder, Paul Francis Christiano, Jan Leike, and Ryan J. Lowe.
2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://api.semanticscholar.org/CorpusID:246426909" target="_blank" title="">
      Training
language models to follow instructions with human feedback
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      ArXiv
     </em>
     , abs/2203.02155.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Peng et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Baolin Peng, Michel Galley, Pengcheng He, Hao Cheng, Yujia Xie, Yu Hu, Qiuyuan
Huang, Lars Liden, Zhou Yu, Weizhu Chen, and Jianfeng Gao. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2302.12813" target="_blank" title="">
      Check your facts and try
again: Improving large language models with external knowledge and automated
feedback
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Rawte et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Vipula Rawte, Swagata Chakraborty, Agnibh Pathak, Anubhav Sarkar, S.M
Towhidul Islam Tonmoy, Aman Chadha, Amit Sheth, and Amitava Das. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.emnlp-main.155" target="_blank" title="">
      The
troubling emergence of hallucination in large language models - an extensive
definition, quantification, and prescriptive remediations
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      Proceedings of the 2023 Conference on Empirical Methods in
Natural Language Processing
     </em>
     , pages 2541–2573, Singapore. Association for
Computational Linguistics.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. [2017]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
2017.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1707.06347" target="_blank" title="">
      Proximal policy optimization
algorithms
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      CoRR
     </em>
     , abs/1707.06347.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shakarian et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Paulo Shakarian, Abhinav Koyyalamudi, Noel Ngu, and Lakshmivihari Mareedu.
2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2302.13814" target="_blank" title="">
      An independent evaluation of
chatgpt on mathematical word problems (mwp)
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Federico Cassano, Edward Berman, Ashwin Gopinath, Karthik
Narasimhan, and Shunyu Yao. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2303.11366" target="_blank" title="">
      Reflexion: Language agents
with verbal reinforcement learning
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Singh et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Ishika Singh, Valts Blukis, Arsalan Mousavian, Ankit Goyal, Danfei Xu, Jonathan
Tremblay, Dieter Fox, Jesse Thomason, and Animesh Garg. 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2209.11302" target="_blank" title="">
      Progprompt: Generating
situated robot task plans using large language models
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sun et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Jiashuo Sun, Chengjin Xu, Lumingyuan Tang, Saizhuo Wang, Chen Lin, Yeyun Gong,
Lionel M. Ni, Heung-Yeung Shum, and Jian Guo. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2307.07697" target="_blank" title="">
      Think-on-graph: Deep and
responsible reasoning of large language model on knowledge graph
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro,
Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume
Lample. 2023a.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2302.13971" target="_blank" title="">
      Llama: Open and efficient
foundation language models
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem
Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar
Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux,
Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier
Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew
Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan
Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang,
Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan
Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien
Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom.
2023b.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2307.09288" target="_blank" title="">
      Llama 2: Open foundation and
fine-tuned chat models
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Tuan et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Yi-Lin Tuan, Sajjad Beygi, Maryam Fazel-Zarandi, Qiaozi Gao, Alessandra
Cervone, and William Yang Wang. 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.findings-acl.33" target="_blank" title="">
      Towards
large-scale interpretable knowledge graph reasoning for dialogue systems
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      Findings of the Association for Computational Linguistics:
ACL 2022
     </em>
     , pages 383–395, Dublin, Ireland. Association for Computational
Linguistics.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Tucker et al. [2018]
    </span>
    <span class="ltx_bibblock">
     George Tucker, Surya Bhupatiraju, Shixiang Gu, Richard E. Turner, Zoubin
Ghahramani, and Sergey Levine. 2018.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/1802.10031" target="_blank" title="">
      The mirage of
action-dependent baselines in reinforcement learning
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia,
Ed Chi, Quoc Le, and Denny Zhou. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2201.11903" target="_blank" title="">
      Chain-of-thought prompting
elicits reasoning in large language models
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Weiran Yao, Shelby Heinecke, Juan Carlos Niebles, Zhiwei Liu, Yihao Feng,
Le Xue, Rithesh Murthy, Zeyuan Chen, Jianguo Zhang, Devansh Arpit, Ran Xu,
Phil Mui, Huan Wang, Caiming Xiong, and Silvio Savarese. 2023.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2308.02151" target="_blank" title="">
      Retroformer: Retrospective
large language agents with policy gradient optimization
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Young et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Tom Young, Erik Cambria, Iti Chaturvedi, Hao Zhou, Subham Biswas, and Minlie
Huang. 2018.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.1609/aaai.v32i1.11923" target="_blank" title="">
      Augmenting
end-to-end dialogue systems with commonsense knowledge
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Proceedings of the AAAI Conference on Artificial Intelligence
     </em>
     ,
32(1).
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yu et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Chao Yu, Akash Velu, Eugene Vinitsky, Jiaxuan Gao, Yu Wang, Alexandre Bayen,
and Yi Wu. 2022.
    </span>
    <span class="ltx_bibblock">
     The surprising effectiveness of PPO in cooperative multi-agent
games.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      Thirty-sixth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Houyu Zhang, Zhenghao Liu, Chenyan Xiong, and Zhiyuan Liu. 2020.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.acl-main.184" target="_blank" title="">
      Grounded
conversation generation as guided traverses in commonsense knowledge graphs
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">
      Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics
     </em>
     , pages 2031–2043, Online. Association for
Computational Linguistics.
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Appendix
  </h2>
  <figure class="ltx_table" id="A1.T4">
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T4.1" style="width:390.3pt;height:77.4pt;vertical-align:-0.0pt;">
    <span class="ltx_transformed_inner" style="transform:translate(59.0pt,-11.7pt) scale(1.43388139863875,1.43388139863875) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T4.1.1">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A1.T4.1.1.1.1">
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="A1.T4.1.1.1.1.1">
         Knowledge Graph
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="A1.T4.1.1.1.1.2">
         Dataset
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A1.T4.1.1.2.1">
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.2.1.1">
         Entity
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.2.1.2">
         Relation
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.2.1.3">
         Triplets
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.2.1.4">
         Train Data
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.2.1.5">
         Test Data
        </td>
       </tr>
       <tr class="ltx_tr" id="A1.T4.1.1.3.2">
        <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T4.1.1.3.2.1">
         100,927
        </td>
        <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T4.1.1.3.2.2">
         1,383
        </td>
        <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T4.1.1.3.2.3">
         1,189,192
        </td>
        <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T4.1.1.3.2.4">
         12,345
        </td>
        <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T4.1.1.3.2.5">
         2,646
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 4:
    </span>
    Detailed information about the number of knowledge graph entity-relationship triples and the number of dataset segmentation samples after processing the OpenDialKG dataset.
   </figcaption>
  </figure>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    Data Format
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     We preprocessed the OpenDialKG raw data to fit our KG inference task. There are individual errors in the raw data, and the information of the dataset after our screening is shown in Table
     <a class="ltx_ref" href="#A1.T4" title="Table 4 ‣ Appendix A Appendix ‣ Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2
    </span>
    Tricks
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     In the original paper of PPO, no implementation details and techniques are mentioned other than the use of GAE to compute the dominance function. Referring to this repository
     <span class="ltx_note ltx_role_footnote" id="footnote3">
      <sup class="ltx_note_mark">
       3
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         3
        </sup>
        <span class="ltx_tag ltx_tag_note">
         3
        </span>
        <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Lizhi-sjtu/DRL-code-pytorch" target="_blank" title="">
         https://github.com/Lizhi-sjtu/DRL-code-pytorch
        </a>
       </span>
      </span>
     </span>
     , we employ several optimization tricks. In the actual code implementation, to encourage the diversity of paths sampled by the strategy during training, we added an entropy regularization term to our loss function. We used the operation of normalization of advantage proposed in the paper
     <cite class="ltx_cite ltx_citemacro_citep">
      [Tucker et al.,
      <a class="ltx_ref" href="#bib.bib26" title="">
       2018
      </a>
      ]
     </cite>
     . Learning rate decay can enhance the smoothness in the late training stage to some extent and improve the training effect. Here we use the linear decay of learning rate, with the number of training steps learning rate from the initial value of a linear decline to 0. Gradient clipping is a trick introduced to prevent the gradient from exploding during the training process, which also serves to stabilize the training process. Orthogonal Initialization is a neural network initialization method proposed to prevent problems such as gradient vanishing and gradient explosion at the beginning of training. Referring to the MAPPO
     <cite class="ltx_cite ltx_citemacro_citep">
      [Yu et al.,
      <a class="ltx_ref" href="#bib.bib30" title="">
       2022
      </a>
      ]
     </cite>
     , the Adam optimizer individually sets eps=1e-5, and this particular setting can improve the training performance of the algorithm to some extent.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.3
    </span>
    Limitation
   </h3>
   <section class="ltx_subsubsection" id="A1.SS3.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.3.1
     </span>
     Limitations of Inference Efficiency
    </h4>
    <div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p1">
     <p class="ltx_p" id="A1.SS3.SSS1.p1.1">
      Efficiency is always a significant issue when building deep learning models based on LLMs. Although our research freezes the parameters of the LLM in the back-propagation stage and uniformly uses the bfloat16 computational type, the huge number of parameters of the model leads to inefficient forward propagation and large GPU memory usage when collecting experience and inference. As stated in the LLaMA paper
      <cite class="ltx_cite ltx_citemacro_citep">
       [Touvron et al.,
       <a class="ltx_ref" href="#bib.bib23" title="">
        2023a
       </a>
       ]
      </cite>
      , the efficiency of the model’s inference is more crucial than its training efficiency. It is acceptable for the training process to be slower, but the inference must be faster. Improving the inference speed of the model while ensuring its effectiveness is a challenge. In addition to constructing the research model, online applications based on LLMs must also address the efficiency issue. Conversational reasoning models based on LLMs must be efficient for real-time applications. The inference efficiency is crucial for building online applications based on LLMs.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="A1.SS3.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.3.2
     </span>
     Limitations of Entity Embedding
    </h4>
    <div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p1">
     <p class="ltx_p" id="A1.SS3.SSS2.p1.1">
      Our research work has identified limitations in the semantic representation of knowledge graph entities. The attributes of knowledge graph entities should be considered during the reasoning process. However, these attributes may be lengthy descriptions that are not easily processed by our TransE knowledge graph semantic embedding model. Furthermore, while most knowledge graphs are currently represented in text form, it is equally important to consider multimodal knowledge graph reasoning in research. By constructing a reasoning model based on multimodal inputs, machines can better describe and understand the real world. For example, the soon-to-be two-dimensionalized Law in Three Body Death Forever says ”Oh, it’s time to go into the picture, kids, go ahead,” and the user asks a question about this scenario, ”can you help me find some pictures related to this galaxy?”. The model may need to deduce that the two-dimensional representation portrayed in this book is the Milky Way galaxy, and then locate relevant images of the galaxy. Our model is currently unable to incorporate the combination of multi-modal, multi-attribute entities, which is a limitation of our work in this endeavor, as well as an area for future research efforts.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="A1.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.4
    </span>
    GPT4 Prompts
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS4.p1">
    <p class="ltx_p" id="A1.SS4.p1.1">
     For GPT4-OPA prompt, since max length is 2, we need to recursively get all exit paths at the next level of all exit paths of the current entity, most of which are omitted due to the large number of KG subgraph triples of exit paths.
    </p>
   </div>
   <figure class="ltx_table" id="A1.T5">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T5.1" style="width:390.3pt;height:235.1pt;vertical-align:-0.9pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-33.6pt,20.2pt) scale(0.85304137820899,0.85304137820899) ;">
      <table class="ltx_tabular ltx_align_middle" id="A1.T5.1.1">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="A1.T5.1.1.1.1">
         <td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.1.1.1.1">
          Standard Prompt
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T5.1.1.2.2">
         <td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.1.2.2.1">
          <table class="ltx_tabular ltx_align_middle" id="A1.T5.1.1.2.2.1.1">
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.1.1">
             ### Task Background
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.2.1">
             Performing 2-hop reasoning on the knowledge graph.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.3.1">
             ### Instruction
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.4.1">
             If you don’t think it’s necessary to perform the second hop in reasoning, stop the reasoning with the ’Equal’ relation.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.5.1">
             Given the Task Background and the Environment, directly output this path in triplet format without any other content.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.6">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.6.1">
             ### Environment
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.7">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.7.1">
             Utterance: What do you think about the Washinton Redskins? Are you a fan?
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.8">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.8.1">
             Current Entity: Washington Redskins
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.9">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.9.1">
             ### Examples
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.10">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.10.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.11">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.11.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.12">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.12.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T5.1.1.2.2.1.1.13">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T5.1.1.2.2.1.1.13.1">
             ### Response
            </td>
           </tr>
          </table>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 5:
     </span>
     GPT4-Standard prompt only perceived user’s query and Current Entity.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="A1.T6">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T6.1" style="width:390.3pt;height:265.8pt;vertical-align:-0.9pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-33.6pt,22.8pt) scale(0.85304137820899,0.85304137820899) ;">
      <table class="ltx_tabular ltx_align_middle" id="A1.T6.1.1">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="A1.T6.1.1.1.1">
         <td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.1.1.1.1.1">
          Normal Prompt
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T6.1.1.2.2">
         <td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T6.1.1.2.2.1">
          <table class="ltx_tabular ltx_align_middle" id="A1.T6.1.1.2.2.1.1">
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.1.1">
             ### Task Background
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.2.1">
             Performing 2-hop reasoning on the knowledge graph.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.3.1">
             ### Instruction
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.4.1">
             If you don’t think it’s necessary to perform the second hop in reasoning, stop the reasoning with the ’Equal’ relation.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.5.1">
             Given the Task Background and the Environment, directly output this path in triplet format without any other content.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.6">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.6.1">
             ### Environment
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.7">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.7.1">
             Dialog History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.8">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.8.1">
             Utterance: What do you think about the Washinton Redskins? Are you a fan?
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.9">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.9.1">
             Path History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.10">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.10.1">
             Current Entity: Washington Redskins
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.11">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.11.1">
             ### Examples
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.12">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.12.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.13">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.13.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.14">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.14.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T6.1.1.2.2.1.1.15">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T6.1.1.2.2.1.1.15.1">
             ### Response
            </td>
           </tr>
          </table>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 6:
     </span>
     GPT4-Normal prompt has more awareness of dialog context and path history.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="A1.T7">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T7.2" style="width:390.3pt;height:401.9pt;vertical-align:-0.9pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-33.9pt,34.8pt) scale(0.852136316894092,0.852136316894092) ;">
      <table class="ltx_tabular ltx_align_middle" id="A1.T7.2.2">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="A1.T7.2.2.3.1">
         <td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T7.2.2.3.1.1">
          OPA(Out Paths Aware) Prompt
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T7.2.2.2">
         <td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T7.2.2.2.2">
          <table class="ltx_tabular ltx_align_middle" id="A1.T7.2.2.2.2.2">
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.3">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.3.1">
             ### Task Background
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.4">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.4.1">
             Performing 2-hop reasoning on the knowledge graph.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.5">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.5.1">
             ### Instruction
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.6">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.6.1">
             Given the Task Background and the Environment, please choose select two consecutive paths KG path from a set of Out Paths.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.7">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.7.1">
             If you don’t think it’s necessary to perform the second hop in reasoning, just select the ’Equal’ relation at the second hop.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.8">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.8.1">
             Directly output these path in triplet format without any other content.
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.9">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.9.1">
             ### Environment
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.10">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.10.1">
             Dialog History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.11">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.11.1">
             Utterance: What do you think about the Washinton Redskins? Are you a fan?
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.12">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.12.1">
             Path History: []
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.13">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.13.1">
             Current Entity: Washington Redskins
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.14">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.14.1">
             Out Path: [’Washington Redskins,Equal,
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.15">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.15.1">
             Washington Redskins’,
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.1.1.1.1.1.1">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.1.1.1.1.1.1.1">
             ’Washington Redskins,
             <math alttext="\sim" class="ltx_Math" display="inline" id="A1.T7.1.1.1.1.1.1.1.m1.1">
              <semantics id="A1.T7.1.1.1.1.1.1.1.m1.1a">
               <mo id="A1.T7.1.1.1.1.1.1.1.m1.1.1" xref="A1.T7.1.1.1.1.1.1.1.m1.1.1.cmml">
                ∼
               </mo>
               <annotation-xml encoding="MathML-Content" id="A1.T7.1.1.1.1.1.1.1.m1.1b">
                <csymbol cd="latexml" id="A1.T7.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.T7.1.1.1.1.1.1.1.m1.1.1">
                 similar-to
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="A1.T7.1.1.1.1.1.1.1.m1.1c">
                \sim
               </annotation>
              </semantics>
             </math>
             Game,Mike Sellers’,
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.2">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.2.1">
             ’Washington Redskins,
             <math alttext="\sim" class="ltx_Math" display="inline" id="A1.T7.2.2.2.2.2.2.1.m1.1">
              <semantics id="A1.T7.2.2.2.2.2.2.1.m1.1a">
               <mo id="A1.T7.2.2.2.2.2.2.1.m1.1.1" xref="A1.T7.2.2.2.2.2.2.1.m1.1.1.cmml">
                ∼
               </mo>
               <annotation-xml encoding="MathML-Content" id="A1.T7.2.2.2.2.2.2.1.m1.1b">
                <csymbol cd="latexml" id="A1.T7.2.2.2.2.2.2.1.m1.1.1.cmml" xref="A1.T7.2.2.2.2.2.2.1.m1.1.1">
                 similar-to
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="A1.T7.2.2.2.2.2.2.1.m1.1c">
                \sim
               </annotation>
              </semantics>
             </math>
             Runner-up,Super Bowl VII’,
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.16">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.16.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.17">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.17.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.18">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.18.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.19">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.19.1">
             ’Ladell Betts,Ethnicity,African American’]
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.20">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.20.1">
             ### Examples
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.21">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.21.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.22">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.22.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.23">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.23.1">
             ·
            </td>
           </tr>
           <tr class="ltx_tr" id="A1.T7.2.2.2.2.2.24">
            <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T7.2.2.2.2.2.24.1">
             ### Response
            </td>
           </tr>
          </table>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 7:
     </span>
     GPT4-OPA prompt has more awareness of 2-hop exit KG path subgraphs.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A1.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.5
    </span>
    HyperParameters
   </h3>
   <figure class="ltx_table" id="A1.T8">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T8.1" style="width:390.3pt;height:866.5pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(77.6pt,-172.2pt) scale(1.65987360290898,1.65987360290898) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T8.1.1">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="A1.T8.1.1.1.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.1.1.1.1">
          Computing Infrastructure
         </th>
         <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T8.1.1.1.1.2">
          Tesla A40 GPU
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.2.2">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.2.2.1">
          Search Strategy
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.2.2.2">
          Beam Search
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.3.3">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.3.3.1">
          Training Efficiency
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.3.3.2">
          6 seconds per step
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.4.4">
         <th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.1.4.4.1">
         </th>
         <td class="ltx_td ltx_border_t" id="A1.T8.1.1.4.4.2">
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.5.5">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.1.5.5.1">
          Hyperparameter
         </th>
         <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T8.1.1.5.5.2">
          Best Setting
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.6.6">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.1.6.6.1">
          use transe
         </th>
         <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T8.1.1.6.6.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.7.7">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.7.7.1">
          out path aware
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.7.7.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.8.8">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.8.8.1">
          bf16
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.8.8.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.9.9">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.9.9.1">
          relation embedding size
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.9.9.2">
          200
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.10.10">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.10.10.1">
          entity embedding size
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.10.10.2">
          200
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.11.11">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.11.11.1">
          max out
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.11.11.2">
          50
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.12.12">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.12.12.1">
          number of explorations
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.12.12.2">
          8
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.13.13">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.13.13.1">
          replay buffer size
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.13.13.2">
          4096
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.14.14">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.14.14.1">
          mini batch size
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.14.14.2">
          1024
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.15.15">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.15.15.1">
          positive reward
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.15.15.2">
          1
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.16.16">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.16.16.1">
          negative reward
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.16.16.2">
          -1
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.17.17">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.17.17.1">
          actor learning rate
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.17.17.2">
          5e-5
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.18.18">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.18.18.1">
          critic learning rate
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.18.18.2">
          5e-5
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.19.19">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.19.19.1">
          gamma
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.19.19.2">
          0.95
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.20.20">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.20.20.1">
          lamda
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.20.20.2">
          0.95
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.21.21">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.21.21.1">
          epsilon
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.21.21.2">
          0.2
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.22.22">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.22.22.1">
          K epochs
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.22.22.2">
          10
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.23.23">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.23.23.1">
          use advantage normalization
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.23.23.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.24.24">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.24.24.1">
          use entropy coef
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.24.24.2">
          0.01
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.25.25">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.25.25.1">
          use learning rate decay
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.25.25.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.26.26">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.26.26.1">
          use gradient clip
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.26.26.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.27.27">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.27.27.1">
          use orthogonal init
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.27.27.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.28.28">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.28.28.1">
          set adam eps 1e-5
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.28.28.2">
          True
         </td>
        </tr>
        <tr class="ltx_tr" id="A1.T8.1.1.29.29">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.1.29.29.1">
          use tanh
         </th>
         <td class="ltx_td ltx_align_left" id="A1.T8.1.1.29.29.2">
          True
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 8:
     </span>
     Additional implementation detail of LLM-ARK.
    </figcaption>
   </figure>
  </section>
 </section>
 <div about="" class="ltx_rdf" content="Yuxuan Huang" property="dcterms:creator">
 </div>
 <div about="" class="ltx_rdf" content="Knowledge Graph, Large Language Model, Deep Reinforcement Learning" property="dcterms:subject">
 </div>
 <div about="" class="ltx_rdf" content="cs.CL, cs.AI" property="dcterms:subject">
 </div>
 <div about="" class="ltx_rdf" content="Evaluating and Enhancing Large Language Models for Conversational Reasoning on Knowledge Graphs" property="dcterms:title">
 </div>
</article>
