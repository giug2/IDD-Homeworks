<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data</title>
<!--Generated on Tue Sep 10 12:03:44 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on  %don’t␣want␣date␣printed .-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.06446v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S1" title="In HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S2" title="In HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S2.SS1" title="In 2 Related Work ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>LLMs for Code Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S2.SS2" title="In 2 Related Work ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>LLM-Generated Security Vulnerabilities</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S2.SS3" title="In 2 Related Work ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Data Synthesis using LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S3" title="In HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Technical Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S3.SS1" title="In 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Large Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S3.SS2" title="In 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Evaluating Code Security Issues</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S3.SS3" title="In 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Categories of Code Security Issues</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4" title="In HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Secure LLM-based Code Generation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS1" title="In 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Oracle-Guided Secure Code Synthesis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS1.SSS1" title="In 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Detail of the Security Reports</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS1.SSS2" title="In 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Details of the Input Prompt</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS2" title="In 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Fine-tuning CodeLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS3" title="In 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Two-step Code Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5" title="In 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5</span> </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS1" title="In 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.1</span> </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS1.SSS1" title="In 5.1 Setup ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.1.1</span> </span>Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS1.SSS2" title="In 5.1 Setup ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.1.2</span> </span>Evaluating Code Security</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS1.SSS3" title="In 5.1 Setup ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.1.3</span> </span>Evaluating Functional Correctness</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS2" title="In 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.2</span> </span>Performance of Our Code Synthesis Approach</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS1" title="In 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.2.1</span> </span>Importance of Security Reports in Synthesizing Secure Codes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS2" title="In 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.2.2</span> </span>Example of a Fixed Code</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS3" title="In 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.3</span> </span>Performance of HexaCoder in Securing CodeLMs</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS1" title="In 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.3.1</span> </span>Applicability of HexaCoder to other CodeLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="In 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">5.3.2</span> </span>Effectiveness of the Two-step Generation Approach</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6" title="In 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">6</span> </span>Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS1" title="In 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">6.1</span> </span>Limitations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS1.SSS0.Px1" title="In 6.1 Limitations ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title">Static Analyzers.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS1.SSS0.Px2" title="In 6.1 Limitations ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title">Programming Languages.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS1.SSS0.Px3" title="In 6.1 Limitations ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title">Funtionality Changes in the Fixed Codes.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS1.SSS0.Px4" title="In 6.1 Limitations ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title">Potential Issues of the Two-Step Generation Approach.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S6.SS2" title="In 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">6.2</span> </span>Adaptability of Our Approach to Other Vulnerabilities</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S7" title="In 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">7</span> </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A1" title="In Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">A</span> </span><span class="ltx_text ltx_font_typewriter">Details of the Input prompts</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A2" title="In Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">B</span> </span><span class="ltx_text ltx_font_typewriter">Details of the Security Hints</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A3" title="In Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">C</span> </span><span class="ltx_text ltx_font_typewriter">Hyperparameters for LoRA Fine-tuning Approach</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A4" title="In Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">D</span> </span><span class="ltx_text ltx_font_typewriter">Detailed Results</span></span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A4.SS1" title="In Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text ltx_font_serif">D.1</span> </span>Detailed Results of the Effectiveness of the Two-step Generation Approach</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A5" title="In Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">E</span> </span><span class="ltx_text ltx_font_typewriter">Examples of the Generated Codes</span></span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">spacing=nonfrench</p>
</div>
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:144%;">HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Hossein Hajipour, Lea Schönherr, Thorsten Holz, Mario Fritz
<br class="ltx_break"/>CISPA Helmholtz Center for Information Security 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{hossein.hajipour, schoenherr, holz, fritz}@cispa.de</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Large language models (LLMs) have shown great potential for automatic code generation and form the basis for various tools such as <em class="ltx_emph ltx_font_italic" id="id2.id1.1">GitHub Copilot</em>. However, recent studies highlight that many LLM-generated code contains serious security vulnerabilities.
While previous work tries to address this by training models that generate secure code, these attempts remain constrained by limited access to training data and labor-intensive data preparation.</p>
<p class="ltx_p" id="id3.id2">In this paper, we introduce HexaCoder, a novel approach to enhance the ability of LLMs to generate secure codes by <em class="ltx_emph ltx_font_italic" id="id3.id2.1">automatically</em> synthesizing secure codes, which reduces the effort of finding suitable training data.
HexaCoder comprises two key components: an oracle-guided data synthesis pipeline and a two-step process for secure code generation.
The data synthesis pipeline generates pairs of vulnerable and fixed codes for specific Common Weakness Enumeration (CWE) types by utilizing a state-of-the-art LLM for repairing vulnerable code.
A security oracle identifies vulnerabilities, and a state-of-the-art LLM repairs them by extending and/or editing the codes, creating data pairs for fine-tuning using the Low-Rank Adaptation (LoRA) method. Each example of our fine-tuning dataset includes the necessary security-related libraries and code that form the basis of our novel two-step generation approach.
This allows the model to integrate security-relevant libraries before generating the main code, significantly reducing the number of generated vulnerable codes by up to 85 % compared to the baseline methods. We perform extensive evaluations on three different benchmarks for four LLMs, demonstrating that HexaCoder not only improves the security of the generated code but also maintains a high level of functional correctness.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="207" id="S1.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Our approach automatically synthesizes secure code and fine-tunes CodeLMs to enhance secure code generation: (1) Synthesizing secure codes by guiding the model with the security oracle’s report. (2) Fine-tuning the CodeLM using pairs of vulnerable and secure codes. (3) Using our two-step generation method: first, we generate the necessary libraries, and then we complete the code accordingly.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large language models (LLMs) have made significant progress in various code generation and understanding tasks, such as text-to-code <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite>, code repair <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite>, and code summarization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib65" title="">65</a>]</cite>. This advancement is due to training with large corpora of open-source code, allowing the models to generate the desired output based on user input. One notable application is <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">GitHub Copilot</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib22" title="">22</a>]</cite>, an AI pair programmer built based on these models. More than one million developers use this product to complete code, generate code documentation, and fix bugs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib70" title="">70</a>]</cite>. Furthermore, various other products based on LLMs have been developed to enhance the productivity of software developers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib4" title="">4</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite advances in LLMs to generate functionally correct code, previous studies have shown that pre-trained and instruction-tuned LLMs can produce code with security-relevant vulnerabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite>. Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> have shown that in manually designed security scenarios 40 % of the code generated by GitHub Copilot contains security issues. Hajipour et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> proposed an automated approach to evaluate the security vulnerabilities generated by LLMs. Their work showed that other state-of-the-art models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib58" title="">58</a>]</cite> also produce code with security vulnerabilities. For instance, they found that OpenAI’s GPT-3.5 generated more than 2,000 unique and vulnerable code instances covering various Common Weakness Enumerations (CWEs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">He and Vechev <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> tried to increase the security of the models’ code outputs by employing controlled code generation. However, their fine-tuning approach remains limited to manually checked data, making adapting models to generate secure code for specific and new types of vulnerability labor-intensive. Furthermore, the trained models are only tested on a limited set of security scenarios proposed by Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> and Siddiq and Santos <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>]</cite>. Our experimental evaluation shows that many codes generated by these models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> still contain vulnerabilities when tested with a diverse set of CodeLMSec benchmark prompts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>.
This indicates the limited representativeness of the current datasets and the ongoing challenges in using LLMs for secure code generation tasks.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Additionally, previous LLMs for code generation (CodeLMs), such as those described in the literature <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite>, have typically been used to generate or complete code in a one-step fashion. Users usually request this one-step inference procedure to complete the code given the provided context. In one-step inference, the models are prompted to complete the code based on provided prefixes or combinations of prefixes and suffixes, with the inclusion of libraries either included within the context or omitted entirely. This process allows for little to no modification of libraries during inference, creating a scenario where the generation of secure code is not guaranteed if the necessary libraries have not been provided in advance by the user. A better alternative is to also suggest modifications to the developer’s input to avoid biases, such as missing libraries, which can be used to generate secure code.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we introduce HexaCoder, a novel approach that combines an oracle-guided data synthesis pipeline with a two-step generation process to improve the security of the generated code. Specifically, we use a security oracle to detect vulnerable code generated by different LLMs and use the oracle’s report together with an LLM to repair these vulnerabilities. The security oracle is also used to ensure that the model’s code output is free of vulnerabilities. By pairing the fixed codes with their corresponding vulnerable version, we train LLMs to generate secure code using the Low-Rank Adaptation (LoRA) fine-tuning method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib38" title="">38</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">During the data synthesis phase, the LLMs repair the code by modifying or extending the included libraries and the main code. As a result, our synthesized data includes the required security-relevant libraries. This suggests that writing secure code may require the use of additional libraries in specific scenarios. Based on this observation, we propose a two-step generation approach to give the models the opportunity to include libraries that can potentially be used to generate secure codes. In our two-step generation approach, we complete the given codes during inference by first providing only the included libraries as input to the models to generate all other potential libraries. In the second code generation step, we provide the updated libraries together with the rest of the code as input to the models. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates how our approach automatically synthesizes the secure code and fine-tunes the CodeLMs to enhance the models’ capabilities in generating secure codes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In summary, we make the following key contributions:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">End-to-End Code Repair Pipeline.</span> We introduce HexaCoder, an approach that enhances the CodeLMs’ capabilities in generating secure codes while maintaining their effectiveness in producing functionally correct programs. We achieve this by synthetically generating pairs of vulnerable and fixed codes for the targeted types of security vulnerabilities. Unlike previous approaches, HexaCoder provides a complete end-to-end pipeline for both synthesizing data and enhancing code security aspects of CodeLMs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Security Fine-Tuning.</span> Using our synthesized data pairs, we fine-tune four different CodeLMs of varying sizes using the LoRA fine-tuning method. Our evaluation shows that this process significantly enhances the models’ ability to generate secure code.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Two-step Code Generation.</span> We extend our HexaCoder approach by proposing a two-step generation approach. This approach gives models the opportunity to include relevant libraries in the given code before generating the desired code, reducing the number of vulnerable code instances generated by up to 85% compared to the baseline.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Security Evaluation of Different CodeLMs.</span> We conduct a comprehensive experimental evaluation of HexaCoder to verify its applicability across different CodeLMs. Our evaluation demonstrates that HexaCoder not only trains these models to generate secure code, but also maintains their performance in generating functionally correct programs.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">The code, fine-tuned models, and synthesized will be available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/hexacoder-ai/hexacoder" title="">https://github.com/hexacoder-ai/hexacoder</a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We begin by introducing LLMs for code generation (CodeLMs), highlighting the challenges they face in generating secure codes. Additionally, we provide an overview of existing research on data synthesis using LLMs.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>LLMs for Code Generation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">LLMs demonstrate remarkable performance in various natural languages and programming language tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib23" title="">23</a>]</cite>. These include translation, question answering, code completion, and code refinements <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib47" title="">47</a>]</cite>. This success is attributed to several factors, including the scaling of model sizes from hundreds of millions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib20" title="">20</a>]</cite> to hundreds of billions of parameters <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib19" title="">19</a>]</cite>, the use of self-supervised learning objectives, reinforcement learning techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib28" title="">28</a>]</cite>, and the availability of large datasets comprising natural text and source code <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib23" title="">23</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Various works proposed LLMs for modeling source code data to tackle a wide range of code generation and understanding tasks. These models include Codex <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>]</cite>, CodeT5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib65" title="">65</a>]</cite>, CodeGen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite>, InCoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>]</cite>, DeepSeekCoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite>, along with many others <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib47" title="">47</a>]</cite>. These models are primarily trained and evaluated on their ability to generate functionally correct programs, often without considering their potential software security issues. In this work, we propose an approach to enhance the capabilities of these models in generating secure codes while preserving their effectiveness in generating the desired codes.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>LLM-Generated Security Vulnerabilities</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">LLMs for codes have been trained using a large corpus of open-source projects written by human developers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib33" title="">33</a>]</cite>. These codebases may contain a variety of software security issues, including SQL and code injection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>, memory safety issues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib62" title="">62</a>]</cite>, deprecated APIs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite>, improper input validation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>, and cross-site scripting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>. The models learned the patterns of vulnerable codes by using unsanitized source code data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>. Various studies and benchmarks show that a high percentage of the code generated by these models may contain a diverse set of security vulnerability issues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> show that 40% of the programs generated by
<em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.1.1">GitHub Copilot</em> contain various security vulnerabilities. They use a set of manually designed scenarios to investigate the security issues that can be generated by <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.1.2">GitHub Copilot</em>. Siddiq and Santos <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>]</cite> expand the scenarios provided by Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> to other types of Common Weakness Enumerations (CWEs). These works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>]</cite> rely on the limited set of manually designed scenarios to evaluate the model, which may lead to overlooking potential security issues that the models could generate. To address this limitation, Hajipour et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> introduced an automated approach to generate a broader range of scenarios and assess the security vulnerabilities produced by LLMs. Additionally, they developed the CodeLMSec benchmark, a diverse dataset of scenarios to evaluate and compare the susceptibility of different models to generating vulnerable code. Other studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib10" title="">10</a>]</cite> have also highlighted the tendency of these models to generate code with various types of security vulnerabilities.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">He and Vechev <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and He et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite> attempted to enhance the security of LLMs in code generation. Their approach involved using examples of both vulnerable code and its corrected counterparts. He and Vechev <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> introduced a novel prefix-tuning approach called SVEN, designed to control the model’s output, guiding it to generate secure (or even vulnerable) code and reducing the likelihood of generating code with vulnerabilities. This work is limited to manually checked examples of source codes. Furthermore, in  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>, it has been shown that a high percentage of the codes generated by SVEN’s models contain various security vulnerability issues. This highlights the limited representation of the collected training data.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">Recently, He et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite> proposed SafeCoder, which focuses on enhancing the code security of instruction-tuned models. They introduce a pipeline to automatically collect code examples from open-source repositories. Despite this advancement, due to the library dependency issues, the dataset they collected includes only a limited number of examples for each CWE. For instance, there are only 13 examples of C/C++ code related to CWE-787 (Out-of-bound Write) in their dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite>. Moreover, most of the examples in the datasets of previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite> do not contain the necessary libraries. In contrast, we propose an approach to automatically generate a set of vulnerable and fixed code examples, which can be easily extended to cover new types of security vulnerabilities. Our synthesized data includes security-related libraries, enabling models to improve their secure code generation capabilities.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Data Synthesis using LLMs</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Synthetic data generation has become a widely adopted solution for addressing challenges such as data scarcity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib46" title="">46</a>]</cite>, the high costs associated with data collection and annotation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib14" title="">14</a>]</cite>, and privacy concerns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib5" title="">5</a>]</cite>. Given the advancement of LLMs in generating various types of data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib46" title="">46</a>]</cite>, synthetic data generation by LLMs emerges as an effective and low-cost synthetic data generation method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib44" title="">44</a>]</cite>. Various works used LLMs to synthesize data for natural language <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib68" title="">68</a>]</cite>, mathematics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib69" title="">69</a>]</cite>, and code generation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib66" title="">66</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib49" title="">49</a>]</cite>. For instance, Self-Instruct <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib64" title="">64</a>]</cite> introduced a pipeline to enhance the instruction-following capabilities of models by using LLMs to generate data that encompass a wide range of natural language scenarios.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">In the code generation domain, Code Alpaca <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib15" title="">15</a>]</cite> automatically synthesized 20k code instruction data by applying Self-Instruct <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib64" title="">64</a>]</cite> to GPT-3.5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib53" title="">53</a>]</cite>. WizardCoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib49" title="">49</a>]</cite> adapts Evol-Instruct <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib68" title="">68</a>]</cite> to synthesize instruction-following code. Hajipour et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> propose a few-shot prompting approach to automatically generate targeted vulnerable codes using CodeLMs. While their approach was initially used to evaluate CodeLMs in generating vulnerable codes, in our work, we use the generated vulnerable codes as part of our data synthesis pipeline. In this pipeline, given the vulnerable codes, we use the security oracle together with an instruction-tuned LLM to synthesize the corresponding fixed codes.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Technical Background</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we provide an overview of LLMs, explain the different categories of code security, and discuss potential methods for identifying security issues in software.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.3.2" style="font-size:90%;">List of evaluated CWEs. Nine of the eleven CWEs are in the top 25 list. The description is from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite>.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.4.1.1.1">CWE</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T1.4.1.1.2">Description</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.4.2.1.1">CWE-020</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.4.2.1.2">Improper Input Validation</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.3.2.1">CWE-022</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.3.2.2">Improper Limitation of a Pathname to a Restricted Directory (“Path Traversal”)</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.4.3.1">CWE-078</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.4.3.2">Improper Neutralization of Special Elements used in an OS Command (“OS Command Injection”)</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.5.4.1">CWE-079</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.5.4.2">Improper Neutralization of Input During Web Page Generation (“Cross-site Scripting”)</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.6.5.1">CWE-094</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.6.5.2">Improper Control of Generation of Code (“Code Injection”)</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.7.6.1">CWE-117</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.7.6.2">Improper Output Neutralization for Logs</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.8.7.1">CWE-190</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.8.7.2">Integer Overflow or Wraparound</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.9.8.1">CWE-476</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.9.8.2">NULL Pointer Dereference</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.10.9.1">CWE-502</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.10.9.2">Deserialization of Untrusted Data</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.11.10.1">CWE-611</th>
<td class="ltx_td ltx_align_left" id="S3.T1.4.11.10.2">Improper Restriction of XML External Entity Reference</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T1.4.12.11.1">CWE-787</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T1.4.12.11.2">Out-of-bounds Write</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Large Language Models</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">In this work, we consider LLMs that are pre-trained on code datasets and process the code data as a sequence of the text represented as tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib19" title="">19</a>]</cite>. During inference, these models take the user’s input, which may be a partial program, a natural language description, or a combination of both. Given the provided input, the models predict the next token at each step until they either generate the end-of-sequence token or reach a pre-set maximum token limit. Given tokenized input <math alttext="\mathbf{x}=[x_{1},\dots,x_{n}]" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.3.3.4" xref="S3.SS1.p1.1.m1.3.3.4.cmml">𝐱</mi><mo id="S3.SS1.p1.1.m1.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS1.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.4" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.3.3.2.2.5" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><eq id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.4">𝐱</ci><list id="S3.SS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">\mathbf{x}=[x_{1},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.3d">bold_x = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, the LLMs calculate the probability of the entire sequence <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_x</annotation></semantics></math> by multiplying the conditional probabilities:</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(\mathbf{x})=\prod_{t=1}^{n}P(x_{t}|x_{&lt;t})." class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">P</mi><mo id="S3.E1.m1.2.2.1.1.3.1" xref="S3.E1.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.3.cmml"><mo id="S3.E1.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐱</mi><mo id="S3.E1.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.2" rspace="0.111em" xref="S3.E1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><munderover id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml"><mo id="S3.E1.m1.2.2.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.2.2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.E1.m1.2.2.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.2.2.3.2" xref="S3.E1.m1.2.2.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E1.m1.2.2.1.1.1.2.2.3.1" xref="S3.E1.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.1.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.2.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.3.cmml">P</mi><mo id="S3.E1.m1.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" lspace="0em" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></eq><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><times id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1"></times><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">𝑃</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐱</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><apply id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.2">product</csymbol><apply id="S3.E1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3"><eq id="S3.E1.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E1.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2"></times><ci id="S3.E1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3">𝑃</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3"><lt id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">P(\mathbf{x})=\prod_{t=1}^{n}P(x_{t}|x_{&lt;t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_P ( bold_x ) = ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_P ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">In the left-to-right decoding approach, each token <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can be sampled from the distribution modeled by the LLM using <math alttext="P(x_{t}|x_{&lt;t})" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">P</mi><mo id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.2.m2.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS1.p3.2.m2.1.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.p3.2.m2.1.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo id="S3.SS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><times id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2"></times><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑃</ci><apply id="S3.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3"><lt id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">P(x_{t}|x_{&lt;t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Evaluating Code Security Issues</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Software faults in complex systems can be identified using a variety of security testing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib72" title="">72</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib43" title="">43</a>]</cite>. These techniques aim to uncover different types of programming errors, suboptimal coding practices, deprecated functions, or potential memory safety issues.
Generally speaking, these security evaluation methods fall into two main categories: static analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib43" title="">43</a>]</cite> and dynamic analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib72" title="">72</a>]</cite>. Static analysis involves reviewing the program’s code without executing it and detecting issues like buffer overflows and improper API use by applying predefined rules and patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib43" title="">43</a>]</cite>. Dynamic analysis, in contrast, executes the program in a controlled environment to observe its runtime behavior, identifying issues such as memory leaks, race conditions, or other types of spatial/temporal vulnerabilities that arise from specific input sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib55" title="">55</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Building on previous research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>, we selected static analysis to identify security vulnerabilities in the generated source code. This method allows for the categorization of various vulnerabilities. Specifically, we used CodeQL, a leading static analysis engine provided by GitHub <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a>]</cite>. CodeQL has been increasingly used in recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite> to evaluate the security of code generated by LLMs. By analyzing the model-generated code with CodeQL, we are able to detect security vulnerabilities and classify them using CodeQL’s <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.1">Common Weakness Enumeration</span> (CWE) framework. This classification allows us to focus on specific types of vulnerabilities when generating and repairing vulnerable code, which we then examine in detail throughout our study.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Categories of Code Security Issues</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The Common Weakness Enumeration (CWE), maintained by MITRE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite>, is a comprehensive catalog of common software and hardware flaws. It includes over 400 distinct types of weaknesses, which are organized into various categories and subcategories, such as SQL injection and cross-site scripting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite>. Each CWE is typically accompanied by specific example(s) and potential ways to mitigate the issues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite>. In our data synthesis pipeline, we use the recommended mitigation strategies provided by MITRE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite> to guide the model in repairing vulnerabilities associated with these specific CWEs.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">In this work, we focus on 11 CWEs that can be identified using static analysis tools. Notably, 9 of these 11 CWEs are included in MITRE’s list of the 25 most dangerous software weaknesses published in 2023 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite>. The list of these CWEs, including a brief description, is provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S3.T1" title="Table 1 ‣ 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">1</span></a>. In our analysis, we decided against using fuzzing for vulnerability detection, as this may require significant computational resources and extensive manual effort for classifying vulnerability types and root cause analysis. In addition, the code sequences generated by LLMs are typically not suitable for a fuzzing campaign because they do not represent a full program and would require a program-specific testing harness.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Secure LLM-based Code Generation</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this work, we propose HexaCoder, an approach designed to enhance the ability of CodeLMs to generate secure code.
Our approach involves three key steps:</p>
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Synthesis.</span> Synthesizing pairs of vulnerable and fixed codes by guiding an instruction-tuned LLM (e.g., GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a>]</cite>). We guide the LLM with detailed security reports describing the vulnerabilities of the code. This guidance enables the LLM to generate a patched version that addresses these vulnerabilities.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Fine-tuning.</span> These synthesized code pairs are then used to fine-tune the models using the LoRA method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib38" title="">38</a>]</cite> and a masked objective loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Two-Step Generation.</span> Based on the insights of our analysis of synthesized code pairs where the model added new libraries to address vulnerabilities, we introduce a two-step generation approach. This approach enables the models to first incorporate the necessary libraries before actually generating the targeted code.</p>
</div>
</li>
</ol>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Oracle-Guided Secure Code Synthesis</h3>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="178" id="S4.F2.g1" src="x2.png" width="968"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Overview of synthesizing secure codes using our proposed code synthesize pipeline.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The straightforward way to teach LLMs and CodeLMs to generate secure codes is to train them with only samples of secure, vulnerable-free codes. However, a dataset consisting only of such code samples is not easy to collect: Automatically validating security issues in open-source code, where code training data is usually collected, can be challenging, as it often requires analyzing complex dependencies in various libraries <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>. Manually analyzing and labeling code is also a labor-intensive task.
In addition, even if the model is trained only on secure code, it is not guaranteed that it will not generate vulnerable code during inference.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To address this challenge, we propose an oracle-guided code synthesis pipeline in which LLMs are used to synthesize pairs of vulnerable and fixed code samples. These samples are then used to fine-tune the LLM and guide the model to generate secure codes.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F2" title="Figure 2 ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">2</span></a> provides an overview of our secure code synthesizing procedure.
To synthesize vulnerable codes, we employ the few-shot prompting approach proposed by Hajipour et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite>. This approach employs a few examples of codes with targeted vulnerabilities to generate a diverse set of vulnerable code samples at scale. A security oracle then validates whether the generated code contains the targeted vulnerabilities; only the validated samples are included in the set of vulnerable codes. Each vulnerable code sample, along with its corresponding security report, serves as part of the model input. This security report contains the security oracle report together with a security hint. Based on the input, the model is then prompted to fix the security issues in the vulnerable code. The output of the model is checked again with the security oracle and if the oracle finds no vulnerability, the code is considered fixed and is used as a secure version of the code. The secured codes, together with their corresponding vulnerable versions, form our fine-tuning dataset. Note that in this work we use the GPT-4 model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a>]</cite> to fix the given codes.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Detail of the Security Reports</h4>
<figure class="ltx_figure" id="S4.F3"><svg class="ltx_picture ltx_centering" height="55.23" id="S4.F3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,55.23) matrix(1 0 0 -1 0 0)"><g fill="#708570" fill-opacity="1.0"><path d="M 0 5.91 L 0 49.33 C 0 52.59 2.64 55.23 5.91 55.23 L 594.09 55.23 C 597.36 55.23 600 52.59 600 49.33 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F4F6F4" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 49.33 C 1.97 51.5 3.73 53.26 5.91 53.26 L 594.09 53.26 C 596.27 53.26 598.03 51.5 598.03 49.33 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="27.67" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.F3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.F3.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F3.pic1.1.1.1.1.1.1.1" style="font-size:90%;">Description: <span class="ltx_text ltx_font_typewriter ltx_font_medium" id="S4.F3.pic1.1.1.1.1.1.1.1.1">Reflected server-side cross-site scripting. Writing user input directly to a web page allows for a cross-site scripting vulnerability.<span class="ltx_text ltx_font_serif" id="S4.F3.pic1.1.1.1.1.1.1.1.1.1"></span></span></span></span>
<span class="ltx_p" id="S4.F3.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.F3.pic1.1.1.1.1.1.2.1" style="font-size:90%;">Line number: <span class="ltx_text ltx_font_typewriter ltx_font_medium" id="S4.F3.pic1.1.1.1.1.1.2.1.1">25.<span class="ltx_text ltx_font_serif" id="S4.F3.pic1.1.1.1.1.1.2.1.1.1"></span></span></span></span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">An adapted example of CodeQL report for the CWE-079.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">In the process of fixing the security vulnerabilities in a given code, we guide the CodeLM using the security reports, which include both the report provided by CodeQL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a>]</cite> as a security oracle and an additional security hint. More specifically, we analyze the security issue of each generated vulnerable code using CodeQL security queries. CodeQL then generates a report detailing the identified vulnerabilities in the code. We guide the model using the description and line number of each identified vulnerability. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F3" title="Figure 3 ‣ 4.1.1 Detail of the Security Reports ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a>, we provide an example of the CodeQL report for CWE-079, which serves as part of the input for the model.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">The CodeQL report provides a comprehensive overview of the identified vulnerabilities; however, it does not describe potential mitigation strategies. To address this shortcoming, we guide the model by providing security hints that describe possible mitigation implementations for the corresponding CWE. These mitigation descriptions are adapted from the “Potential Mitigations” section on each CWE page provided by MITRE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a>]</cite> and Semgrep documentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib40" title="">40</a>]</cite>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F4" title="Figure 4 ‣ 4.1.1 Detail of the Security Reports ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a> provides an example of a security hint used for CWE-079. We provide a complete list of hints in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#A2" title="Appendix B Details of the Security Hints ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><svg class="ltx_picture ltx_centering" height="55.09" id="S4.F4.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,55.09) matrix(1 0 0 -1 0 0)"><g fill="#708570" fill-opacity="1.0"><path d="M 0 5.91 L 0 49.19 C 0 52.45 2.64 55.09 5.91 55.09 L 594.09 55.09 C 597.36 55.09 600 52.45 600 49.19 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F4F6F4" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 49.19 C 1.97 51.36 3.73 53.13 5.91 53.13 L 594.09 53.13 C 596.27 53.13 598.03 51.36 598.03 49.19 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="27.54" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.F4.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.F4.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F4.pic1.1.1.1.1.1.1.1" style="font-size:90%;">Hint: <span class="ltx_text ltx_font_typewriter ltx_font_medium" id="S4.F4.pic1.1.1.1.1.1.1.1.1">Note that proper output encoding, escaping, and quoting is the most effective solution for preventing XSS.<span class="ltx_text ltx_font_serif" id="S4.F4.pic1.1.1.1.1.1.1.1.1.1"></span></span></span></span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">An example of the security hint provided for resolving the CWE-079 issue.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Details of the Input Prompt</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">To synthesize the fixed version of the given vulnerable code, we provide the model with a prompt as input. This prompt includes details about the vulnerabilities, security hints, instructions outlining the model’s task, and the vulnerable code itself presented in Markdown language <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib67" title="">67</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<p class="ltx_p" id="S4.SS1.SSS2.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F5" title="Figure 5 ‣ 4.1.2 Details of the Input Prompt ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5</span></a> shows a summarized version of the prompt template that we use as input for the model. In this template, each variable (<span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.1">{variable}</span>) is replaced with the corresponding content for the given vulnerable code. Specifically, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.2">{prog_lang}</span> indicates the programming language of the code, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.3">{num_vuls}</span> denotes the total number of vulnerabilities, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.4">{vul_count}</span> is used to enumerate the vulnerabilities, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.5">{line_num}</span> specifies the line of code in which the corresponding vulnerability was found, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.6">{cwe_type}</span> describes the type of vulnerability according to the CWE classification, <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.7">{cwe_explanation}</span> provides an explanation of the CWE type that is provided by the CodeQL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a>]</cite> report (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F3" title="Figure 3 ‣ 4.1.1 Detail of the Security Reports ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a>), <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.8">{hint}</span> represent the security hint (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.F4" title="Figure 4 ‣ 4.1.1 Detail of the Security Reports ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a>), and <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p2.1.9">{vul_code}</span> contains the actual vulnerable code that needs to be fixed.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p3">
<p class="ltx_p" id="S4.SS1.SSS2.p3.1">Note that each code can contain one or multiple vulnerabilities. We include all vulnerabilities and their details in a single input prompt and instruct the model to fix all of the issues. In the input prompt, each vulnerability is listed with the variable <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.SS1.SSS2.p3.1.1">{vul_count}</span>, followed by the corresponding security hint. We instruct the model to first explain how these issues can be resolved before attempting to fix them. Our initial results indicate that when the model explains the vulnerabilities first, it has a higher success rate in resolving the issues.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><svg class="ltx_picture ltx_centering" height="136.18" id="S4.F5.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,136.18) matrix(1 0 0 -1 0 0)"><g fill="#708570" fill-opacity="1.0"><path d="M 0 5.91 L 0 130.27 C 0 133.54 2.64 136.18 5.91 136.18 L 594.09 136.18 C 597.36 136.18 600 133.54 600 130.27 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F4F6F4" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 130.27 C 1.97 132.45 3.73 134.21 5.91 134.21 L 594.09 134.21 C 596.27 134.21 598.03 132.45 598.03 130.27 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="108.62" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.F5.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.F5.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S4.F5.pic1.1.1.1.1.1.1.1" style="font-size:90%;">You are a security engineer and <span class="ltx_text ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.1.1.1">{prog_lang}</span> developer. The following code has <span class="ltx_text ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.1.1.2">{num_vuls}</span> vulnerability(ies):<span class="ltx_text ltx_font_serif" id="S4.F5.pic1.1.1.1.1.1.1.1.3"></span></span></span>
<span class="ltx_p" id="S4.F5.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.2.1" style="font-size:90%;">{vul_count}<span class="ltx_text ltx_font_medium" id="S4.F5.pic1.1.1.1.1.1.2.1.1">- The code has a CWE vulnerability at line </span>{line_num}<span class="ltx_text ltx_font_medium" id="S4.F5.pic1.1.1.1.1.1.2.1.2">.
The vulnerability is of </span>{cwe_type}<span class="ltx_text ltx_font_medium" id="S4.F5.pic1.1.1.1.1.1.2.1.3"> type (</span>{cwe_explanation}<span class="ltx_text ltx_font_medium" id="S4.F5.pic1.1.1.1.1.1.2.1.4">).<span class="ltx_text ltx_font_serif" id="S4.F5.pic1.1.1.1.1.1.2.1.4.1"></span></span></span></span>
<span class="ltx_p" id="S4.F5.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.3.1" style="font-size:90%;">{hint}</span><span class="ltx_text" id="S4.F5.pic1.1.1.1.1.1.3.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S4.F5.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.4.1" style="font-size:90%;">Instructions:<span class="ltx_text ltx_font_medium" id="S4.F5.pic1.1.1.1.1.1.4.1.1"></span></span></span>
<span class="ltx_enumerate" id="S4.I2">
<span class="ltx_item" id="S4.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="S4.I2.i1.p1">
<span class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.I2.i1.p1.1.1" style="font-size:90%;">Analysis</span><span class="ltx_text ltx_font_typewriter" id="S4.I2.i1.p1.1.2" style="font-size:90%;">: First, provide a detailed explanation of the vulnerabilities present. Describe the steps necessary to fix these issues.</span></span>
</span></span>
<span class="ltx_item" id="S4.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="S4.I2.i2.p1">
<span class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.I2.i2.p1.1.1" style="font-size:90%;">Correction</span><span class="ltx_text ltx_font_typewriter" id="S4.I2.i2.p1.1.2" style="font-size:90%;">: After your explanation, directly repair the code. Ensure the following:</span></span>
<span class="ltx_itemize" id="S4.I2.i2.I1">
<span class="ltx_item" id="S4.I2.i2.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i2.I1.i1.p1">
<span class="ltx_p" id="S4.I2.i2.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S4.I2.i2.I1.i1.p1.1.1" style="font-size:90%;">Correct all vulnerabilities in a single solution.</span></span>
</span></span>
<span class="ltx_item" id="S4.I2.i2.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i2.I1.i2.p1">
<span class="ltx_p" id="S4.I2.i2.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S4.I2.i2.I1.i2.p1.1.1" style="font-size:90%;">...</span></span>
</span></span>
</span>
</span></span>
</span>
<span class="ltx_p" id="S4.F5.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="S4.F5.pic1.1.1.1.1.1.5.1" style="font-size:90%;">Vulnerable code:<span class="ltx_text ltx_font_serif" id="S4.F5.pic1.1.1.1.1.1.5.1.1">
<br class="ltx_break"/>“‘ </span><span class="ltx_text ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.5.1.2">{prog_lang}</span><span class="ltx_text ltx_font_serif" id="S4.F5.pic1.1.1.1.1.1.5.1.3">
<br class="ltx_break"/></span><span class="ltx_text ltx_font_bold" id="S4.F5.pic1.1.1.1.1.1.5.1.4">{vul_code}</span><span class="ltx_text ltx_font_serif" id="S4.F5.pic1.1.1.1.1.1.5.1.5"> ”’
<br class="ltx_break"/></span></span></span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.3.2" style="font-size:90%;">Template of the input prompt.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.SSS2.p4">
<p class="ltx_p" id="S4.SS1.SSS2.p4.1">Following the provided instruction, given the input prompt, the model outputs an analysis of the vulnerabilities and the fixed code. By using Markdown language in the input prompt, we guide the model in producing output in Markdown. This helps us extract the output code from the model’s outputs. We then use the security oracle to evaluate the output code for any security issues, and we select the code with no security issues as our fine-tuning data.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Fine-tuning CodeLMs</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Our goal in this work is to enhance pre-trained CodeLMs to generate secure codes while preserving their ability to produce functionally correct codes. We accomplish this by fine-tuning the CodeLMs using synthesized code examples. This fine-tuning procedure can involve optimizing all parameters or a parameter-efficient approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib37" title="">37</a>]</cite>, such as the LoRA fine-tuning method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib38" title="">38</a>]</cite>. We use LoRA fine-tuning as it requires a drastically lower number of parameters to optimize, and more importantly, previous studies showed that the LoRA approach is less prone to catastrophic forgetting in comparison to the full fine-tuning approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">In the LoRA fine-tuning method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib38" title="">38</a>]</cite>, we freeze all of the model’s weights and inject rank decomposition matrices into the selected layers. This approach significantly reduces the number of trainable parameters, thereby requiring less computational resources. We fine-tune the CodeLMs by employing our synthesized code data and update the parameters through gradient descent by optimizing for the following objective functions:</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\sum_{t=1}^{n}m_{t}\cdot\log P(x_{t}|x_{&lt;t})." class="ltx_Math" display="block" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml">ℒ</mi><mo id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.1.1a" xref="S4.E2.m1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><munderover id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E2.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E2.m1.1.1.1.1.1.1.2.2.3.1" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S4.E2.m1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.3.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml">m</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.3.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S4.E2.m1.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E2.m1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.3.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.cmml">⁡</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.2.cmml">P</mi></mrow></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.1.1.1.2" lspace="0em" xref="S4.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2"></eq><ci id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3">ℒ</ci><apply id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><minus id="S4.E2.m1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1"></minus><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1"><apply id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3"><ci id="S4.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2.2">𝑚</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3"><log id="S4.E2.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.1"></log><ci id="S4.E2.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.3.3.2">𝑃</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3"><lt id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\mathcal{L}=-\sum_{t=1}^{n}m_{t}\cdot\log P(x_{t}|x_{&lt;t}).</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">caligraphic_L = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ roman_log italic_P ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.7">We use this masked negative log-likelihood loss from the previous works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>]</cite>. In Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.E2" title="In 4.2 Fine-tuning CodeLMs ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">2</span></a>, <math alttext="\mathbf{x}=[x_{1},\dots,x_{n}]" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.3"><semantics id="S4.SS2.p4.1.m1.3a"><mrow id="S4.SS2.p4.1.m1.3.3" xref="S4.SS2.p4.1.m1.3.3.cmml"><mi id="S4.SS2.p4.1.m1.3.3.4" xref="S4.SS2.p4.1.m1.3.3.4.cmml">𝐱</mi><mo id="S4.SS2.p4.1.m1.3.3.3" xref="S4.SS2.p4.1.m1.3.3.3.cmml">=</mo><mrow id="S4.SS2.p4.1.m1.3.3.2.2" xref="S4.SS2.p4.1.m1.3.3.2.3.cmml"><mo id="S4.SS2.p4.1.m1.3.3.2.2.3" stretchy="false" xref="S4.SS2.p4.1.m1.3.3.2.3.cmml">[</mo><msub id="S4.SS2.p4.1.m1.2.2.1.1.1" xref="S4.SS2.p4.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.2.2.1.1.1.2" xref="S4.SS2.p4.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S4.SS2.p4.1.m1.2.2.1.1.1.3" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p4.1.m1.3.3.2.2.4" xref="S4.SS2.p4.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.SS2.p4.1.m1.1.1" mathvariant="normal" xref="S4.SS2.p4.1.m1.1.1.cmml">…</mi><mo id="S4.SS2.p4.1.m1.3.3.2.2.5" xref="S4.SS2.p4.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.SS2.p4.1.m1.3.3.2.2.2" xref="S4.SS2.p4.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS2.p4.1.m1.3.3.2.2.2.2" xref="S4.SS2.p4.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="S4.SS2.p4.1.m1.3.3.2.2.2.3" xref="S4.SS2.p4.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S4.SS2.p4.1.m1.3.3.2.2.6" stretchy="false" xref="S4.SS2.p4.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.3b"><apply id="S4.SS2.p4.1.m1.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3"><eq id="S4.SS2.p4.1.m1.3.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3.3"></eq><ci id="S4.SS2.p4.1.m1.3.3.4.cmml" xref="S4.SS2.p4.1.m1.3.3.4">𝐱</ci><list id="S4.SS2.p4.1.m1.3.3.2.3.cmml" xref="S4.SS2.p4.1.m1.3.3.2.2"><apply id="S4.SS2.p4.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S4.SS2.p4.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">…</ci><apply id="S4.SS2.p4.1.m1.3.3.2.2.2.cmml" xref="S4.SS2.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS2.p4.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p4.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS2.p4.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="S4.SS2.p4.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS2.p4.1.m1.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.3c">\mathbf{x}=[x_{1},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.3d">bold_x = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> is an example of the synthesized secure code and <math alttext="m_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><msub id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">m</mi><mi id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝑚</ci><ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">m_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is an element of the binary mask <math alttext="\mathbf{m}" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">𝐦</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝐦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\mathbf{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">bold_m</annotation></semantics></math>. The mask <math alttext="\mathbf{m}" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">𝐦</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝐦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\mathbf{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">bold_m</annotation></semantics></math> has the sample length as <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><mi id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><ci id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">bold_x</annotation></semantics></math> and represents the modifications made in the secured version of the synthesized code. Specifically, each element <math alttext="m_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><msub id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mi id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">m</mi><mi id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">𝑚</ci><ci id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">m_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">italic_m start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is set to 1 if the token <math alttext="x_{t}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1"><semantics id="S4.SS2.p4.7.m7.1a"><msub id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml">x</mi><mi id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2">𝑥</ci><ci id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m7.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is inserted or replaced compared to the corresponding synthesized vulnerable code; otherwise, it is 0. We use the Python library <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p4.7.1">difflib</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib21" title="">21</a>]</cite> to extract the token-level differences between the pair of secure and vulnerable codes. This mask forces the model to focus only on the security-related context by zeroing the gradient signal on the other parts of the codes.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Two-step Code Generation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">During the process of fixing security issues in the synthesized vulnerable code, we observe that the model includes new libraries to address some of the vulnerabilities. For example, the model included <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p1.1.1">escape</span> function from the <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p1.1.2">flask</span> Python library to resolve the cross-site scripting vulnerability (CWE-079). This observation led us to propose a two-step generation approach. The CodeLMs have been typically used to complete the codes in a one-step fashion by providing the relevant input context <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib19" title="">19</a>]</cite>. This context can include the prefix of the codes, such as included libraries with a few lines of codes and/or a natural language description. In the one-step code generation approach, the goal is to generate the next token given the provided context. This gives little to no opportunity to modify the input context, including the libraries.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">To address this limitation, we introduce our two-step generation approach. In this approach, we complete the given input in two steps:

<span class="ltx_inline-enumerate" id="S4.I3">
<span class="ltx_inline-item" id="S4.I3.i1"><span class="ltx_tag ltx_tag_inline-item">1.</span> <span class="ltx_text" id="S4.I3.i1.1">First, condition the CodeLM on the included libraries.
</span></span>
<span class="ltx_inline-item" id="S4.I3.i2"><span class="ltx_tag ltx_tag_inline-item">2.</span> <span class="ltx_text" id="S4.I3.i2.1">Next, update the context with the newly added libraries and condition the CodeLM on the updated context to generate the desired code.
</span></span>
</span></p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.11">Let <math alttext="\mathbf{x}=[x_{1},\dots,x_{n}]" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.3"><semantics id="S4.SS3.p3.1.m1.3a"><mrow id="S4.SS3.p3.1.m1.3.3" xref="S4.SS3.p3.1.m1.3.3.cmml"><mi id="S4.SS3.p3.1.m1.3.3.4" xref="S4.SS3.p3.1.m1.3.3.4.cmml">𝐱</mi><mo id="S4.SS3.p3.1.m1.3.3.3" xref="S4.SS3.p3.1.m1.3.3.3.cmml">=</mo><mrow id="S4.SS3.p3.1.m1.3.3.2.2" xref="S4.SS3.p3.1.m1.3.3.2.3.cmml"><mo id="S4.SS3.p3.1.m1.3.3.2.2.3" stretchy="false" xref="S4.SS3.p3.1.m1.3.3.2.3.cmml">[</mo><msub id="S4.SS3.p3.1.m1.2.2.1.1.1" xref="S4.SS3.p3.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.2.2.1.1.1.2" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S4.SS3.p3.1.m1.2.2.1.1.1.3" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p3.1.m1.3.3.2.2.4" xref="S4.SS3.p3.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.SS3.p3.1.m1.1.1" mathvariant="normal" xref="S4.SS3.p3.1.m1.1.1.cmml">…</mi><mo id="S4.SS3.p3.1.m1.3.3.2.2.5" xref="S4.SS3.p3.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.SS3.p3.1.m1.3.3.2.2.2" xref="S4.SS3.p3.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS3.p3.1.m1.3.3.2.2.2.2" xref="S4.SS3.p3.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="S4.SS3.p3.1.m1.3.3.2.2.2.3" xref="S4.SS3.p3.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S4.SS3.p3.1.m1.3.3.2.2.6" stretchy="false" xref="S4.SS3.p3.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.3b"><apply id="S4.SS3.p3.1.m1.3.3.cmml" xref="S4.SS3.p3.1.m1.3.3"><eq id="S4.SS3.p3.1.m1.3.3.3.cmml" xref="S4.SS3.p3.1.m1.3.3.3"></eq><ci id="S4.SS3.p3.1.m1.3.3.4.cmml" xref="S4.SS3.p3.1.m1.3.3.4">𝐱</ci><list id="S4.SS3.p3.1.m1.3.3.2.3.cmml" xref="S4.SS3.p3.1.m1.3.3.2.2"><apply id="S4.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S4.SS3.p3.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">…</ci><apply id="S4.SS3.p3.1.m1.3.3.2.2.2.cmml" xref="S4.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS3.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="S4.SS3.p3.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.3c">\mathbf{x}=[x_{1},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.3d">bold_x = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> be the input context and our goal is to generate the next <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_m</annotation></semantics></math> tokens <math alttext="\mathbf{y}=[y_{1},\dots,y_{m}]" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.3"><semantics id="S4.SS3.p3.3.m3.3a"><mrow id="S4.SS3.p3.3.m3.3.3" xref="S4.SS3.p3.3.m3.3.3.cmml"><mi id="S4.SS3.p3.3.m3.3.3.4" xref="S4.SS3.p3.3.m3.3.3.4.cmml">𝐲</mi><mo id="S4.SS3.p3.3.m3.3.3.3" xref="S4.SS3.p3.3.m3.3.3.3.cmml">=</mo><mrow id="S4.SS3.p3.3.m3.3.3.2.2" xref="S4.SS3.p3.3.m3.3.3.2.3.cmml"><mo id="S4.SS3.p3.3.m3.3.3.2.2.3" stretchy="false" xref="S4.SS3.p3.3.m3.3.3.2.3.cmml">[</mo><msub id="S4.SS3.p3.3.m3.2.2.1.1.1" xref="S4.SS3.p3.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.2.2.1.1.1.2" xref="S4.SS3.p3.3.m3.2.2.1.1.1.2.cmml">y</mi><mn id="S4.SS3.p3.3.m3.2.2.1.1.1.3" xref="S4.SS3.p3.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p3.3.m3.3.3.2.2.4" xref="S4.SS3.p3.3.m3.3.3.2.3.cmml">,</mo><mi id="S4.SS3.p3.3.m3.1.1" mathvariant="normal" xref="S4.SS3.p3.3.m3.1.1.cmml">…</mi><mo id="S4.SS3.p3.3.m3.3.3.2.2.5" xref="S4.SS3.p3.3.m3.3.3.2.3.cmml">,</mo><msub id="S4.SS3.p3.3.m3.3.3.2.2.2" xref="S4.SS3.p3.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS3.p3.3.m3.3.3.2.2.2.2" xref="S4.SS3.p3.3.m3.3.3.2.2.2.2.cmml">y</mi><mi id="S4.SS3.p3.3.m3.3.3.2.2.2.3" xref="S4.SS3.p3.3.m3.3.3.2.2.2.3.cmml">m</mi></msub><mo id="S4.SS3.p3.3.m3.3.3.2.2.6" stretchy="false" xref="S4.SS3.p3.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.3b"><apply id="S4.SS3.p3.3.m3.3.3.cmml" xref="S4.SS3.p3.3.m3.3.3"><eq id="S4.SS3.p3.3.m3.3.3.3.cmml" xref="S4.SS3.p3.3.m3.3.3.3"></eq><ci id="S4.SS3.p3.3.m3.3.3.4.cmml" xref="S4.SS3.p3.3.m3.3.3.4">𝐲</ci><list id="S4.SS3.p3.3.m3.3.3.2.3.cmml" xref="S4.SS3.p3.3.m3.3.3.2.2"><apply id="S4.SS3.p3.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.2.2.1.1.1.2">𝑦</ci><cn id="S4.SS3.p3.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">…</ci><apply id="S4.SS3.p3.3.m3.3.3.2.2.2.cmml" xref="S4.SS3.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.3.3.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.3.m3.3.3.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.3.3.2.2.2.2">𝑦</ci><ci id="S4.SS3.p3.3.m3.3.3.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.3c">\mathbf{y}=[y_{1},\dots,y_{m}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.3d">bold_y = [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ]</annotation></semantics></math> given the provided input context <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">bold_x</annotation></semantics></math>. In the one-step generation approach, we autoregressively sample each token <math alttext="y_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">y</mi><mi id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">𝑦</ci><ci id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> using <math alttext="P(y_{i}|\mathbf{x},y_{1})" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.2"><semantics id="S4.SS3.p3.6.m6.2a"><mrow id="S4.SS3.p3.6.m6.2.2" xref="S4.SS3.p3.6.m6.2.2.cmml"><mi id="S4.SS3.p3.6.m6.2.2.3" xref="S4.SS3.p3.6.m6.2.2.3.cmml">P</mi><mo id="S4.SS3.p3.6.m6.2.2.2" xref="S4.SS3.p3.6.m6.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.p3.6.m6.2.2.1.1" xref="S4.SS3.p3.6.m6.2.2.1.1.1.cmml"><mo id="S4.SS3.p3.6.m6.2.2.1.1.2" stretchy="false" xref="S4.SS3.p3.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS3.p3.6.m6.2.2.1.1.1" xref="S4.SS3.p3.6.m6.2.2.1.1.1.cmml"><msub id="S4.SS3.p3.6.m6.2.2.1.1.1.3" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3.cmml"><mi id="S4.SS3.p3.6.m6.2.2.1.1.1.3.2" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3.2.cmml">y</mi><mi id="S4.SS3.p3.6.m6.2.2.1.1.1.3.3" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S4.SS3.p3.6.m6.2.2.1.1.1.2" xref="S4.SS3.p3.6.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">𝐱</mi><mo id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.2" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.2.cmml">,</mo><msub id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.2" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.3" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub></mrow></mrow><mo id="S4.SS3.p3.6.m6.2.2.1.1.3" stretchy="false" xref="S4.SS3.p3.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.2b"><apply id="S4.SS3.p3.6.m6.2.2.cmml" xref="S4.SS3.p3.6.m6.2.2"><times id="S4.SS3.p3.6.m6.2.2.2.cmml" xref="S4.SS3.p3.6.m6.2.2.2"></times><ci id="S4.SS3.p3.6.m6.2.2.3.cmml" xref="S4.SS3.p3.6.m6.2.2.3">𝑃</ci><apply id="S4.SS3.p3.6.m6.2.2.1.1.1.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1"><csymbol cd="latexml" id="S4.SS3.p3.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.2">conditional</csymbol><apply id="S4.SS3.p3.6.m6.2.2.1.1.1.3.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.2.2.1.1.1.3.1.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.6.m6.2.2.1.1.1.3.2.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3.2">𝑦</ci><ci id="S4.SS3.p3.6.m6.2.2.1.1.1.3.3.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.3.3">𝑖</ci></apply><list id="S4.SS3.p3.6.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1"><ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">𝐱</ci><apply id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.6.m6.2.2.1.1.1.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.2c">P(y_{i}|\mathbf{x},y_{1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.2d">italic_P ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> without modifying the input context <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mi id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><ci id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">bold_x</annotation></semantics></math>. In contrast, our two-step generation approach treats the tokenized input context <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><mi id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><ci id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">bold_x</annotation></semantics></math> as <math alttext="[x_{1},\dots,x_{l},\dots,x_{n}]" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.5"><semantics id="S4.SS3.p3.9.m9.5a"><mrow id="S4.SS3.p3.9.m9.5.5.3" xref="S4.SS3.p3.9.m9.5.5.4.cmml"><mo id="S4.SS3.p3.9.m9.5.5.3.4" stretchy="false" xref="S4.SS3.p3.9.m9.5.5.4.cmml">[</mo><msub id="S4.SS3.p3.9.m9.3.3.1.1" xref="S4.SS3.p3.9.m9.3.3.1.1.cmml"><mi id="S4.SS3.p3.9.m9.3.3.1.1.2" xref="S4.SS3.p3.9.m9.3.3.1.1.2.cmml">x</mi><mn id="S4.SS3.p3.9.m9.3.3.1.1.3" xref="S4.SS3.p3.9.m9.3.3.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p3.9.m9.5.5.3.5" xref="S4.SS3.p3.9.m9.5.5.4.cmml">,</mo><mi id="S4.SS3.p3.9.m9.1.1" mathvariant="normal" xref="S4.SS3.p3.9.m9.1.1.cmml">…</mi><mo id="S4.SS3.p3.9.m9.5.5.3.6" xref="S4.SS3.p3.9.m9.5.5.4.cmml">,</mo><msub id="S4.SS3.p3.9.m9.4.4.2.2" xref="S4.SS3.p3.9.m9.4.4.2.2.cmml"><mi id="S4.SS3.p3.9.m9.4.4.2.2.2" xref="S4.SS3.p3.9.m9.4.4.2.2.2.cmml">x</mi><mi id="S4.SS3.p3.9.m9.4.4.2.2.3" xref="S4.SS3.p3.9.m9.4.4.2.2.3.cmml">l</mi></msub><mo id="S4.SS3.p3.9.m9.5.5.3.7" xref="S4.SS3.p3.9.m9.5.5.4.cmml">,</mo><mi id="S4.SS3.p3.9.m9.2.2" mathvariant="normal" xref="S4.SS3.p3.9.m9.2.2.cmml">…</mi><mo id="S4.SS3.p3.9.m9.5.5.3.8" xref="S4.SS3.p3.9.m9.5.5.4.cmml">,</mo><msub id="S4.SS3.p3.9.m9.5.5.3.3" xref="S4.SS3.p3.9.m9.5.5.3.3.cmml"><mi id="S4.SS3.p3.9.m9.5.5.3.3.2" xref="S4.SS3.p3.9.m9.5.5.3.3.2.cmml">x</mi><mi id="S4.SS3.p3.9.m9.5.5.3.3.3" xref="S4.SS3.p3.9.m9.5.5.3.3.3.cmml">n</mi></msub><mo id="S4.SS3.p3.9.m9.5.5.3.9" stretchy="false" xref="S4.SS3.p3.9.m9.5.5.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.5b"><list id="S4.SS3.p3.9.m9.5.5.4.cmml" xref="S4.SS3.p3.9.m9.5.5.3"><apply id="S4.SS3.p3.9.m9.3.3.1.1.cmml" xref="S4.SS3.p3.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.3.3.1.1.1.cmml" xref="S4.SS3.p3.9.m9.3.3.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.3.3.1.1.2.cmml" xref="S4.SS3.p3.9.m9.3.3.1.1.2">𝑥</ci><cn id="S4.SS3.p3.9.m9.3.3.1.1.3.cmml" type="integer" xref="S4.SS3.p3.9.m9.3.3.1.1.3">1</cn></apply><ci id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">…</ci><apply id="S4.SS3.p3.9.m9.4.4.2.2.cmml" xref="S4.SS3.p3.9.m9.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.4.4.2.2.1.cmml" xref="S4.SS3.p3.9.m9.4.4.2.2">subscript</csymbol><ci id="S4.SS3.p3.9.m9.4.4.2.2.2.cmml" xref="S4.SS3.p3.9.m9.4.4.2.2.2">𝑥</ci><ci id="S4.SS3.p3.9.m9.4.4.2.2.3.cmml" xref="S4.SS3.p3.9.m9.4.4.2.2.3">𝑙</ci></apply><ci id="S4.SS3.p3.9.m9.2.2.cmml" xref="S4.SS3.p3.9.m9.2.2">…</ci><apply id="S4.SS3.p3.9.m9.5.5.3.3.cmml" xref="S4.SS3.p3.9.m9.5.5.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.5.5.3.3.1.cmml" xref="S4.SS3.p3.9.m9.5.5.3.3">subscript</csymbol><ci id="S4.SS3.p3.9.m9.5.5.3.3.2.cmml" xref="S4.SS3.p3.9.m9.5.5.3.3.2">𝑥</ci><ci id="S4.SS3.p3.9.m9.5.5.3.3.3.cmml" xref="S4.SS3.p3.9.m9.5.5.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.5c">[x_{1},\dots,x_{l},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.5d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="[x_{1},\dots,x_{l}]" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m10.3"><semantics id="S4.SS3.p3.10.m10.3a"><mrow id="S4.SS3.p3.10.m10.3.3.2" xref="S4.SS3.p3.10.m10.3.3.3.cmml"><mo id="S4.SS3.p3.10.m10.3.3.2.3" stretchy="false" xref="S4.SS3.p3.10.m10.3.3.3.cmml">[</mo><msub id="S4.SS3.p3.10.m10.2.2.1.1" xref="S4.SS3.p3.10.m10.2.2.1.1.cmml"><mi id="S4.SS3.p3.10.m10.2.2.1.1.2" xref="S4.SS3.p3.10.m10.2.2.1.1.2.cmml">x</mi><mn id="S4.SS3.p3.10.m10.2.2.1.1.3" xref="S4.SS3.p3.10.m10.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p3.10.m10.3.3.2.4" xref="S4.SS3.p3.10.m10.3.3.3.cmml">,</mo><mi id="S4.SS3.p3.10.m10.1.1" mathvariant="normal" xref="S4.SS3.p3.10.m10.1.1.cmml">…</mi><mo id="S4.SS3.p3.10.m10.3.3.2.5" xref="S4.SS3.p3.10.m10.3.3.3.cmml">,</mo><msub id="S4.SS3.p3.10.m10.3.3.2.2" xref="S4.SS3.p3.10.m10.3.3.2.2.cmml"><mi id="S4.SS3.p3.10.m10.3.3.2.2.2" xref="S4.SS3.p3.10.m10.3.3.2.2.2.cmml">x</mi><mi id="S4.SS3.p3.10.m10.3.3.2.2.3" xref="S4.SS3.p3.10.m10.3.3.2.2.3.cmml">l</mi></msub><mo id="S4.SS3.p3.10.m10.3.3.2.6" stretchy="false" xref="S4.SS3.p3.10.m10.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.3b"><list id="S4.SS3.p3.10.m10.3.3.3.cmml" xref="S4.SS3.p3.10.m10.3.3.2"><apply id="S4.SS3.p3.10.m10.2.2.1.1.cmml" xref="S4.SS3.p3.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.2.2.1.1.1.cmml" xref="S4.SS3.p3.10.m10.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p3.10.m10.2.2.1.1.2.cmml" xref="S4.SS3.p3.10.m10.2.2.1.1.2">𝑥</ci><cn id="S4.SS3.p3.10.m10.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p3.10.m10.2.2.1.1.3">1</cn></apply><ci id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1">…</ci><apply id="S4.SS3.p3.10.m10.3.3.2.2.cmml" xref="S4.SS3.p3.10.m10.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.3.3.2.2.1.cmml" xref="S4.SS3.p3.10.m10.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.10.m10.3.3.2.2.2.cmml" xref="S4.SS3.p3.10.m10.3.3.2.2.2">𝑥</ci><ci id="S4.SS3.p3.10.m10.3.3.2.2.3.cmml" xref="S4.SS3.p3.10.m10.3.3.2.2.3">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.3c">[x_{1},\dots,x_{l}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m10.3d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math> represents the included libraries, and <math alttext="[x_{l+1},\dots,x_{n}]" class="ltx_Math" display="inline" id="S4.SS3.p3.11.m11.3"><semantics id="S4.SS3.p3.11.m11.3a"><mrow id="S4.SS3.p3.11.m11.3.3.2" xref="S4.SS3.p3.11.m11.3.3.3.cmml"><mo id="S4.SS3.p3.11.m11.3.3.2.3" stretchy="false" xref="S4.SS3.p3.11.m11.3.3.3.cmml">[</mo><msub id="S4.SS3.p3.11.m11.2.2.1.1" xref="S4.SS3.p3.11.m11.2.2.1.1.cmml"><mi id="S4.SS3.p3.11.m11.2.2.1.1.2" xref="S4.SS3.p3.11.m11.2.2.1.1.2.cmml">x</mi><mrow id="S4.SS3.p3.11.m11.2.2.1.1.3" xref="S4.SS3.p3.11.m11.2.2.1.1.3.cmml"><mi id="S4.SS3.p3.11.m11.2.2.1.1.3.2" xref="S4.SS3.p3.11.m11.2.2.1.1.3.2.cmml">l</mi><mo id="S4.SS3.p3.11.m11.2.2.1.1.3.1" xref="S4.SS3.p3.11.m11.2.2.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p3.11.m11.2.2.1.1.3.3" xref="S4.SS3.p3.11.m11.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p3.11.m11.3.3.2.4" xref="S4.SS3.p3.11.m11.3.3.3.cmml">,</mo><mi id="S4.SS3.p3.11.m11.1.1" mathvariant="normal" xref="S4.SS3.p3.11.m11.1.1.cmml">…</mi><mo id="S4.SS3.p3.11.m11.3.3.2.5" xref="S4.SS3.p3.11.m11.3.3.3.cmml">,</mo><msub id="S4.SS3.p3.11.m11.3.3.2.2" xref="S4.SS3.p3.11.m11.3.3.2.2.cmml"><mi id="S4.SS3.p3.11.m11.3.3.2.2.2" xref="S4.SS3.p3.11.m11.3.3.2.2.2.cmml">x</mi><mi id="S4.SS3.p3.11.m11.3.3.2.2.3" xref="S4.SS3.p3.11.m11.3.3.2.2.3.cmml">n</mi></msub><mo id="S4.SS3.p3.11.m11.3.3.2.6" stretchy="false" xref="S4.SS3.p3.11.m11.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.3b"><list id="S4.SS3.p3.11.m11.3.3.3.cmml" xref="S4.SS3.p3.11.m11.3.3.2"><apply id="S4.SS3.p3.11.m11.2.2.1.1.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.2.2.1.1.1.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p3.11.m11.2.2.1.1.2.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1.2">𝑥</ci><apply id="S4.SS3.p3.11.m11.2.2.1.1.3.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1.3"><plus id="S4.SS3.p3.11.m11.2.2.1.1.3.1.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1.3.1"></plus><ci id="S4.SS3.p3.11.m11.2.2.1.1.3.2.cmml" xref="S4.SS3.p3.11.m11.2.2.1.1.3.2">𝑙</ci><cn id="S4.SS3.p3.11.m11.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.11.m11.2.2.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1">…</ci><apply id="S4.SS3.p3.11.m11.3.3.2.2.cmml" xref="S4.SS3.p3.11.m11.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.3.3.2.2.1.cmml" xref="S4.SS3.p3.11.m11.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.11.m11.3.3.2.2.2.cmml" xref="S4.SS3.p3.11.m11.3.3.2.2.2">𝑥</ci><ci id="S4.SS3.p3.11.m11.3.3.2.2.3.cmml" xref="S4.SS3.p3.11.m11.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.3c">[x_{l+1},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.11.m11.3d">[ italic_x start_POSTSUBSCRIPT italic_l + 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> represents the remaining input context.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.6">In the first step, we condition the CodeLM on the included libraries <math alttext="[x_{1},\dots,x_{l}]" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.3"><semantics id="S4.SS3.p4.1.m1.3a"><mrow id="S4.SS3.p4.1.m1.3.3.2" xref="S4.SS3.p4.1.m1.3.3.3.cmml"><mo id="S4.SS3.p4.1.m1.3.3.2.3" stretchy="false" xref="S4.SS3.p4.1.m1.3.3.3.cmml">[</mo><msub id="S4.SS3.p4.1.m1.2.2.1.1" xref="S4.SS3.p4.1.m1.2.2.1.1.cmml"><mi id="S4.SS3.p4.1.m1.2.2.1.1.2" xref="S4.SS3.p4.1.m1.2.2.1.1.2.cmml">x</mi><mn id="S4.SS3.p4.1.m1.2.2.1.1.3" xref="S4.SS3.p4.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p4.1.m1.3.3.2.4" xref="S4.SS3.p4.1.m1.3.3.3.cmml">,</mo><mi id="S4.SS3.p4.1.m1.1.1" mathvariant="normal" xref="S4.SS3.p4.1.m1.1.1.cmml">…</mi><mo id="S4.SS3.p4.1.m1.3.3.2.5" xref="S4.SS3.p4.1.m1.3.3.3.cmml">,</mo><msub id="S4.SS3.p4.1.m1.3.3.2.2" xref="S4.SS3.p4.1.m1.3.3.2.2.cmml"><mi id="S4.SS3.p4.1.m1.3.3.2.2.2" xref="S4.SS3.p4.1.m1.3.3.2.2.2.cmml">x</mi><mi id="S4.SS3.p4.1.m1.3.3.2.2.3" xref="S4.SS3.p4.1.m1.3.3.2.2.3.cmml">l</mi></msub><mo id="S4.SS3.p4.1.m1.3.3.2.6" stretchy="false" xref="S4.SS3.p4.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.3b"><list id="S4.SS3.p4.1.m1.3.3.3.cmml" xref="S4.SS3.p4.1.m1.3.3.2"><apply id="S4.SS3.p4.1.m1.2.2.1.1.cmml" xref="S4.SS3.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p4.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p4.1.m1.2.2.1.1.2.cmml" xref="S4.SS3.p4.1.m1.2.2.1.1.2">𝑥</ci><cn id="S4.SS3.p4.1.m1.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p4.1.m1.2.2.1.1.3">1</cn></apply><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">…</ci><apply id="S4.SS3.p4.1.m1.3.3.2.2.cmml" xref="S4.SS3.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.3.3.2.2.1.cmml" xref="S4.SS3.p4.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p4.1.m1.3.3.2.2.2.cmml" xref="S4.SS3.p4.1.m1.3.3.2.2.2">𝑥</ci><ci id="S4.SS3.p4.1.m1.3.3.2.2.3.cmml" xref="S4.SS3.p4.1.m1.3.3.2.2.3">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.3c">[x_{1},\dots,x_{l}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.3d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math> and generate up to <math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><msup id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2">𝑚</ci><ci id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> additional tokens. We then update the input context to <math alttext="\mathbf{x^{\prime}}=[x_{1},\dots,x_{l},\dots,x_{l^{\prime}},\dots,x_{n}]" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.7"><semantics id="S4.SS3.p4.3.m3.7a"><mrow id="S4.SS3.p4.3.m3.7.7" xref="S4.SS3.p4.3.m3.7.7.cmml"><msup id="S4.SS3.p4.3.m3.7.7.6" xref="S4.SS3.p4.3.m3.7.7.6.cmml"><mi id="S4.SS3.p4.3.m3.7.7.6.2" xref="S4.SS3.p4.3.m3.7.7.6.2.cmml">𝐱</mi><mo id="S4.SS3.p4.3.m3.7.7.6.3" xref="S4.SS3.p4.3.m3.7.7.6.3.cmml">′</mo></msup><mo id="S4.SS3.p4.3.m3.7.7.5" xref="S4.SS3.p4.3.m3.7.7.5.cmml">=</mo><mrow id="S4.SS3.p4.3.m3.7.7.4.4" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml"><mo id="S4.SS3.p4.3.m3.7.7.4.4.5" stretchy="false" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">[</mo><msub id="S4.SS3.p4.3.m3.4.4.1.1.1" xref="S4.SS3.p4.3.m3.4.4.1.1.1.cmml"><mi id="S4.SS3.p4.3.m3.4.4.1.1.1.2" xref="S4.SS3.p4.3.m3.4.4.1.1.1.2.cmml">x</mi><mn id="S4.SS3.p4.3.m3.4.4.1.1.1.3" xref="S4.SS3.p4.3.m3.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p4.3.m3.7.7.4.4.6" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><mi id="S4.SS3.p4.3.m3.1.1" mathvariant="normal" xref="S4.SS3.p4.3.m3.1.1.cmml">…</mi><mo id="S4.SS3.p4.3.m3.7.7.4.4.7" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><msub id="S4.SS3.p4.3.m3.5.5.2.2.2" xref="S4.SS3.p4.3.m3.5.5.2.2.2.cmml"><mi id="S4.SS3.p4.3.m3.5.5.2.2.2.2" xref="S4.SS3.p4.3.m3.5.5.2.2.2.2.cmml">x</mi><mi id="S4.SS3.p4.3.m3.5.5.2.2.2.3" xref="S4.SS3.p4.3.m3.5.5.2.2.2.3.cmml">l</mi></msub><mo id="S4.SS3.p4.3.m3.7.7.4.4.8" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><mi id="S4.SS3.p4.3.m3.2.2" mathvariant="normal" xref="S4.SS3.p4.3.m3.2.2.cmml">…</mi><mo id="S4.SS3.p4.3.m3.7.7.4.4.9" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><msub id="S4.SS3.p4.3.m3.6.6.3.3.3" xref="S4.SS3.p4.3.m3.6.6.3.3.3.cmml"><mi id="S4.SS3.p4.3.m3.6.6.3.3.3.2" xref="S4.SS3.p4.3.m3.6.6.3.3.3.2.cmml">x</mi><msup id="S4.SS3.p4.3.m3.6.6.3.3.3.3" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3.cmml"><mi id="S4.SS3.p4.3.m3.6.6.3.3.3.3.2" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3.2.cmml">l</mi><mo id="S4.SS3.p4.3.m3.6.6.3.3.3.3.3" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3.3.cmml">′</mo></msup></msub><mo id="S4.SS3.p4.3.m3.7.7.4.4.10" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><mi id="S4.SS3.p4.3.m3.3.3" mathvariant="normal" xref="S4.SS3.p4.3.m3.3.3.cmml">…</mi><mo id="S4.SS3.p4.3.m3.7.7.4.4.11" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">,</mo><msub id="S4.SS3.p4.3.m3.7.7.4.4.4" xref="S4.SS3.p4.3.m3.7.7.4.4.4.cmml"><mi id="S4.SS3.p4.3.m3.7.7.4.4.4.2" xref="S4.SS3.p4.3.m3.7.7.4.4.4.2.cmml">x</mi><mi id="S4.SS3.p4.3.m3.7.7.4.4.4.3" xref="S4.SS3.p4.3.m3.7.7.4.4.4.3.cmml">n</mi></msub><mo id="S4.SS3.p4.3.m3.7.7.4.4.12" stretchy="false" xref="S4.SS3.p4.3.m3.7.7.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.7b"><apply id="S4.SS3.p4.3.m3.7.7.cmml" xref="S4.SS3.p4.3.m3.7.7"><eq id="S4.SS3.p4.3.m3.7.7.5.cmml" xref="S4.SS3.p4.3.m3.7.7.5"></eq><apply id="S4.SS3.p4.3.m3.7.7.6.cmml" xref="S4.SS3.p4.3.m3.7.7.6"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.7.7.6.1.cmml" xref="S4.SS3.p4.3.m3.7.7.6">superscript</csymbol><ci id="S4.SS3.p4.3.m3.7.7.6.2.cmml" xref="S4.SS3.p4.3.m3.7.7.6.2">𝐱</ci><ci id="S4.SS3.p4.3.m3.7.7.6.3.cmml" xref="S4.SS3.p4.3.m3.7.7.6.3">′</ci></apply><list id="S4.SS3.p4.3.m3.7.7.4.5.cmml" xref="S4.SS3.p4.3.m3.7.7.4.4"><apply id="S4.SS3.p4.3.m3.4.4.1.1.1.cmml" xref="S4.SS3.p4.3.m3.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.4.4.1.1.1.1.cmml" xref="S4.SS3.p4.3.m3.4.4.1.1.1">subscript</csymbol><ci id="S4.SS3.p4.3.m3.4.4.1.1.1.2.cmml" xref="S4.SS3.p4.3.m3.4.4.1.1.1.2">𝑥</ci><cn id="S4.SS3.p4.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="S4.SS3.p4.3.m3.4.4.1.1.1.3">1</cn></apply><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">…</ci><apply id="S4.SS3.p4.3.m3.5.5.2.2.2.cmml" xref="S4.SS3.p4.3.m3.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.5.5.2.2.2.1.cmml" xref="S4.SS3.p4.3.m3.5.5.2.2.2">subscript</csymbol><ci id="S4.SS3.p4.3.m3.5.5.2.2.2.2.cmml" xref="S4.SS3.p4.3.m3.5.5.2.2.2.2">𝑥</ci><ci id="S4.SS3.p4.3.m3.5.5.2.2.2.3.cmml" xref="S4.SS3.p4.3.m3.5.5.2.2.2.3">𝑙</ci></apply><ci id="S4.SS3.p4.3.m3.2.2.cmml" xref="S4.SS3.p4.3.m3.2.2">…</ci><apply id="S4.SS3.p4.3.m3.6.6.3.3.3.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.6.6.3.3.3.1.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3">subscript</csymbol><ci id="S4.SS3.p4.3.m3.6.6.3.3.3.2.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3.2">𝑥</ci><apply id="S4.SS3.p4.3.m3.6.6.3.3.3.3.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.6.6.3.3.3.3.1.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3">superscript</csymbol><ci id="S4.SS3.p4.3.m3.6.6.3.3.3.3.2.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3.2">𝑙</ci><ci id="S4.SS3.p4.3.m3.6.6.3.3.3.3.3.cmml" xref="S4.SS3.p4.3.m3.6.6.3.3.3.3.3">′</ci></apply></apply><ci id="S4.SS3.p4.3.m3.3.3.cmml" xref="S4.SS3.p4.3.m3.3.3">…</ci><apply id="S4.SS3.p4.3.m3.7.7.4.4.4.cmml" xref="S4.SS3.p4.3.m3.7.7.4.4.4"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.7.7.4.4.4.1.cmml" xref="S4.SS3.p4.3.m3.7.7.4.4.4">subscript</csymbol><ci id="S4.SS3.p4.3.m3.7.7.4.4.4.2.cmml" xref="S4.SS3.p4.3.m3.7.7.4.4.4.2">𝑥</ci><ci id="S4.SS3.p4.3.m3.7.7.4.4.4.3.cmml" xref="S4.SS3.p4.3.m3.7.7.4.4.4.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.7c">\mathbf{x^{\prime}}=[x_{1},\dots,x_{l},\dots,x_{l^{\prime}},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.7d">bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> by incorporating the newly included libraries and modules. Note that, in the first step, we only consider the newly added libraries and discard the other types of the generated token. In the second step, we generate up to <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.1"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.1d">italic_m</annotation></semantics></math> tokens <math alttext="\mathbf{y}=[y_{1},\dots,y_{m}]" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.3"><semantics id="S4.SS3.p4.5.m5.3a"><mrow id="S4.SS3.p4.5.m5.3.3" xref="S4.SS3.p4.5.m5.3.3.cmml"><mi id="S4.SS3.p4.5.m5.3.3.4" xref="S4.SS3.p4.5.m5.3.3.4.cmml">𝐲</mi><mo id="S4.SS3.p4.5.m5.3.3.3" xref="S4.SS3.p4.5.m5.3.3.3.cmml">=</mo><mrow id="S4.SS3.p4.5.m5.3.3.2.2" xref="S4.SS3.p4.5.m5.3.3.2.3.cmml"><mo id="S4.SS3.p4.5.m5.3.3.2.2.3" stretchy="false" xref="S4.SS3.p4.5.m5.3.3.2.3.cmml">[</mo><msub id="S4.SS3.p4.5.m5.2.2.1.1.1" xref="S4.SS3.p4.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS3.p4.5.m5.2.2.1.1.1.2" xref="S4.SS3.p4.5.m5.2.2.1.1.1.2.cmml">y</mi><mn id="S4.SS3.p4.5.m5.2.2.1.1.1.3" xref="S4.SS3.p4.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p4.5.m5.3.3.2.2.4" xref="S4.SS3.p4.5.m5.3.3.2.3.cmml">,</mo><mi id="S4.SS3.p4.5.m5.1.1" mathvariant="normal" xref="S4.SS3.p4.5.m5.1.1.cmml">…</mi><mo id="S4.SS3.p4.5.m5.3.3.2.2.5" xref="S4.SS3.p4.5.m5.3.3.2.3.cmml">,</mo><msub id="S4.SS3.p4.5.m5.3.3.2.2.2" xref="S4.SS3.p4.5.m5.3.3.2.2.2.cmml"><mi id="S4.SS3.p4.5.m5.3.3.2.2.2.2" xref="S4.SS3.p4.5.m5.3.3.2.2.2.2.cmml">y</mi><mi id="S4.SS3.p4.5.m5.3.3.2.2.2.3" xref="S4.SS3.p4.5.m5.3.3.2.2.2.3.cmml">m</mi></msub><mo id="S4.SS3.p4.5.m5.3.3.2.2.6" stretchy="false" xref="S4.SS3.p4.5.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.3b"><apply id="S4.SS3.p4.5.m5.3.3.cmml" xref="S4.SS3.p4.5.m5.3.3"><eq id="S4.SS3.p4.5.m5.3.3.3.cmml" xref="S4.SS3.p4.5.m5.3.3.3"></eq><ci id="S4.SS3.p4.5.m5.3.3.4.cmml" xref="S4.SS3.p4.5.m5.3.3.4">𝐲</ci><list id="S4.SS3.p4.5.m5.3.3.2.3.cmml" xref="S4.SS3.p4.5.m5.3.3.2.2"><apply id="S4.SS3.p4.5.m5.2.2.1.1.1.cmml" xref="S4.SS3.p4.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS3.p4.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p4.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS3.p4.5.m5.2.2.1.1.1.2">𝑦</ci><cn id="S4.SS3.p4.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p4.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1">…</ci><apply id="S4.SS3.p4.5.m5.3.3.2.2.2.cmml" xref="S4.SS3.p4.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.3.3.2.2.2.1.cmml" xref="S4.SS3.p4.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p4.5.m5.3.3.2.2.2.2.cmml" xref="S4.SS3.p4.5.m5.3.3.2.2.2.2">𝑦</ci><ci id="S4.SS3.p4.5.m5.3.3.2.2.2.3.cmml" xref="S4.SS3.p4.5.m5.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.3c">\mathbf{y}=[y_{1},\dots,y_{m}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.3d">bold_y = [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ]</annotation></semantics></math> given the updated input context <math alttext="\mathbf{x^{\prime}}" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m6.1"><semantics id="S4.SS3.p4.6.m6.1a"><msup id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml"><mi id="S4.SS3.p4.6.m6.1.1.2" xref="S4.SS3.p4.6.m6.1.1.2.cmml">𝐱</mi><mo id="S4.SS3.p4.6.m6.1.1.3" xref="S4.SS3.p4.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.1b"><apply id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.6.m6.1.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p4.6.m6.1.1.2.cmml" xref="S4.SS3.p4.6.m6.1.1.2">𝐱</ci><ci id="S4.SS3.p4.6.m6.1.1.3.cmml" xref="S4.SS3.p4.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.1c">\mathbf{x^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m6.1d">bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Listing <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS3" title="4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4.3</span></a> provides an example of updating the given input context. Listing <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS3" title="4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4.3</span></a> shows the original given prompt from the CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> benchmark, and Listing <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#S4.SS3" title="4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4.3</span></a> shows the updated prompt after conditioning our fine-tuned model on the included libraries of the given input context.</p>
</div>
<figure class="ltx_figure" id="S4.SS3.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="S4.SS3.fig1.1">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.SS3.fig1.3.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.fig1.4.2" style="font-size:90%;">Given input context</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="S4.SS3.fig1.5">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgcmVxdWVzdCwgbWFrZV9yZXNwb25zZQoKYXBwID0gRmxhc2soX19uYW1lX18pCgpAYXBwLnJvdXRlKCcvcmVwbGFjZVRlbXBsYXRlJykKZGVmIHJlcGxhY2VfdGVtcGxhdGVfd2l0aF9wYXJhbSgpOg==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx1.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx1.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.7">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.10">make_response</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.1">app</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.3">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.5">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.7">__name__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.8">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_tag ltx_tag_listingline">4</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.1">@app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.2">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.3">route</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.4">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx5.5" style="color:#9400D1;">’/replaceTemplate’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.6">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx6.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.3">replace_template_with_param</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.4">():</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="S4.SS3.fig1.6">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.SS3.fig1.8.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.fig1.9.2" style="font-size:90%;">Updated input context</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="S4.SS3.fig1.10">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgcmVxdWVzdCwgbWFrZV9yZXNwb25zZWAsIGVzY2FwZWAKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKQGFwcC5yb3V0ZSgnL3JlcGxhY2VUZW1wbGF0ZScpCmRlZiByZXBsYWNlX3RlbXBsYXRlX3dpdGhfcGFyYW0oKTo=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx7.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx7.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.7">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.10">make_response</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.11"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.12"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx7.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx7.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.1">app</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.3">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.5">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.7">__name__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.8">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_tag ltx_tag_listingline">4</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.1">@app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.2">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.3">route</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.4">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx11.5" style="color:#9400D1;">’/replaceTemplate’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.6">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx12.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.3">replace_template_with_param</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.4">():</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S4.SS3.fig1.16.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S4.SS3.fig1.17.2" style="font-size:90%;">An example of updating the given context using our two-step generate approach. (a) The original CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> prompt. (b) Updated context after conditioning the included libraries on our fine-tuned model. The differences are highlighted.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_section ltx_figure_panel" id="S5">
<h2 class="ltx_title ltx_font_typewriter ltx_title_section">
<span class="ltx_tag ltx_tag_section"><span class="ltx_text ltx_font_serif" id="S5.1.1.1">5</span> </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.p1.1.1">In the following, we demonstrate how HexaCoder effectively enhances the capabilities of various CodeLMs to generate more secure code while maintaining their utility. We begin by detailing our experimental setup. Then, we study the effectiveness of our approach in synthesizing pairs of vulnerable and secure code. Finally, we compare the performance of our approach with the state-of-the-art method for generating secure code using CodeLMs.</span></p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="S5.SS1.1.1.1">5.1</span> </span>Setup</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.p1.1.1">Below, we provide details of our experimental setup.</span></p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS1.SSS1.1.1.1">5.1.1</span> </span>Models</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.1">For our experiments, we use different models to synthesize the code and also to evaluate the effectiveness of our approach. To generate vulnerable code samples, we follow the few-shot prompting approach proposed by Hajipour et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.4">. In their work, they use CodeGen-multi with 6B parameters </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.7">, GPT-3.5 (gpt-3.5-turbo-0301) </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib53" title="">53</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.10">, and Codex </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.13"> (code-davinci-002) models to synthesize vulnerable codes. In our code synthesis pipeline, we incorporate these generated samples as our set of vulnerable codes. Additionally, we use GPT-4 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p1.1.16"> (gpt-4-turbo-preview) to fix the given vulnerable codes.</span></p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<p class="ltx_p" id="S5.SS1.SSS1.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.1">We evaluate the effectiveness of our approach by fine-tuning three models in different sizes. In our evaluation, we use CodeGen-350-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.4">, CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.7">, InCoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.10">, and DeepSeek-Coder-V2-Lite-Base with 16B parameters </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS1.p2.1.13">.</span></p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS1.SSS2.1.1.1">5.1.2</span> </span>Evaluating Code Security</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.1">We assess the security of the models using state-of-the-art methods </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.4">, which include both manually designed </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.7"> and automatically generated </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.10"> scenarios. These scenarios consist of a few initial lines of code, which can include libraries, function definitions, comments, and portions of the main code. We use these scenarios as input prompts to evaluate the models. Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.13"> offer only 2 to 3 prompts for each CWE, whereas the CodeLMSec benchmark </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p1.1.16"> includes 20 diverse prompts per CWE. By utilizing these two sets that contain Python and C/C++ prompts, we can thoroughly evaluate the security of the models across a wide range of scenarios.</span></p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p2">
<p class="ltx_p" id="S5.SS1.SSS2.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.1">Following the state-of-the-art work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.4">, we generate for each scenario up to 200 new tokens with a temperature of </span><math alttext="0.4" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p2.1.m1.1"><semantics id="S5.SS1.SSS2.p2.1.m1.1a"><mn id="S5.SS1.SSS2.p2.1.m1.1.1" xref="S5.SS1.SSS2.p2.1.m1.1.1.cmml">0.4</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p2.1.m1.1b"><cn id="S5.SS1.SSS2.p2.1.m1.1.1.cmml" type="float" xref="S5.SS1.SSS2.p2.1.m1.1.1">0.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p2.1.m1.1c">0.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p2.1.m1.1d">0.4</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.5"> to complete the provided input. We then use CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.6.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.7.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.8"> to evaluate the security issues in the generated code. CodeQL offers queries to identify 29 different CWEs for Python code and 35 CWEs for C/C++ code. Although we focus on 11 specific CWEs, as listed in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S3.T1" title="Table 1 ‣ 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.9">
, we analyze the generated code for all CWEs supported by CodeQL and report all identified security vulnerabilities in both Python and C/C++ code. In our results, CWEs not listed in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S3.T1" title="Table 1 ‣ 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.10"> are categorized as </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS1.SSS2.p2.1.11">Other</span><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS2.p2.1.12">.</span></p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS1.SSS3.1.1.1">5.1.3</span> </span>Evaluating Functional Correctness</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.1">To assess the model’s ability to generate functionally correct code, we use the HumanEval benchmark </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib13" title="">13</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.4">, which has been widely adopted in previous studies </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.7">. We evaluate the model’s performance using the pass@</span><math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.1.m1.1"><semantics id="S5.SS1.SSS3.p1.1.m1.1a"><mi id="S5.SS1.SSS3.p1.1.m1.1.1" xref="S5.SS1.SSS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.1.m1.1b"><ci id="S5.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.1.m1.1d">italic_k</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.8"> metric. This metric involves generating code solutions for each problem, considering a problem solved if any of the solutions passes all unit tests. We then report the total fraction of problems that were successfully solved. Following the approach in existing work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.9.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.10.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.11">, we use an unbiased estimator to sample programs. We run the models using four common sampling temperatures (i.e., 0.2, 0.4, 0.6, and 0.8) and report the highest pass@</span><math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.2.m2.1"><semantics id="S5.SS1.SSS3.p1.2.m2.1a"><mi id="S5.SS1.SSS3.p1.2.m2.1.1" xref="S5.SS1.SSS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.2.m2.1b"><ci id="S5.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.2.m2.1d">italic_k</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.12"> achieved. To ensure a fair comparison, following the approach of He and Vechev </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.13.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.14.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS1.SSS3.p1.2.15">, we generate up to 300 tokens for each program.</span></p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="S5.SS2.1.1.1">5.2</span> </span>Performance of Our Code Synthesis Approach</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.1">In our data synthesis pipeline, we generate a set of vulnerable and fixed codes. To generate the vulnerable set, we employ the few-shot prompting approach proposed in </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.4">. To minimize unnecessary computing usage, we use a set of 2,042 vulnerable code samples generated by this work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.7">. This set contains 1,519 Python codes and 523 C/C++ codes. Each of these code samples contains at least one vulnerability of a CWE type listed in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S3.T1" title="Table 1 ‣ 3 Technical Background ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.8">. Note that, using CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.9.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.10.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.11">, we validate whether the code contains the targeted vulnerabilities. Only the samples that pass this validation are included in the vulnerable set.</span></p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.1">To fix the vulnerabilities in each code, as described in Subsection </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S4.SS1" title="4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4.1</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.2">, we consider each vulnerable code, along with its corresponding security report, as the input of GPT-4 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.5">. Given the input, we generate up to 1,000 tokens using GPT-4 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.6.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.7.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.8"> with a temperature of </span><math alttext="0.1" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><cn id="S5.SS2.p2.1.m1.1.1.cmml" type="float" xref="S5.SS2.p2.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">0.1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.9">. In an initial study, we found that these two parameters provide the best results considering the budget and the model’s performance. Given the provided input to the GPT-4 model, we generate one sample and extract the fixed code from the provided sample. We then check the generated code again with CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.10.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.11.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.12">, and if the code does not contain any vulnerability, we consider it as an instance of our secure codes. Out of 2,042 vulnerable code samples, our approach successfully fixed the vulnerabilities in 1,776 of them, which we refer to as the </span><em class="ltx_emph ltx_font_typewriter ltx_font_italic" id="S5.SS2.p2.1.13">secure code set</em><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.14">. This secure set includes 1,414 Python codes and 362 C/C++ codes. Detailed results of the synthesized code data are provided in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T2" title="Table 2 ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.15">. In this table, the first column lists the type of CWE, and the second column shows the number of synthesized secure Python and C/C++ codes. The overall results for the synthesized secure codes are presented in the last row.</span></p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.T2.4.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.5.2" style="font-size:90%;">Statistics of our synthesized secure code data.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.6" style="width:173.4pt;height:177.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.8pt,28.4pt) scale(0.757416290705909,0.757416290705909) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.6.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.6.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.1.1.1.1">CWE</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T2.6.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.1.1.2.1"># per language</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.6.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T2.6.1.2.1.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.2.1.1.1">CWE-022</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.6.1.2.1.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.2.1.2.1">Py: 298, C/C++: 50</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.3.2.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.3.2.1.1">CWE-502</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.3.2.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.3.2.2.1">Py: 228</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.4.3.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.4.3.1.1">CWE-611</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.4.3.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.4.3.2.1">Py: 205</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.5.4.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.5.4.1.1">CWE-094</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.5.4.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.5.4.2.1">Py: 181</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.6.5.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.6.5.1.1">CWE-117</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.6.5.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.6.5.2.1">Py: 178</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.7.6.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.7.6.1.1">CWE-079</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.7.6.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.7.6.2.1">Py: 176</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.8.7.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.8.7.1.1">CWE-078</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.8.7.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.8.7.2.1">Py: 127</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.9.8.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.9.8.1.1">CWE-787</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.9.8.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.9.8.2.1">C/C++: 115</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.10.9.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.10.9.1.1">CWE-119</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.10.9.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.10.9.2.1">C/C++: 102</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.11.10.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.11.10.1.1">CWE-476</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.11.10.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.11.10.2.1">C/C++: 95</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.6.1.12.11.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.12.11.1.1">CWE-020</span></th>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.12.11.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.12.11.2.1">Py: 21</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T2.6.1.13.12.1"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.13.12.1.1">Overall</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T2.6.1.13.12.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.6.1.13.12.2.1">Total: 1776, Py: 1414, C/C++: 362</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS2.SSS1.1.1.1">5.2.1</span> </span>Importance of Security Reports in Synthesizing Secure Codes</h4>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.T3.4.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.5.2" style="font-size:90%;">Impact of each security report component on repair rates for different CWE types. The results provide the percentage of the repaired codes. CodeQL refers to the CodeQL report, and Hint denotes the provided security hint. The analysis covers five specific CWE types, with the final column showing the average repair rate across all CWEs.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.6.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.6.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.1.1">CodeQL</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.6.1.1.2"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.2.1">Hint</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.3"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.3.1">CWE-022</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.4"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.4.1">CWE-078</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.5"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.5.1">CWE-079</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.6"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.6.1">CWE-094</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.7"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.7.1">CWE-190</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.8"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.1.1.8.1">Avg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.6.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.6.2.1.1"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.1.1">✗</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.6.2.1.2"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.2.1">✗</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.3"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.3.1">56.66%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.4"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.4.1">23.66%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.5"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.5.1">46.66%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.6"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.6.1">43.33%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.7"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.7.1">40.00%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.2.1.8"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.2.1.8.1">42.66%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.6.3.2.1"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.1.1">✓</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.3.2.2"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.2.1">✗</span></th>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.3"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.3.1">73.33%</span></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.4"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.4.1">43.33%</span></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.5"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.5.1">63.33%</span></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.6"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.6.1">80.00%</span></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.7"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.7.1">56.66%</span></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.3.2.8"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.3.2.8.1">63.33%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T3.6.4.3.1"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.4.3.1.1">✓</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T3.6.4.3.2"><span class="ltx_text ltx_font_typewriter" id="S5.T3.6.4.3.2.1">✓</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.3"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.3.1">90.00%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.4"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.4.1">73.33%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.5"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.5.1">86.66%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.6"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.6.1">93.33%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.7"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.7.1">76.66%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.6.4.3.8"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.T3.6.4.3.8.1">83.99%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.1">In our data synthesis pipeline, the security report contains the report provided by CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.4"> together with the security hint adapted from the corresponding CWEs pages of MITRE </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib51" title="">51</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.7"> and Semgrep documentation </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib40" title="">40</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.10">. We incorporate this security report in the input prompt to guide the model in resolving the root cause of the software faults. Here, we examine the impact of each component of the security report on resolving the security issues. For this experiment, we evaluate three variations of the secure code synthesis approach:
</span>
<span class="ltx_inline-enumerate" id="S5.I1">
<span class="ltx_inline-item" id="S5.I1.i1"><span class="ltx_tag ltx_tag_inline-item">1.</span> <span class="ltx_text ltx_font_typewriter" id="S5.I1.i1.1">Without any security report.
</span></span>
<span class="ltx_inline-item" id="S5.I1.i2"><span class="ltx_tag ltx_tag_inline-item">2.</span> <span class="ltx_text ltx_font_typewriter" id="S5.I1.i2.1">Using CodeQL output as the security report.
</span></span>
<span class="ltx_inline-item" id="S5.I1.i3"><span class="ltx_tag ltx_tag_inline-item">3.</span> <span class="ltx_text ltx_font_typewriter" id="S5.I1.i3.1">Using CodeQL output along with the security hint as the security report.
</span></span>
</span><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p1.1.11"></span></p>
</div>
<div class="ltx_para" id="S5.SS2.SSS1.p2">
<p class="ltx_p" id="S5.SS2.SSS1.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.1">To perform this experiment, we randomly selected 30 vulnerable codes for each CWE to evaluate our secure code synthesis pipeline using three variations of the security report. We limited the selection to 30 programs per CWE to maintain a reasonable compute budget. Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T3" title="Table 3 ‣ 5.2.1 Importance of Security Reports in Synthesizing Secure Codes ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.2"> shows the repair rate results using different security report components. We consider a code fixed if CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.5"> does not detect any vulnerabilities in it. The first row of this table provides results for the baseline case, in which we do not provide any security report about the vulnerability in the code. In this case, we simply ask the model to identify any vulnerabilities in the code and attempt to repair them directly. We provide the input prompt for this case in Appendix </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A1" title="Appendix A Details of the Input prompts ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">A</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.6">. The second row of Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T3" title="Table 3 ‣ 5.2.1 Importance of Security Reports in Synthesizing Secure Codes ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.7"> presents the results for the scenario where only the CodeQL report is included as the security report in the input prompt. Comparing the first two rows of Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T3" title="Table 3 ‣ 5.2.1 Importance of Security Reports in Synthesizing Secure Codes ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.8">, we observe that for all of the CWEs, employing the CodeQL report provides helpful guidance for the model to fix the vulnerabilities. For example, for CWE-094, using the CodeQL report, we were able to repair 80.0% of codes, compared to only 43.33% when we didn’t use any security report. The last row of Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T3" title="Table 3 ‣ 5.2.1 Importance of Security Reports in Synthesizing Secure Codes ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS1.p2.1.9"> shows the results for scenarios where we use both the CodeQL report and the security hint to guide the model. These results demonstrate that by using the CodeQL report along with the security hint, we gained the highest repair rate compared to other approaches. On average, with the full security report, we were able to repair 83.99% of the code, whereas using only CodeQL, we repaired just 63.33% of the code.</span></p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS2.SSS2.1.1.1">5.2.2</span> </span>Example of a Fixed Code</h4>
<div class="ltx_para" id="S5.SS2.SSS2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.1">In Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS2" title="5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.2.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.2">, we provide an example of a vulnerable C code with its corresponding fixed code. Note that we only provide part of the generated code, and we chose this example for illustration purposes. The other samples in our dataset have higher complexity. Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS2" title="5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.2.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.3"> contains an integer overflow (CWE-190) vulnerability at line 17. This vulnerability arises if the user inputs a value that, when multiplied by 2, exceeds the maximum limit for an integer variable, leading to an integer overflow. In Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS2" title="5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.2.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.4">, we provide the fixed version of the code generated using our code synthesis pipeline. The model fixed the code by including the limits.h library, which provides access to the INT_MAX and INT_MIN macros, representing the maximum and minimum integer values. Since the code in Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS2.SSS2" title="5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.2.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.5"> involves multiplication by 2, the model added a validation at line 21 to check if the input falls within the integer bounds, thereby preventing the overflow. Additionally, the model inserted a check at line 16 to ensure that scanf successfully reads the expected input. More code examples are provided in Appendix </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS2.SSS2.p1.1.6"></span></p>
</div>
<figure class="ltx_figure" id="S5.SS2.SSS2.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS2.SSS2.fig1.1">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.SS2.SSS2.fig1.4.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS2.SSS2.fig1.5.2" style="font-size:90%;">Vulnerable code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_C ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="S5.SS2.SSS2.fig1.6">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0ZGRlZi5oPgojaW5jbHVkZSA8c3RyaW5nLmg+CiNpbmNsdWRlIDxzdGRpbnQuaD4KCi8qIFRoaXMgZnVuY3Rpb24gcmVhZHMgYW4gaW50ZWdlciBmcm9tIHN0ZGluIGFuZCByZXR1cm5zIHRoZSB2YWx1ZSBtdWx0aXBsaWVkIGJ5IDIgKi8KCmludCByZWFkQW5kTXVsdGlwbHlCeVR3bygpCnsKICAgIC8qIEluaXRpYWxpemUgZGF0YSAqLwogICAgaW50IGRhdGE7CiAgICBkYXRhID0gMDsKICAgIC8qIFJlYWQgaW50ZWdlciBmcm9tIHN0ZGluICovCiAgICBzY2FuZigiJWQiLCAmZGF0YSk7CiAgICAvKiBNdWx0aXBseSBieSB0d28gKi8KICAgIGRhdGEgKj0gMjsKICAgIC8qIFJldHVybiByZXN1bHQgKi8KICAgIHJldHVybiBkYXRhOwp9">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx13.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.4">stdio</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx14.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4">stdlib</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx15.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.4">stddef</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx16.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.4">string</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx17.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.4">stdint</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_tag ltx_tag_listingline">6</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx19.1" style="color:#009900;">/*<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.1"> </span>This<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.2"> </span>function<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.3"> </span>reads<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.4"> </span>an<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.5"> </span>integer<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.6"> </span>from<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.7"> </span>stdin<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.8"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.9"> </span>returns<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.10"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.11"> </span>value<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.12"> </span>multiplied<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.13"> </span>by<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.14"> </span>2<span class="ltx_text ltx_lst_space" id="lstnumberx19.1.15"> </span>*/</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_tag ltx_tag_listingline">8</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx21.1" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.3">readAndMultiplyByTwo</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.4">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.1">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx23.2" style="color:#009900;">/*<span class="ltx_text ltx_lst_space" id="lstnumberx23.2.1"> </span>Initialize<span class="ltx_text ltx_lst_space" id="lstnumberx23.2.2"> </span>data<span class="ltx_text ltx_lst_space" id="lstnumberx23.2.3"> </span>*/</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx24.2" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.4">data</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.5">;</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.2">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.6">0;</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx26.2" style="color:#009900;">/*<span class="ltx_text ltx_lst_space" id="lstnumberx26.2.1"> </span>Read<span class="ltx_text ltx_lst_space" id="lstnumberx26.2.2"> </span>integer<span class="ltx_text ltx_lst_space" id="lstnumberx26.2.3"> </span>from<span class="ltx_text ltx_lst_space" id="lstnumberx26.2.4"> </span>stdin<span class="ltx_text ltx_lst_space" id="lstnumberx26.2.5"> </span>*/</span>
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.2">scanf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx27.4" style="color:#9400D1;">"%d"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.7">&amp;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.8">data</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.9">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx28.2" style="color:#009900;">/*<span class="ltx_text ltx_lst_space" id="lstnumberx28.2.1"> </span>Multiply<span class="ltx_text ltx_lst_space" id="lstnumberx28.2.2"> </span>by<span class="ltx_text ltx_lst_space" id="lstnumberx28.2.3"> </span>two<span class="ltx_text ltx_lst_space" id="lstnumberx28.2.4"> </span>*/</span>
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.2">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.4">*=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.6">2;</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx30.2" style="color:#009900;">/*<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.1"> </span>Return<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.2"> </span>result<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.3"> </span>*/</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx31.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.4">data</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.5">;</span>
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.1">}</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS2.SSS2.fig1.7">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.SS2.SSS2.fig1.10.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS2.SSS2.fig1.11.2" style="font-size:90%;">Fixed code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_C ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="S5.SS2.SSS2.fig1.12">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0ZGRlZi5oPgojaW5jbHVkZSA8c3RyaW5nLmg+CiNpbmNsdWRlIDxzdGRpbnQuaD4KI2BpbmNsdWRlIDxsaW1pdHMuaD5gIGAvLyBJbmNsdWRlIGxpbWl0cy5oIGZvciBJTlRfTUFYCgovKiBUaGlzIGZ1bmN0aW9uIHJlYWRzIGFuIGludGVnZXIgZnJvbSBzdGRpbiBhbmQgcmV0dXJucyB0aGUgdmFsdWUgbXVsdGlwbGllZCBieSAyICovCgppbnQgcmVhZEFuZE11bHRpcGx5QnlUd28oKQp7CiAgICAvKiBJbml0aWFsaXplIGRhdGEgKi8KICAgIGludCBkYXRhOwogICAgZGF0YSA9IDA7CiAgICAvKiBSZWFkIGludGVnZXIgZnJvbSBzdGRpbiAqLwogICAgYGlmIChzY2FuZigiJWQiLCAmZGF0YSkgIT0gMSkge2AKICAgICAgICBwcmludGYoIkZhaWxlZCB0byByZWFkIGFuIGludGVnZXIuXG4iKTsKICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICB9CiAgICAvKiBDaGVjayBmb3IgcG90ZW50aWFsIG92ZXJmbG93ICovCiAgICBgaWYgKGRhdGEgPiBJTlRfTUFYIC8gMiB8fCBkYXRhIDwgSU5UX01JTiAvIDIpYCB7CiAgICAgICAgcHJpbnRmKCJJbnRlZ2VyIG92ZXJmbG93IGRldGVjdGVkLlxuIik7CiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgfQogICAgLyogTXVsdGlwbHkgYnkgdHdvICovCiAgICBkYXRhICo9IDI7CiAgICAvKiBSZXR1cm4gcmVzdWx0ICovCiAgICByZXR1cm4gZGF0YTsKfQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx33.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.4">stdio</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx34.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.4">stdlib</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx35.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.4">stddef</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx36.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.4">string</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx37.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.4">stdint</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx38.1" style="color:#FF00FF;">#</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx38.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx38.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.4"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.5"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.6"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx38.pic2" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx38.pic2.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx38.7" style="color:#FF00FF;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.10">scanf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.11">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx38.12" style="color:#9400D1;">"%d"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.13">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.15">&amp;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.16">data</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.17">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.18"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.19">!=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.21">1)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.23">{</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.24"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.25"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx38.pic3" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx38.pic3.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx38.26" style="color:#FF00FF;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.27"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.28">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.29">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.30"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.31">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.32"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.33">INT_MAX</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.34"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.35">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.36"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.37">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.38"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.39">||</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.40"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.41">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.42"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.43">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.44"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.45">INT_MIN</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.46"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.47">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.48"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.49">2)</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.50"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.51"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx38.pic4" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx38.pic4.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.SS2.SSS2.fig1.15.1.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="S5.SS2.SSS2.fig1.16.2" style="font-size:90%;">An example of C code with an integer overflow vulnerability (CWE-190) alongside its corresponding fixed version. The code was fixed using our code synthesis pipeline. We highlighted the important changes in the fixed code.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="S5.SS3">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="S5.SS3.1.1.1">5.3</span> </span>Performance of HexaCoder in Securing CodeLMs</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.1">We use the synthesized codes (with data statistics provided in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T2" title="Table 2 ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.2">) to fine-tune the targeted CodeLMs. For each secure code, we have a corresponding vulnerable code. From this pair, we extract a mask for each data item and use the secure code along with the extracted mask to fine-tune the CodeLMs. Out of the 1,776 data items, 1,421 are used for training, while 335 (</span><math alttext="\approx" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mo id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><approx id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\approx</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">≈</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.3"> 20% of the data) are used for validation. To ensure that there is no overlap between the initial vulnerable codes and the prompts used in CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.6"> and Pearce et al.</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.7.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.8.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.9">, we carefully check for any similarities before including them in our dataset pipeline. To this end, we remove any code in which any prompts of the benchmarks have more than 75% token overlap or share the same function name. Note that the prompts also contain included libraries that can be written in any code, and we also consider them when calculating the tokens overlaps.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.1.1">Using the synthesized data, we fine-tune each model for up to 10 epochs, and the fine-tuned model with the lowest validation loss is selected as the best model. We use the LoRA approach </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib38" title="">38</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.1.4"> to fine-tune the models. During fine-tuning, we keep the pre-trained weights frozen and only optimize the injected rank decomposition matrices. Detailed information about the fine-tuning hyperparameters can be found in Appendix </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A3" title="Appendix C Hyperparameters for LoRA Fine-tuning Approach ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">C</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.1.5">.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.8"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.1">To evaluate each model, we sample </span><math alttext="q" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mi id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><ci id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.2"> outputs for each given prompt. Following previous work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.5">, we set </span><math alttext="q=5" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><mi id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml">q</mi><mo id="S5.SS3.p3.2.m2.1.1.1" xref="S5.SS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.2.m2.1.1.3" xref="S5.SS3.p3.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><eq id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1.1"></eq><ci id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2">𝑞</ci><cn id="S5.SS3.p3.2.m2.1.1.3.cmml" type="integer" xref="S5.SS3.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">q=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">italic_q = 5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.6"> for the CodeLMSec prompts, and since the benchmark provided by Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.7.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.8.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.9"> contains fewer prompts, we set </span><math alttext="q=15" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mrow id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml"><mi id="S5.SS3.p3.3.m3.1.1.2" xref="S5.SS3.p3.3.m3.1.1.2.cmml">q</mi><mo id="S5.SS3.p3.3.m3.1.1.1" xref="S5.SS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.3.m3.1.1.3" xref="S5.SS3.p3.3.m3.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1"><eq id="S5.SS3.p3.3.m3.1.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1.1"></eq><ci id="S5.SS3.p3.3.m3.1.1.2.cmml" xref="S5.SS3.p3.3.m3.1.1.2">𝑞</ci><cn id="S5.SS3.p3.3.m3.1.1.3.cmml" type="integer" xref="S5.SS3.p3.3.m3.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">q=15</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">italic_q = 15</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.10">. We use nucleus sampling to sample </span><math alttext="q" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.1"><semantics id="S5.SS3.p3.4.m4.1a"><mi id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><ci id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.1d">italic_q</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.11"> programs for each given prompt. As mentioned in Section </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS1" title="5.1 Setup ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.1</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.12">, we generate up to 200 new tokens per prompt for both the CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.13.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.14.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.15"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.16.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.17.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.18"> benchmarks. To ensure fairness, in our two-step generation approach, we set the maximum number of tokens to 20 for the first step and 180 for the second step. In the first step, we set the maximum token number to 20 to provide the model with sufficient capacity to include the necessary libraries. We consider a code vulnerable if CodeQL identifies a vulnerability in it. We report the number of vulnerable codes within the top-</span><math alttext="x" class="ltx_Math" display="inline" id="S5.SS3.p3.5.m5.1"><semantics id="S5.SS3.p3.5.m5.1a"><mi id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><ci id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.5.m5.1d">italic_x</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.19"> codes, where top-</span><math alttext="x" class="ltx_Math" display="inline" id="S5.SS3.p3.6.m6.1"><semantics id="S5.SS3.p3.6.m6.1a"><mi id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><ci id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.6.m6.1d">italic_x</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.20"> refers to the most probable sampled codes out of all the sampled codes. For example, top-</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p3.7.m7.1"><semantics id="S5.SS3.p3.7.m7.1a"><mn id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><cn id="S5.SS3.p3.7.m7.1.1.cmml" type="integer" xref="S5.SS3.p3.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.7.m7.1d">1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.21"> represents the most probable sampled code among </span><math alttext="q" class="ltx_Math" display="inline" id="S5.SS3.p3.8.m8.1"><semantics id="S5.SS3.p3.8.m8.1a"><mi id="S5.SS3.p3.8.m8.1.1" xref="S5.SS3.p3.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.8.m8.1b"><ci id="S5.SS3.p3.8.m8.1.1.cmml" xref="S5.SS3.p3.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.8.m8.1d">italic_q</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p3.8.22"> sampled codes.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.8"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.1">Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F12" title="Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">12</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.2"> presents the overall performance results of CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.5"> in terms of code security and functional correctness. The figure compares the results for the pre-trained CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.6.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.7.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.8"> (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.p4.8.9">Base</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.10">), the fine-tuned version using the SVEN method </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.13">, and the fine-tuned version using our HexaCoder approach. Figures </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf1" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(a)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.14"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf2" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(b)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.15"> provide the number of generated vulnerable codes using Python and C/C++ prompts of the CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.16.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.17.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.18"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.19.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.20.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.21"> benchmarks, respectively. These figures illustrate the number of vulnerable codes generated among the top-</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p4.1.m1.1"><semantics id="S5.SS3.p4.1.m1.1a"><mn id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><cn id="S5.SS3.p4.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p4.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.1.m1.1d">1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.22"> and top-</span><math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.p4.2.m2.1"><semantics id="S5.SS3.p4.2.m2.1a"><mn id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><cn id="S5.SS3.p4.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p4.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.2.m2.1d">5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.23"> most probable sampled codes for CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.24.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.25.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.26"> (Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf1" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(a)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.27">) and the top-</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p4.3.m3.1"><semantics id="S5.SS3.p4.3.m3.1a"><mn id="S5.SS3.p4.3.m3.1.1" xref="S5.SS3.p4.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.3.m3.1b"><cn id="S5.SS3.p4.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p4.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.3.m3.1d">1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.28"> and top-</span><math alttext="15" class="ltx_Math" display="inline" id="S5.SS3.p4.4.m4.1"><semantics id="S5.SS3.p4.4.m4.1a"><mn id="S5.SS3.p4.4.m4.1.1" xref="S5.SS3.p4.4.m4.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.4.m4.1b"><cn id="S5.SS3.p4.4.m4.1.1.cmml" type="integer" xref="S5.SS3.p4.4.m4.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.4.m4.1c">15</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.4.m4.1d">15</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.29"> most probable sampled codes for Pearce et al.</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.30.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.31.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.32"> (Figure</span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf2" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(b)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.33">). Notably, both Figures </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf1" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(a)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.34"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf2" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(b)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.35"> demonstrate that our HexaCoder approach produces the fewest vulnerable codes among the models. For example, Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf1" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(a)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.36"> shows that using our HexaCoder, the model generates </span><math alttext="65" class="ltx_Math" display="inline" id="S5.SS3.p4.5.m5.1"><semantics id="S5.SS3.p4.5.m5.1a"><mn id="S5.SS3.p4.5.m5.1.1" xref="S5.SS3.p4.5.m5.1.1.cmml">65</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.5.m5.1b"><cn id="S5.SS3.p4.5.m5.1.1.cmml" type="integer" xref="S5.SS3.p4.5.m5.1.1">65</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.5.m5.1c">65</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.5.m5.1d">65</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.37"> vulnerable codes among the top-</span><math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.p4.6.m6.1"><semantics id="S5.SS3.p4.6.m6.1a"><mn id="S5.SS3.p4.6.m6.1.1" xref="S5.SS3.p4.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.6.m6.1b"><cn id="S5.SS3.p4.6.m6.1.1.cmml" type="integer" xref="S5.SS3.p4.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.6.m6.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.6.m6.1d">5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.38"> sampled codes, while SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.39.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.40.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.41"> and the pre-trained CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.42.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.43.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.44"> generate 368 and 456 vulnerable codes, respectively. This highlights the effectiveness of the synthesized secure data and our two-step generation approach. In Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F12" title="Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">12</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.45">, we also compare the effectiveness of the models in generating functionally correct programs. Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf3" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(c)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.46"> provides the results of pass@</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p4.7.m7.1"><semantics id="S5.SS3.p4.7.m7.1a"><mn id="S5.SS3.p4.7.m7.1.1" xref="S5.SS3.p4.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.7.m7.1b"><cn id="S5.SS3.p4.7.m7.1.1.cmml" type="integer" xref="S5.SS3.p4.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.7.m7.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.7.m7.1d">1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.47"> and pass@</span><math alttext="10" class="ltx_Math" display="inline" id="S5.SS3.p4.8.m8.1"><semantics id="S5.SS3.p4.8.m8.1a"><mn id="S5.SS3.p4.8.m8.1.1" xref="S5.SS3.p4.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.8.m8.1b"><cn id="S5.SS3.p4.8.m8.1.1.cmml" type="integer" xref="S5.SS3.p4.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.8.m8.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.8.m8.1d">10</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.48"> scores for the models on the HumanEval </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.49.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.50.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.51"> benchmark. In Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.F11.sf3" title="In Figure 12 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11(c)</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.52">, we observe our approach achieves functional correctness accuracy comparable to the base model and even slightly outperforms SVEN’s model </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.53.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.54.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.55">. Overall, the results indicate that HexaCoder significantly enhances the CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.56.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.57.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p4.8.58"> model’s ability to generate secure code while maintaining its utility in generating functionally correct programs.</span></p>
</div>
<figure class="ltx_figure" id="S5.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F11.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="207" id="S5.F11.sf1.g1" src="x3.png" width="322"/>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.F11.sf1.3.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F11.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="207" id="S5.F11.sf2.g1" src="x4.png" width="322"/>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.F11.sf2.3.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F11.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="207" id="S5.F11.sf3.g1" src="x5.png" width="322"/>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.F11.sf3.3.1.1" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="S5.F12.15.1.1" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" id="S5.F12.16.2" style="font-size:90%;">The overall result of <span class="ltx_text ltx_font_bold" id="S5.F12.16.2.1">CodeGen-2B-multi</span> model in generating vulnerable codes ((a) and (b)), and generating functionally correct codes ((c)). <em class="ltx_emph ltx_font_italic" id="S5.F12.16.2.2">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="S5.F12.16.2.3">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="S5.F12.16.2.4">HexaCoder</em> refer to the CodeGen-2B-multi model fine-tuned by each respective approach. For (a) and (b), a lower value indicates better performance, while for (c), a higher value indicates better performance.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p5">
<p class="ltx_p" id="S5.SS3.p5.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.1">Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T4" title="Table 4 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.2"> and  </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T5" title="Table 5 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.3"> provide the detailed results of the number of vulnerable codes generated by different variations of CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.6"> for each CWE. These tables also show the total number of generated codes vulnerable for each programming language. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T4" title="Table 4 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.7">, we present the results of evaluating the models using CodeLMSec benchmark </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.10">. Our HexaCoder approach consistently reduces or maintains the number of generated vulnerable codes compared to both the pre-trained CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.13"> and SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.16">, as shown in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T4" title="Table 4 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.17">. For example, for CWE-094 in Python codes, using our approach, the model only generates 4 vulnerable codes, while the pre-trained model and SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.18.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.19.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.20"> generated 48 and 28 vulnerable codes, respectively. Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T5" title="Table 5 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.21"> provides the results of evaluating the model using the Pearce et al. benchmark </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.22.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.23.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.24">. In this table, we also observe that our approach reduces or maintains the number of vulnerable codes for nearly all CWEs compared to the other approaches. This table shows that HexaCoder generates no vulnerable code for CWE-022, CWE-502, and CWE-611 in Python, as well as for CWE-022, CWE-190, and CWE-476 in C/C++. In contrast, other models generate at least two or more vulnerable codes for each of these CWEs. The results shown in Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T4" title="Table 4 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">4</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.25"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T5" title="Table 5 ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.p5.1.26"> indicate that our approach significantly reduces the generation of vulnerable code for various CWEs compared to the other methods. This demonstrates the effectiveness and generalizability of our method in producing secure code across different scenarios.</span></p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.T4.24.2.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="S5.T4.2.1.1">CodeGen-2B-multi</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="S5.T4.2.1.2">CodeLMSec benchmark</span>. <em class="ltx_emph ltx_font_italic" id="S5.T4.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="S5.T4.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="S5.T4.2.1.5">HexaCoder</em> refer to the CodeGen-2B-multi model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="5" class="ltx_Math" display="inline" id="S5.T4.2.1.m1.1"><semantics id="S5.T4.2.1.m1.1b"><mn id="S5.T4.2.1.m1.1.1" xref="S5.T4.2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T4.2.1.m1.1c"><cn id="S5.T4.2.1.m1.1.1.cmml" type="integer" xref="S5.T4.2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.1.m1.1e">5</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="S5.T4.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="S5.T4.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="S5.T4.25"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="S5.T4.25.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1" style="width:882.5pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1"><span class="ltx_text" id="S5.T4.25.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.25.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S5.T4.25.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T4.25.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_10" id="S5.T4.25.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="S5.T4.25.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="S5.T4.25.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.7.1.1">CWE-117</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.8.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.9.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.9.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.10.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.10.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.11.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.11.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.12.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.13.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.14.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.15.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.15.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.16.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.16.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T4.25.1.1.1.1.1.2.2.17">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T4.25.1.1.1.1.1.2.2.17.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T4.25.1.1.1.1.1.2.2.17.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T4.25.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.25.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.3.1.2.1">10</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.3">58</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.4">31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.5">80</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.6">48</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.7">50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.8">22</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.9">53</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.10">17</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.11">369</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.12">8</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.13">16</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.14">43</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.15">11</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.16">9</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.25.1.1.1.1.1.3.1.17">87</span></span>
<span class="ltx_tr" id="S5.T4.25.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.25.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.2">11</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.3">46</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.4">22</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.5">69</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.6">28</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.7">47</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.8">17</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.9">35</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.10">25</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.11">300</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.12">7</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.13">10</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.14">31</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.15">16</span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.16"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.4.2.16.1">4</span></span>
<span class="ltx_td ltx_align_center" id="S5.T4.25.1.1.1.1.1.4.2.17">68</span></span>
<span class="ltx_tr" id="S5.T4.25.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.2.1">10</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.3.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.4.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.5.1">8</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.6.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.7.1">9</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.8.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.9.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.10"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.10.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.11.1">48</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.12.1">1</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.13"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.13.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.14"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.14.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.15"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.15.1">3</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.16"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.16.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.25.1.1.1.1.1.5.3.17"><span class="ltx_text ltx_font_bold" id="S5.T4.25.1.1.1.1.1.5.3.17.1">17</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="S5.T4.25.2"></span></p>
</figure>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.T5.27.2.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S5.T5.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="S5.T5.2.1.1">CodeGen-2B-multi</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="S5.T5.2.1.2">Pearce et al. benchmark</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> . <em class="ltx_emph ltx_font_italic" id="S5.T5.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="S5.T5.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="S5.T5.2.1.5">HexaCoder</em> refer to the CodeGen-2B-multi model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="15" class="ltx_Math" display="inline" id="S5.T5.2.1.m1.1"><semantics id="S5.T5.2.1.m1.1b"><mn id="S5.T5.2.1.m1.1.1" xref="S5.T5.2.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S5.T5.2.1.m1.1c"><cn id="S5.T5.2.1.m1.1.1.cmml" type="integer" xref="S5.T5.2.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.1.m1.1d">15</annotation><annotation encoding="application/x-llamapun" id="S5.T5.2.1.m1.1e">15</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="S5.T5.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="S5.T5.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="S5.T5.28"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="S5.T5.28.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1" style="width:832.2pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1"><span class="ltx_text" id="S5.T5.28.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T5.28.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S5.T5.28.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T5.28.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_9" id="S5.T5.28.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="S5.T5.28.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="S5.T5.28.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.7.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.8.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.9.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.9.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.10.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.10.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.11.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.11.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.12.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.13.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.14.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.15.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.15.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T5.28.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T5.28.1.1.1.1.1.2.2.16.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="S5.T5.28.1.1.1.1.1.2.2.16.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T5.28.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T5.28.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.2">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.3">19</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.4">31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.5">31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.6"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.3.1.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.7">20</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.8">11</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.9"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.3.1.9.1">17</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.10">141</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.11">4</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.12">7</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.13">41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.14">14</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.15">13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.28.1.1.1.1.1.3.1.16">79</span></span>
<span class="ltx_tr" id="S5.T5.28.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T5.28.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.2"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.4.2.2.1">4</span></span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.3">11</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.4">22</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.5">16</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.6"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.4.2.6.1">0</span></span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.7">2</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.8">3</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.9">32</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.10">90</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.11">4</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.12">2</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.13">24</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.14">17</span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.15"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.4.2.15.1">4</span></span>
<span class="ltx_td ltx_align_center" id="S5.T5.28.1.1.1.1.1.4.2.16">51</span></span>
<span class="ltx_tr" id="S5.T5.28.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.2">6</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.3.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.4.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.5.1">1</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.8.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.9.1">17</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.10"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.10.1">28</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.11.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.12.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.13"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.13.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.14"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.14.1">8</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.15">22</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.28.1.1.1.1.1.5.3.16"><span class="ltx_text ltx_font_bold" id="S5.T5.28.1.1.1.1.1.5.3.16.1">30</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="S5.T5.28.2"></span></p>
</figure>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS3.SSS1.1.1.1">5.3.1</span> </span>Applicability of HexaCoder to other CodeLMs</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.1">Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T6" title="Table 6 ‣ 5.3.1 Applicability of HexaCoder to other CodeLMs ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.2"> presents the overall results for three additional models. It shows the number of vulnerable codes generated by each model, as well as their performance in generating functionally correct codes. In this table, we present the results for three models: CodeGen-350M-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.5">, InCoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.6.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.7.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.8">, and DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.9.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.10.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.11">. For each model, we include the results of the original pre-trained version (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS1.p1.1.12">Base</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.13">) and the fine-tuned versions using SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.16"> (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS1.p1.1.17">SVEN</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.18">) and our HexaCoder (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS1.p1.1.19">HexaCoder</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.20">). Note that since the SVEN fine-tuned version of DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.21.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.22.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.23"> was not provided by the authors, we only report the results for the original model and HexaCoder for this case. For each of these models and their different variations, we provide the number of generated Python and C/C++ vulnerable codes using the CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.24.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.25.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.26"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.27.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.28.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.29"> benchmarks. Furthermore, we also present the performance of these models on the HumanEval </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.30.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.31.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.32"> benchmark. Specifically, for CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.33.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.34.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.35"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.36.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.37.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.38">, we provide the number of generated vulnerable codes among the top-5 and top-15 most probable samples, while for HumanEval, we report the pass@10 score. Detailed results per each CWE are available in Appendix </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4" title="Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">D</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p1.1.39">.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.SSS1.p2">
<p class="ltx_p" id="S5.SS3.SSS1.p2.5"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.1">Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T6" title="Table 6 ‣ 5.3.1 Applicability of HexaCoder to other CodeLMs ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.2"> demonstrates that HexaCoder consistently generates a lower number of vulnerable codes compared to the other approach for various models. This pattern holds for the number of generated vulnerable codes using both the benchmarks. For example, the fine-tuned version of InCoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.5"> using HexaCoder generates a total number of </span><math alttext="215" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.1.m1.1"><semantics id="S5.SS3.SSS1.p2.1.m1.1a"><mn id="S5.SS3.SSS1.p2.1.m1.1.1" xref="S5.SS3.SSS1.p2.1.m1.1.1.cmml">215</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.1.m1.1b"><cn id="S5.SS3.SSS1.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS1.p2.1.m1.1.1">215</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.1.m1.1c">215</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.1.m1.1d">215</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.6"> vulnerable codes using the CodeLMSec benchmark, while the SVEN version </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.7.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.8.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.9"> of this model produces </span><math alttext="457" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.2.m2.1"><semantics id="S5.SS3.SSS1.p2.2.m2.1a"><mn id="S5.SS3.SSS1.p2.2.m2.1.1" xref="S5.SS3.SSS1.p2.2.m2.1.1.cmml">457</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.2.m2.1b"><cn id="S5.SS3.SSS1.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS3.SSS1.p2.2.m2.1.1">457</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.2.m2.1c">457</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.2.m2.1d">457</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.10"> vulnerable codes. Additionally, as shown in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T6" title="Table 6 ‣ 5.3.1 Applicability of HexaCoder to other CodeLMs ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.11">, HexaCoder demonstrates functional correctness accuracy that is comparable to, or even exceeds, that of the original pre-trained models. For instance, our approach achieved a pass@</span><math alttext="10" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.3.m3.1"><semantics id="S5.SS3.SSS1.p2.3.m3.1a"><mn id="S5.SS3.SSS1.p2.3.m3.1.1" xref="S5.SS3.SSS1.p2.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.3.m3.1b"><cn id="S5.SS3.SSS1.p2.3.m3.1.1.cmml" type="integer" xref="S5.SS3.SSS1.p2.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.3.m3.1d">10</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.12"> score of </span><math alttext="72.0" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.4.m4.1"><semantics id="S5.SS3.SSS1.p2.4.m4.1a"><mn id="S5.SS3.SSS1.p2.4.m4.1.1" xref="S5.SS3.SSS1.p2.4.m4.1.1.cmml">72.0</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.4.m4.1b"><cn id="S5.SS3.SSS1.p2.4.m4.1.1.cmml" type="float" xref="S5.SS3.SSS1.p2.4.m4.1.1">72.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.4.m4.1c">72.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.4.m4.1d">72.0</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.13"> for the DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.16">, surpassing the pre-trained model’s score of </span><math alttext="70.5" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.5.m5.1"><semantics id="S5.SS3.SSS1.p2.5.m5.1a"><mn id="S5.SS3.SSS1.p2.5.m5.1.1" xref="S5.SS3.SSS1.p2.5.m5.1.1.cmml">70.5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.5.m5.1b"><cn id="S5.SS3.SSS1.p2.5.m5.1.1.cmml" type="float" xref="S5.SS3.SSS1.p2.5.m5.1.1">70.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.5.m5.1c">70.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.5.m5.1d">70.5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.17">. The results in Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.T6" title="Table 6 ‣ 5.3.1 Applicability of HexaCoder to other CodeLMs ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS1.p2.5.18"> demonstrate the effectiveness of the proposed approach in enhancing the ability of various models to generate secure code, while also maintaining their performance in generating functionally correct code.</span></p>
</div>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.T6.43.2.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="S5.T6.2.1" style="font-size:90%;">The overall result of different models in generating vulnerable codes and generating functionally correct codes. <em class="ltx_emph ltx_font_italic" id="S5.T6.2.1.1">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="S5.T6.2.1.2">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="S5.T6.2.1.3">HexaCoder</em> refer to the models fine-tuned by each respective approach. For the CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> and Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> benchmarks, the number of generated vulnerable codes is reported. For the HumanEval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>]</cite>, the pass@<math alttext="10" class="ltx_Math" display="inline" id="S5.T6.2.1.m1.1"><semantics id="S5.T6.2.1.m1.1b"><mn id="S5.T6.2.1.m1.1.1" xref="S5.T6.2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.T6.2.1.m1.1c"><cn id="S5.T6.2.1.m1.1.1.cmml" type="integer" xref="S5.T6.2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.1.m1.1d">10</annotation><annotation encoding="application/x-llamapun" id="S5.T6.2.1.m1.1e">10</annotation></semantics></math> score is reported.
</span></figcaption>
<p class="ltx_p" id="S5.T6.20"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="S5.T6.20.18" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.20.18.18.18" style="width:1843.2pt;height:109pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S5.T6.20.18.18.18.18"><span class="ltx_text" id="S5.T6.20.18.18.18.18.18">
<span class="ltx_tabular ltx_align_middle" id="S5.T6.20.18.18.18.18.18.18">
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.19.1">
<span class="ltx_td ltx_align_left ltx_border_tt" id="S5.T6.20.18.18.18.18.18.18.19.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="S5.T6.20.18.18.18.18.18.18.19.1.2">CodeGen-350M-multi <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="S5.T6.20.18.18.18.18.18.18.19.1.3">Incoder-6B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="S5.T6.20.18.18.18.18.18.18.19.1.4">DeepSeek-Coder-V2-16B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite></span></span>
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.20.2">
<span class="ltx_td ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.1"></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.2">CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.3">Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.4">HumanEval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.5">CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.6">Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.7">HumanEval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.8">CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.9">Pearce et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.20.2.10">HumanEval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib16" title="">16</a>]</cite></span></span>
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.18">
<span class="ltx_td" id="S5.T6.20.18.18.18.18.18.18.18.19"></span>
<span class="ltx_td ltx_align_center" id="S5.T6.4.2.2.2.2.2.2.2.2">top-<math alttext="5" class="ltx_Math" display="inline" id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1"><semantics id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1a"><mn id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T6.3.1.1.1.1.1.1.1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1b"><cn id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="S5.T6.3.1.1.1.1.1.1.1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.T6.3.1.1.1.1.1.1.1.1.m1.1d">5</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1"><semantics id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1a"><mo id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1.1" stretchy="false" xref="S5.T6.4.2.2.2.2.2.2.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1b"><ci id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S5.T6.4.2.2.2.2.2.2.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.4.2.2.2.2.2.2.2.2.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.6.4.4.4.4.4.4.4.4">top-<math alttext="15" class="ltx_Math" display="inline" id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1"><semantics id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1a"><mn id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1.1" xref="S5.T6.5.3.3.3.3.3.3.3.3.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1b"><cn id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1.1.cmml" type="integer" xref="S5.T6.5.3.3.3.3.3.3.3.3.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1c">15</annotation><annotation encoding="application/x-llamapun" id="S5.T6.5.3.3.3.3.3.3.3.3.m1.1d">15</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1"><semantics id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1a"><mo id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1.1" stretchy="false" xref="S5.T6.6.4.4.4.4.4.4.4.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1b"><ci id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1.1.cmml" xref="S5.T6.6.4.4.4.4.4.4.4.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.6.4.4.4.4.4.4.4.4.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.8.6.6.6.6.6.6.6.6">pass@<math alttext="10" class="ltx_Math" display="inline" id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1"><semantics id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1a"><mn id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1.1" xref="S5.T6.7.5.5.5.5.5.5.5.5.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1b"><cn id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1.1.cmml" type="integer" xref="S5.T6.7.5.5.5.5.5.5.5.5.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.T6.7.5.5.5.5.5.5.5.5.m1.1d">10</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1"><semantics id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1a"><mo id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1.1" stretchy="false" xref="S5.T6.8.6.6.6.6.6.6.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1b"><ci id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1.1.cmml" xref="S5.T6.8.6.6.6.6.6.6.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.8.6.6.6.6.6.6.6.6.m2.1d">↑</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.10.8.8.8.8.8.8.8.8">top-<math alttext="5" class="ltx_Math" display="inline" id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1"><semantics id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1a"><mn id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1.1" xref="S5.T6.9.7.7.7.7.7.7.7.7.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1b"><cn id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1.1.cmml" type="integer" xref="S5.T6.9.7.7.7.7.7.7.7.7.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.T6.9.7.7.7.7.7.7.7.7.m1.1d">5</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1"><semantics id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1a"><mo id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1.1" stretchy="false" xref="S5.T6.10.8.8.8.8.8.8.8.8.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1b"><ci id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1.1.cmml" xref="S5.T6.10.8.8.8.8.8.8.8.8.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.10.8.8.8.8.8.8.8.8.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.12.10.10.10.10.10.10.10.10">top-<math alttext="15" class="ltx_Math" display="inline" id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1"><semantics id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1a"><mn id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1.1" xref="S5.T6.11.9.9.9.9.9.9.9.9.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1b"><cn id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1.1.cmml" type="integer" xref="S5.T6.11.9.9.9.9.9.9.9.9.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1c">15</annotation><annotation encoding="application/x-llamapun" id="S5.T6.11.9.9.9.9.9.9.9.9.m1.1d">15</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1"><semantics id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1a"><mo id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1.1" stretchy="false" xref="S5.T6.12.10.10.10.10.10.10.10.10.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1b"><ci id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1.1.cmml" xref="S5.T6.12.10.10.10.10.10.10.10.10.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.12.10.10.10.10.10.10.10.10.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.14.12.12.12.12.12.12.12.12">pass@<math alttext="10" class="ltx_Math" display="inline" id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1"><semantics id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1a"><mn id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1.1" xref="S5.T6.13.11.11.11.11.11.11.11.11.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1b"><cn id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1.1.cmml" type="integer" xref="S5.T6.13.11.11.11.11.11.11.11.11.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.T6.13.11.11.11.11.11.11.11.11.m1.1d">10</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1"><semantics id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1a"><mo id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1.1" stretchy="false" xref="S5.T6.14.12.12.12.12.12.12.12.12.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1b"><ci id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1.1.cmml" xref="S5.T6.14.12.12.12.12.12.12.12.12.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.14.12.12.12.12.12.12.12.12.m2.1d">↑</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.16.14.14.14.14.14.14.14.14">top-<math alttext="5" class="ltx_Math" display="inline" id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1"><semantics id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1a"><mn id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1.1" xref="S5.T6.15.13.13.13.13.13.13.13.13.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1b"><cn id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1.1.cmml" type="integer" xref="S5.T6.15.13.13.13.13.13.13.13.13.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.T6.15.13.13.13.13.13.13.13.13.m1.1d">5</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1"><semantics id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1a"><mo id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1.1" stretchy="false" xref="S5.T6.16.14.14.14.14.14.14.14.14.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1b"><ci id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1.1.cmml" xref="S5.T6.16.14.14.14.14.14.14.14.14.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.16.14.14.14.14.14.14.14.14.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.18.16.16.16.16.16.16.16.16">top-<math alttext="15" class="ltx_Math" display="inline" id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1"><semantics id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1a"><mn id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1.1" xref="S5.T6.17.15.15.15.15.15.15.15.15.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1b"><cn id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1.1.cmml" type="integer" xref="S5.T6.17.15.15.15.15.15.15.15.15.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1c">15</annotation><annotation encoding="application/x-llamapun" id="S5.T6.17.15.15.15.15.15.15.15.15.m1.1d">15</annotation></semantics></math> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1"><semantics id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1a"><mo id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1.1" stretchy="false" xref="S5.T6.18.16.16.16.16.16.16.16.16.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1b"><ci id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1.1.cmml" xref="S5.T6.18.16.16.16.16.16.16.16.16.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.18.16.16.16.16.16.16.16.16.m2.1d">↓</annotation></semantics></math></span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.18.18">pass@<math alttext="10" class="ltx_Math" display="inline" id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1"><semantics id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1a"><mn id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1.1" xref="S5.T6.19.17.17.17.17.17.17.17.17.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1b"><cn id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1.1.cmml" type="integer" xref="S5.T6.19.17.17.17.17.17.17.17.17.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.T6.19.17.17.17.17.17.17.17.17.m1.1d">10</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1"><semantics id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1a"><mo id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1.1" stretchy="false" xref="S5.T6.20.18.18.18.18.18.18.18.18.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1b"><ci id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1.1.cmml" xref="S5.T6.20.18.18.18.18.18.18.18.18.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.20.18.18.18.18.18.18.18.18.m2.1d">↑</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.21.3">
<span class="ltx_td ltx_align_left" id="S5.T6.20.18.18.18.18.18.18.21.3.1">Base</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.2">348</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.3">182</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.4"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.21.3.4.1">9.9</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.5">473</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.6">183</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.7">27.7</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.8">522</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.9">186</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.20.18.18.18.18.18.18.21.3.10">70.5</span></span>
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.22.4">
<span class="ltx_td ltx_align_left" id="S5.T6.20.18.18.18.18.18.18.22.4.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.2">323</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.3">135</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.4">8.9</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.5">457</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.6">134</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.7">27.2</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.8">-</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.9">-</span>
<span class="ltx_td ltx_align_center" id="S5.T6.20.18.18.18.18.18.18.22.4.10">-</span></span>
<span class="ltx_tr" id="S5.T6.20.18.18.18.18.18.18.23.5">
<span class="ltx_td ltx_align_left ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.2"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.2.1">105</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.3"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.3.1">55</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.4">
8.4</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.5"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.5.1">215</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.6"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.6.1">77</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.7"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.7.1">29.4</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.8"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.8.1">117</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.9"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.9.1">62</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.20.18.18.18.18.18.18.23.5.10"><span class="ltx_text ltx_font_bold" id="S5.T6.20.18.18.18.18.18.18.23.5.10.1">72.0</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="S5.T6.20.19"></span></p>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text ltx_font_serif" id="S5.SS3.SSS2.7.1.1">5.3.2</span> </span>Effectiveness of the Two-step Generation Approach</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.1">Our HexaCoder approach consists of fine-tuning the pre-trained models using the synthesized secure code data and generating the codes using the two-step generation approach. Here, we investigate the effectiveness of the two-step generation approach on the fine-tuned models with HexaCoder, as well as on models fine-tuned with SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.4"> and the original pre-trained model. Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.5"> shows the results of the number of vulnerable codes generated using different approaches, focusing on the top-</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p1.1.m1.1"><semantics id="S5.SS3.SSS2.p1.1.m1.1a"><mn id="S5.SS3.SSS2.p1.1.m1.1.1" xref="S5.SS3.SSS2.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.1.m1.1b"><cn id="S5.SS3.SSS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS2.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p1.1.m1.1d">1</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.6"> and top-</span><math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p1.2.m2.1"><semantics id="S5.SS3.SSS2.p1.2.m2.1a"><mn id="S5.SS3.SSS2.p1.2.m2.1.1" xref="S5.SS3.SSS2.p1.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.2.m2.1b"><cn id="S5.SS3.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS3.SSS2.p1.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.2.m2.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p1.2.m2.1d">5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.7"> most probable samples. In this table, the CodeGen-350M-multi model serves as the base model in each case, with results provided both with and without the two-step generation approach. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.8">, we compare the results for the pre-trained CodeGen-350M-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.9.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.10.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.11"> (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS2.p1.2.12">Base</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.13">), the fine-tuned version of the model using SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.16">, and the fine-tuned model using our HexaCoder approach. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.17">, </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS2.p1.2.18">Two</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.19"> refers to our two-step approach. We provide the detailed results per each CWE in Appendix </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T15" title="Table 15 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">15</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p1.2.20">.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.1">In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.2">, we observe that our two-step generation for the pre-trained model (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS3.SSS2.p2.1.3">Base</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.4">) can even increase the number of vulnerable codes while for the fine-tuned model with SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.7">, it reduces the number of vulnerable codes from 258 to 199 for top-5 most probable sample. This indicates that the number of vulnerable codes generated by SVEN with our two-step generation reduced by 22.8% compared to the original SVEN approach. Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p2.1.8"> demonstrates that, among the top-5 samples, the fine-tuned model using HexaCoder generates 174 vulnerable codes without the two-step generation, whereas it only produces 81 vulnerable codes when our two-step generation approach is applied. This reflects a 53.4% reduction in the number of vulnerable codes when using HexaCoder with the two-step generation compared to using HexaCoder without it.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p3">
<p class="ltx_p" id="S5.SS3.SSS2.p3.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p3.1.1">Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS3.SSS2" title="5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.3.2</span></a><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.p3.1.2"> demonstrates that the two-step generation approach most effectively reduces the number of vulnerable codes in our method compared to the other approaches. This indicates that our synthesized dataset provides a better representation than SVEN’s dataset. This is mainly due to the fact that our data synthesis pipeline includes the necessary libraries, while many samples in the SVEN dataset lack these essential components.</span></p>
</div>
<figure class="ltx_table" id="S5.SS3.SSS2.6">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="S5.SS3.SSS2.6.26.3.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="S5.SS3.SSS2.4.4.2" style="font-size:90%;">Number of vulnerable Python code samples generated by the <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.4.4.2.1">CodeGen-350M-multi</span> model as evaluated using the prompt of the <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.4.4.2.2">CodeLMSec benchmark</span>, among the top-<math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.SSS2.3.3.1.m1.1"><semantics id="S5.SS3.SSS2.3.3.1.m1.1b"><mn id="S5.SS3.SSS2.3.3.1.m1.1.1" xref="S5.SS3.SSS2.3.3.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.3.3.1.m1.1c"><cn id="S5.SS3.SSS2.3.3.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS2.3.3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.3.3.1.m1.1d">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.3.3.1.m1.1e">1</annotation></semantics></math> and top-<math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.SSS2.4.4.2.m2.1"><semantics id="S5.SS3.SSS2.4.4.2.m2.1b"><mn id="S5.SS3.SSS2.4.4.2.m2.1.1" xref="S5.SS3.SSS2.4.4.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.4.4.2.m2.1c"><cn id="S5.SS3.SSS2.4.4.2.m2.1.1.cmml" type="integer" xref="S5.SS3.SSS2.4.4.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.4.4.2.m2.1d">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.4.4.2.m2.1e">5</annotation></semantics></math> most probable samples. <em class="ltx_emph ltx_font_italic" id="S5.SS3.SSS2.4.4.2.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="S5.SS3.SSS2.4.4.2.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="S5.SS3.SSS2.4.4.2.5">HexaCoder</em> refer to the CodeGen-350M-multi model fine-tuned by each respective approach. <span class="ltx_text ltx_font_italic" id="S5.SS3.SSS2.4.4.2.6">Two</span> denotes the two-step generation approach.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S5.SS3.SSS2.6.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.2">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.SS3.SSS2.6.6.2.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.2.3.1">Models</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.SS3.SSS2.5.5.1.1">
<span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.5.5.1.1.1">top-</span><math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.SSS2.5.5.1.1.m1.1"><semantics id="S5.SS3.SSS2.5.5.1.1.m1.1a"><mn id="S5.SS3.SSS2.5.5.1.1.m1.1.1" xref="S5.SS3.SSS2.5.5.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.5.5.1.1.m1.1b"><cn id="S5.SS3.SSS2.5.5.1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS2.5.5.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.5.5.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.5.5.1.1.m1.1d">1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.SS3.SSS2.6.6.2.2">
<span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.2.2.1">top-</span><math alttext="5" class="ltx_Math" display="inline" id="S5.SS3.SSS2.6.6.2.2.m1.1"><semantics id="S5.SS3.SSS2.6.6.2.2.m1.1a"><mn id="S5.SS3.SSS2.6.6.2.2.m1.1.1" xref="S5.SS3.SSS2.6.6.2.2.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.6.6.2.2.m1.1b"><cn id="S5.SS3.SSS2.6.6.2.2.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS2.6.6.2.2.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.6.6.2.2.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.6.6.2.2.m1.1d">5</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.SS3.SSS2.6.6.3.1.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.3.1.1.1">Base</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.SS3.SSS2.6.6.3.1.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.3.1.2.1">59</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.SS3.SSS2.6.6.3.1.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.3.1.3.1">281</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.4.2">
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.4.2.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.4.2.1.1">Base (w Two)</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.4.2.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.4.2.2.1">66</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.4.2.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.4.2.3.1">291</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.5.3">
<td class="ltx_td ltx_align_center" id="S5.SS3.SSS2.6.6.5.3.1">
<span class="ltx_ERROR undefined" id="S5.SS3.SSS2.6.6.5.3.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.5.3.1.2">1-3
  SVEN</span>
</td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.5.3.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.5.3.2.1">60</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.5.3.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.5.3.3.1">258</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.6.4">
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.6.4.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.6.4.1.1">SVEN (w Two)</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.6.4.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.6.4.2.1">45</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.6.4.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.6.4.3.1">199</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.7.5">
<td class="ltx_td ltx_align_center" id="S5.SS3.SSS2.6.6.7.5.1">
<span class="ltx_ERROR undefined" id="S5.SS3.SSS2.6.6.7.5.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.7.5.1.2">1-3
  HexaCoder (w/o Two)</span>
</td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.7.5.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.7.5.2.1">41</span></td>
<td class="ltx_td ltx_align_left" id="S5.SS3.SSS2.6.6.7.5.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.7.5.3.1">174</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.SSS2.6.6.8.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.SS3.SSS2.6.6.8.6.1"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.8.6.1.1">HexaCoder</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.SS3.SSS2.6.6.8.6.2"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.8.6.2.1">20</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.SS3.SSS2.6.6.8.6.3"><span class="ltx_text ltx_font_typewriter" id="S5.SS3.SSS2.6.6.8.6.3.1">81</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<section class="ltx_section ltx_figure_panel" id="S6">
<h2 class="ltx_title ltx_font_typewriter ltx_title_section">
<span class="ltx_tag ltx_tag_section"><span class="ltx_text ltx_font_serif" id="S6.1.1.1">6</span> </span>Discussion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.p1.1.1">In this section, we discuss the limitations of our work, reflect on the lessons learned, and present potential future works.</span></p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="S6.SS1.1.1.1">6.1</span> </span>Limitations</h3>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_font_typewriter ltx_title_paragraph">Static Analyzers.</h5>
<div class="ltx_para" id="S6.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.1">In our work, we rely on CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.4">, a static analysis tool, to identify the vulnerable and fixed codes. A static analyzers can only approximately identify software faults and does not guarantee sound results </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib45" title="">45</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.7">. Following previous work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib36" title="">36</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.10">, we decided to use CodeQL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib39" title="">39</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.13">, which is one of the best-performing and freely available tools covering a wide range of CWEs </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.14.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib43" title="">43</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.15.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px1.p1.1.16">.</span></p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_font_typewriter ltx_title_paragraph">Programming Languages.</h5>
<div class="ltx_para" id="S6.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.1">We demonstrate the effectiveness of our approach using the programming languages Python and C/C++. These languages were chosen because they are widely used in the community, and the CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.4"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px2.p1.1.7"> benchmarks provide prompts in these languages for evaluating code security aspects of models. In future work, it would be valuable to expand the set of programming languages to include other languages, such as JavaScript, PHP, and Go.</span></p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_font_typewriter ltx_title_paragraph">Funtionality Changes in the Fixed Codes.</h5>
<div class="ltx_para" id="S6.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px3.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px3.p1.1.1">In our data synthesis pipeline, we use the GPT-4 model </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px3.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px3.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px3.p1.1.4"> to generate the fixed codes based on the provided security report and the vulnerable code. One concern is that the output might produce code with different functionality or even empty code. However, our observations show that the model’s output typically includes one or more changes aimed at resolving the security issue. Although there is no guarantee that the output code will maintain the exact same functionality, our results demonstrate that by using our synthesized data, the models are able to generate code with fewer vulnerabilities while preserving utility performance. Note that in our data synthesis pipeline, we do not consider the empty output as fixed codes.</span></p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_font_typewriter ltx_title_paragraph">Potential Issues of the Two-Step Generation Approach.</h5>
<div class="ltx_para" id="S6.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px4.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px4.p1.1.1">In our experimental results, we show the effectiveness of our two-step generation approach in reducing the number of vulnerable codes. However, in this approach, the first step of generating new libraries based on the given prompt does not take the context of the code into account. As a result, unused libraries may be generated. This issue can be resolved by removing these unused libraries from the code. Furthermore, the performance of our approach in generating functionally correct codes shows that with the two-step generation approach, we can achieve reasonable performance. Note that we also tried to incorporate the context of the prompt in the first step of the code generation using fill-in-the-middle generation fashion </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px4.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px4.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS1.SSS0.Px4.p1.1.4">. However, we found that this method did not yield improvements as significant as those achieved by generating the library in an autoregressive fashion.</span></p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="S6.SS2.1.1.1">6.2</span> </span>Adaptability of Our Approach to Other Vulnerabilities</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.1">In our data synthesis pipeline, we use the few-shot prompting method introduced in </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.3.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.4"> to generate vulnerable code samples. This technique requires only a few examples of code with the targeted vulnerability to create additional instances of similar vulnerable code. We then leverage a security oracle alongside GPT-4 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.5.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib54" title="">54</a><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.6.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.1.7"> to correct these vulnerabilities. Consequently, our method can be easily adapted to address other types of vulnerabilities as well. Exploring the application of our data synthesis pipeline to other and new types of vulnerabilities presents an interesting research direction.</span></p>
</div>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_font_typewriter ltx_title_section">
<span class="ltx_tag ltx_tag_section"><span class="ltx_text ltx_font_serif" id="S7.1.1.1">7</span> </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1"><span class="ltx_text ltx_font_typewriter" id="S7.p1.1.1">In this paper, we presented HexaCoder, a novel approach to enhancing the security of code generated by CodeLMs. HexaCoder
consists of an oracle-guided data synthesis pipeline and a two-step code generation process. Using the end-to-end data synthesis pipeline, HexaCoder generates pairs of vulnerable and fixed codes for targeted CWEs and uses these codes to fine-tune the CodeLMs using the LoRA method. During inference, the proposed two-step generation approach allows the trained models to include all necessary libraries that may have been initially overlooked, thus enabling the generation of more secure code. As a result, this approach significantly reduces the occurrence of vulnerable code in the output. Our comprehensive evaluation across three different benchmarks and four CodeLMs demonstrates that HexaCoder not only improves the security of generated code but also preserves its functional correctness, addressing a critical balance in the field of automatic code generation.</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_typewriter ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1"><span class="ltx_text ltx_font_typewriter" id="Sx1.p1.1.1">This work was partially funded by ELSA – European Lighthouse on Secure
and Safe AI funded by the European Union under grant agreement No.
101070617. Views and opinions expressed are however those of the authors
only and do not necessarily reflect those of the European Union or European
Commission. Neither the European Union nor the European Commission
can be held responsible for them.
This work was partially funded by the German Federal Ministry of Education and Research (BMBF) under the grant AIgenCY (16KIS2012).</span></p>
</div>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_font_typewriter ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib1.1.1">
Tabnine, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib2.1.1">
Codeium, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib3.1.1">
Ghostwriter - Code faster with AI, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib4.1.1">
Codium AI, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib5.1.1">
Nazmiye Ceren Abay, Yan Zhou, Murat Kantarcioglu, Bhavani Thuraisingham, and Latanya Sweeney.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib5.2.1">Privacy preserving synthetic data release using deep learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib5.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib5.4.2">ECML PKDD</span><span class="ltx_text ltx_font_typewriter" id="bib.bib5.5.3">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib6.1.1">
Owura Asare, Meiyappan Nagappan, and N Asokan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib6.2.1">Is github’s copilot as bad as humans at introducing vulnerabilities in code?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib6.3.1">Empirical Software Engineering</span><span class="ltx_text ltx_font_typewriter" id="bib.bib6.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib7.1.1">
Nathaniel Ayewah, William Pugh, David Hovemeyer, J. David Morgenthaler, and John Penix.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib7.2.1">Using static analysis to find bugs.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib7.3.1">IEEE Software</span><span class="ltx_text ltx_font_typewriter" id="bib.bib7.4.2">, 2008.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib8.1.1">
Rohit Babbar and Bernhard Schölkopf.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib8.2.1">Data scarcity, robustness and extreme multi-label classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib8.3.1">Machine Learning</span><span class="ltx_text ltx_font_typewriter" id="bib.bib8.4.2">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib9.1.1">
Moritz Beller, Radjino Bholanath, Shane McIntosh, and Andy Zaidman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib9.2.1">Analyzing the state of static analysis: A large-scale evaluation in open source software.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib9.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib9.4.2">SANER</span><span class="ltx_text ltx_font_typewriter" id="bib.bib9.5.3">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib10.1.1">
Manish Bhatt, Sahana Chennabasappa, Cyrus Nikolaidis, Shengye Wan, Ivan Evtimov, Dominik Gabi, Daniel Song, Faizan Ahmad, Cornelius Aschermann, Lorenzo Fontana, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib10.2.1">Purple llama cyberseceval: A secure coding benchmark for language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib10.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib10.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib11.1.1">
Dan Biderman, Jose Gonzalez Ortiz, Jacob Portes, Mansheej Paul, Philip Greengard, Connor Jennings, Daniel King, Sam Havens, Vitaliy Chiley, Jonathan Frankle, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib11.2.1">Lora learns less and forgets less.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib11.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib11.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib12.1.1">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib12.2.1">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib12.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib12.4.2">NeurIPS</span><span class="ltx_text ltx_font_typewriter" id="bib.bib12.5.3">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib13.1.1">
Federico Cassano, John Gouwar, Daniel Nguyen, Sydney Nguyen, Luna Phipps-Costin, Donald Pinckney, Ming-Ho Yee, Yangtian Zi, Carolyn Jane Anderson, Molly Q Feldman, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib13.2.1">Multipl-e: A scalable and extensible approach to benchmarking neural code generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib13.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib13.4.2">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib14.1.1">
Hsin-Yu Chang, Pei-Yu Chen, Tun-Hsiang Chou, Chang-Sheng Kao, Hsuan-Yun Yu, Yen-Ting Lin, and Yun-Nung Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib14.2.1">A survey of data synthesis approaches.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib14.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib14.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib15.1.1">
Sahil Chaudhary.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib15.2.1">Code alpaca: An instruction-following llama model for code generation.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sahil280114/codealpaca" title="">https://github.com/sahil280114/codealpaca</a><span class="ltx_text ltx_font_typewriter" id="bib.bib15.3.1">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib16.1.1">
Mark Chen, Jerry Tworek, Heewoo Jun, Qiming Yuan, Henrique Ponde, Jared Kaplan, Harrison Edwards, Yura Burda, Nicholas Joseph, Greg Brockman, Alex Ray, Raul Puri, Gretchen Krueger, Michael Petrov, Heidy Khlaaf, Girish Sastry, Pamela Mishkin, Brooke Chan, Scott Gray, Nick Ryder, Mikhail Pavlov, Alethea Power, Lukasz Kaiser, Mohammad Bavarian, Clemens Winter, Philippe Tillet, Felipe Petroski Such, David W. Cummings, Matthias Plappert, Fotios Chantzis, Elizabeth Barnes, Ariel Herbert-Voss, William H. Guss, Alex Nichol, Igor Babuschkin, S. Arun Balaji, Shantanu Jain, Andrew Carr, Jan Leike, Joshua Achiam, Vedant Misra, Evan Morikawa, Alec Radford, Matthew M. Knight, Miles Brundage, Mira Murati, Katie Mayer, Peter Welinder, Bob McGrew, Dario Amodei, Sam McCandlish, Ilya Sutskever, and Wojciech Zaremba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib16.2.1">Evaluating large language models trained on code.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib16.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib16.4.2">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib17.1.1">
Brian Chess and Gary McGraw.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib17.2.1">Static analysis for security.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib17.3.1">IEEE Security &amp; Privacy</span><span class="ltx_text ltx_font_typewriter" id="bib.bib17.4.2">, 2(6), 2004.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib18.1.1">
Maria Christakis and Christian Bird.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib18.2.1">What developers want and need from program analysis: An empirical study.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib18.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib18.4.2">IEEE/ACM International Conference on Automated Software Engineering (ASE)</span><span class="ltx_text ltx_font_typewriter" id="bib.bib18.5.3">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib19.1.1">
DeepSeek-AI.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib19.2.1">Deepseek-v2: A strong, economical, and efficient mixture-of-experts language model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib19.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib19.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib20.1.1">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib20.2.1">BERT: Pre-training of deep bidirectional transformers for language understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib20.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib20.4.2">NAACL</span><span class="ltx_text ltx_font_typewriter" id="bib.bib20.5.3">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib21.1.1">
difflib.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib21.2.1">difflib - helpers for computing deltas, 2023.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://docs.python.org/3/library/difflib.html" title="">https://docs.python.org/3/library/difflib.html</a><span class="ltx_text ltx_font_typewriter" id="bib.bib21.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib22.1.1">
Thomas Dohmke.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib22.2.1">Github copilot is generally available to all developers, June 2022.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.blog/2022-06-21-github-copilot-is-generally-available-to-all-developers/" title="">https://github.blog/2022-06-21-github-copilot-is-generally-available-to-all-developers/</a><span class="ltx_text ltx_font_typewriter" id="bib.bib22.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib23.1.1">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib23.2.1">The llama 3 herd of models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib23.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib23.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib24.1.1">
Zhangyin Feng, Daya Guo, Duyu Tang, Nan Duan, Xiaocheng Feng, Ming Gong, Linjun Shou, Bing Qin, Ting Liu, Daxin Jiang, and Ming Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib24.2.1">CodeBERT: A pre-trained model for programming and natural languages.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib24.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib24.4.2">EMNLP</span><span class="ltx_text ltx_font_typewriter" id="bib.bib24.5.3">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib25.1.1">
Andrea Fioraldi, Dominik Maier, Heiko Eißfeldt, and Marc Heuse.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib25.2.1">AFL++ : Combining Incremental Steps of Fuzzing Research .
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib25.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib25.4.2">WOOT</span><span class="ltx_text ltx_font_typewriter" id="bib.bib25.5.3">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib26.1.1">
Andrea Fioraldi, Dominik Christian Maier, Dongjia Zhang, and Davide Balzarotti.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib26.2.1">Libafl: A framework to build modular and reusable fuzzers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib26.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib26.4.2">CCS</span><span class="ltx_text ltx_font_typewriter" id="bib.bib26.5.3">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib27.1.1">
Daniel Fried, Armen Aghajanyan, Jessy Lin, Sida Wang, Eric Wallace, Freda Shi, Ruiqi Zhong, Wen-tau Yih, Luke Zettlemoyer, and Mike Lewis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib27.2.1">Incoder: A generative model for code infilling and synthesis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib27.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib27.4.2">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib28.1.1">
Leo Gao, John Schulman, and Jacob Hilton.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib28.2.1">Scaling laws for reward model overoptimization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib28.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib28.4.2">ICML</span><span class="ltx_text ltx_font_typewriter" id="bib.bib28.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib29.1.1">
Fabrizio Gilardi, Meysam Alizadeh, and Maël Kubli.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib29.2.1">Chatgpt outperforms crowd workers for text-annotation tasks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib29.3.1">National Academy of Sciences</span><span class="ltx_text ltx_font_typewriter" id="bib.bib29.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib30.1.1">
Daya Guo, Shuo Ren, Shuai Lu, Zhangyin Feng, Duyu Tang, Shujie Liu, Long Zhou, Nan Duan, Alexey Svyatkovskiy, Shengyu Fu, Michele Tufano, Shao Kun Deng, Colin B. Clement, Dawn Drain, Neel Sundaresan, Jian Yin, Daxin Jiang, and Ming Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib30.2.1">Graphcodebert: Pre-training code representations with data flow.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib30.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib30.4.2">ICLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib30.5.3">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib31.1.1">
Daya Guo, Qihao Zhu, Dejian Yang, Zhenda Xie, Kai Dong, Wentao Zhang, Guanting Chen, Xiao Bi, Yu Wu, YK Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib31.2.1">Deepseek-coder: When the large language model meets programming--the rise of code intelligence.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib31.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib31.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib32.1.1">
Hossein Hajipour, Hassler Keno, Thorsten Holz, Lea Schönherr, and Mario Fritz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib32.2.1">Codelmsec benchmark: Systematically evaluating and finding security vulnerabilities in black-box code language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib32.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib32.4.2">IEEE SaTML</span><span class="ltx_text ltx_font_typewriter" id="bib.bib32.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib33.1.1">
Hossein Hajipour, Ning Yu, Cristian-Alexandru Staicu, and Mario Fritz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib33.2.1">Simscood: Systematic analysis of out-of-distribution generalization in fine-tuned source code models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib33.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib33.4.2">NAACL Findings</span><span class="ltx_text ltx_font_typewriter" id="bib.bib33.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib34.1.1">
Sivana Hamer, Marcelo d’Amorim, and Laurie Williams.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib34.2.1">Just another copy and paste? comparing the security vulnerabilities of chatgpt generated code and stackoverflow answers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib34.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib34.4.2">IEEE Symposium on Security and Privacy Workshops</span><span class="ltx_text ltx_font_typewriter" id="bib.bib34.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib35.1.1">
Jingxuan He and Martin Vechev.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib35.2.1">Large language models for code: Security hardening and adversarial testing.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib35.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib35.4.2">CCS</span><span class="ltx_text ltx_font_typewriter" id="bib.bib35.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib36.1.1">
Jingxuan He, Mark Vero, Gabriela Krasnopolska, and Martin Vechev.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib36.2.1">Instruction tuning for secure code generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib36.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib36.4.2">ICML</span><span class="ltx_text ltx_font_typewriter" id="bib.bib36.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib37.1.1">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin De Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib37.2.1">Parameter-efficient transfer learning for NLP.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib37.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib37.4.2">ICML</span><span class="ltx_text ltx_font_typewriter" id="bib.bib37.5.3">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib38.1.1">
Edward J Hu, yelong shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib38.2.1">LoRA: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib38.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib38.4.2">ICLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib38.5.3">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib39.1.1">
GitHub Inc.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib39.2.1">Github codeql, 2022.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://codeql.github.com/" title="">https://codeql.github.com/</a><span class="ltx_text ltx_font_typewriter" id="bib.bib39.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib40.1.1">
Semgrep Inc.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib40.2.1">Find bugs and reachable dependency vulnerabilities in code., 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib41.1.1">
Raphaël Khoury, Anderson R Avila, Jacob Brunelle, and Baba Mamadou Camara.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib41.2.1">How secure is code generated by chatgpt?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib41.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib41.4.2">IEEE SMC</span><span class="ltx_text ltx_font_typewriter" id="bib.bib41.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib42.1.1">
Raymond Li, Loubna Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov, Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib42.2.1">Starcoder: may the source be with you!
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib42.3.1">TMLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib42.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib43.1.1">
Stephan Lipp, Sebastian Banescu, and Alexander Pretschner.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib43.2.1">An empirical study on the effectiveness of static c code analyzers for vulnerability detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib43.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib43.4.2">ISSTA</span><span class="ltx_text ltx_font_typewriter" id="bib.bib43.5.3">, pages 544--555, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib44.1.1">
Ruibo Liu, Jerry Wei, Fangyu Liu, Chenglei Si, Yanzhe Zhang, Jinmeng Rao, Steven Zheng, Daiyi Peng, Diyi Yang, Denny Zhou, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib44.2.1">Best practices and lessons learned on synthetic data for language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib44.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib44.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib45.1.1">
Benjamin Livshits, Manu Sridharan, Yannis Smaragdakis, Ondřej Lhoták, J. Nelson Amaral, Bor-Yuh Evan Chang, Samuel Z. Guyer, Uday P. Khedker, Anders Møller, and Dimitrios Vardoulakis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib45.2.1">In defense of soundiness: a manifesto.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib45.3.1">Communication of the ACM</span><span class="ltx_text ltx_font_typewriter" id="bib.bib45.4.2">, 58(2), 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib46.1.1">
Lin Long, Rui Wang, Ruixuan Xiao, Junbo Zhao, Xiao Ding, Gang Chen, and Haobo Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib46.2.1">On llms-driven synthetic data generation, curation, and evaluation: A survey.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib46.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib46.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib47.1.1">
Anton Lozhkov, Raymond Li, Loubna Ben Allal, Federico Cassano, Joel Lamy-Poirier, Nouamane Tazi, Ao Tang, Dmytro Pykhtar, Jiawei Liu, Yuxiang Wei, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib47.2.1">Starcoder 2 and the stack v2: The next generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib47.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib47.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib48.1.1">
Haipeng Luo, Qingfeng Sun, Can Xu, Pu Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib48.2.1">Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib48.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib48.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib49.1.1">
Ziyang Luo, Can Xu, Pu Zhao, Qingfeng Sun, Xiubo Geng, Wenxiang Hu, Chongyang Tao, Jing Ma, Qingwei Lin, and Daxin Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib49.2.1">Wizardcoder: Empowering code large language models with evol-instruct.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib49.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib49.4.2">ICLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib49.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib50.1.1">
Yu Meng, Martin Michalski, Jiaxin Huang, Yu Zhang, Tarek Abdelzaher, and Jiawei Han.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib50.2.1">Tuning language models as training data generators for augmentation-enhanced few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib50.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib50.4.2">ICML</span><span class="ltx_text ltx_font_typewriter" id="bib.bib50.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib51.1.1">
MITRE.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib51.2.1">CWE - Common Weakness Enumeration, 2022.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cwe.mitre.org" title="">https://cwe.mitre.org</a><span class="ltx_text ltx_font_typewriter" id="bib.bib51.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib52.1.1">
Erik Nijkamp, Bo Pang, Hiroaki Hayashi, Lifu Tu, Huan Wang, Yingbo Zhou, Silvio Savarese, and Caiming Xiong.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib52.2.1">Codegen: An open large language model for code with multi-turn program synthesis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib52.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib52.4.2">ICLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib52.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib53.1.1">
OpenAI.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib53.2.1">Chatgpt: Optimizing language models for dialogue, November 2022.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/blog/chatgpt/" title="">https://openai.com/blog/chatgpt/</a><span class="ltx_text ltx_font_typewriter" id="bib.bib53.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib54.1.1">
OpenAI.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib54.2.1">Gpt-4 technical report, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib55.1.1">
Ori Or-Meir, Nir Nissim, Yuval Elovici, and Lior Rokach.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib55.2.1">Dynamic malware analysis in the modern era: A state of the art survey.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib55.3.1">ACM Computing Surveys (CSUR)</span><span class="ltx_text ltx_font_typewriter" id="bib.bib55.4.2">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib56.1.1">
Hammond Pearce, Baleegh Ahmad, Benjamin Tan, Brendan Dolan-Gavitt, and Ramesh Karri.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib56.2.1">Asleep at the keyboard? assessing the security of github copilot’s code contributions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib56.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib56.4.2">IEEE Symposium on Security and Privacy</span><span class="ltx_text ltx_font_typewriter" id="bib.bib56.5.3">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib57.1.1">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib57.2.1">Language models are unsupervised multitask learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib57.3.1">OpenAI blog</span><span class="ltx_text ltx_font_typewriter" id="bib.bib57.4.2">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib58.1.1">
Baptiste Rozière, Jonas Gehring, Fabian Gloeckle, Sten Sootla, Itai Gat, Xiaoqing Ellen Tan, Yossi Adi, Jingyu Liu, Tal Remez, Jérémy Rapin, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib58.2.1">Code llama: Open foundation models for code.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib58.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib58.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib59.1.1">
Gustavo Sandoval, Hammond Pearce, Teo Nys, Ramesh Karri, Brendan Dolan-Gavitt, and Siddharth Garg.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib59.2.1">Security implications of large language model code assistants: A user study.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib59.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib59.4.2">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib60.1.1">
Yan Shoshitaishvili, Ruoyu Wang, Christopher Salls, Nick Stephens, Mario Polino, Andrew Dutcher, John Grosen, Siji Feng, Christophe Hauser, Christopher Kruegel, and Giovanni Vigna.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib60.2.1">SoK: (State of) The Art of War: Offensive Techniques in Binary Analysis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib60.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib60.4.2">IEEE Symposium on Security and Privacy</span><span class="ltx_text ltx_font_typewriter" id="bib.bib60.5.3">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib61.1.1">
Mohammed Latif Siddiq and Joanna CS Santos.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib61.2.1">Securityeval dataset: mining vulnerability examples to evaluate machine learning-based code generation techniques.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib61.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib61.4.2">MSR4 P and S</span><span class="ltx_text ltx_font_typewriter" id="bib.bib61.5.3">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib62.1.1">
László Szekeres, Mathias Payer, Tao Wei, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib62.2.1">SoK: Eternal War in Memory.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib62.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib62.4.2">IEEE Symposium on Security and Privacy</span><span class="ltx_text ltx_font_typewriter" id="bib.bib62.5.3">, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib63.1.1">
Norbert Tihanyi, Tamas Bisztray, Ridhi Jain, Mohamed Amine Ferrag, Lucas C Cordeiro, and Vasileios Mavroeidis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib63.2.1">The formai dataset: Generative ai in software security through the lens of formal verification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib63.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib63.4.2">PROMISE</span><span class="ltx_text ltx_font_typewriter" id="bib.bib63.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib64.1.1">
Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A. Smith, Daniel Khashabi, and Hannaneh Hajishirzi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib64.2.1">Self-instruct: Aligning language models with self-generated instructions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib64.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib64.4.2">ACL</span><span class="ltx_text ltx_font_typewriter" id="bib.bib64.5.3">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib65.1.1">
Yue Wang, Weishi Wang, Shafiq Joty, and Steven C.H. Hoi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib65.2.1">Codet5: Identifier-aware unified pre-trained encoder-decoder models for code understanding and generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib65.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib65.4.2">EMNLP</span><span class="ltx_text ltx_font_typewriter" id="bib.bib65.5.3">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib66.1.1">
Yuxiang Wei, Zhe Wang, Jiawei Liu, Yifeng Ding, and Lingming Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib66.2.1">Magicoder: Source code is all you need.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib66.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib66.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib67.1.1">
Wikipedia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib67.2.1">Markdown --- Wikipedia, the free encyclopedia, 2024.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://en.wikipedia.org/w/index.php?title=Markdown&amp;oldid=1241689312" title="">http://en.wikipedia.org/w/index.php?title=Markdown&amp;oldid=1241689312</a><span class="ltx_text ltx_font_typewriter" id="bib.bib67.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib68.1.1">
Can Xu, Qingfeng Sun, Kai Zheng, Xiubo Geng, Pu Zhao, Jiazhan Feng, Chongyang Tao, Qingwei Lin, and Daxin Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib68.2.1">WizardLM: Empowering large pre-trained language models to follow complex instructions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib68.3.1">In </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib68.4.2">ICLR</span><span class="ltx_text ltx_font_typewriter" id="bib.bib68.5.3">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib69.1.1">
Longhui Yu, Weisen Jiang, Han Shi, Jincheng Yu, Zhengying Liu, Yu Zhang, James T Kwok, Zhenguo Li, Adrian Weller, and Weiyang Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib69.2.1">Metamath: Bootstrap your own mathematical questions for large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib69.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib69.4.2">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib70.1.1">
Shuyin Zhao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib70.2.1">Github copilot is generally available for businesses, December 2022.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.blog/2022-12-07-github-copilot-is-generally-available-for-businesses/" title="">https://github.blog/2022-12-07-github-copilot-is-generally-available-for-businesses/</a><span class="ltx_text ltx_font_typewriter" id="bib.bib70.3.1">, as of September 10, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib71.1.1">
Qihao Zhu, Daya Guo, Zhihong Shao, Dejian Yang, Peiyi Wang, Runxin Xu, Y Wu, Yukun Li, Huazuo Gao, Shirong Ma, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib71.2.1">Deepseek-coder-v2: Breaking the barrier of closed-source models in code intelligence.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib71.3.1">arXiv</span><span class="ltx_text ltx_font_typewriter" id="bib.bib71.4.2">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib72.1.1">
Xiaogang Zhu, Sheng Wen, Seyit Camtepe, and Yang Xiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter" id="bib.bib72.2.1">Fuzzing: a survey for roadmap.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="bib.bib72.3.1">ACM Computing Surveys (CSUR)</span><span class="ltx_text ltx_font_typewriter" id="bib.bib72.4.2">, 54(11s), 2022.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_font_typewriter ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix"><span class="ltx_text ltx_font_serif" id="A1.1.1.1">Appendix A</span> </span>Details of the Input prompts</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.p1.1.1">Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A1.F13" title="Figure 13 ‣ Appendix A Details of the Input prompts ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">13</span></a><span class="ltx_text ltx_font_typewriter" id="A1.p1.1.2"> provides the full version of the input prompt’s template that we demonstrated in Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S4.F5" title="Figure 5 ‣ 4.1.2 Details of the Input Prompt ‣ 4.1 Oracle-Guided Secure Code Synthesis ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5</span></a><span class="ltx_text ltx_font_typewriter" id="A1.p1.1.3">. Here, we provide the full list of instructions that we used in our synthesis pipeline.</span></p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1"><span class="ltx_text ltx_font_typewriter" id="A1.p2.1.1">In Section </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#S5.SS2" title="5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">5.2</span></a><span class="ltx_text ltx_font_typewriter" id="A1.p2.1.2">, we compared three variations of the secure code synthesis approach. In one of these variations, we do not use any security report. In Figure </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A1.F14" title="Figure 14 ‣ Appendix A Details of the Input prompts ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">14</span></a><span class="ltx_text ltx_font_typewriter" id="A1.p2.1.3">, we provide the input prompt that we used for this specific case.</span></p>
</div>
<figure class="ltx_figure" id="A1.F13"><svg class="ltx_picture ltx_centering" height="205.71" id="A1.F13.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,205.71) matrix(1 0 0 -1 0 0)"><g fill="#708570" fill-opacity="1.0"><path d="M 0 5.91 L 0 199.8 C 0 203.07 2.64 205.71 5.91 205.71 L 594.09 205.71 C 597.36 205.71 600 203.07 600 199.8 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F4F6F4" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 199.8 C 1.97 201.98 3.73 203.74 5.91 203.74 L 594.09 203.74 C 596.27 203.74 598.03 201.98 598.03 199.8 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="178.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.F13.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.F13.pic1.1.1.1.1.1.1.1" style="font-size:90%;">You are a security engineer and <span class="ltx_text ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.1.1.1">{prog_lang}</span> developer. The following code has <span class="ltx_text ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.1.1.2">{num_vuls}</span> vulnerability(ies):</span></span>
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.2.1" style="font-size:90%;">{vul_count}<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.2.1.1">- The code has a CWE vulnerability at line </span>{line_num}<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.2.1.2">.
The vulnerability is of </span>{cwe_type}<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.2.1.3"> type (</span>{cwe_explanation}<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.2.1.4">).</span></span></span>
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.3.1" style="font-size:90%;">{hint}<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.3.1.1"></span></span></span>
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.4.1" style="font-size:90%;">Instructions:<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.4.1.1"></span></span></span>
<span class="ltx_enumerate" id="A1.I1">
<span class="ltx_item" id="A1.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A1.I1.i1.p1">
<span class="ltx_p" id="A1.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I1.i1.p1.1.1" style="font-size:90%;">Analysis</span><span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.2" style="font-size:90%;">: First, provide a detailed explanation of the vulnerabilities present. Describe the steps necessary to fix these issues.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="A1.I1.i2.p1">
<span class="ltx_p" id="A1.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I1.i2.p1.1.1" style="font-size:90%;">Correction</span><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.p1.1.2" style="font-size:90%;">: After your explanation, directly repair the code. Ensure the following:</span></span>
<span class="ltx_itemize" id="A1.I1.i2.I1">
<span class="ltx_item" id="A1.I1.i2.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i1.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i1.p1.1.1" style="font-size:90%;">Correct all vulnerabilities in a single solution.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i2.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i2.p1.1.1" style="font-size:90%;">Avoid any syntax errors and ensure the code is valid in </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I1.i2.I1.i2.p1.1.2" style="font-size:90%;">{prog_lang}</span><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i2.p1.1.3" style="font-size:90%;">.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i3.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i3.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i3.p1.1.1" style="font-size:90%;">Do not provide multiple solutions or additional commentary after the corrected code.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i4.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i4.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i4.p1.1.1" style="font-size:90%;">Present the repaired code in a Markdown code block for </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I1.i2.I1.i4.p1.1.2" style="font-size:90%;">{prog_lang}</span><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i4.p1.1.3" style="font-size:90%;">.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2.I1.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i5.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i5.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i5.p1.1.1" style="font-size:90%;">Do not write any explanation after the corrected code.</span></span>
</span></span>
<span class="ltx_item" id="A1.I1.i2.I1.i6" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I1.i2.I1.i6.p1">
<span class="ltx_p" id="A1.I1.i2.I1.i6.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.I1.i6.p1.1.1" style="font-size:90%;">If new libraries are required, include them after the current included libraries.</span></span>
</span></span>
</span>
</span></span>
</span>
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A1.F13.pic1.1.1.1.1.1.5.1" style="font-size:90%;">Vulnerable code: 
<br class="ltx_break"/>‘‘‘ <span class="ltx_text ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.5.1.1">{prog_lang}</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.5.1.2">{vul_code}</span> ’’’
<br class="ltx_break"/></span></span>
<span class="ltx_p" id="A1.F13.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F13.pic1.1.1.1.1.1.6.1" style="font-size:90%;">Expected Outputs:<span class="ltx_text ltx_font_medium" id="A1.F13.pic1.1.1.1.1.1.6.1.1"></span></span></span>
<span class="ltx_itemize" id="A1.I2">
<span class="ltx_item" id="A1.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I2.i1.p1">
<span class="ltx_p" id="A1.I2.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I2.i1.p1.1.1" style="font-size:90%;">A clear and concise description of how to address the vulnerabilities. This is a MUST.</span></span>
</span></span>
<span class="ltx_item" id="A1.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I2.i2.p1">
<span class="ltx_p" id="A1.I2.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I2.i2.p1.1.1" style="font-size:90%;">The corrected version of the code.</span></span>
</span></span>
</span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A1.F13.4.1.1" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" id="A1.F13.5.2" style="font-size:90%;">Template of the input prompt.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A1.F14"><svg class="ltx_picture ltx_centering" height="172.5" id="A1.F14.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,172.5) matrix(1 0 0 -1 0 0)"><g fill="#708570" fill-opacity="1.0"><path d="M 0 5.91 L 0 166.6 C 0 169.86 2.64 172.5 5.91 172.5 L 594.09 172.5 C 597.36 172.5 600 169.86 600 166.6 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F4F6F4" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 166.6 C 1.97 168.77 3.73 170.53 5.91 170.53 L 594.09 170.53 C 596.27 170.53 598.03 168.77 598.03 166.6 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="144.94" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.F14.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.F14.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.F14.pic1.1.1.1.1.1.1.1" style="font-size:90%;">You are a <span class="ltx_text ltx_font_bold" id="A1.F14.pic1.1.1.1.1.1.1.1.1">{prog_lang}</span> developer.</span></span>
<span class="ltx_p" id="A1.F14.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F14.pic1.1.1.1.1.1.2.1" style="font-size:90%;">Instructions:<span class="ltx_text ltx_font_medium" id="A1.F14.pic1.1.1.1.1.1.2.1.1"></span></span></span>
<span class="ltx_enumerate" id="A1.I3">
<span class="ltx_item" id="A1.I3.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A1.I3.i1.p1">
<span class="ltx_p" id="A1.I3.i1.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I3.i1.p1.1.1" style="font-size:90%;">Analysis</span><span class="ltx_text ltx_font_typewriter" id="A1.I3.i1.p1.1.2" style="font-size:90%;">:If there is a vulnerability in the code, provide a detailed explanation of the vulnerabilities present. Describe the steps necessary to fix these issues.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="A1.I3.i2.p1">
<span class="ltx_p" id="A1.I3.i2.p1.1"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I3.i2.p1.1.1" style="font-size:90%;">Correction</span><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.p1.1.2" style="font-size:90%;">: If there is a vulnerability in the code, repair the code. Ensure the following:</span></span>
<span class="ltx_itemize" id="A1.I3.i2.I1">
<span class="ltx_item" id="A1.I3.i2.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i1.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i1.p1.1.1" style="font-size:90%;">Correct all vulnerabilities in a single solution.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i2.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i2.p1.1.1" style="font-size:90%;">Avoid any syntax errors and ensure the code is valid in </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I3.i2.I1.i2.p1.1.2" style="font-size:90%;">{prog_lang}</span><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i2.p1.1.3" style="font-size:90%;">.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i3.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i3.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i3.p1.1.1" style="font-size:90%;">Do not provide multiple solutions or additional commentary after the corrected code.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i4.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i4.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i4.p1.1.1" style="font-size:90%;">Present the repaired code in a Markdown code block for </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.I3.i2.I1.i4.p1.1.2" style="font-size:90%;">{prog_lang}</span><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i4.p1.1.3" style="font-size:90%;">.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2.I1.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i5.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i5.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i5.p1.1.1" style="font-size:90%;">Do not write any explanation after the corrected code.</span></span>
</span></span>
<span class="ltx_item" id="A1.I3.i2.I1.i6" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I3.i2.I1.i6.p1">
<span class="ltx_p" id="A1.I3.i2.I1.i6.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I3.i2.I1.i6.p1.1.1" style="font-size:90%;">If new libraries are required, include them after the current included libraries.</span></span>
</span></span>
</span>
</span></span>
</span>
<span class="ltx_p" id="A1.F14.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A1.F14.pic1.1.1.1.1.1.3.1" style="font-size:90%;">Code: 
<br class="ltx_break"/>‘‘‘ <span class="ltx_text ltx_font_bold" id="A1.F14.pic1.1.1.1.1.1.3.1.1">{prog_lang}</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="A1.F14.pic1.1.1.1.1.1.3.1.2">{vul_code}</span> ’’’
<br class="ltx_break"/></span></span>
<span class="ltx_p" id="A1.F14.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F14.pic1.1.1.1.1.1.4.1" style="font-size:90%;">Expected Outputs:<span class="ltx_text ltx_font_medium" id="A1.F14.pic1.1.1.1.1.1.4.1.1"></span></span></span>
<span class="ltx_itemize" id="A1.I4">
<span class="ltx_item" id="A1.I4.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I4.i1.p1">
<span class="ltx_p" id="A1.I4.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I4.i1.p1.1.1" style="font-size:90%;">A clear and concise description of how to address the vulnerabilities. This is a MUST.</span></span>
</span></span>
<span class="ltx_item" id="A1.I4.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A1.I4.i2.p1">
<span class="ltx_p" id="A1.I4.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A1.I4.i2.p1.1.1" style="font-size:90%;">The corrected version of the code.</span></span>
</span></span>
</span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A1.F14.4.1.1" style="font-size:90%;">Figure 14</span>: </span><span class="ltx_text" id="A1.F14.5.2" style="font-size:90%;">Template of the input prompt without using the security report.</span></figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_font_typewriter ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix"><span class="ltx_text ltx_font_serif" id="A2.1.1.1">Appendix B</span> </span>Details of the Security Hints</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A2.p1.1.1">In our code synthesis pipeline, we provide security hints to guide the model in resolving the security vulnerabilities in the given code. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A2.T8" title="Table 8 ‣ Appendix B Details of the Security Hints ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">8</span></a><span class="ltx_text ltx_font_typewriter" id="A2.p1.1.2">, we provide the list of the security hints that we employed in our work.</span></p>
</div>
<figure class="ltx_table" id="A2.T8">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A2.T8.4.1.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="A2.T8.5.2" style="font-size:90%;">List of the security hints that have been used in the security report of our code synthesis pipeline.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T8.6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T8.6.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.1.1.1.1">CWE</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A2.T8.6.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.1.1.2.1">
<span class="ltx_p" id="A2.T8.6.1.1.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.1.1.2.1.1.1">Hint</span></span>
</span>
</th>
</tr>
<tr class="ltx_tr" id="A2.T8.6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A2.T8.6.2.2.1"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.2.2.1.1">CWE-020</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="A2.T8.6.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.2.2.2.1">
<span class="ltx_p" id="A2.T8.6.2.2.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.2.2.2.1.1.1">Data from all potentially untrusted sources should be subject to input validation.</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.6.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.3.1.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.3.1.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.3.1.1.2">1-2
CWE-022-Py</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.3.1.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.3.1.2.1">
<span class="ltx_p" id="A2.T8.6.3.1.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.3.1.2.1.1.1">Inputs should be decoded and canonicalized to the application’s current internal representation before being validated. Sanitize the user’s input using safe_join or os.path.normpath.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.4.2.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.4.2.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.4.2.1.2">1-2
CWE-022-C/C++</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.4.2.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.4.2.2.1">
<span class="ltx_p" id="A2.T8.6.4.2.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.4.2.2.1.1.1">Inputs should be decoded and canonicalized to the application’s current internal representation before being validated. Use a built-in path canonicalization function (such as realpath() in C) that produces the canonical version of the pathname, which effectively removes sequences and symbolic links (CWE-23, CWE-59).</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.5.3.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.5.3.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.5.3.1.2">1-2
CWE-078</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.5.3.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.5.3.2.1">
<span class="ltx_p" id="A2.T8.6.5.3.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.5.3.2.1.1.1">Properly quote arguments and escape any special characters within those arguments. If using subprocess, avoid using shell=True. Alternatively, use shell=False instead.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.6.4.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.6.4.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.6.4.1.2">1-2
CWE-079</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.6.4.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.6.4.2.1">
<span class="ltx_p" id="A2.T8.6.6.4.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.6.4.2.1.1.1">Note that proper output encoding, escaping, and quoting is the most effective solution for preventing XSS.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.7.5.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.7.5.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.7.5.1.2">1-2
CWE-094</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.7.5.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.7.5.2.1">
<span class="ltx_p" id="A2.T8.6.7.5.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.7.5.2.1.1.1">Avoid using eval, exec, execfile functions or validate the user input. Use the ast.literal_eval() function. However, consider that an adversary could still cause excessive memory or stack consumption via deeply nested structures.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.8.6.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.8.6.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.8.6.1.2">1-2
CWE-117</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.8.6.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.8.6.2.1">
<span class="ltx_p" id="A2.T8.6.8.6.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.8.6.2.1.1.1">User input should be suitably sanitized before it is logged. If the log entries are plain text, then line breaks should be removed from user input, such as replacing (old, new) or similar. Care should also be taken that user input is clearly marked in log entries, and that a malicious user cannot cause confusion in other ways.For log entries that will be displayed in HTML, user input should be HTML encoded before being logged, to prevent forgery and other forms of HTML injection.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.9.7.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.9.7.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.9.7.1.2">1-2
CWE-190</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.9.7.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.9.7.2.1">
<span class="ltx_p" id="A2.T8.6.9.7.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.9.7.2.1.1.1">Perform input validation on any numeric input by ensuring that it is within the expected range. Enforce that the input meets both the minimum and maximum requirements for the expected range. Use unsigned integers where possible. This makes it easier to perform validation for integer overflows. When signed integers are required, ensure that the range check includes minimum values as well as maximum values.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.10.8.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.10.8.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.10.8.1.2">1-2
CWE-476</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.10.8.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.10.8.2.1">
<span class="ltx_p" id="A2.T8.6.10.8.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.10.8.2.1.1.1">If all pointers that could have been modified are sanity-checked previous to use, nearly all NULL pointer dereferences can be prevented.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.11.9.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.11.9.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.11.9.1.2">1-2
CWE-502</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.11.9.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.11.9.2.1">
<span class="ltx_p" id="A2.T8.6.11.9.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.11.9.2.1.1.1">When deserializing data, ensure that a new object is populated rather than just deserialized into an existing one. This ensures that the data flows through safe input validation processes and that the functions remain secure.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.6.12.10.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.12.10.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.12.10.1.2">1-2
CWE-611</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T8.6.12.10.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.12.10.2.1">
<span class="ltx_p" id="A2.T8.6.12.10.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.12.10.2.1.1.1">Many XML parsers and validators can be configured to disable external entity expansion. It is recommended to use the defusedxml library instead of the native Python XML libraries. The defusedxml library is specifically designed to mitigate XML external entity attacks. To guard against XXE attacks with the lxml library, you should create a parser with resolve_entities set to false.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.6.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T8.6.13.11.1">
<span class="ltx_ERROR undefined" id="A2.T8.6.13.11.1.1">\cdashline</span><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.13.11.1.2">1-2
CWE-787</span>
</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A2.T8.6.13.11.2">
<span class="ltx_inline-block ltx_align_top" id="A2.T8.6.13.11.2.1">
<span class="ltx_p" id="A2.T8.6.13.11.2.1.1" style="width:404.7pt;"><span class="ltx_text ltx_font_typewriter" id="A2.T8.6.13.11.2.1.1.1">Consider adhering to the following rules when allocating and managing an application’s memory:</span>
<span class="ltx_itemize" id="A2.I1">
<span class="ltx_item" id="A2.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A2.I1.i1.p1">
<span class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A2.I1.i1.p1.1.1">Double check that the buffer is as large as specified.</span></span>
</span></span>
<span class="ltx_item" id="A2.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A2.I1.i2.p1">
<span class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="A2.I1.i2.p1.1.1">When using functions that accept a number of bytes to copy, such as strncpy(), be aware that if the destination buffer size is equal to the source buffer size, it may not NULL-terminate the string.</span></span>
</span></span>
<span class="ltx_item" id="A2.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A2.I1.i3.p1">
<span class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_typewriter" id="A2.I1.i3.p1.1.1">Check buffer boundaries if accessing the buffer in a loop and make sure there is no danger of writing past the allocated space.</span></span>
</span></span>
<span class="ltx_item" id="A2.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="A2.I1.i4.p1">
<span class="ltx_p" id="A2.I1.i4.p1.1"><span class="ltx_text ltx_font_typewriter" id="A2.I1.i4.p1.1.1">If necessary, truncate all input strings to a reasonable length before passing them to the copy and concatenation functions.</span></span>
</span></span>
</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_font_typewriter ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix"><span class="ltx_text ltx_font_serif" id="A3.1.1.1">Appendix C</span> </span>Hyperparameters for LoRA Fine-tuning Approach</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1"><span class="ltx_text ltx_font_typewriter" id="A3.p1.1.1">In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A3.T9" title="Table 9 ‣ Appendix C Hyperparameters for LoRA Fine-tuning Approach ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">9</span></a><span class="ltx_text ltx_font_typewriter" id="A3.p1.1.2">, we list the LoRA hyperparameters used to fine-tune the various CodeLMs. We aimed to keep most parameters consistent across models. However, due to computational constraints, we set the LoRA rank for DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A3.p1.1.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="A3.p1.1.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A3.p1.1.5"> to 16, while for the other models, the rank was set to 64.</span></p>
</div>
<figure class="ltx_table" id="A3.T9">
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A3.T9.9.1.1" style="font-size:90%;">Table 9</span>: </span><span class="ltx_text" id="A3.T9.10.2" style="font-size:90%;">The LoRA hyperparameters we used to fine-tune the pre-trained CodeLMs.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T9.5.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T9.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T9.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.2.1">Models</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A3.T9.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.3.1">Batch Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.4.1">#Epoch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.5.1">Learning Rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.6.1">Rank</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.1.1.1.1">
<span class="ltx_text ltx_font_typewriter" id="A3.T9.1.1.1.1.1">LoRA </span><math alttext="\alpha" class="ltx_Math" display="inline" id="A3.T9.1.1.1.1.m1.1"><semantics id="A3.T9.1.1.1.1.m1.1a"><mi id="A3.T9.1.1.1.1.m1.1.1" xref="A3.T9.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.T9.1.1.1.1.m1.1b"><ci id="A3.T9.1.1.1.1.m1.1.1.cmml" xref="A3.T9.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.1.1.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A3.T9.1.1.1.1.m1.1d">italic_α</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T9.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T9.2.2.2.2">
<span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.2.1">CodeGen-350M-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.2.3.2">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.2.2.3"><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.3.1">16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.2.2.4"><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.4.1">10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.2.2.1"><math alttext="5e^{-4}" class="ltx_Math" display="inline" id="A3.T9.2.2.2.1.m1.1"><semantics id="A3.T9.2.2.2.1.m1.1a"><mrow id="A3.T9.2.2.2.1.m1.1.1" xref="A3.T9.2.2.2.1.m1.1.1.cmml"><mn id="A3.T9.2.2.2.1.m1.1.1.2" xref="A3.T9.2.2.2.1.m1.1.1.2.cmml">5</mn><mo id="A3.T9.2.2.2.1.m1.1.1.1" xref="A3.T9.2.2.2.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.T9.2.2.2.1.m1.1.1.3" xref="A3.T9.2.2.2.1.m1.1.1.3.cmml"><mi id="A3.T9.2.2.2.1.m1.1.1.3.2" xref="A3.T9.2.2.2.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.T9.2.2.2.1.m1.1.1.3.3" xref="A3.T9.2.2.2.1.m1.1.1.3.3.cmml"><mo id="A3.T9.2.2.2.1.m1.1.1.3.3a" xref="A3.T9.2.2.2.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T9.2.2.2.1.m1.1.1.3.3.2" xref="A3.T9.2.2.2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.2.2.2.1.m1.1b"><apply id="A3.T9.2.2.2.1.m1.1.1.cmml" xref="A3.T9.2.2.2.1.m1.1.1"><times id="A3.T9.2.2.2.1.m1.1.1.1.cmml" xref="A3.T9.2.2.2.1.m1.1.1.1"></times><cn id="A3.T9.2.2.2.1.m1.1.1.2.cmml" type="integer" xref="A3.T9.2.2.2.1.m1.1.1.2">5</cn><apply id="A3.T9.2.2.2.1.m1.1.1.3.cmml" xref="A3.T9.2.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.2.2.2.1.m1.1.1.3.1.cmml" xref="A3.T9.2.2.2.1.m1.1.1.3">superscript</csymbol><ci id="A3.T9.2.2.2.1.m1.1.1.3.2.cmml" xref="A3.T9.2.2.2.1.m1.1.1.3.2">𝑒</ci><apply id="A3.T9.2.2.2.1.m1.1.1.3.3.cmml" xref="A3.T9.2.2.2.1.m1.1.1.3.3"><minus id="A3.T9.2.2.2.1.m1.1.1.3.3.1.cmml" xref="A3.T9.2.2.2.1.m1.1.1.3.3"></minus><cn id="A3.T9.2.2.2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T9.2.2.2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.2.2.2.1.m1.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T9.2.2.2.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.2.2.5"><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.5.1">64</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.2.2.6"><span class="ltx_text ltx_font_typewriter" id="A3.T9.2.2.2.6.1">16</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T9.3.3.3.2">
<span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.2.1">CodeGen-2B-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.2.3.2">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.3.3"><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.3.1">16</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.3.4"><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.4.1">10</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.3.1"><math alttext="5e^{-4}" class="ltx_Math" display="inline" id="A3.T9.3.3.3.1.m1.1"><semantics id="A3.T9.3.3.3.1.m1.1a"><mrow id="A3.T9.3.3.3.1.m1.1.1" xref="A3.T9.3.3.3.1.m1.1.1.cmml"><mn id="A3.T9.3.3.3.1.m1.1.1.2" xref="A3.T9.3.3.3.1.m1.1.1.2.cmml">5</mn><mo id="A3.T9.3.3.3.1.m1.1.1.1" xref="A3.T9.3.3.3.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.T9.3.3.3.1.m1.1.1.3" xref="A3.T9.3.3.3.1.m1.1.1.3.cmml"><mi id="A3.T9.3.3.3.1.m1.1.1.3.2" xref="A3.T9.3.3.3.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.T9.3.3.3.1.m1.1.1.3.3" xref="A3.T9.3.3.3.1.m1.1.1.3.3.cmml"><mo id="A3.T9.3.3.3.1.m1.1.1.3.3a" xref="A3.T9.3.3.3.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T9.3.3.3.1.m1.1.1.3.3.2" xref="A3.T9.3.3.3.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.3.3.3.1.m1.1b"><apply id="A3.T9.3.3.3.1.m1.1.1.cmml" xref="A3.T9.3.3.3.1.m1.1.1"><times id="A3.T9.3.3.3.1.m1.1.1.1.cmml" xref="A3.T9.3.3.3.1.m1.1.1.1"></times><cn id="A3.T9.3.3.3.1.m1.1.1.2.cmml" type="integer" xref="A3.T9.3.3.3.1.m1.1.1.2">5</cn><apply id="A3.T9.3.3.3.1.m1.1.1.3.cmml" xref="A3.T9.3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.3.3.3.1.m1.1.1.3.1.cmml" xref="A3.T9.3.3.3.1.m1.1.1.3">superscript</csymbol><ci id="A3.T9.3.3.3.1.m1.1.1.3.2.cmml" xref="A3.T9.3.3.3.1.m1.1.1.3.2">𝑒</ci><apply id="A3.T9.3.3.3.1.m1.1.1.3.3.cmml" xref="A3.T9.3.3.3.1.m1.1.1.3.3"><minus id="A3.T9.3.3.3.1.m1.1.1.3.3.1.cmml" xref="A3.T9.3.3.3.1.m1.1.1.3.3"></minus><cn id="A3.T9.3.3.3.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T9.3.3.3.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.3.3.3.1.m1.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T9.3.3.3.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.3.5"><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.5.1">64</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.3.6"><span class="ltx_text ltx_font_typewriter" id="A3.T9.3.3.3.6.1">16</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T9.4.4.4.2">
<span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.2.1">Incoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.2.3.2">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.4.3"><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.3.1">16</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.4.4"><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.4.1">10</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.4.1"><math alttext="5e^{-4}" class="ltx_Math" display="inline" id="A3.T9.4.4.4.1.m1.1"><semantics id="A3.T9.4.4.4.1.m1.1a"><mrow id="A3.T9.4.4.4.1.m1.1.1" xref="A3.T9.4.4.4.1.m1.1.1.cmml"><mn id="A3.T9.4.4.4.1.m1.1.1.2" xref="A3.T9.4.4.4.1.m1.1.1.2.cmml">5</mn><mo id="A3.T9.4.4.4.1.m1.1.1.1" xref="A3.T9.4.4.4.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.T9.4.4.4.1.m1.1.1.3" xref="A3.T9.4.4.4.1.m1.1.1.3.cmml"><mi id="A3.T9.4.4.4.1.m1.1.1.3.2" xref="A3.T9.4.4.4.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.T9.4.4.4.1.m1.1.1.3.3" xref="A3.T9.4.4.4.1.m1.1.1.3.3.cmml"><mo id="A3.T9.4.4.4.1.m1.1.1.3.3a" xref="A3.T9.4.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T9.4.4.4.1.m1.1.1.3.3.2" xref="A3.T9.4.4.4.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.4.4.4.1.m1.1b"><apply id="A3.T9.4.4.4.1.m1.1.1.cmml" xref="A3.T9.4.4.4.1.m1.1.1"><times id="A3.T9.4.4.4.1.m1.1.1.1.cmml" xref="A3.T9.4.4.4.1.m1.1.1.1"></times><cn id="A3.T9.4.4.4.1.m1.1.1.2.cmml" type="integer" xref="A3.T9.4.4.4.1.m1.1.1.2">5</cn><apply id="A3.T9.4.4.4.1.m1.1.1.3.cmml" xref="A3.T9.4.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.4.4.4.1.m1.1.1.3.1.cmml" xref="A3.T9.4.4.4.1.m1.1.1.3">superscript</csymbol><ci id="A3.T9.4.4.4.1.m1.1.1.3.2.cmml" xref="A3.T9.4.4.4.1.m1.1.1.3.2">𝑒</ci><apply id="A3.T9.4.4.4.1.m1.1.1.3.3.cmml" xref="A3.T9.4.4.4.1.m1.1.1.3.3"><minus id="A3.T9.4.4.4.1.m1.1.1.3.3.1.cmml" xref="A3.T9.4.4.4.1.m1.1.1.3.3"></minus><cn id="A3.T9.4.4.4.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T9.4.4.4.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.4.4.4.1.m1.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T9.4.4.4.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.4.5"><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.5.1">64</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.4.6"><span class="ltx_text ltx_font_typewriter" id="A3.T9.4.4.4.6.1">16</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.5.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A3.T9.5.5.5.2">
<span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.2.1">DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.2.2.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.2.3.2">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.5.5.5.3"><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.3.1">16</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.5.5.5.4"><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.4.1">10</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.5.5.5.1"><math alttext="5e^{-4}" class="ltx_Math" display="inline" id="A3.T9.5.5.5.1.m1.1"><semantics id="A3.T9.5.5.5.1.m1.1a"><mrow id="A3.T9.5.5.5.1.m1.1.1" xref="A3.T9.5.5.5.1.m1.1.1.cmml"><mn id="A3.T9.5.5.5.1.m1.1.1.2" xref="A3.T9.5.5.5.1.m1.1.1.2.cmml">5</mn><mo id="A3.T9.5.5.5.1.m1.1.1.1" xref="A3.T9.5.5.5.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.T9.5.5.5.1.m1.1.1.3" xref="A3.T9.5.5.5.1.m1.1.1.3.cmml"><mi id="A3.T9.5.5.5.1.m1.1.1.3.2" xref="A3.T9.5.5.5.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.T9.5.5.5.1.m1.1.1.3.3" xref="A3.T9.5.5.5.1.m1.1.1.3.3.cmml"><mo id="A3.T9.5.5.5.1.m1.1.1.3.3a" xref="A3.T9.5.5.5.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T9.5.5.5.1.m1.1.1.3.3.2" xref="A3.T9.5.5.5.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.5.5.5.1.m1.1b"><apply id="A3.T9.5.5.5.1.m1.1.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1"><times id="A3.T9.5.5.5.1.m1.1.1.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1.1"></times><cn id="A3.T9.5.5.5.1.m1.1.1.2.cmml" type="integer" xref="A3.T9.5.5.5.1.m1.1.1.2">5</cn><apply id="A3.T9.5.5.5.1.m1.1.1.3.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.5.5.5.1.m1.1.1.3.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3">superscript</csymbol><ci id="A3.T9.5.5.5.1.m1.1.1.3.2.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3.2">𝑒</ci><apply id="A3.T9.5.5.5.1.m1.1.1.3.3.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3.3"><minus id="A3.T9.5.5.5.1.m1.1.1.3.3.1.cmml" xref="A3.T9.5.5.5.1.m1.1.1.3.3"></minus><cn id="A3.T9.5.5.5.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T9.5.5.5.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.5.5.5.1.m1.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T9.5.5.5.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.5.5.5.5"><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.5.1">16</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.5.5.5.6"><span class="ltx_text ltx_font_typewriter" id="A3.T9.5.5.5.6.1">16</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_font_typewriter ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix"><span class="ltx_text ltx_font_serif" id="A4.1.1.1">Appendix D</span> </span>Detailed Results</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1"><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.1">Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T10" title="Table 10 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">10</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.2">, </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T11" title="Table 11 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.3">,</span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T12" title="Table 12 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">12</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.4">, </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T13" title="Table 13 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">13</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.5">, </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T14" title="Table 14 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">14</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.6">, and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T15" title="Table 15 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">15</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.7"> provide the detailed results of evaluating different variations of the models using CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.10"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.11.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.12.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p1.1.13"> benchmarks. These tables provide the number of generated vulnerable codes per CWE for Python and C/C++ codes.</span></p>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.1"><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.1">Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T10" title="Table 10 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">10</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.2"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T11" title="Table 11 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.3"> demonstrate the number of vulnerable codes generated by different variations of CodeGen-350M-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.6">. In Table  </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T10" title="Table 10 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">10</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.7">, we observe that the CodeGen-350M-multi model fine-tuned with our HexaCoder produces fewer vulnerable Python codes compared to the other variations of the model. For example, using our approach, the model generates no code containing CWE-078 vulnerabilities, whereas the pre-trained model generates 12 such instances, and SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.10"> generates 10. Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T11" title="Table 11 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">11</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p2.1.11"> also shows that in 9 out of 13 cases, our approach generates the same or fewer number of vulnerable codes than the other approaches.</span></p>
</div>
<div class="ltx_para" id="A4.p3">
<p class="ltx_p" id="A4.p3.1"><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.1">In Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T12" title="Table 12 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">12</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.2"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T13" title="Table 13 ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">13</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.3"> we provide the number of vulnerable codes generated by different variations of InCoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.6">. These tables also demonstrate that fine-tuning InCoder-6B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.7.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.8.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.9"> using our approach significantly reduces the number of vulnerable codes that can be generated using CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.10.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.11.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.12"> and Pearce et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.13.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.14.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p3.1.15"> benchmarks.</span></p>
</div>
<div class="ltx_para" id="A4.p4">
<p class="ltx_p" id="A4.p4.1"><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.1">Tables </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T14" title="Table 14 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">14</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.2"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T15" title="Table 15 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">15</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.3"> demonstrate the number of vulnerable codes generated by different variations of DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.6">. In these two tables, as the fine-tuned version of DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.7.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.8.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.9"> using SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.10.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.11.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.12"> was not provided in the original work, we only report the results for the pre-trained model and our approach. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T14" title="Table 14 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">14</span></a><span class="ltx_text ltx_font_typewriter" id="A4.p4.1.13">, we observe that our HexaCoder generates fewer vulnerable codes than the pre-trained model in most cases, except for CWE-020. This may be due to the fact that our dataset contains only 21 samples relevant to this CWE, which are not representative enough. In contrast, for other CWEs, we have up to 298 samples. This data imbalance might explain why our approach generated a higher number of vulnerable codes of type CWE-020 compared to the pre-trained model.</span></p>
</div>
<figure class="ltx_table" id="A4.T10">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T10.24.2.1" style="font-size:90%;">Table 10</span>: </span><span class="ltx_text" id="A4.T10.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T10.2.1.1">CodeGen-350M-multi</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T10.2.1.2">CodeLMSec benchmark</span>. <em class="ltx_emph ltx_font_italic" id="A4.T10.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T10.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="A4.T10.2.1.5">HexaCoder</em> refer to the CodeGen-350M-multi model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="5" class="ltx_Math" display="inline" id="A4.T10.2.1.m1.1"><semantics id="A4.T10.2.1.m1.1b"><mn id="A4.T10.2.1.m1.1.1" xref="A4.T10.2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.T10.2.1.m1.1c"><cn id="A4.T10.2.1.m1.1.1.cmml" type="integer" xref="A4.T10.2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T10.2.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="A4.T10.2.1.m1.1e">5</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T10.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T10.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T10.25"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T10.25.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1" style="width:882.5pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1"><span class="ltx_text" id="A4.T10.25.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T10.25.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T10.25.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T10.25.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_10" id="A4.T10.25.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T10.25.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T10.25.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.7.1.1">CWE-117</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.8.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.9.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.9.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.10.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.10.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.11.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.11.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.12.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.13.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.14.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.15.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.15.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.16.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.16.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T10.25.1.1.1.1.1.2.2.17">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T10.25.1.1.1.1.1.2.2.17.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T10.25.1.1.1.1.1.2.2.17.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T10.25.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T10.25.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.2">5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.3">50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.4">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.5">93</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.6">20</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.7">33</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.8">22</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.9">31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.10">15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.11">281</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.12">8</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.13"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.3.1.13.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.14">33</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.15">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.16">8</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.25.1.1.1.1.1.3.1.17">67</span></span>
<span class="ltx_tr" id="A4.T10.25.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T10.25.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.2">3</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.3">56</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.4">10</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.5">67</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.6">18</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.7">32</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.8">21</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.9">34</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.10">17</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.11">258</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.12">6</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.13">11</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.14">20</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.15">10</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.16">18</span>
<span class="ltx_td ltx_align_center" id="A4.T10.25.1.1.1.1.1.4.2.17">65</span></span>
<span class="ltx_tr" id="A4.T10.25.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.2.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.3.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.4.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.5.1">35</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.7.1">13</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.8.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.9.1">14</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.10"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.10.1">11</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.11.1">81</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.12.1">1</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.13">10</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.14"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.14.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.15"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.15.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.16"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.16.1">8</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.25.1.1.1.1.1.5.3.17"><span class="ltx_text ltx_font_bold" id="A4.T10.25.1.1.1.1.1.5.3.17.1">24</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T10.25.2"></span></p>
</figure>
<figure class="ltx_table" id="A4.T11">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T11.27.2.1" style="font-size:90%;">Table 11</span>: </span><span class="ltx_text" id="A4.T11.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T11.2.1.1">CodeGen-350M-multi</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T11.2.1.2">Pearce et al. benchmark</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> . <em class="ltx_emph ltx_font_italic" id="A4.T11.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T11.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="A4.T11.2.1.5">HexaCoder</em> refer to the CodeGen-350M-multi model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="15" class="ltx_Math" display="inline" id="A4.T11.2.1.m1.1"><semantics id="A4.T11.2.1.m1.1b"><mn id="A4.T11.2.1.m1.1.1" xref="A4.T11.2.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A4.T11.2.1.m1.1c"><cn id="A4.T11.2.1.m1.1.1.cmml" type="integer" xref="A4.T11.2.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T11.2.1.m1.1d">15</annotation><annotation encoding="application/x-llamapun" id="A4.T11.2.1.m1.1e">15</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T11.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T11.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T11.28"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T11.28.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1" style="width:832.2pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1"><span class="ltx_text" id="A4.T11.28.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T11.28.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T11.28.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T11.28.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_9" id="A4.T11.28.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T11.28.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T11.28.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.7.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.8.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.9.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.9.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.10.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.10.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.11.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.11.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.12.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.13.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.14.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.15.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.15.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T11.28.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T11.28.1.1.1.1.1.2.2.16.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T11.28.1.1.1.1.1.2.2.16.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T11.28.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T11.28.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.2">3</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.3">36</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.4">23</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.5">21</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.6"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.3.1.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.7">16</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.8">10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.9"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.3.1.9.1">28</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.10">137</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.11">11</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.12"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.3.1.12.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.13">23</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.14">9</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.15">1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.28.1.1.1.1.1.3.1.16">46</span></span>
<span class="ltx_tr" id="A4.T11.28.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T11.28.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.2"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.4.2.2.1">2</span></span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.3">14</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.4">14</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.5">16</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.6"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.4.2.6.1">0</span></span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.7">9</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.8">11</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.9">39</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.10">105</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.11">3</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.12">5</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.13">15</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.14"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.4.2.14.1">3</span></span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.15">5</span>
<span class="ltx_td ltx_align_center" id="A4.T11.28.1.1.1.1.1.4.2.16">30</span></span>
<span class="ltx_tr" id="A4.T11.28.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.2">3</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.3.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.4.1">1</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.5.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.8.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.9">30</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.10"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.10.1">39</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.11.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.12">5</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.13"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.13.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.14">10</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.15"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.15.1">1</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.28.1.1.1.1.1.5.3.16"><span class="ltx_text ltx_font_bold" id="A4.T11.28.1.1.1.1.1.5.3.16.1">16</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T11.28.2"></span></p>
</figure>
<figure class="ltx_table" id="A4.T12">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T12.24.2.1" style="font-size:90%;">Table 12</span>: </span><span class="ltx_text" id="A4.T12.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T12.2.1.1">InCoder-6B</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T12.2.1.2">CodeLMSec benchmark</span>. <em class="ltx_emph ltx_font_italic" id="A4.T12.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T12.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="A4.T12.2.1.5">HexaCoder</em> refer to the InCoder-6B model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="5" class="ltx_Math" display="inline" id="A4.T12.2.1.m1.1"><semantics id="A4.T12.2.1.m1.1b"><mn id="A4.T12.2.1.m1.1.1" xref="A4.T12.2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.T12.2.1.m1.1c"><cn id="A4.T12.2.1.m1.1.1.cmml" type="integer" xref="A4.T12.2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T12.2.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="A4.T12.2.1.m1.1e">5</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T12.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T12.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T12.25"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T12.25.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1" style="width:882.2pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1"><span class="ltx_text" id="A4.T12.25.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T12.25.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T12.25.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T12.25.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_10" id="A4.T12.25.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T12.25.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T12.25.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.7.1.1">CWE-117</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.8.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.9.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.9.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.10.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.10.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.11.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.11.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.12.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.13.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.14.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.15.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.15.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.16.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.16.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T12.25.1.1.1.1.1.2.2.17">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T12.25.1.1.1.1.1.2.2.17.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T12.25.1.1.1.1.1.2.2.17.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T12.25.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T12.25.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.2">16</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.3">60</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.4">36</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.5"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.3.1.5.1">85</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.6">40</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.7">49</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.8">36</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.9">51</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.10"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.3.1.10.1">12</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.11">385</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.12">14</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.13">13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.14">39</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.15">18</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.16"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.3.1.16.1">4</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.25.1.1.1.1.1.3.1.17">88</span></span>
<span class="ltx_tr" id="A4.T12.25.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T12.25.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.2">8</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.3">52</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.4">23</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.5">94</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.6">37</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.7">49</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.8">25</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.9">59</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.10">20</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.11">367</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.12">12</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.13">14</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.14">36</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.15">17</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.16">11</span>
<span class="ltx_td ltx_align_center" id="A4.T12.25.1.1.1.1.1.4.2.17">90</span></span>
<span class="ltx_tr" id="A4.T12.25.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.2.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.3.1">16</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.4.1">10</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.5">89</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.7.1">19</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.8.1">3</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.9.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.10">30</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.11.1">178</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.12.1">3</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.13"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.13.1">11</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.14"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.14.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.15"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.15.1">3</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.16">15</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T12.25.1.1.1.1.1.5.3.17"><span class="ltx_text ltx_font_bold" id="A4.T12.25.1.1.1.1.1.5.3.17.1">37</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T12.25.2"></span></p>
</figure>
<figure class="ltx_table" id="A4.T13">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T13.27.2.1" style="font-size:90%;">Table 13</span>: </span><span class="ltx_text" id="A4.T13.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T13.2.1.1">InCoder-6B</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T13.2.1.2">Pearce et al. benchmark</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> . <em class="ltx_emph ltx_font_italic" id="A4.T13.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T13.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="A4.T13.2.1.5">HexaCoder</em> refer to the InCoder-6B model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="15" class="ltx_Math" display="inline" id="A4.T13.2.1.m1.1"><semantics id="A4.T13.2.1.m1.1b"><mn id="A4.T13.2.1.m1.1.1" xref="A4.T13.2.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A4.T13.2.1.m1.1c"><cn id="A4.T13.2.1.m1.1.1.cmml" type="integer" xref="A4.T13.2.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T13.2.1.m1.1d">15</annotation><annotation encoding="application/x-llamapun" id="A4.T13.2.1.m1.1e">15</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T13.2.1.6">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T13.2.1.7">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T13.28"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T13.28.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1" style="width:831.9pt;height:108pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1"><span class="ltx_text" id="A4.T13.28.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T13.28.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T13.28.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T13.28.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_9" id="A4.T13.28.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T13.28.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T13.28.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.7.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.8.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.9.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.9.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.10.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.10.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.11.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.11.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.12.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.13.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.14.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.15.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.15.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T13.28.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T13.28.1.1.1.1.1.2.2.16.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T13.28.1.1.1.1.1.2.2.16.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T13.28.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T13.28.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib27" title="">27</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.2">10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.3">9</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.4">27</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.5"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.3.1.5.1">8</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.6"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.3.1.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.7"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.3.1.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.8">14</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.9">38</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.10">106</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.11">9</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.12">13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.13">41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.14">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.15"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.3.1.15.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T13.28.1.1.1.1.1.3.1.16">77</span></span>
<span class="ltx_tr" id="A4.T13.28.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T13.28.1.1.1.1.1.4.2.1">SVEN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite></span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.2">8</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.3">3</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.4">11</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.5">13</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.6"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.4.2.6.1">0</span></span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.7"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.4.2.7.1">0</span></span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.8">8</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.9"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.4.2.9.1">22</span></span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.10">65</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.11">10</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.12">11</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.13">38</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.14"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.4.2.14.1">4</span></span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.15">6</span>
<span class="ltx_td ltx_align_center" id="A4.T13.28.1.1.1.1.1.4.2.16">69</span></span>
<span class="ltx_tr" id="A4.T13.28.1.1.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.2.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.3.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.4.1">8</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.5">9</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.8.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.9">34</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.10"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.10.1">51</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.11"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.11.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.12.1">7</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.13"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.13.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.14">9</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.15">8</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T13.28.1.1.1.1.1.5.3.16"><span class="ltx_text ltx_font_bold" id="A4.T13.28.1.1.1.1.1.5.3.16.1">26</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T13.28.2"></span></p>
</figure>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_font_typewriter ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text ltx_font_serif" id="A4.SS1.1.1.1">D.1</span> </span>Detailed Results of the Effectiveness of the Two-step Generation Approach</h3>
<figure class="ltx_table" id="A4.T14">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T14.19.2.1" style="font-size:90%;">Table 14</span>: </span><span class="ltx_text" id="A4.T14.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T14.2.1.1">DeepSeek-Coder-V2-16B</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T14.2.1.2">CodeLMSec benchmark</span>. <em class="ltx_emph ltx_font_italic" id="A4.T14.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T14.2.1.4">HexaCoder</em> refers to the DeepSeek-Coder-V2-16B model fine-tuned by our proposed approach. The table presents the number of vulnerable codes among the top-<math alttext="5" class="ltx_Math" display="inline" id="A4.T14.2.1.m1.1"><semantics id="A4.T14.2.1.m1.1b"><mn id="A4.T14.2.1.m1.1.1" xref="A4.T14.2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.T14.2.1.m1.1c"><cn id="A4.T14.2.1.m1.1.1.cmml" type="integer" xref="A4.T14.2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T14.2.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="A4.T14.2.1.m1.1e">5</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T14.2.1.5">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T14.2.1.6">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T14.20"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T14.20.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1" style="width:912.2pt;height:90pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1"><span class="ltx_text" id="A4.T14.20.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T14.20.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T14.20.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T14.20.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_10" id="A4.T14.20.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T14.20.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T14.20.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.7.1.1">CWE-117</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.8.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.9.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.9.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.10.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.10.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.11.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.11.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.12.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.13.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.14.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.15.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.15.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.16.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.16.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T14.20.1.1.1.1.1.2.2.17">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T14.20.1.1.1.1.1.2.2.17.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T14.20.1.1.1.1.1.2.2.17.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T14.20.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T14.20.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.2"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.3.1.2.1">15</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.3">57</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.4">49</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.5">75</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.6">47</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.7">49</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.8">39</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.9">52</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.10">30</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.11">413</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.12">13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.13">36</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.14">38</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.15">17</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.16">5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T14.20.1.1.1.1.1.3.1.17">109</span></span>
<span class="ltx_tr" id="A4.T14.20.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.2">19</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.3.1">3</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.4"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.4.1">11</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.5"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.5.1">14</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.6"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.7"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.7.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.8"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.8.1">10</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.9"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.9.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.10"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.10.1">18</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.11"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.11.1">81</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.12"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.12.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.13"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.13.1">20</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.14"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.14.1">11</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.15"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.15.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.16"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.16.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T14.20.1.1.1.1.1.4.2.17"><span class="ltx_text ltx_font_bold" id="A4.T14.20.1.1.1.1.1.4.2.17.1">36</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T14.20.2"></span></p>
</figure>
<figure class="ltx_table" id="A4.T15">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T15.22.2.1" style="font-size:90%;">Table 15</span>: </span><span class="ltx_text" id="A4.T15.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T15.2.1.1">DeepSeek-Coder-V2-16B</span> model as evaluated using the <span class="ltx_text ltx_font_bold" id="A4.T15.2.1.2">Pearce et al. benchmark</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib56" title="">56</a>]</cite> . <em class="ltx_emph ltx_font_italic" id="A4.T15.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T15.2.1.4">HexaCoder</em> refers to the DeepSeek-Coder-V2-16B model fine-tuned by our proposed approach. The table presents the number of vulnerable codes among the top-<math alttext="15" class="ltx_Math" display="inline" id="A4.T15.2.1.m1.1"><semantics id="A4.T15.2.1.m1.1b"><mn id="A4.T15.2.1.m1.1.1" xref="A4.T15.2.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="A4.T15.2.1.m1.1c"><cn id="A4.T15.2.1.m1.1.1.cmml" type="integer" xref="A4.T15.2.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T15.2.1.m1.1d">15</annotation><annotation encoding="application/x-llamapun" id="A4.T15.2.1.m1.1e">15</annotation></semantics></math> samples for each evaluated CWE, with separate columns for Python (left) and C/C++ (right).
The <em class="ltx_emph ltx_font_italic" id="A4.T15.2.1.5">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T15.2.1.6">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T15.23"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T15.23.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1" style="width:861.9pt;height:90pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1"><span class="ltx_text" id="A4.T15.23.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T15.23.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T15.23.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T15.23.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_9" id="A4.T15.23.1.1.1.1.1.1.1.2">Python</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_6" id="A4.T15.23.1.1.1.1.1.1.1.3">C/C++</span></span>
<span class="ltx_tr" id="A4.T15.23.1.1.1.1.1.2.2">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.1"></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.7.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.8.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.9.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.9.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.10.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.10.1.1">Total</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.11.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.11.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.12">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.12.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.12.1.1">CWE-190</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.13">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.13.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.13.1.1">CWE-476</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.14">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.14.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.14.1.1">CWE-787</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.15">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.15.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.15.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A4.T15.23.1.1.1.1.1.2.2.16">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T15.23.1.1.1.1.1.2.2.16.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T15.23.1.1.1.1.1.2.2.16.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T15.23.1.1.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T15.23.1.1.1.1.1.3.1.1">Base <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.2">10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.3">13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.4">25</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.5"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.3.1.5.1">9</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.6"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.3.1.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.7"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.3.1.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.8">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.9">41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.10">110</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.11">15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.12"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.3.1.12.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.13">41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.14">15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.15"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.3.1.15.1">5</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T15.23.1.1.1.1.1.3.1.16">76</span></span>
<span class="ltx_tr" id="A4.T15.23.1.1.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.2"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.2.1">7</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.3.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.4"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.4.1">6</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.5">15</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.6"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.6.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.7"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.7.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.8"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.8.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.9"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.9.1">7</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.10"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.10.1">35</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.11"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.11.1">10</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.12">13</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.13"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.13.1">0</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.14"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.14.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.15"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.15.1">2</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T15.23.1.1.1.1.1.4.2.16"><span class="ltx_text ltx_font_bold" id="A4.T15.23.1.1.1.1.1.4.2.16.1">27</span></span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T15.23.2"></span></p>
</figure>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1"><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.1">Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T16" title="Table 16 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">16</span></a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.2"> demonstrates the detailed results of the different approaches with and without using the two-step generation approach. This table provides the number of generated vulnerable codes among the top-</span><math alttext="5" class="ltx_Math" display="inline" id="A4.SS1.p1.1.m1.1"><semantics id="A4.SS1.p1.1.m1.1a"><mn id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><cn id="A4.SS1.p1.1.m1.1.1.cmml" type="integer" xref="A4.SS1.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.1.m1.1d">5</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.3"> most probable samples using the Python prompts of the CodeLMSec </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.4.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.5.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.6"> benchmark. In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T16" title="Table 16 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">16</span></a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.7">, we present the results of the pre-trained CodeGen-350M-multi </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.8.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib52" title="">52</a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.9.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.10"> (</span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="A4.SS1.p1.1.11">Base</span><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.12">), the fine-tuned version of CodeGen-350M-multi using SVEN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.13.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.14.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.15">, and the fine-tuned model using our HexaCoder approach. In this table, </span><span class="ltx_text ltx_font_typewriter ltx_font_italic" id="A4.SS1.p1.1.16">Two</span><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p1.1.17"> refers to our two-step approach.</span></p>
</div>
<div class="ltx_para" id="A4.SS1.p2">
<p class="ltx_p" id="A4.SS1.p2.1"><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p2.1.1">In Table </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A4.T16" title="Table 16 ‣ D.1 Detailed Results of the Effectiveness of the Two-step Generation Approach ‣ Appendix D Detailed Results ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">16</span></a><span class="ltx_text ltx_font_typewriter" id="A4.SS1.p2.1.2">, we observe that the two-step generation method achieves better performance when used with our approach compared to the others.". For example, using the two-step generation approach, our HexaCoder generates no vulnerable codes for CWE-078, CWE-094, and CWE-502. In contrast, without the two-step approach, it generates at least 14 vulnerable codes for each of these CWEs. However, for the Base model, the two-step generation approach increases the number of vulnerable codes for CWE-094 and CWE-502.</span></p>
</div>
<figure class="ltx_table" id="A4.T16">
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_table"><span class="ltx_text ltx_font_serif" id="A4.T16.26.2.1" style="font-size:90%;">Table 16</span>: </span><span class="ltx_text" id="A4.T16.2.1" style="font-size:90%;">Number of vulnerable code samples generated by the <span class="ltx_text ltx_font_bold" id="A4.T16.2.1.1">CodeGen-350M-multi</span> model as evaluated using the Python prompts of the <span class="ltx_text ltx_font_bold" id="A4.T16.2.1.2">CodeLMSec benchmark</span>. <em class="ltx_emph ltx_font_italic" id="A4.T16.2.1.3">Base</em> represents the original model, while <em class="ltx_emph ltx_font_italic" id="A4.T16.2.1.4">SVEN</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib35" title="">35</a>]</cite> and <em class="ltx_emph ltx_font_italic" id="A4.T16.2.1.5">HexaCoder</em> refer to the CodeGen-350M-multi model fine-tuned by each respective approach. The table presents the number of vulnerable codes among the top-<math alttext="5" class="ltx_Math" display="inline" id="A4.T16.2.1.m1.1"><semantics id="A4.T16.2.1.m1.1b"><mn id="A4.T16.2.1.m1.1.1" xref="A4.T16.2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A4.T16.2.1.m1.1c"><cn id="A4.T16.2.1.m1.1.1.cmml" type="integer" xref="A4.T16.2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T16.2.1.m1.1d">5</annotation><annotation encoding="application/x-llamapun" id="A4.T16.2.1.m1.1e">5</annotation></semantics></math> samples for each evaluated CWE. <span class="ltx_text ltx_font_italic" id="A4.T16.2.1.6">Two</span> denotes
the two-step generation approach
The <em class="ltx_emph ltx_font_italic" id="A4.T16.2.1.7">Other</em> column refers to the rest of the CWEs that are identified by CodeQL. The <em class="ltx_emph ltx_font_italic" id="A4.T16.2.1.8">Total</em> column shows the sum of vulnerable samples.
</span></figcaption>
<p class="ltx_p" id="A4.T16.27"><span class="ltx_text ltx_font_typewriter ltx_inline-block" id="A4.T16.27.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1" style="width:618.0pt;height:144pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1"><span class="ltx_text" id="A4.T16.27.1.1.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T16.27.1.1.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.1">Models</span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.2">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.2.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.2.1.1">CWE-020</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.3">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.3.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.3.1.1">CWE-022</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.4">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.4.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.4.1.1">CWE-078</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.5">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.5.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.5.1.1">CWE-079</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.6">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.6.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.6.1.1">CWE-094</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.7">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.7.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.7.1.1">CWE-117</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.8">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.8.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.8.1.1">CWE-502</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.9">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.9.1" style="width:35.0pt;height:35pt;vertical-align:-14.1pt;"><span class="ltx_transformed_inner" style="width:42.6pt;transform:translate(-3.83pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.9.1.1">CWE-611</span>
</span></span></span>
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.10">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.10.1" style="width:23.0pt;height:23pt;vertical-align:-8.0pt;"><span class="ltx_transformed_inner" style="width:25.6pt;transform:translate(-1.29pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.10.1.1">Other</span>
</span></span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T16.27.1.1.1.1.1.1.1.11">
<span class="ltx_inline-block ltx_transformed_outer" id="A4.T16.27.1.1.1.1.1.1.1.11.1" style="width:21.2pt;height:21.2pt;vertical-align:-7.1pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-0.92pt,0pt) rotate(45deg) ;">
<span class="ltx_p" id="A4.T16.27.1.1.1.1.1.1.1.11.1.1">Total</span>
</span></span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.2.1">
<span class="ltx_td ltx_align_left ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.1">Base</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.2">5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.3">50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.4">12</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.5">93</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.6">20</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.7">33</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.8">22</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.9">31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.10">15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T16.27.1.1.1.1.1.2.1.11">281</span></span>
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.3.2">
<span class="ltx_td ltx_align_left" id="A4.T16.27.1.1.1.1.1.3.2.1">Base (w Two)</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.2">2</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.3">51</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.4">7</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.5">76</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.6">22</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.7">39</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.8">24</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.9">39</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.10">31</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.3.2.11">291</span></span>
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.4.3">
<span class="ltx_td ltx_align_left" id="A4.T16.27.1.1.1.1.1.4.3.1"><span class="ltx_ERROR undefined" id="A4.T16.27.1.1.1.1.1.4.3.1.1">\cdashline</span>1-11
SVEN</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.2">3</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.3">56</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.4">10</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.5">67</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.6">18</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.7">32</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.8">21</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.9">34</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.10">17</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.4.3.11">258</span></span>
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.5.4">
<span class="ltx_td ltx_align_left" id="A4.T16.27.1.1.1.1.1.5.4.1">SVEN (w Two)</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.2">1</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.3">44</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.4">15</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.5">34</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.6">13</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.7">18</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.8">16</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.9">40</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.10">18</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.5.4.11">199</span></span>
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.6.5">
<span class="ltx_td ltx_align_left" id="A4.T16.27.1.1.1.1.1.6.5.1"><span class="ltx_ERROR undefined" id="A4.T16.27.1.1.1.1.1.6.5.1.1">\cdashline</span>1-11
HexaCoder (w/o Two)</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.2">6</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.3">3</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.4">24</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.5">88</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.6">14</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.7">5</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.8">23</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.9">4</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.10">7</span>
<span class="ltx_td ltx_align_center" id="A4.T16.27.1.1.1.1.1.6.5.11">174</span></span>
<span class="ltx_tr" id="A4.T16.27.1.1.1.1.1.7.6">
<span class="ltx_td ltx_align_left ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.1">HexaCoder</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.2">2</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.3">6</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.4">0</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.5">35</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.6">0</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.7">13</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.8">0</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.9">14</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.10">11</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T16.27.1.1.1.1.1.7.6.11">81</span></span>
</span>
</span></span></span>
</span></span></span><span class="ltx_text ltx_font_typewriter" id="A4.T16.27.2"></span></p>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_font_typewriter ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix"><span class="ltx_text ltx_font_serif" id="A5.2.1.1">Appendix E</span> </span>Examples of the Generated Codes</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1"><span class="ltx_text ltx_font_typewriter" id="A5.p1.1.1">In Listings </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p1.1.2"> and </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p1.1.3">, we provide two examples of Vulnerable Python and C codes with their corresponding fixed codes. For clarity and to fit the code on the page, we have removed parts of the codes’ comments. Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p1.1.4"> demonstrates a Python code that contains the cross-site scripting (CWE-079) vulnerability at line 19. In this code, the user-controlled parameter param is directly inserted into the HTML content (at line 17) without any sanitization or encoding. In Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p1.1.5">, we provide the fixed version of the code generated by our code synthesis pipeline. The model fixed the code by including the escape from the  flask library. Specifically, in line 14, the model applies the escape function to sanitize special HTML characters in the user input, thereby preventing the execution of arbitrary code.</span></p>
</div>
<div class="ltx_para" id="A5.p2">
<p class="ltx_p" id="A5.p2.1"><span class="ltx_text ltx_font_typewriter" id="A5.p2.1.1">Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p2.1.2"> provides an example of a C code with out-of-bound write (CWE-787) vulnerability at line 17. The vulnerability arises because the code uses scanf("%s", input_str); without limiting the number of characters read. This can result in a buffer overflow if the user inputs a string longer than the size of input_str. Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p2.1.3"> presents the corrected version of the code generated by our code synthesis pipeline. In the fixed code, the model limits the number of characters scanf can read to 99, ensuring it fits within the input_str buffer while leaving space for the null terminator. Additionally, the model checks the return value of scanf to verify that the expected number of inputs is successfully read.</span></p>
</div>
<div class="ltx_para" id="A5.p3">
<p class="ltx_p" id="A5.p3.1"><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.1">In Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.2">, we provide an example of the CodeLMSec prompt for CWE-611 together with the completed code using HexaCoder. The base model of the HexaCoder was DeepSeek-Coder-V2-16B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.3.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib71" title="">71</a><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.4.2">]</span></cite><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.5">. Using the provided prompt in Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.6">, the model might generate a code that is vulnerable to XML external entity (XXE) attack. To prevent this vulnerability, it is recommended to disable external entity processing in the XML parser. As demonstrated in Listing </span><a class="ltx_ref ltx_font_typewriter" href="https://arxiv.org/html/2409.06446v1#A5" title="Appendix E Examples of the Generated Codes ‣ Acknowledgments ‣ 7 Conclusion ‣ 6.2 Adaptability of Our Approach to Other Vulnerabilities ‣ 6 Discussion ‣ 5.3.2 Effectiveness of the Two-step Generation Approach ‣ 5.3 Performance of HexaCoder in Securing CodeLMs ‣ 5.2.2 Example of a Fixed Code ‣ 5.2 Performance of Our Code Synthesis Approach ‣ 5 Experiments ‣ 4.3 Two-step Code Generation ‣ 4 Secure LLM-based Code Generation ‣ HexaCoder: Secure Code Generation via Oracle-Guided Synthetic Training Data"><span class="ltx_text ltx_ref_tag">E</span></a><span class="ltx_text ltx_font_typewriter" id="A5.p3.1.7">, HexaCoder adds the XMLParser module, priming the model to define a custom parser instead of using the default one. In this listing, the model defines a parser at line 11 and sets the resolve_entities option to False to mitigate the risk of an XXE attack.</span></p>
</div>
<figure class="ltx_figure" id="A5.1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.2">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.5.1.1" style="font-size:90%;">Figure 15</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.6.2" style="font-size:90%;">Vulnerable code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.7">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgcmVxdWVzdCwgbWFrZV9yZXNwb25zZQoKZGVmIHJlcGxhY2Vfc3RyaW5nX2luX3RlbXBsYXRlKCk6CiAgICAnJycKICAgIFRhc2s6IFJlcGxhY2VhIHNwZWNpZmljIHN0cmluZyBpbiBhIEhUTUwgdGVtcGxhdGUgd2l0aCBhIHBhcmFtZXRlciBwYXNzZWQgdGhyb3VnaCByZXF1ZXN0CiAgICBJbnB1dDogTm9uZQogICAgT3V0cHV0OiBIVE1MIHRlbXBsYXRlIHdpdGggcmVwbGFjZWQgc3RyaW5nCiAgICAnJycKCiAgICAjIEdldCB0aGUgSFRNTCB0ZW1wbGF0ZQogICAgd2l0aCBvcGVuKCd0ZW1wbGF0ZS5odG1sJywgJ3InKSBhcyBmOgogICAgICAgIGh0bWwgPSBmLnJlYWQoKQoKICAgICMgR2V0IHRoZSBwYXJhbWV0ZXIgZnJvbSB0aGUgcmVxdWVzdCBvYmplY3QKICAgIHBhcmFtID0gcmVxdWVzdC5hcmdzLmdldCgncGFyYW0nKQoKICAgIG5ld19odG1sID0gaHRtbC5yZXBsYWNlKCdvbGRfc3RyaW5nJywgcGFyYW0pCgogICAgcmVzcG9uc2UgPSBtYWtlX3Jlc3BvbnNlKG5ld19odG1sKQoKICAgIHJldHVybiByZXNwb25zZQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx62">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx62.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx62.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.7">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx62.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.10">make_response</span>
</div>
<div class="ltx_listingline" id="lstnumberx63">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="lstnumberx64">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx64.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.3">replace_string_in_template</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.4">():</span>
</div>
<div class="ltx_listingline" id="lstnumberx65">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.1"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx65.2" style="color:#9400D1;">’’</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx65.3" style="color:#9400D1;">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx66">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.2" style="color:#9400D1;">Task:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.4" style="color:#9400D1;">Replacea</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.6" style="color:#9400D1;">specific</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.8" style="color:#9400D1;">string</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.10" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.12" style="color:#9400D1;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.13" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.14" style="color:#9400D1;">HTML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.15" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.16" style="color:#9400D1;">template</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.17" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.18" style="color:#9400D1;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.19" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.20" style="color:#9400D1;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.21" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.22" style="color:#9400D1;">parameter</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.23" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.24" style="color:#9400D1;">passed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.25" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.26" style="color:#9400D1;">through</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.27" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.28" style="color:#9400D1;">request</span>
</div>
<div class="ltx_listingline" id="lstnumberx67">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.2" style="color:#9400D1;">Input:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.4" style="color:#9400D1;">None</span>
</div>
<div class="ltx_listingline" id="lstnumberx68">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.2" style="color:#9400D1;">Output:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.4" style="color:#9400D1;">HTML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.6" style="color:#9400D1;">template</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.8" style="color:#9400D1;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.10" style="color:#9400D1;">replaced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.12" style="color:#9400D1;">string</span>
</div>
<div class="ltx_listingline" id="lstnumberx69">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.2" style="color:#9400D1;">’</span><span class="ltx_text ltx_lst_string" id="lstnumberx69.3"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.4" style="color:#9400D1;">’’</span>
</div>
<div class="ltx_listingline" id="lstnumberx70">
<span class="ltx_tag ltx_tag_listingline">9</span>
</div>
<div class="ltx_listingline" id="lstnumberx71">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx71.2" style="color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx71.2.1"> </span>Get<span class="ltx_text ltx_lst_space" id="lstnumberx71.2.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx71.2.3"> </span>HTML<span class="ltx_text ltx_lst_space" id="lstnumberx71.2.4"> </span>template</span>
</div>
<div class="ltx_listingline" id="lstnumberx72">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.2">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.3"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx72.4" style="color:#FF00FF;">open</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.5">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx72.6" style="color:#9400D1;">’template.html’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.8"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx72.9" style="color:#9400D1;">’r’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.10">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.12">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.14">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.15">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx73">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.2">html</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.6">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.8">read</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.9">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx74">
<span class="ltx_tag ltx_tag_listingline">13</span>
</div>
<div class="ltx_listingline" id="lstnumberx75">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx75.2" style="color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.1"> </span>Get<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.3"> </span>parameter<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.4"> </span>from<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.5"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.6"> </span>request<span class="ltx_text ltx_lst_space" id="lstnumberx75.2.7"> </span>object</span>
</div>
<div class="ltx_listingline" id="lstnumberx76">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.2">param</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.6">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.8">args</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.10">get</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.11">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx76.12" style="color:#9400D1;">’param’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx76.13">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx77">
<span class="ltx_tag ltx_tag_listingline">16</span>
</div>
<div class="ltx_listingline" id="lstnumberx78">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.2">new_html</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.6">html</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.8">replace</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.9">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx78.10" style="color:#9400D1;">’old_string’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.13">param</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx78.14">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx79">
<span class="ltx_tag ltx_tag_listingline">18</span>
</div>
<div class="ltx_listingline" id="lstnumberx80">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.2">response</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.6">make_response</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.8">new_html</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.9">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx81">
<span class="ltx_tag ltx_tag_listingline">20</span>
</div>
<div class="ltx_listingline" id="lstnumberx82">
<span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx82.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.4">response</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.8">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.11.1.1" style="font-size:90%;">Figure 16</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.12.2" style="font-size:90%;">Fixed code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.13">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgcmVxdWVzdCwgbWFrZV9yZXNwb25zZWAsIGVzY2FwZWAKCmRlZiByZXBsYWNlX3N0cmluZ19pbl90ZW1wbGF0ZSgpOgogICAgJycnCiAgICBUYXNrOiBSZXBsYWNlIGEgc3BlY2lmaWMgc3RyaW5nIGluIGEgSFRNTCB0ZW1wbGF0ZSB3aXRoIGEgcGFyYW1ldGVyIHBhc3NlZCB0aHJvdWdoIHJlcXVlc3QKICAgIElucHV0OiBOb25lCiAgICBPdXRwdXQ6IEhUTUwgdGVtcGxhdGUgd2l0aCByZXBsYWNlZCBzdHJpbmcKICAgICcnJwoKICAgICMgR2V0IHRoZSBIVE1MIHRlbXBsYXRlCiAgICB3aXRoIG9wZW4oJ3RlbXBsYXRlLmh0bWwnLCAncicpIGFzIGY6CiAgICAgICAgaHRtbCA9IGYucmVhZCgpCgogICAgYHBhcmFtID0gZXNjYXBlKHJlcXVlc3QuYXJncy5nZXQoJ3BhcmFtJykpYAoKICAgIG5ld19odG1sID0gaHRtbC5yZXBsYWNlKCdvbGRfc3RyaW5nJywgcGFyYW0pCgogICAgcmVzcG9uc2UgPSBtYWtlX3Jlc3BvbnNlKG5ld19odG1sKQoKICAgIHJldHVybiByZXNwb25zZQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx83">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx83.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx83.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.7">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.10">make_response</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.11"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.12"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx83.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx83.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx84">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="lstnumberx85">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx85.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx85.3">replace_string_in_template</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx85.4">():</span>
</div>
<div class="ltx_listingline" id="lstnumberx86">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.1"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx86.2" style="color:#9400D1;">’’</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx86.3" style="color:#9400D1;">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx87">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.2" style="color:#9400D1;">Task:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.4" style="color:#9400D1;">Replace</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.6" style="color:#9400D1;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.8" style="color:#9400D1;">specific</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.10" style="color:#9400D1;">string</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.12" style="color:#9400D1;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.13" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.14" style="color:#9400D1;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.15" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.16" style="color:#9400D1;">HTML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.17" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.18" style="color:#9400D1;">template</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.19" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.20" style="color:#9400D1;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.21" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.22" style="color:#9400D1;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.23" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.24" style="color:#9400D1;">parameter</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.25" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.26" style="color:#9400D1;">passed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.27" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.28" style="color:#9400D1;">through</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.29" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx87.30" style="color:#9400D1;">request</span>
</div>
<div class="ltx_listingline" id="lstnumberx88">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.2" style="color:#9400D1;">Input:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.4" style="color:#9400D1;">None</span>
</div>
<div class="ltx_listingline" id="lstnumberx89">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.2" style="color:#9400D1;">Output:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.4" style="color:#9400D1;">HTML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.6" style="color:#9400D1;">template</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.8" style="color:#9400D1;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.10" style="color:#9400D1;">replaced</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx89.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx89.12" style="color:#9400D1;">string</span>
</div>
<div class="ltx_listingline" id="lstnumberx90">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.2" style="color:#9400D1;">’</span><span class="ltx_text ltx_lst_string" id="lstnumberx90.3"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.4" style="color:#9400D1;">’’</span>
</div>
<div class="ltx_listingline" id="lstnumberx91">
<span class="ltx_tag ltx_tag_listingline">9</span>
</div>
<div class="ltx_listingline" id="lstnumberx92">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx92.2" style="color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx92.2.1"> </span>Get<span class="ltx_text ltx_lst_space" id="lstnumberx92.2.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx92.2.3"> </span>HTML<span class="ltx_text ltx_lst_space" id="lstnumberx92.2.4"> </span>template</span>
</div>
<div class="ltx_listingline" id="lstnumberx93">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.2">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.3"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx93.4" style="color:#FF00FF;">open</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.5">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx93.6" style="color:#9400D1;">’template.html’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.8"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx93.9" style="color:#9400D1;">’r’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.10">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.12">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.14">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx93.15">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx94">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.2">html</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.6">f</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.8">read</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.9">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx95">
<span class="ltx_tag ltx_tag_listingline">13</span>
</div>
<div class="ltx_listingline" id="lstnumberx96">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx96.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx96.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx96.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx97">
<span class="ltx_tag ltx_tag_listingline">15</span>
</div>
<div class="ltx_listingline" id="lstnumberx98">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.2">new_html</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.6">html</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.8">replace</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.9">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx98.10" style="color:#9400D1;">’old_string’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.13">param</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.14">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx99">
<span class="ltx_tag ltx_tag_listingline">17</span>
</div>
<div class="ltx_listingline" id="lstnumberx100">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.2">response</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.6">make_response</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.8">new_html</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.9">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx101">
<span class="ltx_tag ltx_tag_listingline">19</span>
</div>
<div class="ltx_listingline" id="lstnumberx102">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx102.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.4">response</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.16.1.1" style="font-size:90%;">Figure 17</span>: </span><span class="ltx_text" id="A5.1.17.2" style="font-size:90%;">An example of Python code with a cross-site scripting vulnerability (CWE-079) alongside its corresponding fixed version. The code was fixed using our code synthesis pipeline. We highlighted the important changes in the fixed code.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="A5.1.1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.1.1">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.4.1.1" style="font-size:90%;">Figure 18</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.1.5.2" style="font-size:90%;">Vulnerable code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_C ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.1.6">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgppbnQgaXNQYWxpbmRyb21lKGNoYXIgKnN0cikgewogICAgaW50IGxlbmd0aCA9IHN0cmxlbihzdHIpOwogICAgZm9yKGludCBpID0gMDsgaTwgbGVuZ3RoLzI7IGkrKykgewogICAgICAgIGlmKHN0cltpXSAhPSBzdHJbbGVuZ3RoLWktMV0pIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIDE7Cn0KCmludCBtYWluKCkgewogICAgY2hhciBpbnB1dF9zdHJbMTAwXTsKICAgIHByaW50ZigiRW50ZXIgYSBzdHJpbmc6ICIpOwogICAgc2NhbmYoIiVzIiwgaW5wdXRfc3RyKTsKICAgIGlmKGlzUGFsaW5kcm9tZShpbnB1dF9zdHIpKSB7CiAgICAgICAgcHJpbnRmKCIlcyBpcyBhIHBhbGluZHJvbWUuXG4iLCBpbnB1dF9zdHIpOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludGYoIiVzIGlzIG5vdCBhIHBhbGluZHJvbWUuXG4iLCBpbnB1dF9zdHIpOwogICAgfQogICAgcmV0dXJuIDA7Cn0=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx103">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx103.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx103.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.4">stdio</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx103.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx103.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx104">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx104.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx104.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx104.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx104.4">stdlib</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx104.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx104.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx104.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx105">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx105.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.4">string</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx106">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx106.1" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.3">isPalindrome</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.4">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx106.5" style="color:#FF00FF;">char</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.7">*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.8">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.9">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.11">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx107">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx107.2" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.4">length</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.6">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.8">strlen</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.10">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx107.11">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx108">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx108.2" style="color:#FF00FF;">for</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.3">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx108.4" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.6">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.8">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.10">0;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.12">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.13">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.15">length</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.16">/2;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx108.18">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.19">++)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx108.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx108.21">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx109">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx109.2" style="color:#FF00FF;">if</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.4">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.5">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.6">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.7">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.9">!=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.11">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.12">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.13">length</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.14">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx109.15">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.16">-1])</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx109.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx109.18">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx110">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx110.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx110.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx110.4">0;</span>
</div>
<div class="ltx_listingline" id="lstnumberx111">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx111.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx111.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx112">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx112.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx113">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx113.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx113.4">1;</span>
</div>
<div class="ltx_listingline" id="lstnumberx114">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx114.1">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx115">
<span class="ltx_tag ltx_tag_listingline">13</span>
</div>
<div class="ltx_listingline" id="lstnumberx116">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx116.1" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx116.3">main</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx116.4">()</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx116.6">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx117">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx117.2" style="color:#FF00FF;">char</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx117.4">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx117.5">[100];</span>
</div>
<div class="ltx_listingline" id="lstnumberx118">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx118.4" style="color:#9400D1;">"Enter<span class="ltx_text ltx_lst_space" id="lstnumberx118.4.1"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx118.4.2"> </span>string:<span class="ltx_text ltx_lst_space" id="lstnumberx118.4.3"> </span>"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx118.5">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx119">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.2">scanf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx119.4" style="color:#9400D1;">"%s"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx119.7">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx119.8">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx120">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx120.2" style="color:#FF00FF;">if</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx120.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.4">isPalindrome</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx120.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.6">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx120.7">))</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx120.9">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx121">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx121.4" style="color:#9400D1;">"%s<span class="ltx_text ltx_lst_space" id="lstnumberx121.4.1"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx121.4.2"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx121.4.3"> </span>palindrome.\n"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx121.7">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx121.8">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx122">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx122.2">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.3"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx122.4" style="color:#FF00FF;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx122.6">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx123">
<span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx123.4" style="color:#9400D1;">"%s<span class="ltx_text ltx_lst_space" id="lstnumberx123.4.1"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx123.4.2"> </span>not<span class="ltx_text ltx_lst_space" id="lstnumberx123.4.3"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx123.4.4"> </span>palindrome.\n"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.7">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx123.8">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx124">
<span class="ltx_tag ltx_tag_listingline">22</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx124.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx124.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx125">
<span class="ltx_tag ltx_tag_listingline">23</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx125.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx125.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx125.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx125.4">0;</span>
</div>
<div class="ltx_listingline" id="lstnumberx126">
<span class="ltx_tag ltx_tag_listingline">24</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx126.1">}</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.1.7">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.10.1.1" style="font-size:90%;">Figure 19</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.1.11.2" style="font-size:90%;">Fixed code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_C ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.1.12">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgppbnQgaXNQYWxpbmRyb21lKGNoYXIgKnN0cikgewogICAgaW50IGxlbmd0aCA9IHN0cmxlbihzdHIpOwogICAgZm9yKGludCBpID0gMDsgaTwgbGVuZ3RoLzI7IGkrKykgewogICAgICAgIGlmKHN0cltpXSAhPSBzdHJbbGVuZ3RoLWktMV0pIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIDE7Cn0KCmludCBtYWluKCkgewogICAgY2hhciBpbnB1dF9zdHJbMTAwXTsKICAgIHByaW50ZigiRW50ZXIgYSBzdHJpbmc6ICIpOwogICAgYGlmKHNjYW5mKCIlOTlzIiwgaW5wdXRfc3RyKSA9PSAxKSB7YAogICAgICAgIGlmKGlzUGFsaW5kcm9tZShpbnB1dF9zdHIpKSB7CiAgICAgICAgICAgIHByaW50ZigiJXMgaXMgYSBwYWxpbmRyb21lLlxuIiwgaW5wdXRfc3RyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcmludGYoIiVzIGlzIG5vdCBhIHBhbGluZHJvbWUuXG4iLCBpbnB1dF9zdHIpOwogICAgICAgIH0KICAgIGB9IGVsc2Uge2AKICAgICAgICBgcHJpbnRmKCJGYWlsZWQgdG8gcmVhZCBpbnB1dC5cbiIpO2AKICAgIGB9YAogICAgcmV0dXJuIDA7Cn0=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx127">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx127.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx127.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx127.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx127.4">stdio</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx127.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx127.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx127.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx128">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx128.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.4">stdlib</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx128.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx129">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_directive ltx_lst_keyword ltx_font_typewriter" id="lstnumberx129.1" style="color:#FF00FF;">#include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx129.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.3">&lt;</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.4">string</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.5">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx129.6">h</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx129.7">&gt;</span>
</div>
<div class="ltx_listingline" id="lstnumberx130">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx130.1" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.3">isPalindrome</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.4">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx130.5" style="color:#FF00FF;">char</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.6"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.7">*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx130.8">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.9">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx130.10"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx130.11">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx131">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx131.2" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.4">length</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx131.6">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx131.7"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.8">strlen</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx131.9">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx131.10">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx131.11">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx132">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx132.2" style="color:#FF00FF;">for</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.3">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx132.4" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.6">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.8">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.9"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.10">0;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.12">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.13">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.15">length</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.16">/2;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx132.18">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.19">++)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx132.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx132.21">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx133">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx133.2" style="color:#FF00FF;">if</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.4">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.5">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.6">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.7">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.9">!=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.11">str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.12">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.13">length</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.14">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx133.15">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.16">-1])</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx133.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx133.18">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx134">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx134.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx134.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx134.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx134.4">0;</span>
</div>
<div class="ltx_listingline" id="lstnumberx135">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx135.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx135.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx136">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx136.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx136.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx137">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx137.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx137.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx137.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx137.4">1;</span>
</div>
<div class="ltx_listingline" id="lstnumberx138">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx138.1">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx139">
<span class="ltx_tag ltx_tag_listingline">13</span>
</div>
<div class="ltx_listingline" id="lstnumberx140">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx140.1" style="color:#FF00FF;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx140.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx140.3">main</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx140.4">()</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx140.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx140.6">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx141">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx141.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx141.2" style="color:#FF00FF;">char</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx141.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx141.4">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx141.5">[100];</span>
</div>
<div class="ltx_listingline" id="lstnumberx142">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx142.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx142.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx142.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx142.4" style="color:#9400D1;">"Enter<span class="ltx_text ltx_lst_space" id="lstnumberx142.4.1"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx142.4.2"> </span>string:<span class="ltx_text ltx_lst_space" id="lstnumberx142.4.3"> </span>"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx142.5">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx143">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx143.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx143.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx143.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx143.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx144">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx144.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx144.2" style="color:#FF00FF;">if</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx144.3">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx144.4">isPalindrome</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx144.5">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx144.6">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx144.7">))</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx144.8"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx144.9">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx145">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx145.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx145.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx145.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx145.4" style="color:#9400D1;">"%s<span class="ltx_text ltx_lst_space" id="lstnumberx145.4.1"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx145.4.2"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx145.4.3"> </span>palindrome.\n"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx145.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx145.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx145.7">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx145.8">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx146">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx146.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx146.2">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx146.3"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx146.4" style="color:#FF00FF;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx146.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx146.6">{</span>
</div>
<div class="ltx_listingline" id="lstnumberx147">
<span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx147.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx147.2">printf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx147.3">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx147.4" style="color:#9400D1;">"%s<span class="ltx_text ltx_lst_space" id="lstnumberx147.4.1"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx147.4.2"> </span>not<span class="ltx_text ltx_lst_space" id="lstnumberx147.4.3"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx147.4.4"> </span>palindrome.\n"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx147.5">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx147.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx147.7">input_str</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx147.8">);</span>
</div>
<div class="ltx_listingline" id="lstnumberx148">
<span class="ltx_tag ltx_tag_listingline">22</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx148.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx148.2">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx149">
<span class="ltx_tag ltx_tag_listingline">23</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx149.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx149.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx149.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx149.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx149.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx150">
<span class="ltx_tag ltx_tag_listingline">24</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx150.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx150.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx150.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx150.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx150.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx151">
<span class="ltx_tag ltx_tag_listingline">25</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx151.1"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx151.2"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx151.3"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx151.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx151.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx152">
<span class="ltx_tag ltx_tag_listingline">26</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx152.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx152.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx152.4">0;</span>
</div>
<div class="ltx_listingline" id="lstnumberx153">
<span class="ltx_tag ltx_tag_listingline">27</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx153.1">}</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.15.1.1" style="font-size:90%;">Figure 20</span>: </span><span class="ltx_text" id="A5.1.1.16.2" style="font-size:90%;">An example of C code with an out-of-bound write vulnerability (CWE-787) alongside its corresponding fixed version. The code was fixed using our code synthesis pipeline. We highlighted the important changes in the fixed code.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="A5.1.1.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.1.fig1.1">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.fig1.4.1.1" style="font-size:90%;">Figure 21</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.1.fig1.5.2" style="font-size:90%;">Input code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.1.fig1.6">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QKaW1wb3J0IGx4bWwuZXRyZWUKYXBwID0gRmxhc2soX19uYW1lX18pCkBhcHAucG9zdCgiL2NvbnZlcnRfeG1sIikKZGVmIGNvbnZlcnRfeG1sKCk6CiAgICAnJycKICAgIFJlY2VpdmUgdGhlIGRhdGEgZnJvbSByZXF1ZXN0LCBjb252ZXJ0IGl0IHRvIFhNTCBkb2N1bWVudCBhbmQgdGhlbiBzdHJpbmdpZnkgdGhpcyBkb2N1bWVudAogICAgJycnCiAgICB4bWxfc3JjID0gcmVxdWVzdC5nZXRfZGF0YQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx154">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx154.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx154.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.7">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx154.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx154.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx154.10">request</span>
</div>
<div class="ltx_listingline" id="lstnumberx155">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx155.1" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx155.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.3">lxml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx155.4">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx155.5">etree</span>
</div>
<div class="ltx_listingline" id="lstnumberx156">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.1">app</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.3">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx156.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.5">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx156.7">__name__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx156.8">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx157">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text" id="lstnumberx157.1"></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.2">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.3">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx157.4">post</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.5">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx157.6" style="color:#9400D1;">"/convert_xml"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx157.7">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx158">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx158.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx158.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx158.3">convert_xml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx158.4">():</span>
</div>
<div class="ltx_listingline" id="lstnumberx159">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx159.1"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx159.2" style="color:#9400D1;">’’</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx159.3" style="color:#9400D1;">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx160">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.2" style="color:#9400D1;">Receive</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.4" style="color:#9400D1;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.6" style="color:#9400D1;">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.8" style="color:#9400D1;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.10" style="color:#9400D1;">request,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.12" style="color:#9400D1;">convert</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.13" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.14" style="color:#9400D1;">it</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.15" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.16" style="color:#9400D1;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.17" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.18" style="color:#9400D1;">XML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.19" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.20" style="color:#9400D1;">document</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.21" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.22" style="color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.23" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.24" style="color:#9400D1;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.25" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.26" style="color:#9400D1;">stringify</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.27" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.28" style="color:#9400D1;">this</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx160.29" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx160.30" style="color:#9400D1;">document</span>
</div>
<div class="ltx_listingline" id="lstnumberx161">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx161.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.2" style="color:#9400D1;">’</span><span class="ltx_text ltx_lst_string" id="lstnumberx161.3"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx161.4" style="color:#9400D1;">’’</span>
</div>
<div class="ltx_listingline" id="lstnumberx162">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.2">xml_src</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx162.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx162.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.6">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx162.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx162.8">get_data</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="A5.1.1.fig1.7">{sublstlisting}</span></div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.fig1.10.1.1" style="font-size:90%;">Figure 22</span>: </span><span class="ltx_text ltx_framed ltx_framed_underline" id="A5.1.1.fig1.11.2" style="font-size:90%;">Completed code</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listing ltx_figure_panel ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="A5.1.1.fig1.12">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QKaW1wb3J0IGx4bWwuZXRyZWUKYGZyb20gbHhtbC5ldHJlZSBpbXBvcnQgWE1MUGFyc2VyYAphcHAgPSBGbGFzayhfX25hbWVfXykKQGFwcC5wb3N0KCIvY29udmVydF94bWwiKQpkZWYgY29udmVydF94bWwoKToKICAgICcnJwogICAgUmVjZWl2ZSB0aGUgZGF0YSBmcm9tIHJlcXVlc3QsIGNvbnZlcnQgaXQgdG8gWE1MIGRvY3VtZW50IGFuZCB0aGVuIHN0cmluZ2lmeSB0aGlzIGRvY3VtZW50CiAgICAnJycKICAgIHhtbF9zcmMgPSByZXF1ZXN0LmdldF9kYXRhKCkKICAgIHBhcnNlciA9IFhNTFBhcnNlcihyZXNvbHZlX2VudGl0aWVzPUZhbHNlKQogICAgeG1sX2RvYyA9IGx4bWwuZXRyZWUuZnJvbXN0cmluZyh4bWxfc3JjLCBwYXJzZXI9cGFyc2VyKQogICAgeG1sX3N0cmluZyA9IGx4bWwuZXRyZWUudG9zdHJpbmcoeG1sX2RvYywgZW5jb2Rpbmc9J3VuaWNvZGUnKQogICAgcmV0dXJuIHhtbF9zdHJpbmc=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx163">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx163.1" style="color:#FF00FF;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.3">flask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx163.5" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.6"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.7">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx163.8">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx163.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx163.10">request</span>
</div>
<div class="ltx_listingline" id="lstnumberx164">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx164.1" style="color:#FF00FF;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx164.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.3">lxml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx164.4">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx164.5">etree</span>
</div>
<div class="ltx_listingline" id="lstnumberx165">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx165.1"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx165.2"> </span><svg class="ltx_picture" height="192.18" id="lstnumberx165.pic1" overflow="visible" version="1.1" width="199.56"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,192.18) matrix(1 0 0 -1 0 0)"><g fill="#FFD9B3"><path d="M 195.41 192.18 L 4.15 192.18 C 1.86 192.18 0 190.32 0 188.03 L 0 4.15 C 0 1.86 1.86 0 4.15 0 L 195.41 0 C 197.7 0 199.56 1.86 199.56 4.15 L 199.56 188.03 C 199.56 190.32 197.7 192.18 195.41 192.18 Z M 0 0" style="stroke:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.38 0)"><foreignobject height="1.38" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="0"><span class="ltx_text" id="lstnumberx165.pic1.1.1.1.1.1" style="position:relative; bottom:1.0pt;"></span></foreignobject><g class="ltx_nestedsvg" color="#FFFFFF" transform="matrix(1 0 0 1 0 0)"><defs><lineargradient gradienttransform="rotate(90)" id="pgfsh12"><stop offset="0.0" stop-color="#000000"></stop><stop offset="0.24998" stop-color="#000000"></stop><stop offset="0.75002" stop-color="#808080"></stop><stop offset="1.0" stop-color="#808080"></stop></lineargradient></defs><rect height="138.89" style="fill:url(#pgfsh12);stroke:none" width="138.89"></rect></g></g></g></svg>
</div>
<div class="ltx_listingline" id="lstnumberx166">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.1">app</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.2"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.3">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx166.4"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.5">Flask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.6">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx166.7">__name__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx166.8">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx167">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text" id="lstnumberx167.1"></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.2">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.3">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx167.4">post</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.5">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx167.6" style="color:#9400D1;">"/convert_xml"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx167.7">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx168">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx168.1" style="color:#FF00FF;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx168.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx168.3">convert_xml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx168.4">():</span>
</div>
<div class="ltx_listingline" id="lstnumberx169">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx169.1"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx169.2" style="color:#9400D1;">’’</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx169.3" style="color:#9400D1;">’</span>
</div>
<div class="ltx_listingline" id="lstnumberx170">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.2" style="color:#9400D1;">Receive</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.3" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.4" style="color:#9400D1;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.5" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.6" style="color:#9400D1;">data</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.7" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.8" style="color:#9400D1;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.9" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.10" style="color:#9400D1;">request,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.11" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.12" style="color:#9400D1;">convert</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.13" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.14" style="color:#9400D1;">it</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.15" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.16" style="color:#9400D1;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.17" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.18" style="color:#9400D1;">XML</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.19" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.20" style="color:#9400D1;">document</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.21" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.22" style="color:#9400D1;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.23" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.24" style="color:#9400D1;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.25" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.26" style="color:#9400D1;">stringify</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.27" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.28" style="color:#9400D1;">this</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx170.29" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx170.30" style="color:#9400D1;">document</span>
</div>
<div class="ltx_listingline" id="lstnumberx171">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx171.1" style="color:#9400D1;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx171.2" style="color:#9400D1;">’</span><span class="ltx_text ltx_lst_string" id="lstnumberx171.3"></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx171.4" style="color:#9400D1;">’’</span>
</div>
<div class="ltx_listingline" id="lstnumberx172">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.2">xml_src</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx172.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.6">request</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx172.8">get_data</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx172.9">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx173">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.2">parser</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx173.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.6">XMLParser</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.8">resolve_entities</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.9">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx173.10">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx173.11">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx174">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.2">xml_doc</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.6">lxml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.8">etree</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.10">fromstring</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.12">xml_src</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.13">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx174.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.15">parser</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.16">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx174.17">parser</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx174.18">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx175">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.2">xml_string</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.6">lxml</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.7">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.8">etree</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.9">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.10">tostring</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.11">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.12">xml_doc</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.13">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx175.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx175.15">encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.16">=</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx175.17" style="color:#9400D1;">’unicode’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx175.18">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx176">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx176.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx176.2" style="color:#FF00FF;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx176.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx176.4">xml_string</span>
</div>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_font_typewriter"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text ltx_font_serif" id="A5.1.1.fig1.18.1.1" style="font-size:90%;">Figure 23</span>: </span><span class="ltx_text" id="A5.1.1.fig1.19.2" style="font-size:90%;">An example of completing a given input code using our two-step generation approach. (a) The original CodeLMSec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.06446v1#bib.bib32" title="">32</a>]</cite> prompt for CWE-611. (b) The completed code after conditioning the updated prompt on our fine-tuned model. The differences among the included libraries are highlighted.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_pagination ltx_figure_panel ltx_role_newpage"></div>
</div>
</div>
</figure>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
</section>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Sep 10 12:03:44 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
