<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.14604] Green Federated Learning</title><meta property="og:description" content="The rapid progress of AI is fueled by increasingly large and computationally intensive machine learning models and datasets. As a consequence, the amount of computing used in training state-of-the-art models is increas…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Green Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Green Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.14604">

<!--Generated on Thu Feb 29 17:40:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning,  Green AI">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Green Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ashkan Yousefpour
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shen Guo
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ashish Shenoy
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sayan Ghosh
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pierre Stock
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kiwan Maeng
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Schalk-Willem Krüger
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Michael Rabbat
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Carole-Jean Wu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ilya Mironov
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">The rapid progress of AI is fueled by increasingly large and computationally intensive machine learning models and datasets. As a consequence, the amount of computing used in training state-of-the-art models is increasing exponentially (doubling every 10 months between 2015 and 2022), resulting in a large carbon footprint. Federated Learning (FL) — a collaborative machine learning technique for training a centralized model using data of decentralized entities — can also be resource-intensive and have a significant carbon footprint, particularly when deployed at scale. Unlike centralized AI that can reliably tap into renewables at strategically placed data centers, cross-device FL may leverage as many as hundreds of millions of globally distributed end-user devices with diverse energy sources. Green AI is a novel and important research area where carbon footprint is regarded as an evaluation criterion for AI, alongside accuracy, convergence speed, and other metrics.</p>
<p id="id2.id2" class="ltx_p">In this paper, we propose the concept of Green FL, which involves optimizing FL parameters and making design choices to minimize carbon emissions consistent with competitive performance and training time. The contributions of this work are two-fold. First, we adopt a data-driven approach to quantify the carbon emissions of FL by directly measuring real-world at-scale FL tasks running on millions of phones. Second, we present challenges, guidelines, and lessons from studying the trade-off between energy efficiency, performance, and time-to-train in a production FL system. Our findings offer valuable insights into how FL can reduce its carbon footprint, providing a foundation for future research in the area of Green AI.</p>
</div>
<div class="ltx_keywords">Federated Learning, Green AI
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">Federated learning</em> (FL) is a distributed learning paradigm where a large number of client devices, such as smartphones, collectively train a machine learning model using data located on client devices.
User data remains on client devices, and only updates to the model are aggregated within a centralized model at the server.
FL has emerged as a practical privacy-enhancing technology for on-device learning <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>.
Many real-world models have been trained using FL, including language models for predictive keyboards on Google Pixel, Apple’s iOS, and Meta’s Quest <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib61" title="" class="ltx_ref">2018</a>; Paulik et al., <a href="#bib.bib42" title="" class="ltx_ref">2021</a>; <a href="#bib.bib19" title="" class="ltx_ref">Hamilton, </a>)</cite>, Siri personalization <cite class="ltx_cite ltx_citemacro_citep">(Hao, <a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite>, advertising, messaging, and search on LinkedIn <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">While FL — when coupled with technologies such as secure aggregation and differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Bonawitz et al., <a href="#bib.bib8" title="" class="ltx_ref">2016</a>; Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>; McMahan et al., <a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite> — can be a practical solution to enhance user privacy, the training process in FL can result in non-negligible carbon emissions.
A recent study has shown that training a model with FL can produce as much as 80 kilograms of carbon dioxide equivalent (CO<sub id="S1.p2.1.1" class="ltx_sub">2</sub>e), exceeding that of training a higher capacity model, a large transformer, in the centralized training setting using AI accelerators <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>)</cite>. The relative inefficiency is attributable to several factors, including the overhead of training using a large collection of highly heterogeneous client hardware, additional cost for communication, and often slower convergence.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated Learning’s global carbon footprint is expected to increase as the industry increasingly adopts FL and more machine learning tasks shift away from the centralized setting.
This is especially concerning since renewable sources of electricity may not be available in all locations, making Green FL a challenging goal to achieve <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>; Qiu et al., <a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>. <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">Taking advantage of opportunities for efficiency optimization in FL is of paramount importance to make on-device learning greener.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Recently, there has been growing interest in quantifying and reducing the carbon emissions of machine learning (ML) training and inference in the datacenter setting <cite class="ltx_cite ltx_citemacro_citep">(Dodge et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Strubell et al., <a href="#bib.bib53" title="" class="ltx_ref">2020</a>; Patterson et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>; Lacoste et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Naidu et al., <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>. However, the carbon footprint of Federated Learning (FL) and the factors that contribute to carbon efficiency in FL have yet to be thoroughly explored. Prior works have offer preliminary findings, either quantified the carbon effects of FL only in a simulation setting or with several simplifying assumptions <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al., <a href="#bib.bib45" title="" class="ltx_ref">2021</a>; Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>)</cite>, offering only a partial picture.
These works focused on measurements and opportunity sizing, and restrained from exploring dimensions of the design space toward realizing Green FL.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.14604/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="437" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Carbon emissions of (synchronous) FL: the more rounds is required to reach a target accuracy and the higher the number of users active in training (i.e., <span id="S1.F1.2.1" class="ltx_text ltx_font_italic">concurrency</span>), the higher is the carbon emissions. Each point represents a training run with a different hyper-parameter (grouped by concurrency with marker colors and symbols). The graph shows the carbon emissions (Y axis) and the rounds to reach a target accuracy (X axis) for a language modeling FL task.</figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">This paper presents a holistic carbon footprint analysis of a real-world FL task running on <span id="S1.p5.1.1" class="ltx_text ltx_font_smallcaps">Papaya</span> <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>, a production FL system that operates on hundreds of millions of clients. This is the first study that provides a comprehensive view of Green FL by characterizing the emission profile of all major components involved, including the emissions from clients, the server, and the communication channels in between. To this end, we instrument and profile all major components of the FL system.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">An important finding of our analysis is that <span id="S1.p6.1.1" class="ltx_text ltx_font_bold">the carbon footprint of an FL task is highly correlated (among all parameters and artifacts) with the product of its running time and the number of users active in training (i.e., <span id="S1.p6.1.1.1" class="ltx_text ltx_font_italic">concurrency</span>)</span>. We discuss this in more detail in Section <a href="#S5" title="5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We also provide an in-depth analysis of the multi-criterion optimization between carbon emissions, time to convergence, and training error.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> presents results of measuring a production FL task for a range of hyperparameters. We can see that the number of rounds and concurrency are both positively correlated with the carbon footprint, and keeping one of these parameters constant, the relationship is nearly linear (see, for instance, the line corresponding to concurrency set to 200). These points become more evident throughout the paper. Other findings are the following:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.2" class="ltx_p">Compute on client devices, and the communication between the clients and the server are responsible for the majority of FL’s overall carbon emissions (97%). The carbon footprint attributable to the server-side computation is small (<math id="S1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S1.I1.i1.p1.1.m1.1a"><mo id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><csymbol cd="latexml" id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">\sim</annotation></semantics></math>1–2%), while client computation is almost half of the contribution (<math id="S1.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S1.I1.i1.p1.2.m2.1a"><mo id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><csymbol cd="latexml" id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">\sim</annotation></semantics></math>46–50%). Upload and download networking costs are approximately 27–29% and 22–24%, respectively.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Asynchronous FL (FedBuff <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>) is faster than synchronous FL (FedAvg) as it advances the model more frequently in the face of stragglers, but it comes at the cost of higher carbon emissions.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Different training configurations that achieve similar model accuracy can have substantially different carbon impact, by up to 200<math id="S1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.I1.i3.p1.1.m1.1a"><mo id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><times id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">\times</annotation></semantics></math>, demonstrating the importance of hyper-parameter optimization.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">To minimize the carbon footprint of FL, reduce training time, and achieve a high model quality, FL developers must focus on lowering the training time, e.g., through the right choice of the optimizer, learning rates, and batch sizes, while keeping the concurrency small.</p>
</div>
</li>
<li id="S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i5.p1" class="ltx_para">
<p id="S1.I1.i5.p1.2" class="ltx_p">Carbon footprint of a single language modeling FL task running for a few days at scale is of the order of 5–20 kg CO<sub id="S1.I1.i5.p1.2.1" class="ltx_sub">2</sub>e, similar to that of producing 1 kilogram of chicken <cite class="ltx_cite ltx_citemacro_citep">(Ritchie, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>. In practice, we expect model exploration, hyperparameter tuning, and incremental re-training to increase this multiple-fold (in the order of several tons of CO<sub id="S1.I1.i5.p1.2.2" class="ltx_sub">2</sub>e).</p>
</div>
</li>
</ul>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Contributions</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p">We believe that distilling the complicated design space of the Green FL into several intuitive rules of thumb constitutes a valuable contribution. The rules and findings, even though may appear straight-forward in retrospect, are actionable and validated on a production platform. To the best of our knowledge, this is the first study to measure carbon emissions at scale for an industrial FL system across a range of hyperparameters. Before this study, there had been only intuitions and hypotheses. Our findings can help identify challenges and encourage further research towards the development of more sustainable and environmentally friendly FL systems.
Our main contributions can be summarized as follows:</p>
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p">We present a comprehensive evaluation of the carbon emission of a full production FL system stack by presenting the emission profile of all major components involved, including the emissions from clients, the server, and the communication channels in between. No prior work has done a carbon measurement study on a real-world FL production system at scale.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">Our empirical observations lead us to propose a set of key findings for Green FL, which identify the levers that have the most significant influence on the carbon footprint of FL.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.1" class="ltx_p">We propose a model that predicts the carbon footprint of an FL task prior to actual deployment.</p>
</div>
</li>
<li id="S1.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i4.p1" class="ltx_para">
<p id="S1.I2.i4.p1.1" class="ltx_p">We show that using our recipe for Green FL, we can reduce the carbon footprint of FL training pipelines by as much as 200<math id="S1.I2.i4.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.I2.i4.p1.1.m1.1a"><mo id="S1.I2.i4.p1.1.m1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.1.m1.1b"><times id="S1.I2.i4.p1.1.m1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i4.p1.1.m1.1c">\times</annotation></semantics></math> while achieving similar model quality performance.</p>
</div>
</li>
</ul>
</div>
<section id="S1.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Disclaimer:</h4>

<div id="S1.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S1.SS1.SSS0.Px1.p1.1" class="ltx_p">This study presents an estimation of carbon emissions based on other assumptions; measuring the actual energy and carbon emissions is indeed harder. Moreover, we only consider a production language modeling FL task. Given the state of FL deployment, we foresee language models to be responsible for a disproportionately large share of the total carbon footprint. While we believe the overall trend of the results should hold for other modalities or models, small variation in the findings and results may be expected.</p>
</div>
</section>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Why Green Federated Learning?</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Climate change is a pressing global issue believed to be caused by human activities such as burning fossil fuels, deforestation, and agriculture, which all emit greenhouse gasses (e.g., CO<sub id="S2.p1.1.1" class="ltx_sub">2</sub> and methane). Climate change has significant impacts on human communities, as well as on ecosystems and biodiversity. Mitigating harmful emissions is essential in addressing climate change <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib54" title="" class="ltx_ref">United Nations, </a>; IPCC, <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Green AI is the use of AI techniques and technologies in a way to reduce their environmental impact and promote sustainability in AI <cite class="ltx_cite ltx_citemacro_citep">(Schwartz et al., <a href="#bib.bib51" title="" class="ltx_ref">2020</a>; Rolnick et al., <a href="#bib.bib49" title="" class="ltx_ref">2022</a>)</cite>. Some examples are developing more energy-efficient algorithms and hardware, and reducing the carbon footprint of data centers. With the rapid growth of AI (e.g., the amount of compute for training state-of-the-art models doubled every 10 months between 2015 and 2022 <cite class="ltx_cite ltx_citemacro_citep">(Sevilla et al., <a href="#bib.bib52" title="" class="ltx_ref">2022</a>)</cite>), it is imperative to understand the environmental implications, challenges, and opportunities of AI. By making AI more sustainable, we can reduce its environmental impact while also reaping the benefits that AI has to offer.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">A related line of work addresses communication efficiency or model compression for FL  <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al., <a href="#bib.bib30" title="" class="ltx_ref">2016</a>; Vogels et al., <a href="#bib.bib56" title="" class="ltx_ref">2019</a>; Jiang et al., <a href="#bib.bib24" title="" class="ltx_ref">2019</a>; Rothchild et al., <a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>. Historically, the primary objectives of these techniques have been cost reduction and not carbon emission savings per se – closely related but different. Quantifying and reducing the carbon emissions of FL is our primary objective.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Although one might argue that renewable energy can power centralized AI systems <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib17" title="" class="ltx_ref">Google, </a>; Meta, <a href="#bib.bib35" title="" class="ltx_ref">b</a>; <a href="#bib.bib3" title="" class="ltx_ref">Amazon, </a>)</cite>, providing FL with renewable energy is inherently more challenging, as end-user devices are tied to their local energy mixes whose carbon footprint must be taken into account. In this paper we set out to study the problem of Green FL, present challenges, guidelines, and the lessons learned from realizing the trade-off between energy efficiency, performance, and time to train in a production FL system.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Industry-Scale Federated Learning</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Learning Platform</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our company’s production FL stack is built based on <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">Papaya</span> <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>, a recently proposed system for running federated learning and analytics tasks across millions of user devices. <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">Papaya</span> comprises two major subsystems: a server application that runs on a data center server and a client application that runs on end-user devices. In this study, we set out to measure the energy consumption and carbon footprint of both client-side and server-side resources used during training of a model in the federated learning system <span id="S3.SS1.p1.1.3" class="ltx_text ltx_font_smallcaps">Papaya</span>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The overall architecture of <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_smallcaps">Papaya</span> is presented in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Federated Learning Platform ‣ 3 Industry-Scale Federated Learning ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The <span id="S3.SS1.p2.1.2" class="ltx_text ltx_font_smallcaps">Papaya</span> server has three main components: Coordinator, Selector, and Aggregator. There is one Coordinator, and the number of Selectors and Aggregators scales elastically based on the workload demand. The Coordinator assigns FL tasks to Aggregators based on load and assigns clients to tasks based on demand.
Selectors report available clients and route clients to their assigned aggregator.
Aggregators execute the client protocol, aggregate updates, and optimize the FL model. Regarding energy and carbon footprint, Aggregators and Selectors are responsible for the majority of processing and heavy lifting. The Coordinator is responsible for assigning FL tasks to Aggregators and clients to FL tasks, and centralized coordination.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2303.14604/assets/figures/system-peerreview.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="389" height="439" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall architecture of our production FL stack, based on <span id="S3.F2.2.1" class="ltx_text ltx_font_smallcaps">Papaya</span> <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>.</figcaption>
</figure>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Concurrency vs. aggregation goal.</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p1.1" class="ltx_p">A device must meet a defined set of criteria to participate in FL training. Eligible devices report their availability to the Coordinator, which subsequently selects a subset of available devices for training. <em id="S3.SS1.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">Concurrency</em> is the maximum number of clients that can train simultaneously. The <em id="S3.SS1.SSS0.Px1.p1.1.2" class="ltx_emph ltx_font_italic">aggregation goal</em> denotes the minimum number of client responses that must be received at the server before it updates the model.</p>
</div>
<div id="S3.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p2.1" class="ltx_p">In this study, for synchronous FL, the baseline implementation is FedAvg, whereas for asynchronous FL, it is FedBuff <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. In either settings, Adam is used as the server optimizer. In <em id="S3.SS1.SSS0.Px1.p2.1.1" class="ltx_emph ltx_font_italic">asynchronous</em> FL, based on the FedBuff protocol, a new device is immediately selected for training as soon as the server receives a client response. Therefore, the number of devices training at any given time essentially equals to the concurrency. Once the aggregation goal is met, the server model is updated, and clients selected thereafter receive the updated model. However, clients chosen earlier may still be training using the previous version of the server model, leading to a phenomenon called <em id="S3.SS1.SSS0.Px1.p2.1.2" class="ltx_emph ltx_font_italic">staleness</em> <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. A 4-min timeout is imposed to limit the client training time and removing stragglers <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S3.SS1.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p3.1" class="ltx_p">In contrast, <em id="S3.SS1.SSS0.Px1.p3.1.1" class="ltx_emph ltx_font_italic">synchronous</em> FL <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite> proceeds in discrete rounds. At the beginning of a round, the server distributes the same model to a number of devices equal to the concurrency. At the end of the round, the server updates its model if it has received updates from at least as many users as the aggregation goal; it is worth noting that users may drop out during the round due to various reasons (such as the device no longer being idle or connected to Wi-Fi). In synchronous FL, the concurrency is also referred to as <em id="S3.SS1.SSS0.Px1.p3.1.2" class="ltx_emph ltx_font_italic">users per round</em>, and it is usually greater than the aggregation goal (a process called “over-selection”) to account for the possibility of devices dropping out mid-round <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Large-scale FL Task: Language Modeling</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In all experiments for this study, we train a character-aware language model for a next word prediction task, similar to Kim et al. <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite>. This model computes the probability of a sequence of words <math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="S=w_{1},\dots,w_{T}" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.3.3.4" xref="S3.SS2.p1.1.m1.3.3.4.cmml">S</mi><mo id="S3.SS2.p1.1.m1.3.3.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml"><msub id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.3.3.2.2.4" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml">w</mi><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">T</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><apply id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3"><eq id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3"></eq><ci id="S3.SS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.4">𝑆</ci><list id="S3.SS2.p1.1.m1.3.3.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2">𝑤</ci><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">S=w_{1},\dots,w_{T}</annotation></semantics></math> autoregressively as:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.2" class="ltx_Math" alttext="p(S)=\prod_{i=1}^{T}{p(w_{i}|w_{&lt;i})}." display="block"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.3" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.1.1.3.1" xref="S3.Ex1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1.3.3.2" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.3.3.2.1" xref="S3.Ex1.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">S</mi><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.3.3.2.2" xref="S3.Ex1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.Ex1.m1.2.2.1.1.2" xref="S3.Ex1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.cmml"><munderover id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.2.2.1.1.1.2.2.2" xref="S3.Ex1.m1.2.2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.2.2.3" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.2.2.3.2" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.2.2.1.1.1.2.2.3.1" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.2.2.1.1.1.2.2.3.3" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.2.2.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S3.Ex1.m1.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">w</mi><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex1.m1.2.2.1.2" xref="S3.Ex1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1"><eq id="S3.Ex1.m1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.2"></eq><apply id="S3.Ex1.m1.2.2.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3"><times id="S3.Ex1.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.3.1"></times><ci id="S3.Ex1.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.3.2">𝑝</ci><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑆</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><apply id="S3.Ex1.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.2">product</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3"><eq id="S3.Ex1.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex1.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.2.2.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.3">𝑇</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1"><times id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2"></times><ci id="S3.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3">𝑝</ci><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.2">𝑤</ci><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3"><lt id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">p(S)=\prod_{i=1}^{T}{p(w_{i}|w_{&lt;i})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.2" class="ltx_p">More specifically, we use a character-level CNN with multiple filters, followed by a pooling layer that computes the final word embeddings. These are then encoded using a standard LSTM-based neural network that captures the sequential information in the input sequence. Finally, we use an MLP decoder followed by a <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_typewriter">softmax</span> layer that converts the word-level outputs into final word-level probabilities over a fixed vocabulary. Using the notation where</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">i</annotation></semantics></math> denotes the length of the sequence seen so far,</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.2" class="ltx_p"><math id="S3.I1.i2.p1.1.m1.10" class="ltx_Math" alttext="x_{i,1},x_{i,2},\dots,x_{i,L_{i}}" display="inline"><semantics id="S3.I1.i2.p1.1.m1.10a"><mrow id="S3.I1.i2.p1.1.m1.10.10.3" xref="S3.I1.i2.p1.1.m1.10.10.4.cmml"><msub id="S3.I1.i2.p1.1.m1.8.8.1.1" xref="S3.I1.i2.p1.1.m1.8.8.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.8.8.1.1.2" xref="S3.I1.i2.p1.1.m1.8.8.1.1.2.cmml">x</mi><mrow id="S3.I1.i2.p1.1.m1.2.2.2.4" xref="S3.I1.i2.p1.1.m1.2.2.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.1.m1.2.2.2.4.1" xref="S3.I1.i2.p1.1.m1.2.2.2.3.cmml">,</mo><mn id="S3.I1.i2.p1.1.m1.2.2.2.2" xref="S3.I1.i2.p1.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.I1.i2.p1.1.m1.10.10.3.4" xref="S3.I1.i2.p1.1.m1.10.10.4.cmml">,</mo><msub id="S3.I1.i2.p1.1.m1.9.9.2.2" xref="S3.I1.i2.p1.1.m1.9.9.2.2.cmml"><mi id="S3.I1.i2.p1.1.m1.9.9.2.2.2" xref="S3.I1.i2.p1.1.m1.9.9.2.2.2.cmml">x</mi><mrow id="S3.I1.i2.p1.1.m1.4.4.2.4" xref="S3.I1.i2.p1.1.m1.4.4.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.3.3.1.1" xref="S3.I1.i2.p1.1.m1.3.3.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.1.m1.4.4.2.4.1" xref="S3.I1.i2.p1.1.m1.4.4.2.3.cmml">,</mo><mn id="S3.I1.i2.p1.1.m1.4.4.2.2" xref="S3.I1.i2.p1.1.m1.4.4.2.2.cmml">2</mn></mrow></msub><mo id="S3.I1.i2.p1.1.m1.10.10.3.5" xref="S3.I1.i2.p1.1.m1.10.10.4.cmml">,</mo><mi mathvariant="normal" id="S3.I1.i2.p1.1.m1.7.7" xref="S3.I1.i2.p1.1.m1.7.7.cmml">…</mi><mo id="S3.I1.i2.p1.1.m1.10.10.3.6" xref="S3.I1.i2.p1.1.m1.10.10.4.cmml">,</mo><msub id="S3.I1.i2.p1.1.m1.10.10.3.3" xref="S3.I1.i2.p1.1.m1.10.10.3.3.cmml"><mi id="S3.I1.i2.p1.1.m1.10.10.3.3.2" xref="S3.I1.i2.p1.1.m1.10.10.3.3.2.cmml">x</mi><mrow id="S3.I1.i2.p1.1.m1.6.6.2.2" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.5.5.1.1" xref="S3.I1.i2.p1.1.m1.5.5.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.1.m1.6.6.2.2.2" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml">,</mo><msub id="S3.I1.i2.p1.1.m1.6.6.2.2.1" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1.cmml"><mi id="S3.I1.i2.p1.1.m1.6.6.2.2.1.2" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1.2.cmml">L</mi><mi id="S3.I1.i2.p1.1.m1.6.6.2.2.1.3" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.10b"><list id="S3.I1.i2.p1.1.m1.10.10.4.cmml" xref="S3.I1.i2.p1.1.m1.10.10.3"><apply id="S3.I1.i2.p1.1.m1.8.8.1.1.cmml" xref="S3.I1.i2.p1.1.m1.8.8.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.8.8.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.8.8.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.8.8.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.8.8.1.1.2">𝑥</ci><list id="S3.I1.i2.p1.1.m1.2.2.2.3.cmml" xref="S3.I1.i2.p1.1.m1.2.2.2.4"><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1">𝑖</ci><cn type="integer" id="S3.I1.i2.p1.1.m1.2.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.2.2.2.2">1</cn></list></apply><apply id="S3.I1.i2.p1.1.m1.9.9.2.2.cmml" xref="S3.I1.i2.p1.1.m1.9.9.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.9.9.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.9.9.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.9.9.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.9.9.2.2.2">𝑥</ci><list id="S3.I1.i2.p1.1.m1.4.4.2.3.cmml" xref="S3.I1.i2.p1.1.m1.4.4.2.4"><ci id="S3.I1.i2.p1.1.m1.3.3.1.1.cmml" xref="S3.I1.i2.p1.1.m1.3.3.1.1">𝑖</ci><cn type="integer" id="S3.I1.i2.p1.1.m1.4.4.2.2.cmml" xref="S3.I1.i2.p1.1.m1.4.4.2.2">2</cn></list></apply><ci id="S3.I1.i2.p1.1.m1.7.7.cmml" xref="S3.I1.i2.p1.1.m1.7.7">…</ci><apply id="S3.I1.i2.p1.1.m1.10.10.3.3.cmml" xref="S3.I1.i2.p1.1.m1.10.10.3.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.10.10.3.3.1.cmml" xref="S3.I1.i2.p1.1.m1.10.10.3.3">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.10.10.3.3.2.cmml" xref="S3.I1.i2.p1.1.m1.10.10.3.3.2">𝑥</ci><list id="S3.I1.i2.p1.1.m1.6.6.2.3.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2"><ci id="S3.I1.i2.p1.1.m1.5.5.1.1.cmml" xref="S3.I1.i2.p1.1.m1.5.5.1.1">𝑖</ci><apply id="S3.I1.i2.p1.1.m1.6.6.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.6.6.2.2.1.1.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.6.6.2.2.1.2.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1.2">𝐿</ci><ci id="S3.I1.i2.p1.1.m1.6.6.2.2.1.3.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.1.3">𝑖</ci></apply></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.10c">x_{i,1},x_{i,2},\dots,x_{i,L_{i}}</annotation></semantics></math> are the characters of the <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">i</annotation></semantics></math>-th word in the input sequence,</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.2" class="ltx_p"><math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><msub id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">L_{i}</annotation></semantics></math> is the length of the <math id="S3.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.I1.i3.p1.2.m2.1a"><mi id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b"><ci id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">i</annotation></semantics></math>-th word,</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.2" class="ltx_p"><math id="S3.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="e_{i}" display="inline"><semantics id="S3.I1.i4.p1.1.m1.1a"><msub id="S3.I1.i4.p1.1.m1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.cmml"><mi id="S3.I1.i4.p1.1.m1.1.1.2" xref="S3.I1.i4.p1.1.m1.1.1.2.cmml">e</mi><mi id="S3.I1.i4.p1.1.m1.1.1.3" xref="S3.I1.i4.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.1.m1.1b"><apply id="S3.I1.i4.p1.1.m1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i4.p1.1.m1.1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i4.p1.1.m1.1.1.2.cmml" xref="S3.I1.i4.p1.1.m1.1.1.2">𝑒</ci><ci id="S3.I1.i4.p1.1.m1.1.1.3.cmml" xref="S3.I1.i4.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.1.m1.1c">e_{i}</annotation></semantics></math> is the embedding for the <math id="S3.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.I1.i4.p1.2.m2.1a"><mi id="S3.I1.i4.p1.2.m2.1.1" xref="S3.I1.i4.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.2.m2.1b"><ci id="S3.I1.i4.p1.2.m2.1.1.cmml" xref="S3.I1.i4.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.2.m2.1c">i</annotation></semantics></math>-th word,</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i5.p1" class="ltx_para">
<p id="S3.I1.i5.p1.1" class="ltx_p"><math id="S3.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.I1.i5.p1.1.m1.1a"><msub id="S3.I1.i5.p1.1.m1.1.1" xref="S3.I1.i5.p1.1.m1.1.1.cmml"><mi id="S3.I1.i5.p1.1.m1.1.1.2" xref="S3.I1.i5.p1.1.m1.1.1.2.cmml">h</mi><mi id="S3.I1.i5.p1.1.m1.1.1.3" xref="S3.I1.i5.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.1.m1.1b"><apply id="S3.I1.i5.p1.1.m1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i5.p1.1.m1.1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i5.p1.1.m1.1.1.2.cmml" xref="S3.I1.i5.p1.1.m1.1.1.2">ℎ</ci><ci id="S3.I1.i5.p1.1.m1.1.1.3.cmml" xref="S3.I1.i5.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i5.p1.1.m1.1c">h_{i}</annotation></semantics></math> is the hidden state,</p>
</div>
</li>
<li id="S3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i6.p1" class="ltx_para">
<p id="S3.I1.i6.p1.2" class="ltx_p"><math id="S3.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.I1.i6.p1.1.m1.1a"><msub id="S3.I1.i6.p1.1.m1.1.1" xref="S3.I1.i6.p1.1.m1.1.1.cmml"><mi id="S3.I1.i6.p1.1.m1.1.1.2" xref="S3.I1.i6.p1.1.m1.1.1.2.cmml">c</mi><mi id="S3.I1.i6.p1.1.m1.1.1.3" xref="S3.I1.i6.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i6.p1.1.m1.1b"><apply id="S3.I1.i6.p1.1.m1.1.1.cmml" xref="S3.I1.i6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i6.p1.1.m1.1.1.1.cmml" xref="S3.I1.i6.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i6.p1.1.m1.1.1.2.cmml" xref="S3.I1.i6.p1.1.m1.1.1.2">𝑐</ci><ci id="S3.I1.i6.p1.1.m1.1.1.3.cmml" xref="S3.I1.i6.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i6.p1.1.m1.1c">c_{i}</annotation></semantics></math> is the state of the LSTM for the <math id="S3.I1.i6.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.I1.i6.p1.2.m2.1a"><mi id="S3.I1.i6.p1.2.m2.1.1" xref="S3.I1.i6.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i6.p1.2.m2.1b"><ci id="S3.I1.i6.p1.2.m2.1.1.cmml" xref="S3.I1.i6.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i6.p1.2.m2.1c">i</annotation></semantics></math>-th word,</p>
</div>
</li>
<li id="S3.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i7.p1" class="ltx_para">
<p id="S3.I1.i7.p1.1" class="ltx_p"><math id="S3.I1.i7.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.I1.i7.p1.1.m1.1a"><mi id="S3.I1.i7.p1.1.m1.1.1" xref="S3.I1.i7.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i7.p1.1.m1.1b"><ci id="S3.I1.i7.p1.1.m1.1.1.cmml" xref="S3.I1.i7.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i7.p1.1.m1.1c">W</annotation></semantics></math> is the weight matrix,</p>
</div>
</li>
<li id="S3.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i8.p1" class="ltx_para">
<p id="S3.I1.i8.p1.1" class="ltx_p"><math id="S3.I1.i8.p1.1.m1.1" class="ltx_Math" alttext="p(w_{i+1}|w_{\leq i})" display="inline"><semantics id="S3.I1.i8.p1.1.m1.1a"><mrow id="S3.I1.i8.p1.1.m1.1.1" xref="S3.I1.i8.p1.1.m1.1.1.cmml"><mi id="S3.I1.i8.p1.1.m1.1.1.3" xref="S3.I1.i8.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.I1.i8.p1.1.m1.1.1.2" xref="S3.I1.i8.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.I1.i8.p1.1.m1.1.1.1.1" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i8.p1.1.m1.1.1.1.1.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i8.p1.1.m1.1.1.1.1.1" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.2.cmml">w</mi><mrow id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.1" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.2.cmml">w</mi><mrow id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.2" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.1" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S3.I1.i8.p1.1.m1.1.1.1.1.3" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i8.p1.1.m1.1b"><apply id="S3.I1.i8.p1.1.m1.1.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1"><times id="S3.I1.i8.p1.1.m1.1.1.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.2"></times><ci id="S3.I1.i8.p1.1.m1.1.1.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.3">𝑝</ci><apply id="S3.I1.i8.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.2">𝑤</ci><apply id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3"><plus id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.2">𝑤</ci><apply id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3"><leq id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.I1.i8.p1.1.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i8.p1.1.m1.1c">p(w_{i+1}|w_{\leq i})</annotation></semantics></math> is the probability of the next word in the sequence computed using the MLP decoder and softmax layer,</p>
</div>
</li>
</ul>
<p id="S3.SS2.p1.3" class="ltx_p">then the model can be expressed as follows:</p>
<table id="S3.Ex2" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex2X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2X.2.1.1.m1.10" class="ltx_Math" alttext="\displaystyle e_{i}=\text{CNN}(x_{i,1},x_{i,2},\dots,x_{i,L_{i}})" display="inline"><semantics id="S3.Ex2X.2.1.1.m1.10a"><mrow id="S3.Ex2X.2.1.1.m1.10.10" xref="S3.Ex2X.2.1.1.m1.10.10.cmml"><msub id="S3.Ex2X.2.1.1.m1.10.10.5" xref="S3.Ex2X.2.1.1.m1.10.10.5.cmml"><mi id="S3.Ex2X.2.1.1.m1.10.10.5.2" xref="S3.Ex2X.2.1.1.m1.10.10.5.2.cmml">e</mi><mi id="S3.Ex2X.2.1.1.m1.10.10.5.3" xref="S3.Ex2X.2.1.1.m1.10.10.5.3.cmml">i</mi></msub><mo id="S3.Ex2X.2.1.1.m1.10.10.4" xref="S3.Ex2X.2.1.1.m1.10.10.4.cmml">=</mo><mrow id="S3.Ex2X.2.1.1.m1.10.10.3" xref="S3.Ex2X.2.1.1.m1.10.10.3.cmml"><mtext id="S3.Ex2X.2.1.1.m1.10.10.3.5" xref="S3.Ex2X.2.1.1.m1.10.10.3.5a.cmml">CNN</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2X.2.1.1.m1.10.10.3.4" xref="S3.Ex2X.2.1.1.m1.10.10.3.4.cmml">​</mo><mrow id="S3.Ex2X.2.1.1.m1.10.10.3.3.3" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml"><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.4" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml">(</mo><msub id="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1" xref="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.cmml"><mi id="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.2" xref="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.2.cmml">x</mi><mrow id="S3.Ex2X.2.1.1.m1.2.2.2.4" xref="S3.Ex2X.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.Ex2X.2.1.1.m1.1.1.1.1" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex2X.2.1.1.m1.2.2.2.4.1" xref="S3.Ex2X.2.1.1.m1.2.2.2.3.cmml">,</mo><mn id="S3.Ex2X.2.1.1.m1.2.2.2.2" xref="S3.Ex2X.2.1.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.5" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml">,</mo><msub id="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2" xref="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.cmml"><mi id="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.2" xref="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.2.cmml">x</mi><mrow id="S3.Ex2X.2.1.1.m1.4.4.2.4" xref="S3.Ex2X.2.1.1.m1.4.4.2.3.cmml"><mi id="S3.Ex2X.2.1.1.m1.3.3.1.1" xref="S3.Ex2X.2.1.1.m1.3.3.1.1.cmml">i</mi><mo id="S3.Ex2X.2.1.1.m1.4.4.2.4.1" xref="S3.Ex2X.2.1.1.m1.4.4.2.3.cmml">,</mo><mn id="S3.Ex2X.2.1.1.m1.4.4.2.2" xref="S3.Ex2X.2.1.1.m1.4.4.2.2.cmml">2</mn></mrow></msub><mo id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.6" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.Ex2X.2.1.1.m1.7.7" xref="S3.Ex2X.2.1.1.m1.7.7.cmml">…</mi><mo id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.7" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml">,</mo><msub id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.cmml"><mi id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.2" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.2.cmml">x</mi><mrow id="S3.Ex2X.2.1.1.m1.6.6.2.2" xref="S3.Ex2X.2.1.1.m1.6.6.2.3.cmml"><mi id="S3.Ex2X.2.1.1.m1.5.5.1.1" xref="S3.Ex2X.2.1.1.m1.5.5.1.1.cmml">i</mi><mo id="S3.Ex2X.2.1.1.m1.6.6.2.2.2" xref="S3.Ex2X.2.1.1.m1.6.6.2.3.cmml">,</mo><msub id="S3.Ex2X.2.1.1.m1.6.6.2.2.1" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1.cmml"><mi id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.2" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1.2.cmml">L</mi><mi id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.3" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1.3.cmml">i</mi></msub></mrow></msub><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.8" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2X.2.1.1.m1.10b"><apply id="S3.Ex2X.2.1.1.m1.10.10.cmml" xref="S3.Ex2X.2.1.1.m1.10.10"><eq id="S3.Ex2X.2.1.1.m1.10.10.4.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.4"></eq><apply id="S3.Ex2X.2.1.1.m1.10.10.5.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.5"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.10.10.5.1.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.5">subscript</csymbol><ci id="S3.Ex2X.2.1.1.m1.10.10.5.2.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.5.2">𝑒</ci><ci id="S3.Ex2X.2.1.1.m1.10.10.5.3.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.5.3">𝑖</ci></apply><apply id="S3.Ex2X.2.1.1.m1.10.10.3.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3"><times id="S3.Ex2X.2.1.1.m1.10.10.3.4.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.4"></times><ci id="S3.Ex2X.2.1.1.m1.10.10.3.5a.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.5"><mtext id="S3.Ex2X.2.1.1.m1.10.10.3.5.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.5">CNN</mtext></ci><vector id="S3.Ex2X.2.1.1.m1.10.10.3.3.4.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3"><apply id="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1">subscript</csymbol><ci id="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.2.cmml" xref="S3.Ex2X.2.1.1.m1.8.8.1.1.1.1.2">𝑥</ci><list id="S3.Ex2X.2.1.1.m1.2.2.2.3.cmml" xref="S3.Ex2X.2.1.1.m1.2.2.2.4"><ci id="S3.Ex2X.2.1.1.m1.1.1.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1">𝑖</ci><cn type="integer" id="S3.Ex2X.2.1.1.m1.2.2.2.2.cmml" xref="S3.Ex2X.2.1.1.m1.2.2.2.2">1</cn></list></apply><apply id="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.cmml" xref="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.1.cmml" xref="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2">subscript</csymbol><ci id="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.2.cmml" xref="S3.Ex2X.2.1.1.m1.9.9.2.2.2.2.2">𝑥</ci><list id="S3.Ex2X.2.1.1.m1.4.4.2.3.cmml" xref="S3.Ex2X.2.1.1.m1.4.4.2.4"><ci id="S3.Ex2X.2.1.1.m1.3.3.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.1.1">𝑖</ci><cn type="integer" id="S3.Ex2X.2.1.1.m1.4.4.2.2.cmml" xref="S3.Ex2X.2.1.1.m1.4.4.2.2">2</cn></list></apply><ci id="S3.Ex2X.2.1.1.m1.7.7.cmml" xref="S3.Ex2X.2.1.1.m1.7.7">…</ci><apply id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.1.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3">subscript</csymbol><ci id="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.2.cmml" xref="S3.Ex2X.2.1.1.m1.10.10.3.3.3.3.2">𝑥</ci><list id="S3.Ex2X.2.1.1.m1.6.6.2.3.cmml" xref="S3.Ex2X.2.1.1.m1.6.6.2.2"><ci id="S3.Ex2X.2.1.1.m1.5.5.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.5.5.1.1">𝑖</ci><apply id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.cmml" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1">subscript</csymbol><ci id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.2.cmml" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1.2">𝐿</ci><ci id="S3.Ex2X.2.1.1.m1.6.6.2.2.1.3.cmml" xref="S3.Ex2X.2.1.1.m1.6.6.2.2.1.3">𝑖</ci></apply></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2X.2.1.1.m1.10c">\displaystyle e_{i}=\text{CNN}(x_{i,1},x_{i,2},\dots,x_{i,L_{i}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2Xa.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle c_{i},h_{i}=\text{LSTM}(h_{i-1},c_{i-1},e_{i})" display="inline"><semantics id="S3.Ex2Xa.2.1.1.m1.5a"><mrow id="S3.Ex2Xa.2.1.1.m1.5.5" xref="S3.Ex2Xa.2.1.1.m1.5.5.cmml"><mrow id="S3.Ex2Xa.2.1.1.m1.2.2.2.2" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.3.cmml"><msub id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.cmml">c</mi><mi id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.3" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.2" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.2.cmml">h</mi><mi id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.3" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S3.Ex2Xa.2.1.1.m1.5.5.6" xref="S3.Ex2Xa.2.1.1.m1.5.5.6.cmml">=</mo><mrow id="S3.Ex2Xa.2.1.1.m1.5.5.5" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.cmml"><mtext id="S3.Ex2Xa.2.1.1.m1.5.5.5.5" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.5a.cmml">LSTM</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2Xa.2.1.1.m1.5.5.5.4" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.4.cmml">​</mo><mrow id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml"><mo stretchy="false" id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.4" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml">(</mo><msub id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.2" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.2.cmml">h</mi><mrow id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.2" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.1" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.1.cmml">−</mo><mn id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.3" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.5" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml">,</mo><msub id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.2" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.2.cmml">c</mi><mrow id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.2" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.2.cmml">i</mi><mo id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.1" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.1.cmml">−</mo><mn id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.3" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.6" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml">,</mo><msub id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.cmml"><mi id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.2" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.2.cmml">e</mi><mi id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.3" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.7" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2Xa.2.1.1.m1.5b"><apply id="S3.Ex2Xa.2.1.1.m1.5.5.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5"><eq id="S3.Ex2Xa.2.1.1.m1.5.5.6.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.6"></eq><list id="S3.Ex2Xa.2.1.1.m1.2.2.2.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2"><apply id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.2">ℎ</ci><ci id="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.2.2.2.2.2.3">𝑖</ci></apply></list><apply id="S3.Ex2Xa.2.1.1.m1.5.5.5.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5"><times id="S3.Ex2Xa.2.1.1.m1.5.5.5.4.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.4"></times><ci id="S3.Ex2Xa.2.1.1.m1.5.5.5.5a.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.5"><mtext id="S3.Ex2Xa.2.1.1.m1.5.5.5.5.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.5">LSTM</mtext></ci><vector id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.4.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3"><apply id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1">subscript</csymbol><ci id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.2">ℎ</ci><apply id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3"><minus id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.1"></minus><ci id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2">subscript</csymbol><ci id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.2">𝑐</ci><apply id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3"><minus id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.1"></minus><ci id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.4.4.4.2.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.1.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3">subscript</csymbol><ci id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.2.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.2">𝑒</ci><ci id="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.3.cmml" xref="S3.Ex2Xa.2.1.1.m1.5.5.5.3.3.3.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2Xa.2.1.1.m1.5c">\displaystyle c_{i},h_{i}=\text{LSTM}(h_{i-1},c_{i-1},e_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2Xb.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle p(w_{i+1}|w_{\leq i})=\text{Softmax}(W^{T}h_{i})" display="inline"><semantics id="S3.Ex2Xb.2.1.1.m1.2a"><mrow id="S3.Ex2Xb.2.1.1.m1.2.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.cmml"><mrow id="S3.Ex2Xb.2.1.1.m1.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex2Xb.2.1.1.m1.1.1.1.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mrow id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">w</mi><mrow id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.1" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.3" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2Xb.2.1.1.m1.2.2.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.Ex2Xb.2.1.1.m1.2.2.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.cmml"><mtext id="S3.Ex2Xb.2.1.1.m1.2.2.2.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2Xb.2.1.1.m1.2.2.2.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.2.cmml">​</mo><mrow id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.cmml"><msup id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.2.cmml">W</mi><mi id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.1" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.1.cmml">​</mo><msub id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.2" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.2.cmml">h</mi><mi id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.3" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2Xb.2.1.1.m1.2b"><apply id="S3.Ex2Xb.2.1.1.m1.2.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2"><eq id="S3.Ex2Xb.2.1.1.m1.2.2.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.3"></eq><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1"><times id="S3.Ex2Xb.2.1.1.m1.1.1.1.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.2"></times><ci id="S3.Ex2Xb.2.1.1.m1.1.1.1.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.3">𝑝</ci><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.2">𝑤</ci><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3"><plus id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.2">𝑤</ci><apply id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3"><leq id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.Ex2Xb.2.1.1.m1.2.2.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2"><times id="S3.Ex2Xb.2.1.1.m1.2.2.2.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.2"></times><ci id="S3.Ex2Xb.2.1.1.m1.2.2.2.3a.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.3"><mtext id="S3.Ex2Xb.2.1.1.m1.2.2.2.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.3">Softmax</mtext></ci><apply id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1"><times id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.1"></times><apply id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.2">𝑊</ci><ci id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.2.3">𝑇</ci></apply><apply id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.2">ℎ</ci><ci id="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex2Xb.2.1.1.m1.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2Xb.2.1.1.m1.2c">\displaystyle p(w_{i+1}|w_{\leq i})=\text{Softmax}(W^{T}h_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2Xc"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2Xc.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\text{Perplexity}(w_{0},w_{1},\dots,w_{i})=\left(\prod_{j=0}^{i-1}p(w_{j+1}|w_{\leq j})\right)^{-1/i}." display="inline"><semantics id="S3.Ex2Xc.2.1.1.m1.2a"><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.cmml"><mtext id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5a.cmml">Perplexity</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.4" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.4.cmml">​</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.4" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml">(</mo><msub id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">w</mi><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.5" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">w</mi><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.6" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.Ex2Xc.2.1.1.m1.1.1" xref="S3.Ex2Xc.2.1.1.m1.1.1.cmml">…</mi><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.7" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.2.cmml">w</mi><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.8" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.5" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.5.cmml">=</mo><msup id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.cmml"><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.cmml"><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.cmml">(</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.cmml"><munderover id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2a" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.1.cmml">−</mo><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.2.cmml">w</mi><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.2.cmml">w</mi><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.cmml">)</mo></mrow><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.cmml"><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3a" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.cmml">−</mo><mrow id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.cmml"><mn id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.2.cmml">1</mn><mo id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.1" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.1.cmml">/</mo><mi id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.3" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.3.cmml">i</mi></mrow></mrow></msup></mrow><mo lspace="0em" id="S3.Ex2Xc.2.1.1.m1.2.2.1.2" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2Xc.2.1.1.m1.2b"><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1"><eq id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.5.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.5"></eq><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3"><times id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.4"></times><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5a.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5"><mtext id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.5">Perplexity</mtext></ci><vector id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.4.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3"><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝑤</ci><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.2">𝑤</ci><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.2.2.2.2.3">1</cn></apply><ci id="S3.Ex2Xc.2.1.1.m1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.1.1">…</ci><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.2">𝑤</ci><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4">superscript</csymbol><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1"><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2">superscript</csymbol><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.2">product</csymbol><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3"><eq id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.1"></eq><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3"><minus id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.1"></minus><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1"><times id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.2"></times><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.3">𝑝</ci><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.2">𝑤</ci><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3"><plus id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.2">𝑤</ci><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3"><leq id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3"><minus id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3"></minus><apply id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2"><divide id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.1.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.1"></divide><cn type="integer" id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.2.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.2">1</cn><ci id="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.3.cmml" xref="S3.Ex2Xc.2.1.1.m1.2.2.1.1.4.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2Xc.2.1.1.m1.2c">\displaystyle\text{Perplexity}(w_{0},w_{1},\dots,w_{i})=\left(\prod_{j=0}^{i-1}p(w_{j+1}|w_{\leq j})\right)^{-1/i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.4" class="ltx_p">Perplexity measures the degree of uncertainty of a language model when it generates a new token averaged over sequence lengths. (Tokens are the basic units of text and can be characters, words, subwords, or other segments of text) Formally, perplexity is defined as the normalized inverse probability of sequences.</p>
</div>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Number of devices.</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p1.1" class="ltx_p">The total pool of clients that can potentially participate in FL training can reach tens of millions. In each round, some devices (e.g., 1000) are selected to participate in the training (i.e., the <span id="S3.SS2.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">concurrency</span> parameter). One FL experiment can have hundreds or thousands of rounds, hence involving hundred thousands or millions of unique clients in a language modeling FL task running for a few days.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p2.1" class="ltx_p">Instead of using the users’ data for mobile keyboard predictions, which could raise privacy concerns, we use publicly available, representative data downloaded to the user devices before training. We used <code id="S3.SS2.SSS0.Px1.p2.1.1" class="ltx_verbatim ltx_font_typewriter">pushift.io</code>’s Reddit FL benchmark dataset <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al., <a href="#bib.bib11" title="" class="ltx_ref">2018</a>)</cite> in all experiments<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Meta was not involved in the collection of data from Reddit.</span></span></span>. This dataset is publicly available, previously collected, and currently hosted by <code id="S3.SS2.SSS0.Px1.p2.1.2" class="ltx_verbatim ltx_font_typewriter">pushift.io</code>, consisting of user comments on <code id="S3.SS2.SSS0.Px1.p2.1.3" class="ltx_verbatim ltx_font_typewriter">reddit.com</code>. Thus this dataset has a natural non-IID partitioning and is representative of a real-world data distribution for mobile keyboard predictions. It also exhibits the archetypal power-law phenomenon of the number of comments per user. The dataset comprises millions of users, with an average of 34 samples per user. Each device participating in the FL is randomly assigned an anonymized user id from the <code id="S3.SS2.SSS0.Px1.p2.1.4" class="ltx_verbatim ltx_font_typewriter">pushift.io</code>’s Reddit dataset to use as their training data.</p>
</div>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Stopping Criteria.</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p1.1" class="ltx_p">We run an FL experiment until either the language model reaches a target perplexity on a hold-out test set, or a maximum time limit of 2 days is reached.
We set the target perplexity to be 175 or lower for our tasks and stop the task when the perplexity is at or lower than the target for five consecutive rounds.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p2.1" class="ltx_p">Due to the large number of experiments in this study, we set the target perplexity higher and the time limit shorter than those of the typical production models. The carbon emissions of the at-scale production models of the same task are expected to be roughly <math id="S3.SS2.SSS0.Px2.p2.1.m1.1" class="ltx_math_unparsed" alttext="10\times" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><mn id="S3.SS2.SSS0.Px2.p2.1.m1.1.1">10</mn><mo lspace="0.222em" id="S3.SS2.SSS0.Px2.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">10\times</annotation></semantics></math> higher than the numbers reported in this study.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Experiment Parameters</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We explored different settings of hyperparameters, separately optimizing for model performance, time to reach target accuracy, and carbon emission. We discuss these choices next.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">For the optimizer running on the clients, we use SGD with no momentum. Alternatives (e.g., Adam) require additional on-device memory for the optimizer state (i.e., momentum buffers). Another important consideration is that in scenarios where clients possess limited data (which is often the case), they may not execute sufficient local steps to leverage the benefits of the momentum buffers. In such cases, the momentum-based optimization techniques may not be as effective.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">For the server optimizer, we wanted to be as general as possible, and we chose Adam for the server updates <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>. Adam is more general than SGD or SGD with Momentum, and the parameters of Adam can be chosen to essentially replicate the performance of SGD or SGD with Momentum <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>. On the server side in FL, we do not see any evidence that using a more compute-intensive optimizer has any significant impact on carbon emissions, although it should help the other dimensions — reduce time to reach a target accuracy and improve overall accuracy. Our setup, the server updating the global model using the Adam optimizer and the clients using SGD, is called FedAdam <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">We carefully evaluated hyperparameters for all applicable settings. We experimented with synchronous FL and asynchronous FL. For synchronous FL, the baseline implementation is FedAvg, whereas for asynchronous FL, it is FedBuff <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>. However, since we use Adam as the server optimizer, both synchronous and asynchronous FL get the benefits of adaptive optimizers and perform better than their baselines. The hyperparameters are listed in Table <a href="#S3.T1" title="Table 1 ‣ 3.3 Experiment Parameters ‣ 3 Industry-Scale Federated Learning ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Hyperparameters and their values explored in the experiments. Aggregation goal is expressed here as a percentage of concurrency.</figcaption>
<table id="S3.T1.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.2.3.1" class="ltx_tr">
<th id="S3.T1.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.2.3.1.1.1" class="ltx_text" style="font-size:90%;">Hyperparameter</span></th>
<th id="S3.T1.2.3.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.2.3.1.2.1" class="ltx_text" style="font-size:90%;">Values</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.2.4.1" class="ltx_tr">
<td id="S3.T1.2.4.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S3.T1.2.4.1.1.1" class="ltx_text" style="font-size:90%;">server learning rate</span></td>
<td id="S3.T1.2.4.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S3.T1.2.4.1.2.1" class="ltx_text" style="font-size:90%;">0.0001, 0.001, 0.005, 0.01, 0.1, 1</span></td>
</tr>
<tr id="S3.T1.2.5.2" class="ltx_tr">
<td id="S3.T1.2.5.2.1" class="ltx_td ltx_align_left"><span id="S3.T1.2.5.2.1.1" class="ltx_text" style="font-size:90%;">client learning rate</span></td>
<td id="S3.T1.2.5.2.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.2.5.2.2.1" class="ltx_text" style="font-size:90%;">0.0001, 0.001, 0.01, 0.1, 0.5, 1</span></td>
</tr>
<tr id="S3.T1.2.6.3" class="ltx_tr">
<td id="S3.T1.2.6.3.1" class="ltx_td ltx_align_left"><span id="S3.T1.2.6.3.1.1" class="ltx_text" style="font-size:90%;">local epoch</span></td>
<td id="S3.T1.2.6.3.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.2.6.3.2.1" class="ltx_text" style="font-size:90%;">1, 3, 5, 10, 15, 20</span></td>
</tr>
<tr id="S3.T1.2.7.4" class="ltx_tr">
<td id="S3.T1.2.7.4.1" class="ltx_td ltx_align_left"><span id="S3.T1.2.7.4.1.1" class="ltx_text" style="font-size:90%;">batch size</span></td>
<td id="S3.T1.2.7.4.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.2.7.4.2.1" class="ltx_text" style="font-size:90%;">8, 16, 32</span></td>
</tr>
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_left">
<span id="S3.T1.1.1.1.1" class="ltx_text" style="font-size:90%;">Adam </span><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml">β</mi><mn mathsize="90%" id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\beta_{1}</annotation></semantics></math>
</td>
<td id="S3.T1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">0.1, 0.5, 0.7, 0.9</span></td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.2.2.1" class="ltx_td ltx_align_left">
<span id="S3.T1.2.2.1.1" class="ltx_text" style="font-size:90%;">Adam </span><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><msub id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.2.2.1.m1.1.1.2" xref="S3.T1.2.2.1.m1.1.1.2.cmml">β</mi><mn mathsize="90%" id="S3.T1.2.2.1.m1.1.1.3" xref="S3.T1.2.2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><apply id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S3.T1.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">\beta_{2}</annotation></semantics></math>
</td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">0.9, 0.99, 0.999</span></td>
</tr>
<tr id="S3.T1.2.8.5" class="ltx_tr">
<td id="S3.T1.2.8.5.1" class="ltx_td ltx_align_left"><span id="S3.T1.2.8.5.1.1" class="ltx_text" style="font-size:90%;">concurrency</span></td>
<td id="S3.T1.2.8.5.2" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S3.T1.2.8.5.2.1" class="ltx_text" style="font-size:90%;">50, 100, 200, 300, 800, 1000, 1300, 1500</span></td>
</tr>
<tr id="S3.T1.2.9.6" class="ltx_tr">
<td id="S3.T1.2.9.6.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T1.2.9.6.1.1" class="ltx_text" style="font-size:90%;">aggregation goal</span></td>
<td id="S3.T1.2.9.6.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb"><span id="S3.T1.2.9.6.2.1" class="ltx_text" style="font-size:70%;">8%, 10%, 25%, 50%, 65%, 77%, 80%, 85%, 100%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Measurement Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section describes the measurement methodology we used to obtain our production FL stack’s carbon emissions.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>End-user Device Resource Measurements</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The FL software stack has a client runtime that executes on end-user devices for FL training tasks. To enable accurate measurement of compute time, upload, and download duration, we implemented a logger that records the vitals of the FL session, including the country from which the device is connected for the FL training, the model of the device, model download time, model upload time, and total duration of a single FL session. We use this information for power measurements of the devices.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The logger records events happening on the production FL client runtime. The logger is based on a generic logging system used widely in our production client runtimes and has minimal resource footprint. The generic logging system guarantees that the events are defined, created, and processed consistently across all the apps and services. The logger runs in parallel with an FL session. The downstream of the logger is a server-side database to store the logs sent from the client runtime logger.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Device training requirements.</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">It is a common practice in cross-device FL that training only takes place when the device is idle, charging, connected to an unmetered network (typically, Wi-Fi) <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Yang et al., <a href="#bib.bib61" title="" class="ltx_ref">2018</a>; Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Accounting for geography.</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">Since the device is in the charging mode for FL, considering the source of energy for charging results in a more accurate carbon footprint estimate. To this end, we also consider the country where an end user connects from when the device is charging, since different countries have different carbon intensities. Carbon intensity reflects the amount of CO<sub id="S4.SS1.SSS0.Px2.p1.1.1" class="ltx_sub">2</sub> emitted per unit of energy. We obtained country-level carbon intensities using the most recent reported year, e.g., 2020 or 2021, by Our World in Data <cite class="ltx_cite ltx_citemacro_citep">(Ritchie et al., <a href="#bib.bib48" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Optimization with regards to geography or heterogeneity.</h4>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.1" class="ltx_p">One direction for reducing carbon impact of FL is to optimize carbon and performance with regards to the heterogeneity of clients (e.g., run more on clients with better power profile), or optimizing with respect to the carbon intensity of their location (e.g., run more on clients whose location has greener power source). These optimization strategies, although promising, may introduce bias and amplify unfairness due to the fact that clients with good energy profiles or with greener energy sources are underrepresented in the Global South. We encourage the community to study this direction further.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Power profile of phones.</h4>

<div id="S4.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px4.p1.1" class="ltx_p">We acknowledge that power estimation of phones has been notoriously difficult <cite class="ltx_cite ltx_citemacro_citep">(Oliner et al., <a href="#bib.bib40" title="" class="ltx_ref">2013</a>; Couto et al., <a href="#bib.bib14" title="" class="ltx_ref">2015</a>)</cite>. Several methods exist to get the compute and communication power of end-user devices. One may try to approximate the power consumption of phones based on modeling different components, e.g., Wi-Fi units and TCP/IP layers <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib60" title="" class="ltx_ref">2013</a>)</cite>, although these models may not be accurate. Another approach is to estimate the power drainage by looking at the phone’s battery level over time. This method is a coarse-grained and noisy proxy to power consumption, as the battery life also depends on factors such as the age of the battery and ambient temperature. Moreover, the battery drain may differ for the same app usage across devices. Recent studies use collaborative methods for more accurate power measurements <cite class="ltx_cite ltx_citemacro_citep">(Almeida et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>; Bustamante &amp; Livshits, <a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>. In this study, the main challenge for power estimation is the <span id="S4.SS1.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_italic">diversity of devices</span> (see below). To address this challenge, we use Android phone’s <em id="S4.SS1.SSS0.Px4.p1.1.2" class="ltx_emph ltx_font_italic">power profile</em>. The power profile is an XML file (typically named <code id="S4.SS1.SSS0.Px4.p1.1.3" class="ltx_verbatim ltx_font_typewriter">power_profile.xml</code>) that Android device manufacturers must provide to specify parameters of different electronic components and the approximate battery drainage caused by these components over time <cite class="ltx_cite ltx_citemacro_citep">(Android, <a href="#bib.bib5" title="" class="ltx_ref">a</a>)</cite>. This is the method we adopt as it provides accurate data for phone power consumption based on manufacturer information.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Diversity of Android devices.</h4>

<div id="S4.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p1.1" class="ltx_p">There are more than tens of thousands of distinct Android device models (also observed in <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib58" title="" class="ltx_ref">2019</a>; Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2023</a>)</cite>), and obtaining the power estimates for every device model that participated in our experiments would not be feasible. We instead focus on a subset of representative mobile phones—210 most commonly seen Android phones in the language modeling FL task in production. These devices represent more than 20% of the total devices participating in the FL task in production. The power estimates for different components of these phones are measured by their manufacturers and are available from several sources <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib32" title="" class="ltx_ref">LineageOS, </a>; <a href="#bib.bib16" title="" class="ltx_ref">Exynoobs, </a>; <a href="#bib.bib36" title="" class="ltx_ref">Motorola Common, </a>; <a href="#bib.bib43" title="" class="ltx_ref">PixelPlusUI Devices, </a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS0.Px5.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p2.1" class="ltx_p">We extract from <code id="S4.SS1.SSS0.Px5.p2.1.1" class="ltx_verbatim ltx_font_typewriter">power_profile.xml</code> the power consumption of the CPU and Wi-Fi components. In <span id="S4.SS1.SSS0.Px5.p2.1.2" class="ltx_text ltx_font_smallcaps">Papaya</span> FL training of a language model is done on device CPU at present. (GPU support by PyTorch Mobile is largely limited to inference.) The listing below illustrates a snippet of a <span id="S4.SS1.SSS0.Px5.p2.1.3" class="ltx_text ltx_font_typewriter">power_profile.xml</span> for Google Pixel 7.</p>
<pre id="S4.SS1.SSS0.Px5.p2.2" class="ltx_verbatim ltx_font_typewriter" style="font-size:70%;">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;device name="Android"&gt;
    ... [text] ...
    &lt;item name="screen.on"&gt;98&lt;/item&gt;
    &lt;item name="screen.full"&gt;470&lt;/item&gt;
    &lt;item name="modem.controller.sleep"&gt;2.5&lt;/item&gt;
    &lt;item name="modem.controller.idle"&gt;4.5&lt;/item&gt;
    &lt;item name="modem.controller.rx"&gt;169&lt;/item&gt;
    ... [more text] ...
&lt;/device&gt;
</pre>
</div>
<div id="S4.SS1.SSS0.Px5.p3" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p3.1" class="ltx_p">We impute values for phones with missing <code id="S4.SS1.SSS0.Px5.p3.1.1" class="ltx_verbatim ltx_font_typewriter">power_profile.xml</code> files using corresponding numbers from devices with the same SoC or similar phones with comparable characteristics.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px6" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Wi-Fi Power.</h4>

<div id="S4.SS1.SSS0.Px6.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px6.p1.5" class="ltx_p">From the <code id="S4.SS1.SSS0.Px6.p1.5.1" class="ltx_verbatim ltx_font_typewriter">power_profile.xml</code> file, we use the fields <code id="S4.SS1.SSS0.Px6.p1.5.2" class="ltx_verbatim ltx_font_typewriter">wifi.active</code>, <code id="S4.SS1.SSS0.Px6.p1.5.3" class="ltx_verbatim ltx_font_typewriter">wifi.controller.rx</code>, <code id="S4.SS1.SSS0.Px6.p1.5.4" class="ltx_verbatim ltx_font_typewriter">wifi.controller.tx</code>, and 
<br class="ltx_break"><code id="S4.SS1.SSS0.Px6.p1.5.5" class="ltx_verbatim ltx_font_typewriter">wifi.controller.voltage</code> to determine the communication power of the Wi-Fi, as these fields report the current and voltage when transmitting or receiving data <cite class="ltx_cite ltx_citemacro_citep">(Android, <a href="#bib.bib6" title="" class="ltx_ref">b</a>)</cite>. The receiving power of an end-user phone would be</p>
<table id="S4.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex3.m1.1" class="ltx_Math" alttext="P_{\text{user\_rx}}=(I_{wa}+I_{wrx})\times V_{w}~{}," display="block"><semantics id="S4.Ex3.m1.1a"><mrow id="S4.Ex3.m1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml"><mrow id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml"><msub id="S4.Ex3.m1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.3.2" xref="S4.Ex3.m1.1.1.1.1.3.2.cmml">P</mi><mtext id="S4.Ex3.m1.1.1.1.1.3.3" xref="S4.Ex3.m1.1.1.1.1.3.3a.cmml">user_rx</mtext></msub><mo id="S4.Ex3.m1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex3.m1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.cmml"><mrow id="S4.Ex3.m1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex3.m1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mrow id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">a</mi></mrow></msub><mo id="S4.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">x</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.Ex3.m1.1.1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.Ex3.m1.1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.2.cmml">×</mo><msub id="S4.Ex3.m1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.3.2" xref="S4.Ex3.m1.1.1.1.1.1.3.2.cmml">V</mi><mi id="S4.Ex3.m1.1.1.1.1.1.3.3" xref="S4.Ex3.m1.1.1.1.1.1.3.3.cmml">w</mi></msub></mrow></mrow><mo id="S4.Ex3.m1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1"><eq id="S4.Ex3.m1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1.2"></eq><apply id="S4.Ex3.m1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.3.2">𝑃</ci><ci id="S4.Ex3.m1.1.1.1.1.3.3a.cmml" xref="S4.Ex3.m1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.Ex3.m1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.3.3">user_rx</mtext></ci></apply><apply id="S4.Ex3.m1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1"><times id="S4.Ex3.m1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2"></times><apply id="S4.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1"><plus id="S4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><apply id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3"><times id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.2">𝑤</ci><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.2.3.3">𝑎</ci></apply></apply><apply id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.2">𝐼</ci><apply id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3"><times id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.2">𝑤</ci><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci><ci id="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1.1.1.3.3.4">𝑥</ci></apply></apply></apply><apply id="S4.Ex3.m1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.2">𝑉</ci><ci id="S4.Ex3.m1.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">P_{\text{user\_rx}}=(I_{wa}+I_{wrx})\times V_{w}~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px6.p1.4" class="ltx_p">where <math id="S4.SS1.SSS0.Px6.p1.1.m1.1" class="ltx_Math" alttext="I_{wa}" display="inline"><semantics id="S4.SS1.SSS0.Px6.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px6.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.2.cmml">I</mi><mrow id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.1" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.3" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.3.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px6.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.2">𝐼</ci><apply id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3"><times id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.2">𝑤</ci><ci id="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.1.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px6.p1.1.m1.1c">I_{wa}</annotation></semantics></math>, <math id="S4.SS1.SSS0.Px6.p1.2.m2.1" class="ltx_Math" alttext="I_{wrx}" display="inline"><semantics id="S4.SS1.SSS0.Px6.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px6.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.2.cmml">I</mi><mrow id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.2" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.3" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1a" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.4" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px6.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.2">𝐼</ci><apply id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3"><times id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.2">𝑤</ci><ci id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.3">𝑟</ci><ci id="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.4.cmml" xref="S4.SS1.SSS0.Px6.p1.2.m2.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px6.p1.2.m2.1c">I_{wrx}</annotation></semantics></math>, <math id="S4.SS1.SSS0.Px6.p1.3.m3.1" class="ltx_Math" alttext="V_{w}" display="inline"><semantics id="S4.SS1.SSS0.Px6.p1.3.m3.1a"><msub id="S4.SS1.SSS0.Px6.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1.2.cmml">V</mi><mi id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px6.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1.2">𝑉</ci><ci id="S4.SS1.SSS0.Px6.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px6.p1.3.m3.1c">V_{w}</annotation></semantics></math> denote <code id="S4.SS1.SSS0.Px6.p1.4.1" class="ltx_verbatim ltx_font_typewriter">wifi.active</code>, <code id="S4.SS1.SSS0.Px6.p1.4.2" class="ltx_verbatim ltx_font_typewriter">wifi.controller.rx</code>, and <code id="S4.SS1.SSS0.Px6.p1.4.3" class="ltx_verbatim ltx_font_typewriter">wifi.controller.voltage</code>, respectively. The transmission power is computed similarly with <code id="S4.SS1.SSS0.Px6.p1.4.4" class="ltx_verbatim ltx_font_typewriter">wifi.controller.tx</code> as <math id="S4.SS1.SSS0.Px6.p1.4.m4.1" class="ltx_Math" alttext="P_{\text{user\_tx}}=(I_{wa}+I_{wtx})\times V_{w}" display="inline"><semantics id="S4.SS1.SSS0.Px6.p1.4.m4.1a"><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.cmml"><msub id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.2.cmml">P</mi><mtext id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3a.cmml">user_tx</mtext></msub><mo id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.2.cmml">I</mi><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.3.cmml">a</mi></mrow></msub><mo id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1a" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.4" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.4.cmml">x</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.2.cmml">×</mo><msub id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.2" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.2.cmml">V</mi><mi id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.3" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.3.cmml">w</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px6.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1"><eq id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.2"></eq><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.2">𝑃</ci><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3a.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3"><mtext mathsize="70%" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.3.3">user_tx</mtext></ci></apply><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1"><times id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1"><plus id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.1"></plus><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.2">𝐼</ci><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3"><times id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.1"></times><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.2">𝑤</ci><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.2.3.3">𝑎</ci></apply></apply><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.2">𝐼</ci><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3"><times id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.1"></times><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.2">𝑤</ci><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.3">𝑡</ci><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.4.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.1.1.1.3.3.4">𝑥</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.2">𝑉</ci><ci id="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px6.p1.4.m4.1.1.1.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px6.p1.4.m4.1c">P_{\text{user\_tx}}=(I_{wa}+I_{wtx})\times V_{w}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px7" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">CPU Power.</h4>

<div id="S4.SS1.SSS0.Px7.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px7.p1.1" class="ltx_p">For estimating the CPU power of phones, we need to know the compute resource pattern of the language modeling task on the phones. We did a field study on a few phones running the FL language modeling task for this. We used the Perfetto tool for profiling and analyzing the resource usage trace and confirmed that the FL task runs when the device is idle, and it runs on the “big” cluster of the CPU. The following is a representative example. Google Pixel 3 based on the Qualcomm SDM845 Snapdragon 845 SoC has two CPU clusters: a “small” cluster with four 1.8 GHz Kryo 385 cores for efficiency and a “big” cluster with four 2.8 GHz Kryo 385 cores for performance. Figure <a href="#S4.F3" title="Figure 3 ‣ CPU Power. ‣ 4.1 End-user Device Resource Measurements ‣ 4 Measurement Methodology ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows a snapshot of the 8 cores of the phone when running an FL task. Cores of the big cluster (cores 4 through 7) are running the FL task and are at the maximum frequency of 2.8GHz. Figure <a href="#S4.F4" title="Figure 4 ‣ CPU Power. ‣ 4.1 End-user Device Resource Measurements ‣ 4 Measurement Methodology ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> confirms that when the phone is idle, the big cluster is idle and running at a lower frequency of 0.8GHz.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2303.14604/assets/figures/cpufull.jpeg" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="411" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>A snapshot of the 8 cores of the phone when running an FL task. Cores of the big cluster (CPUs 4 through 7) are running the FL task and are at the maximum frequency of 2.8GHz.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2303.14604/assets/figures/cpuidle.jpg" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="363" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>A snapshot of the 8 cores of the phone when it is idle. The cores of the big cluster are idle.</figcaption>
</figure>
<div id="S4.SS1.SSS0.Px7.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px7.p2.1" class="ltx_p">The <code id="S4.SS1.SSS0.Px7.p2.1.1" class="ltx_verbatim ltx_font_typewriter">power_profile.xml</code> file has currents for all CPU clusters running at different frequencies. We find the total current by adding these values (concretely, <code id="S4.SS1.SSS0.Px7.p2.1.2" class="ltx_verbatim ltx_font_typewriter">cpu.cluster_power.cluster</code>,
<br class="ltx_break"><code id="S4.SS1.SSS0.Px7.p2.1.3" class="ltx_verbatim ltx_font_typewriter">cpu.active</code>, and <code id="S4.SS1.SSS0.Px7.p2.1.4" class="ltx_verbatim ltx_font_typewriter">cpu.core_power.cluster</code>) corresponding to the highest frequency belonging to the “big” cluster. Hence for FL training on the device, the current for CPU is the addition of the values in these 3 fields. We use Watt’s law to convert current to power and assume that the phones operate at 3.8V <cite class="ltx_cite ltx_citemacro_citep">(Network, <a href="#bib.bib38" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS0.Px7.p3" class="ltx_para">
<p id="S4.SS1.SSS0.Px7.p3.1" class="ltx_p">By multiplying the power and the FL session duration obtained from the logger – namely upload time, download time, and processing time – we can get the energy consumption for an FL session on a phone. We additionally confirm that the values resulting from this methodology are consistent with those reported in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>; Halpern et al., <a href="#bib.bib18" title="" class="ltx_ref">2016</a>; Kim &amp; Wu, <a href="#bib.bib27" title="" class="ltx_ref">2020</a>)</cite>. Our methodology also accounts for the clients that drop out or time out during training, as their session information is reported in the logger.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Server Resource Measurements</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We measure the carbon footprint of the server as follows. There are three main server components in the <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">Papaya</span> stack: Aggregator, Coordinator, and Selector. The most power-intensive computations happen in the Aggregator and Selector, while the Coordinator is responsible for matching FL tasks to clients and Aggregators and orchestration. To ensure accurate measurements of power consumption, we monitored the physical servers that run the FL task (Aggregator and Selector). We describe our methodology for measuring the carbon footprint of an individual task on these servers.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Aggregator.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.1" class="ltx_p">To accurately estimate the carbon footprint of a single task on the physical servers, we measure the CPU utilization of the Aggregator during the execution of the language modeling FL task. We use the CPU utilization as a proxy for the power consumption specifically attributable to the FL task being executed on the server.</p>
</div>
<div id="S4.SS2.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p2.2" class="ltx_p">We consider the periods where the Aggregator runs only the language modeling FL task. First, we identify the Aggregator that runs a particular FL task. Next, we select a “<span id="S4.SS2.SSS0.Px1.p2.2.1" class="ltx_text ltx_font_italic">stable</span>” period when there is no failure, and the Aggregator is relatively underloaded. It is important to consider this period since the Coordinator reassigns FL tasks when it detects failed or overloaded Aggregators <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>, hence tracking an FL task would not be feasible. We observe that utilization of the Aggregator for the language modeling FL task is less than <math id="S4.SS2.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">1\%</annotation></semantics></math>, which also includes background processes. To get a conservative upper bound, we assume that server utilization is <math id="S4.SS2.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">1\%</annotation></semantics></math> for the FL task. (Looking ahead, small errors in the estimate of the server utilization have a negligible impact on the results due to the small footprint of the server compute.)</p>
</div>
<div id="S4.SS2.SSS0.Px1.p3" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p3.2" class="ltx_p">Knowing the hardware specification of the physical servers running Aggregator, at <math id="S4.SS2.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S4.SS2.SSS0.Px1.p3.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.1.m1.1c">1\%</annotation></semantics></math> utilization, we measured Aggregator’s power consumption for running the language modeling FL task at <math id="S4.SS2.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="45" display="inline"><semantics id="S4.SS2.SSS0.Px1.p3.2.m2.1a"><mn id="S4.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml">45</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.2.m2.1b"><cn type="integer" id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1">45</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.2.m2.1c">45</annotation></semantics></math>W.
We multiply this number by the Power Usage Effectiveness (PUE) of our datacenters, 1.09, which accounts for the additional energy required to support the datacenter infrastructure (mainly cooling) <cite class="ltx_cite ltx_citemacro_citep">(Meta, <a href="#bib.bib35" title="" class="ltx_ref">b</a>)</cite>.</p>
</div>
<div id="S4.SS2.SSS0.Px1.p4" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p4.1" class="ltx_p">Load balancing and other techniques of <span id="S4.SS2.SSS0.Px1.p4.1.1" class="ltx_text ltx_font_smallcaps">Papaya</span> may impact where the Aggregator and Selector run. However, for this study, we assume they run uniformly across different datacenters.
We use the weighted average carbon intensity model to account for the carbon intensity of different Meta datacenters that reside in different locations and regions <cite class="ltx_cite ltx_citemacro_citep">(Meta, <a href="#bib.bib34" title="" class="ltx_ref">a</a>)</cite>. We obtain the weighted average of the carbon intensities of the countries where Meta datacenters are located, and the weight is the number of datacenters in that country.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Selector.</h4>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">Since most of the processing happens in the Aggregator, the Aggregator’s carbon footprint dominates that of the Selector. We conservatively assume the same carbon footprint value for the Selector as for the Aggregator.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Networking Infrastructure Resource Measurements</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.8" class="ltx_p">For the networking and infrastructure resources, we adopt the standard methodology that considers all hardware assets on the path between the end-user and the FL server, namely, access, metro, edge, and core networks <cite class="ltx_cite ltx_citemacro_citep">(Vishwanath et al., <a href="#bib.bib55" title="" class="ltx_ref">2015</a>; Baliga et al., <a href="#bib.bib7" title="" class="ltx_ref">2011</a>; Jalali et al., <a href="#bib.bib23" title="" class="ltx_ref">2014</a>; Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>)</cite>. The access network is the first network user connects to, and it typically includes ADSL Ethernet, Wi-Fi access point, or 3G/4G/5G access point. The metro and edge network aggregate traffic from several users’ access points, regulate access and usage, and represent the gateway to the global Internet, which consists of an edge Ethernet switch, broadband network gateways (BNGs), and edge routers <cite class="ltx_cite ltx_citemacro_citep">(Vishwanath et al., <a href="#bib.bib55" title="" class="ltx_ref">2015</a>)</cite>. The core network, consisting of core routers, is the backbone of the Internet, connecting the metro and edge network to the datacenter. Schematically for cross-device FL we can have: client <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\rightarrow</annotation></semantics></math> Wi-Fi access point <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\rightarrow</annotation></semantics></math> edge Ethernet switch <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mo stretchy="false" id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\rightarrow</annotation></semantics></math> BNG <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mo stretchy="false" id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\rightarrow</annotation></semantics></math> edge routers <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mo stretchy="false" id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\rightarrow</annotation></semantics></math> core routers <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mo stretchy="false" id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><ci id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\rightarrow</annotation></semantics></math> edge routers <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><mo stretchy="false" id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><ci id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">\rightarrow</annotation></semantics></math> data center Ethernet switch <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><mo stretchy="false" id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><ci id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\rightarrow</annotation></semantics></math> data center.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.7" class="ltx_p">In this setting, power consumption of the networking infrastructure connecting the end-user to the FL server in the datacenter can be obtained using the energy-per-bit model, as <cite class="ltx_cite ltx_citemacro_citep">(Jalali et al., <a href="#bib.bib23" title="" class="ltx_ref">2014</a>; Vishwanath et al., <a href="#bib.bib55" title="" class="ltx_ref">2015</a>)</cite>:</p>
<table id="S4.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex4.m1.1" class="ltx_Math" alttext="P_{\text{network}}=(E_{a}+E_{\text{as}}+E_{\text{bng}}+n_{e}E_{e}+n_{c}E_{c}+E_{\text{ds}})\times B," display="block"><semantics id="S4.Ex4.m1.1a"><mrow id="S4.Ex4.m1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.cmml"><mrow id="S4.Ex4.m1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.cmml"><msub id="S4.Ex4.m1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.3.2" xref="S4.Ex4.m1.1.1.1.1.3.2.cmml">P</mi><mtext id="S4.Ex4.m1.1.1.1.1.3.3" xref="S4.Ex4.m1.1.1.1.1.3.3a.cmml">network</mtext></msub><mo id="S4.Ex4.m1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex4.m1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.cmml"><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mtext id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3a.cmml">as</mtext></msub><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1a" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.2.cmml">E</mi><mtext id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3a.cmml">bng</mtext></msub><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1b" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.cmml"><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.2.cmml">n</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.1.cmml">​</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.2.cmml">E</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.3.cmml">e</mi></msub></mrow><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1c" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.cmml"><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.2.cmml">n</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.1.cmml">​</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.2.cmml">E</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.3.cmml">c</mi></msub></mrow><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1d" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.2.cmml">E</mi><mtext id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3a.cmml">ds</mtext></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.Ex4.m1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.Ex4.m1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.2.cmml">×</mo><mi id="S4.Ex4.m1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.3.cmml">B</mi></mrow></mrow><mo id="S4.Ex4.m1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.1b"><apply id="S4.Ex4.m1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1"><eq id="S4.Ex4.m1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.1.2"></eq><apply id="S4.Ex4.m1.1.1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.3.1.cmml" xref="S4.Ex4.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.3.2.cmml" xref="S4.Ex4.m1.1.1.1.1.3.2">𝑃</ci><ci id="S4.Ex4.m1.1.1.1.1.3.3a.cmml" xref="S4.Ex4.m1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.Ex4.m1.1.1.1.1.3.3.cmml" xref="S4.Ex4.m1.1.1.1.1.3.3">network</mtext></ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1"><times id="S4.Ex4.m1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.2"></times><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1"><plus id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.3.3">as</mtext></ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.4.3">bng</mtext></ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5"><times id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.1"></times><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.2">𝑛</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.2.3">𝑒</ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.5.3.3">𝑒</ci></apply></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6"><times id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.1"></times><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.2">𝑛</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.2.3">𝑐</ci></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.6.3.3">𝑐</ci></apply></apply><apply id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7">subscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.2">𝐸</ci><ci id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3a.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3"><mtext mathsize="70%" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.7.3">ds</mtext></ci></apply></apply><ci id="S4.Ex4.m1.1.1.1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.1c">P_{\text{network}}=(E_{a}+E_{\text{as}}+E_{\text{bng}}+n_{e}E_{e}+n_{c}E_{c}+E_{\text{ds}})\times B,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.6" class="ltx_p">where <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">B</annotation></semantics></math> is the bandwidth usage of the FL session, <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="n_{e}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">n</mi><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑛</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">n_{e}</annotation></semantics></math> is the number of edge routers, <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">n</mi><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑛</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">n_{c}</annotation></semantics></math> is the number of core routers, and <math id="S4.SS3.p2.4.m4.3" class="ltx_Math" alttext="E_{a},E_{\text{as}},E_{\text{bng}}" display="inline"><semantics id="S4.SS3.p2.4.m4.3a"><mrow id="S4.SS3.p2.4.m4.3.3.3" xref="S4.SS3.p2.4.m4.3.3.4.cmml"><msub id="S4.SS3.p2.4.m4.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.1.1.2" xref="S4.SS3.p2.4.m4.1.1.1.1.2.cmml">E</mi><mi id="S4.SS3.p2.4.m4.1.1.1.1.3" xref="S4.SS3.p2.4.m4.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.SS3.p2.4.m4.3.3.3.4" xref="S4.SS3.p2.4.m4.3.3.4.cmml">,</mo><msub id="S4.SS3.p2.4.m4.2.2.2.2" xref="S4.SS3.p2.4.m4.2.2.2.2.cmml"><mi id="S4.SS3.p2.4.m4.2.2.2.2.2" xref="S4.SS3.p2.4.m4.2.2.2.2.2.cmml">E</mi><mtext id="S4.SS3.p2.4.m4.2.2.2.2.3" xref="S4.SS3.p2.4.m4.2.2.2.2.3a.cmml">as</mtext></msub><mo id="S4.SS3.p2.4.m4.3.3.3.5" xref="S4.SS3.p2.4.m4.3.3.4.cmml">,</mo><msub id="S4.SS3.p2.4.m4.3.3.3.3" xref="S4.SS3.p2.4.m4.3.3.3.3.cmml"><mi id="S4.SS3.p2.4.m4.3.3.3.3.2" xref="S4.SS3.p2.4.m4.3.3.3.3.2.cmml">E</mi><mtext id="S4.SS3.p2.4.m4.3.3.3.3.3" xref="S4.SS3.p2.4.m4.3.3.3.3.3a.cmml">bng</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.3b"><list id="S4.SS3.p2.4.m4.3.3.4.cmml" xref="S4.SS3.p2.4.m4.3.3.3"><apply id="S4.SS3.p2.4.m4.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.2">𝐸</ci><ci id="S4.SS3.p2.4.m4.1.1.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1.3">𝑎</ci></apply><apply id="S4.SS3.p2.4.m4.2.2.2.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.2.2.2.2.1.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2.2">𝐸</ci><ci id="S4.SS3.p2.4.m4.2.2.2.2.3a.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2.3"><mtext mathsize="70%" id="S4.SS3.p2.4.m4.2.2.2.2.3.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2.3">as</mtext></ci></apply><apply id="S4.SS3.p2.4.m4.3.3.3.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.3.3.3.3.1.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3">subscript</csymbol><ci id="S4.SS3.p2.4.m4.3.3.3.3.2.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3.2">𝐸</ci><ci id="S4.SS3.p2.4.m4.3.3.3.3.3a.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3.3"><mtext mathsize="70%" id="S4.SS3.p2.4.m4.3.3.3.3.3.cmml" xref="S4.SS3.p2.4.m4.3.3.3.3.3">bng</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.3c">E_{a},E_{\text{as}},E_{\text{bng}}</annotation></semantics></math>, <math id="S4.SS3.p2.5.m5.3" class="ltx_Math" alttext="E_{e},E_{c},E_{\text{ds}}" display="inline"><semantics id="S4.SS3.p2.5.m5.3a"><mrow id="S4.SS3.p2.5.m5.3.3.3" xref="S4.SS3.p2.5.m5.3.3.4.cmml"><msub id="S4.SS3.p2.5.m5.1.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.1.1.2" xref="S4.SS3.p2.5.m5.1.1.1.1.2.cmml">E</mi><mi id="S4.SS3.p2.5.m5.1.1.1.1.3" xref="S4.SS3.p2.5.m5.1.1.1.1.3.cmml">e</mi></msub><mo id="S4.SS3.p2.5.m5.3.3.3.4" xref="S4.SS3.p2.5.m5.3.3.4.cmml">,</mo><msub id="S4.SS3.p2.5.m5.2.2.2.2" xref="S4.SS3.p2.5.m5.2.2.2.2.cmml"><mi id="S4.SS3.p2.5.m5.2.2.2.2.2" xref="S4.SS3.p2.5.m5.2.2.2.2.2.cmml">E</mi><mi id="S4.SS3.p2.5.m5.2.2.2.2.3" xref="S4.SS3.p2.5.m5.2.2.2.2.3.cmml">c</mi></msub><mo id="S4.SS3.p2.5.m5.3.3.3.5" xref="S4.SS3.p2.5.m5.3.3.4.cmml">,</mo><msub id="S4.SS3.p2.5.m5.3.3.3.3" xref="S4.SS3.p2.5.m5.3.3.3.3.cmml"><mi id="S4.SS3.p2.5.m5.3.3.3.3.2" xref="S4.SS3.p2.5.m5.3.3.3.3.2.cmml">E</mi><mtext id="S4.SS3.p2.5.m5.3.3.3.3.3" xref="S4.SS3.p2.5.m5.3.3.3.3.3a.cmml">ds</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.3b"><list id="S4.SS3.p2.5.m5.3.3.4.cmml" xref="S4.SS3.p2.5.m5.3.3.3"><apply id="S4.SS3.p2.5.m5.1.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m5.1.1.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.2">𝐸</ci><ci id="S4.SS3.p2.5.m5.1.1.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.3">𝑒</ci></apply><apply id="S4.SS3.p2.5.m5.2.2.2.2.cmml" xref="S4.SS3.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.2.2.2.2.1.cmml" xref="S4.SS3.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.5.m5.2.2.2.2.2.cmml" xref="S4.SS3.p2.5.m5.2.2.2.2.2">𝐸</ci><ci id="S4.SS3.p2.5.m5.2.2.2.2.3.cmml" xref="S4.SS3.p2.5.m5.2.2.2.2.3">𝑐</ci></apply><apply id="S4.SS3.p2.5.m5.3.3.3.3.cmml" xref="S4.SS3.p2.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.3.3.3.3.1.cmml" xref="S4.SS3.p2.5.m5.3.3.3.3">subscript</csymbol><ci id="S4.SS3.p2.5.m5.3.3.3.3.2.cmml" xref="S4.SS3.p2.5.m5.3.3.3.3.2">𝐸</ci><ci id="S4.SS3.p2.5.m5.3.3.3.3.3a.cmml" xref="S4.SS3.p2.5.m5.3.3.3.3.3"><mtext mathsize="70%" id="S4.SS3.p2.5.m5.3.3.3.3.3.cmml" xref="S4.SS3.p2.5.m5.3.3.3.3.3">ds</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.3c">E_{e},E_{c},E_{\text{ds}}</annotation></semantics></math> denote the energy per bit of the Wi-Fi access point, the edge Ethernet switch, the BNG, an edge router, a core router, and data center Ethernet switch respectively <cite class="ltx_cite ltx_citemacro_citep">(Vishwanath et al., <a href="#bib.bib55" title="" class="ltx_ref">2015</a>)</cite>. We adopt constants from Vishwanath et al. <cite class="ltx_cite ltx_citemacro_citep">(Vishwanath et al., <a href="#bib.bib55" title="" class="ltx_ref">2015</a>)</cite>. The bandwidth usage of the session, <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">B</annotation></semantics></math>, can be calculated using the model size divided by the upload or the download time.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Carbon Emissions of FL</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.5" class="ltx_p">In this section, we present the results of our study and measurements. We use CO<sub id="S5.p1.5.1" class="ltx_sub">2</sub>-equivalents (CO<sub id="S5.p1.5.2" class="ltx_sub">2</sub>e), a standardized measure to express the global-warming potential of various greenhouse gases as a single metric. Carbon dioxide (CO<sub id="S5.p1.5.3" class="ltx_sub">2</sub>) is not the sole greenhouse gas contributing to climate change. There exist other gases that also have a significant impact on the environment, and the aggregate effect of all these gases is quantified as CO<sub id="S5.p1.5.4" class="ltx_sub">2</sub>e: the number of metric tons of CO<sub id="S5.p1.5.5" class="ltx_sub">2</sub> emissions with the same global warming potential as one metric ton of another greenhouse gas.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2303.14604/assets/x2.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="383" height="252" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Carbon emissions of SyncFL and AsyncFL to reach a target perplexity. The text above the bars shows the time and rounds it takes to reach the target perplexity.</figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Estimating Carbon Emissions of Industry-scale FL System</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We quantified the carbon emissions of our synchronous and asynchronous FL system through hundreds of experiments, each with a different set of hyperparameters.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">First, we illustrate the total carbon impact of synchronous and asynchronous FL. Figure <a href="#S5.F5" title="Figure 5 ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the carbon emissions of synchronous and asynchronous FL training in our production stack to reach a target perplexity of 175. We have tuned both methods by finding the choice of hyper-parameters that led to the lowest time to target perplexity, as also used in Huba et al. <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. In this setup, concurrency and aggregation goal are both set to 1,000.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">We can see that synchronous FL has a smaller carbon footprint compared to asynchronous FL. This is in contrast to the faster convergence of asynchronous FL (2.4 hours), which involves more model updates at the server (100). Asynchronous FL converges faster to the target perplexity due to its fast model updates. Due to its frequent iterations, asynchronous FL involves more clients. This result shows a fundamental trade-off between synchronous and asynchronous FL: if tuned well, <span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">asynchronous FL is faster than synchronous FL as it advances the model more frequently in the presence of stragglers, but it comes at the cost of higher carbon emissions.</span></p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.2" class="ltx_p">We can also see that the majority of the carbon footprint is contributed by the client compute — consistent with FL’s pushing the AI processing to the edge of the network. The server compute is a small fraction of the carbon emissions as shown in Figure <a href="#S5.F5" title="Figure 5 ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and other experiments. We observe that client compute and the communication between the clients and the server are responsible for the greatest share of FL’s overall carbon emissions (97%). The carbon footprint from the server-side computation is small (<math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mo id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\sim</annotation></semantics></math>1–2%), while client computation contributes to almost half of the overall carbon footprint (<math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mo id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><csymbol cd="latexml" id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">\sim</annotation></semantics></math>46–50%). Upload and download networking costs are approximately 27–29% and 22–24%, respectively.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">Figure <a href="#S5.F6" title="Figure 6 ‣ 5.1 Estimating Carbon Emissions of Industry-scale FL System ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the carbon emissions of synchronous and asynchronous FL training in our production stack after a fixed time – after 4 and 10 hours. In this experiment, instead of fixing the target perplexity and evaluating on training time, we fix the training time and measure the carbon emissions and the achieved perplexity (lower is better). The test perplexity is computed using data from 20 <em id="S5.SS1.p5.1.1" class="ltx_emph ltx_font_italic">held-out</em> clients, to have quick evaluation. Each device has enough examples to have several hundreds of samples for evaluation. Because test perplexity with so few clients is noisy and can vary significantly from round to round, we smooth the test perplexity using an exponentially-weighted moving average with parameter <math id="S5.SS1.p5.1.m1.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S5.SS1.p5.1.m1.1a"><mrow id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml"><mi id="S5.SS1.p5.1.m1.1.1.2" xref="S5.SS1.p5.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS1.p5.1.m1.1.1.1" xref="S5.SS1.p5.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p5.1.m1.1.1.3" xref="S5.SS1.p5.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><apply id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1"><eq id="S5.SS1.p5.1.m1.1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1.1"></eq><ci id="S5.SS1.p5.1.m1.1.1.2.cmml" xref="S5.SS1.p5.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS1.p5.1.m1.1.1.3.cmml" xref="S5.SS1.p5.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">\alpha=0.3</annotation></semantics></math> and declare that the test perplexity target has been reached when the smoothed test perplexity achieves the target. Asynchronous FL can advance the model faster and reach a lower perplexity at the cost of more carbon footprint. After 10 hours, synchronous FL is able to catch up to asynchronous FL with a similar perplexity of 120. The same contribution ratio among client compute, server compute, upload and download networking costs can be seen here too.</p>
</div>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.1" class="ltx_p">In the rest of the experiments, we fix the target perplexity while evaluating carbon emissions and training time.</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2303.14604/assets/x3.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="251" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Carbon emissions of SyncFL and AsyncFL after a fixed training time. The text above the bars shows the perplexity of the model at the specified time (lower is better).</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Some Parameters Matter More</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">In our study on hyperparameters in FL tasks, we observed that some parameter choices have a greater impact on carbon footprint than others. Specifically, the parameter of <em id="S5.SS2.p1.1.1" class="ltx_emph ltx_font_italic">concurrency</em> plays a significant role. The relationship between concurrency and carbon emissions in synchronous FL is depicted in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, where we observe that as concurrency increases, so does the carbon footprint. Higher concurrency leads to more devices training simultaneously, resulting in increased resource utilization and only partially offset with potentially faster convergence. We note that the time to reach a target accuracy decreases only up to concurrency of 800, illustrating diminishing returns in training speed. Diminishing returns in training speed as a function of increasing the number of clients training in parallel is analogous to a similar phenomenon in large-batch training <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Bonawitz et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>; Charles et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2303.14604/assets/x4.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="391" height="280" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Higher concurrency leads to more carbon emissions. The numbers above bars are the time (in hours) it takes to reach the target accuracy.</figcaption>
</figure>
<figure id="S5.F8" class="ltx_figure"><img src="" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Carbon emission of synchronous FL is linearly correlated with the product of rounds it takes to reach a target accuracy and concurrency.</figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure"><img src="/html/2303.14604/assets/x6.png" id="S5.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Carbon emission of asynchronous FL is linearly correlated with the product of the time it takes to reach a target accuracy and concurrency.</figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Among the parameters and artifacts of FL system design, we found that concurrency and time to reach a target accuracy, which translates to the number of rounds for synchronous FL and wall-clock time for asynchronous FL, have the most significant impact on carbon emissions. Conversely, other parameters such as learning rates, batch sizes, aggregation goals, and local epochs impact the convergence of the FL model towards the target accuracy, which in turn influences the time required to complete the training process. While these parameters do not directly affect carbon emissions, they do indirectly influence the overall training speed. Therefore, it is recommended that these parameters be included in the “time” and “performance” aspects of the multidimensional design in Green FL. On the other hand, concurrency impacts both time and carbon emissions directly and should be given greater consideration in FL system design for reducing carbon emissions.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">Consistent with prior research <cite class="ltx_cite ltx_citemacro_citep">(Huba et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Bonawitz et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, the present study indicates that larger values for local epoch do not yield improvements in training efficiency, particularly within the context of non-IID at-scale FL systems characterized by heterogeneous data and systems. On the contrary, larger local epoch values result in a marked increase in carbon emissions, largely attributable to the corresponding rise in client compute. Therefore, we recommend using smaller values for the local epoch, specifically in the 1 to 3 range.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Predicting Carbon Emissions of FL</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We put forth a model of the relationship between time-to-convergence, model performance, and carbon emissions. By leveraging our model, FL practitioners can effectively forecast the carbon emissions of their system before initiating the training process.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.4" class="ltx_p">We observed that concurrency is the most significant determinant of FL’s carbon emissions. It has the largest effect on the resources, since concurrency most directly corresponds to the resource utilization of clients. While higher concurrency accelerates model convergence, it results in significantly higher carbon emissions. For instance, increasing concurrency by 10<math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mo id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><times id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\times</annotation></semantics></math> increases the resource usage by 10<math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mo id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><times id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\times</annotation></semantics></math> while only reducing the convergence time by 1.5<math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mo id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><times id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">\times</annotation></semantics></math> or 2<math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mo id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><times id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">\times</annotation></semantics></math>. Therefore, the overall benefits of higher concurrency, considering resource consumption, do not scale linearly — <span id="S5.SS3.p2.4.1" class="ltx_text ltx_font_bold">increasing concurrency has diminishing returns considering convergence, model performance, and carbon emissions</span>. Higher concurrency reduces training duration, but increases resource usage even more.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p">To understand the relationship, we assume that the carbon emissions have a linear relationship with the product of concurrency and the number of rounds (or duration) it takes to reach a target accuracy. We validate our hypothesis in Figures <a href="#S5.F8" title="Figure 8 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S5.F9" title="Figure 9 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.2" class="ltx_p">Figure <a href="#S5.F8" title="Figure 8 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the relationship between the product of rounds and concurrency and the carbon emissions for download, upload, and client compute in synchronous FL (carbon emissions of server compute is negligible). Different points on these scatter plots represent different training runs of the language modeling FL task. We use linear regression to find the fitting line that shows the aforementioned relationship. Figure <a href="#S5.F8" title="Figure 8 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> also shows the <math id="S5.SS3.p4.1.m1.1" class="ltx_Math" alttext="R^{2}" display="inline"><semantics id="S5.SS3.p4.1.m1.1a"><msup id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml"><mi id="S5.SS3.p4.1.m1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.2.cmml">R</mi><mn id="S5.SS3.p4.1.m1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><apply id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">superscript</csymbol><ci id="S5.SS3.p4.1.m1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2">𝑅</ci><cn type="integer" id="S5.SS3.p4.1.m1.1.1.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">R^{2}</annotation></semantics></math> values of the models, which is a goodness-of-fit measure for the linear regression models. We can see high <math id="S5.SS3.p4.2.m2.1" class="ltx_Math" alttext="R^{2}" display="inline"><semantics id="S5.SS3.p4.2.m2.1a"><msup id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml"><mi id="S5.SS3.p4.2.m2.1.1.2" xref="S5.SS3.p4.2.m2.1.1.2.cmml">R</mi><mn id="S5.SS3.p4.2.m2.1.1.3" xref="S5.SS3.p4.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><apply id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.2.m2.1.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S5.SS3.p4.2.m2.1.1.2.cmml" xref="S5.SS3.p4.2.m2.1.1.2">𝑅</ci><cn type="integer" id="S5.SS3.p4.2.m2.1.1.3.cmml" xref="S5.SS3.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">R^{2}</annotation></semantics></math> values for the linear regression models, confirming <span id="S5.SS3.p4.2.1" class="ltx_text ltx_font_bold">the product of rounds and concurrency is a good proxy to predict the carbon footprint of synchronous FL</span>.</p>
</div>
<div id="S5.SS3.p5" class="ltx_para">
<p id="S5.SS3.p5.1" class="ltx_p">Figure <a href="#S5.F9" title="Figure 9 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows a similar linear regression model for asynchronous FL. Since there is no concept of rounds in asynchronous FL, we treat duration (hours to reach a target accuracy) as an explanatory variable for the carbon footprint of asynchronous FL. We also see high goodness of fit (<math id="S5.SS3.p5.1.m1.1" class="ltx_Math" alttext="R^{2}" display="inline"><semantics id="S5.SS3.p5.1.m1.1a"><msup id="S5.SS3.p5.1.m1.1.1" xref="S5.SS3.p5.1.m1.1.1.cmml"><mi id="S5.SS3.p5.1.m1.1.1.2" xref="S5.SS3.p5.1.m1.1.1.2.cmml">R</mi><mn id="S5.SS3.p5.1.m1.1.1.3" xref="S5.SS3.p5.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.1.m1.1b"><apply id="S5.SS3.p5.1.m1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.1.m1.1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1">superscript</csymbol><ci id="S5.SS3.p5.1.m1.1.1.2.cmml" xref="S5.SS3.p5.1.m1.1.1.2">𝑅</ci><cn type="integer" id="S5.SS3.p5.1.m1.1.1.3.cmml" xref="S5.SS3.p5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.1.m1.1c">R^{2}</annotation></semantics></math> values) for these models. Hence, <span id="S5.SS3.p5.1.1" class="ltx_text ltx_font_bold">the product of duration and concurrency is a good proxy to predict carbon footprint of asynchronous FL</span>.</p>
</div>
<div id="S5.SS3.p6" class="ltx_para">
<p id="S5.SS3.p6.1" class="ltx_p">The carbon footprint of an FL is proportional to concurrency and the number of rounds to convergence (or duration, in asynchronous FL). To estimate the carbon footprint prior to deployment, one needs to know their values as well as the coefficient of proportionality (i.e., the slope of the line in Figures <a href="#S5.F8" title="Figure 8 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S5.F9" title="Figure 9 ‣ 5.2 Some Parameters Matter More ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>). Concurrency is a hyper-parameter of FL. For estimating rounds (or duration) to convergence, FL practitioners can use FL simulation tools, which is a common practice in the industry. The proportionality coefficient depends on multiple factors, such as the FL task, user population, and the FL infrastructure. In practice, one can estimate this coefficient from a few data points, i.e., by measuring carbon emissions of a task in several settings.</p>
</div>
<div id="S5.SS3.p7" class="ltx_para">
<p id="S5.SS3.p7.1" class="ltx_p">In Figure <a href="#S5.F10" title="Figure 10 ‣ 5.3 Predicting Carbon Emissions of FL ‣ 5 Carbon Emissions of FL ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, we present an overview of the design space for Green Federated Learning (FL) and highlight the trade-off between time, performance, and carbon emissions in asynchronous FL (the design space for synchronous FL was previously illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The scatter plot depicts various training runs of the FL task conducted through asynchronous FL, with different marker colors and symbols representing distinct concurrency values. Each point represents an experiment with a different hyper-parameter; we group the points by concurrency. We observe that the points corresponding to the same concurrency follow a linear trajectory, where higher concurrency leads to a steeper slope, implying a faster rate of CO<sub id="S5.SS3.p7.1.1" class="ltx_sub">2</sub>e accumulation. The cumulative carbon footprint of the task is a function of both its running time and the rate of carbon emission increase. Our analysis identifies concurrency and time to convergence as the two critical parameters for carbon emissions. While the former is under the direct control of the FL engineer, the latter is more indirect and reliant on the appropriate selection of hyperparameters. In particular, the high concurrency regime (which may be desirable, for instance, for its more robust privacy guarantees) puts a higher premium on hyperparameter tuning as longer training time translates into a larger carbon footprint.</p>
</div>
<figure id="S5.F10" class="ltx_figure"><img src="/html/2303.14604/assets/x7.png" id="S5.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="273" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Carbon emissions of asynchronous FL increase linearly with the product of the time it takes to reach a target accuracy and concurrency. Each point represents a training run with a different hyper-parameter (grouped by concurrency with marker colors and symbols), its carbon emissions (Y axis, in kg CO<sub id="S5.F10.4.1" class="ltx_sub">2</sub>e) and the time it takes to reach a target accuracy (X axis, in hours). The more time is required to reach a target accuracy and the higher the concurrency, the higher is the carbon emission.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">To the best of our knowledge, our work is the first to conduct a large-scale carbon emission characterization of an industry-scale FL stack and different hyperparameters. We explore ways FL can be made more energy-efficient (“greener”) through the right selection of FL parameters and design choices.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">There has been growing interest in quantifying and reducing the carbon emission of machine learning (ML) training and inference in the datacenter <cite class="ltx_cite ltx_citemacro_citep">(Dodge et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Strubell et al., <a href="#bib.bib53" title="" class="ltx_ref">2020</a>; Patterson et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>; Anderson et al., <a href="#bib.bib4" title="" class="ltx_ref">2022</a>; Naidu et al., <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>. Nevertheless, the carbon footprint of FL has not yet been explored well. Prior works only quantify the carbon effect of FL in a simulation setting under several simplifying assumptions  <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al., <a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>. Other studies explore different ways for minimizing the energy footprint of client devices in Federated Learning <cite class="ltx_cite ltx_citemacro_citep">(Kim &amp; Wu, <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Abdelmoniem et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>; Kim &amp; Wu, <a href="#bib.bib29" title="" class="ltx_ref">2022</a>)</cite>, though not at large-scale scenarios like this study. Another work did a preliminary study of carbon emissions of FL <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2022</a>)</cite>; however, the authors also did not do their carbon emissions as comprehensively as our study does, as we log the FL session information and use the actual power measurements of the devices.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">We take a data-driven approach to quantify carbon emissions of FL by directly measuring a real-world FL task at scale. We present challenges, guidelines, and lessons learned from studying the trade-off between energy efficiency, performance, and time to train in a production FL system.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">Other related work could be the works on compression and quantization <cite class="ltx_cite ltx_citemacro_citep">(Rothchild et al., <a href="#bib.bib50" title="" class="ltx_ref">2020</a>; Vogels et al., <a href="#bib.bib56" title="" class="ltx_ref">2019</a>)</cite>. Compressing the communications between the server and the clients could further reduce the carbon emissions of the FL training pipeline while presumably maintaining high model utility. For instance, we observed that the carbon emissions of communication in some settings could contribute to up to 60% of the total emissions. Hence, reducing them by, say, a factor 4 with <span id="S6.p4.1.1" class="ltx_text ltx_font_typewriter">int8</span> <cite class="ltx_cite ltx_citemacro_citep">(Prasad et al., <a href="#bib.bib44" title="" class="ltx_ref">2022</a>)</cite> would reduce the total emissions by a factor of <math id="S6.p4.1.m1.1" class="ltx_Math" alttext="1/(.4+0.6/4)=1.82" display="inline"><semantics id="S6.p4.1.m1.1a"><mrow id="S6.p4.1.m1.1.1" xref="S6.p4.1.m1.1.1.cmml"><mrow id="S6.p4.1.m1.1.1.1" xref="S6.p4.1.m1.1.1.1.cmml"><mn id="S6.p4.1.m1.1.1.1.3" xref="S6.p4.1.m1.1.1.1.3.cmml">1</mn><mo id="S6.p4.1.m1.1.1.1.2" xref="S6.p4.1.m1.1.1.1.2.cmml">/</mo><mrow id="S6.p4.1.m1.1.1.1.1.1" xref="S6.p4.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.p4.1.m1.1.1.1.1.1.2" xref="S6.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.p4.1.m1.1.1.1.1.1.1" xref="S6.p4.1.m1.1.1.1.1.1.1.cmml"><mn id="S6.p4.1.m1.1.1.1.1.1.1.2" xref="S6.p4.1.m1.1.1.1.1.1.1.2.cmml">.4</mn><mo id="S6.p4.1.m1.1.1.1.1.1.1.1" xref="S6.p4.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.p4.1.m1.1.1.1.1.1.1.3" xref="S6.p4.1.m1.1.1.1.1.1.1.3.cmml"><mn id="S6.p4.1.m1.1.1.1.1.1.1.3.2" xref="S6.p4.1.m1.1.1.1.1.1.1.3.2.cmml">0.6</mn><mo id="S6.p4.1.m1.1.1.1.1.1.1.3.1" xref="S6.p4.1.m1.1.1.1.1.1.1.3.1.cmml">/</mo><mn id="S6.p4.1.m1.1.1.1.1.1.1.3.3" xref="S6.p4.1.m1.1.1.1.1.1.1.3.3.cmml">4</mn></mrow></mrow><mo stretchy="false" id="S6.p4.1.m1.1.1.1.1.1.3" xref="S6.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.p4.1.m1.1.1.2" xref="S6.p4.1.m1.1.1.2.cmml">=</mo><mn id="S6.p4.1.m1.1.1.3" xref="S6.p4.1.m1.1.1.3.cmml">1.82</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p4.1.m1.1b"><apply id="S6.p4.1.m1.1.1.cmml" xref="S6.p4.1.m1.1.1"><eq id="S6.p4.1.m1.1.1.2.cmml" xref="S6.p4.1.m1.1.1.2"></eq><apply id="S6.p4.1.m1.1.1.1.cmml" xref="S6.p4.1.m1.1.1.1"><divide id="S6.p4.1.m1.1.1.1.2.cmml" xref="S6.p4.1.m1.1.1.1.2"></divide><cn type="integer" id="S6.p4.1.m1.1.1.1.3.cmml" xref="S6.p4.1.m1.1.1.1.3">1</cn><apply id="S6.p4.1.m1.1.1.1.1.1.1.cmml" xref="S6.p4.1.m1.1.1.1.1.1"><plus id="S6.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.1"></plus><cn type="float" id="S6.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.2">.4</cn><apply id="S6.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.3"><divide id="S6.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.3.1"></divide><cn type="float" id="S6.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.3.2">0.6</cn><cn type="integer" id="S6.p4.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S6.p4.1.m1.1.1.1.1.1.1.3.3">4</cn></apply></apply></apply><cn type="float" id="S6.p4.1.m1.1.1.3.cmml" xref="S6.p4.1.m1.1.1.3">1.82</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.1.m1.1c">1/(.4+0.6/4)=1.82</annotation></semantics></math>.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions and Future Work</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we demonstrate how different FL parameters and design choices can impact the carbon footprint of a production FL system. Our empirical approach quantifies carbon emissions by directly profiling a real-world at-scale FL task. These measurements inform our guidelines and lessons learned on the trade-off between carbon emissions, target accuracy, and time to train in a production FL system.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">We acknowledge that this study, like any, has some limitations. Recall that we used the power profiles of the 210 most commonly seen device models to obtain estimates of upload, download, and compute power for typical devices. We noted that these 210 devices represent 20% of the total devices participating. The carbon emissions values we report based on these values are estimates. Although it is possible that the absolute carbon emissions would change if power profiles for additional devices were available, we believe that the same trends and overall conclusions hold.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">As future research directions, we suggest investigating how compression and quantization techniques could apply to Green FL, potentially reducing the carbon footprint of the communication stack (at the expense of increasing client-side computations). Moreover, accounting for GPU or NPU resources is an interesting point when considering other FL tasks (e.g., computer vision) at scale. Alternative FL architectures, such as secure aggregation via cryptographic computations, federated ensemble learning, or federated split learning, present intriguing challenges as well. Moreover, unbiased optimization strategies with regards to geography and heterogeneity, while preserving fairness (as discussed in Section <a href="#S4.SS1" title="4.1 End-user Device Resource Measurements ‣ 4 Measurement Methodology ‣ Green Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) can be explored. Additionally, we encourage the research community to consider the impacts of differential privacy on the landscape of Green FL. Differential privacy would introduce privacy as an additional criterion, alongside accuracy, carbon, and time. Finally, we urge FL practitioners to consider the carbon footprint of their systems in their decision-making process.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to thank Pavel Ustinov, Kunal Bhalla, and Vlad Grytsun for the discussions and their invaluable help in this work; Harish Srinivas, Sam Lurye, Anthony Shoumikhin, Kaikai Wang, and Dweep Gogia for their continued support and for sharing their expertise; Karthik Prasad, Graham Cormode, Ramya Raghavendra, Arnald Shaju Samthambi, and John Nguyen for their insightful ideas and comments. We also like to thank Grace Nichols, Ajay Chand, Jesse He, Riten Gupta, Bharati Sethiya, and Gilbert Sanchez for helping us in mobile phone measurements.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abdelmoniem et al. (2023)</span>
<span class="ltx_bibblock">
Abdelmoniem, A. M., Sahu, A. N., Canini, M., and Fahmy, S. A.

</span>
<span class="ltx_bibblock">Refl: Resource efficient federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ACM EuroSys</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almeida et al. (2021)</span>
<span class="ltx_bibblock">
Almeida, M., Laskaridis, S., Mehrotra, A., Dudziak, L., Leontiadis, I., and
Lane, N. D.

</span>
<span class="ltx_bibblock">Smart at what cost? characterising mobile deep neural networks in the
wild.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 21st ACM Internet Measurement
Conference</em>, pp.  658–672, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
Amazon.

</span>
<span class="ltx_bibblock">Sustainability in the cloud.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://sustainability.aboutamazon.com/environment/the-cloud" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://sustainability.aboutamazon.com/environment/the-cloud</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2022)</span>
<span class="ltx_bibblock">
Anderson, T., Belay, A., Chowdhury, M., Cidon, A., and Zhang, I.

</span>
<span class="ltx_bibblock">Treehouse: A case for carbon-aware datacenter software.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Workshop on Sustainable Computer Systems Design and
Implementation</em>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Android (a)</span>
<span class="ltx_bibblock">
Android.

</span>
<span class="ltx_bibblock">Power profiles for Android, a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://source.android.com/docs/core/power" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://source.android.com/docs/core/power</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Android (b)</span>
<span class="ltx_bibblock">
Android.

</span>
<span class="ltx_bibblock">Measuring power values for Android, b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://source.android.com/docs/core/power/values" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://source.android.com/docs/core/power/values</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baliga et al. (2011)</span>
<span class="ltx_bibblock">
Baliga, J., Ayre, R. W., Hinton, K., and Tucker, R. S.

</span>
<span class="ltx_bibblock">Green cloud computing: Balancing energy in processing, storage, and
transport.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 99(1):149–167,
2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2016)</span>
<span class="ltx_bibblock">
Bonawitz, K. A., Ivanov, V., Kreuter, B., Marcedone, A., McMahan, H. B., Patel,
S., Ramage, D., Segal, A., and Seth, K.

</span>
<span class="ltx_bibblock">Practical secure aggregation for federated learning on user-held
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">NIPS Workshop on Private Multi-Party Machine Learning</em>,
2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Bonawitz, K. A., Eichner, H., Grieskamp, W., Huba, D., Ingerman, A., Ivanov,
V., Kiddon, C. M., Konečný, J., Mazzocchi, S., McMahan, B., Overveldt,
T. V., Petrou, D., Ramage, D., and Roselander, J.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems (SysML)</em>,
1:374–388, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bustamante &amp; Livshits (2022)</span>
<span class="ltx_bibblock">
Bustamante, F. and Livshits, B.

</span>
<span class="ltx_bibblock">Batterylab: a collaborative platform for power monitoring.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Passive and Active Measurement: 23rd International
Conference, PAM 2022, Proceedings</em>, volume 13210, pp.  97. Springer Nature,
2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al. (2018)</span>
<span class="ltx_bibblock">
Caldas, S., Wu, P., Li, T., Konečný, J., McMahan, H. B., Smith, V.,
and Talwalkar, A.

</span>
<span class="ltx_bibblock">LEAF: A benchmark for federated settings.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charles et al. (2021)</span>
<span class="ltx_bibblock">
Charles, Z., Garrett, Z., Huo, Z., Shmulyian, S., and Smith, V.

</span>
<span class="ltx_bibblock">On large-cohort training for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
34:20461–20475, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2019)</span>
<span class="ltx_bibblock">
Choi, D., Shallue, C. J., Nado, Z., Lee, J., Maddison, C. J., and Dahl, G. E.

</span>
<span class="ltx_bibblock">On empirical comparisons of optimizers for deep learning.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Couto et al. (2015)</span>
<span class="ltx_bibblock">
Couto, M., Cunha, J., Fernandes, J. P., Pereira, R., and Saraiva, J.

</span>
<span class="ltx_bibblock">Greendroid: A tool for analysing power consumption in the android
ecosystem.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2015 IEEE 13th International Scientific Conference on
Informatics</em>, pp.  73–78. IEEE, 2015.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dodge et al. (2022)</span>
<span class="ltx_bibblock">
Dodge, J., Prewitt, T., des Combes, R. T., Odmark, E., Schwartz, R., Strubell,
E., Luccioni, A. S., Smith, N. A., DeCario, N., and Buchanan, W.

</span>
<span class="ltx_bibblock">Measuring the carbon intensity of AI in cloud instances.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">FAccT ’22: 2022 ACM Conference on Fairness,
Accountability</em>, pp.  1877–1894. ACM, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(16)</span>
<span class="ltx_bibblock">
Exynoobs.

</span>
<span class="ltx_bibblock">Exynoobs repository.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/Exynoobs" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/Exynoobs</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(17)</span>
<span class="ltx_bibblock">
Google.

</span>
<span class="ltx_bibblock">Google Cloud sustainability.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://cloud.google.com/sustainability" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://cloud.google.com/sustainability</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Halpern et al. (2016)</span>
<span class="ltx_bibblock">
Halpern, M., Zhu, Y., and Reddi, V. J.

</span>
<span class="ltx_bibblock">Mobile cpu’s rise to power: Quantifying the impact of generational
mobile cpu design trends on performance, energy, and user satisfaction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">2016 IEEE International Symposium on High Performance
Computer Architecture (HPCA)</em>, pp.  64–76. IEEE, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(19)</span>
<span class="ltx_bibblock">
Hamilton, I.

</span>
<span class="ltx_bibblock">Oculus Quest keyboard option sends ‘Aggregate Modeling Data’
to Facebook.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://uploadvr.com/facebook-quest-keyboard-data/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://uploadvr.com/facebook-quest-keyboard-data/</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao (2019)</span>
<span class="ltx_bibblock">
Hao, K.

</span>
<span class="ltx_bibblock">How Apple personalizes Siri without hoovering up your data.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">MIT Technology Review</em>, December 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.technologyreview.com/2019/12/11/131629/apple-ai-personalizes-siri-federated-learning/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.technologyreview.com/2019/12/11/131629/apple-ai-personalizes-siri-federated-learning/</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huba et al. (2022)</span>
<span class="ltx_bibblock">
Huba, D., Nguyen, J., Malik, K., Zhu, R., Rabbat, M., Yousefpour, A., Wu,
C.-J., Zhan, H., Ustinov, P., Srinivas, H., et al.

</span>
<span class="ltx_bibblock">Papaya: Practical, private, and scalable federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 4:814–832, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">IPCC (2021)</span>
<span class="ltx_bibblock">
IPCC.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Climate Change 2021: The Physical Science Basis. Contribution
of Working Group I to the Sixth Assessment Report of the Intergovernmental
Panel on Climate Change</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jalali et al. (2014)</span>
<span class="ltx_bibblock">
Jalali, F., Ayre, R., Vishwanath, A., Hinton, K., Alpcan, T., and Tucker, R.

</span>
<span class="ltx_bibblock">Energy consumption of content distribution from nano data centers
versus centralized data centers.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ACM SIGMETRICS Performance Evaluation Review</em>, 42(3):49–54, 2014.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2019)</span>
<span class="ltx_bibblock">
Jiang, Y., Wang, S., Ko, B. J., Lee, W., and Tassiulas, L.

</span>
<span class="ltx_bibblock">Model pruning enables efficient federated learning on edge devices.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N.,
Bonawitz, K. A., Charles, Z., Cormode, G., Cummings, R., D’Oliveira, R.
G. L., Eichner, H., Rouayheb, S. E., Evans, D., Gardner, J., Garrett, Z.,
Gascón, A., Ghazi, B., Gibbons, P. B., Gruteser, M., Harchaoui, Z., He,
C., He, L., Huo, Z., Hutchinson, B., Hsu, J., Jaggi, M., Javidi, T., Joshi,
G., Khodak, M., Konečný, J., Korolova, A., Koushanfar, F., Koyejo,
S., Lepoint, T., Liu, Y., Mittal, P., Mohri, M., Nock, R., Özgür,
A., Pagh, R., Qi, H., Ramage, D., Raskar, R., Raykova, M., Song, D., Song,
W., Stich, S. U., Sun, Z., Suresh, A. T., Tramèr, F., Vepakomma, P.,
Wang, J., Xiong, L., Xu, Z., Yang, Q., Yu, F. X., Yu, H., and Zhao, S.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Found. Trends Mach. Learn.</em>, 14(1-2):1–210, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1561/2200000083</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1561/2200000083" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1561/2200000083</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2016)</span>
<span class="ltx_bibblock">
Kim, Y., Jernite, Y., Sontag, D., and Rush, A. M.

</span>
<span class="ltx_bibblock">Character-aware neural language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirtieth AAAI Conference on Artificial
Intelligence</em>, AAAI’16, pp.  2741–2749. AAAI Press, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim &amp; Wu (2020)</span>
<span class="ltx_bibblock">
Kim, Y. G. and Wu, C.-J.

</span>
<span class="ltx_bibblock">Autoscale: Energy efficiency optimization for stochastic edge
inference using reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">2020 53rd Annual IEEE/ACM International Symposium on
Microarchitecture (MICRO)</em>, pp.  1082–1096. IEEE, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim &amp; Wu (2021)</span>
<span class="ltx_bibblock">
Kim, Y. G. and Wu, C.-J.

</span>
<span class="ltx_bibblock">Autofl: Enabling heterogeneity-aware energy efficient federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">MICRO-54: 54th Annual IEEE/ACM International Symposium on
Microarchitecture</em>, pp.  183–198, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim &amp; Wu (2022)</span>
<span class="ltx_bibblock">
Kim, Y. G. and Wu, C.-J.

</span>
<span class="ltx_bibblock">FedGPO: Heterogeneity-aware global parameter optimization for
efficient federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">2022 IEEE International Symposium on Workload
Characterization (IISWC)</em>, pp.  117–129. IEEE, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečný et al. (2016)</span>
<span class="ltx_bibblock">
Konečný, J., McMahan, H. B., Yu, F. X., Richtarik, P., Suresh, A. T., and
Bacon, D.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">NIPS Workshop on Private Multi-Party Machine Learning</em>,
2016.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lacoste et al. (2019)</span>
<span class="ltx_bibblock">
Lacoste, A., Luccioni, A., Schmidt, V., and Dandres, T.

</span>
<span class="ltx_bibblock">Quantifying the carbon emissions of machine learning.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(32)</span>
<span class="ltx_bibblock">
LineageOS.

</span>
<span class="ltx_bibblock">LineageOS Repository.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/LineageOS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/LineageOS</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2018)</span>
<span class="ltx_bibblock">
McMahan, H. B., Ramage, D., Talwar, K., and Zhang, L.

</span>
<span class="ltx_bibblock">Learning differentially private recurrent language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meta (a)</span>
<span class="ltx_bibblock">
Meta.

</span>
<span class="ltx_bibblock">Meta data centers, a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://datacenters.fb.com" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://datacenters.fb.com</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meta (b)</span>
<span class="ltx_bibblock">
Meta.

</span>
<span class="ltx_bibblock">Meta data centers sustainability, b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://sustainability.fb.com/data-centers/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://sustainability.fb.com/data-centers/</a>.

</span>
<span class="ltx_bibblock">Jan 6, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
Motorola Common.

</span>
<span class="ltx_bibblock">Motorola common repository.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/moto-common" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/moto-common</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naidu et al. (2021)</span>
<span class="ltx_bibblock">
Naidu, R., Diddee, H., Mulay, A., Vardhan, A., Ramesh, K., and Zamzam, A.

</span>
<span class="ltx_bibblock">Towards quantifying the carbon emissions of differentially private
machine learning.

</span>
<span class="ltx_bibblock">2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Network (2015)</span>
<span class="ltx_bibblock">
Network, D.

</span>
<span class="ltx_bibblock">Smartphone batteries: Better but no breakthrough.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Deloitte Touche Tohmatsu Limited, London</em>, 2015.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2022)</span>
<span class="ltx_bibblock">
Nguyen, J., Malik, K., Zhan, H., Yousefpour, A., Rabbat, M., Malek, M., and
Huba, D.

</span>
<span class="ltx_bibblock">Federated learning with buffered asynchronous aggregation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  3581–3607. PMLR, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oliner et al. (2013)</span>
<span class="ltx_bibblock">
Oliner, A. J., Iyer, A. P., Stoica, I., Lagerspetz, E., and Tarkoma, S.

</span>
<span class="ltx_bibblock">Carat: Collaborative energy diagnosis for mobile devices.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 11th ACM conference on embedded networked
sensor systems</em>, pp.  1–14, 2013.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patterson et al. (2022)</span>
<span class="ltx_bibblock">
Patterson, D., Gonzalez, J., Hölzle, U., Le, Q., Liang, C., Munguia, L.-M.,
Rothchild, D., So, D. R., Texier, M., and Dean, J.

</span>
<span class="ltx_bibblock">The carbon footprint of machine learning training will plateau, then
shrink.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">IEEE Computer</em>, 55(7):18–28, 2022.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paulik et al. (2021)</span>
<span class="ltx_bibblock">
Paulik, M., Seigel, M., Mason, H., Telaar, D., Kluivers, J., van Dalen, R. C.,
Lau, C. W., Carlson, L., Granqvist, F., Vandevelde, C., Agarwal, S.,
Freudiger, J., Byde, A., Bhowmick, A., Kapoor, G., Beaumont, S., Cahill,
Á., Hughes, D., Javidbakht, O., Dong, F., Rishi, R., and Hung, S.

</span>
<span class="ltx_bibblock">Federated evaluation and tuning for on-device personalization:
System design &amp; applications.

</span>
<span class="ltx_bibblock">2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(43)</span>
<span class="ltx_bibblock">
PixelPlusUI Devices.

</span>
<span class="ltx_bibblock">PixelPlusUI devices repository.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/PixelPlusUI-Devices" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/PixelPlusUI-Devices</a>.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prasad et al. (2022)</span>
<span class="ltx_bibblock">
Prasad, K., Ghosh, S., Cormode, G., Mironov, I., Yousefpour, A., and Stock, P.

</span>
<span class="ltx_bibblock">Reconciling security and communication efficiency in federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">FL-NeurIPS’22</em>, December 2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. (2021)</span>
<span class="ltx_bibblock">
Qiu, X., Parcollet, T., Fernandez-Marques, J., de Gusmao, P. P. B., Gao, Y.,
Beutel, D. J., Topal, T., Mathur, A., and Lane, N. D.

</span>
<span class="ltx_bibblock">A first look into the carbon footprint of federated learning.

</span>
<span class="ltx_bibblock">2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Reddi, S. J., Charles, Z., Zaheer, M., Garrett, Z., Rush, K.,
Konečný, J., Kumar, S., and McMahan, H. B.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ritchie (2020)</span>
<span class="ltx_bibblock">
Ritchie, H.

</span>
<span class="ltx_bibblock">The carbon footprint of foods: are differences explained by the
impacts of methane?, March 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://ourworldindata.org/carbon-footprint-food-methane" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ourworldindata.org/carbon-footprint-food-methane</a>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ritchie et al. (2020)</span>
<span class="ltx_bibblock">
Ritchie, H., Roser, M., and Rosado, P.

</span>
<span class="ltx_bibblock">CO<sub id="bib.bib48.2.1" class="ltx_sub">2</sub> and greenhouse gas emissions.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.3.1" class="ltx_emph ltx_font_italic">Our World in Data</em>, 2020.

</span>
<span class="ltx_bibblock">https://ourworldindata.org/co2-and-other-greenhouse-gas-emissions.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rolnick et al. (2022)</span>
<span class="ltx_bibblock">
Rolnick, D., Donti, P. L., Kaack, L. H., Kochanski, K., Lacoste, A., Sankaran,
K., Ross, A. S., Milojevic-Dupont, N., Jaques, N., Waldman-Brown, A., et al.

</span>
<span class="ltx_bibblock">Tackling climate change with machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>, 55(2):1–96,
2022.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rothchild et al. (2020)</span>
<span class="ltx_bibblock">
Rothchild, D., Panda, A., Ullah, E., Ivkin, N., Stoica, I., Braverman, V.,
Gonzalez, J., and Arora, R.

</span>
<span class="ltx_bibblock">FetchSGD: Communication-efficient federated learning with
sketching.

</span>
<span class="ltx_bibblock">In <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 8253–8265. PMLR, 2020.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schwartz et al. (2020)</span>
<span class="ltx_bibblock">
Schwartz, R., Dodge, J., Smith, N. A., and Etzioni, O.

</span>
<span class="ltx_bibblock">Green AI.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 63(12):54–63,
2020.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sevilla et al. (2022)</span>
<span class="ltx_bibblock">
Sevilla, J., Heim, L., Ho, A., Besiroglu, T., Hobbhahn, M., and Villalobos, P.

</span>
<span class="ltx_bibblock">Compute trends across three eras of machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">2022 International Joint Conference on Neural Networks
(IJCNN)</em>, pp.  1–8, 2022.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Strubell et al. (2020)</span>
<span class="ltx_bibblock">
Strubell, E., Ganesh, A., and McCallum, A.

</span>
<span class="ltx_bibblock">Energy and policy considerations for modern deep learning research.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
34(09):13693–13696, April 2020.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(54)</span>
<span class="ltx_bibblock">
United Nations.

</span>
<span class="ltx_bibblock">Causes and effects of climate change.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.un.org/en/climatechange/science/causes-effects-climate-change" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.un.org/en/climatechange/science/causes-effects-climate-change</a>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vishwanath et al. (2015)</span>
<span class="ltx_bibblock">
Vishwanath, A., Jalali, F., Hinton, K., Alpcan, T., Ayre, R. W., and Tucker,
R. S.

</span>
<span class="ltx_bibblock">Energy consumption comparison of interactive cloud-based and local
applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">IEEE Journal on selected areas in communications</em>, 33(4):616–626, 2015.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vogels et al. (2019)</span>
<span class="ltx_bibblock">
Vogels, T., Karimireddy, S. P., and Jaggi, M.

</span>
<span class="ltx_bibblock">PowerSGD: Practical low-rank gradient compression for distributed
optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 33rd International Conference on Neural
Information Processing Systems</em>, pp.  14269–14278, 2019.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Wang, E., Kannan, A., Liang, Y., Chen, B., and Chowdhury, M.

</span>
<span class="ltx_bibblock">FLINT: A platform for federated learning integration.

</span>
<span class="ltx_bibblock">2023.

</span>
<span class="ltx_bibblock">To appear in MLSys 2023.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2019)</span>
<span class="ltx_bibblock">
Wu, C.-J., Brooks, D., Chen, K., Chen, D., Choudhury, S., Dukhan, M.,
Hazelwood, K., Isaac, E., Jia, Y., Jia, B., et al.

</span>
<span class="ltx_bibblock">Machine learning at Facebook: Understanding inference at the
edge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">2019 IEEE international symposium on high performance
computer architecture (HPCA)</em>, pp.  331–344. IEEE, 2019.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Wu, C.-J., Raghavendra, R., Gupta, U., Acun, B., Ardalani, N., Maeng, K.,
Chang, G., Aga, F., Huang, J., Bai, C., et al.

</span>
<span class="ltx_bibblock">Sustainable AI: Environmental implications, challenges and
opportunities.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 4:795–813, 2022.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2013)</span>
<span class="ltx_bibblock">
Xiao, Y., Cui, Y., Savolainen, P., Siekkinen, M., Wang, A., Yang, L.,
Ylä-Jääski, A., and Tarkoma, S.

</span>
<span class="ltx_bibblock">Modeling energy consumption of data transmission over Wi-Fi.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Mobile Computing</em>, 13(8):1760–1773, 2013.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Yang, T., Andrew, G., Eichner, H., Sun, H., Li, W., Kong, N., Ramage, D., and
Beaufays, F.

</span>
<span class="ltx_bibblock">Applied federated learning: Improving Google keyboard query
suggestions.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.14603" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.14604" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.14604">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.14604" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.14605" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 17:40:57 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
