<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2211.14450] Text-Aware Dual Routing Network for Visual Question Answering</title><meta property="og:description" content="Visual question answering (VQA) is a challenging task to provide an accurate natural language answer given an image and a natural language question about the image. It involves multi-modal learning, i.e., computer visi…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Text-Aware Dual Routing Network for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Text-Aware Dual Routing Network for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2211.14450">

<!--Generated on Thu Mar 14 05:01:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Text-Aware Dual Routing Network for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Luoqian Jiang<span id="id1.1.id1" class="ltx_ERROR undefined">\equalcontrib</span>,
Yifan He<span id="id2.2.id2" class="ltx_ERROR undefined">\equalcontrib</span>,
Jian Chen
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Visual question answering (VQA) is a challenging task to provide an accurate natural language answer given an image and a natural language question about the image. It involves multi-modal learning, i.e., computer vision (CV) and natural language processing (NLP), as well as flexible answer prediction for free-form and open-ended answers. Existing approaches often fail in cases that require reading and understanding text in images to answer questions. In practice, they cannot effectively handle the answer sequence derived from text tokens because the visual features are not text-oriented. To address the above issues, we propose a Text-Aware Dual Routing Network (TDR) which simultaneously handles the VQA cases with and without understanding text information in the input images. Specifically, we build a two-branch answer prediction network that contains a specific branch for each case and further develop a dual routing scheme to dynamically determine which branch should be chosen. In the branch that involves text understanding, we incorporate the Optical Character Recognition (OCR) features into the model to help understand the text in the images. Extensive experiments on the VQA v2.0 dataset demonstrate that our proposed TDR outperforms existing methods, especially on the “number” related VQA questions.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Deep neural networks have been the workhorse of many real-world applications, including image classification <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib13" title="" class="ltx_ref">2020b</a>, <a href="#bib.bib16" title="" class="ltx_ref">2019</a>; Guo, Stutz, and Schiele <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, language modeling <cite class="ltx_cite ltx_citemacro_citep">(Dai and Callan <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite>, and many other areas <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al. <a href="#bib.bib9" title="" class="ltx_ref">2020</a>; Guo et al. <a href="#bib.bib12" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite>.
Recently, Visual Question Answering (VQA) has become an important task that combines the knowledge of computer vision and natural language processing. It has a high research value as well as a broad range of application scenarios (<em id="Sx1.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, graphic reading, aided navigation for the blind, and medical consultation). Typically, a VQA model takes an image and a free-form, open-ended question as input and generates a reasonable answer based on visual information and natural language rules. The VQA task is extremely challenging. It involves the representation learning of different modalities (<em id="Sx1.p1.1.2" class="ltx_emph ltx_font_italic">i.e.</em>, visual and linguistic modality), cross-modal fusion, and diverse answer generations. In general, there are two great challenges to be solved for the VQA task.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">First, it is non-trivial to explore the visual information from a given image. For example, many existing methods <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2017</a>; Ma et al. <a href="#bib.bib27" title="" class="ltx_ref">2018</a>; Hong et al. <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite> use logit (<em id="Sx1.p2.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, feature from the highest layer of CNN) as their visual representation, which, however, is biased towards object classification tasks, and neglects the low-level semantics such as color, texture, and number of instances. To alleviate this issue, the most recent work namely VinVL <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> obtains richer visual features by a powerful object detection model optimized with more data and annotations. Nevertheless, as VinVL considers object features only, it is hard to read and understand text in the given image, which is crucial and can not be ignored in many real-world scenes, <em id="Sx1.p2.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, signs and titles. In this sense, how to capture abundant visual features from images is one of the most important problems in the VQA task.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Second, how to formulate the answer prediction pattern in the VQA task still remains an open question. Specifically, to handle the answer prediction part, many recent works (<em id="Sx1.p3.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>; Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>) cast the answer prediction in VQA as a multi-label classification problem. However, with such an oversimplified problem setting, the models can only choose the answers from a predefined and fixed-length candidate set (<em id="Sx1.p3.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, with 3129 candidate answers), which is extremely small and can not cover all the answers in the real world. As a result, the limited number of answer candidates would further hamper the model performance as the model can only select the most likely answer in the candidate set regardless of whether this answer is true. Thus, a suitable pattern of the answer prediction is vital and necessary.</p>
</div>
<figure id="Sx1.F1" class="ltx_figure">
<p id="Sx1.F1.1" class="ltx_p ltx_align_center"><span id="Sx1.F1.1.1" class="ltx_text">
<img src="/html/2211.14450/assets/x1.png" id="Sx1.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="191" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The procedure of handling the VQA task by our TDR model. Compared to the previous work, <em id="Sx1.F1.3.1" class="ltx_emph ltx_font_italic">e.g.</em>, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>, our model can read the text in images. Furthermore, it employs a two-branch learning scheme and adaptively selects the final answer for different instances. Please refer to Section 3 for more details.</figcaption>
</figure>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">To overcome these challenges and improve performance on the VQA task, we propose a Text-Aware Dual Routing Network (TDR). We use rich object-level region features from VinVL <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> to capture appearance information from images. Because appearance information alone cannot describe the semantic information of text in images, we introduce abundant Optical Character Recognition (OCR) features as compensation. To improve visual-linguistic alignment, we organize the object tags in Oscar <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>. The model can now observe images on a more comprehensive level thanks to the improved visual representations. To increase the flexibility in answer prediction, we propose a dual routing prediction module that incorporates a two-branch answer prediction network (<em id="Sx1.p4.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, a classifier and a dynamic pointer network) and a gating network. In this way, our method is not only capable of tackling general question types, but also expert in dealing with text-reading instances. In general cases, the classifier can choose a frequent answer from the candidate set. When the instance requires an answer from the text information, we propose a dynamic pointer network to copy some OCR tokens and form an answer sequence step by step during the decoding process. The gating network activates a best-match answer for each instance adaptively. Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts an intuitive procedure of our TDR model.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">Our contributions are summarized as follows:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">We use abundant visual representations to provide a comprehensive view of images. We not only utilize richer object-level region features but also introduce OCR features as compensation on the semantic level.</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">We propose a dual routing prediction module in which we elaborately tackle text-reading and general cases with a two-branch answer prediction network. Specifically, a gating network serves as a dynamic router to activate the final answer from these two branches for each instance.</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">Extensive experiments on the VQA v2.0 dataset demonstrate the superiority of our proposed method. Compared with the SoTA<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>, our method achieves 4% higher accuracy on “number” answer-type instances.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Text-Based Visual Question Answering</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">These years have seen prosperous development in the VQA task <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>; Lu et al. <a href="#bib.bib25" title="" class="ltx_ref">2019</a>; Tan and Bansal <a href="#bib.bib33" title="" class="ltx_ref">2019</a>; Hu and Singh <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>. Text-based VQA is a sub-task of VQA that involves reading and reasoning about the text in images. To address this issue, several methods have been proposed. LoRRA <cite class="ltx_cite ltx_citemacro_citep">(Singh et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite> attends to objects and text relevant to the question, and then chooses an answer from a fixed-length candidate set or OCR tokens with the highest attention weight. However, LoRRA predicts in a single step and cannot combine multiple tokens to form an answer sequence. To overcome this limitation, M4C <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite> proposes a flexible pointer network to generate answers in multiple steps, with each step copied from an OCR token or a fixed vocabulary. After that, some M4C-based variants go a step further. LaAP-Net <cite class="ltx_cite ltx_citemacro_citep">(Han, Huang, and Han <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> uses text location as evidence to generate answers. Zhu <span id="Sx2.SSx1.p1.1.1" class="ltx_text ltx_font_italic">et al.</span>  <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite> design separate attention branches for visual and linguistic parts of text features to fuse pairwise modalities. Different from them, we use abundant visual features from object level and semantic level for image understanding. We also develop a dual routing module for answer prediction and further improve the model performance.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Pointer Networks</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">For instances involving text-reading (<em id="Sx2.SSx2.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, signs and titles) in the VQA dataset, the answers mainly come from the input OCR tokens. Pointer Networks <cite class="ltx_cite ltx_citemacro_citep">(Vinyals, Fortunato, and Jaitly <a href="#bib.bib35" title="" class="ltx_ref">2015</a>)</cite> generates outputs by directly copying from the input sequence, which is not limited by a fixed-length candidate set and thus addresses the out-of-vocabulary (OOV) problem. Pointer Networks has been validated on text summarization <cite class="ltx_cite ltx_citemacro_citep">(Nallapati et al. <a href="#bib.bib28" title="" class="ltx_ref">2016</a>)</cite>, machine translation <cite class="ltx_cite ltx_citemacro_citep">(Gu et al. <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite>, image captioning <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib26" title="" class="ltx_ref">2018</a>)</cite> and other tasks. Recently, Pointer Networks and its variants are applying to text-based VQA tasks. LoRRA <cite class="ltx_cite ltx_citemacro_citep">(Singh et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite> adds dynamic OCR tokens to the candidate set for classification. M4C <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite> incorporates the pointer network in iterative decoding, allowing each step to select an answer from the candidate set or copy a token from OCR tokens. Since the text-sensitive answers are rarely found in the candidate set, we devise a dynamic pointer network to reorganize OCR tokens into a correct answer sequence.</p>
</div>
</section>
<section id="Sx2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Dynamic Neural Networks</h3>

<div id="Sx2.SSx3.p1" class="ltx_para">
<p id="Sx2.SSx3.p1.1" class="ltx_p">Dynamic neural networks incorporate multiple candidate modules, each of which is expert in handling different instances. A gating network is used to selectively activate these modules conditioned on the input instances <cite class="ltx_cite ltx_citemacro_citep">(Han et al. <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. Mixture of Experts (MoE) <cite class="ltx_cite ltx_citemacro_citep">(Shazeer et al. <a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite> takes this approach by dynamically routing instances to different experts and achieves computation allocation. Lioutas <span id="Sx2.SSx3.p1.1.1" class="ltx_text ltx_font_italic">et al.</span>  <cite class="ltx_cite ltx_citemacro_citep">(Lioutas, Passalis, and Tefas <a href="#bib.bib24" title="" class="ltx_ref">2018</a>)</cite> employ a diverse group of attention experts to provide more reliable attention information than a single attention model. N. Patro <span id="Sx2.SSx3.p1.1.2" class="ltx_text ltx_font_italic">et al.</span>  <cite class="ltx_cite ltx_citemacro_citep">(Patro et al. <a href="#bib.bib29" title="" class="ltx_ref">2020</a>)</cite> use a mix of experts to generate visual questions by combining multiple visual and language cues. Wang <span id="Sx2.SSx3.p1.1.3" class="ltx_text ltx_font_italic">et al.</span>  <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> propose to encode different input modalities by modality-specific experts. Concerning the VQA task, we find that while OCR sequence answers generally require multiple steps to generate, other answer phrases can be selected from the candidate set in a single step, implying that these two cases can be solved separately. Thus, we propose a dual routing prediction module containing two experts (<em id="Sx2.SSx3.p1.1.4" class="ltx_emph ltx_font_italic">i.e.</em>, a classifier and a dynamic pointer network), and then use a gating network to activate a best-match answer generated by these two experts.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Method</h2>

<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Overall Framework</h3>

<figure id="Sx3.F2" class="ltx_figure">
<p id="Sx3.F2.1" class="ltx_p ltx_align_center"><span id="Sx3.F2.1.1" class="ltx_text">
<img src="/html/2211.14450/assets/x2.png" id="Sx3.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="249" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The architecture of our TDR model. In the input phase, we enhance the visual representations with abundant object features and OCR features. The input entities are all projected into a low-dimensional space before being fed into transformer layers for cross-modal fusion. Then, we propose a dual routing prediction module in which two experts are developed: a classifier for multi-label classification tasks and a dynamic pointer network to generate answers from OCR tokens via an iterative decoding process. Finally, we use a gating network to activate a best-match answer for each instance.</figcaption>
</figure>
<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.1" class="ltx_p">In this paper, we propose a Text-Aware Dual Routing Network (TDR) which simultaneously handles the
VQA cases with and without understanding text information in the input images. Given an image and a related question, we first improve the visual representations for image understanding by utilizing richer object-level region features and elaborate OCR features. Then, we feed all of the input features into Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite> for cross-modal interaction. To enhance the intelligence of our model, we propose a dual routing prediction module composed of a gating network and two experts, namely a classifier for selecting answers from the candidate set and a dynamic pointer network that generates answers from OCR tokens through an iterative decoding process. Finally, we employ a gating network to activate a best-match answer for each instance. The overall architecture of our proposed method is shown in Figure <a href="#Sx3.F2" title="Figure 2 ‣ Overall Framework ‣ Method ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Visual Representation</h3>

<section id="Sx3.SSx2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Object Feature</h4>

<div id="Sx3.SSx2.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p1.5" class="ltx_p">Visual representations are essential for the advancement of VQA tasks. However, many methods rely on region features proposed in <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite> to identify salient regions from detected objects without further optimizing the visual features. Recently, VinVL <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> has trained a new object detector on a large-scale corpus to extract richer visual features, which significantly improves SoTA results. Given an instance (<em id="Sx3.SSx2.SSSx1.p1.5.1" class="ltx_emph ltx_font_italic">i.e.</em>, an image and a related question), we use the object-level region features extracted by VinVL and project them into a series of object embeddings <math id="Sx3.SSx2.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="\{h^{obj}_{e}\}\in\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.1.m1.1a"><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.cmml"><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.cmml">e</mi><mrow id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1a" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.4" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.4.cmml">j</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.2.cmml">}</mo></mrow><mo id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2.cmml">∈</mo><msup id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.1.m1.1b"><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1"><in id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.2"></in><set id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1"><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3"><times id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.2">𝑜</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.3">𝑏</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.2.3.4">𝑗</ci></apply></apply><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.1.1.1.3">𝑒</ci></apply></set><apply id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.1.m1.1c">\{h^{obj}_{e}\}\in\mathbb{R}^{d}</annotation></semantics></math>, where <math id="Sx3.SSx2.SSSx1.p1.2.m2.3" class="ltx_Math" alttext="e=1,...,E" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.2.m2.3a"><mrow id="Sx3.SSx2.SSSx1.p1.2.m2.3.4" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.cmml"><mi id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.2" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.2.cmml">e</mi><mo id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.1" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.1.cmml">=</mo><mrow id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.2" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.1.cmml"><mn id="Sx3.SSx2.SSSx1.p1.2.m2.1.1" xref="Sx3.SSx2.SSSx1.p1.2.m2.1.1.cmml">1</mn><mo id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.2.1" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.SSSx1.p1.2.m2.2.2" xref="Sx3.SSx2.SSSx1.p1.2.m2.2.2.cmml">…</mi><mo id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.2.2" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx1.p1.2.m2.3.3" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.2.m2.3b"><apply id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4"><eq id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.1.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.1"></eq><ci id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.2.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.2">𝑒</ci><list id="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.4.3.2"><cn type="integer" id="Sx3.SSx2.SSSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.1.1">1</cn><ci id="Sx3.SSx2.SSSx1.p1.2.m2.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.2.2">…</ci><ci id="Sx3.SSx2.SSSx1.p1.2.m2.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.2.m2.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.2.m2.3c">e=1,...,E</annotation></semantics></math>. Furthermore, to enhance visual-linguistic alignment according to <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, we append the detected object tags to the question words and embed them in <math id="Sx3.SSx2.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.3.m3.1a"><mi id="Sx3.SSx2.SSSx1.p1.3.m3.1.1" xref="Sx3.SSx2.SSSx1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.3.m3.1b"><ci id="Sx3.SSx2.SSSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.3.m3.1c">d</annotation></semantics></math>-dimensional word embeddings as <math id="Sx3.SSx2.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="\{h^{word}_{v}\}\in\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.4.m4.1a"><mrow id="Sx3.SSx2.SSSx1.p1.4.m4.1.1" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.cmml"><mrow id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.2" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.2" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.3.cmml">v</mi><mrow id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.2" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1a" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.4" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1b" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.5" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.5.cmml">d</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.2.cmml">}</mo></mrow><mo id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.2" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.2.cmml">∈</mo><msup id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.2" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.3" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.4.m4.1b"><apply id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1"><in id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.2"></in><set id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1"><apply id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3"><times id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.2">𝑤</ci><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.3">𝑜</ci><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.4">𝑟</ci><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.5.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.2.3.5">𝑑</ci></apply></apply><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.1.1.1.3">𝑣</ci></apply></set><apply id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.4.m4.1c">\{h^{word}_{v}\}\in\mathbb{R}^{d}</annotation></semantics></math>, where <math id="Sx3.SSx2.SSSx1.p1.5.m5.3" class="ltx_Math" alttext="v=1,...,V" display="inline"><semantics id="Sx3.SSx2.SSSx1.p1.5.m5.3a"><mrow id="Sx3.SSx2.SSSx1.p1.5.m5.3.4" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.cmml"><mi id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.2" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.2.cmml">v</mi><mo id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.1" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.1.cmml">=</mo><mrow id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.2" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.1.cmml"><mn id="Sx3.SSx2.SSSx1.p1.5.m5.1.1" xref="Sx3.SSx2.SSSx1.p1.5.m5.1.1.cmml">1</mn><mo id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.2.1" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.SSSx1.p1.5.m5.2.2" xref="Sx3.SSx2.SSSx1.p1.5.m5.2.2.cmml">…</mi><mo id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.2.2" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx1.p1.5.m5.3.3" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.3.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx1.p1.5.m5.3b"><apply id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4"><eq id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.1.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.1"></eq><ci id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.2.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.2">𝑣</ci><list id="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.1.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.4.3.2"><cn type="integer" id="Sx3.SSx2.SSSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.1.1">1</cn><ci id="Sx3.SSx2.SSSx1.p1.5.m5.2.2.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.2.2">…</ci><ci id="Sx3.SSx2.SSSx1.p1.5.m5.3.3.cmml" xref="Sx3.SSx2.SSSx1.p1.5.m5.3.3">𝑉</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx1.p1.5.m5.3c">v=1,...,V</annotation></semantics></math>.</p>
</div>
</section>
<section id="Sx3.SSx2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">OCR Feature</h4>

<div id="Sx3.SSx2.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx2.p1.8" class="ltx_p">OCR tokens extracted from images necessarily require special consideration, as they contain visual and semantic information critical to understanding the text in images and cannot be expressed solely through region features. Given an image with <math id="Sx3.SSx2.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.1.m1.1a"><mi id="Sx3.SSx2.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.1.m1.1b"><ci id="Sx3.SSx2.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.1.m1.1c">M</annotation></semantics></math> OCR tokens derived from the Rosetta system <cite class="ltx_cite ltx_citemacro_citep">(Borisyuk, Gordo, and Sivakumar <a href="#bib.bib5" title="" class="ltx_ref">2018</a>)</cite>, we introduce the OCR feature for each OCR patch following the setting in <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>. The OCR feature consists of two parts (<em id="Sx3.SSx2.SSSx2.p1.8.1" class="ltx_emph ltx_font_italic">i.e.</em>, semantic and spatial ones), which focus on the content and position of each OCR patch, respectively. Regarding the <math id="Sx3.SSx2.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.2.m2.1a"><mi id="Sx3.SSx2.SSSx2.p1.2.m2.1.1" xref="Sx3.SSx2.SSSx2.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.2.m2.1b"><ci id="Sx3.SSx2.SSSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.2.m2.1c">m</annotation></semantics></math>-th OCR token (where <math id="Sx3.SSx2.SSSx2.p1.3.m3.3" class="ltx_Math" alttext="m=1,...,M" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.3.m3.3a"><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.3.4" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.cmml"><mi id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.2.cmml">m</mi><mo id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.1.cmml">=</mo><mrow id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.1.cmml"><mn id="Sx3.SSx2.SSSx2.p1.3.m3.1.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.1.cmml">1</mn><mo id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.2.1" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.SSSx2.p1.3.m3.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.2.2.cmml">…</mi><mo id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.2.2" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx2.p1.3.m3.3.3" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.3.m3.3b"><apply id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4"><eq id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.1"></eq><ci id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.2">𝑚</ci><list id="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.4.3.2"><cn type="integer" id="Sx3.SSx2.SSSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.1.1">1</cn><ci id="Sx3.SSx2.SSSx2.p1.3.m3.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.2.2">…</ci><ci id="Sx3.SSx2.SSSx2.p1.3.m3.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.3.m3.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.3.m3.3c">m=1,...,M</annotation></semantics></math>), to better capture the semantic information from the OCR patch, we further divide the semantic part <math id="Sx3.SSx2.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="{x}^{smt}_{m}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.4.m4.1a"><msubsup id="Sx3.SSx2.SSSx2.p1.4.m4.1.1" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.3" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.4" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.4.m4.1b"><apply id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3"><times id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.3">𝑚</ci><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.4.m4.1c">{x}^{smt}_{m}</annotation></semantics></math> into a FastText feature <cite class="ltx_cite ltx_citemacro_citep">(Bojanowski et al. <a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite>, a Pyramidal Histogram of Characters (PHOC) feature <cite class="ltx_cite ltx_citemacro_citep">(Almazán et al. <a href="#bib.bib1" title="" class="ltx_ref">2014</a>)</cite>, and an appearance feature. Specifically, the FastText feature <math id="Sx3.SSx2.SSSx2.p1.5.m5.1" class="ltx_Math" alttext="{x}^{ft}_{m}\in\mathbb{R}^{300}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.5.m5.1a"><mrow id="Sx3.SSx2.SSSx2.p1.5.m5.1.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.cmml"><msubsup id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.3.cmml">t</mi></mrow></msubsup><mo id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.1" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mn id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.3.cmml">300</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.5.m5.1b"><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1"><in id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.1"></in><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3"><times id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.2">𝑓</ci><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.2.3.3">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.2.3">𝑚</ci></apply><apply id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.2">ℝ</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.5.m5.1.1.3.3">300</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.5.m5.1c">{x}^{ft}_{m}\in\mathbb{R}^{300}</annotation></semantics></math> constructs word embedding using subword information, which endows the model with the ability to handle rare and unknown words. The PHOC feature <math id="Sx3.SSx2.SSSx2.p1.6.m6.1" class="ltx_Math" alttext="{x}^{p}_{m}\in\mathbb{R}^{604}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.6.m6.1a"><mrow id="Sx3.SSx2.SSSx2.p1.6.m6.1.1" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.cmml"><msubsup id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.3.cmml">m</mi><mi id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.3.cmml">p</mi></msubsup><mo id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.1" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mn id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.3.cmml">604</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.6.m6.1b"><apply id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1"><in id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.1"></in><apply id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.2">𝑥</ci><ci id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.2.3">𝑝</ci></apply><ci id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.2.3">𝑚</ci></apply><apply id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.2">ℝ</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.6.m6.1.1.3.3">604</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.6.m6.1c">{x}^{p}_{m}\in\mathbb{R}^{604}</annotation></semantics></math> is a character-level representation while the appearance feature <math id="Sx3.SSx2.SSSx2.p1.7.m7.1" class="ltx_Math" alttext="{x}^{fr}_{m}\in\mathbb{R}^{2048}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.7.m7.1a"><mrow id="Sx3.SSx2.SSSx2.p1.7.m7.1.1" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.cmml"><msubsup id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.1" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.3" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.3.cmml">r</mi></mrow></msubsup><mo id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.1" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mn id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.3.cmml">2048</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.7.m7.1b"><apply id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1"><in id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.1"></in><apply id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3"><times id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.2">𝑓</ci><ci id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.2.3.3">𝑟</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.2.3">𝑚</ci></apply><apply id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.2">ℝ</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.7.m7.1.1.3.3">2048</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.7.m7.1c">{x}^{fr}_{m}\in\mathbb{R}^{2048}</annotation></semantics></math> is an object-level representation detected by Faster R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>, which primarily reflects the color, font, and background information of the OCR patch. Formally, to obtain the semantic part <math id="Sx3.SSx2.SSSx2.p1.8.m8.1" class="ltx_Math" alttext="{x}^{smt}_{m}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.8.m8.1a"><msubsup id="Sx3.SSx2.SSSx2.p1.8.m8.1.1" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.3" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.4" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.8.m8.1b"><apply id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3"><times id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.3">𝑚</ci><ci id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.8.m8.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.8.m8.1c">{x}^{smt}_{m}</annotation></semantics></math>, we compose these features by:</p>
<table id="Sx3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E1.m1.1" class="ltx_Math" alttext="{x}^{smt}_{m}=[{x}^{ft}_{m};{x}^{p}_{m};{x}^{fr}_{m}]," display="block"><semantics id="Sx3.E1.m1.1a"><mrow id="Sx3.E1.m1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.cmml"><mrow id="Sx3.E1.m1.1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.cmml"><msubsup id="Sx3.E1.m1.1.1.1.1.5" xref="Sx3.E1.m1.1.1.1.1.5.cmml"><mi id="Sx3.E1.m1.1.1.1.1.5.2.2" xref="Sx3.E1.m1.1.1.1.1.5.2.2.cmml">x</mi><mi id="Sx3.E1.m1.1.1.1.1.5.3" xref="Sx3.E1.m1.1.1.1.1.5.3.cmml">m</mi><mrow id="Sx3.E1.m1.1.1.1.1.5.2.3" xref="Sx3.E1.m1.1.1.1.1.5.2.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1.5.2.3.2" xref="Sx3.E1.m1.1.1.1.1.5.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.1.1.1.1.5.2.3.1" xref="Sx3.E1.m1.1.1.1.1.5.2.3.1.cmml">​</mo><mi id="Sx3.E1.m1.1.1.1.1.5.2.3.3" xref="Sx3.E1.m1.1.1.1.1.5.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.1.1.1.1.5.2.3.1a" xref="Sx3.E1.m1.1.1.1.1.5.2.3.1.cmml">​</mo><mi id="Sx3.E1.m1.1.1.1.1.5.2.3.4" xref="Sx3.E1.m1.1.1.1.1.5.2.3.4.cmml">t</mi></mrow></msubsup><mo id="Sx3.E1.m1.1.1.1.1.4" xref="Sx3.E1.m1.1.1.1.1.4.cmml">=</mo><mrow id="Sx3.E1.m1.1.1.1.1.3.3" xref="Sx3.E1.m1.1.1.1.1.3.4.cmml"><mo stretchy="false" id="Sx3.E1.m1.1.1.1.1.3.3.4" xref="Sx3.E1.m1.1.1.1.1.3.4.cmml">[</mo><msubsup id="Sx3.E1.m1.1.1.1.1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E1.m1.1.1.1.1.1.1.1.2.2" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="Sx3.E1.m1.1.1.1.1.1.1.1.3" xref="Sx3.E1.m1.1.1.1.1.1.1.1.3.cmml">m</mi><mrow id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.1" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></mrow></msubsup><mo id="Sx3.E1.m1.1.1.1.1.3.3.5" xref="Sx3.E1.m1.1.1.1.1.3.4.cmml">;</mo><msubsup id="Sx3.E1.m1.1.1.1.1.2.2.2" xref="Sx3.E1.m1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.E1.m1.1.1.1.1.2.2.2.2.2" xref="Sx3.E1.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="Sx3.E1.m1.1.1.1.1.2.2.2.3" xref="Sx3.E1.m1.1.1.1.1.2.2.2.3.cmml">m</mi><mi id="Sx3.E1.m1.1.1.1.1.2.2.2.2.3" xref="Sx3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">p</mi></msubsup><mo id="Sx3.E1.m1.1.1.1.1.3.3.6" xref="Sx3.E1.m1.1.1.1.1.3.4.cmml">;</mo><msubsup id="Sx3.E1.m1.1.1.1.1.3.3.3" xref="Sx3.E1.m1.1.1.1.1.3.3.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1.3.3.3.2.2" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.2.cmml">x</mi><mi id="Sx3.E1.m1.1.1.1.1.3.3.3.3" xref="Sx3.E1.m1.1.1.1.1.3.3.3.3.cmml">m</mi><mrow id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.2" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.1" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.3" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.3.cmml">r</mi></mrow></msubsup><mo stretchy="false" id="Sx3.E1.m1.1.1.1.1.3.3.7" xref="Sx3.E1.m1.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="Sx3.E1.m1.1.1.1.2" xref="Sx3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.1b"><apply id="Sx3.E1.m1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1"><eq id="Sx3.E1.m1.1.1.1.1.4.cmml" xref="Sx3.E1.m1.1.1.1.1.4"></eq><apply id="Sx3.E1.m1.1.1.1.1.5.cmml" xref="Sx3.E1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.5.1.cmml" xref="Sx3.E1.m1.1.1.1.1.5">subscript</csymbol><apply id="Sx3.E1.m1.1.1.1.1.5.2.cmml" xref="Sx3.E1.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.5.2.1.cmml" xref="Sx3.E1.m1.1.1.1.1.5">superscript</csymbol><ci id="Sx3.E1.m1.1.1.1.1.5.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.2">𝑥</ci><apply id="Sx3.E1.m1.1.1.1.1.5.2.3.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.3"><times id="Sx3.E1.m1.1.1.1.1.5.2.3.1.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.3.1"></times><ci id="Sx3.E1.m1.1.1.1.1.5.2.3.2.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.3.2">𝑠</ci><ci id="Sx3.E1.m1.1.1.1.1.5.2.3.3.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.3.3">𝑚</ci><ci id="Sx3.E1.m1.1.1.1.1.5.2.3.4.cmml" xref="Sx3.E1.m1.1.1.1.1.5.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.E1.m1.1.1.1.1.5.3.cmml" xref="Sx3.E1.m1.1.1.1.1.5.3">𝑚</ci></apply><list id="Sx3.E1.m1.1.1.1.1.3.4.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3"><apply id="Sx3.E1.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3"><times id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.2">𝑓</ci><ci id="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><ci id="Sx3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="Sx3.E1.m1.1.1.1.1.2.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2">subscript</csymbol><apply id="Sx3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2">superscript</csymbol><ci id="Sx3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="Sx3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2.2.3">𝑝</ci></apply><ci id="Sx3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E1.m1.1.1.1.1.2.2.2.3">𝑚</ci></apply><apply id="Sx3.E1.m1.1.1.1.1.3.3.3.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.3.3.3.1.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3">subscript</csymbol><apply id="Sx3.E1.m1.1.1.1.1.3.3.3.2.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="Sx3.E1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.2">𝑥</ci><apply id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3"><times id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.1"></times><ci id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.2">𝑓</ci><ci id="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.2.3.3">𝑟</ci></apply></apply><ci id="Sx3.E1.m1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E1.m1.1.1.1.1.3.3.3.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.1c">{x}^{smt}_{m}=[{x}^{ft}_{m};{x}^{p}_{m};{x}^{fr}_{m}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx2.p1.15" class="ltx_p">where <math id="Sx3.SSx2.SSSx2.p1.9.m1.3" class="ltx_Math" alttext="[\cdot;\cdot;\cdot]" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.9.m1.3a"><mrow id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2.1" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.9.m1.1.1" xref="Sx3.SSx2.SSSx2.p1.9.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2.2" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.9.m1.2.2" xref="Sx3.SSx2.SSSx2.p1.9.m1.2.2.cmml">⋅</mo><mo rspace="0em" id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2.3" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.9.m1.3.3" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.3.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2.4" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.9.m1.3b"><list id="Sx3.SSx2.SSSx2.p1.9.m1.3.4.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.4.2"><ci id="Sx3.SSx2.SSSx2.p1.9.m1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m1.1.1">⋅</ci><ci id="Sx3.SSx2.SSSx2.p1.9.m1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m1.2.2">⋅</ci><ci id="Sx3.SSx2.SSSx2.p1.9.m1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.9.m1.3.3">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.9.m1.3c">[\cdot;\cdot;\cdot]</annotation></semantics></math> denotes concatenation operation. On the other hand, the spatial part <math id="Sx3.SSx2.SSSx2.p1.10.m2.1" class="ltx_Math" alttext="{x}^{spt}_{m}\in\mathbb{R}^{4}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.10.m2.1a"><mrow id="Sx3.SSx2.SSSx2.p1.10.m2.1.1" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.cmml"><msubsup id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.2" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.2" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.3" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.4" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.4.cmml">t</mi></mrow></msubsup><mo id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.1" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.2.cmml">ℝ</mi><mn id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.10.m2.1b"><apply id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1"><in id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.1"></in><apply id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3"><times id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.3">𝑝</ci><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.2.3">𝑚</ci></apply><apply id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.2">ℝ</ci><cn type="integer" id="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.10.m2.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.10.m2.1c">{x}^{spt}_{m}\in\mathbb{R}^{4}</annotation></semantics></math> refers to the relative position of the OCR patch in the given image, which is denoted as bounding box coordinates. After that, we feed both the <math id="Sx3.SSx2.SSSx2.p1.11.m3.1" class="ltx_Math" alttext="{x}^{smt}_{m}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.11.m3.1a"><msubsup id="Sx3.SSx2.SSSx2.p1.11.m3.1.1" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.3" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.4" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.11.m3.1b"><apply id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3"><times id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.3">𝑚</ci><ci id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.11.m3.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.11.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.11.m3.1c">{x}^{smt}_{m}</annotation></semantics></math> and <math id="Sx3.SSx2.SSSx2.p1.12.m4.1" class="ltx_Math" alttext="{x}^{spt}_{m}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.12.m4.1a"><msubsup id="Sx3.SSx2.SSSx2.p1.12.m4.1.1" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.3" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.4" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.12.m4.1b"><apply id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.2">𝑥</ci><apply id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3"><times id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.3">𝑝</ci><ci id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.12.m4.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.12.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.12.m4.1c">{x}^{spt}_{m}</annotation></semantics></math> features into an OCR embedding layer and obtain the <math id="Sx3.SSx2.SSSx2.p1.13.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.13.m5.1a"><mi id="Sx3.SSx2.SSSx2.p1.13.m5.1.1" xref="Sx3.SSx2.SSSx2.p1.13.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.13.m5.1b"><ci id="Sx3.SSx2.SSSx2.p1.13.m5.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.13.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.13.m5.1c">d</annotation></semantics></math>-dimensional integrated OCR embeddings <math id="Sx3.SSx2.SSSx2.p1.14.m6.1" class="ltx_Math" alttext="\{{h}^{ocr}_{m}\}\in\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.14.m6.1a"><mrow id="Sx3.SSx2.SSSx2.p1.14.m6.1.1" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.cmml"><mrow id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.2" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.3.cmml">m</mi><mrow id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.2" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1a" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.4" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.4.cmml">r</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.2.cmml">}</mo></mrow><mo id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.2" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.2.cmml">∈</mo><msup id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.14.m6.1b"><apply id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1"><in id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.2"></in><set id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1"><apply id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3"><times id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.2">𝑜</ci><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.3">𝑐</ci><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.2.3.4">𝑟</ci></apply></apply><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.1.1.1.3">𝑚</ci></apply></set><apply id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.2">ℝ</ci><ci id="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.14.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.14.m6.1c">\{{h}^{ocr}_{m}\}\in\mathbb{R}^{d}</annotation></semantics></math> (where <math id="Sx3.SSx2.SSSx2.p1.15.m7.3" class="ltx_Math" alttext="m=1,...,M" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.15.m7.3a"><mrow id="Sx3.SSx2.SSSx2.p1.15.m7.3.4" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.cmml"><mi id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.2" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.2.cmml">m</mi><mo id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.1" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.1.cmml">=</mo><mrow id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.2" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.1.cmml"><mn id="Sx3.SSx2.SSSx2.p1.15.m7.1.1" xref="Sx3.SSx2.SSSx2.p1.15.m7.1.1.cmml">1</mn><mo id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.2.1" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.SSSx2.p1.15.m7.2.2" xref="Sx3.SSx2.SSSx2.p1.15.m7.2.2.cmml">…</mi><mo id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.2.2" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSSx2.p1.15.m7.3.3" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.15.m7.3b"><apply id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4"><eq id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.1.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.1"></eq><ci id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.2.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.2">𝑚</ci><list id="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.4.3.2"><cn type="integer" id="Sx3.SSx2.SSSx2.p1.15.m7.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.1.1">1</cn><ci id="Sx3.SSx2.SSSx2.p1.15.m7.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.2.2">…</ci><ci id="Sx3.SSx2.SSSx2.p1.15.m7.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.15.m7.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.15.m7.3c">m=1,...,M</annotation></semantics></math>) as follows:</p>
<table id="Sx3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E2.m1.1" class="ltx_Math" alttext="{h}^{ocr}_{m}=LN({W}^{smt}{x}^{smt}_{m})+LN({W}^{spt}{x}^{spt}_{m})," display="block"><semantics id="Sx3.E2.m1.1a"><mrow id="Sx3.E2.m1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.cmml"><mrow id="Sx3.E2.m1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.cmml"><msubsup id="Sx3.E2.m1.1.1.1.1.4" xref="Sx3.E2.m1.1.1.1.1.4.cmml"><mi id="Sx3.E2.m1.1.1.1.1.4.2.2" xref="Sx3.E2.m1.1.1.1.1.4.2.2.cmml">h</mi><mi id="Sx3.E2.m1.1.1.1.1.4.3" xref="Sx3.E2.m1.1.1.1.1.4.3.cmml">m</mi><mrow id="Sx3.E2.m1.1.1.1.1.4.2.3" xref="Sx3.E2.m1.1.1.1.1.4.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.4.2.3.2" xref="Sx3.E2.m1.1.1.1.1.4.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.4.2.3.1" xref="Sx3.E2.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.4.2.3.3" xref="Sx3.E2.m1.1.1.1.1.4.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.4.2.3.1a" xref="Sx3.E2.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.4.2.3.4" xref="Sx3.E2.m1.1.1.1.1.4.2.3.4.cmml">r</mi></mrow></msubsup><mo id="Sx3.E2.m1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="Sx3.E2.m1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.2.cmml"><mrow id="Sx3.E2.m1.1.1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.E2.m1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.1.1.4" xref="Sx3.E2.m1.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.2a" xref="Sx3.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2.m1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mrow id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi><mrow id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.4" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">t</mi></mrow></msubsup></mrow><mo stretchy="false" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E2.m1.1.1.1.1.2.3" xref="Sx3.E2.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="Sx3.E2.m1.1.1.1.1.2.2" xref="Sx3.E2.m1.1.1.1.1.2.2.cmml"><mi id="Sx3.E2.m1.1.1.1.1.2.2.3" xref="Sx3.E2.m1.1.1.1.1.2.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.2" xref="Sx3.E2.m1.1.1.1.1.2.2.2.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.2.2.4" xref="Sx3.E2.m1.1.1.1.1.2.2.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.2a" xref="Sx3.E2.m1.1.1.1.1.2.2.2.cmml">​</mo><mrow id="Sx3.E2.m1.1.1.1.1.2.2.1.1" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.cmml"><msup id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.cmml"><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.2.cmml">W</mi><mrow id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1a" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.4" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.4.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml">​</mo><msubsup id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">x</mi><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.3.cmml">m</mi><mrow id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.2" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1a" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.4" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.4.cmml">t</mi></mrow></msubsup></mrow><mo stretchy="false" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.3" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E2.m1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.1b"><apply id="Sx3.E2.m1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1"><eq id="Sx3.E2.m1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.1.1.1.1.3"></eq><apply id="Sx3.E2.m1.1.1.1.1.4.cmml" xref="Sx3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.4.1.cmml" xref="Sx3.E2.m1.1.1.1.1.4">subscript</csymbol><apply id="Sx3.E2.m1.1.1.1.1.4.2.cmml" xref="Sx3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.4.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.4">superscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.4.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.2">ℎ</ci><apply id="Sx3.E2.m1.1.1.1.1.4.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.3"><times id="Sx3.E2.m1.1.1.1.1.4.2.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.3.1"></times><ci id="Sx3.E2.m1.1.1.1.1.4.2.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.3.2">𝑜</ci><ci id="Sx3.E2.m1.1.1.1.1.4.2.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.3.3">𝑐</ci><ci id="Sx3.E2.m1.1.1.1.1.4.2.3.4.cmml" xref="Sx3.E2.m1.1.1.1.1.4.2.3.4">𝑟</ci></apply></apply><ci id="Sx3.E2.m1.1.1.1.1.4.3.cmml" xref="Sx3.E2.m1.1.1.1.1.4.3">𝑚</ci></apply><apply id="Sx3.E2.m1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2"><plus id="Sx3.E2.m1.1.1.1.1.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.3"></plus><apply id="Sx3.E2.m1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1"><times id="Sx3.E2.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.E2.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.3">𝐿</ci><ci id="Sx3.E2.m1.1.1.1.1.1.1.4.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.4">𝑁</ci><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1"><times id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3"><times id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑥</ci><apply id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑚</ci><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply><apply id="Sx3.E2.m1.1.1.1.1.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2"><times id="Sx3.E2.m1.1.1.1.1.2.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.2"></times><ci id="Sx3.E2.m1.1.1.1.1.2.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.3">𝐿</ci><ci id="Sx3.E2.m1.1.1.1.1.2.2.4.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.4">𝑁</ci><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1"><times id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.1"></times><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2">superscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.2">𝑊</ci><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3"><times id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.1"></times><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.2">𝑠</ci><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.3">𝑝</ci><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.4.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3">superscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.2">𝑥</ci><apply id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3"><times id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.1"></times><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.2.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.2">𝑠</ci><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.3">𝑝</ci><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.4.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.2.3.4">𝑡</ci></apply></apply><ci id="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="Sx3.E2.m1.1.1.1.1.2.2.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.1c">{h}^{ocr}_{m}=LN({W}^{smt}{x}^{smt}_{m})+LN({W}^{spt}{x}^{spt}_{m}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSSx2.p1.18" class="ltx_p">where <math id="Sx3.SSx2.SSSx2.p1.16.m1.1" class="ltx_Math" alttext="{W}^{smt}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.16.m1.1a"><msup id="Sx3.SSx2.SSSx2.p1.16.m1.1.1" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.2" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.2.cmml">W</mi><mrow id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1a" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.4" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.4.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.16.m1.1b"><apply id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.2">𝑊</ci><apply id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3"><times id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.3">𝑚</ci><ci id="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.16.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.16.m1.1c">{W}^{smt}</annotation></semantics></math> and <math id="Sx3.SSx2.SSSx2.p1.17.m2.1" class="ltx_Math" alttext="{W}^{spt}" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.17.m2.1a"><msup id="Sx3.SSx2.SSSx2.p1.17.m2.1.1" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.cmml"><mi id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.2" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.2.cmml">W</mi><mrow id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.cmml"><mi id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.2" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.3" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1a" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.4" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.4.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.17.m2.1b"><apply id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.2">𝑊</ci><apply id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3"><times id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.1"></times><ci id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.2.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.2">𝑠</ci><ci id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.3.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.3">𝑝</ci><ci id="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.4.cmml" xref="Sx3.SSx2.SSSx2.p1.17.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.17.m2.1c">{W}^{spt}</annotation></semantics></math> are learnable weights while <math id="Sx3.SSx2.SSSx2.p1.18.m3.1" class="ltx_Math" alttext="LN(\cdot)" display="inline"><semantics id="Sx3.SSx2.SSSx2.p1.18.m3.1a"><mrow id="Sx3.SSx2.SSSx2.p1.18.m3.1.2" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.cmml"><mi id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.2" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.3" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1a" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1.cmml">​</mo><mrow id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.4.2" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.4.2.1" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSSx2.p1.18.m3.1.1" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.4.2.2" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSSx2.p1.18.m3.1b"><apply id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.cmml" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2"><times id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1.cmml" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.1"></times><ci id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.2.cmml" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.2">𝐿</ci><ci id="Sx3.SSx2.SSSx2.p1.18.m3.1.2.3.cmml" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.2.3">𝑁</ci><ci id="Sx3.SSx2.SSSx2.p1.18.m3.1.1.cmml" xref="Sx3.SSx2.SSSx2.p1.18.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSSx2.p1.18.m3.1c">LN(\cdot)</annotation></semantics></math> denotes layer normalization.</p>
</div>
</section>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Cross-Modal Interaction</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.9" class="ltx_p">The multi-modal transformer layers are built with an encoder-decoder architecture, and the multi-head attention mechanism allows for inter-modal and intra-modal interaction. Entities in each input modality can attend to one another while each decoding step can attend to all positions preceding the current step. We feed a sequence of <math id="Sx3.SSx3.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx3.p1.1.m1.1a"><mi id="Sx3.SSx3.p1.1.m1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.1b"><ci id="Sx3.SSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.1c">d</annotation></semantics></math>-dimensional inputs into the transformer layers, namely word embeddings <math id="Sx3.SSx3.p1.2.m2.1" class="ltx_Math" alttext="\{h^{word}_{v}\}" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.1a"><mrow id="Sx3.SSx3.p1.2.m2.1.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.2.m2.1.1.1.2" xref="Sx3.SSx3.p1.2.m2.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx3.p1.2.m2.1.1.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.2" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.3" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.3.cmml">v</mi><mrow id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.2" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.3" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1a" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.4" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1b" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.5" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.5.cmml">d</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx3.p1.2.m2.1.1.1.3" xref="Sx3.SSx3.p1.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><set id="Sx3.SSx3.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1"><apply id="Sx3.SSx3.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.2.m2.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3"><times id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.2">𝑤</ci><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.3">𝑜</ci><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.4">𝑟</ci><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.5.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.2.3.5">𝑑</ci></apply></apply><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.3">𝑣</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">\{h^{word}_{v}\}</annotation></semantics></math>, object embeddings <math id="Sx3.SSx3.p1.3.m3.1" class="ltx_Math" alttext="\{h^{obj}_{e}\}" display="inline"><semantics id="Sx3.SSx3.p1.3.m3.1a"><mrow id="Sx3.SSx3.p1.3.m3.1.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.3.m3.1.1.1.2" xref="Sx3.SSx3.p1.3.m3.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx3.p1.3.m3.1.1.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.2" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx3.p1.3.m3.1.1.1.1.3" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.3.cmml">e</mi><mrow id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.2" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.3" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1a" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.4" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.4.cmml">j</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx3.p1.3.m3.1.1.1.3" xref="Sx3.SSx3.p1.3.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><set id="Sx3.SSx3.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1"><apply id="Sx3.SSx3.p1.3.m3.1.1.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.3.m3.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3"><times id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.2">𝑜</ci><ci id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.3">𝑏</ci><ci id="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.2.3.4">𝑗</ci></apply></apply><ci id="Sx3.SSx3.p1.3.m3.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.1.1.3">𝑒</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">\{h^{obj}_{e}\}</annotation></semantics></math>, OCR embeddings <math id="Sx3.SSx3.p1.4.m4.1" class="ltx_Math" alttext="\{h^{ocr}_{m}\}" display="inline"><semantics id="Sx3.SSx3.p1.4.m4.1a"><mrow id="Sx3.SSx3.p1.4.m4.1.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.4.m4.1.1.1.2" xref="Sx3.SSx3.p1.4.m4.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx3.p1.4.m4.1.1.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.2" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1.3" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.3.cmml">m</mi><mrow id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.2" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.3" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1a" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.4" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.4.cmml">r</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx3.p1.4.m4.1.1.1.3" xref="Sx3.SSx3.p1.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m4.1b"><set id="Sx3.SSx3.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1"><apply id="Sx3.SSx3.p1.4.m4.1.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3"><times id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.2">𝑜</ci><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.3">𝑐</ci><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.2.3.4">𝑟</ci></apply></apply><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.3">𝑚</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m4.1c">\{h^{ocr}_{m}\}</annotation></semantics></math>, and previous prediction embeddings <math id="Sx3.SSx3.p1.5.m5.1" class="ltx_Math" alttext="\{h^{dec}_{t}\}" display="inline"><semantics id="Sx3.SSx3.p1.5.m5.1a"><mrow id="Sx3.SSx3.p1.5.m5.1.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.5.m5.1.1.1.2" xref="Sx3.SSx3.p1.5.m5.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx3.p1.5.m5.1.1.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.2" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx3.p1.5.m5.1.1.1.1.3" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.3.cmml">t</mi><mrow id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.2" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.3" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1a" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.4" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.4.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx3.p1.5.m5.1.1.1.3" xref="Sx3.SSx3.p1.5.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m5.1b"><set id="Sx3.SSx3.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1"><apply id="Sx3.SSx3.p1.5.m5.1.1.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.2">ℎ</ci><apply id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3"><times id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.1"></times><ci id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.2">𝑑</ci><ci id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.3">𝑒</ci><ci id="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.4.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.2.3.4">𝑐</ci></apply></apply><ci id="Sx3.SSx3.p1.5.m5.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1.1.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m5.1c">\{h^{dec}_{t}\}</annotation></semantics></math> (where the decoding step <math id="Sx3.SSx3.p1.6.m6.3" class="ltx_Math" alttext="t=1,...,T" display="inline"><semantics id="Sx3.SSx3.p1.6.m6.3a"><mrow id="Sx3.SSx3.p1.6.m6.3.4" xref="Sx3.SSx3.p1.6.m6.3.4.cmml"><mi id="Sx3.SSx3.p1.6.m6.3.4.2" xref="Sx3.SSx3.p1.6.m6.3.4.2.cmml">t</mi><mo id="Sx3.SSx3.p1.6.m6.3.4.1" xref="Sx3.SSx3.p1.6.m6.3.4.1.cmml">=</mo><mrow id="Sx3.SSx3.p1.6.m6.3.4.3.2" xref="Sx3.SSx3.p1.6.m6.3.4.3.1.cmml"><mn id="Sx3.SSx3.p1.6.m6.1.1" xref="Sx3.SSx3.p1.6.m6.1.1.cmml">1</mn><mo id="Sx3.SSx3.p1.6.m6.3.4.3.2.1" xref="Sx3.SSx3.p1.6.m6.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx3.p1.6.m6.2.2" xref="Sx3.SSx3.p1.6.m6.2.2.cmml">…</mi><mo id="Sx3.SSx3.p1.6.m6.3.4.3.2.2" xref="Sx3.SSx3.p1.6.m6.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx3.p1.6.m6.3.3" xref="Sx3.SSx3.p1.6.m6.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.6.m6.3b"><apply id="Sx3.SSx3.p1.6.m6.3.4.cmml" xref="Sx3.SSx3.p1.6.m6.3.4"><eq id="Sx3.SSx3.p1.6.m6.3.4.1.cmml" xref="Sx3.SSx3.p1.6.m6.3.4.1"></eq><ci id="Sx3.SSx3.p1.6.m6.3.4.2.cmml" xref="Sx3.SSx3.p1.6.m6.3.4.2">𝑡</ci><list id="Sx3.SSx3.p1.6.m6.3.4.3.1.cmml" xref="Sx3.SSx3.p1.6.m6.3.4.3.2"><cn type="integer" id="Sx3.SSx3.p1.6.m6.1.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1">1</cn><ci id="Sx3.SSx3.p1.6.m6.2.2.cmml" xref="Sx3.SSx3.p1.6.m6.2.2">…</ci><ci id="Sx3.SSx3.p1.6.m6.3.3.cmml" xref="Sx3.SSx3.p1.6.m6.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.6.m6.3c">t=1,...,T</annotation></semantics></math>) to produce a set of <math id="Sx3.SSx3.p1.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx3.p1.7.m7.1a"><mi id="Sx3.SSx3.p1.7.m7.1.1" xref="Sx3.SSx3.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.7.m7.1b"><ci id="Sx3.SSx3.p1.7.m7.1.1.cmml" xref="Sx3.SSx3.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.7.m7.1c">d</annotation></semantics></math>-dimensional enhanced representations. Specifically, <math id="Sx3.SSx3.p1.8.m8.1" class="ltx_Math" alttext="[CLS]" display="inline"><semantics id="Sx3.SSx3.p1.8.m8.1a"><mrow id="Sx3.SSx3.p1.8.m8.1.1.1" xref="Sx3.SSx3.p1.8.m8.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.8.m8.1.1.1.2" xref="Sx3.SSx3.p1.8.m8.1.1.2.1.cmml">[</mo><mrow id="Sx3.SSx3.p1.8.m8.1.1.1.1" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.8.m8.1.1.1.1.2" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.8.m8.1.1.1.1.1" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.8.m8.1.1.1.1.3" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.8.m8.1.1.1.1.1a" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.8.m8.1.1.1.1.4" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="Sx3.SSx3.p1.8.m8.1.1.1.3" xref="Sx3.SSx3.p1.8.m8.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.8.m8.1b"><apply id="Sx3.SSx3.p1.8.m8.1.1.2.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1"><csymbol cd="latexml" id="Sx3.SSx3.p1.8.m8.1.1.2.1.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.SSx3.p1.8.m8.1.1.1.1.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.1"><times id="Sx3.SSx3.p1.8.m8.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.1"></times><ci id="Sx3.SSx3.p1.8.m8.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.2">𝐶</ci><ci id="Sx3.SSx3.p1.8.m8.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.3">𝐿</ci><ci id="Sx3.SSx3.p1.8.m8.1.1.1.1.4.cmml" xref="Sx3.SSx3.p1.8.m8.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.8.m8.1c">[CLS]</annotation></semantics></math> is a special token added to the beginning of each input sequence, and <math id="Sx3.SSx3.p1.9.m9.1" class="ltx_Math" alttext="{z}^{[CLS]}" display="inline"><semantics id="Sx3.SSx3.p1.9.m9.1a"><msup id="Sx3.SSx3.p1.9.m9.1.2" xref="Sx3.SSx3.p1.9.m9.1.2.cmml"><mi id="Sx3.SSx3.p1.9.m9.1.2.2" xref="Sx3.SSx3.p1.9.m9.1.2.2.cmml">z</mi><mrow id="Sx3.SSx3.p1.9.m9.1.1.1.1" xref="Sx3.SSx3.p1.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.9.m9.1.1.1.1.2" xref="Sx3.SSx3.p1.9.m9.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.SSx3.p1.9.m9.1.1.1.1.1" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.cmml"><mi id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.2" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.3" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1a" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.4" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="Sx3.SSx3.p1.9.m9.1.1.1.1.3" xref="Sx3.SSx3.p1.9.m9.1.1.1.2.1.cmml">]</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.9.m9.1b"><apply id="Sx3.SSx3.p1.9.m9.1.2.cmml" xref="Sx3.SSx3.p1.9.m9.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.9.m9.1.2.1.cmml" xref="Sx3.SSx3.p1.9.m9.1.2">superscript</csymbol><ci id="Sx3.SSx3.p1.9.m9.1.2.2.cmml" xref="Sx3.SSx3.p1.9.m9.1.2.2">𝑧</ci><apply id="Sx3.SSx3.p1.9.m9.1.1.1.2.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="Sx3.SSx3.p1.9.m9.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1"><times id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.1"></times><ci id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.2">𝐶</ci><ci id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.3.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.3">𝐿</ci><ci id="Sx3.SSx3.p1.9.m9.1.1.1.1.1.4.cmml" xref="Sx3.SSx3.p1.9.m9.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.9.m9.1c">{z}^{[CLS]}</annotation></semantics></math> is used as the aggregated representation for classification tasks. In the case of sequence-to-sequence learning, the decoder generates a sequence of answers based on the auto-regressive scheme. At each time step, we feed some enhanced representations and a previous prediction embedding into a dynamic pointer network to predict the next step (explained in the next section).</p>
</div>
</section>
<section id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Dual Routing Prediction Module</h3>

<div id="Sx3.SSx4.p1" class="ltx_para">
<p id="Sx3.SSx4.p1.1" class="ltx_p">The VQA dataset contains open-ended questions with flexible answers. In practice, there are two types of questions: general questions that can be answered with a common answer set and questions that must be answered using the text information in the image. To improve the intelligence of our model, we propose a two-branch answer prediction network. Since the first case can be thought of as a multi-label classification problem, we use a classifier to select an entire answer (single-word or multi-word) in one step. In the second case, multi-step decoding is required to generate a sequence of answers. To this end, we propose a dynamic pointer network to copy an answer token from OCR tokens in each step. Finally, a gating network acts as a router to activate a best-match answer generated by these two experts for each instance.</p>
</div>
<section id="Sx3.SSx4.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Two-Branch Answer Prediction Network</h4>

<section id="Sx3.SSx4.SSSx1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Classifier</h5>

<div id="Sx3.SSx4.SSSx1.Px1.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.Px1.p1.7" class="ltx_p">According to <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, in general cases, we can cast the answer prediction in VQA as a multi-label classification problem and use a set of <math id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1a"><mi id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.1.m1.1c">C</annotation></semantics></math> frequent answers in the VQA v2.0 training set as the candidate set. Assume we have <math id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1a"><mi id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1b"><ci id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.2.m2.1c">N</annotation></semantics></math> instances in the training set, for the <math id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1a"><mi id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1b"><ci id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.3.m3.1c">i</annotation></semantics></math>-th (where <math id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3" class="ltx_Math" alttext="i=1,...,N" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3a"><mrow id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.2" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.2.cmml">i</mi><mo id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.1" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.1.cmml">=</mo><mrow id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.2" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.1.cmml"><mn id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.1.1.cmml">1</mn><mo id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.2.1" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.2.2.cmml">…</mi><mo id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.3" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4"><eq id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.1"></eq><ci id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.2">𝑖</ci><list id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.4.3.2"><cn type="integer" id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.1.1">1</cn><ci id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.2.2">…</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.4.m4.3c">i=1,...,N</annotation></semantics></math>) instance, we perform a linear transformation on the aggregated representation <math id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1" class="ltx_Math" alttext="{z}_{i}^{[CLS]}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1a"><msubsup id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.2.cmml">z</mi><mi id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.3" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.3.cmml">i</mi><mrow id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1a" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.4" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.2">𝑧</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.2.2.3">𝑖</ci></apply><apply id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1"><times id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.1"></times><ci id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.2">𝐶</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.3">𝐿</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.4.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.5.m5.1c">{z}_{i}^{[CLS]}</annotation></semantics></math> to calculate the predicted score <math id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1" class="ltx_Math" alttext="\hat{s}_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1a"><msub id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.cmml"><mover accent="true" id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.2.cmml">s</mi><mo id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.1" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2"><ci id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.1">^</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.2.2">𝑠</ci></apply><ci id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.6.m6.1c">\hat{s}_{i}</annotation></semantics></math> for these candidate answers. To train the classifier, we compute the Binary Cross Entropy (BCE) loss <math id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{cls}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1a"><msub id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.2.cmml">ℒ</mi><mrow id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.2">ℒ</ci><apply id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3"><times id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.2">𝑐</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.3">𝑙</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.7.m7.1c">\mathcal{L}_{cls}</annotation></semantics></math> between the predicted and ground-truth scores of the instance taking this branch as follows:</p>
<table id="Sx3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E3.m1.9" class="ltx_Math" alttext="\mathcal{L}_{cls}=-\frac{1}{N}\sum^{N}_{i=1}g_{i}\sum^{C}_{c=1}[s_{i,c}log(\hat{s}_{i,c})+(1-s_{i,c})log(1-\hat{s}_{i,c})]," display="block"><semantics id="Sx3.E3.m1.9a"><mrow id="Sx3.E3.m1.9.9.1" xref="Sx3.E3.m1.9.9.1.1.cmml"><mrow id="Sx3.E3.m1.9.9.1.1" xref="Sx3.E3.m1.9.9.1.1.cmml"><msub id="Sx3.E3.m1.9.9.1.1.3" xref="Sx3.E3.m1.9.9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E3.m1.9.9.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.3.2.cmml">ℒ</mi><mrow id="Sx3.E3.m1.9.9.1.1.3.3" xref="Sx3.E3.m1.9.9.1.1.3.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.3.3.2" xref="Sx3.E3.m1.9.9.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.3.3.1" xref="Sx3.E3.m1.9.9.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.3.3.3" xref="Sx3.E3.m1.9.9.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.3.3.1a" xref="Sx3.E3.m1.9.9.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.3.3.4" xref="Sx3.E3.m1.9.9.1.1.3.3.4.cmml">s</mi></mrow></msub><mo id="Sx3.E3.m1.9.9.1.1.2" xref="Sx3.E3.m1.9.9.1.1.2.cmml">=</mo><mrow id="Sx3.E3.m1.9.9.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.cmml"><mo id="Sx3.E3.m1.9.9.1.1.1a" xref="Sx3.E3.m1.9.9.1.1.1.cmml">−</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.cmml"><mfrac id="Sx3.E3.m1.9.9.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.3.cmml"><mn id="Sx3.E3.m1.9.9.1.1.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.3.2.cmml">1</mn><mi id="Sx3.E3.m1.9.9.1.1.1.1.3.3" xref="Sx3.E3.m1.9.9.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.cmml"><munderover id="Sx3.E3.m1.9.9.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.3.cmml">N</mi></munderover><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.cmml"><msub id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.cmml"><munderover id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.2.cmml">c</mi><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.3.cmml">C</mi></munderover><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="Sx3.E3.m1.2.2.2.4" xref="Sx3.E3.m1.2.2.2.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.E3.m1.2.2.2.4.1" xref="Sx3.E3.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.E3.m1.2.2.2.2" xref="Sx3.E3.m1.2.2.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2a" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.5" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2b" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.6" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2c" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="Sx3.E3.m1.4.4.2.4" xref="Sx3.E3.m1.4.4.2.3.cmml"><mi id="Sx3.E3.m1.3.3.1.1" xref="Sx3.E3.m1.3.3.1.1.cmml">i</mi><mo id="Sx3.E3.m1.4.4.2.4.1" xref="Sx3.E3.m1.4.4.2.3.cmml">,</mo><mi id="Sx3.E3.m1.4.4.2.2" xref="Sx3.E3.m1.4.4.2.2.cmml">c</mi></mrow></msub><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">s</mi><mrow id="Sx3.E3.m1.6.6.2.4" xref="Sx3.E3.m1.6.6.2.3.cmml"><mi id="Sx3.E3.m1.5.5.1.1" xref="Sx3.E3.m1.5.5.1.1.cmml">i</mi><mo id="Sx3.E3.m1.6.6.2.4.1" xref="Sx3.E3.m1.6.6.2.3.cmml">,</mo><mi id="Sx3.E3.m1.6.6.2.2" xref="Sx3.E3.m1.6.6.2.2.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.4" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3a" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.5" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3b" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.6" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3c" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mn id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml">1</mn><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml">−</mo><msub id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml"><mover accent="true" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.cmml"><mi id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2.cmml">s</mi><mo id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1.cmml">^</mo></mover><mrow id="Sx3.E3.m1.8.8.2.4" xref="Sx3.E3.m1.8.8.2.3.cmml"><mi id="Sx3.E3.m1.7.7.1.1" xref="Sx3.E3.m1.7.7.1.1.cmml">i</mi><mo id="Sx3.E3.m1.8.8.2.4.1" xref="Sx3.E3.m1.8.8.2.3.cmml">,</mo><mi id="Sx3.E3.m1.8.8.2.2" xref="Sx3.E3.m1.8.8.2.2.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E3.m1.9.9.1.2" xref="Sx3.E3.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.9b"><apply id="Sx3.E3.m1.9.9.1.1.cmml" xref="Sx3.E3.m1.9.9.1"><eq id="Sx3.E3.m1.9.9.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.2"></eq><apply id="Sx3.E3.m1.9.9.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.3">subscript</csymbol><ci id="Sx3.E3.m1.9.9.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.3.2">ℒ</ci><apply id="Sx3.E3.m1.9.9.1.1.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.3.3"><times id="Sx3.E3.m1.9.9.1.1.3.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.3.3.1"></times><ci id="Sx3.E3.m1.9.9.1.1.3.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.3.3.2">𝑐</ci><ci id="Sx3.E3.m1.9.9.1.1.3.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.3.3.3">𝑙</ci><ci id="Sx3.E3.m1.9.9.1.1.3.3.4.cmml" xref="Sx3.E3.m1.9.9.1.1.3.3.4">𝑠</ci></apply></apply><apply id="Sx3.E3.m1.9.9.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1"><minus id="Sx3.E3.m1.9.9.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1"></minus><apply id="Sx3.E3.m1.9.9.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1"><times id="Sx3.E3.m1.9.9.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.2"></times><apply id="Sx3.E3.m1.9.9.1.1.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.3"><divide id="Sx3.E3.m1.9.9.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.3"></divide><cn type="integer" id="Sx3.E3.m1.9.9.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.3.2">1</cn><ci id="Sx3.E3.m1.9.9.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.3.3">𝑁</ci></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1"><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2">subscript</csymbol><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2">superscript</csymbol><sum id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.2.3">𝑁</ci></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3"><eq id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.1"></eq><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1"><times id="Sx3.E3.m1.9.9.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.2"></times><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.2">𝑔</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1"><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2">superscript</csymbol><sum id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.2.3">𝐶</ci></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3"><eq id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.1"></eq><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.2">𝑐</ci><cn type="integer" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1"><plus id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.4"></plus><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><list id="Sx3.E3.m1.2.2.2.3.cmml" xref="Sx3.E3.m1.2.2.2.4"><ci id="Sx3.E3.m1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1">𝑖</ci><ci id="Sx3.E3.m1.2.2.2.2.cmml" xref="Sx3.E3.m1.2.2.2.2">𝑐</ci></list></apply><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.4">𝑙</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.5">𝑜</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.6">𝑔</ci><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><list id="Sx3.E3.m1.4.4.2.3.cmml" xref="Sx3.E3.m1.4.4.2.4"><ci id="Sx3.E3.m1.3.3.1.1.cmml" xref="Sx3.E3.m1.3.3.1.1">𝑖</ci><ci id="Sx3.E3.m1.4.4.2.2.cmml" xref="Sx3.E3.m1.4.4.2.2">𝑐</ci></list></apply></apply><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3"><times id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.3"></times><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1"><minus id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑠</ci><list id="Sx3.E3.m1.6.6.2.3.cmml" xref="Sx3.E3.m1.6.6.2.4"><ci id="Sx3.E3.m1.5.5.1.1.cmml" xref="Sx3.E3.m1.5.5.1.1">𝑖</ci><ci id="Sx3.E3.m1.6.6.2.2.cmml" xref="Sx3.E3.m1.6.6.2.2">𝑐</ci></list></apply></apply><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.4">𝑙</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.6.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.6">𝑔</ci><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1"><minus id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1"></minus><cn type="integer" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2">1</cn><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3">subscript</csymbol><apply id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2"><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1">^</ci><ci id="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2.cmml" xref="Sx3.E3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2">𝑠</ci></apply><list id="Sx3.E3.m1.8.8.2.3.cmml" xref="Sx3.E3.m1.8.8.2.4"><ci id="Sx3.E3.m1.7.7.1.1.cmml" xref="Sx3.E3.m1.7.7.1.1">𝑖</ci><ci id="Sx3.E3.m1.8.8.2.2.cmml" xref="Sx3.E3.m1.8.8.2.2">𝑐</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.9c">\mathcal{L}_{cls}=-\frac{1}{N}\sum^{N}_{i=1}g_{i}\sum^{C}_{c=1}[s_{i,c}log(\hat{s}_{i,c})+(1-s_{i,c})log(1-\hat{s}_{i,c})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx1.Px1.p1.12" class="ltx_p">where the ground-truth routing flag <math id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1" class="ltx_Math" alttext="g_{i}=1" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1a"><mrow id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.cmml"><msub id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.2.cmml">g</mi><mi id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.1.cmml">=</mo><mn id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1"><eq id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.1"></eq><apply id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.2">𝑔</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.8.m1.1c">g_{i}=1</annotation></semantics></math> indicates that the instance selects the answer generated by the classifier, otherwise <math id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1" class="ltx_Math" alttext="g_{i}=0" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1a"><mrow id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.cmml"><msub id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.2.cmml">g</mi><mi id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.1.cmml">=</mo><mn id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1"><eq id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.1"></eq><apply id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.2">𝑔</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.9.m2.1c">g_{i}=0</annotation></semantics></math>. <math id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1a"><mi id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1b"><ci id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.10.m3.1c">C</annotation></semantics></math> is the fixed length of the candidate set, and <math id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2" class="ltx_Math" alttext="s_{i,c}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2a"><msub id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.2" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.2.cmml">s</mi><mrow id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.4" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.4.1" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.3.2">𝑠</ci><list id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.4"><ci id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.1.1.1.1">𝑖</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.11.m4.2c">s_{i,c}</annotation></semantics></math> is the ground-truth answer score calculated by Eq. (<a href="#Sx4.E9" title="In Evaluation Metric ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) below. During inference, we select the answer index with the highest predicted score as <math id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1" class="ltx_Math" alttext="argmax\ \hat{\mathbf{s}}_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1a"><mrow id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.2" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.3" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1a" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.4" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1b" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.5" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1c" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.6" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1d" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.7" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.7.cmml">x</mi><mo lspace="0.500em" rspace="0em" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1e" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml">​</mo><msub id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.cmml"><mover accent="true" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.2" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.2.cmml">𝐬</mi><mo id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.1" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.1.cmml">^</mo></mover><mi id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.3" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1b"><apply id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1"><times id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.1"></times><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.2">𝑎</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.3">𝑟</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.4.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.4">𝑔</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.5.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.5">𝑚</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.6.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.6">𝑎</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.7.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.7">𝑥</ci><apply id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2"><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.1">^</ci><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.2.2">𝐬</ci></apply><ci id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.3.cmml" xref="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1.1.8.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px1.p1.12.m5.1c">argmax\ \hat{\mathbf{s}}_{i}</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx4.SSSx1.Px1.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.Px1.p2.1" class="ltx_p">In this way, we can solve common cases where the answer is not text-sensitive (<em id="Sx3.SSx4.SSSx1.Px1.p2.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, object detection and counting) with low complexity. However, when the instance asks for the text in the image, the capacity of OCR tokens in diverse images is too large for a fixed-length candidate set. The classifier cannot combine these tokens to generate a specific answer sequence. To address these issues, another prediction approach should be proposed in addition to the classifier.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Dynamic Pointer Network</h5>

<div id="Sx3.SSx4.SSSx1.Px2.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.Px2.p1.11" class="ltx_p">Some answers in the VQA v2.0 dataset are derived directly from image text and composed of OCR tokens (<em id="Sx3.SSx4.SSSx1.Px2.p1.11.1" class="ltx_emph ltx_font_italic">e.g.</em>, signs and titles). Because it is impossible to include all of these diverse OCR tokens in the candidate set, we consider dynamically selecting and combining OCR tokens for each image to generate a sequence of answers. According to pointer networks <cite class="ltx_cite ltx_citemacro_citep">(Vinyals, Fortunato, and Jaitly <a href="#bib.bib35" title="" class="ltx_ref">2015</a>)</cite>, one can copy tokens directly from the input text, which simplifies the answer generation process and avoids OOV problems. During the <math id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.1.m1.1c">T</annotation></semantics></math>-step decoding process, each previous prediction embedding <math id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1" class="ltx_Math" alttext="{h}^{dec}_{t}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.3.cmml">t</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.2">ℎ</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.3">𝑒</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.2.3.4">𝑐</ci></apply></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.2.m2.1c">{h}^{dec}_{t}</annotation></semantics></math> (<math id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3" class="ltx_Math" alttext="t=1,...,T" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.2" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.2.cmml">t</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.1" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.1.cmml">=</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.1.cmml"><mn id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.1.1.cmml">1</mn><mo id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.2.1" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.2.2.cmml">…</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4"><eq id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.1"></eq><ci id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.2">𝑡</ci><list id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.4.3.2"><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.1.1">1</cn><ci id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.2.2">…</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.3.m3.3c">t=1,...,T</annotation></semantics></math>) is the sum of the token embedding, the positional embedding, and the type embedding. We feed them into the transformer layers to get a set of enhanced representations <math id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1" class="ltx_Math" alttext="\{{z}_{t}^{dec}\}\in\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.cmml"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.2.cmml">z</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.3.cmml">t</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.4.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.2.cmml">}</mo></mrow><mo id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.2.cmml">∈</mo><msup id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1"><in id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.2"></in><set id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1"><apply id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.2">𝑧</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.3">𝑒</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.1.1.1.3.4">𝑐</ci></apply></apply></set><apply id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.2">ℝ</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.4.m4.1c">\{{z}_{t}^{dec}\}\in\mathbb{R}^{d}</annotation></semantics></math> (where <math id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3" class="ltx_Math" alttext="t=1,...,T" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.2" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.2.cmml">t</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.1" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.1.cmml">=</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.1.cmml"><mn id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.1.1.cmml">1</mn><mo id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.2.1" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.2.2.cmml">…</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4"><eq id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.1"></eq><ci id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.2">𝑡</ci><list id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.4.3.2"><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.1.1">1</cn><ci id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.2.2">…</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.5.m5.3c">t=1,...,T</annotation></semantics></math>). For the <math id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.6.m6.1c">t</annotation></semantics></math>-th step, we calculate the score <math id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1" class="ltx_Math" alttext="y^{t}_{m}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.2.cmml">y</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.3.cmml">m</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.2">𝑦</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.2.3">𝑡</ci></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.7.m7.1c">y^{t}_{m}</annotation></semantics></math> for the <math id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.8.m8.1c">m</annotation></semantics></math>-th (where <math id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3" class="ltx_Math" alttext="m=1,...,M" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.2" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.2.cmml">m</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.1" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.1.cmml">=</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.1.cmml"><mn id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.1.1.cmml">1</mn><mo id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.2.1" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.2.2.cmml">…</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4"><eq id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.1"></eq><ci id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.2">𝑚</ci><list id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.4.3.2"><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.1.1">1</cn><ci id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.2.2">…</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.9.m9.3c">m=1,...,M</annotation></semantics></math>) OCR token using a bilinear interaction between <math id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1" class="ltx_Math" alttext="{z}_{t}^{dec}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.2.cmml">z</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.3.cmml">t</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.2">𝑧</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.2.3">𝑡</ci></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.3">𝑒</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.10.m10.1c">{z}_{t}^{dec}</annotation></semantics></math> and <math id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1" class="ltx_Math" alttext="{z}_{m}^{ocr}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.2.cmml">z</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.3.cmml">m</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.4.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.2">𝑧</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.2.3">𝑚</ci></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.2">𝑜</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.3">𝑐</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.11.m11.1c">{z}_{m}^{ocr}</annotation></semantics></math> as follows:</p>
<table id="Sx3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E4.m1.1" class="ltx_Math" alttext="y^{t}_{m}=({W}^{ocr}{z}_{m}^{ocr}+{b}^{ocr})^{T}({W}^{dec}{z}_{t}^{dec}+{b}^{dec})," display="block"><semantics id="Sx3.E4.m1.1a"><mrow id="Sx3.E4.m1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.cmml"><msubsup id="Sx3.E4.m1.1.1.1.1.4" xref="Sx3.E4.m1.1.1.1.1.4.cmml"><mi id="Sx3.E4.m1.1.1.1.1.4.2.2" xref="Sx3.E4.m1.1.1.1.1.4.2.2.cmml">y</mi><mi id="Sx3.E4.m1.1.1.1.1.4.3" xref="Sx3.E4.m1.1.1.1.1.4.3.cmml">m</mi><mi id="Sx3.E4.m1.1.1.1.1.4.2.3" xref="Sx3.E4.m1.1.1.1.1.4.2.3.cmml">t</mi></msubsup><mo id="Sx3.E4.m1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="Sx3.E4.m1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.2.cmml"><msup id="Sx3.E4.m1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1a" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml">r</mi></mrow></msup><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">z</mi><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">m</mi><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1a" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.4.cmml">r</mi></mrow></msubsup></mrow><mo id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">r</mi></mrow></msup></mrow><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="Sx3.E4.m1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.2.2.1.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.cmml"><msup id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.2.cmml">W</mi><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1a" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.4" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.4.cmml">c</mi></mrow></msup><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><msubsup id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.cmml">z</mi><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3.cmml">t</mi><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1a" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.4" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.4.cmml">c</mi></mrow></msubsup></mrow><mo id="Sx3.E4.m1.1.1.1.1.2.2.1.1.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.1.cmml">+</mo><msup id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml">b</mi><mrow id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.2" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1a" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.4" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.2.2.1.3" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.1b"><apply id="Sx3.E4.m1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1"><eq id="Sx3.E4.m1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3"></eq><apply id="Sx3.E4.m1.1.1.1.1.4.cmml" xref="Sx3.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.4.1.cmml" xref="Sx3.E4.m1.1.1.1.1.4">subscript</csymbol><apply id="Sx3.E4.m1.1.1.1.1.4.2.cmml" xref="Sx3.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.4.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.4">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.4.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.4.2.2">𝑦</ci><ci id="Sx3.E4.m1.1.1.1.1.4.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="Sx3.E4.m1.1.1.1.1.4.3.cmml" xref="Sx3.E4.m1.1.1.1.1.4.3">𝑚</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2"><times id="Sx3.E4.m1.1.1.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.3"></times><apply id="Sx3.E4.m1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1"><plus id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2"><times id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3"><times id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑜</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑐</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.4">𝑟</ci></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑧</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑚</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3"><times id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.2">𝑜</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.3">𝑐</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.3.4">𝑟</ci></apply></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑜</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑐</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑟</ci></apply></apply></apply><ci id="Sx3.E4.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1"><plus id="Sx3.E4.m1.1.1.1.1.2.2.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.1"></plus><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2"><times id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.1"></times><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.2">𝑊</ci><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3"><times id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.2">𝑑</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.3">𝑒</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.2.3.4">𝑐</ci></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3">superscript</csymbol><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2">𝑧</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3">𝑡</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3"><times id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.2">𝑑</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.3">𝑒</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.2.3.3.4">𝑐</ci></apply></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.2">𝑏</ci><apply id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3"><times id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.1"></times><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.2">𝑑</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.3">𝑒</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.1c">y^{t}_{m}=({W}^{ocr}{z}_{m}^{ocr}+{b}^{ocr})^{T}({W}^{dec}{z}_{t}^{dec}+{b}^{dec}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx1.Px2.p1.17" class="ltx_p">where <math id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1" class="ltx_Math" alttext="{W}^{ocr}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1a"><msup id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.2.cmml">W</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.4.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.2">𝑊</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.2">𝑜</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.3">𝑐</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.12.m1.1c">{W}^{ocr}</annotation></semantics></math> and <math id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1" class="ltx_Math" alttext="{W}^{dec}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.cmml"><msup id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.2.cmml">W</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.4.cmml">c</mi></mrow></msup><mo id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1"><in id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.1"></in><apply id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.2">𝑊</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.3">𝑒</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.2.3.4">𝑐</ci></apply></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.13.m2.1c">{W}^{dec}\in\mathbb{R}^{d\times d}</annotation></semantics></math> denote weight matrices, <math id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1" class="ltx_Math" alttext="{b}^{ocr}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1a"><msup id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.2.cmml">b</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.4.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.2">𝑏</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.2">𝑜</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.3">𝑐</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.14.m3.1c">{b}^{ocr}</annotation></semantics></math> and <math id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1" class="ltx_Math" alttext="{b}^{dec}\in\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.cmml"><msup id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.2.cmml">b</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.4.cmml">c</mi></mrow></msup><mo id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.1.cmml">∈</mo><msup id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1"><in id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.1"></in><apply id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.2">𝑏</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3"><times id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.3">𝑒</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.2.3.4">𝑐</ci></apply></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.2">ℝ</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.15.m4.1c">{b}^{dec}\in\mathbb{R}^{d}</annotation></semantics></math> denote bias vectors. In the <math id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.16.m5.1c">t</annotation></semantics></math>-th step, we select an answer index with the highest predicted score as <math id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4" class="ltx_Math" alttext="argmax\ \{y_{1}^{t},y_{2}^{t},...,y_{M}^{t}\}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4a"><mrow id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.5" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.6" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4a" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.7" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4b" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.8" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4c" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.9" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4d" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.10" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.10.cmml">x</mi><mo lspace="0.500em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4e" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml">​</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.4" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml">{</mo><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.2.cmml">y</mi><mn id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.3.cmml">1</mn><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.5" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml">,</mo><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.2.cmml">y</mi><mn id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.3.cmml">2</mn><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.6" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.1.1" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.1.1.cmml">…</mi><mo id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.7" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml">,</mo><msubsup id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.2.cmml">y</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.3.cmml">M</mi><mi id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.3" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.8" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4b"><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4"><times id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.4"></times><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.5.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.5">𝑎</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.6.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.6">𝑟</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.7.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.7">𝑔</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.8.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.8">𝑚</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.9.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.9">𝑎</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.10.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.10">𝑥</ci><set id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3"><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.2">𝑦</ci><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.2.3">1</cn></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.2.2.1.1.1.3">𝑡</ci></apply><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.2">𝑦</ci><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.2.3">2</cn></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.3.3.2.2.2.3">𝑡</ci></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.1.1">…</ci><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3">superscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.2">𝑦</ci><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.2.3">𝑀</ci></apply><ci id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p1.17.m6.4c">argmax\ \{y_{1}^{t},y_{2}^{t},...,y_{M}^{t}\}</annotation></semantics></math>, and select an answer word from these M OCR tokens with it.</p>
</div>
<div id="Sx3.SSx4.SSSx1.Px2.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.Px2.p2.2" class="ltx_p">Since instances that cannot find answers in the candidate set or OCR tokens are eliminated from the training set, the remaining <math id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1" class="ltx_Math" alttext="\sum^{N}_{i=1}(1-g_{i})" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1a"><mrow id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.cmml"><msubsup id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.cmml"><mo id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.1" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.3.cmml">N</mi></msubsup><mrow id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml"><mn id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><msub id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.2.cmml">g</mi><mi id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1"><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2">superscript</csymbol><sum id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.2"></sum><ci id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.2.3">𝑁</ci></apply><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3"><eq id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.1"></eq><ci id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1"><minus id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.1"></minus><cn type="integer" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.2">1</cn><apply id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.2">𝑔</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.1.m1.1c">\sum^{N}_{i=1}(1-g_{i})</annotation></semantics></math> instances follow the pointer network branch. For each step of the decoding process, we calculate the BCE loss <math id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{ptr}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1a"><msub id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.2" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.2.cmml">ℒ</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.2" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.3" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.4" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.2">ℒ</ci><apply id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3"><times id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.2">𝑝</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.3">𝑡</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.2.m2.1c">\mathcal{L}_{ptr}</annotation></semantics></math> between the predicted and ground-truth scores. Specifically, the score for the first ground-truth token is calculated by Eq. (<a href="#Sx4.E9" title="In Evaluation Metric ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), and each subsequent token is filled with a full score of 1.0.</p>
<table id="Sx5.EGx1" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.Ex1.m1.11" class="ltx_Math" alttext="\displaystyle{loss}_{i}=s^{t}_{i,m}log(y^{t}_{i,m})+(1-s^{t}_{i,m})log(1-y^{t}_{i,m})" display="block"><semantics id="Sx3.Ex1.m1.11a"><mrow id="Sx3.Ex1.m1.11.11" xref="Sx3.Ex1.m1.11.11.cmml"><mrow id="Sx3.Ex1.m1.11.11.5" xref="Sx3.Ex1.m1.11.11.5.cmml"><mi id="Sx3.Ex1.m1.11.11.5.2" xref="Sx3.Ex1.m1.11.11.5.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.5.1" xref="Sx3.Ex1.m1.11.11.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.11.11.5.3" xref="Sx3.Ex1.m1.11.11.5.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.5.1a" xref="Sx3.Ex1.m1.11.11.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.11.11.5.4" xref="Sx3.Ex1.m1.11.11.5.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.5.1b" xref="Sx3.Ex1.m1.11.11.5.1.cmml">​</mo><msub id="Sx3.Ex1.m1.11.11.5.5" xref="Sx3.Ex1.m1.11.11.5.5.cmml"><mi id="Sx3.Ex1.m1.11.11.5.5.2" xref="Sx3.Ex1.m1.11.11.5.5.2.cmml">s</mi><mi id="Sx3.Ex1.m1.11.11.5.5.3" xref="Sx3.Ex1.m1.11.11.5.5.3.cmml">i</mi></msub></mrow><mo id="Sx3.Ex1.m1.11.11.4" xref="Sx3.Ex1.m1.11.11.4.cmml">=</mo><mrow id="Sx3.Ex1.m1.11.11.3" xref="Sx3.Ex1.m1.11.11.3.cmml"><mrow id="Sx3.Ex1.m1.9.9.1.1" xref="Sx3.Ex1.m1.9.9.1.1.cmml"><msubsup id="Sx3.Ex1.m1.9.9.1.1.3" xref="Sx3.Ex1.m1.9.9.1.1.3.cmml"><mi id="Sx3.Ex1.m1.9.9.1.1.3.2.2" xref="Sx3.Ex1.m1.9.9.1.1.3.2.2.cmml">s</mi><mrow id="Sx3.Ex1.m1.2.2.2.4" xref="Sx3.Ex1.m1.2.2.2.3.cmml"><mi id="Sx3.Ex1.m1.1.1.1.1" xref="Sx3.Ex1.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.Ex1.m1.2.2.2.4.1" xref="Sx3.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.Ex1.m1.2.2.2.2" xref="Sx3.Ex1.m1.2.2.2.2.cmml">m</mi></mrow><mi id="Sx3.Ex1.m1.9.9.1.1.3.2.3" xref="Sx3.Ex1.m1.9.9.1.1.3.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.9.9.1.1.2" xref="Sx3.Ex1.m1.9.9.1.1.2.cmml">​</mo><mi id="Sx3.Ex1.m1.9.9.1.1.4" xref="Sx3.Ex1.m1.9.9.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.9.9.1.1.2a" xref="Sx3.Ex1.m1.9.9.1.1.2.cmml">​</mo><mi id="Sx3.Ex1.m1.9.9.1.1.5" xref="Sx3.Ex1.m1.9.9.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.9.9.1.1.2b" xref="Sx3.Ex1.m1.9.9.1.1.2.cmml">​</mo><mi id="Sx3.Ex1.m1.9.9.1.1.6" xref="Sx3.Ex1.m1.9.9.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.9.9.1.1.2c" xref="Sx3.Ex1.m1.9.9.1.1.2.cmml">​</mo><mrow id="Sx3.Ex1.m1.9.9.1.1.1.1" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.9.9.1.1.1.1.2" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.Ex1.m1.9.9.1.1.1.1.1" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.cmml"><mi id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.2" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.2.cmml">y</mi><mrow id="Sx3.Ex1.m1.4.4.2.4" xref="Sx3.Ex1.m1.4.4.2.3.cmml"><mi id="Sx3.Ex1.m1.3.3.1.1" xref="Sx3.Ex1.m1.3.3.1.1.cmml">i</mi><mo id="Sx3.Ex1.m1.4.4.2.4.1" xref="Sx3.Ex1.m1.4.4.2.3.cmml">,</mo><mi id="Sx3.Ex1.m1.4.4.2.2" xref="Sx3.Ex1.m1.4.4.2.2.cmml">m</mi></mrow><mi id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.3" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="Sx3.Ex1.m1.9.9.1.1.1.1.3" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex1.m1.11.11.3.4" xref="Sx3.Ex1.m1.11.11.3.4.cmml">+</mo><mrow id="Sx3.Ex1.m1.11.11.3.3" xref="Sx3.Ex1.m1.11.11.3.3.cmml"><mrow id="Sx3.Ex1.m1.10.10.2.2.1.1" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.10.10.2.2.1.1.2" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.Ex1.m1.10.10.2.2.1.1.1" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.cmml"><mn id="Sx3.Ex1.m1.10.10.2.2.1.1.1.2" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.2.cmml">1</mn><mo id="Sx3.Ex1.m1.10.10.2.2.1.1.1.1" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.1.cmml">−</mo><msubsup id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.cmml"><mi id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.2" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.2.cmml">s</mi><mrow id="Sx3.Ex1.m1.6.6.2.4" xref="Sx3.Ex1.m1.6.6.2.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1" xref="Sx3.Ex1.m1.5.5.1.1.cmml">i</mi><mo id="Sx3.Ex1.m1.6.6.2.4.1" xref="Sx3.Ex1.m1.6.6.2.3.cmml">,</mo><mi id="Sx3.Ex1.m1.6.6.2.2" xref="Sx3.Ex1.m1.6.6.2.2.cmml">m</mi></mrow><mi id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.3" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="Sx3.Ex1.m1.10.10.2.2.1.1.3" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.3.3.3" xref="Sx3.Ex1.m1.11.11.3.3.3.cmml">​</mo><mi id="Sx3.Ex1.m1.11.11.3.3.4" xref="Sx3.Ex1.m1.11.11.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.3.3.3a" xref="Sx3.Ex1.m1.11.11.3.3.3.cmml">​</mo><mi id="Sx3.Ex1.m1.11.11.3.3.5" xref="Sx3.Ex1.m1.11.11.3.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.3.3.3b" xref="Sx3.Ex1.m1.11.11.3.3.3.cmml">​</mo><mi id="Sx3.Ex1.m1.11.11.3.3.6" xref="Sx3.Ex1.m1.11.11.3.3.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.11.11.3.3.3c" xref="Sx3.Ex1.m1.11.11.3.3.3.cmml">​</mo><mrow id="Sx3.Ex1.m1.11.11.3.3.2.1" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.11.11.3.3.2.1.2" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.cmml">(</mo><mrow id="Sx3.Ex1.m1.11.11.3.3.2.1.1" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.cmml"><mn id="Sx3.Ex1.m1.11.11.3.3.2.1.1.2" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.2.cmml">1</mn><mo id="Sx3.Ex1.m1.11.11.3.3.2.1.1.1" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.1.cmml">−</mo><msubsup id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.cmml"><mi id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.2" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.2.cmml">y</mi><mrow id="Sx3.Ex1.m1.8.8.2.4" xref="Sx3.Ex1.m1.8.8.2.3.cmml"><mi id="Sx3.Ex1.m1.7.7.1.1" xref="Sx3.Ex1.m1.7.7.1.1.cmml">i</mi><mo id="Sx3.Ex1.m1.8.8.2.4.1" xref="Sx3.Ex1.m1.8.8.2.3.cmml">,</mo><mi id="Sx3.Ex1.m1.8.8.2.2" xref="Sx3.Ex1.m1.8.8.2.2.cmml">m</mi></mrow><mi id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.3" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="Sx3.Ex1.m1.11.11.3.3.2.1.3" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex1.m1.11b"><apply id="Sx3.Ex1.m1.11.11.cmml" xref="Sx3.Ex1.m1.11.11"><eq id="Sx3.Ex1.m1.11.11.4.cmml" xref="Sx3.Ex1.m1.11.11.4"></eq><apply id="Sx3.Ex1.m1.11.11.5.cmml" xref="Sx3.Ex1.m1.11.11.5"><times id="Sx3.Ex1.m1.11.11.5.1.cmml" xref="Sx3.Ex1.m1.11.11.5.1"></times><ci id="Sx3.Ex1.m1.11.11.5.2.cmml" xref="Sx3.Ex1.m1.11.11.5.2">𝑙</ci><ci id="Sx3.Ex1.m1.11.11.5.3.cmml" xref="Sx3.Ex1.m1.11.11.5.3">𝑜</ci><ci id="Sx3.Ex1.m1.11.11.5.4.cmml" xref="Sx3.Ex1.m1.11.11.5.4">𝑠</ci><apply id="Sx3.Ex1.m1.11.11.5.5.cmml" xref="Sx3.Ex1.m1.11.11.5.5"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.11.11.5.5.1.cmml" xref="Sx3.Ex1.m1.11.11.5.5">subscript</csymbol><ci id="Sx3.Ex1.m1.11.11.5.5.2.cmml" xref="Sx3.Ex1.m1.11.11.5.5.2">𝑠</ci><ci id="Sx3.Ex1.m1.11.11.5.5.3.cmml" xref="Sx3.Ex1.m1.11.11.5.5.3">𝑖</ci></apply></apply><apply id="Sx3.Ex1.m1.11.11.3.cmml" xref="Sx3.Ex1.m1.11.11.3"><plus id="Sx3.Ex1.m1.11.11.3.4.cmml" xref="Sx3.Ex1.m1.11.11.3.4"></plus><apply id="Sx3.Ex1.m1.9.9.1.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1"><times id="Sx3.Ex1.m1.9.9.1.1.2.cmml" xref="Sx3.Ex1.m1.9.9.1.1.2"></times><apply id="Sx3.Ex1.m1.9.9.1.1.3.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.9.9.1.1.3.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3">subscript</csymbol><apply id="Sx3.Ex1.m1.9.9.1.1.3.2.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.9.9.1.1.3.2.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3">superscript</csymbol><ci id="Sx3.Ex1.m1.9.9.1.1.3.2.2.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3.2.2">𝑠</ci><ci id="Sx3.Ex1.m1.9.9.1.1.3.2.3.cmml" xref="Sx3.Ex1.m1.9.9.1.1.3.2.3">𝑡</ci></apply><list id="Sx3.Ex1.m1.2.2.2.3.cmml" xref="Sx3.Ex1.m1.2.2.2.4"><ci id="Sx3.Ex1.m1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.1.1.1.1">𝑖</ci><ci id="Sx3.Ex1.m1.2.2.2.2.cmml" xref="Sx3.Ex1.m1.2.2.2.2">𝑚</ci></list></apply><ci id="Sx3.Ex1.m1.9.9.1.1.4.cmml" xref="Sx3.Ex1.m1.9.9.1.1.4">𝑙</ci><ci id="Sx3.Ex1.m1.9.9.1.1.5.cmml" xref="Sx3.Ex1.m1.9.9.1.1.5">𝑜</ci><ci id="Sx3.Ex1.m1.9.9.1.1.6.cmml" xref="Sx3.Ex1.m1.9.9.1.1.6">𝑔</ci><apply id="Sx3.Ex1.m1.9.9.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.9.9.1.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1">subscript</csymbol><apply id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1">superscript</csymbol><ci id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.2">𝑦</ci><ci id="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex1.m1.9.9.1.1.1.1.1.2.3">𝑡</ci></apply><list id="Sx3.Ex1.m1.4.4.2.3.cmml" xref="Sx3.Ex1.m1.4.4.2.4"><ci id="Sx3.Ex1.m1.3.3.1.1.cmml" xref="Sx3.Ex1.m1.3.3.1.1">𝑖</ci><ci id="Sx3.Ex1.m1.4.4.2.2.cmml" xref="Sx3.Ex1.m1.4.4.2.2">𝑚</ci></list></apply></apply><apply id="Sx3.Ex1.m1.11.11.3.3.cmml" xref="Sx3.Ex1.m1.11.11.3.3"><times id="Sx3.Ex1.m1.11.11.3.3.3.cmml" xref="Sx3.Ex1.m1.11.11.3.3.3"></times><apply id="Sx3.Ex1.m1.10.10.2.2.1.1.1.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1"><minus id="Sx3.Ex1.m1.10.10.2.2.1.1.1.1.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.1"></minus><cn type="integer" id="Sx3.Ex1.m1.10.10.2.2.1.1.1.2.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.2">1</cn><apply id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.1.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3">subscript</csymbol><apply id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.1.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3">superscript</csymbol><ci id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.2.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.2">𝑠</ci><ci id="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.3.cmml" xref="Sx3.Ex1.m1.10.10.2.2.1.1.1.3.2.3">𝑡</ci></apply><list id="Sx3.Ex1.m1.6.6.2.3.cmml" xref="Sx3.Ex1.m1.6.6.2.4"><ci id="Sx3.Ex1.m1.5.5.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1">𝑖</ci><ci id="Sx3.Ex1.m1.6.6.2.2.cmml" xref="Sx3.Ex1.m1.6.6.2.2">𝑚</ci></list></apply></apply><ci id="Sx3.Ex1.m1.11.11.3.3.4.cmml" xref="Sx3.Ex1.m1.11.11.3.3.4">𝑙</ci><ci id="Sx3.Ex1.m1.11.11.3.3.5.cmml" xref="Sx3.Ex1.m1.11.11.3.3.5">𝑜</ci><ci id="Sx3.Ex1.m1.11.11.3.3.6.cmml" xref="Sx3.Ex1.m1.11.11.3.3.6">𝑔</ci><apply id="Sx3.Ex1.m1.11.11.3.3.2.1.1.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1"><minus id="Sx3.Ex1.m1.11.11.3.3.2.1.1.1.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.1"></minus><cn type="integer" id="Sx3.Ex1.m1.11.11.3.3.2.1.1.2.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.2">1</cn><apply id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.1.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3">subscript</csymbol><apply id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.1.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3">superscript</csymbol><ci id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.2.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.2">𝑦</ci><ci id="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.3.cmml" xref="Sx3.Ex1.m1.11.11.3.3.2.1.1.3.2.3">𝑡</ci></apply><list id="Sx3.Ex1.m1.8.8.2.3.cmml" xref="Sx3.Ex1.m1.8.8.2.4"><ci id="Sx3.Ex1.m1.7.7.1.1.cmml" xref="Sx3.Ex1.m1.7.7.1.1">𝑖</ci><ci id="Sx3.Ex1.m1.8.8.2.2.cmml" xref="Sx3.Ex1.m1.8.8.2.2">𝑚</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex1.m1.11c">\displaystyle{loss}_{i}=s^{t}_{i,m}log(y^{t}_{i,m})+(1-s^{t}_{i,m})log(1-y^{t}_{i,m})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{ptr}=-avg_{ptr}(\sum^{N}_{i=1}(1-g_{i})\sum^{T}_{t=1}\sum^{M}_{m=1}loss_{i})," display="block"><semantics id="Sx3.E5.m1.1a"><mrow id="Sx3.E5.m1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml"><msub id="Sx3.E5.m1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E5.m1.1.1.1.1.3.2" xref="Sx3.E5.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="Sx3.E5.m1.1.1.1.1.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.3.3.2" xref="Sx3.E5.m1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.3.3.1" xref="Sx3.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.3.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.3.3.1a" xref="Sx3.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.3.3.4" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml">r</mi></mrow></msub><mo id="Sx3.E5.m1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E5.m1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.cmml"><mo id="Sx3.E5.m1.1.1.1.1.1a" xref="Sx3.E5.m1.1.1.1.1.1.cmml">−</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1.4" xref="Sx3.E5.m1.1.1.1.1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.2a" xref="Sx3.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="Sx3.E5.m1.1.1.1.1.1.1.5" xref="Sx3.E5.m1.1.1.1.1.1.1.5.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.5.2" xref="Sx3.E5.m1.1.1.1.1.1.1.5.2.cmml">g</mi><mrow id="Sx3.E5.m1.1.1.1.1.1.1.5.3" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.5.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.5.3.1" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1.5.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.5.3.1a" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1.5.3.4" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.4.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.2b" xref="Sx3.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">N</mi></munderover><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><munderover id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo movablelimits="false" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml">t</mi><mo id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml">=</mo><mn id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml">1</mn></mrow><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">T</mi></munderover><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><munderover id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml"><mo movablelimits="false" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.2.cmml">m</mi><mo id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.1.cmml">=</mo><mn id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.3.cmml">1</mn></mrow><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.3.cmml">M</mi></munderover><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1a" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">​</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.4" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1b" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">​</mo><msub id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.2.cmml">s</mi><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E5.m1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.1b"><apply id="Sx3.E5.m1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1"><eq id="Sx3.E5.m1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.2"></eq><apply id="Sx3.E5.m1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.3.2">ℒ</ci><apply id="Sx3.E5.m1.1.1.1.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3"><times id="Sx3.E5.m1.1.1.1.1.3.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.1"></times><ci id="Sx3.E5.m1.1.1.1.1.3.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.2">𝑝</ci><ci id="Sx3.E5.m1.1.1.1.1.3.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3">𝑡</ci><ci id="Sx3.E5.m1.1.1.1.1.3.3.4.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.4">𝑟</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1"><minus id="Sx3.E5.m1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1"></minus><apply id="Sx3.E5.m1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1"><times id="Sx3.E5.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.E5.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.3">𝑎</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.4.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.4">𝑣</ci><apply id="Sx3.E5.m1.1.1.1.1.1.1.5.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.5.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.1.1.5.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.2">𝑔</ci><apply id="Sx3.E5.m1.1.1.1.1.1.1.5.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3"><times id="Sx3.E5.m1.1.1.1.1.1.1.5.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.1"></times><ci id="Sx3.E5.m1.1.1.1.1.1.1.5.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.2">𝑝</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.5.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.3">𝑡</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.5.3.4.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.5.3.4">𝑟</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1"><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><sum id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑁</ci></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3"><eq id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3"><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><sum id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.2"></sum><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.3">𝑇</ci></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3"><eq id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1"></eq><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2">𝑡</ci><cn type="integer" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3">1</cn></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2"><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1">subscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1">superscript</csymbol><sum id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.2"></sum><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2.3">𝑀</ci></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3"><eq id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.1"></eq><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.2">𝑚</ci><cn type="integer" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2"><times id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1"></times><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑙</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.3">𝑜</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.4.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.4">𝑠</ci><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.2">𝑠</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.5.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.1c">\displaystyle\mathcal{L}_{ptr}=-avg_{ptr}(\sum^{N}_{i=1}(1-g_{i})\sum^{T}_{t=1}\sum^{M}_{m=1}loss_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx1.Px2.p2.9" class="ltx_p">where <math id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.3.m1.1c">N</annotation></semantics></math> is the number of training set instances, <math id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.4.m2.1c">T</annotation></semantics></math> is the maximum decoding length, and <math id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.5.m3.1c">M</annotation></semantics></math> is the maximum capacity of OCR tokens detected in an image. <math id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2" class="ltx_Math" alttext="s^{t}_{i,m}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.2.cmml">s</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.4" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.4.1" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.2.cmml">m</mi></mrow><mi id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2b"><apply id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.2">𝑠</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.3.2.3">𝑡</ci></apply><list id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.4"><ci id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.1.1.1.1">𝑖</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.6.m4.2c">s^{t}_{i,m}</annotation></semantics></math> is the score of the ground-truth answer token for the <math id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1a"><mi id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1b"><ci id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.7.m5.1c">t</annotation></semantics></math>-th step, and <math id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2" class="ltx_Math" alttext="y^{t}_{i,m}" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2a"><msubsup id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.2.cmml">y</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.4" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.1.1.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.4.1" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.2.cmml">m</mi></mrow><mi id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2b"><apply id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3">subscript</csymbol><apply id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.2">𝑦</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.3.2.3">𝑡</ci></apply><list id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.4"><ci id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.1.1.1.1">𝑖</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.8.m6.2c">y^{t}_{i,m}</annotation></semantics></math> is the predicted OCR score in Eq. (<a href="#Sx3.E4" title="In Dynamic Pointer Network ‣ Two-Branch Answer Prediction Network ‣ Dual Routing Prediction Module ‣ Method ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). Because the valid decoding length for each instance may differ, <math id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1" class="ltx_Math" alttext="avg_{ptr}(\cdot)" display="inline"><semantics id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1a"><mrow id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.3" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1a" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1.cmml">​</mo><msub id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.2.cmml">g</mi><mrow id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.cmml"><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.3" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1a" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.4" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.4.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1b" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.5.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.5.2.1" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.1" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.5.2.2" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1b"><apply id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2"><times id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.2">𝑎</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.3">𝑣</ci><apply id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4">subscript</csymbol><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.2">𝑔</ci><apply id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3"><times id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.1"></times><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.2.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.2">𝑝</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.3.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.3">𝑡</ci><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.4.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.2.4.3.4">𝑟</ci></apply></apply><ci id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.1.cmml" xref="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx1.Px2.p2.9.m7.1c">avg_{ptr}(\cdot)</annotation></semantics></math> averages the loss from all valid decoding steps of these instances.</p>
</div>
</section>
</section>
<section id="Sx3.SSx4.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Gating Network</h4>

<div id="Sx3.SSx4.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p1.4" class="ltx_p">The questions in the VQA task are open-ended, requiring the model to use a variety of abilities and knowledge to solve them. We divide the instances of the dataset into two categories based on whether they are answered with the text in images. The aforementioned dynamic pointer network handles cases where an answer sequence must be generated using detected OCR tokens in the image, while the classifier handles other common cases. To deal with this dynamic routing process, a gating network is proposed. The gating network is essentially a Multi-Layer Perception network (MLP) designed for binary classification. For the <math id="Sx3.SSx4.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.1.m1.1a"><mi id="Sx3.SSx4.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.1.m1.1c">i</annotation></semantics></math>-th (where <math id="Sx3.SSx4.SSSx2.p1.2.m2.3" class="ltx_Math" alttext="i=1,...,N" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.2.m2.3a"><mrow id="Sx3.SSx4.SSSx2.p1.2.m2.3.4" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.cmml"><mi id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.2.cmml">i</mi><mo id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.1" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.1.cmml">=</mo><mrow id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.1.cmml"><mn id="Sx3.SSx4.SSSx2.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.cmml">1</mn><mo id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.2.1" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.SSSx2.p1.2.m2.2.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.2.2.cmml">…</mi><mo id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.2.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx4.SSSx2.p1.2.m2.3.3" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.2.m2.3b"><apply id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4"><eq id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.1"></eq><ci id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.2.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.2">𝑖</ci><list id="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.4.3.2"><cn type="integer" id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1">1</cn><ci id="Sx3.SSx4.SSSx2.p1.2.m2.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.2.2">…</ci><ci id="Sx3.SSx4.SSSx2.p1.2.m2.3.3.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.2.m2.3c">i=1,...,N</annotation></semantics></math>) instance, we take <math id="Sx3.SSx4.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="{z}_{i}^{[CLS]}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.3.m3.1a"><msubsup id="Sx3.SSx4.SSSx2.p1.3.m3.1.2" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.2" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.2.cmml">z</mi><mi id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.3" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.3.cmml">i</mi><mrow id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.2" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.2" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.3" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1a" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.4" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.3" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.3.m3.1b"><apply id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2">superscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.2">𝑧</ci><ci id="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.3.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.2.2.3">𝑖</ci></apply><apply id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1"><times id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.1"></times><ci id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.2">𝐶</ci><ci id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.3">𝐿</ci><ci id="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.4.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m3.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.3.m3.1c">{z}_{i}^{[CLS]}</annotation></semantics></math> as input and compute the gating score <math id="Sx3.SSx4.SSSx2.p1.4.m4.1" class="ltx_Math" alttext="\hat{g}_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.4.m4.1a"><msub id="Sx3.SSx4.SSSx2.p1.4.m4.1.1" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.cmml"><mover accent="true" id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.2" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.2.cmml">g</mi><mo id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.1" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.3" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.4.m4.1b"><apply id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2"><ci id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.1">^</ci><ci id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.2.2">𝑔</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.4.m4.1c">\hat{g}_{i}</annotation></semantics></math> as follows:</p>
<table id="Sx3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E6.m1.2" class="ltx_Math" alttext="\hat{g}_{i}=\sigma(W_{2}ReLU(W_{1}z_{i}^{[CLS]}+b_{1})+b_{2})," display="block"><semantics id="Sx3.E6.m1.2a"><mrow id="Sx3.E6.m1.2.2.1" xref="Sx3.E6.m1.2.2.1.1.cmml"><mrow id="Sx3.E6.m1.2.2.1.1" xref="Sx3.E6.m1.2.2.1.1.cmml"><msub id="Sx3.E6.m1.2.2.1.1.3" xref="Sx3.E6.m1.2.2.1.1.3.cmml"><mover accent="true" id="Sx3.E6.m1.2.2.1.1.3.2" xref="Sx3.E6.m1.2.2.1.1.3.2.cmml"><mi id="Sx3.E6.m1.2.2.1.1.3.2.2" xref="Sx3.E6.m1.2.2.1.1.3.2.2.cmml">g</mi><mo id="Sx3.E6.m1.2.2.1.1.3.2.1" xref="Sx3.E6.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="Sx3.E6.m1.2.2.1.1.3.3" xref="Sx3.E6.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.E6.m1.2.2.1.1.2" xref="Sx3.E6.m1.2.2.1.1.2.cmml">=</mo><mrow id="Sx3.E6.m1.2.2.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E6.m1.2.2.1.1.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.4" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2a" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.5" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2b" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.6" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.6.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2c" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.7" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.7.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2d" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">z</mi><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mrow id="Sx3.E6.m1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E6.m1.1.1.1.1.2" xref="Sx3.E6.m1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E6.m1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.1.1.1.1.1.2" xref="Sx3.E6.m1.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.E6.m1.1.1.1.1.1.3" xref="Sx3.E6.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.1.1.1.1.1.1a" xref="Sx3.E6.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.E6.m1.1.1.1.1.1.4" xref="Sx3.E6.m1.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="Sx3.E6.m1.1.1.1.1.3" xref="Sx3.E6.m1.1.1.1.2.1.cmml">]</mo></mrow></msubsup></mrow><mo id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E6.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">+</mo><msub id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.2" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="Sx3.E6.m1.2.2.1.1.1.1.1.3" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E6.m1.2.2.1.2" xref="Sx3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.2b"><apply id="Sx3.E6.m1.2.2.1.1.cmml" xref="Sx3.E6.m1.2.2.1"><eq id="Sx3.E6.m1.2.2.1.1.2.cmml" xref="Sx3.E6.m1.2.2.1.1.2"></eq><apply id="Sx3.E6.m1.2.2.1.1.3.cmml" xref="Sx3.E6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.3.1.cmml" xref="Sx3.E6.m1.2.2.1.1.3">subscript</csymbol><apply id="Sx3.E6.m1.2.2.1.1.3.2.cmml" xref="Sx3.E6.m1.2.2.1.1.3.2"><ci id="Sx3.E6.m1.2.2.1.1.3.2.1.cmml" xref="Sx3.E6.m1.2.2.1.1.3.2.1">^</ci><ci id="Sx3.E6.m1.2.2.1.1.3.2.2.cmml" xref="Sx3.E6.m1.2.2.1.1.3.2.2">𝑔</ci></apply><ci id="Sx3.E6.m1.2.2.1.1.3.3.cmml" xref="Sx3.E6.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="Sx3.E6.m1.2.2.1.1.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1"><times id="Sx3.E6.m1.2.2.1.1.1.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.2"></times><ci id="Sx3.E6.m1.2.2.1.1.1.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.3">𝜎</ci><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1"><plus id="Sx3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.2"></plus><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1"><times id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.4">𝑅</ci><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.5.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.5">𝑒</ci><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.6.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.6">𝐿</ci><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.7.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.7">𝑈</ci><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><plus id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><times id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><cn type="integer" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑧</ci><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><apply id="Sx3.E6.m1.1.1.1.2.cmml" xref="Sx3.E6.m1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E6.m1.1.1.1.2.1.cmml" xref="Sx3.E6.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E6.m1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1"><times id="Sx3.E6.m1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.1"></times><ci id="Sx3.E6.m1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.1.1.1.1.1.2">𝐶</ci><ci id="Sx3.E6.m1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.1.1.1.1.1.3">𝐿</ci><ci id="Sx3.E6.m1.1.1.1.1.1.4.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></apply><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E6.m1.2.2.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.2c">\hat{g}_{i}=\sigma(W_{2}ReLU(W_{1}z_{i}^{[CLS]}+b_{1})+b_{2}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx2.p1.9" class="ltx_p">where <math id="Sx3.SSx4.SSSx2.p1.5.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.5.m1.1a"><msub id="Sx3.SSx4.SSSx2.p1.5.m1.1.1" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1.cmml"><mi id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.2" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1.2.cmml">W</mi><mi id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.3" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.5.m1.1b"><apply id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1.2">𝑊</ci><ci id="Sx3.SSx4.SSSx2.p1.5.m1.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.5.m1.1c">W_{i}</annotation></semantics></math> and <math id="Sx3.SSx4.SSSx2.p1.6.m2.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.6.m2.1a"><msub id="Sx3.SSx4.SSSx2.p1.6.m2.1.1" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1.cmml"><mi id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.2" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1.2.cmml">b</mi><mi id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.3" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.6.m2.1b"><apply id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1.2">𝑏</ci><ci id="Sx3.SSx4.SSSx2.p1.6.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.6.m2.1c">b_{i}</annotation></semantics></math> are learnable parameters, and <math id="Sx3.SSx4.SSSx2.p1.7.m3.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.7.m3.1a"><mrow id="Sx3.SSx4.SSSx2.p1.7.m3.1.2" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.2" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.1" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.3.2" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.3.2.1" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.7.m3.1.1" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.3.2.2" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.7.m3.1b"><apply id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2"><times id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.1"></times><ci id="Sx3.SSx4.SSSx2.p1.7.m3.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.2.2">𝜎</ci><ci id="Sx3.SSx4.SSSx2.p1.7.m3.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.7.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.7.m3.1c">\sigma(\cdot)</annotation></semantics></math> is the sigmoid function that projects the value into the range [0, 1]. During inference, we use the ceiling function to convert <math id="Sx3.SSx4.SSSx2.p1.8.m4.1" class="ltx_Math" alttext="\hat{g}_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.8.m4.1a"><msub id="Sx3.SSx4.SSSx2.p1.8.m4.1.1" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.cmml"><mover accent="true" id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.2" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.2.cmml">g</mi><mo id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.1" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.3" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.8.m4.1b"><apply id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2"><ci id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.1">^</ci><ci id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.2.2">𝑔</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.8.m4.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.8.m4.1c">\hat{g}_{i}</annotation></semantics></math> to discrete values 0 and 1 as a routing indicator to activate a best-match answer from the above two branches, <em id="Sx3.SSx4.SSSx2.p1.9.1" class="ltx_emph ltx_font_italic">i.e.</em>, the classifier and the dynamic pointer network. The gating network is trained with the BCE loss <math id="Sx3.SSx4.SSSx2.p1.9.m5.1" class="ltx_Math" alttext="\mathcal{L}_{gate}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.9.m5.1a"><msub id="Sx3.SSx4.SSSx2.p1.9.m5.1.1" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.2" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.2.cmml">ℒ</mi><mrow id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.2" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.3" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1a" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.4" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1b" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.5" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.9.m5.1b"><apply id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.2">ℒ</ci><apply id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3"><times id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.1"></times><ci id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.2">𝑔</ci><ci id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.3">𝑎</ci><ci id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.4.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.4">𝑡</ci><ci id="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.5.cmml" xref="Sx3.SSx4.SSSx2.p1.9.m5.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.9.m5.1c">\mathcal{L}_{gate}</annotation></semantics></math> as follows:</p>
<table id="Sx3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E7.m1.1" class="ltx_Math" alttext="\mathcal{L}_{gate}=-\frac{1}{N}\sum^{N}_{i=1}[g_{i}log(\hat{g}_{i})+(1-g_{i})log(1-\hat{g}_{i})]," display="block"><semantics id="Sx3.E7.m1.1a"><mrow id="Sx3.E7.m1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.cmml"><mrow id="Sx3.E7.m1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.cmml"><msub id="Sx3.E7.m1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E7.m1.1.1.1.1.3.2" xref="Sx3.E7.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="Sx3.E7.m1.1.1.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.3.3.cmml"><mi id="Sx3.E7.m1.1.1.1.1.3.3.2" xref="Sx3.E7.m1.1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.3.3.1" xref="Sx3.E7.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.3.3.3" xref="Sx3.E7.m1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.3.3.1a" xref="Sx3.E7.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.3.3.4" xref="Sx3.E7.m1.1.1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.3.3.1b" xref="Sx3.E7.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.3.3.5" xref="Sx3.E7.m1.1.1.1.1.3.3.5.cmml">e</mi></mrow></msub><mo id="Sx3.E7.m1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E7.m1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.cmml"><mo id="Sx3.E7.m1.1.1.1.1.1a" xref="Sx3.E7.m1.1.1.1.1.1.cmml">−</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml"><mfrac id="Sx3.E7.m1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.3.cmml"><mn id="Sx3.E7.m1.1.1.1.1.1.1.3.2" xref="Sx3.E7.m1.1.1.1.1.1.1.3.2.cmml">1</mn><mi id="Sx3.E7.m1.1.1.1.1.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.cmml"><munderover id="Sx3.E7.m1.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml">N</mi></munderover><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.5" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2b" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.6" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2c" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">g</mi><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.4" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3a" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.5" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3b" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.6" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3c" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">​</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><mrow id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mn id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml">1</mn><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml">−</mo><msub id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml"><mover accent="true" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2.cmml">g</mi><mo id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1.cmml">^</mo></mover><mi id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E7.m1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.1b"><apply id="Sx3.E7.m1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1"><eq id="Sx3.E7.m1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.2"></eq><apply id="Sx3.E7.m1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E7.m1.1.1.1.1.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.3.2">ℒ</ci><apply id="Sx3.E7.m1.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3"><times id="Sx3.E7.m1.1.1.1.1.3.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3.1"></times><ci id="Sx3.E7.m1.1.1.1.1.3.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3.2">𝑔</ci><ci id="Sx3.E7.m1.1.1.1.1.3.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3.3">𝑎</ci><ci id="Sx3.E7.m1.1.1.1.1.3.3.4.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3.4">𝑡</ci><ci id="Sx3.E7.m1.1.1.1.1.3.3.5.cmml" xref="Sx3.E7.m1.1.1.1.1.3.3.5">𝑒</ci></apply></apply><apply id="Sx3.E7.m1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1"><minus id="Sx3.E7.m1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1"></minus><apply id="Sx3.E7.m1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1"><times id="Sx3.E7.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.2"></times><apply id="Sx3.E7.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3"><divide id="Sx3.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3"></divide><cn type="integer" id="Sx3.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3.2">1</cn><ci id="Sx3.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1"><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2">superscript</csymbol><sum id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.2.3">𝑁</ci></apply><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3"><eq id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1"><plus id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.4"></plus><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.4">𝑙</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.5">𝑜</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.6">𝑔</ci><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci></apply><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3"><times id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3"></times><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><minus id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑔</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.4">𝑙</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.6.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.6">𝑔</ci><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"><minus id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.1"></minus><cn type="integer" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.2">1</cn><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3">subscript</csymbol><apply id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2"><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.1">^</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.2.2">𝑔</ci></apply><ci id="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.1c">\mathcal{L}_{gate}=-\frac{1}{N}\sum^{N}_{i=1}[g_{i}log(\hat{g}_{i})+(1-g_{i})log(1-\hat{g}_{i})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx2.p1.11" class="ltx_p">where <math id="Sx3.SSx4.SSSx2.p1.10.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.10.m1.1a"><mi id="Sx3.SSx4.SSSx2.p1.10.m1.1.1" xref="Sx3.SSx4.SSSx2.p1.10.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.10.m1.1b"><ci id="Sx3.SSx4.SSSx2.p1.10.m1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.10.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.10.m1.1c">N</annotation></semantics></math> is the number of training set instances, and <math id="Sx3.SSx4.SSSx2.p1.11.m2.1" class="ltx_Math" alttext="g_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.11.m2.1a"><msub id="Sx3.SSx4.SSSx2.p1.11.m2.1.1" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1.cmml"><mi id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.2" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1.2.cmml">g</mi><mi id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.3" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.11.m2.1b"><apply id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1.2">𝑔</ci><ci id="Sx3.SSx4.SSSx2.p1.11.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.11.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.11.m2.1c">g_{i}</annotation></semantics></math> denotes the ground-truth routing flag with a value of 0 or 1.</p>
</div>
<figure id="Sx3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="Sx3.F3.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;">
<img src="/html/2211.14450/assets/pic7.png" id="Sx3.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="414" alt="Refer to caption">
<p id="Sx3.F3.1.1" class="ltx_p">Q1: What number is lit up on the bus?</p>
<p id="Sx3.F3.1.2" class="ltx_p"><span id="Sx3.F3.1.2.1" class="ltx_text ltx_font_bold">VinVL</span>: 1</p>
<p id="Sx3.F3.1.3" class="ltx_p"><span id="Sx3.F3.1.3.1" class="ltx_text ltx_font_bold">TDR (ours)</span>: 407</p>
<p id="Sx3.F3.1.4" class="ltx_p"><span id="Sx3.F3.1.4.1" class="ltx_text ltx_font_bold">Human</span>: 407</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="Sx3.F3.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;">
<img src="/html/2211.14450/assets/pic8.png" id="Sx3.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="414" alt="Refer to caption">
<p id="Sx3.F3.2.1" class="ltx_p">Q2: What number is on the right man’s shirt?</p>
<p id="Sx3.F3.2.2" class="ltx_p"><span id="Sx3.F3.2.2.1" class="ltx_text ltx_font_bold">VinVL</span>: 7</p>
<p id="Sx3.F3.2.3" class="ltx_p"><span id="Sx3.F3.2.3.1" class="ltx_text ltx_font_bold">TDR (ours)</span>: 5</p>
<p id="Sx3.F3.2.4" class="ltx_p"><span id="Sx3.F3.2.4.1" class="ltx_text ltx_font_bold">Human</span>: 5</p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="Sx3.F3.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;">
<img src="/html/2211.14450/assets/pic9.png" id="Sx3.F3.3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="414" alt="Refer to caption">
<p id="Sx3.F3.3.1" class="ltx_p">Q3: What is the name of this street?</p>
<p id="Sx3.F3.3.2" class="ltx_p"><span id="Sx3.F3.3.2.1" class="ltx_text ltx_font_bold">VinVL</span>: main</p>
<p id="Sx3.F3.3.3" class="ltx_p"><span id="Sx3.F3.3.3.1" class="ltx_text ltx_font_bold">TDR (ours)</span>: FLAMING</p>
<p id="Sx3.F3.3.4" class="ltx_p">LIPS ALLEY</p>
<p id="Sx3.F3.3.5" class="ltx_p"><span id="Sx3.F3.3.5.1" class="ltx_text ltx_font_bold">Human</span>: FLAMING</p>
<p id="Sx3.F3.3.6" class="ltx_p">LIPS ALLEY</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="Sx3.F3.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;">
<img src="/html/2211.14450/assets/pic6.png" id="Sx3.F3.4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="414" alt="Refer to caption">
<p id="Sx3.F3.4.1" class="ltx_p">Q4: What is written on the flag?</p>
<p id="Sx3.F3.4.2" class="ltx_p"><span id="Sx3.F3.4.2.1" class="ltx_text ltx_font_bold">VinVL</span>: nothing</p>
<p id="Sx3.F3.4.3" class="ltx_p"><span id="Sx3.F3.4.3.1" class="ltx_text ltx_font_bold">TDR (ours)</span>: MAXIGLIDE</p>
<p id="Sx3.F3.4.4" class="ltx_p"><span id="Sx3.F3.4.4.1" class="ltx_text ltx_font_bold">Human</span>: MAXIGLIDE</p>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Qualitative examples on the VQA v2.0 validation set.</figcaption>
</figure>
</section>
</section>
<section id="Sx3.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Overall Objective Function</h3>

<div id="Sx3.SSx5.p1" class="ltx_para">
<p id="Sx3.SSx5.p1.2" class="ltx_p">To eliminate the impact of imbalance distribution in the proposed two branches, we use the weighted version for <math id="Sx3.SSx5.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{cls}" display="inline"><semantics id="Sx3.SSx5.p1.1.m1.1a"><msub id="Sx3.SSx5.p1.1.m1.1.1" xref="Sx3.SSx5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx5.p1.1.m1.1.1.2" xref="Sx3.SSx5.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="Sx3.SSx5.p1.1.m1.1.1.3" xref="Sx3.SSx5.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx5.p1.1.m1.1.1.3.2" xref="Sx3.SSx5.p1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.1.m1.1.1.3.1" xref="Sx3.SSx5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.1.m1.1.1.3.3" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.1.m1.1.1.3.1a" xref="Sx3.SSx5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.1.m1.1.1.3.4" xref="Sx3.SSx5.p1.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.1.m1.1b"><apply id="Sx3.SSx5.p1.1.m1.1.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.2">ℒ</ci><apply id="Sx3.SSx5.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3"><times id="Sx3.SSx5.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.1"></times><ci id="Sx3.SSx5.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.2">𝑐</ci><ci id="Sx3.SSx5.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3">𝑙</ci><ci id="Sx3.SSx5.p1.1.m1.1.1.3.4.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.1.m1.1c">\mathcal{L}_{cls}</annotation></semantics></math> in Eq. (<a href="#Sx3.E3" title="In Classifier ‣ Two-Branch Answer Prediction Network ‣ Dual Routing Prediction Module ‣ Method ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and <math id="Sx3.SSx5.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{ptr}" display="inline"><semantics id="Sx3.SSx5.p1.2.m2.1a"><msub id="Sx3.SSx5.p1.2.m2.1.1" xref="Sx3.SSx5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx5.p1.2.m2.1.1.2" xref="Sx3.SSx5.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="Sx3.SSx5.p1.2.m2.1.1.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.3.2" xref="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.2.m2.1.1.3.1" xref="Sx3.SSx5.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.2.m2.1.1.3.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.2.m2.1.1.3.1a" xref="Sx3.SSx5.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.2.m2.1.1.3.4" xref="Sx3.SSx5.p1.2.m2.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.2.m2.1b"><apply id="Sx3.SSx5.p1.2.m2.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx5.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2">ℒ</ci><apply id="Sx3.SSx5.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3"><times id="Sx3.SSx5.p1.2.m2.1.1.3.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.1"></times><ci id="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.2">𝑝</ci><ci id="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3">𝑡</ci><ci id="Sx3.SSx5.p1.2.m2.1.1.3.4.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.2.m2.1c">\mathcal{L}_{ptr}</annotation></semantics></math> in Eq. (<a href="#Sx3.E5" title="In Dynamic Pointer Network ‣ Two-Branch Answer Prediction Network ‣ Dual Routing Prediction Module ‣ Method ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Finally, the objective function is formatted as follows:</p>
<table id="Sx3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E8.m1.1" class="ltx_Math" alttext="\mathcal{L}=\omega_{cls}\mathcal{L}_{cls}+\omega_{ptr}\mathcal{L}_{ptr}+\mathcal{L}_{gate}," display="block"><semantics id="Sx3.E8.m1.1a"><mrow id="Sx3.E8.m1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml"><mrow id="Sx3.E8.m1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E8.m1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="Sx3.E8.m1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="Sx3.E8.m1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.3.cmml"><mrow id="Sx3.E8.m1.1.1.1.1.3.2" xref="Sx3.E8.m1.1.1.1.1.3.2.cmml"><msub id="Sx3.E8.m1.1.1.1.1.3.2.2" xref="Sx3.E8.m1.1.1.1.1.3.2.2.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.2.2.2" xref="Sx3.E8.m1.1.1.1.1.3.2.2.2.cmml">ω</mi><mrow id="Sx3.E8.m1.1.1.1.1.3.2.2.3" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.2.2.3.2" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.2.2.3.1" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.2.2.3.3" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.2.2.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.2.2.3.4" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.2.1" xref="Sx3.E8.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="Sx3.E8.m1.1.1.1.1.3.2.3" xref="Sx3.E8.m1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E8.m1.1.1.1.1.3.2.3.2" xref="Sx3.E8.m1.1.1.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="Sx3.E8.m1.1.1.1.1.3.2.3.3" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.2.3.3.2" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.2.3.3.1" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.2.3.3.3" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.2.3.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.2.3.3.4" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.4.cmml">s</mi></mrow></msub></mrow><mo id="Sx3.E8.m1.1.1.1.1.3.1" xref="Sx3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="Sx3.E8.m1.1.1.1.1.3.3" xref="Sx3.E8.m1.1.1.1.1.3.3.cmml"><msub id="Sx3.E8.m1.1.1.1.1.3.3.2" xref="Sx3.E8.m1.1.1.1.1.3.3.2.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.3.2.2" xref="Sx3.E8.m1.1.1.1.1.3.3.2.2.cmml">ω</mi><mrow id="Sx3.E8.m1.1.1.1.1.3.3.2.3" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.3.2.3.2" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.3.2.3.1" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.3.2.3.3" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.3.2.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.3.2.3.4" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.4.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.3.1" xref="Sx3.E8.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="Sx3.E8.m1.1.1.1.1.3.3.3" xref="Sx3.E8.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E8.m1.1.1.1.1.3.3.3.2" xref="Sx3.E8.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="Sx3.E8.m1.1.1.1.1.3.3.3.3" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.3.3.3.2" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.3.3.3.1" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.3.3.3.3" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.3.3.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.3.3.3.4" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.4.cmml">r</mi></mrow></msub></mrow><mo id="Sx3.E8.m1.1.1.1.1.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.1.cmml">+</mo><msub id="Sx3.E8.m1.1.1.1.1.3.4" xref="Sx3.E8.m1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E8.m1.1.1.1.1.3.4.2" xref="Sx3.E8.m1.1.1.1.1.3.4.2.cmml">ℒ</mi><mrow id="Sx3.E8.m1.1.1.1.1.3.4.3" xref="Sx3.E8.m1.1.1.1.1.3.4.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.3.4.3.2" xref="Sx3.E8.m1.1.1.1.1.3.4.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.4.3.1" xref="Sx3.E8.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.4.3.3" xref="Sx3.E8.m1.1.1.1.1.3.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.4.3.1a" xref="Sx3.E8.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.4.3.4" xref="Sx3.E8.m1.1.1.1.1.3.4.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.3.4.3.1b" xref="Sx3.E8.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="Sx3.E8.m1.1.1.1.1.3.4.3.5" xref="Sx3.E8.m1.1.1.1.1.3.4.3.5.cmml">e</mi></mrow></msub></mrow></mrow><mo id="Sx3.E8.m1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E8.m1.1b"><apply id="Sx3.E8.m1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1"><eq id="Sx3.E8.m1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1"></eq><ci id="Sx3.E8.m1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.2">ℒ</ci><apply id="Sx3.E8.m1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3"><plus id="Sx3.E8.m1.1.1.1.1.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.1"></plus><apply id="Sx3.E8.m1.1.1.1.1.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2"><times id="Sx3.E8.m1.1.1.1.1.3.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.1"></times><apply id="Sx3.E8.m1.1.1.1.1.3.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.2">𝜔</ci><apply id="Sx3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3"><times id="Sx3.E8.m1.1.1.1.1.3.2.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.1"></times><ci id="Sx3.E8.m1.1.1.1.1.3.2.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.2">𝑐</ci><ci id="Sx3.E8.m1.1.1.1.1.3.2.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.3">𝑙</ci><ci id="Sx3.E8.m1.1.1.1.1.3.2.2.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.2.3.4">𝑠</ci></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.3.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.2">ℒ</ci><apply id="Sx3.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3"><times id="Sx3.E8.m1.1.1.1.1.3.2.3.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.1"></times><ci id="Sx3.E8.m1.1.1.1.1.3.2.3.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.2">𝑐</ci><ci id="Sx3.E8.m1.1.1.1.1.3.2.3.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.3">𝑙</ci><ci id="Sx3.E8.m1.1.1.1.1.3.2.3.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.2.3.3.4">𝑠</ci></apply></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3"><times id="Sx3.E8.m1.1.1.1.1.3.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.1"></times><apply id="Sx3.E8.m1.1.1.1.1.3.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.2">𝜔</ci><apply id="Sx3.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3"><times id="Sx3.E8.m1.1.1.1.1.3.3.2.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.1"></times><ci id="Sx3.E8.m1.1.1.1.1.3.3.2.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.2">𝑝</ci><ci id="Sx3.E8.m1.1.1.1.1.3.3.2.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.3">𝑡</ci><ci id="Sx3.E8.m1.1.1.1.1.3.3.2.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.2.3.4">𝑟</ci></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.3.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.3.3.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.3.3.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="Sx3.E8.m1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3"><times id="Sx3.E8.m1.1.1.1.1.3.3.3.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.1"></times><ci id="Sx3.E8.m1.1.1.1.1.3.3.3.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.2">𝑝</ci><ci id="Sx3.E8.m1.1.1.1.1.3.3.3.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.3">𝑡</ci><ci id="Sx3.E8.m1.1.1.1.1.3.3.3.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.3.3.3.4">𝑟</ci></apply></apply></apply><apply id="Sx3.E8.m1.1.1.1.1.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.3.4.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.3.4.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.2">ℒ</ci><apply id="Sx3.E8.m1.1.1.1.1.3.4.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3"><times id="Sx3.E8.m1.1.1.1.1.3.4.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3.1"></times><ci id="Sx3.E8.m1.1.1.1.1.3.4.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3.2">𝑔</ci><ci id="Sx3.E8.m1.1.1.1.1.3.4.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3.3">𝑎</ci><ci id="Sx3.E8.m1.1.1.1.1.3.4.3.4.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3.4">𝑡</ci><ci id="Sx3.E8.m1.1.1.1.1.3.4.3.5.cmml" xref="Sx3.E8.m1.1.1.1.1.3.4.3.5">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E8.m1.1c">\mathcal{L}=\omega_{cls}\mathcal{L}_{cls}+\omega_{ptr}\mathcal{L}_{ptr}+\mathcal{L}_{gate},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx5.p1.4" class="ltx_p">where <math id="Sx3.SSx5.p1.3.m1.1" class="ltx_Math" alttext="\omega_{cls}=\frac{\sum^{N}_{i=1}g_{i}}{N}" display="inline"><semantics id="Sx3.SSx5.p1.3.m1.1a"><mrow id="Sx3.SSx5.p1.3.m1.1.1" xref="Sx3.SSx5.p1.3.m1.1.1.cmml"><msub id="Sx3.SSx5.p1.3.m1.1.1.2" xref="Sx3.SSx5.p1.3.m1.1.1.2.cmml"><mi id="Sx3.SSx5.p1.3.m1.1.1.2.2" xref="Sx3.SSx5.p1.3.m1.1.1.2.2.cmml">ω</mi><mrow id="Sx3.SSx5.p1.3.m1.1.1.2.3" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.cmml"><mi id="Sx3.SSx5.p1.3.m1.1.1.2.3.2" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.3.m1.1.1.2.3.1" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.3.m1.1.1.2.3.3" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.3.m1.1.1.2.3.1a" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.3.m1.1.1.2.3.4" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="Sx3.SSx5.p1.3.m1.1.1.1" xref="Sx3.SSx5.p1.3.m1.1.1.1.cmml">=</mo><mfrac id="Sx3.SSx5.p1.3.m1.1.1.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.cmml"><mrow id="Sx3.SSx5.p1.3.m1.1.1.3.2" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.cmml"><mstyle displaystyle="false" id="Sx3.SSx5.p1.3.m1.1.1.3.2.1" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.cmml"><msubsup id="Sx3.SSx5.p1.3.m1.1.1.3.2.1a" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.cmml"><mo id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.2" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.cmml"><mi id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.2" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.2.cmml">i</mi><mo id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.1" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.1.cmml">=</mo><mn id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.3.cmml">N</mi></msubsup></mstyle><msub id="Sx3.SSx5.p1.3.m1.1.1.3.2.2" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2.cmml"><mi id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.2" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2.2.cmml">g</mi><mi id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2.3.cmml">i</mi></msub></mrow><mi id="Sx3.SSx5.p1.3.m1.1.1.3.3" xref="Sx3.SSx5.p1.3.m1.1.1.3.3.cmml">N</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.3.m1.1b"><apply id="Sx3.SSx5.p1.3.m1.1.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1"><eq id="Sx3.SSx5.p1.3.m1.1.1.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.1"></eq><apply id="Sx3.SSx5.p1.3.m1.1.1.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m1.1.1.2.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.3.m1.1.1.2.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.2">𝜔</ci><apply id="Sx3.SSx5.p1.3.m1.1.1.2.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.3"><times id="Sx3.SSx5.p1.3.m1.1.1.2.3.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.1"></times><ci id="Sx3.SSx5.p1.3.m1.1.1.2.3.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.2">𝑐</ci><ci id="Sx3.SSx5.p1.3.m1.1.1.2.3.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.3">𝑙</ci><ci id="Sx3.SSx5.p1.3.m1.1.1.2.3.4.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="Sx3.SSx5.p1.3.m1.1.1.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3"><divide id="Sx3.SSx5.p1.3.m1.1.1.3.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3"></divide><apply id="Sx3.SSx5.p1.3.m1.1.1.3.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2"><apply id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1">subscript</csymbol><apply id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1">superscript</csymbol><sum id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.2"></sum><ci id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.2.3">𝑁</ci></apply><apply id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3"><eq id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.1"></eq><ci id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.1.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2">subscript</csymbol><ci id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.2.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2.2">𝑔</ci><ci id="Sx3.SSx5.p1.3.m1.1.1.3.2.2.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.2.2.3">𝑖</ci></apply></apply><ci id="Sx3.SSx5.p1.3.m1.1.1.3.3.cmml" xref="Sx3.SSx5.p1.3.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.3.m1.1c">\omega_{cls}=\frac{\sum^{N}_{i=1}g_{i}}{N}</annotation></semantics></math>, <math id="Sx3.SSx5.p1.4.m2.1" class="ltx_Math" alttext="\omega_{ptr}=\frac{\sum^{N}_{i=1}(1-g_{i})}{N}" display="inline"><semantics id="Sx3.SSx5.p1.4.m2.1a"><mrow id="Sx3.SSx5.p1.4.m2.1.2" xref="Sx3.SSx5.p1.4.m2.1.2.cmml"><msub id="Sx3.SSx5.p1.4.m2.1.2.2" xref="Sx3.SSx5.p1.4.m2.1.2.2.cmml"><mi id="Sx3.SSx5.p1.4.m2.1.2.2.2" xref="Sx3.SSx5.p1.4.m2.1.2.2.2.cmml">ω</mi><mrow id="Sx3.SSx5.p1.4.m2.1.2.2.3" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.cmml"><mi id="Sx3.SSx5.p1.4.m2.1.2.2.3.2" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.4.m2.1.2.2.3.1" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.4.m2.1.2.2.3.3" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.p1.4.m2.1.2.2.3.1a" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx5.p1.4.m2.1.2.2.3.4" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.4.cmml">r</mi></mrow></msub><mo id="Sx3.SSx5.p1.4.m2.1.2.1" xref="Sx3.SSx5.p1.4.m2.1.2.1.cmml">=</mo><mfrac id="Sx3.SSx5.p1.4.m2.1.1" xref="Sx3.SSx5.p1.4.m2.1.1.cmml"><mrow id="Sx3.SSx5.p1.4.m2.1.1.1" xref="Sx3.SSx5.p1.4.m2.1.1.1.cmml"><mstyle displaystyle="false" id="Sx3.SSx5.p1.4.m2.1.1.1.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.cmml"><msubsup id="Sx3.SSx5.p1.4.m2.1.1.1.2a" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.cmml"><mo id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.SSx5.p1.4.m2.1.1.1.2.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.cmml"><mi id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.1" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.1.cmml">=</mo><mn id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.2.3.cmml">N</mi></msubsup></mstyle><mrow id="Sx3.SSx5.p1.4.m2.1.1.1.1.1" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.cmml"><mn id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.1" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.1.cmml">−</mo><msub id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.cmml"><mi id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.2" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.3" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mi id="Sx3.SSx5.p1.4.m2.1.1.3" xref="Sx3.SSx5.p1.4.m2.1.1.3.cmml">N</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.4.m2.1b"><apply id="Sx3.SSx5.p1.4.m2.1.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.2"><eq id="Sx3.SSx5.p1.4.m2.1.2.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.1"></eq><apply id="Sx3.SSx5.p1.4.m2.1.2.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m2.1.2.2.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2">subscript</csymbol><ci id="Sx3.SSx5.p1.4.m2.1.2.2.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.2">𝜔</ci><apply id="Sx3.SSx5.p1.4.m2.1.2.2.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.3"><times id="Sx3.SSx5.p1.4.m2.1.2.2.3.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.1"></times><ci id="Sx3.SSx5.p1.4.m2.1.2.2.3.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.2">𝑝</ci><ci id="Sx3.SSx5.p1.4.m2.1.2.2.3.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.3">𝑡</ci><ci id="Sx3.SSx5.p1.4.m2.1.2.2.3.4.cmml" xref="Sx3.SSx5.p1.4.m2.1.2.2.3.4">𝑟</ci></apply></apply><apply id="Sx3.SSx5.p1.4.m2.1.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1"><divide id="Sx3.SSx5.p1.4.m2.1.1.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1"></divide><apply id="Sx3.SSx5.p1.4.m2.1.1.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1"><apply id="Sx3.SSx5.p1.4.m2.1.1.1.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m2.1.1.1.2.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2">subscript</csymbol><apply id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2">superscript</csymbol><sum id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.2.2"></sum><ci id="Sx3.SSx5.p1.4.m2.1.1.1.2.2.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.2.3">𝑁</ci></apply><apply id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3"><eq id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.1"></eq><ci id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx5.p1.4.m2.1.1.1.2.3.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1"><minus id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.1"></minus><cn type="integer" id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.2">1</cn><apply id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.2">𝑔</ci><ci id="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><ci id="Sx3.SSx5.p1.4.m2.1.1.3.cmml" xref="Sx3.SSx5.p1.4.m2.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.4.m2.1c">\omega_{ptr}=\frac{\sum^{N}_{i=1}(1-g_{i})}{N}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Dataset</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.1" class="ltx_p">The VQA v2.0 dataset <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al. <a href="#bib.bib10" title="" class="ltx_ref">2017</a>)</cite> includes 265016 images from COCO and abstract scenes, at least 3 open-ended questions per image, and 10 ground-truth answers per question. It is a well-balanced dataset that provides two similar images with distinct answers to the same question. These instances require a detailed visual understanding of images to extract crucial information for reasoning. As a comprehensive dataset, VQA v2.0 covers a wide range of question types, and about 43% of the images contain essential text information. Therefore, a VQA model should apply a variety of skills to complete the task intelligently.</p>
</div>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Evaluation Metric</h3>

<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.1" class="ltx_p">We use the evaluation metric proposed in <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib3" title="" class="ltx_ref">2015</a>)</cite> that is robust to inter-human variable answers as follows:</p>
<table id="Sx4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E9.m1.3" class="ltx_Math" alttext="Acc(ans)=min\{\frac{\#humans\ that\ said\ ans}{3},1\}." display="block"><semantics id="Sx4.E9.m1.3a"><mrow id="Sx4.E9.m1.3.3.1" xref="Sx4.E9.m1.3.3.1.1.cmml"><mrow id="Sx4.E9.m1.3.3.1.1" xref="Sx4.E9.m1.3.3.1.1.cmml"><mrow id="Sx4.E9.m1.3.3.1.1.1" xref="Sx4.E9.m1.3.3.1.1.1.cmml"><mi id="Sx4.E9.m1.3.3.1.1.1.3" xref="Sx4.E9.m1.3.3.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.1.2" xref="Sx4.E9.m1.3.3.1.1.1.2.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.1.4" xref="Sx4.E9.m1.3.3.1.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.1.2a" xref="Sx4.E9.m1.3.3.1.1.1.2.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.1.5" xref="Sx4.E9.m1.3.3.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.1.2b" xref="Sx4.E9.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="Sx4.E9.m1.3.3.1.1.1.1.1" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E9.m1.3.3.1.1.1.1.1.2" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E9.m1.3.3.1.1.1.1.1.1" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.cmml"><mi id="Sx4.E9.m1.3.3.1.1.1.1.1.1.2" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.1.1.1.1.1" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.1.1.1.1.3" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.1.1.1.1.1a" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.1.1.1.1.4" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.4.cmml">s</mi></mrow><mo stretchy="false" id="Sx4.E9.m1.3.3.1.1.1.1.1.3" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E9.m1.3.3.1.1.2" xref="Sx4.E9.m1.3.3.1.1.2.cmml">=</mo><mrow id="Sx4.E9.m1.3.3.1.1.3" xref="Sx4.E9.m1.3.3.1.1.3.cmml"><mi id="Sx4.E9.m1.3.3.1.1.3.2" xref="Sx4.E9.m1.3.3.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.3.1" xref="Sx4.E9.m1.3.3.1.1.3.1.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.3.3" xref="Sx4.E9.m1.3.3.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.3.1a" xref="Sx4.E9.m1.3.3.1.1.3.1.cmml">​</mo><mi id="Sx4.E9.m1.3.3.1.1.3.4" xref="Sx4.E9.m1.3.3.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.3.3.1.1.3.1b" xref="Sx4.E9.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="Sx4.E9.m1.3.3.1.1.3.5.2" xref="Sx4.E9.m1.3.3.1.1.3.5.1.cmml"><mo stretchy="false" id="Sx4.E9.m1.3.3.1.1.3.5.2.1" xref="Sx4.E9.m1.3.3.1.1.3.5.1.cmml">{</mo><mfrac id="Sx4.E9.m1.1.1" xref="Sx4.E9.m1.1.1.cmml"><mrow id="Sx4.E9.m1.1.1.2" xref="Sx4.E9.m1.1.1.2.cmml"><mi mathvariant="normal" id="Sx4.E9.m1.1.1.2.2" xref="Sx4.E9.m1.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.3" xref="Sx4.E9.m1.1.1.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1a" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.4" xref="Sx4.E9.m1.1.1.2.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1b" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.5" xref="Sx4.E9.m1.1.1.2.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1c" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.6" xref="Sx4.E9.m1.1.1.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1d" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.7" xref="Sx4.E9.m1.1.1.2.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1e" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.8" xref="Sx4.E9.m1.1.1.2.8.cmml">s</mi><mo lspace="0.500em" rspace="0em" id="Sx4.E9.m1.1.1.2.1f" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.9" xref="Sx4.E9.m1.1.1.2.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1g" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.10" xref="Sx4.E9.m1.1.1.2.10.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1h" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.11" xref="Sx4.E9.m1.1.1.2.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1i" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.12" xref="Sx4.E9.m1.1.1.2.12.cmml">t</mi><mo lspace="0.500em" rspace="0em" id="Sx4.E9.m1.1.1.2.1j" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.13" xref="Sx4.E9.m1.1.1.2.13.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1k" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.14" xref="Sx4.E9.m1.1.1.2.14.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1l" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.15" xref="Sx4.E9.m1.1.1.2.15.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1m" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.16" xref="Sx4.E9.m1.1.1.2.16.cmml">d</mi><mo lspace="0.500em" rspace="0em" id="Sx4.E9.m1.1.1.2.1n" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.17" xref="Sx4.E9.m1.1.1.2.17.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1o" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.18" xref="Sx4.E9.m1.1.1.2.18.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.E9.m1.1.1.2.1p" xref="Sx4.E9.m1.1.1.2.1.cmml">​</mo><mi id="Sx4.E9.m1.1.1.2.19" xref="Sx4.E9.m1.1.1.2.19.cmml">s</mi></mrow><mn id="Sx4.E9.m1.1.1.3" xref="Sx4.E9.m1.1.1.3.cmml">3</mn></mfrac><mo id="Sx4.E9.m1.3.3.1.1.3.5.2.2" xref="Sx4.E9.m1.3.3.1.1.3.5.1.cmml">,</mo><mn id="Sx4.E9.m1.2.2" xref="Sx4.E9.m1.2.2.cmml">1</mn><mo stretchy="false" id="Sx4.E9.m1.3.3.1.1.3.5.2.3" xref="Sx4.E9.m1.3.3.1.1.3.5.1.cmml">}</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx4.E9.m1.3.3.1.2" xref="Sx4.E9.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E9.m1.3b"><apply id="Sx4.E9.m1.3.3.1.1.cmml" xref="Sx4.E9.m1.3.3.1"><eq id="Sx4.E9.m1.3.3.1.1.2.cmml" xref="Sx4.E9.m1.3.3.1.1.2"></eq><apply id="Sx4.E9.m1.3.3.1.1.1.cmml" xref="Sx4.E9.m1.3.3.1.1.1"><times id="Sx4.E9.m1.3.3.1.1.1.2.cmml" xref="Sx4.E9.m1.3.3.1.1.1.2"></times><ci id="Sx4.E9.m1.3.3.1.1.1.3.cmml" xref="Sx4.E9.m1.3.3.1.1.1.3">𝐴</ci><ci id="Sx4.E9.m1.3.3.1.1.1.4.cmml" xref="Sx4.E9.m1.3.3.1.1.1.4">𝑐</ci><ci id="Sx4.E9.m1.3.3.1.1.1.5.cmml" xref="Sx4.E9.m1.3.3.1.1.1.5">𝑐</ci><apply id="Sx4.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx4.E9.m1.3.3.1.1.1.1.1"><times id="Sx4.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.1"></times><ci id="Sx4.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.2">𝑎</ci><ci id="Sx4.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.3">𝑛</ci><ci id="Sx4.E9.m1.3.3.1.1.1.1.1.1.4.cmml" xref="Sx4.E9.m1.3.3.1.1.1.1.1.1.4">𝑠</ci></apply></apply><apply id="Sx4.E9.m1.3.3.1.1.3.cmml" xref="Sx4.E9.m1.3.3.1.1.3"><times id="Sx4.E9.m1.3.3.1.1.3.1.cmml" xref="Sx4.E9.m1.3.3.1.1.3.1"></times><ci id="Sx4.E9.m1.3.3.1.1.3.2.cmml" xref="Sx4.E9.m1.3.3.1.1.3.2">𝑚</ci><ci id="Sx4.E9.m1.3.3.1.1.3.3.cmml" xref="Sx4.E9.m1.3.3.1.1.3.3">𝑖</ci><ci id="Sx4.E9.m1.3.3.1.1.3.4.cmml" xref="Sx4.E9.m1.3.3.1.1.3.4">𝑛</ci><set id="Sx4.E9.m1.3.3.1.1.3.5.1.cmml" xref="Sx4.E9.m1.3.3.1.1.3.5.2"><apply id="Sx4.E9.m1.1.1.cmml" xref="Sx4.E9.m1.1.1"><divide id="Sx4.E9.m1.1.1.1.cmml" xref="Sx4.E9.m1.1.1"></divide><apply id="Sx4.E9.m1.1.1.2.cmml" xref="Sx4.E9.m1.1.1.2"><times id="Sx4.E9.m1.1.1.2.1.cmml" xref="Sx4.E9.m1.1.1.2.1"></times><ci id="Sx4.E9.m1.1.1.2.2.cmml" xref="Sx4.E9.m1.1.1.2.2">#</ci><ci id="Sx4.E9.m1.1.1.2.3.cmml" xref="Sx4.E9.m1.1.1.2.3">ℎ</ci><ci id="Sx4.E9.m1.1.1.2.4.cmml" xref="Sx4.E9.m1.1.1.2.4">𝑢</ci><ci id="Sx4.E9.m1.1.1.2.5.cmml" xref="Sx4.E9.m1.1.1.2.5">𝑚</ci><ci id="Sx4.E9.m1.1.1.2.6.cmml" xref="Sx4.E9.m1.1.1.2.6">𝑎</ci><ci id="Sx4.E9.m1.1.1.2.7.cmml" xref="Sx4.E9.m1.1.1.2.7">𝑛</ci><ci id="Sx4.E9.m1.1.1.2.8.cmml" xref="Sx4.E9.m1.1.1.2.8">𝑠</ci><ci id="Sx4.E9.m1.1.1.2.9.cmml" xref="Sx4.E9.m1.1.1.2.9">𝑡</ci><ci id="Sx4.E9.m1.1.1.2.10.cmml" xref="Sx4.E9.m1.1.1.2.10">ℎ</ci><ci id="Sx4.E9.m1.1.1.2.11.cmml" xref="Sx4.E9.m1.1.1.2.11">𝑎</ci><ci id="Sx4.E9.m1.1.1.2.12.cmml" xref="Sx4.E9.m1.1.1.2.12">𝑡</ci><ci id="Sx4.E9.m1.1.1.2.13.cmml" xref="Sx4.E9.m1.1.1.2.13">𝑠</ci><ci id="Sx4.E9.m1.1.1.2.14.cmml" xref="Sx4.E9.m1.1.1.2.14">𝑎</ci><ci id="Sx4.E9.m1.1.1.2.15.cmml" xref="Sx4.E9.m1.1.1.2.15">𝑖</ci><ci id="Sx4.E9.m1.1.1.2.16.cmml" xref="Sx4.E9.m1.1.1.2.16">𝑑</ci><ci id="Sx4.E9.m1.1.1.2.17.cmml" xref="Sx4.E9.m1.1.1.2.17">𝑎</ci><ci id="Sx4.E9.m1.1.1.2.18.cmml" xref="Sx4.E9.m1.1.1.2.18">𝑛</ci><ci id="Sx4.E9.m1.1.1.2.19.cmml" xref="Sx4.E9.m1.1.1.2.19">𝑠</ci></apply><cn type="integer" id="Sx4.E9.m1.1.1.3.cmml" xref="Sx4.E9.m1.1.1.3">3</cn></apply><cn type="integer" id="Sx4.E9.m1.2.2.cmml" xref="Sx4.E9.m1.2.2">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E9.m1.3c">Acc(ans)=min\{\frac{\#humans\ that\ said\ ans}{3},1\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx2.p1.2" class="ltx_p">As shown in Eq. (<a href="#Sx4.E9" title="In Evaluation Metric ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), if at least three humans give the same answer, the answer is considered 100% accurate. Before evaluation, a series of regularization operations are performed, such as converting all answers to lowercase, using Arabic numerals uniformly, and removing punctuation marks and articles.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Implementation Details</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.6" class="ltx_p">Our models are implemented in PyTorch and optimized using the Adam optimizer. We fine-tune our BERT-base and BERT-large models with initial learning rates of 5e-05 and 1e-05, respectively. The maximum length of tokenized words is <math id="Sx4.SSx3.p1.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="Sx4.SSx3.p1.1.m1.1a"><mi id="Sx4.SSx3.p1.1.m1.1.1" xref="Sx4.SSx3.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.1.m1.1b"><ci id="Sx4.SSx3.p1.1.m1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.1.m1.1c">V</annotation></semantics></math> = 128. We detect at most <math id="Sx4.SSx3.p1.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="Sx4.SSx3.p1.2.m2.1a"><mi id="Sx4.SSx3.p1.2.m2.1.1" xref="Sx4.SSx3.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.2.m2.1b"><ci id="Sx4.SSx3.p1.2.m2.1.1.cmml" xref="Sx4.SSx3.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.2.m2.1c">E</annotation></semantics></math> = 50 objects and <math id="Sx4.SSx3.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx4.SSx3.p1.3.m3.1a"><mi id="Sx4.SSx3.p1.3.m3.1.1" xref="Sx4.SSx3.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.3.m3.1b"><ci id="Sx4.SSx3.p1.3.m3.1.1.cmml" xref="Sx4.SSx3.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.3.m3.1c">M</annotation></semantics></math> = 50 OCR tokens per image. The maximum decoding step is <math id="Sx4.SSx3.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx4.SSx3.p1.4.m4.1a"><mi id="Sx4.SSx3.p1.4.m4.1.1" xref="Sx4.SSx3.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.4.m4.1b"><ci id="Sx4.SSx3.p1.4.m4.1.1.cmml" xref="Sx4.SSx3.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.4.m4.1c">T</annotation></semantics></math> = 12. The dimensionality of the embedding space is set to <math id="Sx4.SSx3.p1.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx4.SSx3.p1.5.m5.1a"><mi id="Sx4.SSx3.p1.5.m5.1.1" xref="Sx4.SSx3.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.5.m5.1b"><ci id="Sx4.SSx3.p1.5.m5.1.1.cmml" xref="Sx4.SSx3.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.5.m5.1c">d</annotation></semantics></math> = 768. The candidate set has a size of <math id="Sx4.SSx3.p1.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="Sx4.SSx3.p1.6.m6.1a"><mi id="Sx4.SSx3.p1.6.m6.1.1" xref="Sx4.SSx3.p1.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.6.m6.1b"><ci id="Sx4.SSx3.p1.6.m6.1.1.cmml" xref="Sx4.SSx3.p1.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.6.m6.1c">C</annotation></semantics></math> = 3129. The dropout rate is 0.3 and the weight decay is 0.05. We use 12 attention heads in transformer layers and leave the other hyper-parameters unchanged from BERT <cite class="ltx_cite ltx_citemacro_citep">(Kenton and Toutanova <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite>. Due to hardware limitations, we run the training procedure for 35 epochs with a batch size of 48.</p>
</div>
</section>
<section id="Sx4.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Comparison with State-of-The-Art Methods</h3>

<div id="Sx4.SSx4.p1" class="ltx_para">
<p id="Sx4.SSx4.p1.1" class="ltx_p">We compare TDR with previous state-of-the-art methods including UNITER <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>, VILLA <cite class="ltx_cite ltx_citemacro_citep">(Gan et al. <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, ERNIE-VIL <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>, Oscar <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite> and the strongest baseline VinVL <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> on the VQA v2.0 testing set (<em id="Sx4.SSx4.p1.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, “test-dev” and “test-std”). Table <a href="#Sx4.T1" title="Table 1 ‣ Comparison with State-of-The-Art Methods ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> gives an overall comparison of BERT-base size and BERT-large size models. TDR outperforms all the other methods and especially surpasses VinVL by around 0.8% under the same experimental setting. To further validate the effect on different answer-type instances, we compare TDR with VinVL in Table <a href="#Sx4.T2" title="Table 2 ‣ Comparison with State-of-The-Art Methods ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we find that our final model (line 3) leads to over 4% improvement on “number” answer-type instances of VQA v2.0 dataset (line 1).</p>
</div>
<figure id="Sx4.T1" class="ltx_table">
<table id="Sx4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T1.1.1.1" class="ltx_tr">
<th id="Sx4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="Sx4.T1.1.1.1.1.1" class="ltx_text">Dataset</span></th>
<td id="Sx4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">VQA v2.0</td>
</tr>
<tr id="Sx4.T1.1.2.2" class="ltx_tr">
<td id="Sx4.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Test-dev</td>
<td id="Sx4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Test-std</td>
</tr>
<tr id="Sx4.T1.1.3.3" class="ltx_tr">
<th id="Sx4.T1.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Model Size</th>
<td id="Sx4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">Base</td>
<td id="Sx4.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Large</td>
<td id="Sx4.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">Base</td>
<td id="Sx4.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">Large</td>
</tr>
<tr id="Sx4.T1.1.4.4" class="ltx_tr">
<th id="Sx4.T1.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">UNITER</th>
<td id="Sx4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">72.27</td>
<td id="Sx4.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.24</td>
<td id="Sx4.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">72.46</td>
<td id="Sx4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t">73.40</td>
</tr>
<tr id="Sx4.T1.1.5.5" class="ltx_tr">
<th id="Sx4.T1.1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">VILLA</th>
<td id="Sx4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">73.59</td>
<td id="Sx4.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.69</td>
<td id="Sx4.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">73.67</td>
<td id="Sx4.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t">74.87</td>
</tr>
<tr id="Sx4.T1.1.6.6" class="ltx_tr">
<th id="Sx4.T1.1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">ERNIE-VIL</th>
<td id="Sx4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">72.62</td>
<td id="Sx4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.75</td>
<td id="Sx4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">72.85</td>
<td id="Sx4.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">74.93</td>
</tr>
<tr id="Sx4.T1.1.7.7" class="ltx_tr">
<th id="Sx4.T1.1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Oscar</th>
<td id="Sx4.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t">73.16</td>
<td id="Sx4.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.61</td>
<td id="Sx4.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t">73.44</td>
<td id="Sx4.T1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t">73.82</td>
</tr>
<tr id="Sx4.T1.1.8.8" class="ltx_tr">
<th id="Sx4.T1.1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">VinVL</th>
<td id="Sx4.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t">74.78</td>
<td id="Sx4.T1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.04</td>
<td id="Sx4.T1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_t">74.87</td>
<td id="Sx4.T1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_t">76.06</td>
</tr>
<tr id="Sx4.T1.1.9.9" class="ltx_tr">
<th id="Sx4.T1.1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">TDR (ours)</th>
<td id="Sx4.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="Sx4.T1.1.9.9.2.1" class="ltx_text ltx_font_bold">75.56</span></td>
<td id="Sx4.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="Sx4.T1.1.9.9.3.1" class="ltx_text ltx_font_bold">76.73</span></td>
<td id="Sx4.T1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="Sx4.T1.1.9.9.4.1" class="ltx_text ltx_font_bold">75.63</span></td>
<td id="Sx4.T1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="Sx4.T1.1.9.9.5.1" class="ltx_text ltx_font_bold">76.87</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparison on the VQA v2.0 dataset. (“Base” and “Large” indicate models of BERT-base and BERT-large size.)</figcaption>
</figure>
<figure id="Sx4.T2" class="ltx_table">
<table id="Sx4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T2.1.1.1" class="ltx_tr">
<td id="Sx4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="Sx4.T2.1.1.1.1.1" class="ltx_text">Method</span></td>
<td id="Sx4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">OCR</td>
<td id="Sx4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dual</td>
<td id="Sx4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Yes/No</td>
<td id="Sx4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Number</td>
<td id="Sx4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Other</td>
<td id="Sx4.T2.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t" colspan="2">All</td>
</tr>
<tr id="Sx4.T2.1.2.2" class="ltx_tr">
<td id="Sx4.T2.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r">Feature</td>
<td id="Sx4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r">Routing</td>
<td id="Sx4.T2.1.2.2.3" class="ltx_td ltx_align_center">Dev</td>
<td id="Sx4.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r">Std</td>
<td id="Sx4.T2.1.2.2.5" class="ltx_td ltx_align_center">Dev</td>
<td id="Sx4.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r">Std</td>
<td id="Sx4.T2.1.2.2.7" class="ltx_td ltx_align_center">Dev</td>
<td id="Sx4.T2.1.2.2.8" class="ltx_td ltx_align_center ltx_border_r">Std</td>
<td id="Sx4.T2.1.2.2.9" class="ltx_td ltx_align_center">Dev</td>
<td id="Sx4.T2.1.2.2.10" class="ltx_td ltx_align_center">Std</td>
</tr>
<tr id="Sx4.T2.1.3.3" class="ltx_tr">
<td id="Sx4.T2.1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">VinVL</td>
<td id="Sx4.T2.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">—</td>
<td id="Sx4.T2.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">—</td>
<td id="Sx4.T2.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">90.62</td>
<td id="Sx4.T2.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.73</td>
<td id="Sx4.T2.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">56.28</td>
<td id="Sx4.T2.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.63</td>
<td id="Sx4.T2.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">65.45</td>
<td id="Sx4.T2.1.3.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.47</td>
<td id="Sx4.T2.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t">74.78</td>
<td id="Sx4.T2.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">74.87</td>
</tr>
<tr id="Sx4.T2.1.4.4" class="ltx_tr">
<td id="Sx4.T2.1.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" rowspan="2"><span id="Sx4.T2.1.4.4.1.1" class="ltx_text">TDR</span></td>
<td id="Sx4.T2.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</td>
<td id="Sx4.T2.1.4.4.3" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="Sx4.T2.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T2.1.4.4.4.1" class="ltx_text ltx_font_bold">90.92</span></td>
<td id="Sx4.T2.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.84</td>
<td id="Sx4.T2.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t">57.58</td>
<td id="Sx4.T2.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.57</td>
<td id="Sx4.T2.1.4.4.8" class="ltx_td ltx_align_center ltx_border_t">65.44</td>
<td id="Sx4.T2.1.4.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.69</td>
<td id="Sx4.T2.1.4.4.10" class="ltx_td ltx_align_center ltx_border_t">75.04</td>
<td id="Sx4.T2.1.4.4.11" class="ltx_td ltx_align_center ltx_border_t">75.23</td>
</tr>
<tr id="Sx4.T2.1.5.5" class="ltx_tr">
<td id="Sx4.T2.1.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</td>
<td id="Sx4.T2.1.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</td>
<td id="Sx4.T2.1.5.5.3" class="ltx_td ltx_align_center ltx_border_b">90.64</td>
<td id="Sx4.T2.1.5.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="Sx4.T2.1.5.5.4.1" class="ltx_text ltx_font_bold">90.92</span></td>
<td id="Sx4.T2.1.5.5.5" class="ltx_td ltx_align_center ltx_border_b"><span id="Sx4.T2.1.5.5.5.1" class="ltx_text ltx_font_bold">60.37</span></td>
<td id="Sx4.T2.1.5.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="Sx4.T2.1.5.5.6.1" class="ltx_text ltx_font_bold">59.29</span></td>
<td id="Sx4.T2.1.5.5.7" class="ltx_td ltx_align_center ltx_border_b"><span id="Sx4.T2.1.5.5.7.1" class="ltx_text ltx_font_bold">66.11</span></td>
<td id="Sx4.T2.1.5.5.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="Sx4.T2.1.5.5.8.1" class="ltx_text ltx_font_bold">66.06</span></td>
<td id="Sx4.T2.1.5.5.9" class="ltx_td ltx_align_center ltx_border_b"><span id="Sx4.T2.1.5.5.9.1" class="ltx_text ltx_font_bold">75.56</span></td>
<td id="Sx4.T2.1.5.5.10" class="ltx_td ltx_align_center ltx_border_b"><span id="Sx4.T2.1.5.5.10.1" class="ltx_text ltx_font_bold">75.63</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance on different answer-type instances of the VQA v2.0 dataset. (Test-dev is denoted by “Dev” and Test-std is denoted by “Std”.)</figcaption>
</figure>
</section>
<section id="Sx4.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Effect of OCR Feature</h3>

<div id="Sx4.SSx5.p1" class="ltx_para">
<p id="Sx4.SSx5.p1.1" class="ltx_p">To investigate the effect of the OCR feature, we conduct an ablation experiment with models of the BERT-base size in Table <a href="#Sx4.T2" title="Table 2 ‣ Comparison with State-of-The-Art Methods ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Unlike VinVL, the restricted version of our TDR model (line 2) incorporates OCR features in the visual representation. In the answer prediction phase, both models use the classifier to predict an entire answer in one step. Comparing line 2 to 1, OCR features lead to an overall improvement, particularly in the “number” answer type known to be difficult for VQA models <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>. We especially uplift the performance of text-reading instances (<em id="Sx4.SSx5.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, “What number is … ?”, “What is … ?”), demonstrating the validity of incorporating OCR features as supplement information.</p>
</div>
</section>
<section id="Sx4.SSx6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Effect of Dual Routing Prediction Module</h3>

<div id="Sx4.SSx6.p1" class="ltx_para">
<p id="Sx4.SSx6.p1.1" class="ltx_p">As shown in Table <a href="#Sx4.T2" title="Table 2 ‣ Comparison with State-of-The-Art Methods ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we train our full TDR model with a dual routing prediction module (line 3), which gives another 2% improvement on “number” answer-type instances compared to its counterpart using a classifier for answer prediction (line 2). When compared to VinVL, our full TDR model achieves around 4% improvement (line 3 VS line 1) on this answer type.</p>
</div>
<div id="Sx4.SSx6.p2" class="ltx_para">
<p id="Sx4.SSx6.p2.1" class="ltx_p">The dual routing prediction module incorporates a two-branch answer prediction network (<em id="Sx4.SSx6.p2.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, a classifier and a dynamic pointer network) and a gating network. To intuitively show the effect of the two-branch learning scheme on tackling text-reading and general cases, we evaluate our TDR and VinVL on different answer-source instances in Table <a href="#Sx4.T3" title="Table 3 ‣ Effect of Dual Routing Prediction Module ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Specifically, we divide the validation set into two categories based on the answer source, <em id="Sx4.SSx6.p2.1.2" class="ltx_emph ltx_font_italic">i.e.</em>, the final answer is either from the OCR tokens or from the candidate set, and then calculate the average score using Eq. (<a href="#Sx4.E9" title="In Evaluation Metric ‣ Experiments ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>). Compared with VinVL, our model can generate much more accurate OCR sequence answers in text-reading cases, improving the performance by a significant margin (&gt;30%), while ensuring the accuracy of selecting an answer from the candidate set.</p>
</div>
<figure id="Sx4.T3" class="ltx_table">
<table id="Sx4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T3.1.1.1" class="ltx_tr">
<th id="Sx4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Answer Source</th>
<th id="Sx4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">OCR Token</th>
<th id="Sx4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Candidate Set</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T3.1.2.1" class="ltx_tr">
<td id="Sx4.T3.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">VinVL</td>
<td id="Sx4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.08</td>
<td id="Sx4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">76.28</td>
</tr>
<tr id="Sx4.T3.1.3.2" class="ltx_tr">
<td id="Sx4.T3.1.3.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">TDR (ours)</td>
<td id="Sx4.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">58.23</td>
<td id="Sx4.T3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">75.69</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance on different answer-source instances of the VQA v2.0 dataset.</figcaption>
</figure>
<div id="Sx4.SSx6.p3" class="ltx_para">
<p id="Sx4.SSx6.p3.1" class="ltx_p">Essentially, the gating network performs a binary classification task to finally determine the final answer from the two branches mentioned above. To assess the performance of the gating network, we use commonly used classification task metrics, <em id="Sx4.SSx6.p3.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, accuracy and F1-score. A high value of these metrics indicates good performance. As a result, we get 98.7% accuracy and an F1-score of 0.81.</p>
</div>
</section>
<section id="Sx4.SSx7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Qualitative Analysis</h3>

<div id="Sx4.SSx7.p1" class="ltx_para">
<p id="Sx4.SSx7.p1.1" class="ltx_p">The major failure cases of existing methods in the VQA v2.0 dataset involve text reading and answering. As shown in Figure <a href="#Sx3.F3" title="Figure 3 ‣ Gating Network ‣ Dual Routing Prediction Module ‣ Method ‣ Text-Aware Dual Routing Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the SoTA VinVL degrades when accounting questions such as “What number is … ?” and “What is … ?”. Under these difficult conditions, our TDR model can still correctly identify and reorganize OCR tokens in the image to generate a complete answer sequence, proving the advancement of our proposed method.</p>
</div>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">In this paper, we propose a Text-Aware Dual Routing Network (TDR) for the VQA task. We enrich the visual representations with abundant region features and OCR features to provide a comprehensive visual-linguistic view of the input image. Thus, the model can utilize text information as supplementary knowledge for reasoning. Furthermore, we propose a dual routing prediction module incorporating a two-branch answer prediction network and a gating network to improve the flexibility of answer prediction. In this way, we can simultaneously handle the VQA cases with and without understanding text information in the input images. We not only improve the diversity and the accuracy of the generated answers but also inspire a new way of thinking about achieving human intelligence. Extensive experiments on the VQA v2.0 dataset demonstrate the superiority of our method over the considered baseline methods. We significantly improve the performance on the “number” related questions known to be difficult for existing VQA models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazán et al. (2014)</span>
<span class="ltx_bibblock">
Almazán, J.; Gordo, A.; Fornés, A.; and Valveny, E. 2014.

</span>
<span class="ltx_bibblock">Word spotting and recognition with embedded attributes.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on pattern analysis and machine
intelligence</em>, 36(12): 2552–2566.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2018)</span>
<span class="ltx_bibblock">
Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and
Zhang, L. 2018.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 6077–6086.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol et al. (2015)</span>
<span class="ltx_bibblock">
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Zitnick, C. L.; and
Parikh, D. 2015.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, 2425–2433.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bojanowski et al. (2017)</span>
<span class="ltx_bibblock">
Bojanowski, P.; Grave, E.; Joulin, A.; and Mikolov, T. 2017.

</span>
<span class="ltx_bibblock">Enriching word vectors with subword information.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Transactions of the association for computational linguistics</em>,
5.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borisyuk, Gordo, and Sivakumar (2018)</span>
<span class="ltx_bibblock">
Borisyuk, F.; Gordo, A.; and Sivakumar, V. 2018.

</span>
<span class="ltx_bibblock">Rosetta: Large scale system for text detection and recognition in
images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th ACM SIGKDD international conference
on knowledge discovery &amp; data mining</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Chen, Y.-C.; Li, L.; Yu, L.; El Kholy, A.; Ahmed, F.; Gan, Z.; Cheng, Y.; and
Liu, J. 2019.

</span>
<span class="ltx_bibblock">Uniter: Learning universal image-text representations.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai and Callan (2019)</span>
<span class="ltx_bibblock">
Dai, Z.; and Callan, J. 2019.

</span>
<span class="ltx_bibblock">Deeper text understanding for IR with contextual neural language
modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 42nd International ACM SIGIR Conference
on Research and Development in Information Retrieval</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gan et al. (2020)</span>
<span class="ltx_bibblock">
Gan, Z.; Chen, Y.-C.; Li, L.; Zhu, C.; Cheng, Y.; and Liu, J. 2020.

</span>
<span class="ltx_bibblock">Large-scale adversarial training for vision-and-language
representation learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
6616–6628.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al. (2020)</span>
<span class="ltx_bibblock">
Goodfellow, I.; Pouget-Abadie, J.; Mirza, M.; Xu, B.; Warde-Farley, D.; Ozair,
S.; Courville, A.; and Bengio, Y. 2020.

</span>
<span class="ltx_bibblock">Generative adversarial networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 63(11): 139–144.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Goyal, Y.; Khot, T.; Summers-Stay, D.; Batra, D.; and Parikh, D. 2017.

</span>
<span class="ltx_bibblock">Making the v in vqa matter: Elevating the role of image understanding
in visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 6904–6913.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2016)</span>
<span class="ltx_bibblock">
Gu, J.; Lu, Z.; Li, H.; and Li, V. O. 2016.

</span>
<span class="ltx_bibblock">Incorporating copying mechanism in sequence-to-sequence learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1603.06393</em>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2020a)</span>
<span class="ltx_bibblock">
Guo, Y.; Chen, J.; Wang, J.; Chen, Q.; Cao, J.; Deng, Z.; Xu, Y.; and Tan, M.
2020a.

</span>
<span class="ltx_bibblock">Closed-loop matters: Dual regression networks for single image
super-resolution.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF conference on computer vision and pattern
recognition</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2020b)</span>
<span class="ltx_bibblock">
Guo, Y.; Chen, Y.; Zheng, Y.; Zhao, P.; Chen, J.; Huang, J.; and Tan, M.
2020b.

</span>
<span class="ltx_bibblock">Breaking the curse of space explosion: Towards efficient nas with
curriculum search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>. PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo, Stutz, and Schiele (2022)</span>
<span class="ltx_bibblock">
Guo, Y.; Stutz, D.; and Schiele, B. 2022.

</span>
<span class="ltx_bibblock">Improving robustness by enhancing weak subnets.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>. Springer.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Guo, Y.; Wang, J.; Chen, Q.; Cao, J.; Deng, Z.; Xu, Y.; Chen, J.; and Tan, M.
2022.

</span>
<span class="ltx_bibblock">Towards lightweight super-resolution with dual regression learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.07929</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2019)</span>
<span class="ltx_bibblock">
Guo, Y.; Zheng, Y.; Tan, M.; Chen, Q.; Chen, J.; Zhao, P.; and Huang, J. 2019.

</span>
<span class="ltx_bibblock">Nat: Neural architecture transformer for accurate and compact
architectures.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han, Huang, and Han (2020)</span>
<span class="ltx_bibblock">
Han, W.; Huang, H.; and Han, T. 2020.

</span>
<span class="ltx_bibblock">Finding the evidence: Localization-aware answer prediction for text
visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.02582</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021)</span>
<span class="ltx_bibblock">
Han, Y.; Huang, G.; Song, S.; Yang, L.; Wang, H.; and Wang, Y. 2021.

</span>
<span class="ltx_bibblock">Dynamic neural networks: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine
Intelligence</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2019)</span>
<span class="ltx_bibblock">
Hong, J.; Fu, J.; Uh, Y.; Mei, T.; and Byun, H. 2019.

</span>
<span class="ltx_bibblock">Exploiting hierarchical visual features for visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, 351: 187–195.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu and Singh (2021)</span>
<span class="ltx_bibblock">
Hu, R.; and Singh, A. 2021.

</span>
<span class="ltx_bibblock">Unit: Multimodal multitask learning with a unified transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2020)</span>
<span class="ltx_bibblock">
Hu, R.; Singh, A.; Darrell, T.; and Rohrbach, M. 2020.

</span>
<span class="ltx_bibblock">Iterative answer prediction with pointer-augmented multimodal
transformers for textvqa.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kenton and Toutanova (2019)</span>
<span class="ltx_bibblock">
Kenton, J. D. M.-W. C.; and Toutanova, L. K. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language
Understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of NAACL-HLT</em>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, X.; Yin, X.; Li, C.; Zhang, P.; Hu, X.; Zhang, L.; Wang, L.; Hu, H.; Dong,
L.; Wei, F.; et al. 2020.

</span>
<span class="ltx_bibblock">Oscar: Object-semantics aligned pre-training for vision-language
tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>. Springer.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lioutas, Passalis, and Tefas (2018)</span>
<span class="ltx_bibblock">
Lioutas, V.; Passalis, N.; and Tefas, A. 2018.

</span>
<span class="ltx_bibblock">Explicit ensemble attention learning for improving visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition Letters</em>, 111: 51–57.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2019)</span>
<span class="ltx_bibblock">
Lu, J.; Batra, D.; Parikh, D.; and Lee, S. 2019.

</span>
<span class="ltx_bibblock">Vilbert: Pretraining task-agnostic visiolinguistic representations
for vision-and-language tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2018)</span>
<span class="ltx_bibblock">
Lu, J.; Yang, J.; Batra, D.; and Parikh, D. 2018.

</span>
<span class="ltx_bibblock">Neural baby talk.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 7219–7228.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2018)</span>
<span class="ltx_bibblock">
Ma, C.; Shen, C.; Dick, A.; Wu, Q.; Wang, P.; van den Hengel, A.; and Reid, I.
2018.

</span>
<span class="ltx_bibblock">Visual question answering with memory-augmented networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE conference on computer vision and pattern recognition</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nallapati et al. (2016)</span>
<span class="ltx_bibblock">
Nallapati, R.; Zhou, B.; Gulcehre, C.; Xiang, B.; et al. 2016.

</span>
<span class="ltx_bibblock">Abstractive text summarization using sequence-to-sequence rnns and
beyond.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1602.06023</em>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patro et al. (2020)</span>
<span class="ltx_bibblock">
Patro, B.; Kurmi, V.; Kumar, S.; and Namboodiri, V. 2020.

</span>
<span class="ltx_bibblock">Deep bayesian network for visual question generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Winter Conference on
Applications of Computer Vision</em>, 1566–1576.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2015)</span>
<span class="ltx_bibblock">
Ren, S.; He, K.; Girshick, R.; and Sun, J. 2015.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection with region proposal
networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et al. (2017)</span>
<span class="ltx_bibblock">
Shazeer, N.; Mirhoseini, A.; Maziarz, K.; Davis, A.; Le, Q.; Hinton, G.; and
Dean, J. 2017.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated
mixture-of-experts layer.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1701.06538</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al. (2019)</span>
<span class="ltx_bibblock">
Singh, A.; Natarajan, V.; Shah, M.; Jiang, Y.; Chen, X.; Batra, D.; Parikh, D.;
and Rohrbach, M. 2019.

</span>
<span class="ltx_bibblock">Towards vqa models that can read.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan and Bansal (2019)</span>
<span class="ltx_bibblock">
Tan, H.; and Bansal, M. 2019.

</span>
<span class="ltx_bibblock">LXMERT: Learning Cross-Modality Encoder Representations from
Transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing and the 9th International Joint Conference on
Natural Language Processing</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.;
Kaiser, Ł.; and Polosukhin, I. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vinyals, Fortunato, and Jaitly (2015)</span>
<span class="ltx_bibblock">
Vinyals, O.; Fortunato, M.; and Jaitly, N. 2015.

</span>
<span class="ltx_bibblock">Pointer networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, W.; Bao, H.; Dong, L.; and Wei, F. 2021.

</span>
<span class="ltx_bibblock">VLMo: Unified Vision-Language Pre-Training with
Mixture-of-Modality-Experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.02358</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2017)</span>
<span class="ltx_bibblock">
Yu, D.; Fu, J.; Mei, T.; and Rui, Y. 2017.

</span>
<span class="ltx_bibblock">Multi-level attention networks for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">IEEE conference on computer vision and pattern recognition</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021)</span>
<span class="ltx_bibblock">
Yu, F.; Tang, J.; Yin, W.; Sun, Y.; Tian, H.; Wu, H.; and Wang, H. 2021.

</span>
<span class="ltx_bibblock">Ernie-vil: Knowledge enhanced vision-language representations through
scene graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, 4.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhang, P.; Li, X.; Hu, X.; Yang, J.; Zhang, L.; Wang, L.; Choi, Y.; and Gao, J.
2021.

</span>
<span class="ltx_bibblock">Vinvl: Revisiting visual representations in vision-language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern
Recognition</em>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2020)</span>
<span class="ltx_bibblock">
Zhu, Q.; Gao, C.; Wang, P.; and Wu, Q. 2020.

</span>
<span class="ltx_bibblock">Simple is not easy: A simple strong baseline for textvqa and
textcaps.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.05153</em>, 2.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2211.14449" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2211.14450" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2211.14450">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2211.14450" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2211.14451" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 05:01:56 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
