<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios</title>
<!--Generated on Sun Oct 13 09:57:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Interactive matting Multi-modal learning SMPMat dataset" lang="en" name="keywords"/>
<base href="/html/2410.09788v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S1" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S2" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title">Interactive Image matting.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title">Matting datasets.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.SS1" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.SS2" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Interactive Semantic Capture Network (ISCN)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.SS3" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Matting Refinement Network (MRN)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>The SMPMat Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS1" title="In 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS2" title="In 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Dataset and Evaluation Protocol</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS3" title="In 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Comparison with the state-of-the-art methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS4" title="In 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Quantitative analysis on data synthesis method</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS5" title="In 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Ablation studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S6" title="In DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Limitations</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span>
</p>
</div>
<span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>
School of AIA, Huazhong University of Science and Technology
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{m202173030,m202173066}@alumni.hust.edu.cn</span></span></span>,
<span class="ltx_note ltx_role_email" id="id1.2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{cgao,nsang}@hust.edu.cn</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Siyi Jiao<sup class="ltx_sup" id="id6.2.id1">*</sup> <math alttext="{}^{~{}\orcidlink{0009-0005-6114-1020}}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mrow id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml"><mrow id="id1.1.m1.1.1.1.2" xref="id1.1.m1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="id1.1.m1.1.1.1.2.2" xref="id1.1.m1.1.1.1.2.2b.cmml"><mtext id="id1.1.m1.1.1.1.2.2a" xref="id1.1.m1.1.1.1.2.2b.cmml">\orcidlink</mtext></merror><mo id="id1.1.m1.1.1.1.2.1" xref="id1.1.m1.1.1.1.2.1.cmml">⁢</mo><mn id="id1.1.m1.1.1.1.2.3" xref="id1.1.m1.1.1.1.2.3.cmml">0009</mn></mrow><mo id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">−</mo><mn id="id1.1.m1.1.1.1.3" xref="id1.1.m1.1.1.1.3.cmml">0005</mn><mo id="id1.1.m1.1.1.1.1a" xref="id1.1.m1.1.1.1.1.cmml">−</mo><mn id="id1.1.m1.1.1.1.4" xref="id1.1.m1.1.1.1.4.cmml">6114</mn><mo id="id1.1.m1.1.1.1.1b" xref="id1.1.m1.1.1.1.1.cmml">−</mo><mn id="id1.1.m1.1.1.1.5" xref="id1.1.m1.1.1.1.5.cmml">1020</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><apply id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1"><minus id="id1.1.m1.1.1.1.1.cmml" xref="id1.1.m1.1.1.1.1"></minus><apply id="id1.1.m1.1.1.1.2.cmml" xref="id1.1.m1.1.1.1.2"><times id="id1.1.m1.1.1.1.2.1.cmml" xref="id1.1.m1.1.1.1.2.1"></times><ci id="id1.1.m1.1.1.1.2.2b.cmml" xref="id1.1.m1.1.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="id1.1.m1.1.1.1.2.2.cmml" xref="id1.1.m1.1.1.1.2.2"><mtext id="id1.1.m1.1.1.1.2.2a.cmml" xref="id1.1.m1.1.1.1.2.2">\orcidlink</mtext></merror></ci><cn id="id1.1.m1.1.1.1.2.3.cmml" type="integer" xref="id1.1.m1.1.1.1.2.3">0009</cn></apply><cn id="id1.1.m1.1.1.1.3.cmml" type="integer" xref="id1.1.m1.1.1.1.3">0005</cn><cn id="id1.1.m1.1.1.1.4.cmml" type="integer" xref="id1.1.m1.1.1.1.4">6114</cn><cn id="id1.1.m1.1.1.1.5.cmml" type="integer" xref="id1.1.m1.1.1.1.5">1020</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{~{}\orcidlink{0009-0005-6114-1020}}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT 0009 - 0005 - 6114 - 1020 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenzheng Zeng<sup class="ltx_sup" id="id7.2.id1">*</sup> <math alttext="{}^{~{}\orcidlink{0000-0001-8467-5862}}" class="ltx_Math" display="inline" id="id2.1.m1.1"><semantics id="id2.1.m1.1a"><msup id="id2.1.m1.1.1" xref="id2.1.m1.1.1.cmml"><mi id="id2.1.m1.1.1a" xref="id2.1.m1.1.1.cmml"></mi><mrow id="id2.1.m1.1.1.1" xref="id2.1.m1.1.1.1.cmml"><mrow id="id2.1.m1.1.1.1.2" xref="id2.1.m1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="id2.1.m1.1.1.1.2.2" xref="id2.1.m1.1.1.1.2.2b.cmml"><mtext id="id2.1.m1.1.1.1.2.2a" xref="id2.1.m1.1.1.1.2.2b.cmml">\orcidlink</mtext></merror><mo id="id2.1.m1.1.1.1.2.1" xref="id2.1.m1.1.1.1.2.1.cmml">⁢</mo><mn id="id2.1.m1.1.1.1.2.3" xref="id2.1.m1.1.1.1.2.3.cmml">0000</mn></mrow><mo id="id2.1.m1.1.1.1.1" xref="id2.1.m1.1.1.1.1.cmml">−</mo><mn id="id2.1.m1.1.1.1.3" xref="id2.1.m1.1.1.1.3.cmml">0001</mn><mo id="id2.1.m1.1.1.1.1a" xref="id2.1.m1.1.1.1.1.cmml">−</mo><mn id="id2.1.m1.1.1.1.4" xref="id2.1.m1.1.1.1.4.cmml">8467</mn><mo id="id2.1.m1.1.1.1.1b" xref="id2.1.m1.1.1.1.1.cmml">−</mo><mn id="id2.1.m1.1.1.1.5" xref="id2.1.m1.1.1.1.5.cmml">5862</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.1.m1.1b"><apply id="id2.1.m1.1.1.cmml" xref="id2.1.m1.1.1"><apply id="id2.1.m1.1.1.1.cmml" xref="id2.1.m1.1.1.1"><minus id="id2.1.m1.1.1.1.1.cmml" xref="id2.1.m1.1.1.1.1"></minus><apply id="id2.1.m1.1.1.1.2.cmml" xref="id2.1.m1.1.1.1.2"><times id="id2.1.m1.1.1.1.2.1.cmml" xref="id2.1.m1.1.1.1.2.1"></times><ci id="id2.1.m1.1.1.1.2.2b.cmml" xref="id2.1.m1.1.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="id2.1.m1.1.1.1.2.2.cmml" xref="id2.1.m1.1.1.1.2.2"><mtext id="id2.1.m1.1.1.1.2.2a.cmml" xref="id2.1.m1.1.1.1.2.2">\orcidlink</mtext></merror></ci><cn id="id2.1.m1.1.1.1.2.3.cmml" type="integer" xref="id2.1.m1.1.1.1.2.3">0000</cn></apply><cn id="id2.1.m1.1.1.1.3.cmml" type="integer" xref="id2.1.m1.1.1.1.3">0001</cn><cn id="id2.1.m1.1.1.1.4.cmml" type="integer" xref="id2.1.m1.1.1.1.4">8467</cn><cn id="id2.1.m1.1.1.1.5.cmml" type="integer" xref="id2.1.m1.1.1.1.5">5862</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.1.m1.1c">{}^{~{}\orcidlink{0000-0001-8467-5862}}</annotation><annotation encoding="application/x-llamapun" id="id2.1.m1.1d">start_FLOATSUPERSCRIPT 0000 - 0001 - 8467 - 5862 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Changxin Gao <math alttext="{}^{~{}\orcidlink{0000-0003-2736-3920}}" class="ltx_Math" display="inline" id="id3.1.m1.1"><semantics id="id3.1.m1.1a"><msup id="id3.1.m1.1.1" xref="id3.1.m1.1.1.cmml"><mi id="id3.1.m1.1.1a" xref="id3.1.m1.1.1.cmml"></mi><mrow id="id3.1.m1.1.1.1" xref="id3.1.m1.1.1.1.cmml"><mrow id="id3.1.m1.1.1.1.2" xref="id3.1.m1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="id3.1.m1.1.1.1.2.2" xref="id3.1.m1.1.1.1.2.2b.cmml"><mtext id="id3.1.m1.1.1.1.2.2a" xref="id3.1.m1.1.1.1.2.2b.cmml">\orcidlink</mtext></merror><mo id="id3.1.m1.1.1.1.2.1" xref="id3.1.m1.1.1.1.2.1.cmml">⁢</mo><mn id="id3.1.m1.1.1.1.2.3" xref="id3.1.m1.1.1.1.2.3.cmml">0000</mn></mrow><mo id="id3.1.m1.1.1.1.1" xref="id3.1.m1.1.1.1.1.cmml">−</mo><mn id="id3.1.m1.1.1.1.3" xref="id3.1.m1.1.1.1.3.cmml">0003</mn><mo id="id3.1.m1.1.1.1.1a" xref="id3.1.m1.1.1.1.1.cmml">−</mo><mn id="id3.1.m1.1.1.1.4" xref="id3.1.m1.1.1.1.4.cmml">2736</mn><mo id="id3.1.m1.1.1.1.1b" xref="id3.1.m1.1.1.1.1.cmml">−</mo><mn id="id3.1.m1.1.1.1.5" xref="id3.1.m1.1.1.1.5.cmml">3920</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.1.m1.1b"><apply id="id3.1.m1.1.1.cmml" xref="id3.1.m1.1.1"><apply id="id3.1.m1.1.1.1.cmml" xref="id3.1.m1.1.1.1"><minus id="id3.1.m1.1.1.1.1.cmml" xref="id3.1.m1.1.1.1.1"></minus><apply id="id3.1.m1.1.1.1.2.cmml" xref="id3.1.m1.1.1.1.2"><times id="id3.1.m1.1.1.1.2.1.cmml" xref="id3.1.m1.1.1.1.2.1"></times><ci id="id3.1.m1.1.1.1.2.2b.cmml" xref="id3.1.m1.1.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="id3.1.m1.1.1.1.2.2.cmml" xref="id3.1.m1.1.1.1.2.2"><mtext id="id3.1.m1.1.1.1.2.2a.cmml" xref="id3.1.m1.1.1.1.2.2">\orcidlink</mtext></merror></ci><cn id="id3.1.m1.1.1.1.2.3.cmml" type="integer" xref="id3.1.m1.1.1.1.2.3">0000</cn></apply><cn id="id3.1.m1.1.1.1.3.cmml" type="integer" xref="id3.1.m1.1.1.1.3">0003</cn><cn id="id3.1.m1.1.1.1.4.cmml" type="integer" xref="id3.1.m1.1.1.1.4">2736</cn><cn id="id3.1.m1.1.1.1.5.cmml" type="integer" xref="id3.1.m1.1.1.1.5">3920</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.1c">{}^{~{}\orcidlink{0000-0003-2736-3920}}</annotation><annotation encoding="application/x-llamapun" id="id3.1.m1.1d">start_FLOATSUPERSCRIPT 0000 - 0003 - 2736 - 3920 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nong Sang<sup class="ltx_sup" id="id4.1.1"><sup class="ltx_sup" id="id4.1.1.1"><span class="ltx_text ltx_font_italic" id="id4.1.1.1.1">†</span></sup></sup> <math alttext="{}^{~{}\orcidlink{0000-0002-9167-1496}}" class="ltx_Math" display="inline" id="id5.2.m1.1"><semantics id="id5.2.m1.1a"><msup id="id5.2.m1.1.1" xref="id5.2.m1.1.1.cmml"><mi id="id5.2.m1.1.1a" xref="id5.2.m1.1.1.cmml"></mi><mrow id="id5.2.m1.1.1.1" xref="id5.2.m1.1.1.1.cmml"><mrow id="id5.2.m1.1.1.1.2" xref="id5.2.m1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="id5.2.m1.1.1.1.2.2" xref="id5.2.m1.1.1.1.2.2b.cmml"><mtext id="id5.2.m1.1.1.1.2.2a" xref="id5.2.m1.1.1.1.2.2b.cmml">\orcidlink</mtext></merror><mo id="id5.2.m1.1.1.1.2.1" xref="id5.2.m1.1.1.1.2.1.cmml">⁢</mo><mn id="id5.2.m1.1.1.1.2.3" xref="id5.2.m1.1.1.1.2.3.cmml">0000</mn></mrow><mo id="id5.2.m1.1.1.1.1" xref="id5.2.m1.1.1.1.1.cmml">−</mo><mn id="id5.2.m1.1.1.1.3" xref="id5.2.m1.1.1.1.3.cmml">0002</mn><mo id="id5.2.m1.1.1.1.1a" xref="id5.2.m1.1.1.1.1.cmml">−</mo><mn id="id5.2.m1.1.1.1.4" xref="id5.2.m1.1.1.1.4.cmml">9167</mn><mo id="id5.2.m1.1.1.1.1b" xref="id5.2.m1.1.1.1.1.cmml">−</mo><mn id="id5.2.m1.1.1.1.5" xref="id5.2.m1.1.1.1.5.cmml">1496</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id5.2.m1.1b"><apply id="id5.2.m1.1.1.cmml" xref="id5.2.m1.1.1"><apply id="id5.2.m1.1.1.1.cmml" xref="id5.2.m1.1.1.1"><minus id="id5.2.m1.1.1.1.1.cmml" xref="id5.2.m1.1.1.1.1"></minus><apply id="id5.2.m1.1.1.1.2.cmml" xref="id5.2.m1.1.1.1.2"><times id="id5.2.m1.1.1.1.2.1.cmml" xref="id5.2.m1.1.1.1.2.1"></times><ci id="id5.2.m1.1.1.1.2.2b.cmml" xref="id5.2.m1.1.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="id5.2.m1.1.1.1.2.2.cmml" xref="id5.2.m1.1.1.1.2.2"><mtext id="id5.2.m1.1.1.1.2.2a.cmml" xref="id5.2.m1.1.1.1.2.2">\orcidlink</mtext></merror></ci><cn id="id5.2.m1.1.1.1.2.3.cmml" type="integer" xref="id5.2.m1.1.1.1.2.3">0000</cn></apply><cn id="id5.2.m1.1.1.1.3.cmml" type="integer" xref="id5.2.m1.1.1.1.3">0002</cn><cn id="id5.2.m1.1.1.1.4.cmml" type="integer" xref="id5.2.m1.1.1.1.4">9167</cn><cn id="id5.2.m1.1.1.1.5.cmml" type="integer" xref="id5.2.m1.1.1.1.5">1496</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.2.m1.1c">{}^{~{}\orcidlink{0000-0002-9167-1496}}</annotation><annotation encoding="application/x-llamapun" id="id5.2.m1.1d">start_FLOATSUPERSCRIPT 0000 - 0002 - 9167 - 1496 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">Interactive portrait matting refers to extracting the soft portrait from a given image that best meets the user’s intent through their inputs.
Existing methods often underperform in complex scenarios, mainly due to three factors. (1) Most works apply a tightly coupled network that directly predicts matting results, lacking interpretability and resulting in inadequate modeling. (2) Existing works are limited to a single type of user input, which is ineffective for intention understanding and also inefficient for user operation. (3) The multi-round characteristics have been under-explored, which is crucial for user interaction. To alleviate these limitations, we propose DFIMat, a decoupled framework that enables flexible interactive matting. Specifically, we first decouple the task into 2 sub-ones: localizing target instances by understanding scene semantics and the flexible user inputs, and conducting refinement for instance-level matting. We observe a clear performance gain from decoupling, as it makes sub-tasks easier to learn, and the flexible multi-type input further enhances both effectiveness and efficiency. DFIMat also considers the multi-round interaction property, where a contrastive reasoning module is designed to enhance cross-round refinement.
Another limitation for multi-person matting task is the lack of training data. We address this by introducing a new synthetic data generation pipeline that can generate much more realistic samples than previous arts. A new large-scale dataset SMPMat is subsequently established. Experiments verify the significant superiority of DFIMat. With it, we also investigate the roles of different input types, providing valuable principles for users. Our code and dataset can be found at <a class="ltx_ref ltx_href" href="https://github.com/JiaoSiyi/DFIMat" style="color:#FF4582;" title="">https://github.com/JiaoSiyi/DFIMat</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Interactive matting Multi-modal learning SMPMat dataset
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">{NoHyper}</span><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><sup class="ltx_sup" id="footnote1.1">*</sup> Equal contribution.
<br class="ltx_break"/>† Corresponding author.</span></span></span>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S1.1.fig1" style="width:273.2pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S1.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S1.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S1.T1.3.2" style="font-size:90%;">Comparison of different methods. DFIMat supports (1) multi-type user inputs, (2) any combination of different types of input at each time, and (3) multi-round iteration.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S1.1.fig1.1" style="width:433.6pt;height:148.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(7.0pt,-2.4pt) scale(1.03332372771808,1.03332372771808) ;">
<table class="ltx_tabular ltx_align_middle" id="S1.1.fig1.1.1">
<tr class="ltx_tr" id="S1.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.1.1" rowspan="2" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.1.1.1">Design</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.1.2" rowspan="2" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.1.2.1">Approach</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S1.1.fig1.1.1.1.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">Supported input type</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.1.4" rowspan="2" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.1.4.1">
<span class="ltx_tabular ltx_align_middle" id="S1.1.fig1.1.1.1.4.1.1">
<span class="ltx_tr" id="S1.1.fig1.1.1.1.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.1.fig1.1.1.1.4.1.1.1.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">Mixed type</span></span>
<span class="ltx_tr" id="S1.1.fig1.1.1.1.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.1.fig1.1.1.1.4.1.1.2.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">of input?</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.1.5" rowspan="2" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.1.5.1">
<span class="ltx_tabular ltx_align_middle" id="S1.1.fig1.1.1.1.5.1.1">
<span class="ltx_tr" id="S1.1.fig1.1.1.1.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.1.fig1.1.1.1.5.1.1.1.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">Multi-</span></span>
<span class="ltx_tr" id="S1.1.fig1.1.1.1.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.1.fig1.1.1.1.5.1.1.2.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">round?</span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.2.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">click</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.2.2" style="padding-top:0.6pt;padding-bottom:0.6pt;">scribble</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.2.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">box</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.2.4" style="padding-top:0.6pt;padding-bottom:0.6pt;">text</td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.3.1" rowspan="4" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.3.1.1">Coupled</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.3.2" style="padding-top:0.6pt;padding-bottom:0.6pt;"> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.3.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_border_t" id="S1.1.fig1.1.1.3.4" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_t" id="S1.1.fig1.1.1.3.5" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.3.6" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.3.7" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_t" id="S1.1.fig1.1.1.3.8" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.1.fig1.1.1.4.1" style="padding-top:0.6pt;padding-bottom:0.6pt;"> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>]</cite>
</td>
<td class="ltx_td" id="S1.1.fig1.1.1.4.2" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_align_center" id="S1.1.fig1.1.1.4.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td" id="S1.1.fig1.1.1.4.4" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r" id="S1.1.fig1.1.1.4.5" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r" id="S1.1.fig1.1.1.4.6" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_align_center" id="S1.1.fig1.1.1.4.7" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.1.fig1.1.1.5.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">FGI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S1.1.fig1.1.1.5.2" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S1.1.fig1.1.1.5.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td" id="S1.1.fig1.1.1.5.4" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r" id="S1.1.fig1.1.1.5.5" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_r" id="S1.1.fig1.1.1.5.6" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td" id="S1.1.fig1.1.1.5.7" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.1.fig1.1.1.6.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">RIM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite>
</td>
<td class="ltx_td" id="S1.1.fig1.1.1.6.2" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td" id="S1.1.fig1.1.1.6.3" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td" id="S1.1.fig1.1.1.6.4" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.1.fig1.1.1.6.5" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_border_r" id="S1.1.fig1.1.1.6.6" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td" id="S1.1.fig1.1.1.6.7" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.7.1" rowspan="2" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span class="ltx_text" id="S1.1.fig1.1.1.7.1.1">Decoupled</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.7.2" style="padding-top:0.6pt;padding-bottom:0.6pt;">MatAny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib37" title="">37</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.7.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.7.4" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.1.fig1.1.1.7.5" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.7.6" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S1.1.fig1.1.1.7.7" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
<td class="ltx_td ltx_border_t" id="S1.1.fig1.1.1.7.8" style="padding-top:0.6pt;padding-bottom:0.6pt;"></td>
</tr>
<tr class="ltx_tr" id="S1.1.fig1.1.1.8">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S1.1.fig1.1.1.8.1" style="padding-top:0.6pt;padding-bottom:0.6pt;">DFIMat (ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S1.1.fig1.1.1.8.2" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S1.1.fig1.1.1.8.3" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S1.1.fig1.1.1.8.4" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S1.1.fig1.1.1.8.5" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S1.1.fig1.1.1.8.6" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S1.1.fig1.1.1.8.7" style="padding-top:0.6pt;padding-bottom:0.6pt;">✓</td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S1.F1" style="width:147.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="749" id="S1.2.1.g1" src="x1.png" width="830"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Performance and complexity comparison.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Interactive portrait matting (IPM) is a crucial computer vision task that aims to extract the fine-grained alpha matte of the specific foreground instance that can best match the users’ intention given from their interactive inputs (e.g., clicks, scribbles, texts). The significance of IPM lies in its wide downstream application values, such as image editing, advertisement production, and video conferencing.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite>, have demonstrated successful performance validation in relatively idealized scenarios (e.g., clear background and single instance without occlusions). However, in real-world scenarios, images often present highly complex backgrounds, with multiple instances and even severe instance occlusions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>. As a result, the existing approach have exhibited poor performance on images that are more representative of real-world scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We argue that there are three crucial reasons that potentially cause the failure of the aforementioned methods in challenging real-world scenarios. Firstly, they generally use a coupled network to directly predict matting results. From a top-down perspective, the task actually consists of multiple steps: we need to localize the targeted instance conditioning on the understanding of both user intention and scene semantics, and then conduct fine-grained matting on the corresponding instance. The coupled design lacks interpretability and makes the network difficult to learn each sub-tasks well especially in complex scenarios.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The second issue is that existing works only consider a single type of user input for the model to understand the user intention, which is inefficient for instance matting task that need both global scene understanding for instance localization and local awareness for fine-grained matting at boundary. Specifically, the bounding box input is a suitable way to quickly localize target instance, but lack of ability to focus on fine-grained boundary details. While click and scribble inputs are good at distinguishing local fine-grained details but inefficient for instance localization. One optimal way is first using a bounding box to localize instance and then applying click and scribble to refine local boundary. Such a multiple-type input will also make the user operation more flexible. Therefore, enabling a universal matting interface that is capable of accommodating various types of human prompts is more preferred.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Thirdly, for practical usage, multiple rounds of interaction are typically necessary to refine the matting result until it is satisfactory. However, most works only support feeding user inputs in one step, ignoring the cross-round information that can be useful clues for refinement.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Based on the aforementioned analysis, we propose DFIMat, a decoupled framework that enables flexible interactive matting. Particularly, we propose to decouple the IPM task into 2 sub-ones: localizing target instances by understanding scene semantics and the flexible user inputs, and conducting refinement for instance-level matting. Following this rule, we subsequently design an interactive semantic capture network (ISCN) and a matting refinement network (MRN) to address these two tasks respectively.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Within ISCN, we propose to enable multi-modal user inputs such as clicks, scribbles, boxes, texts, or any combination of them, resulting in a more concise, flexible, and efficient interaction. This is achieved by encoding various inputs into a unified visual-semantic space, and building strong interactions in the decoder to understand the user intents and predict the target instance mask for instance localization. To meet the practical needs, DFIMat also consider the multi-round interaction property, where we design a contrastive reasoning module to evaluate the consistency between the model prediction and user intention while also explicitly identifying and reasoning the conflict areas during each round’s interaction, providing valuable auxiliary guidance for cross-around refinement.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">For MRN, we build a dual-branch network to effectively capture fine-grained local details with global instance-level consideration. As summarized in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S1" title="1 Introduction ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, our DFIMat distinguishes existing works in: (1) supporting multi-types of user inputs; (2) allowing any combination of different input types (including a single input) at each time; (3) with multi-round iteration ability. Those properties make it more user-friendly and with better effectiveness as verified by experiments.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">Data is another important point for method training and evaluation. The volume of real-image datasets for multi-person matting remains relatively small due to the cost of data collection and annotation. In order to obtain a large amount of matting data that contains multi-instance scenes, previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite> adopt a simple synthesis strategy to iteratively add portrait foregrounds to no-portrait backgrounds. Due to the randomness of the adding positions and the lack of instance-scene prior consideration, there is often a large gap between the synthetic images and natural images, it is more preferred to utilize more realistic and complex images for training and evaluation. To fill this gap, we further design a new synthetic data generation pipeline that can generate much more diverse and realistic samples, and build a new large-scale dataset SPMMat, which consists of 40,000 realistic multi-instance images with high-quality matte GT.</p>
</div>
<div class="ltx_para" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">Our extensive experiments verify the superiority of DFIMat over representative methods. Notably, DFIMat outperforms previous SOTA by 3.48 SAD on the challenging SMPMat dataset with higher efficiency. We also provide a more lightweight version, DFIMat-S, with only 33% of the parameters of SOTA methods, while still achieving higher matting accuracy, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S1.F1" title="In 1 Introduction ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>. By utilizing DFIMat, we also investigate the roles of different input types, providing valuable principles for users on more effective interaction. Our main contributions are:</p>
</div>
<div class="ltx_para" id="S1.p11">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a decoupled network for IPM task, which decomposes the task based on a top-down perspective, resulting in a clear performance gain.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose to enable flexible and multi-type user input for interactive matting, making it more effective, efficient, and user-friendly. This is achieved by encoding different inputs into a unified visual-semantic space.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Concerning the multi-round feature of interaction, we design a contrastive reasoning module to enhance cross-round refinement.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We propose a new synthetic data generation pipeline that can generate diverse and high-quality image-matte-text pairs in multi-person scenarios. A large-scale dataset is further introduced to facilitate relevant research.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1">We investigate the roles of different input types and provide valuable principles for users on more effective interaction.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Interactive Image matting.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite> adopt user inputs to identify the foreground and background region, which can usually obtain much better matting results than the automatic ones <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib23" title="">23</a>]</cite>.
Most of the existing interactive matting methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite> adopt an encoder-decoder-like architecture that takes image and user input as input, and directly predicts matting results. Such a coupled network design makes the model difficult to adapt well in complex real-world scenarios, such as multi-person scenes with severe occlusions. The reason is that the coupled design lacks interpretability and thus increasing the learning difficulty.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.1">Another limitation is that existing works generally only consider a single type of user input (e.g., click, scribble, box, or text), which is ineffective and not user-friendly, as different types of inputs can play different roles and can complement each other. Although a very recent work (i.e., MatAny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib37" title="">37</a>]</cite>) expands the input type by using a segmentation foundation model (SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib13" title="">13</a>]</cite>) to receive different types of input, it still can not support mixed types of input at one time, which failed to exploit complement information from different types of input during user interactions. Moreover, most of the existing works do not consider the multi-round interaction property that is necessary for practical usage and thus ignore the cross-round information that can be useful clues for refinement.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p3.1">Here we proposed a decoupled network DFIMat that is of better interpretability and performance. It also enables truly flexible inputs by encoding different types of inputs into a unified visual-semantic space, resulting in a more effective and user-friendly matting experience. We also consider the multi-round interaction characteristic and design a contrastive reasoning module to enhance cross-round refinement. A summary of different methods can be seen in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S1" title="1 Introduction ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Matting datasets.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Numerous matting datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib26" title="">26</a>]</cite> have been introduced to propel advancements in the field of image matting. Typical matting datasets contain high-resolution images belonging to some specific object categories that have lots of details like hair, accessories, fur, and net, as well as transparent objects. Besides, some other matting datasets focus on a specific category of object, e.g., humans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib14" title="">14</a>]</cite> and animals <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib29" title="">29</a>]</cite>. To generate images containing multiple foreground objects, a typical solution in previous matting methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite> is to iteratively composite the foreground onto the background image sequentially. Although augmentation strategies have been proposed to reduce the domain gap between the real-world images and the composite ones,there is still an urgent need to generate synthetic images that are closer to the real world.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">In our work, we build a multi-person matting dataset and ensure its diversity and high quality by designing a new synthetic data generation pipeline.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="310" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">The overall framework of DFIMat, which consists of two components: (a) Interactive semantic capture network (ISCN), and (b) Matting refinement network (MRN).</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">By reflecting on and summarizing the shortcomings of the existing works, we propose DFIMat, a novel decoupled framework for flexible interactive matting. It consists of two independent components: the interactive semantic capture network (ISCN) and the matting refinement network (MRN), as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.F2" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. The ISCN is responsible for understanding the user intention from their various inputs, and localizing the interested instance in the image (<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.SS2" title="3.2 Interactive Semantic Capture Network (ISCN) ‣ 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>). The MRN takes the prediction result of ISCN (i.e., a coarse mask of the interested instance) as well as the original image, and performs refinement to produce the final alpha matte for the corresponding instance-level matting (<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.SS3" title="3.3 Matting Refinement Network (MRN) ‣ 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Interactive Semantic Capture Network (ISCN)</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Here we introduce the proposed ISCN, a model that understands scene semantics and multiple/flexible user inputs to localize the target instance, in an interactive manner. The ISCN design takes inspiration from the recent success of multi-modal learning methods  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib41" title="">41</a>]</cite> and encodes the different types of user inputs and image into a unified visual-semantic space. Then, strong interactions among them are introduced to better understand the user intentions and then predict the target instance mask for instance localization. Leveraging the characteristic of multi-round interaction, we further design a simple but effective contrastive reasoning module to evaluate the consistency between the model prediction and user intention while also explicitly identifying and reasoning the conflict areas during each round’s interaction, providing valuable auxiliary guidance for the model to further refine its outputs. The overall architecture is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.F2" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, which will be introduced in detail.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.6.1">Unified visual-semantic space.</span>
Given an input image <math alttext="I\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">I</mi><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS2.p2.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p2.1.m1.1.1.3.3.4" xref="S3.SS2.p2.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><in id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></in><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐼</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><times id="S3.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.3">𝑊</ci><cn id="S3.SS2.p2.1.m1.1.1.3.3.4.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">I\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, we first extract image feature <math alttext="F_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐹</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">F_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> by an image encoder. Visual inputs <math alttext="s" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_s</annotation></semantics></math>(<math alttext="s\in\{clicks,scrib" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1b"><mi id="S3.SS2.p2.4.m4.1.1">s</mi><mo id="S3.SS2.p2.4.m4.1.2">∈</mo><mrow id="S3.SS2.p2.4.m4.1.3"><mo id="S3.SS2.p2.4.m4.1.3.1" stretchy="false">{</mo><mi id="S3.SS2.p2.4.m4.1.3.2">c</mi><mi id="S3.SS2.p2.4.m4.1.3.3">l</mi><mi id="S3.SS2.p2.4.m4.1.3.4">i</mi><mi id="S3.SS2.p2.4.m4.1.3.5">c</mi><mi id="S3.SS2.p2.4.m4.1.3.6">k</mi><mi id="S3.SS2.p2.4.m4.1.3.7">s</mi><mo id="S3.SS2.p2.4.m4.1.3.8">,</mo><mi id="S3.SS2.p2.4.m4.1.3.9">s</mi><mi id="S3.SS2.p2.4.m4.1.3.10">c</mi><mi id="S3.SS2.p2.4.m4.1.3.11">r</mi><mi id="S3.SS2.p2.4.m4.1.3.12">i</mi><mi id="S3.SS2.p2.4.m4.1.3.13">b</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">s\in\{clicks,scrib</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_s ∈ { italic_c italic_l italic_i italic_c italic_k italic_s , italic_s italic_c italic_r italic_i italic_b</annotation></semantics></math> <math alttext="-bles,boxes\}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1b"><mo id="S3.SS2.p2.5.m5.1.1">−</mo><mi id="S3.SS2.p2.5.m5.1.2">b</mi><mi id="S3.SS2.p2.5.m5.1.3">l</mi><mi id="S3.SS2.p2.5.m5.1.4">e</mi><mi id="S3.SS2.p2.5.m5.1.5">s</mi><mo id="S3.SS2.p2.5.m5.1.6">,</mo><mi id="S3.SS2.p2.5.m5.1.7">b</mi><mi id="S3.SS2.p2.5.m5.1.8">o</mi><mi id="S3.SS2.p2.5.m5.1.9">x</mi><mi id="S3.SS2.p2.5.m5.1.10">e</mi><mi id="S3.SS2.p2.5.m5.1.11">s</mi><mo id="S3.SS2.p2.5.m5.1.12" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">-bles,boxes\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">- italic_b italic_l italic_e italic_s , italic_b italic_o italic_x italic_e italic_s }</annotation></semantics></math>) are converted to visual prompts <math alttext="P_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">P</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝑃</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">P_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> through a visual sampler:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{v}=\mathbf{VisualSampler}(s,F_{v})." class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">P</mi><mi id="S3.E1.m1.2.2.1.1.3.3" xref="S3.E1.m1.2.2.1.1.3.3.cmml">v</mi></msub><mo id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">𝐕𝐢𝐬𝐮𝐚𝐥𝐒𝐚𝐦𝐩𝐥𝐞𝐫</mi><mo id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">s</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" lspace="0em" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></eq><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">𝑃</ci><ci id="S3.E1.m1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.3">𝑣</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"></times><ci id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3">𝐕𝐢𝐬𝐮𝐚𝐥𝐒𝐚𝐦𝐩𝐥𝐞𝐫</ci><interval closure="open" id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑠</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">𝑣</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">P_{v}=\mathbf{VisualSampler}(s,F_{v}).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = bold_VisualSampler ( italic_s , italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.9">The visual sampler performs feature point sampling on the corresponding locations in image features based on user inputs. Textual inputs are fed into a text encoder for text prompts <math alttext="P_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m1.1"><semantics id="S3.SS2.p2.7.m1.1a"><msub id="S3.SS2.p2.7.m1.1.1" xref="S3.SS2.p2.7.m1.1.1.cmml"><mi id="S3.SS2.p2.7.m1.1.1.2" xref="S3.SS2.p2.7.m1.1.1.2.cmml">P</mi><mi id="S3.SS2.p2.7.m1.1.1.3" xref="S3.SS2.p2.7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m1.1b"><apply id="S3.SS2.p2.7.m1.1.1.cmml" xref="S3.SS2.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m1.1.1.1.cmml" xref="S3.SS2.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m1.1.1.2.cmml" xref="S3.SS2.p2.7.m1.1.1.2">𝑃</ci><ci id="S3.SS2.p2.7.m1.1.1.3.cmml" xref="S3.SS2.p2.7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m1.1c">P_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m1.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
Then, a decoder is used to build strong interactions between the image feature <math alttext="F_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m2.1"><semantics id="S3.SS2.p2.8.m2.1a"><msub id="S3.SS2.p2.8.m2.1.1" xref="S3.SS2.p2.8.m2.1.1.cmml"><mi id="S3.SS2.p2.8.m2.1.1.2" xref="S3.SS2.p2.8.m2.1.1.2.cmml">F</mi><mi id="S3.SS2.p2.8.m2.1.1.3" xref="S3.SS2.p2.8.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m2.1b"><apply id="S3.SS2.p2.8.m2.1.1.cmml" xref="S3.SS2.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m2.1.1.1.cmml" xref="S3.SS2.p2.8.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m2.1.1.2.cmml" xref="S3.SS2.p2.8.m2.1.1.2">𝐹</ci><ci id="S3.SS2.p2.8.m2.1.1.3.cmml" xref="S3.SS2.p2.8.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m2.1c">F_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m2.1d">italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> and user prompts <math alttext="{P_{v},P_{t}}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m3.2"><semantics id="S3.SS2.p2.9.m3.2a"><mrow id="S3.SS2.p2.9.m3.2.2.2" xref="S3.SS2.p2.9.m3.2.2.3.cmml"><msub id="S3.SS2.p2.9.m3.1.1.1.1" xref="S3.SS2.p2.9.m3.1.1.1.1.cmml"><mi id="S3.SS2.p2.9.m3.1.1.1.1.2" xref="S3.SS2.p2.9.m3.1.1.1.1.2.cmml">P</mi><mi id="S3.SS2.p2.9.m3.1.1.1.1.3" xref="S3.SS2.p2.9.m3.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS2.p2.9.m3.2.2.2.3" xref="S3.SS2.p2.9.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.9.m3.2.2.2.2" xref="S3.SS2.p2.9.m3.2.2.2.2.cmml"><mi id="S3.SS2.p2.9.m3.2.2.2.2.2" xref="S3.SS2.p2.9.m3.2.2.2.2.2.cmml">P</mi><mi id="S3.SS2.p2.9.m3.2.2.2.2.3" xref="S3.SS2.p2.9.m3.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m3.2b"><list id="S3.SS2.p2.9.m3.2.2.3.cmml" xref="S3.SS2.p2.9.m3.2.2.2"><apply id="S3.SS2.p2.9.m3.1.1.1.1.cmml" xref="S3.SS2.p2.9.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m3.1.1.1.1.2.cmml" xref="S3.SS2.p2.9.m3.1.1.1.1.2">𝑃</ci><ci id="S3.SS2.p2.9.m3.1.1.1.1.3.cmml" xref="S3.SS2.p2.9.m3.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS2.p2.9.m3.2.2.2.2.cmml" xref="S3.SS2.p2.9.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m3.2.2.2.2.1.cmml" xref="S3.SS2.p2.9.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.9.m3.2.2.2.2.2.cmml" xref="S3.SS2.p2.9.m3.2.2.2.2.2">𝑃</ci><ci id="S3.SS2.p2.9.m3.2.2.2.2.3.cmml" xref="S3.SS2.p2.9.m3.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m3.2c">{P_{v},P_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m3.2d">italic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to understand both scene semantics and user intentions, and finally predict the target instance mask for instance localization. This can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\langle{M},{C}\right\rangle=\mathbf{Decoder}\left(\left\langle{P}_{t},{P}%
_{v}\right\rangle\mid{F}_{v}\right)," class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.1.cmml"><mo id="S3.E2.m1.3.3.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⟨</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">M</mi><mo id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">C</mi><mo id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⟩</mo></mrow><mo id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml">𝐃𝐞𝐜𝐨𝐝𝐞𝐫</mi><mo id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml">⟨</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">P</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">P</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">v</mi></msub><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml">⟩</mo></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml">∣</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.4" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.4.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4.2.cmml">F</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.4.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4.3.cmml">v</mi></msub></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"></eq><list id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑀</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐶</ci></list><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2"></times><ci id="S3.E2.m1.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3">𝐃𝐞𝐜𝐨𝐝𝐞𝐫</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3">conditional</csymbol><list id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑃</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑃</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.2.3">𝑣</ci></apply></list><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4.2">𝐹</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.4.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\left\langle{M},{C}\right\rangle=\mathbf{Decoder}\left(\left\langle{P}_{t},{P}%
_{v}\right\rangle\mid{F}_{v}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">⟨ italic_M , italic_C ⟩ = bold_Decoder ( ⟨ italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ⟩ ∣ italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.14">where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m1.1"><semantics id="S3.SS2.p2.10.m1.1a"><mi id="S3.SS2.p2.10.m1.1.1" xref="S3.SS2.p2.10.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m1.1b"><ci id="S3.SS2.p2.10.m1.1.1.cmml" xref="S3.SS2.p2.10.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m1.1d">italic_M</annotation></semantics></math> is the predicted instance mask and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p2.11.m2.1"><semantics id="S3.SS2.p2.11.m2.1a"><mi id="S3.SS2.p2.11.m2.1.1" xref="S3.SS2.p2.11.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m2.1b"><ci id="S3.SS2.p2.11.m2.1.1.cmml" xref="S3.SS2.p2.11.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.m2.1d">italic_C</annotation></semantics></math> is its class (is human or not). More specifically, we first initialize three types of learnable query: object queries <math alttext="Q_{o}" class="ltx_Math" display="inline" id="S3.SS2.p2.12.m3.1"><semantics id="S3.SS2.p2.12.m3.1a"><msub id="S3.SS2.p2.12.m3.1.1" xref="S3.SS2.p2.12.m3.1.1.cmml"><mi id="S3.SS2.p2.12.m3.1.1.2" xref="S3.SS2.p2.12.m3.1.1.2.cmml">Q</mi><mi id="S3.SS2.p2.12.m3.1.1.3" xref="S3.SS2.p2.12.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m3.1b"><apply id="S3.SS2.p2.12.m3.1.1.cmml" xref="S3.SS2.p2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m3.1.1.1.cmml" xref="S3.SS2.p2.12.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m3.1.1.2.cmml" xref="S3.SS2.p2.12.m3.1.1.2">𝑄</ci><ci id="S3.SS2.p2.12.m3.1.1.3.cmml" xref="S3.SS2.p2.12.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m3.1c">Q_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.12.m3.1d">italic_Q start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>, text queries <math alttext="Q_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.13.m4.1"><semantics id="S3.SS2.p2.13.m4.1a"><msub id="S3.SS2.p2.13.m4.1.1" xref="S3.SS2.p2.13.m4.1.1.cmml"><mi id="S3.SS2.p2.13.m4.1.1.2" xref="S3.SS2.p2.13.m4.1.1.2.cmml">Q</mi><mi id="S3.SS2.p2.13.m4.1.1.3" xref="S3.SS2.p2.13.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m4.1b"><apply id="S3.SS2.p2.13.m4.1.1.cmml" xref="S3.SS2.p2.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m4.1.1.1.cmml" xref="S3.SS2.p2.13.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.13.m4.1.1.2.cmml" xref="S3.SS2.p2.13.m4.1.1.2">𝑄</ci><ci id="S3.SS2.p2.13.m4.1.1.3.cmml" xref="S3.SS2.p2.13.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m4.1c">Q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.13.m4.1d">italic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and visual queries <math alttext="Q_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.14.m5.1"><semantics id="S3.SS2.p2.14.m5.1a"><msub id="S3.SS2.p2.14.m5.1.1" xref="S3.SS2.p2.14.m5.1.1.cmml"><mi id="S3.SS2.p2.14.m5.1.1.2" xref="S3.SS2.p2.14.m5.1.1.2.cmml">Q</mi><mi id="S3.SS2.p2.14.m5.1.1.3" xref="S3.SS2.p2.14.m5.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m5.1b"><apply id="S3.SS2.p2.14.m5.1.1.cmml" xref="S3.SS2.p2.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m5.1.1.1.cmml" xref="S3.SS2.p2.14.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.14.m5.1.1.2.cmml" xref="S3.SS2.p2.14.m5.1.1.2">𝑄</ci><ci id="S3.SS2.p2.14.m5.1.1.3.cmml" xref="S3.SS2.p2.14.m5.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m5.1c">Q_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.14.m5.1d">italic_Q start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>. Each decoder stage contains cross-attention operations on images and learnable queries, and a prompt self-attention block to perform the interaction between queries and prompts:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q_{x}=\mathbf{CrossAttention}(Q=F_{v},K=V=Q_{x}),\quad x\in\{o,v%
,t\}," class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.4"><semantics id="S3.E3X.2.1.1.m1.4a"><mrow id="S3.E3X.2.1.1.m1.4.4.1"><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.3.cmml"><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.cmml"><msub id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.2.cmml">Q</mi><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.3.cmml">x</mi></msub><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">𝐂𝐫𝐨𝐬𝐬𝐀𝐭𝐭𝐞𝐧𝐭𝐢𝐨𝐧</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">v</mi></msub></mrow><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">K</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">=</mo><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.4.cmml">V</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.5.cmml">=</mo><msub id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.2.cmml">Q</mi><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.3.cmml">x</mi></msub></mrow></mrow><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.3" rspace="1.167em" xref="S3.E3X.2.1.1.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.2.cmml">x</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml"><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2.1" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml">{</mo><mi id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml">o</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.2.2" xref="S3.E3X.2.1.1.m1.2.2.cmml">v</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.3.3" xref="S3.E3X.2.1.1.m1.3.3.cmml">t</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2.4" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E3X.2.1.1.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.4b"><apply id="S3.E3X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1"><eq id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2"></eq><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.2">𝑄</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.3">𝑥</ci></apply><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1"><times id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.2"></times><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.3">𝐂𝐫𝐨𝐬𝐬𝐀𝐭𝐭𝐞𝐧𝐭𝐢𝐨𝐧</ci><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><eq id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2"><and id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2"></and><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2b.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2"><eq id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.3"></eq><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝐾</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.4">𝑉</ci></apply><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2c.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2"><eq id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.5.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.5"></eq><share href="https://arxiv.org/html/2410.09788v1#S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.4.cmml" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2d.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2"></share><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.2">𝑄</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.6.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2"><in id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.1"></in><ci id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.2">𝑥</ci><set id="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.2.2.3.2"><ci id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">𝑜</ci><ci id="S3.E3X.2.1.1.m1.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2">𝑣</ci><ci id="S3.E3X.2.1.1.m1.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3">𝑡</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.4c">\displaystyle Q_{x}=\mathbf{CrossAttention}(Q=F_{v},K=V=Q_{x}),\quad x\in\{o,v%
,t\},</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.4d">italic_Q start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = bold_CrossAttention ( italic_Q = italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_K = italic_V = italic_Q start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ) , italic_x ∈ { italic_o , italic_v , italic_t } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Q_{o},Q_{t},Q_{v}=\mathbf{SelfAttention}(Q_{o},Q_{t},Q_{v},P_{v}%
,P_{t})." class="ltx_Math" display="inline" id="S3.E3Xa.2.1.1.m1.1"><semantics id="S3.E3Xa.2.1.1.m1.1a"><mrow id="S3.E3Xa.2.1.1.m1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.4.cmml"><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.4" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.5" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">v</mi></msub></mrow><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.9" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.9.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.8" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.7" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.7.cmml">𝐒𝐞𝐥𝐟𝐀𝐭𝐭𝐞𝐧𝐭𝐢𝐨𝐧</mi><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.6" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.6.cmml">⁢</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml"><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.6" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">(</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.3.cmml">o</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.7" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.3.cmml">t</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.8" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.2.cmml">Q</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.3.cmml">v</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.9" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.2.cmml">P</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.3.cmml">v</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.10" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">,</mo><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.2.cmml">P</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.3.cmml">t</mi></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.11" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1"><eq id="S3.E3Xa.2.1.1.m1.1.1.1.1.9.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.9"></eq><list id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3"><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3">𝑜</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.3.3.3">𝑣</ci></apply></list><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8"><times id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.6.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.6"></times><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.7.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.7">𝐒𝐞𝐥𝐟𝐀𝐭𝐭𝐞𝐧𝐭𝐢𝐨𝐧</ci><vector id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.6.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5"><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.4.1.1.1.3">𝑜</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.5.2.2.2.3">𝑡</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.2">𝑄</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.6.3.3.3.3">𝑣</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.2">𝑃</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.7.4.4.4.3">𝑣</ci></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.2">𝑃</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.8.5.5.5.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle Q_{o},Q_{t},Q_{v}=\mathbf{SelfAttention}(Q_{o},Q_{t},Q_{v},P_{v}%
,P_{t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.2.1.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = bold_SelfAttention ( italic_Q start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.16">The output of last decoder stage and image features are passed to FFN to obtain the mask embeddings <math alttext="{O}_{h}^{m}" class="ltx_Math" display="inline" id="S3.SS2.p2.15.m1.1"><semantics id="S3.SS2.p2.15.m1.1a"><msubsup id="S3.SS2.p2.15.m1.1.1" xref="S3.SS2.p2.15.m1.1.1.cmml"><mi id="S3.SS2.p2.15.m1.1.1.2.2" xref="S3.SS2.p2.15.m1.1.1.2.2.cmml">O</mi><mi id="S3.SS2.p2.15.m1.1.1.2.3" xref="S3.SS2.p2.15.m1.1.1.2.3.cmml">h</mi><mi id="S3.SS2.p2.15.m1.1.1.3" xref="S3.SS2.p2.15.m1.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m1.1b"><apply id="S3.SS2.p2.15.m1.1.1.cmml" xref="S3.SS2.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m1.1.1.1.cmml" xref="S3.SS2.p2.15.m1.1.1">superscript</csymbol><apply id="S3.SS2.p2.15.m1.1.1.2.cmml" xref="S3.SS2.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m1.1.1.2.1.cmml" xref="S3.SS2.p2.15.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.15.m1.1.1.2.2.cmml" xref="S3.SS2.p2.15.m1.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.15.m1.1.1.2.3.cmml" xref="S3.SS2.p2.15.m1.1.1.2.3">ℎ</ci></apply><ci id="S3.SS2.p2.15.m1.1.1.3.cmml" xref="S3.SS2.p2.15.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m1.1c">{O}_{h}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.15.m1.1d">italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and class embeddings <math alttext="{O}_{h}^{c}" class="ltx_Math" display="inline" id="S3.SS2.p2.16.m2.1"><semantics id="S3.SS2.p2.16.m2.1a"><msubsup id="S3.SS2.p2.16.m2.1.1" xref="S3.SS2.p2.16.m2.1.1.cmml"><mi id="S3.SS2.p2.16.m2.1.1.2.2" xref="S3.SS2.p2.16.m2.1.1.2.2.cmml">O</mi><mi id="S3.SS2.p2.16.m2.1.1.2.3" xref="S3.SS2.p2.16.m2.1.1.2.3.cmml">h</mi><mi id="S3.SS2.p2.16.m2.1.1.3" xref="S3.SS2.p2.16.m2.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m2.1b"><apply id="S3.SS2.p2.16.m2.1.1.cmml" xref="S3.SS2.p2.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m2.1.1.1.cmml" xref="S3.SS2.p2.16.m2.1.1">superscript</csymbol><apply id="S3.SS2.p2.16.m2.1.1.2.cmml" xref="S3.SS2.p2.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m2.1.1.2.1.cmml" xref="S3.SS2.p2.16.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.16.m2.1.1.2.2.cmml" xref="S3.SS2.p2.16.m2.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.16.m2.1.1.2.3.cmml" xref="S3.SS2.p2.16.m2.1.1.2.3">ℎ</ci></apply><ci id="S3.SS2.p2.16.m2.1.1.3.cmml" xref="S3.SS2.p2.16.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m2.1c">{O}_{h}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.16.m2.1d">italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{O}_{h}^{m},{O}_{h}^{c}=\mathbf{FFN}(F_{v},Q_{o},Q_{t},Q_{v})." class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.3.cmml"><msubsup id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml">O</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.cmml">h</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.2.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml">O</mi><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">h</mi><mi id="S3.E4.m1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.3.cmml">c</mi></msubsup></mrow><mo id="S3.E4.m1.1.1.1.1.7" xref="S3.E4.m1.1.1.1.1.7.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.6.cmml"><mi id="S3.E4.m1.1.1.1.1.6.6" xref="S3.E4.m1.1.1.1.1.6.6.cmml">𝐅𝐅𝐍</mi><mo id="S3.E4.m1.1.1.1.1.6.5" xref="S3.E4.m1.1.1.1.1.6.5.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.6.4.4" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml"><mo id="S3.E4.m1.1.1.1.1.6.4.4.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.3.1.1.1" xref="S3.E4.m1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.1.1.1.2.cmml">F</mi><mi id="S3.E4.m1.1.1.1.1.3.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3.cmml">v</mi></msub><mo id="S3.E4.m1.1.1.1.1.6.4.4.6" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.4.2.2.2" xref="S3.E4.m1.1.1.1.1.4.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.4.2.2.2.2" xref="S3.E4.m1.1.1.1.1.4.2.2.2.2.cmml">Q</mi><mi id="S3.E4.m1.1.1.1.1.4.2.2.2.3" xref="S3.E4.m1.1.1.1.1.4.2.2.2.3.cmml">o</mi></msub><mo id="S3.E4.m1.1.1.1.1.6.4.4.7" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.5.3.3.3" xref="S3.E4.m1.1.1.1.1.5.3.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.5.3.3.3.2" xref="S3.E4.m1.1.1.1.1.5.3.3.3.2.cmml">Q</mi><mi id="S3.E4.m1.1.1.1.1.5.3.3.3.3" xref="S3.E4.m1.1.1.1.1.5.3.3.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.1.1.6.4.4.8" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.6.4.4.4" xref="S3.E4.m1.1.1.1.1.6.4.4.4.cmml"><mi id="S3.E4.m1.1.1.1.1.6.4.4.4.2" xref="S3.E4.m1.1.1.1.1.6.4.4.4.2.cmml">Q</mi><mi id="S3.E4.m1.1.1.1.1.6.4.4.4.3" xref="S3.E4.m1.1.1.1.1.6.4.4.4.3.cmml">v</mi></msub><mo id="S3.E4.m1.1.1.1.1.6.4.4.9" stretchy="false" xref="S3.E4.m1.1.1.1.1.6.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" lspace="0em" xref="S3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.7.cmml" xref="S3.E4.m1.1.1.1.1.7"></eq><list id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2">𝑂</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2">𝑂</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3">ℎ</ci></apply><ci id="S3.E4.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.3">𝑐</ci></apply></list><apply id="S3.E4.m1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.6"><times id="S3.E4.m1.1.1.1.1.6.5.cmml" xref="S3.E4.m1.1.1.1.1.6.5"></times><ci id="S3.E4.m1.1.1.1.1.6.6.cmml" xref="S3.E4.m1.1.1.1.1.6.6">𝐅𝐅𝐍</ci><vector id="S3.E4.m1.1.1.1.1.6.4.5.cmml" xref="S3.E4.m1.1.1.1.1.6.4.4"><apply id="S3.E4.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.2">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.1.1.3">𝑣</ci></apply><apply id="S3.E4.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.4.2.2.2.2">𝑄</ci><ci id="S3.E4.m1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.4.2.2.2.3">𝑜</ci></apply><apply id="S3.E4.m1.1.1.1.1.5.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.3.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.3.3.2">𝑄</ci><ci id="S3.E4.m1.1.1.1.1.5.3.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.3.3.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.6.4.4.4.cmml" xref="S3.E4.m1.1.1.1.1.6.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.6.4.4.4.1.cmml" xref="S3.E4.m1.1.1.1.1.6.4.4.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.6.4.4.4.2.cmml" xref="S3.E4.m1.1.1.1.1.6.4.4.4.2">𝑄</ci><ci id="S3.E4.m1.1.1.1.1.6.4.4.4.3.cmml" xref="S3.E4.m1.1.1.1.1.6.4.4.4.3">𝑣</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">{O}_{h}^{m},{O}_{h}^{c}=\mathbf{FFN}(F_{v},Q_{o},Q_{t},Q_{v}).</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT = bold_FFN ( italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.20">Finally, ISCN predicts the masks <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.17.m1.1"><semantics id="S3.SS2.p2.17.m1.1a"><mi id="S3.SS2.p2.17.m1.1.1" xref="S3.SS2.p2.17.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.m1.1b"><ci id="S3.SS2.p2.17.m1.1.1.cmml" xref="S3.SS2.p2.17.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.17.m1.1d">italic_M</annotation></semantics></math> and the classes <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p2.18.m2.1"><semantics id="S3.SS2.p2.18.m2.1a"><mi id="S3.SS2.p2.18.m2.1.1" xref="S3.SS2.p2.18.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.18.m2.1b"><ci id="S3.SS2.p2.18.m2.1.1.cmml" xref="S3.SS2.p2.18.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.18.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.18.m2.1d">italic_C</annotation></semantics></math> based on <math alttext="{O}_{h}^{m}" class="ltx_Math" display="inline" id="S3.SS2.p2.19.m3.1"><semantics id="S3.SS2.p2.19.m3.1a"><msubsup id="S3.SS2.p2.19.m3.1.1" xref="S3.SS2.p2.19.m3.1.1.cmml"><mi id="S3.SS2.p2.19.m3.1.1.2.2" xref="S3.SS2.p2.19.m3.1.1.2.2.cmml">O</mi><mi id="S3.SS2.p2.19.m3.1.1.2.3" xref="S3.SS2.p2.19.m3.1.1.2.3.cmml">h</mi><mi id="S3.SS2.p2.19.m3.1.1.3" xref="S3.SS2.p2.19.m3.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.19.m3.1b"><apply id="S3.SS2.p2.19.m3.1.1.cmml" xref="S3.SS2.p2.19.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.19.m3.1.1.1.cmml" xref="S3.SS2.p2.19.m3.1.1">superscript</csymbol><apply id="S3.SS2.p2.19.m3.1.1.2.cmml" xref="S3.SS2.p2.19.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.19.m3.1.1.2.1.cmml" xref="S3.SS2.p2.19.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.19.m3.1.1.2.2.cmml" xref="S3.SS2.p2.19.m3.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.19.m3.1.1.2.3.cmml" xref="S3.SS2.p2.19.m3.1.1.2.3">ℎ</ci></apply><ci id="S3.SS2.p2.19.m3.1.1.3.cmml" xref="S3.SS2.p2.19.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.19.m3.1c">{O}_{h}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.19.m3.1d">italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{O}_{h}^{c}" class="ltx_Math" display="inline" id="S3.SS2.p2.20.m4.1"><semantics id="S3.SS2.p2.20.m4.1a"><msubsup id="S3.SS2.p2.20.m4.1.1" xref="S3.SS2.p2.20.m4.1.1.cmml"><mi id="S3.SS2.p2.20.m4.1.1.2.2" xref="S3.SS2.p2.20.m4.1.1.2.2.cmml">O</mi><mi id="S3.SS2.p2.20.m4.1.1.2.3" xref="S3.SS2.p2.20.m4.1.1.2.3.cmml">h</mi><mi id="S3.SS2.p2.20.m4.1.1.3" xref="S3.SS2.p2.20.m4.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.20.m4.1b"><apply id="S3.SS2.p2.20.m4.1.1.cmml" xref="S3.SS2.p2.20.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.20.m4.1.1.1.cmml" xref="S3.SS2.p2.20.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.20.m4.1.1.2.cmml" xref="S3.SS2.p2.20.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.20.m4.1.1.2.1.cmml" xref="S3.SS2.p2.20.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.20.m4.1.1.2.2.cmml" xref="S3.SS2.p2.20.m4.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.20.m4.1.1.2.3.cmml" xref="S3.SS2.p2.20.m4.1.1.2.3">ℎ</ci></apply><ci id="S3.SS2.p2.20.m4.1.1.3.cmml" xref="S3.SS2.p2.20.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.20.m4.1c">{O}_{h}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.20.m4.1d">italic_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{M}" class="ltx_Math" display="inline" id="S3.E5X.2.1.1.m1.1"><semantics id="S3.E5X.2.1.1.m1.1a"><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.2.1.1.m1.1d">bold_M</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{MaskPredictor}\left(\mathbf{O}_{h}^{m}\right)," class="ltx_Math" display="inline" id="S3.E5X.3.2.2.m1.1"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml">𝐌𝐚𝐬𝐤𝐏𝐫𝐞𝐝𝐢𝐜𝐭𝐨𝐫</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐎</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml">h</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><eq id="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3">𝐌𝐚𝐬𝐤𝐏𝐫𝐞𝐝𝐢𝐜𝐭𝐨𝐫</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">𝐎</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle=\mathbf{MaskPredictor}\left(\mathbf{O}_{h}^{m}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.3.2.2.m1.1d">= bold_MaskPredictor ( bold_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{C}" class="ltx_Math" display="inline" id="S3.E5Xa.2.1.1.m1.1"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mi id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml">𝐂</mi><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><ci id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">𝐂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\mathbf{C}</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.2.1.1.m1.1d">bold_C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{ConceptClassifier}\left(\mathbf{O}_{h}^{c}\right)." class="ltx_Math" display="inline" id="S3.E5Xa.3.2.2.m1.1"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml">𝐂𝐨𝐧𝐜𝐞𝐩𝐭𝐂𝐥𝐚𝐬𝐬𝐢𝐟𝐢𝐞𝐫</mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐎</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml">h</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msubsup><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2" lspace="0em" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3">𝐂𝐨𝐧𝐜𝐞𝐩𝐭𝐂𝐥𝐚𝐬𝐬𝐢𝐟𝐢𝐞𝐫</ci><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">𝐎</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\mathbf{ConceptClassifier}\left(\mathbf{O}_{h}^{c}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.3.2.2.m1.1d">= bold_ConceptClassifier ( bold_O start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.21">Here MaskPredictor (and ConceptClassifier) are task-specific heads and we follow the design of X-decoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib40" title="">40</a>]</cite> for its simplicity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.13"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.13.1">Contrastive reasoning module.</span> We propose a contrastive reasoning module (CRM) to evaluate the consistency between the model prediction and user intention while also explicitly identifying and reasoning the conflict areas during each round’s interaction, which can serve as a useful clue for cross-round refinement. Specifically, we maintain a mask <math alttext="M_{ref}\in\mathbb{R}^{H\times W}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><msub id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2.2" xref="S3.SS2.p3.1.m1.1.1.2.2.cmml">M</mi><mrow id="S3.SS2.p3.1.m1.1.1.2.3" xref="S3.SS2.p3.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2.3.2" xref="S3.SS2.p3.1.m1.1.1.2.3.2.cmml">r</mi><mo id="S3.SS2.p3.1.m1.1.1.2.3.1" xref="S3.SS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.1.m1.1.1.2.3.3" xref="S3.SS2.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S3.SS2.p3.1.m1.1.1.2.3.1a" xref="S3.SS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.1.m1.1.1.2.3.4" xref="S3.SS2.p3.1.m1.1.1.2.3.4.cmml">f</mi></mrow></msub><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.p3.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><in id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></in><apply id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2.2">𝑀</ci><apply id="S3.SS2.p3.1.m1.1.1.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3"><times id="S3.SS2.p3.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3.2">𝑟</ci><ci id="S3.SS2.p3.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.p3.1.m1.1.1.2.3.4.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3.4">𝑓</ci></apply></apply><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"><times id="S3.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">M_{ref}\in\mathbb{R}^{H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>, where each pixel has one of the following three values based on the difference between new user input and the previous model prediction: (1) <math alttext="D_{r}=0" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.cmml">D</mi><mi id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><eq id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></eq><apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2">𝐷</ci><ci id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">𝑟</ci></apply><cn id="S3.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">D_{r}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = 0</annotation></semantics></math> indicates no conflict; (2) <math alttext="D_{fg}=1" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><msub id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.3.2" xref="S3.SS2.p3.3.m3.1.1.2.3.2.cmml">f</mi><mo id="S3.SS2.p3.3.m3.1.1.2.3.1" xref="S3.SS2.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.3.m3.1.1.2.3.3" xref="S3.SS2.p3.3.m3.1.1.2.3.3.cmml">g</mi></mrow></msub><mo id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><eq id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1"></eq><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">𝐷</ci><apply id="S3.SS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3"><times id="S3.SS2.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3.1"></times><ci id="S3.SS2.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3.2">𝑓</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3.3">𝑔</ci></apply></apply><cn id="S3.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">D_{fg}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_f italic_g end_POSTSUBSCRIPT = 1</annotation></semantics></math> means previous prediction classified the area as background but new user input suggest it is foreground, and (3) <math alttext="D_{gf}=2" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><msub id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p3.4.m4.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.3.2" xref="S3.SS2.p3.4.m4.1.1.2.3.2.cmml">g</mi><mo id="S3.SS2.p3.4.m4.1.1.2.3.1" xref="S3.SS2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.4.m4.1.1.2.3.3" xref="S3.SS2.p3.4.m4.1.1.2.3.3.cmml">f</mi></mrow></msub><mo id="S3.SS2.p3.4.m4.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><eq id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1"></eq><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝐷</ci><apply id="S3.SS2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3"><times id="S3.SS2.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.1"></times><ci id="S3.SS2.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.2">𝑔</ci><ci id="S3.SS2.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.3">𝑓</ci></apply></apply><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">D_{gf}=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_D start_POSTSUBSCRIPT italic_g italic_f end_POSTSUBSCRIPT = 2</annotation></semantics></math> means conversely with <math alttext="D_{fg}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">D</mi><mrow id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">f</mi><mo id="S3.SS2.p3.5.m5.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝐷</ci><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><times id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑓</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">D_{fg}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_f italic_g end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="M_{ref}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">M</mi><mrow id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml"><mi id="S3.SS2.p3.6.m6.1.1.3.2" xref="S3.SS2.p3.6.m6.1.1.3.2.cmml">r</mi><mo id="S3.SS2.p3.6.m6.1.1.3.1" xref="S3.SS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.1.3.3" xref="S3.SS2.p3.6.m6.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p3.6.m6.1.1.3.1a" xref="S3.SS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.1.3.4" xref="S3.SS2.p3.6.m6.1.1.3.4.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑀</ci><apply id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><times id="S3.SS2.p3.6.m6.1.1.3.1.cmml" xref="S3.SS2.p3.6.m6.1.1.3.1"></times><ci id="S3.SS2.p3.6.m6.1.1.3.2.cmml" xref="S3.SS2.p3.6.m6.1.1.3.2">𝑟</ci><ci id="S3.SS2.p3.6.m6.1.1.3.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3">𝑒</ci><ci id="S3.SS2.p3.6.m6.1.1.3.4.cmml" xref="S3.SS2.p3.6.m6.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">M_{ref}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_M start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT</annotation></semantics></math> is initialized with all pixels set to <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">D</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝐷</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and recalculated upon receiving new user input. A convolution layer is utilized to transform <math alttext="M_{ref}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><msub id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">M</mi><mrow id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml"><mi id="S3.SS2.p3.8.m8.1.1.3.2" xref="S3.SS2.p3.8.m8.1.1.3.2.cmml">r</mi><mo id="S3.SS2.p3.8.m8.1.1.3.1" xref="S3.SS2.p3.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.8.m8.1.1.3.3" xref="S3.SS2.p3.8.m8.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p3.8.m8.1.1.3.1a" xref="S3.SS2.p3.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.8.m8.1.1.3.4" xref="S3.SS2.p3.8.m8.1.1.3.4.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑀</ci><apply id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3"><times id="S3.SS2.p3.8.m8.1.1.3.1.cmml" xref="S3.SS2.p3.8.m8.1.1.3.1"></times><ci id="S3.SS2.p3.8.m8.1.1.3.2.cmml" xref="S3.SS2.p3.8.m8.1.1.3.2">𝑟</ci><ci id="S3.SS2.p3.8.m8.1.1.3.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3.3">𝑒</ci><ci id="S3.SS2.p3.8.m8.1.1.3.4.cmml" xref="S3.SS2.p3.8.m8.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">M_{ref}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_M start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT</annotation></semantics></math> into an embedding <math alttext="E_{c}\in\mathbb{R}^{H\times W\times C_{1}}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><mrow id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><msub id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2.2" xref="S3.SS2.p3.9.m9.1.1.2.2.cmml">E</mi><mi id="S3.SS2.p3.9.m9.1.1.2.3" xref="S3.SS2.p3.9.m9.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS2.p3.9.m9.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml"><mi id="S3.SS2.p3.9.m9.1.1.3.2" xref="S3.SS2.p3.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.9.m9.1.1.3.3" xref="S3.SS2.p3.9.m9.1.1.3.3.cmml"><mi id="S3.SS2.p3.9.m9.1.1.3.3.2" xref="S3.SS2.p3.9.m9.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p3.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.9.m9.1.1.3.3.3" xref="S3.SS2.p3.9.m9.1.1.3.3.3.cmml">W</mi><mo id="S3.SS2.p3.9.m9.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.9.m9.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p3.9.m9.1.1.3.3.4" xref="S3.SS2.p3.9.m9.1.1.3.3.4.cmml"><mi id="S3.SS2.p3.9.m9.1.1.3.3.4.2" xref="S3.SS2.p3.9.m9.1.1.3.3.4.2.cmml">C</mi><mn id="S3.SS2.p3.9.m9.1.1.3.3.4.3" xref="S3.SS2.p3.9.m9.1.1.3.3.4.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><in id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1"></in><apply id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.2.1.cmml" xref="S3.SS2.p3.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.2.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2.2">𝐸</ci><ci id="S3.SS2.p3.9.m9.1.1.2.3.cmml" xref="S3.SS2.p3.9.m9.1.1.2.3">𝑐</ci></apply><apply id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.3.1.cmml" xref="S3.SS2.p3.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.3.2.cmml" xref="S3.SS2.p3.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.9.m9.1.1.3.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3"><times id="S3.SS2.p3.9.m9.1.1.3.3.1.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.1"></times><ci id="S3.SS2.p3.9.m9.1.1.3.3.2.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.9.m9.1.1.3.3.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.3">𝑊</ci><apply id="S3.SS2.p3.9.m9.1.1.3.3.4.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.3.3.4.1.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.4">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.3.3.4.2.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3.4.2">𝐶</ci><cn id="S3.SS2.p3.9.m9.1.1.3.3.4.3.cmml" type="integer" xref="S3.SS2.p3.9.m9.1.1.3.3.4.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">E_{c}\in\mathbb{R}^{H\times W\times C_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> , with each pixel value corresponding to a learnable <math alttext="C1" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><mrow id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">C</mi><mo id="S3.SS2.p3.10.m10.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.cmml">⁢</mo><mn id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1"><times id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1"></times><ci id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">𝐶</ci><cn id="S3.SS2.p3.10.m10.1.1.3.cmml" type="integer" xref="S3.SS2.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">C1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">italic_C 1</annotation></semantics></math>-dimensional vector. Then, we resize and combine <math alttext="E_{c}" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m11.1"><semantics id="S3.SS2.p3.11.m11.1a"><msub id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml"><mi id="S3.SS2.p3.11.m11.1.1.2" xref="S3.SS2.p3.11.m11.1.1.2.cmml">E</mi><mi id="S3.SS2.p3.11.m11.1.1.3" xref="S3.SS2.p3.11.m11.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><apply id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.1.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m11.1.1.2.cmml" xref="S3.SS2.p3.11.m11.1.1.2">𝐸</ci><ci id="S3.SS2.p3.11.m11.1.1.3.cmml" xref="S3.SS2.p3.11.m11.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">E_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m11.1d">italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> with the image feature <math alttext="F_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m12.1"><semantics id="S3.SS2.p3.12.m12.1a"><msub id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml"><mi id="S3.SS2.p3.12.m12.1.1.2" xref="S3.SS2.p3.12.m12.1.1.2.cmml">F</mi><mi id="S3.SS2.p3.12.m12.1.1.3" xref="S3.SS2.p3.12.m12.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><apply id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p3.12.m12.1.1.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2">𝐹</ci><ci id="S3.SS2.p3.12.m12.1.1.3.cmml" xref="S3.SS2.p3.12.m12.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">F_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m12.1d">italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> to get the conflict-involved feature <math alttext="{F_{v}}=resize(E_{c})+F_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m13.1"><semantics id="S3.SS2.p3.13.m13.1a"><mrow id="S3.SS2.p3.13.m13.1.1" xref="S3.SS2.p3.13.m13.1.1.cmml"><msub id="S3.SS2.p3.13.m13.1.1.3" xref="S3.SS2.p3.13.m13.1.1.3.cmml"><mi id="S3.SS2.p3.13.m13.1.1.3.2" xref="S3.SS2.p3.13.m13.1.1.3.2.cmml">F</mi><mi id="S3.SS2.p3.13.m13.1.1.3.3" xref="S3.SS2.p3.13.m13.1.1.3.3.cmml">v</mi></msub><mo id="S3.SS2.p3.13.m13.1.1.2" xref="S3.SS2.p3.13.m13.1.1.2.cmml">=</mo><mrow id="S3.SS2.p3.13.m13.1.1.1" xref="S3.SS2.p3.13.m13.1.1.1.cmml"><mrow id="S3.SS2.p3.13.m13.1.1.1.1" xref="S3.SS2.p3.13.m13.1.1.1.1.cmml"><mi id="S3.SS2.p3.13.m13.1.1.1.1.3" xref="S3.SS2.p3.13.m13.1.1.1.1.3.cmml">r</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1.4" xref="S3.SS2.p3.13.m13.1.1.1.1.4.cmml">e</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2a" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1.5" xref="S3.SS2.p3.13.m13.1.1.1.1.5.cmml">s</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2b" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1.6" xref="S3.SS2.p3.13.m13.1.1.1.1.6.cmml">i</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2c" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1.7" xref="S3.SS2.p3.13.m13.1.1.1.1.7.cmml">z</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2d" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.13.m13.1.1.1.1.8" xref="S3.SS2.p3.13.m13.1.1.1.1.8.cmml">e</mi><mo id="S3.SS2.p3.13.m13.1.1.1.1.2e" xref="S3.SS2.p3.13.m13.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.13.m13.1.1.1.1.1.1" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.13.m13.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.2.cmml">E</mi><mi id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p3.13.m13.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.13.m13.1.1.1.2" xref="S3.SS2.p3.13.m13.1.1.1.2.cmml">+</mo><msub id="S3.SS2.p3.13.m13.1.1.1.3" xref="S3.SS2.p3.13.m13.1.1.1.3.cmml"><mi id="S3.SS2.p3.13.m13.1.1.1.3.2" xref="S3.SS2.p3.13.m13.1.1.1.3.2.cmml">F</mi><mi id="S3.SS2.p3.13.m13.1.1.1.3.3" xref="S3.SS2.p3.13.m13.1.1.1.3.3.cmml">v</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.1b"><apply id="S3.SS2.p3.13.m13.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1"><eq id="S3.SS2.p3.13.m13.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1.2"></eq><apply id="S3.SS2.p3.13.m13.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.3.1.cmml" xref="S3.SS2.p3.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.3.2.cmml" xref="S3.SS2.p3.13.m13.1.1.3.2">𝐹</ci><ci id="S3.SS2.p3.13.m13.1.1.3.3.cmml" xref="S3.SS2.p3.13.m13.1.1.3.3">𝑣</ci></apply><apply id="S3.SS2.p3.13.m13.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1"><plus id="S3.SS2.p3.13.m13.1.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1.1.2"></plus><apply id="S3.SS2.p3.13.m13.1.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1"><times id="S3.SS2.p3.13.m13.1.1.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.2"></times><ci id="S3.SS2.p3.13.m13.1.1.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.3">𝑟</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.4.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.4">𝑒</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.5.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.5">𝑠</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.6.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.6">𝑖</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.7.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.7">𝑧</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.8.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.8">𝑒</ci><apply id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.13.m13.1.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.1.3.1.cmml" xref="S3.SS2.p3.13.m13.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.1.3.2.cmml" xref="S3.SS2.p3.13.m13.1.1.1.3.2">𝐹</ci><ci id="S3.SS2.p3.13.m13.1.1.1.3.3.cmml" xref="S3.SS2.p3.13.m13.1.1.1.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.1c">{F_{v}}=resize(E_{c})+F_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m13.1d">italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = italic_r italic_e italic_s italic_i italic_z italic_e ( italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + italic_F start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> for cross-round refinement. In addition, the previous prediction result is also sent to the decoder as a mask to participate in the calculation of masked multi-head attention in prompt self-attention block.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.5"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.5.1">Loss.</span>
We train ISCN with standard segmentation loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{ISCN}}=\mathcal{L}_{c\_ce}(C,\hat{C})+\mathcal{L}_{m\_bce}(%
M,\hat{M})+\mathcal{L}_{m\_dice}(M,\hat{M})," class="ltx_Math" display="block" id="S3.E6.m1.7"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.1.1.2.2" xref="S3.E6.m1.7.7.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.7.7.1.1.2.3" xref="S3.E6.m1.7.7.1.1.2.3a.cmml">ISCN</mtext></msub><mo id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.7.7.1.1.3" xref="S3.E6.m1.7.7.1.1.3.cmml"><mrow id="S3.E6.m1.7.7.1.1.3.2" xref="S3.E6.m1.7.7.1.1.3.2.cmml"><msub id="S3.E6.m1.7.7.1.1.3.2.2" xref="S3.E6.m1.7.7.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.1.1.3.2.2.2" xref="S3.E6.m1.7.7.1.1.3.2.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.7.7.1.1.3.2.2.3" xref="S3.E6.m1.7.7.1.1.3.2.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.3.2.2.3.2" xref="S3.E6.m1.7.7.1.1.3.2.2.3.2.cmml">c</mi><mo id="S3.E6.m1.7.7.1.1.3.2.2.3.1" xref="S3.E6.m1.7.7.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.2.2.3.3" mathvariant="normal" xref="S3.E6.m1.7.7.1.1.3.2.2.3.3.cmml">_</mi><mo id="S3.E6.m1.7.7.1.1.3.2.2.3.1a" xref="S3.E6.m1.7.7.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.2.2.3.4" xref="S3.E6.m1.7.7.1.1.3.2.2.3.4.cmml">c</mi><mo id="S3.E6.m1.7.7.1.1.3.2.2.3.1b" xref="S3.E6.m1.7.7.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.2.2.3.5" xref="S3.E6.m1.7.7.1.1.3.2.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E6.m1.7.7.1.1.3.2.1" xref="S3.E6.m1.7.7.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.3.2.3.2" xref="S3.E6.m1.7.7.1.1.3.2.3.1.cmml"><mo id="S3.E6.m1.7.7.1.1.3.2.3.2.1" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.2.3.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">C</mi><mo id="S3.E6.m1.7.7.1.1.3.2.3.2.2" xref="S3.E6.m1.7.7.1.1.3.2.3.1.cmml">,</mo><mover accent="true" id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mi id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml">C</mi><mo id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E6.m1.7.7.1.1.3.2.3.2.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.3.1" xref="S3.E6.m1.7.7.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.7.7.1.1.3.3" xref="S3.E6.m1.7.7.1.1.3.3.cmml"><msub id="S3.E6.m1.7.7.1.1.3.3.2" xref="S3.E6.m1.7.7.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.1.1.3.3.2.2" xref="S3.E6.m1.7.7.1.1.3.3.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.7.7.1.1.3.3.2.3" xref="S3.E6.m1.7.7.1.1.3.3.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.3.3.2.3.2" xref="S3.E6.m1.7.7.1.1.3.3.2.3.2.cmml">m</mi><mo id="S3.E6.m1.7.7.1.1.3.3.2.3.1" xref="S3.E6.m1.7.7.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.3.2.3.3" mathvariant="normal" xref="S3.E6.m1.7.7.1.1.3.3.2.3.3.cmml">_</mi><mo id="S3.E6.m1.7.7.1.1.3.3.2.3.1a" xref="S3.E6.m1.7.7.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.3.2.3.4" xref="S3.E6.m1.7.7.1.1.3.3.2.3.4.cmml">b</mi><mo id="S3.E6.m1.7.7.1.1.3.3.2.3.1b" xref="S3.E6.m1.7.7.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.3.2.3.5" xref="S3.E6.m1.7.7.1.1.3.3.2.3.5.cmml">c</mi><mo id="S3.E6.m1.7.7.1.1.3.3.2.3.1c" xref="S3.E6.m1.7.7.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.3.2.3.6" xref="S3.E6.m1.7.7.1.1.3.3.2.3.6.cmml">e</mi></mrow></msub><mo id="S3.E6.m1.7.7.1.1.3.3.1" xref="S3.E6.m1.7.7.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.3.3.3.2" xref="S3.E6.m1.7.7.1.1.3.3.3.1.cmml"><mo id="S3.E6.m1.7.7.1.1.3.3.3.2.1" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.3.3.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">M</mi><mo id="S3.E6.m1.7.7.1.1.3.3.3.2.2" xref="S3.E6.m1.7.7.1.1.3.3.3.1.cmml">,</mo><mover accent="true" id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml"><mi id="S3.E6.m1.4.4.2" xref="S3.E6.m1.4.4.2.cmml">M</mi><mo id="S3.E6.m1.4.4.1" xref="S3.E6.m1.4.4.1.cmml">^</mo></mover><mo id="S3.E6.m1.7.7.1.1.3.3.3.2.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.3.1a" xref="S3.E6.m1.7.7.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.7.7.1.1.3.4" xref="S3.E6.m1.7.7.1.1.3.4.cmml"><msub id="S3.E6.m1.7.7.1.1.3.4.2" xref="S3.E6.m1.7.7.1.1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.1.1.3.4.2.2" xref="S3.E6.m1.7.7.1.1.3.4.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.7.7.1.1.3.4.2.3" xref="S3.E6.m1.7.7.1.1.3.4.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.2" xref="S3.E6.m1.7.7.1.1.3.4.2.3.2.cmml">m</mi><mo id="S3.E6.m1.7.7.1.1.3.4.2.3.1" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.3" mathvariant="normal" xref="S3.E6.m1.7.7.1.1.3.4.2.3.3.cmml">_</mi><mo id="S3.E6.m1.7.7.1.1.3.4.2.3.1a" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.4" xref="S3.E6.m1.7.7.1.1.3.4.2.3.4.cmml">d</mi><mo id="S3.E6.m1.7.7.1.1.3.4.2.3.1b" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.5" xref="S3.E6.m1.7.7.1.1.3.4.2.3.5.cmml">i</mi><mo id="S3.E6.m1.7.7.1.1.3.4.2.3.1c" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.6" xref="S3.E6.m1.7.7.1.1.3.4.2.3.6.cmml">c</mi><mo id="S3.E6.m1.7.7.1.1.3.4.2.3.1d" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.3.4.2.3.7" xref="S3.E6.m1.7.7.1.1.3.4.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.E6.m1.7.7.1.1.3.4.1" xref="S3.E6.m1.7.7.1.1.3.4.1.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.3.4.3.2" xref="S3.E6.m1.7.7.1.1.3.4.3.1.cmml"><mo id="S3.E6.m1.7.7.1.1.3.4.3.2.1" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.4.3.1.cmml">(</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">M</mi><mo id="S3.E6.m1.7.7.1.1.3.4.3.2.2" xref="S3.E6.m1.7.7.1.1.3.4.3.1.cmml">,</mo><mover accent="true" id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><mi id="S3.E6.m1.6.6.2" xref="S3.E6.m1.6.6.2.cmml">M</mi><mo id="S3.E6.m1.6.6.1" xref="S3.E6.m1.6.6.1.cmml">^</mo></mover><mo id="S3.E6.m1.7.7.1.1.3.4.3.2.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.2" xref="S3.E6.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1"></eq><apply id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2">ℒ</ci><ci id="S3.E6.m1.7.7.1.1.2.3a.cmml" xref="S3.E6.m1.7.7.1.1.2.3"><mtext id="S3.E6.m1.7.7.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.1.1.2.3">ISCN</mtext></ci></apply><apply id="S3.E6.m1.7.7.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.3"><plus id="S3.E6.m1.7.7.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1"></plus><apply id="S3.E6.m1.7.7.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2"><times id="S3.E6.m1.7.7.1.1.3.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.2.1"></times><apply id="S3.E6.m1.7.7.1.1.3.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.2">ℒ</ci><apply id="S3.E6.m1.7.7.1.1.3.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3"><times id="S3.E6.m1.7.7.1.1.3.2.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.3.2.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3.2">𝑐</ci><ci id="S3.E6.m1.7.7.1.1.3.2.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3.3">_</ci><ci id="S3.E6.m1.7.7.1.1.3.2.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3.4">𝑐</ci><ci id="S3.E6.m1.7.7.1.1.3.2.2.3.5.cmml" xref="S3.E6.m1.7.7.1.1.3.2.2.3.5">𝑒</ci></apply></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.3.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.2.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐶</ci><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><ci id="S3.E6.m1.2.2.1.cmml" xref="S3.E6.m1.2.2.1">^</ci><ci id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2">𝐶</ci></apply></interval></apply><apply id="S3.E6.m1.7.7.1.1.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.3"><times id="S3.E6.m1.7.7.1.1.3.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.3.1"></times><apply id="S3.E6.m1.7.7.1.1.3.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.3.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.3.3.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.2">ℒ</ci><apply id="S3.E6.m1.7.7.1.1.3.3.2.3.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3"><times id="S3.E6.m1.7.7.1.1.3.3.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.3.3.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.E6.m1.7.7.1.1.3.3.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.3">_</ci><ci id="S3.E6.m1.7.7.1.1.3.3.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.4">𝑏</ci><ci id="S3.E6.m1.7.7.1.1.3.3.2.3.5.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.5">𝑐</ci><ci id="S3.E6.m1.7.7.1.1.3.3.2.3.6.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2.3.6">𝑒</ci></apply></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.3.3.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.3.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑀</ci><apply id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4"><ci id="S3.E6.m1.4.4.1.cmml" xref="S3.E6.m1.4.4.1">^</ci><ci id="S3.E6.m1.4.4.2.cmml" xref="S3.E6.m1.4.4.2">𝑀</ci></apply></interval></apply><apply id="S3.E6.m1.7.7.1.1.3.4.cmml" xref="S3.E6.m1.7.7.1.1.3.4"><times id="S3.E6.m1.7.7.1.1.3.4.1.cmml" xref="S3.E6.m1.7.7.1.1.3.4.1"></times><apply id="S3.E6.m1.7.7.1.1.3.4.2.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.4.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.3.4.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.2">ℒ</ci><apply id="S3.E6.m1.7.7.1.1.3.4.2.3.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3"><times id="S3.E6.m1.7.7.1.1.3.4.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.2">𝑚</ci><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.3">_</ci><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.4">𝑑</ci><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.5.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.5">𝑖</ci><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.6.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.6">𝑐</ci><ci id="S3.E6.m1.7.7.1.1.3.4.2.3.7.cmml" xref="S3.E6.m1.7.7.1.1.3.4.2.3.7">𝑒</ci></apply></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.3.4.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.4.3.2"><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝑀</ci><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><ci id="S3.E6.m1.6.6.1.cmml" xref="S3.E6.m1.6.6.1">^</ci><ci id="S3.E6.m1.6.6.2.cmml" xref="S3.E6.m1.6.6.2">𝑀</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\mathcal{L}_{\text{ISCN}}=\mathcal{L}_{c\_ce}(C,\hat{C})+\mathcal{L}_{m\_bce}(%
M,\hat{M})+\mathcal{L}_{m\_dice}(M,\hat{M}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">caligraphic_L start_POSTSUBSCRIPT ISCN end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_c _ italic_c italic_e end_POSTSUBSCRIPT ( italic_C , over^ start_ARG italic_C end_ARG ) + caligraphic_L start_POSTSUBSCRIPT italic_m _ italic_b italic_c italic_e end_POSTSUBSCRIPT ( italic_M , over^ start_ARG italic_M end_ARG ) + caligraphic_L start_POSTSUBSCRIPT italic_m _ italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT ( italic_M , over^ start_ARG italic_M end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.4">where <math alttext="\hat{C},\hat{M}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.2"><semantics id="S3.SS2.p4.1.m1.2a"><mrow id="S3.SS2.p4.1.m1.2.3.2" xref="S3.SS2.p4.1.m1.2.3.1.cmml"><mover accent="true" id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">C</mi><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">^</mo></mover><mo id="S3.SS2.p4.1.m1.2.3.2.1" xref="S3.SS2.p4.1.m1.2.3.1.cmml">,</mo><mover accent="true" id="S3.SS2.p4.1.m1.2.2" xref="S3.SS2.p4.1.m1.2.2.cmml"><mi id="S3.SS2.p4.1.m1.2.2.2" xref="S3.SS2.p4.1.m1.2.2.2.cmml">M</mi><mo id="S3.SS2.p4.1.m1.2.2.1" xref="S3.SS2.p4.1.m1.2.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.2b"><list id="S3.SS2.p4.1.m1.2.3.1.cmml" xref="S3.SS2.p4.1.m1.2.3.2"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><ci id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1">^</ci><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝐶</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2"><ci id="S3.SS2.p4.1.m1.2.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1">^</ci><ci id="S3.SS2.p4.1.m1.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.2">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.2c">\hat{C},\hat{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.2d">over^ start_ARG italic_C end_ARG , over^ start_ARG italic_M end_ARG</annotation></semantics></math> is GT category and mask respectively. <math alttext="\mathcal{L}_{c\_ce}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">c</mi><mo id="S3.SS2.p4.2.m2.1.1.3.1" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3" mathvariant="normal" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml">_</mi><mo id="S3.SS2.p4.2.m2.1.1.3.1a" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.3.4" xref="S3.SS2.p4.2.m2.1.1.3.4.cmml">c</mi><mo id="S3.SS2.p4.2.m2.1.1.3.1b" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.3.5" xref="S3.SS2.p4.2.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">ℒ</ci><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><times id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.1"></times><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3">_</ci><ci id="S3.SS2.p4.2.m2.1.1.3.4.cmml" xref="S3.SS2.p4.2.m2.1.1.3.4">𝑐</ci><ci id="S3.SS2.p4.2.m2.1.1.3.5.cmml" xref="S3.SS2.p4.2.m2.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathcal{L}_{c\_ce}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_c _ italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{L}_{m\_bce}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">m</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.3" mathvariant="normal" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">_</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1a" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.4" xref="S3.SS2.p4.3.m3.1.1.3.4.cmml">b</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1b" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.5" xref="S3.SS2.p4.3.m3.1.1.3.5.cmml">c</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1c" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.3.m3.1.1.3.6" xref="S3.SS2.p4.3.m3.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">ℒ</ci><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><times id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3.1"></times><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">𝑚</ci><ci id="S3.SS2.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3.3">_</ci><ci id="S3.SS2.p4.3.m3.1.1.3.4.cmml" xref="S3.SS2.p4.3.m3.1.1.3.4">𝑏</ci><ci id="S3.SS2.p4.3.m3.1.1.3.5.cmml" xref="S3.SS2.p4.3.m3.1.1.3.5">𝑐</ci><ci id="S3.SS2.p4.3.m3.1.1.3.6.cmml" xref="S3.SS2.p4.3.m3.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\mathcal{L}_{m\_bce}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_m _ italic_b italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathcal{L}_{m\_dice}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.2" xref="S3.SS2.p4.4.m4.1.1.3.2.cmml">m</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.1.1.3.3" mathvariant="normal" xref="S3.SS2.p4.4.m4.1.1.3.3.cmml">_</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1a" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.1.1.3.4" xref="S3.SS2.p4.4.m4.1.1.3.4.cmml">d</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1b" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.1.1.3.5" xref="S3.SS2.p4.4.m4.1.1.3.5.cmml">i</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1c" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.1.1.3.6" xref="S3.SS2.p4.4.m4.1.1.3.6.cmml">c</mi><mo id="S3.SS2.p4.4.m4.1.1.3.1d" xref="S3.SS2.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.4.m4.1.1.3.7" xref="S3.SS2.p4.4.m4.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">ℒ</ci><apply id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><times id="S3.SS2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3.1"></times><ci id="S3.SS2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2">𝑚</ci><ci id="S3.SS2.p4.4.m4.1.1.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3">_</ci><ci id="S3.SS2.p4.4.m4.1.1.3.4.cmml" xref="S3.SS2.p4.4.m4.1.1.3.4">𝑑</ci><ci id="S3.SS2.p4.4.m4.1.1.3.5.cmml" xref="S3.SS2.p4.4.m4.1.1.3.5">𝑖</ci><ci id="S3.SS2.p4.4.m4.1.1.3.6.cmml" xref="S3.SS2.p4.4.m4.1.1.3.6">𝑐</ci><ci id="S3.SS2.p4.4.m4.1.1.3.7.cmml" xref="S3.SS2.p4.4.m4.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\mathcal{L}_{m\_dice}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_m _ italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math> denote cross-entropy, binary cross-entropy, and dice loss, with weights 0.1:1:1.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Matting Refinement Network (MRN)</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">MRN aims to refine the mask prediction from ISCN to obtain accurate alpha matte predictions. As ISCN has already given a relatively good instance mask as a good beginning, the task difficulty for MRN is largely reduced.
Here, we design a simple dual-branch network as our MRN, to capture fine-grained local details while simultaneously considering global instance-level semantics, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.F2" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. Our insight is that images for multi-instance matting tasks often contain complex human interaction and background, so a global encoder is needed to better capture the overall structure and background information, while a local encoder can focus more on details. Then, a subsequent progressive feature fusion should be built to fuse the features and decode them to final matte.
Taking those things in mind, we design a simple network containing a global encoder, a local encoder, and a progressive feature fusion module, as shown in  <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S3.F2" title="In 3 Method ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. Specifically, we choose a CNN as the local encoder, as it can effectively exploit local features, and we choose a transformer-based encoder as our global encoder, as the self-attention operation can build strong non-local interactions in the images to form a better global instance-level understanding. For progressive fusion, we start from the latent feature from the global branch, as it contains rich global instance-level representation. We then fuse it with the feature from local branch in a progressive manner (from low to high resolution), we also utilize PRM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib38" title="">38</a>]</cite> to further refine the result.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">Loss.</span> Since most pixels in the coarse mask are already predicted correctly, only a few “hard” pixels need significant refinement. To make the network pay more attention to those “hard” pixels, we adopt a simplified hard-sample mining objective function <math alttext="\mathcal{L}_{\text{MRN}}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3a.cmml">MRN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS3.p2.1.m1.1.1.3a.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><mtext id="S3.SS3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.1.m1.1.1.3">MRN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{L}_{\text{MRN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT MRN end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{MRN}}=\frac{1}{|C|}\sum_{i\in C}\left|\alpha_{p}^{i}-\alpha%
_{g}^{i}\right|+\lambda\frac{1}{|H|}\sum_{j\in H}\left|\alpha_{p}^{j}-\alpha_{%
g}^{j}\right|," class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.4" xref="S3.E7.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.4.2" xref="S3.E7.m1.3.3.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E7.m1.3.3.1.1.4.3" xref="S3.E7.m1.3.3.1.1.4.3a.cmml">MRN</mtext></msub><mo id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mfrac id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mn id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">1</mn><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">C</mi><mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.cmml"><munder id="S3.E7.m1.3.3.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E7.m1.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.E7.m1.3.3.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.3.cmml">C</mi></mrow></munder><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">α</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">p</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">g</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">+</mo><mrow id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">λ</mi><mo id="S3.E7.m1.3.3.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.cmml">⁢</mo><mfrac id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mn id="S3.E7.m1.2.2.3" xref="S3.E7.m1.2.2.3.cmml">1</mn><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.2.cmml"><mo id="S3.E7.m1.2.2.1.3.1" stretchy="false" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">H</mi><mo id="S3.E7.m1.2.2.1.3.2" stretchy="false" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E7.m1.3.3.1.1.2.2.2a" xref="S3.E7.m1.3.3.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.1" xref="S3.E7.m1.3.3.1.1.2.2.1.cmml"><munder id="S3.E7.m1.3.3.1.1.2.2.1.2" xref="S3.E7.m1.3.3.1.1.2.2.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.2.2.1.2.2" movablelimits="false" rspace="0em" xref="S3.E7.m1.3.3.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.1.2.3" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.1.2.3.2" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.3.3.1.1.2.2.1.2.3.1" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.1.cmml">∈</mo><mi id="S3.E7.m1.3.3.1.1.2.2.1.2.3.3" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.3.cmml">H</mi></mrow></munder><mrow id="S3.E7.m1.3.3.1.1.2.2.1.1.1" xref="S3.E7.m1.3.3.1.1.2.2.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.2.2.1.1.1.2" xref="S3.E7.m1.3.3.1.1.2.2.1.1.2.1.cmml">|</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.cmml"><msubsup id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.cmml">α</mi><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.cmml">p</mi><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.3.cmml">j</mi></msubsup><mo id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.2.cmml">α</mi><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.3.cmml">g</mi><mi id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml">j</mi></msubsup></mrow><mo id="S3.E7.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E7.m1.3.3.1.1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"></eq><apply id="S3.E7.m1.3.3.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.4.1.cmml" xref="S3.E7.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.4.2.cmml" xref="S3.E7.m1.3.3.1.1.4.2">ℒ</ci><ci id="S3.E7.m1.3.3.1.1.4.3a.cmml" xref="S3.E7.m1.3.3.1.1.4.3"><mtext id="S3.E7.m1.3.3.1.1.4.3.cmml" mathsize="70%" xref="S3.E7.m1.3.3.1.1.4.3">MRN</mtext></ci></apply><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><plus id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3"></plus><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><divide id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1"></divide><cn id="S3.E7.m1.1.1.3.cmml" type="integer" xref="S3.E7.m1.1.1.3">1</cn><apply id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.3"><abs id="S3.E7.m1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.3.1"></abs><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝐶</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3"><in id="S3.E7.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.1"></in><ci id="S3.E7.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><abs id="S3.E7.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2"></abs><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">𝛼</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝑔</ci></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2"><times id="S3.E7.m1.3.3.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2"></times><ci id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3">𝜆</ci><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2"></divide><cn id="S3.E7.m1.2.2.3.cmml" type="integer" xref="S3.E7.m1.2.2.3">1</cn><apply id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.3"><abs id="S3.E7.m1.2.2.1.2.1.cmml" xref="S3.E7.m1.2.2.1.3.1"></abs><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">𝐻</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1"><apply id="S3.E7.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.2.2.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.2.2.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3"><in id="S3.E7.m1.3.3.1.1.2.2.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.1"></in><ci id="S3.E7.m1.3.3.1.1.2.2.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.2">𝑗</ci><ci id="S3.E7.m1.3.3.1.1.2.2.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.2.3.3">𝐻</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1"><abs id="S3.E7.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.2"></abs><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1"><minus id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.1"></minus><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2">𝛼</ci><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.2">𝛼</ci><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.2.3">𝑔</ci></apply><ci id="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\mathcal{L}_{\text{MRN}}=\frac{1}{|C|}\sum_{i\in C}\left|\alpha_{p}^{i}-\alpha%
_{g}^{i}\right|+\lambda\frac{1}{|H|}\sum_{j\in H}\left|\alpha_{p}^{j}-\alpha_{%
g}^{j}\right|,</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">caligraphic_L start_POSTSUBSCRIPT MRN end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_C | end_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ italic_C end_POSTSUBSCRIPT | italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT - italic_α start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT | + italic_λ divide start_ARG 1 end_ARG start_ARG | italic_H | end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ italic_H end_POSTSUBSCRIPT | italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT - italic_α start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT | ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.4">where <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m1.1"><semantics id="S3.SS3.p2.2.m1.1a"><mi id="S3.SS3.p2.2.m1.1.1" xref="S3.SS3.p2.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.1b"><ci id="S3.SS3.p2.2.m1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m1.1d">italic_C</annotation></semantics></math> represents the whole pixel-set and <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m2.1"><semantics id="S3.SS3.p2.3.m2.1a"><mi id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><ci id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m2.1d">italic_H</annotation></semantics></math> denotes “hard” pixel-set whose error to corresponding ground truth ranks in the top 30% of the matte. <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m3.1"><semantics id="S3.SS3.p2.4.m3.1a"><mi id="S3.SS3.p2.4.m3.1.1" xref="S3.SS3.p2.4.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m3.1b"><ci id="S3.SS3.p2.4.m3.1.1.cmml" xref="S3.SS3.p2.4.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m3.1d">italic_λ</annotation></semantics></math> denotes the weight that emphasizes the hard samples and is set as 1 by default.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>The SMPMat Dataset</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We propose a synthetic multi-person matting dataset called SMPMat to facilitate the research of instance matting task. To our knowledge, the existing multi-instance dataset from natural images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite> suffers from low data scale as well as diversity. Specifically, HIM2K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite> is the mainly used dataset that focuses on instance-level matting under multi-person scenarios. As can be observed in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.T2" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, the HIM2K dataset only contains a limited scale of data that is collected from natural scenes (i.e., only contains 320 natural images with 930 instances in total), making it only serve as a validation set.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">In order to obtain a large amount of matting data that contains multi-instance scenes, previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite> adopt a simple synthesis strategy to iteratively add portrait foregrounds to no-portrait background. Due to the randomness of the adding positions and the lack of instance-scene prior consideration, there is often a large gap between the synthetic images and natural images, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.F3" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. To fill this gap, we design a new synthetic data generation pipeline that can generate much more diverse and realistic samples, and build a new large-scale dataset SMPMat, which consists of 40,000 realistic multi-instance images with high-quality matte GT.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Comparison with previous multi-instance matting dataset and ours.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.4">
<tr class="ltx_tr" id="S4.T2.4.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.1" rowspan="2">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="S4.T2.4.1.1.1">Datasets</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.2" rowspan="2"><span class="ltx_text" id="S4.T2.4.1.2.1">Image Number</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.1.3" rowspan="2"><span class="ltx_text" id="S4.T2.4.1.3.1">Instance Number</span></td>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.T2.4.1.4">Annotation</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1">Matte</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.2">Text description</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.3.1">HIM2K(nature)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.3.2">320</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.3.3">830</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.3.4">✓</td>
<td class="ltx_td ltx_border_t" id="S4.T2.4.3.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.4.1">HIM2K(synthetic)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.4.2">1,680</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.4.3">5,884</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.4.4">✓</td>
<td class="ltx_td" id="S4.T2.4.4.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.5.1">SMPMat</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.5.2">40,000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.5.3">142,357</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.5.4">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.5">✓</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.6.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td class="ltx_td" id="S4.T2.4.6.2"></td>
<td class="ltx_td" id="S4.T2.4.6.3"></td>
<td class="ltx_td" id="S4.T2.4.6.4"></td>
<td class="ltx_td" id="S4.T2.4.6.5"></td>
</tr>
</table>
</figure>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="265" id="S4.F3.sf1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F3.sf1.3.2" style="font-size:90%;">Existing synthetic method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="277" id="S4.F3.sf2.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F3.sf2.3.2" style="font-size:90%;">Our method</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Visual comparison of synthetic datasets.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">The synthetic data generation pipeline.</span>
Inspired by work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib33" title="">33</a>]</cite> using diffusion models for image synthesis, we build a new synthetic data generation pipeline that can synthesize an infinite amount of realistic and diverse images with high-quality matte ground truth. Our insight is that the latent feature within the well-trained diffusion process (e.g., Stable Diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib27" title="">27</a>]</cite>) contains rich semantic contexts of the corresponding generated image, so ideally, the matte ground truth of the generated image can be well interpreted from such latent feature. Thus, we build an interpreter to derive the matte ground truth from the latent feature of the diffusion process. Based on the good performance of the recent text-to-image diffusion models, all we need to do is just train the interpreter for this interpretation task, using a small amount of annotated real data. After that, we can synthesize an infinite amount of images with high diversity based on the well-trained text-to-image diffusion models (e.g., Stable Diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib27" title="">27</a>]</cite>), and simultaneously obtain their matte ground truth by our trained interpreter.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.12">Specifically, our method is illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.F4.fig1" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>. During training, given a real image <math alttext="I" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><mi id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">italic_I</annotation></semantics></math> and the paired text description <math alttext="H" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">italic_H</annotation></semantics></math>, we feed them into a pre-trained text-to-image diffusion model (i.e., Stable Diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib27" title="">27</a>]</cite> in our implementation) and acquire the multi-scale latent feature map <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.p4.3.m3.1"><semantics id="S4.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><ci id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.m3.1d">caligraphic_F</annotation></semantics></math> as well as the text-visual cross-attention map <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S4.p4.4.m4.1"><semantics id="S4.p4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><ci id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m4.1d">caligraphic_M</annotation></semantics></math> in it (i.e., the denoising U-Net).
We concat those intermediate representations <math alttext="\hat{\mathcal{F}}=Concat(\left[\mathcal{F},\mathcal{M}\right])" class="ltx_Math" display="inline" id="S4.p4.5.m5.3"><semantics id="S4.p4.5.m5.3a"><mrow id="S4.p4.5.m5.3.3" xref="S4.p4.5.m5.3.3.cmml"><mover accent="true" id="S4.p4.5.m5.3.3.3" xref="S4.p4.5.m5.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.5.m5.3.3.3.2" xref="S4.p4.5.m5.3.3.3.2.cmml">ℱ</mi><mo id="S4.p4.5.m5.3.3.3.1" xref="S4.p4.5.m5.3.3.3.1.cmml">^</mo></mover><mo id="S4.p4.5.m5.3.3.2" xref="S4.p4.5.m5.3.3.2.cmml">=</mo><mrow id="S4.p4.5.m5.3.3.1" xref="S4.p4.5.m5.3.3.1.cmml"><mi id="S4.p4.5.m5.3.3.1.3" xref="S4.p4.5.m5.3.3.1.3.cmml">C</mi><mo id="S4.p4.5.m5.3.3.1.2" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mi id="S4.p4.5.m5.3.3.1.4" xref="S4.p4.5.m5.3.3.1.4.cmml">o</mi><mo id="S4.p4.5.m5.3.3.1.2a" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mi id="S4.p4.5.m5.3.3.1.5" xref="S4.p4.5.m5.3.3.1.5.cmml">n</mi><mo id="S4.p4.5.m5.3.3.1.2b" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mi id="S4.p4.5.m5.3.3.1.6" xref="S4.p4.5.m5.3.3.1.6.cmml">c</mi><mo id="S4.p4.5.m5.3.3.1.2c" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mi id="S4.p4.5.m5.3.3.1.7" xref="S4.p4.5.m5.3.3.1.7.cmml">a</mi><mo id="S4.p4.5.m5.3.3.1.2d" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mi id="S4.p4.5.m5.3.3.1.8" xref="S4.p4.5.m5.3.3.1.8.cmml">t</mi><mo id="S4.p4.5.m5.3.3.1.2e" xref="S4.p4.5.m5.3.3.1.2.cmml">⁢</mo><mrow id="S4.p4.5.m5.3.3.1.1.1" xref="S4.p4.5.m5.3.3.1.cmml"><mo id="S4.p4.5.m5.3.3.1.1.1.2" stretchy="false" xref="S4.p4.5.m5.3.3.1.cmml">(</mo><mrow id="S4.p4.5.m5.3.3.1.1.1.1.2" xref="S4.p4.5.m5.3.3.1.1.1.1.1.cmml"><mo id="S4.p4.5.m5.3.3.1.1.1.1.2.1" xref="S4.p4.5.m5.3.3.1.1.1.1.1.cmml">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml">ℱ</mi><mo id="S4.p4.5.m5.3.3.1.1.1.1.2.2" xref="S4.p4.5.m5.3.3.1.1.1.1.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.p4.5.m5.2.2" xref="S4.p4.5.m5.2.2.cmml">ℳ</mi><mo id="S4.p4.5.m5.3.3.1.1.1.1.2.3" xref="S4.p4.5.m5.3.3.1.1.1.1.1.cmml">]</mo></mrow><mo id="S4.p4.5.m5.3.3.1.1.1.3" stretchy="false" xref="S4.p4.5.m5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.3b"><apply id="S4.p4.5.m5.3.3.cmml" xref="S4.p4.5.m5.3.3"><eq id="S4.p4.5.m5.3.3.2.cmml" xref="S4.p4.5.m5.3.3.2"></eq><apply id="S4.p4.5.m5.3.3.3.cmml" xref="S4.p4.5.m5.3.3.3"><ci id="S4.p4.5.m5.3.3.3.1.cmml" xref="S4.p4.5.m5.3.3.3.1">^</ci><ci id="S4.p4.5.m5.3.3.3.2.cmml" xref="S4.p4.5.m5.3.3.3.2">ℱ</ci></apply><apply id="S4.p4.5.m5.3.3.1.cmml" xref="S4.p4.5.m5.3.3.1"><times id="S4.p4.5.m5.3.3.1.2.cmml" xref="S4.p4.5.m5.3.3.1.2"></times><ci id="S4.p4.5.m5.3.3.1.3.cmml" xref="S4.p4.5.m5.3.3.1.3">𝐶</ci><ci id="S4.p4.5.m5.3.3.1.4.cmml" xref="S4.p4.5.m5.3.3.1.4">𝑜</ci><ci id="S4.p4.5.m5.3.3.1.5.cmml" xref="S4.p4.5.m5.3.3.1.5">𝑛</ci><ci id="S4.p4.5.m5.3.3.1.6.cmml" xref="S4.p4.5.m5.3.3.1.6">𝑐</ci><ci id="S4.p4.5.m5.3.3.1.7.cmml" xref="S4.p4.5.m5.3.3.1.7">𝑎</ci><ci id="S4.p4.5.m5.3.3.1.8.cmml" xref="S4.p4.5.m5.3.3.1.8">𝑡</ci><interval closure="closed" id="S4.p4.5.m5.3.3.1.1.1.1.1.cmml" xref="S4.p4.5.m5.3.3.1.1.1.1.2"><ci id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1">ℱ</ci><ci id="S4.p4.5.m5.2.2.cmml" xref="S4.p4.5.m5.2.2">ℳ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.3c">\hat{\mathcal{F}}=Concat(\left[\mathcal{F},\mathcal{M}\right])</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m5.3d">over^ start_ARG caligraphic_F end_ARG = italic_C italic_o italic_n italic_c italic_a italic_t ( [ caligraphic_F , caligraphic_M ] )</annotation></semantics></math> and send <math alttext="\hat{\mathcal{F}}" class="ltx_Math" display="inline" id="S4.p4.6.m6.1"><semantics id="S4.p4.6.m6.1a"><mover accent="true" id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.6.m6.1.1.2" xref="S4.p4.6.m6.1.1.2.cmml">ℱ</mi><mo id="S4.p4.6.m6.1.1.1" xref="S4.p4.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><apply id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1"><ci id="S4.p4.6.m6.1.1.1.cmml" xref="S4.p4.6.m6.1.1.1">^</ci><ci id="S4.p4.6.m6.1.1.2.cmml" xref="S4.p4.6.m6.1.1.2">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">\hat{\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m6.1d">over^ start_ARG caligraphic_F end_ARG</annotation></semantics></math> to our interpreter and interpret them into GT matte. For the detailed architecture of the interpreter, any decoder for dense prediction task can be used, and here we adopt Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib4" title="">4</a>]</cite>, which contains a transformer decoder and a pixel decoder. Given <math alttext="\hat{\mathcal{F}}" class="ltx_Math" display="inline" id="S4.p4.7.m7.1"><semantics id="S4.p4.7.m7.1a"><mover accent="true" id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.7.m7.1.1.2" xref="S4.p4.7.m7.1.1.2.cmml">ℱ</mi><mo id="S4.p4.7.m7.1.1.1" xref="S4.p4.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><ci id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1.1">^</ci><ci id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1.2">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">\hat{\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.7.m7.1d">over^ start_ARG caligraphic_F end_ARG</annotation></semantics></math>, and <math alttext="N" class="ltx_Math" display="inline" id="S4.p4.8.m8.1"><semantics id="S4.p4.8.m8.1a"><mi id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.1b"><ci id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.p4.8.m8.1d">italic_N</annotation></semantics></math> learnable queues <math alttext="\{Q_{0},Q_{1}...Q_{T}\}" class="ltx_Math" display="inline" id="S4.p4.9.m9.2"><semantics id="S4.p4.9.m9.2a"><mrow id="S4.p4.9.m9.2.2.2" xref="S4.p4.9.m9.2.2.3.cmml"><mo id="S4.p4.9.m9.2.2.2.3" stretchy="false" xref="S4.p4.9.m9.2.2.3.cmml">{</mo><msub id="S4.p4.9.m9.1.1.1.1" xref="S4.p4.9.m9.1.1.1.1.cmml"><mi id="S4.p4.9.m9.1.1.1.1.2" xref="S4.p4.9.m9.1.1.1.1.2.cmml">Q</mi><mn id="S4.p4.9.m9.1.1.1.1.3" xref="S4.p4.9.m9.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.p4.9.m9.2.2.2.4" xref="S4.p4.9.m9.2.2.3.cmml">,</mo><mrow id="S4.p4.9.m9.2.2.2.2" xref="S4.p4.9.m9.2.2.2.2.cmml"><msub id="S4.p4.9.m9.2.2.2.2.2" xref="S4.p4.9.m9.2.2.2.2.2.cmml"><mi id="S4.p4.9.m9.2.2.2.2.2.2" xref="S4.p4.9.m9.2.2.2.2.2.2.cmml">Q</mi><mn id="S4.p4.9.m9.2.2.2.2.2.3" xref="S4.p4.9.m9.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S4.p4.9.m9.2.2.2.2.1" xref="S4.p4.9.m9.2.2.2.2.1.cmml">⁢</mo><mi id="S4.p4.9.m9.2.2.2.2.3" mathvariant="normal" xref="S4.p4.9.m9.2.2.2.2.3.cmml">…</mi><mo id="S4.p4.9.m9.2.2.2.2.1a" xref="S4.p4.9.m9.2.2.2.2.1.cmml">⁢</mo><msub id="S4.p4.9.m9.2.2.2.2.4" xref="S4.p4.9.m9.2.2.2.2.4.cmml"><mi id="S4.p4.9.m9.2.2.2.2.4.2" xref="S4.p4.9.m9.2.2.2.2.4.2.cmml">Q</mi><mi id="S4.p4.9.m9.2.2.2.2.4.3" xref="S4.p4.9.m9.2.2.2.2.4.3.cmml">T</mi></msub></mrow><mo id="S4.p4.9.m9.2.2.2.5" stretchy="false" xref="S4.p4.9.m9.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.9.m9.2b"><set id="S4.p4.9.m9.2.2.3.cmml" xref="S4.p4.9.m9.2.2.2"><apply id="S4.p4.9.m9.1.1.1.1.cmml" xref="S4.p4.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.9.m9.1.1.1.1.1.cmml" xref="S4.p4.9.m9.1.1.1.1">subscript</csymbol><ci id="S4.p4.9.m9.1.1.1.1.2.cmml" xref="S4.p4.9.m9.1.1.1.1.2">𝑄</ci><cn id="S4.p4.9.m9.1.1.1.1.3.cmml" type="integer" xref="S4.p4.9.m9.1.1.1.1.3">0</cn></apply><apply id="S4.p4.9.m9.2.2.2.2.cmml" xref="S4.p4.9.m9.2.2.2.2"><times id="S4.p4.9.m9.2.2.2.2.1.cmml" xref="S4.p4.9.m9.2.2.2.2.1"></times><apply id="S4.p4.9.m9.2.2.2.2.2.cmml" xref="S4.p4.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p4.9.m9.2.2.2.2.2.1.cmml" xref="S4.p4.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S4.p4.9.m9.2.2.2.2.2.2.cmml" xref="S4.p4.9.m9.2.2.2.2.2.2">𝑄</ci><cn id="S4.p4.9.m9.2.2.2.2.2.3.cmml" type="integer" xref="S4.p4.9.m9.2.2.2.2.2.3">1</cn></apply><ci id="S4.p4.9.m9.2.2.2.2.3.cmml" xref="S4.p4.9.m9.2.2.2.2.3">…</ci><apply id="S4.p4.9.m9.2.2.2.2.4.cmml" xref="S4.p4.9.m9.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.p4.9.m9.2.2.2.2.4.1.cmml" xref="S4.p4.9.m9.2.2.2.2.4">subscript</csymbol><ci id="S4.p4.9.m9.2.2.2.2.4.2.cmml" xref="S4.p4.9.m9.2.2.2.2.4.2">𝑄</ci><ci id="S4.p4.9.m9.2.2.2.2.4.3.cmml" xref="S4.p4.9.m9.2.2.2.2.4.3">𝑇</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m9.2c">\{Q_{0},Q_{1}...Q_{T}\}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.9.m9.2d">{ italic_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_Q start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT }</annotation></semantics></math> as input, it outputs <math alttext="N" class="ltx_Math" display="inline" id="S4.p4.10.m10.1"><semantics id="S4.p4.10.m10.1a"><mi id="S4.p4.10.m10.1.1" xref="S4.p4.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p4.10.m10.1b"><ci id="S4.p4.10.m10.1.1.cmml" xref="S4.p4.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m10.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.p4.10.m10.1d">italic_N</annotation></semantics></math> foreground alpha matte <math alttext="A" class="ltx_Math" display="inline" id="S4.p4.11.m11.1"><semantics id="S4.p4.11.m11.1a"><mi id="S4.p4.11.m11.1.1" xref="S4.p4.11.m11.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.p4.11.m11.1b"><ci id="S4.p4.11.m11.1.1.cmml" xref="S4.p4.11.m11.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m11.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.p4.11.m11.1d">italic_A</annotation></semantics></math> and their corresponding categories <math alttext="L" class="ltx_Math" display="inline" id="S4.p4.12.m12.1"><semantics id="S4.p4.12.m12.1a"><mi id="S4.p4.12.m12.1.1" xref="S4.p4.12.m12.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p4.12.m12.1b"><ci id="S4.p4.12.m12.1.1.cmml" xref="S4.p4.12.m12.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m12.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.p4.12.m12.1d">italic_L</annotation></semantics></math> (is a human instance or not). We train the interpreter with binary cross-entropy loss and alpha loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{P-decoder}}=\lambda\mathcal{L}_{c\_bce}(\hat{L},L)+\mathcal%
{L}_{a\_alpha}(\hat{A},A)," class="ltx_Math" display="block" id="S4.E8.m1.5"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5.1" xref="S4.E8.m1.5.5.1.1.cmml"><mrow id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml"><msub id="S4.E8.m1.5.5.1.1.2" xref="S4.E8.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.1.1.2.2" xref="S4.E8.m1.5.5.1.1.2.2.cmml">ℒ</mi><mtext id="S4.E8.m1.5.5.1.1.2.3" xref="S4.E8.m1.5.5.1.1.2.3a.cmml">P-decoder</mtext></msub><mo id="S4.E8.m1.5.5.1.1.1" xref="S4.E8.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.5.5.1.1.3" xref="S4.E8.m1.5.5.1.1.3.cmml"><mrow id="S4.E8.m1.5.5.1.1.3.2" xref="S4.E8.m1.5.5.1.1.3.2.cmml"><mi id="S4.E8.m1.5.5.1.1.3.2.2" xref="S4.E8.m1.5.5.1.1.3.2.2.cmml">λ</mi><mo id="S4.E8.m1.5.5.1.1.3.2.1" xref="S4.E8.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msub id="S4.E8.m1.5.5.1.1.3.2.3" xref="S4.E8.m1.5.5.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.1.1.3.2.3.2" xref="S4.E8.m1.5.5.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="S4.E8.m1.5.5.1.1.3.2.3.3" xref="S4.E8.m1.5.5.1.1.3.2.3.3.cmml"><mi id="S4.E8.m1.5.5.1.1.3.2.3.3.2" xref="S4.E8.m1.5.5.1.1.3.2.3.3.2.cmml">c</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.3.1" xref="S4.E8.m1.5.5.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.2.3.3.3" mathvariant="normal" xref="S4.E8.m1.5.5.1.1.3.2.3.3.3.cmml">_</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.3.1a" xref="S4.E8.m1.5.5.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.2.3.3.4" xref="S4.E8.m1.5.5.1.1.3.2.3.3.4.cmml">b</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.3.1b" xref="S4.E8.m1.5.5.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.2.3.3.5" xref="S4.E8.m1.5.5.1.1.3.2.3.3.5.cmml">c</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.3.1c" xref="S4.E8.m1.5.5.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.2.3.3.6" xref="S4.E8.m1.5.5.1.1.3.2.3.3.6.cmml">e</mi></mrow></msub><mo id="S4.E8.m1.5.5.1.1.3.2.1a" xref="S4.E8.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.5.5.1.1.3.2.4.2" xref="S4.E8.m1.5.5.1.1.3.2.4.1.cmml"><mo id="S4.E8.m1.5.5.1.1.3.2.4.2.1" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.2.4.1.cmml">(</mo><mover accent="true" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mi id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">L</mi><mo id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml">^</mo></mover><mo id="S4.E8.m1.5.5.1.1.3.2.4.2.2" xref="S4.E8.m1.5.5.1.1.3.2.4.1.cmml">,</mo><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">L</mi><mo id="S4.E8.m1.5.5.1.1.3.2.4.2.3" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.5.5.1.1.3.1" xref="S4.E8.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S4.E8.m1.5.5.1.1.3.3" xref="S4.E8.m1.5.5.1.1.3.3.cmml"><msub id="S4.E8.m1.5.5.1.1.3.3.2" xref="S4.E8.m1.5.5.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.1.1.3.3.2.2" xref="S4.E8.m1.5.5.1.1.3.3.2.2.cmml">ℒ</mi><mrow id="S4.E8.m1.5.5.1.1.3.3.2.3" xref="S4.E8.m1.5.5.1.1.3.3.2.3.cmml"><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.2" xref="S4.E8.m1.5.5.1.1.3.3.2.3.2.cmml">a</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.3" mathvariant="normal" xref="S4.E8.m1.5.5.1.1.3.3.2.3.3.cmml">_</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1a" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.4" xref="S4.E8.m1.5.5.1.1.3.3.2.3.4.cmml">a</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1b" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.5" xref="S4.E8.m1.5.5.1.1.3.3.2.3.5.cmml">l</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1c" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.6" xref="S4.E8.m1.5.5.1.1.3.3.2.3.6.cmml">p</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1d" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.7" xref="S4.E8.m1.5.5.1.1.3.3.2.3.7.cmml">h</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.3.1e" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.3.2.3.8" xref="S4.E8.m1.5.5.1.1.3.3.2.3.8.cmml">a</mi></mrow></msub><mo id="S4.E8.m1.5.5.1.1.3.3.1" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mrow id="S4.E8.m1.5.5.1.1.3.3.3.2" xref="S4.E8.m1.5.5.1.1.3.3.3.1.cmml"><mo id="S4.E8.m1.5.5.1.1.3.3.3.2.1" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.3.3.1.cmml">(</mo><mover accent="true" id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml"><mi id="S4.E8.m1.3.3.2" xref="S4.E8.m1.3.3.2.cmml">A</mi><mo id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.cmml">^</mo></mover><mo id="S4.E8.m1.5.5.1.1.3.3.3.2.2" xref="S4.E8.m1.5.5.1.1.3.3.3.1.cmml">,</mo><mi id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml">A</mi><mo id="S4.E8.m1.5.5.1.1.3.3.3.2.3" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.5.5.1.2" xref="S4.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1"><eq id="S4.E8.m1.5.5.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.1"></eq><apply id="S4.E8.m1.5.5.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E8.m1.5.5.1.1.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2">ℒ</ci><ci id="S4.E8.m1.5.5.1.1.2.3a.cmml" xref="S4.E8.m1.5.5.1.1.2.3"><mtext id="S4.E8.m1.5.5.1.1.2.3.cmml" mathsize="70%" xref="S4.E8.m1.5.5.1.1.2.3">P-decoder</mtext></ci></apply><apply id="S4.E8.m1.5.5.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.3"><plus id="S4.E8.m1.5.5.1.1.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.1"></plus><apply id="S4.E8.m1.5.5.1.1.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2"><times id="S4.E8.m1.5.5.1.1.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.1"></times><ci id="S4.E8.m1.5.5.1.1.3.2.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2.2">𝜆</ci><apply id="S4.E8.m1.5.5.1.1.3.2.3.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.3.2.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S4.E8.m1.5.5.1.1.3.2.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.2">ℒ</ci><apply id="S4.E8.m1.5.5.1.1.3.2.3.3.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3"><times id="S4.E8.m1.5.5.1.1.3.2.3.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.1"></times><ci id="S4.E8.m1.5.5.1.1.3.2.3.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.2">𝑐</ci><ci id="S4.E8.m1.5.5.1.1.3.2.3.3.3.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.3">_</ci><ci id="S4.E8.m1.5.5.1.1.3.2.3.3.4.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.4">𝑏</ci><ci id="S4.E8.m1.5.5.1.1.3.2.3.3.5.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.5">𝑐</ci><ci id="S4.E8.m1.5.5.1.1.3.2.3.3.6.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.3.6">𝑒</ci></apply></apply><interval closure="open" id="S4.E8.m1.5.5.1.1.3.2.4.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.4.2"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><ci id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1">^</ci><ci id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2">𝐿</ci></apply><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">𝐿</ci></interval></apply><apply id="S4.E8.m1.5.5.1.1.3.3.cmml" xref="S4.E8.m1.5.5.1.1.3.3"><times id="S4.E8.m1.5.5.1.1.3.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.3.1"></times><apply id="S4.E8.m1.5.5.1.1.3.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.3.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2">subscript</csymbol><ci id="S4.E8.m1.5.5.1.1.3.3.2.2.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.2">ℒ</ci><apply id="S4.E8.m1.5.5.1.1.3.3.2.3.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3"><times id="S4.E8.m1.5.5.1.1.3.3.2.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.1"></times><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.2">𝑎</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.3.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.3">_</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.4.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.4">𝑎</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.5.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.5">𝑙</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.6.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.6">𝑝</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.7.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.7">ℎ</ci><ci id="S4.E8.m1.5.5.1.1.3.3.2.3.8.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2.3.8">𝑎</ci></apply></apply><interval closure="open" id="S4.E8.m1.5.5.1.1.3.3.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.3.3.2"><apply id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"><ci id="S4.E8.m1.3.3.1.cmml" xref="S4.E8.m1.3.3.1">^</ci><ci id="S4.E8.m1.3.3.2.cmml" xref="S4.E8.m1.3.3.2">𝐴</ci></apply><ci id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.4">𝐴</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">\mathcal{L}_{\text{P-decoder}}=\lambda\mathcal{L}_{c\_bce}(\hat{L},L)+\mathcal%
{L}_{a\_alpha}(\hat{A},A),</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.5d">caligraphic_L start_POSTSUBSCRIPT P-decoder end_POSTSUBSCRIPT = italic_λ caligraphic_L start_POSTSUBSCRIPT italic_c _ italic_b italic_c italic_e end_POSTSUBSCRIPT ( over^ start_ARG italic_L end_ARG , italic_L ) + caligraphic_L start_POSTSUBSCRIPT italic_a _ italic_a italic_l italic_p italic_h italic_a end_POSTSUBSCRIPT ( over^ start_ARG italic_A end_ARG , italic_A ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p4.14">where <math alttext="\lambda=0.1" class="ltx_Math" display="inline" id="S4.p4.13.m1.1"><semantics id="S4.p4.13.m1.1a"><mrow id="S4.p4.13.m1.1.1" xref="S4.p4.13.m1.1.1.cmml"><mi id="S4.p4.13.m1.1.1.2" xref="S4.p4.13.m1.1.1.2.cmml">λ</mi><mo id="S4.p4.13.m1.1.1.1" xref="S4.p4.13.m1.1.1.1.cmml">=</mo><mn id="S4.p4.13.m1.1.1.3" xref="S4.p4.13.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.13.m1.1b"><apply id="S4.p4.13.m1.1.1.cmml" xref="S4.p4.13.m1.1.1"><eq id="S4.p4.13.m1.1.1.1.cmml" xref="S4.p4.13.m1.1.1.1"></eq><ci id="S4.p4.13.m1.1.1.2.cmml" xref="S4.p4.13.m1.1.1.2">𝜆</ci><cn id="S4.p4.13.m1.1.1.3.cmml" type="float" xref="S4.p4.13.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.13.m1.1c">\lambda=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.p4.13.m1.1d">italic_λ = 0.1</annotation></semantics></math>, <math alttext="\hat{L},\hat{A}" class="ltx_Math" display="inline" id="S4.p4.14.m2.2"><semantics id="S4.p4.14.m2.2a"><mrow id="S4.p4.14.m2.2.3.2" xref="S4.p4.14.m2.2.3.1.cmml"><mover accent="true" id="S4.p4.14.m2.1.1" xref="S4.p4.14.m2.1.1.cmml"><mi id="S4.p4.14.m2.1.1.2" xref="S4.p4.14.m2.1.1.2.cmml">L</mi><mo id="S4.p4.14.m2.1.1.1" xref="S4.p4.14.m2.1.1.1.cmml">^</mo></mover><mo id="S4.p4.14.m2.2.3.2.1" xref="S4.p4.14.m2.2.3.1.cmml">,</mo><mover accent="true" id="S4.p4.14.m2.2.2" xref="S4.p4.14.m2.2.2.cmml"><mi id="S4.p4.14.m2.2.2.2" xref="S4.p4.14.m2.2.2.2.cmml">A</mi><mo id="S4.p4.14.m2.2.2.1" xref="S4.p4.14.m2.2.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.14.m2.2b"><list id="S4.p4.14.m2.2.3.1.cmml" xref="S4.p4.14.m2.2.3.2"><apply id="S4.p4.14.m2.1.1.cmml" xref="S4.p4.14.m2.1.1"><ci id="S4.p4.14.m2.1.1.1.cmml" xref="S4.p4.14.m2.1.1.1">^</ci><ci id="S4.p4.14.m2.1.1.2.cmml" xref="S4.p4.14.m2.1.1.2">𝐿</ci></apply><apply id="S4.p4.14.m2.2.2.cmml" xref="S4.p4.14.m2.2.2"><ci id="S4.p4.14.m2.2.2.1.cmml" xref="S4.p4.14.m2.2.2.1">^</ci><ci id="S4.p4.14.m2.2.2.2.cmml" xref="S4.p4.14.m2.2.2.2">𝐴</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.14.m2.2c">\hat{L},\hat{A}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.14.m2.2d">over^ start_ARG italic_L end_ARG , over^ start_ARG italic_A end_ARG</annotation></semantics></math> means the ground truth category and alpha matte respectively. To enable the interpreter training, we collected 400 real images and labeled them with matte ground truth as well as a text description. Once the training finishes, we use the Stable Diffusion to generate realistic images, and use the trained interpreter to obtain the matte ground truth at the same time. To let the Stable Diffusion generate diverse images, we design a prompt to instruct GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib1" title="">1</a>]</cite> to generate an infinite amount of diverse and semantic-rich text descriptions (see supplementary for details), and send them to the Stable Diffusion for text-to-image generation. We give a visual comparison in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.F3" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. It can be observed that the image synthesized by existing data synthetic algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite> often lacks of realistic instance lay-out with scene-instance prior consideration, while our new data synthetic pipeline enables a much more realistic data generation. Please also refer to <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS4" title="5.4 Quantitative analysis on data synthesis method ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.4</span></a> for quantitative evaluation.</p>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S4.F4.fig1" style="width:433.6pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="188" id="S4.F4.sf1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F4.sf1.3.2" style="font-size:90%;">Training phase with few (400 images) manually labeled natural images.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="212" id="S4.F4.sf2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F4.sf2.3.2" style="font-size:90%;">Inference phase generating image and corresponding perception annotation.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.fig1.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.fig1.3.2" style="font-size:90%;">The synthetic data generation pipeline.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.p5.1.1">The SMPMat dataset.</span>
We followed the above generation pipeline to generate a large-scale multi-person matting dataset SMPMat, in which we carefully select 40,000 high-quality multi-person scene images from our generated samples to form the dataset. We generated diverse text descriptions for the people in each image through GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib1" title="">1</a>]</cite>, as the additional text annotations to broaden the usage of the proposed dataset.
Compared with existing multi-person matting datasets, the SMPMat dataset shows superiority in both data diversity (see <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.T2" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>) and image quality (see <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S4.F3" title="In 4 The SMPMat Dataset ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Implementation Details</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We first train the semantic capture network alone without the matting refinement network. After the semantic network converges, we freeze it and then train the matting refinement network. For all the network training, Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib12" title="">12</a>]</cite> is used and the base learning rate is set to <math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">5</mn><mo id="S5.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.1.m1.1.1.1.cmml">×</mo><msup id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mn id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p1.1.m1.1.1.3.3" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml"><mo id="S5.SS1.p1.1.m1.1.1.3.3a" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p1.1.m1.1.1.3.3.2" xref="S5.SS1.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></times><cn id="S5.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.2">5</cn><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3">superscript</csymbol><cn id="S5.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.2">10</cn><apply id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3"><minus id="S5.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3"></minus><cn id="S5.SS1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> with the cosine learning rate scheduler. The matting network is trained for 150 epochs, while the uncertainty estimation decoder and the refinement network are trained for 75 epochs.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Dataset and Evaluation Protocol</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We compare our method with existing interactive matting methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite>
on the SMPMat dataset and the HIM2K (natural) dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>.
All the methods are trained on the training set of SMPMat, and evaluated on both the validation set of SMPMat and HIM2K (natural). All the used metrics (the smaller, the better) follow previous works.
We train different methods under their supported input type.
For a fair comparison, we first train our DFIMat under the same protocol as the existing method (only one type of input) to make the comparison under each supported type. Then, we also train our DFIMat using mixed types of user input to show its full performance.
We design some rules to imitate human behavior and simulate the user input during training and testing. Rules are as follows.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Click &amp; scribble input.</span> Since they usually conduct in a multi-round interaction fashion, we set a 5-round interaction loop, for both training and testing. Each round adds 3 clicks/2 scribbles. The first round of input is randomly generated by GT (but the same for different methods in the same input image for a fair comparison). Subsequent inputs are generated in the most significant area calculated from previous prediction results and GT (see the supplementary material for the definition of the most significant area). For methods that do not consider multi-round interactions, we aggregate the inputs from rounds 1 to t and feed them together into the model as the input for round t.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Box &amp; text input.</span> A single round of interaction is built for both training and testing, where the input is obtained directly from GT.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">Mixed input.</span> For both training and testing, the interaction round is set to 5. We set the first round of input to a combination of text and any kind of visual input (click/scribble/box). The input types in <math alttext="2\sim 3" class="ltx_Math" display="inline" id="S5.SS2.p4.1.m1.1"><semantics id="S5.SS2.p4.1.m1.1a"><mrow id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml"><mn id="S5.SS2.p4.1.m1.1.1.2" xref="S5.SS2.p4.1.m1.1.1.2.cmml">2</mn><mo id="S5.SS2.p4.1.m1.1.1.1" xref="S5.SS2.p4.1.m1.1.1.1.cmml">∼</mo><mn id="S5.SS2.p4.1.m1.1.1.3" xref="S5.SS2.p4.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.p4.1.m1.1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1.1">similar-to</csymbol><cn id="S5.SS2.p4.1.m1.1.1.2.cmml" type="integer" xref="S5.SS2.p4.1.m1.1.1.2">2</cn><cn id="S5.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p4.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">2\sim 3</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.1.m1.1d">2 ∼ 3</annotation></semantics></math> rounds are randomly selected from click and scribble, and clicks/scribbles are added to the most significant areas based on previous prediction results (same rule as the aforementioned single-type click or scribble input).</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Comparison with the state-of-the-art methods</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p1.1.1">Single-type user input.</span>
We conducted comparisons of various models on the SMPMat validation set and the HIM2k natural subset, with results listed in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.T3" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. Experimental outcomes demonstrate that under single-type input settings, our approach consistently outperforms all state-of-the-art methods. To investigate how different models perform during multiple rounds of interaction, we present the SAD variation curves of various methods during the interactive process in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.F5" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>. Notably, Our DFIMat also achieves more accurate prediction output with fewer interactions needed.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.4.2.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.2.1" style="font-size:90%;">Quantitative comparison on SMPMat validation set and HIM2K natural set. The MSE metrics are scaled by <math alttext="10^{2}" class="ltx_Math" display="inline" id="S5.T3.2.1.m1.1"><semantics id="S5.T3.2.1.m1.1b"><msup id="S5.T3.2.1.m1.1.1" xref="S5.T3.2.1.m1.1.1.cmml"><mn id="S5.T3.2.1.m1.1.1.2" xref="S5.T3.2.1.m1.1.1.2.cmml">10</mn><mn id="S5.T3.2.1.m1.1.1.3" xref="S5.T3.2.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T3.2.1.m1.1c"><apply id="S5.T3.2.1.m1.1.1.cmml" xref="S5.T3.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.1.m1.1.1.1.cmml" xref="S5.T3.2.1.m1.1.1">superscript</csymbol><cn id="S5.T3.2.1.m1.1.1.2.cmml" type="integer" xref="S5.T3.2.1.m1.1.1.2">10</cn><cn id="S5.T3.2.1.m1.1.1.3.cmml" type="integer" xref="S5.T3.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.1.m1.1d">10^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.1.m1.1e">10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. </span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T3.5" style="width:433.6pt;height:337.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-40.8pt,31.8pt) scale(0.841757906879533,0.841757906879533) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T3.5.1">
<tr class="ltx_tr" id="S5.T3.5.1.1">
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.1.1"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.1.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.5.1.1.3">SMPMat Validation</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S5.T3.5.1.1.4">HIM2K Natural</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.2.1"><span class="ltx_text" id="S5.T3.5.1.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.5.1.2.1.1.1">
<span class="ltx_tr" id="S5.T3.5.1.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.5.1.2.1.1.1.1.1">Supported</span></span>
<span class="ltx_tr" id="S5.T3.5.1.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.5.1.2.1.1.1.2.1">User Input</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.2.2"><span class="ltx_text" id="S5.T3.5.1.2.2.1">Method</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.3">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.4">MSE</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.5">GRAD</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.2.6">CONN</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.7">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.8">MSE</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.9">GRAD</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.2.10">CONN</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.3">
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.3.2">ActiveMatting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib36" title="">36</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.3">36.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.4">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.5">17.85</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.3.6">37.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.7">16.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.8">0.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.9">7.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.3.10">16.73</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.4">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.4.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.4.2">InteractiveMatting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib32" title="">32</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.3">30.47</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.4">0.70</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.5">15.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.4.6">31.11</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.7">14.06</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.8">0.41</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.9">7.02</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.4.10">14.11</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.5">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.5.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.5.2">DIIM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib43" title="">43</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.3">33.49</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.4">0.81</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.5">16.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.5.6">32.04</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.7">15.87</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.8">0.43</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.9">7.36</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.5.10">15.89</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.6">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.6.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.6.2">MatAny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib37" title="">37</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.1.6.3">30.49</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.4">0.71</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.5">15.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.6.6">31.44</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.7">14.01</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.8">0.40</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.9">7.00</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.6.10">14.02</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.7">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.7.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.7.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.2.1" style="background-color:#EFEFEF;">DFIMat(click trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.3.1" style="background-color:#EFEFEF;">28.63</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.4.1" style="background-color:#EFEFEF;">0.67</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.5.1" style="background-color:#EFEFEF;">15.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.7.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.6.1" style="background-color:#EFEFEF;">28.49</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.7.1" style="background-color:#EFEFEF;">13.74</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.8.1" style="background-color:#EFEFEF;">0.39</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.9.1" style="background-color:#EFEFEF;">6.49</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.7.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.7.10.1" style="background-color:#EFEFEF;">13.77</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.8.1"><span class="ltx_text" id="S5.T3.5.1.8.1.1">Click</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.8.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.2.1" style="background-color:#EFEFEF;">DFIMat(mix trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.3.1" style="background-color:#EFEFEF;">28.01</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.4.1" style="background-color:#EFEFEF;">0.66</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.5.1" style="background-color:#EFEFEF;">16.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.8.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.6.1" style="background-color:#EFEFEF;">27.36</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.7.1" style="background-color:#EFEFEF;">13.59</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.8.1" style="background-color:#EFEFEF;">0.38</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.9.1" style="background-color:#EFEFEF;">6.47</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.8.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.8.10.1" style="background-color:#EFEFEF;">13.62</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.9">
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.9.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.9.2">SmartScribbles <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib35" title="">35</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.3">26.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.4">0.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.5">16.01</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.9.6">26.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.7">12.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.8">0.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.9">6.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.9.10">12.26</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.10">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.10.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.10.2">FGI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib5" title="">5</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.3">27.34</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.4">0.61</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.5">16.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.10.6">26.95</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.7">13.63</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.8">0.39</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.9">6.51</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.10.10">14.01</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.11">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.11.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.11.2">UGDMatting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib7" title="">7</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.3">30.95</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.4">0.71</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.5">17.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.11.6">31.76</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.7">14.58</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.8">0.42</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.9">7.39</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.11.10">15.37</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.12">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.12.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.12.2">MatAny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib37" title="">37</a>]</cite>
</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.1.12.3">26.37</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.4">0.58</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.5">15.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.12.6">26.82</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.7">12.40</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.8">0.41</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.9">6.25</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.12.10">12.51</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.13">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.13.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.13.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.2.1" style="background-color:#EFEFEF;">DFIMat(scribble trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.3.1" style="background-color:#EFEFEF;">24.14</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.4.1" style="background-color:#EFEFEF;">0.50</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.5.1" style="background-color:#EFEFEF;">15.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.13.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.6.1" style="background-color:#EFEFEF;">24.19</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.7.1" style="background-color:#EFEFEF;">12.22</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.8.1" style="background-color:#EFEFEF;">0.38</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.9.1" style="background-color:#EFEFEF;">6.25</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.13.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.13.10.1" style="background-color:#EFEFEF;">12.23</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.14.1"><span class="ltx_text" id="S5.T3.5.1.14.1.1">Scribble</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.14.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.2.1" style="background-color:#EFEFEF;">DFIMat(mix trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.3.1" style="background-color:#EFEFEF;">23.86</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.4.1" style="background-color:#EFEFEF;">0.49</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.5.1" style="background-color:#EFEFEF;">15.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.14.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.6.1" style="background-color:#EFEFEF;">23.80</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.7.1" style="background-color:#EFEFEF;">12.07</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.8.1" style="background-color:#EFEFEF;">0.37</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.9.1" style="background-color:#EFEFEF;">6.18</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.14.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.14.10.1" style="background-color:#EFEFEF;">11.99</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.15">
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.15.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.15.2">MatAny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib37" title="">37</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.5.1.15.3">50.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.4">2.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.5">30.16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.15.6">50.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.7">21.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.8">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.9">10.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.15.10">22.44</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.16">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.16.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.16.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.2.1" style="background-color:#EFEFEF;">DFIMat(box trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.3.1" style="background-color:#EFEFEF;">47.44</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.4.1" style="background-color:#EFEFEF;">2.17</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.5.1" style="background-color:#EFEFEF;">28.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.16.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.6.1" style="background-color:#EFEFEF;">47.35</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.7.1" style="background-color:#EFEFEF;">20.46</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.8.1" style="background-color:#EFEFEF;">0.88</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.9.1" style="background-color:#EFEFEF;">9.88</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.16.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.16.10.1" style="background-color:#EFEFEF;">21.38</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.17.1"><span class="ltx_text" id="S5.T3.5.1.17.1.1">Box</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.17.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.2.1" style="background-color:#EFEFEF;">DFIMat(mix trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.3.1" style="background-color:#EFEFEF;">46.29</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.4.1" style="background-color:#EFEFEF;">1.85</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.5.1" style="background-color:#EFEFEF;">28.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.17.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.6.1" style="background-color:#EFEFEF;">46.24</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.7.1" style="background-color:#EFEFEF;">19.79</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.8.1" style="background-color:#EFEFEF;">0.85</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.9.1" style="background-color:#EFEFEF;">8.74</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.17.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.17.10.1" style="background-color:#EFEFEF;">20.54</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.18">
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.5.1.18.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.18.2">RIM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib17" title="">17</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.3">52.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.4">2.94</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.5">31.46</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.5.1.18.6">52.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.7">22.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.8">0.97</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.9">11.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.18.10">23.33</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.19">
<td class="ltx_td ltx_border_r" id="S5.T3.5.1.19.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.19.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.2.1" style="background-color:#EFEFEF;">DFIMat(text trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.3.1" style="background-color:#EFEFEF;">54.86</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.4.1" style="background-color:#EFEFEF;">3.31</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.5.1" style="background-color:#EFEFEF;">21.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.19.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.6.1" style="background-color:#EFEFEF;">54.79</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.7.1" style="background-color:#EFEFEF;">23.53</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.8.1" style="background-color:#EFEFEF;">1.05</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.9.1" style="background-color:#EFEFEF;">12.06</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.19.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.19.10.1" style="background-color:#EFEFEF;">23.69</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.20">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.20.1"><span class="ltx_text" id="S5.T3.5.1.20.1.1">Text</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.20.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.2.1" style="background-color:#EFEFEF;">DFIMat(mix trained)</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.3.1" style="background-color:#EFEFEF;">50.32</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.4.1" style="background-color:#EFEFEF;">2.83</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.5.1" style="background-color:#EFEFEF;">30.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.1.20.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.6.1" style="background-color:#EFEFEF;">50.24</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.7.1" style="background-color:#EFEFEF;">22.45</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.8.1" style="background-color:#EFEFEF;">0.92</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.9.1" style="background-color:#EFEFEF;">11.19</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.1.20.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.20.10.1" style="background-color:#EFEFEF;">22.66</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.1.21">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.5.1.21.1">Mix</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.5.1.21.2" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.2.1" style="background-color:#EFEFEF;">DFIMat(mix trained)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.3" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.3.1" style="background-color:#EFEFEF;">22.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.4" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.4.1" style="background-color:#EFEFEF;">0.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.5" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.5.1" style="background-color:#EFEFEF;">15.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.5.1.21.6" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.6.1" style="background-color:#EFEFEF;">22.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.7" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.7.1" style="background-color:#EFEFEF;">11.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.8" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.8.1" style="background-color:#EFEFEF;">0.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.9" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.9.1" style="background-color:#EFEFEF;">5.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T3.5.1.21.10" style="background-color:#EFEFEF;"><span class="ltx_text" id="S5.T3.5.1.21.10.1" style="background-color:#EFEFEF;">11.80</span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="188" id="S5.F5.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.3.2" style="font-size:90%;">Performance comparison under different rounds of interaction on SMPMat.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="178" id="S5.F6.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">Effect of different user inputs on the SMPMat dataset.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S5.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="379" id="S5.F7.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S5.F7.3.2" style="font-size:90%;">Qualitative comparisons among different methods. The red points in (a) indicate the target instances.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p2.1.1">Multi-type user input.</span> From the test results in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.T3" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, the following conclusions can be drawn: (1) Unlike previous methods that only support one type of input, our model enables mixed types of inputs. Experiments show that when trained under mixed user inputs, the performance of our model can be further enhanced, even with the same single-type input inference. This verifies the benefit of multi-type user input for model training, as they can give more complementary information. (2) As in the bottom line of <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.T3" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, it can be seen that when applying mixed type inputs during inference, the performance of our model can be further improved. This further verifies the benefit of multi-type user inference, and it also makes user interaction more flexible.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.1">Analysis on user input choice.</span> Here we investigate the roles of different input types, aiming to provide valuable principles for users on more effective interaction. We assume only one input per interaction. We use IoU to measure the coarse-grained instance capture accuracy, and SAD to measure the fine-grained matting accuracy. As in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.F6" title="Figure 6 ‣ 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">6</span></a>, box input can give a good start as its effectiveness for instance localization, scribble (we observe a similar role but slightly lower performance on click) is useful to refine local details, text is usually not-efficient. As a result, box at round 1 and scribble at the remaining iteration is an optimal choice for efficient user interaction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p4.1.1">Qualitative comparison.</span>
We follow the same protocol in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS2" title="5.2 Dataset and Evaluation Protocol ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.2</span></a> to conduct the experiment, as in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.F7" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>. The red points in (a) indicate the target instances. For our DFIMat, we only give the result from our full model (i.e., mix trained &amp; inference) in (h) due to the space limitation. More comparisons with other variants of DFIMat refer to our supplementary material. From <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.F7" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, it can be seen that DFIMat can accurately localize the target instance. More importantly, it shows superiority at perceiving fine-grained details: (1) Hair regions across all examples. (2) Other hollow body areas like the fingers or arm in row 2-5.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T5.fig1" style="width:238.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.T5.fig1.1.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T5.fig1.2.2" style="font-size:90%;">Analysis of the decoupled design.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T5.fig1.3" style="width:433.6pt;height:149.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(60.5pt,-20.9pt) scale(1.38671877478007,1.38671877478007) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T5.fig1.3.1">
<tr class="ltx_tr" id="S5.T5.fig1.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.1.1" rowspan="2">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="S5.T5.fig1.3.1.1.1.1">Setting</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.1.2">Complexity</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.1.3">Semantic Capture</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S5.T5.fig1.3.1.1.4">Matting</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig1.3.1.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.2.1">GFLOPs</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.2.2">NoC @ 90%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.2.3">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.2.4">MSE</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig1.3.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.fig1.3.1.3.1">Coupled Network</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.fig1.3.1.3.2">0.2186</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.fig1.3.1.3.3">7.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.fig1.3.1.3.4">25.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.fig1.3.1.3.5">0.53</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig1.3.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.4.1">Coupled Traning</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.4.2">0.223</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.4.3">6.82</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.4.4">23.62</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.4.5">0.48</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig1.3.1.5" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.5.1"><span class="ltx_text" id="S5.T5.fig1.3.1.5.1.1" style="background-color:#F0F0F0;">DFIMat</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.5.2"><span class="ltx_text" id="S5.T5.fig1.3.1.5.2.1" style="background-color:#F0F0F0;">0.223</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.5.3"><span class="ltx_text ltx_font_bold" id="S5.T5.fig1.3.1.5.3.1" style="background-color:#F0F0F0;">6.51</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.5.4"><span class="ltx_text ltx_font_bold" id="S5.T5.fig1.3.1.5.4.1" style="background-color:#F0F0F0;">22.89</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig1.3.1.5.5"><span class="ltx_text ltx_font_bold" id="S5.T5.fig1.3.1.5.5.1" style="background-color:#F0F0F0;">0.47</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig1.3.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig1.3.1.6.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td class="ltx_td" id="S5.T5.fig1.3.1.6.2"></td>
<td class="ltx_td" id="S5.T5.fig1.3.1.6.3"></td>
<td class="ltx_td" id="S5.T5.fig1.3.1.6.4"></td>
<td class="ltx_td" id="S5.T5.fig1.3.1.6.5"></td>
</tr>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T5.fig2" style="width:190.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.T5.fig2.1.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S5.T5.fig2.2.2" style="font-size:90%;">Effectiveness of CRM.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T5.fig2.3" style="width:433.6pt;height:178.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(107.5pt,-44.3pt) scale(1.98377128144106,1.98377128144106) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T5.fig2.3.1">
<tr class="ltx_tr" id="S5.T5.fig2.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.1.1" rowspan="2">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="S5.T5.fig2.3.1.1.1.1">Setting</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.1.2">Semantic Capture</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S5.T5.fig2.3.1.1.3">Matting</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig2.3.1.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.2.1">NoC @ 90%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig2.3.1.2.2">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig2.3.1.2.3">MSE</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig2.3.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.fig2.3.1.3.1">w/o CRM</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.fig2.3.1.3.2">7.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.fig2.3.1.3.3">25.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.fig2.3.1.3.4">0.52</td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig2.3.1.4" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.4.1"><span class="ltx_text" id="S5.T5.fig2.3.1.4.1.1" style="background-color:#F0F0F0;">w/ CRM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.4.2"><span class="ltx_text ltx_font_bold" id="S5.T5.fig2.3.1.4.2.1" style="background-color:#F0F0F0;">6.51</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig2.3.1.4.3"><span class="ltx_text ltx_font_bold" id="S5.T5.fig2.3.1.4.3.1" style="background-color:#F0F0F0;">22.99</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.fig2.3.1.4.4"><span class="ltx_text ltx_font_bold" id="S5.T5.fig2.3.1.4.4.1" style="background-color:#F0F0F0;">0.47</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.fig2.3.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.fig2.3.1.5.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td class="ltx_td" id="S5.T5.fig2.3.1.5.2"></td>
<td class="ltx_td" id="S5.T5.fig2.3.1.5.3"></td>
<td class="ltx_td" id="S5.T5.fig2.3.1.5.4"></td>
</tr>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S5.SS3.2">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.SS3.1.fig1" style="width:169.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S5.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T6.2.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="S5.T6.3.2" style="font-size:90%;">Ablation study on 
<br class="ltx_break"/>the encoder setting of MRN.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S5.SS3.1.fig1.1" style="width:225.5pt;height:171.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(53.6pt,-40.8pt) scale(1.9068404948666,1.9068404948666) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.SS3.1.fig1.1.1">
<tr class="ltx_tr" id="S5.SS3.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.1.fig1.1.1.1.1">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
Branch</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.1.2">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.1.3">MSE</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.SS3.1.fig1.1.1.2.1">Global</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.1.fig1.1.1.2.2">24.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.1.fig1.1.1.2.3">0.51</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.1.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.1.fig1.1.1.3.1">Local</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.3.2">23.35</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.3.3">0.48</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.1.fig1.1.1.4" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.1.fig1.1.1.4.1"><span class="ltx_text" id="S5.SS3.1.fig1.1.1.4.1.1" style="background-color:#F0F0F0;">Hybrid</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.4.2"><span class="ltx_text ltx_font_bold" id="S5.SS3.1.fig1.1.1.4.2.1" style="background-color:#F0F0F0;">22.89</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.1.fig1.1.1.4.3"><span class="ltx_text ltx_font_bold" id="S5.SS3.1.fig1.1.1.4.3.1" style="background-color:#F0F0F0;">0.47</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.1.fig1.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.1.fig1.1.1.5.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td class="ltx_td" id="S5.SS3.1.fig1.1.1.5.2"></td>
<td class="ltx_td" id="S5.SS3.1.fig1.1.1.5.3"></td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.SS3.2.fig2" style="width:260.2pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S5.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T7.2.1.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="S5.T7.3.2" style="font-size:90%;">Matting performance comparison under datasets using different data generation schemes.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S5.SS3.2.fig2.1" style="width:433.6pt;height:120.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.0pt,-15.3pt) scale(1.33960834477969,1.33960834477969) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.SS3.2.fig2.1.1">
<tr class="ltx_tr" id="S5.SS3.2.fig2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.1.1" rowspan="2">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="S5.SS3.2.fig2.1.1.1.1.1">Method</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S5.SS3.2.fig2.1.1.1.2">MG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib38" title="">38</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S5.SS3.2.fig2.1.1.1.3">MatteFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib25" title="">25</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S5.SS3.2.fig2.1.1.1.4">MRN</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.2.fig2.1.1.2">
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.2.1">SAD</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.2.2">MSE</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.2.3">SAD</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.2.4">MSE</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.2.5">SAD</td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.2.6">MSE</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.2.fig2.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.SS3.2.fig2.1.1.3.1">Sys method in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.2.fig2.1.1.3.2">17.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.SS3.2.fig2.1.1.3.3">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.2.fig2.1.1.3.4">19.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.SS3.2.fig2.1.1.3.5">0.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.2.fig2.1.1.3.6">15.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.SS3.2.fig2.1.1.3.7">0.46</td>
</tr>
<tr class="ltx_tr" id="S5.SS3.2.fig2.1.1.4" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.4.1"><span class="ltx_text" id="S5.SS3.2.fig2.1.1.4.1.1" style="background-color:#F0F0F0;">Ours</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.4.2"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.2.1" style="background-color:#F0F0F0;">12.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.4.3"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.3.1" style="background-color:#F0F0F0;">0.43</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.4.4"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.4.1" style="background-color:#F0F0F0;">13.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.4.5"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.5.1" style="background-color:#F0F0F0;">0.38</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.4.6"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.6.1" style="background-color:#F0F0F0;">11.77</span></td>
<td class="ltx_td ltx_align_center" id="S5.SS3.2.fig2.1.1.4.7"><span class="ltx_text ltx_font_bold" id="S5.SS3.2.fig2.1.1.4.7.1" style="background-color:#F0F0F0;">0.36</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS3.2.fig2.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.SS3.2.fig2.1.1.5.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.2"></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.3"></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.4"></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.5"></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.6"></td>
<td class="ltx_td" id="S5.SS3.2.fig2.1.1.5.7"></td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Quantitative analysis on data synthesis method</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Here we give some quantitative evaluation of our proposed data synthesis pipeline. We compare it with the existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>. We separately apply it and our method to synthesize a same amount of data (i.e., 45k instances) from model training. Then, we apply 3 different methods (i.e., MG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib38" title="">38</a>]</cite>, MatteFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib25" title="">25</a>]</cite>, and MRN) to train on the synthesized data, and evaluate their testing performance on the HIM2K natural dataset. The result is listed in <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS3" title="5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.3</span></a>, it can be observed that when trained on the data synthesized by our method, the performance of different models is significantly and consistently better than trained on the data generated by existing method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib30" title="">30</a>]</cite>, which further verifies the superiority of our data synthesis pipeline.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Ablation studies</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">Here component effects are studied on the SMPMat dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p2.1.1">Effect of the decoupled design.</span>
Here we evaluate the following settings: <span class="ltx_text ltx_font_bold" id="S5.SS5.p2.1.2">a) Coupled Network</span> (ISCN with matting head); <span class="ltx_text ltx_font_bold" id="S5.SS5.p2.1.3">b) Coupled Training</span> (ISCN + MRN but trained jointly); <span class="ltx_text ltx_font_bold" id="S5.SS5.p2.1.4">c) DFIMat</span>
(Decoupled in both network and training). Tab. <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.T5" title="Table 5 ‣ 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">5</span></a> shows that both decoupled network and decoupled training have obvious performance gains (in both semantic capture and matting that align with our insight). Besides, the extra complexity from our decoupled design is neglectable (2% in GFLOPS), which validates the effectiveness of our design. We think the reason is that it can make the 2 independent tasks more focused and easier to be optimized, thus leading to a clear performance gain.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p3.1.1">Effect of the contrastive reasoning module (CRM).</span> From <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.T5" title="In 5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, it can be seen that with CRM, both semantic capture and matting performance improve by a noticeable margin, which shows the advantages of our design.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p4">
<p class="ltx_p" id="S5.SS5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p4.1.1">Design choices of the matting refinement network (MRN).</span> <a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#S5.SS3" title="5.3 Comparison with the state-of-the-art methods ‣ 5 Experiments ‣ DFIMat: Decoupled Flexible Interactive Matting in Multi-Person Scenarios"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.3</span></a> shows that our dual-stream design can enhance the performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Limitations</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose DFIMat, a decoupled framework that enables flexible interactive matting in multi-person scenarios, which consists of two modules, the interactive semantic capture network and the matting refinement network. DFIMat enables flexible and multi-type user input by encoding different inputs into a unified visual-semantic space, resulting in a more effective and user-friendly matting experience. Concerning the multi-round interaction requirement for practical usage, we also design a contrastive reasoning module to enhance cross-round refinement. To address the limitation from the perspective of data, we introduce a new synthetic data generation pipeline that can generate much more realistic samples than previous arts. A new large-scale dataset SMPMat is subsequently established. Extensive experiments verify the significant superiority of DFIMat while also providing valuable principles for efficient interaction. Despite its effectiveness, our method produces less accurate results when only coarse user input (e.g., box, text) is provided, and similar phenomena can also be observed in other methods. Besides, our SMP-Mat dataset does not include crowd scenes due to unrealistic generation results from base diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.09788v1#bib.bib27" title="">27</a>]</cite> in such cases. We will tackle those limitations in future works.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I., Aleman, F.L., Almeida, D., Altenschmidt, J., Altman, S., Anadkat, S., et al.: Gpt-4 technical report. arXiv preprint arXiv:2303.08774 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Cai, S., Zhang, X., Fan, H., Huang, H., Liu, J., Liu, J., Liu, J., Wang, J., Sun, J.: Disentangled image matting. In: CVPR. pp. 8819–8828 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Chen, Q., Ge, T., Xu, Y., Zhang, Z., Yang, X., Gai, K.: Semantic human matting. In: ACM MM. pp. 618–626 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Cheng, B., Misra, I., Schwing, A.G., Kirillov, A., Girdhar, R.: Masked-attention mask transformer for universal image segmentation. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 1290–1299 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Cheng, H., Xu, S., Jiang, X., Wang, R.: Deep image matting with flexible guidance input. arXiv preprint arXiv:2110.10898 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Ding, H., Zhang, H., Liu, C., Jiang, X.: Deep interactive image matting with feature propagation. IEEE TIP <span class="ltx_text ltx_font_bold" id="bib.bib6.1.1">31</span>, 2421–2432 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Fang, X., Zhang, S.H., Chen, T., Wu, X., Shamir, A., Hu, S.M.: User-guided deep human image matting using arbitrary trimaps. IEEE Transactions on Image Processing <span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">31</span>, 2040–2052 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Hou, Q., Liu, F.: Context-aware image matting for simultaneous foreground and alpha estimation. In: CVPR. pp. 4130–4139 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Kamath, A., Singh, M., LeCun, Y., Synnaeve, G., Misra, I., Carion, N.: Mdetr-modulated detection for end-to-end multi-modal understanding. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 1780–1790 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Ke, Z., Sun, J., Li, K., Yan, Q., Lau, R.W.: Modnet: Real-time trimap-free portrait matting via objective decomposition. In: AAAI. vol. 36, pp. 1140–1147 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Khattak, M.U., Rasheed, H., Maaz, M., Khan, S., Khan, F.S.: Maple: Multi-modal prompt learning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 19113–19122 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Kingma, D.P., Ba, J.: Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980 (2014)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Kirillov, A., Mintun, E., Ravi, N., Mao, H., Rolland, C., Gustafson, L., Xiao, T., Whitehead, S., Berg, A.C., Lo, W.Y., et al.: Segment anything. arXiv preprint arXiv:2304.02643 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Li, J., Ma, S., Zhang, J., Tao, D.: Privacy-preserving portrait matting. In: ACM MM. pp. 3501–3509 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Li, J., Zhang, J., Maybank, S.J., Tao, D.: Bridging composite and real: towards end-to-end deep image matting. IJCV <span class="ltx_text ltx_font_bold" id="bib.bib15.1.1">130</span>(2), 246–266 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Li, J., Zhang, J., Tao, D.: Deep automatic natural image matting. arXiv preprint arXiv:2107.07235 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Li, J., Zhang, J., Tao, D.: Referring image matting. In: CVPR. pp. 22448–22457 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Li, Y., Lu, H.: Natural image matting via guided contextual attention. In: AAAI. pp. 11450–11457 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Lin, S., Yang, L., Saleemi, I., Sengupta, S.: Robust high-resolution video matting with temporal guidance. In: Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision. pp. 238–247 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Liu, J., Yao, Y., Hou, W., Cui, M., Xie, X., Zhang, C., Hua, X.s.: Boosting semantic human matting with coarse annotations. In: CVPR. pp. 8563–8572 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Liu, Y., Xie, J., Shi, X., Qiao, Y., Huang, Y., Tang, Y., Yang, X.: Tripartite information mining and integration for image matting. In: ICCV. pp. 7555–7564 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Lu, H., Dai, Y., Shen, C., Xu, S.: Indices matter: Learning to index for deep image matting. In: ICCV. pp. 3266–3275 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Lutz, S., Amplianitis, K., Smolic, A.: Alphagan: Generative adversarial networks for natural image matting. arXiv preprint arXiv:1807.10088 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Ma, S., Li, J., Zhang, J., Zhang, H., Tao, D.: Rethinking portrait matting with privacy preserving. IJCV pp. 1–26 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Park, G., Son, S., Yoo, J., Kim, S., Kwak, N.: Matteformer: Transformer-based image matting via prior-tokens. In: CVPR. pp. 11696–11706 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Qiao, Y., Liu, Y., Yang, X., Zhou, D., Xu, M., Zhang, Q., Wei, X.: Attention-guided hierarchical structure aggregation for image matting. In: CVPR. pp. 13676–13685 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Rombach, R., Blattmann, A., Lorenz, D., Esser, P., Ommer, B.: High-resolution image synthesis with latent diffusion models. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 10684–10695 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Saharia, C., Chan, W., Saxena, S., Li, L., Whang, J., Denton, E.L., Ghasemipour, K., Gontijo Lopes, R., Karagol Ayan, B., Salimans, T., et al.: Photorealistic text-to-image diffusion models with deep language understanding. Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bib28.1.1">35</span>, 36479–36494 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Shahrian, E., Rajan, D., Price, B., Cohen, S.: Improving image matting using comprehensive sampling sets. In: CVPR. pp. 636–643 (2013)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Sun, Y., Tang, C.K., Tai, Y.W.: Human instance matting via mutual guidance and multi-instance refinement. In: CVPR. pp. 2647–2656 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Tang, J., Aksoy, Y., Oztireli, C., Gross, M., Aydin, T.O.: Learning-based sampling for natural image matting. In: CVPR. pp. 3055–3063 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Wei, T., Chen, D., Zhou, W., Liao, J., Zhao, H., Zhang, W., Yu, N.: Improved image matting via real-time user clicks and uncertainty estimation. In: CVPR. pp. 15374–15383 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Wu, W., Zhao, Y., Chen, H., Gu, Y., Zhao, R., He, Y., Zhou, H., Shou, M.Z., Shen, C.: Datasetdm: Synthesizing data with perception annotations using diffusion models. arXiv preprint arXiv:2308.06160 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Xu, N., Price, B., Cohen, S., Huang, T.: Deep image matting. In: CVPR. pp. 2970–2979 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Yang, X., Qiao, Y., Chen, S., He, S., Yin, B., Zhang, Q., Wei, X., Lau, R.W.: Smart scribbles for image matting. ACM Transactions on Multimedia Computing, Communications, and Applications (TOMM) <span class="ltx_text ltx_font_bold" id="bib.bib35.1.1">16</span>(4), 1–21 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Yang, X., Xu, K., Chen, S., He, S., Yin, B.Y., Lau, R.: Active matting. Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bib36.1.1">31</span> (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yao, J., Wang, X., Ye, L., Liu, W.: Matte anything: Interactive natural image matting with segment anything model. Image and Vision Computing p. 105067 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Yu, Q., Zhang, J., Zhang, H., Wang, Y., Lin, Z., Xu, N., Bai, Y., Yuille, A.: Mask guided matting via progressive refinement network. In: CVPR. pp. 1154–1163 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Zhang, Y., Gong, L., Fan, L., Ren, P., Huang, Q., Bao, H., Xu, W.: A late fusion cnn for digital matting. In: CVPR. pp. 7469–7478 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Zou, X., Dou, Z.Y., Yang, J., Gan, Z., Li, L., Li, C., Dai, X., Behl, H., Wang, J., Yuan, L., et al.: Generalized decoding for pixel, image, and language. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 15116–15127 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zou, X., Yang, J., Zhang, H., Li, F., Li, L., Gao, J., Lee, Y.J.: Segment everything everywhere all at once. arXiv preprint arXiv:2304.06718 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Liu, Q., Zhang, S., Meng, Q., Zhong, B., Liu, P., Yao, H.: End-to-end human instance matting. IEEE Transactions on Circuits and Systems for Video Technology <span class="ltx_text ltx_font_bold" id="bib.bib42.1.1">34</span>(4), 2633–2647 (2024). https://doi.org/10.1109/TCSVT.2023.3306400

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Ding, H., Zhang, H., Liu, C., Jiang, X.: Deep interactive image matting with feature propagation. IEEE Transactions on Image Processing <span class="ltx_text ltx_font_bold" id="bib.bib43.1.1">31</span>, 2421–2432 (2022)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct 13 09:57:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
