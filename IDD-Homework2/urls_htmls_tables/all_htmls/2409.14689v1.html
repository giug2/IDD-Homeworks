<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs</title>
<!--Generated on Mon Sep 23 03:15:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="recommendation,  diffusion,  graph,  recommender,  systems" lang="en" name="keywords"/>
<base href="/html/2409.14689v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S1" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S2" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S2.SS1" title="In 2. Related Work ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Diffusion on Adjacency Matrices</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S2.SS2" title="In 2. Related Work ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Diffusion Transformers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S2.SS3" title="In 2. Related Work ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Diffusion-based Recommender Systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S2.SS4" title="In 2. Related Work ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Graph Diffusion Recommender Systems</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S3" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S3.SS1" title="In 3. Preliminaries ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Adjacency Matrix vs. Interaction Matrix</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S3.SS2" title="In 3. Preliminaries ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Recommender System Constraints</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S4" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Proposed Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S4.SS1" title="In 4. Proposed Framework ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Row-Column Separable Attention (RCSA)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S4.SS2" title="In 4. Proposed Framework ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Graph Diffusion Transformer (GDiT)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S5" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S5.SS1" title="In 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Model and patch size</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S5.SS2" title="In 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Larger Datasets</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S6" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions and Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#A1" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>DiffRec Baseline Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#A2" title="In EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Visualizing the Sparsity in the MovieLens datasets</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Utkarsh Priyam
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:upriyam@cs.cmu.edu">upriyam@cs.cmu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hemit Shah
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:hemits@cs.cmu.edu">hemits@cs.cmu.edu</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Edoardo Botta
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ebotta@cs.cmu.edu">ebotta@cs.cmu.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Carnegie Mellon University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Pittsburgh</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">Pennsylvania</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">USA</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024; 29 July 2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id5.id1">Most recommender systems research focuses on binary historical user-item interaction encodings to predict future interactions. User features, item features, and interaction strengths remain largely under-utilized in this space or only indirectly utilized, despite proving largely effective in large-scale production recommendation systems. We propose a new attention mechanism, loosely based on the principles of collaborative filtering, called Row-Column Separable Attention (<span class="ltx_text ltx_font_bold" id="id5.id1.1">RCSA</span>) to take advantage of real-valued interaction weights as well as user and item features directly. Building on this mechanism, we additionally propose a novel Graph Diffusion Transformer (<span class="ltx_text ltx_font_bold" id="id5.id1.2">GDiT</span>) architecture which is trained to iteratively denoise the weighted interaction matrix of the user-item interaction graph directly. The weighted interaction matrix is built from the bipartite structure of the user-item interaction graph and corresponding edge weights derived from user-item rating interactions. Inspired by the recent progress in text-conditioned image generation, our method directly produces user-item rating predictions on the same scale as the original ratings by conditioning the denoising process on user and item features with a principled approach.</p>
</div>
<div class="ltx_keywords">recommendation, diffusion, graph, recommender, systems
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Knowledge Discovery and Data Mining, Workshop on Generative AI for Recommender Systems and Personalization ’24; August 25–26,
2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span></span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Machine learning algorithms</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Probabilistic reasoning</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Denoising diffusion models <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib5" title="">2020</a>)</cite> form a prominent class of models that have proven remarkably effective across a variety of generation and sampling tasks where the data distribution is high-dimensional, such as video, image synthesis and graph generation <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib8" title="">2023</a>)</cite>. However, generative modeling of graphs has historically focused on smaller graphs for applications such as molecule generation <cite class="ltx_cite ltx_citemacro_citep">(Vignac et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib15" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib8" title="">2023</a>)</cite>. Recent work involving graph generation with diffusion models show promising results for reconstructing large undirected graphs with thousands of nodes <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>; Bergmeister et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib2" title="">2024</a>)</cite>. Prior work also presents promising results with guided denoising steps incorporating score functions to evaluate graphs generated during denoising <cite class="ltx_cite ltx_citemacro_citep">(Jo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib7" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recommendation systems focus on using historical user-item interaction data (such as reviews) to predict/recommend new items for users. Previous research in this space applies diffusion models to augment sparse data, model user dynamics/preference distributions, model item latent distributions, or perform sequential recommendation <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib18" title="">2023</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib10" title="">2024</a>)</cite>. In contrast to prior research in diffusion-based recommendation systems, we aim to construct a recommender system based on graph diffusion models by formulating the problem as a graph completion task. We focus primarily on the graph structure of the user-item interaction space.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="516" id="S1.F1.g1" src="extracted/5872128/interaction_graph.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>User-item interaction graph for a movie rating dataset. Each edge weight corresponds to the user-provided rating of the movie. Users and movies are linked via only their rating interactions, hence the graph is bipartite.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S1.F1.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S1.F1.2">Bipartite graph of orange user nodes with numbered ID’s, and blue movie nodes with names. Lines connect users to movies with one box interrupting each edge with the rating given by the user for the movie.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our proposed method involves representing historical user-item interactions as edges between nodes in a bipartite graph with real-valued edge weights. These weights can represent the strength of these interactions (e.g. a rating out of 5). We also utilize latent space representations of users and items to condition the denoising process for the prediction of new interaction links (recommendations). In recommendation systems, the set of users and items (as well as their attributes) is fixed, so we focus on noising edge attributes of the interaction graph such as the adjacency matrix and edge weights in a continuous manner. Additionally, since recommender systems graphs are bipartite, we can represent the edge weights between users and items in a weighted interaction matrix, forming a 2D array similar to an image where each pixel represents the corresponding interaction strength between a user and item.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To the best of our knowledge, our work is the first to consider the interaction graph in a recommender system with both node features (per user and item) and the strength of interactions as edge weights. By conditioning on node features in the denoising model, we are able to guide the diffusion of weights over all possible interaction edges in the graph to approximate the expected interaction strengths.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Diffusion on Adjacency Matrices</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In the context of graph generation, a natural formulation of a diffusion model defines the noising process in the space of adjacency matrices. In this spirit, EDGE <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib3" title="">2023</a>)</cite> defines the transition kernel of the forward process as a Bernoulli distribution that resamples each edge with a time-varying positive probability. It aims to reconstruct the original graph by removing edges in the forward process, and denoising by adding edges in the reverse process. By explicitly modelling the node degrees and appropriately restricting each step of the backward process to a selected subset of “active” nodes, EDGE achieves promising performance and efficiency on larger graphs.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Diffusion Transformers</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">Transformer based denoising models (those that predict the noise added in a forward step by <math alttext="q(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">q</mi><mo id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"></times><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑞</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3"><minus id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.1"></minus><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">q(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> or predict <math alttext="x_{0}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">x</mi><mn id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑥</ci><cn id="S2.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> directly), have become the standard for image diffusion models. Considering our aim to perform continuous diffusion on a 2D weighted interaction matrix with similar characteristics to an image, our denoising model is inspired heavily by the architecture utilized in the recent work on Diffusion Transformers <cite class="ltx_cite ltx_citemacro_citep">(Peebles and Xie, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib11" title="">2023</a>)</cite>. Our main goal is to capitalize on the modeling capacity of scaled dot-product attention to capture neighborhood characteristics for each node in the interaction graph. We follow a similar approach to the original Diffusion Transformer architecture with regards to the usage of multi-head attention and time-step conditioning via adaptive layer-norms.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Diffusion-based Recommender Systems</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Due to the structure implied by user-item interactions, recommendation problems can be naturally reformulated as link prediction problems on graphs. Applications of graph convolutional networks <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib16" title="">2021</a>)</cite> to this task have been extensively studied, while applications of diffusion models here are relatively understudied. Recently, <cite class="ltx_cite ltx_citemacro_citet">Wang et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>)</cite> proposed DiffRec, a recommendation paradigm based on generative diffusion models. Given a user and a list of items, the diffusion process acts on the space of the interaction vectors. That is, it reconstructs one-hot encoded vectors representing whether the user has interacted with a specific item or not.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>Graph Diffusion Recommender Systems</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Subsequently, <cite class="ltx_cite ltx_citemacro_citet">Jiang et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib6" title="">2023</a>); Zhu et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib20" title="">2023</a>)</cite> have incorporated the graph structure of the interaction history, bridging the gap between recommendation systems and graph diffusion models. However, they still do not fully utilize user or item features, and perform the forward and reverse diffusion processes over the space of one-hot encodings for interactions, regardless of interaction strength.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">A concurrent work by <cite class="ltx_cite ltx_citemacro_citet">Yi et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib19" title="">2024</a>)</cite> formulates the problem of recommendation similarly, however, they first train a graph neural encoder to produce node (user/item) embeddings. In their experiment with continuous diffusion, they noise these embeddings in the forward process, and train a denoising model to recover the embeddings. Their graph neural encoder relies mainly on the graph defined by historical user-item interactions, and they additionally incorporate user/item features by measuring the similarity between user-user and item-item pairs based on their features.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1">Our work differs from their approach as we incorporate user and item features directly in our denoising model architecture rather than producing node embeddings using this information. While they perform diffusion over the space of these node embeddings, our diffusion process is applied to the space of weighted interaction matrices. As a result, our denoising model is able to directly predict interactions strengths whereas theirs recover node embeddings.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="194" id="S2.F2.g1" src="extracted/5872128/DiffRec.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>DiffRec - Starting from a one-hot vector of historical interactions, the forward process noises the user’s interaction history until timestep <math alttext="T" class="ltx_Math" display="inline" id="S2.F2.5.m1.1"><semantics id="S2.F2.5.m1.1b"><mi id="S2.F2.5.m1.1.1" xref="S2.F2.5.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.F2.5.m1.1c"><ci id="S2.F2.5.m1.1.1.cmml" xref="S2.F2.5.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S2.F2.5.m1.1e">italic_T</annotation></semantics></math> by the transition step <math alttext="q(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S2.F2.6.m2.1"><semantics id="S2.F2.6.m2.1b"><mrow id="S2.F2.6.m2.1.1" xref="S2.F2.6.m2.1.1.cmml"><mi id="S2.F2.6.m2.1.1.3" xref="S2.F2.6.m2.1.1.3.cmml">q</mi><mo id="S2.F2.6.m2.1.1.2" xref="S2.F2.6.m2.1.1.2.cmml">⁢</mo><mrow id="S2.F2.6.m2.1.1.1.1" xref="S2.F2.6.m2.1.1.1.1.1.cmml"><mo id="S2.F2.6.m2.1.1.1.1.2" stretchy="false" xref="S2.F2.6.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.F2.6.m2.1.1.1.1.1" xref="S2.F2.6.m2.1.1.1.1.1.cmml"><msub id="S2.F2.6.m2.1.1.1.1.1.2" xref="S2.F2.6.m2.1.1.1.1.1.2.cmml"><mi id="S2.F2.6.m2.1.1.1.1.1.2.2" xref="S2.F2.6.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.F2.6.m2.1.1.1.1.1.2.3" xref="S2.F2.6.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.F2.6.m2.1.1.1.1.1.1" xref="S2.F2.6.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.F2.6.m2.1.1.1.1.1.3" xref="S2.F2.6.m2.1.1.1.1.1.3.cmml"><mi id="S2.F2.6.m2.1.1.1.1.1.3.2" xref="S2.F2.6.m2.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.F2.6.m2.1.1.1.1.1.3.3" xref="S2.F2.6.m2.1.1.1.1.1.3.3.cmml"><mi id="S2.F2.6.m2.1.1.1.1.1.3.3.2" xref="S2.F2.6.m2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.F2.6.m2.1.1.1.1.1.3.3.1" xref="S2.F2.6.m2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.F2.6.m2.1.1.1.1.1.3.3.3" xref="S2.F2.6.m2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.F2.6.m2.1.1.1.1.3" stretchy="false" xref="S2.F2.6.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.6.m2.1c"><apply id="S2.F2.6.m2.1.1.cmml" xref="S2.F2.6.m2.1.1"><times id="S2.F2.6.m2.1.1.2.cmml" xref="S2.F2.6.m2.1.1.2"></times><ci id="S2.F2.6.m2.1.1.3.cmml" xref="S2.F2.6.m2.1.1.3">𝑞</ci><apply id="S2.F2.6.m2.1.1.1.1.1.cmml" xref="S2.F2.6.m2.1.1.1.1"><csymbol cd="latexml" id="S2.F2.6.m2.1.1.1.1.1.1.cmml" xref="S2.F2.6.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.F2.6.m2.1.1.1.1.1.2.cmml" xref="S2.F2.6.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F2.6.m2.1.1.1.1.1.2.1.cmml" xref="S2.F2.6.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.F2.6.m2.1.1.1.1.1.2.2.cmml" xref="S2.F2.6.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.F2.6.m2.1.1.1.1.1.2.3.cmml" xref="S2.F2.6.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.F2.6.m2.1.1.1.1.1.3.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F2.6.m2.1.1.1.1.1.3.1.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.F2.6.m2.1.1.1.1.1.3.2.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.F2.6.m2.1.1.1.1.1.3.3.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3.3"><minus id="S2.F2.6.m2.1.1.1.1.1.3.3.1.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3.3.1"></minus><ci id="S2.F2.6.m2.1.1.1.1.1.3.3.2.cmml" xref="S2.F2.6.m2.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.F2.6.m2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.F2.6.m2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m2.1d">q(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.m2.1e">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. The model is trained to recover <math alttext="x_{0}" class="ltx_Math" display="inline" id="S2.F2.7.m3.1"><semantics id="S2.F2.7.m3.1b"><msub id="S2.F2.7.m3.1.1" xref="S2.F2.7.m3.1.1.cmml"><mi id="S2.F2.7.m3.1.1.2" xref="S2.F2.7.m3.1.1.2.cmml">x</mi><mn id="S2.F2.7.m3.1.1.3" xref="S2.F2.7.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.m3.1c"><apply id="S2.F2.7.m3.1.1.cmml" xref="S2.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.7.m3.1.1.1.cmml" xref="S2.F2.7.m3.1.1">subscript</csymbol><ci id="S2.F2.7.m3.1.1.2.cmml" xref="S2.F2.7.m3.1.1.2">𝑥</ci><cn id="S2.F2.7.m3.1.1.3.cmml" type="integer" xref="S2.F2.7.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m3.1d">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.7.m3.1e">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> using <math alttext="p_{\theta}(x_{t-1}|x_{t})" class="ltx_Math" display="inline" id="S2.F2.8.m4.1"><semantics id="S2.F2.8.m4.1b"><mrow id="S2.F2.8.m4.1.1" xref="S2.F2.8.m4.1.1.cmml"><msub id="S2.F2.8.m4.1.1.3" xref="S2.F2.8.m4.1.1.3.cmml"><mi id="S2.F2.8.m4.1.1.3.2" xref="S2.F2.8.m4.1.1.3.2.cmml">p</mi><mi id="S2.F2.8.m4.1.1.3.3" xref="S2.F2.8.m4.1.1.3.3.cmml">θ</mi></msub><mo id="S2.F2.8.m4.1.1.2" xref="S2.F2.8.m4.1.1.2.cmml">⁢</mo><mrow id="S2.F2.8.m4.1.1.1.1" xref="S2.F2.8.m4.1.1.1.1.1.cmml"><mo id="S2.F2.8.m4.1.1.1.1.2" stretchy="false" xref="S2.F2.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.F2.8.m4.1.1.1.1.1" xref="S2.F2.8.m4.1.1.1.1.1.cmml"><msub id="S2.F2.8.m4.1.1.1.1.1.2" xref="S2.F2.8.m4.1.1.1.1.1.2.cmml"><mi id="S2.F2.8.m4.1.1.1.1.1.2.2" xref="S2.F2.8.m4.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S2.F2.8.m4.1.1.1.1.1.2.3" xref="S2.F2.8.m4.1.1.1.1.1.2.3.cmml"><mi id="S2.F2.8.m4.1.1.1.1.1.2.3.2" xref="S2.F2.8.m4.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.F2.8.m4.1.1.1.1.1.2.3.1" xref="S2.F2.8.m4.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.F2.8.m4.1.1.1.1.1.2.3.3" xref="S2.F2.8.m4.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.F2.8.m4.1.1.1.1.1.1" xref="S2.F2.8.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S2.F2.8.m4.1.1.1.1.1.3" xref="S2.F2.8.m4.1.1.1.1.1.3.cmml"><mi id="S2.F2.8.m4.1.1.1.1.1.3.2" xref="S2.F2.8.m4.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.F2.8.m4.1.1.1.1.1.3.3" xref="S2.F2.8.m4.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.F2.8.m4.1.1.1.1.3" stretchy="false" xref="S2.F2.8.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.8.m4.1c"><apply id="S2.F2.8.m4.1.1.cmml" xref="S2.F2.8.m4.1.1"><times id="S2.F2.8.m4.1.1.2.cmml" xref="S2.F2.8.m4.1.1.2"></times><apply id="S2.F2.8.m4.1.1.3.cmml" xref="S2.F2.8.m4.1.1.3"><csymbol cd="ambiguous" id="S2.F2.8.m4.1.1.3.1.cmml" xref="S2.F2.8.m4.1.1.3">subscript</csymbol><ci id="S2.F2.8.m4.1.1.3.2.cmml" xref="S2.F2.8.m4.1.1.3.2">𝑝</ci><ci id="S2.F2.8.m4.1.1.3.3.cmml" xref="S2.F2.8.m4.1.1.3.3">𝜃</ci></apply><apply id="S2.F2.8.m4.1.1.1.1.1.cmml" xref="S2.F2.8.m4.1.1.1.1"><csymbol cd="latexml" id="S2.F2.8.m4.1.1.1.1.1.1.cmml" xref="S2.F2.8.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S2.F2.8.m4.1.1.1.1.1.2.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F2.8.m4.1.1.1.1.1.2.1.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.F2.8.m4.1.1.1.1.1.2.2.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2.2">𝑥</ci><apply id="S2.F2.8.m4.1.1.1.1.1.2.3.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2.3"><minus id="S2.F2.8.m4.1.1.1.1.1.2.3.1.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2.3.1"></minus><ci id="S2.F2.8.m4.1.1.1.1.1.2.3.2.cmml" xref="S2.F2.8.m4.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S2.F2.8.m4.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.F2.8.m4.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.F2.8.m4.1.1.1.1.1.3.cmml" xref="S2.F2.8.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F2.8.m4.1.1.1.1.1.3.1.cmml" xref="S2.F2.8.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.F2.8.m4.1.1.1.1.1.3.2.cmml" xref="S2.F2.8.m4.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.F2.8.m4.1.1.1.1.1.3.3.cmml" xref="S2.F2.8.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m4.1d">p_{\theta}(x_{t-1}|x_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.F2.8.m4.1e">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>)</cite>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F2.9">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F2.10">Visual overview of diffusion process where a one-hot vector is visualized as a bar graph. Arrows in the forward direction point to new bar graphs representing weights in the one-hot vector being noised. Arrows in the reverse direction point to the previous denoised bar graph representing the one-hot encoded vector.</p>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Preliminaries</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.3">In the traditional formulation of denoising diffusion models <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib5" title="">2020</a>)</cite>, the forward diffusion process gradually adds Gaussian noise to the original data, <math alttext="\mathbf{x}_{0}\sim q(\mathbf{x})" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2" xref="S3.p1.1.m1.1.2.cmml"><msub id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.2.cmml"><mi id="S3.p1.1.m1.1.2.2.2" xref="S3.p1.1.m1.1.2.2.2.cmml">𝐱</mi><mn id="S3.p1.1.m1.1.2.2.3" xref="S3.p1.1.m1.1.2.2.3.cmml">0</mn></msub><mo id="S3.p1.1.m1.1.2.1" xref="S3.p1.1.m1.1.2.1.cmml">∼</mo><mrow id="S3.p1.1.m1.1.2.3" xref="S3.p1.1.m1.1.2.3.cmml"><mi id="S3.p1.1.m1.1.2.3.2" xref="S3.p1.1.m1.1.2.3.2.cmml">q</mi><mo id="S3.p1.1.m1.1.2.3.1" xref="S3.p1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.p1.1.m1.1.2.3.3.2" xref="S3.p1.1.m1.1.2.3.cmml"><mo id="S3.p1.1.m1.1.2.3.3.2.1" stretchy="false" xref="S3.p1.1.m1.1.2.3.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.p1.1.m1.1.2.3.3.2.2" stretchy="false" xref="S3.p1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.cmml" xref="S3.p1.1.m1.1.2"><csymbol cd="latexml" id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.1">similar-to</csymbol><apply id="S3.p1.1.m1.1.2.2.cmml" xref="S3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.2.2.1.cmml" xref="S3.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.p1.1.m1.1.2.2.2.cmml" xref="S3.p1.1.m1.1.2.2.2">𝐱</ci><cn id="S3.p1.1.m1.1.2.2.3.cmml" type="integer" xref="S3.p1.1.m1.1.2.2.3">0</cn></apply><apply id="S3.p1.1.m1.1.2.3.cmml" xref="S3.p1.1.m1.1.2.3"><times id="S3.p1.1.m1.1.2.3.1.cmml" xref="S3.p1.1.m1.1.2.3.1"></times><ci id="S3.p1.1.m1.1.2.3.2.cmml" xref="S3.p1.1.m1.1.2.3.2">𝑞</ci><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{x}_{0}\sim q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_q ( bold_x )</annotation></semantics></math>, over <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_T</annotation></semantics></math> diffusion steps to reach random Gaussian noise, <math alttext="\mathbf{x}_{T}\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.p1.3.m3.2"><semantics id="S3.p1.3.m3.2a"><mrow id="S3.p1.3.m3.2.3" xref="S3.p1.3.m3.2.3.cmml"><msub id="S3.p1.3.m3.2.3.2" xref="S3.p1.3.m3.2.3.2.cmml"><mi id="S3.p1.3.m3.2.3.2.2" xref="S3.p1.3.m3.2.3.2.2.cmml">𝐱</mi><mi id="S3.p1.3.m3.2.3.2.3" xref="S3.p1.3.m3.2.3.2.3.cmml">T</mi></msub><mo id="S3.p1.3.m3.2.3.1" xref="S3.p1.3.m3.2.3.1.cmml">∼</mo><mrow id="S3.p1.3.m3.2.3.3" xref="S3.p1.3.m3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.2.3.3.2" xref="S3.p1.3.m3.2.3.3.2.cmml">𝒩</mi><mo id="S3.p1.3.m3.2.3.3.1" xref="S3.p1.3.m3.2.3.3.1.cmml">⁢</mo><mrow id="S3.p1.3.m3.2.3.3.3.2" xref="S3.p1.3.m3.2.3.3.3.1.cmml"><mo id="S3.p1.3.m3.2.3.3.3.2.1" stretchy="false" xref="S3.p1.3.m3.2.3.3.3.1.cmml">(</mo><mn id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">0</mn><mo id="S3.p1.3.m3.2.3.3.3.2.2" xref="S3.p1.3.m3.2.3.3.3.1.cmml">,</mo><mi id="S3.p1.3.m3.2.2" xref="S3.p1.3.m3.2.2.cmml">𝐈</mi><mo id="S3.p1.3.m3.2.3.3.3.2.3" stretchy="false" xref="S3.p1.3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.2b"><apply id="S3.p1.3.m3.2.3.cmml" xref="S3.p1.3.m3.2.3"><csymbol cd="latexml" id="S3.p1.3.m3.2.3.1.cmml" xref="S3.p1.3.m3.2.3.1">similar-to</csymbol><apply id="S3.p1.3.m3.2.3.2.cmml" xref="S3.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.2.3.2.1.cmml" xref="S3.p1.3.m3.2.3.2">subscript</csymbol><ci id="S3.p1.3.m3.2.3.2.2.cmml" xref="S3.p1.3.m3.2.3.2.2">𝐱</ci><ci id="S3.p1.3.m3.2.3.2.3.cmml" xref="S3.p1.3.m3.2.3.2.3">𝑇</ci></apply><apply id="S3.p1.3.m3.2.3.3.cmml" xref="S3.p1.3.m3.2.3.3"><times id="S3.p1.3.m3.2.3.3.1.cmml" xref="S3.p1.3.m3.2.3.3.1"></times><ci id="S3.p1.3.m3.2.3.3.2.cmml" xref="S3.p1.3.m3.2.3.3.2">𝒩</ci><interval closure="open" id="S3.p1.3.m3.2.3.3.3.1.cmml" xref="S3.p1.3.m3.2.3.3.3.2"><cn id="S3.p1.3.m3.1.1.cmml" type="integer" xref="S3.p1.3.m3.1.1">0</cn><ci id="S3.p1.3.m3.2.2.cmml" xref="S3.p1.3.m3.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.2c">\mathbf{x}_{T}\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.2d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math>. Each diffusion step corrupts the noised representation from the previous step:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\mathcal{N}(\mathbf{x}_{t};\sqrt{1-\beta_{t%
}}\mathbf{x}_{t-1},\beta_{t}\mathbf{I})" class="ltx_Math" display="block" id="S3.Ex1.m1.4"><semantics id="S3.Ex1.m1.4a"><mrow id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml">q</mi><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.Ex1.m1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.3.3.1" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.4.4.5" xref="S3.Ex1.m1.4.4.5.cmml">=</mo><mrow id="S3.Ex1.m1.4.4.4" xref="S3.Ex1.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.4.4.4.5" xref="S3.Ex1.m1.4.4.4.5.cmml">𝒩</mi><mo id="S3.Ex1.m1.4.4.4.4" xref="S3.Ex1.m1.4.4.4.4.cmml">⁢</mo><mrow id="S3.Ex1.m1.4.4.4.3.3" xref="S3.Ex1.m1.4.4.4.3.4.cmml"><mo id="S3.Ex1.m1.4.4.4.3.3.4" stretchy="false" xref="S3.Ex1.m1.4.4.4.3.4.cmml">(</mo><msub id="S3.Ex1.m1.2.2.2.1.1.1" xref="S3.Ex1.m1.2.2.2.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex1.m1.2.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex1.m1.4.4.4.3.3.5" xref="S3.Ex1.m1.4.4.4.3.4.cmml">;</mo><mrow id="S3.Ex1.m1.3.3.3.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.cmml"><msqrt id="S3.Ex1.m1.3.3.3.2.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.2.cmml"><mrow id="S3.Ex1.m1.3.3.3.2.2.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.cmml"><mn id="S3.Ex1.m1.3.3.3.2.2.2.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.2.cmml">1</mn><mo id="S3.Ex1.m1.3.3.3.2.2.2.2.2.1" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.1.cmml">−</mo><msub id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.2" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.2.cmml">β</mi><mi id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.3" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.Ex1.m1.3.3.3.2.2.2.1" xref="S3.Ex1.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex1.m1.3.3.3.2.2.2.3" xref="S3.Ex1.m1.3.3.3.2.2.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.2.2.2.3.2" xref="S3.Ex1.m1.3.3.3.2.2.2.3.2.cmml">𝐱</mi><mrow id="S3.Ex1.m1.3.3.3.2.2.2.3.3" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.2.2.2.3.3.2" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.2.cmml">t</mi><mo id="S3.Ex1.m1.3.3.3.2.2.2.3.3.1" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.1.cmml">−</mo><mn id="S3.Ex1.m1.3.3.3.2.2.2.3.3.3" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex1.m1.4.4.4.3.3.6" xref="S3.Ex1.m1.4.4.4.3.4.cmml">,</mo><mrow id="S3.Ex1.m1.4.4.4.3.3.3" xref="S3.Ex1.m1.4.4.4.3.3.3.cmml"><msub id="S3.Ex1.m1.4.4.4.3.3.3.2" xref="S3.Ex1.m1.4.4.4.3.3.3.2.cmml"><mi id="S3.Ex1.m1.4.4.4.3.3.3.2.2" xref="S3.Ex1.m1.4.4.4.3.3.3.2.2.cmml">β</mi><mi id="S3.Ex1.m1.4.4.4.3.3.3.2.3" xref="S3.Ex1.m1.4.4.4.3.3.3.2.3.cmml">t</mi></msub><mo id="S3.Ex1.m1.4.4.4.3.3.3.1" xref="S3.Ex1.m1.4.4.4.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.4.4.4.3.3.3.3" xref="S3.Ex1.m1.4.4.4.3.3.3.3.cmml">𝐈</mi></mrow><mo id="S3.Ex1.m1.4.4.4.3.3.7" stretchy="false" xref="S3.Ex1.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.4b"><apply id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4"><eq id="S3.Ex1.m1.4.4.5.cmml" xref="S3.Ex1.m1.4.4.5"></eq><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3">𝑞</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3"><minus id="S3.Ex1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.Ex1.m1.4.4.4.cmml" xref="S3.Ex1.m1.4.4.4"><times id="S3.Ex1.m1.4.4.4.4.cmml" xref="S3.Ex1.m1.4.4.4.4"></times><ci id="S3.Ex1.m1.4.4.4.5.cmml" xref="S3.Ex1.m1.4.4.4.5">𝒩</ci><list id="S3.Ex1.m1.4.4.4.3.4.cmml" xref="S3.Ex1.m1.4.4.4.3.3"><apply id="S3.Ex1.m1.2.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.2">𝐱</ci><ci id="S3.Ex1.m1.2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex1.m1.3.3.3.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2"><times id="S3.Ex1.m1.3.3.3.2.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.1"></times><apply id="S3.Ex1.m1.3.3.3.2.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2"><root id="S3.Ex1.m1.3.3.3.2.2.2.2a.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2"></root><apply id="S3.Ex1.m1.3.3.3.2.2.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2"><minus id="S3.Ex1.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.1"></minus><cn id="S3.Ex1.m1.3.3.3.2.2.2.2.2.2.cmml" type="integer" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.2">1</cn><apply id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.2">𝛽</ci><ci id="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex1.m1.3.3.3.2.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.2.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.2.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3.2">𝐱</ci><apply id="S3.Ex1.m1.3.3.3.2.2.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3"><minus id="S3.Ex1.m1.3.3.3.2.2.2.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.1"></minus><ci id="S3.Ex1.m1.3.3.3.2.2.2.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.2">𝑡</ci><cn id="S3.Ex1.m1.3.3.3.2.2.2.3.3.3.cmml" type="integer" xref="S3.Ex1.m1.3.3.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex1.m1.4.4.4.3.3.3.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3"><times id="S3.Ex1.m1.4.4.4.3.3.3.1.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.1"></times><apply id="S3.Ex1.m1.4.4.4.3.3.3.2.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.3.3.3.2.1.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.3.3.3.2.2.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.2.2">𝛽</ci><ci id="S3.Ex1.m1.4.4.4.3.3.3.2.3.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.Ex1.m1.4.4.4.3.3.3.3.cmml" xref="S3.Ex1.m1.4.4.4.3.3.3.3">𝐈</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\mathcal{N}(\mathbf{x}_{t};\sqrt{1-\beta_{t%
}}\mathbf{x}_{t-1},\beta_{t}\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.4d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.5">Where <math alttext="\{\beta_{t}\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S3.p1.4.m1.1"><semantics id="S3.p1.4.m1.1a"><msubsup id="S3.p1.4.m1.1.1" xref="S3.p1.4.m1.1.1.cmml"><mrow id="S3.p1.4.m1.1.1.1.1.1" xref="S3.p1.4.m1.1.1.1.1.2.cmml"><mo id="S3.p1.4.m1.1.1.1.1.1.2" stretchy="false" xref="S3.p1.4.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.p1.4.m1.1.1.1.1.1.1" xref="S3.p1.4.m1.1.1.1.1.1.1.cmml"><mi id="S3.p1.4.m1.1.1.1.1.1.1.2" xref="S3.p1.4.m1.1.1.1.1.1.1.2.cmml">β</mi><mi id="S3.p1.4.m1.1.1.1.1.1.1.3" xref="S3.p1.4.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.4.m1.1.1.1.1.1.3" stretchy="false" xref="S3.p1.4.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p1.4.m1.1.1.1.3" xref="S3.p1.4.m1.1.1.1.3.cmml"><mi id="S3.p1.4.m1.1.1.1.3.2" xref="S3.p1.4.m1.1.1.1.3.2.cmml">t</mi><mo id="S3.p1.4.m1.1.1.1.3.1" xref="S3.p1.4.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.p1.4.m1.1.1.1.3.3" xref="S3.p1.4.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p1.4.m1.1.1.3" xref="S3.p1.4.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.4.m1.1b"><apply id="S3.p1.4.m1.1.1.cmml" xref="S3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m1.1.1.2.cmml" xref="S3.p1.4.m1.1.1">superscript</csymbol><apply id="S3.p1.4.m1.1.1.1.cmml" xref="S3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m1.1.1.1.2.cmml" xref="S3.p1.4.m1.1.1">subscript</csymbol><set id="S3.p1.4.m1.1.1.1.1.2.cmml" xref="S3.p1.4.m1.1.1.1.1.1"><apply id="S3.p1.4.m1.1.1.1.1.1.1.cmml" xref="S3.p1.4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.p1.4.m1.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.p1.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.p1.4.m1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.p1.4.m1.1.1.1.3.cmml" xref="S3.p1.4.m1.1.1.1.3"><eq id="S3.p1.4.m1.1.1.1.3.1.cmml" xref="S3.p1.4.m1.1.1.1.3.1"></eq><ci id="S3.p1.4.m1.1.1.1.3.2.cmml" xref="S3.p1.4.m1.1.1.1.3.2">𝑡</ci><cn id="S3.p1.4.m1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.4.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p1.4.m1.1.1.3.cmml" xref="S3.p1.4.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m1.1c">\{\beta_{t}\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m1.1d">{ italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> are the noise-schedule hyper-parameters controlling the amount of noise added at each step. Note <math alttext="\beta_{t}\in(0,1)" class="ltx_Math" display="inline" id="S3.p1.5.m2.2"><semantics id="S3.p1.5.m2.2a"><mrow id="S3.p1.5.m2.2.3" xref="S3.p1.5.m2.2.3.cmml"><msub id="S3.p1.5.m2.2.3.2" xref="S3.p1.5.m2.2.3.2.cmml"><mi id="S3.p1.5.m2.2.3.2.2" xref="S3.p1.5.m2.2.3.2.2.cmml">β</mi><mi id="S3.p1.5.m2.2.3.2.3" xref="S3.p1.5.m2.2.3.2.3.cmml">t</mi></msub><mo id="S3.p1.5.m2.2.3.1" xref="S3.p1.5.m2.2.3.1.cmml">∈</mo><mrow id="S3.p1.5.m2.2.3.3.2" xref="S3.p1.5.m2.2.3.3.1.cmml"><mo id="S3.p1.5.m2.2.3.3.2.1" stretchy="false" xref="S3.p1.5.m2.2.3.3.1.cmml">(</mo><mn id="S3.p1.5.m2.1.1" xref="S3.p1.5.m2.1.1.cmml">0</mn><mo id="S3.p1.5.m2.2.3.3.2.2" xref="S3.p1.5.m2.2.3.3.1.cmml">,</mo><mn id="S3.p1.5.m2.2.2" xref="S3.p1.5.m2.2.2.cmml">1</mn><mo id="S3.p1.5.m2.2.3.3.2.3" stretchy="false" xref="S3.p1.5.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m2.2b"><apply id="S3.p1.5.m2.2.3.cmml" xref="S3.p1.5.m2.2.3"><in id="S3.p1.5.m2.2.3.1.cmml" xref="S3.p1.5.m2.2.3.1"></in><apply id="S3.p1.5.m2.2.3.2.cmml" xref="S3.p1.5.m2.2.3.2"><csymbol cd="ambiguous" id="S3.p1.5.m2.2.3.2.1.cmml" xref="S3.p1.5.m2.2.3.2">subscript</csymbol><ci id="S3.p1.5.m2.2.3.2.2.cmml" xref="S3.p1.5.m2.2.3.2.2">𝛽</ci><ci id="S3.p1.5.m2.2.3.2.3.cmml" xref="S3.p1.5.m2.2.3.2.3">𝑡</ci></apply><interval closure="open" id="S3.p1.5.m2.2.3.3.1.cmml" xref="S3.p1.5.m2.2.3.3.2"><cn id="S3.p1.5.m2.1.1.cmml" type="integer" xref="S3.p1.5.m2.1.1">0</cn><cn id="S3.p1.5.m2.2.2.cmml" type="integer" xref="S3.p1.5.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m2.2c">\beta_{t}\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m2.2d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ ( 0 , 1 )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.2"><cite class="ltx_cite ltx_citemacro_citet">Ho et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib5" title="">2020</a>)</cite> also provide the analytical form for <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝐱</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> given <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">𝐱</mi><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝐱</ci><cn id="S3.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="A2.EGx1.3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle q(\mathbf{x}_{t}|\mathbf{x}_{0})" class="ltx_Math" display="inline" id="A2.EGx1.1.m1.1"><semantics id="A2.EGx1.1.m1.1a"><mrow id="A2.EGx1.1.m1.1.1" xref="A2.EGx1.1.m1.1.1.cmml"><mi id="A2.EGx1.1.m1.1.1.3" xref="A2.EGx1.1.m1.1.1.3.cmml">q</mi><mo id="A2.EGx1.1.m1.1.1.2" xref="A2.EGx1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A2.EGx1.1.m1.1.1.1.1" xref="A2.EGx1.1.m1.1.1.1.1.1.cmml"><mo id="A2.EGx1.1.m1.1.1.1.1.2" stretchy="false" xref="A2.EGx1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A2.EGx1.1.m1.1.1.1.1.1" xref="A2.EGx1.1.m1.1.1.1.1.1.cmml"><msub id="A2.EGx1.1.m1.1.1.1.1.1.2" xref="A2.EGx1.1.m1.1.1.1.1.1.2.cmml"><mi id="A2.EGx1.1.m1.1.1.1.1.1.2.2" xref="A2.EGx1.1.m1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A2.EGx1.1.m1.1.1.1.1.1.2.3" xref="A2.EGx1.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A2.EGx1.1.m1.1.1.1.1.1.1" xref="A2.EGx1.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="A2.EGx1.1.m1.1.1.1.1.1.3" xref="A2.EGx1.1.m1.1.1.1.1.1.3.cmml"><mi id="A2.EGx1.1.m1.1.1.1.1.1.3.2" xref="A2.EGx1.1.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mn id="A2.EGx1.1.m1.1.1.1.1.1.3.3" xref="A2.EGx1.1.m1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A2.EGx1.1.m1.1.1.1.1.3" stretchy="false" xref="A2.EGx1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.EGx1.1.m1.1b"><apply id="A2.EGx1.1.m1.1.1.cmml" xref="A2.EGx1.1.m1.1.1"><times id="A2.EGx1.1.m1.1.1.2.cmml" xref="A2.EGx1.1.m1.1.1.2"></times><ci id="A2.EGx1.1.m1.1.1.3.cmml" xref="A2.EGx1.1.m1.1.1.3">𝑞</ci><apply id="A2.EGx1.1.m1.1.1.1.1.1.cmml" xref="A2.EGx1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A2.EGx1.1.m1.1.1.1.1.1.1.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A2.EGx1.1.m1.1.1.1.1.1.2.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.EGx1.1.m1.1.1.1.1.1.2.1.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.EGx1.1.m1.1.1.1.1.1.2.2.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.2.2">𝐱</ci><ci id="A2.EGx1.1.m1.1.1.1.1.1.2.3.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A2.EGx1.1.m1.1.1.1.1.1.3.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.EGx1.1.m1.1.1.1.1.1.3.1.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.EGx1.1.m1.1.1.1.1.1.3.2.cmml" xref="A2.EGx1.1.m1.1.1.1.1.1.3.2">𝐱</ci><cn id="A2.EGx1.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A2.EGx1.1.m1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.EGx1.1.m1.1c">\displaystyle q(\mathbf{x}_{t}|\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="A2.EGx1.1.m1.1d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{N}(\mathbf{x}_{t};\sqrt{\widebar{\alpha}_{t}}\mathbf{x}%
_{0},(1-\widebar{\alpha}_{t})\mathbf{I}" class="ltx_math_unparsed" display="inline" id="A2.EGx1.2.m2.1"><semantics id="A2.EGx1.2.m2.1a"><mrow id="A2.EGx1.2.m2.1b"><mo id="A2.EGx1.2.m2.1.1">=</mo><mi class="ltx_font_mathcaligraphic" id="A2.EGx1.2.m2.1.2">𝒩</mi><mrow id="A2.EGx1.2.m2.1.3"><mo id="A2.EGx1.2.m2.1.3.1" stretchy="false">(</mo><msub id="A2.EGx1.2.m2.1.3.2"><mi id="A2.EGx1.2.m2.1.3.2.2">𝐱</mi><mi id="A2.EGx1.2.m2.1.3.2.3">t</mi></msub><mo id="A2.EGx1.2.m2.1.3.3">;</mo><msqrt id="A2.EGx1.2.m2.1.3.4"><mrow id="A2.EGx1.2.m2.1.3.4.2"><merror class="ltx_ERROR undefined undefined" id="A2.EGx1.2.m2.1.3.4.2.2"><mtext id="A2.EGx1.2.m2.1.3.4.2.2a">\widebar</mtext></merror><mo id="A2.EGx1.2.m2.1.3.4.2.1">⁢</mo><msub id="A2.EGx1.2.m2.1.3.4.2.3"><mi id="A2.EGx1.2.m2.1.3.4.2.3.2">α</mi><mi id="A2.EGx1.2.m2.1.3.4.2.3.3">t</mi></msub></mrow></msqrt><msub id="A2.EGx1.2.m2.1.3.5"><mi id="A2.EGx1.2.m2.1.3.5.2">𝐱</mi><mn id="A2.EGx1.2.m2.1.3.5.3">0</mn></msub><mo id="A2.EGx1.2.m2.1.3.6">,</mo><mrow id="A2.EGx1.2.m2.1.3.7"><mo id="A2.EGx1.2.m2.1.3.7.1" stretchy="false">(</mo><mn id="A2.EGx1.2.m2.1.3.7.2">1</mn><mo id="A2.EGx1.2.m2.1.3.7.3">−</mo><merror class="ltx_ERROR undefined undefined" id="A2.EGx1.2.m2.1.3.7.4"><mtext id="A2.EGx1.2.m2.1.3.7.4a">\widebar</mtext></merror><msub id="A2.EGx1.2.m2.1.3.7.5"><mi id="A2.EGx1.2.m2.1.3.7.5.2">α</mi><mi id="A2.EGx1.2.m2.1.3.7.5.3">t</mi></msub><mo id="A2.EGx1.2.m2.1.3.7.6" stretchy="false">)</mo></mrow><mi id="A2.EGx1.2.m2.1.3.8">𝐈</mi></mrow></mrow><annotation encoding="application/x-tex" id="A2.EGx1.2.m2.1c">\displaystyle=\mathcal{N}(\mathbf{x}_{t};\sqrt{\widebar{\alpha}_{t}}\mathbf{x}%
_{0},(1-\widebar{\alpha}_{t})\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="A2.EGx1.2.m2.1d">= caligraphic_N ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , ( 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) bold_I</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright" colspan="2"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sqrt{\widebar{\alpha}_{t}}\mathbf{x}_{0}+\sqrt{1-\widebar{%
\alpha}_{t}}\epsilon," class="ltx_Math" display="inline" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.3.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.1.3.2.cmml"><msqrt id="S3.Ex2.m1.1.1.1.1.3.2.2" xref="S3.Ex2.m1.1.1.1.1.3.2.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.3.2.2.2" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex2.m1.1.1.1.1.3.2.2.2.2" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.2b.cmml"><mtext id="S3.Ex2.m1.1.1.1.1.3.2.2.2.2a" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex2.m1.1.1.1.1.3.2.2.2.1" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.2" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.2.cmml">α</mi><mi id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.Ex2.m1.1.1.1.1.3.2.1" xref="S3.Ex2.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.1.1.3.2.3" xref="S3.Ex2.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.3.2.3.2" xref="S3.Ex2.m1.1.1.1.1.3.2.3.2.cmml">𝐱</mi><mn id="S3.Ex2.m1.1.1.1.1.3.2.3.3" xref="S3.Ex2.m1.1.1.1.1.3.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.Ex2.m1.1.1.1.1.3.1" xref="S3.Ex2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.Ex2.m1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.3.3.cmml"><msqrt id="S3.Ex2.m1.1.1.1.1.3.3.2" xref="S3.Ex2.m1.1.1.1.1.3.3.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.3.3.2.2" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.cmml"><mn id="S3.Ex2.m1.1.1.1.1.3.3.2.2.2" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.2.cmml">1</mn><mo id="S3.Ex2.m1.1.1.1.1.3.3.2.2.1" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.1.cmml">−</mo><mrow id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2b.cmml"><mtext id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2a" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.1" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.2" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.2.cmml">α</mi><mi id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.3" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.3.cmml">t</mi></msub></mrow></mrow></msqrt><mo id="S3.Ex2.m1.1.1.1.1.3.3.1" xref="S3.Ex2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.1.1.3.3.3" xref="S3.Ex2.m1.1.1.1.1.3.3.3.cmml">ϵ</mi></mrow></mrow></mrow><mo id="S3.Ex2.m1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"><eq id="S3.Ex2.m1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.Ex2.m1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.Ex2.m1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3"><plus id="S3.Ex2.m1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.1"></plus><apply id="S3.Ex2.m1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2"><times id="S3.Ex2.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.1"></times><apply id="S3.Ex2.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2"><root id="S3.Ex2.m1.1.1.1.1.3.2.2a.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2"></root><apply id="S3.Ex2.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2"><times id="S3.Ex2.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.1"></times><ci id="S3.Ex2.m1.1.1.1.1.3.2.2.2.2b.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex2.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.2"><mtext id="S3.Ex2.m1.1.1.1.1.3.2.2.2.2a.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.2">\widebar</mtext></merror></ci><apply id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.2">𝛼</ci><ci id="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2.3.2">𝐱</ci><cn id="S3.Ex2.m1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.Ex2.m1.1.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3"><times id="S3.Ex2.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.1"></times><apply id="S3.Ex2.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2"><root id="S3.Ex2.m1.1.1.1.1.3.3.2a.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2"></root><apply id="S3.Ex2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2"><minus id="S3.Ex2.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.1"></minus><cn id="S3.Ex2.m1.1.1.1.1.3.3.2.2.2.cmml" type="integer" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.2">1</cn><apply id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3"><times id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.1"></times><ci id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2b.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2"><mtext id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2a.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.2">𝛼</ci><ci id="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply><ci id="S3.Ex2.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle=\sqrt{\widebar{\alpha}_{t}}\mathbf{x}_{0}+\sqrt{1-\widebar{%
\alpha}_{t}}\epsilon,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">= square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + square-root start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_ϵ ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\epsilon\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.Ex2.m2.2"><semantics id="S3.Ex2.m2.2a"><mrow id="S3.Ex2.m2.2.3" xref="S3.Ex2.m2.2.3.cmml"><mi id="S3.Ex2.m2.2.3.2" xref="S3.Ex2.m2.2.3.2.cmml">ϵ</mi><mo id="S3.Ex2.m2.2.3.1" xref="S3.Ex2.m2.2.3.1.cmml">∼</mo><mrow id="S3.Ex2.m2.2.3.3" xref="S3.Ex2.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.2.3.3.2" xref="S3.Ex2.m2.2.3.3.2.cmml">𝒩</mi><mo id="S3.Ex2.m2.2.3.3.1" xref="S3.Ex2.m2.2.3.3.1.cmml">⁢</mo><mrow id="S3.Ex2.m2.2.3.3.3.2" xref="S3.Ex2.m2.2.3.3.3.1.cmml"><mo id="S3.Ex2.m2.2.3.3.3.2.1" stretchy="false" xref="S3.Ex2.m2.2.3.3.3.1.cmml">(</mo><mn id="S3.Ex2.m2.1.1" xref="S3.Ex2.m2.1.1.cmml">0</mn><mo id="S3.Ex2.m2.2.3.3.3.2.2" xref="S3.Ex2.m2.2.3.3.3.1.cmml">,</mo><mi id="S3.Ex2.m2.2.2" xref="S3.Ex2.m2.2.2.cmml">𝐈</mi><mo id="S3.Ex2.m2.2.3.3.3.2.3" stretchy="false" xref="S3.Ex2.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.2b"><apply id="S3.Ex2.m2.2.3.cmml" xref="S3.Ex2.m2.2.3"><csymbol cd="latexml" id="S3.Ex2.m2.2.3.1.cmml" xref="S3.Ex2.m2.2.3.1">similar-to</csymbol><ci id="S3.Ex2.m2.2.3.2.cmml" xref="S3.Ex2.m2.2.3.2">italic-ϵ</ci><apply id="S3.Ex2.m2.2.3.3.cmml" xref="S3.Ex2.m2.2.3.3"><times id="S3.Ex2.m2.2.3.3.1.cmml" xref="S3.Ex2.m2.2.3.3.1"></times><ci id="S3.Ex2.m2.2.3.3.2.cmml" xref="S3.Ex2.m2.2.3.3.2">𝒩</ci><interval closure="open" id="S3.Ex2.m2.2.3.3.3.1.cmml" xref="S3.Ex2.m2.2.3.3.3.2"><cn id="S3.Ex2.m2.1.1.cmml" type="integer" xref="S3.Ex2.m2.1.1">0</cn><ci id="S3.Ex2.m2.2.2.cmml" xref="S3.Ex2.m2.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.2c">\displaystyle\epsilon\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m2.2d">italic_ϵ ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.7">Where <math alttext="\alpha_{t}=1-\beta_{t}" class="ltx_Math" display="inline" id="S3.p2.3.m1.1"><semantics id="S3.p2.3.m1.1a"><mrow id="S3.p2.3.m1.1.1" xref="S3.p2.3.m1.1.1.cmml"><msub id="S3.p2.3.m1.1.1.2" xref="S3.p2.3.m1.1.1.2.cmml"><mi id="S3.p2.3.m1.1.1.2.2" xref="S3.p2.3.m1.1.1.2.2.cmml">α</mi><mi id="S3.p2.3.m1.1.1.2.3" xref="S3.p2.3.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.p2.3.m1.1.1.1" xref="S3.p2.3.m1.1.1.1.cmml">=</mo><mrow id="S3.p2.3.m1.1.1.3" xref="S3.p2.3.m1.1.1.3.cmml"><mn id="S3.p2.3.m1.1.1.3.2" xref="S3.p2.3.m1.1.1.3.2.cmml">1</mn><mo id="S3.p2.3.m1.1.1.3.1" xref="S3.p2.3.m1.1.1.3.1.cmml">−</mo><msub id="S3.p2.3.m1.1.1.3.3" xref="S3.p2.3.m1.1.1.3.3.cmml"><mi id="S3.p2.3.m1.1.1.3.3.2" xref="S3.p2.3.m1.1.1.3.3.2.cmml">β</mi><mi id="S3.p2.3.m1.1.1.3.3.3" xref="S3.p2.3.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m1.1b"><apply id="S3.p2.3.m1.1.1.cmml" xref="S3.p2.3.m1.1.1"><eq id="S3.p2.3.m1.1.1.1.cmml" xref="S3.p2.3.m1.1.1.1"></eq><apply id="S3.p2.3.m1.1.1.2.cmml" xref="S3.p2.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.3.m1.1.1.2.1.cmml" xref="S3.p2.3.m1.1.1.2">subscript</csymbol><ci id="S3.p2.3.m1.1.1.2.2.cmml" xref="S3.p2.3.m1.1.1.2.2">𝛼</ci><ci id="S3.p2.3.m1.1.1.2.3.cmml" xref="S3.p2.3.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.p2.3.m1.1.1.3.cmml" xref="S3.p2.3.m1.1.1.3"><minus id="S3.p2.3.m1.1.1.3.1.cmml" xref="S3.p2.3.m1.1.1.3.1"></minus><cn id="S3.p2.3.m1.1.1.3.2.cmml" type="integer" xref="S3.p2.3.m1.1.1.3.2">1</cn><apply id="S3.p2.3.m1.1.1.3.3.cmml" xref="S3.p2.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.3.m1.1.1.3.3.1.cmml" xref="S3.p2.3.m1.1.1.3.3">subscript</csymbol><ci id="S3.p2.3.m1.1.1.3.3.2.cmml" xref="S3.p2.3.m1.1.1.3.3.2">𝛽</ci><ci id="S3.p2.3.m1.1.1.3.3.3.cmml" xref="S3.p2.3.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m1.1c">\alpha_{t}=1-\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\widebar{\alpha}_{t}=\Pi_{i=1}^{t}\alpha_{i}" class="ltx_Math" display="inline" id="S3.p2.4.m2.1"><semantics id="S3.p2.4.m2.1a"><mrow id="S3.p2.4.m2.1.1" xref="S3.p2.4.m2.1.1.cmml"><mrow id="S3.p2.4.m2.1.1.2" xref="S3.p2.4.m2.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.p2.4.m2.1.1.2.2" xref="S3.p2.4.m2.1.1.2.2b.cmml"><mtext id="S3.p2.4.m2.1.1.2.2a" xref="S3.p2.4.m2.1.1.2.2b.cmml">\widebar</mtext></merror><mo id="S3.p2.4.m2.1.1.2.1" xref="S3.p2.4.m2.1.1.2.1.cmml">⁢</mo><msub id="S3.p2.4.m2.1.1.2.3" xref="S3.p2.4.m2.1.1.2.3.cmml"><mi id="S3.p2.4.m2.1.1.2.3.2" xref="S3.p2.4.m2.1.1.2.3.2.cmml">α</mi><mi id="S3.p2.4.m2.1.1.2.3.3" xref="S3.p2.4.m2.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.p2.4.m2.1.1.1" xref="S3.p2.4.m2.1.1.1.cmml">=</mo><mrow id="S3.p2.4.m2.1.1.3" xref="S3.p2.4.m2.1.1.3.cmml"><msubsup id="S3.p2.4.m2.1.1.3.2" xref="S3.p2.4.m2.1.1.3.2.cmml"><mi id="S3.p2.4.m2.1.1.3.2.2.2" mathvariant="normal" xref="S3.p2.4.m2.1.1.3.2.2.2.cmml">Π</mi><mrow id="S3.p2.4.m2.1.1.3.2.2.3" xref="S3.p2.4.m2.1.1.3.2.2.3.cmml"><mi id="S3.p2.4.m2.1.1.3.2.2.3.2" xref="S3.p2.4.m2.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.p2.4.m2.1.1.3.2.2.3.1" xref="S3.p2.4.m2.1.1.3.2.2.3.1.cmml">=</mo><mn id="S3.p2.4.m2.1.1.3.2.2.3.3" xref="S3.p2.4.m2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p2.4.m2.1.1.3.2.3" xref="S3.p2.4.m2.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S3.p2.4.m2.1.1.3.1" xref="S3.p2.4.m2.1.1.3.1.cmml">⁢</mo><msub id="S3.p2.4.m2.1.1.3.3" xref="S3.p2.4.m2.1.1.3.3.cmml"><mi id="S3.p2.4.m2.1.1.3.3.2" xref="S3.p2.4.m2.1.1.3.3.2.cmml">α</mi><mi id="S3.p2.4.m2.1.1.3.3.3" xref="S3.p2.4.m2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m2.1b"><apply id="S3.p2.4.m2.1.1.cmml" xref="S3.p2.4.m2.1.1"><eq id="S3.p2.4.m2.1.1.1.cmml" xref="S3.p2.4.m2.1.1.1"></eq><apply id="S3.p2.4.m2.1.1.2.cmml" xref="S3.p2.4.m2.1.1.2"><times id="S3.p2.4.m2.1.1.2.1.cmml" xref="S3.p2.4.m2.1.1.2.1"></times><ci id="S3.p2.4.m2.1.1.2.2b.cmml" xref="S3.p2.4.m2.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.p2.4.m2.1.1.2.2.cmml" xref="S3.p2.4.m2.1.1.2.2"><mtext id="S3.p2.4.m2.1.1.2.2a.cmml" xref="S3.p2.4.m2.1.1.2.2">\widebar</mtext></merror></ci><apply id="S3.p2.4.m2.1.1.2.3.cmml" xref="S3.p2.4.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.p2.4.m2.1.1.2.3.1.cmml" xref="S3.p2.4.m2.1.1.2.3">subscript</csymbol><ci id="S3.p2.4.m2.1.1.2.3.2.cmml" xref="S3.p2.4.m2.1.1.2.3.2">𝛼</ci><ci id="S3.p2.4.m2.1.1.2.3.3.cmml" xref="S3.p2.4.m2.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.p2.4.m2.1.1.3.cmml" xref="S3.p2.4.m2.1.1.3"><times id="S3.p2.4.m2.1.1.3.1.cmml" xref="S3.p2.4.m2.1.1.3.1"></times><apply id="S3.p2.4.m2.1.1.3.2.cmml" xref="S3.p2.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.4.m2.1.1.3.2.1.cmml" xref="S3.p2.4.m2.1.1.3.2">superscript</csymbol><apply id="S3.p2.4.m2.1.1.3.2.2.cmml" xref="S3.p2.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.4.m2.1.1.3.2.2.1.cmml" xref="S3.p2.4.m2.1.1.3.2">subscript</csymbol><ci id="S3.p2.4.m2.1.1.3.2.2.2.cmml" xref="S3.p2.4.m2.1.1.3.2.2.2">Π</ci><apply id="S3.p2.4.m2.1.1.3.2.2.3.cmml" xref="S3.p2.4.m2.1.1.3.2.2.3"><eq id="S3.p2.4.m2.1.1.3.2.2.3.1.cmml" xref="S3.p2.4.m2.1.1.3.2.2.3.1"></eq><ci id="S3.p2.4.m2.1.1.3.2.2.3.2.cmml" xref="S3.p2.4.m2.1.1.3.2.2.3.2">𝑖</ci><cn id="S3.p2.4.m2.1.1.3.2.2.3.3.cmml" type="integer" xref="S3.p2.4.m2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.p2.4.m2.1.1.3.2.3.cmml" xref="S3.p2.4.m2.1.1.3.2.3">𝑡</ci></apply><apply id="S3.p2.4.m2.1.1.3.3.cmml" xref="S3.p2.4.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.4.m2.1.1.3.3.1.cmml" xref="S3.p2.4.m2.1.1.3.3">subscript</csymbol><ci id="S3.p2.4.m2.1.1.3.3.2.cmml" xref="S3.p2.4.m2.1.1.3.3.2">𝛼</ci><ci id="S3.p2.4.m2.1.1.3.3.3.cmml" xref="S3.p2.4.m2.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m2.1c">\widebar{\alpha}_{t}=\Pi_{i=1}^{t}\alpha_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_Π start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. This enables any arbitrary step of the diffusion process to be generated extremely quickly for any given <math alttext="\mathbf{x}_{0}\sim q(\mathbf{x})" class="ltx_Math" display="inline" id="S3.p2.5.m3.1"><semantics id="S3.p2.5.m3.1a"><mrow id="S3.p2.5.m3.1.2" xref="S3.p2.5.m3.1.2.cmml"><msub id="S3.p2.5.m3.1.2.2" xref="S3.p2.5.m3.1.2.2.cmml"><mi id="S3.p2.5.m3.1.2.2.2" xref="S3.p2.5.m3.1.2.2.2.cmml">𝐱</mi><mn id="S3.p2.5.m3.1.2.2.3" xref="S3.p2.5.m3.1.2.2.3.cmml">0</mn></msub><mo id="S3.p2.5.m3.1.2.1" xref="S3.p2.5.m3.1.2.1.cmml">∼</mo><mrow id="S3.p2.5.m3.1.2.3" xref="S3.p2.5.m3.1.2.3.cmml"><mi id="S3.p2.5.m3.1.2.3.2" xref="S3.p2.5.m3.1.2.3.2.cmml">q</mi><mo id="S3.p2.5.m3.1.2.3.1" xref="S3.p2.5.m3.1.2.3.1.cmml">⁢</mo><mrow id="S3.p2.5.m3.1.2.3.3.2" xref="S3.p2.5.m3.1.2.3.cmml"><mo id="S3.p2.5.m3.1.2.3.3.2.1" stretchy="false" xref="S3.p2.5.m3.1.2.3.cmml">(</mo><mi id="S3.p2.5.m3.1.1" xref="S3.p2.5.m3.1.1.cmml">𝐱</mi><mo id="S3.p2.5.m3.1.2.3.3.2.2" stretchy="false" xref="S3.p2.5.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m3.1b"><apply id="S3.p2.5.m3.1.2.cmml" xref="S3.p2.5.m3.1.2"><csymbol cd="latexml" id="S3.p2.5.m3.1.2.1.cmml" xref="S3.p2.5.m3.1.2.1">similar-to</csymbol><apply id="S3.p2.5.m3.1.2.2.cmml" xref="S3.p2.5.m3.1.2.2"><csymbol cd="ambiguous" id="S3.p2.5.m3.1.2.2.1.cmml" xref="S3.p2.5.m3.1.2.2">subscript</csymbol><ci id="S3.p2.5.m3.1.2.2.2.cmml" xref="S3.p2.5.m3.1.2.2.2">𝐱</ci><cn id="S3.p2.5.m3.1.2.2.3.cmml" type="integer" xref="S3.p2.5.m3.1.2.2.3">0</cn></apply><apply id="S3.p2.5.m3.1.2.3.cmml" xref="S3.p2.5.m3.1.2.3"><times id="S3.p2.5.m3.1.2.3.1.cmml" xref="S3.p2.5.m3.1.2.3.1"></times><ci id="S3.p2.5.m3.1.2.3.2.cmml" xref="S3.p2.5.m3.1.2.3.2">𝑞</ci><ci id="S3.p2.5.m3.1.1.cmml" xref="S3.p2.5.m3.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m3.1c">\mathbf{x}_{0}\sim q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m3.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_q ( bold_x )</annotation></semantics></math>, simply by sampling <math alttext="\epsilon\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.p2.6.m4.2"><semantics id="S3.p2.6.m4.2a"><mrow id="S3.p2.6.m4.2.3" xref="S3.p2.6.m4.2.3.cmml"><mi id="S3.p2.6.m4.2.3.2" xref="S3.p2.6.m4.2.3.2.cmml">ϵ</mi><mo id="S3.p2.6.m4.2.3.1" xref="S3.p2.6.m4.2.3.1.cmml">∼</mo><mrow id="S3.p2.6.m4.2.3.3" xref="S3.p2.6.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m4.2.3.3.2" xref="S3.p2.6.m4.2.3.3.2.cmml">𝒩</mi><mo id="S3.p2.6.m4.2.3.3.1" xref="S3.p2.6.m4.2.3.3.1.cmml">⁢</mo><mrow id="S3.p2.6.m4.2.3.3.3.2" xref="S3.p2.6.m4.2.3.3.3.1.cmml"><mo id="S3.p2.6.m4.2.3.3.3.2.1" stretchy="false" xref="S3.p2.6.m4.2.3.3.3.1.cmml">(</mo><mn id="S3.p2.6.m4.1.1" xref="S3.p2.6.m4.1.1.cmml">0</mn><mo id="S3.p2.6.m4.2.3.3.3.2.2" xref="S3.p2.6.m4.2.3.3.3.1.cmml">,</mo><mi id="S3.p2.6.m4.2.2" xref="S3.p2.6.m4.2.2.cmml">𝐈</mi><mo id="S3.p2.6.m4.2.3.3.3.2.3" stretchy="false" xref="S3.p2.6.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m4.2b"><apply id="S3.p2.6.m4.2.3.cmml" xref="S3.p2.6.m4.2.3"><csymbol cd="latexml" id="S3.p2.6.m4.2.3.1.cmml" xref="S3.p2.6.m4.2.3.1">similar-to</csymbol><ci id="S3.p2.6.m4.2.3.2.cmml" xref="S3.p2.6.m4.2.3.2">italic-ϵ</ci><apply id="S3.p2.6.m4.2.3.3.cmml" xref="S3.p2.6.m4.2.3.3"><times id="S3.p2.6.m4.2.3.3.1.cmml" xref="S3.p2.6.m4.2.3.3.1"></times><ci id="S3.p2.6.m4.2.3.3.2.cmml" xref="S3.p2.6.m4.2.3.3.2">𝒩</ci><interval closure="open" id="S3.p2.6.m4.2.3.3.3.1.cmml" xref="S3.p2.6.m4.2.3.3.3.2"><cn id="S3.p2.6.m4.1.1.cmml" type="integer" xref="S3.p2.6.m4.1.1">0</cn><ci id="S3.p2.6.m4.2.2.cmml" xref="S3.p2.6.m4.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m4.2c">\epsilon\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m4.2d">italic_ϵ ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math>. The diffusion steps can be tuned by choosing an appropriate set of <math alttext="\{\beta_{t}\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S3.p2.7.m5.1"><semantics id="S3.p2.7.m5.1a"><msubsup id="S3.p2.7.m5.1.1" xref="S3.p2.7.m5.1.1.cmml"><mrow id="S3.p2.7.m5.1.1.1.1.1" xref="S3.p2.7.m5.1.1.1.1.2.cmml"><mo id="S3.p2.7.m5.1.1.1.1.1.2" stretchy="false" xref="S3.p2.7.m5.1.1.1.1.2.cmml">{</mo><msub id="S3.p2.7.m5.1.1.1.1.1.1" xref="S3.p2.7.m5.1.1.1.1.1.1.cmml"><mi id="S3.p2.7.m5.1.1.1.1.1.1.2" xref="S3.p2.7.m5.1.1.1.1.1.1.2.cmml">β</mi><mi id="S3.p2.7.m5.1.1.1.1.1.1.3" xref="S3.p2.7.m5.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p2.7.m5.1.1.1.1.1.3" stretchy="false" xref="S3.p2.7.m5.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.7.m5.1.1.1.3" xref="S3.p2.7.m5.1.1.1.3.cmml"><mi id="S3.p2.7.m5.1.1.1.3.2" xref="S3.p2.7.m5.1.1.1.3.2.cmml">t</mi><mo id="S3.p2.7.m5.1.1.1.3.1" xref="S3.p2.7.m5.1.1.1.3.1.cmml">=</mo><mn id="S3.p2.7.m5.1.1.1.3.3" xref="S3.p2.7.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p2.7.m5.1.1.3" xref="S3.p2.7.m5.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.7.m5.1b"><apply id="S3.p2.7.m5.1.1.cmml" xref="S3.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m5.1.1.2.cmml" xref="S3.p2.7.m5.1.1">superscript</csymbol><apply id="S3.p2.7.m5.1.1.1.cmml" xref="S3.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m5.1.1.1.2.cmml" xref="S3.p2.7.m5.1.1">subscript</csymbol><set id="S3.p2.7.m5.1.1.1.1.2.cmml" xref="S3.p2.7.m5.1.1.1.1.1"><apply id="S3.p2.7.m5.1.1.1.1.1.1.cmml" xref="S3.p2.7.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m5.1.1.1.1.1.1.1.cmml" xref="S3.p2.7.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.7.m5.1.1.1.1.1.1.2.cmml" xref="S3.p2.7.m5.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.p2.7.m5.1.1.1.1.1.1.3.cmml" xref="S3.p2.7.m5.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.p2.7.m5.1.1.1.3.cmml" xref="S3.p2.7.m5.1.1.1.3"><eq id="S3.p2.7.m5.1.1.1.3.1.cmml" xref="S3.p2.7.m5.1.1.1.3.1"></eq><ci id="S3.p2.7.m5.1.1.1.3.2.cmml" xref="S3.p2.7.m5.1.1.1.3.2">𝑡</ci><cn id="S3.p2.7.m5.1.1.1.3.3.cmml" type="integer" xref="S3.p2.7.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p2.7.m5.1.1.3.cmml" xref="S3.p2.7.m5.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m5.1c">\{\beta_{t}\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m5.1d">{ italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.4">The reverse diffusion process aims to gradually recover the original data <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝐱</mi><mn id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝐱</ci><cn id="S3.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> given the fully corrupted <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝐱</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝐱</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>. <cite class="ltx_cite ltx_citemacro_citet">Ho et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib5" title="">2020</a>)</cite> show that the posterior Gaussian, <math alttext="p(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">p</mi><mo id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.p3.3.m3.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.1.cmml"><mo id="S3.p3.3.m3.1.1.1.1.2" stretchy="false" xref="S3.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.3.m3.1.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.1.cmml"><msub id="S3.p3.3.m3.1.1.1.1.1.4" xref="S3.p3.3.m3.1.1.1.1.1.4.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.4.2" xref="S3.p3.3.m3.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="S3.p3.3.m3.1.1.1.1.1.4.3" xref="S3.p3.3.m3.1.1.1.1.1.4.3.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.4.3.2" xref="S3.p3.3.m3.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.p3.3.m3.1.1.1.1.1.4.3.1" xref="S3.p3.3.m3.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="S3.p3.3.m3.1.1.1.1.1.4.3.3" xref="S3.p3.3.m3.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.p3.3.m3.1.1.1.1.1.3" xref="S3.p3.3.m3.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.p3.3.m3.1.1.1.1.1.2.2" xref="S3.p3.3.m3.1.1.1.1.1.2.3.cmml"><msub id="S3.p3.3.m3.1.1.1.1.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.p3.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p3.3.m3.1.1.1.1.1.2.2.3" xref="S3.p3.3.m3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.p3.3.m3.1.1.1.1.1.2.2.2" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.2.2.2.2" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="S3.p3.3.m3.1.1.1.1.1.2.2.2.3" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="S3.p3.3.m3.1.1.1.1.3" stretchy="false" xref="S3.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><times id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2"></times><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑝</ci><apply id="S3.p3.3.m3.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p3.3.m3.1.1.1.1.1.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.3">conditional</csymbol><apply id="S3.p3.3.m3.1.1.1.1.1.4.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.1.4.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.1.4.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4.2">𝐱</ci><apply id="S3.p3.3.m3.1.1.1.1.1.4.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4.3"><minus id="S3.p3.3.m3.1.1.1.1.1.4.3.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4.3.1"></minus><ci id="S3.p3.3.m3.1.1.1.1.1.4.3.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.p3.3.m3.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.p3.3.m3.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.p3.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.2.2"><apply id="S3.p3.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.p3.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.p3.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="S3.p3.3.m3.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.p3.3.m3.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">p(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_p ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>, is tractable (when conditioned on <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">𝐱</mi><mn id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝐱</ci><cn id="S3.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.p3.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>) and has the analytical form:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx2">
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})=" class="ltx_Math" display="inline" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">p</mi><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex3.m1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.2" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="S3.Ex3.m1.1.1.1.1.1.1.4.3" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.4.3.1" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="S3.Ex3.m1.1.1.1.1.1.1.4.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex3.m1.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">=</mo><mi id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"></eq><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝑝</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.Ex3.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2">𝐱</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3"><minus id="S3.Ex3.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.1"></minus><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.Ex3.m1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2"><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply><csymbol cd="latexml" id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle p(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">italic_p ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{N}(\mathbf{x}_{t-1};\mu_{t}(\mathbf{x}_{t},\mathbf{x}_{0%
}),\tilde{\beta_{t}}\mathbf{I})" class="ltx_Math" display="inline" id="S3.Ex3.m2.3"><semantics id="S3.Ex3.m2.3a"><mrow id="S3.Ex3.m2.3.3" xref="S3.Ex3.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m2.3.3.5" xref="S3.Ex3.m2.3.3.5.cmml">𝒩</mi><mo id="S3.Ex3.m2.3.3.4" xref="S3.Ex3.m2.3.3.4.cmml">⁢</mo><mrow id="S3.Ex3.m2.3.3.3.3" xref="S3.Ex3.m2.3.3.3.4.cmml"><mo id="S3.Ex3.m2.3.3.3.3.4" stretchy="false" xref="S3.Ex3.m2.3.3.3.4.cmml">(</mo><msub id="S3.Ex3.m2.1.1.1.1.1" xref="S3.Ex3.m2.1.1.1.1.1.cmml"><mi id="S3.Ex3.m2.1.1.1.1.1.2" xref="S3.Ex3.m2.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.Ex3.m2.1.1.1.1.1.3" xref="S3.Ex3.m2.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m2.1.1.1.1.1.3.2" xref="S3.Ex3.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.Ex3.m2.1.1.1.1.1.3.1" xref="S3.Ex3.m2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.Ex3.m2.1.1.1.1.1.3.3" xref="S3.Ex3.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex3.m2.3.3.3.3.5" xref="S3.Ex3.m2.3.3.3.4.cmml">;</mo><mrow id="S3.Ex3.m2.2.2.2.2.2" xref="S3.Ex3.m2.2.2.2.2.2.cmml"><msub id="S3.Ex3.m2.2.2.2.2.2.4" xref="S3.Ex3.m2.2.2.2.2.2.4.cmml"><mi id="S3.Ex3.m2.2.2.2.2.2.4.2" xref="S3.Ex3.m2.2.2.2.2.2.4.2.cmml">μ</mi><mi id="S3.Ex3.m2.2.2.2.2.2.4.3" xref="S3.Ex3.m2.2.2.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.Ex3.m2.2.2.2.2.2.3" xref="S3.Ex3.m2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex3.m2.2.2.2.2.2.2.2" xref="S3.Ex3.m2.2.2.2.2.2.2.3.cmml"><mo id="S3.Ex3.m2.2.2.2.2.2.2.2.3" stretchy="false" xref="S3.Ex3.m2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.Ex3.m2.2.2.2.2.2.1.1.1" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.Ex3.m2.2.2.2.2.2.1.1.1.2" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex3.m2.2.2.2.2.2.1.1.1.3" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex3.m2.2.2.2.2.2.2.2.4" xref="S3.Ex3.m2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.Ex3.m2.2.2.2.2.2.2.2.2" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.Ex3.m2.2.2.2.2.2.2.2.2.2" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2.2.cmml">𝐱</mi><mn id="S3.Ex3.m2.2.2.2.2.2.2.2.2.3" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.Ex3.m2.2.2.2.2.2.2.2.5" stretchy="false" xref="S3.Ex3.m2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m2.3.3.3.3.6" xref="S3.Ex3.m2.3.3.3.4.cmml">,</mo><mrow id="S3.Ex3.m2.3.3.3.3.3" xref="S3.Ex3.m2.3.3.3.3.3.cmml"><mover accent="true" id="S3.Ex3.m2.3.3.3.3.3.2" xref="S3.Ex3.m2.3.3.3.3.3.2.cmml"><msub id="S3.Ex3.m2.3.3.3.3.3.2.2" xref="S3.Ex3.m2.3.3.3.3.3.2.2.cmml"><mi id="S3.Ex3.m2.3.3.3.3.3.2.2.2" xref="S3.Ex3.m2.3.3.3.3.3.2.2.2.cmml">β</mi><mi id="S3.Ex3.m2.3.3.3.3.3.2.2.3" xref="S3.Ex3.m2.3.3.3.3.3.2.2.3.cmml">t</mi></msub><mo id="S3.Ex3.m2.3.3.3.3.3.2.1" xref="S3.Ex3.m2.3.3.3.3.3.2.1.cmml">~</mo></mover><mo id="S3.Ex3.m2.3.3.3.3.3.1" xref="S3.Ex3.m2.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex3.m2.3.3.3.3.3.3" xref="S3.Ex3.m2.3.3.3.3.3.3.cmml">𝐈</mi></mrow><mo id="S3.Ex3.m2.3.3.3.3.7" stretchy="false" xref="S3.Ex3.m2.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m2.3b"><apply id="S3.Ex3.m2.3.3.cmml" xref="S3.Ex3.m2.3.3"><times id="S3.Ex3.m2.3.3.4.cmml" xref="S3.Ex3.m2.3.3.4"></times><ci id="S3.Ex3.m2.3.3.5.cmml" xref="S3.Ex3.m2.3.3.5">𝒩</ci><list id="S3.Ex3.m2.3.3.3.4.cmml" xref="S3.Ex3.m2.3.3.3.3"><apply id="S3.Ex3.m2.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.1.1.1.1.1.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m2.1.1.1.1.1.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.2">𝐱</ci><apply id="S3.Ex3.m2.1.1.1.1.1.3.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3"><minus id="S3.Ex3.m2.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3.1"></minus><ci id="S3.Ex3.m2.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m2.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.Ex3.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex3.m2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Ex3.m2.2.2.2.2.2.cmml" xref="S3.Ex3.m2.2.2.2.2.2"><times id="S3.Ex3.m2.2.2.2.2.2.3.cmml" xref="S3.Ex3.m2.2.2.2.2.2.3"></times><apply id="S3.Ex3.m2.2.2.2.2.2.4.cmml" xref="S3.Ex3.m2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.2.2.2.4.1.cmml" xref="S3.Ex3.m2.2.2.2.2.2.4">subscript</csymbol><ci id="S3.Ex3.m2.2.2.2.2.2.4.2.cmml" xref="S3.Ex3.m2.2.2.2.2.2.4.2">𝜇</ci><ci id="S3.Ex3.m2.2.2.2.2.2.4.3.cmml" xref="S3.Ex3.m2.2.2.2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.Ex3.m2.2.2.2.2.2.2.3.cmml" xref="S3.Ex3.m2.2.2.2.2.2.2.2"><apply id="S3.Ex3.m2.2.2.2.2.2.1.1.1.cmml" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.Ex3.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1.2">𝐱</ci><ci id="S3.Ex3.m2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex3.m2.2.2.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex3.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex3.m2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2.2">𝐱</ci><cn id="S3.Ex3.m2.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.Ex3.m2.2.2.2.2.2.2.2.2.3">0</cn></apply></interval></apply><apply id="S3.Ex3.m2.3.3.3.3.3.cmml" xref="S3.Ex3.m2.3.3.3.3.3"><times id="S3.Ex3.m2.3.3.3.3.3.1.cmml" xref="S3.Ex3.m2.3.3.3.3.3.1"></times><apply id="S3.Ex3.m2.3.3.3.3.3.2.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2"><ci id="S3.Ex3.m2.3.3.3.3.3.2.1.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2.1">~</ci><apply id="S3.Ex3.m2.3.3.3.3.3.2.2.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m2.3.3.3.3.3.2.2.1.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2.2">subscript</csymbol><ci id="S3.Ex3.m2.3.3.3.3.3.2.2.2.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2.2.2">𝛽</ci><ci id="S3.Ex3.m2.3.3.3.3.3.2.2.3.cmml" xref="S3.Ex3.m2.3.3.3.3.3.2.2.3">𝑡</ci></apply></apply><ci id="S3.Ex3.m2.3.3.3.3.3.3.cmml" xref="S3.Ex3.m2.3.3.3.3.3.3">𝐈</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m2.3c">\displaystyle\mathcal{N}(\mathbf{x}_{t-1};\mu_{t}(\mathbf{x}_{t},\mathbf{x}_{0%
}),\tilde{\beta_{t}}\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m2.3d">caligraphic_N ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , over~ start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mu_{t}(\mathbf{x}_{t},\mathbf{x}_{0}):=" class="ltx_Math" display="inline" id="S3.Ex4.m1.2"><semantics id="S3.Ex4.m1.2a"><mrow id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml"><mrow id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml"><msub id="S3.Ex4.m1.2.2.2.4" xref="S3.Ex4.m1.2.2.2.4.cmml"><mi id="S3.Ex4.m1.2.2.2.4.2" xref="S3.Ex4.m1.2.2.2.4.2.cmml">μ</mi><mi id="S3.Ex4.m1.2.2.2.4.3" xref="S3.Ex4.m1.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.Ex4.m1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.3.cmml"><mo id="S3.Ex4.m1.2.2.2.2.2.3" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex4.m1.2.2.2.2.2.4" xref="S3.Ex4.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.Ex4.m1.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.2.cmml">𝐱</mi><mn id="S3.Ex4.m1.2.2.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.Ex4.m1.2.2.2.2.2.5" rspace="0.278em" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.2.2.3" rspace="0.278em" xref="S3.Ex4.m1.2.2.3.cmml">:=</mo><mi id="S3.Ex4.m1.2.2.4" xref="S3.Ex4.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.2b"><apply id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2"><csymbol cd="latexml" id="S3.Ex4.m1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.3">assign</csymbol><apply id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"><times id="S3.Ex4.m1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.3"></times><apply id="S3.Ex4.m1.2.2.2.4.cmml" xref="S3.Ex4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.4.1.cmml" xref="S3.Ex4.m1.2.2.2.4">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.4.2.cmml" xref="S3.Ex4.m1.2.2.2.4.2">𝜇</ci><ci id="S3.Ex4.m1.2.2.2.4.3.cmml" xref="S3.Ex4.m1.2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.Ex4.m1.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2"><apply id="S3.Ex4.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex4.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.2">𝐱</ci><cn id="S3.Ex4.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.Ex4.m1.2.2.2.2.2.2.3">0</cn></apply></interval></apply><csymbol cd="latexml" id="S3.Ex4.m1.2.2.4.cmml" xref="S3.Ex4.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.2c">\displaystyle\mu_{t}(\mathbf{x}_{t},\mathbf{x}_{0}):=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.2d">italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) :=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{\sqrt{\widebar{\alpha}_{t-1}}\beta_{t}}{1-\widebar{\alpha}_%
{t}}\mathbf{x}_{0}+\frac{\sqrt{\alpha_{n}}(1-\widebar{\alpha}_{t-1})}{1-%
\widebar{\alpha}_{t}}\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.Ex4.m2.1"><semantics id="S3.Ex4.m2.1a"><mrow id="S3.Ex4.m2.1.2" xref="S3.Ex4.m2.1.2.cmml"><mrow id="S3.Ex4.m2.1.2.2" xref="S3.Ex4.m2.1.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex4.m2.1.2.2.2" xref="S3.Ex4.m2.1.2.2.2.cmml"><mfrac id="S3.Ex4.m2.1.2.2.2a" xref="S3.Ex4.m2.1.2.2.2.cmml"><mrow id="S3.Ex4.m2.1.2.2.2.2" xref="S3.Ex4.m2.1.2.2.2.2.cmml"><msqrt id="S3.Ex4.m2.1.2.2.2.2.2" xref="S3.Ex4.m2.1.2.2.2.2.2.cmml"><mrow id="S3.Ex4.m2.1.2.2.2.2.2.2" xref="S3.Ex4.m2.1.2.2.2.2.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.2.2.2.2.2.2.2" xref="S3.Ex4.m2.1.2.2.2.2.2.2.2b.cmml"><mtext id="S3.Ex4.m2.1.2.2.2.2.2.2.2a" xref="S3.Ex4.m2.1.2.2.2.2.2.2.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex4.m2.1.2.2.2.2.2.2.1" xref="S3.Ex4.m2.1.2.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.2.2.2.2.2.2.3" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.cmml"><mi id="S3.Ex4.m2.1.2.2.2.2.2.2.3.2" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.2.cmml">α</mi><mrow id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.cmml"><mi id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.2" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.1" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.1.cmml">−</mo><mn id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.3" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></msqrt><mo id="S3.Ex4.m2.1.2.2.2.2.1" xref="S3.Ex4.m2.1.2.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.2.2.2.2.3" xref="S3.Ex4.m2.1.2.2.2.2.3.cmml"><mi id="S3.Ex4.m2.1.2.2.2.2.3.2" xref="S3.Ex4.m2.1.2.2.2.2.3.2.cmml">β</mi><mi id="S3.Ex4.m2.1.2.2.2.2.3.3" xref="S3.Ex4.m2.1.2.2.2.2.3.3.cmml">t</mi></msub></mrow><mrow id="S3.Ex4.m2.1.2.2.2.3" xref="S3.Ex4.m2.1.2.2.2.3.cmml"><mn id="S3.Ex4.m2.1.2.2.2.3.2" xref="S3.Ex4.m2.1.2.2.2.3.2.cmml">1</mn><mo id="S3.Ex4.m2.1.2.2.2.3.1" xref="S3.Ex4.m2.1.2.2.2.3.1.cmml">−</mo><mrow id="S3.Ex4.m2.1.2.2.2.3.3" xref="S3.Ex4.m2.1.2.2.2.3.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.2.2.2.3.3.2" xref="S3.Ex4.m2.1.2.2.2.3.3.2b.cmml"><mtext id="S3.Ex4.m2.1.2.2.2.3.3.2a" xref="S3.Ex4.m2.1.2.2.2.3.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex4.m2.1.2.2.2.3.3.1" xref="S3.Ex4.m2.1.2.2.2.3.3.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.2.2.2.3.3.3" xref="S3.Ex4.m2.1.2.2.2.3.3.3.cmml"><mi id="S3.Ex4.m2.1.2.2.2.3.3.3.2" xref="S3.Ex4.m2.1.2.2.2.3.3.3.2.cmml">α</mi><mi id="S3.Ex4.m2.1.2.2.2.3.3.3.3" xref="S3.Ex4.m2.1.2.2.2.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mfrac></mstyle><mo id="S3.Ex4.m2.1.2.2.1" xref="S3.Ex4.m2.1.2.2.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.2.2.3" xref="S3.Ex4.m2.1.2.2.3.cmml"><mi id="S3.Ex4.m2.1.2.2.3.2" xref="S3.Ex4.m2.1.2.2.3.2.cmml">𝐱</mi><mn id="S3.Ex4.m2.1.2.2.3.3" xref="S3.Ex4.m2.1.2.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.Ex4.m2.1.2.1" xref="S3.Ex4.m2.1.2.1.cmml">+</mo><mrow id="S3.Ex4.m2.1.2.3" xref="S3.Ex4.m2.1.2.3.cmml"><mstyle displaystyle="true" id="S3.Ex4.m2.1.1" xref="S3.Ex4.m2.1.1.cmml"><mfrac id="S3.Ex4.m2.1.1a" xref="S3.Ex4.m2.1.1.cmml"><mrow id="S3.Ex4.m2.1.1.1" xref="S3.Ex4.m2.1.1.1.cmml"><msqrt id="S3.Ex4.m2.1.1.1.3" xref="S3.Ex4.m2.1.1.1.3.cmml"><msub id="S3.Ex4.m2.1.1.1.3.2" xref="S3.Ex4.m2.1.1.1.3.2.cmml"><mi id="S3.Ex4.m2.1.1.1.3.2.2" xref="S3.Ex4.m2.1.1.1.3.2.2.cmml">α</mi><mi id="S3.Ex4.m2.1.1.1.3.2.3" xref="S3.Ex4.m2.1.1.1.3.2.3.cmml">n</mi></msub></msqrt><mo id="S3.Ex4.m2.1.1.1.2" xref="S3.Ex4.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m2.1.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m2.1.1.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.1.1.cmml"><mn id="S3.Ex4.m2.1.1.1.1.1.1.2" xref="S3.Ex4.m2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex4.m2.1.1.1.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex4.m2.1.1.1.1.1.1.3" xref="S3.Ex4.m2.1.1.1.1.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.1.1.1.1.1.3.2" xref="S3.Ex4.m2.1.1.1.1.1.1.3.2b.cmml"><mtext id="S3.Ex4.m2.1.1.1.1.1.1.3.2a" xref="S3.Ex4.m2.1.1.1.1.1.1.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex4.m2.1.1.1.1.1.1.3.1" xref="S3.Ex4.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.1.1.1.1.1.3.3" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex4.m2.1.1.1.1.1.1.3.3.2" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.2.cmml">α</mi><mrow id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.2" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.1" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.Ex4.m2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex4.m2.1.1.3" xref="S3.Ex4.m2.1.1.3.cmml"><mn id="S3.Ex4.m2.1.1.3.2" xref="S3.Ex4.m2.1.1.3.2.cmml">1</mn><mo id="S3.Ex4.m2.1.1.3.1" xref="S3.Ex4.m2.1.1.3.1.cmml">−</mo><mrow id="S3.Ex4.m2.1.1.3.3" xref="S3.Ex4.m2.1.1.3.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.1.3.3.2" xref="S3.Ex4.m2.1.1.3.3.2b.cmml"><mtext id="S3.Ex4.m2.1.1.3.3.2a" xref="S3.Ex4.m2.1.1.3.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex4.m2.1.1.3.3.1" xref="S3.Ex4.m2.1.1.3.3.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.1.3.3.3" xref="S3.Ex4.m2.1.1.3.3.3.cmml"><mi id="S3.Ex4.m2.1.1.3.3.3.2" xref="S3.Ex4.m2.1.1.3.3.3.2.cmml">α</mi><mi id="S3.Ex4.m2.1.1.3.3.3.3" xref="S3.Ex4.m2.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mfrac></mstyle><mo id="S3.Ex4.m2.1.2.3.1" xref="S3.Ex4.m2.1.2.3.1.cmml">⁢</mo><msub id="S3.Ex4.m2.1.2.3.2" xref="S3.Ex4.m2.1.2.3.2.cmml"><mi id="S3.Ex4.m2.1.2.3.2.2" xref="S3.Ex4.m2.1.2.3.2.2.cmml">𝐱</mi><mi id="S3.Ex4.m2.1.2.3.2.3" xref="S3.Ex4.m2.1.2.3.2.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m2.1b"><apply id="S3.Ex4.m2.1.2.cmml" xref="S3.Ex4.m2.1.2"><plus id="S3.Ex4.m2.1.2.1.cmml" xref="S3.Ex4.m2.1.2.1"></plus><apply id="S3.Ex4.m2.1.2.2.cmml" xref="S3.Ex4.m2.1.2.2"><times id="S3.Ex4.m2.1.2.2.1.cmml" xref="S3.Ex4.m2.1.2.2.1"></times><apply id="S3.Ex4.m2.1.2.2.2.cmml" xref="S3.Ex4.m2.1.2.2.2"><divide id="S3.Ex4.m2.1.2.2.2.1.cmml" xref="S3.Ex4.m2.1.2.2.2"></divide><apply id="S3.Ex4.m2.1.2.2.2.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2"><times id="S3.Ex4.m2.1.2.2.2.2.1.cmml" xref="S3.Ex4.m2.1.2.2.2.2.1"></times><apply id="S3.Ex4.m2.1.2.2.2.2.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2"><root id="S3.Ex4.m2.1.2.2.2.2.2a.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2"></root><apply id="S3.Ex4.m2.1.2.2.2.2.2.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2"><times id="S3.Ex4.m2.1.2.2.2.2.2.2.1.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.1"></times><ci id="S3.Ex4.m2.1.2.2.2.2.2.2.2b.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.2.2.2.2.2.2.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.2"><mtext id="S3.Ex4.m2.1.2.2.2.2.2.2.2a.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.2">\widebar</mtext></merror></ci><apply id="S3.Ex4.m2.1.2.2.2.2.2.2.3.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex4.m2.1.2.2.2.2.2.2.3.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.2">𝛼</ci><apply id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3"><minus id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.1"></minus><ci id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.2">𝑡</ci><cn id="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="S3.Ex4.m2.1.2.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.Ex4.m2.1.2.2.2.2.3.cmml" xref="S3.Ex4.m2.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.2.2.2.2.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex4.m2.1.2.2.2.2.3.2.cmml" xref="S3.Ex4.m2.1.2.2.2.2.3.2">𝛽</ci><ci id="S3.Ex4.m2.1.2.2.2.2.3.3.cmml" xref="S3.Ex4.m2.1.2.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.Ex4.m2.1.2.2.2.3.cmml" xref="S3.Ex4.m2.1.2.2.2.3"><minus id="S3.Ex4.m2.1.2.2.2.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.3.1"></minus><cn id="S3.Ex4.m2.1.2.2.2.3.2.cmml" type="integer" xref="S3.Ex4.m2.1.2.2.2.3.2">1</cn><apply id="S3.Ex4.m2.1.2.2.2.3.3.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3"><times id="S3.Ex4.m2.1.2.2.2.3.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.1"></times><ci id="S3.Ex4.m2.1.2.2.2.3.3.2b.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.2.2.2.3.3.2.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.2"><mtext id="S3.Ex4.m2.1.2.2.2.3.3.2a.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex4.m2.1.2.2.2.3.3.3.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.2.2.2.3.3.3.1.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.3">subscript</csymbol><ci id="S3.Ex4.m2.1.2.2.2.3.3.3.2.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.3.2">𝛼</ci><ci id="S3.Ex4.m2.1.2.2.2.3.3.3.3.cmml" xref="S3.Ex4.m2.1.2.2.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex4.m2.1.2.2.3.cmml" xref="S3.Ex4.m2.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.2.2.3.1.cmml" xref="S3.Ex4.m2.1.2.2.3">subscript</csymbol><ci id="S3.Ex4.m2.1.2.2.3.2.cmml" xref="S3.Ex4.m2.1.2.2.3.2">𝐱</ci><cn id="S3.Ex4.m2.1.2.2.3.3.cmml" type="integer" xref="S3.Ex4.m2.1.2.2.3.3">0</cn></apply></apply><apply id="S3.Ex4.m2.1.2.3.cmml" xref="S3.Ex4.m2.1.2.3"><times id="S3.Ex4.m2.1.2.3.1.cmml" xref="S3.Ex4.m2.1.2.3.1"></times><apply id="S3.Ex4.m2.1.1.cmml" xref="S3.Ex4.m2.1.1"><divide id="S3.Ex4.m2.1.1.2.cmml" xref="S3.Ex4.m2.1.1"></divide><apply id="S3.Ex4.m2.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1"><times id="S3.Ex4.m2.1.1.1.2.cmml" xref="S3.Ex4.m2.1.1.1.2"></times><apply id="S3.Ex4.m2.1.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.3"><root id="S3.Ex4.m2.1.1.1.3a.cmml" xref="S3.Ex4.m2.1.1.1.3"></root><apply id="S3.Ex4.m2.1.1.1.3.2.cmml" xref="S3.Ex4.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.1.3.2.1.cmml" xref="S3.Ex4.m2.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex4.m2.1.1.1.3.2.2.cmml" xref="S3.Ex4.m2.1.1.1.3.2.2">𝛼</ci><ci id="S3.Ex4.m2.1.1.1.3.2.3.cmml" xref="S3.Ex4.m2.1.1.1.3.2.3">𝑛</ci></apply></apply><apply id="S3.Ex4.m2.1.1.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1"><minus id="S3.Ex4.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.1"></minus><cn id="S3.Ex4.m2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.Ex4.m2.1.1.1.1.1.1.2">1</cn><apply id="S3.Ex4.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3"><times id="S3.Ex4.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex4.m2.1.1.1.1.1.1.3.2b.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.2"><mtext id="S3.Ex4.m2.1.1.1.1.1.1.3.2a.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex4.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex4.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.2">𝛼</ci><apply id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3"><minus id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn id="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.Ex4.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.Ex4.m2.1.1.3.cmml" xref="S3.Ex4.m2.1.1.3"><minus id="S3.Ex4.m2.1.1.3.1.cmml" xref="S3.Ex4.m2.1.1.3.1"></minus><cn id="S3.Ex4.m2.1.1.3.2.cmml" type="integer" xref="S3.Ex4.m2.1.1.3.2">1</cn><apply id="S3.Ex4.m2.1.1.3.3.cmml" xref="S3.Ex4.m2.1.1.3.3"><times id="S3.Ex4.m2.1.1.3.3.1.cmml" xref="S3.Ex4.m2.1.1.3.3.1"></times><ci id="S3.Ex4.m2.1.1.3.3.2b.cmml" xref="S3.Ex4.m2.1.1.3.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex4.m2.1.1.3.3.2.cmml" xref="S3.Ex4.m2.1.1.3.3.2"><mtext id="S3.Ex4.m2.1.1.3.3.2a.cmml" xref="S3.Ex4.m2.1.1.3.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex4.m2.1.1.3.3.3.cmml" xref="S3.Ex4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.1.3.3.3.1.cmml" xref="S3.Ex4.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.Ex4.m2.1.1.3.3.3.2.cmml" xref="S3.Ex4.m2.1.1.3.3.3.2">𝛼</ci><ci id="S3.Ex4.m2.1.1.3.3.3.3.cmml" xref="S3.Ex4.m2.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex4.m2.1.2.3.2.cmml" xref="S3.Ex4.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m2.1.2.3.2.1.cmml" xref="S3.Ex4.m2.1.2.3.2">subscript</csymbol><ci id="S3.Ex4.m2.1.2.3.2.2.cmml" xref="S3.Ex4.m2.1.2.3.2.2">𝐱</ci><ci id="S3.Ex4.m2.1.2.3.2.3.cmml" xref="S3.Ex4.m2.1.2.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m2.1c">\displaystyle\frac{\sqrt{\widebar{\alpha}_{t-1}}\beta_{t}}{1-\widebar{\alpha}_%
{t}}\mathbf{x}_{0}+\frac{\sqrt{\alpha_{n}}(1-\widebar{\alpha}_{t-1})}{1-%
\widebar{\alpha}_{t}}\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m2.1d">divide start_ARG square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + divide start_ARG square-root start_ARG italic_α start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_ARG ( 1 - italic_α start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) end_ARG start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\beta}_{t}:=" class="ltx_Math" display="inline" id="S3.Ex5.m1.1"><semantics id="S3.Ex5.m1.1a"><mrow id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><msub id="S3.Ex5.m1.1.1.2" xref="S3.Ex5.m1.1.1.2.cmml"><mover accent="true" id="S3.Ex5.m1.1.1.2.2" xref="S3.Ex5.m1.1.1.2.2.cmml"><mi id="S3.Ex5.m1.1.1.2.2.2" xref="S3.Ex5.m1.1.1.2.2.2.cmml">β</mi><mo id="S3.Ex5.m1.1.1.2.2.1" xref="S3.Ex5.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.Ex5.m1.1.1.2.3" xref="S3.Ex5.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex5.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex5.m1.1.1.1.cmml">:=</mo><mi id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"><csymbol cd="latexml" id="S3.Ex5.m1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1">assign</csymbol><apply id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.2.1.cmml" xref="S3.Ex5.m1.1.1.2">subscript</csymbol><apply id="S3.Ex5.m1.1.1.2.2.cmml" xref="S3.Ex5.m1.1.1.2.2"><ci id="S3.Ex5.m1.1.1.2.2.1.cmml" xref="S3.Ex5.m1.1.1.2.2.1">~</ci><ci id="S3.Ex5.m1.1.1.2.2.2.cmml" xref="S3.Ex5.m1.1.1.2.2.2">𝛽</ci></apply><ci id="S3.Ex5.m1.1.1.2.3.cmml" xref="S3.Ex5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S3.Ex5.m1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\displaystyle\tilde{\beta}_{t}:=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.1d">over~ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT :=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{1-\widebar{\alpha}_{t-1}}{1-\widebar{\alpha}_{t}}\beta_{t}" class="ltx_Math" display="inline" id="S3.Ex5.m2.1"><semantics id="S3.Ex5.m2.1a"><mrow id="S3.Ex5.m2.1.1" xref="S3.Ex5.m2.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.1.1.2" xref="S3.Ex5.m2.1.1.2.cmml"><mfrac id="S3.Ex5.m2.1.1.2a" xref="S3.Ex5.m2.1.1.2.cmml"><mrow id="S3.Ex5.m2.1.1.2.2" xref="S3.Ex5.m2.1.1.2.2.cmml"><mn id="S3.Ex5.m2.1.1.2.2.2" xref="S3.Ex5.m2.1.1.2.2.2.cmml">1</mn><mo id="S3.Ex5.m2.1.1.2.2.1" xref="S3.Ex5.m2.1.1.2.2.1.cmml">−</mo><mrow id="S3.Ex5.m2.1.1.2.2.3" xref="S3.Ex5.m2.1.1.2.2.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex5.m2.1.1.2.2.3.2" xref="S3.Ex5.m2.1.1.2.2.3.2b.cmml"><mtext id="S3.Ex5.m2.1.1.2.2.3.2a" xref="S3.Ex5.m2.1.1.2.2.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex5.m2.1.1.2.2.3.1" xref="S3.Ex5.m2.1.1.2.2.3.1.cmml">⁢</mo><msub id="S3.Ex5.m2.1.1.2.2.3.3" xref="S3.Ex5.m2.1.1.2.2.3.3.cmml"><mi id="S3.Ex5.m2.1.1.2.2.3.3.2" xref="S3.Ex5.m2.1.1.2.2.3.3.2.cmml">α</mi><mrow id="S3.Ex5.m2.1.1.2.2.3.3.3" xref="S3.Ex5.m2.1.1.2.2.3.3.3.cmml"><mi id="S3.Ex5.m2.1.1.2.2.3.3.3.2" xref="S3.Ex5.m2.1.1.2.2.3.3.3.2.cmml">t</mi><mo id="S3.Ex5.m2.1.1.2.2.3.3.3.1" xref="S3.Ex5.m2.1.1.2.2.3.3.3.1.cmml">−</mo><mn id="S3.Ex5.m2.1.1.2.2.3.3.3.3" xref="S3.Ex5.m2.1.1.2.2.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mrow id="S3.Ex5.m2.1.1.2.3" xref="S3.Ex5.m2.1.1.2.3.cmml"><mn id="S3.Ex5.m2.1.1.2.3.2" xref="S3.Ex5.m2.1.1.2.3.2.cmml">1</mn><mo id="S3.Ex5.m2.1.1.2.3.1" xref="S3.Ex5.m2.1.1.2.3.1.cmml">−</mo><mrow id="S3.Ex5.m2.1.1.2.3.3" xref="S3.Ex5.m2.1.1.2.3.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex5.m2.1.1.2.3.3.2" xref="S3.Ex5.m2.1.1.2.3.3.2b.cmml"><mtext id="S3.Ex5.m2.1.1.2.3.3.2a" xref="S3.Ex5.m2.1.1.2.3.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex5.m2.1.1.2.3.3.1" xref="S3.Ex5.m2.1.1.2.3.3.1.cmml">⁢</mo><msub id="S3.Ex5.m2.1.1.2.3.3.3" xref="S3.Ex5.m2.1.1.2.3.3.3.cmml"><mi id="S3.Ex5.m2.1.1.2.3.3.3.2" xref="S3.Ex5.m2.1.1.2.3.3.3.2.cmml">α</mi><mi id="S3.Ex5.m2.1.1.2.3.3.3.3" xref="S3.Ex5.m2.1.1.2.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mfrac></mstyle><mo id="S3.Ex5.m2.1.1.1" xref="S3.Ex5.m2.1.1.1.cmml">⁢</mo><msub id="S3.Ex5.m2.1.1.3" xref="S3.Ex5.m2.1.1.3.cmml"><mi id="S3.Ex5.m2.1.1.3.2" xref="S3.Ex5.m2.1.1.3.2.cmml">β</mi><mi id="S3.Ex5.m2.1.1.3.3" xref="S3.Ex5.m2.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m2.1b"><apply id="S3.Ex5.m2.1.1.cmml" xref="S3.Ex5.m2.1.1"><times id="S3.Ex5.m2.1.1.1.cmml" xref="S3.Ex5.m2.1.1.1"></times><apply id="S3.Ex5.m2.1.1.2.cmml" xref="S3.Ex5.m2.1.1.2"><divide id="S3.Ex5.m2.1.1.2.1.cmml" xref="S3.Ex5.m2.1.1.2"></divide><apply id="S3.Ex5.m2.1.1.2.2.cmml" xref="S3.Ex5.m2.1.1.2.2"><minus id="S3.Ex5.m2.1.1.2.2.1.cmml" xref="S3.Ex5.m2.1.1.2.2.1"></minus><cn id="S3.Ex5.m2.1.1.2.2.2.cmml" type="integer" xref="S3.Ex5.m2.1.1.2.2.2">1</cn><apply id="S3.Ex5.m2.1.1.2.2.3.cmml" xref="S3.Ex5.m2.1.1.2.2.3"><times id="S3.Ex5.m2.1.1.2.2.3.1.cmml" xref="S3.Ex5.m2.1.1.2.2.3.1"></times><ci id="S3.Ex5.m2.1.1.2.2.3.2b.cmml" xref="S3.Ex5.m2.1.1.2.2.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex5.m2.1.1.2.2.3.2.cmml" xref="S3.Ex5.m2.1.1.2.2.3.2"><mtext id="S3.Ex5.m2.1.1.2.2.3.2a.cmml" xref="S3.Ex5.m2.1.1.2.2.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex5.m2.1.1.2.2.3.3.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.1.1.2.2.3.3.1.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3">subscript</csymbol><ci id="S3.Ex5.m2.1.1.2.2.3.3.2.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3.2">𝛼</ci><apply id="S3.Ex5.m2.1.1.2.2.3.3.3.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3.3"><minus id="S3.Ex5.m2.1.1.2.2.3.3.3.1.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3.3.1"></minus><ci id="S3.Ex5.m2.1.1.2.2.3.3.3.2.cmml" xref="S3.Ex5.m2.1.1.2.2.3.3.3.2">𝑡</ci><cn id="S3.Ex5.m2.1.1.2.2.3.3.3.3.cmml" type="integer" xref="S3.Ex5.m2.1.1.2.2.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.Ex5.m2.1.1.2.3.cmml" xref="S3.Ex5.m2.1.1.2.3"><minus id="S3.Ex5.m2.1.1.2.3.1.cmml" xref="S3.Ex5.m2.1.1.2.3.1"></minus><cn id="S3.Ex5.m2.1.1.2.3.2.cmml" type="integer" xref="S3.Ex5.m2.1.1.2.3.2">1</cn><apply id="S3.Ex5.m2.1.1.2.3.3.cmml" xref="S3.Ex5.m2.1.1.2.3.3"><times id="S3.Ex5.m2.1.1.2.3.3.1.cmml" xref="S3.Ex5.m2.1.1.2.3.3.1"></times><ci id="S3.Ex5.m2.1.1.2.3.3.2b.cmml" xref="S3.Ex5.m2.1.1.2.3.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex5.m2.1.1.2.3.3.2.cmml" xref="S3.Ex5.m2.1.1.2.3.3.2"><mtext id="S3.Ex5.m2.1.1.2.3.3.2a.cmml" xref="S3.Ex5.m2.1.1.2.3.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex5.m2.1.1.2.3.3.3.cmml" xref="S3.Ex5.m2.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.1.1.2.3.3.3.1.cmml" xref="S3.Ex5.m2.1.1.2.3.3.3">subscript</csymbol><ci id="S3.Ex5.m2.1.1.2.3.3.3.2.cmml" xref="S3.Ex5.m2.1.1.2.3.3.3.2">𝛼</ci><ci id="S3.Ex5.m2.1.1.2.3.3.3.3.cmml" xref="S3.Ex5.m2.1.1.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex5.m2.1.1.3.cmml" xref="S3.Ex5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.1.1.3.1.cmml" xref="S3.Ex5.m2.1.1.3">subscript</csymbol><ci id="S3.Ex5.m2.1.1.3.2.cmml" xref="S3.Ex5.m2.1.1.3.2">𝛽</ci><ci id="S3.Ex5.m2.1.1.3.3.cmml" xref="S3.Ex5.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m2.1c">\displaystyle\frac{1-\widebar{\alpha}_{t-1}}{1-\widebar{\alpha}_{t}}\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m2.1d">divide start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.3">Above, the conditioning on <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">𝐱</mi><mn id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝐱</ci><cn id="S3.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is necessary for the posterior to be tractable. The primary goal of a diffusion model is to learn the initial distribution such that arbitrary Gaussian noise can be gradually denoised to produce outputs from the original input data distribution <math alttext="q(\mathbf{x})" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.2" xref="S3.p4.2.m2.1.2.cmml"><mi id="S3.p4.2.m2.1.2.2" xref="S3.p4.2.m2.1.2.2.cmml">q</mi><mo id="S3.p4.2.m2.1.2.1" xref="S3.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p4.2.m2.1.2.3.2" xref="S3.p4.2.m2.1.2.cmml"><mo id="S3.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p4.2.m2.1.2.cmml">(</mo><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">𝐱</mi><mo id="S3.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.2.cmml" xref="S3.p4.2.m2.1.2"><times id="S3.p4.2.m2.1.2.1.cmml" xref="S3.p4.2.m2.1.2.1"></times><ci id="S3.p4.2.m2.1.2.2.cmml" xref="S3.p4.2.m2.1.2.2">𝑞</ci><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">q(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_q ( bold_x )</annotation></semantics></math>. Without conditioning on <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">x</mi><mn id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑥</ci><cn id="S3.p4.3.m3.1.1.3.cmml" type="integer" xref="S3.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we need:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})=\mathcal{N}\left(\mathbf{x}_{t-1};%
\mu_{\theta}(\mathbf{x}_{t},t),\Sigma_{\theta}(\mathbf{x}_{t},t)\right)" class="ltx_Math" display="block" id="S3.Ex6.m1.6"><semantics id="S3.Ex6.m1.6a"><mrow id="S3.Ex6.m1.6.6" xref="S3.Ex6.m1.6.6.cmml"><mrow id="S3.Ex6.m1.3.3.1" xref="S3.Ex6.m1.3.3.1.cmml"><msub id="S3.Ex6.m1.3.3.1.3" xref="S3.Ex6.m1.3.3.1.3.cmml"><mi id="S3.Ex6.m1.3.3.1.3.2" xref="S3.Ex6.m1.3.3.1.3.2.cmml">p</mi><mi id="S3.Ex6.m1.3.3.1.3.3" xref="S3.Ex6.m1.3.3.1.3.3.cmml">θ</mi></msub><mo id="S3.Ex6.m1.3.3.1.2" xref="S3.Ex6.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.3.3.1.1.1" xref="S3.Ex6.m1.3.3.1.1.1.1.cmml"><mo id="S3.Ex6.m1.3.3.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.3.3.1.1.1.1" xref="S3.Ex6.m1.3.3.1.1.1.1.cmml"><msub id="S3.Ex6.m1.3.3.1.1.1.1.2" xref="S3.Ex6.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.Ex6.m1.3.3.1.1.1.1.2.2" xref="S3.Ex6.m1.3.3.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S3.Ex6.m1.3.3.1.1.1.1.2.3" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.3.3.1.1.1.1.2.3.2" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.Ex6.m1.3.3.1.1.1.1.2.3.1" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.Ex6.m1.3.3.1.1.1.1.2.3.3" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.Ex6.m1.3.3.1.1.1.1.1" xref="S3.Ex6.m1.3.3.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex6.m1.3.3.1.1.1.1.3" xref="S3.Ex6.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.3.3.1.1.1.1.3.2" xref="S3.Ex6.m1.3.3.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S3.Ex6.m1.3.3.1.1.1.1.3.3" xref="S3.Ex6.m1.3.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.Ex6.m1.3.3.1.1.1.3" stretchy="false" xref="S3.Ex6.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.6.6.5" xref="S3.Ex6.m1.6.6.5.cmml">=</mo><mrow id="S3.Ex6.m1.6.6.4" xref="S3.Ex6.m1.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.6.6.4.5" xref="S3.Ex6.m1.6.6.4.5.cmml">𝒩</mi><mo id="S3.Ex6.m1.6.6.4.4" xref="S3.Ex6.m1.6.6.4.4.cmml">⁢</mo><mrow id="S3.Ex6.m1.6.6.4.3.3" xref="S3.Ex6.m1.6.6.4.3.4.cmml"><mo id="S3.Ex6.m1.6.6.4.3.3.4" xref="S3.Ex6.m1.6.6.4.3.4.cmml">(</mo><msub id="S3.Ex6.m1.4.4.2.1.1.1" xref="S3.Ex6.m1.4.4.2.1.1.1.cmml"><mi id="S3.Ex6.m1.4.4.2.1.1.1.2" xref="S3.Ex6.m1.4.4.2.1.1.1.2.cmml">𝐱</mi><mrow id="S3.Ex6.m1.4.4.2.1.1.1.3" xref="S3.Ex6.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.Ex6.m1.4.4.2.1.1.1.3.2" xref="S3.Ex6.m1.4.4.2.1.1.1.3.2.cmml">t</mi><mo id="S3.Ex6.m1.4.4.2.1.1.1.3.1" xref="S3.Ex6.m1.4.4.2.1.1.1.3.1.cmml">−</mo><mn id="S3.Ex6.m1.4.4.2.1.1.1.3.3" xref="S3.Ex6.m1.4.4.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex6.m1.6.6.4.3.3.5" xref="S3.Ex6.m1.6.6.4.3.4.cmml">;</mo><mrow id="S3.Ex6.m1.5.5.3.2.2.2" xref="S3.Ex6.m1.5.5.3.2.2.2.cmml"><msub id="S3.Ex6.m1.5.5.3.2.2.2.3" xref="S3.Ex6.m1.5.5.3.2.2.2.3.cmml"><mi id="S3.Ex6.m1.5.5.3.2.2.2.3.2" xref="S3.Ex6.m1.5.5.3.2.2.2.3.2.cmml">μ</mi><mi id="S3.Ex6.m1.5.5.3.2.2.2.3.3" xref="S3.Ex6.m1.5.5.3.2.2.2.3.3.cmml">θ</mi></msub><mo id="S3.Ex6.m1.5.5.3.2.2.2.2" xref="S3.Ex6.m1.5.5.3.2.2.2.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.5.5.3.2.2.2.1.1" xref="S3.Ex6.m1.5.5.3.2.2.2.1.2.cmml"><mo id="S3.Ex6.m1.5.5.3.2.2.2.1.1.2" stretchy="false" xref="S3.Ex6.m1.5.5.3.2.2.2.1.2.cmml">(</mo><msub id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.cmml"><mi id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.2" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.3" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex6.m1.5.5.3.2.2.2.1.1.3" xref="S3.Ex6.m1.5.5.3.2.2.2.1.2.cmml">,</mo><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">t</mi><mo id="S3.Ex6.m1.5.5.3.2.2.2.1.1.4" stretchy="false" xref="S3.Ex6.m1.5.5.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.6.6.4.3.3.6" xref="S3.Ex6.m1.6.6.4.3.4.cmml">,</mo><mrow id="S3.Ex6.m1.6.6.4.3.3.3" xref="S3.Ex6.m1.6.6.4.3.3.3.cmml"><msub id="S3.Ex6.m1.6.6.4.3.3.3.3" xref="S3.Ex6.m1.6.6.4.3.3.3.3.cmml"><mi id="S3.Ex6.m1.6.6.4.3.3.3.3.2" mathvariant="normal" xref="S3.Ex6.m1.6.6.4.3.3.3.3.2.cmml">Σ</mi><mi id="S3.Ex6.m1.6.6.4.3.3.3.3.3" xref="S3.Ex6.m1.6.6.4.3.3.3.3.3.cmml">θ</mi></msub><mo id="S3.Ex6.m1.6.6.4.3.3.3.2" xref="S3.Ex6.m1.6.6.4.3.3.3.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.6.6.4.3.3.3.1.1" xref="S3.Ex6.m1.6.6.4.3.3.3.1.2.cmml"><mo id="S3.Ex6.m1.6.6.4.3.3.3.1.1.2" stretchy="false" xref="S3.Ex6.m1.6.6.4.3.3.3.1.2.cmml">(</mo><msub id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.cmml"><mi id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.2" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.3" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex6.m1.6.6.4.3.3.3.1.1.3" xref="S3.Ex6.m1.6.6.4.3.3.3.1.2.cmml">,</mo><mi id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml">t</mi><mo id="S3.Ex6.m1.6.6.4.3.3.3.1.1.4" stretchy="false" xref="S3.Ex6.m1.6.6.4.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.6.6.4.3.3.7" xref="S3.Ex6.m1.6.6.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.6b"><apply id="S3.Ex6.m1.6.6.cmml" xref="S3.Ex6.m1.6.6"><eq id="S3.Ex6.m1.6.6.5.cmml" xref="S3.Ex6.m1.6.6.5"></eq><apply id="S3.Ex6.m1.3.3.1.cmml" xref="S3.Ex6.m1.3.3.1"><times id="S3.Ex6.m1.3.3.1.2.cmml" xref="S3.Ex6.m1.3.3.1.2"></times><apply id="S3.Ex6.m1.3.3.1.3.cmml" xref="S3.Ex6.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.3.3.1.3.1.cmml" xref="S3.Ex6.m1.3.3.1.3">subscript</csymbol><ci id="S3.Ex6.m1.3.3.1.3.2.cmml" xref="S3.Ex6.m1.3.3.1.3.2">𝑝</ci><ci id="S3.Ex6.m1.3.3.1.3.3.cmml" xref="S3.Ex6.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S3.Ex6.m1.3.3.1.1.1.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.Ex6.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex6.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex6.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2.2">𝐱</ci><apply id="S3.Ex6.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3"><minus id="S3.Ex6.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.1"></minus><ci id="S3.Ex6.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.Ex6.m1.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex6.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex6.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex6.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.3.2">𝐱</ci><ci id="S3.Ex6.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex6.m1.6.6.4.cmml" xref="S3.Ex6.m1.6.6.4"><times id="S3.Ex6.m1.6.6.4.4.cmml" xref="S3.Ex6.m1.6.6.4.4"></times><ci id="S3.Ex6.m1.6.6.4.5.cmml" xref="S3.Ex6.m1.6.6.4.5">𝒩</ci><list id="S3.Ex6.m1.6.6.4.3.4.cmml" xref="S3.Ex6.m1.6.6.4.3.3"><apply id="S3.Ex6.m1.4.4.2.1.1.1.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.4.4.2.1.1.1.1.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.4.4.2.1.1.1.2.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1.2">𝐱</ci><apply id="S3.Ex6.m1.4.4.2.1.1.1.3.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1.3"><minus id="S3.Ex6.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1.3.1"></minus><ci id="S3.Ex6.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.Ex6.m1.4.4.2.1.1.1.3.2">𝑡</ci><cn id="S3.Ex6.m1.4.4.2.1.1.1.3.3.cmml" type="integer" xref="S3.Ex6.m1.4.4.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Ex6.m1.5.5.3.2.2.2.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2"><times id="S3.Ex6.m1.5.5.3.2.2.2.2.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.2"></times><apply id="S3.Ex6.m1.5.5.3.2.2.2.3.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.5.5.3.2.2.2.3.1.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex6.m1.5.5.3.2.2.2.3.2.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.3.2">𝜇</ci><ci id="S3.Ex6.m1.5.5.3.2.2.2.3.3.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.Ex6.m1.5.5.3.2.2.2.1.2.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1"><apply id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.1.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.2.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.2">𝐱</ci><ci id="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.3.cmml" xref="S3.Ex6.m1.5.5.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">𝑡</ci></interval></apply><apply id="S3.Ex6.m1.6.6.4.3.3.3.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3"><times id="S3.Ex6.m1.6.6.4.3.3.3.2.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.2"></times><apply id="S3.Ex6.m1.6.6.4.3.3.3.3.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.6.6.4.3.3.3.3.1.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.3">subscript</csymbol><ci id="S3.Ex6.m1.6.6.4.3.3.3.3.2.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.3.2">Σ</ci><ci id="S3.Ex6.m1.6.6.4.3.3.3.3.3.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.3.3">𝜃</ci></apply><interval closure="open" id="S3.Ex6.m1.6.6.4.3.3.3.1.2.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1"><apply id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.1.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.2.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.2">𝐱</ci><ci id="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.3.cmml" xref="S3.Ex6.m1.6.6.4.3.3.3.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2">𝑡</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.6c">p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})=\mathcal{N}\left(\mathbf{x}_{t-1};%
\mu_{\theta}(\mathbf{x}_{t},t),\Sigma_{\theta}(\mathbf{x}_{t},t)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.6d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = caligraphic_N ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) , roman_Σ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.4">The model, parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_θ</annotation></semantics></math>, is trained to approximate either the mean, <math alttext="\mu_{\theta}" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><msub id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">μ</mi><mi id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝜇</ci><ci id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\mu_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, and variance, <math alttext="\Sigma_{\theta}" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><msub id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><mi id="S3.p5.3.m3.1.1.2" mathvariant="normal" xref="S3.p5.3.m3.1.1.2.cmml">Σ</mi><mi id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2">Σ</ci><ci id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">\Sigma_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">roman_Σ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S3.p5.4.1">or</span> to predict the added noise, <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.p5.4.m4.1"><semantics id="S3.p5.4.m4.1a"><mi id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><ci id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">italic_ϵ</annotation></semantics></math>. Generally, the latter approach has lower variance and this parameterization more closely resembles Langevin dynamics with a loss that resembles the denoising score matching objective <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib5" title="">2020</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\left\|\epsilon-\epsilon_{\theta}(\mathbf{x}_{t},t)\right\|^{2}=%
\left\|\epsilon-\epsilon_{\theta}\left(\sqrt{\widebar{\alpha}_{t}}\mathbf{x}_{%
0}+\sqrt{1-\widebar{\alpha}_{t}}\epsilon,t\right)\right\|^{2}" class="ltx_Math" display="block" id="S3.Ex7.m1.4"><semantics id="S3.Ex7.m1.4a"><mrow id="S3.Ex7.m1.4.4" xref="S3.Ex7.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.4.4.4" xref="S3.Ex7.m1.4.4.4.cmml">ℒ</mi><mo id="S3.Ex7.m1.4.4.5" xref="S3.Ex7.m1.4.4.5.cmml">=</mo><msup id="S3.Ex7.m1.3.3.1" xref="S3.Ex7.m1.3.3.1.cmml"><mrow id="S3.Ex7.m1.3.3.1.1.1" xref="S3.Ex7.m1.3.3.1.1.2.cmml"><mo id="S3.Ex7.m1.3.3.1.1.1.2" xref="S3.Ex7.m1.3.3.1.1.2.1.cmml">‖</mo><mrow id="S3.Ex7.m1.3.3.1.1.1.1" xref="S3.Ex7.m1.3.3.1.1.1.1.cmml"><mi id="S3.Ex7.m1.3.3.1.1.1.1.3" xref="S3.Ex7.m1.3.3.1.1.1.1.3.cmml">ϵ</mi><mo id="S3.Ex7.m1.3.3.1.1.1.1.2" xref="S3.Ex7.m1.3.3.1.1.1.1.2.cmml">−</mo><mrow id="S3.Ex7.m1.3.3.1.1.1.1.1" xref="S3.Ex7.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.Ex7.m1.3.3.1.1.1.1.1.3" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.Ex7.m1.3.3.1.1.1.1.1.3.2" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.Ex7.m1.3.3.1.1.1.1.1.3.3" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.Ex7.m1.3.3.1.1.1.1.1.2" xref="S3.Ex7.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">t</mi><mo id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex7.m1.3.3.1.1.1.3" xref="S3.Ex7.m1.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex7.m1.3.3.1.3" xref="S3.Ex7.m1.3.3.1.3.cmml">2</mn></msup><mo id="S3.Ex7.m1.4.4.6" xref="S3.Ex7.m1.4.4.6.cmml">=</mo><msup id="S3.Ex7.m1.4.4.2" xref="S3.Ex7.m1.4.4.2.cmml"><mrow id="S3.Ex7.m1.4.4.2.1.1" xref="S3.Ex7.m1.4.4.2.1.2.cmml"><mo id="S3.Ex7.m1.4.4.2.1.1.2" xref="S3.Ex7.m1.4.4.2.1.2.1.cmml">‖</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1" xref="S3.Ex7.m1.4.4.2.1.1.1.cmml"><mi id="S3.Ex7.m1.4.4.2.1.1.1.3" xref="S3.Ex7.m1.4.4.2.1.1.1.3.cmml">ϵ</mi><mo id="S3.Ex7.m1.4.4.2.1.1.1.2" xref="S3.Ex7.m1.4.4.2.1.1.1.2.cmml">−</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.cmml"><msub id="S3.Ex7.m1.4.4.2.1.1.1.1.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3.cmml"><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.cmml"><msqrt id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.cmml"><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2b.cmml"><mtext id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2a" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml">α</mi><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mn id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.cmml"><msqrt id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.cmml"><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.cmml"><mn id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.2.cmml">1</mn><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.1.cmml">−</mo><mrow id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2b.cmml"><mtext id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2a" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2b.cmml">\widebar</mtext></merror><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><msub id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.cmml"><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.2" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.2.cmml">α</mi><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.3.cmml">t</mi></msub></mrow></mrow></msqrt><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.1" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.3" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex7.m1.2.2" xref="S3.Ex7.m1.2.2.cmml">t</mi><mo id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.4" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex7.m1.4.4.2.1.1.3" xref="S3.Ex7.m1.4.4.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex7.m1.4.4.2.3" xref="S3.Ex7.m1.4.4.2.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.4b"><apply id="S3.Ex7.m1.4.4.cmml" xref="S3.Ex7.m1.4.4"><and id="S3.Ex7.m1.4.4a.cmml" xref="S3.Ex7.m1.4.4"></and><apply id="S3.Ex7.m1.4.4b.cmml" xref="S3.Ex7.m1.4.4"><eq id="S3.Ex7.m1.4.4.5.cmml" xref="S3.Ex7.m1.4.4.5"></eq><ci id="S3.Ex7.m1.4.4.4.cmml" xref="S3.Ex7.m1.4.4.4">ℒ</ci><apply id="S3.Ex7.m1.3.3.1.cmml" xref="S3.Ex7.m1.3.3.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.2.cmml" xref="S3.Ex7.m1.3.3.1">superscript</csymbol><apply id="S3.Ex7.m1.3.3.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.Ex7.m1.3.3.1.1.2.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.2">norm</csymbol><apply id="S3.Ex7.m1.3.3.1.1.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1"><minus id="S3.Ex7.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.2"></minus><ci id="S3.Ex7.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.3">italic-ϵ</ci><apply id="S3.Ex7.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1"><times id="S3.Ex7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.Ex7.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex7.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.Ex7.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.3.3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">𝑡</ci></interval></apply></apply></apply><cn id="S3.Ex7.m1.3.3.1.3.cmml" type="integer" xref="S3.Ex7.m1.3.3.1.3">2</cn></apply></apply><apply id="S3.Ex7.m1.4.4c.cmml" xref="S3.Ex7.m1.4.4"><eq id="S3.Ex7.m1.4.4.6.cmml" xref="S3.Ex7.m1.4.4.6"></eq><share href="https://arxiv.org/html/2409.14689v1#S3.Ex7.m1.3.3.1.cmml" id="S3.Ex7.m1.4.4d.cmml" xref="S3.Ex7.m1.4.4"></share><apply id="S3.Ex7.m1.4.4.2.cmml" xref="S3.Ex7.m1.4.4.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.2.2.cmml" xref="S3.Ex7.m1.4.4.2">superscript</csymbol><apply id="S3.Ex7.m1.4.4.2.1.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.Ex7.m1.4.4.2.1.2.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.2">norm</csymbol><apply id="S3.Ex7.m1.4.4.2.1.1.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1"><minus id="S3.Ex7.m1.4.4.2.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.2"></minus><ci id="S3.Ex7.m1.4.4.2.1.1.1.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.3">italic-ϵ</ci><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1"><times id="S3.Ex7.m1.4.4.2.1.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.2"></times><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.2.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1"><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1"><plus id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2"><times id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2"><root id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2"></root><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2"><times id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2b.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2"><mtext id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.2">\widebar</mtext></merror></ci><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.2">𝛼</ci><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.2">𝐱</ci><cn id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3"><times id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2"><root id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2"></root><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2"><minus id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.1"></minus><cn id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.2.cmml" type="integer" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.2">1</cn><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3"><times id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.1"></times><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2b.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2"><mtext id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2a.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.2">\widebar</mtext></merror></ci><apply id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.1.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.2.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.2">𝛼</ci><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply><ci id="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.4.4.2.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.Ex7.m1.2.2.cmml" xref="S3.Ex7.m1.2.2">𝑡</ci></interval></apply></apply></apply><cn id="S3.Ex7.m1.4.4.2.3.cmml" type="integer" xref="S3.Ex7.m1.4.4.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.4c">\mathcal{L}=\left\|\epsilon-\epsilon_{\theta}(\mathbf{x}_{t},t)\right\|^{2}=%
\left\|\epsilon-\epsilon_{\theta}\left(\sqrt{\widebar{\alpha}_{t}}\mathbf{x}_{%
0}+\sqrt{1-\widebar{\alpha}_{t}}\epsilon,t\right)\right\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.4d">caligraphic_L = ∥ italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = ∥ italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + square-root start_ARG 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_ϵ , italic_t ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p5.9">where <math alttext="\epsilon_{\theta}(\cdot)" class="ltx_Math" display="inline" id="S3.p5.5.m1.1"><semantics id="S3.p5.5.m1.1a"><mrow id="S3.p5.5.m1.1.2" xref="S3.p5.5.m1.1.2.cmml"><msub id="S3.p5.5.m1.1.2.2" xref="S3.p5.5.m1.1.2.2.cmml"><mi id="S3.p5.5.m1.1.2.2.2" xref="S3.p5.5.m1.1.2.2.2.cmml">ϵ</mi><mi id="S3.p5.5.m1.1.2.2.3" xref="S3.p5.5.m1.1.2.2.3.cmml">θ</mi></msub><mo id="S3.p5.5.m1.1.2.1" xref="S3.p5.5.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p5.5.m1.1.2.3.2" xref="S3.p5.5.m1.1.2.cmml"><mo id="S3.p5.5.m1.1.2.3.2.1" stretchy="false" xref="S3.p5.5.m1.1.2.cmml">(</mo><mo id="S3.p5.5.m1.1.1" lspace="0em" rspace="0em" xref="S3.p5.5.m1.1.1.cmml">⋅</mo><mo id="S3.p5.5.m1.1.2.3.2.2" stretchy="false" xref="S3.p5.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.5.m1.1b"><apply id="S3.p5.5.m1.1.2.cmml" xref="S3.p5.5.m1.1.2"><times id="S3.p5.5.m1.1.2.1.cmml" xref="S3.p5.5.m1.1.2.1"></times><apply id="S3.p5.5.m1.1.2.2.cmml" xref="S3.p5.5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p5.5.m1.1.2.2.1.cmml" xref="S3.p5.5.m1.1.2.2">subscript</csymbol><ci id="S3.p5.5.m1.1.2.2.2.cmml" xref="S3.p5.5.m1.1.2.2.2">italic-ϵ</ci><ci id="S3.p5.5.m1.1.2.2.3.cmml" xref="S3.p5.5.m1.1.2.2.3">𝜃</ci></apply><ci id="S3.p5.5.m1.1.1.cmml" xref="S3.p5.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m1.1c">\epsilon_{\theta}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.5.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> is the noise predicted by the model. We use this vanilla diffusion approach over the space of weighted interaction matrices (applying isotropic noise in the forward steps, and training our GDiT architecture to predict the added noise in the reverse process). Inspired by text-conditioned image-generation methods <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib13" title="">2022</a>)</cite>, our approach also conditions on user features, <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.p5.6.m2.1"><semantics id="S3.p5.6.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p5.6.m2.1.1" xref="S3.p5.6.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.p5.6.m2.1b"><ci id="S3.p5.6.m2.1.1.cmml" xref="S3.p5.6.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.m2.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.6.m2.1d">caligraphic_U</annotation></semantics></math>, as well as item features, <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.p5.7.m3.1"><semantics id="S3.p5.7.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p5.7.m3.1.1" xref="S3.p5.7.m3.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.p5.7.m3.1b"><ci id="S3.p5.7.m3.1.1.cmml" xref="S3.p5.7.m3.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.m3.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.7.m3.1d">caligraphic_I</annotation></semantics></math>, such that the model predicts <math alttext="\epsilon_{\theta}(\mathbf{x}_{t},t,\mathcal{U},\mathcal{I})" class="ltx_Math" display="inline" id="S3.p5.8.m4.4"><semantics id="S3.p5.8.m4.4a"><mrow id="S3.p5.8.m4.4.4" xref="S3.p5.8.m4.4.4.cmml"><msub id="S3.p5.8.m4.4.4.3" xref="S3.p5.8.m4.4.4.3.cmml"><mi id="S3.p5.8.m4.4.4.3.2" xref="S3.p5.8.m4.4.4.3.2.cmml">ϵ</mi><mi id="S3.p5.8.m4.4.4.3.3" xref="S3.p5.8.m4.4.4.3.3.cmml">θ</mi></msub><mo id="S3.p5.8.m4.4.4.2" xref="S3.p5.8.m4.4.4.2.cmml">⁢</mo><mrow id="S3.p5.8.m4.4.4.1.1" xref="S3.p5.8.m4.4.4.1.2.cmml"><mo id="S3.p5.8.m4.4.4.1.1.2" stretchy="false" xref="S3.p5.8.m4.4.4.1.2.cmml">(</mo><msub id="S3.p5.8.m4.4.4.1.1.1" xref="S3.p5.8.m4.4.4.1.1.1.cmml"><mi id="S3.p5.8.m4.4.4.1.1.1.2" xref="S3.p5.8.m4.4.4.1.1.1.2.cmml">𝐱</mi><mi id="S3.p5.8.m4.4.4.1.1.1.3" xref="S3.p5.8.m4.4.4.1.1.1.3.cmml">t</mi></msub><mo id="S3.p5.8.m4.4.4.1.1.3" xref="S3.p5.8.m4.4.4.1.2.cmml">,</mo><mi id="S3.p5.8.m4.1.1" xref="S3.p5.8.m4.1.1.cmml">t</mi><mo id="S3.p5.8.m4.4.4.1.1.4" xref="S3.p5.8.m4.4.4.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.8.m4.2.2" xref="S3.p5.8.m4.2.2.cmml">𝒰</mi><mo id="S3.p5.8.m4.4.4.1.1.5" xref="S3.p5.8.m4.4.4.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.8.m4.3.3" xref="S3.p5.8.m4.3.3.cmml">ℐ</mi><mo id="S3.p5.8.m4.4.4.1.1.6" stretchy="false" xref="S3.p5.8.m4.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.8.m4.4b"><apply id="S3.p5.8.m4.4.4.cmml" xref="S3.p5.8.m4.4.4"><times id="S3.p5.8.m4.4.4.2.cmml" xref="S3.p5.8.m4.4.4.2"></times><apply id="S3.p5.8.m4.4.4.3.cmml" xref="S3.p5.8.m4.4.4.3"><csymbol cd="ambiguous" id="S3.p5.8.m4.4.4.3.1.cmml" xref="S3.p5.8.m4.4.4.3">subscript</csymbol><ci id="S3.p5.8.m4.4.4.3.2.cmml" xref="S3.p5.8.m4.4.4.3.2">italic-ϵ</ci><ci id="S3.p5.8.m4.4.4.3.3.cmml" xref="S3.p5.8.m4.4.4.3.3">𝜃</ci></apply><vector id="S3.p5.8.m4.4.4.1.2.cmml" xref="S3.p5.8.m4.4.4.1.1"><apply id="S3.p5.8.m4.4.4.1.1.1.cmml" xref="S3.p5.8.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p5.8.m4.4.4.1.1.1.1.cmml" xref="S3.p5.8.m4.4.4.1.1.1">subscript</csymbol><ci id="S3.p5.8.m4.4.4.1.1.1.2.cmml" xref="S3.p5.8.m4.4.4.1.1.1.2">𝐱</ci><ci id="S3.p5.8.m4.4.4.1.1.1.3.cmml" xref="S3.p5.8.m4.4.4.1.1.1.3">𝑡</ci></apply><ci id="S3.p5.8.m4.1.1.cmml" xref="S3.p5.8.m4.1.1">𝑡</ci><ci id="S3.p5.8.m4.2.2.cmml" xref="S3.p5.8.m4.2.2">𝒰</ci><ci id="S3.p5.8.m4.3.3.cmml" xref="S3.p5.8.m4.3.3">ℐ</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.8.m4.4c">\epsilon_{\theta}(\mathbf{x}_{t},t,\mathcal{U},\mathcal{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p5.8.m4.4d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , caligraphic_U , caligraphic_I )</annotation></semantics></math> and learns the posterior distribution <math alttext="p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathcal{U},\mathcal{I})" class="ltx_Math" display="inline" id="S3.p5.9.m5.3"><semantics id="S3.p5.9.m5.3a"><mrow id="S3.p5.9.m5.3.3" xref="S3.p5.9.m5.3.3.cmml"><msub id="S3.p5.9.m5.3.3.3" xref="S3.p5.9.m5.3.3.3.cmml"><mi id="S3.p5.9.m5.3.3.3.2" xref="S3.p5.9.m5.3.3.3.2.cmml">p</mi><mi id="S3.p5.9.m5.3.3.3.3" xref="S3.p5.9.m5.3.3.3.3.cmml">θ</mi></msub><mo id="S3.p5.9.m5.3.3.2" xref="S3.p5.9.m5.3.3.2.cmml">⁢</mo><mrow id="S3.p5.9.m5.3.3.1.1" xref="S3.p5.9.m5.3.3.1.1.1.cmml"><mo id="S3.p5.9.m5.3.3.1.1.2" stretchy="false" xref="S3.p5.9.m5.3.3.1.1.1.cmml">(</mo><mrow id="S3.p5.9.m5.3.3.1.1.1" xref="S3.p5.9.m5.3.3.1.1.1.cmml"><msub id="S3.p5.9.m5.3.3.1.1.1.3" xref="S3.p5.9.m5.3.3.1.1.1.3.cmml"><mi id="S3.p5.9.m5.3.3.1.1.1.3.2" xref="S3.p5.9.m5.3.3.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.p5.9.m5.3.3.1.1.1.3.3" xref="S3.p5.9.m5.3.3.1.1.1.3.3.cmml"><mi id="S3.p5.9.m5.3.3.1.1.1.3.3.2" xref="S3.p5.9.m5.3.3.1.1.1.3.3.2.cmml">t</mi><mo id="S3.p5.9.m5.3.3.1.1.1.3.3.1" xref="S3.p5.9.m5.3.3.1.1.1.3.3.1.cmml">−</mo><mn id="S3.p5.9.m5.3.3.1.1.1.3.3.3" xref="S3.p5.9.m5.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.p5.9.m5.3.3.1.1.1.2" xref="S3.p5.9.m5.3.3.1.1.1.2.cmml">|</mo><mrow id="S3.p5.9.m5.3.3.1.1.1.1.1" xref="S3.p5.9.m5.3.3.1.1.1.1.2.cmml"><msub id="S3.p5.9.m5.3.3.1.1.1.1.1.1" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1.cmml"><mi id="S3.p5.9.m5.3.3.1.1.1.1.1.1.2" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.p5.9.m5.3.3.1.1.1.1.1.1.3" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p5.9.m5.3.3.1.1.1.1.1.2" xref="S3.p5.9.m5.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.9.m5.1.1" xref="S3.p5.9.m5.1.1.cmml">𝒰</mi><mo id="S3.p5.9.m5.3.3.1.1.1.1.1.3" xref="S3.p5.9.m5.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.9.m5.2.2" xref="S3.p5.9.m5.2.2.cmml">ℐ</mi></mrow></mrow><mo id="S3.p5.9.m5.3.3.1.1.3" stretchy="false" xref="S3.p5.9.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.9.m5.3b"><apply id="S3.p5.9.m5.3.3.cmml" xref="S3.p5.9.m5.3.3"><times id="S3.p5.9.m5.3.3.2.cmml" xref="S3.p5.9.m5.3.3.2"></times><apply id="S3.p5.9.m5.3.3.3.cmml" xref="S3.p5.9.m5.3.3.3"><csymbol cd="ambiguous" id="S3.p5.9.m5.3.3.3.1.cmml" xref="S3.p5.9.m5.3.3.3">subscript</csymbol><ci id="S3.p5.9.m5.3.3.3.2.cmml" xref="S3.p5.9.m5.3.3.3.2">𝑝</ci><ci id="S3.p5.9.m5.3.3.3.3.cmml" xref="S3.p5.9.m5.3.3.3.3">𝜃</ci></apply><apply id="S3.p5.9.m5.3.3.1.1.1.cmml" xref="S3.p5.9.m5.3.3.1.1"><csymbol cd="latexml" id="S3.p5.9.m5.3.3.1.1.1.2.cmml" xref="S3.p5.9.m5.3.3.1.1.1.2">conditional</csymbol><apply id="S3.p5.9.m5.3.3.1.1.1.3.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.p5.9.m5.3.3.1.1.1.3.1.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3">subscript</csymbol><ci id="S3.p5.9.m5.3.3.1.1.1.3.2.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3.2">𝐱</ci><apply id="S3.p5.9.m5.3.3.1.1.1.3.3.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3.3"><minus id="S3.p5.9.m5.3.3.1.1.1.3.3.1.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3.3.1"></minus><ci id="S3.p5.9.m5.3.3.1.1.1.3.3.2.cmml" xref="S3.p5.9.m5.3.3.1.1.1.3.3.2">𝑡</ci><cn id="S3.p5.9.m5.3.3.1.1.1.3.3.3.cmml" type="integer" xref="S3.p5.9.m5.3.3.1.1.1.3.3.3">1</cn></apply></apply><list id="S3.p5.9.m5.3.3.1.1.1.1.2.cmml" xref="S3.p5.9.m5.3.3.1.1.1.1.1"><apply id="S3.p5.9.m5.3.3.1.1.1.1.1.1.cmml" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p5.9.m5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p5.9.m5.3.3.1.1.1.1.1.1.2.cmml" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.p5.9.m5.3.3.1.1.1.1.1.1.3.cmml" xref="S3.p5.9.m5.3.3.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.p5.9.m5.1.1.cmml" xref="S3.p5.9.m5.1.1">𝒰</ci><ci id="S3.p5.9.m5.2.2.cmml" xref="S3.p5.9.m5.2.2">ℐ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.9.m5.3c">p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathcal{U},\mathcal{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p5.9.m5.3d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_U , caligraphic_I )</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Adjacency Matrix vs. Interaction Matrix</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">With a bipartite undirected graph, there is no need to encode the edges with a full adjacency matrix. We instead define our diffusion process to operate over weighted interaction matrices consisting of users along the rows and items along the columns. For example, for the small interaction graph provided in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 1</span></a> we show below both the adjacency matrix and the weighted interaction matrix (abbreviations are used in place of the full movie titles).</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S3.F3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.Ex8">
<td class="ltx_td ltx_border_r" id="S3.Ex8.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.2.1" style="font-size:50%;">342</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.3.1" style="font-size:50%;">254</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.4.1" style="font-size:50%;">436</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.5"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.5.1" style="font-size:50%;">974</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.6"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.6.1" style="font-size:50%;">TGM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.7"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.7.1" style="font-size:50%;">TTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.Ex8.8"><span class="ltx_text ltx_font_typewriter" id="S3.Ex8.8.1" style="font-size:50%;">AVG</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex9">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex9.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex9.1.1" style="font-size:50%;">342</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex9.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex9.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex9.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex9.5"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex9.6"><span class="ltx_text ltx_font_typewriter" id="S3.Ex9.6.1" style="font-size:50%;">5.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex9.7"><span class="ltx_text ltx_font_typewriter" id="S3.Ex9.7.1" style="font-size:50%;">2.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex9.8"><span class="ltx_text ltx_font_typewriter" id="S3.Ex9.8.1" style="font-size:50%;">3.0</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex10.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex10.1.1" style="font-size:50%;">254</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex10.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex10.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex10.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex10.5"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex10.6"><span class="ltx_text ltx_font_typewriter" id="S3.Ex10.6.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex10.7"><span class="ltx_text ltx_font_typewriter" id="S3.Ex10.7.1" style="font-size:50%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex10.8"><span class="ltx_text ltx_font_typewriter" id="S3.Ex10.8.1" style="font-size:50%;">4.0</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex11">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex11.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex11.1.1" style="font-size:50%;">436</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex11.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex11.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex11.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex11.5"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex11.6"><span class="ltx_text ltx_font_typewriter" id="S3.Ex11.6.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex11.7"><span class="ltx_text ltx_font_typewriter" id="S3.Ex11.7.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex11.8"><span class="ltx_text ltx_font_typewriter" id="S3.Ex11.8.1" style="font-size:50%;">4.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex12">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex12.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex12.1.1" style="font-size:50%;">974</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex12.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex12.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex12.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex12.5"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex12.6"><span class="ltx_text ltx_font_typewriter" id="S3.Ex12.6.1" style="font-size:50%;">1.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex12.7"><span class="ltx_text ltx_font_typewriter" id="S3.Ex12.7.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex12.8"><span class="ltx_text ltx_font_typewriter" id="S3.Ex12.8.1" style="font-size:50%;">3.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex13.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex13.1.1" style="font-size:50%;">TGM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex13.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex13.2.1" style="font-size:50%;">5.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex13.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex13.3.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex13.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex13.4.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex13.5"><span class="ltx_text ltx_font_typewriter" id="S3.Ex13.5.1" style="font-size:50%;">1.5</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex13.6"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex13.7"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex13.8"></td>
</tr>
<tr class="ltx_tr" id="S3.Ex14">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex14.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex14.1.1" style="font-size:50%;">TTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex14.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex14.2.1" style="font-size:50%;">2.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex14.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex14.3.1" style="font-size:50%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex14.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex14.4.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex14.5"><span class="ltx_text ltx_font_typewriter" id="S3.Ex14.5.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex14.6"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex14.7"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.Ex14.8"></td>
</tr>
<tr class="ltx_tr" id="S3.Ex15">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex15.1.1" style="font-size:50%;">AVG</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex15.2.1" style="font-size:50%;">3.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex15.3.1" style="font-size:50%;">4.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex15.4.1" style="font-size:50%;">4.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.5"><span class="ltx_text ltx_font_typewriter" id="S3.Ex15.5.1" style="font-size:50%;">3.5</span></td>
<td class="ltx_td ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.6"></td>
<td class="ltx_td ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.7"></td>
<td class="ltx_td ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex15.8"></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:50%;"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Full adjacency matrix for the interaction graph provided in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>. Notice the empty quadrants in the top left and bottom right of the matrix due to the bipartite graph.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F3.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F3.6"><span class="ltx_text" id="S3.F3.6.1" style="font-size:50%;">Adjacency matrix filled with edge weights for bipartite graph of users and movies with edges corresponding to ratings between 1 to 5. Cells corresponding to edges between user-user nodes or movie-movie nodes are empty as they do not exist in the bipartite graph, whereas cells where the user has not rated the corresponding move are filled with three dashes.</span></p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S3.F4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.Ex16">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.Ex16.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.Ex16.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex16.2.1" style="font-size:50%;">TGM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.Ex16.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex16.3.1" style="font-size:50%;">TTN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.Ex16.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex16.4.1" style="font-size:50%;">AVG</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.Ex17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.Ex17.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex17.1.1" style="font-size:50%;">342</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex17.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex17.2.1" style="font-size:50%;">5.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex17.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex17.3.1" style="font-size:50%;">2.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex17.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex17.4.1" style="font-size:50%;">3.0</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.Ex18.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex18.1.1" style="font-size:50%;">254</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex18.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex18.2.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex18.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex18.3.1" style="font-size:50%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex18.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex18.4.1" style="font-size:50%;">4.0</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.Ex19.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex19.1.1" style="font-size:50%;">436</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex19.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex19.2.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex19.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex19.3.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.Ex19.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex19.4.1" style="font-size:50%;">4.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.Ex20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex20.1"><span class="ltx_text ltx_font_typewriter" id="S3.Ex20.1.1" style="font-size:50%;">974</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex20.2"><span class="ltx_text ltx_font_typewriter" id="S3.Ex20.2.1" style="font-size:50%;">1.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex20.3"><span class="ltx_text ltx_font_typewriter" id="S3.Ex20.3.1" style="font-size:50%;">---</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.Ex20.4"><span class="ltx_text ltx_font_typewriter" id="S3.Ex20.4.1" style="font-size:50%;">3.5</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:50%;"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Weighted interaction matrix for the same graph (with non-existent interactions as ‘<span class="ltx_text ltx_font_typewriter" id="S3.F4.6.1">---</span>’). Our proposed diffusion method operates over these weighted interaction matrices.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F4.7">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F4.8"><span class="ltx_text" id="S3.F4.8.1" style="font-size:50%;">Weighted interaction matrix structure which is consistent with the top right corner of the adjacency matrix of the user-movie rating graph. Users are on the vertical axis and movies along the horizontal axis, with ratings in the cells of the array.</span></p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Recommender System Constraints</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">Formulating the recommendation task as a graph diffusion problem introduces two key constraints. First, the set of all users and items (as well as their metadata/attributes) is fixed (e.g. Netflix’s subscribers and movie library). Second, the scale of the graphs we aim to operate on is on the order of at least <math alttext="10^{3}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">10</mn><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><cn id="S3.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.2">10</cn><cn id="S3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">10^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> nodes and <math alttext="10^{5}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">10</mn><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><cn id="S3.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.2">10</cn><cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">10^{5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math> edges. This excludes the majority of prior work on generating graphs using diffusion models as they operate on nodes, edges, and attributes in the forward and reverse processes, and they cannot scale to graphs with thousands of nodes (often because the methods are geared towards applications like molecule generation, where the graphs are substantially smaller and denser than recommender systems).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Proposed Framework</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We take inspiration from the notion of “active node” sampling in the interaction graph from EDGE <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>)</cite>, thus enforcing the same mechanism of scalable local diffusion. Below, we highlight some key differences between our method and prior works.</p>
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.6">Sets of active nodes are sampled a priori and kept fixed throughout the diffusion. This means that our diffusion process is defined on the space of <math alttext="n\times m" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">n</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i1.p1.1.m1.1.1.1.cmml">×</mo><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><times id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1"></times><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝑛</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_n × italic_m</annotation></semantics></math> sub-matrices (called <span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.6.1">“patches”</span>), whose values represent all ratings in a sub-sample of <math alttext="n" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_n</annotation></semantics></math> users and <math alttext="m" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_m</annotation></semantics></math> items from the dataset. During training this translates to a batch of <math alttext="n\times m" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.1"><semantics id="S4.I1.i1.p1.4.m4.1a"><mrow id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.2" xref="S4.I1.i1.p1.4.m4.1.1.2.cmml">n</mi><mo id="S4.I1.i1.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i1.p1.4.m4.1.1.1.cmml">×</mo><mi id="S4.I1.i1.p1.4.m4.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><apply id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1"><times id="S4.I1.i1.p1.4.m4.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1"></times><ci id="S4.I1.i1.p1.4.m4.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.2">𝑛</ci><ci id="S4.I1.i1.p1.4.m4.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.1d">italic_n × italic_m</annotation></semantics></math> interaction matrix patches which are corrupted in the forward process. The model is trained to predict the added noise within these patches given the corrupted data, time-step, and feature information for the <math alttext="n" class="ltx_Math" display="inline" id="S4.I1.i1.p1.5.m5.1"><semantics id="S4.I1.i1.p1.5.m5.1a"><mi id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><ci id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.5.m5.1d">italic_n</annotation></semantics></math> users and <math alttext="m" class="ltx_Math" display="inline" id="S4.I1.i1.p1.6.m6.1"><semantics id="S4.I1.i1.p1.6.m6.1a"><mi id="S4.I1.i1.p1.6.m6.1.1" xref="S4.I1.i1.p1.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.6.m6.1b"><ci id="S4.I1.i1.p1.6.m6.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.6.m6.1d">italic_m</annotation></semantics></math> items within each patch.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.3">For all user-item pairs within a sampled <math alttext="n\times m" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">n</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i2.p1.1.m1.1.1.1.cmml">×</mo><mi id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><times id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"></times><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝑛</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">italic_n × italic_m</annotation></semantics></math> patch, we consider real-valued <span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.3.1">interaction strengths</span> as opposed to binary interactions (e.g. ratings from 1-5 for the MovieLens datasets <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib4" title="">2015</a>)</cite>). This makes the task more difficult but at the same time closer to applications of recommendation systems. The interaction strengths are mapped to the continuous interval <math alttext="[-1,1]" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.2"><semantics id="S4.I1.i2.p1.2.m2.2a"><mrow id="S4.I1.i2.p1.2.m2.2.2.1" xref="S4.I1.i2.p1.2.m2.2.2.2.cmml"><mo id="S4.I1.i2.p1.2.m2.2.2.1.2" stretchy="false" xref="S4.I1.i2.p1.2.m2.2.2.2.cmml">[</mo><mrow id="S4.I1.i2.p1.2.m2.2.2.1.1" xref="S4.I1.i2.p1.2.m2.2.2.1.1.cmml"><mo id="S4.I1.i2.p1.2.m2.2.2.1.1a" xref="S4.I1.i2.p1.2.m2.2.2.1.1.cmml">−</mo><mn id="S4.I1.i2.p1.2.m2.2.2.1.1.2" xref="S4.I1.i2.p1.2.m2.2.2.1.1.2.cmml">1</mn></mrow><mo id="S4.I1.i2.p1.2.m2.2.2.1.3" xref="S4.I1.i2.p1.2.m2.2.2.2.cmml">,</mo><mn id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">1</mn><mo id="S4.I1.i2.p1.2.m2.2.2.1.4" stretchy="false" xref="S4.I1.i2.p1.2.m2.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.2b"><interval closure="closed" id="S4.I1.i2.p1.2.m2.2.2.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2.1"><apply id="S4.I1.i2.p1.2.m2.2.2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.2.2.1.1"><minus id="S4.I1.i2.p1.2.m2.2.2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.2.2.1.1"></minus><cn id="S4.I1.i2.p1.2.m2.2.2.1.1.2.cmml" type="integer" xref="S4.I1.i2.p1.2.m2.2.2.1.1.2">1</cn></apply><cn id="S4.I1.i2.p1.2.m2.1.1.cmml" type="integer" xref="S4.I1.i2.p1.2.m2.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.2d">[ - 1 , 1 ]</annotation></semantics></math>, with <math alttext="0" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><mn id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><cn id="S4.I1.i2.p1.3.m3.1.1.cmml" type="integer" xref="S4.I1.i2.p1.3.m3.1.1">0</cn></annotation-xml></semantics></math> representing a neutral interaction, and positive and negative values corresponding to favorable and unfavorable interactions, respectively.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">With a large (and dense) enough dataset it is reasonable to assume that the distribution of these interaction strengths will be roughly Gaussian, or can easily be transformed to a standard Gaussian in an invertible manner, such as with a quantile transformation. This motivates the usage of the vanilla diffusion method over the space of (transformed) weighted interaction matrices.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">In contrast to EDGE, we noise all edges within a patch at the same time, without employing additional selection at each step. This is made computationally feasible by the a priori subsampling of the active edges, which makes each subsample of size significantly smaller than the entire graph.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(5)</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1">In contrast to DiffRec, we contract the weights of the interaction graph edges to be samples from a standard Gaussian distribution. While DiffRec stops the forward process at some partially-noised time-step to encode historical interaction information as a latent prior, we hope to remove this requirement by conditioning on user and item features, enabling generation by sampling directly from random noise.</p>
</div>
</li>
</ol>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Row-Column Separable Attention (RCSA)</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">A key aspect of weighted interaction matrices is that the axes ordering of users and items can be permuted arbitrarily without changing the encoded information. As a result, spatial correlations in an interaction matrix are not analogous to those present in images. Due to this fact, the predictive power present within a square neighborhood of a user-item pair is limited.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We hypothesize that most of the predictive power relevant to the noise prediction at a particular user-item pair is contained in the interaction matrix entries with either the same user or the same item, that is across the same row or the same column. Analogously, we hypothesize the amount of predictive power present across user-item pairs with different items and different users to be low.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="479" id="S4.F5.g1" src="extracted/5872128/RowColAttn.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>A submatrix/subsample from the full weighted interaction matrix including additional features provided to the denoising model (latent representations for user features, <math alttext="u_{i}" class="ltx_Math" display="inline" id="S4.F5.4.m1.1"><semantics id="S4.F5.4.m1.1b"><msub id="S4.F5.4.m1.1.1" xref="S4.F5.4.m1.1.1.cmml"><mi id="S4.F5.4.m1.1.1.2" xref="S4.F5.4.m1.1.1.2.cmml">u</mi><mi id="S4.F5.4.m1.1.1.3" xref="S4.F5.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.4.m1.1c"><apply id="S4.F5.4.m1.1.1.cmml" xref="S4.F5.4.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.4.m1.1.1.1.cmml" xref="S4.F5.4.m1.1.1">subscript</csymbol><ci id="S4.F5.4.m1.1.1.2.cmml" xref="S4.F5.4.m1.1.1.2">𝑢</ci><ci id="S4.F5.4.m1.1.1.3.cmml" xref="S4.F5.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m1.1d">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.4.m1.1e">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and item features, <math alttext="i_{j}" class="ltx_Math" display="inline" id="S4.F5.5.m2.1"><semantics id="S4.F5.5.m2.1b"><msub id="S4.F5.5.m2.1.1" xref="S4.F5.5.m2.1.1.cmml"><mi id="S4.F5.5.m2.1.1.2" xref="S4.F5.5.m2.1.1.2.cmml">i</mi><mi id="S4.F5.5.m2.1.1.3" xref="S4.F5.5.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.5.m2.1c"><apply id="S4.F5.5.m2.1.1.cmml" xref="S4.F5.5.m2.1.1"><csymbol cd="ambiguous" id="S4.F5.5.m2.1.1.1.cmml" xref="S4.F5.5.m2.1.1">subscript</csymbol><ci id="S4.F5.5.m2.1.1.2.cmml" xref="S4.F5.5.m2.1.1.2">𝑖</ci><ci id="S4.F5.5.m2.1.1.3.cmml" xref="S4.F5.5.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m2.1d">i_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.5.m2.1e">italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>). We also show our custom attention mechanism’s operation for the user-item pair <math alttext="(u_{3},i_{2})" class="ltx_Math" display="inline" id="S4.F5.6.m3.2"><semantics id="S4.F5.6.m3.2b"><mrow id="S4.F5.6.m3.2.2.2" xref="S4.F5.6.m3.2.2.3.cmml"><mo id="S4.F5.6.m3.2.2.2.3" stretchy="false" xref="S4.F5.6.m3.2.2.3.cmml">(</mo><msub id="S4.F5.6.m3.1.1.1.1" xref="S4.F5.6.m3.1.1.1.1.cmml"><mi id="S4.F5.6.m3.1.1.1.1.2" xref="S4.F5.6.m3.1.1.1.1.2.cmml">u</mi><mn id="S4.F5.6.m3.1.1.1.1.3" xref="S4.F5.6.m3.1.1.1.1.3.cmml">3</mn></msub><mo id="S4.F5.6.m3.2.2.2.4" xref="S4.F5.6.m3.2.2.3.cmml">,</mo><msub id="S4.F5.6.m3.2.2.2.2" xref="S4.F5.6.m3.2.2.2.2.cmml"><mi id="S4.F5.6.m3.2.2.2.2.2" xref="S4.F5.6.m3.2.2.2.2.2.cmml">i</mi><mn id="S4.F5.6.m3.2.2.2.2.3" xref="S4.F5.6.m3.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.F5.6.m3.2.2.2.5" stretchy="false" xref="S4.F5.6.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.6.m3.2c"><interval closure="open" id="S4.F5.6.m3.2.2.3.cmml" xref="S4.F5.6.m3.2.2.2"><apply id="S4.F5.6.m3.1.1.1.1.cmml" xref="S4.F5.6.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.F5.6.m3.1.1.1.1.1.cmml" xref="S4.F5.6.m3.1.1.1.1">subscript</csymbol><ci id="S4.F5.6.m3.1.1.1.1.2.cmml" xref="S4.F5.6.m3.1.1.1.1.2">𝑢</ci><cn id="S4.F5.6.m3.1.1.1.1.3.cmml" type="integer" xref="S4.F5.6.m3.1.1.1.1.3">3</cn></apply><apply id="S4.F5.6.m3.2.2.2.2.cmml" xref="S4.F5.6.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.F5.6.m3.2.2.2.2.1.cmml" xref="S4.F5.6.m3.2.2.2.2">subscript</csymbol><ci id="S4.F5.6.m3.2.2.2.2.2.cmml" xref="S4.F5.6.m3.2.2.2.2.2">𝑖</ci><cn id="S4.F5.6.m3.2.2.2.2.3.cmml" type="integer" xref="S4.F5.6.m3.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m3.2d">(u_{3},i_{2})</annotation><annotation encoding="application/x-llamapun" id="S4.F5.6.m3.2e">( italic_u start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, attending over other users’ ratings for the same item (column), as well as the same user’s ratings of other items (row).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F5.7">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F5.8">A visualization of the submatrix from a weighted interaction matrix as a grid of red three dimensional cubes. Users are again along the vertical axis and items along the horizontal axis. Additionally, each user and item is depicted along their respective axes as a vector in three dimensions in the depth dimension to represent the features of each user and item. For row three and column two, these rows are highlighted in darker red with green arrows stretching across the row and column to represent the attention mechanism applied for the user three, item two pair.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.3">The presence of this structure suggests that the commonly used U-Net <cite class="ltx_cite ltx_citemacro_citep">(Ronneberger et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib14" title="">2015</a>)</cite> architecture based on square convolutions is not suitable as it would only capture information within an immediate neighborhood. For this reason, we propose a novel attention module for interaction matrices. Within this module, each element of the matrix is separately attending to elements in its row first and elements in its columns subsequently. This is equivalent to a two-headed masked attention module where the attention coefficients for elements that do not belong to the same row or column, respectively, are masked out. In practice, one attention head operates on the sub-sample of the weighted interaction matrix and the other operates on its transpose. Replacing all attention modules with RCSA modules reduces the computation cost for an <math alttext="N\times M" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.1.m1.1.1.1.cmml">×</mo><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></times><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑁</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">N\times M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_N × italic_M</annotation></semantics></math> patch from <math alttext="O(N^{2}M^{2})" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">O</mi><mo id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.2.m2.1.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml"><msup id="S4.SS1.p3.2.m2.1.1.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.2.cmml">N</mi><mn id="S4.SS1.p3.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS1.p3.2.m2.1.1.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.p3.2.m2.1.1.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.2.cmml">M</mi><mn id="S4.SS1.p3.2.m2.1.1.1.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S4.SS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><times id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"></times><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑂</ci><apply id="S4.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1"><times id="S4.SS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1"></times><apply id="S4.SS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.2">𝑁</ci><cn id="S4.SS1.p3.2.m2.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.3">2</cn></apply><apply id="S4.SS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.2">𝑀</ci><cn id="S4.SS1.p3.2.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">O(N^{2}M^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> for traditional 2D attention mechanisms to <math alttext="O(N^{2}+M^{2})" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">O</mi><mo id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p3.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.3.m3.1.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml"><msup id="S4.SS1.p3.3.m3.1.1.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1.1.2.2" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.2.cmml">N</mi><mn id="S4.SS1.p3.3.m3.1.1.1.1.1.2.3" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS1.p3.3.m3.1.1.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.1.1.cmml">+</mo><msup id="S4.SS1.p3.3.m3.1.1.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.2.cmml">M</mi><mn id="S4.SS1.p3.3.m3.1.1.1.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S4.SS1.p3.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><times id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2"></times><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑂</ci><apply id="S4.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1"><plus id="S4.SS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.1"></plus><apply id="S4.SS1.p3.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.2">𝑁</ci><cn id="S4.SS1.p3.3.m3.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.3">2</cn></apply><apply id="S4.SS1.p3.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.2">𝑀</ci><cn id="S4.SS1.p3.3.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">O(N^{2}+M^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_M start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Graph Diffusion Transformer (GDiT)</h3>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="517" id="S4.F6.g1" src="extracted/5872128/GDiT_Architecture.png" width="521"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Novel GDiT Architecture</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F6.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F6.2">Architecture of the novel graph diffusion transformer. From the bottom left a block of operations is defined which accepts node feature embeddings as inputs. These inputs pass through a row column self attention block, residual connection from the input, layer norm, multi-layer perceptron, residual connection from the output of the layer norm, and a final layer norm. The output of these blocks is connected to a row column cross-attention block. On the right a block of operations is defined to accept noised interaction strengths, and diffusion time step embeddings. The time embeddings are passed through a multi-layer perceptron to generate scale and shift parameters. The noised interaction strengths pass through a layer-norm, scale and shift, row column self attention block, scale, residual connection from the input, layer norm, scale and shift, row column feature strength cross attention, scale, residual connection from prior to the last layer norm, layer norm, scale and shift, multi-layer perceptron, scale, residual connection from prior to the last layer norm, 1x1 convolution, to produce the noise prediction outputs.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We propose a new transformer architecture (<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S4.F6" title="Figure 6 ‣ 4.2. Graph Diffusion Transformer (GDiT) ‣ 4. Proposed Framework ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>) based on Diffusion Transformers (DiT) <cite class="ltx_cite ltx_citemacro_citep">(Peebles and Xie, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib11" title="">2023</a>)</cite>, which we use to attend to user and item features in predicting diffusion noise. Specifically, we merge DiT with scaled layer norms conditioned on the diffusion time step and DiT with cross-attention conditioned on node features. We also apply RCSA (<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S4.F5" title="Figure 5 ‣ 4.1. Row-Column Separable Attention (RCSA) ‣ 4. Proposed Framework ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>) in place of all 2D attention operations. This architectural change better suits attention on bipartite graph structures, as well as providing runtime efficiency by replacing 2D attention with 1D attention. Note that each block can be repeated an arbitrary number of times to enhance the model’s learning capacity for higher dimensional node feature embeddings (or be used to predict multi-dimensional rating/interaction strengths).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.2">We train and evaluate our proposed method, EDGE-Rec, on the MovieLens datasets ML-100k and ML-1M <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib4" title="">2015</a>)</cite>. Evaluation is performed using a set of standard metrics for recommendation systems based on the top-<math alttext="K" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_K</annotation></semantics></math> predictions from the model. We train each model for at least 10000 iterations with a batch size of 16 and patch size at least <math alttext="50\times 50" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><mrow id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mn id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">50</mn><mo id="S5.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><times id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1.1"></times><cn id="S5.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.p1.2.m2.1.1.2">50</cn><cn id="S5.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.p1.2.m2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">50\times 50</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">50 × 50</annotation></semantics></math>. We construct a custom time-aware 90-10 train-test split of the edges to ensure consequentiality and the absence of overlap in the time ranges covered by training and validation split.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Training consists of sampling random patches of specified size <math alttext="n\times m" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mrow id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">n</mi><mo id="S5.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.p2.1.m1.1.1.1.cmml">×</mo><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><times id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1"></times><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝑛</ci><ci id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_n × italic_m</annotation></semantics></math> from the target graph. Uniform random sampling of the full weighted interaction matrix over at least 10000 iterations allows most if not all of the users and items to be included during training. The model is provided patches corrupted to uniformly sampled time-steps, the time-steps each patch is noised to, and user-item features for each patch. Unknown interactions are optionally masked, and, if a user has not interacted with an item, the expected or true interaction strength is set to 0 (neutral).</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Finally, we train the GDiT model by maximizing the usual denoising formulation of the ELBO objective, which we regularize at the single step level using Bayesian Personalized Ranking loss <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib12" title="">2012</a>)</cite> to encourage coherent rankings. At sampling time, we reconstruct patches of ratings from random noise. Notably, given a patch we have access to the known training edges, which precede the test edge edges. This allows to frame the sampling problem as a <span class="ltx_text ltx_font_bold" id="S5.p3.1.1">matrix completion</span> problem. Inspired from <span class="ltx_text ltx_font_bold" id="S5.p3.1.2">inpainting techniques</span> for image completion <cite class="ltx_cite ltx_citemacro_citep">(Lugmayr et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib9" title="">2022</a>)</cite>, we replace the known portion of the patch with the known noised ratings from the training set to further condition the generation on the a priori information and ecourage accurate generation of new ratings that “complete” the already-available ones. These candidates are discarded at test time.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1">We also propose a new method of denoising larger subgraphs by randomly tiling the encompassing subgraph with smaller patches at each reverse-diffusion step. As a result, the entire interaction matrix is denoised uniformly during the sampling process, instead of independently as when patches are naively denoised sequentially.</p>
</div>
<div class="ltx_para" id="S5.p5">
<p class="ltx_p" id="S5.p5.1">Figures <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S5.F7" title="Figure 7 ‣ 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#S5.F8" title="Figure 8 ‣ 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">8</span></a> depict plots for the chosen suite of evaluation metrics for various top-K values. In particular, note that EDGE-Rec surpasses DiffRec baselines (included in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#A1" title="Appendix A DiffRec Baseline Metrics ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Appendix A</span></a>) for most patch sampling tasks on edge densities above around <math alttext="55\%" class="ltx_Math" display="inline" id="S5.p5.1.m1.1"><semantics id="S5.p5.1.m1.1a"><mrow id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml"><mn id="S5.p5.1.m1.1.1.2" xref="S5.p5.1.m1.1.1.2.cmml">55</mn><mo id="S5.p5.1.m1.1.1.1" xref="S5.p5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><apply id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1"><csymbol cd="latexml" id="S5.p5.1.m1.1.1.1.cmml" xref="S5.p5.1.m1.1.1.1">percent</csymbol><cn id="S5.p5.1.m1.1.1.2.cmml" type="integer" xref="S5.p5.1.m1.1.1.2">55</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">55\%</annotation><annotation encoding="application/x-llamapun" id="S5.p5.1.m1.1d">55 %</annotation></semantics></math> (in terms of known interactions). Additionally, we observe that scaling up denoising sampling using our novel tiling method does not significantly degrade recommendations, with sufficient subgraph density.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="147" id="S5.F7.g1" src="extracted/5872128/ml100k-sampling-modes-cropped.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>EDGE-Rec 8-block model evaluation metrics on ML-100k dataset. The figures show average results on arbitrary randomly sampled patches of varying sizes, as well as tiled sampling at <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.F7.2.m1.1"><semantics id="S5.F7.2.m1.1b"><mrow id="S5.F7.2.m1.1.1" xref="S5.F7.2.m1.1.1.cmml"><mn id="S5.F7.2.m1.1.1.2" xref="S5.F7.2.m1.1.1.2.cmml">64</mn><mo id="S5.F7.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F7.2.m1.1.1.1.cmml">×</mo><mn id="S5.F7.2.m1.1.1.3" xref="S5.F7.2.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.2.m1.1c"><apply id="S5.F7.2.m1.1.1.cmml" xref="S5.F7.2.m1.1.1"><times id="S5.F7.2.m1.1.1.1.cmml" xref="S5.F7.2.m1.1.1.1"></times><cn id="S5.F7.2.m1.1.1.2.cmml" type="integer" xref="S5.F7.2.m1.1.1.2">64</cn><cn id="S5.F7.2.m1.1.1.3.cmml" type="integer" xref="S5.F7.2.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.m1.1d">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.F7.2.m1.1e">64 × 64</annotation></semantics></math> over the entire user-item rating graph.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F7.7">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F7.6">Comparison of the evaluation metrics for an 8-block model following the previously described architecture plotted as a set of line graphs. Along the horizontal axis, multiple plots depict the trend in precision, recall, normalized discounted cumulative gain, mean reciprocal rank, and hit rate as K is increased to take the model’s top K predictions for the ML-1M dataset. There are four lines per plot, showing the trends in results for each metric as K is increased, for 3 sampling patch sizes <math alttext="50\times 50" class="ltx_Math" display="inline" id="S5.F7.3.m1.1"><semantics id="S5.F7.3.m1.1a"><mrow id="S5.F7.3.m1.1.1" xref="S5.F7.3.m1.1.1.cmml"><mn id="S5.F7.3.m1.1.1.2" xref="S5.F7.3.m1.1.1.2.cmml">50</mn><mo id="S5.F7.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F7.3.m1.1.1.1.cmml">×</mo><mn id="S5.F7.3.m1.1.1.3" xref="S5.F7.3.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.3.m1.1b"><apply id="S5.F7.3.m1.1.1.cmml" xref="S5.F7.3.m1.1.1"><times id="S5.F7.3.m1.1.1.1.cmml" xref="S5.F7.3.m1.1.1.1"></times><cn id="S5.F7.3.m1.1.1.2.cmml" type="integer" xref="S5.F7.3.m1.1.1.2">50</cn><cn id="S5.F7.3.m1.1.1.3.cmml" type="integer" xref="S5.F7.3.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.3.m1.1c">50\times 50</annotation><annotation encoding="application/x-llamapun" id="S5.F7.3.m1.1d">50 × 50</annotation></semantics></math>, <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.F7.4.m2.1"><semantics id="S5.F7.4.m2.1a"><mrow id="S5.F7.4.m2.1.1" xref="S5.F7.4.m2.1.1.cmml"><mn id="S5.F7.4.m2.1.1.2" xref="S5.F7.4.m2.1.1.2.cmml">64</mn><mo id="S5.F7.4.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F7.4.m2.1.1.1.cmml">×</mo><mn id="S5.F7.4.m2.1.1.3" xref="S5.F7.4.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.4.m2.1b"><apply id="S5.F7.4.m2.1.1.cmml" xref="S5.F7.4.m2.1.1"><times id="S5.F7.4.m2.1.1.1.cmml" xref="S5.F7.4.m2.1.1.1"></times><cn id="S5.F7.4.m2.1.1.2.cmml" type="integer" xref="S5.F7.4.m2.1.1.2">64</cn><cn id="S5.F7.4.m2.1.1.3.cmml" type="integer" xref="S5.F7.4.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.m2.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.F7.4.m2.1d">64 × 64</annotation></semantics></math>, and <math alttext="80\times 80" class="ltx_Math" display="inline" id="S5.F7.5.m3.1"><semantics id="S5.F7.5.m3.1a"><mrow id="S5.F7.5.m3.1.1" xref="S5.F7.5.m3.1.1.cmml"><mn id="S5.F7.5.m3.1.1.2" xref="S5.F7.5.m3.1.1.2.cmml">80</mn><mo id="S5.F7.5.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F7.5.m3.1.1.1.cmml">×</mo><mn id="S5.F7.5.m3.1.1.3" xref="S5.F7.5.m3.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.5.m3.1b"><apply id="S5.F7.5.m3.1.1.cmml" xref="S5.F7.5.m3.1.1"><times id="S5.F7.5.m3.1.1.1.cmml" xref="S5.F7.5.m3.1.1.1"></times><cn id="S5.F7.5.m3.1.1.2.cmml" type="integer" xref="S5.F7.5.m3.1.1.2">80</cn><cn id="S5.F7.5.m3.1.1.3.cmml" type="integer" xref="S5.F7.5.m3.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.5.m3.1c">80\times 80</annotation><annotation encoding="application/x-llamapun" id="S5.F7.5.m3.1d">80 × 80</annotation></semantics></math>, as well as tiled sampling over the full graph with tile size <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.F7.6.m4.1"><semantics id="S5.F7.6.m4.1a"><mrow id="S5.F7.6.m4.1.1" xref="S5.F7.6.m4.1.1.cmml"><mn id="S5.F7.6.m4.1.1.2" xref="S5.F7.6.m4.1.1.2.cmml">64</mn><mo id="S5.F7.6.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F7.6.m4.1.1.1.cmml">×</mo><mn id="S5.F7.6.m4.1.1.3" xref="S5.F7.6.m4.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.6.m4.1b"><apply id="S5.F7.6.m4.1.1.cmml" xref="S5.F7.6.m4.1.1"><times id="S5.F7.6.m4.1.1.1.cmml" xref="S5.F7.6.m4.1.1.1"></times><cn id="S5.F7.6.m4.1.1.2.cmml" type="integer" xref="S5.F7.6.m4.1.1.2">64</cn><cn id="S5.F7.6.m4.1.1.3.cmml" type="integer" xref="S5.F7.6.m4.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.6.m4.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.F7.6.m4.1d">64 × 64</annotation></semantics></math>.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="269" id="S5.F8.g1" src="extracted/5872128/ml100k_results_cropped.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>EDGE-Rec 1-block model evaluation metrics on ML-100k dataset. The top row depicts results on arbitrary <math alttext="50\times 50" class="ltx_Math" display="inline" id="S5.F8.5.m1.1"><semantics id="S5.F8.5.m1.1b"><mrow id="S5.F8.5.m1.1.1" xref="S5.F8.5.m1.1.1.cmml"><mn id="S5.F8.5.m1.1.1.2" xref="S5.F8.5.m1.1.1.2.cmml">50</mn><mo id="S5.F8.5.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F8.5.m1.1.1.1.cmml">×</mo><mn id="S5.F8.5.m1.1.1.3" xref="S5.F8.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.5.m1.1c"><apply id="S5.F8.5.m1.1.1.cmml" xref="S5.F8.5.m1.1.1"><times id="S5.F8.5.m1.1.1.1.cmml" xref="S5.F8.5.m1.1.1.1"></times><cn id="S5.F8.5.m1.1.1.2.cmml" type="integer" xref="S5.F8.5.m1.1.1.2">50</cn><cn id="S5.F8.5.m1.1.1.3.cmml" type="integer" xref="S5.F8.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.5.m1.1d">50\times 50</annotation><annotation encoding="application/x-llamapun" id="S5.F8.5.m1.1e">50 × 50</annotation></semantics></math> patches from subgraphs of specified density. The bottom row compares evaluations for sampling a fixed <math alttext="50\times 50" class="ltx_Math" display="inline" id="S5.F8.6.m2.1"><semantics id="S5.F8.6.m2.1b"><mrow id="S5.F8.6.m2.1.1" xref="S5.F8.6.m2.1.1.cmml"><mn id="S5.F8.6.m2.1.1.2" xref="S5.F8.6.m2.1.1.2.cmml">50</mn><mo id="S5.F8.6.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F8.6.m2.1.1.1.cmml">×</mo><mn id="S5.F8.6.m2.1.1.3" xref="S5.F8.6.m2.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.6.m2.1c"><apply id="S5.F8.6.m2.1.1.cmml" xref="S5.F8.6.m2.1.1"><times id="S5.F8.6.m2.1.1.1.cmml" xref="S5.F8.6.m2.1.1.1"></times><cn id="S5.F8.6.m2.1.1.2.cmml" type="integer" xref="S5.F8.6.m2.1.1.2">50</cn><cn id="S5.F8.6.m2.1.1.3.cmml" type="integer" xref="S5.F8.6.m2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.6.m2.1d">50\times 50</annotation><annotation encoding="application/x-llamapun" id="S5.F8.6.m2.1e">50 × 50</annotation></semantics></math> patch to sampling the entire subgraph for a fixed label density of <math alttext="70\%" class="ltx_Math" display="inline" id="S5.F8.7.m3.1"><semantics id="S5.F8.7.m3.1b"><mrow id="S5.F8.7.m3.1.1" xref="S5.F8.7.m3.1.1.cmml"><mn id="S5.F8.7.m3.1.1.2" xref="S5.F8.7.m3.1.1.2.cmml">70</mn><mo id="S5.F8.7.m3.1.1.1" xref="S5.F8.7.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.7.m3.1c"><apply id="S5.F8.7.m3.1.1.cmml" xref="S5.F8.7.m3.1.1"><csymbol cd="latexml" id="S5.F8.7.m3.1.1.1.cmml" xref="S5.F8.7.m3.1.1.1">percent</csymbol><cn id="S5.F8.7.m3.1.1.2.cmml" type="integer" xref="S5.F8.7.m3.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.7.m3.1d">70\%</annotation><annotation encoding="application/x-llamapun" id="S5.F8.7.m3.1e">70 %</annotation></semantics></math>, which corresponds to the top 100 users and 100 movies, by rating density (i.e. a <math alttext="100\times 100" class="ltx_Math" display="inline" id="S5.F8.8.m4.1"><semantics id="S5.F8.8.m4.1b"><mrow id="S5.F8.8.m4.1.1" xref="S5.F8.8.m4.1.1.cmml"><mn id="S5.F8.8.m4.1.1.2" xref="S5.F8.8.m4.1.1.2.cmml">100</mn><mo id="S5.F8.8.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F8.8.m4.1.1.1.cmml">×</mo><mn id="S5.F8.8.m4.1.1.3" xref="S5.F8.8.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.8.m4.1c"><apply id="S5.F8.8.m4.1.1.cmml" xref="S5.F8.8.m4.1.1"><times id="S5.F8.8.m4.1.1.1.cmml" xref="S5.F8.8.m4.1.1.1"></times><cn id="S5.F8.8.m4.1.1.2.cmml" type="integer" xref="S5.F8.8.m4.1.1.2">100</cn><cn id="S5.F8.8.m4.1.1.3.cmml" type="integer" xref="S5.F8.8.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.8.m4.1d">100\times 100</annotation><annotation encoding="application/x-llamapun" id="S5.F8.8.m4.1e">100 × 100</annotation></semantics></math> patch).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F8.9">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F8.10">Evaluation metrics for the previously described architecture plotted as a set of line graphs. Along the horizontal axis, multiple plots depict the trend in precision, recall, normalized discounted cumulative gain, mean reciprocal rank, and hit rate as K is increased to take the model’s top K predictions for the ML-100K dataset. On the top row are the metrics when performing 50x50 patch sampling, with multiple lines in each plot depicting the metrics when specifying a varying minimum density of 0.5, 0.6, 0.7, or 0.8 for the sampled patches. The bottom row of plots for each metric shows the trend in performance as K is increased to take the model’s top K predictions, and compares 50x50 patch sampling with a density of 0.7 for the edges, against the performance for full graph subsampling via the novel tiling method.</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Model and patch size</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We upscale the experiments with the proposed architecture by stacking 8 GDiT blocks. <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S5.F9" title="Figure 9 ‣ 5.1. Model and patch size ‣ 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 9</span></a> shows the results obtained across different choices of density and patch size. Notably, when compared with corresponding smaller baselines composed of a single block (<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S5.F8" title="Figure 8 ‣ 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 8</span></a>), we observe improvements of up to 0.13 in magnitude across all top-1, top-5 and top-10 metrics. This suggest a strong improvement in the quality of the resulting rankings overall. We further observe the role of the patch size in balancing precision and recall. Specifically, from top-20 to top-50, as the patch size increases, meaning that the number of ranked candidates is increased, <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#S5.F9" title="Figure 9 ‣ 5.1. Model and patch size ‣ 5. Evaluation ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 9</span></a> shows an increase in precision and recall, and a decrease in NDCG.</p>
</div>
<figure class="ltx_figure" id="S5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="151" id="S5.F9.g1" src="extracted/5872128/ml100k-large-model-sampling-cropped.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9. </span>EDGE-Rec 8-block model evaluation metrics on ML-100k dataset. The figure depicts results on arbitrary patches of <math alttext="50\times 50" class="ltx_Math" display="inline" id="S5.F9.3.m1.1"><semantics id="S5.F9.3.m1.1b"><mrow id="S5.F9.3.m1.1.1" xref="S5.F9.3.m1.1.1.cmml"><mn id="S5.F9.3.m1.1.1.2" xref="S5.F9.3.m1.1.1.2.cmml">50</mn><mo id="S5.F9.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F9.3.m1.1.1.1.cmml">×</mo><mn id="S5.F9.3.m1.1.1.3" xref="S5.F9.3.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F9.3.m1.1c"><apply id="S5.F9.3.m1.1.1.cmml" xref="S5.F9.3.m1.1.1"><times id="S5.F9.3.m1.1.1.1.cmml" xref="S5.F9.3.m1.1.1.1"></times><cn id="S5.F9.3.m1.1.1.2.cmml" type="integer" xref="S5.F9.3.m1.1.1.2">50</cn><cn id="S5.F9.3.m1.1.1.3.cmml" type="integer" xref="S5.F9.3.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.3.m1.1d">50\times 50</annotation><annotation encoding="application/x-llamapun" id="S5.F9.3.m1.1e">50 × 50</annotation></semantics></math> and <math alttext="80\times 80" class="ltx_Math" display="inline" id="S5.F9.4.m2.1"><semantics id="S5.F9.4.m2.1b"><mrow id="S5.F9.4.m2.1.1" xref="S5.F9.4.m2.1.1.cmml"><mn id="S5.F9.4.m2.1.1.2" xref="S5.F9.4.m2.1.1.2.cmml">80</mn><mo id="S5.F9.4.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F9.4.m2.1.1.1.cmml">×</mo><mn id="S5.F9.4.m2.1.1.3" xref="S5.F9.4.m2.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F9.4.m2.1c"><apply id="S5.F9.4.m2.1.1.cmml" xref="S5.F9.4.m2.1.1"><times id="S5.F9.4.m2.1.1.1.cmml" xref="S5.F9.4.m2.1.1.1"></times><cn id="S5.F9.4.m2.1.1.2.cmml" type="integer" xref="S5.F9.4.m2.1.1.2">80</cn><cn id="S5.F9.4.m2.1.1.3.cmml" type="integer" xref="S5.F9.4.m2.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.4.m2.1d">80\times 80</annotation><annotation encoding="application/x-llamapun" id="S5.F9.4.m2.1e">80 × 80</annotation></semantics></math> sizes and specified densities. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F9.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F9.6">Comparison of the evaluation metrics for a 8-blocks model following the previously described architecture across different choices of density and patch size plotted as a set of line graphs. Along the horizontal axis, multiple plots depict the trend in precision, recall, normalized discounted cumulative gain, mean reciprocal rank, and hit rate as K is increased to take the model’s top K predictions for the ML-100K dataset. Multiple lines in each plot depict the metrics when specifying a varying minimum density of 0.5 or 0.7 and a patch size of 50x50 or 80x80.</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Larger Datasets</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.2">We train and evaluate a large model with 16 GDiT layers and <math alttext="\sim 14" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">∼</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\sim 14</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">∼ 14</annotation></semantics></math>-million parameters on the larger ML-1M dataset <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib4" title="">2015</a>)</cite>. This dataset contains 1,000,000 ratings from over 6000 users and 4000 movies (10,000 nodes and 1,000,000 edges). A patch size of <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mn id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">64</mn><mo id="S5.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><times id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></times><cn id="S5.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.2">64</cn><cn id="S5.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">64 × 64</annotation></semantics></math> was used. Evaluation is performed by randomly sampling 10 patches of the same size from the full weighted interaction matrix, performing in-painting as previously mentioned, and averaging the metrics over these patches. Note the model predictions are compared against test edges (user ratings the model has not previously seen).</p>
</div>
<figure class="ltx_figure" id="S5.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="145" id="S5.F10.g1" src="extracted/5872128/ML1M.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10. </span>EDGE-Rec 16-block model evaluation metrics on ML-1M dataset. The figures show average results on arbitrary randomly sampled patches of size <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.F10.2.m1.1"><semantics id="S5.F10.2.m1.1b"><mrow id="S5.F10.2.m1.1.1" xref="S5.F10.2.m1.1.1.cmml"><mn id="S5.F10.2.m1.1.1.2" xref="S5.F10.2.m1.1.1.2.cmml">64</mn><mo id="S5.F10.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F10.2.m1.1.1.1.cmml">×</mo><mn id="S5.F10.2.m1.1.1.3" xref="S5.F10.2.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F10.2.m1.1c"><apply id="S5.F10.2.m1.1.1.cmml" xref="S5.F10.2.m1.1.1"><times id="S5.F10.2.m1.1.1.1.cmml" xref="S5.F10.2.m1.1.1.1"></times><cn id="S5.F10.2.m1.1.1.2.cmml" type="integer" xref="S5.F10.2.m1.1.1.2">64</cn><cn id="S5.F10.2.m1.1.1.3.cmml" type="integer" xref="S5.F10.2.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.2.m1.1d">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.F10.2.m1.1e">64 × 64</annotation></semantics></math>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F10.3">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F10.4">Comparison of the evaluation metrics for a 16-block model following the previously described architecture plotted as a set of line graphs. Along the horizontal axis, multiple plots depict the trend in precision, recall, normalized discounted cumulative gain, mean reciprocal rank, and hit rate as K is increased to take the model’s top K predictions for the ML-1M dataset. There is one line per plot showing the trend in results for each metric as K is increased.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">Due to the consistency of the metrics between our evaluations on ML-100K and ML-1M, we conclude that our model is able to scale to large datasets well. Despite an order of magnitude more data, performance is relatively minimally degraded. This is most likely driven by our training strategy involving random patch sampling, while our evaluation strategy adopts this scalable approach as well.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusions and Limitations</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We propose a graph-diffusion-based recommendation model that predicts continuous interaction strengths. Building on advancements in conditioned diffusion models, we generate recommendations by conditioning on user and item features. By tuning the size of the patch, our model shows promising performance, despite the patch size being two orders of magnitude smaller than the complete graph. Assuming one can identify dense patches of the graph with high accuracy, this makes the training process highly scalable in the number of users and items. However, in highly sparse production-level environments, identifying such patches can be a challenge, as it essentially reduces to the retrieval problem. This makes the assumption of a dense patch size particularly strong and a clear limitation of the method. If available, future work could pair this ranking methodology with a trained retrieval model that produces high-density patches of candidate user-item pairs.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
To Michael Mu, for the late-night company in the MSML lounge, and for answering our many questions on recent diffusion model developments.

</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergmeister et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Andreas Bergmeister, Karolis Martinkus, Nathanaël Perraudin, and Roger Wattenhofer. 2024.

</span>
<span class="ltx_bibblock">Efficient and Scalable Graph Generation through Iterative Local Expansion.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2312.11529 [cs.SI]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiaohui Chen, Jiaxing He, Xu Han, and Li-Ping Liu. 2023.

</span>
<span class="ltx_bibblock">Efficient and Degree-Guided Graph Generation via Discrete Diffusion Modeling.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.04111 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
F. Maxwell Harper and Joseph A. Konstan. 2015.

</span>
<span class="ltx_bibblock">The MovieLens Datasets: History and Context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">ACM Trans. Interact. Intell. Syst.</em> 5, 4, Article 19 (dec 2015), 19 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2827872" title="">https://doi.org/10.1145/2827872</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel. 2020.

</span>
<span class="ltx_bibblock">Denoising Diffusion Probabilistic Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2006.11239 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yangqin Jiang, Yuhao Yang, Lianghao Xia, and Chao Huang. 2023.

</span>
<span class="ltx_bibblock">DiffKG: Knowledge Graph Diffusion Model for Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2312.16890 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jo et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jaehyeong Jo, Seul Lee, and Sung Ju Hwang. 2022.

</span>
<span class="ltx_bibblock">Score-based Generative Modeling of Graphs via the System of Stochastic Differential Equations.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2202.02514 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Chengyi Liu, Wenqi Fan, Yunqing Liu, Jiatong Li, Hang Li, Hui Liu, Jiliang Tang, and Qing Li. 2023.

</span>
<span class="ltx_bibblock">Generative Diffusion Models on Graphs: Methods and Applications.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2302.02591 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lugmayr et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Andreas Lugmayr, Martin Danelljan, Andres Romero, Fisher Yu, Radu Timofte, and Luc Van Gool. 2022.

</span>
<span class="ltx_bibblock">Repaint: Inpainting using denoising diffusion probabilistic models. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>. 11461–11471.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Haokai Ma, Ruobing Xie, Lei Meng, Xin Chen, Xu Zhang, Leyu Lin, and Zhanhui Kang. 2024.

</span>
<span class="ltx_bibblock">Plug-in Diffusion Model for Sequential Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2401.02913 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peebles and Xie (2023)</span>
<span class="ltx_bibblock">
William Peebles and Saining Xie. 2023.

</span>
<span class="ltx_bibblock">Scalable diffusion models with transformers. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>. 4195–4205.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2012.

</span>
<span class="ltx_bibblock">BPR: Bayesian Personalized Ranking from Implicit Feedback.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1205.2618 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rombach et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer. 2022.

</span>
<span class="ltx_bibblock">High-resolution image synthesis with latent diffusion models. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>. 10684–10695.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox. 2015.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18</em>. Springer, 234–241.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vignac et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Clement Vignac, Igor Krawczuk, Antoine Siraudin, Bohan Wang, Volkan Cevher, and Pascal Frossard. 2023.

</span>
<span class="ltx_bibblock">DiGress: Discrete Denoising diffusion for graph generation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2209.14734 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Xiangnan He, Quan Z. Sheng, Mehmet A. Orgun, Longbing Cao, Francesco Ricci, and Philip S. Yu. 2021.

</span>
<span class="ltx_bibblock">Graph Learning based Recommender Systems: A Review.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2105.06339 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenjie Wang, Yiyan Xu, Fuli Feng, Xinyu Lin, Xiangnan He, and Tat-Seng Chua. 2023.

</span>
<span class="ltx_bibblock">Diffusion Recommender Model.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2304.04971 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhengyi Yang, Jiancan Wu, Zhicai Wang, Xiang Wang, Yancheng Yuan, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">Generate What You Prefer: Reshaping Sequential Recommendation via Guided Diffusion.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2310.20453 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zixuan Yi, Xi Wang, and Iadh Ounis. 2024.

</span>
<span class="ltx_bibblock">A Directional Diffusion Graph Transformer for Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2404.03326 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunqin Zhu, Chao Wang, and Hui Xiong. 2023.

</span>
<span class="ltx_bibblock">Towards Graph-Aware Diffusion Modeling for Collaborative Filtering.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2311.08744 [cs.IR]

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>DiffRec Baseline Metrics</h2>
<figure class="ltx_figure" id="A1.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="238" id="A1.F11.g1" src="extracted/5872128/diffrec_metrics.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11. </span>DiffRec <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>)</cite> evaluation metrics on ML-100k and ML-1M.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F11.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F11.2">Baseline metrics for the DiffRec <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14689v1#bib.bib17" title="">2023</a>)</cite> algorithm.</p>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Visualizing the Sparsity in the MovieLens datasets</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#A2.F12" title="Figure 12 ‣ Appendix B Visualizing the Sparsity in the MovieLens datasets ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 12</span></a> visualizes the ratings provided by all users for the movies in the MovieLens-100K dataset. Note the inherent sparsity in the encoded interaction matrix.</p>
</div>
<figure class="ltx_figure" id="A2.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="314" id="A2.F12.g1" src="extracted/5872128/movielens_heatmap.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12. </span>Heat-map of ratings provided by users for movies ranging from 1 to 5 in the MovieLens-100K dataset. Values are 0 (black) where the user has not rated the movie.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A2.F12.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A2.F12.2">A plot of a heat-map for the ratings provided by users for movies in the Movie Lens 100K dataset, with an orange color intensity scheme. User IDs are on the y-axis and Movie IDs are on the x-axis. Where there are unrated movies from users, the pixels are black, and pixels are colored from red, to orange, to white corresponding to ratings of 1, 3, and 5 respectively. There is a grid like structure to the pixel colors, emphasizing popular movies that have been rated by many users, and users who have rated many movies.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">In order to sample dense subgraphs of the interaction matrix, we heuristically identify “important” or densely connected users and movies by counting the number of nodes at a distance of 2 edges from each user or movie node in the interaction graph. <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2409.14689v1#A2.F13" title="Figure 13 ‣ Appendix B Visualizing the Sparsity in the MovieLens datasets ‣ EDGE-Rec: Efficient and Data-Guided Edge Diffusion For Recommender Systems Graphs"><span class="ltx_text ltx_ref_tag">Figure 13</span></a> is a heat-map of the data after sorting users and movies by this heuristic. We sample dense subgraphs of the ML-100k dataset by selecting a suitably-sized sub-matrix from the lower left corner of the visualized sorted complete graph adjacency matrix.</p>
</div>
<figure class="ltx_figure" id="A2.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="314" id="A2.F13.g1" src="extracted/5872128/movielens_sorted.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13. </span>Heat-map of user-provided ratings for movies in the MovieLens-100K dataset, sorted heuristically by density of graph.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A2.F13.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A2.F13.2">A plot of a heat-map for the ratings provided by users for movies in the Movie Lens 100K dataset, with an orange color intensity scheme. User IDs are on the y-axis and Movie IDs are on the x-axis. Where there are unrated movies from users, the pixels are black, and pixels are colored from red, to orange, to white corresponding to ratings of 1, 3, and 5 respectively. Due to the heuristic sorting based on the density of the graph, most colored pixels are concentrated near the bottom left of the plot, and the gradient going towards the bottom left changes the pixel colors from black, to red, to orange, to white.</p>
</div>
</div>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 23 03:15:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
