<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.08228] Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective</title><meta property="og:description" content="Reconstruction-based methods, particularly those leveraging autoencoders, have been widely adopted to perform anomaly detection in brain MRI.
While most existing works try to improve detection accuracy by proposing new…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.08228">

<!--Generated on Thu Sep  5 15:20:46 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Anomaly detection,  Autoencoders,  DDPM,  Image quality assessment
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zixuan Pan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_font_italic">Computer Science and Engineering</span>
<br class="ltx_break"><span id="id4.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">zpan3@nd.edu
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Xia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_font_italic">Computer Science and Engineering</span>
<br class="ltx_break"><span id="id6.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">jxia4@nd.edu
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zheyu Yan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_font_italic">Computer Science and Engineering</span>
<br class="ltx_break"><span id="id8.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">zyan2@nd.edu
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guoyue Xu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id9.1.id1" class="ltx_text ltx_font_italic">Aerospace and Mechanical Engineering</span>
<br class="ltx_break"><span id="id10.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">gxu3@nd.edu
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yawen Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id11.1.id1" class="ltx_text ltx_font_italic">Computer Science and Engineering</span>
<br class="ltx_break"><span id="id12.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">yawen.wu@pitt.edu
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenge Jia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id13.1.id1" class="ltx_text ltx_font_italic">Computer Science and Technology</span>
<br class="ltx_break"><span id="id14.2.id2" class="ltx_text ltx_font_italic">Shandong University
<br class="ltx_break"></span>Shandong, China 
<br class="ltx_break">zhengejia@sdu.edu.cn
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianxu Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id15.1.id1" class="ltx_text ltx_font_italic">Leibniz-Institut für Analytische Wissenschaften - ISAS e.V.
<br class="ltx_break"></span>Dortmund, Germany 
<br class="ltx_break">jianxu.chen@isas.de
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yiyu Shi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id16.1.id1" class="ltx_text ltx_font_italic">Computer Science and Engineering</span>
<br class="ltx_break"><span id="id17.2.id2" class="ltx_text ltx_font_italic">University of Notre Dame
<br class="ltx_break"></span>Notre Dame, USA 
<br class="ltx_break">yshi4@nd.edu
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.2" class="ltx_p">Reconstruction-based methods, particularly those leveraging autoencoders, have been widely adopted to perform anomaly detection in brain MRI.
While most existing works try to improve detection accuracy by proposing new model structures or algorithms, we tackle the problem through image quality assessment, an underexplored perspective in the field.
We propose a fusion quality loss function that combines Structural Similarity Index Measure loss with <math id="id1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="id1.1.m1.1a"><msub id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi mathvariant="normal" id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml">ℓ</mi><mn id="id1.1.m1.1.1.3" xref="id1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="ambiguous" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1">subscript</csymbol><ci id="id1.1.m1.1.1.2.cmml" xref="id1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="id1.1.m1.1.1.3.cmml" xref="id1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\ell_{1}</annotation></semantics></math> loss, offering a more comprehensive evaluation of reconstruction quality.
Additionally, we introduce a data pre-processing strategy that enhances the average intensity ratio (AIR) between normal and abnormal regions, further improving the distinction of anomalies.
By fusing the aforementioned two methods, we devise the image quality assessment (IQA) approach.
The proposed IQA approach achieves significant improvements (<math id="id2.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="id2.2.m2.1a"><mo id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><gt id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">&gt;</annotation></semantics></math>10%) in terms of Dice coefficient (DICE) and Area Under the Precision-Recall Curve (AUPRC) on the BraTS21 (T2, FLAIR) and MSULB datasets when compared with state-of-the-art methods.
These results highlight the importance of invoking the comprehensive image quality assessment in medical anomaly detection and provide a new perspective for future research in this field.
The code is available at <a target="_blank" href="https://github.com/zx-pan/MedAnomalyDetection-IQA" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/zx-pan/MedAnomalyDetection-IQA</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Anomaly detection, Autoencoders, DDPM, Image quality assessment

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">For decades, deep learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> have been widely used to assist radiologists in disease recognition, such as detecting tumors from brain MRI scans. Traditional supervised learning approaches, however, require a large amount of labeled data (e.g., tumor segmentation masks), which are often difficult to obtain for medical images. To address this challenge, many self-supervised, semi-supervised, and weakly supervised learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> have been developed. These methods effectively utilize both limited labeled data and abundant unlabeled data. Among these approaches, framing the disease recognition task as an anomaly detection problem has gained popularity. This type of method trains solely on unannotated normal images (e.g., MRI scans of healthy brains), enabling the identification of abnormalities (e.g., tumor segmentation) without extensive manual labeling.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Reconstruction-based methods, such as autoencoders (AEs) and their variants, have shown great promise in medical anomaly detection. These methods are trained to reconstruct original images from corrupted versions, with the assumption that anomalies are harder to reconstruct than normal regions. During inference, the difference between the reconstructed and original test images indicates the anomaly level for each pixel. Consequently, abnormal areas exhibit higher reconstruction errors, detectable through post-processing techniques (e.g., binarization with a threshold).</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, standard AEs and variational autoencoders (VAEs) often produce blurry reconstructions, leading to suboptimal anomaly detection performance.
To enhance these models, various improvements have been proposed, such as adding spatial latent dimensions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, incorporating skip connections <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, or developing denoising autoencoders (DAEs)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Research has also highlighted that simplex noise generally outperforms Gaussian noise in DAE-based anomaly detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.2" class="ltx_p">While these work takes much efforts in carefully designing the models and algorithms, the importance of the metrics used to evaluate reconstructions is often overlooked, with most approaches defaulting to <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\ell_{1}</annotation></semantics></math> loss.
In contrast, we revisit the problem of reconstruction-based anomaly detection in brain MRI from an image quality assessment (IQA) perspective, an underexplored aspect in this field.
Our intuition is based on the observation that simply changing the way the reconstruction residuals are calculated can significantly improve anomaly detection performance. As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, even with the same reconstruction, using Structural Similarity Index Measure (SSIM) loss to calculate the anomaly map can detect the anomalies that the commonly used <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.p4.2.m2.1a"><msub id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi mathvariant="normal" id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">ℓ</mi><mn id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">subscript</csymbol><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\ell_{1}</annotation></semantics></math> loss might miss.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.3" class="ltx_p">Based on the above observations, we argue that metrics beyond <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.p5.1.m1.1a"><msub id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1">subscript</csymbol><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\ell_{1}</annotation></semantics></math> are essential for a more comprehensive assessment of reconstructions during the training and inference phases of anomaly detection.
We propose a fusion quality loss that combines SSIM loss with the widely used <math id="S1.p5.2.m2.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.p5.2.m2.1a"><msub id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml"><mi mathvariant="normal" id="S1.p5.2.m2.1.1.2" xref="S1.p5.2.m2.1.1.2.cmml">ℓ</mi><mn id="S1.p5.2.m2.1.1.3" xref="S1.p5.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p5.2.m2.1.1.1.cmml" xref="S1.p5.2.m2.1.1">subscript</csymbol><ci id="S1.p5.2.m2.1.1.2.cmml" xref="S1.p5.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S1.p5.2.m2.1.1.3.cmml" xref="S1.p5.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">\ell_{1}</annotation></semantics></math> loss. This combined loss function evaluates the reconstruction based on intensity (subtractive from <math id="S1.p5.3.m3.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.p5.3.m3.1a"><msub id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml"><mi mathvariant="normal" id="S1.p5.3.m3.1.1.2" xref="S1.p5.3.m3.1.1.2.cmml">ℓ</mi><mn id="S1.p5.3.m3.1.1.3" xref="S1.p5.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><apply id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p5.3.m3.1.1.1.cmml" xref="S1.p5.3.m3.1.1">subscript</csymbol><ci id="S1.p5.3.m3.1.1.2.cmml" xref="S1.p5.3.m3.1.1.2">ℓ</ci><cn type="integer" id="S1.p5.3.m3.1.1.3.cmml" xref="S1.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">\ell_{1}</annotation></semantics></math> and divisive from SSIM), contrast, and structure similarity, capturing the strength of both error functions.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Evaluating reconstruction quality beyond just pixel-wise intensity introduces a higher level view, making subtle variations in different regions more impactful in the final assessment, comparing to existing anomaly detection solutions. In this situation, the inherent characteristics of images from a semantic perspective becomes increasingly important for optimizing anomaly detection performance, therefore necessitates commensurate pre-processing steps tailored to these expanded metrics.
Since we introduce divisive metrics from SSIM, it is important to amplify the divisive discrepancies between anomalies and normal regions.
To this end, we propose a pre-processing strategy to consistently enhance the average intensity ratio (AIR) between normal and abnormal regions, thereby improving the overall effectiveness of the model.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">We refer to our final approach, which combines the fusion quality loss and AIR enhancement pre-processing strategy, as the IQA approach. We evaluate its effectiveness on several commonly used datasets by applying it to a baseline model.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2408.08228/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="108" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Visualization of the anomaly maps generated by <math id="S1.F1.2.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.F1.2.m1.1b"><msub id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml"><mi mathvariant="normal" id="S1.F1.2.m1.1.1.2" xref="S1.F1.2.m1.1.1.2.cmml">ℓ</mi><mn id="S1.F1.2.m1.1.1.3" xref="S1.F1.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><apply id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.2.m1.1.1.1.cmml" xref="S1.F1.2.m1.1.1">subscript</csymbol><ci id="S1.F1.2.m1.1.1.2.cmml" xref="S1.F1.2.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.F1.2.m1.1.1.3.cmml" xref="S1.F1.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">\ell_{1}</annotation></semantics></math> loss and SSIM loss from the same reconstruction. Calculating the reconstruction discrepancy with L1-metric cannot flag the large tumor area, while calculating with SSIM, from the same reconstruction, could identify the tumor area significantly better.</figcaption>
</figure>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">We summarize our main contributions as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Incorporation of SSIM Loss</span>: To the best of our knowledge, we are the first to incorporate SSIM loss alongside <math id="S1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S1.I1.i1.p1.1.m1.1a"><msub id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">\ell_{1}</annotation></semantics></math> loss for both training and inference in brain MRI anomaly detection.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Pre-processing Strategy</span>: We propose a simple yet effective dataset pre-processing strategy
to enhance AIR and validate its effectiveness both theoretically and empirically.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Comprehensive experiments</span>: Our results show that our method achieves relative improvements in DICE of up to 15.86% for BraTS21 T2, 21.41% for MSLUB, 30.82% for BraTS21 FLAIR, and 5.27% for BraTS21 T1-CE compared to state-of-the-art (SOTA) baselines.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p"><span id="S1.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Image quality assessment perspective</span>: We investigate brain MRI anomaly detection from an image quality assessment perspective and achieve state-of-the-art performance on the BraTS21 (T2, FLAIR) and MSULB datasets. Our approach opens a new door in the community for studying medical image anomaly detection.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In recent years, reconstruction-based methods using autoencoders (AEs) and their variants have become increasingly popular for medical anomaly detection. These models are trained to reconstruct healthy images, and the reconstruction error is used as an anomaly score. However, the tendency of AEs and VAEs to produce blurry reconstructions can limit their effectiveness in detecting anomalies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. To address this, various advanced AE models have been explored. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> proposes using vector-quantized VAEs that improve discrete feature representation. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> introduces adversarial autoencoders to enhance generative quality through adversarial training. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> uses denoising autoencoders (DAE) to improve image clarity by adding skip connections and performs denoising task during training.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Other than AE-based methods, generative adversarial networks (GANs) have also been applied to anomaly detection tasks. AnoGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, the first GAN-based approach for this task, identifies anomalies in medical images by comparing test images with their GAN-generated healthy counterparts in pixel space. However, AnoGAN requires extensive inference time due to its reliance on numerous back-propagation iterations. To improve inference speed, f-AnoGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> uses an encoder with a Wasserstein GAN for faster mapping to latent space. Despite these improvements, GANs still face stability issues during training and often fail to maintain anatomical coherence, leading to problems like mode collapse <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Denoising diffusion probabilistic models (DDPM) have recently gained attention as a robust method for anomaly detection in brain MRI. anoDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> was the first to apply DDPM in this context, proposing the use of simplex noise to replace Gaussian noise. Building on this, pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> improved anomaly detection performance by adopting a patch-based DDPM approach, where noise is added to patches while the rest of the image remains uncorrupted and serves as a condition. This technique enhances brain MRI reconstruction by incorporating global context information about individual brain structures and appearances. Further extending this concept, mDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> applied the patch-based approach to the frequency domain, yielding additional improvements.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">While much of work in the anomaly detection has focused on designing architectures and algorithms, some studies have investigated different ways of measuring discrepancies. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> applies SSIM loss for industrial defect detection, and replacing the <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S2.p4.1.m1.1a"><msub id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi mathvariant="normal" id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">ℓ</mi><mn id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\ell_{2}</annotation></semantics></math> loss. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> proposed calculating SSIM loss in latent space instead of pixel space, and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
designed an ensembled SSIM approach for anomaly score calculation.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">In summary, existing work in medical anomaly detection has either utilized SSIM loss in latent space or applied it only during inference for anomaly score calculation. We are the first to incorporate SSIM loss for both training and inference in the medical anomaly detection problem, achieving state-of-the-art performance on several commonly used datasets.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we will first sketch the overall framework of reconstruction based anomaly detection and then the core concept of denoising diffusion probabilistic models, which will be the basic our method builds upon. After that, we will introduce our proposed <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">Fusion Quality Loss</span> and <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">Average Intensity Ratio Enhancement</span>, the two major findings after revisiting the brain MRI anomaly detection from an image quality assessment (IQA) perspective. An overview of our final reconstruction-based anoamly detection framework is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2408.08228/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="370" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of our reconstruction-based anomaly detection method using a denoising autoencoder (DAE) as the reconstruction model.
During training, the normal dataset <math id="S3.F2.10.m1.1" class="ltx_Math" alttext="X_{n}" display="inline"><semantics id="S3.F2.10.m1.1b"><msub id="S3.F2.10.m1.1.1" xref="S3.F2.10.m1.1.1.cmml"><mi id="S3.F2.10.m1.1.1.2" xref="S3.F2.10.m1.1.1.2.cmml">X</mi><mi id="S3.F2.10.m1.1.1.3" xref="S3.F2.10.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.10.m1.1c"><apply id="S3.F2.10.m1.1.1.cmml" xref="S3.F2.10.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.10.m1.1.1.1.cmml" xref="S3.F2.10.m1.1.1">subscript</csymbol><ci id="S3.F2.10.m1.1.1.2.cmml" xref="S3.F2.10.m1.1.1.2">𝑋</ci><ci id="S3.F2.10.m1.1.1.3.cmml" xref="S3.F2.10.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.m1.1d">X_{n}</annotation></semantics></math> is augmented with the proposed AIR enhancement pre-processinig strategy and corrupted to form the noisy normal dataset <math id="S3.F2.11.m2.1" class="ltx_math_unparsed" alttext="X_{n}{{}^{\prime}}" display="inline"><semantics id="S3.F2.11.m2.1b"><mrow id="S3.F2.11.m2.1c"><msub id="S3.F2.11.m2.1.1"><mi id="S3.F2.11.m2.1.1.2">X</mi><mi id="S3.F2.11.m2.1.1.3">n</mi></msub><msup id="S3.F2.11.m2.1.2"><mi id="S3.F2.11.m2.1.2b"></mi><mo id="S3.F2.11.m2.1.2.1">′</mo></msup></mrow><annotation encoding="application/x-tex" id="S3.F2.11.m2.1d">X_{n}{{}^{\prime}}</annotation></semantics></math> using simplex noise.
The model is then trained by denoising <math id="S3.F2.12.m3.1" class="ltx_Math" alttext="X_{n}^{\prime}" display="inline"><semantics id="S3.F2.12.m3.1b"><msubsup id="S3.F2.12.m3.1.1" xref="S3.F2.12.m3.1.1.cmml"><mi id="S3.F2.12.m3.1.1.2.2" xref="S3.F2.12.m3.1.1.2.2.cmml">X</mi><mi id="S3.F2.12.m3.1.1.2.3" xref="S3.F2.12.m3.1.1.2.3.cmml">n</mi><mo id="S3.F2.12.m3.1.1.3" xref="S3.F2.12.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.F2.12.m3.1c"><apply id="S3.F2.12.m3.1.1.cmml" xref="S3.F2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.12.m3.1.1.1.cmml" xref="S3.F2.12.m3.1.1">superscript</csymbol><apply id="S3.F2.12.m3.1.1.2.cmml" xref="S3.F2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.12.m3.1.1.2.1.cmml" xref="S3.F2.12.m3.1.1">subscript</csymbol><ci id="S3.F2.12.m3.1.1.2.2.cmml" xref="S3.F2.12.m3.1.1.2.2">𝑋</ci><ci id="S3.F2.12.m3.1.1.2.3.cmml" xref="S3.F2.12.m3.1.1.2.3">𝑛</ci></apply><ci id="S3.F2.12.m3.1.1.3.cmml" xref="S3.F2.12.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m3.1d">X_{n}^{\prime}</annotation></semantics></math> and minimizing the fusion quality loss <math id="S3.F2.13.m4.1" class="ltx_Math" alttext="L_{FQ}" display="inline"><semantics id="S3.F2.13.m4.1b"><msub id="S3.F2.13.m4.1.1" xref="S3.F2.13.m4.1.1.cmml"><mi id="S3.F2.13.m4.1.1.2" xref="S3.F2.13.m4.1.1.2.cmml">L</mi><mrow id="S3.F2.13.m4.1.1.3" xref="S3.F2.13.m4.1.1.3.cmml"><mi id="S3.F2.13.m4.1.1.3.2" xref="S3.F2.13.m4.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.F2.13.m4.1.1.3.1" xref="S3.F2.13.m4.1.1.3.1.cmml">​</mo><mi id="S3.F2.13.m4.1.1.3.3" xref="S3.F2.13.m4.1.1.3.3.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.13.m4.1c"><apply id="S3.F2.13.m4.1.1.cmml" xref="S3.F2.13.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.13.m4.1.1.1.cmml" xref="S3.F2.13.m4.1.1">subscript</csymbol><ci id="S3.F2.13.m4.1.1.2.cmml" xref="S3.F2.13.m4.1.1.2">𝐿</ci><apply id="S3.F2.13.m4.1.1.3.cmml" xref="S3.F2.13.m4.1.1.3"><times id="S3.F2.13.m4.1.1.3.1.cmml" xref="S3.F2.13.m4.1.1.3.1"></times><ci id="S3.F2.13.m4.1.1.3.2.cmml" xref="S3.F2.13.m4.1.1.3.2">𝐹</ci><ci id="S3.F2.13.m4.1.1.3.3.cmml" xref="S3.F2.13.m4.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.13.m4.1d">L_{FQ}</annotation></semantics></math> between the reconstruction <math id="S3.F2.14.m5.1" class="ltx_Math" alttext="\hat{X_{n}}" display="inline"><semantics id="S3.F2.14.m5.1b"><mover accent="true" id="S3.F2.14.m5.1.1" xref="S3.F2.14.m5.1.1.cmml"><msub id="S3.F2.14.m5.1.1.2" xref="S3.F2.14.m5.1.1.2.cmml"><mi id="S3.F2.14.m5.1.1.2.2" xref="S3.F2.14.m5.1.1.2.2.cmml">X</mi><mi id="S3.F2.14.m5.1.1.2.3" xref="S3.F2.14.m5.1.1.2.3.cmml">n</mi></msub><mo id="S3.F2.14.m5.1.1.1" xref="S3.F2.14.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.14.m5.1c"><apply id="S3.F2.14.m5.1.1.cmml" xref="S3.F2.14.m5.1.1"><ci id="S3.F2.14.m5.1.1.1.cmml" xref="S3.F2.14.m5.1.1.1">^</ci><apply id="S3.F2.14.m5.1.1.2.cmml" xref="S3.F2.14.m5.1.1.2"><csymbol cd="ambiguous" id="S3.F2.14.m5.1.1.2.1.cmml" xref="S3.F2.14.m5.1.1.2">subscript</csymbol><ci id="S3.F2.14.m5.1.1.2.2.cmml" xref="S3.F2.14.m5.1.1.2.2">𝑋</ci><ci id="S3.F2.14.m5.1.1.2.3.cmml" xref="S3.F2.14.m5.1.1.2.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.14.m5.1d">\hat{X_{n}}</annotation></semantics></math> and the original normal dataset <math id="S3.F2.15.m6.1" class="ltx_Math" alttext="X_{n}" display="inline"><semantics id="S3.F2.15.m6.1b"><msub id="S3.F2.15.m6.1.1" xref="S3.F2.15.m6.1.1.cmml"><mi id="S3.F2.15.m6.1.1.2" xref="S3.F2.15.m6.1.1.2.cmml">X</mi><mi id="S3.F2.15.m6.1.1.3" xref="S3.F2.15.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.15.m6.1c"><apply id="S3.F2.15.m6.1.1.cmml" xref="S3.F2.15.m6.1.1"><csymbol cd="ambiguous" id="S3.F2.15.m6.1.1.1.cmml" xref="S3.F2.15.m6.1.1">subscript</csymbol><ci id="S3.F2.15.m6.1.1.2.cmml" xref="S3.F2.15.m6.1.1.2">𝑋</ci><ci id="S3.F2.15.m6.1.1.3.cmml" xref="S3.F2.15.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.15.m6.1d">X_{n}</annotation></semantics></math>. During inference, the abnormal test dataset <math id="S3.F2.16.m7.1" class="ltx_Math" alttext="X_{a}" display="inline"><semantics id="S3.F2.16.m7.1b"><msub id="S3.F2.16.m7.1.1" xref="S3.F2.16.m7.1.1.cmml"><mi id="S3.F2.16.m7.1.1.2" xref="S3.F2.16.m7.1.1.2.cmml">X</mi><mi id="S3.F2.16.m7.1.1.3" xref="S3.F2.16.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.16.m7.1c"><apply id="S3.F2.16.m7.1.1.cmml" xref="S3.F2.16.m7.1.1"><csymbol cd="ambiguous" id="S3.F2.16.m7.1.1.1.cmml" xref="S3.F2.16.m7.1.1">subscript</csymbol><ci id="S3.F2.16.m7.1.1.2.cmml" xref="S3.F2.16.m7.1.1.2">𝑋</ci><ci id="S3.F2.16.m7.1.1.3.cmml" xref="S3.F2.16.m7.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.16.m7.1d">X_{a}</annotation></semantics></math> undergoes the same process.
The anomalies in <math id="S3.F2.17.m8.1" class="ltx_Math" alttext="X_{a}" display="inline"><semantics id="S3.F2.17.m8.1b"><msub id="S3.F2.17.m8.1.1" xref="S3.F2.17.m8.1.1.cmml"><mi id="S3.F2.17.m8.1.1.2" xref="S3.F2.17.m8.1.1.2.cmml">X</mi><mi id="S3.F2.17.m8.1.1.3" xref="S3.F2.17.m8.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.17.m8.1c"><apply id="S3.F2.17.m8.1.1.cmml" xref="S3.F2.17.m8.1.1"><csymbol cd="ambiguous" id="S3.F2.17.m8.1.1.1.cmml" xref="S3.F2.17.m8.1.1">subscript</csymbol><ci id="S3.F2.17.m8.1.1.2.cmml" xref="S3.F2.17.m8.1.1.2">𝑋</ci><ci id="S3.F2.17.m8.1.1.3.cmml" xref="S3.F2.17.m8.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.17.m8.1d">X_{a}</annotation></semantics></math> are expected to be poorly reconstructed, resulting in higher values in the <math id="S3.F2.18.m9.1" class="ltx_Math" alttext="L_{FQ}" display="inline"><semantics id="S3.F2.18.m9.1b"><msub id="S3.F2.18.m9.1.1" xref="S3.F2.18.m9.1.1.cmml"><mi id="S3.F2.18.m9.1.1.2" xref="S3.F2.18.m9.1.1.2.cmml">L</mi><mrow id="S3.F2.18.m9.1.1.3" xref="S3.F2.18.m9.1.1.3.cmml"><mi id="S3.F2.18.m9.1.1.3.2" xref="S3.F2.18.m9.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.F2.18.m9.1.1.3.1" xref="S3.F2.18.m9.1.1.3.1.cmml">​</mo><mi id="S3.F2.18.m9.1.1.3.3" xref="S3.F2.18.m9.1.1.3.3.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.18.m9.1c"><apply id="S3.F2.18.m9.1.1.cmml" xref="S3.F2.18.m9.1.1"><csymbol cd="ambiguous" id="S3.F2.18.m9.1.1.1.cmml" xref="S3.F2.18.m9.1.1">subscript</csymbol><ci id="S3.F2.18.m9.1.1.2.cmml" xref="S3.F2.18.m9.1.1.2">𝐿</ci><apply id="S3.F2.18.m9.1.1.3.cmml" xref="S3.F2.18.m9.1.1.3"><times id="S3.F2.18.m9.1.1.3.1.cmml" xref="S3.F2.18.m9.1.1.3.1"></times><ci id="S3.F2.18.m9.1.1.3.2.cmml" xref="S3.F2.18.m9.1.1.3.2">𝐹</ci><ci id="S3.F2.18.m9.1.1.3.3.cmml" xref="S3.F2.18.m9.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.18.m9.1d">L_{FQ}</annotation></semantics></math>-based anomaly map.
The final anomaly map is thresholded for segmentation, with performance measured by DICE and AUPRC.
</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Anomaly detection with pDDPM</span>
</h3>

<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS1.5.1.1" class="ltx_text">III-A</span>1 </span>Reconstruction-based anomaly detection</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.6" class="ltx_p">Given a normal dataset <math id="S3.SS1.SSS1.p1.1.m1.4" class="ltx_Math" alttext="X_{n}=\{x^{n}_{1},x^{n}_{2},...,x^{n}_{N}\}" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.4a"><mrow id="S3.SS1.SSS1.p1.1.m1.4.4" xref="S3.SS1.SSS1.p1.1.m1.4.4.cmml"><msub id="S3.SS1.SSS1.p1.1.m1.4.4.5" xref="S3.SS1.SSS1.p1.1.m1.4.4.5.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.4.4.5.2" xref="S3.SS1.SSS1.p1.1.m1.4.4.5.2.cmml">X</mi><mi id="S3.SS1.SSS1.p1.1.m1.4.4.5.3" xref="S3.SS1.SSS1.p1.1.m1.4.4.5.3.cmml">n</mi></msub><mo id="S3.SS1.SSS1.p1.1.m1.4.4.4" xref="S3.SS1.SSS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.1.m1.4.4.3.3" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.4" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.2.cmml">x</mi><mn id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.2.cmml">x</mi><mn id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.2" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.3.cmml">N</mi><mi id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.3" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.8" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.4b"><apply id="S3.SS1.SSS1.p1.1.m1.4.4.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4"><eq id="S3.SS1.SSS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.4"></eq><apply id="S3.SS1.SSS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.4.4.5.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.4.4.5.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.5.2">𝑋</ci><ci id="S3.SS1.SSS1.p1.1.m1.4.4.5.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.5.3">𝑛</ci></apply><set id="S3.SS1.SSS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.3">𝑛</ci></apply><cn type="integer" id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.3">𝑛</ci></apply><cn type="integer" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.4c">X_{n}=\{x^{n}_{1},x^{n}_{2},...,x^{n}_{N}\}</annotation></semantics></math>, a reconstruction-based anomaly detection method usually trains a model <math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mrow id="S3.SS1.SSS1.p1.2.m2.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.2.cmml"><msub id="S3.SS1.SSS1.p1.2.m2.1.2.2" xref="S3.SS1.SSS1.p1.2.m2.1.2.2.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.2.2.2" xref="S3.SS1.SSS1.p1.2.m2.1.2.2.2.cmml">f</mi><mi id="S3.SS1.SSS1.p1.2.m2.1.2.2.3" xref="S3.SS1.SSS1.p1.2.m2.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.2.m2.1.2.1" xref="S3.SS1.SSS1.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.2.m2.1.2.3.2" xref="S3.SS1.SSS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.1.2.3.2.1" xref="S3.SS1.SSS1.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.1.2.3.2.2" xref="S3.SS1.SSS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2"><times id="S3.SS1.SSS1.p1.2.m2.1.2.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2.1"></times><apply id="S3.SS1.SSS1.p1.2.m2.1.2.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2.2.2">𝑓</ci><ci id="S3.SS1.SSS1.p1.2.m2.1.2.2.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">f_{\theta}(\cdot)</annotation></semantics></math> to restore the original <math id="S3.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="x^{n}_{i}" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><msubsup id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml">i</mi><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">x^{n}_{i}</annotation></semantics></math> from a disturbed one <math id="S3.SS1.SSS1.p1.4.m4.1" class="ltx_math_unparsed" alttext="x^{n}_{i}{{}^{\prime}}" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mrow id="S3.SS1.SSS1.p1.4.m4.1b"><msubsup id="S3.SS1.SSS1.p1.4.m4.1.1"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.2.2">x</mi><mi id="S3.SS1.SSS1.p1.4.m4.1.1.3">i</mi><mi id="S3.SS1.SSS1.p1.4.m4.1.1.2.3">n</mi></msubsup><msup id="S3.SS1.SSS1.p1.4.m4.1.2"><mi id="S3.SS1.SSS1.p1.4.m4.1.2a"></mi><mo id="S3.SS1.SSS1.p1.4.m4.1.2.1">′</mo></msup></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">x^{n}_{i}{{}^{\prime}}</annotation></semantics></math> and expect the reconstruction <math id="S3.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\hat{x^{n}_{i}}" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m5.1a"><mover accent="true" id="S3.SS1.SSS1.p1.5.m5.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.cmml"><msubsup id="S3.SS1.SSS1.p1.5.m5.1.1.2" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.2" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.5.m5.1.1.2.3" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.3.cmml">i</mi><mi id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.3" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.2.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS1.p1.5.m5.1.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m5.1b"><apply id="S3.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1"><ci id="S3.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.1">^</ci><apply id="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m5.1c">\hat{x^{n}_{i}}</annotation></semantics></math> to be as close to <math id="S3.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="x^{n}_{i}" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m6.1a"><msubsup id="S3.SS1.SSS1.p1.6.m6.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p1.6.m6.1.1.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.cmml">i</mi><mi id="S3.SS1.SSS1.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m6.1b"><apply id="S3.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m6.1c">x^{n}_{i}</annotation></semantics></math> as possible.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_math_unparsed" alttext="\min_{\theta}\frac{1}{N}\sum_{i=1}^{N}L_{train}(x^{n}_{i},\hat{x^{n}_{i}}=f_{\theta}(x^{n}_{i}{{}^{\prime}}))," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><munder id="S3.E1.m1.1.2"><mi id="S3.E1.m1.1.2.2">min</mi><mi id="S3.E1.m1.1.2.3">θ</mi></munder><mfrac id="S3.E1.m1.1.3"><mn id="S3.E1.m1.1.3.2">1</mn><mi id="S3.E1.m1.1.3.3">N</mi></mfrac><munderover id="S3.E1.m1.1.4"><mo movablelimits="false" id="S3.E1.m1.1.4.2.2">∑</mo><mrow id="S3.E1.m1.1.4.2.3"><mi id="S3.E1.m1.1.4.2.3.2">i</mi><mo id="S3.E1.m1.1.4.2.3.1">=</mo><mn id="S3.E1.m1.1.4.2.3.3">1</mn></mrow><mi id="S3.E1.m1.1.4.3">N</mi></munderover><msub id="S3.E1.m1.1.5"><mi id="S3.E1.m1.1.5.2">L</mi><mrow id="S3.E1.m1.1.5.3"><mi id="S3.E1.m1.1.5.3.2">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.5.3.1">​</mo><mi id="S3.E1.m1.1.5.3.3">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.5.3.1a">​</mo><mi id="S3.E1.m1.1.5.3.4">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.5.3.1b">​</mo><mi id="S3.E1.m1.1.5.3.5">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.5.3.1c">​</mo><mi id="S3.E1.m1.1.5.3.6">n</mi></mrow></msub><mrow id="S3.E1.m1.1.6"><mo stretchy="false" id="S3.E1.m1.1.6.1">(</mo><msubsup id="S3.E1.m1.1.6.2"><mi id="S3.E1.m1.1.6.2.2.2">x</mi><mi id="S3.E1.m1.1.6.2.3">i</mi><mi id="S3.E1.m1.1.6.2.2.3">n</mi></msubsup><mo id="S3.E1.m1.1.6.3">,</mo><mover accent="true" id="S3.E1.m1.1.1"><msubsup id="S3.E1.m1.1.1.2"><mi id="S3.E1.m1.1.1.2.2.2">x</mi><mi id="S3.E1.m1.1.1.2.3">i</mi><mi id="S3.E1.m1.1.1.2.2.3">n</mi></msubsup><mo id="S3.E1.m1.1.1.1">^</mo></mover><mo id="S3.E1.m1.1.6.4">=</mo><msub id="S3.E1.m1.1.6.5"><mi id="S3.E1.m1.1.6.5.2">f</mi><mi id="S3.E1.m1.1.6.5.3">θ</mi></msub><mrow id="S3.E1.m1.1.6.6"><mo stretchy="false" id="S3.E1.m1.1.6.6.1">(</mo><msubsup id="S3.E1.m1.1.6.6.2"><mi id="S3.E1.m1.1.6.6.2.2.2">x</mi><mi id="S3.E1.m1.1.6.6.2.3">i</mi><mi id="S3.E1.m1.1.6.6.2.2.3">n</mi></msubsup><mmultiscripts id="S3.E1.m1.1.6.6.3"><mo stretchy="false" id="S3.E1.m1.1.6.6.3.2">)</mo><mprescripts id="S3.E1.m1.1.6.6.3a"></mprescripts><mrow id="S3.E1.m1.1.6.6.3b"></mrow><mo id="S3.E1.m1.1.6.6.3.3">′</mo></mmultiscripts></mrow><mo stretchy="false" id="S3.E1.m1.1.6.7">)</mo></mrow><mo id="S3.E1.m1.1.7">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\min_{\theta}\frac{1}{N}\sum_{i=1}^{N}L_{train}(x^{n}_{i},\hat{x^{n}_{i}}=f_{\theta}(x^{n}_{i}{{}^{\prime}})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.7" class="ltx_p">where <math id="S3.SS1.SSS1.p1.7.m1.1" class="ltx_Math" alttext="L_{train}" display="inline"><semantics id="S3.SS1.SSS1.p1.7.m1.1a"><msub id="S3.SS1.SSS1.p1.7.m1.1.1" xref="S3.SS1.SSS1.p1.7.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.7.m1.1.1.2" xref="S3.SS1.SSS1.p1.7.m1.1.1.2.cmml">L</mi><mrow id="S3.SS1.SSS1.p1.7.m1.1.1.3" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.7.m1.1.1.3.2" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.7.m1.1.1.3.1" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p1.7.m1.1.1.3.3" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.7.m1.1.1.3.1a" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p1.7.m1.1.1.3.4" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.7.m1.1.1.3.1b" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p1.7.m1.1.1.3.5" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.7.m1.1.1.3.1c" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p1.7.m1.1.1.3.6" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m1.1b"><apply id="S3.SS1.SSS1.p1.7.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.7.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.7.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.2">𝐿</ci><apply id="S3.SS1.SSS1.p1.7.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3"><times id="S3.SS1.SSS1.p1.7.m1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.1"></times><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.3">𝑟</ci><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3.4.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.4">𝑎</ci><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3.5.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.5">𝑖</ci><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3.6.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m1.1c">L_{train}</annotation></semantics></math> is a function to measure the reconstruction quality.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.6" class="ltx_p">During Inference, we denote the test dataset with anomalies as
<math id="S3.SS1.SSS1.p2.1.m1.4" class="ltx_Math" alttext="X_{a}=\{x^{a}_{1},x^{a}_{2},...,x^{a}_{M}\}" display="inline"><semantics id="S3.SS1.SSS1.p2.1.m1.4a"><mrow id="S3.SS1.SSS1.p2.1.m1.4.4" xref="S3.SS1.SSS1.p2.1.m1.4.4.cmml"><msub id="S3.SS1.SSS1.p2.1.m1.4.4.5" xref="S3.SS1.SSS1.p2.1.m1.4.4.5.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.4.4.5.2" xref="S3.SS1.SSS1.p2.1.m1.4.4.5.2.cmml">X</mi><mi id="S3.SS1.SSS1.p2.1.m1.4.4.5.3" xref="S3.SS1.SSS1.p2.1.m1.4.4.5.3.cmml">a</mi></msub><mo id="S3.SS1.SSS1.p2.1.m1.4.4.4" xref="S3.SS1.SSS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.SSS1.p2.1.m1.4.4.3.3" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.4" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml">x</mi><mn id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.5" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.2.cmml">x</mi><mn id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.6" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.7" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.2" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.3.cmml">M</mi><mi id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.3" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.8" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.4b"><apply id="S3.SS1.SSS1.p2.1.m1.4.4.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4"><eq id="S3.SS1.SSS1.p2.1.m1.4.4.4.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.4"></eq><apply id="S3.SS1.SSS1.p2.1.m1.4.4.5.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.4.4.5.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.4.4.5.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.5.2">𝑋</ci><ci id="S3.SS1.SSS1.p2.1.m1.4.4.5.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.5.3">𝑎</ci></apply><set id="S3.SS1.SSS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3"><apply id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">…</ci><apply id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.2.3">𝑎</ci></apply><ci id="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.4c">X_{a}=\{x^{a}_{1},x^{a}_{2},...,x^{a}_{M}\}</annotation></semantics></math>.
For any test image <math id="S3.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="x^{a}_{j}\in X_{a}" display="inline"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mrow id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml"><msubsup id="S3.SS1.SSS1.p2.2.m2.1.1.2" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.2" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.3.cmml">j</mi><mi id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.SSS1.p2.2.m2.1.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.1.cmml">∈</mo><msub id="S3.SS1.SSS1.p2.2.m2.1.1.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.2.m2.1.1.3.2" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.2.cmml">X</mi><mi id="S3.SS1.SSS1.p2.2.m2.1.1.3.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><apply id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1"><in id="S3.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.1"></in><apply id="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p2.2.m2.1.1.2.2.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.2.3">𝑎</ci></apply><ci id="S3.SS1.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.2">𝑋</ci><ci id="S3.SS1.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">x^{a}_{j}\in X_{a}</annotation></semantics></math>, we first degrade it to <math id="S3.SS1.SSS1.p2.3.m3.1" class="ltx_math_unparsed" alttext="x^{a}_{j}{{}^{\prime}}" display="inline"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><mrow id="S3.SS1.SSS1.p2.3.m3.1b"><msubsup id="S3.SS1.SSS1.p2.3.m3.1.1"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2.2">x</mi><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3">j</mi><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2.3">a</mi></msubsup><msup id="S3.SS1.SSS1.p2.3.m3.1.2"><mi id="S3.SS1.SSS1.p2.3.m3.1.2a"></mi><mo id="S3.SS1.SSS1.p2.3.m3.1.2.1">′</mo></msup></mrow><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">x^{a}_{j}{{}^{\prime}}</annotation></semantics></math>, and then use the well-trained reconstruction model <math id="S3.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="f_{\theta^{*}}(\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><mrow id="S3.SS1.SSS1.p2.4.m4.1.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.cmml"><msub id="S3.SS1.SSS1.p2.4.m4.1.2.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.2.2.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.2.cmml">f</mi><msup id="S3.SS1.SSS1.p2.4.m4.1.2.2.3" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3.2.cmml">θ</mi><mo id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.3" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3.3.cmml">∗</mo></msup></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.4.m4.1.2.1" xref="S3.SS1.SSS1.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p2.4.m4.1.2.3.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p2.4.m4.1.2.3.2.1" xref="S3.SS1.SSS1.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p2.4.m4.1.2.3.2.2" xref="S3.SS1.SSS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><apply id="S3.SS1.SSS1.p2.4.m4.1.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2"><times id="S3.SS1.SSS1.p2.4.m4.1.2.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.1"></times><apply id="S3.SS1.SSS1.p2.4.m4.1.2.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.4.m4.1.2.2.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.4.m4.1.2.2.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.2">𝑓</ci><apply id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3">superscript</csymbol><ci id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3.2">𝜃</ci><times id="S3.SS1.SSS1.p2.4.m4.1.2.2.3.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.2.2.3.3"></times></apply></apply><ci id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">f_{\theta^{*}}(\cdot)</annotation></semantics></math> to get the reconstruction <math id="S3.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\hat{x^{a}_{j}}" display="inline"><semantics id="S3.SS1.SSS1.p2.5.m5.1a"><mover accent="true" id="S3.SS1.SSS1.p2.5.m5.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml"><msubsup id="S3.SS1.SSS1.p2.5.m5.1.1.2" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml"><mi id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.2" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.2.2.cmml">x</mi><mi id="S3.SS1.SSS1.p2.5.m5.1.1.2.3" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.3.cmml">j</mi><mi id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.3" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.SSS1.p2.5.m5.1.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m5.1b"><apply id="S3.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1"><ci id="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.1">^</ci><apply id="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.2.2">𝑥</ci><ci id="S3.SS1.SSS1.p2.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.2.3">𝑎</ci></apply><ci id="S3.SS1.SSS1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m5.1c">\hat{x^{a}_{j}}</annotation></semantics></math>.
The pixel-wise anomaly score map <math id="S3.SS1.SSS1.p2.6.m6.1" class="ltx_Math" alttext="\Lambda_{j}" display="inline"><semantics id="S3.SS1.SSS1.p2.6.m6.1a"><msub id="S3.SS1.SSS1.p2.6.m6.1.1" xref="S3.SS1.SSS1.p2.6.m6.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.SSS1.p2.6.m6.1.1.2" xref="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml">Λ</mi><mi id="S3.SS1.SSS1.p2.6.m6.1.1.3" xref="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.6.m6.1b"><apply id="S3.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.2">Λ</ci><ci id="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.6.m6.1c">\Lambda_{j}</annotation></semantics></math> is defined by the reconstruction error:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_math_unparsed" alttext="\Lambda_{j}=L_{test}(x^{a}_{j},\hat{x^{a}_{j}}=f_{\theta^{*}}(x^{a}_{j}{{}^{\prime}})," display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1b"><msub id="S3.E2.m1.1.2"><mi mathvariant="normal" id="S3.E2.m1.1.2.2">Λ</mi><mi id="S3.E2.m1.1.2.3">j</mi></msub><mo id="S3.E2.m1.1.3">=</mo><msub id="S3.E2.m1.1.4"><mi id="S3.E2.m1.1.4.2">L</mi><mrow id="S3.E2.m1.1.4.3"><mi id="S3.E2.m1.1.4.3.2">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.4.3.1">​</mo><mi id="S3.E2.m1.1.4.3.3">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.4.3.1a">​</mo><mi id="S3.E2.m1.1.4.3.4">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.4.3.1b">​</mo><mi id="S3.E2.m1.1.4.3.5">t</mi></mrow></msub><mrow id="S3.E2.m1.1.5"><mo stretchy="false" id="S3.E2.m1.1.5.1">(</mo><msubsup id="S3.E2.m1.1.5.2"><mi id="S3.E2.m1.1.5.2.2.2">x</mi><mi id="S3.E2.m1.1.5.2.3">j</mi><mi id="S3.E2.m1.1.5.2.2.3">a</mi></msubsup><mo id="S3.E2.m1.1.5.3">,</mo><mover accent="true" id="S3.E2.m1.1.1"><msubsup id="S3.E2.m1.1.1.2"><mi id="S3.E2.m1.1.1.2.2.2">x</mi><mi id="S3.E2.m1.1.1.2.3">j</mi><mi id="S3.E2.m1.1.1.2.2.3">a</mi></msubsup><mo id="S3.E2.m1.1.1.1">^</mo></mover><mo id="S3.E2.m1.1.5.4">=</mo><msub id="S3.E2.m1.1.5.5"><mi id="S3.E2.m1.1.5.5.2">f</mi><msup id="S3.E2.m1.1.5.5.3"><mi id="S3.E2.m1.1.5.5.3.2">θ</mi><mo id="S3.E2.m1.1.5.5.3.3">∗</mo></msup></msub><mrow id="S3.E2.m1.1.5.6"><mo stretchy="false" id="S3.E2.m1.1.5.6.1">(</mo><msubsup id="S3.E2.m1.1.5.6.2"><mi id="S3.E2.m1.1.5.6.2.2.2">x</mi><mi id="S3.E2.m1.1.5.6.2.3">j</mi><mi id="S3.E2.m1.1.5.6.2.2.3">a</mi></msubsup><mmultiscripts id="S3.E2.m1.1.5.6.3"><mo stretchy="false" id="S3.E2.m1.1.5.6.3.2">)</mo><mprescripts id="S3.E2.m1.1.5.6.3a"></mprescripts><mrow id="S3.E2.m1.1.5.6.3b"></mrow><mo id="S3.E2.m1.1.5.6.3.3">′</mo></mmultiscripts></mrow><mo id="S3.E2.m1.1.5.7">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\Lambda_{j}=L_{test}(x^{a}_{j},\hat{x^{a}_{j}}=f_{\theta^{*}}(x^{a}_{j}{{}^{\prime}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p2.9" class="ltx_p">where higher values correspond to larger reconstruction errors, indicating higher probability of being abnormal.
<math id="S3.SS1.SSS1.p2.7.m1.1" class="ltx_Math" alttext="L_{test}" display="inline"><semantics id="S3.SS1.SSS1.p2.7.m1.1a"><msub id="S3.SS1.SSS1.p2.7.m1.1.1" xref="S3.SS1.SSS1.p2.7.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.7.m1.1.1.2" xref="S3.SS1.SSS1.p2.7.m1.1.1.2.cmml">L</mi><mrow id="S3.SS1.SSS1.p2.7.m1.1.1.3" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.7.m1.1.1.3.2" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.7.m1.1.1.3.1" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.7.m1.1.1.3.3" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.7.m1.1.1.3.1a" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.7.m1.1.1.3.4" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.7.m1.1.1.3.1b" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.7.m1.1.1.3.5" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.7.m1.1b"><apply id="S3.SS1.SSS1.p2.7.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.7.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.7.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.2">𝐿</ci><apply id="S3.SS1.SSS1.p2.7.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3"><times id="S3.SS1.SSS1.p2.7.m1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.1"></times><ci id="S3.SS1.SSS1.p2.7.m1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p2.7.m1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.3">𝑒</ci><ci id="S3.SS1.SSS1.p2.7.m1.1.1.3.4.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.4">𝑠</ci><ci id="S3.SS1.SSS1.p2.7.m1.1.1.3.5.cmml" xref="S3.SS1.SSS1.p2.7.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.7.m1.1c">L_{test}</annotation></semantics></math> serves the same purpose of assessing the reconstructed image as <math id="S3.SS1.SSS1.p2.8.m2.1" class="ltx_Math" alttext="L_{train}" display="inline"><semantics id="S3.SS1.SSS1.p2.8.m2.1a"><msub id="S3.SS1.SSS1.p2.8.m2.1.1" xref="S3.SS1.SSS1.p2.8.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p2.8.m2.1.1.2" xref="S3.SS1.SSS1.p2.8.m2.1.1.2.cmml">L</mi><mrow id="S3.SS1.SSS1.p2.8.m2.1.1.3" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.8.m2.1.1.3.2" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.8.m2.1.1.3.1" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.8.m2.1.1.3.3" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.8.m2.1.1.3.1a" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.8.m2.1.1.3.4" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.8.m2.1.1.3.1b" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.8.m2.1.1.3.5" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.8.m2.1.1.3.1c" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.8.m2.1.1.3.6" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.8.m2.1b"><apply id="S3.SS1.SSS1.p2.8.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.8.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.8.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.2">𝐿</ci><apply id="S3.SS1.SSS1.p2.8.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3"><times id="S3.SS1.SSS1.p2.8.m2.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.1"></times><ci id="S3.SS1.SSS1.p2.8.m2.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p2.8.m2.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.3">𝑟</ci><ci id="S3.SS1.SSS1.p2.8.m2.1.1.3.4.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.4">𝑎</ci><ci id="S3.SS1.SSS1.p2.8.m2.1.1.3.5.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.5">𝑖</ci><ci id="S3.SS1.SSS1.p2.8.m2.1.1.3.6.cmml" xref="S3.SS1.SSS1.p2.8.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.8.m2.1c">L_{train}</annotation></semantics></math>, though it may use a different function. A threshold is then applied to <math id="S3.SS1.SSS1.p2.9.m3.1" class="ltx_Math" alttext="\Lambda_{j}" display="inline"><semantics id="S3.SS1.SSS1.p2.9.m3.1a"><msub id="S3.SS1.SSS1.p2.9.m3.1.1" xref="S3.SS1.SSS1.p2.9.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.SSS1.p2.9.m3.1.1.2" xref="S3.SS1.SSS1.p2.9.m3.1.1.2.cmml">Λ</mi><mi id="S3.SS1.SSS1.p2.9.m3.1.1.3" xref="S3.SS1.SSS1.p2.9.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.9.m3.1b"><apply id="S3.SS1.SSS1.p2.9.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p2.9.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p2.9.m3.1.1.2">Λ</ci><ci id="S3.SS1.SSS1.p2.9.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p2.9.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.9.m3.1c">\Lambda_{j}</annotation></semantics></math> for binarization post-processing to obtain the final anomaly segmentation.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS2.5.1.1" class="ltx_text">III-A</span>2 </span>pDDPM</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.3" class="ltx_p">Denoising Diffusion Probabilistic Models (DDPMs) are a class of generative models which have recently gained significant popularity. The training of DDPMs consists of a Markovian forward process (the <em id="S3.SS1.SSS2.p1.3.1" class="ltx_emph ltx_font_italic">diffusion process</em>) and a reverse sampling procedure (the <em id="S3.SS1.SSS2.p1.3.2" class="ltx_emph ltx_font_italic">reverse process</em>). In the <em id="S3.SS1.SSS2.p1.3.3" class="ltx_emph ltx_font_italic">diffusion process</em> guided by a noise schedule <math id="S3.SS1.SSS2.p1.1.m1.3" class="ltx_Math" alttext="\{\beta_{1},\beta_{2}...,\beta_{T}\}" display="inline"><semantics id="S3.SS1.SSS2.p1.1.m1.3a"><mrow id="S3.SS1.SSS2.p1.1.m1.3.3.3" xref="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.1.m1.3.3.3.4" xref="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml">{</mo><msub id="S3.SS1.SSS2.p1.1.m1.1.1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml">β</mi><mn id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS2.p1.1.m1.3.3.3.5" xref="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml">,</mo><mrow id="S3.SS1.SSS2.p1.1.m1.2.2.2.2" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.cmml"><msub id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.2" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.2.cmml">β</mi><mn id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.3" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.1" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.3" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.3.cmml">…</mi></mrow><mo id="S3.SS1.SSS2.p1.1.m1.3.3.3.6" xref="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS1.SSS2.p1.1.m1.3.3.3.3" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.2" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3.2.cmml">β</mi><mi id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.3" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3.3.cmml">T</mi></msub><mo stretchy="false" id="S3.SS1.SSS2.p1.1.m1.3.3.3.7" xref="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.3b"><set id="S3.SS1.SSS2.p1.1.m1.3.3.4.cmml" xref="S3.SS1.SSS2.p1.1.m1.3.3.3"><apply id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1.2">𝛽</ci><cn type="integer" id="S3.SS1.SSS2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2"><times id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.1"></times><apply id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.2">𝛽</ci><cn type="integer" id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.2.2.2.2.3">…</ci></apply><apply id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3.2">𝛽</ci><ci id="S3.SS1.SSS2.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.3.3.3.3.3">𝑇</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.3c">\{\beta_{1},\beta_{2}...,\beta_{T}\}</annotation></semantics></math>, the image <math id="S3.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S3.SS1.SSS2.p1.2.m2.1a"><msub id="S3.SS1.SSS2.p1.2.m2.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS2.p1.2.m2.1.1.3" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.1b"><apply id="S3.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.1c">x_{0}</annotation></semantics></math> is degraded to the noisy image <math id="S3.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS1.SSS2.p1.3.m3.1a"><msub id="S3.SS1.SSS2.p1.3.m3.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p1.3.m3.1.1.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.1b"><apply id="S3.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.1c">x_{t}</annotation></semantics></math> by</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle q(x_{t}|x_{0}):=\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}x_{0},(1-\bar{\alpha}_{t})I),\," display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><mrow id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo rspace="0.278em" stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E3X.2.1.1.m1.1.1.1.1.5" xref="S3.E3X.2.1.1.m1.1.1.1.1.5.cmml">:=</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.4" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.1.1.1.1.4.5" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.5.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1.1.4.4" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.4.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.4" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml">(</mo><msub id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.2.cmml">x</mi><mi id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.5" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml">;</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.cmml"><msqrt id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml"><msub id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.cmml"><mover accent="true" id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.2.cmml">α</mi><mo id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.3.cmml">t</mi></msub></msqrt><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml">​</mo><msub id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml">x</mi><mn id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.6" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml">,</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.cmml"><mn id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.2.cmml">1</mn><mo id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.1.cmml">−</mo><msub id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.cmml"><mover accent="true" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.2.cmml">α</mi><mo id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.2.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.3.cmml">I</mi></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.7" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3X.2.1.1.m1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1"><csymbol cd="latexml" id="S3.E3X.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.5">assign</csymbol><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1"><times id="S3.E3X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.3">𝑞</ci><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn type="integer" id="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S3.E3X.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4"><times id="S3.E3X.2.1.1.m1.1.1.1.1.4.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.4"></times><ci id="S3.E3X.2.1.1.m1.1.1.1.1.4.5.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.5">𝒩</ci><list id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3"><apply id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.2">𝑥</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2"><times id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.1"></times><apply id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2"><root id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2a.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2"></root><apply id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2"><ci id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.1">¯</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.2.2">𝛼</ci></apply><ci id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2">𝑥</ci><cn type="integer" id="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3">0</cn></apply></apply><apply id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3"><times id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.2"></times><apply id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1"><minus id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.1"></minus><cn type="integer" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.2">1</cn><apply id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2"><ci id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.1">¯</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.2.2">𝛼</ci></apply><ci id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.4.3.3.3.3">𝐼</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle q(x_{t}|x_{0}):=\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}x_{0},(1-\bar{\alpha}_{t})I),\,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle x_{t}=\sqrt{\bar{\alpha}}x_{0}+\epsilon\sqrt{1-\bar{\alpha}_{t}},\epsilon\sim\mathcal{N}(0,I)" display="inline"><semantics id="S3.E3Xa.2.1.1.m1.4a"><mrow id="S3.E3Xa.2.1.1.m1.4.4.2" xref="S3.E3Xa.2.1.1.m1.4.4.3.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml"><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.cmml">x</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3.cmml">t</mi></msub><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.cmml"><msqrt id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.cmml"><mover accent="true" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.2.cmml">α</mi><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.1.cmml">¯</mo></mover></msqrt><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.1.cmml">​</mo><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.2.cmml">x</mi><mn id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml">ϵ</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml">​</mo><msqrt id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.cmml"><mn id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml">1</mn><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.1.cmml">−</mo><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml"><mover accent="true" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.2.cmml">α</mi><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.3.cmml">t</mi></msub></mrow></msqrt></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.4.4.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.3a.cmml">,</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.cmml">ϵ</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.cmml">∼</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.1.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.1.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.1.cmml">(</mo><mn id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">0</mn><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.1.cmml">,</mo><mi id="S3.E3Xa.2.1.1.m1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.cmml">I</mi><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.4b"><apply id="S3.E3Xa.2.1.1.m1.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.3a.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1"><eq id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1"></eq><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.2">𝑥</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3"><plus id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.1"></plus><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.1"></times><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2"><root id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2a.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2"></root><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2"><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.1">¯</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.2.2.2">𝛼</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.2">𝑥</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.2">italic-ϵ</ci><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3"><root id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3a.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3"></root><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2"><minus id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.1"></minus><cn type="integer" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2">1</cn><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3">subscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2"><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.1">¯</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.2.2">𝛼</ci></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2"><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1">similar-to</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2">italic-ϵ</ci><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.2">𝒩</ci><interval closure="open" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.3.2"><cn type="integer" id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">0</cn><ci id="S3.E3Xa.2.1.1.m1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2">𝐼</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.4c">\displaystyle x_{t}=\sqrt{\bar{\alpha}}x_{0}+\epsilon\sqrt{1-\bar{\alpha}_{t}},\epsilon\sim\mathcal{N}(0,I)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.SSS2.p1.5" class="ltx_p">where <math id="S3.SS1.SSS2.p1.4.m1.1" class="ltx_Math" alttext="\alpha_{t}:=1-\beta_{t}" display="inline"><semantics id="S3.SS1.SSS2.p1.4.m1.1a"><mrow id="S3.SS1.SSS2.p1.4.m1.1.1" xref="S3.SS1.SSS2.p1.4.m1.1.1.cmml"><msub id="S3.SS1.SSS2.p1.4.m1.1.1.2" xref="S3.SS1.SSS2.p1.4.m1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p1.4.m1.1.1.2.2" xref="S3.SS1.SSS2.p1.4.m1.1.1.2.2.cmml">α</mi><mi id="S3.SS1.SSS2.p1.4.m1.1.1.2.3" xref="S3.SS1.SSS2.p1.4.m1.1.1.2.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.SSS2.p1.4.m1.1.1.1" xref="S3.SS1.SSS2.p1.4.m1.1.1.1.cmml">:=</mo><mrow id="S3.SS1.SSS2.p1.4.m1.1.1.3" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.cmml"><mn id="S3.SS1.SSS2.p1.4.m1.1.1.3.2" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.2.cmml">1</mn><mo id="S3.SS1.SSS2.p1.4.m1.1.1.3.1" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.1.cmml">−</mo><msub id="S3.SS1.SSS2.p1.4.m1.1.1.3.3" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.2" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3.2.cmml">β</mi><mi id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.3" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m1.1b"><apply id="S3.SS1.SSS2.p1.4.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS2.p1.4.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.1">assign</csymbol><apply id="S3.SS1.SSS2.p1.4.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.4.m1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.4.m1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.2.2">𝛼</ci><ci id="S3.SS1.SSS2.p1.4.m1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.SSS2.p1.4.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3"><minus id="S3.SS1.SSS2.p1.4.m1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.1"></minus><cn type="integer" id="S3.SS1.SSS2.p1.4.m1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.2">1</cn><apply id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3.2">𝛽</ci><ci id="S3.SS1.SSS2.p1.4.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p1.4.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m1.1c">\alpha_{t}:=1-\beta_{t}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p1.5.m2.1" class="ltx_Math" alttext="\bar{\alpha}_{t}:=\prod_{s=1}^{s}\alpha_{s}" display="inline"><semantics id="S3.SS1.SSS2.p1.5.m2.1a"><mrow id="S3.SS1.SSS2.p1.5.m2.1.1" xref="S3.SS1.SSS2.p1.5.m2.1.1.cmml"><msub id="S3.SS1.SSS2.p1.5.m2.1.1.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.cmml"><mover accent="true" id="S3.SS1.SSS2.p1.5.m2.1.1.2.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2.cmml"><mi id="S3.SS1.SSS2.p1.5.m2.1.1.2.2.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2.2.cmml">α</mi><mo id="S3.SS1.SSS2.p1.5.m2.1.1.2.2.1" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2.1.cmml">¯</mo></mover><mi id="S3.SS1.SSS2.p1.5.m2.1.1.2.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.111em" id="S3.SS1.SSS2.p1.5.m2.1.1.1" xref="S3.SS1.SSS2.p1.5.m2.1.1.1.cmml">:=</mo><mrow id="S3.SS1.SSS2.p1.5.m2.1.1.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.cmml"><msubsup id="S3.SS1.SSS2.p1.5.m2.1.1.3.1" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.cmml"><mo id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.2.cmml">∏</mo><mrow id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.cmml"><mi id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.2.cmml">s</mi><mo id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.1" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.3.cmml">s</mi></msubsup><msub id="S3.SS1.SSS2.p1.5.m2.1.1.3.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2.cmml"><mi id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.2" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2.2.cmml">α</mi><mi id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.3" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.5.m2.1b"><apply id="S3.SS1.SSS2.p1.5.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1"><csymbol cd="latexml" id="S3.SS1.SSS2.p1.5.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.1">assign</csymbol><apply id="S3.SS1.SSS2.p1.5.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.5.m2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS2.p1.5.m2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2"><ci id="S3.SS1.SSS2.p1.5.m2.1.1.2.2.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2.1">¯</ci><ci id="S3.SS1.SSS2.p1.5.m2.1.1.2.2.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.2.2">𝛼</ci></apply><ci id="S3.SS1.SSS2.p1.5.m2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.SSS2.p1.5.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3"><apply id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1">superscript</csymbol><apply id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.2">product</csymbol><apply id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3"><eq id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS2.p1.5.m2.1.1.3.1.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.1.3">𝑠</ci></apply><apply id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.1.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.2.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2.2">𝛼</ci><ci id="S3.SS1.SSS2.p1.5.m2.1.1.3.2.3.cmml" xref="S3.SS1.SSS2.p1.5.m2.1.1.3.2.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.5.m2.1c">\bar{\alpha}_{t}:=\prod_{s=1}^{s}\alpha_{s}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.3" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> show that, in the <em id="S3.SS1.SSS2.p2.3.1" class="ltx_emph ltx_font_italic">reverse process</em>, we can model the distribution <math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="p_{\theta}(x_{t-1}|x_{t})" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mrow id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.1.m1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.2.cmml">p</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.1.m1.1.1.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p2.1.m1.1.1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><apply id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><times id="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2"></times><apply id="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.2">𝑥</ci><apply id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3"><minus id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.1"></minus><ci id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">p_{\theta}(x_{t-1}|x_{t})</annotation></semantics></math> of <math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="x_{t-1}" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><msub id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.1.1.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS2.p2.2.m2.1.1.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.1.1.3.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS1.SSS2.p2.2.m2.1.1.3.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.SSS2.p2.2.m2.1.1.3.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><apply id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2">𝑥</ci><apply id="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3"><minus id="S3.SS1.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.1"></minus><ci id="S3.SS1.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">x_{t-1}</annotation></semantics></math> given <math id="S3.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><msub id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.1.1.2" xref="S3.SS1.SSS2.p2.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.3.m3.1.1.3" xref="S3.SS1.SSS2.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><apply id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">x_{t}</annotation></semantics></math> as a diagonal Gaussian:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_{t},t))," display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.3.2.cmml">p</mi><mi id="S3.E4.m1.3.3.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.4" xref="S3.E4.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.3.4" xref="S3.E4.m1.3.3.1.1.3.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.2.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.2.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3.2.cmml">μ</mi><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.2.1.1.1.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.4" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.3.2.2.4" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml">,</mo><mrow id="S3.E4.m1.3.3.1.1.3.2.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.cmml"><msub id="S3.E4.m1.3.3.1.1.3.2.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml"><mi mathvariant="normal" id="S3.E4.m1.3.3.1.1.3.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.2.cmml">Σ</mi><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.3.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.2.2.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.2.cmml">(</mo><msub id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.4" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.2.5" xref="S3.E4.m1.3.3.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.4"></eq><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"></times><apply id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2">𝑝</ci><ci id="S3.E4.m1.3.3.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2">𝑥</ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3"><minus id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><times id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3"></times><ci id="S3.E4.m1.3.3.1.1.3.4.cmml" xref="S3.E4.m1.3.3.1.1.3.4">𝒩</ci><interval closure="open" id="S3.E4.m1.3.3.1.1.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2"><apply id="S3.E4.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1"><times id="S3.E4.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.2"></times><apply id="S3.E4.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3.2">𝜇</ci><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1"><apply id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑡</ci></interval></apply><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2"><times id="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2"></times><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.2">Σ</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1"><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_{t},t)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p2.7" class="ltx_p">where the mean <math id="S3.SS1.SSS2.p2.4.m1.2" class="ltx_Math" alttext="\mu_{\theta}(x_{t},t)" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m1.2a"><mrow id="S3.SS1.SSS2.p2.4.m1.2.2" xref="S3.SS1.SSS2.p2.4.m1.2.2.cmml"><msub id="S3.SS1.SSS2.p2.4.m1.2.2.3" xref="S3.SS1.SSS2.p2.4.m1.2.2.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m1.2.2.3.2" xref="S3.SS1.SSS2.p2.4.m1.2.2.3.2.cmml">μ</mi><mi id="S3.SS1.SSS2.p2.4.m1.2.2.3.3" xref="S3.SS1.SSS2.p2.4.m1.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.4.m1.2.2.2" xref="S3.SS1.SSS2.p2.4.m1.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p2.4.m1.2.2.1.1" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.2" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.2" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.3" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.3" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.2.cmml">,</mo><mi id="S3.SS1.SSS2.p2.4.m1.1.1" xref="S3.SS1.SSS2.p2.4.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.4" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m1.2b"><apply id="S3.SS1.SSS2.p2.4.m1.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2"><times id="S3.SS1.SSS2.p2.4.m1.2.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.2"></times><apply id="S3.SS1.SSS2.p2.4.m1.2.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m1.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m1.2.2.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.3.2">𝜇</ci><ci id="S3.SS1.SSS2.p2.4.m1.2.2.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS1.SSS2.p2.4.m1.2.2.1.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1"><apply id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m1.2c">\mu_{\theta}(x_{t},t)</annotation></semantics></math> can be calculated as a function of <math id="S3.SS1.SSS2.p2.5.m2.2" class="ltx_Math" alttext="\epsilon(x_{t},t)" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m2.2a"><mrow id="S3.SS1.SSS2.p2.5.m2.2.2" xref="S3.SS1.SSS2.p2.5.m2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.5.m2.2.2.3" xref="S3.SS1.SSS2.p2.5.m2.2.2.3.cmml">ϵ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.5.m2.2.2.2" xref="S3.SS1.SSS2.p2.5.m2.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p2.5.m2.2.2.1.1" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.2" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.2.cmml">(</mo><msub id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.2" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.3" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.3" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.2.cmml">,</mo><mi id="S3.SS1.SSS2.p2.5.m2.1.1" xref="S3.SS1.SSS2.p2.5.m2.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.4" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m2.2b"><apply id="S3.SS1.SSS2.p2.5.m2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2"><times id="S3.SS1.SSS2.p2.5.m2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.2"></times><ci id="S3.SS1.SSS2.p2.5.m2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.3">italic-ϵ</ci><interval closure="open" id="S3.SS1.SSS2.p2.5.m2.2.2.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1"><apply id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.5.m2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m2.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m2.2c">\epsilon(x_{t},t)</annotation></semantics></math>, and the covariance <math id="S3.SS1.SSS2.p2.6.m3.2" class="ltx_Math" alttext="\Sigma_{\theta}(x_{t},t)" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m3.2a"><mrow id="S3.SS1.SSS2.p2.6.m3.2.2" xref="S3.SS1.SSS2.p2.6.m3.2.2.cmml"><msub id="S3.SS1.SSS2.p2.6.m3.2.2.3" xref="S3.SS1.SSS2.p2.6.m3.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.SSS2.p2.6.m3.2.2.3.2" xref="S3.SS1.SSS2.p2.6.m3.2.2.3.2.cmml">Σ</mi><mi id="S3.SS1.SSS2.p2.6.m3.2.2.3.3" xref="S3.SS1.SSS2.p2.6.m3.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.6.m3.2.2.2" xref="S3.SS1.SSS2.p2.6.m3.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p2.6.m3.2.2.1.1" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.2" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.2" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.3" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.3" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.2.cmml">,</mo><mi id="S3.SS1.SSS2.p2.6.m3.1.1" xref="S3.SS1.SSS2.p2.6.m3.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.4" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m3.2b"><apply id="S3.SS1.SSS2.p2.6.m3.2.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2"><times id="S3.SS1.SSS2.p2.6.m3.2.2.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.2"></times><apply id="S3.SS1.SSS2.p2.6.m3.2.2.3.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m3.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m3.2.2.3.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.3.2">Σ</ci><ci id="S3.SS1.SSS2.p2.6.m3.2.2.3.3.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS1.SSS2.p2.6.m3.2.2.1.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1"><apply id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.6.m3.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.6.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m3.2c">\Sigma_{\theta}(x_{t},t)</annotation></semantics></math> can be fixed to a known constant, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
Therefore, DDPMs usually use UNet to estimate the added noise of <math id="S3.SS1.SSS2.p2.7.m4.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS1.SSS2.p2.7.m4.1a"><msub id="S3.SS1.SSS2.p2.7.m4.1.1" xref="S3.SS1.SSS2.p2.7.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p2.7.m4.1.1.2" xref="S3.SS1.SSS2.p2.7.m4.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.7.m4.1.1.3" xref="S3.SS1.SSS2.p2.7.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m4.1b"><apply id="S3.SS1.SSS2.p2.7.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.7.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.7.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p2.7.m4.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.7.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p2.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m4.1c">x_{t}</annotation></semantics></math> and optimize the network with a simple loss function:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.8" class="ltx_Math" alttext="\mathcal{L}_{\textrm{simple}}:=E_{t\sim[1,T],x_{0}\sim q(x_{0}),\epsilon\sim\mathcal{N}(0,I)}[\|\epsilon-\epsilon_{\theta}(x_{t},t)\|^{2}]" display="block"><semantics id="S3.E5.m1.8a"><mrow id="S3.E5.m1.8.8" xref="S3.E5.m1.8.8.cmml"><msub id="S3.E5.m1.8.8.3" xref="S3.E5.m1.8.8.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.8.8.3.2" xref="S3.E5.m1.8.8.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.8.8.3.3" xref="S3.E5.m1.8.8.3.3a.cmml">simple</mtext></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E5.m1.8.8.2" xref="S3.E5.m1.8.8.2.cmml">:=</mo><mrow id="S3.E5.m1.8.8.1" xref="S3.E5.m1.8.8.1.cmml"><msub id="S3.E5.m1.8.8.1.3" xref="S3.E5.m1.8.8.1.3.cmml"><mi id="S3.E5.m1.8.8.1.3.2" xref="S3.E5.m1.8.8.1.3.2.cmml">E</mi><mrow id="S3.E5.m1.6.6.6.6" xref="S3.E5.m1.6.6.6.7.cmml"><mrow id="S3.E5.m1.5.5.5.5.1" xref="S3.E5.m1.5.5.5.5.1.cmml"><mi id="S3.E5.m1.5.5.5.5.1.2" xref="S3.E5.m1.5.5.5.5.1.2.cmml">t</mi><mo id="S3.E5.m1.5.5.5.5.1.1" xref="S3.E5.m1.5.5.5.5.1.1.cmml">∼</mo><mrow id="S3.E5.m1.5.5.5.5.1.3.2" xref="S3.E5.m1.5.5.5.5.1.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.5.5.1.3.2.1" xref="S3.E5.m1.5.5.5.5.1.3.1.cmml">[</mo><mn id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">1</mn><mo id="S3.E5.m1.5.5.5.5.1.3.2.2" xref="S3.E5.m1.5.5.5.5.1.3.1.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">T</mi><mo stretchy="false" id="S3.E5.m1.5.5.5.5.1.3.2.3" xref="S3.E5.m1.5.5.5.5.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.6.6.6.6.3" xref="S3.E5.m1.6.6.6.7a.cmml">,</mo><mrow id="S3.E5.m1.6.6.6.6.2.2" xref="S3.E5.m1.6.6.6.6.2.3.cmml"><mrow id="S3.E5.m1.6.6.6.6.2.1.1" xref="S3.E5.m1.6.6.6.6.2.1.1.cmml"><msub id="S3.E5.m1.6.6.6.6.2.1.1.3" xref="S3.E5.m1.6.6.6.6.2.1.1.3.cmml"><mi id="S3.E5.m1.6.6.6.6.2.1.1.3.2" xref="S3.E5.m1.6.6.6.6.2.1.1.3.2.cmml">x</mi><mn id="S3.E5.m1.6.6.6.6.2.1.1.3.3" xref="S3.E5.m1.6.6.6.6.2.1.1.3.3.cmml">0</mn></msub><mo id="S3.E5.m1.6.6.6.6.2.1.1.2" xref="S3.E5.m1.6.6.6.6.2.1.1.2.cmml">∼</mo><mrow id="S3.E5.m1.6.6.6.6.2.1.1.1" xref="S3.E5.m1.6.6.6.6.2.1.1.1.cmml"><mi id="S3.E5.m1.6.6.6.6.2.1.1.1.3" xref="S3.E5.m1.6.6.6.6.2.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.6.6.2.1.1.1.2" xref="S3.E5.m1.6.6.6.6.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.2" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml">x</mi><mn id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.3" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.6.6.6.6.2.2.3" xref="S3.E5.m1.6.6.6.6.2.3a.cmml">,</mo><mrow id="S3.E5.m1.6.6.6.6.2.2.2" xref="S3.E5.m1.6.6.6.6.2.2.2.cmml"><mi id="S3.E5.m1.6.6.6.6.2.2.2.2" xref="S3.E5.m1.6.6.6.6.2.2.2.2.cmml">ϵ</mi><mo id="S3.E5.m1.6.6.6.6.2.2.2.1" xref="S3.E5.m1.6.6.6.6.2.2.2.1.cmml">∼</mo><mrow id="S3.E5.m1.6.6.6.6.2.2.2.3" xref="S3.E5.m1.6.6.6.6.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.6.6.6.2.2.2.3.2" xref="S3.E5.m1.6.6.6.6.2.2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.6.6.2.2.2.3.1" xref="S3.E5.m1.6.6.6.6.2.2.2.3.1.cmml">​</mo><mrow id="S3.E5.m1.6.6.6.6.2.2.2.3.3.2" xref="S3.E5.m1.6.6.6.6.2.2.2.3.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.6.6.2.2.2.3.3.2.1" xref="S3.E5.m1.6.6.6.6.2.2.2.3.3.1.cmml">(</mo><mn id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.3.cmml">0</mn><mo id="S3.E5.m1.6.6.6.6.2.2.2.3.3.2.2" xref="S3.E5.m1.6.6.6.6.2.2.2.3.3.1.cmml">,</mo><mi id="S3.E5.m1.4.4.4.4" xref="S3.E5.m1.4.4.4.4.cmml">I</mi><mo stretchy="false" id="S3.E5.m1.6.6.6.6.2.2.2.3.3.2.3" xref="S3.E5.m1.6.6.6.6.2.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.8.8.1.2" xref="S3.E5.m1.8.8.1.2.cmml">​</mo><mrow id="S3.E5.m1.8.8.1.1.1" xref="S3.E5.m1.8.8.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.2" xref="S3.E5.m1.8.8.1.1.2.1.cmml">[</mo><msup id="S3.E5.m1.8.8.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E5.m1.8.8.1.1.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m1.8.8.1.1.1.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.3.cmml">ϵ</mi><mo id="S3.E5.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.7.7" xref="S3.E5.m1.7.7.cmml">t</mi><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m1.8.8.1.1.1.1.3" xref="S3.E5.m1.8.8.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S3.E5.m1.8.8.1.1.1.3" xref="S3.E5.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.8b"><apply id="S3.E5.m1.8.8.cmml" xref="S3.E5.m1.8.8"><csymbol cd="latexml" id="S3.E5.m1.8.8.2.cmml" xref="S3.E5.m1.8.8.2">assign</csymbol><apply id="S3.E5.m1.8.8.3.cmml" xref="S3.E5.m1.8.8.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.3.1.cmml" xref="S3.E5.m1.8.8.3">subscript</csymbol><ci id="S3.E5.m1.8.8.3.2.cmml" xref="S3.E5.m1.8.8.3.2">ℒ</ci><ci id="S3.E5.m1.8.8.3.3a.cmml" xref="S3.E5.m1.8.8.3.3"><mtext mathsize="70%" id="S3.E5.m1.8.8.3.3.cmml" xref="S3.E5.m1.8.8.3.3">simple</mtext></ci></apply><apply id="S3.E5.m1.8.8.1.cmml" xref="S3.E5.m1.8.8.1"><times id="S3.E5.m1.8.8.1.2.cmml" xref="S3.E5.m1.8.8.1.2"></times><apply id="S3.E5.m1.8.8.1.3.cmml" xref="S3.E5.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.3.1.cmml" xref="S3.E5.m1.8.8.1.3">subscript</csymbol><ci id="S3.E5.m1.8.8.1.3.2.cmml" xref="S3.E5.m1.8.8.1.3.2">𝐸</ci><apply id="S3.E5.m1.6.6.6.7.cmml" xref="S3.E5.m1.6.6.6.6"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.7a.cmml" xref="S3.E5.m1.6.6.6.6.3">formulae-sequence</csymbol><apply id="S3.E5.m1.5.5.5.5.1.cmml" xref="S3.E5.m1.5.5.5.5.1"><csymbol cd="latexml" id="S3.E5.m1.5.5.5.5.1.1.cmml" xref="S3.E5.m1.5.5.5.5.1.1">similar-to</csymbol><ci id="S3.E5.m1.5.5.5.5.1.2.cmml" xref="S3.E5.m1.5.5.5.5.1.2">𝑡</ci><interval closure="closed" id="S3.E5.m1.5.5.5.5.1.3.1.cmml" xref="S3.E5.m1.5.5.5.5.1.3.2"><cn type="integer" id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">1</cn><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑇</ci></interval></apply><apply id="S3.E5.m1.6.6.6.6.2.3.cmml" xref="S3.E5.m1.6.6.6.6.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.6.2.3a.cmml" xref="S3.E5.m1.6.6.6.6.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.6.6.6.6.2.1.1.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.6.6.2.1.1.2.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.2">similar-to</csymbol><apply id="S3.E5.m1.6.6.6.6.2.1.1.3.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.6.2.1.1.3.1.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.6.6.2.1.1.3.2.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.3.2">𝑥</ci><cn type="integer" id="S3.E5.m1.6.6.6.6.2.1.1.3.3.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.3.3">0</cn></apply><apply id="S3.E5.m1.6.6.6.6.2.1.1.1.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1"><times id="S3.E5.m1.6.6.6.6.2.1.1.1.2.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.2"></times><ci id="S3.E5.m1.6.6.6.6.2.1.1.1.3.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.3">𝑞</ci><apply id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.6.6.2.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S3.E5.m1.6.6.6.6.2.2.2.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.6.6.6.6.2.2.2.1.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.1">similar-to</csymbol><ci id="S3.E5.m1.6.6.6.6.2.2.2.2.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.2">italic-ϵ</ci><apply id="S3.E5.m1.6.6.6.6.2.2.2.3.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.3"><times id="S3.E5.m1.6.6.6.6.2.2.2.3.1.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.3.1"></times><ci id="S3.E5.m1.6.6.6.6.2.2.2.3.2.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.3.2">𝒩</ci><interval closure="open" id="S3.E5.m1.6.6.6.6.2.2.2.3.3.1.cmml" xref="S3.E5.m1.6.6.6.6.2.2.2.3.3.2"><cn type="integer" id="S3.E5.m1.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3">0</cn><ci id="S3.E5.m1.4.4.4.4.cmml" xref="S3.E5.m1.4.4.4.4">𝐼</ci></interval></apply></apply></apply></apply></apply><apply id="S3.E5.m1.8.8.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.8.8.1.1.2.1.cmml" xref="S3.E5.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.8.8.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1"><minus id="S3.E5.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.2"></minus><ci id="S3.E5.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.3">italic-ϵ</ci><apply id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E5.m1.7.7.cmml" xref="S3.E5.m1.7.7">𝑡</ci></interval></apply></apply></apply><cn type="integer" id="S3.E5.m1.8.8.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.8c">\mathcal{L}_{\textrm{simple}}:=E_{t\sim[1,T],x_{0}\sim q(x_{0}),\epsilon\sim\mathcal{N}(0,I)}[\|\epsilon-\epsilon_{\theta}(x_{t},t)\|^{2}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p2.14" class="ltx_p">In the context of reconstruction-based anomaly detection, our objective is not to create new images from pure noise but to reconstruct the normal image given a noisy input image. Therefore, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we train a denoising model <math id="S3.SS1.SSS2.p2.8.m1.2" class="ltx_Math" alttext="f_{\theta}(x_{t},t)" display="inline"><semantics id="S3.SS1.SSS2.p2.8.m1.2a"><mrow id="S3.SS1.SSS2.p2.8.m1.2.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.cmml"><msub id="S3.SS1.SSS2.p2.8.m1.2.2.3" xref="S3.SS1.SSS2.p2.8.m1.2.2.3.cmml"><mi id="S3.SS1.SSS2.p2.8.m1.2.2.3.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.3.2.cmml">f</mi><mi id="S3.SS1.SSS2.p2.8.m1.2.2.3.3" xref="S3.SS1.SSS2.p2.8.m1.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.8.m1.2.2.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p2.8.m1.2.2.1.1" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.2" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.3" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.3" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.2.cmml">,</mo><mi id="S3.SS1.SSS2.p2.8.m1.1.1" xref="S3.SS1.SSS2.p2.8.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.4" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.8.m1.2b"><apply id="S3.SS1.SSS2.p2.8.m1.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2"><times id="S3.SS1.SSS2.p2.8.m1.2.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.2"></times><apply id="S3.SS1.SSS2.p2.8.m1.2.2.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m1.2.2.3.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.3.2">𝑓</ci><ci id="S3.SS1.SSS2.p2.8.m1.2.2.3.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS1.SSS2.p2.8.m1.2.2.1.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1"><apply id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.8.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.8.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m1.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.8.m1.2c">f_{\theta}(x_{t},t)</annotation></semantics></math> to directly estimate <math id="S3.SS1.SSS2.p2.9.m2.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S3.SS1.SSS2.p2.9.m2.1a"><msub id="S3.SS1.SSS2.p2.9.m2.1.1" xref="S3.SS1.SSS2.p2.9.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.9.m2.1.1.2" xref="S3.SS1.SSS2.p2.9.m2.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS2.p2.9.m2.1.1.3" xref="S3.SS1.SSS2.p2.9.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.9.m2.1b"><apply id="S3.SS1.SSS2.p2.9.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.9.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.9.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.9.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.9.m2.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS2.p2.9.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.9.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.9.m2.1c">x_{0}</annotation></semantics></math> instead of <math id="S3.SS1.SSS2.p2.10.m3.1" class="ltx_Math" alttext="\epsilon_{t}" display="inline"><semantics id="S3.SS1.SSS2.p2.10.m3.1a"><msub id="S3.SS1.SSS2.p2.10.m3.1.1" xref="S3.SS1.SSS2.p2.10.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p2.10.m3.1.1.2" xref="S3.SS1.SSS2.p2.10.m3.1.1.2.cmml">ϵ</mi><mi id="S3.SS1.SSS2.p2.10.m3.1.1.3" xref="S3.SS1.SSS2.p2.10.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.10.m3.1b"><apply id="S3.SS1.SSS2.p2.10.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.10.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.10.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p2.10.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.10.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p2.10.m3.1.1.2">italic-ϵ</ci><ci id="S3.SS1.SSS2.p2.10.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p2.10.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.10.m3.1c">\epsilon_{t}</annotation></semantics></math>.
Another modification is that we estimate <math id="S3.SS1.SSS2.p2.11.m4.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S3.SS1.SSS2.p2.11.m4.1a"><msub id="S3.SS1.SSS2.p2.11.m4.1.1" xref="S3.SS1.SSS2.p2.11.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p2.11.m4.1.1.2" xref="S3.SS1.SSS2.p2.11.m4.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS2.p2.11.m4.1.1.3" xref="S3.SS1.SSS2.p2.11.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.11.m4.1b"><apply id="S3.SS1.SSS2.p2.11.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.11.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.11.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.11.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.11.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p2.11.m4.1.1.2">𝑥</ci><cn type="integer" id="S3.SS1.SSS2.p2.11.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p2.11.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.11.m4.1c">x_{0}</annotation></semantics></math> from <math id="S3.SS1.SSS2.p2.12.m5.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS1.SSS2.p2.12.m5.1a"><msub id="S3.SS1.SSS2.p2.12.m5.1.1" xref="S3.SS1.SSS2.p2.12.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p2.12.m5.1.1.2" xref="S3.SS1.SSS2.p2.12.m5.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS2.p2.12.m5.1.1.3" xref="S3.SS1.SSS2.p2.12.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.12.m5.1b"><apply id="S3.SS1.SSS2.p2.12.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.12.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p2.12.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.12.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p2.12.m5.1.1.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.12.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p2.12.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.12.m5.1c">x_{t}</annotation></semantics></math> at a fixed time step <math id="S3.SS1.SSS2.p2.13.m6.1" class="ltx_Math" alttext="t_{test}" display="inline"><semantics id="S3.SS1.SSS2.p2.13.m6.1a"><msub id="S3.SS1.SSS2.p2.13.m6.1.1" xref="S3.SS1.SSS2.p2.13.m6.1.1.cmml"><mi id="S3.SS1.SSS2.p2.13.m6.1.1.2" xref="S3.SS1.SSS2.p2.13.m6.1.1.2.cmml">t</mi><mrow id="S3.SS1.SSS2.p2.13.m6.1.1.3" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.13.m6.1.1.3.2" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.13.m6.1.1.3.1" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS2.p2.13.m6.1.1.3.3" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.13.m6.1.1.3.1a" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS2.p2.13.m6.1.1.3.4" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.13.m6.1.1.3.1b" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS2.p2.13.m6.1.1.3.5" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.13.m6.1b"><apply id="S3.SS1.SSS2.p2.13.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.13.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.13.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.2">𝑡</ci><apply id="S3.SS1.SSS2.p2.13.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3"><times id="S3.SS1.SSS2.p2.13.m6.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.1"></times><ci id="S3.SS1.SSS2.p2.13.m6.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS2.p2.13.m6.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.3">𝑒</ci><ci id="S3.SS1.SSS2.p2.13.m6.1.1.3.4.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.4">𝑠</ci><ci id="S3.SS1.SSS2.p2.13.m6.1.1.3.5.cmml" xref="S3.SS1.SSS2.p2.13.m6.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.13.m6.1c">t_{test}</annotation></semantics></math> when sampling, rather than <math id="S3.SS1.SSS2.p2.14.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.SSS2.p2.14.m7.1a"><mi id="S3.SS1.SSS2.p2.14.m7.1.1" xref="S3.SS1.SSS2.p2.14.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.14.m7.1b"><ci id="S3.SS1.SSS2.p2.14.m7.1.1.cmml" xref="S3.SS1.SSS2.p2.14.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.14.m7.1c">T</annotation></semantics></math> steps in traditional DDPM. This simplification significantly decreases the sampling time but not affects the anomaly detection performance.
With these two modifications, DDPM can be considered as a Denoising AutoEncoder (DAE) with multi-levels’ noises, and can serve as a reconstruction-based anomaly detection method.</p>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para">
<p id="S3.SS1.SSS2.p3.1" class="ltx_p">pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposes to conduct the <em id="S3.SS1.SSS2.p3.1.1" class="ltx_emph ltx_font_italic">diffusion</em> and <em id="S3.SS1.SSS2.p3.1.2" class="ltx_emph ltx_font_italic">reverse</em> processes only on a patch and use the other region as condition. This technique offers better brain MRI reconstruction by encouraging global context information incorporation. During evaluation, pDDPM reconstructs from noisy patches sampled over the whole image and merge all patches to one final reconstruction.
We choose pDDPM to serve as a strong baseline.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Fusion Quality Loss</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">Most existing reconstruction-based anomaly detection methods in Brain MRI, including pDDPM, use <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\ell_{1}</annotation></semantics></math> loss to calculate the reconstruction error during training and testing.
However, <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\ell_{1}</annotation></semantics></math> loss has two main issues in anomaly detection problems:
it assumes pixel independence, ignoring spatial relationships, which may prevent the model from learning the intrinsic structure of healthy brains.
Additionally, it focuses on intensity discrepancies, which may not capture subtle anomalies with only minor intensity differences from normal parts.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">To address these limitations, we propose to assess the reconstruction image quality from a more comprehensive perspective by incorporating the Structural Similarity Index Measure (SSIM).</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.5" class="ltx_p">SSIM is originally constructed as an image quality measure with respect to the human perception rather than absolute differences measured by metrics such as the MSE or Mean Absolute Error (MAE). It measures the similarity between two images <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">x</annotation></semantics></math> and <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">y</annotation></semantics></math> from three aspects: luminance <math id="S3.SS2.p3.3.m3.2" class="ltx_Math" alttext="l(x,y)" display="inline"><semantics id="S3.SS2.p3.3.m3.2a"><mrow id="S3.SS2.p3.3.m3.2.3" xref="S3.SS2.p3.3.m3.2.3.cmml"><mi id="S3.SS2.p3.3.m3.2.3.2" xref="S3.SS2.p3.3.m3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.2.3.1" xref="S3.SS2.p3.3.m3.2.3.1.cmml">​</mo><mrow id="S3.SS2.p3.3.m3.2.3.3.2" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.2.3.3.2.1" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">x</mi><mo id="S3.SS2.p3.3.m3.2.3.3.2.2" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS2.p3.3.m3.2.3.3.2.3" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b"><apply id="S3.SS2.p3.3.m3.2.3.cmml" xref="S3.SS2.p3.3.m3.2.3"><times id="S3.SS2.p3.3.m3.2.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3.1"></times><ci id="S3.SS2.p3.3.m3.2.3.2.cmml" xref="S3.SS2.p3.3.m3.2.3.2">𝑙</ci><interval closure="open" id="S3.SS2.p3.3.m3.2.3.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3.3.2"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑥</ci><ci id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">l(x,y)</annotation></semantics></math>, contrast <math id="S3.SS2.p3.4.m4.2" class="ltx_Math" alttext="c(x,y)" display="inline"><semantics id="S3.SS2.p3.4.m4.2a"><mrow id="S3.SS2.p3.4.m4.2.3" xref="S3.SS2.p3.4.m4.2.3.cmml"><mi id="S3.SS2.p3.4.m4.2.3.2" xref="S3.SS2.p3.4.m4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.2.3.1" xref="S3.SS2.p3.4.m4.2.3.1.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.2.3.3.2" xref="S3.SS2.p3.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.2.3.3.2.1" xref="S3.SS2.p3.4.m4.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">x</mi><mo id="S3.SS2.p3.4.m4.2.3.3.2.2" xref="S3.SS2.p3.4.m4.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p3.4.m4.2.2" xref="S3.SS2.p3.4.m4.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS2.p3.4.m4.2.3.3.2.3" xref="S3.SS2.p3.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.2b"><apply id="S3.SS2.p3.4.m4.2.3.cmml" xref="S3.SS2.p3.4.m4.2.3"><times id="S3.SS2.p3.4.m4.2.3.1.cmml" xref="S3.SS2.p3.4.m4.2.3.1"></times><ci id="S3.SS2.p3.4.m4.2.3.2.cmml" xref="S3.SS2.p3.4.m4.2.3.2">𝑐</ci><interval closure="open" id="S3.SS2.p3.4.m4.2.3.3.1.cmml" xref="S3.SS2.p3.4.m4.2.3.3.2"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝑥</ci><ci id="S3.SS2.p3.4.m4.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.2c">c(x,y)</annotation></semantics></math> and structure <math id="S3.SS2.p3.5.m5.2" class="ltx_Math" alttext="s(x,y)" display="inline"><semantics id="S3.SS2.p3.5.m5.2a"><mrow id="S3.SS2.p3.5.m5.2.3" xref="S3.SS2.p3.5.m5.2.3.cmml"><mi id="S3.SS2.p3.5.m5.2.3.2" xref="S3.SS2.p3.5.m5.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.2.3.1" xref="S3.SS2.p3.5.m5.2.3.1.cmml">​</mo><mrow id="S3.SS2.p3.5.m5.2.3.3.2" xref="S3.SS2.p3.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.2.3.3.2.1" xref="S3.SS2.p3.5.m5.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">x</mi><mo id="S3.SS2.p3.5.m5.2.3.3.2.2" xref="S3.SS2.p3.5.m5.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p3.5.m5.2.2" xref="S3.SS2.p3.5.m5.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS2.p3.5.m5.2.3.3.2.3" xref="S3.SS2.p3.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.2b"><apply id="S3.SS2.p3.5.m5.2.3.cmml" xref="S3.SS2.p3.5.m5.2.3"><times id="S3.SS2.p3.5.m5.2.3.1.cmml" xref="S3.SS2.p3.5.m5.2.3.1"></times><ci id="S3.SS2.p3.5.m5.2.3.2.cmml" xref="S3.SS2.p3.5.m5.2.3.2">𝑠</ci><interval closure="open" id="S3.SS2.p3.5.m5.2.3.3.1.cmml" xref="S3.SS2.p3.5.m5.2.3.3.2"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑥</ci><ci id="S3.SS2.p3.5.m5.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.2c">s(x,y)</annotation></semantics></math>. The functions are defined as follows:</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle l(x,y)=\frac{2\mu_{x}\mu_{y}+C_{1}}{\mu_{x}^{2}+\mu_{y}^{2}+C_{1}},\," display="inline"><semantics id="S3.E6X.2.1.1.m1.3a"><mrow id="S3.E6X.2.1.1.m1.3.3.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.1.2.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.2.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.2.3.2.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.3.1.cmml">(</mo><mi id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.E6X.2.1.1.m1.3.3.1.1.2.3.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.3.1.cmml">,</mo><mi id="S3.E6X.2.1.1.m1.2.2" xref="S3.E6X.2.1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6X.2.1.1.m1.3.3.1.1.2.3.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6X.2.1.1.m1.3.3.1.1.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E6X.2.1.1.m1.3.3.1.1.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.cmml"><mfrac id="S3.E6X.2.1.1.m1.3.3.1.1.3a" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.cmml"><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.cmml"><mn id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1.cmml">​</mo><msub id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.2.cmml">μ</mi><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1a" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1.cmml">​</mo><msub id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.2.cmml">μ</mi><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.3.cmml">y</mi></msub></mrow><mo id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.1.cmml">+</mo><msub id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.2.cmml">C</mi><mn id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.3.cmml">1</mn></msub></mrow><mrow id="S3.E6X.2.1.1.m1.3.3.1.1.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.cmml"><msubsup id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.2.cmml">μ</mi><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.3.cmml">x</mi><mn id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.3.cmml">2</mn></msubsup><mo id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1.cmml">+</mo><msubsup id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml">μ</mi><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml">y</mi><mn id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.3.cmml">2</mn></msubsup><mo id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1a" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1.cmml">+</mo><msub id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.cmml"><mi id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.2.cmml">C</mi><mn id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.3" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.3.cmml">1</mn></msub></mrow></mfrac></mstyle></mrow><mo id="S3.E6X.2.1.1.m1.3.3.1.2" xref="S3.E6X.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.3b"><apply id="S3.E6X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1"><eq id="S3.E6X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.1"></eq><apply id="S3.E6X.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.2"><times id="S3.E6X.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.1"></times><ci id="S3.E6X.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.2">𝑙</ci><interval closure="open" id="S3.E6X.2.1.1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.2.3.2"><ci id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">𝑥</ci><ci id="S3.E6X.2.1.1.m1.2.2.cmml" xref="S3.E6X.2.1.1.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3"><divide id="S3.E6X.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3"></divide><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2"><plus id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.1"></plus><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2"><times id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.1"></times><cn type="integer" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.2">2</cn><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.2">𝜇</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.3.3">𝑥</ci></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.2">𝜇</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.2.4.3">𝑦</ci></apply></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.2">𝐶</ci><cn type="integer" id="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3"><plus id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.1"></plus><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.2">𝜇</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.2.3">𝑥</ci></apply><cn type="integer" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.2.3">2</cn></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3">superscript</csymbol><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.2">𝜇</ci><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.2.3">𝑦</ci></apply><cn type="integer" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.3.3">2</cn></apply><apply id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.1.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.2.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.2">𝐶</ci><cn type="integer" id="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.3.cmml" xref="S3.E6X.2.1.1.m1.3.3.1.1.3.3.4.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.3c">\displaystyle l(x,y)=\frac{2\mu_{x}\mu_{y}+C_{1}}{\mu_{x}^{2}+\mu_{y}^{2}+C_{1}},\,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S3.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle c(x,y)=\frac{2\sigma_{x}\sigma_{y}+C_{2}}{\sigma_{x}^{2}+\sigma_{y}^{2}+C_{2}},\," display="inline"><semantics id="S3.E6Xa.2.1.1.m1.3a"><mrow id="S3.E6Xa.2.1.1.m1.3.3.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.2.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml">(</mo><mi id="S3.E6Xa.2.1.1.m1.1.1" xref="S3.E6Xa.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml">,</mo><mi id="S3.E6Xa.2.1.1.m1.2.2" xref="S3.E6Xa.2.1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.cmml"><mfrac id="S3.E6Xa.2.1.1.m1.3.3.1.1.3a" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.cmml"><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.cmml"><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.cmml"><mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1.cmml">​</mo><msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.2.cmml">σ</mi><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1a" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1.cmml">​</mo><msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.2.cmml">σ</mi><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.3.cmml">y</mi></msub></mrow><mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.1.cmml">+</mo><msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.2.cmml">C</mi><mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.3.cmml">2</mn></msub></mrow><mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.cmml"><msubsup id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.2.cmml">σ</mi><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.3.cmml">x</mi><mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.3.cmml">2</mn></msubsup><mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml">+</mo><msubsup id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml">σ</mi><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml">y</mi><mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.3.cmml">2</mn></msubsup><mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1a" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml">+</mo><msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.cmml"><mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.2.cmml">C</mi><mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.3.cmml">2</mn></msub></mrow></mfrac></mstyle></mrow><mo id="S3.E6Xa.2.1.1.m1.3.3.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xa.2.1.1.m1.3b"><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1"><eq id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1"></eq><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2"><times id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.1"></times><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2">𝑐</ci><interval closure="open" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.2"><ci id="S3.E6Xa.2.1.1.m1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1">𝑥</ci><ci id="S3.E6Xa.2.1.1.m1.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3"><divide id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3"></divide><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2"><plus id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.1"></plus><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2"><times id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.1"></times><cn type="integer" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.2">2</cn><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.2">𝜎</ci><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.3.3">𝑥</ci></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.2">𝜎</ci><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.2.4.3">𝑦</ci></apply></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.2">𝐶</ci><cn type="integer" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.2.3.3">2</cn></apply></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3"><plus id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.1"></plus><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.2">𝜎</ci><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.2.3">𝑥</ci></apply><cn type="integer" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.2.3">2</cn></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3">superscript</csymbol><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.2">𝜎</ci><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.2.3">𝑦</ci></apply><cn type="integer" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.3.3">2</cn></apply><apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.2">𝐶</ci><cn type="integer" id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.3.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.3c">\displaystyle c(x,y)=\frac{2\sigma_{x}\sigma_{y}+C_{2}}{\sigma_{x}^{2}+\sigma_{y}^{2}+C_{2}},\,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E6Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6Xb.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle s(x,y)=\frac{\sigma_{xy}+C_{3}}{\sigma_{x}\sigma_{y}+C_{3}}" display="inline"><semantics id="S3.E6Xb.2.1.1.m1.2a"><mrow id="S3.E6Xb.2.1.1.m1.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.cmml"><mrow id="S3.E6Xb.2.1.1.m1.2.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.2.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6Xb.2.1.1.m1.2.3.2.1" xref="S3.E6Xb.2.1.1.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E6Xb.2.1.1.m1.2.3.2.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.E6Xb.2.1.1.m1.2.3.2.3.2.1" xref="S3.E6Xb.2.1.1.m1.2.3.2.3.1.cmml">(</mo><mi id="S3.E6Xb.2.1.1.m1.1.1" xref="S3.E6Xb.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.E6Xb.2.1.1.m1.2.3.2.3.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.2.3.1.cmml">,</mo><mi id="S3.E6Xb.2.1.1.m1.2.2" xref="S3.E6Xb.2.1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6Xb.2.1.1.m1.2.3.2.3.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6Xb.2.1.1.m1.2.3.1" xref="S3.E6Xb.2.1.1.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E6Xb.2.1.1.m1.2.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.cmml"><mfrac id="S3.E6Xb.2.1.1.m1.2.3.3a" xref="S3.E6Xb.2.1.1.m1.2.3.3.cmml"><mrow id="S3.E6Xb.2.1.1.m1.2.3.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.cmml"><msub id="S3.E6Xb.2.1.1.m1.2.3.3.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.2.cmml">σ</mi><mrow id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.1" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.1.cmml">​</mo><mi id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.3.cmml">y</mi></mrow></msub><mo id="S3.E6Xb.2.1.1.m1.2.3.3.2.1" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.1.cmml">+</mo><msub id="S3.E6Xb.2.1.1.m1.2.3.3.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3.2.cmml">C</mi><mn id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3.3.cmml">3</mn></msub></mrow><mrow id="S3.E6Xb.2.1.1.m1.2.3.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.cmml"><mrow id="S3.E6Xb.2.1.1.m1.2.3.3.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.cmml"><msub id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.2.cmml">σ</mi><mi id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.1" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.1.cmml">​</mo><msub id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.2.cmml">σ</mi><mi id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.3.cmml">y</mi></msub></mrow><mo id="S3.E6Xb.2.1.1.m1.2.3.3.3.1" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.1.cmml">+</mo><msub id="S3.E6Xb.2.1.1.m1.2.3.3.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3.cmml"><mi id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.2" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3.2.cmml">C</mi><mn id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.3" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3.3.cmml">3</mn></msub></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xb.2.1.1.m1.2b"><apply id="S3.E6Xb.2.1.1.m1.2.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3"><eq id="S3.E6Xb.2.1.1.m1.2.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.1"></eq><apply id="S3.E6Xb.2.1.1.m1.2.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.2"><times id="S3.E6Xb.2.1.1.m1.2.3.2.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.2.1"></times><ci id="S3.E6Xb.2.1.1.m1.2.3.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.2.2">𝑠</ci><interval closure="open" id="S3.E6Xb.2.1.1.m1.2.3.2.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.2.3.2"><ci id="S3.E6Xb.2.1.1.m1.1.1.cmml" xref="S3.E6Xb.2.1.1.m1.1.1">𝑥</ci><ci id="S3.E6Xb.2.1.1.m1.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E6Xb.2.1.1.m1.2.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3"><divide id="S3.E6Xb.2.1.1.m1.2.3.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3"></divide><apply id="S3.E6Xb.2.1.1.m1.2.3.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2"><plus id="S3.E6Xb.2.1.1.m1.2.3.3.2.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.1"></plus><apply id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.2">𝜎</ci><apply id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3"><times id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.1"></times><ci id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.2">𝑥</ci><ci id="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.2.3.3">𝑦</ci></apply></apply><apply id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3">subscript</csymbol><ci id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3.2">𝐶</ci><cn type="integer" id="S3.E6Xb.2.1.1.m1.2.3.3.2.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.2.3.3">3</cn></apply></apply><apply id="S3.E6Xb.2.1.1.m1.2.3.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3"><plus id="S3.E6Xb.2.1.1.m1.2.3.3.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.1"></plus><apply id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2"><times id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.1"></times><apply id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2">subscript</csymbol><ci id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.2">𝜎</ci><ci id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.2.3">𝑥</ci></apply><apply id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3">subscript</csymbol><ci id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.2">𝜎</ci><ci id="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.2.3.3">𝑦</ci></apply></apply><apply id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.1.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3">subscript</csymbol><ci id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.2.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3.2">𝐶</ci><cn type="integer" id="S3.E6Xb.2.1.1.m1.2.3.3.3.3.3.cmml" xref="S3.E6Xb.2.1.1.m1.2.3.3.3.3.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xb.2.1.1.m1.2c">\displaystyle s(x,y)=\frac{\sigma_{xy}+C_{3}}{\sigma_{x}\sigma_{y}+C_{3}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p4.13" class="ltx_p">where <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mu_{x}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">μ</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝜇</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mu_{x}</annotation></semantics></math> and <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mu_{y}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">μ</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝜇</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mu_{y}</annotation></semantics></math> are the means of the images <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">x</annotation></semantics></math> and <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">y</annotation></semantics></math>, respectively. <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\sigma_{x}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">σ</mi><mi id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝜎</ci><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\sigma_{x}</annotation></semantics></math> and <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="\sigma_{y}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">σ</mi><mi id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝜎</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\sigma_{y}</annotation></semantics></math> are the standard deviations of <math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">x</annotation></semantics></math> and <math id="S3.SS2.p4.8.m8.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p4.8.m8.1a"><mi id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><ci id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">y</annotation></semantics></math>, respectively. <math id="S3.SS2.p4.9.m9.1" class="ltx_Math" alttext="\sigma_{xy}" display="inline"><semantics id="S3.SS2.p4.9.m9.1a"><msub id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml"><mi id="S3.SS2.p4.9.m9.1.1.2" xref="S3.SS2.p4.9.m9.1.1.2.cmml">σ</mi><mrow id="S3.SS2.p4.9.m9.1.1.3" xref="S3.SS2.p4.9.m9.1.1.3.cmml"><mi id="S3.SS2.p4.9.m9.1.1.3.2" xref="S3.SS2.p4.9.m9.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.9.m9.1.1.3.1" xref="S3.SS2.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.9.m9.1.1.3.3" xref="S3.SS2.p4.9.m9.1.1.3.3.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><apply id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m9.1.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p4.9.m9.1.1.2.cmml" xref="S3.SS2.p4.9.m9.1.1.2">𝜎</ci><apply id="S3.SS2.p4.9.m9.1.1.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3"><times id="S3.SS2.p4.9.m9.1.1.3.1.cmml" xref="S3.SS2.p4.9.m9.1.1.3.1"></times><ci id="S3.SS2.p4.9.m9.1.1.3.2.cmml" xref="S3.SS2.p4.9.m9.1.1.3.2">𝑥</ci><ci id="S3.SS2.p4.9.m9.1.1.3.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">\sigma_{xy}</annotation></semantics></math> is the covariance between <math id="S3.SS2.p4.10.m10.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p4.10.m10.1a"><mi id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><ci id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">x</annotation></semantics></math> and <math id="S3.SS2.p4.11.m11.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p4.11.m11.1a"><mi id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><ci id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">y</annotation></semantics></math>. <math id="S3.SS2.p4.12.m12.1" class="ltx_Math" alttext="C_{1},C_{2}," display="inline"><semantics id="S3.SS2.p4.12.m12.1a"><mrow id="S3.SS2.p4.12.m12.1.1.1"><mrow id="S3.SS2.p4.12.m12.1.1.1.1.2" xref="S3.SS2.p4.12.m12.1.1.1.1.3.cmml"><msub id="S3.SS2.p4.12.m12.1.1.1.1.1.1" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.12.m12.1.1.1.1.1.1.2" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1.2.cmml">C</mi><mn id="S3.SS2.p4.12.m12.1.1.1.1.1.1.3" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p4.12.m12.1.1.1.1.2.3" xref="S3.SS2.p4.12.m12.1.1.1.1.3.cmml">,</mo><msub id="S3.SS2.p4.12.m12.1.1.1.1.2.2" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p4.12.m12.1.1.1.1.2.2.2" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2.2.cmml">C</mi><mn id="S3.SS2.p4.12.m12.1.1.1.1.2.2.3" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.SS2.p4.12.m12.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m12.1b"><list id="S3.SS2.p4.12.m12.1.1.1.1.3.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.2"><apply id="S3.SS2.p4.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p4.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p4.12.m12.1.1.1.1.2.2.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.12.m12.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p4.12.m12.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2.2">𝐶</ci><cn type="integer" id="S3.SS2.p4.12.m12.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p4.12.m12.1.1.1.1.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m12.1c">C_{1},C_{2},</annotation></semantics></math> and <math id="S3.SS2.p4.13.m13.1" class="ltx_Math" alttext="C_{3}" display="inline"><semantics id="S3.SS2.p4.13.m13.1a"><msub id="S3.SS2.p4.13.m13.1.1" xref="S3.SS2.p4.13.m13.1.1.cmml"><mi id="S3.SS2.p4.13.m13.1.1.2" xref="S3.SS2.p4.13.m13.1.1.2.cmml">C</mi><mn id="S3.SS2.p4.13.m13.1.1.3" xref="S3.SS2.p4.13.m13.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.13.m13.1b"><apply id="S3.SS2.p4.13.m13.1.1.cmml" xref="S3.SS2.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.13.m13.1.1.1.cmml" xref="S3.SS2.p4.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p4.13.m13.1.1.2.cmml" xref="S3.SS2.p4.13.m13.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p4.13.m13.1.1.3.cmml" xref="S3.SS2.p4.13.m13.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.13.m13.1c">C_{3}</annotation></semantics></math> are small constants to avoid division by zero and to stabilize the computation.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">SSIM is then computed as the product of these three components, capturing the perceived quality of the images:</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.11" class="ltx_Math" alttext="\text{SSIM}(x,y)=[l(x,y)]^{\alpha}[c(x,y)]^{\beta}[s(x,y)]^{\gamma}" display="block"><semantics id="S3.E7.m1.11a"><mrow id="S3.E7.m1.11.11" xref="S3.E7.m1.11.11.cmml"><mrow id="S3.E7.m1.11.11.5" xref="S3.E7.m1.11.11.5.cmml"><mtext id="S3.E7.m1.11.11.5.2" xref="S3.E7.m1.11.11.5.2a.cmml">SSIM</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.11.11.5.1" xref="S3.E7.m1.11.11.5.1.cmml">​</mo><mrow id="S3.E7.m1.11.11.5.3.2" xref="S3.E7.m1.11.11.5.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.11.11.5.3.2.1" xref="S3.E7.m1.11.11.5.3.1.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">x</mi><mo id="S3.E7.m1.11.11.5.3.2.2" xref="S3.E7.m1.11.11.5.3.1.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.11.11.5.3.2.3" xref="S3.E7.m1.11.11.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.11.11.4" xref="S3.E7.m1.11.11.4.cmml">=</mo><mrow id="S3.E7.m1.11.11.3" xref="S3.E7.m1.11.11.3.cmml"><msup id="S3.E7.m1.9.9.1.1" xref="S3.E7.m1.9.9.1.1.cmml"><mrow id="S3.E7.m1.9.9.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.1.1.1.1.2" xref="S3.E7.m1.9.9.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.9.9.1.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.1.1.cmml"><mi id="S3.E7.m1.9.9.1.1.1.1.1.2" xref="S3.E7.m1.9.9.1.1.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.1.1.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.9.9.1.1.1.1.1.3.2" xref="S3.E7.m1.9.9.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.1.1.1.1.1.3.2.1" xref="S3.E7.m1.9.9.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">x</mi><mo id="S3.E7.m1.9.9.1.1.1.1.1.3.2.2" xref="S3.E7.m1.9.9.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.9.9.1.1.1.1.1.3.2.3" xref="S3.E7.m1.9.9.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.9.9.1.1.1.1.3" xref="S3.E7.m1.9.9.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.E7.m1.9.9.1.1.3" xref="S3.E7.m1.9.9.1.1.3.cmml">α</mi></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.11.11.3.4" xref="S3.E7.m1.11.11.3.4.cmml">​</mo><msup id="S3.E7.m1.10.10.2.2" xref="S3.E7.m1.10.10.2.2.cmml"><mrow id="S3.E7.m1.10.10.2.2.1.1" xref="S3.E7.m1.10.10.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.10.10.2.2.1.1.2" xref="S3.E7.m1.10.10.2.2.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.10.10.2.2.1.1.1" xref="S3.E7.m1.10.10.2.2.1.1.1.cmml"><mi id="S3.E7.m1.10.10.2.2.1.1.1.2" xref="S3.E7.m1.10.10.2.2.1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.10.10.2.2.1.1.1.1" xref="S3.E7.m1.10.10.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.10.10.2.2.1.1.1.3.2" xref="S3.E7.m1.10.10.2.2.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.10.10.2.2.1.1.1.3.2.1" xref="S3.E7.m1.10.10.2.2.1.1.1.3.1.cmml">(</mo><mi id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml">x</mi><mo id="S3.E7.m1.10.10.2.2.1.1.1.3.2.2" xref="S3.E7.m1.10.10.2.2.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.10.10.2.2.1.1.1.3.2.3" xref="S3.E7.m1.10.10.2.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.10.10.2.2.1.1.3" xref="S3.E7.m1.10.10.2.2.1.2.1.cmml">]</mo></mrow><mi id="S3.E7.m1.10.10.2.2.3" xref="S3.E7.m1.10.10.2.2.3.cmml">β</mi></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.11.11.3.4a" xref="S3.E7.m1.11.11.3.4.cmml">​</mo><msup id="S3.E7.m1.11.11.3.3" xref="S3.E7.m1.11.11.3.3.cmml"><mrow id="S3.E7.m1.11.11.3.3.1.1" xref="S3.E7.m1.11.11.3.3.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.11.11.3.3.1.1.2" xref="S3.E7.m1.11.11.3.3.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.11.11.3.3.1.1.1" xref="S3.E7.m1.11.11.3.3.1.1.1.cmml"><mi id="S3.E7.m1.11.11.3.3.1.1.1.2" xref="S3.E7.m1.11.11.3.3.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.11.11.3.3.1.1.1.1" xref="S3.E7.m1.11.11.3.3.1.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.11.11.3.3.1.1.1.3.2" xref="S3.E7.m1.11.11.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.11.11.3.3.1.1.1.3.2.1" xref="S3.E7.m1.11.11.3.3.1.1.1.3.1.cmml">(</mo><mi id="S3.E7.m1.7.7" xref="S3.E7.m1.7.7.cmml">x</mi><mo id="S3.E7.m1.11.11.3.3.1.1.1.3.2.2" xref="S3.E7.m1.11.11.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.8.8" xref="S3.E7.m1.8.8.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.11.11.3.3.1.1.1.3.2.3" xref="S3.E7.m1.11.11.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.11.11.3.3.1.1.3" xref="S3.E7.m1.11.11.3.3.1.2.1.cmml">]</mo></mrow><mi id="S3.E7.m1.11.11.3.3.3" xref="S3.E7.m1.11.11.3.3.3.cmml">γ</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.11b"><apply id="S3.E7.m1.11.11.cmml" xref="S3.E7.m1.11.11"><eq id="S3.E7.m1.11.11.4.cmml" xref="S3.E7.m1.11.11.4"></eq><apply id="S3.E7.m1.11.11.5.cmml" xref="S3.E7.m1.11.11.5"><times id="S3.E7.m1.11.11.5.1.cmml" xref="S3.E7.m1.11.11.5.1"></times><ci id="S3.E7.m1.11.11.5.2a.cmml" xref="S3.E7.m1.11.11.5.2"><mtext id="S3.E7.m1.11.11.5.2.cmml" xref="S3.E7.m1.11.11.5.2">SSIM</mtext></ci><interval closure="open" id="S3.E7.m1.11.11.5.3.1.cmml" xref="S3.E7.m1.11.11.5.3.2"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝑥</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E7.m1.11.11.3.cmml" xref="S3.E7.m1.11.11.3"><times id="S3.E7.m1.11.11.3.4.cmml" xref="S3.E7.m1.11.11.3.4"></times><apply id="S3.E7.m1.9.9.1.1.cmml" xref="S3.E7.m1.9.9.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1">superscript</csymbol><apply id="S3.E7.m1.9.9.1.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.9.9.1.1.1.2.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.9.9.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1"><times id="S3.E7.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1"></times><ci id="S3.E7.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.2">𝑙</ci><interval closure="open" id="S3.E7.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.3.2"><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝑥</ci><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝑦</ci></interval></apply></apply><ci id="S3.E7.m1.9.9.1.1.3.cmml" xref="S3.E7.m1.9.9.1.1.3">𝛼</ci></apply><apply id="S3.E7.m1.10.10.2.2.cmml" xref="S3.E7.m1.10.10.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.10.10.2.2.2.cmml" xref="S3.E7.m1.10.10.2.2">superscript</csymbol><apply id="S3.E7.m1.10.10.2.2.1.2.cmml" xref="S3.E7.m1.10.10.2.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.10.10.2.2.1.2.1.cmml" xref="S3.E7.m1.10.10.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.10.10.2.2.1.1.1.cmml" xref="S3.E7.m1.10.10.2.2.1.1.1"><times id="S3.E7.m1.10.10.2.2.1.1.1.1.cmml" xref="S3.E7.m1.10.10.2.2.1.1.1.1"></times><ci id="S3.E7.m1.10.10.2.2.1.1.1.2.cmml" xref="S3.E7.m1.10.10.2.2.1.1.1.2">𝑐</ci><interval closure="open" id="S3.E7.m1.10.10.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.10.10.2.2.1.1.1.3.2"><ci id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5">𝑥</ci><ci id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6">𝑦</ci></interval></apply></apply><ci id="S3.E7.m1.10.10.2.2.3.cmml" xref="S3.E7.m1.10.10.2.2.3">𝛽</ci></apply><apply id="S3.E7.m1.11.11.3.3.cmml" xref="S3.E7.m1.11.11.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.3.3.2.cmml" xref="S3.E7.m1.11.11.3.3">superscript</csymbol><apply id="S3.E7.m1.11.11.3.3.1.2.cmml" xref="S3.E7.m1.11.11.3.3.1.1"><csymbol cd="latexml" id="S3.E7.m1.11.11.3.3.1.2.1.cmml" xref="S3.E7.m1.11.11.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.11.11.3.3.1.1.1.cmml" xref="S3.E7.m1.11.11.3.3.1.1.1"><times id="S3.E7.m1.11.11.3.3.1.1.1.1.cmml" xref="S3.E7.m1.11.11.3.3.1.1.1.1"></times><ci id="S3.E7.m1.11.11.3.3.1.1.1.2.cmml" xref="S3.E7.m1.11.11.3.3.1.1.1.2">𝑠</ci><interval closure="open" id="S3.E7.m1.11.11.3.3.1.1.1.3.1.cmml" xref="S3.E7.m1.11.11.3.3.1.1.1.3.2"><ci id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7">𝑥</ci><ci id="S3.E7.m1.8.8.cmml" xref="S3.E7.m1.8.8">𝑦</ci></interval></apply></apply><ci id="S3.E7.m1.11.11.3.3.3.cmml" xref="S3.E7.m1.11.11.3.3.3">𝛾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.11c">\text{SSIM}(x,y)=[l(x,y)]^{\alpha}[c(x,y)]^{\beta}[s(x,y)]^{\gamma}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.2" class="ltx_p">Typically, <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\alpha=\beta=\gamma=1" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><mrow id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">=</mo><mi id="S3.SS2.p7.1.m1.1.1.4" xref="S3.SS2.p7.1.m1.1.1.4.cmml">β</mi><mo id="S3.SS2.p7.1.m1.1.1.5" xref="S3.SS2.p7.1.m1.1.1.5.cmml">=</mo><mi id="S3.SS2.p7.1.m1.1.1.6" xref="S3.SS2.p7.1.m1.1.1.6.cmml">γ</mi><mo id="S3.SS2.p7.1.m1.1.1.7" xref="S3.SS2.p7.1.m1.1.1.7.cmml">=</mo><mn id="S3.SS2.p7.1.m1.1.1.8" xref="S3.SS2.p7.1.m1.1.1.8.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><and id="S3.SS2.p7.1.m1.1.1a.cmml" xref="S3.SS2.p7.1.m1.1.1"></and><apply id="S3.SS2.p7.1.m1.1.1b.cmml" xref="S3.SS2.p7.1.m1.1.1"><eq id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3"></eq><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝛼</ci><ci id="S3.SS2.p7.1.m1.1.1.4.cmml" xref="S3.SS2.p7.1.m1.1.1.4">𝛽</ci></apply><apply id="S3.SS2.p7.1.m1.1.1c.cmml" xref="S3.SS2.p7.1.m1.1.1"><eq id="S3.SS2.p7.1.m1.1.1.5.cmml" xref="S3.SS2.p7.1.m1.1.1.5"></eq><share href="#S3.SS2.p7.1.m1.1.1.4.cmml" id="S3.SS2.p7.1.m1.1.1d.cmml" xref="S3.SS2.p7.1.m1.1.1"></share><ci id="S3.SS2.p7.1.m1.1.1.6.cmml" xref="S3.SS2.p7.1.m1.1.1.6">𝛾</ci></apply><apply id="S3.SS2.p7.1.m1.1.1e.cmml" xref="S3.SS2.p7.1.m1.1.1"><eq id="S3.SS2.p7.1.m1.1.1.7.cmml" xref="S3.SS2.p7.1.m1.1.1.7"></eq><share href="#S3.SS2.p7.1.m1.1.1.6.cmml" id="S3.SS2.p7.1.m1.1.1f.cmml" xref="S3.SS2.p7.1.m1.1.1"></share><cn type="integer" id="S3.SS2.p7.1.m1.1.1.8.cmml" xref="S3.SS2.p7.1.m1.1.1.8">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\alpha=\beta=\gamma=1</annotation></semantics></math> and <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="C_{3}=C_{2}/2" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><mrow id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><msub id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2.2" xref="S3.SS2.p7.2.m2.1.1.2.2.cmml">C</mi><mn id="S3.SS2.p7.2.m2.1.1.2.3" xref="S3.SS2.p7.2.m2.1.1.2.3.cmml">3</mn></msub><mo id="S3.SS2.p7.2.m2.1.1.1" xref="S3.SS2.p7.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.p7.2.m2.1.1.3" xref="S3.SS2.p7.2.m2.1.1.3.cmml"><msub id="S3.SS2.p7.2.m2.1.1.3.2" xref="S3.SS2.p7.2.m2.1.1.3.2.cmml"><mi id="S3.SS2.p7.2.m2.1.1.3.2.2" xref="S3.SS2.p7.2.m2.1.1.3.2.2.cmml">C</mi><mn id="S3.SS2.p7.2.m2.1.1.3.2.3" xref="S3.SS2.p7.2.m2.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.SS2.p7.2.m2.1.1.3.1" xref="S3.SS2.p7.2.m2.1.1.3.1.cmml">/</mo><mn id="S3.SS2.p7.2.m2.1.1.3.3" xref="S3.SS2.p7.2.m2.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><eq id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1.1"></eq><apply id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.2.1.cmml" xref="S3.SS2.p7.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2.2">𝐶</ci><cn type="integer" id="S3.SS2.p7.2.m2.1.1.2.3.cmml" xref="S3.SS2.p7.2.m2.1.1.2.3">3</cn></apply><apply id="S3.SS2.p7.2.m2.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3"><divide id="S3.SS2.p7.2.m2.1.1.3.1.cmml" xref="S3.SS2.p7.2.m2.1.1.3.1"></divide><apply id="S3.SS2.p7.2.m2.1.1.3.2.cmml" xref="S3.SS2.p7.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.p7.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.p7.2.m2.1.1.3.2.2">𝐶</ci><cn type="integer" id="S3.SS2.p7.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3.2.3">2</cn></apply><cn type="integer" id="S3.SS2.p7.2.m2.1.1.3.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">C_{3}=C_{2}/2</annotation></semantics></math>, so the formula simplifies to:</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<table id="S3.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\text{SSIM}(x,y)" display="inline"><semantics id="S3.E8X.2.1.1.m1.2a"><mrow id="S3.E8X.2.1.1.m1.2.3" xref="S3.E8X.2.1.1.m1.2.3.cmml"><mtext id="S3.E8X.2.1.1.m1.2.3.2" xref="S3.E8X.2.1.1.m1.2.3.2a.cmml">SSIM</mtext><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.2.3.1" xref="S3.E8X.2.1.1.m1.2.3.1.cmml">​</mo><mrow id="S3.E8X.2.1.1.m1.2.3.3.2" xref="S3.E8X.2.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.E8X.2.1.1.m1.2.3.3.2.1" xref="S3.E8X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.E8X.2.1.1.m1.1.1" xref="S3.E8X.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.E8X.2.1.1.m1.2.3.3.2.2" xref="S3.E8X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.E8X.2.1.1.m1.2.2" xref="S3.E8X.2.1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E8X.2.1.1.m1.2.3.3.2.3" xref="S3.E8X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.2b"><apply id="S3.E8X.2.1.1.m1.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.3"><times id="S3.E8X.2.1.1.m1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.3.1"></times><ci id="S3.E8X.2.1.1.m1.2.3.2a.cmml" xref="S3.E8X.2.1.1.m1.2.3.2"><mtext id="S3.E8X.2.1.1.m1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.3.2">SSIM</mtext></ci><interval closure="open" id="S3.E8X.2.1.1.m1.2.3.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.3.3.2"><ci id="S3.E8X.2.1.1.m1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1">𝑥</ci><ci id="S3.E8X.2.1.1.m1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.2c">\displaystyle\text{SSIM}(x,y)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8X.3.2.2.m1.6" class="ltx_Math" alttext="\displaystyle=l(x,y)\cdot c(x,y)\cdot s(x,y)" display="inline"><semantics id="S3.E8X.3.2.2.m1.6a"><mrow id="S3.E8X.3.2.2.m1.6.7" xref="S3.E8X.3.2.2.m1.6.7.cmml"><mi id="S3.E8X.3.2.2.m1.6.7.2" xref="S3.E8X.3.2.2.m1.6.7.2.cmml"></mi><mo id="S3.E8X.3.2.2.m1.6.7.1" xref="S3.E8X.3.2.2.m1.6.7.1.cmml">=</mo><mrow id="S3.E8X.3.2.2.m1.6.7.3" xref="S3.E8X.3.2.2.m1.6.7.3.cmml"><mrow id="S3.E8X.3.2.2.m1.6.7.3.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.cmml"><mrow id="S3.E8X.3.2.2.m1.6.7.3.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.cmml"><mrow id="S3.E8X.3.2.2.m1.6.7.3.2.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.cmml"><mrow id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.cmml"><mi id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.1.cmml">​</mo><mrow id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.1.cmml">(</mo><mi id="S3.E8X.3.2.2.m1.1.1" xref="S3.E8X.3.2.2.m1.1.1.cmml">x</mi><mo id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E8X.3.2.2.m1.2.2" xref="S3.E8X.3.2.2.m1.2.2.cmml">y</mi><mo rspace="0.055em" stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.2.3" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.1.cmml">⋅</mo><mi id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.3" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.3.cmml">c</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.6.7.3.2.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.1.cmml">​</mo><mrow id="S3.E8X.3.2.2.m1.6.7.3.2.2.3.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.3.1.cmml"><mo stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.2.2.3.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.3.1.cmml">(</mo><mi id="S3.E8X.3.2.2.m1.3.3" xref="S3.E8X.3.2.2.m1.3.3.cmml">x</mi><mo id="S3.E8X.3.2.2.m1.6.7.3.2.2.3.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.3.1.cmml">,</mo><mi id="S3.E8X.3.2.2.m1.4.4" xref="S3.E8X.3.2.2.m1.4.4.cmml">y</mi><mo rspace="0.055em" stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.2.2.3.2.3" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E8X.3.2.2.m1.6.7.3.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.2.1.cmml">⋅</mo><mi id="S3.E8X.3.2.2.m1.6.7.3.2.3" xref="S3.E8X.3.2.2.m1.6.7.3.2.3.cmml">s</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.6.7.3.1" xref="S3.E8X.3.2.2.m1.6.7.3.1.cmml">​</mo><mrow id="S3.E8X.3.2.2.m1.6.7.3.3.2" xref="S3.E8X.3.2.2.m1.6.7.3.3.1.cmml"><mo stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.3.2.1" xref="S3.E8X.3.2.2.m1.6.7.3.3.1.cmml">(</mo><mi id="S3.E8X.3.2.2.m1.5.5" xref="S3.E8X.3.2.2.m1.5.5.cmml">x</mi><mo id="S3.E8X.3.2.2.m1.6.7.3.3.2.2" xref="S3.E8X.3.2.2.m1.6.7.3.3.1.cmml">,</mo><mi id="S3.E8X.3.2.2.m1.6.6" xref="S3.E8X.3.2.2.m1.6.6.cmml">y</mi><mo stretchy="false" id="S3.E8X.3.2.2.m1.6.7.3.3.2.3" xref="S3.E8X.3.2.2.m1.6.7.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.3.2.2.m1.6b"><apply id="S3.E8X.3.2.2.m1.6.7.cmml" xref="S3.E8X.3.2.2.m1.6.7"><eq id="S3.E8X.3.2.2.m1.6.7.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.1"></eq><csymbol cd="latexml" id="S3.E8X.3.2.2.m1.6.7.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.2">absent</csymbol><apply id="S3.E8X.3.2.2.m1.6.7.3.cmml" xref="S3.E8X.3.2.2.m1.6.7.3"><times id="S3.E8X.3.2.2.m1.6.7.3.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.1"></times><apply id="S3.E8X.3.2.2.m1.6.7.3.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2"><ci id="S3.E8X.3.2.2.m1.6.7.3.2.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.1">⋅</ci><apply id="S3.E8X.3.2.2.m1.6.7.3.2.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2"><times id="S3.E8X.3.2.2.m1.6.7.3.2.2.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.1"></times><apply id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2"><ci id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.1">⋅</ci><apply id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2"><times id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.1"></times><ci id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.2.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.2">𝑙</ci><interval closure="open" id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.2.3.2"><ci id="S3.E8X.3.2.2.m1.1.1.cmml" xref="S3.E8X.3.2.2.m1.1.1">𝑥</ci><ci id="S3.E8X.3.2.2.m1.2.2.cmml" xref="S3.E8X.3.2.2.m1.2.2">𝑦</ci></interval></apply><ci id="S3.E8X.3.2.2.m1.6.7.3.2.2.2.3.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.2.3">𝑐</ci></apply><interval closure="open" id="S3.E8X.3.2.2.m1.6.7.3.2.2.3.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.2.3.2"><ci id="S3.E8X.3.2.2.m1.3.3.cmml" xref="S3.E8X.3.2.2.m1.3.3">𝑥</ci><ci id="S3.E8X.3.2.2.m1.4.4.cmml" xref="S3.E8X.3.2.2.m1.4.4">𝑦</ci></interval></apply><ci id="S3.E8X.3.2.2.m1.6.7.3.2.3.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.2.3">𝑠</ci></apply><interval closure="open" id="S3.E8X.3.2.2.m1.6.7.3.3.1.cmml" xref="S3.E8X.3.2.2.m1.6.7.3.3.2"><ci id="S3.E8X.3.2.2.m1.5.5.cmml" xref="S3.E8X.3.2.2.m1.5.5">𝑥</ci><ci id="S3.E8X.3.2.2.m1.6.6.cmml" xref="S3.E8X.3.2.2.m1.6.6">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.3.2.2.m1.6c">\displaystyle=l(x,y)\cdot c(x,y)\cdot s(x,y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr id="S3.E8Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{(2\mu_{x}\mu_{y}+C_{1})(2\sigma_{xy}+C_{2})}{(\mu_{x}^{2}+\mu_{y}^{2}+C_{1})(\sigma_{x}^{2}+\sigma_{y}^{2}+C_{2})}" display="inline"><semantics id="S3.E8Xa.2.1.1.m1.4a"><mrow id="S3.E8Xa.2.1.1.m1.4.5" xref="S3.E8Xa.2.1.1.m1.4.5.cmml"><mi id="S3.E8Xa.2.1.1.m1.4.5.2" xref="S3.E8Xa.2.1.1.m1.4.5.2.cmml"></mi><mo id="S3.E8Xa.2.1.1.m1.4.5.1" xref="S3.E8Xa.2.1.1.m1.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E8Xa.2.1.1.m1.4.4" xref="S3.E8Xa.2.1.1.m1.4.4.cmml"><mfrac id="S3.E8Xa.2.1.1.m1.4.4a" xref="S3.E8Xa.2.1.1.m1.4.4.cmml"><mrow id="S3.E8Xa.2.1.1.m1.2.2.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.cmml"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mn id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml">μ</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1a" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.2.cmml">μ</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.3.cmml">y</mi></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">C</mi><mn id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.2.2.2.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E8Xa.2.1.1.m1.2.2.2.2.1" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml"><mn id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.1" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><msub id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.2.cmml">σ</mi><mrow id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.1" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.1.cmml">​</mo><mi id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.3.cmml">y</mi></mrow></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml">+</mo><msub id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml">C</mi><mn id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.3" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E8Xa.2.1.1.m1.4.4.4" xref="S3.E8Xa.2.1.1.m1.4.4.4.cmml"><mrow id="S3.E8Xa.2.1.1.m1.3.3.3.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.cmml"><msubsup id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.2" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.2.cmml">μ</mi><mi id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.3.cmml">x</mi><mn id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1.cmml">+</mo><msubsup id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.2" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.2.cmml">μ</mi><mi id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.3.cmml">y</mi><mn id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.3.cmml">2</mn></msubsup><mo id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1a" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1.cmml">+</mo><msub id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.2" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.2.cmml">C</mi><mn id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.3" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.4.4.4.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.3.cmml">​</mo><mrow id="S3.E8Xa.2.1.1.m1.4.4.4.2.1" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.cmml"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.2" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.cmml"><msubsup id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.2" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.2.cmml">σ</mi><mi id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.3.cmml">x</mi><mn id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.3.cmml">2</mn></msubsup><mo id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1.cmml">+</mo><msubsup id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.2" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.2.cmml">σ</mi><mi id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.3.cmml">y</mi><mn id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.3.cmml">2</mn></msubsup><mo id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1a" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1.cmml">+</mo><msub id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.cmml"><mi id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.2" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.2.cmml">C</mi><mn id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.3" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xa.2.1.1.m1.4b"><apply id="S3.E8Xa.2.1.1.m1.4.5.cmml" xref="S3.E8Xa.2.1.1.m1.4.5"><eq id="S3.E8Xa.2.1.1.m1.4.5.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.5.1"></eq><csymbol cd="latexml" id="S3.E8Xa.2.1.1.m1.4.5.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.5.2">absent</csymbol><apply id="S3.E8Xa.2.1.1.m1.4.4.cmml" xref="S3.E8Xa.2.1.1.m1.4.4"><divide id="S3.E8Xa.2.1.1.m1.4.4.5.cmml" xref="S3.E8Xa.2.1.1.m1.4.4"></divide><apply id="S3.E8Xa.2.1.1.m1.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2"><times id="S3.E8Xa.2.1.1.m1.2.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.3"></times><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1"><plus id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2"><times id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.2">2</cn><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.2">𝜇</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.3.3">𝑥</ci></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.2">𝜇</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.4.3">𝑦</ci></apply></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2">𝐶</ci><cn type="integer" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1"><plus id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.1"></plus><apply id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2"><times id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.1"></times><cn type="integer" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.2">2</cn><apply id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.2">𝜎</ci><apply id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3"><times id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.1"></times><ci id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.2">𝑥</ci><ci id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.2.3.3.3">𝑦</ci></apply></apply></apply><apply id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.2">𝐶</ci><cn type="integer" id="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.2.2.2.2.1.1.3.3">2</cn></apply></apply></apply><apply id="S3.E8Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4"><times id="S3.E8Xa.2.1.1.m1.4.4.4.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.3"></times><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1"><plus id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.1"></plus><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.2">𝜇</ci><ci id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.2.3">𝑥</ci></apply><cn type="integer" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.2.3">2</cn></apply><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.2">𝜇</ci><ci id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.2.3">𝑦</ci></apply><cn type="integer" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.3.3">2</cn></apply><apply id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.2">𝐶</ci><cn type="integer" id="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.3.1.1.1.4.3">1</cn></apply></apply><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1"><plus id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.1"></plus><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2">superscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.2">𝜎</ci><ci id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.2.3">𝑥</ci></apply><cn type="integer" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.2.3">2</cn></apply><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3">superscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.2">𝜎</ci><ci id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.2.3">𝑦</ci></apply><cn type="integer" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.3.3">2</cn></apply><apply id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.1.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.2.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.2">𝐶</ci><cn type="integer" id="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.3.cmml" xref="S3.E8Xa.2.1.1.m1.4.4.4.2.1.1.4.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.4c">\displaystyle=\frac{(2\mu_{x}\mu_{y}+C_{1})(2\sigma_{xy}+C_{2})}{(\mu_{x}^{2}+\mu_{y}^{2}+C_{1})(\sigma_{x}^{2}+\sigma_{y}^{2}+C_{2})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.7" class="ltx_p">In practice, it is useful to apply SSIM index locally rather than globally for many reasons. The most straightforward one for anomaly detection is that we need a spatially varying quality map of the reconstruction image to localize the anomalies. The local statistics <math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="\mu_{x}" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><msub id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml"><mi id="S3.SS2.p9.1.m1.1.1.2" xref="S3.SS2.p9.1.m1.1.1.2.cmml">μ</mi><mi id="S3.SS2.p9.1.m1.1.1.3" xref="S3.SS2.p9.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><apply id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p9.1.m1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2">𝜇</ci><ci id="S3.SS2.p9.1.m1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">\mu_{x}</annotation></semantics></math>, <math id="S3.SS2.p9.2.m2.1" class="ltx_Math" alttext="\sigma_{x}" display="inline"><semantics id="S3.SS2.p9.2.m2.1a"><msub id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml"><mi id="S3.SS2.p9.2.m2.1.1.2" xref="S3.SS2.p9.2.m2.1.1.2.cmml">σ</mi><mi id="S3.SS2.p9.2.m2.1.1.3" xref="S3.SS2.p9.2.m2.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.1b"><apply id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.2.m2.1.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p9.2.m2.1.1.2.cmml" xref="S3.SS2.p9.2.m2.1.1.2">𝜎</ci><ci id="S3.SS2.p9.2.m2.1.1.3.cmml" xref="S3.SS2.p9.2.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.1c">\sigma_{x}</annotation></semantics></math> and <math id="S3.SS2.p9.3.m3.1" class="ltx_Math" alttext="\sigma_{xy}" display="inline"><semantics id="S3.SS2.p9.3.m3.1a"><msub id="S3.SS2.p9.3.m3.1.1" xref="S3.SS2.p9.3.m3.1.1.cmml"><mi id="S3.SS2.p9.3.m3.1.1.2" xref="S3.SS2.p9.3.m3.1.1.2.cmml">σ</mi><mrow id="S3.SS2.p9.3.m3.1.1.3" xref="S3.SS2.p9.3.m3.1.1.3.cmml"><mi id="S3.SS2.p9.3.m3.1.1.3.2" xref="S3.SS2.p9.3.m3.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p9.3.m3.1.1.3.1" xref="S3.SS2.p9.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p9.3.m3.1.1.3.3" xref="S3.SS2.p9.3.m3.1.1.3.3.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.3.m3.1b"><apply id="S3.SS2.p9.3.m3.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m3.1.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p9.3.m3.1.1.2.cmml" xref="S3.SS2.p9.3.m3.1.1.2">𝜎</ci><apply id="S3.SS2.p9.3.m3.1.1.3.cmml" xref="S3.SS2.p9.3.m3.1.1.3"><times id="S3.SS2.p9.3.m3.1.1.3.1.cmml" xref="S3.SS2.p9.3.m3.1.1.3.1"></times><ci id="S3.SS2.p9.3.m3.1.1.3.2.cmml" xref="S3.SS2.p9.3.m3.1.1.3.2">𝑥</ci><ci id="S3.SS2.p9.3.m3.1.1.3.3.cmml" xref="S3.SS2.p9.3.m3.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.3.m3.1c">\sigma_{xy}</annotation></semantics></math> are calculated within a <math id="S3.SS2.p9.4.m4.1" class="ltx_Math" alttext="W\times W" display="inline"><semantics id="S3.SS2.p9.4.m4.1a"><mrow id="S3.SS2.p9.4.m4.1.1" xref="S3.SS2.p9.4.m4.1.1.cmml"><mi id="S3.SS2.p9.4.m4.1.1.2" xref="S3.SS2.p9.4.m4.1.1.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p9.4.m4.1.1.1" xref="S3.SS2.p9.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS2.p9.4.m4.1.1.3" xref="S3.SS2.p9.4.m4.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.4.m4.1b"><apply id="S3.SS2.p9.4.m4.1.1.cmml" xref="S3.SS2.p9.4.m4.1.1"><times id="S3.SS2.p9.4.m4.1.1.1.cmml" xref="S3.SS2.p9.4.m4.1.1.1"></times><ci id="S3.SS2.p9.4.m4.1.1.2.cmml" xref="S3.SS2.p9.4.m4.1.1.2">𝑊</ci><ci id="S3.SS2.p9.4.m4.1.1.3.cmml" xref="S3.SS2.p9.4.m4.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.4.m4.1c">W\times W</annotation></semantics></math> window, moving with a stride <math id="S3.SS2.p9.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p9.5.m5.1a"><mi id="S3.SS2.p9.5.m5.1.1" xref="S3.SS2.p9.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.5.m5.1b"><ci id="S3.SS2.p9.5.m5.1.1.cmml" xref="S3.SS2.p9.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.5.m5.1c">S</annotation></semantics></math> over the entire image. We set <math id="S3.SS2.p9.6.m6.1" class="ltx_Math" alttext="W=5" display="inline"><semantics id="S3.SS2.p9.6.m6.1a"><mrow id="S3.SS2.p9.6.m6.1.1" xref="S3.SS2.p9.6.m6.1.1.cmml"><mi id="S3.SS2.p9.6.m6.1.1.2" xref="S3.SS2.p9.6.m6.1.1.2.cmml">W</mi><mo id="S3.SS2.p9.6.m6.1.1.1" xref="S3.SS2.p9.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p9.6.m6.1.1.3" xref="S3.SS2.p9.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.6.m6.1b"><apply id="S3.SS2.p9.6.m6.1.1.cmml" xref="S3.SS2.p9.6.m6.1.1"><eq id="S3.SS2.p9.6.m6.1.1.1.cmml" xref="S3.SS2.p9.6.m6.1.1.1"></eq><ci id="S3.SS2.p9.6.m6.1.1.2.cmml" xref="S3.SS2.p9.6.m6.1.1.2">𝑊</ci><cn type="integer" id="S3.SS2.p9.6.m6.1.1.3.cmml" xref="S3.SS2.p9.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.6.m6.1c">W=5</annotation></semantics></math> and <math id="S3.SS2.p9.7.m7.1" class="ltx_Math" alttext="S=1" display="inline"><semantics id="S3.SS2.p9.7.m7.1a"><mrow id="S3.SS2.p9.7.m7.1.1" xref="S3.SS2.p9.7.m7.1.1.cmml"><mi id="S3.SS2.p9.7.m7.1.1.2" xref="S3.SS2.p9.7.m7.1.1.2.cmml">S</mi><mo id="S3.SS2.p9.7.m7.1.1.1" xref="S3.SS2.p9.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.p9.7.m7.1.1.3" xref="S3.SS2.p9.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.7.m7.1b"><apply id="S3.SS2.p9.7.m7.1.1.cmml" xref="S3.SS2.p9.7.m7.1.1"><eq id="S3.SS2.p9.7.m7.1.1.1.cmml" xref="S3.SS2.p9.7.m7.1.1.1"></eq><ci id="S3.SS2.p9.7.m7.1.1.2.cmml" xref="S3.SS2.p9.7.m7.1.1.2">𝑆</ci><cn type="integer" id="S3.SS2.p9.7.m7.1.1.3.cmml" xref="S3.SS2.p9.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.7.m7.1c">S=1</annotation></semantics></math> to produce a quality map matching the input shape. The final SSIM loss can be defined as:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.4" class="ltx_Math" alttext="L_{SSIM}(x,y)=\frac{1-\frac{1}{K}\sum_{k=1}^{K}SSIM(x_{k},y_{k})}{2}" display="block"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.5" xref="S3.E9.m1.4.5.cmml"><mrow id="S3.E9.m1.4.5.2" xref="S3.E9.m1.4.5.2.cmml"><msub id="S3.E9.m1.4.5.2.2" xref="S3.E9.m1.4.5.2.2.cmml"><mi id="S3.E9.m1.4.5.2.2.2" xref="S3.E9.m1.4.5.2.2.2.cmml">L</mi><mrow id="S3.E9.m1.4.5.2.2.3" xref="S3.E9.m1.4.5.2.2.3.cmml"><mi id="S3.E9.m1.4.5.2.2.3.2" xref="S3.E9.m1.4.5.2.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.2.2.3.1" xref="S3.E9.m1.4.5.2.2.3.1.cmml">​</mo><mi id="S3.E9.m1.4.5.2.2.3.3" xref="S3.E9.m1.4.5.2.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.2.2.3.1a" xref="S3.E9.m1.4.5.2.2.3.1.cmml">​</mo><mi id="S3.E9.m1.4.5.2.2.3.4" xref="S3.E9.m1.4.5.2.2.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.2.2.3.1b" xref="S3.E9.m1.4.5.2.2.3.1.cmml">​</mo><mi id="S3.E9.m1.4.5.2.2.3.5" xref="S3.E9.m1.4.5.2.2.3.5.cmml">M</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.2.1" xref="S3.E9.m1.4.5.2.1.cmml">​</mo><mrow id="S3.E9.m1.4.5.2.3.2" xref="S3.E9.m1.4.5.2.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.5.2.3.2.1" xref="S3.E9.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">x</mi><mo id="S3.E9.m1.4.5.2.3.2.2" xref="S3.E9.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E9.m1.4.5.2.3.2.3" xref="S3.E9.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.5.1" xref="S3.E9.m1.4.5.1.cmml">=</mo><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mn id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.4.cmml">1</mn><mo id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml"><mfrac id="S3.E9.m1.2.2.2.2.4" xref="S3.E9.m1.2.2.2.2.4.cmml"><mn id="S3.E9.m1.2.2.2.2.4.2" xref="S3.E9.m1.2.2.2.2.4.2.cmml">1</mn><mi id="S3.E9.m1.2.2.2.2.4.3" xref="S3.E9.m1.2.2.2.2.4.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.cmml"><msubsup id="S3.E9.m1.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.3.cmml"><mo id="S3.E9.m1.2.2.2.2.2.3.2.2" xref="S3.E9.m1.2.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E9.m1.2.2.2.2.2.3.2.3" xref="S3.E9.m1.2.2.2.2.2.3.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.2.3.2.3.2" xref="S3.E9.m1.2.2.2.2.2.3.2.3.2.cmml">k</mi><mo id="S3.E9.m1.2.2.2.2.2.3.2.3.1" xref="S3.E9.m1.2.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E9.m1.2.2.2.2.2.3.2.3.3" xref="S3.E9.m1.2.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.2.2.2.2.2.3.3" xref="S3.E9.m1.2.2.2.2.2.3.3.cmml">K</mi></msubsup><mrow id="S3.E9.m1.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.4" xref="S3.E9.m1.2.2.2.2.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.3.cmml">​</mo><mi id="S3.E9.m1.2.2.2.2.2.2.5" xref="S3.E9.m1.2.2.2.2.2.2.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.2.2.3a" xref="S3.E9.m1.2.2.2.2.2.2.3.cmml">​</mo><mi id="S3.E9.m1.2.2.2.2.2.2.6" xref="S3.E9.m1.2.2.2.2.2.2.6.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.2.2.3b" xref="S3.E9.m1.2.2.2.2.2.2.3.cmml">​</mo><mi id="S3.E9.m1.2.2.2.2.2.2.7" xref="S3.E9.m1.2.2.2.2.2.2.7.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.2.2.3c" xref="S3.E9.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.2.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E9.m1.2.2.2.2.2.2.2.2.4" xref="S3.E9.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E9.m1.2.2.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E9.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E9.m1.2.2.2.2.2.2.2.2.5" xref="S3.E9.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mn id="S3.E9.m1.2.2.4" xref="S3.E9.m1.2.2.4.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.5.cmml" xref="S3.E9.m1.4.5"><eq id="S3.E9.m1.4.5.1.cmml" xref="S3.E9.m1.4.5.1"></eq><apply id="S3.E9.m1.4.5.2.cmml" xref="S3.E9.m1.4.5.2"><times id="S3.E9.m1.4.5.2.1.cmml" xref="S3.E9.m1.4.5.2.1"></times><apply id="S3.E9.m1.4.5.2.2.cmml" xref="S3.E9.m1.4.5.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.2.2.1.cmml" xref="S3.E9.m1.4.5.2.2">subscript</csymbol><ci id="S3.E9.m1.4.5.2.2.2.cmml" xref="S3.E9.m1.4.5.2.2.2">𝐿</ci><apply id="S3.E9.m1.4.5.2.2.3.cmml" xref="S3.E9.m1.4.5.2.2.3"><times id="S3.E9.m1.4.5.2.2.3.1.cmml" xref="S3.E9.m1.4.5.2.2.3.1"></times><ci id="S3.E9.m1.4.5.2.2.3.2.cmml" xref="S3.E9.m1.4.5.2.2.3.2">𝑆</ci><ci id="S3.E9.m1.4.5.2.2.3.3.cmml" xref="S3.E9.m1.4.5.2.2.3.3">𝑆</ci><ci id="S3.E9.m1.4.5.2.2.3.4.cmml" xref="S3.E9.m1.4.5.2.2.3.4">𝐼</ci><ci id="S3.E9.m1.4.5.2.2.3.5.cmml" xref="S3.E9.m1.4.5.2.2.3.5">𝑀</ci></apply></apply><interval closure="open" id="S3.E9.m1.4.5.2.3.1.cmml" xref="S3.E9.m1.4.5.2.3.2"><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">𝑥</ci><ci id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4">𝑦</ci></interval></apply><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2"></divide><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><minus id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></minus><cn type="integer" id="S3.E9.m1.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.4">1</cn><apply id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2"><times id="S3.E9.m1.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.3"></times><apply id="S3.E9.m1.2.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.2.4"><divide id="S3.E9.m1.2.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.2.4"></divide><cn type="integer" id="S3.E9.m1.2.2.2.2.4.2.cmml" xref="S3.E9.m1.2.2.2.2.4.2">1</cn><ci id="S3.E9.m1.2.2.2.2.4.3.cmml" xref="S3.E9.m1.2.2.2.2.4.3">𝐾</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2"><apply id="S3.E9.m1.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.3.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.3">subscript</csymbol><sum id="S3.E9.m1.2.2.2.2.2.3.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.3.2.2"></sum><apply id="S3.E9.m1.2.2.2.2.2.3.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3.2.3"><eq id="S3.E9.m1.2.2.2.2.2.3.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.2.3.2.3.1"></eq><ci id="S3.E9.m1.2.2.2.2.2.3.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E9.m1.2.2.2.2.2.3.2.3.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.2.2.2.2.2.3.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3.3">𝐾</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2"><times id="S3.E9.m1.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3"></times><ci id="S3.E9.m1.2.2.2.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.2.2.2.4">𝑆</ci><ci id="S3.E9.m1.2.2.2.2.2.2.5.cmml" xref="S3.E9.m1.2.2.2.2.2.2.5">𝑆</ci><ci id="S3.E9.m1.2.2.2.2.2.2.6.cmml" xref="S3.E9.m1.2.2.2.2.2.2.6">𝐼</ci><ci id="S3.E9.m1.2.2.2.2.2.2.7.cmml" xref="S3.E9.m1.2.2.2.2.2.2.7">𝑀</ci><interval closure="open" id="S3.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2"><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E9.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply><cn type="integer" id="S3.E9.m1.2.2.4.cmml" xref="S3.E9.m1.2.2.4">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">L_{SSIM}(x,y)=\frac{1-\frac{1}{K}\sum_{k=1}^{K}SSIM(x_{k},y_{k})}{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p9.11" class="ltx_p">where <math id="S3.SS2.p9.8.m1.1" class="ltx_Math" alttext="x_{k}" display="inline"><semantics id="S3.SS2.p9.8.m1.1a"><msub id="S3.SS2.p9.8.m1.1.1" xref="S3.SS2.p9.8.m1.1.1.cmml"><mi id="S3.SS2.p9.8.m1.1.1.2" xref="S3.SS2.p9.8.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.p9.8.m1.1.1.3" xref="S3.SS2.p9.8.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.8.m1.1b"><apply id="S3.SS2.p9.8.m1.1.1.cmml" xref="S3.SS2.p9.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.8.m1.1.1.1.cmml" xref="S3.SS2.p9.8.m1.1.1">subscript</csymbol><ci id="S3.SS2.p9.8.m1.1.1.2.cmml" xref="S3.SS2.p9.8.m1.1.1.2">𝑥</ci><ci id="S3.SS2.p9.8.m1.1.1.3.cmml" xref="S3.SS2.p9.8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.8.m1.1c">x_{k}</annotation></semantics></math> and <math id="S3.SS2.p9.9.m2.1" class="ltx_Math" alttext="y_{k}" display="inline"><semantics id="S3.SS2.p9.9.m2.1a"><msub id="S3.SS2.p9.9.m2.1.1" xref="S3.SS2.p9.9.m2.1.1.cmml"><mi id="S3.SS2.p9.9.m2.1.1.2" xref="S3.SS2.p9.9.m2.1.1.2.cmml">y</mi><mi id="S3.SS2.p9.9.m2.1.1.3" xref="S3.SS2.p9.9.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.9.m2.1b"><apply id="S3.SS2.p9.9.m2.1.1.cmml" xref="S3.SS2.p9.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.9.m2.1.1.1.cmml" xref="S3.SS2.p9.9.m2.1.1">subscript</csymbol><ci id="S3.SS2.p9.9.m2.1.1.2.cmml" xref="S3.SS2.p9.9.m2.1.1.2">𝑦</ci><ci id="S3.SS2.p9.9.m2.1.1.3.cmml" xref="S3.SS2.p9.9.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.9.m2.1c">y_{k}</annotation></semantics></math> are the image contents in the <math id="S3.SS2.p9.10.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p9.10.m3.1a"><mi id="S3.SS2.p9.10.m3.1.1" xref="S3.SS2.p9.10.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.10.m3.1b"><ci id="S3.SS2.p9.10.m3.1.1.cmml" xref="S3.SS2.p9.10.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.10.m3.1c">k</annotation></semantics></math>-th local window, and <math id="S3.SS2.p9.11.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p9.11.m4.1a"><mi id="S3.SS2.p9.11.m4.1.1" xref="S3.SS2.p9.11.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.11.m4.1b"><ci id="S3.SS2.p9.11.m4.1.1.cmml" xref="S3.SS2.p9.11.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.11.m4.1c">K</annotation></semantics></math> is the total number of local windows.</p>
</div>
<div id="S3.SS2.p10" class="ltx_para">
<p id="S3.SS2.p10.1" class="ltx_p">The error at the <math id="S3.SS2.p10.1.m1.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS2.p10.1.m1.2a"><mrow id="S3.SS2.p10.1.m1.2.3.2" xref="S3.SS2.p10.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p10.1.m1.2.3.2.1" xref="S3.SS2.p10.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml">i</mi><mo id="S3.SS2.p10.1.m1.2.3.2.2" xref="S3.SS2.p10.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.p10.1.m1.2.2" xref="S3.SS2.p10.1.m1.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS2.p10.1.m1.2.3.2.3" xref="S3.SS2.p10.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.2b"><interval closure="open" id="S3.SS2.p10.1.m1.2.3.1.cmml" xref="S3.SS2.p10.1.m1.2.3.2"><ci id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1">𝑖</ci><ci id="S3.SS2.p10.1.m1.2.2.cmml" xref="S3.SS2.p10.1.m1.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.2c">(i,j)</annotation></semantics></math> pixel during inference can be defined as:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.4" class="ltx_Math" alttext="\Lambda(i,j)=\frac{1-SSIM(x_{ij},y_{ij})}{2}" display="block"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.5" xref="S3.E10.m1.4.5.cmml"><mrow id="S3.E10.m1.4.5.2" xref="S3.E10.m1.4.5.2.cmml"><mi mathvariant="normal" id="S3.E10.m1.4.5.2.2" xref="S3.E10.m1.4.5.2.2.cmml">Λ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.4.5.2.1" xref="S3.E10.m1.4.5.2.1.cmml">​</mo><mrow id="S3.E10.m1.4.5.2.3.2" xref="S3.E10.m1.4.5.2.3.1.cmml"><mo stretchy="false" id="S3.E10.m1.4.5.2.3.2.1" xref="S3.E10.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">i</mi><mo id="S3.E10.m1.4.5.2.3.2.2" xref="S3.E10.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml">j</mi><mo stretchy="false" id="S3.E10.m1.4.5.2.3.2.3" xref="S3.E10.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.4.5.1" xref="S3.E10.m1.4.5.1.cmml">=</mo><mfrac id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><mn id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.4.cmml">1</mn><mo id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.3.cmml">​</mo><mi id="S3.E10.m1.2.2.2.2.5" xref="S3.E10.m1.2.2.2.2.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.3a" xref="S3.E10.m1.2.2.2.2.3.cmml">​</mo><mi id="S3.E10.m1.2.2.2.2.6" xref="S3.E10.m1.2.2.2.2.6.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.3b" xref="S3.E10.m1.2.2.2.2.3.cmml">​</mo><mi id="S3.E10.m1.2.2.2.2.7" xref="S3.E10.m1.2.2.2.2.7.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.3c" xref="S3.E10.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.2.2.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mrow id="S3.E10.m1.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.3.2" xref="S3.E10.m1.2.2.2.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.2.2.2.3.1" xref="S3.E10.m1.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.2.2.2.2.2.3.3" xref="S3.E10.m1.2.2.2.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.5" xref="S3.E10.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mn id="S3.E10.m1.2.2.4" xref="S3.E10.m1.2.2.4.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.5.cmml" xref="S3.E10.m1.4.5"><eq id="S3.E10.m1.4.5.1.cmml" xref="S3.E10.m1.4.5.1"></eq><apply id="S3.E10.m1.4.5.2.cmml" xref="S3.E10.m1.4.5.2"><times id="S3.E10.m1.4.5.2.1.cmml" xref="S3.E10.m1.4.5.2.1"></times><ci id="S3.E10.m1.4.5.2.2.cmml" xref="S3.E10.m1.4.5.2.2">Λ</ci><interval closure="open" id="S3.E10.m1.4.5.2.3.1.cmml" xref="S3.E10.m1.4.5.2.3.2"><ci id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">𝑖</ci><ci id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.4.4">𝑗</ci></interval></apply><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><divide id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2"></divide><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><minus id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3"></minus><cn type="integer" id="S3.E10.m1.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.4">1</cn><apply id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2"><times id="S3.E10.m1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.3"></times><ci id="S3.E10.m1.2.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.2.4">𝑆</ci><ci id="S3.E10.m1.2.2.2.2.5.cmml" xref="S3.E10.m1.2.2.2.2.5">𝑆</ci><ci id="S3.E10.m1.2.2.2.2.6.cmml" xref="S3.E10.m1.2.2.2.2.6">𝐼</ci><ci id="S3.E10.m1.2.2.2.2.7.cmml" xref="S3.E10.m1.2.2.2.2.7">𝑀</ci><interval closure="open" id="S3.E10.m1.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2"><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3"><times id="S3.E10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2">𝑦</ci><apply id="S3.E10.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3"><times id="S3.E10.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S3.E10.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.E10.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3.3">𝑗</ci></apply></apply></interval></apply></apply><cn type="integer" id="S3.E10.m1.2.2.4.cmml" xref="S3.E10.m1.2.2.4">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">\Lambda(i,j)=\frac{1-SSIM(x_{ij},y_{ij})}{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p10.4" class="ltx_p">where <math id="S3.SS2.p10.2.m1.1" class="ltx_Math" alttext="x_{ij}" display="inline"><semantics id="S3.SS2.p10.2.m1.1a"><msub id="S3.SS2.p10.2.m1.1.1" xref="S3.SS2.p10.2.m1.1.1.cmml"><mi id="S3.SS2.p10.2.m1.1.1.2" xref="S3.SS2.p10.2.m1.1.1.2.cmml">x</mi><mrow id="S3.SS2.p10.2.m1.1.1.3" xref="S3.SS2.p10.2.m1.1.1.3.cmml"><mi id="S3.SS2.p10.2.m1.1.1.3.2" xref="S3.SS2.p10.2.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p10.2.m1.1.1.3.1" xref="S3.SS2.p10.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p10.2.m1.1.1.3.3" xref="S3.SS2.p10.2.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m1.1b"><apply id="S3.SS2.p10.2.m1.1.1.cmml" xref="S3.SS2.p10.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.2.m1.1.1.1.cmml" xref="S3.SS2.p10.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.p10.2.m1.1.1.2.cmml" xref="S3.SS2.p10.2.m1.1.1.2">𝑥</ci><apply id="S3.SS2.p10.2.m1.1.1.3.cmml" xref="S3.SS2.p10.2.m1.1.1.3"><times id="S3.SS2.p10.2.m1.1.1.3.1.cmml" xref="S3.SS2.p10.2.m1.1.1.3.1"></times><ci id="S3.SS2.p10.2.m1.1.1.3.2.cmml" xref="S3.SS2.p10.2.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p10.2.m1.1.1.3.3.cmml" xref="S3.SS2.p10.2.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m1.1c">x_{ij}</annotation></semantics></math> and <math id="S3.SS2.p10.3.m2.1" class="ltx_Math" alttext="y_{ij}" display="inline"><semantics id="S3.SS2.p10.3.m2.1a"><msub id="S3.SS2.p10.3.m2.1.1" xref="S3.SS2.p10.3.m2.1.1.cmml"><mi id="S3.SS2.p10.3.m2.1.1.2" xref="S3.SS2.p10.3.m2.1.1.2.cmml">y</mi><mrow id="S3.SS2.p10.3.m2.1.1.3" xref="S3.SS2.p10.3.m2.1.1.3.cmml"><mi id="S3.SS2.p10.3.m2.1.1.3.2" xref="S3.SS2.p10.3.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p10.3.m2.1.1.3.1" xref="S3.SS2.p10.3.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p10.3.m2.1.1.3.3" xref="S3.SS2.p10.3.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m2.1b"><apply id="S3.SS2.p10.3.m2.1.1.cmml" xref="S3.SS2.p10.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.3.m2.1.1.1.cmml" xref="S3.SS2.p10.3.m2.1.1">subscript</csymbol><ci id="S3.SS2.p10.3.m2.1.1.2.cmml" xref="S3.SS2.p10.3.m2.1.1.2">𝑦</ci><apply id="S3.SS2.p10.3.m2.1.1.3.cmml" xref="S3.SS2.p10.3.m2.1.1.3"><times id="S3.SS2.p10.3.m2.1.1.3.1.cmml" xref="S3.SS2.p10.3.m2.1.1.3.1"></times><ci id="S3.SS2.p10.3.m2.1.1.3.2.cmml" xref="S3.SS2.p10.3.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.p10.3.m2.1.1.3.3.cmml" xref="S3.SS2.p10.3.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m2.1c">y_{ij}</annotation></semantics></math> are the image contents within the local window centered at <math id="S3.SS2.p10.4.m3.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS2.p10.4.m3.2a"><mrow id="S3.SS2.p10.4.m3.2.3.2" xref="S3.SS2.p10.4.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p10.4.m3.2.3.2.1" xref="S3.SS2.p10.4.m3.2.3.1.cmml">(</mo><mi id="S3.SS2.p10.4.m3.1.1" xref="S3.SS2.p10.4.m3.1.1.cmml">i</mi><mo id="S3.SS2.p10.4.m3.2.3.2.2" xref="S3.SS2.p10.4.m3.2.3.1.cmml">,</mo><mi id="S3.SS2.p10.4.m3.2.2" xref="S3.SS2.p10.4.m3.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS2.p10.4.m3.2.3.2.3" xref="S3.SS2.p10.4.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.4.m3.2b"><interval closure="open" id="S3.SS2.p10.4.m3.2.3.1.cmml" xref="S3.SS2.p10.4.m3.2.3.2"><ci id="S3.SS2.p10.4.m3.1.1.cmml" xref="S3.SS2.p10.4.m3.1.1">𝑖</ci><ci id="S3.SS2.p10.4.m3.2.2.cmml" xref="S3.SS2.p10.4.m3.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.4.m3.2c">(i,j)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p11" class="ltx_para">
<p id="S3.SS2.p11.1" class="ltx_p">By design, SSIM is not particularly sensitive to uniform biases, which can lead to changes in brightness or color shifts. However, SSIM better preserves contrast in high-frequency regions compared to other loss functions as shown in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. On the other hand, <math id="S3.SS2.p11.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.SS2.p11.1.m1.1a"><msub id="S3.SS2.p11.1.m1.1.1" xref="S3.SS2.p11.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p11.1.m1.1.1.2" xref="S3.SS2.p11.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS2.p11.1.m1.1.1.3" xref="S3.SS2.p11.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.1.m1.1b"><apply id="S3.SS2.p11.1.m1.1.1.cmml" xref="S3.SS2.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.1.m1.1.1.1.cmml" xref="S3.SS2.p11.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p11.1.m1.1.1.2.cmml" xref="S3.SS2.p11.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS2.p11.1.m1.1.1.3.cmml" xref="S3.SS2.p11.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.1.m1.1c">\ell_{1}</annotation></semantics></math> loss preserves colors and luminance, treating all errors equally regardless of local structure, but it doesn’t maintain contrast as effectively as SSIM.</p>
</div>
<div id="S3.SS2.p12" class="ltx_para">
<p id="S3.SS2.p12.2" class="ltx_p">To capture the best characteristics of both error functions, we propose to combine them and get our final fusion quality loss:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.1" class="ltx_Math" alttext="L_{FQ}=\alpha L_{SSIM}+(1-\alpha)L_{1}" display="block"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><msub id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.3.2" xref="S3.E11.m1.1.1.3.2.cmml">L</mi><mrow id="S3.E11.m1.1.1.3.3" xref="S3.E11.m1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.2" xref="S3.E11.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.3.3.1" xref="S3.E11.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E11.m1.1.1.3.3.3" xref="S3.E11.m1.1.1.3.3.3.cmml">Q</mi></mrow></msub><mo id="S3.E11.m1.1.1.2" xref="S3.E11.m1.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.3" xref="S3.E11.m1.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.3.1" xref="S3.E11.m1.1.1.1.3.1.cmml">​</mo><msub id="S3.E11.m1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.1.3.3.2" xref="S3.E11.m1.1.1.1.3.3.2.cmml">L</mi><mrow id="S3.E11.m1.1.1.1.3.3.3" xref="S3.E11.m1.1.1.1.3.3.3.cmml"><mi id="S3.E11.m1.1.1.1.3.3.3.2" xref="S3.E11.m1.1.1.1.3.3.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.3.3.3.1" xref="S3.E11.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11.m1.1.1.1.3.3.3.3" xref="S3.E11.m1.1.1.1.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.3.3.3.1a" xref="S3.E11.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11.m1.1.1.1.3.3.3.4" xref="S3.E11.m1.1.1.1.3.3.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.3.3.3.1b" xref="S3.E11.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E11.m1.1.1.1.3.3.3.5" xref="S3.E11.m1.1.1.1.3.3.3.5.cmml">M</mi></mrow></msub></mrow><mo id="S3.E11.m1.1.1.1.2" xref="S3.E11.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E11.m1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E11.m1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.E11.m1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E11.m1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.3.2.cmml">L</mi><mn id="S3.E11.m1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.3.3.cmml">1</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><eq id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1.2"></eq><apply id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.3.2">𝐿</ci><apply id="S3.E11.m1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.3.3"><times id="S3.E11.m1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3.1"></times><ci id="S3.E11.m1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.2">𝐹</ci><ci id="S3.E11.m1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.3.3.3">𝑄</ci></apply></apply><apply id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><plus id="S3.E11.m1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.2"></plus><apply id="S3.E11.m1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.3"><times id="S3.E11.m1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.3.1"></times><ci id="S3.E11.m1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.3.2">𝛼</ci><apply id="S3.E11.m1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.1.3.3.2">𝐿</ci><apply id="S3.E11.m1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.1.3.3.3"><times id="S3.E11.m1.1.1.1.3.3.3.1.cmml" xref="S3.E11.m1.1.1.1.3.3.3.1"></times><ci id="S3.E11.m1.1.1.1.3.3.3.2.cmml" xref="S3.E11.m1.1.1.1.3.3.3.2">𝑆</ci><ci id="S3.E11.m1.1.1.1.3.3.3.3.cmml" xref="S3.E11.m1.1.1.1.3.3.3.3">𝑆</ci><ci id="S3.E11.m1.1.1.1.3.3.3.4.cmml" xref="S3.E11.m1.1.1.1.3.3.3.4">𝐼</ci><ci id="S3.E11.m1.1.1.1.3.3.3.5.cmml" xref="S3.E11.m1.1.1.1.3.3.3.5">𝑀</ci></apply></apply></apply><apply id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1"><times id="S3.E11.m1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2"></times><apply id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><minus id="S3.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E11.m1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.2">𝐿</ci><cn type="integer" id="S3.E11.m1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">L_{FQ}=\alpha L_{SSIM}+(1-\alpha)L_{1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p12.1" class="ltx_p">we empirically set <math id="S3.SS2.p12.1.m1.1" class="ltx_Math" alttext="\alpha=0.84" display="inline"><semantics id="S3.SS2.p12.1.m1.1a"><mrow id="S3.SS2.p12.1.m1.1.1" xref="S3.SS2.p12.1.m1.1.1.cmml"><mi id="S3.SS2.p12.1.m1.1.1.2" xref="S3.SS2.p12.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS2.p12.1.m1.1.1.1" xref="S3.SS2.p12.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p12.1.m1.1.1.3" xref="S3.SS2.p12.1.m1.1.1.3.cmml">0.84</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.1.m1.1b"><apply id="S3.SS2.p12.1.m1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1"><eq id="S3.SS2.p12.1.m1.1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1.1"></eq><ci id="S3.SS2.p12.1.m1.1.1.2.cmml" xref="S3.SS2.p12.1.m1.1.1.2">𝛼</ci><cn type="float" id="S3.SS2.p12.1.m1.1.1.3.cmml" xref="S3.SS2.p12.1.m1.1.1.3">0.84</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.1.m1.1c">\alpha=0.84</annotation></semantics></math>, as suggested by prior work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.8.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.9.2" class="ltx_text ltx_font_italic">Average Intensity Ratio Enhancement</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">After incorporating SSIM loss into the reconstruction assessment metrics, the error is no longer uniformly weighted regardless of the local structure as it is with <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\ell_{1}</annotation></semantics></math> loss. Instead, the relationships between regions become more significant.
This shift means that the characteristics of a dataset can significantly influence anomaly detection performance.
Moreover, since the new loss function introduces divisive metrics from SSIM, it becomes important to amplify the divisive discrepancies between anomalies and normal regions.
Therefore, we propose that an appropriate image processing strategy is necessary to optimize the anomaly detection performance under this new loss function.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">We define the average intensity ratio (AIR) between the anomalous and normal regions in an abnormal dataset <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">X</annotation></semantics></math> as:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.7" class="ltx_Math" alttext="AIR(X)=\frac{\max(\mu^{a}_{X},\mu^{n}_{x})}{\min(\mu^{a}_{X},\mu^{n}_{X})}" display="block"><semantics id="S3.E12.m1.7a"><mrow id="S3.E12.m1.7.8" xref="S3.E12.m1.7.8.cmml"><mrow id="S3.E12.m1.7.8.2" xref="S3.E12.m1.7.8.2.cmml"><mi id="S3.E12.m1.7.8.2.2" xref="S3.E12.m1.7.8.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.8.2.1" xref="S3.E12.m1.7.8.2.1.cmml">​</mo><mi id="S3.E12.m1.7.8.2.3" xref="S3.E12.m1.7.8.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.8.2.1a" xref="S3.E12.m1.7.8.2.1.cmml">​</mo><mi id="S3.E12.m1.7.8.2.4" xref="S3.E12.m1.7.8.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.8.2.1b" xref="S3.E12.m1.7.8.2.1.cmml">​</mo><mrow id="S3.E12.m1.7.8.2.5.2" xref="S3.E12.m1.7.8.2.cmml"><mo stretchy="false" id="S3.E12.m1.7.8.2.5.2.1" xref="S3.E12.m1.7.8.2.cmml">(</mo><mi id="S3.E12.m1.7.7" xref="S3.E12.m1.7.7.cmml">X</mi><mo stretchy="false" id="S3.E12.m1.7.8.2.5.2.2" xref="S3.E12.m1.7.8.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.7.8.1" xref="S3.E12.m1.7.8.1.cmml">=</mo><mfrac id="S3.E12.m1.6.6" xref="S3.E12.m1.6.6.cmml"><mrow id="S3.E12.m1.3.3.3.3" xref="S3.E12.m1.3.3.3.4.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">max</mi><mo id="S3.E12.m1.3.3.3.3a" xref="S3.E12.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E12.m1.3.3.3.3.2" xref="S3.E12.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.3.3.2.3" xref="S3.E12.m1.3.3.3.4.cmml">(</mo><msubsup id="S3.E12.m1.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.1.1.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.cmml">μ</mi><mi id="S3.E12.m1.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.3.cmml">X</mi><mi id="S3.E12.m1.2.2.2.2.1.1.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E12.m1.3.3.3.3.2.4" xref="S3.E12.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E12.m1.3.3.3.3.2.2" xref="S3.E12.m1.3.3.3.3.2.2.cmml"><mi id="S3.E12.m1.3.3.3.3.2.2.2.2" xref="S3.E12.m1.3.3.3.3.2.2.2.2.cmml">μ</mi><mi id="S3.E12.m1.3.3.3.3.2.2.3" xref="S3.E12.m1.3.3.3.3.2.2.3.cmml">x</mi><mi id="S3.E12.m1.3.3.3.3.2.2.2.3" xref="S3.E12.m1.3.3.3.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E12.m1.3.3.3.3.2.5" xref="S3.E12.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E12.m1.6.6.6.3" xref="S3.E12.m1.6.6.6.4.cmml"><mi id="S3.E12.m1.4.4.4.1" xref="S3.E12.m1.4.4.4.1.cmml">min</mi><mo id="S3.E12.m1.6.6.6.3a" xref="S3.E12.m1.6.6.6.4.cmml">⁡</mo><mrow id="S3.E12.m1.6.6.6.3.2" xref="S3.E12.m1.6.6.6.4.cmml"><mo stretchy="false" id="S3.E12.m1.6.6.6.3.2.3" xref="S3.E12.m1.6.6.6.4.cmml">(</mo><msubsup id="S3.E12.m1.5.5.5.2.1.1" xref="S3.E12.m1.5.5.5.2.1.1.cmml"><mi id="S3.E12.m1.5.5.5.2.1.1.2.2" xref="S3.E12.m1.5.5.5.2.1.1.2.2.cmml">μ</mi><mi id="S3.E12.m1.5.5.5.2.1.1.3" xref="S3.E12.m1.5.5.5.2.1.1.3.cmml">X</mi><mi id="S3.E12.m1.5.5.5.2.1.1.2.3" xref="S3.E12.m1.5.5.5.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E12.m1.6.6.6.3.2.4" xref="S3.E12.m1.6.6.6.4.cmml">,</mo><msubsup id="S3.E12.m1.6.6.6.3.2.2" xref="S3.E12.m1.6.6.6.3.2.2.cmml"><mi id="S3.E12.m1.6.6.6.3.2.2.2.2" xref="S3.E12.m1.6.6.6.3.2.2.2.2.cmml">μ</mi><mi id="S3.E12.m1.6.6.6.3.2.2.3" xref="S3.E12.m1.6.6.6.3.2.2.3.cmml">X</mi><mi id="S3.E12.m1.6.6.6.3.2.2.2.3" xref="S3.E12.m1.6.6.6.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E12.m1.6.6.6.3.2.5" xref="S3.E12.m1.6.6.6.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.7b"><apply id="S3.E12.m1.7.8.cmml" xref="S3.E12.m1.7.8"><eq id="S3.E12.m1.7.8.1.cmml" xref="S3.E12.m1.7.8.1"></eq><apply id="S3.E12.m1.7.8.2.cmml" xref="S3.E12.m1.7.8.2"><times id="S3.E12.m1.7.8.2.1.cmml" xref="S3.E12.m1.7.8.2.1"></times><ci id="S3.E12.m1.7.8.2.2.cmml" xref="S3.E12.m1.7.8.2.2">𝐴</ci><ci id="S3.E12.m1.7.8.2.3.cmml" xref="S3.E12.m1.7.8.2.3">𝐼</ci><ci id="S3.E12.m1.7.8.2.4.cmml" xref="S3.E12.m1.7.8.2.4">𝑅</ci><ci id="S3.E12.m1.7.7.cmml" xref="S3.E12.m1.7.7">𝑋</ci></apply><apply id="S3.E12.m1.6.6.cmml" xref="S3.E12.m1.6.6"><divide id="S3.E12.m1.6.6.7.cmml" xref="S3.E12.m1.6.6"></divide><apply id="S3.E12.m1.3.3.3.4.cmml" xref="S3.E12.m1.3.3.3.3"><max id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1"></max><apply id="S3.E12.m1.2.2.2.2.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E12.m1.2.2.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2">𝜇</ci><ci id="S3.E12.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.3">𝑎</ci></apply><ci id="S3.E12.m1.2.2.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.3">𝑋</ci></apply><apply id="S3.E12.m1.3.3.3.3.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.2">subscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.2.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.2">superscript</csymbol><ci id="S3.E12.m1.3.3.3.3.2.2.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.2.2.2">𝜇</ci><ci id="S3.E12.m1.3.3.3.3.2.2.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E12.m1.3.3.3.3.2.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.2.3">𝑥</ci></apply></apply><apply id="S3.E12.m1.6.6.6.4.cmml" xref="S3.E12.m1.6.6.6.3"><min id="S3.E12.m1.4.4.4.1.cmml" xref="S3.E12.m1.4.4.4.1"></min><apply id="S3.E12.m1.5.5.5.2.1.1.cmml" xref="S3.E12.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.2.1.1.1.cmml" xref="S3.E12.m1.5.5.5.2.1.1">subscript</csymbol><apply id="S3.E12.m1.5.5.5.2.1.1.2.cmml" xref="S3.E12.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.2.1.1.2.1.cmml" xref="S3.E12.m1.5.5.5.2.1.1">superscript</csymbol><ci id="S3.E12.m1.5.5.5.2.1.1.2.2.cmml" xref="S3.E12.m1.5.5.5.2.1.1.2.2">𝜇</ci><ci id="S3.E12.m1.5.5.5.2.1.1.2.3.cmml" xref="S3.E12.m1.5.5.5.2.1.1.2.3">𝑎</ci></apply><ci id="S3.E12.m1.5.5.5.2.1.1.3.cmml" xref="S3.E12.m1.5.5.5.2.1.1.3">𝑋</ci></apply><apply id="S3.E12.m1.6.6.6.3.2.2.cmml" xref="S3.E12.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.6.6.6.3.2.2.1.cmml" xref="S3.E12.m1.6.6.6.3.2.2">subscript</csymbol><apply id="S3.E12.m1.6.6.6.3.2.2.2.cmml" xref="S3.E12.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.6.6.6.3.2.2.2.1.cmml" xref="S3.E12.m1.6.6.6.3.2.2">superscript</csymbol><ci id="S3.E12.m1.6.6.6.3.2.2.2.2.cmml" xref="S3.E12.m1.6.6.6.3.2.2.2.2">𝜇</ci><ci id="S3.E12.m1.6.6.6.3.2.2.2.3.cmml" xref="S3.E12.m1.6.6.6.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E12.m1.6.6.6.3.2.2.3.cmml" xref="S3.E12.m1.6.6.6.3.2.2.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.7c">AIR(X)=\frac{\max(\mu^{a}_{X},\mu^{n}_{x})}{\min(\mu^{a}_{X},\mu^{n}_{X})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.3" class="ltx_p">where <math id="S3.SS3.p2.2.m1.1" class="ltx_Math" alttext="\mu^{a}_{X}" display="inline"><semantics id="S3.SS3.p2.2.m1.1a"><msubsup id="S3.SS3.p2.2.m1.1.1" xref="S3.SS3.p2.2.m1.1.1.cmml"><mi id="S3.SS3.p2.2.m1.1.1.2.2" xref="S3.SS3.p2.2.m1.1.1.2.2.cmml">μ</mi><mi id="S3.SS3.p2.2.m1.1.1.3" xref="S3.SS3.p2.2.m1.1.1.3.cmml">X</mi><mi id="S3.SS3.p2.2.m1.1.1.2.3" xref="S3.SS3.p2.2.m1.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.1b"><apply id="S3.SS3.p2.2.m1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1">subscript</csymbol><apply id="S3.SS3.p2.2.m1.1.1.2.cmml" xref="S3.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m1.1.1.2.2">𝜇</ci><ci id="S3.SS3.p2.2.m1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m1.1.1.2.3">𝑎</ci></apply><ci id="S3.SS3.p2.2.m1.1.1.3.cmml" xref="S3.SS3.p2.2.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.1c">\mu^{a}_{X}</annotation></semantics></math> and <math id="S3.SS3.p2.3.m2.1" class="ltx_Math" alttext="\mu^{n}_{X}" display="inline"><semantics id="S3.SS3.p2.3.m2.1a"><msubsup id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml"><mi id="S3.SS3.p2.3.m2.1.1.2.2" xref="S3.SS3.p2.3.m2.1.1.2.2.cmml">μ</mi><mi id="S3.SS3.p2.3.m2.1.1.3" xref="S3.SS3.p2.3.m2.1.1.3.cmml">X</mi><mi id="S3.SS3.p2.3.m2.1.1.2.3" xref="S3.SS3.p2.3.m2.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><apply id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m2.1.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">subscript</csymbol><apply id="S3.SS3.p2.3.m2.1.1.2.cmml" xref="S3.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m2.1.1.2.1.cmml" xref="S3.SS3.p2.3.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.3.m2.1.1.2.2.cmml" xref="S3.SS3.p2.3.m2.1.1.2.2">𝜇</ci><ci id="S3.SS3.p2.3.m2.1.1.2.3.cmml" xref="S3.SS3.p2.3.m2.1.1.2.3">𝑛</ci></apply><ci id="S3.SS3.p2.3.m2.1.1.3.cmml" xref="S3.SS3.p2.3.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">\mu^{n}_{X}</annotation></semantics></math> are the mean values of the anomaly and the normal region, respectively.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">Based on the principles of reconstruction-based anomaly detection sketeched in Section <a href="#S3.SS1.SSS1" title="III-A1 Reconstruction-based anomaly detection ‣ III-A Anomaly detection with pDDPM ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-A</span>1</span></a>, we hypothesize that a higher AIR is important for better anomaly detection performance, mainly for two reasons: 1) A higher AIR suggests a larger discrepancy between the training normal data and the anomalies in the test data, resulting in greater reconstruction errors in the anomalous regions. 2) Since the model aims to reconstruct the normal brain from the noisy anomalies and calculate the difference between the reconstruction and the anomaly as the anomaly score, a higher MIC naturally leads to higher reconstruction errors during evaluation.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.2" class="ltx_p">During evaluation, existing baselines usually use a validation set <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="X_{val}\subset X_{a}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><msub id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2.2" xref="S3.SS3.p4.1.m1.1.1.2.2.cmml">X</mi><mrow id="S3.SS3.p4.1.m1.1.1.2.3" xref="S3.SS3.p4.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2.3.2" xref="S3.SS3.p4.1.m1.1.1.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.2.3.1" xref="S3.SS3.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.2.3.3" xref="S3.SS3.p4.1.m1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.2.3.1a" xref="S3.SS3.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.2.3.4" xref="S3.SS3.p4.1.m1.1.1.2.3.4.cmml">l</mi></mrow></msub><mo id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">⊂</mo><msub id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">X</mi><mi id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><subset id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></subset><apply id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2.2">𝑋</ci><apply id="S3.SS3.p4.1.m1.1.1.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3"><times id="S3.SS3.p4.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3.2">𝑣</ci><ci id="S3.SS3.p4.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.p4.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3.4">𝑙</ci></apply></apply><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝑋</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">X_{val}\subset X_{a}</annotation></semantics></math> and the corresponding ground truth <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="Y_{val}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">Y</mi><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1a" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.4" xref="S3.SS3.p4.2.m2.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝑌</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><times id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑣</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS3.p4.2.m2.1.1.3.4.cmml" xref="S3.SS3.p4.2.m2.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">Y_{val}</annotation></semantics></math> to determine hyper-parameters, such as the threshold for binarization.
Therefore, it is feasible to perform dataset statistics-based pre-processing operations before training to increase MIC and enhance anomaly detection performance.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.3" class="ltx_p">In the context of MRI brain anomaly detection, we analyze three modalities from the BraTS21 dataset and find a simple yet effective way that consistently increases the Average Intensity Ratio (AIR) across all datasets used in this paper. Our strategy is based on the following prior statistics calculated on the unhealthy validation set:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="0&lt;\mu_{X}^{n}&lt;\mu_{X}^{a}&lt;1" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mn id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">0</mn><mo id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml">&lt;</mo><msubsup id="S3.I1.i1.p1.1.m1.1.1.4" xref="S3.I1.i1.p1.1.m1.1.1.4.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.4.2.2" xref="S3.I1.i1.p1.1.m1.1.1.4.2.2.cmml">μ</mi><mi id="S3.I1.i1.p1.1.m1.1.1.4.2.3" xref="S3.I1.i1.p1.1.m1.1.1.4.2.3.cmml">X</mi><mi id="S3.I1.i1.p1.1.m1.1.1.4.3" xref="S3.I1.i1.p1.1.m1.1.1.4.3.cmml">n</mi></msubsup><mo id="S3.I1.i1.p1.1.m1.1.1.5" xref="S3.I1.i1.p1.1.m1.1.1.5.cmml">&lt;</mo><msubsup id="S3.I1.i1.p1.1.m1.1.1.6" xref="S3.I1.i1.p1.1.m1.1.1.6.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.6.2.2" xref="S3.I1.i1.p1.1.m1.1.1.6.2.2.cmml">μ</mi><mi id="S3.I1.i1.p1.1.m1.1.1.6.2.3" xref="S3.I1.i1.p1.1.m1.1.1.6.2.3.cmml">X</mi><mi id="S3.I1.i1.p1.1.m1.1.1.6.3" xref="S3.I1.i1.p1.1.m1.1.1.6.3.cmml">a</mi></msubsup><mo id="S3.I1.i1.p1.1.m1.1.1.7" xref="S3.I1.i1.p1.1.m1.1.1.7.cmml">&lt;</mo><mn id="S3.I1.i1.p1.1.m1.1.1.8" xref="S3.I1.i1.p1.1.m1.1.1.8.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><and id="S3.I1.i1.p1.1.m1.1.1a.cmml" xref="S3.I1.i1.p1.1.m1.1.1"></and><apply id="S3.I1.i1.p1.1.m1.1.1b.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><lt id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"></lt><cn type="integer" id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2">0</cn><apply id="S3.I1.i1.p1.1.m1.1.1.4.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.4.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4">superscript</csymbol><apply id="S3.I1.i1.p1.1.m1.1.1.4.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.4.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.4.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4.2.2">𝜇</ci><ci id="S3.I1.i1.p1.1.m1.1.1.4.2.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4.2.3">𝑋</ci></apply><ci id="S3.I1.i1.p1.1.m1.1.1.4.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4.3">𝑛</ci></apply></apply><apply id="S3.I1.i1.p1.1.m1.1.1c.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><lt id="S3.I1.i1.p1.1.m1.1.1.5.cmml" xref="S3.I1.i1.p1.1.m1.1.1.5"></lt><share href="#S3.I1.i1.p1.1.m1.1.1.4.cmml" id="S3.I1.i1.p1.1.m1.1.1d.cmml" xref="S3.I1.i1.p1.1.m1.1.1"></share><apply id="S3.I1.i1.p1.1.m1.1.1.6.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.6.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6">superscript</csymbol><apply id="S3.I1.i1.p1.1.m1.1.1.6.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.6.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.6.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6.2.2">𝜇</ci><ci id="S3.I1.i1.p1.1.m1.1.1.6.2.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6.2.3">𝑋</ci></apply><ci id="S3.I1.i1.p1.1.m1.1.1.6.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6.3">𝑎</ci></apply></apply><apply id="S3.I1.i1.p1.1.m1.1.1e.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><lt id="S3.I1.i1.p1.1.m1.1.1.7.cmml" xref="S3.I1.i1.p1.1.m1.1.1.7"></lt><share href="#S3.I1.i1.p1.1.m1.1.1.6.cmml" id="S3.I1.i1.p1.1.m1.1.1f.cmml" xref="S3.I1.i1.p1.1.m1.1.1"></share><cn type="integer" id="S3.I1.i1.p1.1.m1.1.1.8.cmml" xref="S3.I1.i1.p1.1.m1.1.1.8">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">0&lt;\mu_{X}^{n}&lt;\mu_{X}^{a}&lt;1</annotation></semantics></math> for all three modalities.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mu_{X}^{n}&gt;0.5" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><msubsup id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2.2.2" xref="S3.I1.i2.p1.1.m1.1.1.2.2.2.cmml">μ</mi><mi id="S3.I1.i2.p1.1.m1.1.1.2.2.3" xref="S3.I1.i2.p1.1.m1.1.1.2.2.3.cmml">X</mi><mi id="S3.I1.i2.p1.1.m1.1.1.2.3" xref="S3.I1.i2.p1.1.m1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.I1.i2.p1.1.m1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><gt id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1"></gt><apply id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">superscript</csymbol><apply id="S3.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2.2">𝜇</ci><ci id="S3.I1.i2.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2.3">𝑋</ci></apply><ci id="S3.I1.i2.p1.1.m1.1.1.2.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.3">𝑛</ci></apply><cn type="float" id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\mu_{X}^{n}&gt;0.5</annotation></semantics></math> for FLAIR and T1-CE.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\mu_{X}^{a}&lt;0.5" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><mrow id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><msubsup id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2.2.2" xref="S3.I1.i3.p1.1.m1.1.1.2.2.2.cmml">μ</mi><mi id="S3.I1.i3.p1.1.m1.1.1.2.2.3" xref="S3.I1.i3.p1.1.m1.1.1.2.2.3.cmml">X</mi><mi id="S3.I1.i3.p1.1.m1.1.1.2.3" xref="S3.I1.i3.p1.1.m1.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.I1.i3.p1.1.m1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><lt id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1"></lt><apply id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">superscript</csymbol><apply id="S3.I1.i3.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2.2.2">𝜇</ci><ci id="S3.I1.i3.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2.2.3">𝑋</ci></apply><ci id="S3.I1.i3.p1.1.m1.1.1.2.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2.3">𝑎</ci></apply><cn type="float" id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">\mu_{X}^{a}&lt;0.5</annotation></semantics></math> for T2.</p>
</div>
</li>
</ol>
<p id="S3.SS3.p5.1" class="ltx_p">Our pre-processing strategy for an image <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">x</annotation></semantics></math> is then defined as:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.4" class="ltx_Math" alttext="p(x)=x\cdot\mathbb{I}(u_{X}^{n}\leq 0.5)+(1-x)\cdot\mathbb{I}(0.5&lt;u_{X}^{n})" display="block"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4.4" xref="S3.E13.m1.4.4.cmml"><mrow id="S3.E13.m1.4.4.5" xref="S3.E13.m1.4.4.5.cmml"><mi id="S3.E13.m1.4.4.5.2" xref="S3.E13.m1.4.4.5.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.5.1" xref="S3.E13.m1.4.4.5.1.cmml">​</mo><mrow id="S3.E13.m1.4.4.5.3.2" xref="S3.E13.m1.4.4.5.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.5.3.2.1" xref="S3.E13.m1.4.4.5.cmml">(</mo><mi id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E13.m1.4.4.5.3.2.2" xref="S3.E13.m1.4.4.5.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.4" xref="S3.E13.m1.4.4.4.cmml">=</mo><mrow id="S3.E13.m1.4.4.3" xref="S3.E13.m1.4.4.3.cmml"><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.3.2" xref="S3.E13.m1.2.2.1.1.3.2.cmml">x</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E13.m1.2.2.1.1.3.1" xref="S3.E13.m1.2.2.1.1.3.1.cmml">⋅</mo><mi id="S3.E13.m1.2.2.1.1.3.3" xref="S3.E13.m1.2.2.1.1.3.3.cmml">𝕀</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.2.cmml">​</mo><mrow id="S3.E13.m1.2.2.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.cmml"><msubsup id="S3.E13.m1.2.2.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E13.m1.2.2.1.1.1.1.1.2.2.2.cmml">u</mi><mi id="S3.E13.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.E13.m1.2.2.1.1.1.1.1.2.2.3.cmml">X</mi><mi id="S3.E13.m1.2.2.1.1.1.1.1.2.3" xref="S3.E13.m1.2.2.1.1.1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.E13.m1.2.2.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.cmml">≤</mo><mn id="S3.E13.m1.2.2.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.3.cmml">0.5</mn></mrow><mo stretchy="false" id="S3.E13.m1.2.2.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.3.4" xref="S3.E13.m1.4.4.3.4.cmml">+</mo><mrow id="S3.E13.m1.4.4.3.3" xref="S3.E13.m1.4.4.3.3.cmml"><mrow id="S3.E13.m1.3.3.2.2.1" xref="S3.E13.m1.3.3.2.2.1.cmml"><mrow id="S3.E13.m1.3.3.2.2.1.1.1" xref="S3.E13.m1.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.3.3.2.2.1.1.1.2" xref="S3.E13.m1.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.3.3.2.2.1.1.1.1" xref="S3.E13.m1.3.3.2.2.1.1.1.1.cmml"><mn id="S3.E13.m1.3.3.2.2.1.1.1.1.2" xref="S3.E13.m1.3.3.2.2.1.1.1.1.2.cmml">1</mn><mo id="S3.E13.m1.3.3.2.2.1.1.1.1.1" xref="S3.E13.m1.3.3.2.2.1.1.1.1.1.cmml">−</mo><mi id="S3.E13.m1.3.3.2.2.1.1.1.1.3" xref="S3.E13.m1.3.3.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E13.m1.3.3.2.2.1.1.1.3" xref="S3.E13.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E13.m1.3.3.2.2.1.2" xref="S3.E13.m1.3.3.2.2.1.2.cmml">⋅</mo><mi id="S3.E13.m1.3.3.2.2.1.3" xref="S3.E13.m1.3.3.2.2.1.3.cmml">𝕀</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.3.3.3" xref="S3.E13.m1.4.4.3.3.3.cmml">​</mo><mrow id="S3.E13.m1.4.4.3.3.2.1" xref="S3.E13.m1.4.4.3.3.2.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.3.3.2.1.2" xref="S3.E13.m1.4.4.3.3.2.1.1.cmml">(</mo><mrow id="S3.E13.m1.4.4.3.3.2.1.1" xref="S3.E13.m1.4.4.3.3.2.1.1.cmml"><mn id="S3.E13.m1.4.4.3.3.2.1.1.2" xref="S3.E13.m1.4.4.3.3.2.1.1.2.cmml">0.5</mn><mo id="S3.E13.m1.4.4.3.3.2.1.1.1" xref="S3.E13.m1.4.4.3.3.2.1.1.1.cmml">&lt;</mo><msubsup id="S3.E13.m1.4.4.3.3.2.1.1.3" xref="S3.E13.m1.4.4.3.3.2.1.1.3.cmml"><mi id="S3.E13.m1.4.4.3.3.2.1.1.3.2.2" xref="S3.E13.m1.4.4.3.3.2.1.1.3.2.2.cmml">u</mi><mi id="S3.E13.m1.4.4.3.3.2.1.1.3.2.3" xref="S3.E13.m1.4.4.3.3.2.1.1.3.2.3.cmml">X</mi><mi id="S3.E13.m1.4.4.3.3.2.1.1.3.3" xref="S3.E13.m1.4.4.3.3.2.1.1.3.3.cmml">n</mi></msubsup></mrow><mo stretchy="false" id="S3.E13.m1.4.4.3.3.2.1.3" xref="S3.E13.m1.4.4.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.4b"><apply id="S3.E13.m1.4.4.cmml" xref="S3.E13.m1.4.4"><eq id="S3.E13.m1.4.4.4.cmml" xref="S3.E13.m1.4.4.4"></eq><apply id="S3.E13.m1.4.4.5.cmml" xref="S3.E13.m1.4.4.5"><times id="S3.E13.m1.4.4.5.1.cmml" xref="S3.E13.m1.4.4.5.1"></times><ci id="S3.E13.m1.4.4.5.2.cmml" xref="S3.E13.m1.4.4.5.2">𝑝</ci><ci id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1">𝑥</ci></apply><apply id="S3.E13.m1.4.4.3.cmml" xref="S3.E13.m1.4.4.3"><plus id="S3.E13.m1.4.4.3.4.cmml" xref="S3.E13.m1.4.4.3.4"></plus><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1.1"><times id="S3.E13.m1.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2"></times><apply id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3"><ci id="S3.E13.m1.2.2.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.1">⋅</ci><ci id="S3.E13.m1.2.2.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2">𝑥</ci><ci id="S3.E13.m1.2.2.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.3.3">𝕀</ci></apply><apply id="S3.E13.m1.2.2.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1"><leq id="S3.E13.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1"></leq><apply id="S3.E13.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E13.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2.2.2">𝑢</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2.2.3">𝑋</ci></apply><ci id="S3.E13.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2.3">𝑛</ci></apply><cn type="float" id="S3.E13.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3">0.5</cn></apply></apply><apply id="S3.E13.m1.4.4.3.3.cmml" xref="S3.E13.m1.4.4.3.3"><times id="S3.E13.m1.4.4.3.3.3.cmml" xref="S3.E13.m1.4.4.3.3.3"></times><apply id="S3.E13.m1.3.3.2.2.1.cmml" xref="S3.E13.m1.3.3.2.2.1"><ci id="S3.E13.m1.3.3.2.2.1.2.cmml" xref="S3.E13.m1.3.3.2.2.1.2">⋅</ci><apply id="S3.E13.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E13.m1.3.3.2.2.1.1.1"><minus id="S3.E13.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S3.E13.m1.3.3.2.2.1.1.1.1.1"></minus><cn type="integer" id="S3.E13.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E13.m1.3.3.2.2.1.1.1.1.2">1</cn><ci id="S3.E13.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E13.m1.3.3.2.2.1.1.1.1.3">𝑥</ci></apply><ci id="S3.E13.m1.3.3.2.2.1.3.cmml" xref="S3.E13.m1.3.3.2.2.1.3">𝕀</ci></apply><apply id="S3.E13.m1.4.4.3.3.2.1.1.cmml" xref="S3.E13.m1.4.4.3.3.2.1"><lt id="S3.E13.m1.4.4.3.3.2.1.1.1.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.1"></lt><cn type="float" id="S3.E13.m1.4.4.3.3.2.1.1.2.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.2">0.5</cn><apply id="S3.E13.m1.4.4.3.3.2.1.1.3.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.3.3.2.1.1.3.1.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3">superscript</csymbol><apply id="S3.E13.m1.4.4.3.3.2.1.1.3.2.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.3.3.2.1.1.3.2.1.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3">subscript</csymbol><ci id="S3.E13.m1.4.4.3.3.2.1.1.3.2.2.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3.2.2">𝑢</ci><ci id="S3.E13.m1.4.4.3.3.2.1.1.3.2.3.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3.2.3">𝑋</ci></apply><ci id="S3.E13.m1.4.4.3.3.2.1.1.3.3.cmml" xref="S3.E13.m1.4.4.3.3.2.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.4c">p(x)=x\cdot\mathbb{I}(u_{X}^{n}\leq 0.5)+(1-x)\cdot\mathbb{I}(0.5&lt;u_{X}^{n})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.2" class="ltx_p">where <math id="S3.SS3.p5.2.m1.1" class="ltx_Math" alttext="\mathbb{I}" display="inline"><semantics id="S3.SS3.p5.2.m1.1a"><mi id="S3.SS3.p5.2.m1.1.1" xref="S3.SS3.p5.2.m1.1.1.cmml">𝕀</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m1.1b"><ci id="S3.SS3.p5.2.m1.1.1.cmml" xref="S3.SS3.p5.2.m1.1.1">𝕀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m1.1c">\mathbb{I}</annotation></semantics></math> is an indicator function that returns 1 if the condition inside is true and 0 otherwise.
Note that in our experiments, the processing is applied only to the non-zero foreground. We omit this detail here for simplicity in writing.
We prove the correctness of our strategy below:</p>
</div>
<div id="S3.SS3.3" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS3.1.p1" class="ltx_para">
<p id="S3.SS3.1.p1.2" class="ltx_p">For FLAIR and T1-CE modality of BraTS21, the prior statistics are:</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.1" class="ltx_Math" alttext="0.5&lt;\mu_{X}^{n}&lt;\mu_{X}^{a}&lt;1" display="block"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><mn id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">0.5</mn><mo id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml">&lt;</mo><msubsup id="S3.E14.m1.1.1.4" xref="S3.E14.m1.1.1.4.cmml"><mi id="S3.E14.m1.1.1.4.2.2" xref="S3.E14.m1.1.1.4.2.2.cmml">μ</mi><mi id="S3.E14.m1.1.1.4.2.3" xref="S3.E14.m1.1.1.4.2.3.cmml">X</mi><mi id="S3.E14.m1.1.1.4.3" xref="S3.E14.m1.1.1.4.3.cmml">n</mi></msubsup><mo id="S3.E14.m1.1.1.5" xref="S3.E14.m1.1.1.5.cmml">&lt;</mo><msubsup id="S3.E14.m1.1.1.6" xref="S3.E14.m1.1.1.6.cmml"><mi id="S3.E14.m1.1.1.6.2.2" xref="S3.E14.m1.1.1.6.2.2.cmml">μ</mi><mi id="S3.E14.m1.1.1.6.2.3" xref="S3.E14.m1.1.1.6.2.3.cmml">X</mi><mi id="S3.E14.m1.1.1.6.3" xref="S3.E14.m1.1.1.6.3.cmml">a</mi></msubsup><mo id="S3.E14.m1.1.1.7" xref="S3.E14.m1.1.1.7.cmml">&lt;</mo><mn id="S3.E14.m1.1.1.8" xref="S3.E14.m1.1.1.8.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><and id="S3.E14.m1.1.1a.cmml" xref="S3.E14.m1.1.1"></and><apply id="S3.E14.m1.1.1b.cmml" xref="S3.E14.m1.1.1"><lt id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3"></lt><cn type="float" id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2">0.5</cn><apply id="S3.E14.m1.1.1.4.cmml" xref="S3.E14.m1.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.4.1.cmml" xref="S3.E14.m1.1.1.4">superscript</csymbol><apply id="S3.E14.m1.1.1.4.2.cmml" xref="S3.E14.m1.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.4.2.1.cmml" xref="S3.E14.m1.1.1.4">subscript</csymbol><ci id="S3.E14.m1.1.1.4.2.2.cmml" xref="S3.E14.m1.1.1.4.2.2">𝜇</ci><ci id="S3.E14.m1.1.1.4.2.3.cmml" xref="S3.E14.m1.1.1.4.2.3">𝑋</ci></apply><ci id="S3.E14.m1.1.1.4.3.cmml" xref="S3.E14.m1.1.1.4.3">𝑛</ci></apply></apply><apply id="S3.E14.m1.1.1c.cmml" xref="S3.E14.m1.1.1"><lt id="S3.E14.m1.1.1.5.cmml" xref="S3.E14.m1.1.1.5"></lt><share href="#S3.E14.m1.1.1.4.cmml" id="S3.E14.m1.1.1d.cmml" xref="S3.E14.m1.1.1"></share><apply id="S3.E14.m1.1.1.6.cmml" xref="S3.E14.m1.1.1.6"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.6.1.cmml" xref="S3.E14.m1.1.1.6">superscript</csymbol><apply id="S3.E14.m1.1.1.6.2.cmml" xref="S3.E14.m1.1.1.6"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.6.2.1.cmml" xref="S3.E14.m1.1.1.6">subscript</csymbol><ci id="S3.E14.m1.1.1.6.2.2.cmml" xref="S3.E14.m1.1.1.6.2.2">𝜇</ci><ci id="S3.E14.m1.1.1.6.2.3.cmml" xref="S3.E14.m1.1.1.6.2.3">𝑋</ci></apply><ci id="S3.E14.m1.1.1.6.3.cmml" xref="S3.E14.m1.1.1.6.3">𝑎</ci></apply></apply><apply id="S3.E14.m1.1.1e.cmml" xref="S3.E14.m1.1.1"><lt id="S3.E14.m1.1.1.7.cmml" xref="S3.E14.m1.1.1.7"></lt><share href="#S3.E14.m1.1.1.6.cmml" id="S3.E14.m1.1.1f.cmml" xref="S3.E14.m1.1.1"></share><cn type="integer" id="S3.E14.m1.1.1.8.cmml" xref="S3.E14.m1.1.1.8">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">0.5&lt;\mu_{X}^{n}&lt;\mu_{X}^{a}&lt;1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.1.p1.3" class="ltx_p">Thus, the pre-processing strategy should be:</p>
<table id="S3.E15" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E15X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle p(x)" display="inline"><semantics id="S3.E15X.2.1.1.m1.1a"><mrow id="S3.E15X.2.1.1.m1.1.2" xref="S3.E15X.2.1.1.m1.1.2.cmml"><mi id="S3.E15X.2.1.1.m1.1.2.2" xref="S3.E15X.2.1.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E15X.2.1.1.m1.1.2.1" xref="S3.E15X.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.E15X.2.1.1.m1.1.2.3.2" xref="S3.E15X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E15X.2.1.1.m1.1.2.3.2.1" xref="S3.E15X.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E15X.2.1.1.m1.1.1" xref="S3.E15X.2.1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E15X.2.1.1.m1.1.2.3.2.2" xref="S3.E15X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.2.1.1.m1.1b"><apply id="S3.E15X.2.1.1.m1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.2"><times id="S3.E15X.2.1.1.m1.1.2.1.cmml" xref="S3.E15X.2.1.1.m1.1.2.1"></times><ci id="S3.E15X.2.1.1.m1.1.2.2.cmml" xref="S3.E15X.2.1.1.m1.1.2.2">𝑝</ci><ci id="S3.E15X.2.1.1.m1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.2.1.1.m1.1c">\displaystyle p(x)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=x\cdot 0+(1-x)\cdot 1" display="inline"><semantics id="S3.E15X.3.2.2.m1.1a"><mrow id="S3.E15X.3.2.2.m1.1.1" xref="S3.E15X.3.2.2.m1.1.1.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E15X.3.2.2.m1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E15X.3.2.2.m1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E15X.3.2.2.m1.1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.1.3.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.1.3.2" xref="S3.E15X.3.2.2.m1.1.1.1.3.2.cmml">x</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E15X.3.2.2.m1.1.1.1.3.1" xref="S3.E15X.3.2.2.m1.1.1.1.3.1.cmml">⋅</mo><mn id="S3.E15X.3.2.2.m1.1.1.1.3.3" xref="S3.E15X.3.2.2.m1.1.1.1.3.3.cmml">0</mn></mrow><mo id="S3.E15X.3.2.2.m1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E15X.3.2.2.m1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E15X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E15X.3.2.2.m1.1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.2.cmml">⋅</mo><mn id="S3.E15X.3.2.2.m1.1.1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.3.2.2.m1.1b"><apply id="S3.E15X.3.2.2.m1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1"><eq id="S3.E15X.3.2.2.m1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E15X.3.2.2.m1.1.1.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E15X.3.2.2.m1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1"><plus id="S3.E15X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.2"></plus><apply id="S3.E15X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.3"><ci id="S3.E15X.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.3.1">⋅</ci><ci id="S3.E15X.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.3.2">𝑥</ci><cn type="integer" id="S3.E15X.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.3.3">0</cn></apply><apply id="S3.E15X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1"><ci id="S3.E15X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.2">⋅</ci><apply id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1"><minus id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply><cn type="integer" id="S3.E15X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.3.2.2.m1.1c">\displaystyle=x\cdot 0+(1-x)\cdot 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
<tr id="S3.E15Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=1-x" display="inline"><semantics id="S3.E15Xa.2.1.1.m1.1a"><mrow id="S3.E15Xa.2.1.1.m1.1.1" xref="S3.E15Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E15Xa.2.1.1.m1.1.1.2" xref="S3.E15Xa.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E15Xa.2.1.1.m1.1.1.1" xref="S3.E15Xa.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.E15Xa.2.1.1.m1.1.1.3" xref="S3.E15Xa.2.1.1.m1.1.1.3.cmml"><mn id="S3.E15Xa.2.1.1.m1.1.1.3.2" xref="S3.E15Xa.2.1.1.m1.1.1.3.2.cmml">1</mn><mo id="S3.E15Xa.2.1.1.m1.1.1.3.1" xref="S3.E15Xa.2.1.1.m1.1.1.3.1.cmml">−</mo><mi id="S3.E15Xa.2.1.1.m1.1.1.3.3" xref="S3.E15Xa.2.1.1.m1.1.1.3.3.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15Xa.2.1.1.m1.1b"><apply id="S3.E15Xa.2.1.1.m1.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.1.1"><eq id="S3.E15Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E15Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E15Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.3"><minus id="S3.E15Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.3.1"></minus><cn type="integer" id="S3.E15Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.3.2">1</cn><ci id="S3.E15Xa.2.1.1.m1.1.1.3.3.cmml" xref="S3.E15Xa.2.1.1.m1.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15Xa.2.1.1.m1.1c">\displaystyle=1-x</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.1.p1.1" class="ltx_p">Let <math id="S3.SS3.1.p1.1.m1.1" class="ltx_Math" alttext="\bar{X}" display="inline"><semantics id="S3.SS3.1.p1.1.m1.1a"><mover accent="true" id="S3.SS3.1.p1.1.m1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.1.p1.1.m1.1.1.2" xref="S3.SS3.1.p1.1.m1.1.1.2.cmml">X</mi><mo id="S3.SS3.1.p1.1.m1.1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.1.m1.1b"><apply id="S3.SS3.1.p1.1.m1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1"><ci id="S3.SS3.1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1">¯</ci><ci id="S3.SS3.1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.1.m1.1c">\bar{X}</annotation></semantics></math> denote the dataset after pre-processing. The AIR is then calculated as:</p>
<table id="S3.E16" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E16X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle AIR(\bar{X})" display="inline"><semantics id="S3.E16X.2.1.1.m1.1a"><mrow id="S3.E16X.2.1.1.m1.1.2" xref="S3.E16X.2.1.1.m1.1.2.cmml"><mi id="S3.E16X.2.1.1.m1.1.2.2" xref="S3.E16X.2.1.1.m1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E16X.2.1.1.m1.1.2.1" xref="S3.E16X.2.1.1.m1.1.2.1.cmml">​</mo><mi id="S3.E16X.2.1.1.m1.1.2.3" xref="S3.E16X.2.1.1.m1.1.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E16X.2.1.1.m1.1.2.1a" xref="S3.E16X.2.1.1.m1.1.2.1.cmml">​</mo><mi id="S3.E16X.2.1.1.m1.1.2.4" xref="S3.E16X.2.1.1.m1.1.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E16X.2.1.1.m1.1.2.1b" xref="S3.E16X.2.1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.E16X.2.1.1.m1.1.2.5.2" xref="S3.E16X.2.1.1.m1.1.1.cmml"><mo stretchy="false" id="S3.E16X.2.1.1.m1.1.2.5.2.1" xref="S3.E16X.2.1.1.m1.1.1.cmml">(</mo><mover accent="true" id="S3.E16X.2.1.1.m1.1.1" xref="S3.E16X.2.1.1.m1.1.1.cmml"><mi id="S3.E16X.2.1.1.m1.1.1.2" xref="S3.E16X.2.1.1.m1.1.1.2.cmml">X</mi><mo id="S3.E16X.2.1.1.m1.1.1.1" xref="S3.E16X.2.1.1.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S3.E16X.2.1.1.m1.1.2.5.2.2" xref="S3.E16X.2.1.1.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16X.2.1.1.m1.1b"><apply id="S3.E16X.2.1.1.m1.1.2.cmml" xref="S3.E16X.2.1.1.m1.1.2"><times id="S3.E16X.2.1.1.m1.1.2.1.cmml" xref="S3.E16X.2.1.1.m1.1.2.1"></times><ci id="S3.E16X.2.1.1.m1.1.2.2.cmml" xref="S3.E16X.2.1.1.m1.1.2.2">𝐴</ci><ci id="S3.E16X.2.1.1.m1.1.2.3.cmml" xref="S3.E16X.2.1.1.m1.1.2.3">𝐼</ci><ci id="S3.E16X.2.1.1.m1.1.2.4.cmml" xref="S3.E16X.2.1.1.m1.1.2.4">𝑅</ci><apply id="S3.E16X.2.1.1.m1.1.1.cmml" xref="S3.E16X.2.1.1.m1.1.2.5.2"><ci id="S3.E16X.2.1.1.m1.1.1.1.cmml" xref="S3.E16X.2.1.1.m1.1.1.1">¯</ci><ci id="S3.E16X.2.1.1.m1.1.1.2.cmml" xref="S3.E16X.2.1.1.m1.1.1.2">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16X.2.1.1.m1.1c">\displaystyle AIR(\bar{X})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16X.3.2.2.m1.6" class="ltx_Math" alttext="\displaystyle=\frac{\max(\mu^{a}_{\bar{X}},\mu^{n}_{\bar{X}})}{\min(\mu^{a}_{\bar{X}},\mu^{n}_{\bar{X}})}" display="inline"><semantics id="S3.E16X.3.2.2.m1.6a"><mrow id="S3.E16X.3.2.2.m1.6.7" xref="S3.E16X.3.2.2.m1.6.7.cmml"><mi id="S3.E16X.3.2.2.m1.6.7.2" xref="S3.E16X.3.2.2.m1.6.7.2.cmml"></mi><mo id="S3.E16X.3.2.2.m1.6.7.1" xref="S3.E16X.3.2.2.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E16X.3.2.2.m1.6.6" xref="S3.E16X.3.2.2.m1.6.6.cmml"><mfrac id="S3.E16X.3.2.2.m1.6.6a" xref="S3.E16X.3.2.2.m1.6.6.cmml"><mrow id="S3.E16X.3.2.2.m1.3.3.3.3" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml"><mi id="S3.E16X.3.2.2.m1.1.1.1.1" xref="S3.E16X.3.2.2.m1.1.1.1.1.cmml">max</mi><mo id="S3.E16X.3.2.2.m1.3.3.3.3a" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E16X.3.2.2.m1.3.3.3.3.2" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E16X.3.2.2.m1.3.3.3.3.2.3" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml">(</mo><msubsup id="S3.E16X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.2" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.2.cmml">μ</mi><mover accent="true" id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.2" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.2.cmml">X</mi><mo id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.1" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.1.cmml">¯</mo></mover><mi id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.3" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E16X.3.2.2.m1.3.3.3.3.2.4" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E16X.3.2.2.m1.3.3.3.3.2.2" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.cmml"><mi id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.2" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.2.cmml">μ</mi><mover accent="true" id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.cmml"><mi id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.2" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.2.cmml">X</mi><mo id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.1" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.1.cmml">¯</mo></mover><mi id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.3" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E16X.3.2.2.m1.3.3.3.3.2.5" xref="S3.E16X.3.2.2.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E16X.3.2.2.m1.6.6.6.3" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml"><mi id="S3.E16X.3.2.2.m1.4.4.4.1" xref="S3.E16X.3.2.2.m1.4.4.4.1.cmml">min</mi><mo id="S3.E16X.3.2.2.m1.6.6.6.3a" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml">⁡</mo><mrow id="S3.E16X.3.2.2.m1.6.6.6.3.2" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml"><mo stretchy="false" id="S3.E16X.3.2.2.m1.6.6.6.3.2.3" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml">(</mo><msubsup id="S3.E16X.3.2.2.m1.5.5.5.2.1.1" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.cmml"><mi id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.2" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.2.cmml">μ</mi><mover accent="true" id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.cmml"><mi id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.2" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.2.cmml">X</mi><mo id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.1" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.1.cmml">¯</mo></mover><mi id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.3" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E16X.3.2.2.m1.6.6.6.3.2.4" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml">,</mo><msubsup id="S3.E16X.3.2.2.m1.6.6.6.3.2.2" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.cmml"><mi id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.2" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.2.cmml">μ</mi><mover accent="true" id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.cmml"><mi id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.2" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.2.cmml">X</mi><mo id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.1" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.1.cmml">¯</mo></mover><mi id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.3" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E16X.3.2.2.m1.6.6.6.3.2.5" xref="S3.E16X.3.2.2.m1.6.6.6.4.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E16X.3.2.2.m1.6b"><apply id="S3.E16X.3.2.2.m1.6.7.cmml" xref="S3.E16X.3.2.2.m1.6.7"><eq id="S3.E16X.3.2.2.m1.6.7.1.cmml" xref="S3.E16X.3.2.2.m1.6.7.1"></eq><csymbol cd="latexml" id="S3.E16X.3.2.2.m1.6.7.2.cmml" xref="S3.E16X.3.2.2.m1.6.7.2">absent</csymbol><apply id="S3.E16X.3.2.2.m1.6.6.cmml" xref="S3.E16X.3.2.2.m1.6.6"><divide id="S3.E16X.3.2.2.m1.6.6.7.cmml" xref="S3.E16X.3.2.2.m1.6.6"></divide><apply id="S3.E16X.3.2.2.m1.3.3.3.4.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3"><max id="S3.E16X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E16X.3.2.2.m1.1.1.1.1"></max><apply id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.2">𝜇</ci><ci id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.2.3">𝑎</ci></apply><apply id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3"><ci id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.1">¯</ci><ci id="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E16X.3.2.2.m1.2.2.2.2.1.1.3.2">𝑋</ci></apply></apply><apply id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.1.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2">subscript</csymbol><apply id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.1.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2">superscript</csymbol><ci id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.2.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.2">𝜇</ci><ci id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.3.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3"><ci id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.1.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.1">¯</ci><ci id="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.2.cmml" xref="S3.E16X.3.2.2.m1.3.3.3.3.2.2.3.2">𝑋</ci></apply></apply></apply><apply id="S3.E16X.3.2.2.m1.6.6.6.4.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3"><min id="S3.E16X.3.2.2.m1.4.4.4.1.cmml" xref="S3.E16X.3.2.2.m1.4.4.4.1"></min><apply id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.1.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1">subscript</csymbol><apply id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.1.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1">superscript</csymbol><ci id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.2.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.2">𝜇</ci><ci id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.3.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.2.3">𝑎</ci></apply><apply id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3"><ci id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.1.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.1">¯</ci><ci id="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.2.cmml" xref="S3.E16X.3.2.2.m1.5.5.5.2.1.1.3.2">𝑋</ci></apply></apply><apply id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.1.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2">subscript</csymbol><apply id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.1.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2">superscript</csymbol><ci id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.2.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.2">𝜇</ci><ci id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.3.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.2.3">𝑛</ci></apply><apply id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3"><ci id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.1.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.1">¯</ci><ci id="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.2.cmml" xref="S3.E16X.3.2.2.m1.6.6.6.3.2.2.3.2">𝑋</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16X.3.2.2.m1.6c">\displaystyle=\frac{\max(\mu^{a}_{\bar{X}},\mu^{n}_{\bar{X}})}{\min(\mu^{a}_{\bar{X}},\mu^{n}_{\bar{X}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="7" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(16)</span></td>
</tr>
<tr id="S3.E16Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xa.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle=\frac{\max(1-\mu^{a}_{X},1-\mu^{n}_{X})}{\min(1-\mu^{a}_{X},1-\mu^{n}_{X})}" display="inline"><semantics id="S3.E16Xa.2.1.1.m1.6a"><mrow id="S3.E16Xa.2.1.1.m1.6.7" xref="S3.E16Xa.2.1.1.m1.6.7.cmml"><mi id="S3.E16Xa.2.1.1.m1.6.7.2" xref="S3.E16Xa.2.1.1.m1.6.7.2.cmml"></mi><mo id="S3.E16Xa.2.1.1.m1.6.7.1" xref="S3.E16Xa.2.1.1.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E16Xa.2.1.1.m1.6.6" xref="S3.E16Xa.2.1.1.m1.6.6.cmml"><mfrac id="S3.E16Xa.2.1.1.m1.6.6a" xref="S3.E16Xa.2.1.1.m1.6.6.cmml"><mrow id="S3.E16Xa.2.1.1.m1.3.3.3.3" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml"><mi id="S3.E16Xa.2.1.1.m1.1.1.1.1" xref="S3.E16Xa.2.1.1.m1.1.1.1.1.cmml">max</mi><mo id="S3.E16Xa.2.1.1.m1.3.3.3.3a" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E16Xa.2.1.1.m1.3.3.3.3.2" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.3" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.cmml"><mn id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml">−</mo><msubsup id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.2" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.2.cmml">μ</mi><mi id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.3" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml">X</mi><mi id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.3" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.3.cmml">a</mi></msubsup></mrow><mo id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.4" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml">,</mo><mrow id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.cmml"><mn id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.2" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.2.cmml">1</mn><mo id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.1" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.1.cmml">−</mo><msubsup id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.cmml"><mi id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.2" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.2.cmml">μ</mi><mi id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.3" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.3.cmml">X</mi><mi id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.3" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.3.cmml">n</mi></msubsup></mrow><mo stretchy="false" id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.5" xref="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E16Xa.2.1.1.m1.6.6.6.3" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml"><mi id="S3.E16Xa.2.1.1.m1.4.4.4.1" xref="S3.E16Xa.2.1.1.m1.4.4.4.1.cmml">min</mi><mo id="S3.E16Xa.2.1.1.m1.6.6.6.3a" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml">⁡</mo><mrow id="S3.E16Xa.2.1.1.m1.6.6.6.3.2" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml"><mo stretchy="false" id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.3" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml">(</mo><mrow id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.cmml"><mn id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.2" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.2.cmml">1</mn><mo id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.1" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.1.cmml">−</mo><msubsup id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.cmml"><mi id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.2" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.2.cmml">μ</mi><mi id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.3" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.3.cmml">X</mi><mi id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.3" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.3.cmml">a</mi></msubsup></mrow><mo id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.4" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml">,</mo><mrow id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.cmml"><mn id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.2" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.2.cmml">1</mn><mo id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.1" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.1.cmml">−</mo><msubsup id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.cmml"><mi id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.2" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.2.cmml">μ</mi><mi id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.3" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.3.cmml">X</mi><mi id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.3" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.3.cmml">n</mi></msubsup></mrow><mo stretchy="false" id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.5" xref="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xa.2.1.1.m1.6b"><apply id="S3.E16Xa.2.1.1.m1.6.7.cmml" xref="S3.E16Xa.2.1.1.m1.6.7"><eq id="S3.E16Xa.2.1.1.m1.6.7.1.cmml" xref="S3.E16Xa.2.1.1.m1.6.7.1"></eq><csymbol cd="latexml" id="S3.E16Xa.2.1.1.m1.6.7.2.cmml" xref="S3.E16Xa.2.1.1.m1.6.7.2">absent</csymbol><apply id="S3.E16Xa.2.1.1.m1.6.6.cmml" xref="S3.E16Xa.2.1.1.m1.6.6"><divide id="S3.E16Xa.2.1.1.m1.6.6.7.cmml" xref="S3.E16Xa.2.1.1.m1.6.6"></divide><apply id="S3.E16Xa.2.1.1.m1.3.3.3.4.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3"><max id="S3.E16Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E16Xa.2.1.1.m1.1.1.1.1"></max><apply id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1"><minus id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.1"></minus><cn type="integer" id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.2">1</cn><apply id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3">subscript</csymbol><apply id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.2">𝜇</ci><ci id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.2.3">𝑎</ci></apply><ci id="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E16Xa.2.1.1.m1.2.2.2.2.1.1.3.3">𝑋</ci></apply></apply><apply id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2"><minus id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.1"></minus><cn type="integer" id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.2">1</cn><apply id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.1.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3">subscript</csymbol><apply id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3">superscript</csymbol><ci id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.2">𝜇</ci><ci id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.2.3">𝑛</ci></apply><ci id="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.3.cmml" xref="S3.E16Xa.2.1.1.m1.3.3.3.3.2.2.3.3">𝑋</ci></apply></apply></apply><apply id="S3.E16Xa.2.1.1.m1.6.6.6.4.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3"><min id="S3.E16Xa.2.1.1.m1.4.4.4.1.cmml" xref="S3.E16Xa.2.1.1.m1.4.4.4.1"></min><apply id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1"><minus id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.1.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.1"></minus><cn type="integer" id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.2.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.2">1</cn><apply id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.1.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3">subscript</csymbol><apply id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3">superscript</csymbol><ci id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.2">𝜇</ci><ci id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.2.3">𝑎</ci></apply><ci id="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.3.cmml" xref="S3.E16Xa.2.1.1.m1.5.5.5.2.1.1.3.3">𝑋</ci></apply></apply><apply id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2"><minus id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.1"></minus><cn type="integer" id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.2">1</cn><apply id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.1.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3">subscript</csymbol><apply id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3"><csymbol cd="ambiguous" id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.1.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3">superscript</csymbol><ci id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.2.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.2">𝜇</ci><ci id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.3.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.2.3">𝑛</ci></apply><ci id="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.3.cmml" xref="S3.E16Xa.2.1.1.m1.6.6.6.3.2.2.3.3">𝑋</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xa.2.1.1.m1.6c">\displaystyle=\frac{\max(1-\mu^{a}_{X},1-\mu^{n}_{X})}{\min(1-\mu^{a}_{X},1-\mu^{n}_{X})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E16Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\frac{1-\mu^{n}_{X}}{1-\mu^{a}_{X}}" display="inline"><semantics id="S3.E16Xb.2.1.1.m1.1a"><mrow id="S3.E16Xb.2.1.1.m1.1.1" xref="S3.E16Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E16Xb.2.1.1.m1.1.1.2" xref="S3.E16Xb.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E16Xb.2.1.1.m1.1.1.1" xref="S3.E16Xb.2.1.1.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E16Xb.2.1.1.m1.1.1.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.cmml"><mfrac id="S3.E16Xb.2.1.1.m1.1.1.3a" xref="S3.E16Xb.2.1.1.m1.1.1.3.cmml"><mrow id="S3.E16Xb.2.1.1.m1.1.1.3.2" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.cmml"><mn id="S3.E16Xb.2.1.1.m1.1.1.3.2.2" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.2.cmml">1</mn><mo id="S3.E16Xb.2.1.1.m1.1.1.3.2.1" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.1.cmml">−</mo><msubsup id="S3.E16Xb.2.1.1.m1.1.1.3.2.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.2" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.2.cmml">μ</mi><mi id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.3.cmml">X</mi><mi id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.3.cmml">n</mi></msubsup></mrow><mrow id="S3.E16Xb.2.1.1.m1.1.1.3.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.cmml"><mn id="S3.E16Xb.2.1.1.m1.1.1.3.3.2" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.E16Xb.2.1.1.m1.1.1.3.3.1" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.1.cmml">−</mo><msubsup id="S3.E16Xb.2.1.1.m1.1.1.3.3.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.cmml"><mi id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.2" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.2.cmml">μ</mi><mi id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.3.cmml">X</mi><mi id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.3" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.3.cmml">a</mi></msubsup></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xb.2.1.1.m1.1b"><apply id="S3.E16Xb.2.1.1.m1.1.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1"><eq id="S3.E16Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E16Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E16Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3"><divide id="S3.E16Xb.2.1.1.m1.1.1.3.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3"></divide><apply id="S3.E16Xb.2.1.1.m1.1.1.3.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2"><minus id="S3.E16Xb.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.1"></minus><cn type="integer" id="S3.E16Xb.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.2">1</cn><apply id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3">subscript</csymbol><apply id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3">superscript</csymbol><ci id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.2">𝜇</ci><ci id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.2.3">𝑛</ci></apply><ci id="S3.E16Xb.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.2.3.3">𝑋</ci></apply></apply><apply id="S3.E16Xb.2.1.1.m1.1.1.3.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3"><minus id="S3.E16Xb.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.1"></minus><cn type="integer" id="S3.E16Xb.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.2">1</cn><apply id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3">subscript</csymbol><apply id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.1.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3">superscript</csymbol><ci id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.2.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.2">𝜇</ci><ci id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.2.3">𝑎</ci></apply><ci id="S3.E16Xb.2.1.1.m1.1.1.3.3.3.3.cmml" xref="S3.E16Xb.2.1.1.m1.1.1.3.3.3.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xb.2.1.1.m1.1c">\displaystyle=\frac{1-\mu^{n}_{X}}{1-\mu^{a}_{X}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E16Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=1+\frac{\mu_{X}^{a}-\mu_{X}^{n}}{1-\mu_{X}^{a}}" display="inline"><semantics id="S3.E16Xc.2.1.1.m1.1a"><mrow id="S3.E16Xc.2.1.1.m1.1.1" xref="S3.E16Xc.2.1.1.m1.1.1.cmml"><mi id="S3.E16Xc.2.1.1.m1.1.1.2" xref="S3.E16Xc.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E16Xc.2.1.1.m1.1.1.1" xref="S3.E16Xc.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.E16Xc.2.1.1.m1.1.1.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.cmml"><mn id="S3.E16Xc.2.1.1.m1.1.1.3.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.2.cmml">1</mn><mo id="S3.E16Xc.2.1.1.m1.1.1.3.1" xref="S3.E16Xc.2.1.1.m1.1.1.3.1.cmml">+</mo><mstyle displaystyle="true" id="S3.E16Xc.2.1.1.m1.1.1.3.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.cmml"><mfrac id="S3.E16Xc.2.1.1.m1.1.1.3.3a" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.cmml"><mrow id="S3.E16Xc.2.1.1.m1.1.1.3.3.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.cmml"><msubsup id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.2.cmml">μ</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.3.cmml">X</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.3.cmml">a</mi></msubsup><mo id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.1" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.1.cmml">−</mo><msubsup id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.2.cmml">μ</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.3.cmml">X</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.3.cmml">n</mi></msubsup></mrow><mrow id="S3.E16Xc.2.1.1.m1.1.1.3.3.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.cmml"><mn id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.2.cmml">1</mn><mo id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.1" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.1.cmml">−</mo><msubsup id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.cmml"><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.2" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.2.cmml">μ</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.3.cmml">X</mi><mi id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.3" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.3.cmml">a</mi></msubsup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xc.2.1.1.m1.1b"><apply id="S3.E16Xc.2.1.1.m1.1.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1"><eq id="S3.E16Xc.2.1.1.m1.1.1.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E16Xc.2.1.1.m1.1.1.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E16Xc.2.1.1.m1.1.1.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3"><plus id="S3.E16Xc.2.1.1.m1.1.1.3.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.1"></plus><cn type="integer" id="S3.E16Xc.2.1.1.m1.1.1.3.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.2">1</cn><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3"><divide id="S3.E16Xc.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3"></divide><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2"><minus id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.1"></minus><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.2">𝜇</ci><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.2.3">𝑋</ci></apply><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.2.3">𝑎</ci></apply><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.2">𝜇</ci><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.2.3">𝑋</ci></apply><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.2.3.3">𝑛</ci></apply></apply><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3"><minus id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.1"></minus><cn type="integer" id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.2">1</cn><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.1.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.2.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.2">𝜇</ci><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.2.3">𝑋</ci></apply><ci id="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.3.cmml" xref="S3.E16Xc.2.1.1.m1.1.1.3.3.3.3.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xc.2.1.1.m1.1c">\displaystyle=1+\frac{\mu_{X}^{a}-\mu_{X}^{n}}{1-\mu_{X}^{a}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E16Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xd.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle&gt;1+\frac{\mu_{X}^{a}-\mu_{X}^{n}}{\mu_{X}^{n}}" display="inline"><semantics id="S3.E16Xd.2.1.1.m1.1a"><mrow id="S3.E16Xd.2.1.1.m1.1.1" xref="S3.E16Xd.2.1.1.m1.1.1.cmml"><mi id="S3.E16Xd.2.1.1.m1.1.1.2" xref="S3.E16Xd.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E16Xd.2.1.1.m1.1.1.1" xref="S3.E16Xd.2.1.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S3.E16Xd.2.1.1.m1.1.1.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.cmml"><mn id="S3.E16Xd.2.1.1.m1.1.1.3.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.2.cmml">1</mn><mo id="S3.E16Xd.2.1.1.m1.1.1.3.1" xref="S3.E16Xd.2.1.1.m1.1.1.3.1.cmml">+</mo><mstyle displaystyle="true" id="S3.E16Xd.2.1.1.m1.1.1.3.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.cmml"><mfrac id="S3.E16Xd.2.1.1.m1.1.1.3.3a" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.cmml"><mrow id="S3.E16Xd.2.1.1.m1.1.1.3.3.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.cmml"><msubsup id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.2.cmml">μ</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.3.cmml">X</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.3.cmml">a</mi></msubsup><mo id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.1" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.1.cmml">−</mo><msubsup id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.2.cmml">μ</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.3.cmml">X</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.3.cmml">n</mi></msubsup></mrow><msubsup id="S3.E16Xd.2.1.1.m1.1.1.3.3.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.cmml"><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.2" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.2.cmml">μ</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.3.cmml">X</mi><mi id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.3" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.3.cmml">n</mi></msubsup></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xd.2.1.1.m1.1b"><apply id="S3.E16Xd.2.1.1.m1.1.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1"><gt id="S3.E16Xd.2.1.1.m1.1.1.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S3.E16Xd.2.1.1.m1.1.1.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E16Xd.2.1.1.m1.1.1.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3"><plus id="S3.E16Xd.2.1.1.m1.1.1.3.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.1"></plus><cn type="integer" id="S3.E16Xd.2.1.1.m1.1.1.3.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.2">1</cn><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3"><divide id="S3.E16Xd.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3"></divide><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2"><minus id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.1"></minus><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.2">𝜇</ci><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.2.3">𝑋</ci></apply><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.2.3">𝑎</ci></apply><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.2">𝜇</ci><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.2.3">𝑋</ci></apply><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.2.3.3">𝑛</ci></apply></apply><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3">superscript</csymbol><apply id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.1.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.2.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.2">𝜇</ci><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.2.3">𝑋</ci></apply><ci id="S3.E16Xd.2.1.1.m1.1.1.3.3.3.3.cmml" xref="S3.E16Xd.2.1.1.m1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xd.2.1.1.m1.1c">\displaystyle&gt;1+\frac{\mu_{X}^{a}-\mu_{X}^{n}}{\mu_{X}^{n}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E16Xe" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xe.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\frac{\mu^{a}_{X}}{\mu^{n}_{X}}" display="inline"><semantics id="S3.E16Xe.2.1.1.m1.1a"><mrow id="S3.E16Xe.2.1.1.m1.1.1" xref="S3.E16Xe.2.1.1.m1.1.1.cmml"><mi id="S3.E16Xe.2.1.1.m1.1.1.2" xref="S3.E16Xe.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E16Xe.2.1.1.m1.1.1.1" xref="S3.E16Xe.2.1.1.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E16Xe.2.1.1.m1.1.1.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.cmml"><mfrac id="S3.E16Xe.2.1.1.m1.1.1.3a" xref="S3.E16Xe.2.1.1.m1.1.1.3.cmml"><msubsup id="S3.E16Xe.2.1.1.m1.1.1.3.2" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.cmml"><mi id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.2" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.2.2.cmml">μ</mi><mi id="S3.E16Xe.2.1.1.m1.1.1.3.2.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.3.cmml">X</mi><mi id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.2.3.cmml">a</mi></msubsup><msubsup id="S3.E16Xe.2.1.1.m1.1.1.3.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.cmml"><mi id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.2" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.2.2.cmml">μ</mi><mi id="S3.E16Xe.2.1.1.m1.1.1.3.3.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.3.cmml">X</mi><mi id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.3" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.2.3.cmml">n</mi></msubsup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xe.2.1.1.m1.1b"><apply id="S3.E16Xe.2.1.1.m1.1.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1"><eq id="S3.E16Xe.2.1.1.m1.1.1.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E16Xe.2.1.1.m1.1.1.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E16Xe.2.1.1.m1.1.1.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3"><divide id="S3.E16Xe.2.1.1.m1.1.1.3.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3"></divide><apply id="S3.E16Xe.2.1.1.m1.1.1.3.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E16Xe.2.1.1.m1.1.1.3.2.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2">subscript</csymbol><apply id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.2.2">𝜇</ci><ci id="S3.E16Xe.2.1.1.m1.1.1.3.2.2.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.2.3">𝑎</ci></apply><ci id="S3.E16Xe.2.1.1.m1.1.1.3.2.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.2.3">𝑋</ci></apply><apply id="S3.E16Xe.2.1.1.m1.1.1.3.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E16Xe.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3">subscript</csymbol><apply id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.1.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.2.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.2.2">𝜇</ci><ci id="S3.E16Xe.2.1.1.m1.1.1.3.3.2.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.2.3">𝑛</ci></apply><ci id="S3.E16Xe.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E16Xe.2.1.1.m1.1.1.3.3.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xe.2.1.1.m1.1c">\displaystyle=\frac{\mu^{a}_{X}}{\mu^{n}_{X}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E16Xf" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16Xf.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle=\frac{\max(\mu^{a}_{X},\mu^{n}_{X})}{\min(\mu^{a}_{X},\mu^{n}_{X})}=AIR(X)" display="inline"><semantics id="S3.E16Xf.2.1.1.m1.7a"><mrow id="S3.E16Xf.2.1.1.m1.7.8" xref="S3.E16Xf.2.1.1.m1.7.8.cmml"><mi id="S3.E16Xf.2.1.1.m1.7.8.2" xref="S3.E16Xf.2.1.1.m1.7.8.2.cmml"></mi><mo id="S3.E16Xf.2.1.1.m1.7.8.3" xref="S3.E16Xf.2.1.1.m1.7.8.3.cmml">=</mo><mstyle displaystyle="true" id="S3.E16Xf.2.1.1.m1.6.6" xref="S3.E16Xf.2.1.1.m1.6.6.cmml"><mfrac id="S3.E16Xf.2.1.1.m1.6.6a" xref="S3.E16Xf.2.1.1.m1.6.6.cmml"><mrow id="S3.E16Xf.2.1.1.m1.3.3.3.3" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml"><mi id="S3.E16Xf.2.1.1.m1.1.1.1.1" xref="S3.E16Xf.2.1.1.m1.1.1.1.1.cmml">max</mi><mo id="S3.E16Xf.2.1.1.m1.3.3.3.3a" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E16Xf.2.1.1.m1.3.3.3.3.2" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.3" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml">(</mo><msubsup id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.cmml"><mi id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.2" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.2.cmml">μ</mi><mi id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.3" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.3.cmml">X</mi><mi id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.3" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.4" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.cmml"><mi id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.2" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.2.cmml">μ</mi><mi id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.3" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.3.cmml">X</mi><mi id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.3" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.5" xref="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E16Xf.2.1.1.m1.6.6.6.3" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml"><mi id="S3.E16Xf.2.1.1.m1.4.4.4.1" xref="S3.E16Xf.2.1.1.m1.4.4.4.1.cmml">min</mi><mo id="S3.E16Xf.2.1.1.m1.6.6.6.3a" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml">⁡</mo><mrow id="S3.E16Xf.2.1.1.m1.6.6.6.3.2" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml"><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.3" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml">(</mo><msubsup id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.cmml"><mi id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.2" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.2.cmml">μ</mi><mi id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.3" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.3.cmml">X</mi><mi id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.3" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.4" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml">,</mo><msubsup id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.cmml"><mi id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.2" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.2.cmml">μ</mi><mi id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.3" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.3.cmml">X</mi><mi id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.3" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.5" xref="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E16Xf.2.1.1.m1.7.8.4" xref="S3.E16Xf.2.1.1.m1.7.8.4.cmml">=</mo><mrow id="S3.E16Xf.2.1.1.m1.7.8.5" xref="S3.E16Xf.2.1.1.m1.7.8.5.cmml"><mi id="S3.E16Xf.2.1.1.m1.7.8.5.2" xref="S3.E16Xf.2.1.1.m1.7.8.5.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E16Xf.2.1.1.m1.7.8.5.1" xref="S3.E16Xf.2.1.1.m1.7.8.5.1.cmml">​</mo><mi id="S3.E16Xf.2.1.1.m1.7.8.5.3" xref="S3.E16Xf.2.1.1.m1.7.8.5.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E16Xf.2.1.1.m1.7.8.5.1a" xref="S3.E16Xf.2.1.1.m1.7.8.5.1.cmml">​</mo><mi id="S3.E16Xf.2.1.1.m1.7.8.5.4" xref="S3.E16Xf.2.1.1.m1.7.8.5.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E16Xf.2.1.1.m1.7.8.5.1b" xref="S3.E16Xf.2.1.1.m1.7.8.5.1.cmml">​</mo><mrow id="S3.E16Xf.2.1.1.m1.7.8.5.5.2" xref="S3.E16Xf.2.1.1.m1.7.8.5.cmml"><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.7.8.5.5.2.1" xref="S3.E16Xf.2.1.1.m1.7.8.5.cmml">(</mo><mi id="S3.E16Xf.2.1.1.m1.7.7" xref="S3.E16Xf.2.1.1.m1.7.7.cmml">X</mi><mo stretchy="false" id="S3.E16Xf.2.1.1.m1.7.8.5.5.2.2" xref="S3.E16Xf.2.1.1.m1.7.8.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16Xf.2.1.1.m1.7b"><apply id="S3.E16Xf.2.1.1.m1.7.8.cmml" xref="S3.E16Xf.2.1.1.m1.7.8"><and id="S3.E16Xf.2.1.1.m1.7.8a.cmml" xref="S3.E16Xf.2.1.1.m1.7.8"></and><apply id="S3.E16Xf.2.1.1.m1.7.8b.cmml" xref="S3.E16Xf.2.1.1.m1.7.8"><eq id="S3.E16Xf.2.1.1.m1.7.8.3.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.3"></eq><csymbol cd="latexml" id="S3.E16Xf.2.1.1.m1.7.8.2.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.2">absent</csymbol><apply id="S3.E16Xf.2.1.1.m1.6.6.cmml" xref="S3.E16Xf.2.1.1.m1.6.6"><divide id="S3.E16Xf.2.1.1.m1.6.6.7.cmml" xref="S3.E16Xf.2.1.1.m1.6.6"></divide><apply id="S3.E16Xf.2.1.1.m1.3.3.3.4.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3"><max id="S3.E16Xf.2.1.1.m1.1.1.1.1.cmml" xref="S3.E16Xf.2.1.1.m1.1.1.1.1"></max><apply id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.2">𝜇</ci><ci id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.2.3">𝑎</ci></apply><ci id="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E16Xf.2.1.1.m1.2.2.2.2.1.1.3">𝑋</ci></apply><apply id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2">subscript</csymbol><apply id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2">superscript</csymbol><ci id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.2">𝜇</ci><ci id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.3.3.3.3.2.2.3">𝑋</ci></apply></apply><apply id="S3.E16Xf.2.1.1.m1.6.6.6.4.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3"><min id="S3.E16Xf.2.1.1.m1.4.4.4.1.cmml" xref="S3.E16Xf.2.1.1.m1.4.4.4.1"></min><apply id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.1.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1">subscript</csymbol><apply id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1">superscript</csymbol><ci id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.2">𝜇</ci><ci id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.2.3">𝑎</ci></apply><ci id="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.3.cmml" xref="S3.E16Xf.2.1.1.m1.5.5.5.2.1.1.3">𝑋</ci></apply><apply id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2">subscript</csymbol><apply id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2"><csymbol cd="ambiguous" id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.1.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2">superscript</csymbol><ci id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.2.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.2">𝜇</ci><ci id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.3.cmml" xref="S3.E16Xf.2.1.1.m1.6.6.6.3.2.2.3">𝑋</ci></apply></apply></apply></apply><apply id="S3.E16Xf.2.1.1.m1.7.8c.cmml" xref="S3.E16Xf.2.1.1.m1.7.8"><eq id="S3.E16Xf.2.1.1.m1.7.8.4.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.4"></eq><share href="#S3.E16Xf.2.1.1.m1.6.6.cmml" id="S3.E16Xf.2.1.1.m1.7.8d.cmml" xref="S3.E16Xf.2.1.1.m1.7.8"></share><apply id="S3.E16Xf.2.1.1.m1.7.8.5.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.5"><times id="S3.E16Xf.2.1.1.m1.7.8.5.1.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.5.1"></times><ci id="S3.E16Xf.2.1.1.m1.7.8.5.2.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.5.2">𝐴</ci><ci id="S3.E16Xf.2.1.1.m1.7.8.5.3.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.5.3">𝐼</ci><ci id="S3.E16Xf.2.1.1.m1.7.8.5.4.cmml" xref="S3.E16Xf.2.1.1.m1.7.8.5.4">𝑅</ci><ci id="S3.E16Xf.2.1.1.m1.7.7.cmml" xref="S3.E16Xf.2.1.1.m1.7.7">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16Xf.2.1.1.m1.7c">\displaystyle=\frac{\max(\mu^{a}_{X},\mu^{n}_{X})}{\min(\mu^{a}_{X},\mu^{n}_{X})}=AIR(X)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS3.2.p2" class="ltx_para">
<p id="S3.SS3.2.p2.1" class="ltx_p">For T2,
the pre-processing is simply:</p>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E17.m1.1" class="ltx_Math" alttext="p(x)=x" display="block"><semantics id="S3.E17.m1.1a"><mrow id="S3.E17.m1.1.2" xref="S3.E17.m1.1.2.cmml"><mrow id="S3.E17.m1.1.2.2" xref="S3.E17.m1.1.2.2.cmml"><mi id="S3.E17.m1.1.2.2.2" xref="S3.E17.m1.1.2.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.2.2.1" xref="S3.E17.m1.1.2.2.1.cmml">​</mo><mrow id="S3.E17.m1.1.2.2.3.2" xref="S3.E17.m1.1.2.2.cmml"><mo stretchy="false" id="S3.E17.m1.1.2.2.3.2.1" xref="S3.E17.m1.1.2.2.cmml">(</mo><mi id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E17.m1.1.2.2.3.2.2" xref="S3.E17.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.1.2.1" xref="S3.E17.m1.1.2.1.cmml">=</mo><mi id="S3.E17.m1.1.2.3" xref="S3.E17.m1.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.1b"><apply id="S3.E17.m1.1.2.cmml" xref="S3.E17.m1.1.2"><eq id="S3.E17.m1.1.2.1.cmml" xref="S3.E17.m1.1.2.1"></eq><apply id="S3.E17.m1.1.2.2.cmml" xref="S3.E17.m1.1.2.2"><times id="S3.E17.m1.1.2.2.1.cmml" xref="S3.E17.m1.1.2.2.1"></times><ci id="S3.E17.m1.1.2.2.2.cmml" xref="S3.E17.m1.1.2.2.2">𝑝</ci><ci id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1">𝑥</ci></apply><ci id="S3.E17.m1.1.2.3.cmml" xref="S3.E17.m1.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.1c">p(x)=x</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.2.p2.2" class="ltx_p">Thus, the AIR remains unchanged:</p>
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E18.m1.2" class="ltx_Math" alttext="AIR(\bar{X})=AIR(X)" display="block"><semantics id="S3.E18.m1.2a"><mrow id="S3.E18.m1.2.3" xref="S3.E18.m1.2.3.cmml"><mrow id="S3.E18.m1.2.3.2" xref="S3.E18.m1.2.3.2.cmml"><mi id="S3.E18.m1.2.3.2.2" xref="S3.E18.m1.2.3.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.2.1" xref="S3.E18.m1.2.3.2.1.cmml">​</mo><mi id="S3.E18.m1.2.3.2.3" xref="S3.E18.m1.2.3.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.2.1a" xref="S3.E18.m1.2.3.2.1.cmml">​</mo><mi id="S3.E18.m1.2.3.2.4" xref="S3.E18.m1.2.3.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.2.1b" xref="S3.E18.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E18.m1.2.3.2.5.2" xref="S3.E18.m1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.2.3.2.5.2.1" xref="S3.E18.m1.1.1.cmml">(</mo><mover accent="true" id="S3.E18.m1.1.1" xref="S3.E18.m1.1.1.cmml"><mi id="S3.E18.m1.1.1.2" xref="S3.E18.m1.1.1.2.cmml">X</mi><mo id="S3.E18.m1.1.1.1" xref="S3.E18.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S3.E18.m1.2.3.2.5.2.2" xref="S3.E18.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E18.m1.2.3.1" xref="S3.E18.m1.2.3.1.cmml">=</mo><mrow id="S3.E18.m1.2.3.3" xref="S3.E18.m1.2.3.3.cmml"><mi id="S3.E18.m1.2.3.3.2" xref="S3.E18.m1.2.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.3.1" xref="S3.E18.m1.2.3.3.1.cmml">​</mo><mi id="S3.E18.m1.2.3.3.3" xref="S3.E18.m1.2.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.3.1a" xref="S3.E18.m1.2.3.3.1.cmml">​</mo><mi id="S3.E18.m1.2.3.3.4" xref="S3.E18.m1.2.3.3.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.3.3.1b" xref="S3.E18.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E18.m1.2.3.3.5.2" xref="S3.E18.m1.2.3.3.cmml"><mo stretchy="false" id="S3.E18.m1.2.3.3.5.2.1" xref="S3.E18.m1.2.3.3.cmml">(</mo><mi id="S3.E18.m1.2.2" xref="S3.E18.m1.2.2.cmml">X</mi><mo stretchy="false" id="S3.E18.m1.2.3.3.5.2.2" xref="S3.E18.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.2b"><apply id="S3.E18.m1.2.3.cmml" xref="S3.E18.m1.2.3"><eq id="S3.E18.m1.2.3.1.cmml" xref="S3.E18.m1.2.3.1"></eq><apply id="S3.E18.m1.2.3.2.cmml" xref="S3.E18.m1.2.3.2"><times id="S3.E18.m1.2.3.2.1.cmml" xref="S3.E18.m1.2.3.2.1"></times><ci id="S3.E18.m1.2.3.2.2.cmml" xref="S3.E18.m1.2.3.2.2">𝐴</ci><ci id="S3.E18.m1.2.3.2.3.cmml" xref="S3.E18.m1.2.3.2.3">𝐼</ci><ci id="S3.E18.m1.2.3.2.4.cmml" xref="S3.E18.m1.2.3.2.4">𝑅</ci><apply id="S3.E18.m1.1.1.cmml" xref="S3.E18.m1.2.3.2.5.2"><ci id="S3.E18.m1.1.1.1.cmml" xref="S3.E18.m1.1.1.1">¯</ci><ci id="S3.E18.m1.1.1.2.cmml" xref="S3.E18.m1.1.1.2">𝑋</ci></apply></apply><apply id="S3.E18.m1.2.3.3.cmml" xref="S3.E18.m1.2.3.3"><times id="S3.E18.m1.2.3.3.1.cmml" xref="S3.E18.m1.2.3.3.1"></times><ci id="S3.E18.m1.2.3.3.2.cmml" xref="S3.E18.m1.2.3.3.2">𝐴</ci><ci id="S3.E18.m1.2.3.3.3.cmml" xref="S3.E18.m1.2.3.3.3">𝐼</ci><ci id="S3.E18.m1.2.3.3.4.cmml" xref="S3.E18.m1.2.3.3.4">𝑅</ci><ci id="S3.E18.m1.2.2.cmml" xref="S3.E18.m1.2.2">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.2c">AIR(\bar{X})=AIR(X)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.3.p3" class="ltx_para">
<p id="S3.SS3.3.p3.1" class="ltx_p">To sum up, with our simple pre-processing strategy, we ensure that for any processed dataset <math id="S3.SS3.3.p3.1.m1.1" class="ltx_Math" alttext="\bar{X}" display="inline"><semantics id="S3.SS3.3.p3.1.m1.1a"><mover accent="true" id="S3.SS3.3.p3.1.m1.1.1" xref="S3.SS3.3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.3.p3.1.m1.1.1.2" xref="S3.SS3.3.p3.1.m1.1.1.2.cmml">X</mi><mo id="S3.SS3.3.p3.1.m1.1.1.1" xref="S3.SS3.3.p3.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.3.p3.1.m1.1b"><apply id="S3.SS3.3.p3.1.m1.1.1.cmml" xref="S3.SS3.3.p3.1.m1.1.1"><ci id="S3.SS3.3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.3.p3.1.m1.1.1.1">¯</ci><ci id="S3.SS3.3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.3.p3.1.m1.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.3.p3.1.m1.1c">\bar{X}</annotation></semantics></math> used in our work, the AIR is either maintained or increased, i.e.,</p>
<table id="S3.E19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E19.m1.2" class="ltx_Math" alttext="AIR(\bar{X})\geq AIR(X)" display="block"><semantics id="S3.E19.m1.2a"><mrow id="S3.E19.m1.2.3" xref="S3.E19.m1.2.3.cmml"><mrow id="S3.E19.m1.2.3.2" xref="S3.E19.m1.2.3.2.cmml"><mi id="S3.E19.m1.2.3.2.2" xref="S3.E19.m1.2.3.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.2.1" xref="S3.E19.m1.2.3.2.1.cmml">​</mo><mi id="S3.E19.m1.2.3.2.3" xref="S3.E19.m1.2.3.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.2.1a" xref="S3.E19.m1.2.3.2.1.cmml">​</mo><mi id="S3.E19.m1.2.3.2.4" xref="S3.E19.m1.2.3.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.2.1b" xref="S3.E19.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E19.m1.2.3.2.5.2" xref="S3.E19.m1.1.1.cmml"><mo stretchy="false" id="S3.E19.m1.2.3.2.5.2.1" xref="S3.E19.m1.1.1.cmml">(</mo><mover accent="true" id="S3.E19.m1.1.1" xref="S3.E19.m1.1.1.cmml"><mi id="S3.E19.m1.1.1.2" xref="S3.E19.m1.1.1.2.cmml">X</mi><mo id="S3.E19.m1.1.1.1" xref="S3.E19.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S3.E19.m1.2.3.2.5.2.2" xref="S3.E19.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E19.m1.2.3.1" xref="S3.E19.m1.2.3.1.cmml">≥</mo><mrow id="S3.E19.m1.2.3.3" xref="S3.E19.m1.2.3.3.cmml"><mi id="S3.E19.m1.2.3.3.2" xref="S3.E19.m1.2.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.3.1" xref="S3.E19.m1.2.3.3.1.cmml">​</mo><mi id="S3.E19.m1.2.3.3.3" xref="S3.E19.m1.2.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.3.1a" xref="S3.E19.m1.2.3.3.1.cmml">​</mo><mi id="S3.E19.m1.2.3.3.4" xref="S3.E19.m1.2.3.3.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.2.3.3.1b" xref="S3.E19.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E19.m1.2.3.3.5.2" xref="S3.E19.m1.2.3.3.cmml"><mo stretchy="false" id="S3.E19.m1.2.3.3.5.2.1" xref="S3.E19.m1.2.3.3.cmml">(</mo><mi id="S3.E19.m1.2.2" xref="S3.E19.m1.2.2.cmml">X</mi><mo stretchy="false" id="S3.E19.m1.2.3.3.5.2.2" xref="S3.E19.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.2b"><apply id="S3.E19.m1.2.3.cmml" xref="S3.E19.m1.2.3"><geq id="S3.E19.m1.2.3.1.cmml" xref="S3.E19.m1.2.3.1"></geq><apply id="S3.E19.m1.2.3.2.cmml" xref="S3.E19.m1.2.3.2"><times id="S3.E19.m1.2.3.2.1.cmml" xref="S3.E19.m1.2.3.2.1"></times><ci id="S3.E19.m1.2.3.2.2.cmml" xref="S3.E19.m1.2.3.2.2">𝐴</ci><ci id="S3.E19.m1.2.3.2.3.cmml" xref="S3.E19.m1.2.3.2.3">𝐼</ci><ci id="S3.E19.m1.2.3.2.4.cmml" xref="S3.E19.m1.2.3.2.4">𝑅</ci><apply id="S3.E19.m1.1.1.cmml" xref="S3.E19.m1.2.3.2.5.2"><ci id="S3.E19.m1.1.1.1.cmml" xref="S3.E19.m1.1.1.1">¯</ci><ci id="S3.E19.m1.1.1.2.cmml" xref="S3.E19.m1.1.1.2">𝑋</ci></apply></apply><apply id="S3.E19.m1.2.3.3.cmml" xref="S3.E19.m1.2.3.3"><times id="S3.E19.m1.2.3.3.1.cmml" xref="S3.E19.m1.2.3.3.1"></times><ci id="S3.E19.m1.2.3.3.2.cmml" xref="S3.E19.m1.2.3.3.2">𝐴</ci><ci id="S3.E19.m1.2.3.3.3.cmml" xref="S3.E19.m1.2.3.3.3">𝐼</ci><ci id="S3.E19.m1.2.3.3.4.cmml" xref="S3.E19.m1.2.3.3.4">𝑅</ci><ci id="S3.E19.m1.2.2.cmml" xref="S3.E19.m1.2.2">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.2c">AIR(\bar{X})\geq AIR(X)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.3.p3.2" class="ltx_p">∎</p>
</div>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">Finally, we refer to our approach as the IQA approach, which includes the proposed Fusion Quality Loss and Average Intensity Ratio Enhancement as its two key components. We apply our IQA approach to the strong baseline pDDPM, resulting in the method we term pDDPM-IQA.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison with baselines in terms of DICE and AUPRC on BraTS21 and MSLUB using T2 modality in a <span id="S3.T1.38.1" class="ltx_text ltx_font_bold">cross-dataset</span> setting. The model is trained on the IXI dataset, which contains only healthy samples. The best results for a given metric/dataset are bolded, and the second-best are underlined.</figcaption>
<table id="S3.T1.36" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.36.37.1" class="ltx_tr">
<th id="S3.T1.36.37.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T1.36.37.1.1.1" class="ltx_text">Method</span></th>
<th id="S3.T1.36.37.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (T2)</th>
<th id="S3.T1.36.37.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">MSLUB (T2)</th>
</tr>
<tr id="S3.T1.36.38.2" class="ltx_tr">
<th id="S3.T1.36.38.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE [%]</th>
<th id="S3.T1.36.38.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC [%]</th>
<th id="S3.T1.36.38.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE [%]</th>
<th id="S3.T1.36.38.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC [%]</th>
</tr>
<tr id="S3.T1.36.39.3" class="ltx_tr">
<th id="S3.T1.36.39.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Thresh <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</th>
<th id="S3.T1.36.39.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">19.69</th>
<th id="S3.T1.36.39.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">20.27</th>
<th id="S3.T1.36.39.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">6.21</th>
<th id="S3.T1.36.39.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">4.23</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.4.4" class="ltx_tr">
<th id="S3.T1.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">AE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">32.87<math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\pm</annotation></semantics></math>1.25</td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">31.07<math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mo id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">\pm</annotation></semantics></math>1.75</td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">7.10<math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><mo id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">\pm</annotation></semantics></math>0.68</td>
<td id="S3.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t">5.58<math id="S3.T1.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.4.4.4.m1.1a"><mo id="S3.T1.4.4.4.m1.1.1" xref="S3.T1.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.m1.1b"><csymbol cd="latexml" id="S3.T1.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.m1.1c">\pm</annotation></semantics></math>0.26</td>
</tr>
<tr id="S3.T1.8.8" class="ltx_tr">
<th id="S3.T1.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</th>
<td id="S3.T1.5.5.1" class="ltx_td ltx_align_center">31.11<math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><mo id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><csymbol cd="latexml" id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">\pm</annotation></semantics></math>1.50</td>
<td id="S3.T1.6.6.2" class="ltx_td ltx_align_center">28.80<math id="S3.T1.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.6.6.2.m1.1a"><mo id="S3.T1.6.6.2.m1.1.1" xref="S3.T1.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.2.m1.1b"><csymbol cd="latexml" id="S3.T1.6.6.2.m1.1.1.cmml" xref="S3.T1.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.2.m1.1c">\pm</annotation></semantics></math>1.92</td>
<td id="S3.T1.7.7.3" class="ltx_td ltx_align_center">6.89<math id="S3.T1.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.7.7.3.m1.1a"><mo id="S3.T1.7.7.3.m1.1.1" xref="S3.T1.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.3.m1.1b"><csymbol cd="latexml" id="S3.T1.7.7.3.m1.1.1.cmml" xref="S3.T1.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.3.m1.1c">\pm</annotation></semantics></math>0.09</td>
<td id="S3.T1.8.8.4" class="ltx_td ltx_align_center">5.00<math id="S3.T1.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.8.8.4.m1.1a"><mo id="S3.T1.8.8.4.m1.1.1" xref="S3.T1.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.4.m1.1b"><csymbol cd="latexml" id="S3.T1.8.8.4.m1.1.1.cmml" xref="S3.T1.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.4.m1.1c">\pm</annotation></semantics></math>0.40</td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">SVAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S3.T1.9.9.1" class="ltx_td ltx_align_center">33.32<math id="S3.T1.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.9.9.1.m1.1a"><mo id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><csymbol cd="latexml" id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">\pm</annotation></semantics></math>0.14</td>
<td id="S3.T1.10.10.2" class="ltx_td ltx_align_center">33.14<math id="S3.T1.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.10.10.2.m1.1a"><mo id="S3.T1.10.10.2.m1.1.1" xref="S3.T1.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.2.m1.1b"><csymbol cd="latexml" id="S3.T1.10.10.2.m1.1.1.cmml" xref="S3.T1.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.2.m1.1c">\pm</annotation></semantics></math>0.20</td>
<td id="S3.T1.11.11.3" class="ltx_td ltx_align_center">5.76<math id="S3.T1.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.11.11.3.m1.1a"><mo id="S3.T1.11.11.3.m1.1.1" xref="S3.T1.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.3.m1.1b"><csymbol cd="latexml" id="S3.T1.11.11.3.m1.1.1.cmml" xref="S3.T1.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.3.m1.1c">\pm</annotation></semantics></math>0.44</td>
<td id="S3.T1.12.12.4" class="ltx_td ltx_align_center">5.04<math id="S3.T1.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.12.12.4.m1.1a"><mo id="S3.T1.12.12.4.m1.1.1" xref="S3.T1.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.4.m1.1b"><csymbol cd="latexml" id="S3.T1.12.12.4.m1.1.1.cmml" xref="S3.T1.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.4.m1.1c">\pm</annotation></semantics></math>0.13</td>
</tr>
<tr id="S3.T1.16.16" class="ltx_tr">
<th id="S3.T1.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">DAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S3.T1.13.13.1" class="ltx_td ltx_align_center">37.05<math id="S3.T1.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.13.13.1.m1.1a"><mo id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><csymbol cd="latexml" id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">\pm</annotation></semantics></math>1.42</td>
<td id="S3.T1.14.14.2" class="ltx_td ltx_align_center">44.99<math id="S3.T1.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.14.14.2.m1.1a"><mo id="S3.T1.14.14.2.m1.1.1" xref="S3.T1.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.2.m1.1b"><csymbol cd="latexml" id="S3.T1.14.14.2.m1.1.1.cmml" xref="S3.T1.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.2.m1.1c">\pm</annotation></semantics></math>1.72</td>
<td id="S3.T1.15.15.3" class="ltx_td ltx_align_center">3.56<math id="S3.T1.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.15.15.3.m1.1a"><mo id="S3.T1.15.15.3.m1.1.1" xref="S3.T1.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.3.m1.1b"><csymbol cd="latexml" id="S3.T1.15.15.3.m1.1.1.cmml" xref="S3.T1.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.3.m1.1c">\pm</annotation></semantics></math>0.91</td>
<td id="S3.T1.16.16.4" class="ltx_td ltx_align_center">5.35<math id="S3.T1.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.16.16.4.m1.1a"><mo id="S3.T1.16.16.4.m1.1.1" xref="S3.T1.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.4.m1.1b"><csymbol cd="latexml" id="S3.T1.16.16.4.m1.1.1.cmml" xref="S3.T1.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.4.m1.1c">\pm</annotation></semantics></math>0.45</td>
</tr>
<tr id="S3.T1.20.20" class="ltx_tr">
<th id="S3.T1.20.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">f-AnoGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</th>
<td id="S3.T1.17.17.1" class="ltx_td ltx_align_center">24.16<math id="S3.T1.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.17.17.1.m1.1a"><mo id="S3.T1.17.17.1.m1.1.1" xref="S3.T1.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.1.m1.1b"><csymbol cd="latexml" id="S3.T1.17.17.1.m1.1.1.cmml" xref="S3.T1.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.1.m1.1c">\pm</annotation></semantics></math>2.94</td>
<td id="S3.T1.18.18.2" class="ltx_td ltx_align_center">22.05<math id="S3.T1.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.18.18.2.m1.1a"><mo id="S3.T1.18.18.2.m1.1.1" xref="S3.T1.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.2.m1.1b"><csymbol cd="latexml" id="S3.T1.18.18.2.m1.1.1.cmml" xref="S3.T1.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.2.m1.1c">\pm</annotation></semantics></math>3.05</td>
<td id="S3.T1.19.19.3" class="ltx_td ltx_align_center">4.18<math id="S3.T1.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.19.19.3.m1.1a"><mo id="S3.T1.19.19.3.m1.1.1" xref="S3.T1.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.3.m1.1b"><csymbol cd="latexml" id="S3.T1.19.19.3.m1.1.1.cmml" xref="S3.T1.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.3.m1.1c">\pm</annotation></semantics></math>1.18</td>
<td id="S3.T1.20.20.4" class="ltx_td ltx_align_center">4.01<math id="S3.T1.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.20.20.4.m1.1a"><mo id="S3.T1.20.20.4.m1.1.1" xref="S3.T1.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.4.m1.1b"><csymbol cd="latexml" id="S3.T1.20.20.4.m1.1.1.cmml" xref="S3.T1.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.4.m1.1c">\pm</annotation></semantics></math>0.90</td>
</tr>
<tr id="S3.T1.24.24" class="ltx_tr">
<th id="S3.T1.24.24.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">DDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S3.T1.21.21.1" class="ltx_td ltx_align_center">40.67<math id="S3.T1.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.21.21.1.m1.1a"><mo id="S3.T1.21.21.1.m1.1.1" xref="S3.T1.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.1.m1.1b"><csymbol cd="latexml" id="S3.T1.21.21.1.m1.1.1.cmml" xref="S3.T1.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.1.m1.1c">\pm</annotation></semantics></math>1.21</td>
<td id="S3.T1.22.22.2" class="ltx_td ltx_align_center">49.78<math id="S3.T1.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.22.22.2.m1.1a"><mo id="S3.T1.22.22.2.m1.1.1" xref="S3.T1.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.22.22.2.m1.1b"><csymbol cd="latexml" id="S3.T1.22.22.2.m1.1.1.cmml" xref="S3.T1.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.22.2.m1.1c">\pm</annotation></semantics></math>1.02</td>
<td id="S3.T1.23.23.3" class="ltx_td ltx_align_center">6.42<math id="S3.T1.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.23.23.3.m1.1a"><mo id="S3.T1.23.23.3.m1.1.1" xref="S3.T1.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.23.23.3.m1.1b"><csymbol cd="latexml" id="S3.T1.23.23.3.m1.1.1.cmml" xref="S3.T1.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.23.3.m1.1c">\pm</annotation></semantics></math>1.60</td>
<td id="S3.T1.24.24.4" class="ltx_td ltx_align_center">7.44<math id="S3.T1.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.24.24.4.m1.1a"><mo id="S3.T1.24.24.4.m1.1.1" xref="S3.T1.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.24.24.4.m1.1b"><csymbol cd="latexml" id="S3.T1.24.24.4.m1.1.1.cmml" xref="S3.T1.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.24.4.m1.1c">\pm</annotation></semantics></math>0.52</td>
</tr>
<tr id="S3.T1.28.28" class="ltx_tr">
<th id="S3.T1.28.28.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">mDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S3.T1.25.25.1" class="ltx_td ltx_align_center"><span id="S3.T1.25.25.1.1" class="ltx_text ltx_framed ltx_framed_underline">51.31<math id="S3.T1.25.25.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.25.25.1.1.m1.1a"><mo id="S3.T1.25.25.1.1.m1.1.1" xref="S3.T1.25.25.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.25.25.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.25.25.1.1.m1.1.1.cmml" xref="S3.T1.25.25.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.25.1.1.m1.1c">\pm</annotation></semantics></math>0.66</span></td>
<td id="S3.T1.26.26.2" class="ltx_td ltx_align_center"><span id="S3.T1.26.26.2.1" class="ltx_text ltx_framed ltx_framed_underline">57.09<math id="S3.T1.26.26.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.26.26.2.1.m1.1a"><mo id="S3.T1.26.26.2.1.m1.1.1" xref="S3.T1.26.26.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.26.26.2.1.m1.1b"><csymbol cd="latexml" id="S3.T1.26.26.2.1.m1.1.1.cmml" xref="S3.T1.26.26.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.26.2.1.m1.1c">\pm</annotation></semantics></math>0.94</span></td>
<td id="S3.T1.27.27.3" class="ltx_td ltx_align_center">8.08<math id="S3.T1.27.27.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.27.27.3.m1.1a"><mo id="S3.T1.27.27.3.m1.1.1" xref="S3.T1.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.27.27.3.m1.1b"><csymbol cd="latexml" id="S3.T1.27.27.3.m1.1.1.cmml" xref="S3.T1.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.27.3.m1.1c">\pm</annotation></semantics></math>0.70</td>
<td id="S3.T1.28.28.4" class="ltx_td ltx_align_center">9.06<math id="S3.T1.28.28.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.28.28.4.m1.1a"><mo id="S3.T1.28.28.4.m1.1.1" xref="S3.T1.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.28.28.4.m1.1b"><csymbol cd="latexml" id="S3.T1.28.28.4.m1.1.1.cmml" xref="S3.T1.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.28.28.4.m1.1c">\pm</annotation></semantics></math>0.62</td>
</tr>
<tr id="S3.T1.32.32" class="ltx_tr">
<th id="S3.T1.32.32.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S3.T1.29.29.1" class="ltx_td ltx_align_center">49.41<math id="S3.T1.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.29.29.1.m1.1a"><mo id="S3.T1.29.29.1.m1.1.1" xref="S3.T1.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.29.29.1.m1.1b"><csymbol cd="latexml" id="S3.T1.29.29.1.m1.1.1.cmml" xref="S3.T1.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.29.29.1.m1.1c">\pm</annotation></semantics></math>0.66</td>
<td id="S3.T1.30.30.2" class="ltx_td ltx_align_center">54.76<math id="S3.T1.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.30.30.2.m1.1a"><mo id="S3.T1.30.30.2.m1.1.1" xref="S3.T1.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.30.30.2.m1.1b"><csymbol cd="latexml" id="S3.T1.30.30.2.m1.1.1.cmml" xref="S3.T1.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.30.30.2.m1.1c">\pm</annotation></semantics></math>0.83</td>
<td id="S3.T1.31.31.3" class="ltx_td ltx_align_center"><span id="S3.T1.31.31.3.1" class="ltx_text ltx_framed ltx_framed_underline">10.65<math id="S3.T1.31.31.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.31.31.3.1.m1.1a"><mo id="S3.T1.31.31.3.1.m1.1.1" xref="S3.T1.31.31.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.31.31.3.1.m1.1b"><csymbol cd="latexml" id="S3.T1.31.31.3.1.m1.1.1.cmml" xref="S3.T1.31.31.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.31.31.3.1.m1.1c">\pm</annotation></semantics></math>1.05</span></td>
<td id="S3.T1.32.32.4" class="ltx_td ltx_align_center"><span id="S3.T1.32.32.4.1" class="ltx_text ltx_framed ltx_framed_underline">10.37<math id="S3.T1.32.32.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.32.32.4.1.m1.1a"><mo id="S3.T1.32.32.4.1.m1.1.1" xref="S3.T1.32.32.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.32.32.4.1.m1.1b"><csymbol cd="latexml" id="S3.T1.32.32.4.1.m1.1.1.cmml" xref="S3.T1.32.32.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.32.32.4.1.m1.1c">\pm</annotation></semantics></math>0.51</span></td>
</tr>
<tr id="S3.T1.36.36" class="ltx_tr" style="background-color:#CCCCCC;">
<th id="S3.T1.36.36.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S3.T1.36.36.5.1" class="ltx_text" style="background-color:#CCCCCC;">pDDPM-IQA (ours)</span></th>
<td id="S3.T1.33.33.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T1.33.33.1.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">59.45<math id="S3.T1.33.33.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.33.33.1.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T1.33.33.1.1.m1.1.1" xref="S3.T1.33.33.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.33.33.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.33.33.1.1.m1.1.1.cmml" xref="S3.T1.33.33.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.33.33.1.1.m1.1c">\pm</annotation></semantics></math>0.37</span></td>
<td id="S3.T1.34.34.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T1.34.34.2.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">62.99<math id="S3.T1.34.34.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.34.34.2.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T1.34.34.2.1.m1.1.1" xref="S3.T1.34.34.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.34.34.2.1.m1.1b"><csymbol cd="latexml" id="S3.T1.34.34.2.1.m1.1.1.cmml" xref="S3.T1.34.34.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.34.34.2.1.m1.1c">\pm</annotation></semantics></math>0.37</span></td>
<td id="S3.T1.35.35.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T1.35.35.3.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">12.93<math id="S3.T1.35.35.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.35.35.3.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T1.35.35.3.1.m1.1.1" xref="S3.T1.35.35.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.35.35.3.1.m1.1b"><csymbol cd="latexml" id="S3.T1.35.35.3.1.m1.1.1.cmml" xref="S3.T1.35.35.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.35.35.3.1.m1.1c">\pm</annotation></semantics></math>0.67</span></td>
<td id="S3.T1.36.36.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T1.36.36.4.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">11.51<math id="S3.T1.36.36.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T1.36.36.4.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T1.36.36.4.1.m1.1.1" xref="S3.T1.36.36.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.36.36.4.1.m1.1b"><csymbol cd="latexml" id="S3.T1.36.36.4.1.m1.1.1.cmml" xref="S3.T1.36.36.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.36.36.4.1.m1.1c">\pm</annotation></semantics></math>0.50</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2408.08228/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="442" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Qualitative visualization on the BraTS21 test set. Columns 2-5 show anomaly maps from different methods for three samples.</figcaption>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Comparison with baselines in terms of DICE and AUPRC on BraTS21 using FLAIR and T1-CE modalities in an <span id="S3.T2.18.1" class="ltx_text ltx_font_bold">intra-dataset</span> setting. The model is trained on a subset of healthy slices from BraTS21.</figcaption>
<table id="S3.T2.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.16.17.1" class="ltx_tr">
<th id="S3.T2.16.17.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T2.16.17.1.1.1" class="ltx_text">Method</span></th>
<th id="S3.T2.16.17.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (FLAIR)</th>
<th id="S3.T2.16.17.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (T1-CE)</th>
</tr>
<tr id="S3.T2.16.18.2" class="ltx_tr">
<th id="S3.T2.16.18.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE [%]</th>
<th id="S3.T2.16.18.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC [%]</th>
<th id="S3.T2.16.18.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE [%]</th>
<th id="S3.T2.16.18.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC [%]</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.4.4" class="ltx_tr">
<th id="S3.T2.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">DAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t">29.12<math id="S3.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">\pm</annotation></semantics></math>2.78</td>
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">28.52<math id="S3.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.2.2.2.m1.1a"><mo id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">\pm</annotation></semantics></math>2.91</td>
<td id="S3.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_t">36.52<math id="S3.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.3.3.3.m1.1a"><mo id="S3.T2.3.3.3.m1.1.1" xref="S3.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T2.3.3.3.m1.1.1.cmml" xref="S3.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.m1.1c">\pm</annotation></semantics></math>0.77</td>
<td id="S3.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_t">42.10<math id="S3.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.4.4.4.m1.1a"><mo id="S3.T2.4.4.4.m1.1.1" xref="S3.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S3.T2.4.4.4.m1.1.1.cmml" xref="S3.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.m1.1c">\pm</annotation></semantics></math>0.82</td>
</tr>
<tr id="S3.T2.8.8" class="ltx_tr">
<th id="S3.T2.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">DDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S3.T2.5.5.1" class="ltx_td ltx_align_center">21.13<math id="S3.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.5.5.1.m1.1a"><mo id="S3.T2.5.5.1.m1.1.1" xref="S3.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S3.T2.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.1.m1.1c">\pm</annotation></semantics></math>2.35</td>
<td id="S3.T2.6.6.2" class="ltx_td ltx_align_center">19.89<math id="S3.T2.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.6.6.2.m1.1a"><mo id="S3.T2.6.6.2.m1.1.1" xref="S3.T2.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S3.T2.6.6.2.m1.1.1.cmml" xref="S3.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.2.m1.1c">\pm</annotation></semantics></math>4.06</td>
<td id="S3.T2.7.7.3" class="ltx_td ltx_align_center">30.98<math id="S3.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.7.7.3.m1.1a"><mo id="S3.T2.7.7.3.m1.1.1" xref="S3.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S3.T2.7.7.3.m1.1.1.cmml" xref="S3.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.3.m1.1c">\pm</annotation></semantics></math>2.57</td>
<td id="S3.T2.8.8.4" class="ltx_td ltx_align_center">34.69<math id="S3.T2.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.8.8.4.m1.1a"><mo id="S3.T2.8.8.4.m1.1.1" xref="S3.T2.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.4.m1.1b"><csymbol cd="latexml" id="S3.T2.8.8.4.m1.1.1.cmml" xref="S3.T2.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.4.m1.1c">\pm</annotation></semantics></math>2.77</td>
</tr>
<tr id="S3.T2.12.12" class="ltx_tr">
<th id="S3.T2.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S3.T2.9.9.1" class="ltx_td ltx_align_center"><span id="S3.T2.9.9.1.1" class="ltx_text ltx_framed ltx_framed_underline">42.63<math id="S3.T2.9.9.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.9.9.1.1.m1.1a"><mo id="S3.T2.9.9.1.1.m1.1.1" xref="S3.T2.9.9.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.9.9.1.1.m1.1.1.cmml" xref="S3.T2.9.9.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.1.1.m1.1c">\pm</annotation></semantics></math>2.51</span></td>
<td id="S3.T2.10.10.2" class="ltx_td ltx_align_center"><span id="S3.T2.10.10.2.1" class="ltx_text ltx_framed ltx_framed_underline">46.00<math id="S3.T2.10.10.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.10.10.2.1.m1.1a"><mo id="S3.T2.10.10.2.1.m1.1.1" xref="S3.T2.10.10.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.10.10.2.1.m1.1.1.cmml" xref="S3.T2.10.10.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.2.1.m1.1c">\pm</annotation></semantics></math>2.75</span></td>
<td id="S3.T2.11.11.3" class="ltx_td ltx_align_center"><span id="S3.T2.11.11.3.1" class="ltx_text ltx_framed ltx_framed_underline">43.85<math id="S3.T2.11.11.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.11.11.3.1.m1.1a"><mo id="S3.T2.11.11.3.1.m1.1.1" xref="S3.T2.11.11.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.11.11.3.1.m1.1.1.cmml" xref="S3.T2.11.11.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.3.1.m1.1c">\pm</annotation></semantics></math>2.11</span></td>
<td id="S3.T2.12.12.4" class="ltx_td ltx_align_center"><span id="S3.T2.12.12.4.1" class="ltx_text ltx_font_bold">49.06<math id="S3.T2.12.12.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.12.12.4.1.m1.1a"><mo id="S3.T2.12.12.4.1.m1.1.1" xref="S3.T2.12.12.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.4.1.m1.1b"><csymbol cd="latexml" id="S3.T2.12.12.4.1.m1.1.1.cmml" xref="S3.T2.12.12.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.4.1.m1.1c">\pm</annotation></semantics></math>2.69</span></td>
</tr>
<tr id="S3.T2.16.16" class="ltx_tr" style="background-color:#CCCCCC;">
<th id="S3.T2.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S3.T2.16.16.5.1" class="ltx_text" style="background-color:#CCCCCC;">pDDPM-IQA (ours)</span></th>
<td id="S3.T2.13.13.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.13.13.1.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">55.77<math id="S3.T2.13.13.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.13.13.1.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T2.13.13.1.1.m1.1.1" xref="S3.T2.13.13.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.13.13.1.1.m1.1.1.cmml" xref="S3.T2.13.13.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.1.1.m1.1c">\pm</annotation></semantics></math>1.78</span></td>
<td id="S3.T2.14.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.14.14.2.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">58.27<math id="S3.T2.14.14.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.14.14.2.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T2.14.14.2.1.m1.1.1" xref="S3.T2.14.14.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.14.14.2.1.m1.1.1.cmml" xref="S3.T2.14.14.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.2.1.m1.1c">\pm</annotation></semantics></math>2.07</span></td>
<td id="S3.T2.15.15.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.15.15.3.1" class="ltx_text ltx_font_bold" style="background-color:#CCCCCC;">46.16<math id="S3.T2.15.15.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.15.15.3.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T2.15.15.3.1.m1.1.1" xref="S3.T2.15.15.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.15.15.3.1.m1.1.1.cmml" xref="S3.T2.15.15.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.3.1.m1.1c">\pm</annotation></semantics></math>2.09</span></td>
<td id="S3.T2.16.16.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.16.16.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#CCCCCC;">47.55<math id="S3.T2.16.16.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.16.16.4.1.m1.1a"><mo mathbackground="#CCCCCC" id="S3.T2.16.16.4.1.m1.1.1" xref="S3.T2.16.16.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.16.16.4.1.m1.1b"><csymbol cd="latexml" id="S3.T2.16.16.4.1.m1.1.1.cmml" xref="S3.T2.16.16.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.16.16.4.1.m1.1c">\pm</annotation></semantics></math>2.66</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Ablation study results evaluated on BraTS21 using the FLAIR modality.</figcaption>
<table id="S3.T3.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.12.13.1" class="ltx_tr">
<th id="S3.T3.12.13.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="S3.T3.12.13.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">DICE [%]</th>
<th id="S3.T3.12.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">AUPRC [%]</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.2.2" class="ltx_tr">
<th id="S3.T3.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">pDDPM</th>
<td id="S3.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_t">42.63<math id="S3.T3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.m1.1.1" xref="S3.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.m1.1c">\pm</annotation></semantics></math>2.51</td>
<td id="S3.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t">46.00<math id="S3.T3.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.2.2.2.m1.1a"><mo id="S3.T3.2.2.2.m1.1.1" xref="S3.T3.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T3.2.2.2.m1.1.1.cmml" xref="S3.T3.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.m1.1c">\pm</annotation></semantics></math>2.75</td>
</tr>
<tr id="S3.T3.5.5" class="ltx_tr">
<th id="S3.T3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">pDDPM + <math id="S3.T3.3.3.1.m1.1" class="ltx_Math" alttext="L_{SSIM}" display="inline"><semantics id="S3.T3.3.3.1.m1.1a"><msub id="S3.T3.3.3.1.m1.1.1" xref="S3.T3.3.3.1.m1.1.1.cmml"><mi id="S3.T3.3.3.1.m1.1.1.2" xref="S3.T3.3.3.1.m1.1.1.2.cmml">L</mi><mrow id="S3.T3.3.3.1.m1.1.1.3" xref="S3.T3.3.3.1.m1.1.1.3.cmml"><mi id="S3.T3.3.3.1.m1.1.1.3.2" xref="S3.T3.3.3.1.m1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.T3.3.3.1.m1.1.1.3.1" xref="S3.T3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T3.3.3.1.m1.1.1.3.3" xref="S3.T3.3.3.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.T3.3.3.1.m1.1.1.3.1a" xref="S3.T3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T3.3.3.1.m1.1.1.3.4" xref="S3.T3.3.3.1.m1.1.1.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.T3.3.3.1.m1.1.1.3.1b" xref="S3.T3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T3.3.3.1.m1.1.1.3.5" xref="S3.T3.3.3.1.m1.1.1.3.5.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.1.m1.1b"><apply id="S3.T3.3.3.1.m1.1.1.cmml" xref="S3.T3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.3.3.1.m1.1.1.1.cmml" xref="S3.T3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T3.3.3.1.m1.1.1.2.cmml" xref="S3.T3.3.3.1.m1.1.1.2">𝐿</ci><apply id="S3.T3.3.3.1.m1.1.1.3.cmml" xref="S3.T3.3.3.1.m1.1.1.3"><times id="S3.T3.3.3.1.m1.1.1.3.1.cmml" xref="S3.T3.3.3.1.m1.1.1.3.1"></times><ci id="S3.T3.3.3.1.m1.1.1.3.2.cmml" xref="S3.T3.3.3.1.m1.1.1.3.2">𝑆</ci><ci id="S3.T3.3.3.1.m1.1.1.3.3.cmml" xref="S3.T3.3.3.1.m1.1.1.3.3">𝑆</ci><ci id="S3.T3.3.3.1.m1.1.1.3.4.cmml" xref="S3.T3.3.3.1.m1.1.1.3.4">𝐼</ci><ci id="S3.T3.3.3.1.m1.1.1.3.5.cmml" xref="S3.T3.3.3.1.m1.1.1.3.5">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.1.m1.1c">L_{SSIM}</annotation></semantics></math>
</th>
<td id="S3.T3.4.4.2" class="ltx_td ltx_align_center">47.89<math id="S3.T3.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.4.4.2.m1.1a"><mo id="S3.T3.4.4.2.m1.1.1" xref="S3.T3.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.2.m1.1b"><csymbol cd="latexml" id="S3.T3.4.4.2.m1.1.1.cmml" xref="S3.T3.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.2.m1.1c">\pm</annotation></semantics></math>1.51</td>
<td id="S3.T3.5.5.3" class="ltx_td ltx_align_center">46.14<math id="S3.T3.5.5.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.5.5.3.m1.1a"><mo id="S3.T3.5.5.3.m1.1.1" xref="S3.T3.5.5.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.3.m1.1b"><csymbol cd="latexml" id="S3.T3.5.5.3.m1.1.1.cmml" xref="S3.T3.5.5.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.3.m1.1c">\pm</annotation></semantics></math>1.56</td>
</tr>
<tr id="S3.T3.8.8" class="ltx_tr">
<th id="S3.T3.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">pDDPM + <math id="S3.T3.6.6.1.m1.1" class="ltx_Math" alttext="L_{FQ}" display="inline"><semantics id="S3.T3.6.6.1.m1.1a"><msub id="S3.T3.6.6.1.m1.1.1" xref="S3.T3.6.6.1.m1.1.1.cmml"><mi id="S3.T3.6.6.1.m1.1.1.2" xref="S3.T3.6.6.1.m1.1.1.2.cmml">L</mi><mrow id="S3.T3.6.6.1.m1.1.1.3" xref="S3.T3.6.6.1.m1.1.1.3.cmml"><mi id="S3.T3.6.6.1.m1.1.1.3.2" xref="S3.T3.6.6.1.m1.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.T3.6.6.1.m1.1.1.3.1" xref="S3.T3.6.6.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T3.6.6.1.m1.1.1.3.3" xref="S3.T3.6.6.1.m1.1.1.3.3.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.1.m1.1b"><apply id="S3.T3.6.6.1.m1.1.1.cmml" xref="S3.T3.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.6.6.1.m1.1.1.1.cmml" xref="S3.T3.6.6.1.m1.1.1">subscript</csymbol><ci id="S3.T3.6.6.1.m1.1.1.2.cmml" xref="S3.T3.6.6.1.m1.1.1.2">𝐿</ci><apply id="S3.T3.6.6.1.m1.1.1.3.cmml" xref="S3.T3.6.6.1.m1.1.1.3"><times id="S3.T3.6.6.1.m1.1.1.3.1.cmml" xref="S3.T3.6.6.1.m1.1.1.3.1"></times><ci id="S3.T3.6.6.1.m1.1.1.3.2.cmml" xref="S3.T3.6.6.1.m1.1.1.3.2">𝐹</ci><ci id="S3.T3.6.6.1.m1.1.1.3.3.cmml" xref="S3.T3.6.6.1.m1.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.1.m1.1c">L_{FQ}</annotation></semantics></math>
</th>
<td id="S3.T3.7.7.2" class="ltx_td ltx_align_center">50.15<math id="S3.T3.7.7.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.7.7.2.m1.1a"><mo id="S3.T3.7.7.2.m1.1.1" xref="S3.T3.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.2.m1.1b"><csymbol cd="latexml" id="S3.T3.7.7.2.m1.1.1.cmml" xref="S3.T3.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.2.m1.1c">\pm</annotation></semantics></math>1.08</td>
<td id="S3.T3.8.8.3" class="ltx_td ltx_align_center">49.34<math id="S3.T3.8.8.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.8.8.3.m1.1a"><mo id="S3.T3.8.8.3.m1.1.1" xref="S3.T3.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.3.m1.1b"><csymbol cd="latexml" id="S3.T3.8.8.3.m1.1.1.cmml" xref="S3.T3.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.3.m1.1c">\pm</annotation></semantics></math>1.04</td>
</tr>
<tr id="S3.T3.12.12" class="ltx_tr">
<th id="S3.T3.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">pDDPM + <math id="S3.T3.9.9.1.m1.1" class="ltx_Math" alttext="L_{FQ}" display="inline"><semantics id="S3.T3.9.9.1.m1.1a"><msub id="S3.T3.9.9.1.m1.1.1" xref="S3.T3.9.9.1.m1.1.1.cmml"><mi id="S3.T3.9.9.1.m1.1.1.2" xref="S3.T3.9.9.1.m1.1.1.2.cmml">L</mi><mrow id="S3.T3.9.9.1.m1.1.1.3" xref="S3.T3.9.9.1.m1.1.1.3.cmml"><mi id="S3.T3.9.9.1.m1.1.1.3.2" xref="S3.T3.9.9.1.m1.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.T3.9.9.1.m1.1.1.3.1" xref="S3.T3.9.9.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T3.9.9.1.m1.1.1.3.3" xref="S3.T3.9.9.1.m1.1.1.3.3.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.1.m1.1b"><apply id="S3.T3.9.9.1.m1.1.1.cmml" xref="S3.T3.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.9.9.1.m1.1.1.1.cmml" xref="S3.T3.9.9.1.m1.1.1">subscript</csymbol><ci id="S3.T3.9.9.1.m1.1.1.2.cmml" xref="S3.T3.9.9.1.m1.1.1.2">𝐿</ci><apply id="S3.T3.9.9.1.m1.1.1.3.cmml" xref="S3.T3.9.9.1.m1.1.1.3"><times id="S3.T3.9.9.1.m1.1.1.3.1.cmml" xref="S3.T3.9.9.1.m1.1.1.3.1"></times><ci id="S3.T3.9.9.1.m1.1.1.3.2.cmml" xref="S3.T3.9.9.1.m1.1.1.3.2">𝐹</ci><ci id="S3.T3.9.9.1.m1.1.1.3.3.cmml" xref="S3.T3.9.9.1.m1.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.1.m1.1c">L_{FQ}</annotation></semantics></math> + AIR<math id="S3.T3.10.10.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S3.T3.10.10.2.m2.1a"><mo stretchy="false" id="S3.T3.10.10.2.m2.1.1" xref="S3.T3.10.10.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.10.10.2.m2.1b"><ci id="S3.T3.10.10.2.m2.1.1.cmml" xref="S3.T3.10.10.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.10.2.m2.1c">\uparrow</annotation></semantics></math> (pDDPM-IQA)</th>
<td id="S3.T3.11.11.3" class="ltx_td ltx_align_center ltx_border_bb">55.77<math id="S3.T3.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.11.11.3.m1.1a"><mo id="S3.T3.11.11.3.m1.1.1" xref="S3.T3.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.11.11.3.m1.1b"><csymbol cd="latexml" id="S3.T3.11.11.3.m1.1.1.cmml" xref="S3.T3.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.11.3.m1.1c">\pm</annotation></semantics></math>1.78</td>
<td id="S3.T3.12.12.4" class="ltx_td ltx_align_center ltx_border_bb">58.27<math id="S3.T3.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.12.12.4.m1.1a"><mo id="S3.T3.12.12.4.m1.1.1" xref="S3.T3.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.12.12.4.m1.1b"><csymbol cd="latexml" id="S3.T3.12.12.4.m1.1.1.cmml" xref="S3.T3.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.12.4.m1.1c">\pm</annotation></semantics></math>2.07</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Performance of DDPM-IQA Compared to the Baseline DDPM on Brain MRI Datasets</figcaption>
<div id="S3.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:37.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-97.9pt,17.1pt) scale(0.525493315455018,0.525493315455018) ;">
<table id="S3.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.1.1.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T4.1.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S3.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (T2)</th>
<th id="S3.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">MSLUB (T2)</th>
<th id="S3.T4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (FLAIR)</th>
<th id="S3.T4.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BraTS21 (T1-CE)</th>
</tr>
<tr id="S3.T4.1.1.2.2" class="ltx_tr">
<th id="S3.T4.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE</th>
<th id="S3.T4.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC</th>
<th id="S3.T4.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE</th>
<th id="S3.T4.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC</th>
<th id="S3.T4.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE</th>
<th id="S3.T4.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC</th>
<th id="S3.T4.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DICE</th>
<th id="S3.T4.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">AUPRC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.1.1.3.1" class="ltx_tr">
<th id="S3.T4.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">DDPM</th>
<td id="S3.T4.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">40.67</td>
<td id="S3.T4.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">49.78</td>
<td id="S3.T4.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">6.42</td>
<td id="S3.T4.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">7.44</td>
<td id="S3.T4.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">21.13</td>
<td id="S3.T4.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">19.89</td>
<td id="S3.T4.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t">30.98</td>
<td id="S3.T4.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t">34.69</td>
</tr>
<tr id="S3.T4.1.1.4.2" class="ltx_tr">
<th id="S3.T4.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">DDPM-IQA</th>
<td id="S3.T4.1.1.4.2.2" class="ltx_td ltx_align_center ltx_border_bb">62.02</td>
<td id="S3.T4.1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_bb">65.53</td>
<td id="S3.T4.1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_bb">11.93</td>
<td id="S3.T4.1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_bb">11.17</td>
<td id="S3.T4.1.1.4.2.6" class="ltx_td ltx_align_center ltx_border_bb">44.98</td>
<td id="S3.T4.1.1.4.2.7" class="ltx_td ltx_align_center ltx_border_bb">48.34</td>
<td id="S3.T4.1.1.4.2.8" class="ltx_td ltx_align_center ltx_border_bb">45.40</td>
<td id="S3.T4.1.1.4.2.9" class="ltx_td ltx_align_center ltx_border_bb">47.36</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We conduct our experiments under both cross-dataset and intra-dataset settings using three publicly available datasets: the Multimodal Brain Tumor Segmentation Challenge 2021 (BraTS21) dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, the multiple sclerosis dataset from the University Hospital of Ljubljana (MSLUB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and the IXI dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The BraTS21 dataset contains 1251 brain MRI scans with four modalities (T1, T1-CE, T2, FLAIR).
The MSLUB dateset consists of brain MRI scans from 30 multiple sclerosis (MS) patients, each having T1, T2, and FLAIR-weighted scans.
The IXI dataset includes 560 pairs of T1 and T2-weighted healthy brain MRI scans.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">In the cross-dataset setting, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and perform five-fold cross-validation, training the model on healthy T2-weighted scans from IXI and evaluating it on T2-weighted scans from BraTS21 and MSLUB.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">In the intra-dataset setting, we perform five-fold cross-validation on FLAIR and T1-CE scans from BraTS21. For each fold, the slices without tumors are extracted from 60% and 10% of the patients for model training and training-phase validation, respectively. The remaining 30% of the patients are split, with 10% used as the unhealthy validation set and 20% as the test set.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">We pre-process all datasets using resampling, skull-stripping, and registration, as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">We train the model on an NVIDIA A10 GPU using the Adam optimizer, with a learning rate of 1e-4 and a batch size of 32. We use the default settings in pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> including using simplex noise as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, uniformly sampling noise levels <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="t\in[1,T]" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.3" xref="S4.SS2.p1.1.m1.2.3.cmml"><mi id="S4.SS2.p1.1.m1.2.3.2" xref="S4.SS2.p1.1.m1.2.3.2.cmml">t</mi><mo id="S4.SS2.p1.1.m1.2.3.1" xref="S4.SS2.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p1.1.m1.2.3.3.2" xref="S4.SS2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.2.3.3.2.1" xref="S4.SS2.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">1</mn><mo id="S4.SS2.p1.1.m1.2.3.3.2.2" xref="S4.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml">T</mi><mo stretchy="false" id="S4.SS2.p1.1.m1.2.3.3.2.3" xref="S4.SS2.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.3.cmml" xref="S4.SS2.p1.1.m1.2.3"><in id="S4.SS2.p1.1.m1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3.1"></in><ci id="S4.SS2.p1.1.m1.2.3.2.cmml" xref="S4.SS2.p1.1.m1.2.3.2">𝑡</ci><interval closure="closed" id="S4.SS2.p1.1.m1.2.3.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3.3.2"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">1</cn><ci id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2">𝑇</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">t\in[1,T]</annotation></semantics></math> with <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><eq id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">T=1000</annotation></semantics></math> during training, and training for 1600 epochs. For evaluation, we set the noise level <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="t_{test}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">t</mi><mrow id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.1" xref="S4.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.1a" xref="S4.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.3.4" xref="S4.SS2.p1.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.1b" xref="S4.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.3.5" xref="S4.SS2.p1.3.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑡</ci><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><times id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.3.m3.1.1.3.4.cmml" xref="S4.SS2.p1.3.m3.1.1.3.4">𝑠</ci><ci id="S4.SS2.p1.3.m3.1.1.3.5.cmml" xref="S4.SS2.p1.3.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">t_{test}</annotation></semantics></math> to 500 for BraTS21 (T2) and 750 for the others.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">To enhance the quality of the anomaly map, we employ standard post-processing techniques. First, we apply a median filter with a kernel size of <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="K_{M}=5" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml">K</mi><mi id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml">M</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">𝐾</ci><ci id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">𝑀</ci></apply><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">K_{M}=5</annotation></semantics></math> to smooth the anomaly scores, followed by three iterations of brain mask erosion. To determine the optimal binarization threshold, we perform a greedy search on the unhealthy validation set, iteratively calculating Dice scores for various thresholds. The best threshold identified is then used to compute Dice and AUPRC on the unhealthy test set.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Comparisons with State-of-the-art Methods</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We evaluate the effectiveness of our method against Thresh <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, AE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, SVAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, DAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, f-AnoGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, DDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, mDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and pDDPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, in terms of Dice-Coefficient (DICE) and the average Area Under the Precision-Recall Curve (AUPRC). Results are reported as “mean<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mo id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\pm</annotation></semantics></math>std” across five folds.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">In Table <a href="#S3.T1" title="TABLE I ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, we compare our pDDPM-IQA with state-of-the-art methods on BraTS21 and MSLUB using T2 modality in a <span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">cross-dataset</span> setting, as adopted in previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Our pDDPM-IQA significantly (p <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mo id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><lt id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">&lt;</annotation></semantics></math> 0.05) outperforms all baseline approaches on both datasets in terms of DICE and AUPRC, with improvements exceeding 10%.
Qualitative examples of anomaly maps generated by our method and other models are shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, demonstrating that pDDPM-IQA provides more precise anomaly detection.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">In Table <a href="#S3.T2" title="TABLE II ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, we evaluate our method using FLAIR and T1-CE modalities from the BraTS21 dataset in an <span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">intra-dataset</span> setting. pDDPM-IQA achieves state-of-the-art (SOTA) performance (p <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mo id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><lt id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">&lt;</annotation></semantics></math> 0.05) on the BraTS21 FLAIR dataset, excelling in both DICE and AUPRC. For the BraTS21 T1-CE dataset, pDDPM-IQA also attains SOTA performance in terms of DICE and shows competitive performance in AUPRC, demonstrating its superior capability in accurately detecting and segmenting anomalies.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.5" class="ltx_p">In Table <a href="#S3.T3" title="TABLE III ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we present the ablation study results on the BraTS21 dataset using the FLAIR modality, highlighting the effectiveness of our proposed fusion quality loss and AIR enhancement pre-processing strategy. The baseline pDDPM model (using <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\ell_{1}</annotation></semantics></math>) achieves a DICE score of 42.63% and an AUPRC of 46.00%. Incorporating the <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="L_{SSIM}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.p1.2.m2.1.1.3.2" xref="S4.SS4.p1.2.m2.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.3" xref="S4.SS4.p1.2.m2.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1a" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.4" xref="S4.SS4.p1.2.m2.1.1.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.2.m2.1.1.3.1b" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.2.m2.1.1.3.5" xref="S4.SS4.p1.2.m2.1.1.3.5.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝐿</ci><apply id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><times id="S4.SS4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.p1.2.m2.1.1.3.1"></times><ci id="S4.SS4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.p1.2.m2.1.1.3.2">𝑆</ci><ci id="S4.SS4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3.3">𝑆</ci><ci id="S4.SS4.p1.2.m2.1.1.3.4.cmml" xref="S4.SS4.p1.2.m2.1.1.3.4">𝐼</ci><ci id="S4.SS4.p1.2.m2.1.1.3.5.cmml" xref="S4.SS4.p1.2.m2.1.1.3.5">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">L_{SSIM}</annotation></semantics></math> component slightly improves the results, with a DICE score of 47.89% and an AUPRC of 46.14%, indicating a benefit from structural similarity in anomaly detection. Further enhancement using the fusion quality loss <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="L_{FQ}" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><msub id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.3.m3.1.1.3.1" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝐿</ci><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><times id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3.1"></times><ci id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">𝐹</ci><ci id="S4.SS4.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">L_{FQ}</annotation></semantics></math> (<math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">ℓ</mi><mn id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">ℓ</ci><cn type="integer" id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\ell_{1}</annotation></semantics></math> + <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="L_{SSIM}" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><msub id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.3.2" xref="S4.SS4.p1.5.m5.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.3.1" xref="S4.SS4.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.5.m5.1.1.3.3" xref="S4.SS4.p1.5.m5.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.3.1a" xref="S4.SS4.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.5.m5.1.1.3.4" xref="S4.SS4.p1.5.m5.1.1.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.3.1b" xref="S4.SS4.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.5.m5.1.1.3.5" xref="S4.SS4.p1.5.m5.1.1.3.5.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝐿</ci><apply id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3"><times id="S4.SS4.p1.5.m5.1.1.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.3.1"></times><ci id="S4.SS4.p1.5.m5.1.1.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.3.2">𝑆</ci><ci id="S4.SS4.p1.5.m5.1.1.3.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3.3">𝑆</ci><ci id="S4.SS4.p1.5.m5.1.1.3.4.cmml" xref="S4.SS4.p1.5.m5.1.1.3.4">𝐼</ci><ci id="S4.SS4.p1.5.m5.1.1.3.5.cmml" xref="S4.SS4.p1.5.m5.1.1.3.5">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">L_{SSIM}</annotation></semantics></math>) yields a notable increase, achieving a DICE score of 50.15% and an AUPRC of 49.34%. Another significant improvement is observed with the addition of the AIR enhancement strategy, where pDDPM-IQA attains a DICE score of 55.77% and an AUPRC of 58.27%. These results demonstrate the substantial impact of the IQA approach, validating their effectiveness in improving the model’s anomaly detection capabilities.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Additional Experiments</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">To verify the generalization of our approach, we apply our IQA approach to another baseline, DDPM, and termed it DDPM-IQA. We evaluate it on BraTS21 T2, MSLUB, BraTS21 FLAIR, and BraTS21 T1-CE, using the same settings as in Table <a href="#S3.T1" title="TABLE I ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Table <a href="#S3.T2" title="TABLE II ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. The results in Table <a href="#S3.T4" title="TABLE IV ‣ III-C Average Intensity Ratio Enhancement ‣ III Method ‣ Rethinking Medical Anomaly Detection in Brain MRI: An Image Quality Assessment Perspective" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> demonstrate that the proposed IQA approach significantly enhances the performance of DDPM across all datasets, even achieving SOTA performance on the BraTS21 T2 dataset. These findings confirm that our IQA approach is broadly applicable to various reconstruction-based anomaly detection methods in Brain MRI.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Discussion and Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this study, we investigated reconstruction-based anomaly detection in brain MRI from an image quality assessment (IQA) perspective and proposed a novel IQA approach for medical anomaly detection. Our approach comprises two key components:
1) we introduced the incorporation of SSIM loss into the commonly used <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\ell_{1}</annotation></semantics></math> loss, resulting in a fusion quality loss function that more accurately captures the discrepancies between reconstructed and original images. 2) Additionally, we proposed a dataset pre-processing strategy to increase the average intensity ratio (AIR) between normal and abnormal regions.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We apply our IQA approach on a baseline pDDPM model (denoted as pDDPM-IQA in the paper), and it significantly outperforms existing state-of-the-art approaches in terms of DICE and AUPRC across multiple datasets.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">It is worth noting that the proposed fusion quality loss and AIR enhancement strategy are specific implementations under the broader IQA approach.
Therefore, further research into new metrics that better assess image quality than the current fusion quality loss could be a valuable direction. Additionally, while our AIR enhancement strategy is tailored to brain MRI images, developing similar strategies for other medical imaging datasets to further improve anomaly detection performance is worth trying.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">J. C. is funded by the Federal Ministry of Education and Research (Bundesministerium für Bildung und Forschung, BMBF) in Germany under the funding reference 161L0272, and is also supported by the Ministry of Culture and Science of the State of North Rhine-Westphalia (Ministerium für Kultur und Wissenschaft des Landes Nordrhein-Westfalen, MKW NRW).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Dong, Z. Pan, Y. Fu, Q. Yang, Y. Gao, T. Yu, Y. Shi, and C. Zhuo, “Deu-net 2.0: Enhanced deformable u-net for 3d cardiac cine MRI segmentation,” <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Medical Image Anal.</span>, vol. 78, p. 102389, 2022.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. Dong, Z. Pan, Y. Fu, D. Xu, K. Shi, Q. Yang, Y. Shi, and C. Zhuo, “Partial unbalanced feature transport for cross-modality cardiac image segmentation,” <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">IEEE Trans. Medical Imaging</span>, vol. 42, no. 6, pp. 1758–1773, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
X. Hu, D. Zeng, X. Xu, and Y. Shi, “Semi-supervised contrastive learning for label-efficient medical image segmentation,” in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Medical Image Computing and Computer Assisted Intervention - MICCAI 2021 - 24th International Conference, Strasbourg, France, September 27 - October 1, 2021, Proceedings, Part II</span> (M. de Bruijne, P. C. Cattin, S. Cotin, N. Padoy, S. Speidel, Y. Zheng, and C. Essert, eds.), vol. 12902 of <span id="bib.bib3.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 481–490, Springer, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Z. Pan, J. Chen, and Y. Shi, “Masked diffusion as self-supervised representation learner,” 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
C. Baur, B. Wiestler, S. Albarqouni, and N. Navab, “Deep autoencoding models for unsupervised anomaly segmentation in brain MR images,” in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Brainlesion: Glioma, Multiple Sclerosis, Stroke and Traumatic Brain Injuries - 4th International Workshop, BrainLes 2018, Held in Conjunction with MICCAI 2018, Granada, Spain, September 16, 2018, Revised Selected Papers, Part I</span> (A. Crimi, S. Bakas, H. J. Kuijf, F. Keyvan, M. Reyes, and T. van Walsum, eds.), vol. 11383 of <span id="bib.bib5.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 161–169, Springer, 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Baur, B. Wiestler, S. Albarqouni, and N. Navab, “Bayesian skip-autoencoders for unsupervised hyperintense anomaly detection in high resolution brain mri,” in <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">17th IEEE International Symposium on Biomedical Imaging, ISBI 2020, Iowa City, IA, USA, April 3-7, 2020</span>, pp. 1905–1909, IEEE, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
A. Kascenas, N. Pugeault, and A. Q. O’Neil, “Denoising autoencoders for unsupervised anomaly detection in brain MRI,” in <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">International Conference on Medical Imaging with Deep Learning, MIDL 2022, 6-8 July 2022, Zurich, Switzerland</span> (E. Konukoglu, B. H. Menze, A. Venkataraman, C. F. Baumgartner, Q. Dou, and S. Albarqouni, eds.), vol. 172 of <span id="bib.bib7.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pp. 653–664, PMLR, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
J. Wyatt, A. Leach, S. M. Schmon, and C. G. Willcocks, “Anoddpm: Anomaly detection with denoising diffusion probabilistic models using simplex noise,” in <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops, CVPR Workshops 2022, New Orleans, LA, USA, June 19-20, 2022</span>, pp. 649–655, IEEE, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Baur, S. Denner, B. Wiestler, N. Navab, and S. Albarqouni, “Autoencoders for unsupervised anomaly segmentation in brain MR images: A comparative study,” <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Medical Image Anal.</span>, vol. 69, p. 101952, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
W. H. Pinaya, P.-D. Tudosiu, R. Gray, G. Rees, P. Nachev, S. Ourselin, and M. J. Cardoso, “Unsupervised brain imaging 3d anomaly detection and segmentation with transformers,” <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Medical Image Analysis</span>, vol. 79, p. 102475, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X. Chen and E. Konukoglu, “Unsupervised detection of lesions in brain mri using constrained adversarial auto-encoders,” <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, vol. abs/1806.04972, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
T. Schlegl, P. Seeböck, S. M. Waldstein, U. Schmidt-Erfurth, and G. Langs, “Unsupervised anomaly detection with generative adversarial networks to guide marker discovery,” in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Information Processing in Medical Imaging - 25th International Conference, IPMI 2017, Boone, NC, USA, June 25-30, 2017, Proceedings</span> (M. Niethammer, M. Styner, S. R. Aylward, H. Zhu, I. Oguz, P. Yap, and D. Shen, eds.), vol. 10265 of <span id="bib.bib12.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 146–157, Springer, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
T. Schlegl, P. Seeböck, S. M. Waldstein, G. Langs, and U. Schmidt-Erfurth, “f-anogan: Fast unsupervised anomaly detection with generative adversarial networks,” <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Medical Image Anal.</span>, vol. 54, pp. 30–44, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
F. Behrendt, D. Bhattacharya, J. Krüger, R. Opfer, and A. Schlaefer, “Patched diffusion models for unsupervised anomaly detection in brain MRI,” in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Medical Imaging with Deep Learning, MIDL 2023, 10-12 July 2023, Nashville, TN, USA</span> (I. Oguz, J. H. Noble, X. Li, M. Styner, C. Baumgartner, M. Rusu, T. Heimann, D. Kontos, B. A. Landman, and B. M. Dawant, eds.), vol. 227 of <span id="bib.bib14.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pp. 1019–1032, PMLR, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
H. Iqbal, U. Khalid, C. Chen, and J. Hua, “Unsupervised anomaly detection in medical images using masked diffusion model,” in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Machine Learning in Medical Imaging - 14th International Workshop, MLMI 2023, Held in Conjunction with MICCAI 2023, Vancouver, BC, Canada, October 8, 2023, Proceedings, Part I</span> (X. Cao, X. Xu, I. Rekik, Z. Cui, and X. Ouyang, eds.), vol. 14348 of <span id="bib.bib15.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 372–381, Springer, 2023.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
P. Bergmann, S. Löwe, M. Fauser, D. Sattlegger, and C. Steger, “Improving unsupervised defect segmentation by applying structural similarity to autoencoders,” in <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Proceedings of the 14th International Joint Conference on Computer Vision, Imaging and Computer Graphics Theory and Applications, VISIGRAPP 2019, Volume 5: VISAPP, Prague, Czech Republic, February 25-27, 2019</span> (A. Trémeau, G. M. Farinella, and J. Braz, eds.), pp. 372–380, SciTePress, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
F. Meissen, J. C. Paetzold, G. Kaissis, and D. Rueckert, “Unsupervised anomaly localization with structural feature-autoencoders,” in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Brainlesion: Glioma, Multiple Sclerosis, Stroke and Traumatic Brain Injuries - 8th International Workshop, BrainLes 2022, Held in Conjunction with MICCAI 2022, Singapore, September 18, 2022, Revised Selected Papers</span> (S. Bakas, A. Crimi, U. Baid, S. Malec, M. Pytlarz, B. Baheti, M. Zenk, and R. Dorent, eds.), vol. 13769 of <span id="bib.bib17.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 14–24, Springer, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
F. Behrendt, D. Bhattacharya, L. Maack, J. Krüger, R. Opfer, R. Mieling, and A. Schlaefer, “Diffusion models with ensembled structure-based anomaly scoring for unsupervised anomaly detection,” 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
J. Ho, A. Jain, and P. Abbeel, “Denoising diffusion probabilistic models,” in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</span> (H. Larochelle, M. Ranzato, R. Hadsell, M. Balcan, and H. Lin, eds.), 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Zhao, O. Gallo, I. Frosio, and J. Kautz, “Loss functions for image restoration with neural networks,” <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">IEEE Trans. Computational Imaging</span>, vol. 3, no. 1, pp. 47–57, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
F. Meissen, G. Kaissis, and D. Rueckert, “Challenging current semi-supervised anomaly segmentation methods for brain MRI,” in <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Brainlesion: Glioma, Multiple Sclerosis, Stroke and Traumatic Brain Injuries - 7th International Workshop, BrainLes 2021, Held in Conjunction with MICCAI 2021, Virtual Event, September 27, 2021, Revised Selected Papers, Part I</span> (A. Crimi and S. Bakas, eds.), vol. 12962 of <span id="bib.bib21.2.2" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science</span>, pp. 63–74, Springer, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
F. Behrendt, M. Bengs, D. Bhattacharya, J. Krüger, R. Opfer, and A. Schlaefer, “Capturing inter-slice dependencies of 3d brain mri-scans for unsupervised anomaly detection,” in <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Medical Imaging with Deep Learning</span>, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
U. Baid, S. Ghodasara, S. Mohan, M. Bilello, E. Calabrese, E. Colak, K. Farahani, J. Kalpathy-Cramer, F. C. Kitamura, S. Pati, <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">et al.</span>, “The rsna-asnr-miccai brats 2021 benchmark on brain tumor segmentation and radiogenomic classification,” <span id="bib.bib23.2.2" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2107.02314</span>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Lesjak, A. Galimzianova, A. Koren, M. Lukin, F. Pernus, B. Likar, and Z. Spiclin, “A novel public MR image dataset of multiple sclerosis patients with lesion segmentations based on multi-rater consensus,” <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Neuroinformatics</span>, vol. 16, no. 1, pp. 51–63, 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
https://brain-development.org/ixi-dataset/.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.08227" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.08228" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.08228">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.08228" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.08229" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 15:20:46 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
