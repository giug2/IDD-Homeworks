<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.00060] FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids</title><meta property="og:description" content="Smart energy performance monitoring and optimisation at the supplier and consumer levels is essential to realising smart cities. In order to implement a more sustainable energy management plan, it is crucial to conduct…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.00060">

<!--Generated on Thu Mar 14 03:13:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Mohammad Al-Quraan
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Ahsan Khan
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Anthony Centeno
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Ahmed Zoha
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Muhammad Ali Imran
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> and Lina Mohjazi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_address"> James Watt School of Engineering,
University of Glasgow, Glasgow, G12 8QQ, UK, 
<br class="ltx_break">(e-mail: {m.alquraan.1, a.khan.9}@research.gla.ac.uk,
<br class="ltx_break">{Anthony.Centeno, Ahmed.Zoha, Muhammad.Imran, Lina.Mohjazi}@glasgow.ac.uk).
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Smart energy performance monitoring and optimisation at the supplier and consumer levels is essential to realising smart cities. In order to implement a more sustainable energy management plan, it is crucial to conduct a better energy forecast. The next-generation smart meters can also be used to measure, record, and report energy consumption data, which can be used to train machine learning (ML) models for predicting energy needs. However, sharing fine-grained energy data and performing centralised learning may compromise users’ privacy and leave them vulnerable to several attacks. This study addresses this issue by utilising federated learning (FL), an emerging technique that performs ML model training at the user level, where data resides. We introduce FedTrees, a new, lightweight FL framework that benefits from the outstanding features of ensemble learning. Furthermore, we developed a delta-based early stopping algorithm to monitor FL training and stop it when it does not need to continue. The simulation results demonstrate that FedTrees outperforms the most popular federated averaging (FedAvg) framework and the baseline Persistence model for providing accurate energy forecasting patterns while taking only 2% of the computation time and 13% of the communication rounds compared to FedAvg, saving considerable amounts of computation and communication resources.</p>
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Engineering Applications of Artificial Intelligence</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Fifth-generation (5G) and beyond wireless technologies are expected to unlock the full potential of the Internet of Things (IoT), the key enabler of the smart city model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The smart city concept combines several elements such as a smart environment, mobility, living, and energy to improve citizens’ quality of life. Fulfilling smart energy, in the form of smart grids and smart buildings, has been the focus of many bodies in industry and academia through monitoring and predicting energy consumption patterns <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Accurate short-, mid-, or long-term energy forecasting is the ultimate goal that helps managers or consumers to prepare better future plans, thus improving energy performance.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Energy suppliers need to maintain an equilibrium point between supply and demand, since producing excessive amounts of energy will result in energy wastage. In contrast, failure to meet consumers’ demands may lead to the need to purchase energy at higher rates; otherwise, frequent blackouts will happen. Therefore, various load forecasting techniques have been considered for electricity networks’ efficient and reliable operation. Statistical forecasting methods, e.g., multiple linear regression (MLR), autoregressive (AR), and moving average (MA) techniques, were used to project past and present load profiles into future predictions. Later, the introduction of smart metering and the evolution of artificial intelligence (AI) technology paved the way for replacing traditional prediction techniques with various machine learning (ML) algorithms, due to their ability in analysing large amounts of datasets in short periods of time while providing impressive accuracy levels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Advanced metering infrastructure (AMI), a system of smart meters connected to a communication network for two-way communications between customers and utility companies, is the first step toward smart energy, which helps collect and analyse smart-meter data. However, collecting consumers’ load profiles into a central entity to conduct energy forecasting raises privacy concerns. Individuals’ load information could be misused by revealing consumer habits and household occupancy.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address this issue, the ML community recently introduced a new learning paradigm termed as federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. The FL is analogous to the concept of distributed learning in terms of handling enormous datasets and developing efficient and scalable systems. However, maintaining data privacy is the goal of FL as it does not involve the collection of data in a central location, but instead it sends the model to the clients where the data is generated. The FL framework is orchestrated by a server placed in a central entity, i.e., an energy supplier, to train and improve a shared model with many clients collaboratively. Two typical FL architectures exist based on the scale of the federation. The first is cross-device, where the number of clients may be massive, for example, consumers’ smart meters. The second is cross-silo, which considers relatively limited and reliable clients, for example, substations. The FL process starts by initialising a global model in the server and then sending it to the clients to conduct model training. Once completed, the clients send back the model updates to the server, which will aggregate them, resulting in an updated model. Then, the updated model is sent to the clients for another training round. This process is repeated until the limit of communication rounds is reached, or the model achieves the desired accuracy.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The use of FL in energy forecasting is still in very early stages, and few studies have considered this approach <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. In these studies, the authors focus on utilising long short-term memory (LSTM) architectures, a type of recurrent neural network (RNN) used in the field of deep learning (DL), due to their remarkable performance in predicting time-series data sequences. However, the mentioned works overlook a critical issue: DL models are extremely resource-consuming (energy, memory, processor, etc.), and the lengthy and extensive underlying mathematical operations demand resource-rich hardware. Considering such schemes of combining FL with LSTM models requires extended computation time to reach the desired precision and impede their scalability. Furthermore, individual households are the focal point of the abovementioned studies to be used as FL clients. Conversely, our study applies FL at the substation level, i.e., a part of the power system dedicated to servicing local dwellings in a specific area, allowing for the use of FL algorithm within one or more energy suppliers, hence attaining more generalised ML models.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we propose FedTrees; a novel light aggregation algorithm developed to utilise decision trees (DTs) under the FL setting. Specifically, we use the light gradient boosting model (LGBM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, one of the boosting techniques in ensemble learning, to be sent and trained across the clients of the FL framework. The main reasons for considering the LGBM models are due to their rapid training speed, less memory consumption, higher efficiency, and accurate predictions. FedTrees attempts to minimise computations and the number of communication rounds while guaranteeing high training performance; hence it is envisioned to play a crucial role in a wide range of FL-based applications in several fields, such as smart energy. Moreover, this work considers the common challenge of optimising the number of communication rounds that may lead to suboptimal performance or excessive rounds of unnecessary training, thus consuming computation and communication resources. Therefore, we developed a delta-based early stopping patience technique, a dynamic algorithm that monitors the FL training process and stops it when no further enhancement is possible. Also, this paper examines the importance of each feature used in the training process and offers a study of the effect of using a different number of features on the final training performance. Additionally, the performance of the FedTrees algorithm is benchmarked against the popular LSTM-based federated averaging (FedAvg) and the naïve Persistence model. Finally, the proposed framework is evaluated based on state-of-the-art metrics and by conducting extensive simulations. The main contributions of the paper are summarised as follows:</p>
</div>
<div id="S1.p6" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">First, we introduce FedTrees, a novel, light algorithm that employs DT-based models within the FL setup. FedTrees using LGBM models shows improved performance in terms of the required number of communication rounds and computation time compared to LSTM-based FedAvg aggregation scheme when employed for energy forecasting.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Unlike other FL-based energy forecasting framework that rely on fixing the number of communication rounds, this study develops a delta-based early stopping technique to reach the best possible accuracy while reducing the computation and communications costs.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">A feature importance evaluation study is conducted against individual load profiles for optimal forecasting performance.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Finally, we compared FedTrees performance with LSTM-based FedAvg and a naïve Persistence model as a benchmark using state-of-the-art metrics. The results reveal a significant improvement in overall performance using the FedTrees framework.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The remainder of this paper is structured as follows. Section <a href="#S2" title="2 Related Work ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> recalls the related work, while Section <a href="#S3" title="3 Preliminaries and background ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents some background notions. Section <a href="#S4" title="4 Proposed FedTrees Algorithm ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> describes the proposed FedTrees algorithm versus FedAvg and represents the delta-based early stopping patience technique. Simulation setup, used dataset, and numerical results are presented in Section <a href="#S5" title="5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Finally, the concluding remarks are drawn in Section <a href="#S6" title="6 CONCLUSIONS ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">This section first reviews the works that use different load forecasting methodologies performed either locally or centrally; then, it presents the state-of-the-art research that takes into account the FL framework for load forecasting.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Local and Centralised Approaches</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Load profiles store energy/power consumption information in the form of time-series data, which can be predicted using several approaches, such as statistical and computational intelligence. For a complete view of the energy forecasting methods, we refer the reader to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Statistical methods have been used in the literature for the short and medium temporal forecasting ranges and show quite good performance. For instance, the study in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> uses the MLR technique to verify its reliability in energy demand forecasting instead of traditional and more complex methods. The authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> rely on the traditional AR methodology to predict electrical energy in Lebanon. Using univariate historical time series data, the second-order MA model is combined with another statistical method for forecasting gas consumption in China from 2009 to 2015 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Moreover, combining AR and MA resulted in many variants that enhance the forecasting process such as the autoregressive moving average (ARMA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, ARMA model with exogenous inputs (ARMAX) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, AR integrated MA (ARIMA) model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and seasonal ARIMA (SARIMA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Later, the focus on ML methods became dominant owing to the advantages of AI in analysing large amounts of data, which was made available by the introduction of smart metering. The contribution in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> highlights the use of support vector machine (SVM) to forecast the monthly electrical load of Taiwan. On the other hand, many studies use NNs in the energy forecasting domain by virtue of their impressive performance in various areas. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, the work uses electricity time-series data from three countries to compare the performance of convolutional NN (CNN) and multilayer perceptron (MLP) algorithms. Similarly, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> demonstrate that a three hidden layer CNN model performs well in energy forecasting compared to statistical and other simple ML methods. RNN is also widely used in smart energy, particularly LSTM and its variants <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Apart from NNs, DTs have also been used in the energy forecasting task. Although the DT approach is simple, it shows desired performance when predicting future energy consumption in Hong Kong <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Following the same DT approach, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> demonstrate that employing DT for predicting energy use intensity in Japanese residential buildings can give very well accuracy. However, DT alone has not been widely used because it suffers from several drawbacks, such as instability, easily losing generalisation, and performing poorly with noisy and non-linear data. Later, ensemble-based algorithms gained popularity and were explored in the energy research domain. In general, ensemble techniques possess attractive features that draw the research community’s attention, such as simplicity, ease of use, interpretability, and computational efficiency. For instance, random forest forecasting performance is compared with NN in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, and the results demonstrated that both are feasible and effective in building energy applications. The gradient-boosted decision tree (GBDT) and extreme gradient boosting (XGBoost) algorithms are also utilised in predicting future electricity loads and have shown to be effective in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, respectively.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">The proposed studies and frameworks mentioned above are generally based on a centralised model training where the energy consumption information is transmitted across the network and combined in a central location. However, this training scheme raises privacy concerns. Consumers’ load profiles hold sensitive information that can be used in various dimensions like inferring occupancy and usage patterns of households, government surveillance, data selling, and illegal data use among others.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>FL-based Load Forecasting</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Recently, the ML community has investigated a new research direction to address the privacy concerns associated with traditional training methods. As a distributed learning algorithm, FL can perform model training at the edge of the network rather than a central location without the need to share sensitive load information. Few studies have begun to consider the use of FL in the context of smart energy; for example, the aim of the work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> is to evaluate the use of federated settings in predicting electrical load consumption patterns that will assist in load monitoring and energy demand response. The FedAvg technique is applied to aggregate the parameters of LSTM models while conducting training, and to produce a generalised global model. Applying this framework to several households in the USA, the study demonstrated that FL has a great potential in smart grids through training a powerful future energy forecasting model. Similarly, FedAvg and LSTM are adopted in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to provide a generalised electrical load forecasting model. The authors use complementary features related to calendar and weather conditions along with the sequences of previous electrical load to improve the forecast model.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Briggs <em id="S2.SS2.p2.1.1" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> present a study on the importance of using smart meters in residential areas to forecast energy consumption using FL, which helps move towards renewable energy generation. LSTM algorithm is considered to perform short-term forecasting tasks. Similarly, the contribution in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> evaluates the performance of FL versus centralised and local training methods when using LSTM models in the context of electrical load forecasting. In addition, clustering is considered to group the clients based on similar model hyperparameters and, accordingly, similar data characteristics. The study concluded that local learning is better for predicting individual energy consumption than FL. However, FL is needed when a generalised forecasting model is required and access to aggregated data is impossible. Very recently, the research work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> adopted the LSTM algorithm under the FL setting to forecast energy profiles. Two strategies are considered, namely, federated stochastic gradient descent (FedSGD) and FedAvg to perform models’ parameter aggregation. Experimental results demonstrated that FedAvg achieves better accuracy and requires fewer communication rounds.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">The aforementioned FL-based energy forecasting studies rely on DL algorithms, specifically LSTM networks. Although the LSTMs have shown to achieve excellent prediction accuracy, they require intensive processing duties that yield a heavy computational burden. The following section provides a background to the main elements considered for conducting this study.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries and background</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we review the basic concepts of LSTM, LGBM, and FL needed to understand better the study conducted in this paper.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Long Short-Term Memory (LSTM) Networks</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">An RNN is a class of artificial neural networks designed to process sequential data through which it recognises patterns, understands temporal dynamic behaviours, and provides predictions based on the previous states <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. As in NNs, RNNs are gradient-based learning algorithms that rely on the backpropagation mechanism to update neurons’ weights. However, RNNs suffer from two main challenges associated with performing partial derivatives across the network to find the model weights: vanishing and exploding gradient. These problems may prevent the network from further training, causing the network to struggle to learn long-term dependencies. Therefore, LSTM networks were introduced as more robust models without being affected by the unstable gradients problem by improving the gradient flow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. This was done by introducing artificial memory (cell state) and three gates: a forget gate, an input gate, and an output gate. The three gates can be thought of as filters that regulate the flow of information in and out of the cell to help predict the output sequence. Specifically, the forget gate decides which information to keep/neglect from the previous cell state. The input gate decides which information is relevant to update the cell state. On the other hand, the output gate determines the new hidden state of the next LSTM unit. A pictorial representation of an LSTM unit is given in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Long Short-Term Memory (LSTM) Networks ‣ 3 Preliminaries and background ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2210.00060/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="231" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>LSTM memory cell with gating units.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Light Gradient Boosting Model (LGBM)</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">DTs are supervised ML algorithms that can do regression and classification by continually splitting data according to specific rules. The simplicity of DTs has made them popular, and they have been applied in many applications. However, DTs suffer from several challenges that limit their use in more complex situations, such as overfitting, instability, and bias. Therefore, the concept of ensemble learning was adopted with the aim of combining many weaker learners (i.e., DTs) to produce a more robust ensemble. The ensemble learning includes three main classes, bagging, stacking, and boosting. For more details on ensemble learning, we refer the reader to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">In 2017, Microsoft introduced one of the most powerful boosting models named LGBM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, depicted in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Light Gradient Boosting Model (LGBM) ‣ 3 Preliminaries and background ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. What distinguishes LGBM from other boosting models is its efficiency, fast processing, and scalability. These desirable features are gained by introducing two techniques: gradient-based one-side sampling (GOSS) and exclusive feature bundling (EFB). GOSS downsample data instances with small absolute gradients while keeping the samples with higher absolute gradients because they contribute more to the training process. At the same time, EFB reduces the number of data features by bundling the mutually exclusive ones. Moreover, unlike other tree-based algorithms that grow trees horizontally, i.e., level-wise, LGBM grows trees vertically, i.e., leaf-wise, by choosing the leaf that it believes will achieve the highest loss decrease. It is worth mentioning that the level-wise strategy is better for smaller datasets to avoid overfitting, while the leaf-wise strategy excels in larger datasets. Lower computations, less memory consumption, fast training, handling large-scale data, and scalability are the main characteristics that will help the prevalence of LGBM algorithms in solving many real-world problems.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2210.00060/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="224" height="65" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Ensemble of DTs are combined to boost and form the LGBM model.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Averaging</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">ML is a data-driven approach that relies on several quantities of data sets to train a model for a specific task. The conventional way to conduct model training is by collecting the required datasets at a central location, performing pre-processing, and then feeding them to the model for training. However, centralised training methods threaten data privacy and security and contradict the legislation in data protection laws. Therefore, FL has emerged as a promising solution that addresses privacy concerns by pushing the model to the locations where the data is generated and exists. The FL framework is an iterative training process that incorporates specific steps to achieve the desired performance. In short, the FL training procedure includes initiating and broadcasting the global model to the clients, performing local model training, uploading model updates to the server, and finally aggregating the updates to produce a new version of the model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">Several aggregation algorithms have been introduced such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, and FedDist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. However, these algorithms are designed to aggregate the parameters of NNs models and cannot be used with other ML algorithms, for example, SVMs and DTs. Furthermore, the FL framework is highly dependent on the resources of clients and networks, and using NN models under the FL framework will lead to highly consuming these resources. Therefore, building new efficient aggregation schemes is crucial. To tackle this problem, this study proposes a novel tree based FL framework, termed as FedTrees, which will be discussed in detail in the next section. FedTrees performance is compared with FedAvg, the most widely used aggregation algorithm in the literature.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">Finding the minimum of the loss function is fundamental in evaluating the performance of the ML algorithm in dataset modelling. Various ML algorithms depend on gradient descent (GD). This optimisation algorithm attempts to track down the minimum value of a differential function by finding the gradient at a given point and then taking steps proportional to the negative of the gradient. However, this algorithm demands a considerable computation complexity proportional to the size of the dataset. Then, a stochastic GD (SGD) is introduced to relieve the computations by performing GD on batches of data samples. SGD has improved the model convergence rate and is used under the FL setting (FedSGD) as the first naïve aggregation algorithm. Although FedSGD eases the computation complexity on the client-side, it requires many communication rounds with the central server. Therefore, the FedAvg algorithm is developed to alleviate the pressure on communication resources by doing multiple minibatch gradient calculations before updating the server. The amount of computation is controlled using three parameters; a subset of total client count (C), breaking down the dataset into small-sized mini-batches (B), and the number of epochs (E) that the client passes over its dataset per round. FedAvg allows each client to perform multiple SGD rounds locally across different local data subsets and then find the optimal model parameters by averaging the clients’ locally evaluated gradients at the FL server. The complete pseudo-code of FedAvg is given in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3 Federated Averaging ‣ 3 Preliminaries and background ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">FedAvg is designed to best fit neural networks where network parameters (weights and biases) can be extracted and aggregated to form newly updated parameters. LSTM networks, one form of neural networks, have been widely used in predicting time-series datasets, and they fit the federated optimisation problem. In previous studies that considered energy forecasting tasks under the FL environment, their primary model choice was certainly the LSTM networks. Although the prediction performance of LSTM models is accurate, these studies have overlooked very crucial problems accompanied by FL distributed learning, which are the computation and communication costs.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite></figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  Communications limit (<math id="alg1.l0.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">T</annotation></semantics></math>), Clients count (<math id="alg1.l0.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">C</annotation></semantics></math>), Number of mini-batches (<math id="alg1.l0.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">B</annotation></semantics></math>), Number of epochs (<math id="alg1.l0.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">E</annotation></semantics></math>)
</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  
</div>
<div id="alg1.l1" class="ltx_listingline">  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="w_{0}\leftarrow" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><msub id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">w</mi><mn id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝑤</ci><cn type="integer" id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">w_{0}\leftarrow</annotation></semantics></math> initialise weights

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.4" class="ltx_Math" alttext="t=1,2,...,T" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.5" xref="alg1.l2.m1.4.5.cmml"><mi id="alg1.l2.m1.4.5.2" xref="alg1.l2.m1.4.5.2.cmml">t</mi><mo id="alg1.l2.m1.4.5.1" xref="alg1.l2.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2.m1.4.5.3.2" xref="alg1.l2.m1.4.5.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.4.5.3.2.1" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">2</mn><mo id="alg1.l2.m1.4.5.3.2.2" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.4.5.3.2.3" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.5.cmml" xref="alg1.l2.m1.4.5"><eq id="alg1.l2.m1.4.5.1.cmml" xref="alg1.l2.m1.4.5.1"></eq><ci id="alg1.l2.m1.4.5.2.cmml" xref="alg1.l2.m1.4.5.2">𝑡</ci><list id="alg1.l2.m1.4.5.3.1.cmml" xref="alg1.l2.m1.4.5.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">2</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">t=1,2,...,T</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">     <math id="alg1.l3.m1.1" class="ltx_Math" alttext="S_{t}=" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑆</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">S_{t}=</annotation></semantics></math> Random set of <math id="alg1.l3.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">C</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l4.m1.4" class="ltx_Math" alttext="k=1,2,...,S_{t}" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml"><mi id="alg1.l4.m1.4.4.3" xref="alg1.l4.m1.4.4.3.cmml">k</mi><mo id="alg1.l4.m1.4.4.2" xref="alg1.l4.m1.4.4.2.cmml">=</mo><mrow id="alg1.l4.m1.4.4.1.1" xref="alg1.l4.m1.4.4.1.2.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.4.1.1.2" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.4.1.1.3" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.4.1.1.4" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><msub id="alg1.l4.m1.4.4.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.cmml"><mi id="alg1.l4.m1.4.4.1.1.1.2" xref="alg1.l4.m1.4.4.1.1.1.2.cmml">S</mi><mi id="alg1.l4.m1.4.4.1.1.1.3" xref="alg1.l4.m1.4.4.1.1.1.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4"><eq id="alg1.l4.m1.4.4.2.cmml" xref="alg1.l4.m1.4.4.2"></eq><ci id="alg1.l4.m1.4.4.3.cmml" xref="alg1.l4.m1.4.4.3">𝑘</ci><list id="alg1.l4.m1.4.4.1.2.cmml" xref="alg1.l4.m1.4.4.1.1"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><apply id="alg1.l4.m1.4.4.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.4.4.1.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1.2">𝑆</ci><ci id="alg1.l4.m1.4.4.1.1.1.3.cmml" xref="alg1.l4.m1.4.4.1.1.1.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">k=1,2,...,S_{t}</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w_{t}^{k}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msubsup id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2.2" xref="alg1.l5.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.2.2.3" xref="alg1.l5.m1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">superscript</csymbol><apply id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.2.cmml" xref="alg1.l5.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l5.m1.1.1.2.2.3.cmml" xref="alg1.l5.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑘</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w_{t}^{k}\leftarrow</annotation></semantics></math> ClientUpdate(<math id="alg1.l5.m2.2" class="ltx_Math" alttext="k,w_{t-1}" display="inline"><semantics id="alg1.l5.m2.2a"><mrow id="alg1.l5.m2.2.2.1" xref="alg1.l5.m2.2.2.2.cmml"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">k</mi><mo id="alg1.l5.m2.2.2.1.2" xref="alg1.l5.m2.2.2.2.cmml">,</mo><msub id="alg1.l5.m2.2.2.1.1" xref="alg1.l5.m2.2.2.1.1.cmml"><mi id="alg1.l5.m2.2.2.1.1.2" xref="alg1.l5.m2.2.2.1.1.2.cmml">w</mi><mrow id="alg1.l5.m2.2.2.1.1.3" xref="alg1.l5.m2.2.2.1.1.3.cmml"><mi id="alg1.l5.m2.2.2.1.1.3.2" xref="alg1.l5.m2.2.2.1.1.3.2.cmml">t</mi><mo id="alg1.l5.m2.2.2.1.1.3.1" xref="alg1.l5.m2.2.2.1.1.3.1.cmml">−</mo><mn id="alg1.l5.m2.2.2.1.1.3.3" xref="alg1.l5.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.2b"><list id="alg1.l5.m2.2.2.2.cmml" xref="alg1.l5.m2.2.2.1"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑘</ci><apply id="alg1.l5.m2.2.2.1.1.cmml" xref="alg1.l5.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.2.2.1.1.1.cmml" xref="alg1.l5.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l5.m2.2.2.1.1.2.cmml" xref="alg1.l5.m2.2.2.1.1.2">𝑤</ci><apply id="alg1.l5.m2.2.2.1.1.3.cmml" xref="alg1.l5.m2.2.2.1.1.3"><minus id="alg1.l5.m2.2.2.1.1.3.1.cmml" xref="alg1.l5.m2.2.2.1.1.3.1"></minus><ci id="alg1.l5.m2.2.2.1.1.3.2.cmml" xref="alg1.l5.m2.2.2.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m2.2.2.1.1.3.3.cmml" xref="alg1.l5.m2.2.2.1.1.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.2c">k,w_{t-1}</annotation></semantics></math>)

</div>
<div id="alg1.l6" class="ltx_listingline">     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="w_{t}\leftarrow\sum_{k=1}^{S_{t}}\frac{n_{k}}{n}w_{t}^{k}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">t</mi></msub><mo rspace="0.111em" stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mrow id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><msubsup id="alg1.l6.m1.1.1.3.1" xref="alg1.l6.m1.1.1.3.1.cmml"><mo id="alg1.l6.m1.1.1.3.1.2.2" xref="alg1.l6.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l6.m1.1.1.3.1.2.3" xref="alg1.l6.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l6.m1.1.1.3.1.2.3.2" xref="alg1.l6.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l6.m1.1.1.3.1.2.3.1" xref="alg1.l6.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.3.1.2.3.3" xref="alg1.l6.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="alg1.l6.m1.1.1.3.1.3" xref="alg1.l6.m1.1.1.3.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.1.3.2" xref="alg1.l6.m1.1.1.3.1.3.2.cmml">S</mi><mi id="alg1.l6.m1.1.1.3.1.3.3" xref="alg1.l6.m1.1.1.3.1.3.3.cmml">t</mi></msub></msubsup><mrow id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml"><mfrac id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml"><msub id="alg1.l6.m1.1.1.3.2.2.2" xref="alg1.l6.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l6.m1.1.1.3.2.2.2.2" xref="alg1.l6.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg1.l6.m1.1.1.3.2.2.2.3" xref="alg1.l6.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l6.m1.1.1.3.2.2.3" xref="alg1.l6.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.3.2.1" xref="alg1.l6.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml"><mi id="alg1.l6.m1.1.1.3.2.3.2.2" xref="alg1.l6.m1.1.1.3.2.3.2.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.3.2.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.2.3.cmml">t</mi><mi id="alg1.l6.m1.1.1.3.2.3.3" xref="alg1.l6.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝑤</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><apply id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.1.cmml" xref="alg1.l6.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.3.1.2.cmml" xref="alg1.l6.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.2.1.cmml" xref="alg1.l6.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l6.m1.1.1.3.1.2.2.cmml" xref="alg1.l6.m1.1.1.3.1.2.2"></sum><apply id="alg1.l6.m1.1.1.3.1.2.3.cmml" xref="alg1.l6.m1.1.1.3.1.2.3"><eq id="alg1.l6.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l6.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l6.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l6.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="alg1.l6.m1.1.1.3.1.3.cmml" xref="alg1.l6.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.1.3.2">𝑆</ci><ci id="alg1.l6.m1.1.1.3.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2"><times id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3.2.1"></times><apply id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2"><divide id="alg1.l6.m1.1.1.3.2.2.1.cmml" xref="alg1.l6.m1.1.1.3.2.2"></divide><apply id="alg1.l6.m1.1.1.3.2.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l6.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg1.l6.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.1.1.3.2.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.3.1.cmml" xref="alg1.l6.m1.1.1.3.2.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.3.2.cmml" xref="alg1.l6.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l6.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.3.2.2">𝑤</ci><ci id="alg1.l6.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.3.2.3.3.cmml" xref="alg1.l6.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">w_{t}\leftarrow\sum_{k=1}^{S_{t}}\frac{n_{k}}{n}w_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">  
</div>
<div id="alg1.l7a" class="ltx_listingline">  (<math id="alg1.l7a.m1.2" class="ltx_Math" alttext="k,w" display="inline"><semantics id="alg1.l7a.m1.2a"><mrow id="alg1.l7a.m1.2.3.2" xref="alg1.l7a.m1.2.3.1.cmml"><mi id="alg1.l7a.m1.1.1" xref="alg1.l7a.m1.1.1.cmml">k</mi><mo id="alg1.l7a.m1.2.3.2.1" xref="alg1.l7a.m1.2.3.1.cmml">,</mo><mi id="alg1.l7a.m1.2.2" xref="alg1.l7a.m1.2.2.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.2b"><list id="alg1.l7a.m1.2.3.1.cmml" xref="alg1.l7a.m1.2.3.2"><ci id="alg1.l7a.m1.1.1.cmml" xref="alg1.l7a.m1.1.1">𝑘</ci><ci id="alg1.l7a.m1.2.2.cmml" xref="alg1.l7a.m1.2.2">𝑤</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.2c">k,w</annotation></semantics></math>)<span id="alg1.l7a.1" class="ltx_text ltx_font_bold">:</span>

</div>
<div id="alg1.l8" class="ltx_listingline">  <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l8.m1.4" class="ltx_Math" alttext="e=1,2,...,E" display="inline"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.5" xref="alg1.l8.m1.4.5.cmml"><mi id="alg1.l8.m1.4.5.2" xref="alg1.l8.m1.4.5.2.cmml">e</mi><mo id="alg1.l8.m1.4.5.1" xref="alg1.l8.m1.4.5.1.cmml">=</mo><mrow id="alg1.l8.m1.4.5.3.2" xref="alg1.l8.m1.4.5.3.1.cmml"><mn id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">1</mn><mo id="alg1.l8.m1.4.5.3.2.1" xref="alg1.l8.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">2</mn><mo id="alg1.l8.m1.4.5.3.2.2" xref="alg1.l8.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml">…</mi><mo id="alg1.l8.m1.4.5.3.2.3" xref="alg1.l8.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.5.cmml" xref="alg1.l8.m1.4.5"><eq id="alg1.l8.m1.4.5.1.cmml" xref="alg1.l8.m1.4.5.1"></eq><ci id="alg1.l8.m1.4.5.2.cmml" xref="alg1.l8.m1.4.5.2">𝑒</ci><list id="alg1.l8.m1.4.5.3.1.cmml" xref="alg1.l8.m1.4.5.3.2"><cn type="integer" id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">1</cn><cn type="integer" id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">2</cn><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">…</ci><ci id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">e=1,2,...,E</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="batches\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1a" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.4" xref="alg1.l9.m1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1b" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.5" xref="alg1.l9.m1.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1c" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.6" xref="alg1.l9.m1.1.1.2.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1d" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.7" xref="alg1.l9.m1.1.1.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1e" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.8" xref="alg1.l9.m1.1.1.2.8.cmml">s</mi></mrow><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑏</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑎</ci><ci id="alg1.l9.m1.1.1.2.4.cmml" xref="alg1.l9.m1.1.1.2.4">𝑡</ci><ci id="alg1.l9.m1.1.1.2.5.cmml" xref="alg1.l9.m1.1.1.2.5">𝑐</ci><ci id="alg1.l9.m1.1.1.2.6.cmml" xref="alg1.l9.m1.1.1.2.6">ℎ</ci><ci id="alg1.l9.m1.1.1.2.7.cmml" xref="alg1.l9.m1.1.1.2.7">𝑒</ci><ci id="alg1.l9.m1.1.1.2.8.cmml" xref="alg1.l9.m1.1.1.2.8">𝑠</ci></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">batches\leftarrow</annotation></semantics></math> Split dataset into <math id="alg1.l9.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">B</annotation></semantics></math> batches

</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l10.m1.4" class="ltx_Math" alttext="b=1,2,...,batches" display="inline"><semantics id="alg1.l10.m1.4a"><mrow id="alg1.l10.m1.4.4" xref="alg1.l10.m1.4.4.cmml"><mi id="alg1.l10.m1.4.4.3" xref="alg1.l10.m1.4.4.3.cmml">b</mi><mo id="alg1.l10.m1.4.4.2" xref="alg1.l10.m1.4.4.2.cmml">=</mo><mrow id="alg1.l10.m1.4.4.1.1" xref="alg1.l10.m1.4.4.1.2.cmml"><mn id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">1</mn><mo id="alg1.l10.m1.4.4.1.1.2" xref="alg1.l10.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">2</mn><mo id="alg1.l10.m1.4.4.1.1.3" xref="alg1.l10.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml">…</mi><mo id="alg1.l10.m1.4.4.1.1.4" xref="alg1.l10.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l10.m1.4.4.1.1.1" xref="alg1.l10.m1.4.4.1.1.1.cmml"><mi id="alg1.l10.m1.4.4.1.1.1.2" xref="alg1.l10.m1.4.4.1.1.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.3" xref="alg1.l10.m1.4.4.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1a" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.4" xref="alg1.l10.m1.4.4.1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1b" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.5" xref="alg1.l10.m1.4.4.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1c" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.6" xref="alg1.l10.m1.4.4.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1d" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.7" xref="alg1.l10.m1.4.4.1.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.4.4.1.1.1.1e" xref="alg1.l10.m1.4.4.1.1.1.1.cmml">​</mo><mi id="alg1.l10.m1.4.4.1.1.1.8" xref="alg1.l10.m1.4.4.1.1.1.8.cmml">s</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.4b"><apply id="alg1.l10.m1.4.4.cmml" xref="alg1.l10.m1.4.4"><eq id="alg1.l10.m1.4.4.2.cmml" xref="alg1.l10.m1.4.4.2"></eq><ci id="alg1.l10.m1.4.4.3.cmml" xref="alg1.l10.m1.4.4.3">𝑏</ci><list id="alg1.l10.m1.4.4.1.2.cmml" xref="alg1.l10.m1.4.4.1.1"><cn type="integer" id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">1</cn><cn type="integer" id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">2</cn><ci id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3">…</ci><apply id="alg1.l10.m1.4.4.1.1.1.cmml" xref="alg1.l10.m1.4.4.1.1.1"><times id="alg1.l10.m1.4.4.1.1.1.1.cmml" xref="alg1.l10.m1.4.4.1.1.1.1"></times><ci id="alg1.l10.m1.4.4.1.1.1.2.cmml" xref="alg1.l10.m1.4.4.1.1.1.2">𝑏</ci><ci id="alg1.l10.m1.4.4.1.1.1.3.cmml" xref="alg1.l10.m1.4.4.1.1.1.3">𝑎</ci><ci id="alg1.l10.m1.4.4.1.1.1.4.cmml" xref="alg1.l10.m1.4.4.1.1.1.4">𝑡</ci><ci id="alg1.l10.m1.4.4.1.1.1.5.cmml" xref="alg1.l10.m1.4.4.1.1.1.5">𝑐</ci><ci id="alg1.l10.m1.4.4.1.1.1.6.cmml" xref="alg1.l10.m1.4.4.1.1.1.6">ℎ</ci><ci id="alg1.l10.m1.4.4.1.1.1.7.cmml" xref="alg1.l10.m1.4.4.1.1.1.7">𝑒</ci><ci id="alg1.l10.m1.4.4.1.1.1.8.cmml" xref="alg1.l10.m1.4.4.1.1.1.8">𝑠</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.4c">b=1,2,...,batches</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l11" class="ltx_listingline">        <math id="alg1.l11.m1.2" class="ltx_Math" alttext="w\leftarrow w-\eta\nabla l(w;b)" display="inline"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><mi id="alg1.l11.m1.2.3.2" xref="alg1.l11.m1.2.3.2.cmml">w</mi><mo stretchy="false" id="alg1.l11.m1.2.3.1" xref="alg1.l11.m1.2.3.1.cmml">←</mo><mrow id="alg1.l11.m1.2.3.3" xref="alg1.l11.m1.2.3.3.cmml"><mi id="alg1.l11.m1.2.3.3.2" xref="alg1.l11.m1.2.3.3.2.cmml">w</mi><mo id="alg1.l11.m1.2.3.3.1" xref="alg1.l11.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l11.m1.2.3.3.3" xref="alg1.l11.m1.2.3.3.3.cmml"><mi id="alg1.l11.m1.2.3.3.3.2" xref="alg1.l11.m1.2.3.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l11.m1.2.3.3.3.1" xref="alg1.l11.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l11.m1.2.3.3.3.3" xref="alg1.l11.m1.2.3.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l11.m1.2.3.3.3.3.1" xref="alg1.l11.m1.2.3.3.3.3.1.cmml">∇</mo><mi id="alg1.l11.m1.2.3.3.3.3.2" xref="alg1.l11.m1.2.3.3.3.3.2.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.3.3.3.1a" xref="alg1.l11.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l11.m1.2.3.3.3.4.2" xref="alg1.l11.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l11.m1.2.3.3.3.4.2.1" xref="alg1.l11.m1.2.3.3.3.4.1.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">w</mi><mo id="alg1.l11.m1.2.3.3.3.4.2.2" xref="alg1.l11.m1.2.3.3.3.4.1.cmml">;</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg1.l11.m1.2.3.3.3.4.2.3" xref="alg1.l11.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><ci id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3.1">←</ci><ci id="alg1.l11.m1.2.3.2.cmml" xref="alg1.l11.m1.2.3.2">𝑤</ci><apply id="alg1.l11.m1.2.3.3.cmml" xref="alg1.l11.m1.2.3.3"><minus id="alg1.l11.m1.2.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.1"></minus><ci id="alg1.l11.m1.2.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.2">𝑤</ci><apply id="alg1.l11.m1.2.3.3.3.cmml" xref="alg1.l11.m1.2.3.3.3"><times id="alg1.l11.m1.2.3.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.3.1"></times><ci id="alg1.l11.m1.2.3.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.3.2">𝜂</ci><apply id="alg1.l11.m1.2.3.3.3.3.cmml" xref="alg1.l11.m1.2.3.3.3.3"><ci id="alg1.l11.m1.2.3.3.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.3.3.1">∇</ci><ci id="alg1.l11.m1.2.3.3.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.3.3.2">𝑙</ci></apply><list id="alg1.l11.m1.2.3.3.3.4.1.cmml" xref="alg1.l11.m1.2.3.3.3.4.2"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑤</ci><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑏</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">w\leftarrow w-\eta\nabla l(w;b)</annotation></semantics></math>
<span id="alg1.l11.1" class="ltx_text" style="font-size:80%;">
//<span id="alg1.l11.1.1" class="ltx_text ltx_font_italic">Compute gradients and update weights</span>
</span>

</div>
<div id="alg1.l12" class="ltx_listingline">  Return <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l12.m1.1a"><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w</annotation></semantics></math> to server

</div>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed FedTrees Algorithm</h2>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2210.00060/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="270" height="193" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>FedTrees sequential operation steps for energy forecasting task by considering C substations as clients.</figcaption>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FedTrees</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  Communications rounds (<math id="alg2.l0.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">R</annotation></semantics></math>), Clients count (<math id="alg2.l0.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg2.l0.m2.1a"><mi id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">C</annotation></semantics></math>), Number of trees in one batch (<math id="alg2.l0.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l0.m3.1a"><mi id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><ci id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">T</annotation></semantics></math>)
</div>
<div id="alg2.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  
</div>
<div id="alg2.l1" class="ltx_listingline">  <span id="alg2.l1.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l1.m1.4" class="ltx_Math" alttext="r=1,2,...,R" display="inline"><semantics id="alg2.l1.m1.4a"><mrow id="alg2.l1.m1.4.5" xref="alg2.l1.m1.4.5.cmml"><mi id="alg2.l1.m1.4.5.2" xref="alg2.l1.m1.4.5.2.cmml">r</mi><mo id="alg2.l1.m1.4.5.1" xref="alg2.l1.m1.4.5.1.cmml">=</mo><mrow id="alg2.l1.m1.4.5.3.2" xref="alg2.l1.m1.4.5.3.1.cmml"><mn id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">1</mn><mo id="alg2.l1.m1.4.5.3.2.1" xref="alg2.l1.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml">2</mn><mo id="alg2.l1.m1.4.5.3.2.2" xref="alg2.l1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml">…</mi><mo id="alg2.l1.m1.4.5.3.2.3" xref="alg2.l1.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l1.m1.4.4" xref="alg2.l1.m1.4.4.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.4b"><apply id="alg2.l1.m1.4.5.cmml" xref="alg2.l1.m1.4.5"><eq id="alg2.l1.m1.4.5.1.cmml" xref="alg2.l1.m1.4.5.1"></eq><ci id="alg2.l1.m1.4.5.2.cmml" xref="alg2.l1.m1.4.5.2">𝑟</ci><list id="alg2.l1.m1.4.5.3.1.cmml" xref="alg2.l1.m1.4.5.3.2"><cn type="integer" id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">1</cn><cn type="integer" id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">2</cn><ci id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3">…</ci><ci id="alg2.l1.m1.4.4.cmml" xref="alg2.l1.m1.4.4">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.4c">r=1,2,...,R</annotation></semantics></math> <span id="alg2.l1.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l2" class="ltx_listingline">     <span id="alg2.l2.1" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l2.m1.1" class="ltx_math_unparsed" alttext="r==1" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1b"><mi id="alg2.l2.m1.1.1">r</mi><mo rspace="0em" id="alg2.l2.m1.1.2">=</mo><mo lspace="0em" id="alg2.l2.m1.1.3">=</mo><mn id="alg2.l2.m1.1.4">1</mn></mrow><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">r==1</annotation></semantics></math> <span id="alg2.l2.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l3" class="ltx_listingline">        Broadcast LGBM parameters values to clients <math id="alg2.l3.m1.1" class="ltx_Math" alttext="Batch^{0}=\{\}" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mrow id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.1.1.2.1" xref="alg2.l3.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.1.1.2.1a" xref="alg2.l3.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l3.m1.1.1.2.4" xref="alg2.l3.m1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.1.1.2.1b" xref="alg2.l3.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l3.m1.1.1.2.5" xref="alg2.l3.m1.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.1.1.2.1c" xref="alg2.l3.m1.1.1.2.1.cmml">​</mo><msup id="alg2.l3.m1.1.1.2.6" xref="alg2.l3.m1.1.1.2.6.cmml"><mi id="alg2.l3.m1.1.1.2.6.2" xref="alg2.l3.m1.1.1.2.6.2.cmml">h</mi><mn id="alg2.l3.m1.1.1.2.6.3" xref="alg2.l3.m1.1.1.2.6.3.cmml">0</mn></msup></mrow><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mrow id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.cmml"><mo stretchy="false" id="alg2.l3.m1.1.1.3.2.1" xref="alg2.l3.m1.1.1.3.1.cmml">{</mo><mo stretchy="false" id="alg2.l3.m1.1.1.3.2.2" xref="alg2.l3.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><times id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2.1"></times><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝐵</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑎</ci><ci id="alg2.l3.m1.1.1.2.4.cmml" xref="alg2.l3.m1.1.1.2.4">𝑡</ci><ci id="alg2.l3.m1.1.1.2.5.cmml" xref="alg2.l3.m1.1.1.2.5">𝑐</ci><apply id="alg2.l3.m1.1.1.2.6.cmml" xref="alg2.l3.m1.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.6.1.cmml" xref="alg2.l3.m1.1.1.2.6">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.6.2.cmml" xref="alg2.l3.m1.1.1.2.6.2">ℎ</ci><cn type="integer" id="alg2.l3.m1.1.1.2.6.3.cmml" xref="alg2.l3.m1.1.1.2.6.3">0</cn></apply></apply><list id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">Batch^{0}=\{\}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">     Broadcast <math id="alg2.l4.m1.1" class="ltx_Math" alttext="Batch^{r-1}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">​</mo><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.1.1.1a" xref="alg2.l4.m1.1.1.1.cmml">​</mo><mi id="alg2.l4.m1.1.1.4" xref="alg2.l4.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.1.1.1b" xref="alg2.l4.m1.1.1.1.cmml">​</mo><mi id="alg2.l4.m1.1.1.5" xref="alg2.l4.m1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.1.1.1c" xref="alg2.l4.m1.1.1.1.cmml">​</mo><msup id="alg2.l4.m1.1.1.6" xref="alg2.l4.m1.1.1.6.cmml"><mi id="alg2.l4.m1.1.1.6.2" xref="alg2.l4.m1.1.1.6.2.cmml">h</mi><mrow id="alg2.l4.m1.1.1.6.3" xref="alg2.l4.m1.1.1.6.3.cmml"><mi id="alg2.l4.m1.1.1.6.3.2" xref="alg2.l4.m1.1.1.6.3.2.cmml">r</mi><mo id="alg2.l4.m1.1.1.6.3.1" xref="alg2.l4.m1.1.1.6.3.1.cmml">−</mo><mn id="alg2.l4.m1.1.1.6.3.3" xref="alg2.l4.m1.1.1.6.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><times id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></times><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝐵</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑎</ci><ci id="alg2.l4.m1.1.1.4.cmml" xref="alg2.l4.m1.1.1.4">𝑡</ci><ci id="alg2.l4.m1.1.1.5.cmml" xref="alg2.l4.m1.1.1.5">𝑐</ci><apply id="alg2.l4.m1.1.1.6.cmml" xref="alg2.l4.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.6.1.cmml" xref="alg2.l4.m1.1.1.6">superscript</csymbol><ci id="alg2.l4.m1.1.1.6.2.cmml" xref="alg2.l4.m1.1.1.6.2">ℎ</ci><apply id="alg2.l4.m1.1.1.6.3.cmml" xref="alg2.l4.m1.1.1.6.3"><minus id="alg2.l4.m1.1.1.6.3.1.cmml" xref="alg2.l4.m1.1.1.6.3.1"></minus><ci id="alg2.l4.m1.1.1.6.3.2.cmml" xref="alg2.l4.m1.1.1.6.3.2">𝑟</ci><cn type="integer" id="alg2.l4.m1.1.1.6.3.3.cmml" xref="alg2.l4.m1.1.1.6.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">Batch^{r-1}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">     <span id="alg2.l5.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l5.m1.4" class="ltx_Math" alttext="k=1,2,...,C" display="inline"><semantics id="alg2.l5.m1.4a"><mrow id="alg2.l5.m1.4.5" xref="alg2.l5.m1.4.5.cmml"><mi id="alg2.l5.m1.4.5.2" xref="alg2.l5.m1.4.5.2.cmml">k</mi><mo id="alg2.l5.m1.4.5.1" xref="alg2.l5.m1.4.5.1.cmml">=</mo><mrow id="alg2.l5.m1.4.5.3.2" xref="alg2.l5.m1.4.5.3.1.cmml"><mn id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">1</mn><mo id="alg2.l5.m1.4.5.3.2.1" xref="alg2.l5.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml">2</mn><mo id="alg2.l5.m1.4.5.3.2.2" xref="alg2.l5.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l5.m1.3.3" xref="alg2.l5.m1.3.3.cmml">…</mi><mo id="alg2.l5.m1.4.5.3.2.3" xref="alg2.l5.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l5.m1.4.4" xref="alg2.l5.m1.4.4.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.4b"><apply id="alg2.l5.m1.4.5.cmml" xref="alg2.l5.m1.4.5"><eq id="alg2.l5.m1.4.5.1.cmml" xref="alg2.l5.m1.4.5.1"></eq><ci id="alg2.l5.m1.4.5.2.cmml" xref="alg2.l5.m1.4.5.2">𝑘</ci><list id="alg2.l5.m1.4.5.3.1.cmml" xref="alg2.l5.m1.4.5.3.2"><cn type="integer" id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">1</cn><cn type="integer" id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2">2</cn><ci id="alg2.l5.m1.3.3.cmml" xref="alg2.l5.m1.3.3">…</ci><ci id="alg2.l5.m1.4.4.cmml" xref="alg2.l5.m1.4.4">𝐶</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.4c">k=1,2,...,C</annotation></semantics></math> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l6" class="ltx_listingline">        Store <math id="alg2.l6.m1.1" class="ltx_Math" alttext="Batch^{r-1}" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1a" xref="alg2.l6.m1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.4" xref="alg2.l6.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1b" xref="alg2.l6.m1.1.1.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.5" xref="alg2.l6.m1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1c" xref="alg2.l6.m1.1.1.1.cmml">​</mo><msup id="alg2.l6.m1.1.1.6" xref="alg2.l6.m1.1.1.6.cmml"><mi id="alg2.l6.m1.1.1.6.2" xref="alg2.l6.m1.1.1.6.2.cmml">h</mi><mrow id="alg2.l6.m1.1.1.6.3" xref="alg2.l6.m1.1.1.6.3.cmml"><mi id="alg2.l6.m1.1.1.6.3.2" xref="alg2.l6.m1.1.1.6.3.2.cmml">r</mi><mo id="alg2.l6.m1.1.1.6.3.1" xref="alg2.l6.m1.1.1.6.3.1.cmml">−</mo><mn id="alg2.l6.m1.1.1.6.3.3" xref="alg2.l6.m1.1.1.6.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><times id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1"></times><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝐵</ci><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">𝑎</ci><ci id="alg2.l6.m1.1.1.4.cmml" xref="alg2.l6.m1.1.1.4">𝑡</ci><ci id="alg2.l6.m1.1.1.5.cmml" xref="alg2.l6.m1.1.1.5">𝑐</ci><apply id="alg2.l6.m1.1.1.6.cmml" xref="alg2.l6.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.6.1.cmml" xref="alg2.l6.m1.1.1.6">superscript</csymbol><ci id="alg2.l6.m1.1.1.6.2.cmml" xref="alg2.l6.m1.1.1.6.2">ℎ</ci><apply id="alg2.l6.m1.1.1.6.3.cmml" xref="alg2.l6.m1.1.1.6.3"><minus id="alg2.l6.m1.1.1.6.3.1.cmml" xref="alg2.l6.m1.1.1.6.3.1"></minus><ci id="alg2.l6.m1.1.1.6.3.2.cmml" xref="alg2.l6.m1.1.1.6.3.2">𝑟</ci><cn type="integer" id="alg2.l6.m1.1.1.6.3.3.cmml" xref="alg2.l6.m1.1.1.6.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">Batch^{r-1}</annotation></semantics></math> in memory


</div>
<div id="alg2.l7" class="ltx_listingline">        <math id="alg2.l7.m1.1" class="ltx_Math" alttext="Batch_{k}^{r}\leftarrow" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml"><mi id="alg2.l7.m1.1.1.2.2" xref="alg2.l7.m1.1.1.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.2.1" xref="alg2.l7.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.2.3" xref="alg2.l7.m1.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.2.1a" xref="alg2.l7.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.2.4" xref="alg2.l7.m1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.2.1b" xref="alg2.l7.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.2.5" xref="alg2.l7.m1.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.2.1c" xref="alg2.l7.m1.1.1.2.1.cmml">​</mo><msubsup id="alg2.l7.m1.1.1.2.6" xref="alg2.l7.m1.1.1.2.6.cmml"><mi id="alg2.l7.m1.1.1.2.6.2.2" xref="alg2.l7.m1.1.1.2.6.2.2.cmml">h</mi><mi id="alg2.l7.m1.1.1.2.6.2.3" xref="alg2.l7.m1.1.1.2.6.2.3.cmml">k</mi><mi id="alg2.l7.m1.1.1.2.6.3" xref="alg2.l7.m1.1.1.2.6.3.cmml">r</mi></msubsup></mrow><mo stretchy="false" id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">←</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1">←</ci><apply id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"><times id="alg2.l7.m1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.2.1"></times><ci id="alg2.l7.m1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.2.2">𝐵</ci><ci id="alg2.l7.m1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.2.3">𝑎</ci><ci id="alg2.l7.m1.1.1.2.4.cmml" xref="alg2.l7.m1.1.1.2.4">𝑡</ci><ci id="alg2.l7.m1.1.1.2.5.cmml" xref="alg2.l7.m1.1.1.2.5">𝑐</ci><apply id="alg2.l7.m1.1.1.2.6.cmml" xref="alg2.l7.m1.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.6.1.cmml" xref="alg2.l7.m1.1.1.2.6">superscript</csymbol><apply id="alg2.l7.m1.1.1.2.6.2.cmml" xref="alg2.l7.m1.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.6.2.1.cmml" xref="alg2.l7.m1.1.1.2.6">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.6.2.2.cmml" xref="alg2.l7.m1.1.1.2.6.2.2">ℎ</ci><ci id="alg2.l7.m1.1.1.2.6.2.3.cmml" xref="alg2.l7.m1.1.1.2.6.2.3">𝑘</ci></apply><ci id="alg2.l7.m1.1.1.2.6.3.cmml" xref="alg2.l7.m1.1.1.2.6.3">𝑟</ci></apply></apply><csymbol cd="latexml" id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">Batch_{k}^{r}\leftarrow</annotation></semantics></math> ClientUpdate(<math id="alg2.l7.m2.3" class="ltx_Math" alttext="k,\sum_{i=0}^{r-1}{Batch^{i}},r" display="inline"><semantics id="alg2.l7.m2.3a"><mrow id="alg2.l7.m2.3.3.1" xref="alg2.l7.m2.3.3.2.cmml"><mi id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml">k</mi><mo rspace="0em" id="alg2.l7.m2.3.3.1.2" xref="alg2.l7.m2.3.3.2.cmml">,</mo><mrow id="alg2.l7.m2.3.3.1.1" xref="alg2.l7.m2.3.3.1.1.cmml"><msubsup id="alg2.l7.m2.3.3.1.1.1" xref="alg2.l7.m2.3.3.1.1.1.cmml"><mo id="alg2.l7.m2.3.3.1.1.1.2.2" xref="alg2.l7.m2.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l7.m2.3.3.1.1.1.2.3" xref="alg2.l7.m2.3.3.1.1.1.2.3.cmml"><mi id="alg2.l7.m2.3.3.1.1.1.2.3.2" xref="alg2.l7.m2.3.3.1.1.1.2.3.2.cmml">i</mi><mo id="alg2.l7.m2.3.3.1.1.1.2.3.1" xref="alg2.l7.m2.3.3.1.1.1.2.3.1.cmml">=</mo><mn id="alg2.l7.m2.3.3.1.1.1.2.3.3" xref="alg2.l7.m2.3.3.1.1.1.2.3.3.cmml">0</mn></mrow><mrow id="alg2.l7.m2.3.3.1.1.1.3" xref="alg2.l7.m2.3.3.1.1.1.3.cmml"><mi id="alg2.l7.m2.3.3.1.1.1.3.2" xref="alg2.l7.m2.3.3.1.1.1.3.2.cmml">r</mi><mo id="alg2.l7.m2.3.3.1.1.1.3.1" xref="alg2.l7.m2.3.3.1.1.1.3.1.cmml">−</mo><mn id="alg2.l7.m2.3.3.1.1.1.3.3" xref="alg2.l7.m2.3.3.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg2.l7.m2.3.3.1.1.2" xref="alg2.l7.m2.3.3.1.1.2.cmml"><mi id="alg2.l7.m2.3.3.1.1.2.2" xref="alg2.l7.m2.3.3.1.1.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.3.3.1.1.2.1" xref="alg2.l7.m2.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m2.3.3.1.1.2.3" xref="alg2.l7.m2.3.3.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.3.3.1.1.2.1a" xref="alg2.l7.m2.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m2.3.3.1.1.2.4" xref="alg2.l7.m2.3.3.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.3.3.1.1.2.1b" xref="alg2.l7.m2.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m2.3.3.1.1.2.5" xref="alg2.l7.m2.3.3.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.3.3.1.1.2.1c" xref="alg2.l7.m2.3.3.1.1.2.1.cmml">​</mo><msup id="alg2.l7.m2.3.3.1.1.2.6" xref="alg2.l7.m2.3.3.1.1.2.6.cmml"><mi id="alg2.l7.m2.3.3.1.1.2.6.2" xref="alg2.l7.m2.3.3.1.1.2.6.2.cmml">h</mi><mi id="alg2.l7.m2.3.3.1.1.2.6.3" xref="alg2.l7.m2.3.3.1.1.2.6.3.cmml">i</mi></msup></mrow></mrow><mo id="alg2.l7.m2.3.3.1.3" xref="alg2.l7.m2.3.3.2.cmml">,</mo><mi id="alg2.l7.m2.2.2" xref="alg2.l7.m2.2.2.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.3b"><list id="alg2.l7.m2.3.3.2.cmml" xref="alg2.l7.m2.3.3.1"><ci id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1">𝑘</ci><apply id="alg2.l7.m2.3.3.1.1.cmml" xref="alg2.l7.m2.3.3.1.1"><apply id="alg2.l7.m2.3.3.1.1.1.cmml" xref="alg2.l7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.3.3.1.1.1.1.cmml" xref="alg2.l7.m2.3.3.1.1.1">superscript</csymbol><apply id="alg2.l7.m2.3.3.1.1.1.2.cmml" xref="alg2.l7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.3.3.1.1.1.2.1.cmml" xref="alg2.l7.m2.3.3.1.1.1">subscript</csymbol><sum id="alg2.l7.m2.3.3.1.1.1.2.2.cmml" xref="alg2.l7.m2.3.3.1.1.1.2.2"></sum><apply id="alg2.l7.m2.3.3.1.1.1.2.3.cmml" xref="alg2.l7.m2.3.3.1.1.1.2.3"><eq id="alg2.l7.m2.3.3.1.1.1.2.3.1.cmml" xref="alg2.l7.m2.3.3.1.1.1.2.3.1"></eq><ci id="alg2.l7.m2.3.3.1.1.1.2.3.2.cmml" xref="alg2.l7.m2.3.3.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="alg2.l7.m2.3.3.1.1.1.2.3.3.cmml" xref="alg2.l7.m2.3.3.1.1.1.2.3.3">0</cn></apply></apply><apply id="alg2.l7.m2.3.3.1.1.1.3.cmml" xref="alg2.l7.m2.3.3.1.1.1.3"><minus id="alg2.l7.m2.3.3.1.1.1.3.1.cmml" xref="alg2.l7.m2.3.3.1.1.1.3.1"></minus><ci id="alg2.l7.m2.3.3.1.1.1.3.2.cmml" xref="alg2.l7.m2.3.3.1.1.1.3.2">𝑟</ci><cn type="integer" id="alg2.l7.m2.3.3.1.1.1.3.3.cmml" xref="alg2.l7.m2.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l7.m2.3.3.1.1.2.cmml" xref="alg2.l7.m2.3.3.1.1.2"><times id="alg2.l7.m2.3.3.1.1.2.1.cmml" xref="alg2.l7.m2.3.3.1.1.2.1"></times><ci id="alg2.l7.m2.3.3.1.1.2.2.cmml" xref="alg2.l7.m2.3.3.1.1.2.2">𝐵</ci><ci id="alg2.l7.m2.3.3.1.1.2.3.cmml" xref="alg2.l7.m2.3.3.1.1.2.3">𝑎</ci><ci id="alg2.l7.m2.3.3.1.1.2.4.cmml" xref="alg2.l7.m2.3.3.1.1.2.4">𝑡</ci><ci id="alg2.l7.m2.3.3.1.1.2.5.cmml" xref="alg2.l7.m2.3.3.1.1.2.5">𝑐</ci><apply id="alg2.l7.m2.3.3.1.1.2.6.cmml" xref="alg2.l7.m2.3.3.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l7.m2.3.3.1.1.2.6.1.cmml" xref="alg2.l7.m2.3.3.1.1.2.6">superscript</csymbol><ci id="alg2.l7.m2.3.3.1.1.2.6.2.cmml" xref="alg2.l7.m2.3.3.1.1.2.6.2">ℎ</ci><ci id="alg2.l7.m2.3.3.1.1.2.6.3.cmml" xref="alg2.l7.m2.3.3.1.1.2.6.3">𝑖</ci></apply></apply></apply><ci id="alg2.l7.m2.2.2.cmml" xref="alg2.l7.m2.2.2">𝑟</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.3c">k,\sum_{i=0}^{r-1}{Batch^{i}},r</annotation></semantics></math>)

<span id="alg2.l7.1" class="ltx_text" style="font-size:90%;">
//<span id="alg2.l7.1.1" class="ltx_text ltx_font_italic">Find the best Batch</span>
</span>

</div>
<div id="alg2.l8" class="ltx_listingline">     <math id="alg2.l8.m1.1" class="ltx_Math" alttext="Batch^{r}" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1a" xref="alg2.l8.m1.1.1.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.4" xref="alg2.l8.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1b" xref="alg2.l8.m1.1.1.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.5" xref="alg2.l8.m1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1c" xref="alg2.l8.m1.1.1.1.cmml">​</mo><msup id="alg2.l8.m1.1.1.6" xref="alg2.l8.m1.1.1.6.cmml"><mi id="alg2.l8.m1.1.1.6.2" xref="alg2.l8.m1.1.1.6.2.cmml">h</mi><mi id="alg2.l8.m1.1.1.6.3" xref="alg2.l8.m1.1.1.6.3.cmml">r</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><times id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></times><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝐵</ci><ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">𝑎</ci><ci id="alg2.l8.m1.1.1.4.cmml" xref="alg2.l8.m1.1.1.4">𝑡</ci><ci id="alg2.l8.m1.1.1.5.cmml" xref="alg2.l8.m1.1.1.5">𝑐</ci><apply id="alg2.l8.m1.1.1.6.cmml" xref="alg2.l8.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.6.1.cmml" xref="alg2.l8.m1.1.1.6">superscript</csymbol><ci id="alg2.l8.m1.1.1.6.2.cmml" xref="alg2.l8.m1.1.1.6.2">ℎ</ci><ci id="alg2.l8.m1.1.1.6.3.cmml" xref="alg2.l8.m1.1.1.6.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">Batch^{r}</annotation></semantics></math> <math id="alg2.l8.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l8.m2.1a"><mo stretchy="false" id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><ci id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">\leftarrow</annotation></semantics></math> <span id="alg2.l8.1" class="ltx_text" style="font-size:90%;">Server validation <math id="alg2.l8.1.m1.1" class="ltx_Math" alttext="\{\sum_{i=0}^{r-1}{Batch^{i}+Batch_{k}^{r}}\}_{k=1}^{C}" display="inline"><semantics id="alg2.l8.1.m1.1a"><msubsup id="alg2.l8.1.m1.1.1" xref="alg2.l8.1.m1.1.1.cmml"><mrow id="alg2.l8.1.m1.1.1.1.1.1" xref="alg2.l8.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l8.1.m1.1.1.1.1.1.2" xref="alg2.l8.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l8.1.m1.1.1.1.1.1.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.cmml"><mrow id="alg2.l8.1.m1.1.1.1.1.1.1.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.cmml"><msubsup id="alg2.l8.1.m1.1.1.1.1.1.1.2.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.cmml"><mo lspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.2.cmml">i</mi><mo id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.3.cmml">0</mn></mrow><mrow id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.2.cmml">r</mi><mo id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.1.cmml">−</mo><mn id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg2.l8.1.m1.1.1.1.1.1.1.2.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1a" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.4" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1b" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.5" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1c" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1.cmml">​</mo><msup id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.2.cmml">h</mi><mi id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.3.cmml">i</mi></msup></mrow></mrow><mo id="alg2.l8.1.m1.1.1.1.1.1.1.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg2.l8.1.m1.1.1.1.1.1.1.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.3.1" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.3.1a" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.4" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.3.1b" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.5" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l8.1.m1.1.1.1.1.1.1.3.1c" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="alg2.l8.1.m1.1.1.1.1.1.1.3.6" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.cmml"><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.2" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.2.cmml">h</mi><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.3.cmml">k</mi><mi id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.3" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.3.cmml">r</mi></msubsup></mrow></mrow><mo stretchy="false" id="alg2.l8.1.m1.1.1.1.1.1.3" xref="alg2.l8.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l8.1.m1.1.1.1.3" xref="alg2.l8.1.m1.1.1.1.3.cmml"><mi id="alg2.l8.1.m1.1.1.1.3.2" xref="alg2.l8.1.m1.1.1.1.3.2.cmml">k</mi><mo id="alg2.l8.1.m1.1.1.1.3.1" xref="alg2.l8.1.m1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l8.1.m1.1.1.1.3.3" xref="alg2.l8.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l8.1.m1.1.1.3" xref="alg2.l8.1.m1.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><apply id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.2.cmml" xref="alg2.l8.1.m1.1.1">superscript</csymbol><apply id="alg2.l8.1.m1.1.1.1.cmml" xref="alg2.l8.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.2.cmml" xref="alg2.l8.1.m1.1.1">subscript</csymbol><set id="alg2.l8.1.m1.1.1.1.1.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1"><apply id="alg2.l8.1.m1.1.1.1.1.1.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1"><plus id="alg2.l8.1.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.1"></plus><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2"><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3"><eq id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.2.3.3">0</cn></apply></apply><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3"><minus id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.1"></minus><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.2">𝑟</ci><cn type="integer" id="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2"><times id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.1"></times><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.2">𝐵</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.3">𝑎</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.4.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.4">𝑡</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.5.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.5">𝑐</ci><apply id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6">superscript</csymbol><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.2">ℎ</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.2.2.6.3">𝑖</ci></apply></apply></apply><apply id="alg2.l8.1.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3"><times id="alg2.l8.1.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.1"></times><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.2">𝐵</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.4.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.4">𝑡</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.5.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.5">𝑐</ci><apply id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6">superscript</csymbol><apply id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.1.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6">subscript</csymbol><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.2.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.2">ℎ</ci><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.2.3">𝑘</ci></apply><ci id="alg2.l8.1.m1.1.1.1.1.1.1.3.6.3.cmml" xref="alg2.l8.1.m1.1.1.1.1.1.1.3.6.3">𝑟</ci></apply></apply></apply></set><apply id="alg2.l8.1.m1.1.1.1.3.cmml" xref="alg2.l8.1.m1.1.1.1.3"><eq id="alg2.l8.1.m1.1.1.1.3.1.cmml" xref="alg2.l8.1.m1.1.1.1.3.1"></eq><ci id="alg2.l8.1.m1.1.1.1.3.2.cmml" xref="alg2.l8.1.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="alg2.l8.1.m1.1.1.1.3.3.cmml" xref="alg2.l8.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l8.1.m1.1.1.3.cmml" xref="alg2.l8.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">\{\sum_{i=0}^{r-1}{Batch^{i}+Batch_{k}^{r}}\}_{k=1}^{C}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l9" class="ltx_listingline">  
</div>
<div id="alg2.l9a" class="ltx_listingline">  (<math id="alg2.l9a.m1.3" class="ltx_Math" alttext="k,\sum_{i=0}^{r-1}{Batch^{i}},r" display="inline"><semantics id="alg2.l9a.m1.3a"><mrow id="alg2.l9a.m1.3.3.1" xref="alg2.l9a.m1.3.3.2.cmml"><mi id="alg2.l9a.m1.1.1" xref="alg2.l9a.m1.1.1.cmml">k</mi><mo rspace="0em" id="alg2.l9a.m1.3.3.1.2" xref="alg2.l9a.m1.3.3.2.cmml">,</mo><mrow id="alg2.l9a.m1.3.3.1.1" xref="alg2.l9a.m1.3.3.1.1.cmml"><msubsup id="alg2.l9a.m1.3.3.1.1.1" xref="alg2.l9a.m1.3.3.1.1.1.cmml"><mo id="alg2.l9a.m1.3.3.1.1.1.2.2" xref="alg2.l9a.m1.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l9a.m1.3.3.1.1.1.2.3" xref="alg2.l9a.m1.3.3.1.1.1.2.3.cmml"><mi id="alg2.l9a.m1.3.3.1.1.1.2.3.2" xref="alg2.l9a.m1.3.3.1.1.1.2.3.2.cmml">i</mi><mo id="alg2.l9a.m1.3.3.1.1.1.2.3.1" xref="alg2.l9a.m1.3.3.1.1.1.2.3.1.cmml">=</mo><mn id="alg2.l9a.m1.3.3.1.1.1.2.3.3" xref="alg2.l9a.m1.3.3.1.1.1.2.3.3.cmml">0</mn></mrow><mrow id="alg2.l9a.m1.3.3.1.1.1.3" xref="alg2.l9a.m1.3.3.1.1.1.3.cmml"><mi id="alg2.l9a.m1.3.3.1.1.1.3.2" xref="alg2.l9a.m1.3.3.1.1.1.3.2.cmml">r</mi><mo id="alg2.l9a.m1.3.3.1.1.1.3.1" xref="alg2.l9a.m1.3.3.1.1.1.3.1.cmml">−</mo><mn id="alg2.l9a.m1.3.3.1.1.1.3.3" xref="alg2.l9a.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg2.l9a.m1.3.3.1.1.2" xref="alg2.l9a.m1.3.3.1.1.2.cmml"><mi id="alg2.l9a.m1.3.3.1.1.2.2" xref="alg2.l9a.m1.3.3.1.1.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l9a.m1.3.3.1.1.2.1" xref="alg2.l9a.m1.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l9a.m1.3.3.1.1.2.3" xref="alg2.l9a.m1.3.3.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l9a.m1.3.3.1.1.2.1a" xref="alg2.l9a.m1.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l9a.m1.3.3.1.1.2.4" xref="alg2.l9a.m1.3.3.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l9a.m1.3.3.1.1.2.1b" xref="alg2.l9a.m1.3.3.1.1.2.1.cmml">​</mo><mi id="alg2.l9a.m1.3.3.1.1.2.5" xref="alg2.l9a.m1.3.3.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l9a.m1.3.3.1.1.2.1c" xref="alg2.l9a.m1.3.3.1.1.2.1.cmml">​</mo><msup id="alg2.l9a.m1.3.3.1.1.2.6" xref="alg2.l9a.m1.3.3.1.1.2.6.cmml"><mi id="alg2.l9a.m1.3.3.1.1.2.6.2" xref="alg2.l9a.m1.3.3.1.1.2.6.2.cmml">h</mi><mi id="alg2.l9a.m1.3.3.1.1.2.6.3" xref="alg2.l9a.m1.3.3.1.1.2.6.3.cmml">i</mi></msup></mrow></mrow><mo id="alg2.l9a.m1.3.3.1.3" xref="alg2.l9a.m1.3.3.2.cmml">,</mo><mi id="alg2.l9a.m1.2.2" xref="alg2.l9a.m1.2.2.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9a.m1.3b"><list id="alg2.l9a.m1.3.3.2.cmml" xref="alg2.l9a.m1.3.3.1"><ci id="alg2.l9a.m1.1.1.cmml" xref="alg2.l9a.m1.1.1">𝑘</ci><apply id="alg2.l9a.m1.3.3.1.1.cmml" xref="alg2.l9a.m1.3.3.1.1"><apply id="alg2.l9a.m1.3.3.1.1.1.cmml" xref="alg2.l9a.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l9a.m1.3.3.1.1.1.1.cmml" xref="alg2.l9a.m1.3.3.1.1.1">superscript</csymbol><apply id="alg2.l9a.m1.3.3.1.1.1.2.cmml" xref="alg2.l9a.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l9a.m1.3.3.1.1.1.2.1.cmml" xref="alg2.l9a.m1.3.3.1.1.1">subscript</csymbol><sum id="alg2.l9a.m1.3.3.1.1.1.2.2.cmml" xref="alg2.l9a.m1.3.3.1.1.1.2.2"></sum><apply id="alg2.l9a.m1.3.3.1.1.1.2.3.cmml" xref="alg2.l9a.m1.3.3.1.1.1.2.3"><eq id="alg2.l9a.m1.3.3.1.1.1.2.3.1.cmml" xref="alg2.l9a.m1.3.3.1.1.1.2.3.1"></eq><ci id="alg2.l9a.m1.3.3.1.1.1.2.3.2.cmml" xref="alg2.l9a.m1.3.3.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="alg2.l9a.m1.3.3.1.1.1.2.3.3.cmml" xref="alg2.l9a.m1.3.3.1.1.1.2.3.3">0</cn></apply></apply><apply id="alg2.l9a.m1.3.3.1.1.1.3.cmml" xref="alg2.l9a.m1.3.3.1.1.1.3"><minus id="alg2.l9a.m1.3.3.1.1.1.3.1.cmml" xref="alg2.l9a.m1.3.3.1.1.1.3.1"></minus><ci id="alg2.l9a.m1.3.3.1.1.1.3.2.cmml" xref="alg2.l9a.m1.3.3.1.1.1.3.2">𝑟</ci><cn type="integer" id="alg2.l9a.m1.3.3.1.1.1.3.3.cmml" xref="alg2.l9a.m1.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l9a.m1.3.3.1.1.2.cmml" xref="alg2.l9a.m1.3.3.1.1.2"><times id="alg2.l9a.m1.3.3.1.1.2.1.cmml" xref="alg2.l9a.m1.3.3.1.1.2.1"></times><ci id="alg2.l9a.m1.3.3.1.1.2.2.cmml" xref="alg2.l9a.m1.3.3.1.1.2.2">𝐵</ci><ci id="alg2.l9a.m1.3.3.1.1.2.3.cmml" xref="alg2.l9a.m1.3.3.1.1.2.3">𝑎</ci><ci id="alg2.l9a.m1.3.3.1.1.2.4.cmml" xref="alg2.l9a.m1.3.3.1.1.2.4">𝑡</ci><ci id="alg2.l9a.m1.3.3.1.1.2.5.cmml" xref="alg2.l9a.m1.3.3.1.1.2.5">𝑐</ci><apply id="alg2.l9a.m1.3.3.1.1.2.6.cmml" xref="alg2.l9a.m1.3.3.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l9a.m1.3.3.1.1.2.6.1.cmml" xref="alg2.l9a.m1.3.3.1.1.2.6">superscript</csymbol><ci id="alg2.l9a.m1.3.3.1.1.2.6.2.cmml" xref="alg2.l9a.m1.3.3.1.1.2.6.2">ℎ</ci><ci id="alg2.l9a.m1.3.3.1.1.2.6.3.cmml" xref="alg2.l9a.m1.3.3.1.1.2.6.3">𝑖</ci></apply></apply></apply><ci id="alg2.l9a.m1.2.2.cmml" xref="alg2.l9a.m1.2.2">𝑟</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9a.m1.3c">k,\sum_{i=0}^{r-1}{Batch^{i}},r</annotation></semantics></math>)<span id="alg2.l9a.1" class="ltx_text ltx_font_bold">:</span>


</div>
<div id="alg2.l10" class="ltx_listingline">  <math id="alg2.l10.m1.1" class="ltx_Math" alttext="Model_{k}^{r}\leftarrow\sum_{i=0}^{r-1}{Batch^{i}}+\sum_{t=1}^{T}{DT_{t}}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mrow id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mi id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.3" xref="alg2.l10.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1a" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.4" xref="alg2.l10.m1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1b" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.5" xref="alg2.l10.m1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1c" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><msubsup id="alg2.l10.m1.1.1.2.6" xref="alg2.l10.m1.1.1.2.6.cmml"><mi id="alg2.l10.m1.1.1.2.6.2.2" xref="alg2.l10.m1.1.1.2.6.2.2.cmml">l</mi><mi id="alg2.l10.m1.1.1.2.6.2.3" xref="alg2.l10.m1.1.1.2.6.2.3.cmml">k</mi><mi id="alg2.l10.m1.1.1.2.6.3" xref="alg2.l10.m1.1.1.2.6.3.cmml">r</mi></msubsup></mrow><mo rspace="0.111em" stretchy="false" id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">←</mo><mrow id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><mrow id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml"><msubsup id="alg2.l10.m1.1.1.3.2.1" xref="alg2.l10.m1.1.1.3.2.1.cmml"><mo id="alg2.l10.m1.1.1.3.2.1.2.2" xref="alg2.l10.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.1.1.3.2.1.2.3" xref="alg2.l10.m1.1.1.3.2.1.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.2.1.2.3.2" xref="alg2.l10.m1.1.1.3.2.1.2.3.2.cmml">i</mi><mo id="alg2.l10.m1.1.1.3.2.1.2.3.1" xref="alg2.l10.m1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.1.1.3.2.1.2.3.3" xref="alg2.l10.m1.1.1.3.2.1.2.3.3.cmml">0</mn></mrow><mrow id="alg2.l10.m1.1.1.3.2.1.3" xref="alg2.l10.m1.1.1.3.2.1.3.cmml"><mi id="alg2.l10.m1.1.1.3.2.1.3.2" xref="alg2.l10.m1.1.1.3.2.1.3.2.cmml">r</mi><mo id="alg2.l10.m1.1.1.3.2.1.3.1" xref="alg2.l10.m1.1.1.3.2.1.3.1.cmml">−</mo><mn id="alg2.l10.m1.1.1.3.2.1.3.3" xref="alg2.l10.m1.1.1.3.2.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg2.l10.m1.1.1.3.2.2" xref="alg2.l10.m1.1.1.3.2.2.cmml"><mi id="alg2.l10.m1.1.1.3.2.2.2" xref="alg2.l10.m1.1.1.3.2.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.2.2.1" xref="alg2.l10.m1.1.1.3.2.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.3.2.2.3" xref="alg2.l10.m1.1.1.3.2.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.2.2.1a" xref="alg2.l10.m1.1.1.3.2.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.3.2.2.4" xref="alg2.l10.m1.1.1.3.2.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.2.2.1b" xref="alg2.l10.m1.1.1.3.2.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.3.2.2.5" xref="alg2.l10.m1.1.1.3.2.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.2.2.1c" xref="alg2.l10.m1.1.1.3.2.2.1.cmml">​</mo><msup id="alg2.l10.m1.1.1.3.2.2.6" xref="alg2.l10.m1.1.1.3.2.2.6.cmml"><mi id="alg2.l10.m1.1.1.3.2.2.6.2" xref="alg2.l10.m1.1.1.3.2.2.6.2.cmml">h</mi><mi id="alg2.l10.m1.1.1.3.2.2.6.3" xref="alg2.l10.m1.1.1.3.2.2.6.3.cmml">i</mi></msup></mrow></mrow><mo rspace="0.055em" id="alg2.l10.m1.1.1.3.1" xref="alg2.l10.m1.1.1.3.1.cmml">+</mo><mrow id="alg2.l10.m1.1.1.3.3" xref="alg2.l10.m1.1.1.3.3.cmml"><msubsup id="alg2.l10.m1.1.1.3.3.1" xref="alg2.l10.m1.1.1.3.3.1.cmml"><mo id="alg2.l10.m1.1.1.3.3.1.2.2" xref="alg2.l10.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.1.1.3.3.1.2.3" xref="alg2.l10.m1.1.1.3.3.1.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.3.1.2.3.2" xref="alg2.l10.m1.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="alg2.l10.m1.1.1.3.3.1.2.3.1" xref="alg2.l10.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.1.1.3.3.1.2.3.3" xref="alg2.l10.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l10.m1.1.1.3.3.1.3" xref="alg2.l10.m1.1.1.3.3.1.3.cmml">T</mi></msubsup><mrow id="alg2.l10.m1.1.1.3.3.2" xref="alg2.l10.m1.1.1.3.3.2.cmml"><mi id="alg2.l10.m1.1.1.3.3.2.2" xref="alg2.l10.m1.1.1.3.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.3.2.1" xref="alg2.l10.m1.1.1.3.3.2.1.cmml">​</mo><msub id="alg2.l10.m1.1.1.3.3.2.3" xref="alg2.l10.m1.1.1.3.3.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.3.2.3.2" xref="alg2.l10.m1.1.1.3.3.2.3.2.cmml">T</mi><mi id="alg2.l10.m1.1.1.3.3.2.3.3" xref="alg2.l10.m1.1.1.3.3.2.3.3.cmml">t</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">←</ci><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><times id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2.1"></times><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">𝑀</ci><ci id="alg2.l10.m1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.2.3">𝑜</ci><ci id="alg2.l10.m1.1.1.2.4.cmml" xref="alg2.l10.m1.1.1.2.4">𝑑</ci><ci id="alg2.l10.m1.1.1.2.5.cmml" xref="alg2.l10.m1.1.1.2.5">𝑒</ci><apply id="alg2.l10.m1.1.1.2.6.cmml" xref="alg2.l10.m1.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.2.6.1.cmml" xref="alg2.l10.m1.1.1.2.6">superscript</csymbol><apply id="alg2.l10.m1.1.1.2.6.2.cmml" xref="alg2.l10.m1.1.1.2.6"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.2.6.2.1.cmml" xref="alg2.l10.m1.1.1.2.6">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.6.2.2.cmml" xref="alg2.l10.m1.1.1.2.6.2.2">𝑙</ci><ci id="alg2.l10.m1.1.1.2.6.2.3.cmml" xref="alg2.l10.m1.1.1.2.6.2.3">𝑘</ci></apply><ci id="alg2.l10.m1.1.1.2.6.3.cmml" xref="alg2.l10.m1.1.1.2.6.3">𝑟</ci></apply></apply><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><plus id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3.1"></plus><apply id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2"><apply id="alg2.l10.m1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.1.1.cmml" xref="alg2.l10.m1.1.1.3.2.1">superscript</csymbol><apply id="alg2.l10.m1.1.1.3.2.1.2.cmml" xref="alg2.l10.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.1.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.1">subscript</csymbol><sum id="alg2.l10.m1.1.1.3.2.1.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.1.2.2"></sum><apply id="alg2.l10.m1.1.1.3.2.1.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.1.2.3"><eq id="alg2.l10.m1.1.1.3.2.1.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.2.1.2.3.1"></eq><ci id="alg2.l10.m1.1.1.3.2.1.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="alg2.l10.m1.1.1.3.2.1.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.2.1.2.3.3">0</cn></apply></apply><apply id="alg2.l10.m1.1.1.3.2.1.3.cmml" xref="alg2.l10.m1.1.1.3.2.1.3"><minus id="alg2.l10.m1.1.1.3.2.1.3.1.cmml" xref="alg2.l10.m1.1.1.3.2.1.3.1"></minus><ci id="alg2.l10.m1.1.1.3.2.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2.1.3.2">𝑟</ci><cn type="integer" id="alg2.l10.m1.1.1.3.2.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2"><times id="alg2.l10.m1.1.1.3.2.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.2.1"></times><ci id="alg2.l10.m1.1.1.3.2.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2.2">𝐵</ci><ci id="alg2.l10.m1.1.1.3.2.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.3">𝑎</ci><ci id="alg2.l10.m1.1.1.3.2.2.4.cmml" xref="alg2.l10.m1.1.1.3.2.2.4">𝑡</ci><ci id="alg2.l10.m1.1.1.3.2.2.5.cmml" xref="alg2.l10.m1.1.1.3.2.2.5">𝑐</ci><apply id="alg2.l10.m1.1.1.3.2.2.6.cmml" xref="alg2.l10.m1.1.1.3.2.2.6"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.2.6.1.cmml" xref="alg2.l10.m1.1.1.3.2.2.6">superscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.2.6.2.cmml" xref="alg2.l10.m1.1.1.3.2.2.6.2">ℎ</ci><ci id="alg2.l10.m1.1.1.3.2.2.6.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.6.3">𝑖</ci></apply></apply></apply><apply id="alg2.l10.m1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.3"><apply id="alg2.l10.m1.1.1.3.3.1.cmml" xref="alg2.l10.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.3.1.1.cmml" xref="alg2.l10.m1.1.1.3.3.1">superscript</csymbol><apply id="alg2.l10.m1.1.1.3.3.1.2.cmml" xref="alg2.l10.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.3.1.2.1.cmml" xref="alg2.l10.m1.1.1.3.3.1">subscript</csymbol><sum id="alg2.l10.m1.1.1.3.3.1.2.2.cmml" xref="alg2.l10.m1.1.1.3.3.1.2.2"></sum><apply id="alg2.l10.m1.1.1.3.3.1.2.3.cmml" xref="alg2.l10.m1.1.1.3.3.1.2.3"><eq id="alg2.l10.m1.1.1.3.3.1.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg2.l10.m1.1.1.3.3.1.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.3.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l10.m1.1.1.3.3.1.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l10.m1.1.1.3.3.1.3.cmml" xref="alg2.l10.m1.1.1.3.3.1.3">𝑇</ci></apply><apply id="alg2.l10.m1.1.1.3.3.2.cmml" xref="alg2.l10.m1.1.1.3.3.2"><times id="alg2.l10.m1.1.1.3.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.3.2.1"></times><ci id="alg2.l10.m1.1.1.3.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.3.2.2">𝐷</ci><apply id="alg2.l10.m1.1.1.3.3.2.3.cmml" xref="alg2.l10.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.3.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.3.2.3">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.3.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.3.2.3.2">𝑇</ci><ci id="alg2.l10.m1.1.1.3.3.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">Model_{k}^{r}\leftarrow\sum_{i=0}^{r-1}{Batch^{i}}+\sum_{t=1}^{T}{DT_{t}}</annotation></semantics></math>


</div>
<div id="alg2.l11" class="ltx_listingline">  <span id="alg2.l11.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l11.m1.4" class="ltx_Math" alttext="t=1,2,...,T" display="inline"><semantics id="alg2.l11.m1.4a"><mrow id="alg2.l11.m1.4.5" xref="alg2.l11.m1.4.5.cmml"><mi id="alg2.l11.m1.4.5.2" xref="alg2.l11.m1.4.5.2.cmml">t</mi><mo id="alg2.l11.m1.4.5.1" xref="alg2.l11.m1.4.5.1.cmml">=</mo><mrow id="alg2.l11.m1.4.5.3.2" xref="alg2.l11.m1.4.5.3.1.cmml"><mn id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">1</mn><mo id="alg2.l11.m1.4.5.3.2.1" xref="alg2.l11.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml">2</mn><mo id="alg2.l11.m1.4.5.3.2.2" xref="alg2.l11.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l11.m1.3.3" xref="alg2.l11.m1.3.3.cmml">…</mi><mo id="alg2.l11.m1.4.5.3.2.3" xref="alg2.l11.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l11.m1.4.4" xref="alg2.l11.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.4b"><apply id="alg2.l11.m1.4.5.cmml" xref="alg2.l11.m1.4.5"><eq id="alg2.l11.m1.4.5.1.cmml" xref="alg2.l11.m1.4.5.1"></eq><ci id="alg2.l11.m1.4.5.2.cmml" xref="alg2.l11.m1.4.5.2">𝑡</ci><list id="alg2.l11.m1.4.5.3.1.cmml" xref="alg2.l11.m1.4.5.3.2"><cn type="integer" id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">1</cn><cn type="integer" id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2">2</cn><ci id="alg2.l11.m1.3.3.cmml" xref="alg2.l11.m1.3.3">…</ci><ci id="alg2.l11.m1.4.4.cmml" xref="alg2.l11.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.4c">t=1,2,...,T</annotation></semantics></math> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l12" class="ltx_listingline">     Find the optimal split for each split node in the new batch trees and update <math id="alg2.l12.m1.1" class="ltx_Math" alttext="Model_{k}^{r}" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml">​</mo><mi id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1a" xref="alg2.l12.m1.1.1.1.cmml">​</mo><mi id="alg2.l12.m1.1.1.4" xref="alg2.l12.m1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1b" xref="alg2.l12.m1.1.1.1.cmml">​</mo><mi id="alg2.l12.m1.1.1.5" xref="alg2.l12.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1c" xref="alg2.l12.m1.1.1.1.cmml">​</mo><msubsup id="alg2.l12.m1.1.1.6" xref="alg2.l12.m1.1.1.6.cmml"><mi id="alg2.l12.m1.1.1.6.2.2" xref="alg2.l12.m1.1.1.6.2.2.cmml">l</mi><mi id="alg2.l12.m1.1.1.6.2.3" xref="alg2.l12.m1.1.1.6.2.3.cmml">k</mi><mi id="alg2.l12.m1.1.1.6.3" xref="alg2.l12.m1.1.1.6.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><times id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"></times><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">𝑀</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝑜</ci><ci id="alg2.l12.m1.1.1.4.cmml" xref="alg2.l12.m1.1.1.4">𝑑</ci><ci id="alg2.l12.m1.1.1.5.cmml" xref="alg2.l12.m1.1.1.5">𝑒</ci><apply id="alg2.l12.m1.1.1.6.cmml" xref="alg2.l12.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.6.1.cmml" xref="alg2.l12.m1.1.1.6">superscript</csymbol><apply id="alg2.l12.m1.1.1.6.2.cmml" xref="alg2.l12.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.6.2.1.cmml" xref="alg2.l12.m1.1.1.6">subscript</csymbol><ci id="alg2.l12.m1.1.1.6.2.2.cmml" xref="alg2.l12.m1.1.1.6.2.2">𝑙</ci><ci id="alg2.l12.m1.1.1.6.2.3.cmml" xref="alg2.l12.m1.1.1.6.2.3">𝑘</ci></apply><ci id="alg2.l12.m1.1.1.6.3.cmml" xref="alg2.l12.m1.1.1.6.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">Model_{k}^{r}</annotation></semantics></math>


</div>
<div id="alg2.l13" class="ltx_listingline">  Return <math id="alg2.l13.m1.1" class="ltx_Math" alttext="\sum_{t=1}^{T}{DT_{t}}" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msubsup id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml"><mo id="alg2.l13.m1.1.1.1.2.2" xref="alg2.l13.m1.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l13.m1.1.1.1.2.3" xref="alg2.l13.m1.1.1.1.2.3.cmml"><mi id="alg2.l13.m1.1.1.1.2.3.2" xref="alg2.l13.m1.1.1.1.2.3.2.cmml">t</mi><mo id="alg2.l13.m1.1.1.1.2.3.1" xref="alg2.l13.m1.1.1.1.2.3.1.cmml">=</mo><mn id="alg2.l13.m1.1.1.1.2.3.3" xref="alg2.l13.m1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l13.m1.1.1.1.3" xref="alg2.l13.m1.1.1.1.3.cmml">T</mi></msubsup><mrow id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.2.2" xref="alg2.l13.m1.1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.1.1.2.1" xref="alg2.l13.m1.1.1.2.1.cmml">​</mo><msub id="alg2.l13.m1.1.1.2.3" xref="alg2.l13.m1.1.1.2.3.cmml"><mi id="alg2.l13.m1.1.1.2.3.2" xref="alg2.l13.m1.1.1.2.3.2.cmml">T</mi><mi id="alg2.l13.m1.1.1.2.3.3" xref="alg2.l13.m1.1.1.2.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><apply id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1">superscript</csymbol><apply id="alg2.l13.m1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.1">subscript</csymbol><sum id="alg2.l13.m1.1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.1.2.2"></sum><apply id="alg2.l13.m1.1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.1.2.3"><eq id="alg2.l13.m1.1.1.1.2.3.1.cmml" xref="alg2.l13.m1.1.1.1.2.3.1"></eq><ci id="alg2.l13.m1.1.1.1.2.3.2.cmml" xref="alg2.l13.m1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l13.m1.1.1.1.2.3.3.cmml" xref="alg2.l13.m1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg2.l13.m1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.3">𝑇</ci></apply><apply id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2"><times id="alg2.l13.m1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.2.1"></times><ci id="alg2.l13.m1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.2.2">𝐷</ci><apply id="alg2.l13.m1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.3.1.cmml" xref="alg2.l13.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.3.2.cmml" xref="alg2.l13.m1.1.1.2.3.2">𝑇</ci><ci id="alg2.l13.m1.1.1.2.3.3.cmml" xref="alg2.l13.m1.1.1.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\sum_{t=1}^{T}{DT_{t}}</annotation></semantics></math>

</div>
</div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>FedTrees in LGBM-based FL</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">As mentioned earlier, in the federal environment, the use of NNs is becoming more and more popular. However, many other ML algorithms have not had the opportunity to be explored in such an environment, even though they conceal many wanted merits like simple but efficient approaches. Recently, the research community has begun to investigate the use of other ML techniques, such as DTs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. This study follows the same concept of employing DTs under the FL setting; however, it is the first research that explores the use of LGBM models with FL. This study is also the leading in exploring LGBM-based FL in the context of smart grids. Inspired by the FedVoting algorithm presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, where the authors construct a federated GBDT model trained for human mobility prediction, this study proposes FedTrees. FedTrees framework harnesses the power of the LGBM algorithm within the FL environment. What distinguishes FedTrees from FedVoting is that it is less complex and scalable. To be precise, FedVoting is developed for the cross-silo setup and relies on cross-validations. To determine the optimal model for each training round, each client must validate other clients’ trained local models, incurring additional computation cost. Moreover, scalability is not by design of FedVoting since it is designed to be performed on a limited number of clients. By contrast, FedTrees is developed to fulfil simplicity, efficiency, and scalability, while fitting both cross-device and cross-silo settings. In FedTrees, the complexity is alleviated as there is no need for any client to validate others’ models; the central server validates the received models and selects the best one to build upon in upcoming training rounds.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Proposed FedTrees Algorithm ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrates the structure of FedTrees and the detailed training process. Constructing FedTrees begins with choosing the best hyperparameters of the LGBM model, like the number of estimators (trees), the number of leaves for each estimator, boosting type, and max depth. Once determined, the central server broadcasts these parameters to each participating client except for the number of estimators, which is the server’s role in determining the best initial batch of trees to be trained in each round and build on it. When every client receives the model parameters, they create the LGBM model accordingly and start the iterative model training. At the end of each training round, the clients send the trained batch of trees to the central server for evaluation. The batch that achieves the best evaluation performance will be picked to build on in the following communication rounds, while the other batches will be discarded. This process is repeated until the global LGBM model reaches the desired accuracy or no further improvement can be achieved. The complete FedTrees pseudo-code is presented in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4 Proposed FedTrees Algorithm ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Delta-based Early Stopping Patience</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The challenge of training an ML model in the federated setting is choosing the number of communication rounds. A large number of rounds incur unnecessary computations and waste of resources, leading to overfitting. Whereas a small number of rounds would result in a suboptimal model suffering underfitting. In this study, we also consider this challenge by developing a stopping algorithm that monitors the evaluation performance of the trained model at every iteration and halts the training process when no further improvement is expected. Instead of fixing the number of communication rounds, the delta-based early stopping algorithm sets a threshold (delta) for comparing the best model of the previous rounds with the currently trained model based on the validation dataset, as depicted in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Delta-based Early Stopping Patience ‣ 4 Proposed FedTrees Algorithm ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. If the current model has a better performance than the preceding best stored model, it will replace it; otherwise, the best model will remain. This comparison runs for several rounds defined as a window size; if the window is filled in without a better model being found, the training will stop and return the best model. We have implemented this algorithm on the FedAvg and FedTrees frameworks after an extensive study to determine the best delta and window size values. More details will be provided in the following section.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2210.00060/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="211" height="98" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Illustration of the delta-based early stopping patience algorithm; the current <math id="S4.F4.2.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.F4.2.m1.1b"><mi id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">r</annotation></semantics></math> communication round has a better model that replaces the previous one, emptying the window. </figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Performance Evaluation and Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Dataset Pre-Processing and Evaluation Methods</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Since this study is intended to provide a practical framework capable of forecasting electricity load patterns in smart cities, it is essential to find an excellent dataset to evaluate the performance of FedTrees versus FedAvg. In this regard, the Tetouan power consumption dataset is selected for this purpose <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. This dataset was collected in 2017 at three different distribution substations from the zones: Quads, Boussafou, and Smir in Tetouan, a city located in north Morocco. In addition to providing power consumption information for every 10 minutes, the Tetouan dataset offers complementary data about the calendar and weather conditions. To prepare this dataset for our study, we initially converted the time scale from 10 minutes to 60 minutes because we are interested in predicting short-term loads for the next hour. Furthermore, we created two new dataset features; the aggregation feature that aggregates the power consumption of the three zones for use while performing centralised and distributed learning, and the previous hour aggregation (PrevHourAgg) feature that gives the aggregated feature reading of the previous hour. Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1 Dataset Pre-Processing and Evaluation Methods ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> demonstrates the hourly aggregated load as well as zones’ load information. Moreover, Table. <a href="#S5.T1" title="Table 1 ‣ 5.1 Dataset Pre-Processing and Evaluation Methods ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the features that are considered to perform load forecasting.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2210.00060/assets/x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="296" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Tetouan dataset preparation generated hourly power consumption of the three zones in addition to the aggregated power</figcaption>
</figure>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Tetouan dataset features used for load forecasting</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Context</span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Features</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<th id="S5.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">Calendar</th>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S5.T1.1.2.1.2.1" class="ltx_text" style="font-size:120%;">\small1⃝ <span id="S5.T1.1.2.1.2.1.1" class="ltx_text" style="font-size:75%;">Month </span>\small2⃝ <span id="S5.T1.1.2.1.2.1.2" class="ltx_text" style="font-size:75%;">Day </span>\small3⃝ <span id="S5.T1.1.2.1.2.1.3" class="ltx_text" style="font-size:75%;">Hour</span></span></td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<th id="S5.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Weather</th>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S5.T1.1.3.2.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T1.1.3.2.2.1.1" class="ltx_tr">
<td id="S5.T1.1.3.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S5.T1.1.3.2.2.1.1.1.1" class="ltx_text" style="font-size:120%;">\small4⃝ <span id="S5.T1.1.3.2.2.1.1.1.1.1" class="ltx_text" style="font-size:75%;">Temperature </span>\small5⃝ <span id="S5.T1.1.3.2.2.1.1.1.1.2" class="ltx_text" style="font-size:75%;">Humidity </span>\small6⃝ <span id="S5.T1.1.3.2.2.1.1.1.1.3" class="ltx_text" style="font-size:75%;">Wind speed</span></span></td>
</tr>
<tr id="S5.T1.1.3.2.2.1.2" class="ltx_tr">
<td id="S5.T1.1.3.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S5.T1.1.3.2.2.1.2.1.1" class="ltx_text" style="font-size:120%;">\small7⃝ <span id="S5.T1.1.3.2.2.1.2.1.1.1" class="ltx_text" style="font-size:75%;">Diffuse flow </span>\small8⃝ <span id="S5.T1.1.3.2.2.1.2.1.1.2" class="ltx_text" style="font-size:75%;">General diffuse flow</span></span></td>
</tr>
</table>
</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<th id="S5.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r ltx_border_t">Power</th>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><span id="S5.T1.1.4.3.2.1" class="ltx_text" style="font-size:120%;">\small9⃝ <span id="S5.T1.1.4.3.2.1.1" class="ltx_text" style="font-size:75%;">PrevHourAgg</span></span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">Before commencing the training process, the default scale of the features is normalised using MinMax scaler into the range [0,1]. Accordingly, all features have the chance of contributing equally to model fitting and avoiding biasing. For evaluation purposes, we use the most popular metrics of mean absolute error (MAE) and mean absolute percentage error (MAPE), which are defined as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>:</p>
<table id="S5.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S5.E1.m1.1" class="ltx_Math" alttext="MAE=\frac{1}{n}\sum_{i=1}^{n}\left|y_{i}-\hat{y}_{i}\right|" display="block"><semantics id="S5.E1.m1.1a"><mrow id="S5.E1.m1.1.1" xref="S5.E1.m1.1.1.cmml"><mrow id="S5.E1.m1.1.1.3" xref="S5.E1.m1.1.1.3.cmml"><mi id="S5.E1.m1.1.1.3.2" xref="S5.E1.m1.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E1.m1.1.1.3.1" xref="S5.E1.m1.1.1.3.1.cmml">​</mo><mi id="S5.E1.m1.1.1.3.3" xref="S5.E1.m1.1.1.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.E1.m1.1.1.3.1a" xref="S5.E1.m1.1.1.3.1.cmml">​</mo><mi id="S5.E1.m1.1.1.3.4" xref="S5.E1.m1.1.1.3.4.cmml">E</mi></mrow><mo id="S5.E1.m1.1.1.2" xref="S5.E1.m1.1.1.2.cmml">=</mo><mrow id="S5.E1.m1.1.1.1" xref="S5.E1.m1.1.1.1.cmml"><mfrac id="S5.E1.m1.1.1.1.3" xref="S5.E1.m1.1.1.1.3.cmml"><mn id="S5.E1.m1.1.1.1.3.2" xref="S5.E1.m1.1.1.1.3.2.cmml">1</mn><mi id="S5.E1.m1.1.1.1.3.3" xref="S5.E1.m1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S5.E1.m1.1.1.1.2" xref="S5.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S5.E1.m1.1.1.1.1" xref="S5.E1.m1.1.1.1.1.cmml"><munderover id="S5.E1.m1.1.1.1.1.2" xref="S5.E1.m1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S5.E1.m1.1.1.1.1.2.2.2" xref="S5.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.E1.m1.1.1.1.1.2.2.3" xref="S5.E1.m1.1.1.1.1.2.2.3.cmml"><mi id="S5.E1.m1.1.1.1.1.2.2.3.2" xref="S5.E1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S5.E1.m1.1.1.1.1.2.2.3.1" xref="S5.E1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E1.m1.1.1.1.1.2.2.3.3" xref="S5.E1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.E1.m1.1.1.1.1.2.3" xref="S5.E1.m1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S5.E1.m1.1.1.1.1.1.1" xref="S5.E1.m1.1.1.1.1.1.2.cmml"><mo id="S5.E1.m1.1.1.1.1.1.1.2" xref="S5.E1.m1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S5.E1.m1.1.1.1.1.1.1.1" xref="S5.E1.m1.1.1.1.1.1.1.1.cmml"><msub id="S5.E1.m1.1.1.1.1.1.1.1.2" xref="S5.E1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E1.m1.1.1.1.1.1.1.1.2.2" xref="S5.E1.m1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S5.E1.m1.1.1.1.1.1.1.1.2.3" xref="S5.E1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E1.m1.1.1.1.1.1.1.1.1" xref="S5.E1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.E1.m1.1.1.1.1.1.1.1.3" xref="S5.E1.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.E1.m1.1.1.1.1.1.1.1.3.2" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E1.m1.1.1.1.1.1.1.1.3.2.2" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S5.E1.m1.1.1.1.1.1.1.1.3.2.1" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S5.E1.m1.1.1.1.1.1.1.1.3.3" xref="S5.E1.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S5.E1.m1.1.1.1.1.1.1.3" xref="S5.E1.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E1.m1.1b"><apply id="S5.E1.m1.1.1.cmml" xref="S5.E1.m1.1.1"><eq id="S5.E1.m1.1.1.2.cmml" xref="S5.E1.m1.1.1.2"></eq><apply id="S5.E1.m1.1.1.3.cmml" xref="S5.E1.m1.1.1.3"><times id="S5.E1.m1.1.1.3.1.cmml" xref="S5.E1.m1.1.1.3.1"></times><ci id="S5.E1.m1.1.1.3.2.cmml" xref="S5.E1.m1.1.1.3.2">𝑀</ci><ci id="S5.E1.m1.1.1.3.3.cmml" xref="S5.E1.m1.1.1.3.3">𝐴</ci><ci id="S5.E1.m1.1.1.3.4.cmml" xref="S5.E1.m1.1.1.3.4">𝐸</ci></apply><apply id="S5.E1.m1.1.1.1.cmml" xref="S5.E1.m1.1.1.1"><times id="S5.E1.m1.1.1.1.2.cmml" xref="S5.E1.m1.1.1.1.2"></times><apply id="S5.E1.m1.1.1.1.3.cmml" xref="S5.E1.m1.1.1.1.3"><divide id="S5.E1.m1.1.1.1.3.1.cmml" xref="S5.E1.m1.1.1.1.3"></divide><cn type="integer" id="S5.E1.m1.1.1.1.3.2.cmml" xref="S5.E1.m1.1.1.1.3.2">1</cn><ci id="S5.E1.m1.1.1.1.3.3.cmml" xref="S5.E1.m1.1.1.1.3.3">𝑛</ci></apply><apply id="S5.E1.m1.1.1.1.1.cmml" xref="S5.E1.m1.1.1.1.1"><apply id="S5.E1.m1.1.1.1.1.2.cmml" xref="S5.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E1.m1.1.1.1.1.2.1.cmml" xref="S5.E1.m1.1.1.1.1.2">superscript</csymbol><apply id="S5.E1.m1.1.1.1.1.2.2.cmml" xref="S5.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E1.m1.1.1.1.1.2.2.1.cmml" xref="S5.E1.m1.1.1.1.1.2">subscript</csymbol><sum id="S5.E1.m1.1.1.1.1.2.2.2.cmml" xref="S5.E1.m1.1.1.1.1.2.2.2"></sum><apply id="S5.E1.m1.1.1.1.1.2.2.3.cmml" xref="S5.E1.m1.1.1.1.1.2.2.3"><eq id="S5.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S5.E1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S5.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S5.E1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S5.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="S5.E1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S5.E1.m1.1.1.1.1.2.3.cmml" xref="S5.E1.m1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S5.E1.m1.1.1.1.1.1.2.cmml" xref="S5.E1.m1.1.1.1.1.1.1"><abs id="S5.E1.m1.1.1.1.1.1.2.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.2"></abs><apply id="S5.E1.m1.1.1.1.1.1.1.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1"><minus id="S5.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.1"></minus><apply id="S5.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S5.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S5.E1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2"><ci id="S5.E1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S5.E1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S5.E1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E1.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E1.m1.1c">MAE=\frac{1}{n}\sum_{i=1}^{n}\left|y_{i}-\hat{y}_{i}\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<table id="S5.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S5.E2.m1.1" class="ltx_Math" alttext="MAPE=\frac{1}{n}\sum_{i=1}^{n}\left|\frac{y_{i}-\hat{y}_{i}}{y_{i}}\right|" display="block"><semantics id="S5.E2.m1.1a"><mrow id="S5.E2.m1.1.2" xref="S5.E2.m1.1.2.cmml"><mrow id="S5.E2.m1.1.2.2" xref="S5.E2.m1.1.2.2.cmml"><mi id="S5.E2.m1.1.2.2.2" xref="S5.E2.m1.1.2.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.2.2.1" xref="S5.E2.m1.1.2.2.1.cmml">​</mo><mi id="S5.E2.m1.1.2.2.3" xref="S5.E2.m1.1.2.2.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.2.2.1a" xref="S5.E2.m1.1.2.2.1.cmml">​</mo><mi id="S5.E2.m1.1.2.2.4" xref="S5.E2.m1.1.2.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.2.2.1b" xref="S5.E2.m1.1.2.2.1.cmml">​</mo><mi id="S5.E2.m1.1.2.2.5" xref="S5.E2.m1.1.2.2.5.cmml">E</mi></mrow><mo id="S5.E2.m1.1.2.1" xref="S5.E2.m1.1.2.1.cmml">=</mo><mrow id="S5.E2.m1.1.2.3" xref="S5.E2.m1.1.2.3.cmml"><mfrac id="S5.E2.m1.1.2.3.2" xref="S5.E2.m1.1.2.3.2.cmml"><mn id="S5.E2.m1.1.2.3.2.2" xref="S5.E2.m1.1.2.3.2.2.cmml">1</mn><mi id="S5.E2.m1.1.2.3.2.3" xref="S5.E2.m1.1.2.3.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.2.3.1" xref="S5.E2.m1.1.2.3.1.cmml">​</mo><mrow id="S5.E2.m1.1.2.3.3" xref="S5.E2.m1.1.2.3.3.cmml"><munderover id="S5.E2.m1.1.2.3.3.1" xref="S5.E2.m1.1.2.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S5.E2.m1.1.2.3.3.1.2.2" xref="S5.E2.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S5.E2.m1.1.2.3.3.1.2.3" xref="S5.E2.m1.1.2.3.3.1.2.3.cmml"><mi id="S5.E2.m1.1.2.3.3.1.2.3.2" xref="S5.E2.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S5.E2.m1.1.2.3.3.1.2.3.1" xref="S5.E2.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S5.E2.m1.1.2.3.3.1.2.3.3" xref="S5.E2.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.E2.m1.1.2.3.3.1.3" xref="S5.E2.m1.1.2.3.3.1.3.cmml">n</mi></munderover><mrow id="S5.E2.m1.1.2.3.3.2.2" xref="S5.E2.m1.1.2.3.3.2.1.cmml"><mo id="S5.E2.m1.1.2.3.3.2.2.1" xref="S5.E2.m1.1.2.3.3.2.1.1.cmml">|</mo><mfrac id="S5.E2.m1.1.1" xref="S5.E2.m1.1.1.cmml"><mrow id="S5.E2.m1.1.1.2" xref="S5.E2.m1.1.1.2.cmml"><msub id="S5.E2.m1.1.1.2.2" xref="S5.E2.m1.1.1.2.2.cmml"><mi id="S5.E2.m1.1.1.2.2.2" xref="S5.E2.m1.1.1.2.2.2.cmml">y</mi><mi id="S5.E2.m1.1.1.2.2.3" xref="S5.E2.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E2.m1.1.1.2.1" xref="S5.E2.m1.1.1.2.1.cmml">−</mo><msub id="S5.E2.m1.1.1.2.3" xref="S5.E2.m1.1.1.2.3.cmml"><mover accent="true" id="S5.E2.m1.1.1.2.3.2" xref="S5.E2.m1.1.1.2.3.2.cmml"><mi id="S5.E2.m1.1.1.2.3.2.2" xref="S5.E2.m1.1.1.2.3.2.2.cmml">y</mi><mo id="S5.E2.m1.1.1.2.3.2.1" xref="S5.E2.m1.1.1.2.3.2.1.cmml">^</mo></mover><mi id="S5.E2.m1.1.1.2.3.3" xref="S5.E2.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><msub id="S5.E2.m1.1.1.3" xref="S5.E2.m1.1.1.3.cmml"><mi id="S5.E2.m1.1.1.3.2" xref="S5.E2.m1.1.1.3.2.cmml">y</mi><mi id="S5.E2.m1.1.1.3.3" xref="S5.E2.m1.1.1.3.3.cmml">i</mi></msub></mfrac><mo id="S5.E2.m1.1.2.3.3.2.2.2" xref="S5.E2.m1.1.2.3.3.2.1.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E2.m1.1b"><apply id="S5.E2.m1.1.2.cmml" xref="S5.E2.m1.1.2"><eq id="S5.E2.m1.1.2.1.cmml" xref="S5.E2.m1.1.2.1"></eq><apply id="S5.E2.m1.1.2.2.cmml" xref="S5.E2.m1.1.2.2"><times id="S5.E2.m1.1.2.2.1.cmml" xref="S5.E2.m1.1.2.2.1"></times><ci id="S5.E2.m1.1.2.2.2.cmml" xref="S5.E2.m1.1.2.2.2">𝑀</ci><ci id="S5.E2.m1.1.2.2.3.cmml" xref="S5.E2.m1.1.2.2.3">𝐴</ci><ci id="S5.E2.m1.1.2.2.4.cmml" xref="S5.E2.m1.1.2.2.4">𝑃</ci><ci id="S5.E2.m1.1.2.2.5.cmml" xref="S5.E2.m1.1.2.2.5">𝐸</ci></apply><apply id="S5.E2.m1.1.2.3.cmml" xref="S5.E2.m1.1.2.3"><times id="S5.E2.m1.1.2.3.1.cmml" xref="S5.E2.m1.1.2.3.1"></times><apply id="S5.E2.m1.1.2.3.2.cmml" xref="S5.E2.m1.1.2.3.2"><divide id="S5.E2.m1.1.2.3.2.1.cmml" xref="S5.E2.m1.1.2.3.2"></divide><cn type="integer" id="S5.E2.m1.1.2.3.2.2.cmml" xref="S5.E2.m1.1.2.3.2.2">1</cn><ci id="S5.E2.m1.1.2.3.2.3.cmml" xref="S5.E2.m1.1.2.3.2.3">𝑛</ci></apply><apply id="S5.E2.m1.1.2.3.3.cmml" xref="S5.E2.m1.1.2.3.3"><apply id="S5.E2.m1.1.2.3.3.1.cmml" xref="S5.E2.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S5.E2.m1.1.2.3.3.1.1.cmml" xref="S5.E2.m1.1.2.3.3.1">superscript</csymbol><apply id="S5.E2.m1.1.2.3.3.1.2.cmml" xref="S5.E2.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S5.E2.m1.1.2.3.3.1.2.1.cmml" xref="S5.E2.m1.1.2.3.3.1">subscript</csymbol><sum id="S5.E2.m1.1.2.3.3.1.2.2.cmml" xref="S5.E2.m1.1.2.3.3.1.2.2"></sum><apply id="S5.E2.m1.1.2.3.3.1.2.3.cmml" xref="S5.E2.m1.1.2.3.3.1.2.3"><eq id="S5.E2.m1.1.2.3.3.1.2.3.1.cmml" xref="S5.E2.m1.1.2.3.3.1.2.3.1"></eq><ci id="S5.E2.m1.1.2.3.3.1.2.3.2.cmml" xref="S5.E2.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S5.E2.m1.1.2.3.3.1.2.3.3.cmml" xref="S5.E2.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S5.E2.m1.1.2.3.3.1.3.cmml" xref="S5.E2.m1.1.2.3.3.1.3">𝑛</ci></apply><apply id="S5.E2.m1.1.2.3.3.2.1.cmml" xref="S5.E2.m1.1.2.3.3.2.2"><abs id="S5.E2.m1.1.2.3.3.2.1.1.cmml" xref="S5.E2.m1.1.2.3.3.2.2.1"></abs><apply id="S5.E2.m1.1.1.cmml" xref="S5.E2.m1.1.1"><divide id="S5.E2.m1.1.1.1.cmml" xref="S5.E2.m1.1.1"></divide><apply id="S5.E2.m1.1.1.2.cmml" xref="S5.E2.m1.1.1.2"><minus id="S5.E2.m1.1.1.2.1.cmml" xref="S5.E2.m1.1.1.2.1"></minus><apply id="S5.E2.m1.1.1.2.2.cmml" xref="S5.E2.m1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E2.m1.1.1.2.2.1.cmml" xref="S5.E2.m1.1.1.2.2">subscript</csymbol><ci id="S5.E2.m1.1.1.2.2.2.cmml" xref="S5.E2.m1.1.1.2.2.2">𝑦</ci><ci id="S5.E2.m1.1.1.2.2.3.cmml" xref="S5.E2.m1.1.1.2.2.3">𝑖</ci></apply><apply id="S5.E2.m1.1.1.2.3.cmml" xref="S5.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E2.m1.1.1.2.3.1.cmml" xref="S5.E2.m1.1.1.2.3">subscript</csymbol><apply id="S5.E2.m1.1.1.2.3.2.cmml" xref="S5.E2.m1.1.1.2.3.2"><ci id="S5.E2.m1.1.1.2.3.2.1.cmml" xref="S5.E2.m1.1.1.2.3.2.1">^</ci><ci id="S5.E2.m1.1.1.2.3.2.2.cmml" xref="S5.E2.m1.1.1.2.3.2.2">𝑦</ci></apply><ci id="S5.E2.m1.1.1.2.3.3.cmml" xref="S5.E2.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S5.E2.m1.1.1.3.cmml" xref="S5.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.1.1.3.1.cmml" xref="S5.E2.m1.1.1.3">subscript</csymbol><ci id="S5.E2.m1.1.1.3.2.cmml" xref="S5.E2.m1.1.1.3.2">𝑦</ci><ci id="S5.E2.m1.1.1.3.3.cmml" xref="S5.E2.m1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E2.m1.1c">MAPE=\frac{1}{n}\sum_{i=1}^{n}\left|\frac{y_{i}-\hat{y}_{i}}{y_{i}}\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.3" class="ltx_p">Where <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><msub id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml"><mi id="S5.SS1.p4.1.m1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.2.cmml">y</mi><mi id="S5.SS1.p4.1.m1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.1.m1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p4.1.m1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2">𝑦</ci><ci id="S5.SS1.p4.1.m1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">y_{i}</annotation></semantics></math> is the actual value, <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><msub id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml"><mover accent="true" id="S5.SS1.p4.2.m2.1.1.2" xref="S5.SS1.p4.2.m2.1.1.2.cmml"><mi id="S5.SS1.p4.2.m2.1.1.2.2" xref="S5.SS1.p4.2.m2.1.1.2.2.cmml">y</mi><mo id="S5.SS1.p4.2.m2.1.1.2.1" xref="S5.SS1.p4.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S5.SS1.p4.2.m2.1.1.3" xref="S5.SS1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><apply id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.2.m2.1.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">subscript</csymbol><apply id="S5.SS1.p4.2.m2.1.1.2.cmml" xref="S5.SS1.p4.2.m2.1.1.2"><ci id="S5.SS1.p4.2.m2.1.1.2.1.cmml" xref="S5.SS1.p4.2.m2.1.1.2.1">^</ci><ci id="S5.SS1.p4.2.m2.1.1.2.2.cmml" xref="S5.SS1.p4.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S5.SS1.p4.2.m2.1.1.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">\hat{y}_{i}</annotation></semantics></math> is the predicted value, and <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><mi id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><ci id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">n</annotation></semantics></math> represents the number of data samples.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Simulation Setup</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">To evaluate the performance of the FedTrees and FedAvg algorithms in power forecasting, we use the Persistence model as a benchmark, which is a naïve model that predicts the current value to be the same as the previous actual value. The forecasting problem is converted to a multivariate regression problem where we exploit various calendar, weather, and power features to predict power consumption for the next hour. For this purpose, we built LSTM and LGBM models based on the Random search strategy to discover the best combination of hyperparameters values. The LSTM model consists of a single hidden layer with 64 LSTM units that use the ReLU activation function and a dense output layer with one neuron. Also, it uses the Adam optimiser for compilation, the dataset is divided into 80/20% train/test split ratio, batch size equals 30, and the number of epochs equals 300. Whereas the LGBM’s boosting type, the number of trees<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>This hyperparameter is replaced by batch in FedTrees.</span></span></span>, max_depth, learning rate, num_leaves, and train/test split ratio are set to DART, 800, 12, 0.078, 30, and 80/20%, respectively. Our simulation experiments are based on Python programs installed on a Windows operating system with Intel Xeon CPU E5-2620 @ 2GHz and 16GB RAM.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Numerical Results</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We first investigate the performance of the selected models when performing the conventional approach of centralised training. Table <a href="#S5.T2" title="Table 2 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates the results of the evaluation metrics as well as the required computation time for each model. The MAE and MAPE for the LSTM model are 0.02 and 3.04%, respectively, while they are improved when using the LGBM model and reached 0.017 and 2.69%, respectively. The fast-computing merit of the LGBM model is confirmed in this table which shows that it needs only two seconds to converge, while the LSTM model requires more than 97% of computations compared to the LGBM model.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison between LSTM and LGBM models when performing centralised model training.</figcaption>
<div id="S5.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:207.7pt;height:48.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.5pt,2.7pt) scale(0.9,0.9) ;">
<table id="S5.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">ML model</span></th>
<th id="S5.T2.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.1.2.1" class="ltx_text ltx_font_bold">MAE</span></th>
<th id="S5.T2.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.1.3.1" class="ltx_text ltx_font_bold">MAPE</span></th>
<th id="S5.T2.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T2.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Computation time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.2.1" class="ltx_tr">
<td id="S5.T2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt">LSTM</td>
<td id="S5.T2.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">0.019</td>
<td id="S5.T2.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">3.04%</td>
<td id="S5.T2.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">77 seconds</td>
</tr>
<tr id="S5.T2.1.1.3.2" class="ltx_tr">
<td id="S5.T2.1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">LGBM</td>
<td id="S5.T2.1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">0.017</td>
<td id="S5.T2.1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">2.69%</td>
<td id="S5.T2.1.1.3.2.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">2 seconds</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2210.00060/assets/x6.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="251" height="145" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The importance of each feature in forecasting power consumption.</figcaption>
</figure>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2210.00060/assets/x7.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="287" height="166" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>MAE as a function of different features contributing in the prediction process.</figcaption>
</figure>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">Furthermore, we conducted a study to explore the impact of every feature in predicting the target value. The LGBM model is equipped with a feature importance tool that can be used to find out what features contribute the most to the prediction of power values. Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrates the results of the feature importance study from which we can conclude that Hour, PrevHourAgg, General diffuse flows, and Month have the most impact in predicting the power consumption values. Other features also contribute to the prediction but their contribution is less noticeable. Moreover, we performed a study to examine the prediction performance when using several numbers of features for the LSTM and LGBM models. Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the best achieved MAE versus using different numbers of features which are ordered based on their rank in the feature importance study. This figure indicates that, in general, multivariate prediction gives improved performance over univariate; however, the best performance for both models is obtained when the four most important features are used.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p">Moving on to the FL setup, it is worth recalling that FedTrees is designed to accommodate cross-device and cross-silo settings. To the best of the authors’ knowledge, FL has not been previously applied at the substation level in energy/power forecasting studies. Therefore, in this study, we focus on applying FedTrees and the FedAvg at the substation level. The FL setup for both algorithms comprises a central orchestrating server and three clients representing the three zones of the Tetouan dataset. The number of communication rounds is not fixed since we use the developed delta-based early stopping technique, discussed in Section <a href="#S4.SS2" title="4.2 Delta-based Early Stopping Patience ‣ 4 Proposed FedTrees Algorithm ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, to find the best round that yields the optimal trained model while alleviating the computation and communication costs. An extensive study is carried out to determine the best delta and window size values for the stopping algorithm, the findings of this study are given in Tables <a href="#S5.T3" title="Table 3 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S5.T4" title="Table 4 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. From Table <a href="#S5.T3" title="Table 3 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the most computationally efficient and the best MAE/MAPE for the LSTM model are obtained when the delta and window size values are 0.00001 and 55, respectively. Regarding LGBM, Table <a href="#S5.T4" title="Table 4 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates that best values for the delta and window size are 0.00001 and 10, respectively. Table <a href="#S5.T5" title="Table 5 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> summarises the best results obtained for each of the Persistence, FedAvg, and FedTrees algorithms. The performance of the Persistence model is poor compared to other algorithms, and the FedAvg has the best performance, which is slightly better than that of FedTrees; however, FedTrees outperforms the FedAvg algorithm in terms of the communication rounds and the required computations. FedTrees only requires 65 rounds of communications that result in approximately 26 seconds of computations, while FedAvg requires a much higher number of communication rounds and computation time by a factor of 7.6 and 52.2, respectively, to achieve the same level of performance.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>A study to determine the best values of delta and window size for LSTM-based FedAvg.</figcaption><img src="/html/2210.00060/assets/x8.png" id="S5.T3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="245" height="102" alt="[Uncaptioned image]">
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>A study to determine the best values of delta and window size for LGBM-based FedTrees.</figcaption><img src="/html/2210.00060/assets/x9.png" id="S5.T4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="245" height="102" alt="[Uncaptioned image]">
</figure>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p">Furthermore, Fig <a href="#S5.F8" title="Figure 8 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the convergence curve of MAE for both algorithms during the training of the global model. In addition, Fig <a href="#S5.F9" title="Figure 9 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows the actual and the predicted power consumption from both algorithms and the baseline Persistence model. These figures indicate that FedTrees converges faster and achieves an outstanding performance compared to FedAvg.</p>
</div>
<div id="S5.SS3.p5" class="ltx_para">
<p id="S5.SS3.p5.1" class="ltx_p">Another study was conducted by looking only at the four most important features to see the impact of using fewer features on the required number of communication rounds, computation time, and model performance. Table <a href="#S5.T6" title="Table 6 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> gives the outcomes of this study and indicates that the performance of FedTrees is improved when removing the less important features. However, this is not the case with FedAvg, as this table shows that its performance is slightly degraded compared to using all the features. The number of communication rounds is slightly less than that in the full feature study for both algorithms; however, this study also shows the outstanding performance of FedTrees as it requires far fewer rounds of communications and computation costs. Similarly, Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> and <a href="#S5.F11" title="Figure 11 ‣ 5.3 Numerical Results ‣ 5 Performance Evaluation and Results ‣ FedTrees: A Novel Computation-Communication Efficient Federated Learning Framework Investigated in Smart Grids" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> give the MAE convergence curve and the actual and forecasted power consumption for both algorithms, respectively. Also, these figures ensure the superb overall performance of FedTrees.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Performance results of the FedTrees compared to the FedAvg and the Persistence model. </figcaption>
<div id="S5.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:254.5pt;height:57.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.8pt,7.2pt) scale(0.8,0.8) ;">
<table id="S5.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T5.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Algorithm</span></th>
<th id="S5.T5.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T5.1.1.1.1.2.1" class="ltx_text ltx_font_bold">MAE</span></th>
<th id="S5.T5.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T5.1.1.1.1.3.1" class="ltx_text ltx_font_bold">MAPE%</span></th>
<th id="S5.T5.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T5.1.1.1.1.4.1" class="ltx_text ltx_font_bold">No. of rounds</span></th>
<th id="S5.T5.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T5.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Computation time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.1.2.1" class="ltx_tr">
<td id="S5.T5.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">Persistence</td>
<td id="S5.T5.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.08</td>
<td id="S5.T5.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">6.64</td>
<td id="S5.T5.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">N/A</td>
<td id="S5.T5.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">N/A</td>
</tr>
<tr id="S5.T5.1.1.3.2" class="ltx_tr">
<td id="S5.T5.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T5.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0157</td>
<td id="S5.T5.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.43</td>
<td id="S5.T5.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">491</td>
<td id="S5.T5.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1356 seconds</td>
</tr>
<tr id="S5.T5.1.1.4.3" class="ltx_tr">
<td id="S5.T5.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">FedTrees</td>
<td id="S5.T5.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.0173</td>
<td id="S5.T5.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">3.69</td>
<td id="S5.T5.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">65</td>
<td id="S5.T5.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">26.2 seconds</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2210.00060/assets/x10.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="241" height="149" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>MAE as a function of the communication rounds needed to train the global model of FedAvg and FedTrees.</figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure"><img src="/html/2210.00060/assets/x11.png" id="S5.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="237" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Forecasting power consumption for three days.</figcaption>
</figure>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Performance results of the FedTrees compared to the FedAvg and Persistence model when considering only the top four features. </figcaption>
<div id="S5.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:254.5pt;height:57.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.8pt,7.2pt) scale(0.8,0.8) ;">
<table id="S5.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.1.1.1.1" class="ltx_tr">
<th id="S5.T6.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T6.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Algorithm</span></th>
<th id="S5.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T6.1.1.1.1.2.1" class="ltx_text ltx_font_bold">MAE</span></th>
<th id="S5.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T6.1.1.1.1.3.1" class="ltx_text ltx_font_bold">MAPE%</span></th>
<th id="S5.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T6.1.1.1.1.4.1" class="ltx_text ltx_font_bold">No. of rounds</span></th>
<th id="S5.T6.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T6.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Computation time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.1.1.2.1" class="ltx_tr">
<td id="S5.T6.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">Persistence</td>
<td id="S5.T6.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.08</td>
<td id="S5.T6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">6.64</td>
<td id="S5.T6.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">N/A</td>
<td id="S5.T6.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">N/A</td>
</tr>
<tr id="S5.T6.1.1.3.2" class="ltx_tr">
<td id="S5.T6.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T6.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0177</td>
<td id="S5.T6.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.93</td>
<td id="S5.T6.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">465</td>
<td id="S5.T6.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1293 seconds</td>
</tr>
<tr id="S5.T6.1.1.4.3" class="ltx_tr">
<td id="S5.T6.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">FedTrees</td>
<td id="S5.T6.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.0168</td>
<td id="S5.T6.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">3.54</td>
<td id="S5.T6.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">50</td>
<td id="S5.T6.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">8.8 seconds</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.F10" class="ltx_figure"><img src="/html/2210.00060/assets/x12.png" id="S5.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="241" height="148" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>MAE as a function of the communication rounds needed to train the global model of FedAvg and FedTrees when considering only the top four features.</figcaption>
</figure>
<figure id="S5.F11" class="ltx_figure"><img src="/html/2210.00060/assets/x13.png" id="S5.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="237" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Forecasting power consumption for three days when considering only the top four features.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>CONCLUSIONS</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This paper aimed at developing FedTrees, a novel framework that incorporates ensemble learning, specifically the LGBM model, within the FL settings and coined to accommodate smart cities. Utilising the LGBM model transforms the FL into a highly efficient, fast processing, and scalable framework. Furthermore, instead of following the conventional fixed number of communication rounds method in FL, we developed a delta-based early stopping algorithm that monitors and stops the FL training process when no further enhancement is possible, thus ensuring achieving the desired training accuracy with the minimal use of computation and communication resources. FedTress is employed for the energy demand forecasting problem and benchmarked against LSTM-based FedAvg and Persistence model. Simulation results demonstrated that FedTrees has a remarkable performance in predicting short-term energy patterns and requires much less computation and communication than FedAvg with just 2% and 13%, respectively.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. Gohar, G. Nencioni, The role of 5G technologies in a smart city: The case
for intelligent transportation system, Sustain. 13 (9) (2021) 5188.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Abdel-Basset, et al., Energy-net: a deep learning approach for smart energy
management in IOT-based smart cities, IEEE Internet Things J. 8 (15) (2021)
12422–12435.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
K. T. Chui, M. D. Lytras, A. Visvizi, Energy sustainability in smart cities:
Artificial intelligence, smart monitoring, and optimization of energy
consumption, Energies 11 (11) (2018) 2869.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
M. Al-Quraan, et al., <a target="_blank" href="http://arxiv.org/abs/2111.07392" title="" class="ltx_ref ltx_href">Edge-native
intelligence for 6G communications driven by federated learning: A survey
of trends and challenges</a>, arXiv preprint arXiv:2111.07392 (Nov. 2021).

<br class="ltx_break">URL <a target="_blank" href="http://arxiv.org/abs/2111.07392" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2111.07392</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Taïk, S. Cherkaoui, Electrical load forecasting using edge computing
and federated learning, in: Proc. IEEE Int. Conf. Commun. (ICC), Dublin,
Ireland, 2020, pp. 1–6.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Savi, F. Olivadese, Short-term energy consumption forecasting at the edge: A
federated learning approach, IEEE Access 9 (2021) 95949–95969.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, P. Andras, <a target="_blank" href="http://arxiv.org/abs/2105.13325" title="" class="ltx_ref ltx_href">Federated
learning for short-term residential energy demand forecasting</a>, arXiv
preprint arXiv:2105.13325 (May 2021).

<br class="ltx_break">URL <a target="_blank" href="http://arxiv.org/abs/2105.13325" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2105.13325</a>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
N. Gholizadeh, P. Musilek, Federated learning with hyperparameter-based
clustering for electrical load forecasting, Internet Things 17 (2022) 100470.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
M. N. Fekri, K. Grolinger, S. Mir, Distributed load forecasting using smart
meter data: Federated learning with recurrent neural networks, Int. J. Elect.
Power &amp; Energy Syst. 137 (2022) 107669.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
G. Ke, et al., LightGBM: A highly efficient gradient boosting decision tree,
Adv. neural info. process. syst. 30 (2017).

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. B. Debnath, M. Mourshed, Forecasting methods in energy planning models,
Renew. Sustain. Energy Rev. 88 (2018) 297–325.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Ciulla, A. D’Amico, Building energy performance forecasting: A multiple
linear regression approach, Appl. Energy 253 (2019) 113500.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. Saab, E. Badr, G. Nasr, Univariate modeling and forecasting of energy
consumption: the case of electricity in Lebanon, Energy 26 (1) (2001)
1–14.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
G. Xu, W. Wang, Forecasting China’s natural gas consumption based on a
combination model, J. Natural Gas Chem. 19 (5) (2010) 493–496.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
B. Singh, D. Pozo, A guide to solar power forecasting using ARMA models, in:
Proc. IEEE PES Innov. Smart Grid Technol. Eur. (ISGT-Europe), Bucharest,
Romania, 2019, pp. 1–4.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
G. A. Darbellay, M. Slama, Forecasting the short-term demand for electricity:
Do neural networks stand a better chance?, Int.l J. Forecasting 16 (1) (2000)
71–83.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Ozturk, F. Ozturk, Forecasting energy consumption of Turkey by ARIMA
model, J. Asian Sci. Res. 8 (2) (2018) 52–60.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
J. A. Zancanaro, et al., Energy consumption forecasting using SARIMA and
NARNET: An actual case study at university campus, in: Proc. IEEE PES
Innov. Smart Grid Technol. Conf.-Latin America (ISGT Latin America), Gramado,
Brazil, IEEE, 2019, pp. 1–6.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
F.-Y. Ju, W.-C. Hong, Application of seasonal SVR with chaotic gravitational
search algorithm in electricity forecasting, Appl. Math. Model. 37 (23)
(2013) 9643–9651.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
I. Koprinska, D. Wu, Z. Wang, Convolutional neural networks for energy time
series forecasting, in: Proc. int. joint conf. neural netw. (IJCNN), Rio de
Janeiro, Brazil, 2018, pp. 1–8.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
P.-H. Kuo, C.-J. Huang, A high precision artificial neural networks model for
short-term energy load forecasting, Energies 11 (1) (2018) 213.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Q. Wang, Y. Du, J. Wang, LSTM based long-term energy consumption
prediction with periodicity, Energy 197 (2020) 117197.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
K. Yan, et al., A hybrid LSTM neural network for energy consumption
forecasting of individual households, IEEE Access 7 (2019) 157633–157642.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
G. K. Tso, K. K. Yau, Predicting electricity energy consumption: A comparison
of regression analysis, decision tree and neural networks, Energy 32 (9)
(2007) 1761–1768.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Z. Yu, et al., A decision tree method for building energy demand modeling,
Energy and Buildings 42 (10) (2010) 1637–1646.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
M. W. Ahmad, M. Mourshed, Y. Rezgui, Trees vs neurons: Comparison between
random forest and ANN for high-resolution prediction of building energy
consumption, Energy and buildings 147 (2017) 77–89.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
S. Liu, et al., Short-term load forecasting based on GBDT combinatorial
optimization, in: Proc. IEEE Conf. Energy Internet and Energy Syst. Integr.
(EI2), Beijing, China, 2018, pp. 1–5.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
R. A. Abbasi, et al., Short term load forecasting using XGBoost, in: Proc.
Int. Conf. Adv. Inf. Netw. Appl., Springer, 2019, pp. 1120–1131.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
A. Sherstinsky, Fundamentals of recurrent neural network (RNN) and long
short-term memory (LSTM) network, Physica D: Nonlinear Phenomena 404 (2020)
132306.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
M. H. D. M. Ribeiro, L. dos Santos Coelho, Ensemble approach based on bagging,
boosting and stacking for short-term prediction in agribusiness time series,
Appl. Soft Comput. 86 (2020) 105837.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. B. McMahan, et al., <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_href">Federated
learning of deep networks using model averaging</a>, arXiv preprint
arXiv:1602.05629 (Feb. 2016).

<br class="ltx_break">URL <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1602.05629</a>

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
T. Li, et al., Federated optimization in heterogeneous networks, Proc. Mach.
Learn. Syst. 2 (2020) 429–450.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
E. Sannara, et al., A federated learning aggregation algorithm for pervasive
computing: Evaluation and comparison, in: Proc. IEEE Int. Conf. Pervasive
Comput. Commun. (PerCom), Kassel, Germany, 2021, pp. 1–10.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
L. Zhao, et al., Inprivate digging: Enabling tree-based distributed data mining
with differential privacy, in: Proc. IEEE INFOCOM Conf. Comput. Commun.,
2018, pp. 2087–2095.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Y. Liu, et al., Fedvoting: A cross-silo boosting tree construction method for
privacy-preserving long-term human mobility prediction, Sensors 21 (24)
(2021) 8282.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Salam, A. El Hibaoui, Comparison of machine learning algorithms for the
power consumption prediction:case study of Tetouan city, in: Proc. 2018 6th
Int. Renew. Sustain. Energy Conf. (IRSEC), Rabat, Morocco, IEEE, 2018, pp.
1–5.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
T. Ahmad, H. Chen, Short and medium-term forecasting of cooling and heating
load demand in building environment with data-mining based approaches, Energy
and Buildings 166 (2018) 460–476.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.00059" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.00060" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.00060">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.00060" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.00061" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 03:13:08 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
