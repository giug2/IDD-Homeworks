<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2205.12616] A template for the arxiv style</title><meta property="og:description" content="The current success of modern visual reasoning systems is arguably
attributed to cross-modality attention mechanisms. However, in deliberative
reasoning such as in VQA, attention is unconstrained at each step,
and thus…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A template for the arxiv style">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="A template for the arxiv style">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.12616">

<!--Generated on Tue Feb 27 04:36:46 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">A template for the <em id="id1.id1" class="ltx_emph ltx_font_italic">arxiv</em> style</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thao Minh Le, Vuong Le, Sunil Gupta, Svetha Venkatesh, Truyen Tran 
<br class="ltx_break">Applied Artificial Intelligence Institute, Deakin University, Australia
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter">{lethao,vuong.le,sunil.gupta,svetha.venkatesh,truyen.tran}@deakin.edu.au</span> 
<br class="ltx_break">
</span></span>
</div>

<h1 class="ltx_title ltx_title_document">Guiding Visual Question Answering with Attention Priors</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thao Minh Le, Vuong Le, Sunil Gupta, Svetha Venkatesh, Truyen Tran 
<br class="ltx_break">Applied Artificial Intelligence Institute, Deakin University, Australia
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter">{lethao,vuong.le,sunil.gupta,svetha.venkatesh,truyen.tran}@deakin.edu.au</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">The current success of modern visual reasoning systems is arguably
attributed to cross-modality attention mechanisms. However, in deliberative
reasoning such as in VQA, attention is unconstrained at each step,
and thus may serve as a statistical pooling mechanism rather than
a semantic operation intended to select information relevant to inference.
This is because at training time, attention is only guided by a very
sparse signal (i.e. the answer label) at the end of the inference
chain. This causes the cross-modality attention weights to deviate
from the desired visual-language bindings. To rectify this deviation,
we propose to guide the attention mechanism using explicit linguistic-visual
grounding. This grounding is derived by connecting structured linguistic
concepts in the query to their referents among the visual objects.
Here we learn the grounding from the pairing of questions and images
alone, without the need for answer annotation or external grounding
supervision. This grounding guides the attention mechanism inside
VQA models through a duality of mechanisms: pre-training attention
weight calculation and directly guiding the weights at inference time
on a case-by-case basis. The resultant algorithm is capable of probing
attention-based reasoning models, injecting relevant associative knowledge,
and regulating the core reasoning process. This scalable enhancement
improves the performance of VQA models, fortifies their robustness
to limited access to supervised data, and increases interpretability.</p>
</div>
<section id="S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h3>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Visual reasoning is the new frontier of AI wherein facts extracted
from visual data are gathered and distilled into higher-level knowledge
in response to a query. Successful visual reasoning methodology estimates
the cross-domain association between the symbolic concepts and visual
entities in the form of attention weights. Such associations shape
the knowledge distillation process, resulting in a unified representation
that can be decoded into an answer. In the exemplar reasoning setting
known as Visual Question Answering (VQA), attention plays a pivotal
role in modern systems <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Kim et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>; Le et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Lu et al., <a href="#bib.bib5" title="" class="ltx_ref">2016</a>)</cite>.
Ideal attention scores must be both <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">relevant</em> and <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">effective</em>:
Relevance implies that attention is high when the visual entity and
linguistic entity refer to the same concept; Effectiveness implies
that the attention derived leads to good VQA performance.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">However, in typical systems, the attention scores are computed on-the-fly:
unregulated at inference time and guided at training time by the gradient
from the groundtruth answers. Analysis of several VQA attention models
shows that these attention scores are usually neither relevant nor
guaranteed to be effective <cite class="ltx_cite ltx_citemacro_citep">(Das et al., <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>. The problem is even
more severe when we cannot afford to have enough labeled answers due
to the cost of the human annotation process. A promising solution
is providing pre-computed guidance to direct and hint the attention
mechanisms inside the VQA models towards more appropriate scores.
Early works use human attention as the label for supervising machine
attention <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>; Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>. This simple
and direct attention perceived by humans is not guaranteed to be optimal
for machine reasoning <cite class="ltx_cite ltx_citemacro_citep">(Firestone, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>; Fleuret et al., <a href="#bib.bib10" title="" class="ltx_ref">2011</a>)</cite>.
Furthermore, because annotating attention is a complex labeling task,
this process is inherently costly, inconsistent and unreliable <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>.
Finally, these methods only regulate the attention scores in training
stage without directly adjust them in inference. Different from these
approaches, we leverage the fact that such external guidance is pre-existing
in the query-image pairs and can be extracted without any additional
labels. <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">Using pre-computed language-visual associations as an
inductive bias for attention-based reasoning without further extra
labeling remains a desired but missing capability.</em></p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2205.12616/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="108" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>We introduce Grounding-based Attention Prior (GAP) mechanism (blue
box) which considers the linguistic-visual associations between a
pair of VQA query and image and refines the attentions inside reasoning
model (gray box). This boosts the performance of VQA models, reduces
their reliance on supervised data and increases their interpretability.
</figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Exploring this underlying linguistic-visual association for VQA, we
aim to distill the compatibility between entities across input modalities
in an unsupervised manner from the query-image pairs without explicit
alignment grouthtruths, and use this knowledge as an inductive bias
for the attention mechanism thus boosting reasoning capability. To
this end, we design a framework called <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">Grounding-based Attention
Prior </em>(GAP) to (1) extract the alignments between linguistic-visual
region pairs and (2) use these pair-wise associations as an inductive
bias to guide VQA’s attention mechanisms.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">For the first task, we exploit the pairing between the questions and
the images as a weakly supervised signal to learn the mapping between
words and image regions. By exploiting the implicit supervising signals
from the pairing, this requires no further annotation. To overcome
the challenge of disparity in the co-inferred semantics between query
words and image regions, we construct a parse tree of the query, extract
the nested phrasal expressions and ground them to image regions. These
expressions semantically match image regions better than single words
and thus create a set of more reliable linguistic-visual alignments.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">The second task aims at using these newly discovered alignments to
guide reasoning attention. This guidance process is provided through
two complementary pathways. First, we pre-train attention weights
to align with the pre-computed grounding. This step is done in an
unsupervised manner without access to the answer groundtruths. Second,
we use the attention prior to directly regulate and refine the attention
weights guided by the groundtruth answer through back-propagation
to not deviate too far away from it. This is modulated by a learnable
gate. These dual guidance pathways are a major advancement from previous
attention regularization methods <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>; Wu and Mooney, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>
as the linguistic-visual compatibility is leveraged directly and flexibly
in both training and inference rather than simply as just regularization.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Through extensive experiments, we prove that this methodology is effective
in both discovering the grounding and using them to boost the performance
of attention-based VQA models across representative methods and datasets.
These improvements surpass other methods’ performance and furthermore
require no extra annotation. The proposed method also significantly
improves the sample efficiency of VQA models, hence less annotated
answers are required. Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the intuition
and design of the method with an example of the improved attention
and answer.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">Our key contributions are:</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">1. A novel framework to calculate linguistic-visual alignments, providing
pre-computed attention priors to guide attention-based VQA models;</p>
</div>
<div id="S1.p9" class="ltx_para ltx_noindent">
<p id="S1.p9.1" class="ltx_p">2. A generic technique to incorporate attention priors into most common
visual reasoning methods, fortifying them in performance and significantly
reducing their reliance on human supervision; and,</p>
</div>
<div id="S1.p10" class="ltx_para ltx_noindent">
<p id="S1.p10.1" class="ltx_p">3. Rigorous experiments and analysis on the relevance of linguistic-visual
alignments to reasoning attention.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work </h3>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Attention-based models</span> are the most prominent approaches
in VQA. Simple methods <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite> only used single-hop
attention mechanism to help machine select relevant image features.
More advanced methods <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>; Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Le et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>
and those relying on memory networks <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a href="#bib.bib13" title="" class="ltx_ref">2016</a>; Xu and Saenko, <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>
used multi-hop attention mechanisms to repeatedly revise the selection
of relevant visual information. BAN <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite> learned
a co-attention map using expensive bilinear networks to represent
the interactions between pairs of word-region. One drawback of these
attention models is that they are only supervised by the answer groundtruth
without explicit attention supervision.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Attention supervision </span>is recently studied for several problems
such as machine translation <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib15" title="" class="ltx_ref">2016</a>)</cite> and image captioning
<cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Ma et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>; Zhou et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>. In VQA, attentions
can be self-regulated through internal constraints <cite class="ltx_cite ltx_citemacro_citep">(Ramakrishnan et al., <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Liu et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>.
More successful regularization methods use external knowledge such
as human annotations on textual explanations <cite class="ltx_cite ltx_citemacro_citep">(Wu and Mooney, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> or
visual attention <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>; Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>. Unlike
these, we propose to supervise VQA attentions using pre-computed
language-visual grounding from image-query pairs without using external
annotation.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Linguistic-visual alignment</span> includes the tasks of text-image
matching <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite>, grounding referring expressions
<cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite> and cross-domain joint representation <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Su et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>.
These groundings can support tasks such as captioning <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>; Karpathy and Fei-Fei, <a href="#bib.bib25" title="" class="ltx_ref">2015</a>)</cite>.
Although most tasks are supervised by human annotations, contrastive
learning <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Wang et al., <a href="#bib.bib27" title="" class="ltx_ref">2021a</a>)</cite> allows machines
to learn the associations between words and image regions from weak
supervision of phrase-image pairs. In this work, we propose to explore
such associations between query and image in VQA. This is a new challenge
because the query is complex and harder to be grounded, therefore
new method using grammatical structure will be devised.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">Our work also share the <span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Knowledge distillation</span> paradigm <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>
with cross-task <cite class="ltx_cite ltx_citemacro_citep">(Albanie et al., <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite> and cross modality <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a href="#bib.bib30" title="" class="ltx_ref">2016</a>; Liu et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2021b</a>)</cite>
adaptations. Particularly, we distill visual-linguistic grounding
and use it as an input for VQA model’s attention. This also distinguishes
our work from the recent <span id="S2.p4.1.2" class="ltx_text ltx_font_bold">self-supervised pretraining methods</span>
<cite class="ltx_cite ltx_citemacro_citep">(Tan and Bansal, <a href="#bib.bib33" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>)</cite> where they focus on a unified representation
for a wide variety of tasks thanks to the access to enormous amount
of data. Our work is theoritically applicable to complement the multimodal
matching inside these models.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h3>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.14" class="ltx_p">A VQA system aims to deduce an answer <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">y</annotation></semantics></math> about an image <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathcal{I}</annotation></semantics></math>
in response to a linguistic question <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">q</annotation></semantics></math>, <math id="S3.p1.4.m4.3" class="ltx_Math" alttext="e.g." display="inline"><semantics id="S3.p1.4.m4.3a"><mrow id="S3.p1.4.m4.3.3.1"><mrow id="S3.p1.4.m4.3.3.1.1.2" xref="S3.p1.4.m4.3.3.1.1.1.cmml"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">e</mi><mo lspace="0em" rspace="0.167em" id="S3.p1.4.m4.3.3.1.1.2.1" xref="S3.p1.4.m4.3.3.1.1.1a.cmml">.</mo><mi id="S3.p1.4.m4.2.2" xref="S3.p1.4.m4.2.2.cmml">g</mi></mrow><mo lspace="0em" id="S3.p1.4.m4.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.3b"><apply id="S3.p1.4.m4.3.3.1.1.1.cmml" xref="S3.p1.4.m4.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.1.1a.cmml" xref="S3.p1.4.m4.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑒</ci><ci id="S3.p1.4.m4.2.2.cmml" xref="S3.p1.4.m4.2.2">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.3c">e.g.</annotation></semantics></math>, via <math id="S3.p1.5.m5.3" class="ltx_Math" alttext="P(y\mid q,\mathcal{I})" display="inline"><semantics id="S3.p1.5.m5.3a"><mrow id="S3.p1.5.m5.3.3" xref="S3.p1.5.m5.3.3.cmml"><mi id="S3.p1.5.m5.3.3.3" xref="S3.p1.5.m5.3.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.5.m5.3.3.2" xref="S3.p1.5.m5.3.3.2.cmml">​</mo><mrow id="S3.p1.5.m5.3.3.1.1" xref="S3.p1.5.m5.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.p1.5.m5.3.3.1.1.2" xref="S3.p1.5.m5.3.3.1.1.1.cmml">(</mo><mrow id="S3.p1.5.m5.3.3.1.1.1" xref="S3.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.p1.5.m5.3.3.1.1.1.2" xref="S3.p1.5.m5.3.3.1.1.1.2.cmml">y</mi><mo id="S3.p1.5.m5.3.3.1.1.1.1" xref="S3.p1.5.m5.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.p1.5.m5.3.3.1.1.1.3.2" xref="S3.p1.5.m5.3.3.1.1.1.3.1.cmml"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">q</mi><mo id="S3.p1.5.m5.3.3.1.1.1.3.2.1" xref="S3.p1.5.m5.3.3.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.2.2" xref="S3.p1.5.m5.2.2.cmml">ℐ</mi></mrow></mrow><mo stretchy="false" id="S3.p1.5.m5.3.3.1.1.3" xref="S3.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.3b"><apply id="S3.p1.5.m5.3.3.cmml" xref="S3.p1.5.m5.3.3"><times id="S3.p1.5.m5.3.3.2.cmml" xref="S3.p1.5.m5.3.3.2"></times><ci id="S3.p1.5.m5.3.3.3.cmml" xref="S3.p1.5.m5.3.3.3">𝑃</ci><apply id="S3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.p1.5.m5.3.3.1.1"><csymbol cd="latexml" id="S3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.p1.5.m5.3.3.1.1.1.1">conditional</csymbol><ci id="S3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.p1.5.m5.3.3.1.1.1.2">𝑦</ci><list id="S3.p1.5.m5.3.3.1.1.1.3.1.cmml" xref="S3.p1.5.m5.3.3.1.1.1.3.2"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑞</ci><ci id="S3.p1.5.m5.2.2.cmml" xref="S3.p1.5.m5.2.2">ℐ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.3c">P(y\mid q,\mathcal{I})</annotation></semantics></math>.
The query <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">q</annotation></semantics></math> is typically decomposed into a set of <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">T</annotation></semantics></math> linguistic
entities <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="L=\left\{l_{i}\right\}_{i=1}^{T}" display="inline"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">L</mi><mo id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">=</mo><msubsup id="S3.p1.8.m8.1.1.1" xref="S3.p1.8.m8.1.1.1.cmml"><mrow id="S3.p1.8.m8.1.1.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.1.2.cmml"><mo id="S3.p1.8.m8.1.1.1.1.1.1.2" xref="S3.p1.8.m8.1.1.1.1.1.2.cmml">{</mo><msub id="S3.p1.8.m8.1.1.1.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.8.m8.1.1.1.1.1.1.1.2" xref="S3.p1.8.m8.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S3.p1.8.m8.1.1.1.1.1.1.1.3" xref="S3.p1.8.m8.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.8.m8.1.1.1.1.1.1.3" xref="S3.p1.8.m8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p1.8.m8.1.1.1.1.3" xref="S3.p1.8.m8.1.1.1.1.3.cmml"><mi id="S3.p1.8.m8.1.1.1.1.3.2" xref="S3.p1.8.m8.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p1.8.m8.1.1.1.1.3.1" xref="S3.p1.8.m8.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p1.8.m8.1.1.1.1.3.3" xref="S3.p1.8.m8.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p1.8.m8.1.1.1.3" xref="S3.p1.8.m8.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><eq id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2"></eq><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝐿</ci><apply id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1">superscript</csymbol><apply id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1">subscript</csymbol><set id="S3.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1.1.1.1"><apply id="S3.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.p1.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.8.m8.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.p1.8.m8.1.1.1.1.3.cmml" xref="S3.p1.8.m8.1.1.1.1.3"><eq id="S3.p1.8.m8.1.1.1.1.3.1.cmml" xref="S3.p1.8.m8.1.1.1.1.3.1"></eq><ci id="S3.p1.8.m8.1.1.1.1.3.2.cmml" xref="S3.p1.8.m8.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.p1.8.m8.1.1.1.1.3.3.cmml" xref="S3.p1.8.m8.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p1.8.m8.1.1.1.3.cmml" xref="S3.p1.8.m8.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">L=\left\{l_{i}\right\}_{i=1}^{T}</annotation></semantics></math>. These entities and
the query <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">q</annotation></semantics></math> are then embedded into a feature vector space: <math id="S3.p1.10.m10.2" class="ltx_Math" alttext="q\in\mathbb{R}^{d},\,l_{i}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.p1.10.m10.2a"><mrow id="S3.p1.10.m10.2.2.2" xref="S3.p1.10.m10.2.2.3.cmml"><mrow id="S3.p1.10.m10.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.cmml"><mi id="S3.p1.10.m10.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.2.cmml">q</mi><mo id="S3.p1.10.m10.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.cmml">∈</mo><msup id="S3.p1.10.m10.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.3.cmml"><mi id="S3.p1.10.m10.1.1.1.1.3.2" xref="S3.p1.10.m10.1.1.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.10.m10.1.1.1.1.3.3" xref="S3.p1.10.m10.1.1.1.1.3.3.cmml">d</mi></msup></mrow><mo rspace="0.337em" id="S3.p1.10.m10.2.2.2.3" xref="S3.p1.10.m10.2.2.3a.cmml">,</mo><mrow id="S3.p1.10.m10.2.2.2.2" xref="S3.p1.10.m10.2.2.2.2.cmml"><msub id="S3.p1.10.m10.2.2.2.2.2" xref="S3.p1.10.m10.2.2.2.2.2.cmml"><mi id="S3.p1.10.m10.2.2.2.2.2.2" xref="S3.p1.10.m10.2.2.2.2.2.2.cmml">l</mi><mi id="S3.p1.10.m10.2.2.2.2.2.3" xref="S3.p1.10.m10.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p1.10.m10.2.2.2.2.1" xref="S3.p1.10.m10.2.2.2.2.1.cmml">∈</mo><msup id="S3.p1.10.m10.2.2.2.2.3" xref="S3.p1.10.m10.2.2.2.2.3.cmml"><mi id="S3.p1.10.m10.2.2.2.2.3.2" xref="S3.p1.10.m10.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S3.p1.10.m10.2.2.2.2.3.3" xref="S3.p1.10.m10.2.2.2.2.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.2b"><apply id="S3.p1.10.m10.2.2.3.cmml" xref="S3.p1.10.m10.2.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.2.2.3a.cmml" xref="S3.p1.10.m10.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p1.10.m10.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1"><in id="S3.p1.10.m10.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1"></in><ci id="S3.p1.10.m10.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.2">𝑞</ci><apply id="S3.p1.10.m10.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.1.1.3">superscript</csymbol><ci id="S3.p1.10.m10.1.1.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.1.1.3.2">ℝ</ci><ci id="S3.p1.10.m10.1.1.1.1.3.3.cmml" xref="S3.p1.10.m10.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S3.p1.10.m10.2.2.2.2.cmml" xref="S3.p1.10.m10.2.2.2.2"><in id="S3.p1.10.m10.2.2.2.2.1.cmml" xref="S3.p1.10.m10.2.2.2.2.1"></in><apply id="S3.p1.10.m10.2.2.2.2.2.cmml" xref="S3.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.2.2.2.2.2.1.cmml" xref="S3.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.10.m10.2.2.2.2.2.2.cmml" xref="S3.p1.10.m10.2.2.2.2.2.2">𝑙</ci><ci id="S3.p1.10.m10.2.2.2.2.2.3.cmml" xref="S3.p1.10.m10.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.p1.10.m10.2.2.2.2.3.cmml" xref="S3.p1.10.m10.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.10.m10.2.2.2.2.3.1.cmml" xref="S3.p1.10.m10.2.2.2.2.3">superscript</csymbol><ci id="S3.p1.10.m10.2.2.2.2.3.2.cmml" xref="S3.p1.10.m10.2.2.2.2.3.2">ℝ</ci><ci id="S3.p1.10.m10.2.2.2.2.3.3.cmml" xref="S3.p1.10.m10.2.2.2.2.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.2c">q\in\mathbb{R}^{d},\,l_{i}\in\mathbb{R}^{d}</annotation></semantics></math>.
In the case of sequential embedding popularly used for VQA, entities
are query words; they are encoded with GloVe for word-level embedding
<cite class="ltx_cite ltx_citemacro_citep">(Pennington et al., <a href="#bib.bib35" title="" class="ltx_ref">2014</a>)</cite> followed by RNNs such as BiLSTM for sentence-level
embedding. Likewise the image <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S3.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">\mathcal{I}</annotation></semantics></math> is often segmented into
a set of <math id="S3.p1.12.m12.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">N</annotation></semantics></math> visual regions with features <math id="S3.p1.13.m13.2" class="ltx_Math" alttext="V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d}\right\}_{j=1}^{N}" display="inline"><semantics id="S3.p1.13.m13.2a"><mrow id="S3.p1.13.m13.2.2" xref="S3.p1.13.m13.2.2.cmml"><mi id="S3.p1.13.m13.2.2.4" xref="S3.p1.13.m13.2.2.4.cmml">V</mi><mo id="S3.p1.13.m13.2.2.3" xref="S3.p1.13.m13.2.2.3.cmml">=</mo><msubsup id="S3.p1.13.m13.2.2.2" xref="S3.p1.13.m13.2.2.2.cmml"><mrow id="S3.p1.13.m13.2.2.2.2.2.2" xref="S3.p1.13.m13.2.2.2.2.2.3.cmml"><mo id="S3.p1.13.m13.2.2.2.2.2.2.3" xref="S3.p1.13.m13.2.2.2.2.2.3.1.cmml">{</mo><msub id="S3.p1.13.m13.1.1.1.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.2" xref="S3.p1.13.m13.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.13.m13.2.2.2.2.2.2.4" xref="S3.p1.13.m13.2.2.2.2.2.3.1.cmml">∣</mo><mrow id="S3.p1.13.m13.2.2.2.2.2.2.2" xref="S3.p1.13.m13.2.2.2.2.2.2.2.cmml"><msub id="S3.p1.13.m13.2.2.2.2.2.2.2.2" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.13.m13.2.2.2.2.2.2.2.2.2" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.p1.13.m13.2.2.2.2.2.2.2.2.3" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.p1.13.m13.2.2.2.2.2.2.2.1" xref="S3.p1.13.m13.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S3.p1.13.m13.2.2.2.2.2.2.2.3" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3.cmml"><mi id="S3.p1.13.m13.2.2.2.2.2.2.2.3.2" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S3.p1.13.m13.2.2.2.2.2.2.2.3.3" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3.3.cmml">d</mi></msup></mrow><mo id="S3.p1.13.m13.2.2.2.2.2.2.5" xref="S3.p1.13.m13.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="S3.p1.13.m13.2.2.2.2.4" xref="S3.p1.13.m13.2.2.2.2.4.cmml"><mi id="S3.p1.13.m13.2.2.2.2.4.2" xref="S3.p1.13.m13.2.2.2.2.4.2.cmml">j</mi><mo id="S3.p1.13.m13.2.2.2.2.4.1" xref="S3.p1.13.m13.2.2.2.2.4.1.cmml">=</mo><mn id="S3.p1.13.m13.2.2.2.2.4.3" xref="S3.p1.13.m13.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S3.p1.13.m13.2.2.2.4" xref="S3.p1.13.m13.2.2.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.2b"><apply id="S3.p1.13.m13.2.2.cmml" xref="S3.p1.13.m13.2.2"><eq id="S3.p1.13.m13.2.2.3.cmml" xref="S3.p1.13.m13.2.2.3"></eq><ci id="S3.p1.13.m13.2.2.4.cmml" xref="S3.p1.13.m13.2.2.4">𝑉</ci><apply id="S3.p1.13.m13.2.2.2.cmml" xref="S3.p1.13.m13.2.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.2.2.2.3.cmml" xref="S3.p1.13.m13.2.2.2">superscript</csymbol><apply id="S3.p1.13.m13.2.2.2.2.cmml" xref="S3.p1.13.m13.2.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.2.2.2.2.3.cmml" xref="S3.p1.13.m13.2.2.2">subscript</csymbol><apply id="S3.p1.13.m13.2.2.2.2.2.3.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2"><csymbol cd="latexml" id="S3.p1.13.m13.2.2.2.2.2.3.1.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="S3.p1.13.m13.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.p1.13.m13.2.2.2.2.2.2.2.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2"><in id="S3.p1.13.m13.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.1"></in><apply id="S3.p1.13.m13.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.2.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.13.m13.2.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.p1.13.m13.2.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.p1.13.m13.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.13.m13.2.2.2.2.2.2.2.3.1.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S3.p1.13.m13.2.2.2.2.2.2.2.3.2.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3.2">ℝ</ci><ci id="S3.p1.13.m13.2.2.2.2.2.2.2.3.3.cmml" xref="S3.p1.13.m13.2.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></apply><apply id="S3.p1.13.m13.2.2.2.2.4.cmml" xref="S3.p1.13.m13.2.2.2.2.4"><eq id="S3.p1.13.m13.2.2.2.2.4.1.cmml" xref="S3.p1.13.m13.2.2.2.2.4.1"></eq><ci id="S3.p1.13.m13.2.2.2.2.4.2.cmml" xref="S3.p1.13.m13.2.2.2.2.4.2">𝑗</ci><cn type="integer" id="S3.p1.13.m13.2.2.2.2.4.3.cmml" xref="S3.p1.13.m13.2.2.2.2.4.3">1</cn></apply></apply><ci id="S3.p1.13.m13.2.2.2.4.cmml" xref="S3.p1.13.m13.2.2.2.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.2c">V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d}\right\}_{j=1}^{N}</annotation></semantics></math>
by an object detector, i.e., Faster R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a href="#bib.bib36" title="" class="ltx_ref">2015</a>)</cite>.
For ease of reading, we use the dimension <math id="S3.p1.14.m14.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p1.14.m14.1a"><mi id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><ci id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">d</annotation></semantics></math> for both linguistic
embedding vectors and visual representation vectors.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.2" class="ltx_p">A large family of VQA systems <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib5" title="" class="ltx_ref">2016</a>; Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Le et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Kim et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>, <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>
rely on attention mechanisms to distribute conditional computations
on linguistic entities <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">L</annotation></semantics></math> and visual counterparts <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">V</annotation></semantics></math>. These models
can be broadly classified into two groups: <em id="S3.p2.2.1" class="ltx_emph ltx_font_italic">joint-</em> and <em id="S3.p2.2.2" class="ltx_emph ltx_font_italic">marginalized-
attention models</em>. <cite class="ltx_cite ltx_citemacro_citet">Lu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2016</a>); Anderson et al. (<a href="#bib.bib1" title="" class="ltx_ref">2018</a>); Hudson and Manning (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>
are among those who fall into the former, while <cite class="ltx_cite ltx_citemacro_citet">Kim et al. (<a href="#bib.bib3" title="" class="ltx_ref">2018</a>, <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>
and Transformer-based models <cite class="ltx_cite ltx_citemacro_citep">(Tan and Bansal, <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite> are typical representative
of the works in the latter category.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Joint attention models</h6>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px1.p1.8" class="ltx_p">The most complete attention model includes a detailed pair-wise attention
map indicating the contextualized correlation between word-region
pairs used to estimate the interaction between visual and linguistic
entities for the combined information. These attention weights are
in the form of a 2D matrix <math id="S3.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="A\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">A</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1"><in id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝐴</ci><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝑇</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">A\in\mathbb{R}^{T\times N}</annotation></semantics></math>. They often
contain fine-grained relationships between each linguistic word to
each visual region. The attention matrix <math id="S3.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">A</annotation></semantics></math> is derived by a sub-network
<math id="S3.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_math_unparsed" alttext="B_{\theta}(.)" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><msub id="S3.SS0.SSS0.Px1.p1.3.m3.1.1"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2">B</mi><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3">θ</mi></msub><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.2"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2">.</mo><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">B_{\theta}(.)</annotation></semantics></math> as <math id="S3.SS0.SSS0.Px1.p1.4.m4.3" class="ltx_Math" alttext="A_{ij}=B_{\theta}(e_{ij}\mid V,L)" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.3a"><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.cmml"><msub id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.2.cmml">A</mi><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.cmml"><msub id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.2.cmml">B</mi><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml"><msub id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.2.cmml">e</mi><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.1.cmml">∣</mo><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">V</mi><mo id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.2.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.2.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.2.2.cmml">L</mi></mrow></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.3b"><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3"><eq id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.2"></eq><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.2">𝐴</ci><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3"><times id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.2">𝑖</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1"><times id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.2"></times><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.2">𝐵</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.3.3">𝜃</ci></apply><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.2">𝑒</ci><apply id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3"><times id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.2.3.3">𝑗</ci></apply></apply><list id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.3.2"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝑉</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.2.2">𝐿</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.3c">A_{ij}=B_{\theta}(e_{ij}\mid V,L)</annotation></semantics></math>, where each
<math id="S3.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="e_{ij}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.1a"><msub id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml">e</mi><mrow id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2">𝑒</ci><apply id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3"><times id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2">𝑖</ci><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.1c">e_{ij}</annotation></semantics></math> denotes the correlation between the linguistic entities
<math id="S3.SS0.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml">l</mi><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2">𝑙</ci><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.6.m6.1c">l_{i}</annotation></semantics></math> and the visual region <math id="S3.SS0.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.7.m7.1a"><msub id="S3.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.2">𝑣</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.7.m7.1c">v_{j}</annotation></semantics></math>, and <math id="S3.SS0.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.8.m8.1a"><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.8.m8.1b"><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.8.m8.1c">\theta</annotation></semantics></math> is network
parameters of VQA models. Joint attention models contain the rich
pairwise relation and often perform well. However, calculating and
using this full matrix has a large overhead computation cost. A good
approximation of this matrix is the marginalized vectors over rows
and columns which is described next.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Marginalized attention models</h6>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p1.15" class="ltx_p">Conceptually, the matrix <math id="S3.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">A</annotation></semantics></math> is marginalized along columns into the
<em id="S3.SS0.SSS0.Px2.p1.15.1" class="ltx_emph ltx_font_italic">linguistic attention vector</em> <math id="S3.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\alpha=\left\{\alpha_{i}\right\}_{i=1}^{T}\in\mathbb{R}^{T}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">α</mi><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.4" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.4.cmml">=</mo><msubsup id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.3.cmml">T</mi></msubsup><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.5" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.5.cmml">∈</mo><msup id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.2.cmml">ℝ</mi><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"><and id="S3.SS0.SSS0.Px2.p1.2.m2.1.1a.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"></and><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1b.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"><eq id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.4.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.4"></eq><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝛼</ci><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3"><eq id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1c.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"><in id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.5.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.5"></in><share href="#S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1d.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"></share><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.2">ℝ</ci><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.6.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">\alpha=\left\{\alpha_{i}\right\}_{i=1}^{T}\in\mathbb{R}^{T}</annotation></semantics></math>
and along rows into <em id="S3.SS0.SSS0.Px2.p1.15.2" class="ltx_emph ltx_font_italic">visual attention vector</em> <math id="S3.SS0.SSS0.Px2.p1.3.m3.2" class="ltx_Math" alttext="\beta=\left\{\beta_{j}\right\}_{j=1}^{N},\beta\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.2a"><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.3.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml">β</mi><mo id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml">=</mo><msubsup id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">β</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">N</mi></msubsup></mrow><mo id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml">β</mi><mo id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.3.cmml">N</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.2b"><apply id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.3a.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1"><eq id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2"></eq><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3">𝛽</ci><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1"><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3"><eq id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">𝑁</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2"><in id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.1"></in><ci id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.2">𝛽</ci><apply id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.2">ℝ</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.2.2.2.2.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.2c">\beta=\left\{\beta_{j}\right\}_{j=1}^{N},\beta\in\mathbb{R}^{N}</annotation></semantics></math>.
In practice, <math id="S3.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m4.1c">\alpha</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.5.m5.1c">\beta</annotation></semantics></math> are calculated directly from
each pair of input image and query through dedicated attention modules.
They can be implemented in different ways such as direct single-shot
attention <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, co-attention <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib5" title="" class="ltx_ref">2016</a>)</cite>
or multi-step attention <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>. In our
experiment, we concentrate on two popular mechanisms: <em id="S3.SS0.SSS0.Px2.p1.15.3" class="ltx_emph ltx_font_italic">single-shot
attention</em> where the visual attention <math id="S3.SS0.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.6.m6.1a"><mi id="S3.SS0.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px2.p1.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.6.m6.1b"><ci id="S3.SS0.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.6.m6.1c">\beta</annotation></semantics></math> is calculated directly
from the inputs <math id="S3.SS0.SSS0.Px2.p1.7.m7.2" class="ltx_Math" alttext="(V,q)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.7.m7.2a"><mrow id="S3.SS0.SSS0.Px2.p1.7.m7.2.3.2" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.7.m7.2.3.2.1" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.cmml">V</mi><mo id="S3.SS0.SSS0.Px2.p1.7.m7.2.3.2.2" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.7.m7.2.2" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.7.m7.2.3.2.3" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.7.m7.2b"><interval closure="open" id="S3.SS0.SSS0.Px2.p1.7.m7.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.3.2"><ci id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1">𝑉</ci><ci id="S3.SS0.SSS0.Px2.p1.7.m7.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.7.m7.2c">(V,q)</annotation></semantics></math> and <em id="S3.SS0.SSS0.Px2.p1.15.4" class="ltx_emph ltx_font_italic">alternating attention mechanism</em>
where the visual attention <math id="S3.SS0.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.8.m8.1a"><mi id="S3.SS0.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px2.p1.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.8.m8.1b"><ci id="S3.SS0.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.8.m8.1c">\beta</annotation></semantics></math> follows the linguistic attention
<math id="S3.SS0.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.9.m9.1a"><mi id="S3.SS0.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.9.m9.1b"><ci id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.9.m9.1c">\alpha</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib5" title="" class="ltx_ref">2016</a>)</cite>. Concretely, <math id="S3.SS0.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.10.m10.1a"><mi id="S3.SS0.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.10.m10.1b"><ci id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.10.m10.1c">\alpha</annotation></semantics></math> is estimated
first, followed by the attended linguistic feature of the entire query
<math id="S3.SS0.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="c=\sum_{i=1}^{T}\alpha_{i}*l_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.11.m11.1a"><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.2.cmml">c</mi><mo rspace="0.111em" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.cmml"><msubsup id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.cmml"><mo id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.3.cmml">T</mi></msubsup><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.cmml"><msub id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.2.cmml">α</mi><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.1.cmml">∗</mo><msub id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.2.cmml">l</mi><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.11.m11.1b"><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1"><eq id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.2">𝑐</ci><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3"><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1">subscript</csymbol><sum id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.2"></sum><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3"><eq id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.1.3">𝑇</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2"><times id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.1"></times><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.2">𝛼</ci><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.2">𝑙</ci><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.11.m11.1c">c=\sum_{i=1}^{T}\alpha_{i}*l_{i}</annotation></semantics></math>; then this attended linguistic
feature is used to calculate the visual attention <math id="S3.SS0.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.12.m12.1a"><mi id="S3.SS0.SSS0.Px2.p1.12.m12.1.1" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.12.m12.1b"><ci id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.12.m12.1c">\beta</annotation></semantics></math>. The alternating
mechanism can be extended with multi-step reasoning <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Le et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Hu et al., <a href="#bib.bib38" title="" class="ltx_ref">2019</a>)</cite>.
In such case, a pair of attentions <math id="S3.SS0.SSS0.Px2.p1.13.m13.2" class="ltx_Math" alttext="\alpha_{i,k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.13.m13.2a"><msub id="S3.SS0.SSS0.Px2.p1.13.m13.2.3" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.13.m13.2.3.2" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.3.2.cmml">α</mi><mrow id="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.4" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.1.1.cmml">i</mi><mo id="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.4.1" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.3.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.13.m13.2b"><apply id="S3.SS0.SSS0.Px2.p1.13.m13.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.13.m13.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.13.m13.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.3.2">𝛼</ci><list id="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.4"><ci id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.1.1">𝑖</ci><ci id="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.13.m13.2c">\alpha_{i,k}</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px2.p1.14.m14.2" class="ltx_Math" alttext="\beta_{j,k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.14.m14.2a"><msub id="S3.SS0.SSS0.Px2.p1.14.m14.2.3" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.14.m14.2.3.2" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.3.2.cmml">β</mi><mrow id="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.4" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.1.1.cmml">j</mi><mo id="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.4.1" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.3.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.14.m14.2b"><apply id="S3.SS0.SSS0.Px2.p1.14.m14.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.14.m14.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.14.m14.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.3.2">𝛽</ci><list id="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.4"><ci id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.1.1">𝑗</ci><ci id="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.14.m14.2c">\beta_{j,k}</annotation></semantics></math>
are estimated at each reasoning step <math id="S3.SS0.SSS0.Px2.p1.15.m15.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.15.m15.1a"><mi id="S3.SS0.SSS0.Px2.p1.15.m15.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.15.m15.1b"><ci id="S3.SS0.SSS0.Px2.p1.15.m15.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.15.m15.1c">k</annotation></semantics></math> forming a series of them.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2205.12616/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="177" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall architecture of a generic joint attention VQA model using
Grounding-based Attention Prior (GAP) to guide the computation of
attention weights. Vision-language compatibility pre-computed by an
unsupervised framework (green boxes) serves as an extra source of
information, providing inductive biases to guide attention weights
inside attention-based VQA models towards more meaningful alignment.</figcaption>
</figure>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Answer decoder</h6>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p1.7" class="ltx_p">Attention scores drive the reasoning process producing a joint linguistic-visual
representation on which the answer is decoded: <math id="S3.SS0.SSS0.Px3.p1.1.m1.4" class="ltx_Math" alttext="P\left(a\mid f(L,V,\text{att\_scores})\right)" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.1.m1.4a"><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.4.4" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.cmml"><mo id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.2.cmml">a</mi><mo id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.1.cmml">∣</mo><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.1.cmml">​</mo><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">L</mi><mo id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px3.p1.1.m1.2.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.2.2.cmml">V</mi><mo id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml">,</mo><mtext id="S3.SS0.SSS0.Px3.p1.1.m1.3.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.3.3a.cmml">att_scores</mtext><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2.4" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.1.m1.4b"><apply id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4"><times id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.2"></times><ci id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.3">𝑃</ci><apply id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.1">conditional</csymbol><ci id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.2">𝑎</ci><apply id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3"><times id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.2">𝑓</ci><vector id="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.4.4.1.1.1.3.3.2"><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1">𝐿</ci><ci id="S3.SS0.SSS0.Px3.p1.1.m1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.2.2">𝑉</ci><ci id="S3.SS0.SSS0.Px3.p1.1.m1.3.3a.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.3.3"><mtext id="S3.SS0.SSS0.Px3.p1.1.m1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.3.3">att_scores</mtext></ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.1.m1.4c">P\left(a\mid f(L,V,\text{att\_scores})\right)</annotation></semantics></math>
(“att_scores” refers to either visual attention vector <math id="S3.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.2.m2.1c">\beta</annotation></semantics></math>
or attention matrix <math id="S3.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.3.m3.1a"><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.3.m3.1c">A</annotation></semantics></math>). For marginalized attention models, the
function <math id="S3.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_math_unparsed" alttext="f(.)" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.4.m4.1a"><mrow id="S3.SS0.SSS0.Px3.p1.4.m4.1b"><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.1">f</mi><mrow id="S3.SS0.SSS0.Px3.p1.4.m4.1.2"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2">.</mo><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.4.m4.1c">f(.)</annotation></semantics></math> is a neural network taking as input the query representation
<math id="S3.SS0.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.5.m5.1a"><mi id="S3.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.5.m5.1c">q</annotation></semantics></math> and the attended visual feature <math id="S3.SS0.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="\hat{v}=\sum_{j}\beta_{j}*v_{j}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.6.m6.1a"><mrow id="S3.SS0.SSS0.Px3.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.cmml"><mover accent="true" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2.cmml">v</mi><mo id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.1.cmml">^</mo></mover><mo rspace="0.111em" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.cmml"><msub id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.cmml"><mo id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.2.cmml">∑</mo><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.3.cmml">j</mi></msub><mrow id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.cmml"><msub id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.2.cmml">β</mi><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.1.cmml">∗</mo><msub id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1"><eq id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2"><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.1">^</ci><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2">𝑣</ci></apply><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3"><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1">subscript</csymbol><sum id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.2"></sum><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.1.3">𝑗</ci></apply><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2"><times id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.1"></times><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.2">𝛽</ci><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.2.3">𝑗</ci></apply><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.2">𝑣</ci><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.6.m6.1c">\hat{v}=\sum_{j}\beta_{j}*v_{j}</annotation></semantics></math>
to return a joint representation. Joint attention models instead use
the bilinear combination to calculate each component of the output
vector of <math id="S3.SS0.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.7.m7.1a"><mi id="S3.SS0.SSS0.Px3.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px3.p1.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.7.m7.1b"><ci id="S3.SS0.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.7.m7.1c">f</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>:</p>
</div>
<div id="S3.SS0.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="f_{t}\equiv(L^{\top}W_{L})_{t}^{\top}A(V^{\top}W_{V})_{t}," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.4.2.cmml">f</mi><mi id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">≡</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">L</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.2.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.3a" xref="S3.E1.m1.1.1.1.1.2.3.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.cmml">V</mi><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml">V</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><equivalent id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"></equivalent><apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2">𝑓</ci><ci id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"></times><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐿</ci><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝐿</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">top</csymbol></apply><ci id="S3.E1.m1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.4">𝐴</ci><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1"><times id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1"></times><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2">𝑉</ci><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3">top</csymbol></apply><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.3.3">𝑉</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">f_{t}\equiv(L^{\top}W_{L})_{t}^{\top}A(V^{\top}W_{V})_{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px3.p2.3" class="ltx_p">where <math id="S3.SS0.SSS0.Px3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px3.p2.1.m1.1a"><mi id="S3.SS0.SSS0.Px3.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p2.1.m1.1b"><ci id="S3.SS0.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p2.1.m1.1c">t</annotation></semantics></math> is the index of output components and <math id="S3.SS0.SSS0.Px3.p2.2.m2.1" class="ltx_Math" alttext="W_{L}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p2.2.m2.1a"><mrow id="S3.SS0.SSS0.Px3.p2.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.2" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.3" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.1" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.2" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.1" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.3" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p2.2.m2.1b"><apply id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1"><in id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.1"></in><apply id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.2.3">𝐿</ci></apply><apply id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3"><times id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p2.2.m2.1c">W_{L}\in\mathbb{R}^{d\times d}</annotation></semantics></math>
and <math id="S3.SS0.SSS0.Px3.p2.3.m3.1" class="ltx_Math" alttext="W_{V}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p2.3.m3.1a"><mrow id="S3.SS0.SSS0.Px3.p2.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.2" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.3" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.3.cmml">V</mi></msub><mo id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.1" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.1" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.3" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p2.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1"><in id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.1"></in><apply id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.2.3">𝑉</ci></apply><apply id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3"><times id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p2.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p2.3.m3.1c">W_{V}\in\mathbb{R}^{d\times d}</annotation></semantics></math> are learnable weights.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methods</h3>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We now present Grounding-based Attention Priors (GAP), an approach
to extract the concept-level association between query and image and
use this knowledge as attention priors to guide and refine the cross-modality
attentions inside VQA systems. The approach consists of two main stages.
First, we learn to estimate the linguistic-visual alignments directly
from question-image pairs (Sec. <a href="#S4.SS1" title="4.1 Structures for Linguistic-Visual Alignment ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, green boxes
in Fig. <a href="#S3.F2" title="Figure 2 ‣ Marginalized attention models ‣ 3 Preliminaries ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Second, we use such knowledge as inductive
priors to assist the computation of attention in VQA (Sec. <a href="#S4.SS2" title="4.2 Pre-training VQA Attention ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>,
Sec. <a href="#S4.SS3" title="4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, and lower parts in Fig. <a href="#S3.F2" title="Figure 2 ‣ Marginalized attention models ‣ 3 Preliminaries ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Structures for Linguistic-Visual Alignment</h4>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.4" class="ltx_p"><span id="S4.SS1.p1.4.1" class="ltx_text ltx_font_bold">Grammatical structures for grounding</span>. The task of <em id="S4.SS1.p1.4.2" class="ltx_emph ltx_font_italic">Linguistic-visual
Alignment</em> aims to find the groundings between the linguistic entities
(<math id="S4.SS1.p1.1.m1.3" class="ltx_Math" alttext="e.g." display="inline"><semantics id="S4.SS1.p1.1.m1.3a"><mrow id="S4.SS1.p1.1.m1.3.3.1"><mrow id="S4.SS1.p1.1.m1.3.3.1.1.2" xref="S4.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">e</mi><mo lspace="0em" rspace="0.167em" id="S4.SS1.p1.1.m1.3.3.1.1.2.1" xref="S4.SS1.p1.1.m1.3.3.1.1.1a.cmml">.</mo><mi id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">g</mi></mrow><mo lspace="0em" id="S4.SS1.p1.1.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.3b"><apply id="S4.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.p1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.3.3.1.1.1a.cmml" xref="S4.SS1.p1.1.m1.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑒</ci><ci id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.3c">e.g.</annotation></semantics></math>, query words <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="L=\left\{l_{i}\right\}_{i=1}^{T}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">L</mi><mo id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml"><mrow id="S4.SS1.p1.2.m2.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.2.m2.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p1.2.m2.1.1.1.1.3.1" xref="S4.SS1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.2.m2.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"></eq><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝐿</ci><apply id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1">subscript</csymbol><set id="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1"><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.3"><eq id="S4.SS1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.2.m2.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">L=\left\{l_{i}\right\}_{i=1}^{T}</annotation></semantics></math> in VQA)
and vision entities (<math id="S4.SS1.p1.3.m3.3" class="ltx_Math" alttext="e.g." display="inline"><semantics id="S4.SS1.p1.3.m3.3a"><mrow id="S4.SS1.p1.3.m3.3.3.1"><mrow id="S4.SS1.p1.3.m3.3.3.1.1.2" xref="S4.SS1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">e</mi><mo lspace="0em" rspace="0.167em" id="S4.SS1.p1.3.m3.3.3.1.1.2.1" xref="S4.SS1.p1.3.m3.3.3.1.1.1a.cmml">.</mo><mi id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">g</mi></mrow><mo lspace="0em" id="S4.SS1.p1.3.m3.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.3b"><apply id="S4.SS1.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.1.1.1a.cmml" xref="S4.SS1.p1.3.m3.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑒</ci><ci id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.3c">e.g.</annotation></semantics></math>, visual regions <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="V=\left\{v_{j}\right\}_{j=1}^{N}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">V</mi><mo id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.4.m4.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2.cmml">j</mi><mo id="S4.SS1.p1.4.m4.1.1.1.1.3.1" xref="S4.SS1.p1.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.1.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"></eq><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑉</ci><apply id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1">subscript</csymbol><set id="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1"><apply id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S4.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3"><eq id="S4.SS1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.1"></eq><ci id="S4.SS1.p1.4.m4.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.4.m4.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">V=\left\{v_{j}\right\}_{j=1}^{N}</annotation></semantics></math>
in VQA) in a shared context. This requires the interpretation of individual
words in the complex context of the query so that they can co-refer
to the same concepts as image regions. However, compositional queries
have complex structures that prevent state-of-the-art language representation
methods from fully understanding the relations between semantic concepts
in the queries <cite class="ltx_cite ltx_citemacro_citep">(Reimers and Gurevych, <a href="#bib.bib39" title="" class="ltx_ref">2019</a>)</cite>. We propose to better
contextualize query words by <em id="S4.SS1.p1.4.3" class="ltx_emph ltx_font_italic">breaking a full query into phrases
that refer to simpler structures, </em>making the computation of word-region
grounding more effective<em id="S4.SS1.p1.4.4" class="ltx_emph ltx_font_italic">. </em>These phrases are called <em id="S4.SS1.p1.4.5" class="ltx_emph ltx_font_italic">referring
expressions</em> (RE) <cite class="ltx_cite ltx_citemacro_citep">(Mao et al., <a href="#bib.bib40" title="" class="ltx_ref">2016</a>)</cite> and were shown to co-refer
well to image regions <cite class="ltx_cite ltx_citemacro_citep">(Kazemzadeh et al., <a href="#bib.bib41" title="" class="ltx_ref">2014</a>)</cite>. The VQA
image-query pairing labels are passed to the REs of such query. We
then ground words with contextualized embeddings within each RE to
their corresponding visual regions. As the REs are nested phrases
from the query, a word can appear in multiple REs. Thus, we obtain
the query-wide <em id="S4.SS1.p1.4.6" class="ltx_emph ltx_font_italic">word-region grounding</em> by aggregating the grounding
of REs containing the word. See Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1 Structures for Linguistic-Visual Alignment ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
for an example on this process.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2205.12616/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="267" height="227" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The query is parsed into a constituency parse tree to identify REs.
Each RE serves as a local context for words. Words within each RE
context are grounded to corresponding image regions. A word can appear
in multiple REs, and thus its final grounding is averaged over containing
REs, serving as inductive prior for VQA.</figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.3" class="ltx_p">We extract query REs using a constituency parse tree <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathcal{T}</annotation></semantics></math><cite class="ltx_cite ltx_citemacro_citep">(Cirik et al., <a href="#bib.bib42" title="" class="ltx_ref">2018</a>)</cite>.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Berkeley Neural Parser <cite class="ltx_cite ltx_citemacro_citep">(Kitaev and Klein, <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite> in our implementation.</span></span></span>
In this structure, the query is represented as a set of nested phrases
corresponding to subtrees of <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\mathcal{T}</annotation></semantics></math>. The parser also provides
the grammatical roles of the phrases. For example, the phrase “the
white car” will be tagged as a <em id="S4.SS1.p2.3.1" class="ltx_emph ltx_font_italic">noun-phrase </em>while “standing
next to the white car” is a<em id="S4.SS1.p2.3.2" class="ltx_emph ltx_font_italic"> verb-phrase</em>. As visual objects
and regions are naturally associated with noun-phrases, we select
a set <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="E=\left\{E_{r}\right\}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">E</mi><mo id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">=</mo><mrow id="S4.SS1.p2.3.m3.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.2.cmml"><mo id="S4.SS1.p2.3.m3.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p2.3.m3.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml">E</mi><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S4.SS1.p2.3.m3.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2"></eq><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝐸</ci><set id="S4.SS1.p2.3.m3.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1"><apply id="S4.SS1.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2">𝐸</ci><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.3">𝑟</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">E=\left\{E_{r}\right\}</annotation></semantics></math> of all the noun phrases and wh-noun
phrases<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>noun phrases prefixed by a pronoun, <math id="footnote2.m1.3" class="ltx_Math" alttext="e.g." display="inline"><semantics id="footnote2.m1.3b"><mrow id="footnote2.m1.3.3.1"><mrow id="footnote2.m1.3.3.1.1.2" xref="footnote2.m1.3.3.1.1.1.cmml"><mi id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">e</mi><mo lspace="0em" rspace="0.167em" id="footnote2.m1.3.3.1.1.2.1" xref="footnote2.m1.3.3.1.1.1a.cmml">.</mo><mi id="footnote2.m1.2.2" xref="footnote2.m1.2.2.cmml">g</mi></mrow><mo lspace="0em" id="footnote2.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.3c"><apply id="footnote2.m1.3.3.1.1.1.cmml" xref="footnote2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="footnote2.m1.3.3.1.1.1a.cmml" xref="footnote2.m1.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1">𝑒</ci><ci id="footnote2.m1.2.2.cmml" xref="footnote2.m1.2.2">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.3d">e.g.</annotation></semantics></math>, “which side”, “whose
bag”.</span></span></span> as the REs.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.10" class="ltx_p">We denote the <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="r^{th}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msup id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">r</mi><mrow id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑟</ci><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><times id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.1"></times><ci id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">r^{th}</annotation></semantics></math> RE as <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="E_{r}=\{w_{i}\mid w_{i}\in\mathbb{R}^{d}\}_{s_{r}\leq i\leq e_{r}}" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><mrow id="S4.SS1.p3.2.m2.2.2" xref="S4.SS1.p3.2.m2.2.2.cmml"><msub id="S4.SS1.p3.2.m2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.4.cmml"><mi id="S4.SS1.p3.2.m2.2.2.4.2" xref="S4.SS1.p3.2.m2.2.2.4.2.cmml">E</mi><mi id="S4.SS1.p3.2.m2.2.2.4.3" xref="S4.SS1.p3.2.m2.2.2.4.3.cmml">r</mi></msub><mo id="S4.SS1.p3.2.m2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.3.cmml">=</mo><msub id="S4.SS1.p3.2.m2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.cmml"><mrow id="S4.SS1.p3.2.m2.2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.2.m2.2.2.2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.2.2.3.1.cmml">{</mo><msub id="S4.SS1.p3.2.m2.1.1.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.2.m2.1.1.1.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="S4.SS1.p3.2.m2.2.2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.2.2.3.1.cmml">∣</mo><mrow id="S4.SS1.p3.2.m2.2.2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.cmml"><msub id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p3.2.m2.2.2.2.2.2.2.1" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.2" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.3" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.3.cmml">d</mi></msup></mrow><mo stretchy="false" id="S4.SS1.p3.2.m2.2.2.2.2.2.5" xref="S4.SS1.p3.2.m2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="S4.SS1.p3.2.m2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.2.4.cmml"><msub id="S4.SS1.p3.2.m2.2.2.2.4.2" xref="S4.SS1.p3.2.m2.2.2.2.4.2.cmml"><mi id="S4.SS1.p3.2.m2.2.2.2.4.2.2" xref="S4.SS1.p3.2.m2.2.2.2.4.2.2.cmml">s</mi><mi id="S4.SS1.p3.2.m2.2.2.2.4.2.3" xref="S4.SS1.p3.2.m2.2.2.2.4.2.3.cmml">r</mi></msub><mo id="S4.SS1.p3.2.m2.2.2.2.4.3" xref="S4.SS1.p3.2.m2.2.2.2.4.3.cmml">≤</mo><mi id="S4.SS1.p3.2.m2.2.2.2.4.4" xref="S4.SS1.p3.2.m2.2.2.2.4.4.cmml">i</mi><mo id="S4.SS1.p3.2.m2.2.2.2.4.5" xref="S4.SS1.p3.2.m2.2.2.2.4.5.cmml">≤</mo><msub id="S4.SS1.p3.2.m2.2.2.2.4.6" xref="S4.SS1.p3.2.m2.2.2.2.4.6.cmml"><mi id="S4.SS1.p3.2.m2.2.2.2.4.6.2" xref="S4.SS1.p3.2.m2.2.2.2.4.6.2.cmml">e</mi><mi id="S4.SS1.p3.2.m2.2.2.2.4.6.3" xref="S4.SS1.p3.2.m2.2.2.2.4.6.3.cmml">r</mi></msub></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2"><eq id="S4.SS1.p3.2.m2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.3"></eq><apply id="S4.SS1.p3.2.m2.2.2.4.cmml" xref="S4.SS1.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.4.1.cmml" xref="S4.SS1.p3.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.4.2.cmml" xref="S4.SS1.p3.2.m2.2.2.4.2">𝐸</ci><ci id="S4.SS1.p3.2.m2.2.2.4.3.cmml" xref="S4.SS1.p3.2.m2.2.2.4.3">𝑟</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2">subscript</csymbol><apply id="S4.SS1.p3.2.m2.2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2"><csymbol cd="latexml" id="S4.SS1.p3.2.m2.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2"><in id="S4.SS1.p3.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.1"></in><apply id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.2">𝑤</ci><ci id="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.2">ℝ</ci><ci id="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></apply><apply id="S4.SS1.p3.2.m2.2.2.2.4.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><and id="S4.SS1.p3.2.m2.2.2.2.4a.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"></and><apply id="S4.SS1.p3.2.m2.2.2.2.4b.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><leq id="S4.SS1.p3.2.m2.2.2.2.4.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.3"></leq><apply id="S4.SS1.p3.2.m2.2.2.2.4.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.4.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.2.4.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.2.2">𝑠</ci><ci id="S4.SS1.p3.2.m2.2.2.2.4.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.2.3">𝑟</ci></apply><ci id="S4.SS1.p3.2.m2.2.2.2.4.4.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.4">𝑖</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.2.4c.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><leq id="S4.SS1.p3.2.m2.2.2.2.4.5.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.5"></leq><share href="#S4.SS1.p3.2.m2.2.2.2.4.4.cmml" id="S4.SS1.p3.2.m2.2.2.2.4d.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"></share><apply id="S4.SS1.p3.2.m2.2.2.2.4.6.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.6"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.4.6.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.6">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.2.4.6.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.6.2">𝑒</ci><ci id="S4.SS1.p3.2.m2.2.2.2.4.6.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4.6.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">E_{r}=\{w_{i}\mid w_{i}\in\mathbb{R}^{d}\}_{s_{r}\leq i\leq e_{r}}</annotation></semantics></math>
where <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="s_{r}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">s</mi><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝑠</ci><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">s_{r}</annotation></semantics></math> and <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="e_{r}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">e</mi><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑒</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">e_{r}</annotation></semantics></math> are the start and end word index of the
RE within the query <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="L=\left\{l_{i}\right\}_{i=1}^{T}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">L</mi><mo id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.cmml"><mrow id="S4.SS1.p3.5.m5.1.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p3.5.m5.1.1.1.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p3.5.m5.1.1.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p3.5.m5.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.5.m5.1.1.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.5.m5.1.1.1.1.3.1" xref="S4.SS1.p3.5.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p3.5.m5.1.1.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p3.5.m5.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><eq id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2"></eq><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝐿</ci><apply id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1">superscript</csymbol><apply id="S4.SS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1">subscript</csymbol><set id="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1"><apply id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p3.5.m5.1.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.3"><eq id="S4.SS1.p3.5.m5.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.3.1"></eq><ci id="S4.SS1.p3.5.m5.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS1.p3.5.m5.1.1.1.1.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p3.5.m5.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">L=\left\{l_{i}\right\}_{i=1}^{T}</annotation></semantics></math>. It has
length <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="m_{r}=e_{r}-s_{r}+1" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><mrow id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><msub id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2.2" xref="S4.SS1.p3.6.m6.1.1.2.2.cmml">m</mi><mi id="S4.SS1.p3.6.m6.1.1.2.3" xref="S4.SS1.p3.6.m6.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml"><mrow id="S4.SS1.p3.6.m6.1.1.3.2" xref="S4.SS1.p3.6.m6.1.1.3.2.cmml"><msub id="S4.SS1.p3.6.m6.1.1.3.2.2" xref="S4.SS1.p3.6.m6.1.1.3.2.2.cmml"><mi id="S4.SS1.p3.6.m6.1.1.3.2.2.2" xref="S4.SS1.p3.6.m6.1.1.3.2.2.2.cmml">e</mi><mi id="S4.SS1.p3.6.m6.1.1.3.2.2.3" xref="S4.SS1.p3.6.m6.1.1.3.2.2.3.cmml">r</mi></msub><mo id="S4.SS1.p3.6.m6.1.1.3.2.1" xref="S4.SS1.p3.6.m6.1.1.3.2.1.cmml">−</mo><msub id="S4.SS1.p3.6.m6.1.1.3.2.3" xref="S4.SS1.p3.6.m6.1.1.3.2.3.cmml"><mi id="S4.SS1.p3.6.m6.1.1.3.2.3.2" xref="S4.SS1.p3.6.m6.1.1.3.2.3.2.cmml">s</mi><mi id="S4.SS1.p3.6.m6.1.1.3.2.3.3" xref="S4.SS1.p3.6.m6.1.1.3.2.3.3.cmml">r</mi></msub></mrow><mo id="S4.SS1.p3.6.m6.1.1.3.1" xref="S4.SS1.p3.6.m6.1.1.3.1.cmml">+</mo><mn id="S4.SS1.p3.6.m6.1.1.3.3" xref="S4.SS1.p3.6.m6.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><eq id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1"></eq><apply id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.2.1.cmml" xref="S4.SS1.p3.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2.2">𝑚</ci><ci id="S4.SS1.p3.6.m6.1.1.2.3.cmml" xref="S4.SS1.p3.6.m6.1.1.2.3">𝑟</ci></apply><apply id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3"><plus id="S4.SS1.p3.6.m6.1.1.3.1.cmml" xref="S4.SS1.p3.6.m6.1.1.3.1"></plus><apply id="S4.SS1.p3.6.m6.1.1.3.2.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2"><minus id="S4.SS1.p3.6.m6.1.1.3.2.1.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.1"></minus><apply id="S4.SS1.p3.6.m6.1.1.3.2.2.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.3.2.2.1.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.2">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.3.2.2.2.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.2.2">𝑒</ci><ci id="S4.SS1.p3.6.m6.1.1.3.2.2.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.2.3">𝑟</ci></apply><apply id="S4.SS1.p3.6.m6.1.1.3.2.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.3.2.3.1.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.3">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.3.2.3.2.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.3.2">𝑠</ci><ci id="S4.SS1.p3.6.m6.1.1.3.2.3.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2.3.3">𝑟</ci></apply></apply><cn type="integer" id="S4.SS1.p3.6.m6.1.1.3.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">m_{r}=e_{r}-s_{r}+1</annotation></semantics></math>. We now estimate the correlation between
words in these REs and the visual regions <math id="S4.SS1.p3.7.m7.2" class="ltx_Math" alttext="V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d}\right\}_{j=1}^{N}" display="inline"><semantics id="S4.SS1.p3.7.m7.2a"><mrow id="S4.SS1.p3.7.m7.2.2" xref="S4.SS1.p3.7.m7.2.2.cmml"><mi id="S4.SS1.p3.7.m7.2.2.4" xref="S4.SS1.p3.7.m7.2.2.4.cmml">V</mi><mo id="S4.SS1.p3.7.m7.2.2.3" xref="S4.SS1.p3.7.m7.2.2.3.cmml">=</mo><msubsup id="S4.SS1.p3.7.m7.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.cmml"><mrow id="S4.SS1.p3.7.m7.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml"><mo id="S4.SS1.p3.7.m7.2.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.1.cmml">{</mo><msub id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.4" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.1.cmml">∣</mo><mrow id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.cmml"><msub id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.3.cmml">d</mi></msup></mrow><mo id="S4.SS1.p3.7.m7.2.2.2.2.2.2.5" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="S4.SS1.p3.7.m7.2.2.2.2.4" xref="S4.SS1.p3.7.m7.2.2.2.2.4.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.4.2" xref="S4.SS1.p3.7.m7.2.2.2.2.4.2.cmml">j</mi><mo id="S4.SS1.p3.7.m7.2.2.2.2.4.1" xref="S4.SS1.p3.7.m7.2.2.2.2.4.1.cmml">=</mo><mn id="S4.SS1.p3.7.m7.2.2.2.2.4.3" xref="S4.SS1.p3.7.m7.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S4.SS1.p3.7.m7.2.2.2.4" xref="S4.SS1.p3.7.m7.2.2.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.2b"><apply id="S4.SS1.p3.7.m7.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2"><eq id="S4.SS1.p3.7.m7.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.3"></eq><ci id="S4.SS1.p3.7.m7.2.2.4.cmml" xref="S4.SS1.p3.7.m7.2.2.4">𝑉</ci><apply id="S4.SS1.p3.7.m7.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2">superscript</csymbol><apply id="S4.SS1.p3.7.m7.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2">subscript</csymbol><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2"><csymbol cd="latexml" id="S4.SS1.p3.7.m7.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2"><in id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1"></in><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.2">ℝ</ci><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.4.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.4"><eq id="S4.SS1.p3.7.m7.2.2.2.2.4.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.4.1"></eq><ci id="S4.SS1.p3.7.m7.2.2.2.2.4.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.4.2">𝑗</ci><cn type="integer" id="S4.SS1.p3.7.m7.2.2.2.2.4.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.4.3">1</cn></apply></apply><ci id="S4.SS1.p3.7.m7.2.2.2.4.cmml" xref="S4.SS1.p3.7.m7.2.2.2.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.2c">V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d}\right\}_{j=1}^{N}</annotation></semantics></math>
by learning the neural association function <math id="S4.SS1.p3.8.m8.2" class="ltx_Math" alttext="g_{\delta}(V,E_{r})" display="inline"><semantics id="S4.SS1.p3.8.m8.2a"><mrow id="S4.SS1.p3.8.m8.2.2" xref="S4.SS1.p3.8.m8.2.2.cmml"><msub id="S4.SS1.p3.8.m8.2.2.3" xref="S4.SS1.p3.8.m8.2.2.3.cmml"><mi id="S4.SS1.p3.8.m8.2.2.3.2" xref="S4.SS1.p3.8.m8.2.2.3.2.cmml">g</mi><mi id="S4.SS1.p3.8.m8.2.2.3.3" xref="S4.SS1.p3.8.m8.2.2.3.3.cmml">δ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p3.8.m8.2.2.2" xref="S4.SS1.p3.8.m8.2.2.2.cmml">​</mo><mrow id="S4.SS1.p3.8.m8.2.2.1.1" xref="S4.SS1.p3.8.m8.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.8.m8.2.2.1.1.2" xref="S4.SS1.p3.8.m8.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml">V</mi><mo id="S4.SS1.p3.8.m8.2.2.1.1.3" xref="S4.SS1.p3.8.m8.2.2.1.2.cmml">,</mo><msub id="S4.SS1.p3.8.m8.2.2.1.1.1" xref="S4.SS1.p3.8.m8.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.8.m8.2.2.1.1.1.2" xref="S4.SS1.p3.8.m8.2.2.1.1.1.2.cmml">E</mi><mi id="S4.SS1.p3.8.m8.2.2.1.1.1.3" xref="S4.SS1.p3.8.m8.2.2.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="S4.SS1.p3.8.m8.2.2.1.1.4" xref="S4.SS1.p3.8.m8.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.2b"><apply id="S4.SS1.p3.8.m8.2.2.cmml" xref="S4.SS1.p3.8.m8.2.2"><times id="S4.SS1.p3.8.m8.2.2.2.cmml" xref="S4.SS1.p3.8.m8.2.2.2"></times><apply id="S4.SS1.p3.8.m8.2.2.3.cmml" xref="S4.SS1.p3.8.m8.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.2.2.3.1.cmml" xref="S4.SS1.p3.8.m8.2.2.3">subscript</csymbol><ci id="S4.SS1.p3.8.m8.2.2.3.2.cmml" xref="S4.SS1.p3.8.m8.2.2.3.2">𝑔</ci><ci id="S4.SS1.p3.8.m8.2.2.3.3.cmml" xref="S4.SS1.p3.8.m8.2.2.3.3">𝛿</ci></apply><interval closure="open" id="S4.SS1.p3.8.m8.2.2.1.2.cmml" xref="S4.SS1.p3.8.m8.2.2.1.1"><ci id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">𝑉</ci><apply id="S4.SS1.p3.8.m8.2.2.1.1.1.cmml" xref="S4.SS1.p3.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.2.2.1.1.1.1.cmml" xref="S4.SS1.p3.8.m8.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.8.m8.2.2.1.1.1.2.cmml" xref="S4.SS1.p3.8.m8.2.2.1.1.1.2">𝐸</ci><ci id="S4.SS1.p3.8.m8.2.2.1.1.1.3.cmml" xref="S4.SS1.p3.8.m8.2.2.1.1.1.3">𝑟</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.2c">g_{\delta}(V,E_{r})</annotation></semantics></math>
of parameter <math id="S4.SS1.p3.9.m9.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S4.SS1.p3.9.m9.1a"><mi id="S4.SS1.p3.9.m9.1.1" xref="S4.SS1.p3.9.m9.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m9.1b"><ci id="S4.SS1.p3.9.m9.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m9.1c">\delta</annotation></semantics></math> that generates a mapping <math id="S4.SS1.p3.10.m10.1" class="ltx_Math" alttext="A_{r}^{*}\in\mathbb{R}^{m_{r}\times N}" display="inline"><semantics id="S4.SS1.p3.10.m10.1a"><mrow id="S4.SS1.p3.10.m10.1.1" xref="S4.SS1.p3.10.m10.1.1.cmml"><msubsup id="S4.SS1.p3.10.m10.1.1.2" xref="S4.SS1.p3.10.m10.1.1.2.cmml"><mi id="S4.SS1.p3.10.m10.1.1.2.2.2" xref="S4.SS1.p3.10.m10.1.1.2.2.2.cmml">A</mi><mi id="S4.SS1.p3.10.m10.1.1.2.2.3" xref="S4.SS1.p3.10.m10.1.1.2.2.3.cmml">r</mi><mo id="S4.SS1.p3.10.m10.1.1.2.3" xref="S4.SS1.p3.10.m10.1.1.2.3.cmml">∗</mo></msubsup><mo id="S4.SS1.p3.10.m10.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.10.m10.1.1.3" xref="S4.SS1.p3.10.m10.1.1.3.cmml"><mi id="S4.SS1.p3.10.m10.1.1.3.2" xref="S4.SS1.p3.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.10.m10.1.1.3.3" xref="S4.SS1.p3.10.m10.1.1.3.3.cmml"><msub id="S4.SS1.p3.10.m10.1.1.3.3.2" xref="S4.SS1.p3.10.m10.1.1.3.3.2.cmml"><mi id="S4.SS1.p3.10.m10.1.1.3.3.2.2" xref="S4.SS1.p3.10.m10.1.1.3.3.2.2.cmml">m</mi><mi id="S4.SS1.p3.10.m10.1.1.3.3.2.3" xref="S4.SS1.p3.10.m10.1.1.3.3.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.10.m10.1.1.3.3.1" xref="S4.SS1.p3.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.10.m10.1.1.3.3.3" xref="S4.SS1.p3.10.m10.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m10.1b"><apply id="S4.SS1.p3.10.m10.1.1.cmml" xref="S4.SS1.p3.10.m10.1.1"><in id="S4.SS1.p3.10.m10.1.1.1.cmml" xref="S4.SS1.p3.10.m10.1.1.1"></in><apply id="S4.SS1.p3.10.m10.1.1.2.cmml" xref="S4.SS1.p3.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.2.1.cmml" xref="S4.SS1.p3.10.m10.1.1.2">superscript</csymbol><apply id="S4.SS1.p3.10.m10.1.1.2.2.cmml" xref="S4.SS1.p3.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.2.2.1.cmml" xref="S4.SS1.p3.10.m10.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.10.m10.1.1.2.2.2.cmml" xref="S4.SS1.p3.10.m10.1.1.2.2.2">𝐴</ci><ci id="S4.SS1.p3.10.m10.1.1.2.2.3.cmml" xref="S4.SS1.p3.10.m10.1.1.2.2.3">𝑟</ci></apply><times id="S4.SS1.p3.10.m10.1.1.2.3.cmml" xref="S4.SS1.p3.10.m10.1.1.2.3"></times></apply><apply id="S4.SS1.p3.10.m10.1.1.3.cmml" xref="S4.SS1.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.3.1.cmml" xref="S4.SS1.p3.10.m10.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.10.m10.1.1.3.2.cmml" xref="S4.SS1.p3.10.m10.1.1.3.2">ℝ</ci><apply id="S4.SS1.p3.10.m10.1.1.3.3.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3"><times id="S4.SS1.p3.10.m10.1.1.3.3.1.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.1"></times><apply id="S4.SS1.p3.10.m10.1.1.3.3.2.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m10.1.1.3.3.2.1.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p3.10.m10.1.1.3.3.2.2.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.2.2">𝑚</ci><ci id="S4.SS1.p3.10.m10.1.1.3.3.2.3.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.2.3">𝑟</ci></apply><ci id="S4.SS1.p3.10.m10.1.1.3.3.3.cmml" xref="S4.SS1.p3.10.m10.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m10.1c">A_{r}^{*}\in\mathbb{R}^{m_{r}\times N}</annotation></semantics></math>
between words in the RE and the corresponding visual regions.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.4" class="ltx_p">We implement <math id="S4.SS1.p4.1.m1.1" class="ltx_math_unparsed" alttext="g_{\delta}\left(.\right)" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1b"><msub id="S4.SS1.p4.1.m1.1.1"><mi id="S4.SS1.p4.1.m1.1.1.2">g</mi><mi id="S4.SS1.p4.1.m1.1.1.3">δ</mi></msub><mrow id="S4.SS1.p4.1.m1.1.2"><mo id="S4.SS1.p4.1.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS1.p4.1.m1.1.2.2">.</mo><mo id="S4.SS1.p4.1.m1.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">g_{\delta}\left(.\right)</annotation></semantics></math> as the dot products of a
contextualized embedding of word <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">w</mi><mi id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝑤</ci><ci id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">w_{i}</annotation></semantics></math> in <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="E_{r}" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><msub id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">E</mi><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝐸</ci><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">E_{r}</annotation></semantics></math> with the representations
of regions in <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">V</annotation></semantics></math>, following the scaled dot-product attention <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib44" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.14" class="ltx_p"><span id="S4.SS1.p5.14.1" class="ltx_text ltx_font_bold">Unsupervised training.</span> To train the function <math id="S4.SS1.p5.1.m1.1" class="ltx_math_unparsed" alttext="g_{\delta}\left(.\right)" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><mrow id="S4.SS1.p5.1.m1.1b"><msub id="S4.SS1.p5.1.m1.1.1"><mi id="S4.SS1.p5.1.m1.1.1.2">g</mi><mi id="S4.SS1.p5.1.m1.1.1.3">δ</mi></msub><mrow id="S4.SS1.p5.1.m1.1.2"><mo id="S4.SS1.p5.1.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS1.p5.1.m1.1.2.2">.</mo><mo id="S4.SS1.p5.1.m1.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">g_{\delta}\left(.\right)</annotation></semantics></math>,
we adapt the recent contrastive learning framework <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>
for phrase grounding to learn these word-region alignments from the
RE-image pairs in an unsupervised manner, i.e. without explicit word-region
annotations. In a mini batch <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><ci id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\mathcal{B}</annotation></semantics></math> of size <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><mi id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><ci id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">b</annotation></semantics></math>, we calculate
the positive mapping <math id="S4.SS1.p5.4.m4.4" class="ltx_Math" alttext="A_{r}^{*}=\left(a_{r,i,j}^{*}\right)\in\mathbb{R}^{m_{r}\times N}" display="inline"><semantics id="S4.SS1.p5.4.m4.4a"><mrow id="S4.SS1.p5.4.m4.4.4" xref="S4.SS1.p5.4.m4.4.4.cmml"><msubsup id="S4.SS1.p5.4.m4.4.4.3" xref="S4.SS1.p5.4.m4.4.4.3.cmml"><mi id="S4.SS1.p5.4.m4.4.4.3.2.2" xref="S4.SS1.p5.4.m4.4.4.3.2.2.cmml">A</mi><mi id="S4.SS1.p5.4.m4.4.4.3.2.3" xref="S4.SS1.p5.4.m4.4.4.3.2.3.cmml">r</mi><mo id="S4.SS1.p5.4.m4.4.4.3.3" xref="S4.SS1.p5.4.m4.4.4.3.3.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.4.m4.4.4.4" xref="S4.SS1.p5.4.m4.4.4.4.cmml">=</mo><mrow id="S4.SS1.p5.4.m4.4.4.1.1" xref="S4.SS1.p5.4.m4.4.4.1.1.1.cmml"><mo id="S4.SS1.p5.4.m4.4.4.1.1.2" xref="S4.SS1.p5.4.m4.4.4.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p5.4.m4.4.4.1.1.1" xref="S4.SS1.p5.4.m4.4.4.1.1.1.cmml"><mi id="S4.SS1.p5.4.m4.4.4.1.1.1.2.2" xref="S4.SS1.p5.4.m4.4.4.1.1.1.2.2.cmml">a</mi><mrow id="S4.SS1.p5.4.m4.3.3.3.5" xref="S4.SS1.p5.4.m4.3.3.3.4.cmml"><mi id="S4.SS1.p5.4.m4.1.1.1.1" xref="S4.SS1.p5.4.m4.1.1.1.1.cmml">r</mi><mo id="S4.SS1.p5.4.m4.3.3.3.5.1" xref="S4.SS1.p5.4.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p5.4.m4.2.2.2.2" xref="S4.SS1.p5.4.m4.2.2.2.2.cmml">i</mi><mo id="S4.SS1.p5.4.m4.3.3.3.5.2" xref="S4.SS1.p5.4.m4.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p5.4.m4.3.3.3.3" xref="S4.SS1.p5.4.m4.3.3.3.3.cmml">j</mi></mrow><mo id="S4.SS1.p5.4.m4.4.4.1.1.1.3" xref="S4.SS1.p5.4.m4.4.4.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.4.m4.4.4.1.1.3" xref="S4.SS1.p5.4.m4.4.4.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p5.4.m4.4.4.5" xref="S4.SS1.p5.4.m4.4.4.5.cmml">∈</mo><msup id="S4.SS1.p5.4.m4.4.4.6" xref="S4.SS1.p5.4.m4.4.4.6.cmml"><mi id="S4.SS1.p5.4.m4.4.4.6.2" xref="S4.SS1.p5.4.m4.4.4.6.2.cmml">ℝ</mi><mrow id="S4.SS1.p5.4.m4.4.4.6.3" xref="S4.SS1.p5.4.m4.4.4.6.3.cmml"><msub id="S4.SS1.p5.4.m4.4.4.6.3.2" xref="S4.SS1.p5.4.m4.4.4.6.3.2.cmml"><mi id="S4.SS1.p5.4.m4.4.4.6.3.2.2" xref="S4.SS1.p5.4.m4.4.4.6.3.2.2.cmml">m</mi><mi id="S4.SS1.p5.4.m4.4.4.6.3.2.3" xref="S4.SS1.p5.4.m4.4.4.6.3.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p5.4.m4.4.4.6.3.1" xref="S4.SS1.p5.4.m4.4.4.6.3.1.cmml">×</mo><mi id="S4.SS1.p5.4.m4.4.4.6.3.3" xref="S4.SS1.p5.4.m4.4.4.6.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.4b"><apply id="S4.SS1.p5.4.m4.4.4.cmml" xref="S4.SS1.p5.4.m4.4.4"><and id="S4.SS1.p5.4.m4.4.4a.cmml" xref="S4.SS1.p5.4.m4.4.4"></and><apply id="S4.SS1.p5.4.m4.4.4b.cmml" xref="S4.SS1.p5.4.m4.4.4"><eq id="S4.SS1.p5.4.m4.4.4.4.cmml" xref="S4.SS1.p5.4.m4.4.4.4"></eq><apply id="S4.SS1.p5.4.m4.4.4.3.cmml" xref="S4.SS1.p5.4.m4.4.4.3"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.3.1.cmml" xref="S4.SS1.p5.4.m4.4.4.3">superscript</csymbol><apply id="S4.SS1.p5.4.m4.4.4.3.2.cmml" xref="S4.SS1.p5.4.m4.4.4.3"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.3.2.1.cmml" xref="S4.SS1.p5.4.m4.4.4.3">subscript</csymbol><ci id="S4.SS1.p5.4.m4.4.4.3.2.2.cmml" xref="S4.SS1.p5.4.m4.4.4.3.2.2">𝐴</ci><ci id="S4.SS1.p5.4.m4.4.4.3.2.3.cmml" xref="S4.SS1.p5.4.m4.4.4.3.2.3">𝑟</ci></apply><times id="S4.SS1.p5.4.m4.4.4.3.3.cmml" xref="S4.SS1.p5.4.m4.4.4.3.3"></times></apply><apply id="S4.SS1.p5.4.m4.4.4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.1.1.1.1.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1">superscript</csymbol><apply id="S4.SS1.p5.4.m4.4.4.1.1.1.2.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.1.1.1.2.1.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1">subscript</csymbol><ci id="S4.SS1.p5.4.m4.4.4.1.1.1.2.2.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1.1.2.2">𝑎</ci><list id="S4.SS1.p5.4.m4.3.3.3.4.cmml" xref="S4.SS1.p5.4.m4.3.3.3.5"><ci id="S4.SS1.p5.4.m4.1.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1.1.1">𝑟</ci><ci id="S4.SS1.p5.4.m4.2.2.2.2.cmml" xref="S4.SS1.p5.4.m4.2.2.2.2">𝑖</ci><ci id="S4.SS1.p5.4.m4.3.3.3.3.cmml" xref="S4.SS1.p5.4.m4.3.3.3.3">𝑗</ci></list></apply><times id="S4.SS1.p5.4.m4.4.4.1.1.1.3.cmml" xref="S4.SS1.p5.4.m4.4.4.1.1.1.3"></times></apply></apply><apply id="S4.SS1.p5.4.m4.4.4c.cmml" xref="S4.SS1.p5.4.m4.4.4"><in id="S4.SS1.p5.4.m4.4.4.5.cmml" xref="S4.SS1.p5.4.m4.4.4.5"></in><share href="#S4.SS1.p5.4.m4.4.4.1.cmml" id="S4.SS1.p5.4.m4.4.4d.cmml" xref="S4.SS1.p5.4.m4.4.4"></share><apply id="S4.SS1.p5.4.m4.4.4.6.cmml" xref="S4.SS1.p5.4.m4.4.4.6"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.6.1.cmml" xref="S4.SS1.p5.4.m4.4.4.6">superscript</csymbol><ci id="S4.SS1.p5.4.m4.4.4.6.2.cmml" xref="S4.SS1.p5.4.m4.4.4.6.2">ℝ</ci><apply id="S4.SS1.p5.4.m4.4.4.6.3.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3"><times id="S4.SS1.p5.4.m4.4.4.6.3.1.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.1"></times><apply id="S4.SS1.p5.4.m4.4.4.6.3.2.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.2"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.4.4.6.3.2.1.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.2">subscript</csymbol><ci id="S4.SS1.p5.4.m4.4.4.6.3.2.2.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.2.2">𝑚</ci><ci id="S4.SS1.p5.4.m4.4.4.6.3.2.3.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.2.3">𝑟</ci></apply><ci id="S4.SS1.p5.4.m4.4.4.6.3.3.cmml" xref="S4.SS1.p5.4.m4.4.4.6.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.4c">A_{r}^{*}=\left(a_{r,i,j}^{*}\right)\in\mathbb{R}^{m_{r}\times N}</annotation></semantics></math>
on one positive sample (the RE <math id="S4.SS1.p5.5.m5.1" class="ltx_Math" alttext="E_{r}" display="inline"><semantics id="S4.SS1.p5.5.m5.1a"><msub id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.2" xref="S4.SS1.p5.5.m5.1.1.2.cmml">E</mi><mi id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.2">𝐸</ci><ci id="S4.SS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">E_{r}</annotation></semantics></math> and the image regions <math id="S4.SS1.p5.6.m6.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS1.p5.6.m6.1a"><mi id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><ci id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">V</annotation></semantics></math>
in the image that is paired with it) and <math id="S4.SS1.p5.7.m7.1" class="ltx_Math" alttext="(b-1)" display="inline"><semantics id="S4.SS1.p5.7.m7.1a"><mrow id="S4.SS1.p5.7.m7.1.1.1" xref="S4.SS1.p5.7.m7.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p5.7.m7.1.1.1.2" xref="S4.SS1.p5.7.m7.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p5.7.m7.1.1.1.1" xref="S4.SS1.p5.7.m7.1.1.1.1.cmml"><mi id="S4.SS1.p5.7.m7.1.1.1.1.2" xref="S4.SS1.p5.7.m7.1.1.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.7.m7.1.1.1.1.1" xref="S4.SS1.p5.7.m7.1.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p5.7.m7.1.1.1.1.3" xref="S4.SS1.p5.7.m7.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p5.7.m7.1.1.1.3" xref="S4.SS1.p5.7.m7.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.1b"><apply id="S4.SS1.p5.7.m7.1.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1.1"><minus id="S4.SS1.p5.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1.1.1.1"></minus><ci id="S4.SS1.p5.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.p5.7.m7.1.1.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p5.7.m7.1.1.1.1.3.cmml" xref="S4.SS1.p5.7.m7.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.1c">(b-1)</annotation></semantics></math> negative mappings
<math id="S4.SS1.p5.8.m8.6" class="ltx_Math" alttext="\overline{A_{r,s}^{*}}=\left(\overline{a_{r,s,i,j}^{*}}\right)\in\mathbb{R}^{m_{r}\times N}" display="inline"><semantics id="S4.SS1.p5.8.m8.6a"><mrow id="S4.SS1.p5.8.m8.6.7" xref="S4.SS1.p5.8.m8.6.7.cmml"><mover accent="true" id="S4.SS1.p5.8.m8.2.2" xref="S4.SS1.p5.8.m8.2.2.cmml"><msubsup id="S4.SS1.p5.8.m8.2.2.2" xref="S4.SS1.p5.8.m8.2.2.2.cmml"><mi id="S4.SS1.p5.8.m8.2.2.2.4.2" xref="S4.SS1.p5.8.m8.2.2.2.4.2.cmml">A</mi><mrow id="S4.SS1.p5.8.m8.2.2.2.2.2.4" xref="S4.SS1.p5.8.m8.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p5.8.m8.1.1.1.1.1.1" xref="S4.SS1.p5.8.m8.1.1.1.1.1.1.cmml">r</mi><mo id="S4.SS1.p5.8.m8.2.2.2.2.2.4.1" xref="S4.SS1.p5.8.m8.2.2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.8.m8.2.2.2.2.2.2" xref="S4.SS1.p5.8.m8.2.2.2.2.2.2.cmml">s</mi></mrow><mo id="S4.SS1.p5.8.m8.2.2.2.5" xref="S4.SS1.p5.8.m8.2.2.2.5.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.8.m8.2.2.3" xref="S4.SS1.p5.8.m8.2.2.3.cmml">¯</mo></mover><mo id="S4.SS1.p5.8.m8.6.7.2" xref="S4.SS1.p5.8.m8.6.7.2.cmml">=</mo><mrow id="S4.SS1.p5.8.m8.6.7.3.2" xref="S4.SS1.p5.8.m8.6.6.cmml"><mo id="S4.SS1.p5.8.m8.6.7.3.2.1" xref="S4.SS1.p5.8.m8.6.6.cmml">(</mo><mover accent="true" id="S4.SS1.p5.8.m8.6.6" xref="S4.SS1.p5.8.m8.6.6.cmml"><msubsup id="S4.SS1.p5.8.m8.6.6.4" xref="S4.SS1.p5.8.m8.6.6.4.cmml"><mi id="S4.SS1.p5.8.m8.6.6.4.6.2" xref="S4.SS1.p5.8.m8.6.6.4.6.2.cmml">a</mi><mrow id="S4.SS1.p5.8.m8.6.6.4.4.4.6" xref="S4.SS1.p5.8.m8.6.6.4.4.4.5.cmml"><mi id="S4.SS1.p5.8.m8.3.3.1.1.1.1" xref="S4.SS1.p5.8.m8.3.3.1.1.1.1.cmml">r</mi><mo id="S4.SS1.p5.8.m8.6.6.4.4.4.6.1" xref="S4.SS1.p5.8.m8.6.6.4.4.4.5.cmml">,</mo><mi id="S4.SS1.p5.8.m8.4.4.2.2.2.2" xref="S4.SS1.p5.8.m8.4.4.2.2.2.2.cmml">s</mi><mo id="S4.SS1.p5.8.m8.6.6.4.4.4.6.2" xref="S4.SS1.p5.8.m8.6.6.4.4.4.5.cmml">,</mo><mi id="S4.SS1.p5.8.m8.5.5.3.3.3.3" xref="S4.SS1.p5.8.m8.5.5.3.3.3.3.cmml">i</mi><mo id="S4.SS1.p5.8.m8.6.6.4.4.4.6.3" xref="S4.SS1.p5.8.m8.6.6.4.4.4.5.cmml">,</mo><mi id="S4.SS1.p5.8.m8.6.6.4.4.4.4" xref="S4.SS1.p5.8.m8.6.6.4.4.4.4.cmml">j</mi></mrow><mo id="S4.SS1.p5.8.m8.6.6.4.7" xref="S4.SS1.p5.8.m8.6.6.4.7.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.8.m8.6.6.5" xref="S4.SS1.p5.8.m8.6.6.5.cmml">¯</mo></mover><mo id="S4.SS1.p5.8.m8.6.7.3.2.2" xref="S4.SS1.p5.8.m8.6.6.cmml">)</mo></mrow><mo id="S4.SS1.p5.8.m8.6.7.4" xref="S4.SS1.p5.8.m8.6.7.4.cmml">∈</mo><msup id="S4.SS1.p5.8.m8.6.7.5" xref="S4.SS1.p5.8.m8.6.7.5.cmml"><mi id="S4.SS1.p5.8.m8.6.7.5.2" xref="S4.SS1.p5.8.m8.6.7.5.2.cmml">ℝ</mi><mrow id="S4.SS1.p5.8.m8.6.7.5.3" xref="S4.SS1.p5.8.m8.6.7.5.3.cmml"><msub id="S4.SS1.p5.8.m8.6.7.5.3.2" xref="S4.SS1.p5.8.m8.6.7.5.3.2.cmml"><mi id="S4.SS1.p5.8.m8.6.7.5.3.2.2" xref="S4.SS1.p5.8.m8.6.7.5.3.2.2.cmml">m</mi><mi id="S4.SS1.p5.8.m8.6.7.5.3.2.3" xref="S4.SS1.p5.8.m8.6.7.5.3.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p5.8.m8.6.7.5.3.1" xref="S4.SS1.p5.8.m8.6.7.5.3.1.cmml">×</mo><mi id="S4.SS1.p5.8.m8.6.7.5.3.3" xref="S4.SS1.p5.8.m8.6.7.5.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.6b"><apply id="S4.SS1.p5.8.m8.6.7.cmml" xref="S4.SS1.p5.8.m8.6.7"><and id="S4.SS1.p5.8.m8.6.7a.cmml" xref="S4.SS1.p5.8.m8.6.7"></and><apply id="S4.SS1.p5.8.m8.6.7b.cmml" xref="S4.SS1.p5.8.m8.6.7"><eq id="S4.SS1.p5.8.m8.6.7.2.cmml" xref="S4.SS1.p5.8.m8.6.7.2"></eq><apply id="S4.SS1.p5.8.m8.2.2.cmml" xref="S4.SS1.p5.8.m8.2.2"><ci id="S4.SS1.p5.8.m8.2.2.3.cmml" xref="S4.SS1.p5.8.m8.2.2.3">¯</ci><apply id="S4.SS1.p5.8.m8.2.2.2.cmml" xref="S4.SS1.p5.8.m8.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.2.2.2.3.cmml" xref="S4.SS1.p5.8.m8.2.2.2">superscript</csymbol><apply id="S4.SS1.p5.8.m8.2.2.2.4.cmml" xref="S4.SS1.p5.8.m8.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.2.2.2.4.1.cmml" xref="S4.SS1.p5.8.m8.2.2.2">subscript</csymbol><ci id="S4.SS1.p5.8.m8.2.2.2.4.2.cmml" xref="S4.SS1.p5.8.m8.2.2.2.4.2">𝐴</ci><list id="S4.SS1.p5.8.m8.2.2.2.2.2.3.cmml" xref="S4.SS1.p5.8.m8.2.2.2.2.2.4"><ci id="S4.SS1.p5.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1.1.1.1.1">𝑟</ci><ci id="S4.SS1.p5.8.m8.2.2.2.2.2.2.cmml" xref="S4.SS1.p5.8.m8.2.2.2.2.2.2">𝑠</ci></list></apply><times id="S4.SS1.p5.8.m8.2.2.2.5.cmml" xref="S4.SS1.p5.8.m8.2.2.2.5"></times></apply></apply><apply id="S4.SS1.p5.8.m8.6.6.cmml" xref="S4.SS1.p5.8.m8.6.7.3.2"><ci id="S4.SS1.p5.8.m8.6.6.5.cmml" xref="S4.SS1.p5.8.m8.6.6.5">¯</ci><apply id="S4.SS1.p5.8.m8.6.6.4.cmml" xref="S4.SS1.p5.8.m8.6.6.4"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.6.6.4.5.cmml" xref="S4.SS1.p5.8.m8.6.6.4">superscript</csymbol><apply id="S4.SS1.p5.8.m8.6.6.4.6.cmml" xref="S4.SS1.p5.8.m8.6.6.4"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.6.6.4.6.1.cmml" xref="S4.SS1.p5.8.m8.6.6.4">subscript</csymbol><ci id="S4.SS1.p5.8.m8.6.6.4.6.2.cmml" xref="S4.SS1.p5.8.m8.6.6.4.6.2">𝑎</ci><list id="S4.SS1.p5.8.m8.6.6.4.4.4.5.cmml" xref="S4.SS1.p5.8.m8.6.6.4.4.4.6"><ci id="S4.SS1.p5.8.m8.3.3.1.1.1.1.cmml" xref="S4.SS1.p5.8.m8.3.3.1.1.1.1">𝑟</ci><ci id="S4.SS1.p5.8.m8.4.4.2.2.2.2.cmml" xref="S4.SS1.p5.8.m8.4.4.2.2.2.2">𝑠</ci><ci id="S4.SS1.p5.8.m8.5.5.3.3.3.3.cmml" xref="S4.SS1.p5.8.m8.5.5.3.3.3.3">𝑖</ci><ci id="S4.SS1.p5.8.m8.6.6.4.4.4.4.cmml" xref="S4.SS1.p5.8.m8.6.6.4.4.4.4">𝑗</ci></list></apply><times id="S4.SS1.p5.8.m8.6.6.4.7.cmml" xref="S4.SS1.p5.8.m8.6.6.4.7"></times></apply></apply></apply><apply id="S4.SS1.p5.8.m8.6.7c.cmml" xref="S4.SS1.p5.8.m8.6.7"><in id="S4.SS1.p5.8.m8.6.7.4.cmml" xref="S4.SS1.p5.8.m8.6.7.4"></in><share href="#S4.SS1.p5.8.m8.6.7.3.cmml" id="S4.SS1.p5.8.m8.6.7d.cmml" xref="S4.SS1.p5.8.m8.6.7"></share><apply id="S4.SS1.p5.8.m8.6.7.5.cmml" xref="S4.SS1.p5.8.m8.6.7.5"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.6.7.5.1.cmml" xref="S4.SS1.p5.8.m8.6.7.5">superscript</csymbol><ci id="S4.SS1.p5.8.m8.6.7.5.2.cmml" xref="S4.SS1.p5.8.m8.6.7.5.2">ℝ</ci><apply id="S4.SS1.p5.8.m8.6.7.5.3.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3"><times id="S4.SS1.p5.8.m8.6.7.5.3.1.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.1"></times><apply id="S4.SS1.p5.8.m8.6.7.5.3.2.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.2"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.6.7.5.3.2.1.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.2">subscript</csymbol><ci id="S4.SS1.p5.8.m8.6.7.5.3.2.2.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.2.2">𝑚</ci><ci id="S4.SS1.p5.8.m8.6.7.5.3.2.3.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.2.3">𝑟</ci></apply><ci id="S4.SS1.p5.8.m8.6.7.5.3.3.cmml" xref="S4.SS1.p5.8.m8.6.7.5.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.6c">\overline{A_{r,s}^{*}}=\left(\overline{a_{r,s,i,j}^{*}}\right)\in\mathbb{R}^{m_{r}\times N}</annotation></semantics></math>
where <math id="S4.SS1.p5.9.m9.1" class="ltx_Math" alttext="1\leq s\leq(b-1)" display="inline"><semantics id="S4.SS1.p5.9.m9.1a"><mrow id="S4.SS1.p5.9.m9.1.1" xref="S4.SS1.p5.9.m9.1.1.cmml"><mn id="S4.SS1.p5.9.m9.1.1.3" xref="S4.SS1.p5.9.m9.1.1.3.cmml">1</mn><mo id="S4.SS1.p5.9.m9.1.1.4" xref="S4.SS1.p5.9.m9.1.1.4.cmml">≤</mo><mi id="S4.SS1.p5.9.m9.1.1.5" xref="S4.SS1.p5.9.m9.1.1.5.cmml">s</mi><mo id="S4.SS1.p5.9.m9.1.1.6" xref="S4.SS1.p5.9.m9.1.1.6.cmml">≤</mo><mrow id="S4.SS1.p5.9.m9.1.1.1.1" xref="S4.SS1.p5.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p5.9.m9.1.1.1.1.2" xref="S4.SS1.p5.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p5.9.m9.1.1.1.1.1" xref="S4.SS1.p5.9.m9.1.1.1.1.1.cmml"><mi id="S4.SS1.p5.9.m9.1.1.1.1.1.2" xref="S4.SS1.p5.9.m9.1.1.1.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.9.m9.1.1.1.1.1.1" xref="S4.SS1.p5.9.m9.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p5.9.m9.1.1.1.1.1.3" xref="S4.SS1.p5.9.m9.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p5.9.m9.1.1.1.1.3" xref="S4.SS1.p5.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.1b"><apply id="S4.SS1.p5.9.m9.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1"><and id="S4.SS1.p5.9.m9.1.1a.cmml" xref="S4.SS1.p5.9.m9.1.1"></and><apply id="S4.SS1.p5.9.m9.1.1b.cmml" xref="S4.SS1.p5.9.m9.1.1"><leq id="S4.SS1.p5.9.m9.1.1.4.cmml" xref="S4.SS1.p5.9.m9.1.1.4"></leq><cn type="integer" id="S4.SS1.p5.9.m9.1.1.3.cmml" xref="S4.SS1.p5.9.m9.1.1.3">1</cn><ci id="S4.SS1.p5.9.m9.1.1.5.cmml" xref="S4.SS1.p5.9.m9.1.1.5">𝑠</ci></apply><apply id="S4.SS1.p5.9.m9.1.1c.cmml" xref="S4.SS1.p5.9.m9.1.1"><leq id="S4.SS1.p5.9.m9.1.1.6.cmml" xref="S4.SS1.p5.9.m9.1.1.6"></leq><share href="#S4.SS1.p5.9.m9.1.1.5.cmml" id="S4.SS1.p5.9.m9.1.1d.cmml" xref="S4.SS1.p5.9.m9.1.1"></share><apply id="S4.SS1.p5.9.m9.1.1.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1"><minus id="S4.SS1.p5.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1.1.1"></minus><ci id="S4.SS1.p5.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p5.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS1.p5.9.m9.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.1c">1\leq s\leq(b-1)</annotation></semantics></math> from negative samples (the RE <math id="S4.SS1.p5.10.m10.1" class="ltx_Math" alttext="E_{r}" display="inline"><semantics id="S4.SS1.p5.10.m10.1a"><msub id="S4.SS1.p5.10.m10.1.1" xref="S4.SS1.p5.10.m10.1.1.cmml"><mi id="S4.SS1.p5.10.m10.1.1.2" xref="S4.SS1.p5.10.m10.1.1.2.cmml">E</mi><mi id="S4.SS1.p5.10.m10.1.1.3" xref="S4.SS1.p5.10.m10.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.10.m10.1b"><apply id="S4.SS1.p5.10.m10.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.10.m10.1.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p5.10.m10.1.1.2.cmml" xref="S4.SS1.p5.10.m10.1.1.2">𝐸</ci><ci id="S4.SS1.p5.10.m10.1.1.3.cmml" xref="S4.SS1.p5.10.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.10.m10.1c">E_{r}</annotation></semantics></math> and
negative image regions <math id="S4.SS1.p5.11.m11.3" class="ltx_Math" alttext="V_{s}^{\prime}=\{v_{s,j}^{\prime}\}" display="inline"><semantics id="S4.SS1.p5.11.m11.3a"><mrow id="S4.SS1.p5.11.m11.3.3" xref="S4.SS1.p5.11.m11.3.3.cmml"><msubsup id="S4.SS1.p5.11.m11.3.3.3" xref="S4.SS1.p5.11.m11.3.3.3.cmml"><mi id="S4.SS1.p5.11.m11.3.3.3.2.2" xref="S4.SS1.p5.11.m11.3.3.3.2.2.cmml">V</mi><mi id="S4.SS1.p5.11.m11.3.3.3.2.3" xref="S4.SS1.p5.11.m11.3.3.3.2.3.cmml">s</mi><mo id="S4.SS1.p5.11.m11.3.3.3.3" xref="S4.SS1.p5.11.m11.3.3.3.3.cmml">′</mo></msubsup><mo id="S4.SS1.p5.11.m11.3.3.2" xref="S4.SS1.p5.11.m11.3.3.2.cmml">=</mo><mrow id="S4.SS1.p5.11.m11.3.3.1.1" xref="S4.SS1.p5.11.m11.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p5.11.m11.3.3.1.1.2" xref="S4.SS1.p5.11.m11.3.3.1.2.cmml">{</mo><msubsup id="S4.SS1.p5.11.m11.3.3.1.1.1" xref="S4.SS1.p5.11.m11.3.3.1.1.1.cmml"><mi id="S4.SS1.p5.11.m11.3.3.1.1.1.2.2" xref="S4.SS1.p5.11.m11.3.3.1.1.1.2.2.cmml">v</mi><mrow id="S4.SS1.p5.11.m11.2.2.2.4" xref="S4.SS1.p5.11.m11.2.2.2.3.cmml"><mi id="S4.SS1.p5.11.m11.1.1.1.1" xref="S4.SS1.p5.11.m11.1.1.1.1.cmml">s</mi><mo id="S4.SS1.p5.11.m11.2.2.2.4.1" xref="S4.SS1.p5.11.m11.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.11.m11.2.2.2.2" xref="S4.SS1.p5.11.m11.2.2.2.2.cmml">j</mi></mrow><mo id="S4.SS1.p5.11.m11.3.3.1.1.1.3" xref="S4.SS1.p5.11.m11.3.3.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.SS1.p5.11.m11.3.3.1.1.3" xref="S4.SS1.p5.11.m11.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.11.m11.3b"><apply id="S4.SS1.p5.11.m11.3.3.cmml" xref="S4.SS1.p5.11.m11.3.3"><eq id="S4.SS1.p5.11.m11.3.3.2.cmml" xref="S4.SS1.p5.11.m11.3.3.2"></eq><apply id="S4.SS1.p5.11.m11.3.3.3.cmml" xref="S4.SS1.p5.11.m11.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.11.m11.3.3.3.1.cmml" xref="S4.SS1.p5.11.m11.3.3.3">superscript</csymbol><apply id="S4.SS1.p5.11.m11.3.3.3.2.cmml" xref="S4.SS1.p5.11.m11.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.11.m11.3.3.3.2.1.cmml" xref="S4.SS1.p5.11.m11.3.3.3">subscript</csymbol><ci id="S4.SS1.p5.11.m11.3.3.3.2.2.cmml" xref="S4.SS1.p5.11.m11.3.3.3.2.2">𝑉</ci><ci id="S4.SS1.p5.11.m11.3.3.3.2.3.cmml" xref="S4.SS1.p5.11.m11.3.3.3.2.3">𝑠</ci></apply><ci id="S4.SS1.p5.11.m11.3.3.3.3.cmml" xref="S4.SS1.p5.11.m11.3.3.3.3">′</ci></apply><set id="S4.SS1.p5.11.m11.3.3.1.2.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1"><apply id="S4.SS1.p5.11.m11.3.3.1.1.1.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.11.m11.3.3.1.1.1.1.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1">superscript</csymbol><apply id="S4.SS1.p5.11.m11.3.3.1.1.1.2.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.11.m11.3.3.1.1.1.2.1.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.p5.11.m11.3.3.1.1.1.2.2.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1.2.2">𝑣</ci><list id="S4.SS1.p5.11.m11.2.2.2.3.cmml" xref="S4.SS1.p5.11.m11.2.2.2.4"><ci id="S4.SS1.p5.11.m11.1.1.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1.1.1">𝑠</ci><ci id="S4.SS1.p5.11.m11.2.2.2.2.cmml" xref="S4.SS1.p5.11.m11.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS1.p5.11.m11.3.3.1.1.1.3.cmml" xref="S4.SS1.p5.11.m11.3.3.1.1.1.3">′</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.11.m11.3c">V_{s}^{\prime}=\{v_{s,j}^{\prime}\}</annotation></semantics></math> from
images that are not paired with it). We then compute linguistic-induced
visual representations <math id="S4.SS1.p5.12.m12.1" class="ltx_Math" alttext="v_{i}^{*}\in\mathbb{R}^{d}" display="inline"><semantics id="S4.SS1.p5.12.m12.1a"><mrow id="S4.SS1.p5.12.m12.1.1" xref="S4.SS1.p5.12.m12.1.1.cmml"><msubsup id="S4.SS1.p5.12.m12.1.1.2" xref="S4.SS1.p5.12.m12.1.1.2.cmml"><mi id="S4.SS1.p5.12.m12.1.1.2.2.2" xref="S4.SS1.p5.12.m12.1.1.2.2.2.cmml">v</mi><mi id="S4.SS1.p5.12.m12.1.1.2.2.3" xref="S4.SS1.p5.12.m12.1.1.2.2.3.cmml">i</mi><mo id="S4.SS1.p5.12.m12.1.1.2.3" xref="S4.SS1.p5.12.m12.1.1.2.3.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.12.m12.1.1.1" xref="S4.SS1.p5.12.m12.1.1.1.cmml">∈</mo><msup id="S4.SS1.p5.12.m12.1.1.3" xref="S4.SS1.p5.12.m12.1.1.3.cmml"><mi id="S4.SS1.p5.12.m12.1.1.3.2" xref="S4.SS1.p5.12.m12.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p5.12.m12.1.1.3.3" xref="S4.SS1.p5.12.m12.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.12.m12.1b"><apply id="S4.SS1.p5.12.m12.1.1.cmml" xref="S4.SS1.p5.12.m12.1.1"><in id="S4.SS1.p5.12.m12.1.1.1.cmml" xref="S4.SS1.p5.12.m12.1.1.1"></in><apply id="S4.SS1.p5.12.m12.1.1.2.cmml" xref="S4.SS1.p5.12.m12.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.12.m12.1.1.2.1.cmml" xref="S4.SS1.p5.12.m12.1.1.2">superscript</csymbol><apply id="S4.SS1.p5.12.m12.1.1.2.2.cmml" xref="S4.SS1.p5.12.m12.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.12.m12.1.1.2.2.1.cmml" xref="S4.SS1.p5.12.m12.1.1.2">subscript</csymbol><ci id="S4.SS1.p5.12.m12.1.1.2.2.2.cmml" xref="S4.SS1.p5.12.m12.1.1.2.2.2">𝑣</ci><ci id="S4.SS1.p5.12.m12.1.1.2.2.3.cmml" xref="S4.SS1.p5.12.m12.1.1.2.2.3">𝑖</ci></apply><times id="S4.SS1.p5.12.m12.1.1.2.3.cmml" xref="S4.SS1.p5.12.m12.1.1.2.3"></times></apply><apply id="S4.SS1.p5.12.m12.1.1.3.cmml" xref="S4.SS1.p5.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p5.12.m12.1.1.3.1.cmml" xref="S4.SS1.p5.12.m12.1.1.3">superscript</csymbol><ci id="S4.SS1.p5.12.m12.1.1.3.2.cmml" xref="S4.SS1.p5.12.m12.1.1.3.2">ℝ</ci><ci id="S4.SS1.p5.12.m12.1.1.3.3.cmml" xref="S4.SS1.p5.12.m12.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.12.m12.1c">v_{i}^{*}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="S4.SS1.p5.13.m13.2" class="ltx_Math" alttext="\overline{v_{s,i}^{*}}\in\mathbb{R}^{d}" display="inline"><semantics id="S4.SS1.p5.13.m13.2a"><mrow id="S4.SS1.p5.13.m13.2.3" xref="S4.SS1.p5.13.m13.2.3.cmml"><mover accent="true" id="S4.SS1.p5.13.m13.2.2" xref="S4.SS1.p5.13.m13.2.2.cmml"><msubsup id="S4.SS1.p5.13.m13.2.2.2" xref="S4.SS1.p5.13.m13.2.2.2.cmml"><mi id="S4.SS1.p5.13.m13.2.2.2.4.2" xref="S4.SS1.p5.13.m13.2.2.2.4.2.cmml">v</mi><mrow id="S4.SS1.p5.13.m13.2.2.2.2.2.4" xref="S4.SS1.p5.13.m13.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p5.13.m13.1.1.1.1.1.1" xref="S4.SS1.p5.13.m13.1.1.1.1.1.1.cmml">s</mi><mo id="S4.SS1.p5.13.m13.2.2.2.2.2.4.1" xref="S4.SS1.p5.13.m13.2.2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.13.m13.2.2.2.2.2.2" xref="S4.SS1.p5.13.m13.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="S4.SS1.p5.13.m13.2.2.2.5" xref="S4.SS1.p5.13.m13.2.2.2.5.cmml">∗</mo></msubsup><mo id="S4.SS1.p5.13.m13.2.2.3" xref="S4.SS1.p5.13.m13.2.2.3.cmml">¯</mo></mover><mo id="S4.SS1.p5.13.m13.2.3.1" xref="S4.SS1.p5.13.m13.2.3.1.cmml">∈</mo><msup id="S4.SS1.p5.13.m13.2.3.2" xref="S4.SS1.p5.13.m13.2.3.2.cmml"><mi id="S4.SS1.p5.13.m13.2.3.2.2" xref="S4.SS1.p5.13.m13.2.3.2.2.cmml">ℝ</mi><mi id="S4.SS1.p5.13.m13.2.3.2.3" xref="S4.SS1.p5.13.m13.2.3.2.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.13.m13.2b"><apply id="S4.SS1.p5.13.m13.2.3.cmml" xref="S4.SS1.p5.13.m13.2.3"><in id="S4.SS1.p5.13.m13.2.3.1.cmml" xref="S4.SS1.p5.13.m13.2.3.1"></in><apply id="S4.SS1.p5.13.m13.2.2.cmml" xref="S4.SS1.p5.13.m13.2.2"><ci id="S4.SS1.p5.13.m13.2.2.3.cmml" xref="S4.SS1.p5.13.m13.2.2.3">¯</ci><apply id="S4.SS1.p5.13.m13.2.2.2.cmml" xref="S4.SS1.p5.13.m13.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.13.m13.2.2.2.3.cmml" xref="S4.SS1.p5.13.m13.2.2.2">superscript</csymbol><apply id="S4.SS1.p5.13.m13.2.2.2.4.cmml" xref="S4.SS1.p5.13.m13.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.13.m13.2.2.2.4.1.cmml" xref="S4.SS1.p5.13.m13.2.2.2">subscript</csymbol><ci id="S4.SS1.p5.13.m13.2.2.2.4.2.cmml" xref="S4.SS1.p5.13.m13.2.2.2.4.2">𝑣</ci><list id="S4.SS1.p5.13.m13.2.2.2.2.2.3.cmml" xref="S4.SS1.p5.13.m13.2.2.2.2.2.4"><ci id="S4.SS1.p5.13.m13.1.1.1.1.1.1.cmml" xref="S4.SS1.p5.13.m13.1.1.1.1.1.1">𝑠</ci><ci id="S4.SS1.p5.13.m13.2.2.2.2.2.2.cmml" xref="S4.SS1.p5.13.m13.2.2.2.2.2.2">𝑖</ci></list></apply><times id="S4.SS1.p5.13.m13.2.2.2.5.cmml" xref="S4.SS1.p5.13.m13.2.2.2.5"></times></apply></apply><apply id="S4.SS1.p5.13.m13.2.3.2.cmml" xref="S4.SS1.p5.13.m13.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p5.13.m13.2.3.2.1.cmml" xref="S4.SS1.p5.13.m13.2.3.2">superscript</csymbol><ci id="S4.SS1.p5.13.m13.2.3.2.2.cmml" xref="S4.SS1.p5.13.m13.2.3.2.2">ℝ</ci><ci id="S4.SS1.p5.13.m13.2.3.2.3.cmml" xref="S4.SS1.p5.13.m13.2.3.2.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.13.m13.2c">\overline{v_{s,i}^{*}}\in\mathbb{R}^{d}</annotation></semantics></math>
over regions for each word <math id="S4.SS1.p5.14.m14.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS1.p5.14.m14.1a"><msub id="S4.SS1.p5.14.m14.1.1" xref="S4.SS1.p5.14.m14.1.1.cmml"><mi id="S4.SS1.p5.14.m14.1.1.2" xref="S4.SS1.p5.14.m14.1.1.2.cmml">w</mi><mi id="S4.SS1.p5.14.m14.1.1.3" xref="S4.SS1.p5.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.14.m14.1b"><apply id="S4.SS1.p5.14.m14.1.1.cmml" xref="S4.SS1.p5.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.14.m14.1.1.1.cmml" xref="S4.SS1.p5.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.p5.14.m14.1.1.2.cmml" xref="S4.SS1.p5.14.m14.1.1.2">𝑤</ci><ci id="S4.SS1.p5.14.m14.1.1.3.cmml" xref="S4.SS1.p5.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.14.m14.1c">w_{i}</annotation></semantics></math>:</p>
</div>
<div id="S4.SS1.p6" class="ltx_para ltx_noindent">
<table id="A2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.1" class="ltx_Math" alttext="\displaystyle v_{i}^{*}" display="inline"><semantics id="S4.E2.m1.1a"><msubsup id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><mi id="S4.E2.m1.1.1.2.2" xref="S4.E2.m1.1.1.2.2.cmml">v</mi><mi id="S4.E2.m1.1.1.2.3" xref="S4.E2.m1.1.1.2.3.cmml">i</mi><mo id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1">superscript</csymbol><apply id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.2.1.cmml" xref="S4.E2.m1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.2.2">𝑣</ci><ci id="S4.E2.m1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.2.3">𝑖</ci></apply><times id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle v_{i}^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2.m2.4" class="ltx_Math" alttext="\displaystyle={\textstyle\sum_{v_{j}\in V}}\text{norm}_{j}\left(a_{r,i,j}^{*}\right)W_{v}^{\top}v_{j}," display="inline"><semantics id="S4.E2.m2.4a"><mrow id="S4.E2.m2.4.4.1" xref="S4.E2.m2.4.4.1.1.cmml"><mrow id="S4.E2.m2.4.4.1.1" xref="S4.E2.m2.4.4.1.1.cmml"><mi id="S4.E2.m2.4.4.1.1.3" xref="S4.E2.m2.4.4.1.1.3.cmml"></mi><mo rspace="0.111em" id="S4.E2.m2.4.4.1.1.2" xref="S4.E2.m2.4.4.1.1.2.cmml">=</mo><mrow id="S4.E2.m2.4.4.1.1.1" xref="S4.E2.m2.4.4.1.1.1.cmml"><msub id="S4.E2.m2.4.4.1.1.1.2" xref="S4.E2.m2.4.4.1.1.1.2.cmml"><mo id="S4.E2.m2.4.4.1.1.1.2.2" xref="S4.E2.m2.4.4.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E2.m2.4.4.1.1.1.2.3" xref="S4.E2.m2.4.4.1.1.1.2.3.cmml"><msub id="S4.E2.m2.4.4.1.1.1.2.3.2" xref="S4.E2.m2.4.4.1.1.1.2.3.2.cmml"><mi id="S4.E2.m2.4.4.1.1.1.2.3.2.2" xref="S4.E2.m2.4.4.1.1.1.2.3.2.2.cmml">v</mi><mi id="S4.E2.m2.4.4.1.1.1.2.3.2.3" xref="S4.E2.m2.4.4.1.1.1.2.3.2.3.cmml">j</mi></msub><mo id="S4.E2.m2.4.4.1.1.1.2.3.1" xref="S4.E2.m2.4.4.1.1.1.2.3.1.cmml">∈</mo><mi id="S4.E2.m2.4.4.1.1.1.2.3.3" xref="S4.E2.m2.4.4.1.1.1.2.3.3.cmml">V</mi></mrow></msub><mrow id="S4.E2.m2.4.4.1.1.1.1" xref="S4.E2.m2.4.4.1.1.1.1.cmml"><msub id="S4.E2.m2.4.4.1.1.1.1.3" xref="S4.E2.m2.4.4.1.1.1.1.3.cmml"><mtext id="S4.E2.m2.4.4.1.1.1.1.3.2" xref="S4.E2.m2.4.4.1.1.1.1.3.2a.cmml">norm</mtext><mi id="S4.E2.m2.4.4.1.1.1.1.3.3" xref="S4.E2.m2.4.4.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m2.4.4.1.1.1.1.2" xref="S4.E2.m2.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m2.4.4.1.1.1.1.1.1" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m2.4.4.1.1.1.1.1.1.2" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E2.m2.4.4.1.1.1.1.1.1.1" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.2" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.E2.m2.3.3.3.5" xref="S4.E2.m2.3.3.3.4.cmml"><mi id="S4.E2.m2.1.1.1.1" xref="S4.E2.m2.1.1.1.1.cmml">r</mi><mo id="S4.E2.m2.3.3.3.5.1" xref="S4.E2.m2.3.3.3.4.cmml">,</mo><mi id="S4.E2.m2.2.2.2.2" xref="S4.E2.m2.2.2.2.2.cmml">i</mi><mo id="S4.E2.m2.3.3.3.5.2" xref="S4.E2.m2.3.3.3.4.cmml">,</mo><mi id="S4.E2.m2.3.3.3.3" xref="S4.E2.m2.3.3.3.3.cmml">j</mi></mrow><mo id="S4.E2.m2.4.4.1.1.1.1.1.1.1.3" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.E2.m2.4.4.1.1.1.1.1.1.3" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m2.4.4.1.1.1.1.2a" xref="S4.E2.m2.4.4.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E2.m2.4.4.1.1.1.1.4" xref="S4.E2.m2.4.4.1.1.1.1.4.cmml"><mi id="S4.E2.m2.4.4.1.1.1.1.4.2.2" xref="S4.E2.m2.4.4.1.1.1.1.4.2.2.cmml">W</mi><mi id="S4.E2.m2.4.4.1.1.1.1.4.2.3" xref="S4.E2.m2.4.4.1.1.1.1.4.2.3.cmml">v</mi><mo id="S4.E2.m2.4.4.1.1.1.1.4.3" xref="S4.E2.m2.4.4.1.1.1.1.4.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E2.m2.4.4.1.1.1.1.2b" xref="S4.E2.m2.4.4.1.1.1.1.2.cmml">​</mo><msub id="S4.E2.m2.4.4.1.1.1.1.5" xref="S4.E2.m2.4.4.1.1.1.1.5.cmml"><mi id="S4.E2.m2.4.4.1.1.1.1.5.2" xref="S4.E2.m2.4.4.1.1.1.1.5.2.cmml">v</mi><mi id="S4.E2.m2.4.4.1.1.1.1.5.3" xref="S4.E2.m2.4.4.1.1.1.1.5.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S4.E2.m2.4.4.1.2" xref="S4.E2.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m2.4b"><apply id="S4.E2.m2.4.4.1.1.cmml" xref="S4.E2.m2.4.4.1"><eq id="S4.E2.m2.4.4.1.1.2.cmml" xref="S4.E2.m2.4.4.1.1.2"></eq><csymbol cd="latexml" id="S4.E2.m2.4.4.1.1.3.cmml" xref="S4.E2.m2.4.4.1.1.3">absent</csymbol><apply id="S4.E2.m2.4.4.1.1.1.cmml" xref="S4.E2.m2.4.4.1.1.1"><apply id="S4.E2.m2.4.4.1.1.1.2.cmml" xref="S4.E2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.2.1.cmml" xref="S4.E2.m2.4.4.1.1.1.2">subscript</csymbol><sum id="S4.E2.m2.4.4.1.1.1.2.2.cmml" xref="S4.E2.m2.4.4.1.1.1.2.2"></sum><apply id="S4.E2.m2.4.4.1.1.1.2.3.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3"><in id="S4.E2.m2.4.4.1.1.1.2.3.1.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.1"></in><apply id="S4.E2.m2.4.4.1.1.1.2.3.2.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.2.3.2.1.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.2">subscript</csymbol><ci id="S4.E2.m2.4.4.1.1.1.2.3.2.2.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.2.2">𝑣</ci><ci id="S4.E2.m2.4.4.1.1.1.2.3.2.3.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.2.3">𝑗</ci></apply><ci id="S4.E2.m2.4.4.1.1.1.2.3.3.cmml" xref="S4.E2.m2.4.4.1.1.1.2.3.3">𝑉</ci></apply></apply><apply id="S4.E2.m2.4.4.1.1.1.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1"><times id="S4.E2.m2.4.4.1.1.1.1.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.2"></times><apply id="S4.E2.m2.4.4.1.1.1.1.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.3.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m2.4.4.1.1.1.1.3.2a.cmml" xref="S4.E2.m2.4.4.1.1.1.1.3.2"><mtext id="S4.E2.m2.4.4.1.1.1.1.3.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.3.2">norm</mtext></ci><ci id="S4.E2.m2.4.4.1.1.1.1.3.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E2.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.E2.m2.3.3.3.4.cmml" xref="S4.E2.m2.3.3.3.5"><ci id="S4.E2.m2.1.1.1.1.cmml" xref="S4.E2.m2.1.1.1.1">𝑟</ci><ci id="S4.E2.m2.2.2.2.2.cmml" xref="S4.E2.m2.2.2.2.2">𝑖</ci><ci id="S4.E2.m2.3.3.3.3.cmml" xref="S4.E2.m2.3.3.3.3">𝑗</ci></list></apply><times id="S4.E2.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.1.1.1.3"></times></apply><apply id="S4.E2.m2.4.4.1.1.1.1.4.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.4.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4">superscript</csymbol><apply id="S4.E2.m2.4.4.1.1.1.1.4.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.4.2.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4">subscript</csymbol><ci id="S4.E2.m2.4.4.1.1.1.1.4.2.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4.2.2">𝑊</ci><ci id="S4.E2.m2.4.4.1.1.1.1.4.2.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4.2.3">𝑣</ci></apply><csymbol cd="latexml" id="S4.E2.m2.4.4.1.1.1.1.4.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.4.3">top</csymbol></apply><apply id="S4.E2.m2.4.4.1.1.1.1.5.cmml" xref="S4.E2.m2.4.4.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E2.m2.4.4.1.1.1.1.5.1.cmml" xref="S4.E2.m2.4.4.1.1.1.1.5">subscript</csymbol><ci id="S4.E2.m2.4.4.1.1.1.1.5.2.cmml" xref="S4.E2.m2.4.4.1.1.1.1.5.2">𝑣</ci><ci id="S4.E2.m2.4.4.1.1.1.1.5.3.cmml" xref="S4.E2.m2.4.4.1.1.1.1.5.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m2.4c">\displaystyle={\textstyle\sum_{v_{j}\in V}}\text{norm}_{j}\left(a_{r,i,j}^{*}\right)W_{v}^{\top}v_{j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\displaystyle\overline{v_{s,i}^{*}}" display="inline"><semantics id="S4.E3.m1.2a"><mover accent="true" id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><msubsup id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.2.cmml">v</mi><mrow id="S4.E3.m1.2.2.2.2.2.4" xref="S4.E3.m1.2.2.2.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml">s</mi><mo id="S4.E3.m1.2.2.2.2.2.4.1" xref="S4.E3.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="S4.E3.m1.2.2.2.5" xref="S4.E3.m1.2.2.2.5.cmml">∗</mo></msubsup><mo id="S4.E3.m1.2.2.3" xref="S4.E3.m1.2.2.3.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><ci id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2.3">¯</ci><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2">superscript</csymbol><apply id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.4.2.cmml" xref="S4.E3.m1.2.2.2.4.2">𝑣</ci><list id="S4.E3.m1.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.4"><ci id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">𝑠</ci><ci id="S4.E3.m1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2">𝑖</ci></list></apply><times id="S4.E3.m1.2.2.2.5.cmml" xref="S4.E3.m1.2.2.2.5"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\displaystyle\overline{v_{s,i}^{*}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m2.9" class="ltx_Math" alttext="\displaystyle={\textstyle\sum_{v_{s,j}^{\prime}\in V_{s}^{\prime}}}\text{norm}_{j}\left(\overline{a_{r,s,i,j}^{*}}\right)W_{v^{\prime}}^{\top}v_{s,j}^{\prime}," display="inline"><semantics id="S4.E3.m2.9a"><mrow id="S4.E3.m2.9.9.1" xref="S4.E3.m2.9.9.1.1.cmml"><mrow id="S4.E3.m2.9.9.1.1" xref="S4.E3.m2.9.9.1.1.cmml"><mi id="S4.E3.m2.9.9.1.1.2" xref="S4.E3.m2.9.9.1.1.2.cmml"></mi><mo rspace="0.111em" id="S4.E3.m2.9.9.1.1.1" xref="S4.E3.m2.9.9.1.1.1.cmml">=</mo><mrow id="S4.E3.m2.9.9.1.1.3" xref="S4.E3.m2.9.9.1.1.3.cmml"><msub id="S4.E3.m2.9.9.1.1.3.1" xref="S4.E3.m2.9.9.1.1.3.1.cmml"><mo id="S4.E3.m2.9.9.1.1.3.1.2" xref="S4.E3.m2.9.9.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E3.m2.2.2.2" xref="S4.E3.m2.2.2.2.cmml"><msubsup id="S4.E3.m2.2.2.2.4" xref="S4.E3.m2.2.2.2.4.cmml"><mi id="S4.E3.m2.2.2.2.4.2.2" xref="S4.E3.m2.2.2.2.4.2.2.cmml">v</mi><mrow id="S4.E3.m2.2.2.2.2.2.4" xref="S4.E3.m2.2.2.2.2.2.3.cmml"><mi id="S4.E3.m2.1.1.1.1.1.1" xref="S4.E3.m2.1.1.1.1.1.1.cmml">s</mi><mo id="S4.E3.m2.2.2.2.2.2.4.1" xref="S4.E3.m2.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E3.m2.2.2.2.2.2.2" xref="S4.E3.m2.2.2.2.2.2.2.cmml">j</mi></mrow><mo id="S4.E3.m2.2.2.2.4.3" xref="S4.E3.m2.2.2.2.4.3.cmml">′</mo></msubsup><mo id="S4.E3.m2.2.2.2.3" xref="S4.E3.m2.2.2.2.3.cmml">∈</mo><msubsup id="S4.E3.m2.2.2.2.5" xref="S4.E3.m2.2.2.2.5.cmml"><mi id="S4.E3.m2.2.2.2.5.2.2" xref="S4.E3.m2.2.2.2.5.2.2.cmml">V</mi><mi id="S4.E3.m2.2.2.2.5.2.3" xref="S4.E3.m2.2.2.2.5.2.3.cmml">s</mi><mo id="S4.E3.m2.2.2.2.5.3" xref="S4.E3.m2.2.2.2.5.3.cmml">′</mo></msubsup></mrow></msub><mrow id="S4.E3.m2.9.9.1.1.3.2" xref="S4.E3.m2.9.9.1.1.3.2.cmml"><msub id="S4.E3.m2.9.9.1.1.3.2.2" xref="S4.E3.m2.9.9.1.1.3.2.2.cmml"><mtext id="S4.E3.m2.9.9.1.1.3.2.2.2" xref="S4.E3.m2.9.9.1.1.3.2.2.2a.cmml">norm</mtext><mi id="S4.E3.m2.9.9.1.1.3.2.2.3" xref="S4.E3.m2.9.9.1.1.3.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m2.9.9.1.1.3.2.1" xref="S4.E3.m2.9.9.1.1.3.2.1.cmml">​</mo><mrow id="S4.E3.m2.9.9.1.1.3.2.3.2" xref="S4.E3.m2.6.6.cmml"><mo id="S4.E3.m2.9.9.1.1.3.2.3.2.1" xref="S4.E3.m2.6.6.cmml">(</mo><mover accent="true" id="S4.E3.m2.6.6" xref="S4.E3.m2.6.6.cmml"><msubsup id="S4.E3.m2.6.6.4" xref="S4.E3.m2.6.6.4.cmml"><mi id="S4.E3.m2.6.6.4.6.2" xref="S4.E3.m2.6.6.4.6.2.cmml">a</mi><mrow id="S4.E3.m2.6.6.4.4.4.6" xref="S4.E3.m2.6.6.4.4.4.5.cmml"><mi id="S4.E3.m2.3.3.1.1.1.1" xref="S4.E3.m2.3.3.1.1.1.1.cmml">r</mi><mo id="S4.E3.m2.6.6.4.4.4.6.1" xref="S4.E3.m2.6.6.4.4.4.5.cmml">,</mo><mi id="S4.E3.m2.4.4.2.2.2.2" xref="S4.E3.m2.4.4.2.2.2.2.cmml">s</mi><mo id="S4.E3.m2.6.6.4.4.4.6.2" xref="S4.E3.m2.6.6.4.4.4.5.cmml">,</mo><mi id="S4.E3.m2.5.5.3.3.3.3" xref="S4.E3.m2.5.5.3.3.3.3.cmml">i</mi><mo id="S4.E3.m2.6.6.4.4.4.6.3" xref="S4.E3.m2.6.6.4.4.4.5.cmml">,</mo><mi id="S4.E3.m2.6.6.4.4.4.4" xref="S4.E3.m2.6.6.4.4.4.4.cmml">j</mi></mrow><mo id="S4.E3.m2.6.6.4.7" xref="S4.E3.m2.6.6.4.7.cmml">∗</mo></msubsup><mo id="S4.E3.m2.6.6.5" xref="S4.E3.m2.6.6.5.cmml">¯</mo></mover><mo id="S4.E3.m2.9.9.1.1.3.2.3.2.2" xref="S4.E3.m2.6.6.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m2.9.9.1.1.3.2.1a" xref="S4.E3.m2.9.9.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E3.m2.9.9.1.1.3.2.4" xref="S4.E3.m2.9.9.1.1.3.2.4.cmml"><mi id="S4.E3.m2.9.9.1.1.3.2.4.2.2" xref="S4.E3.m2.9.9.1.1.3.2.4.2.2.cmml">W</mi><msup id="S4.E3.m2.9.9.1.1.3.2.4.2.3" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3.cmml"><mi id="S4.E3.m2.9.9.1.1.3.2.4.2.3.2" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3.2.cmml">v</mi><mo id="S4.E3.m2.9.9.1.1.3.2.4.2.3.3" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3.3.cmml">′</mo></msup><mo id="S4.E3.m2.9.9.1.1.3.2.4.3" xref="S4.E3.m2.9.9.1.1.3.2.4.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m2.9.9.1.1.3.2.1b" xref="S4.E3.m2.9.9.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E3.m2.9.9.1.1.3.2.5" xref="S4.E3.m2.9.9.1.1.3.2.5.cmml"><mi id="S4.E3.m2.9.9.1.1.3.2.5.2.2" xref="S4.E3.m2.9.9.1.1.3.2.5.2.2.cmml">v</mi><mrow id="S4.E3.m2.8.8.2.4" xref="S4.E3.m2.8.8.2.3.cmml"><mi id="S4.E3.m2.7.7.1.1" xref="S4.E3.m2.7.7.1.1.cmml">s</mi><mo id="S4.E3.m2.8.8.2.4.1" xref="S4.E3.m2.8.8.2.3.cmml">,</mo><mi id="S4.E3.m2.8.8.2.2" xref="S4.E3.m2.8.8.2.2.cmml">j</mi></mrow><mo id="S4.E3.m2.9.9.1.1.3.2.5.3" xref="S4.E3.m2.9.9.1.1.3.2.5.3.cmml">′</mo></msubsup></mrow></mrow></mrow><mo id="S4.E3.m2.9.9.1.2" xref="S4.E3.m2.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m2.9b"><apply id="S4.E3.m2.9.9.1.1.cmml" xref="S4.E3.m2.9.9.1"><eq id="S4.E3.m2.9.9.1.1.1.cmml" xref="S4.E3.m2.9.9.1.1.1"></eq><csymbol cd="latexml" id="S4.E3.m2.9.9.1.1.2.cmml" xref="S4.E3.m2.9.9.1.1.2">absent</csymbol><apply id="S4.E3.m2.9.9.1.1.3.cmml" xref="S4.E3.m2.9.9.1.1.3"><apply id="S4.E3.m2.9.9.1.1.3.1.cmml" xref="S4.E3.m2.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.1.1.cmml" xref="S4.E3.m2.9.9.1.1.3.1">subscript</csymbol><sum id="S4.E3.m2.9.9.1.1.3.1.2.cmml" xref="S4.E3.m2.9.9.1.1.3.1.2"></sum><apply id="S4.E3.m2.2.2.2.cmml" xref="S4.E3.m2.2.2.2"><in id="S4.E3.m2.2.2.2.3.cmml" xref="S4.E3.m2.2.2.2.3"></in><apply id="S4.E3.m2.2.2.2.4.cmml" xref="S4.E3.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.4.1.cmml" xref="S4.E3.m2.2.2.2.4">superscript</csymbol><apply id="S4.E3.m2.2.2.2.4.2.cmml" xref="S4.E3.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.4.2.1.cmml" xref="S4.E3.m2.2.2.2.4">subscript</csymbol><ci id="S4.E3.m2.2.2.2.4.2.2.cmml" xref="S4.E3.m2.2.2.2.4.2.2">𝑣</ci><list id="S4.E3.m2.2.2.2.2.2.3.cmml" xref="S4.E3.m2.2.2.2.2.2.4"><ci id="S4.E3.m2.1.1.1.1.1.1.cmml" xref="S4.E3.m2.1.1.1.1.1.1">𝑠</ci><ci id="S4.E3.m2.2.2.2.2.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.E3.m2.2.2.2.4.3.cmml" xref="S4.E3.m2.2.2.2.4.3">′</ci></apply><apply id="S4.E3.m2.2.2.2.5.cmml" xref="S4.E3.m2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.5.1.cmml" xref="S4.E3.m2.2.2.2.5">superscript</csymbol><apply id="S4.E3.m2.2.2.2.5.2.cmml" xref="S4.E3.m2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.5.2.1.cmml" xref="S4.E3.m2.2.2.2.5">subscript</csymbol><ci id="S4.E3.m2.2.2.2.5.2.2.cmml" xref="S4.E3.m2.2.2.2.5.2.2">𝑉</ci><ci id="S4.E3.m2.2.2.2.5.2.3.cmml" xref="S4.E3.m2.2.2.2.5.2.3">𝑠</ci></apply><ci id="S4.E3.m2.2.2.2.5.3.cmml" xref="S4.E3.m2.2.2.2.5.3">′</ci></apply></apply></apply><apply id="S4.E3.m2.9.9.1.1.3.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2"><times id="S4.E3.m2.9.9.1.1.3.2.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.1"></times><apply id="S4.E3.m2.9.9.1.1.3.2.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.2.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.2">subscript</csymbol><ci id="S4.E3.m2.9.9.1.1.3.2.2.2a.cmml" xref="S4.E3.m2.9.9.1.1.3.2.2.2"><mtext id="S4.E3.m2.9.9.1.1.3.2.2.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.2.2">norm</mtext></ci><ci id="S4.E3.m2.9.9.1.1.3.2.2.3.cmml" xref="S4.E3.m2.9.9.1.1.3.2.2.3">𝑗</ci></apply><apply id="S4.E3.m2.6.6.cmml" xref="S4.E3.m2.9.9.1.1.3.2.3.2"><ci id="S4.E3.m2.6.6.5.cmml" xref="S4.E3.m2.6.6.5">¯</ci><apply id="S4.E3.m2.6.6.4.cmml" xref="S4.E3.m2.6.6.4"><csymbol cd="ambiguous" id="S4.E3.m2.6.6.4.5.cmml" xref="S4.E3.m2.6.6.4">superscript</csymbol><apply id="S4.E3.m2.6.6.4.6.cmml" xref="S4.E3.m2.6.6.4"><csymbol cd="ambiguous" id="S4.E3.m2.6.6.4.6.1.cmml" xref="S4.E3.m2.6.6.4">subscript</csymbol><ci id="S4.E3.m2.6.6.4.6.2.cmml" xref="S4.E3.m2.6.6.4.6.2">𝑎</ci><list id="S4.E3.m2.6.6.4.4.4.5.cmml" xref="S4.E3.m2.6.6.4.4.4.6"><ci id="S4.E3.m2.3.3.1.1.1.1.cmml" xref="S4.E3.m2.3.3.1.1.1.1">𝑟</ci><ci id="S4.E3.m2.4.4.2.2.2.2.cmml" xref="S4.E3.m2.4.4.2.2.2.2">𝑠</ci><ci id="S4.E3.m2.5.5.3.3.3.3.cmml" xref="S4.E3.m2.5.5.3.3.3.3">𝑖</ci><ci id="S4.E3.m2.6.6.4.4.4.4.cmml" xref="S4.E3.m2.6.6.4.4.4.4">𝑗</ci></list></apply><times id="S4.E3.m2.6.6.4.7.cmml" xref="S4.E3.m2.6.6.4.7"></times></apply></apply><apply id="S4.E3.m2.9.9.1.1.3.2.4.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.4.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4">superscript</csymbol><apply id="S4.E3.m2.9.9.1.1.3.2.4.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.4.2.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4">subscript</csymbol><ci id="S4.E3.m2.9.9.1.1.3.2.4.2.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.2.2">𝑊</ci><apply id="S4.E3.m2.9.9.1.1.3.2.4.2.3.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.4.2.3.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3">superscript</csymbol><ci id="S4.E3.m2.9.9.1.1.3.2.4.2.3.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3.2">𝑣</ci><ci id="S4.E3.m2.9.9.1.1.3.2.4.2.3.3.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.2.3.3">′</ci></apply></apply><csymbol cd="latexml" id="S4.E3.m2.9.9.1.1.3.2.4.3.cmml" xref="S4.E3.m2.9.9.1.1.3.2.4.3">top</csymbol></apply><apply id="S4.E3.m2.9.9.1.1.3.2.5.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.5.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5">superscript</csymbol><apply id="S4.E3.m2.9.9.1.1.3.2.5.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5"><csymbol cd="ambiguous" id="S4.E3.m2.9.9.1.1.3.2.5.2.1.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5">subscript</csymbol><ci id="S4.E3.m2.9.9.1.1.3.2.5.2.2.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5.2.2">𝑣</ci><list id="S4.E3.m2.8.8.2.3.cmml" xref="S4.E3.m2.8.8.2.4"><ci id="S4.E3.m2.7.7.1.1.cmml" xref="S4.E3.m2.7.7.1.1">𝑠</ci><ci id="S4.E3.m2.8.8.2.2.cmml" xref="S4.E3.m2.8.8.2.2">𝑗</ci></list></apply><ci id="S4.E3.m2.9.9.1.1.3.2.5.3.cmml" xref="S4.E3.m2.9.9.1.1.3.2.5.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.9c">\displaystyle={\textstyle\sum_{v_{s,j}^{\prime}\in V_{s}^{\prime}}}\text{norm}_{j}\left(\overline{a_{r,s,i,j}^{*}}\right)W_{v^{\prime}}^{\top}v_{s,j}^{\prime},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<br class="ltx_break">
<p id="S4.SS1.p6.3" class="ltx_p">where “<math id="S4.SS1.p6.1.m1.1" class="ltx_Math" alttext="\text{norm}_{j}" display="inline"><semantics id="S4.SS1.p6.1.m1.1a"><msub id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml"><mtext id="S4.SS1.p6.1.m1.1.1.2" xref="S4.SS1.p6.1.m1.1.1.2a.cmml">norm</mtext><mi id="S4.SS1.p6.1.m1.1.1.3" xref="S4.SS1.p6.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b"><apply id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p6.1.m1.1.1.2a.cmml" xref="S4.SS1.p6.1.m1.1.1.2"><mtext id="S4.SS1.p6.1.m1.1.1.2.cmml" xref="S4.SS1.p6.1.m1.1.1.2">norm</mtext></ci><ci id="S4.SS1.p6.1.m1.1.1.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">\text{norm}_{j}</annotation></semantics></math>” is a column normalization operator;
<math id="S4.SS1.p6.2.m2.1" class="ltx_Math" alttext="W_{v}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S4.SS1.p6.2.m2.1a"><mrow id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml"><msub id="S4.SS1.p6.2.m2.1.1.2" xref="S4.SS1.p6.2.m2.1.1.2.cmml"><mi id="S4.SS1.p6.2.m2.1.1.2.2" xref="S4.SS1.p6.2.m2.1.1.2.2.cmml">W</mi><mi id="S4.SS1.p6.2.m2.1.1.2.3" xref="S4.SS1.p6.2.m2.1.1.2.3.cmml">v</mi></msub><mo id="S4.SS1.p6.2.m2.1.1.1" xref="S4.SS1.p6.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p6.2.m2.1.1.3" xref="S4.SS1.p6.2.m2.1.1.3.cmml"><mi id="S4.SS1.p6.2.m2.1.1.3.2" xref="S4.SS1.p6.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.2.m2.1.1.3.3" xref="S4.SS1.p6.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.p6.2.m2.1.1.3.3.2" xref="S4.SS1.p6.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p6.2.m2.1.1.3.3.1" xref="S4.SS1.p6.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p6.2.m2.1.1.3.3.3" xref="S4.SS1.p6.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><apply id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1"><in id="S4.SS1.p6.2.m2.1.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1.1"></in><apply id="S4.SS1.p6.2.m2.1.1.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.2.1.cmml" xref="S4.SS1.p6.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.2.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2.2">𝑊</ci><ci id="S4.SS1.p6.2.m2.1.1.2.3.cmml" xref="S4.SS1.p6.2.m2.1.1.2.3">𝑣</ci></apply><apply id="S4.SS1.p6.2.m2.1.1.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.3.1.cmml" xref="S4.SS1.p6.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.3.2.cmml" xref="S4.SS1.p6.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p6.2.m2.1.1.3.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3"><times id="S4.SS1.p6.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.1"></times><ci id="S4.SS1.p6.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p6.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">W_{v}\in\mathbb{R}^{d\times d}</annotation></semantics></math> and <math id="S4.SS1.p6.3.m3.1" class="ltx_Math" alttext="W_{v^{\prime}}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S4.SS1.p6.3.m3.1a"><mrow id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml"><msub id="S4.SS1.p6.3.m3.1.1.2" xref="S4.SS1.p6.3.m3.1.1.2.cmml"><mi id="S4.SS1.p6.3.m3.1.1.2.2" xref="S4.SS1.p6.3.m3.1.1.2.2.cmml">W</mi><msup id="S4.SS1.p6.3.m3.1.1.2.3" xref="S4.SS1.p6.3.m3.1.1.2.3.cmml"><mi id="S4.SS1.p6.3.m3.1.1.2.3.2" xref="S4.SS1.p6.3.m3.1.1.2.3.2.cmml">v</mi><mo id="S4.SS1.p6.3.m3.1.1.2.3.3" xref="S4.SS1.p6.3.m3.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S4.SS1.p6.3.m3.1.1.1" xref="S4.SS1.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p6.3.m3.1.1.3" xref="S4.SS1.p6.3.m3.1.1.3.cmml"><mi id="S4.SS1.p6.3.m3.1.1.3.2" xref="S4.SS1.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.3.m3.1.1.3.3" xref="S4.SS1.p6.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p6.3.m3.1.1.3.3.2" xref="S4.SS1.p6.3.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p6.3.m3.1.1.3.3.1" xref="S4.SS1.p6.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p6.3.m3.1.1.3.3.3" xref="S4.SS1.p6.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.1b"><apply id="S4.SS1.p6.3.m3.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1"><in id="S4.SS1.p6.3.m3.1.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1.1"></in><apply id="S4.SS1.p6.3.m3.1.1.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.1.1.2.1.cmml" xref="S4.SS1.p6.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p6.3.m3.1.1.2.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2.2">𝑊</ci><apply id="S4.SS1.p6.3.m3.1.1.2.3.cmml" xref="S4.SS1.p6.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.1.1.2.3.1.cmml" xref="S4.SS1.p6.3.m3.1.1.2.3">superscript</csymbol><ci id="S4.SS1.p6.3.m3.1.1.2.3.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2.3.2">𝑣</ci><ci id="S4.SS1.p6.3.m3.1.1.2.3.3.cmml" xref="S4.SS1.p6.3.m3.1.1.2.3.3">′</ci></apply></apply><apply id="S4.SS1.p6.3.m3.1.1.3.cmml" xref="S4.SS1.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.1.1.3.1.cmml" xref="S4.SS1.p6.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p6.3.m3.1.1.3.2.cmml" xref="S4.SS1.p6.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p6.3.m3.1.1.3.3.cmml" xref="S4.SS1.p6.3.m3.1.1.3.3"><times id="S4.SS1.p6.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p6.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.p6.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p6.3.m3.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p6.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p6.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.1c">W_{v^{\prime}}\in\mathbb{R}^{d\times d}</annotation></semantics></math>
are learnable parameters. We then push them away from each other by
maximizing the linguistic-vision InfoNCE <cite class="ltx_cite ltx_citemacro_citep">(Oord et al., <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite>:</p>
</div>
<div id="S4.SS1.p7" class="ltx_para ltx_noindent">
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.9" class="ltx_Math" alttext="\mathcal{L}_{r}(\delta)=\mathbb{E}_{\mathcal{B}}\left[\sum_{w_{i}\in E_{r}}\textrm{log}\left(\frac{e^{\left\langle W_{w}^{\top}w_{i},v_{i}^{*}\right\rangle}}{e^{\left\langle W_{w}^{\top}w_{i},v_{i}^{*}\right\rangle}+\sum_{s=1}^{b-1}e^{\left\langle W_{w}^{\top}w_{i},\overline{v_{s,i}^{*}}\right\rangle}}\right)\right]." display="block"><semantics id="S4.E4.m1.9a"><mrow id="S4.E4.m1.9.9.1" xref="S4.E4.m1.9.9.1.1.cmml"><mrow id="S4.E4.m1.9.9.1.1" xref="S4.E4.m1.9.9.1.1.cmml"><mrow id="S4.E4.m1.9.9.1.1.3" xref="S4.E4.m1.9.9.1.1.3.cmml"><msub id="S4.E4.m1.9.9.1.1.3.2" xref="S4.E4.m1.9.9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.9.9.1.1.3.2.2" xref="S4.E4.m1.9.9.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E4.m1.9.9.1.1.3.2.3" xref="S4.E4.m1.9.9.1.1.3.2.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.9.9.1.1.3.1" xref="S4.E4.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.9.9.1.1.3.3.2" xref="S4.E4.m1.9.9.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.9.9.1.1.3.3.2.1" xref="S4.E4.m1.9.9.1.1.3.cmml">(</mo><mi id="S4.E4.m1.8.8" xref="S4.E4.m1.8.8.cmml">δ</mi><mo stretchy="false" id="S4.E4.m1.9.9.1.1.3.3.2.2" xref="S4.E4.m1.9.9.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.9.9.1.1.2" xref="S4.E4.m1.9.9.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.9.9.1.1.1" xref="S4.E4.m1.9.9.1.1.1.cmml"><msub id="S4.E4.m1.9.9.1.1.1.3" xref="S4.E4.m1.9.9.1.1.1.3.cmml"><mi id="S4.E4.m1.9.9.1.1.1.3.2" xref="S4.E4.m1.9.9.1.1.1.3.2.cmml">𝔼</mi><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.9.9.1.1.1.3.3" xref="S4.E4.m1.9.9.1.1.1.3.3.cmml">ℬ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.9.9.1.1.1.2" xref="S4.E4.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.2.cmml"><mo id="S4.E4.m1.9.9.1.1.1.1.1.2" xref="S4.E4.m1.9.9.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.1.1.cmml"><munder id="S4.E4.m1.9.9.1.1.1.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S4.E4.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.3" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.2.cmml">E</mi><mi id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></munder><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.cmml"><mtext id="S4.E4.m1.9.9.1.1.1.1.1.1.2.2" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.2a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="S4.E4.m1.9.9.1.1.1.1.1.1.2.1" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1.2.3.2" xref="S4.E4.m1.7.7.cmml"><mo id="S4.E4.m1.9.9.1.1.1.1.1.1.2.3.2.1" xref="S4.E4.m1.7.7.cmml">(</mo><mfrac id="S4.E4.m1.7.7" xref="S4.E4.m1.7.7.cmml"><msup id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.4.cmml">e</mi><mrow id="S4.E4.m1.2.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.3.cmml"><mo id="S4.E4.m1.2.2.2.2.2.2.3" xref="S4.E4.m1.2.2.2.2.2.3.cmml">⟨</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2.3.cmml">w</mi><mo id="S4.E4.m1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E4.m1.2.2.2.2.2.2.4" xref="S4.E4.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E4.m1.2.2.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S4.E4.m1.2.2.2.2.2.2.2.2.3" xref="S4.E4.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi><mo id="S4.E4.m1.2.2.2.2.2.2.2.3" xref="S4.E4.m1.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E4.m1.2.2.2.2.2.2.5" xref="S4.E4.m1.2.2.2.2.2.3.cmml">⟩</mo></mrow></msup><mrow id="S4.E4.m1.7.7.7" xref="S4.E4.m1.7.7.7.cmml"><msup id="S4.E4.m1.7.7.7.7" xref="S4.E4.m1.7.7.7.7.cmml"><mi id="S4.E4.m1.7.7.7.7.2" xref="S4.E4.m1.7.7.7.7.2.cmml">e</mi><mrow id="S4.E4.m1.4.4.4.2.2.2" xref="S4.E4.m1.4.4.4.2.2.3.cmml"><mo id="S4.E4.m1.4.4.4.2.2.2.3" xref="S4.E4.m1.4.4.4.2.2.3.cmml">⟨</mo><mrow id="S4.E4.m1.3.3.3.1.1.1.1" xref="S4.E4.m1.3.3.3.1.1.1.1.cmml"><msubsup id="S4.E4.m1.3.3.3.1.1.1.1.2" xref="S4.E4.m1.3.3.3.1.1.1.1.2.cmml"><mi id="S4.E4.m1.3.3.3.1.1.1.1.2.2.2" xref="S4.E4.m1.3.3.3.1.1.1.1.2.2.2.cmml">W</mi><mi id="S4.E4.m1.3.3.3.1.1.1.1.2.2.3" xref="S4.E4.m1.3.3.3.1.1.1.1.2.2.3.cmml">w</mi><mo id="S4.E4.m1.3.3.3.1.1.1.1.2.3" xref="S4.E4.m1.3.3.3.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.3.1.1.1.1.1" xref="S4.E4.m1.3.3.3.1.1.1.1.1.cmml">​</mo><msub id="S4.E4.m1.3.3.3.1.1.1.1.3" xref="S4.E4.m1.3.3.3.1.1.1.1.3.cmml"><mi id="S4.E4.m1.3.3.3.1.1.1.1.3.2" xref="S4.E4.m1.3.3.3.1.1.1.1.3.2.cmml">w</mi><mi id="S4.E4.m1.3.3.3.1.1.1.1.3.3" xref="S4.E4.m1.3.3.3.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E4.m1.4.4.4.2.2.2.4" xref="S4.E4.m1.4.4.4.2.2.3.cmml">,</mo><msubsup id="S4.E4.m1.4.4.4.2.2.2.2" xref="S4.E4.m1.4.4.4.2.2.2.2.cmml"><mi id="S4.E4.m1.4.4.4.2.2.2.2.2.2" xref="S4.E4.m1.4.4.4.2.2.2.2.2.2.cmml">v</mi><mi id="S4.E4.m1.4.4.4.2.2.2.2.2.3" xref="S4.E4.m1.4.4.4.2.2.2.2.2.3.cmml">i</mi><mo id="S4.E4.m1.4.4.4.2.2.2.2.3" xref="S4.E4.m1.4.4.4.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E4.m1.4.4.4.2.2.2.5" xref="S4.E4.m1.4.4.4.2.2.3.cmml">⟩</mo></mrow></msup><mo rspace="0.055em" id="S4.E4.m1.7.7.7.6" xref="S4.E4.m1.7.7.7.6.cmml">+</mo><mrow id="S4.E4.m1.7.7.7.8" xref="S4.E4.m1.7.7.7.8.cmml"><msubsup id="S4.E4.m1.7.7.7.8.1" xref="S4.E4.m1.7.7.7.8.1.cmml"><mo id="S4.E4.m1.7.7.7.8.1.2.2" xref="S4.E4.m1.7.7.7.8.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.7.7.7.8.1.2.3" xref="S4.E4.m1.7.7.7.8.1.2.3.cmml"><mi id="S4.E4.m1.7.7.7.8.1.2.3.2" xref="S4.E4.m1.7.7.7.8.1.2.3.2.cmml">s</mi><mo id="S4.E4.m1.7.7.7.8.1.2.3.1" xref="S4.E4.m1.7.7.7.8.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.7.7.7.8.1.2.3.3" xref="S4.E4.m1.7.7.7.8.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E4.m1.7.7.7.8.1.3" xref="S4.E4.m1.7.7.7.8.1.3.cmml"><mi id="S4.E4.m1.7.7.7.8.1.3.2" xref="S4.E4.m1.7.7.7.8.1.3.2.cmml">b</mi><mo id="S4.E4.m1.7.7.7.8.1.3.1" xref="S4.E4.m1.7.7.7.8.1.3.1.cmml">−</mo><mn id="S4.E4.m1.7.7.7.8.1.3.3" xref="S4.E4.m1.7.7.7.8.1.3.3.cmml">1</mn></mrow></msubsup><msup id="S4.E4.m1.7.7.7.8.2" xref="S4.E4.m1.7.7.7.8.2.cmml"><mi id="S4.E4.m1.7.7.7.8.2.2" xref="S4.E4.m1.7.7.7.8.2.2.cmml">e</mi><mrow id="S4.E4.m1.7.7.7.5.3.3" xref="S4.E4.m1.7.7.7.5.3.4.cmml"><mo id="S4.E4.m1.7.7.7.5.3.3.2" xref="S4.E4.m1.7.7.7.5.3.4.cmml">⟨</mo><mrow id="S4.E4.m1.7.7.7.5.3.3.1" xref="S4.E4.m1.7.7.7.5.3.3.1.cmml"><msubsup id="S4.E4.m1.7.7.7.5.3.3.1.2" xref="S4.E4.m1.7.7.7.5.3.3.1.2.cmml"><mi id="S4.E4.m1.7.7.7.5.3.3.1.2.2.2" xref="S4.E4.m1.7.7.7.5.3.3.1.2.2.2.cmml">W</mi><mi id="S4.E4.m1.7.7.7.5.3.3.1.2.2.3" xref="S4.E4.m1.7.7.7.5.3.3.1.2.2.3.cmml">w</mi><mo id="S4.E4.m1.7.7.7.5.3.3.1.2.3" xref="S4.E4.m1.7.7.7.5.3.3.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.7.5.3.3.1.1" xref="S4.E4.m1.7.7.7.5.3.3.1.1.cmml">​</mo><msub id="S4.E4.m1.7.7.7.5.3.3.1.3" xref="S4.E4.m1.7.7.7.5.3.3.1.3.cmml"><mi id="S4.E4.m1.7.7.7.5.3.3.1.3.2" xref="S4.E4.m1.7.7.7.5.3.3.1.3.2.cmml">w</mi><mi id="S4.E4.m1.7.7.7.5.3.3.1.3.3" xref="S4.E4.m1.7.7.7.5.3.3.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E4.m1.7.7.7.5.3.3.3" xref="S4.E4.m1.7.7.7.5.3.4.cmml">,</mo><mover accent="true" id="S4.E4.m1.6.6.6.4.2.2" xref="S4.E4.m1.6.6.6.4.2.2.cmml"><msubsup id="S4.E4.m1.6.6.6.4.2.2.2" xref="S4.E4.m1.6.6.6.4.2.2.2.cmml"><mi id="S4.E4.m1.6.6.6.4.2.2.2.4.2" xref="S4.E4.m1.6.6.6.4.2.2.2.4.2.cmml">v</mi><mrow id="S4.E4.m1.6.6.6.4.2.2.2.2.2.4" xref="S4.E4.m1.6.6.6.4.2.2.2.2.2.3.cmml"><mi id="S4.E4.m1.5.5.5.3.1.1.1.1.1.1" xref="S4.E4.m1.5.5.5.3.1.1.1.1.1.1.cmml">s</mi><mo id="S4.E4.m1.6.6.6.4.2.2.2.2.2.4.1" xref="S4.E4.m1.6.6.6.4.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E4.m1.6.6.6.4.2.2.2.2.2.2" xref="S4.E4.m1.6.6.6.4.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="S4.E4.m1.6.6.6.4.2.2.2.5" xref="S4.E4.m1.6.6.6.4.2.2.2.5.cmml">∗</mo></msubsup><mo id="S4.E4.m1.6.6.6.4.2.2.3" xref="S4.E4.m1.6.6.6.4.2.2.3.cmml">¯</mo></mover><mo id="S4.E4.m1.7.7.7.5.3.3.4" xref="S4.E4.m1.7.7.7.5.3.4.cmml">⟩</mo></mrow></msup></mrow></mrow></mfrac><mo id="S4.E4.m1.9.9.1.1.1.1.1.1.2.3.2.2" xref="S4.E4.m1.7.7.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.9.9.1.1.1.1.1.3" xref="S4.E4.m1.9.9.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E4.m1.9.9.1.2" xref="S4.E4.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.9b"><apply id="S4.E4.m1.9.9.1.1.cmml" xref="S4.E4.m1.9.9.1"><eq id="S4.E4.m1.9.9.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.2"></eq><apply id="S4.E4.m1.9.9.1.1.3.cmml" xref="S4.E4.m1.9.9.1.1.3"><times id="S4.E4.m1.9.9.1.1.3.1.cmml" xref="S4.E4.m1.9.9.1.1.3.1"></times><apply id="S4.E4.m1.9.9.1.1.3.2.cmml" xref="S4.E4.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.3.2.1.cmml" xref="S4.E4.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.3.2.2.cmml" xref="S4.E4.m1.9.9.1.1.3.2.2">ℒ</ci><ci id="S4.E4.m1.9.9.1.1.3.2.3.cmml" xref="S4.E4.m1.9.9.1.1.3.2.3">𝑟</ci></apply><ci id="S4.E4.m1.8.8.cmml" xref="S4.E4.m1.8.8">𝛿</ci></apply><apply id="S4.E4.m1.9.9.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1"><times id="S4.E4.m1.9.9.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.2"></times><apply id="S4.E4.m1.9.9.1.1.1.3.cmml" xref="S4.E4.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.1.3.1.cmml" xref="S4.E4.m1.9.9.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.1.3.2.cmml" xref="S4.E4.m1.9.9.1.1.1.3.2">𝔼</ci><ci id="S4.E4.m1.9.9.1.1.1.3.3.cmml" xref="S4.E4.m1.9.9.1.1.1.3.3">ℬ</ci></apply><apply id="S4.E4.m1.9.9.1.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.9.9.1.1.1.1.2.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1"><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1">subscript</csymbol><sum id="S4.E4.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.2"></sum><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3"><in id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.1"></in><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.2">𝐸</ci><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2"><times id="S4.E4.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.1"></times><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.2.2a.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.2"><mtext id="S4.E4.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.2">log</mtext></ci><apply id="S4.E4.m1.7.7.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.3.2"><divide id="S4.E4.m1.7.7.8.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.2.3.2"></divide><apply id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2">superscript</csymbol><ci id="S4.E4.m1.2.2.2.4.cmml" xref="S4.E4.m1.2.2.2.4">𝑒</ci><list id="S4.E4.m1.2.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2"><apply id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2.3">𝑤</ci></apply><csymbol cd="latexml" id="S4.E4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E4.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S4.E4.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><times id="S4.E4.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2.3"></times></apply></list></apply><apply id="S4.E4.m1.7.7.7.cmml" xref="S4.E4.m1.7.7.7"><plus id="S4.E4.m1.7.7.7.6.cmml" xref="S4.E4.m1.7.7.7.6"></plus><apply id="S4.E4.m1.7.7.7.7.cmml" xref="S4.E4.m1.7.7.7.7"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.7.1.cmml" xref="S4.E4.m1.7.7.7.7">superscript</csymbol><ci id="S4.E4.m1.7.7.7.7.2.cmml" xref="S4.E4.m1.7.7.7.7.2">𝑒</ci><list id="S4.E4.m1.4.4.4.2.2.3.cmml" xref="S4.E4.m1.4.4.4.2.2.2"><apply id="S4.E4.m1.3.3.3.1.1.1.1.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1"><times id="S4.E4.m1.3.3.3.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.1"></times><apply id="S4.E4.m1.3.3.3.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m1.3.3.3.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.3.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.3.3.3.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2.2.2">𝑊</ci><ci id="S4.E4.m1.3.3.3.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2.2.3">𝑤</ci></apply><csymbol cd="latexml" id="S4.E4.m1.3.3.3.1.1.1.1.2.3.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.2.3">top</csymbol></apply><apply id="S4.E4.m1.3.3.3.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.3.1.1.1.1.3.1.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.3.3.3.1.1.1.1.3.2.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.3.2">𝑤</ci><ci id="S4.E4.m1.3.3.3.1.1.1.1.3.3.cmml" xref="S4.E4.m1.3.3.3.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.4.4.4.2.2.2.2.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.2.2.2.1.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2">superscript</csymbol><apply id="S4.E4.m1.4.4.4.2.2.2.2.2.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.2.2.2.2.2.1.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2.2.2">𝑣</ci><ci id="S4.E4.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2.2.3">𝑖</ci></apply><times id="S4.E4.m1.4.4.4.2.2.2.2.3.cmml" xref="S4.E4.m1.4.4.4.2.2.2.2.3"></times></apply></list></apply><apply id="S4.E4.m1.7.7.7.8.cmml" xref="S4.E4.m1.7.7.7.8"><apply id="S4.E4.m1.7.7.7.8.1.cmml" xref="S4.E4.m1.7.7.7.8.1"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.8.1.1.cmml" xref="S4.E4.m1.7.7.7.8.1">superscript</csymbol><apply id="S4.E4.m1.7.7.7.8.1.2.cmml" xref="S4.E4.m1.7.7.7.8.1"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.8.1.2.1.cmml" xref="S4.E4.m1.7.7.7.8.1">subscript</csymbol><sum id="S4.E4.m1.7.7.7.8.1.2.2.cmml" xref="S4.E4.m1.7.7.7.8.1.2.2"></sum><apply id="S4.E4.m1.7.7.7.8.1.2.3.cmml" xref="S4.E4.m1.7.7.7.8.1.2.3"><eq id="S4.E4.m1.7.7.7.8.1.2.3.1.cmml" xref="S4.E4.m1.7.7.7.8.1.2.3.1"></eq><ci id="S4.E4.m1.7.7.7.8.1.2.3.2.cmml" xref="S4.E4.m1.7.7.7.8.1.2.3.2">𝑠</ci><cn type="integer" id="S4.E4.m1.7.7.7.8.1.2.3.3.cmml" xref="S4.E4.m1.7.7.7.8.1.2.3.3">1</cn></apply></apply><apply id="S4.E4.m1.7.7.7.8.1.3.cmml" xref="S4.E4.m1.7.7.7.8.1.3"><minus id="S4.E4.m1.7.7.7.8.1.3.1.cmml" xref="S4.E4.m1.7.7.7.8.1.3.1"></minus><ci id="S4.E4.m1.7.7.7.8.1.3.2.cmml" xref="S4.E4.m1.7.7.7.8.1.3.2">𝑏</ci><cn type="integer" id="S4.E4.m1.7.7.7.8.1.3.3.cmml" xref="S4.E4.m1.7.7.7.8.1.3.3">1</cn></apply></apply><apply id="S4.E4.m1.7.7.7.8.2.cmml" xref="S4.E4.m1.7.7.7.8.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.8.2.1.cmml" xref="S4.E4.m1.7.7.7.8.2">superscript</csymbol><ci id="S4.E4.m1.7.7.7.8.2.2.cmml" xref="S4.E4.m1.7.7.7.8.2.2">𝑒</ci><list id="S4.E4.m1.7.7.7.5.3.4.cmml" xref="S4.E4.m1.7.7.7.5.3.3"><apply id="S4.E4.m1.7.7.7.5.3.3.1.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1"><times id="S4.E4.m1.7.7.7.5.3.3.1.1.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.1"></times><apply id="S4.E4.m1.7.7.7.5.3.3.1.2.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.5.3.3.1.2.1.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2">superscript</csymbol><apply id="S4.E4.m1.7.7.7.5.3.3.1.2.2.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.5.3.3.1.2.2.1.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2">subscript</csymbol><ci id="S4.E4.m1.7.7.7.5.3.3.1.2.2.2.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2.2.2">𝑊</ci><ci id="S4.E4.m1.7.7.7.5.3.3.1.2.2.3.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2.2.3">𝑤</ci></apply><csymbol cd="latexml" id="S4.E4.m1.7.7.7.5.3.3.1.2.3.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.2.3">top</csymbol></apply><apply id="S4.E4.m1.7.7.7.5.3.3.1.3.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.7.5.3.3.1.3.1.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.3">subscript</csymbol><ci id="S4.E4.m1.7.7.7.5.3.3.1.3.2.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.3.2">𝑤</ci><ci id="S4.E4.m1.7.7.7.5.3.3.1.3.3.cmml" xref="S4.E4.m1.7.7.7.5.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.6.6.6.4.2.2.cmml" xref="S4.E4.m1.6.6.6.4.2.2"><ci id="S4.E4.m1.6.6.6.4.2.2.3.cmml" xref="S4.E4.m1.6.6.6.4.2.2.3">¯</ci><apply id="S4.E4.m1.6.6.6.4.2.2.2.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.6.4.2.2.2.3.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2">superscript</csymbol><apply id="S4.E4.m1.6.6.6.4.2.2.2.4.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.6.4.2.2.2.4.1.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2">subscript</csymbol><ci id="S4.E4.m1.6.6.6.4.2.2.2.4.2.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2.4.2">𝑣</ci><list id="S4.E4.m1.6.6.6.4.2.2.2.2.2.3.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2.2.2.4"><ci id="S4.E4.m1.5.5.5.3.1.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.5.3.1.1.1.1.1.1">𝑠</ci><ci id="S4.E4.m1.6.6.6.4.2.2.2.2.2.2.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2.2.2.2">𝑖</ci></list></apply><times id="S4.E4.m1.6.6.6.4.2.2.2.5.cmml" xref="S4.E4.m1.6.6.6.4.2.2.2.5"></times></apply></apply></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.9c">\mathcal{L}_{r}(\delta)=\mathbb{E}_{\mathcal{B}}\left[\sum_{w_{i}\in E_{r}}\textrm{log}\left(\frac{e^{\left\langle W_{w}^{\top}w_{i},v_{i}^{*}\right\rangle}}{e^{\left\langle W_{w}^{\top}w_{i},v_{i}^{*}\right\rangle}+\sum_{s=1}^{b-1}e^{\left\langle W_{w}^{\top}w_{i},\overline{v_{s,i}^{*}}\right\rangle}}\right)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p8" class="ltx_para ltx_noindent">
<p id="S4.SS1.p8.3" class="ltx_p">This loss maximizes the lower bound of mutual information <math id="S4.SS1.p8.1.m1.2" class="ltx_Math" alttext="\textrm{MI}(V,w_{i})" display="inline"><semantics id="S4.SS1.p8.1.m1.2a"><mrow id="S4.SS1.p8.1.m1.2.2" xref="S4.SS1.p8.1.m1.2.2.cmml"><mtext id="S4.SS1.p8.1.m1.2.2.3" xref="S4.SS1.p8.1.m1.2.2.3a.cmml">MI</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p8.1.m1.2.2.2" xref="S4.SS1.p8.1.m1.2.2.2.cmml">​</mo><mrow id="S4.SS1.p8.1.m1.2.2.1.1" xref="S4.SS1.p8.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p8.1.m1.2.2.1.1.2" xref="S4.SS1.p8.1.m1.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p8.1.m1.1.1" xref="S4.SS1.p8.1.m1.1.1.cmml">V</mi><mo id="S4.SS1.p8.1.m1.2.2.1.1.3" xref="S4.SS1.p8.1.m1.2.2.1.2.cmml">,</mo><msub id="S4.SS1.p8.1.m1.2.2.1.1.1" xref="S4.SS1.p8.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.p8.1.m1.2.2.1.1.1.2" xref="S4.SS1.p8.1.m1.2.2.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p8.1.m1.2.2.1.1.1.3" xref="S4.SS1.p8.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p8.1.m1.2.2.1.1.4" xref="S4.SS1.p8.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.2b"><apply id="S4.SS1.p8.1.m1.2.2.cmml" xref="S4.SS1.p8.1.m1.2.2"><times id="S4.SS1.p8.1.m1.2.2.2.cmml" xref="S4.SS1.p8.1.m1.2.2.2"></times><ci id="S4.SS1.p8.1.m1.2.2.3a.cmml" xref="S4.SS1.p8.1.m1.2.2.3"><mtext id="S4.SS1.p8.1.m1.2.2.3.cmml" xref="S4.SS1.p8.1.m1.2.2.3">MI</mtext></ci><interval closure="open" id="S4.SS1.p8.1.m1.2.2.1.2.cmml" xref="S4.SS1.p8.1.m1.2.2.1.1"><ci id="S4.SS1.p8.1.m1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1">𝑉</ci><apply id="S4.SS1.p8.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p8.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p8.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.2.2.1.1.1.2">𝑤</ci><ci id="S4.SS1.p8.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.p8.1.m1.2.2.1.1.1.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.2c">\textrm{MI}(V,w_{i})</annotation></semantics></math>
between visual regions <math id="S4.SS1.p8.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS1.p8.2.m2.1a"><mi id="S4.SS1.p8.2.m2.1.1" xref="S4.SS1.p8.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.2.m2.1b"><ci id="S4.SS1.p8.2.m2.1.1.cmml" xref="S4.SS1.p8.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.2.m2.1c">V</annotation></semantics></math> and contextualized word embedding <math id="S4.SS1.p8.3.m3.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS1.p8.3.m3.1a"><msub id="S4.SS1.p8.3.m3.1.1" xref="S4.SS1.p8.3.m3.1.1.cmml"><mi id="S4.SS1.p8.3.m3.1.1.2" xref="S4.SS1.p8.3.m3.1.1.2.cmml">w</mi><mi id="S4.SS1.p8.3.m3.1.1.3" xref="S4.SS1.p8.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.3.m3.1b"><apply id="S4.SS1.p8.3.m3.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p8.3.m3.1.1.2.cmml" xref="S4.SS1.p8.3.m3.1.1.2">𝑤</ci><ci id="S4.SS1.p8.3.m3.1.1.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.3.m3.1c">w_{i}</annotation></semantics></math>
<cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S4.SS1.p9" class="ltx_para ltx_noindent">
<p id="S4.SS1.p9.1" class="ltx_p">Finally, we compute the word-region alignment <math id="S4.SS1.p9.1.m1.1" class="ltx_Math" alttext="A^{*}\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S4.SS1.p9.1.m1.1a"><mrow id="S4.SS1.p9.1.m1.1.1" xref="S4.SS1.p9.1.m1.1.1.cmml"><msup id="S4.SS1.p9.1.m1.1.1.2" xref="S4.SS1.p9.1.m1.1.1.2.cmml"><mi id="S4.SS1.p9.1.m1.1.1.2.2" xref="S4.SS1.p9.1.m1.1.1.2.2.cmml">A</mi><mo id="S4.SS1.p9.1.m1.1.1.2.3" xref="S4.SS1.p9.1.m1.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS1.p9.1.m1.1.1.1" xref="S4.SS1.p9.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p9.1.m1.1.1.3" xref="S4.SS1.p9.1.m1.1.1.3.cmml"><mi id="S4.SS1.p9.1.m1.1.1.3.2" xref="S4.SS1.p9.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p9.1.m1.1.1.3.3" xref="S4.SS1.p9.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p9.1.m1.1.1.3.3.2" xref="S4.SS1.p9.1.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p9.1.m1.1.1.3.3.1" xref="S4.SS1.p9.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p9.1.m1.1.1.3.3.3" xref="S4.SS1.p9.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.1.m1.1b"><apply id="S4.SS1.p9.1.m1.1.1.cmml" xref="S4.SS1.p9.1.m1.1.1"><in id="S4.SS1.p9.1.m1.1.1.1.cmml" xref="S4.SS1.p9.1.m1.1.1.1"></in><apply id="S4.SS1.p9.1.m1.1.1.2.cmml" xref="S4.SS1.p9.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.1.m1.1.1.2.1.cmml" xref="S4.SS1.p9.1.m1.1.1.2">superscript</csymbol><ci id="S4.SS1.p9.1.m1.1.1.2.2.cmml" xref="S4.SS1.p9.1.m1.1.1.2.2">𝐴</ci><times id="S4.SS1.p9.1.m1.1.1.2.3.cmml" xref="S4.SS1.p9.1.m1.1.1.2.3"></times></apply><apply id="S4.SS1.p9.1.m1.1.1.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p9.1.m1.1.1.3.1.cmml" xref="S4.SS1.p9.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p9.1.m1.1.1.3.2.cmml" xref="S4.SS1.p9.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p9.1.m1.1.1.3.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3"><times id="S4.SS1.p9.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.p9.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3.2">𝑇</ci><ci id="S4.SS1.p9.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p9.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.1.m1.1c">A^{*}\in\mathbb{R}^{T\times N}</annotation></semantics></math>
by aggregating the RE-image groundings:</p>
</div>
<div id="S4.SS1.p10" class="ltx_para ltx_noindent">
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.3" class="ltx_Math" alttext="A^{*}=\frac{1}{|E|}{\textstyle\sum_{r=1}^{|E|}}\tilde{A_{r}^{*}}," display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3.1" xref="S4.E5.m1.3.3.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml"><msup id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.2.cmml"><mi id="S4.E5.m1.3.3.1.1.2.2" xref="S4.E5.m1.3.3.1.1.2.2.cmml">A</mi><mo id="S4.E5.m1.3.3.1.1.2.3" xref="S4.E5.m1.3.3.1.1.2.3.cmml">∗</mo></msup><mo id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.3.3.1.1.3" xref="S4.E5.m1.3.3.1.1.3.cmml"><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mn id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">1</mn><mrow id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">E</mi><mo stretchy="false" id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.3.1" xref="S4.E5.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E5.m1.3.3.1.1.3.2" xref="S4.E5.m1.3.3.1.1.3.2.cmml"><mstyle displaystyle="false" id="S4.E5.m1.3.3.1.1.3.2.1" xref="S4.E5.m1.3.3.1.1.3.2.1.cmml"><msubsup id="S4.E5.m1.3.3.1.1.3.2.1a" xref="S4.E5.m1.3.3.1.1.3.2.1.cmml"><mo id="S4.E5.m1.3.3.1.1.3.2.1.2.2" xref="S4.E5.m1.3.3.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.1.1.3.2.1.2.3" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1.3.2.1.2.3.2" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.2.cmml">r</mi><mo id="S4.E5.m1.3.3.1.1.3.2.1.2.3.1" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.3.3.1.1.3.2.1.2.3.3" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.3.1" xref="S4.E5.m1.2.2.1.2.1.cmml">|</mo><mi id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.cmml">E</mi><mo stretchy="false" id="S4.E5.m1.2.2.1.3.2" xref="S4.E5.m1.2.2.1.2.1.cmml">|</mo></mrow></msubsup></mstyle><mover accent="true" id="S4.E5.m1.3.3.1.1.3.2.2" xref="S4.E5.m1.3.3.1.1.3.2.2.cmml"><msubsup id="S4.E5.m1.3.3.1.1.3.2.2.2" xref="S4.E5.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S4.E5.m1.3.3.1.1.3.2.2.2.2.2" xref="S4.E5.m1.3.3.1.1.3.2.2.2.2.2.cmml">A</mi><mi id="S4.E5.m1.3.3.1.1.3.2.2.2.2.3" xref="S4.E5.m1.3.3.1.1.3.2.2.2.2.3.cmml">r</mi><mo id="S4.E5.m1.3.3.1.1.3.2.2.2.3" xref="S4.E5.m1.3.3.1.1.3.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E5.m1.3.3.1.1.3.2.2.1" xref="S4.E5.m1.3.3.1.1.3.2.2.1.cmml">~</mo></mover></mrow></mrow></mrow><mo id="S4.E5.m1.3.3.1.2" xref="S4.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1"><eq id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"></eq><apply id="S4.E5.m1.3.3.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2">superscript</csymbol><ci id="S4.E5.m1.3.3.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2">𝐴</ci><times id="S4.E5.m1.3.3.1.1.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.3"></times></apply><apply id="S4.E5.m1.3.3.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.3"><times id="S4.E5.m1.3.3.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.3.1"></times><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1"></divide><cn type="integer" id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3">1</cn><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.3"><abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.3.1"></abs><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝐸</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2"><apply id="S4.E5.m1.3.3.1.1.3.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.1.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1">subscript</csymbol><sum id="S4.E5.m1.3.3.1.1.3.2.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2.2"></sum><apply id="S4.E5.m1.3.3.1.1.3.2.1.2.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3"><eq id="S4.E5.m1.3.3.1.1.3.2.1.2.3.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.1"></eq><ci id="S4.E5.m1.3.3.1.1.3.2.1.2.3.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.2">𝑟</ci><cn type="integer" id="S4.E5.m1.3.3.1.1.3.2.1.2.3.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.3"><abs id="S4.E5.m1.2.2.1.2.1.cmml" xref="S4.E5.m1.2.2.1.3.1"></abs><ci id="S4.E5.m1.2.2.1.1.cmml" xref="S4.E5.m1.2.2.1.1">𝐸</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.3.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2"><ci id="S4.E5.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.1">~</ci><apply id="S4.E5.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.3.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2.2.2">𝐴</ci><ci id="S4.E5.m1.3.3.1.1.3.2.2.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2.2.3">𝑟</ci></apply><times id="S4.E5.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">A^{*}=\frac{1}{|E|}{\textstyle\sum_{r=1}^{|E|}}\tilde{A_{r}^{*}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p10.2" class="ltx_p">where <math id="S4.SS1.p10.1.m1.1" class="ltx_Math" alttext="\tilde{A_{r}^{*}}\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S4.SS1.p10.1.m1.1a"><mrow id="S4.SS1.p10.1.m1.1.1" xref="S4.SS1.p10.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p10.1.m1.1.1.2" xref="S4.SS1.p10.1.m1.1.1.2.cmml"><msubsup id="S4.SS1.p10.1.m1.1.1.2.2" xref="S4.SS1.p10.1.m1.1.1.2.2.cmml"><mi id="S4.SS1.p10.1.m1.1.1.2.2.2.2" xref="S4.SS1.p10.1.m1.1.1.2.2.2.2.cmml">A</mi><mi id="S4.SS1.p10.1.m1.1.1.2.2.2.3" xref="S4.SS1.p10.1.m1.1.1.2.2.2.3.cmml">r</mi><mo id="S4.SS1.p10.1.m1.1.1.2.2.3" xref="S4.SS1.p10.1.m1.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S4.SS1.p10.1.m1.1.1.2.1" xref="S4.SS1.p10.1.m1.1.1.2.1.cmml">~</mo></mover><mo id="S4.SS1.p10.1.m1.1.1.1" xref="S4.SS1.p10.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p10.1.m1.1.1.3" xref="S4.SS1.p10.1.m1.1.1.3.cmml"><mi id="S4.SS1.p10.1.m1.1.1.3.2" xref="S4.SS1.p10.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p10.1.m1.1.1.3.3" xref="S4.SS1.p10.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p10.1.m1.1.1.3.3.2" xref="S4.SS1.p10.1.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p10.1.m1.1.1.3.3.1" xref="S4.SS1.p10.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p10.1.m1.1.1.3.3.3" xref="S4.SS1.p10.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.1.m1.1b"><apply id="S4.SS1.p10.1.m1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1"><in id="S4.SS1.p10.1.m1.1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1.1"></in><apply id="S4.SS1.p10.1.m1.1.1.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2"><ci id="S4.SS1.p10.1.m1.1.1.2.1.cmml" xref="S4.SS1.p10.1.m1.1.1.2.1">~</ci><apply id="S4.SS1.p10.1.m1.1.1.2.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p10.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2">superscript</csymbol><apply id="S4.SS1.p10.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p10.1.m1.1.1.2.2.2.1.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p10.1.m1.1.1.2.2.2.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2.2.2">𝐴</ci><ci id="S4.SS1.p10.1.m1.1.1.2.2.2.3.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2.2.3">𝑟</ci></apply><times id="S4.SS1.p10.1.m1.1.1.2.2.3.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2.3"></times></apply></apply><apply id="S4.SS1.p10.1.m1.1.1.3.cmml" xref="S4.SS1.p10.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p10.1.m1.1.1.3.1.cmml" xref="S4.SS1.p10.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p10.1.m1.1.1.3.2.cmml" xref="S4.SS1.p10.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p10.1.m1.1.1.3.3.cmml" xref="S4.SS1.p10.1.m1.1.1.3.3"><times id="S4.SS1.p10.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p10.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.p10.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p10.1.m1.1.1.3.3.2">𝑇</ci><ci id="S4.SS1.p10.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p10.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.1.m1.1c">\tilde{A_{r}^{*}}\in\mathbb{R}^{T\times N}</annotation></semantics></math> is the zero-padded
matrix of the matrix <math id="S4.SS1.p10.2.m2.1" class="ltx_Math" alttext="A_{r}^{*}" display="inline"><semantics id="S4.SS1.p10.2.m2.1a"><msubsup id="S4.SS1.p10.2.m2.1.1" xref="S4.SS1.p10.2.m2.1.1.cmml"><mi id="S4.SS1.p10.2.m2.1.1.2.2" xref="S4.SS1.p10.2.m2.1.1.2.2.cmml">A</mi><mi id="S4.SS1.p10.2.m2.1.1.2.3" xref="S4.SS1.p10.2.m2.1.1.2.3.cmml">r</mi><mo id="S4.SS1.p10.2.m2.1.1.3" xref="S4.SS1.p10.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.2.m2.1b"><apply id="S4.SS1.p10.2.m2.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p10.2.m2.1.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p10.2.m2.1.1.2.cmml" xref="S4.SS1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p10.2.m2.1.1.2.1.cmml" xref="S4.SS1.p10.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p10.2.m2.1.1.2.2.cmml" xref="S4.SS1.p10.2.m2.1.1.2.2">𝐴</ci><ci id="S4.SS1.p10.2.m2.1.1.2.3.cmml" xref="S4.SS1.p10.2.m2.1.1.2.3">𝑟</ci></apply><times id="S4.SS1.p10.2.m2.1.1.3.cmml" xref="S4.SS1.p10.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.2.m2.1c">A_{r}^{*}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p11" class="ltx_para ltx_noindent">
<p id="S4.SS1.p11.1" class="ltx_p">Besides making grounding more expressive, this divide-and-conquer
strategy has the extra benefit of augmenting the weak supervising
labels from query-image to RE-image pairs, which increase the amount
of supervising signals (positive pairs) and facilitate better training
of the contrastive learning framework.</p>
</div>
<div id="S4.SS1.p12" class="ltx_para ltx_noindent">
<p id="S4.SS1.p12.1" class="ltx_p">The discovered grounding provides a valuable source of priors for
VQA attention. Existing works <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>; Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>
use attention priors to regulate the gradient flow of VQA models during
training, hence only constraining the attention weights indirectly.
Unlike these methods, we directly guide the computation of attention
weights via two pathways: through pre-training them without answers,
and by refining in VQA inference on a case-by-case basis.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Pre-training VQA Attention </h4>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">A typical VQA system seeks to ground linguistic concepts parsed
from the question to the associated visual parts through cross-modal
attention. However, this attention mechanism is guided only indirectly
and distantly through sparse training signal of the answers. This
training signal is too weak to assure that relevant associations can
be discovered. To directly train the attention weights to reflect
these natural associations, we pre-train VQA models by enforcing the
attention weights to be close to the alignment maps <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="A^{*}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">A</mi><mo id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐴</ci><times id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">A^{*}</annotation></semantics></math> discovered
through unsupervised grounding in Sec. <a href="#S4.SS1" title="4.1 Structures for Linguistic-Visual Alignment ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.2" class="ltx_p">For joint attention VQA models, this is achieved through minimizing
the Kullback-Leibler divergence between vectorized forms of the VQA
visual attention weights <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">A</annotation></semantics></math> and the prior grounding scores <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="A^{*}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">A</mi><mo id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝐴</ci><times id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">A^{*}</annotation></semantics></math>:</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<table id="A2.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{pre-train}}" display="inline"><semantics id="S4.E6.m1.1a"><msub id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3a.cmml">pre-train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2">ℒ</ci><ci id="S4.E6.m1.1.1.3a.cmml" xref="S4.E6.m1.1.1.3"><mtext mathsize="70%" id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3">pre-train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\mathcal{L}_{\text{pre-train}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6.m2.1" class="ltx_math_unparsed" alttext="\displaystyle=KL(\text{norm}\circ\text{vec(}A^{*})\parallel\text{norm}\circ\text{vec}(A))," display="inline"><semantics id="S4.E6.m2.1a"><mrow id="S4.E6.m2.1b"><mo id="S4.E6.m2.1.2">=</mo><mi id="S4.E6.m2.1.3">K</mi><mi id="S4.E6.m2.1.4">L</mi><mrow id="S4.E6.m2.1.5"><mo stretchy="false" id="S4.E6.m2.1.5.1">(</mo><mtext id="S4.E6.m2.1.5.2">norm</mtext><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m2.1.5.3">∘</mo><mtext id="S4.E6.m2.1.5.4">vec(</mtext><msup id="S4.E6.m2.1.5.5"><mi id="S4.E6.m2.1.5.5.2">A</mi><mo id="S4.E6.m2.1.5.5.3">∗</mo></msup><mo stretchy="false" id="S4.E6.m2.1.5.6">)</mo></mrow><mo lspace="0em" rspace="0.167em" id="S4.E6.m2.1.6">∥</mo><mtext id="S4.E6.m2.1.7">norm</mtext><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m2.1.8">∘</mo><mtext id="S4.E6.m2.1.9">vec</mtext><mrow id="S4.E6.m2.1.10"><mo stretchy="false" id="S4.E6.m2.1.10.1">(</mo><mi id="S4.E6.m2.1.1">A</mi><mo stretchy="false" id="S4.E6.m2.1.10.2">)</mo></mrow><mo stretchy="false" id="S4.E6.m2.1.11">)</mo><mo id="S4.E6.m2.1.12">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E6.m2.1c">\displaystyle=KL(\text{norm}\circ\text{vec(}A^{*})\parallel\text{norm}\circ\text{vec}(A)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.1" class="ltx_p">where <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\text{norm}\circ\text{vec}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mtext id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2a.cmml">norm</mtext><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">∘</mo><mtext id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3a.cmml">vec</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><compose id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></compose><ci id="S4.SS2.p3.1.m1.1.1.2a.cmml" xref="S4.SS2.p3.1.m1.1.1.2"><mtext id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">norm</mtext></ci><ci id="S4.SS2.p3.1.m1.1.1.3a.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><mtext id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">vec</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\text{norm}\circ\text{vec}</annotation></semantics></math>
flattens a matrix into a vector followed by a normalization operator
ensuring such vector sums to one.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.1" class="ltx_p">For VQA marginalized attention models, we first marginalize <math id="S4.SS2.p4.1.m1.3" class="ltx_Math" alttext="A^{*}=\left(a_{i,j}^{*}\right)\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S4.SS2.p4.1.m1.3a"><mrow id="S4.SS2.p4.1.m1.3.3" xref="S4.SS2.p4.1.m1.3.3.cmml"><msup id="S4.SS2.p4.1.m1.3.3.3" xref="S4.SS2.p4.1.m1.3.3.3.cmml"><mi id="S4.SS2.p4.1.m1.3.3.3.2" xref="S4.SS2.p4.1.m1.3.3.3.2.cmml">A</mi><mo id="S4.SS2.p4.1.m1.3.3.3.3" xref="S4.SS2.p4.1.m1.3.3.3.3.cmml">∗</mo></msup><mo id="S4.SS2.p4.1.m1.3.3.4" xref="S4.SS2.p4.1.m1.3.3.4.cmml">=</mo><mrow id="S4.SS2.p4.1.m1.3.3.1.1" xref="S4.SS2.p4.1.m1.3.3.1.1.1.cmml"><mo id="S4.SS2.p4.1.m1.3.3.1.1.2" xref="S4.SS2.p4.1.m1.3.3.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p4.1.m1.3.3.1.1.1" xref="S4.SS2.p4.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.3.3.1.1.1.2.2" xref="S4.SS2.p4.1.m1.3.3.1.1.1.2.2.cmml">a</mi><mrow id="S4.SS2.p4.1.m1.2.2.2.4" xref="S4.SS2.p4.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p4.1.m1.2.2.2.4.1" xref="S4.SS2.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p4.1.m1.2.2.2.2" xref="S4.SS2.p4.1.m1.2.2.2.2.cmml">j</mi></mrow><mo id="S4.SS2.p4.1.m1.3.3.1.1.1.3" xref="S4.SS2.p4.1.m1.3.3.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.SS2.p4.1.m1.3.3.1.1.3" xref="S4.SS2.p4.1.m1.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p4.1.m1.3.3.5" xref="S4.SS2.p4.1.m1.3.3.5.cmml">∈</mo><msup id="S4.SS2.p4.1.m1.3.3.6" xref="S4.SS2.p4.1.m1.3.3.6.cmml"><mi id="S4.SS2.p4.1.m1.3.3.6.2" xref="S4.SS2.p4.1.m1.3.3.6.2.cmml">ℝ</mi><mrow id="S4.SS2.p4.1.m1.3.3.6.3" xref="S4.SS2.p4.1.m1.3.3.6.3.cmml"><mi id="S4.SS2.p4.1.m1.3.3.6.3.2" xref="S4.SS2.p4.1.m1.3.3.6.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p4.1.m1.3.3.6.3.1" xref="S4.SS2.p4.1.m1.3.3.6.3.1.cmml">×</mo><mi id="S4.SS2.p4.1.m1.3.3.6.3.3" xref="S4.SS2.p4.1.m1.3.3.6.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.3b"><apply id="S4.SS2.p4.1.m1.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3"><and id="S4.SS2.p4.1.m1.3.3a.cmml" xref="S4.SS2.p4.1.m1.3.3"></and><apply id="S4.SS2.p4.1.m1.3.3b.cmml" xref="S4.SS2.p4.1.m1.3.3"><eq id="S4.SS2.p4.1.m1.3.3.4.cmml" xref="S4.SS2.p4.1.m1.3.3.4"></eq><apply id="S4.SS2.p4.1.m1.3.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.3.1.cmml" xref="S4.SS2.p4.1.m1.3.3.3">superscript</csymbol><ci id="S4.SS2.p4.1.m1.3.3.3.2.cmml" xref="S4.SS2.p4.1.m1.3.3.3.2">𝐴</ci><times id="S4.SS2.p4.1.m1.3.3.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3.3.3"></times></apply><apply id="S4.SS2.p4.1.m1.3.3.1.1.1.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1">superscript</csymbol><apply id="S4.SS2.p4.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.3.3.1.1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1.1.2.2">𝑎</ci><list id="S4.SS2.p4.1.m1.2.2.2.3.cmml" xref="S4.SS2.p4.1.m1.2.2.2.4"><ci id="S4.SS2.p4.1.m1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p4.1.m1.2.2.2.2.cmml" xref="S4.SS2.p4.1.m1.2.2.2.2">𝑗</ci></list></apply><times id="S4.SS2.p4.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.3.3.1.1.1.3"></times></apply></apply><apply id="S4.SS2.p4.1.m1.3.3c.cmml" xref="S4.SS2.p4.1.m1.3.3"><in id="S4.SS2.p4.1.m1.3.3.5.cmml" xref="S4.SS2.p4.1.m1.3.3.5"></in><share href="#S4.SS2.p4.1.m1.3.3.1.cmml" id="S4.SS2.p4.1.m1.3.3d.cmml" xref="S4.SS2.p4.1.m1.3.3"></share><apply id="S4.SS2.p4.1.m1.3.3.6.cmml" xref="S4.SS2.p4.1.m1.3.3.6"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.6.1.cmml" xref="S4.SS2.p4.1.m1.3.3.6">superscript</csymbol><ci id="S4.SS2.p4.1.m1.3.3.6.2.cmml" xref="S4.SS2.p4.1.m1.3.3.6.2">ℝ</ci><apply id="S4.SS2.p4.1.m1.3.3.6.3.cmml" xref="S4.SS2.p4.1.m1.3.3.6.3"><times id="S4.SS2.p4.1.m1.3.3.6.3.1.cmml" xref="S4.SS2.p4.1.m1.3.3.6.3.1"></times><ci id="S4.SS2.p4.1.m1.3.3.6.3.2.cmml" xref="S4.SS2.p4.1.m1.3.3.6.3.2">𝑇</ci><ci id="S4.SS2.p4.1.m1.3.3.6.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3.6.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.3c">A^{*}=\left(a_{i,j}^{*}\right)\in\mathbb{R}^{T\times N}</annotation></semantics></math>
into a vector of visual attention prior:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.3" class="ltx_Math" alttext="\beta^{*}=\frac{1}{T}{\textstyle\sum_{i=1}^{T}}\text{norm}_{j}(a_{i,j}^{*})." display="block"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><msup id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.2" xref="S4.E7.m1.3.3.1.1.3.2.cmml">β</mi><mo id="S4.E7.m1.3.3.1.1.3.3" xref="S4.E7.m1.3.3.1.1.3.3.cmml">∗</mo></msup><mo id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.cmml"><mfrac id="S4.E7.m1.3.3.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.3.cmml"><mn id="S4.E7.m1.3.3.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.3.2.cmml">1</mn><mi id="S4.E7.m1.3.3.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.3.3.cmml">T</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="false" id="S4.E7.m1.3.3.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.2.cmml"><msubsup id="S4.E7.m1.3.3.1.1.1.1.2a" xref="S4.E7.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.2.2.3" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.2.2.3.2" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E7.m1.3.3.1.1.1.1.2.2.3.1" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E7.m1.3.3.1.1.1.1.2.2.3.3" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.3.3.1.1.1.1.2.3" xref="S4.E7.m1.3.3.1.1.1.1.2.3.cmml">T</mi></msubsup></mstyle><mrow id="S4.E7.m1.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml"><msub id="S4.E7.m1.3.3.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.cmml"><mtext id="S4.E7.m1.3.3.1.1.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.1.1.3.2a.cmml">norm</mtext><mi id="S4.E7.m1.3.3.1.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.3.cmml"><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">i</mi><mo id="S4.E7.m1.2.2.2.4.1" xref="S4.E7.m1.2.2.2.3.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">j</mi></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><eq id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2"></eq><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2">𝛽</ci><times id="S4.E7.m1.3.3.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3"></times></apply><apply id="S4.E7.m1.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.2"></times><apply id="S4.E7.m1.3.3.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.3"><divide id="S4.E7.m1.3.3.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S4.E7.m1.3.3.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.3.2">1</cn><ci id="S4.E7.m1.3.3.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.3.3">𝑇</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><apply id="S4.E7.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S4.E7.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3"><eq id="S4.E7.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S4.E7.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E7.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.2"></times><apply id="S4.E7.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.3.2a.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.2"><mtext id="S4.E7.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.2">norm</mtext></ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.4"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑖</ci><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝑗</ci></list></apply><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\beta^{*}=\frac{1}{T}{\textstyle\sum_{i=1}^{T}}\text{norm}_{j}(a_{i,j}^{*}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.2" class="ltx_p">The pre-training loss is the KL divergence between the attention weights
and their priors:</p>
<table id="A2.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{pre-train}}" display="inline"><semantics id="S4.E8.m1.1a"><msub id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3a.cmml">pre-train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2">ℒ</ci><ci id="S4.E8.m1.1.1.3a.cmml" xref="S4.E8.m1.1.1.3"><mtext mathsize="70%" id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3">pre-train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\mathcal{L}_{\text{pre-train}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E8.m2.1" class="ltx_Math" alttext="\displaystyle=KL(\beta^{*}\parallel\beta)." display="inline"><semantics id="S4.E8.m2.1a"><mrow id="S4.E8.m2.1.1.1" xref="S4.E8.m2.1.1.1.1.cmml"><mrow id="S4.E8.m2.1.1.1.1" xref="S4.E8.m2.1.1.1.1.cmml"><mi id="S4.E8.m2.1.1.1.1.3" xref="S4.E8.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E8.m2.1.1.1.1.2" xref="S4.E8.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8.m2.1.1.1.1.1" xref="S4.E8.m2.1.1.1.1.1.cmml"><mi id="S4.E8.m2.1.1.1.1.1.3" xref="S4.E8.m2.1.1.1.1.1.3.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.1.1.1.1.1.2" xref="S4.E8.m2.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m2.1.1.1.1.1.4" xref="S4.E8.m2.1.1.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.1.1.1.1.1.2a" xref="S4.E8.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m2.1.1.1.1.1.1.1" xref="S4.E8.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m2.1.1.1.1.1.1.1.2" xref="S4.E8.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m2.1.1.1.1.1.1.1.1" xref="S4.E8.m2.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E8.m2.1.1.1.1.1.1.1.1.2" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="S4.E8.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="S4.E8.m2.1.1.1.1.1.1.1.1.1" xref="S4.E8.m2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S4.E8.m2.1.1.1.1.1.1.1.1.3" xref="S4.E8.m2.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E8.m2.1.1.1.1.1.1.1.3" xref="S4.E8.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E8.m2.1.1.1.2" xref="S4.E8.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m2.1b"><apply id="S4.E8.m2.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1"><eq id="S4.E8.m2.1.1.1.1.2.cmml" xref="S4.E8.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E8.m2.1.1.1.1.3.cmml" xref="S4.E8.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E8.m2.1.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1.1"><times id="S4.E8.m2.1.1.1.1.1.2.cmml" xref="S4.E8.m2.1.1.1.1.1.2"></times><ci id="S4.E8.m2.1.1.1.1.1.3.cmml" xref="S4.E8.m2.1.1.1.1.1.3">𝐾</ci><ci id="S4.E8.m2.1.1.1.1.1.4.cmml" xref="S4.E8.m2.1.1.1.1.1.4">𝐿</ci><apply id="S4.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E8.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E8.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2.2">𝛽</ci><times id="S4.E8.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.2.3"></times></apply><ci id="S4.E8.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m2.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m2.1c">\displaystyle=KL(\beta^{*}\parallel\beta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Attention Refinement with Attention Priors </h4>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Marginalized attention refinement</h5>

<div id="S4.SS3.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p1.8" class="ltx_p">Recall from Sec. <a href="#S3" title="3 Preliminaries ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> that a marginalized attention
VQA model computes linguistic attention over <math id="S4.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.SSS1.p1.1.m1.1a"><mi id="S4.SS3.SSS1.p1.1.m1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.1.m1.1b"><ci id="S4.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.1c">T</annotation></semantics></math> query words <math id="S4.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha\in\mathbb{R}^{T}" display="inline"><semantics id="S4.SS3.SSS1.p1.2.m2.1a"><mrow id="S4.SS3.SSS1.p1.2.m2.1.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p1.2.m2.1.1.2" xref="S4.SS3.SSS1.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS1.p1.2.m2.1.1.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.2.m2.1.1.3" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.SSS1.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.2.m2.1b"><apply id="S4.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1"><in id="S4.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.1"></in><ci id="S4.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.2">𝛼</ci><apply id="S4.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S4.SS3.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.2.m2.1c">\alpha\in\mathbb{R}^{T}</annotation></semantics></math>
and visual attention over <math id="S4.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.SSS1.p1.3.m3.1a"><mi id="S4.SS3.SSS1.p1.3.m3.1.1" xref="S4.SS3.SSS1.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.3.m3.1b"><ci id="S4.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.3.m3.1c">N</annotation></semantics></math> visual regions <math id="S4.SS3.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\beta\in\mathbb{R}^{N}" display="inline"><semantics id="S4.SS3.SSS1.p1.4.m4.1a"><mrow id="S4.SS3.SSS1.p1.4.m4.1.1" xref="S4.SS3.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p1.4.m4.1.1.2" xref="S4.SS3.SSS1.p1.4.m4.1.1.2.cmml">β</mi><mo id="S4.SS3.SSS1.p1.4.m4.1.1.1" xref="S4.SS3.SSS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.4.m4.1.1.3" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.SSS1.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.4.m4.1b"><apply id="S4.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1"><in id="S4.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.1"></in><ci id="S4.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.2">𝛽</ci><apply id="S4.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S4.SS3.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.4.m4.1c">\beta\in\mathbb{R}^{N}</annotation></semantics></math>.
In this section, we propose to directly refine these attentions using
attention priors <math id="S4.SS3.SSS1.p1.5.m5.3" class="ltx_Math" alttext="A^{*}=\left(a_{i,j}^{*}\right)\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S4.SS3.SSS1.p1.5.m5.3a"><mrow id="S4.SS3.SSS1.p1.5.m5.3.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.cmml"><msup id="S4.SS3.SSS1.p1.5.m5.3.3.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.3.cmml"><mi id="S4.SS3.SSS1.p1.5.m5.3.3.3.2" xref="S4.SS3.SSS1.p1.5.m5.3.3.3.2.cmml">A</mi><mo id="S4.SS3.SSS1.p1.5.m5.3.3.3.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.3.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS1.p1.5.m5.3.3.4" xref="S4.SS3.SSS1.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S4.SS3.SSS1.p1.5.m5.3.3.1.1" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml"><mo id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.2" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml">(</mo><msubsup id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml"><mi id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.2" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.2.cmml">a</mi><mrow id="S4.SS3.SSS1.p1.5.m5.2.2.2.4" xref="S4.SS3.SSS1.p1.5.m5.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p1.5.m5.1.1.1.1" xref="S4.SS3.SSS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS3.SSS1.p1.5.m5.2.2.2.4.1" xref="S4.SS3.SSS1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS3.SSS1.p1.5.m5.2.2.2.2" xref="S4.SS3.SSS1.p1.5.m5.2.2.2.2.cmml">j</mi></mrow><mo id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.SSS1.p1.5.m5.3.3.5" xref="S4.SS3.SSS1.p1.5.m5.3.3.5.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.5.m5.3.3.6" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.cmml"><mi id="S4.SS3.SSS1.p1.5.m5.3.3.6.2" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS1.p1.5.m5.3.3.6.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.cmml"><mi id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.2" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.1" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.1.cmml">×</mo><mi id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.3" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.5.m5.3b"><apply id="S4.SS3.SSS1.p1.5.m5.3.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3"><and id="S4.SS3.SSS1.p1.5.m5.3.3a.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3"></and><apply id="S4.SS3.SSS1.p1.5.m5.3.3b.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3"><eq id="S4.SS3.SSS1.p1.5.m5.3.3.4.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.4"></eq><apply id="S4.SS3.SSS1.p1.5.m5.3.3.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.5.m5.3.3.3.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.5.m5.3.3.3.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.3.2">𝐴</ci><times id="S4.SS3.SSS1.p1.5.m5.3.3.3.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.3.3"></times></apply><apply id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.2">𝑎</ci><list id="S4.SS3.SSS1.p1.5.m5.2.2.2.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.2.2.2.4"><ci id="S4.SS3.SSS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS3.SSS1.p1.5.m5.2.2.2.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.2.2.2.2">𝑗</ci></list></apply><times id="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.1.1.1.3"></times></apply></apply><apply id="S4.SS3.SSS1.p1.5.m5.3.3c.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3"><in id="S4.SS3.SSS1.p1.5.m5.3.3.5.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.5"></in><share href="#S4.SS3.SSS1.p1.5.m5.3.3.1.cmml" id="S4.SS3.SSS1.p1.5.m5.3.3d.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3"></share><apply id="S4.SS3.SSS1.p1.5.m5.3.3.6.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.5.m5.3.3.6.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6">superscript</csymbol><ci id="S4.SS3.SSS1.p1.5.m5.3.3.6.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.2">ℝ</ci><apply id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3"><times id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.1"></times><ci id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.2.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.2">𝑇</ci><ci id="S4.SS3.SSS1.p1.5.m5.3.3.6.3.3.cmml" xref="S4.SS3.SSS1.p1.5.m5.3.3.6.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.5.m5.3c">A^{*}=\left(a_{i,j}^{*}\right)\in\mathbb{R}^{T\times N}</annotation></semantics></math>
learned in Sec. <a href="#S4.SS1" title="4.1 Structures for Linguistic-Visual Alignment ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. First, <math id="S4.SS3.SSS1.p1.6.m6.1" class="ltx_Math" alttext="A^{*}" display="inline"><semantics id="S4.SS3.SSS1.p1.6.m6.1a"><msup id="S4.SS3.SSS1.p1.6.m6.1.1" xref="S4.SS3.SSS1.p1.6.m6.1.1.cmml"><mi id="S4.SS3.SSS1.p1.6.m6.1.1.2" xref="S4.SS3.SSS1.p1.6.m6.1.1.2.cmml">A</mi><mo id="S4.SS3.SSS1.p1.6.m6.1.1.3" xref="S4.SS3.SSS1.p1.6.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.6.m6.1b"><apply id="S4.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p1.6.m6.1.1.2">𝐴</ci><times id="S4.SS3.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p1.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.6.m6.1c">A^{*}</annotation></semantics></math> is marginalized
over rows and columns to obtain a pair of attention priors vectors
<math id="S4.SS3.SSS1.p1.7.m7.1" class="ltx_Math" alttext="\alpha^{*}\in\mathbb{R}^{T}" display="inline"><semantics id="S4.SS3.SSS1.p1.7.m7.1a"><mrow id="S4.SS3.SSS1.p1.7.m7.1.1" xref="S4.SS3.SSS1.p1.7.m7.1.1.cmml"><msup id="S4.SS3.SSS1.p1.7.m7.1.1.2" xref="S4.SS3.SSS1.p1.7.m7.1.1.2.cmml"><mi id="S4.SS3.SSS1.p1.7.m7.1.1.2.2" xref="S4.SS3.SSS1.p1.7.m7.1.1.2.2.cmml">α</mi><mo id="S4.SS3.SSS1.p1.7.m7.1.1.2.3" xref="S4.SS3.SSS1.p1.7.m7.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS1.p1.7.m7.1.1.1" xref="S4.SS3.SSS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.7.m7.1.1.3" xref="S4.SS3.SSS1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.7.m7.1.1.3.2" xref="S4.SS3.SSS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.SSS1.p1.7.m7.1.1.3.3" xref="S4.SS3.SSS1.p1.7.m7.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.7.m7.1b"><apply id="S4.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1"><in id="S4.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.1"></in><apply id="S4.SS3.SSS1.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.2.2">𝛼</ci><times id="S4.SS3.SSS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.2.3"></times></apply><apply id="S4.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.3.2">ℝ</ci><ci id="S4.SS3.SSS1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.SSS1.p1.7.m7.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.7.m7.1c">\alpha^{*}\in\mathbb{R}^{T}</annotation></semantics></math> and <math id="S4.SS3.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\beta^{*}\in\mathbb{R}^{N}" display="inline"><semantics id="S4.SS3.SSS1.p1.8.m8.1a"><mrow id="S4.SS3.SSS1.p1.8.m8.1.1" xref="S4.SS3.SSS1.p1.8.m8.1.1.cmml"><msup id="S4.SS3.SSS1.p1.8.m8.1.1.2" xref="S4.SS3.SSS1.p1.8.m8.1.1.2.cmml"><mi id="S4.SS3.SSS1.p1.8.m8.1.1.2.2" xref="S4.SS3.SSS1.p1.8.m8.1.1.2.2.cmml">β</mi><mo id="S4.SS3.SSS1.p1.8.m8.1.1.2.3" xref="S4.SS3.SSS1.p1.8.m8.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS1.p1.8.m8.1.1.1" xref="S4.SS3.SSS1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.8.m8.1.1.3" xref="S4.SS3.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.8.m8.1.1.3.2" xref="S4.SS3.SSS1.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.SSS1.p1.8.m8.1.1.3.3" xref="S4.SS3.SSS1.p1.8.m8.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.8.m8.1b"><apply id="S4.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1"><in id="S4.SS3.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.1"></in><apply id="S4.SS3.SSS1.p1.8.m8.1.1.2.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.8.m8.1.1.2.1.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS1.p1.8.m8.1.1.2.2.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.2.2">𝛽</ci><times id="S4.SS3.SSS1.p1.8.m8.1.1.2.3.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.2.3"></times></apply><apply id="S4.SS3.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.3.2">ℝ</ci><ci id="S4.SS3.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S4.SS3.SSS1.p1.8.m8.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.8.m8.1c">\beta^{*}\in\mathbb{R}^{N}</annotation></semantics></math>:</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<table id="A2.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\displaystyle\alpha^{*}" display="inline"><semantics id="S4.E9.m1.1a"><msup id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mi id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml">α</mi><mo id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1">superscript</csymbol><ci id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2">𝛼</ci><times id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\displaystyle\alpha^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E9.m2.5" class="ltx_Math" alttext="\displaystyle=\frac{1}{N}\sum_{j=1}^{N}\text{norm}_{i}(a_{i,j}^{*});\&gt;\beta^{*}=\frac{1}{T}\sum_{i=1}^{T}\text{norm}_{j}(a_{i,j}^{*})." display="inline"><semantics id="S4.E9.m2.5a"><mrow id="S4.E9.m2.5.5.1"><mrow id="S4.E9.m2.5.5.1.1.2" xref="S4.E9.m2.5.5.1.1.3.cmml"><mrow id="S4.E9.m2.5.5.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.cmml"><mi id="S4.E9.m2.5.5.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.1.1.3.cmml"></mi><mo id="S4.E9.m2.5.5.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9.m2.5.5.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m2.5.5.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.1.1.1.3.cmml"><mfrac id="S4.E9.m2.5.5.1.1.1.1.1.3a" xref="S4.E9.m2.5.5.1.1.1.1.1.3.cmml"><mn id="S4.E9.m2.5.5.1.1.1.1.1.3.2" xref="S4.E9.m2.5.5.1.1.1.1.1.3.2.cmml">1</mn><mi id="S4.E9.m2.5.5.1.1.1.1.1.3.3" xref="S4.E9.m2.5.5.1.1.1.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E9.m2.5.5.1.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m2.5.5.1.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m2.5.5.1.1.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.cmml"><munderover id="S4.E9.m2.5.5.1.1.1.1.1.1.2a" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.1" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m2.5.5.1.1.1.1.1.1.2.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E9.m2.5.5.1.1.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.cmml"><msub id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.cmml"><mtext id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2a.cmml">norm</mtext><mi id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.E9.m2.2.2.2.4" xref="S4.E9.m2.2.2.2.3.cmml"><mi id="S4.E9.m2.1.1.1.1" xref="S4.E9.m2.1.1.1.1.cmml">i</mi><mo id="S4.E9.m2.2.2.2.4.1" xref="S4.E9.m2.2.2.2.3.cmml">,</mo><mi id="S4.E9.m2.2.2.2.2" xref="S4.E9.m2.2.2.2.2.cmml">j</mi></mrow><mo id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo rspace="0.387em" id="S4.E9.m2.5.5.1.1.2.3" xref="S4.E9.m2.5.5.1.1.3a.cmml">;</mo><mrow id="S4.E9.m2.5.5.1.1.2.2" xref="S4.E9.m2.5.5.1.1.2.2.cmml"><msup id="S4.E9.m2.5.5.1.1.2.2.3" xref="S4.E9.m2.5.5.1.1.2.2.3.cmml"><mi id="S4.E9.m2.5.5.1.1.2.2.3.2" xref="S4.E9.m2.5.5.1.1.2.2.3.2.cmml">β</mi><mo id="S4.E9.m2.5.5.1.1.2.2.3.3" xref="S4.E9.m2.5.5.1.1.2.2.3.3.cmml">∗</mo></msup><mo id="S4.E9.m2.5.5.1.1.2.2.2" xref="S4.E9.m2.5.5.1.1.2.2.2.cmml">=</mo><mrow id="S4.E9.m2.5.5.1.1.2.2.1" xref="S4.E9.m2.5.5.1.1.2.2.1.cmml"><mstyle displaystyle="true" id="S4.E9.m2.5.5.1.1.2.2.1.3" xref="S4.E9.m2.5.5.1.1.2.2.1.3.cmml"><mfrac id="S4.E9.m2.5.5.1.1.2.2.1.3a" xref="S4.E9.m2.5.5.1.1.2.2.1.3.cmml"><mn id="S4.E9.m2.5.5.1.1.2.2.1.3.2" xref="S4.E9.m2.5.5.1.1.2.2.1.3.2.cmml">1</mn><mi id="S4.E9.m2.5.5.1.1.2.2.1.3.3" xref="S4.E9.m2.5.5.1.1.2.2.1.3.3.cmml">T</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E9.m2.5.5.1.1.2.2.1.2" xref="S4.E9.m2.5.5.1.1.2.2.1.2.cmml">​</mo><mrow id="S4.E9.m2.5.5.1.1.2.2.1.1" xref="S4.E9.m2.5.5.1.1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m2.5.5.1.1.2.2.1.1.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.cmml"><munderover id="S4.E9.m2.5.5.1.1.2.2.1.1.2a" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.cmml"><mi id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.1" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m2.5.5.1.1.2.2.1.1.2.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S4.E9.m2.5.5.1.1.2.2.1.1.1" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.cmml"><msub id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.cmml"><mtext id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2a.cmml">norm</mtext><mi id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.2" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.E9.m2.4.4.2.4" xref="S4.E9.m2.4.4.2.3.cmml"><mi id="S4.E9.m2.3.3.1.1" xref="S4.E9.m2.3.3.1.1.cmml">i</mi><mo id="S4.E9.m2.4.4.2.4.1" xref="S4.E9.m2.4.4.2.3.cmml">,</mo><mi id="S4.E9.m2.4.4.2.2" xref="S4.E9.m2.4.4.2.2.cmml">j</mi></mrow><mo id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.3" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E9.m2.5.5.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m2.5b"><apply id="S4.E9.m2.5.5.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.3a.cmml" xref="S4.E9.m2.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E9.m2.5.5.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1"><eq id="S4.E9.m2.5.5.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E9.m2.5.5.1.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.3">absent</csymbol><apply id="S4.E9.m2.5.5.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1"><times id="S4.E9.m2.5.5.1.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.2"></times><apply id="S4.E9.m2.5.5.1.1.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.3"><divide id="S4.E9.m2.5.5.1.1.1.1.1.3.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.3"></divide><cn type="integer" id="S4.E9.m2.5.5.1.1.1.1.1.3.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.3.2">1</cn><ci id="S4.E9.m2.5.5.1.1.1.1.1.3.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1"><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3"><eq id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m2.5.5.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1"><times id="S4.E9.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.2"></times><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2a.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2"><mtext id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.2">norm</mtext></ci><ci id="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.E9.m2.2.2.2.3.cmml" xref="S4.E9.m2.2.2.2.4"><ci id="S4.E9.m2.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1.1">𝑖</ci><ci id="S4.E9.m2.2.2.2.2.cmml" xref="S4.E9.m2.2.2.2.2">𝑗</ci></list></apply><times id="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.1.1.1.1.1.1.1.1.3"></times></apply></apply></apply></apply></apply><apply id="S4.E9.m2.5.5.1.1.2.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2"><eq id="S4.E9.m2.5.5.1.1.2.2.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.2"></eq><apply id="S4.E9.m2.5.5.1.1.2.2.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.3.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.3">superscript</csymbol><ci id="S4.E9.m2.5.5.1.1.2.2.3.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.3.2">𝛽</ci><times id="S4.E9.m2.5.5.1.1.2.2.3.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.3.3"></times></apply><apply id="S4.E9.m2.5.5.1.1.2.2.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1"><times id="S4.E9.m2.5.5.1.1.2.2.1.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.2"></times><apply id="S4.E9.m2.5.5.1.1.2.2.1.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.3"><divide id="S4.E9.m2.5.5.1.1.2.2.1.3.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.3"></divide><cn type="integer" id="S4.E9.m2.5.5.1.1.2.2.1.3.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.3.2">1</cn><ci id="S4.E9.m2.5.5.1.1.2.2.1.3.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.3.3">𝑇</ci></apply><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1"><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.1.1.2.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2">superscript</csymbol><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2">subscript</csymbol><sum id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.2"></sum><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3"><eq id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.1"></eq><ci id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m2.5.5.1.1.2.2.1.1.2.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.2.3">𝑇</ci></apply><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1"><times id="S4.E9.m2.5.5.1.1.2.2.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.2"></times><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2a.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2"><mtext id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.2">norm</mtext></ci><ci id="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.E9.m2.4.4.2.3.cmml" xref="S4.E9.m2.4.4.2.4"><ci id="S4.E9.m2.3.3.1.1.cmml" xref="S4.E9.m2.3.3.1.1">𝑖</ci><ci id="S4.E9.m2.4.4.2.2.cmml" xref="S4.E9.m2.4.4.2.2">𝑗</ci></list></apply><times id="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E9.m2.5.5.1.1.2.2.1.1.1.1.1.1.3"></times></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m2.5c">\displaystyle=\frac{1}{N}\sum_{j=1}^{N}\text{norm}_{i}(a_{i,j}^{*});\&gt;\beta^{*}=\frac{1}{T}\sum_{i=1}^{T}\text{norm}_{j}(a_{i,j}^{*}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p3.4" class="ltx_p">We then refine <math id="S4.SS3.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.SSS1.p3.1.m1.1a"><mi id="S4.SS3.SSS1.p3.1.m1.1.1" xref="S4.SS3.SSS1.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.1.m1.1b"><ci id="S4.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S4.SS3.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS1.p3.2.m2.1a"><mi id="S4.SS3.SSS1.p3.2.m2.1.1" xref="S4.SS3.SSS1.p3.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.2.m2.1b"><ci id="S4.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p3.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.2.m2.1c">\beta</annotation></semantics></math> inside the reasoning process
through a gating mechanism to return refined attention weights <math id="S4.SS3.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\alpha^{\prime}" display="inline"><semantics id="S4.SS3.SSS1.p3.3.m3.1a"><msup id="S4.SS3.SSS1.p3.3.m3.1.1" xref="S4.SS3.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS3.SSS1.p3.3.m3.1.1.2" xref="S4.SS3.SSS1.p3.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS1.p3.3.m3.1.1.3" xref="S4.SS3.SSS1.p3.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.3.m3.1b"><apply id="S4.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.2">𝛼</ci><ci id="S4.SS3.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p3.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.3.m3.1c">\alpha^{\prime}</annotation></semantics></math>
and <math id="S4.SS3.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\beta^{\prime}" display="inline"><semantics id="S4.SS3.SSS1.p3.4.m4.1a"><msup id="S4.SS3.SSS1.p3.4.m4.1.1" xref="S4.SS3.SSS1.p3.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p3.4.m4.1.1.2" xref="S4.SS3.SSS1.p3.4.m4.1.1.2.cmml">β</mi><mo id="S4.SS3.SSS1.p3.4.m4.1.1.3" xref="S4.SS3.SSS1.p3.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.4.m4.1b"><apply id="S4.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.2">𝛽</ci><ci id="S4.SS3.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p3.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.4.m4.1c">\beta^{\prime}</annotation></semantics></math> in two forms:</p>
</div>
<div id="S4.SS3.SSS1.p4" class="ltx_para ltx_noindent">
<table id="S4.SS3.SSS1.p4.10" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.SS3.SSS1.p4.10.1.1" class="ltx_tr">
<td id="S4.SS3.SSS1.p4.10.1.1.1" class="ltx_td ltx_align_justify">
<span id="S4.SS3.SSS1.p4.10.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS3.SSS1.p4.10.1.1.1.1.1" class="ltx_p"><em id="S4.SS3.SSS1.p4.10.1.1.1.1.1.1" class="ltx_emph ltx_font_italic">Additive form:</em></span>
<span id="A2.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<span id="S4.E10"><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E10.m1.31" class="ltx_Math" alttext="\displaystyle\begin{split}\alpha^{\prime}=\lambda\alpha+\left(1-\lambda\right)\alpha^{*},\\
\beta^{\prime}=\gamma\beta+\left(1-\gamma\right)\beta^{*}.\end{split}" display="inline"><semantics id="S4.E10.m1.31a"><mtable rowspacing="0pt" id="S4.E10.m1.31.31.3"><mtr id="S4.E10.m1.31.31.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E10.m1.31.31.3b"><mrow id="S4.E10.m1.30.30.2.29.15.15.15"><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1"><msup id="S4.E10.m1.30.30.2.29.15.15.15.1.2"><mi id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">α</mi><mo id="S4.E10.m1.2.2.2.2.2.2.1" xref="S4.E10.m1.2.2.2.2.2.2.1.cmml">′</mo></msup><mo id="S4.E10.m1.3.3.3.3.3.3" xref="S4.E10.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1.1"><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1.1.2"><mi id="S4.E10.m1.4.4.4.4.4.4" xref="S4.E10.m1.4.4.4.4.4.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.30.30.2.29.15.15.15.1.1.2.1">​</mo><mi id="S4.E10.m1.5.5.5.5.5.5" xref="S4.E10.m1.5.5.5.5.5.5.cmml">α</mi></mrow><mo id="S4.E10.m1.6.6.6.6.6.6" xref="S4.E10.m1.6.6.6.6.6.6.cmml">+</mo><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1.1.1"><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1.1.1.1.1"><mo id="S4.E10.m1.7.7.7.7.7.7">(</mo><mrow id="S4.E10.m1.30.30.2.29.15.15.15.1.1.1.1.1.1"><mn id="S4.E10.m1.8.8.8.8.8.8" xref="S4.E10.m1.8.8.8.8.8.8.cmml">1</mn><mo id="S4.E10.m1.9.9.9.9.9.9" xref="S4.E10.m1.9.9.9.9.9.9.cmml">−</mo><mi id="S4.E10.m1.10.10.10.10.10.10" xref="S4.E10.m1.10.10.10.10.10.10.cmml">λ</mi></mrow><mo id="S4.E10.m1.11.11.11.11.11.11">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.30.30.2.29.15.15.15.1.1.1.2">​</mo><msup id="S4.E10.m1.30.30.2.29.15.15.15.1.1.1.3"><mi id="S4.E10.m1.12.12.12.12.12.12" xref="S4.E10.m1.12.12.12.12.12.12.cmml">α</mi><mo id="S4.E10.m1.13.13.13.13.13.13.1" xref="S4.E10.m1.13.13.13.13.13.13.1.cmml">∗</mo></msup></mrow></mrow></mrow><mo id="S4.E10.m1.14.14.14.14.14.14">,</mo></mrow></mtd></mtr><mtr id="S4.E10.m1.31.31.3c"><mtd class="ltx_align_right" columnalign="right" id="S4.E10.m1.31.31.3d"><mrow id="S4.E10.m1.31.31.3.30.15.15.15"><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1"><msup id="S4.E10.m1.31.31.3.30.15.15.15.1.2"><mi id="S4.E10.m1.15.15.15.1.1.1" xref="S4.E10.m1.15.15.15.1.1.1.cmml">β</mi><mo id="S4.E10.m1.16.16.16.2.2.2.1" xref="S4.E10.m1.16.16.16.2.2.2.1.cmml">′</mo></msup><mo id="S4.E10.m1.17.17.17.3.3.3" xref="S4.E10.m1.17.17.17.3.3.3.cmml">=</mo><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1.1"><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1.1.2"><mi id="S4.E10.m1.18.18.18.4.4.4" xref="S4.E10.m1.18.18.18.4.4.4.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.31.31.3.30.15.15.15.1.1.2.1">​</mo><mi id="S4.E10.m1.19.19.19.5.5.5" xref="S4.E10.m1.19.19.19.5.5.5.cmml">β</mi></mrow><mo id="S4.E10.m1.20.20.20.6.6.6" xref="S4.E10.m1.20.20.20.6.6.6.cmml">+</mo><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1.1.1"><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1.1.1.1.1"><mo id="S4.E10.m1.21.21.21.7.7.7">(</mo><mrow id="S4.E10.m1.31.31.3.30.15.15.15.1.1.1.1.1.1"><mn id="S4.E10.m1.22.22.22.8.8.8" xref="S4.E10.m1.22.22.22.8.8.8.cmml">1</mn><mo id="S4.E10.m1.23.23.23.9.9.9" xref="S4.E10.m1.23.23.23.9.9.9.cmml">−</mo><mi id="S4.E10.m1.24.24.24.10.10.10" xref="S4.E10.m1.24.24.24.10.10.10.cmml">γ</mi></mrow><mo id="S4.E10.m1.25.25.25.11.11.11">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.31.31.3.30.15.15.15.1.1.1.2">​</mo><msup id="S4.E10.m1.31.31.3.30.15.15.15.1.1.1.3"><mi id="S4.E10.m1.26.26.26.12.12.12" xref="S4.E10.m1.26.26.26.12.12.12.cmml">β</mi><mo id="S4.E10.m1.27.27.27.13.13.13.1" xref="S4.E10.m1.27.27.27.13.13.13.1.cmml">∗</mo></msup></mrow></mrow></mrow><mo lspace="0em" id="S4.E10.m1.28.28.28.14.14.14">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E10.m1.31b"><apply id="S4.E10.m1.29.29.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E10.m1.29.29.1.1.1.1.1.cmml"><eq id="S4.E10.m1.3.3.3.3.3.3.cmml" xref="S4.E10.m1.3.3.3.3.3.3"></eq><apply id="S4.E10.m1.29.29.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">𝛼</ci><ci id="S4.E10.m1.2.2.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.2.2.1">′</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.cmml"><plus id="S4.E10.m1.6.6.6.6.6.6.cmml" xref="S4.E10.m1.6.6.6.6.6.6"></plus><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.3.cmml"><times id="S4.E10.m1.29.29.1.1.1.1.1.1.3.1.cmml"></times><ci id="S4.E10.m1.4.4.4.4.4.4.cmml" xref="S4.E10.m1.4.4.4.4.4.4">𝜆</ci><ci id="S4.E10.m1.5.5.5.5.5.5.cmml" xref="S4.E10.m1.5.5.5.5.5.5">𝛼</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.1.cmml"><times id="S4.E10.m1.29.29.1.1.1.1.1.1.1.2.cmml"></times><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.1.1.1.1.cmml"><minus id="S4.E10.m1.9.9.9.9.9.9.cmml" xref="S4.E10.m1.9.9.9.9.9.9"></minus><cn type="integer" id="S4.E10.m1.8.8.8.8.8.8.cmml" xref="S4.E10.m1.8.8.8.8.8.8">1</cn><ci id="S4.E10.m1.10.10.10.10.10.10.cmml" xref="S4.E10.m1.10.10.10.10.10.10">𝜆</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E10.m1.12.12.12.12.12.12.cmml" xref="S4.E10.m1.12.12.12.12.12.12">𝛼</ci><times id="S4.E10.m1.13.13.13.13.13.13.1.cmml" xref="S4.E10.m1.13.13.13.13.13.13.1"></times></apply></apply></apply></apply><apply id="S4.E10.m1.29.29.1.1.1.2.2.cmml"><eq id="S4.E10.m1.17.17.17.3.3.3.cmml" xref="S4.E10.m1.17.17.17.3.3.3"></eq><apply id="S4.E10.m1.29.29.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.2.2.3.1.cmml">superscript</csymbol><ci id="S4.E10.m1.15.15.15.1.1.1.cmml" xref="S4.E10.m1.15.15.15.1.1.1">𝛽</ci><ci id="S4.E10.m1.16.16.16.2.2.2.1.cmml" xref="S4.E10.m1.16.16.16.2.2.2.1">′</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.2.2.1.cmml"><plus id="S4.E10.m1.20.20.20.6.6.6.cmml" xref="S4.E10.m1.20.20.20.6.6.6"></plus><apply id="S4.E10.m1.29.29.1.1.1.2.2.1.3.cmml"><times id="S4.E10.m1.29.29.1.1.1.2.2.1.3.1.cmml"></times><ci id="S4.E10.m1.18.18.18.4.4.4.cmml" xref="S4.E10.m1.18.18.18.4.4.4">𝛾</ci><ci id="S4.E10.m1.19.19.19.5.5.5.cmml" xref="S4.E10.m1.19.19.19.5.5.5">𝛽</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.2.2.1.1.cmml"><times id="S4.E10.m1.29.29.1.1.1.2.2.1.1.2.cmml"></times><apply id="S4.E10.m1.29.29.1.1.1.2.2.1.1.1.1.1.cmml"><minus id="S4.E10.m1.23.23.23.9.9.9.cmml" xref="S4.E10.m1.23.23.23.9.9.9"></minus><cn type="integer" id="S4.E10.m1.22.22.22.8.8.8.cmml" xref="S4.E10.m1.22.22.22.8.8.8">1</cn><ci id="S4.E10.m1.24.24.24.10.10.10.cmml" xref="S4.E10.m1.24.24.24.10.10.10">𝛾</ci></apply><apply id="S4.E10.m1.29.29.1.1.1.2.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E10.m1.29.29.1.1.1.2.2.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E10.m1.26.26.26.12.12.12.cmml" xref="S4.E10.m1.26.26.26.12.12.12">𝛽</ci><times id="S4.E10.m1.27.27.27.13.13.13.1.cmml" xref="S4.E10.m1.27.27.27.13.13.13.1"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.31c">\displaystyle\begin{split}\alpha^{\prime}=\lambda\alpha+\left(1-\lambda\right)\alpha^{*},\\
\beta^{\prime}=\gamma\beta+\left(1-\gamma\right)\beta^{*}.\end{split}</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span>
<span rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></span></span></span>
</span>
</span>
</td>
<td id="S4.SS3.SSS1.p4.10.1.1.2" class="ltx_td ltx_nopad_r ltx_align_justify">
<span id="S4.SS3.SSS1.p4.10.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS3.SSS1.p4.10.1.1.2.1.1" class="ltx_p"><em id="S4.SS3.SSS1.p4.10.1.1.2.1.1.1" class="ltx_emph ltx_font_italic">Multiplicative form:</em></span>
<span id="A2.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<span id="S4.E11"><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E11.m1.35" class="ltx_Math" alttext="\displaystyle\begin{split}\alpha^{\prime}=\textrm{norm}\left(\left(\alpha\right)^{\lambda}\left(\alpha^{*}\right)^{\left(1-\lambda\right)}\right),\\
\beta^{\prime}=\textrm{norm}\left(\left(\beta\right)^{\gamma}\left(\beta^{*}\right)^{\left(1-\gamma\right)}\right),\end{split}" display="inline"><semantics id="S4.E11.m1.35a"><mtable rowspacing="0pt" id="S4.E11.m1.35.35.3"><mtr id="S4.E11.m1.35.35.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.35.35.3b"><mrow id="S4.E11.m1.34.34.2.33.17.17.17"><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1"><msup id="S4.E11.m1.34.34.2.33.17.17.17.1.2"><mi id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">α</mi><mo id="S4.E11.m1.2.2.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.2.1.cmml">′</mo></msup><mo id="S4.E11.m1.3.3.3.3.3.3" xref="S4.E11.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1.1"><mtext id="S4.E11.m1.4.4.4.4.4.4" xref="S4.E11.m1.4.4.4.4.4.4a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.34.34.2.33.17.17.17.1.1.2">​</mo><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1"><mo id="S4.E11.m1.5.5.5.5.5.5">(</mo><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1"><msup id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.3"><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.3.2"><mo id="S4.E11.m1.6.6.6.6.6.6">(</mo><mi id="S4.E11.m1.7.7.7.7.7.7" xref="S4.E11.m1.7.7.7.7.7.7.cmml">α</mi><mo id="S4.E11.m1.8.8.8.8.8.8">)</mo></mrow><mi id="S4.E11.m1.9.9.9.9.9.9.1" xref="S4.E11.m1.9.9.9.9.9.9.1.cmml">λ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.2">​</mo><msup id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.1"><mrow id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.1.1.1"><mo id="S4.E11.m1.10.10.10.10.10.10">(</mo><msup id="S4.E11.m1.34.34.2.33.17.17.17.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.11.11.11.11.11.11" xref="S4.E11.m1.11.11.11.11.11.11.cmml">α</mi><mo id="S4.E11.m1.12.12.12.12.12.12.1" xref="S4.E11.m1.12.12.12.12.12.12.1.cmml">∗</mo></msup><mo id="S4.E11.m1.13.13.13.13.13.13">)</mo></mrow><mrow id="S4.E11.m1.14.14.14.14.14.14.1.1" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.cmml"><mo id="S4.E11.m1.14.14.14.14.14.14.1.1.2" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.14.14.14.14.14.14.1.1.1" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.cmml"><mn id="S4.E11.m1.14.14.14.14.14.14.1.1.1.2" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.2.cmml">1</mn><mo id="S4.E11.m1.14.14.14.14.14.14.1.1.1.1" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.1.cmml">−</mo><mi id="S4.E11.m1.14.14.14.14.14.14.1.1.1.3" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.E11.m1.14.14.14.14.14.14.1.1.3" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S4.E11.m1.15.15.15.15.15.15">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.16.16.16.16.16.16">,</mo></mrow></mtd></mtr><mtr id="S4.E11.m1.35.35.3c"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.35.35.3d"><mrow id="S4.E11.m1.35.35.3.34.17.17.17"><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1"><msup id="S4.E11.m1.35.35.3.34.17.17.17.1.2"><mi id="S4.E11.m1.17.17.17.1.1.1" xref="S4.E11.m1.17.17.17.1.1.1.cmml">β</mi><mo id="S4.E11.m1.18.18.18.2.2.2.1" xref="S4.E11.m1.18.18.18.2.2.2.1.cmml">′</mo></msup><mo id="S4.E11.m1.19.19.19.3.3.3" xref="S4.E11.m1.19.19.19.3.3.3.cmml">=</mo><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1.1"><mtext id="S4.E11.m1.20.20.20.4.4.4" xref="S4.E11.m1.20.20.20.4.4.4a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.35.35.3.34.17.17.17.1.1.2">​</mo><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1"><mo id="S4.E11.m1.21.21.21.5.5.5">(</mo><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1"><msup id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.3"><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.3.2"><mo id="S4.E11.m1.22.22.22.6.6.6">(</mo><mi id="S4.E11.m1.23.23.23.7.7.7" xref="S4.E11.m1.23.23.23.7.7.7.cmml">β</mi><mo id="S4.E11.m1.24.24.24.8.8.8">)</mo></mrow><mi id="S4.E11.m1.25.25.25.9.9.9.1" xref="S4.E11.m1.25.25.25.9.9.9.1.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.2">​</mo><msup id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.1"><mrow id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.1.1.1"><mo id="S4.E11.m1.26.26.26.10.10.10">(</mo><msup id="S4.E11.m1.35.35.3.34.17.17.17.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.27.27.27.11.11.11" xref="S4.E11.m1.27.27.27.11.11.11.cmml">β</mi><mo id="S4.E11.m1.28.28.28.12.12.12.1" xref="S4.E11.m1.28.28.28.12.12.12.1.cmml">∗</mo></msup><mo id="S4.E11.m1.29.29.29.13.13.13">)</mo></mrow><mrow id="S4.E11.m1.30.30.30.14.14.14.1.1" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.cmml"><mo id="S4.E11.m1.30.30.30.14.14.14.1.1.2" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.30.30.30.14.14.14.1.1.1" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.cmml"><mn id="S4.E11.m1.30.30.30.14.14.14.1.1.1.2" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.2.cmml">1</mn><mo id="S4.E11.m1.30.30.30.14.14.14.1.1.1.1" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.1.cmml">−</mo><mi id="S4.E11.m1.30.30.30.14.14.14.1.1.1.3" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.3.cmml">γ</mi></mrow><mo id="S4.E11.m1.30.30.30.14.14.14.1.1.3" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S4.E11.m1.31.31.31.15.15.15">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.32.32.32.16.16.16">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E11.m1.35b"><apply id="S4.E11.m1.33.33.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E11.m1.33.33.1.1.1.1.1.cmml"><eq id="S4.E11.m1.3.3.3.3.3.3.cmml" xref="S4.E11.m1.3.3.3.3.3.3"></eq><apply id="S4.E11.m1.33.33.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">𝛼</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1">′</ci></apply><apply id="S4.E11.m1.33.33.1.1.1.1.1.1.cmml"><times id="S4.E11.m1.33.33.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E11.m1.4.4.4.4.4.4a.cmml" xref="S4.E11.m1.4.4.4.4.4.4"><mtext id="S4.E11.m1.4.4.4.4.4.4.cmml" xref="S4.E11.m1.4.4.4.4.4.4">norm</mtext></ci><apply id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.cmml"><times id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.2.cmml"></times><apply id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E11.m1.7.7.7.7.7.7.cmml" xref="S4.E11.m1.7.7.7.7.7.7">𝛼</ci><ci id="S4.E11.m1.9.9.9.9.9.9.1.cmml" xref="S4.E11.m1.9.9.9.9.9.9.1">𝜆</ci></apply><apply id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.1.2.cmml">superscript</csymbol><apply id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E11.m1.11.11.11.11.11.11.cmml" xref="S4.E11.m1.11.11.11.11.11.11">𝛼</ci><times id="S4.E11.m1.12.12.12.12.12.12.1.cmml" xref="S4.E11.m1.12.12.12.12.12.12.1"></times></apply><apply id="S4.E11.m1.14.14.14.14.14.14.1.1.1.cmml" xref="S4.E11.m1.14.14.14.14.14.14.1.1"><minus id="S4.E11.m1.14.14.14.14.14.14.1.1.1.1.cmml" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.1"></minus><cn type="integer" id="S4.E11.m1.14.14.14.14.14.14.1.1.1.2.cmml" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.2">1</cn><ci id="S4.E11.m1.14.14.14.14.14.14.1.1.1.3.cmml" xref="S4.E11.m1.14.14.14.14.14.14.1.1.1.3">𝜆</ci></apply></apply></apply></apply></apply><apply id="S4.E11.m1.33.33.1.1.1.2.2.cmml"><eq id="S4.E11.m1.19.19.19.3.3.3.cmml" xref="S4.E11.m1.19.19.19.3.3.3"></eq><apply id="S4.E11.m1.33.33.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.2.2.3.1.cmml">superscript</csymbol><ci id="S4.E11.m1.17.17.17.1.1.1.cmml" xref="S4.E11.m1.17.17.17.1.1.1">𝛽</ci><ci id="S4.E11.m1.18.18.18.2.2.2.1.cmml" xref="S4.E11.m1.18.18.18.2.2.2.1">′</ci></apply><apply id="S4.E11.m1.33.33.1.1.1.2.2.1.cmml"><times id="S4.E11.m1.33.33.1.1.1.2.2.1.2.cmml"></times><ci id="S4.E11.m1.20.20.20.4.4.4a.cmml" xref="S4.E11.m1.20.20.20.4.4.4"><mtext id="S4.E11.m1.20.20.20.4.4.4.cmml" xref="S4.E11.m1.20.20.20.4.4.4">norm</mtext></ci><apply id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.cmml"><times id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.2.cmml"></times><apply id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E11.m1.23.23.23.7.7.7.cmml" xref="S4.E11.m1.23.23.23.7.7.7">𝛽</ci><ci id="S4.E11.m1.25.25.25.9.9.9.1.cmml" xref="S4.E11.m1.25.25.25.9.9.9.1">𝛾</ci></apply><apply id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.1.2.cmml">superscript</csymbol><apply id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E11.m1.33.33.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E11.m1.27.27.27.11.11.11.cmml" xref="S4.E11.m1.27.27.27.11.11.11">𝛽</ci><times id="S4.E11.m1.28.28.28.12.12.12.1.cmml" xref="S4.E11.m1.28.28.28.12.12.12.1"></times></apply><apply id="S4.E11.m1.30.30.30.14.14.14.1.1.1.cmml" xref="S4.E11.m1.30.30.30.14.14.14.1.1"><minus id="S4.E11.m1.30.30.30.14.14.14.1.1.1.1.cmml" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.1"></minus><cn type="integer" id="S4.E11.m1.30.30.30.14.14.14.1.1.1.2.cmml" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.2">1</cn><ci id="S4.E11.m1.30.30.30.14.14.14.1.1.1.3.cmml" xref="S4.E11.m1.30.30.30.14.14.14.1.1.1.3">𝛾</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.35c">\displaystyle\begin{split}\alpha^{\prime}=\textrm{norm}\left(\left(\alpha\right)^{\lambda}\left(\alpha^{*}\right)^{\left(1-\lambda\right)}\right),\\
\beta^{\prime}=\textrm{norm}\left(\left(\beta\right)^{\gamma}\left(\beta^{*}\right)^{\left(1-\gamma\right)}\right),\end{split}</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span>
<span rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></span></span></span>
</span>
</span>
</td>
</tr>
</tbody>
</table>
<br class="ltx_break">
<p id="S4.SS3.SSS1.p4.9" class="ltx_p">where “norm” is a normalization operator; <math id="S4.SS3.SSS1.p4.1.m1.2" class="ltx_Math" alttext="\lambda\in(0,1)" display="inline"><semantics id="S4.SS3.SSS1.p4.1.m1.2a"><mrow id="S4.SS3.SSS1.p4.1.m1.2.3" xref="S4.SS3.SSS1.p4.1.m1.2.3.cmml"><mi id="S4.SS3.SSS1.p4.1.m1.2.3.2" xref="S4.SS3.SSS1.p4.1.m1.2.3.2.cmml">λ</mi><mo id="S4.SS3.SSS1.p4.1.m1.2.3.1" xref="S4.SS3.SSS1.p4.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS3.SSS1.p4.1.m1.2.3.3.2" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p4.1.m1.2.3.3.2.1" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml">(</mo><mn id="S4.SS3.SSS1.p4.1.m1.1.1" xref="S4.SS3.SSS1.p4.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.SSS1.p4.1.m1.2.3.3.2.2" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p4.1.m1.2.2" xref="S4.SS3.SSS1.p4.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.SSS1.p4.1.m1.2.3.3.2.3" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.1.m1.2b"><apply id="S4.SS3.SSS1.p4.1.m1.2.3.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3"><in id="S4.SS3.SSS1.p4.1.m1.2.3.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.1"></in><ci id="S4.SS3.SSS1.p4.1.m1.2.3.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.2">𝜆</ci><interval closure="open" id="S4.SS3.SSS1.p4.1.m1.2.3.3.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.3.3.2"><cn type="integer" id="S4.SS3.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p4.1.m1.1.1">0</cn><cn type="integer" id="S4.SS3.SSS1.p4.1.m1.2.2.cmml" xref="S4.SS3.SSS1.p4.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.1.m1.2c">\lambda\in(0,1)</annotation></semantics></math> and
<math id="S4.SS3.SSS1.p4.2.m2.2" class="ltx_Math" alttext="\gamma\in(0,1)" display="inline"><semantics id="S4.SS3.SSS1.p4.2.m2.2a"><mrow id="S4.SS3.SSS1.p4.2.m2.2.3" xref="S4.SS3.SSS1.p4.2.m2.2.3.cmml"><mi id="S4.SS3.SSS1.p4.2.m2.2.3.2" xref="S4.SS3.SSS1.p4.2.m2.2.3.2.cmml">γ</mi><mo id="S4.SS3.SSS1.p4.2.m2.2.3.1" xref="S4.SS3.SSS1.p4.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS3.SSS1.p4.2.m2.2.3.3.2" xref="S4.SS3.SSS1.p4.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p4.2.m2.2.3.3.2.1" xref="S4.SS3.SSS1.p4.2.m2.2.3.3.1.cmml">(</mo><mn id="S4.SS3.SSS1.p4.2.m2.1.1" xref="S4.SS3.SSS1.p4.2.m2.1.1.cmml">0</mn><mo id="S4.SS3.SSS1.p4.2.m2.2.3.3.2.2" xref="S4.SS3.SSS1.p4.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p4.2.m2.2.2" xref="S4.SS3.SSS1.p4.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.SSS1.p4.2.m2.2.3.3.2.3" xref="S4.SS3.SSS1.p4.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.2.m2.2b"><apply id="S4.SS3.SSS1.p4.2.m2.2.3.cmml" xref="S4.SS3.SSS1.p4.2.m2.2.3"><in id="S4.SS3.SSS1.p4.2.m2.2.3.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.2.3.1"></in><ci id="S4.SS3.SSS1.p4.2.m2.2.3.2.cmml" xref="S4.SS3.SSS1.p4.2.m2.2.3.2">𝛾</ci><interval closure="open" id="S4.SS3.SSS1.p4.2.m2.2.3.3.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.2.3.3.2"><cn type="integer" id="S4.SS3.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1">0</cn><cn type="integer" id="S4.SS3.SSS1.p4.2.m2.2.2.cmml" xref="S4.SS3.SSS1.p4.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.2.m2.2c">\gamma\in(0,1)</annotation></semantics></math> are outputs of learnable gating functions that decide
how much attention priors contribute per words and regions. Intuitively,
these gating mechanisms are a solution to maximizing the agreement
between two sources of information: <math id="S4.SS3.SSS1.p4.3.m3.2" class="ltx_Math" alttext="\alpha^{\prime}=\text{argmin}\left(\lambda*D(\alpha^{\prime},\alpha)+\left(1-\lambda\right)*D(\alpha^{\prime},\alpha^{*})\right)," display="inline"><semantics id="S4.SS3.SSS1.p4.3.m3.2a"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.cmml"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.cmml"><msup id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.cmml"><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.2.cmml">α</mi><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.3.cmml">′</mo></msup><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.2.cmml">=</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.cmml"><mtext id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3a.cmml">argmin</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.1.cmml">∗</mo><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.3.cmml">D</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.SS3.SSS1.p4.3.m3.1.1" xref="S4.SS3.SSS1.p4.3.m3.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.4" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.5" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.cmml"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.cmml"><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml"><mn id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.3.cmml">λ</mi></mrow><mo rspace="0.055em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.2.cmml">∗</mo><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.3.cmml">D</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.4" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.4.cmml">​</mo><mrow id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.3.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.3.cmml">(</mo><msup id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.cmml"><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.3.cmml">′</mo></msup><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.4" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.3.cmml">,</mo><msup id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.cmml"><mi id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.2.cmml">α</mi><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.5" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS3.SSS1.p4.3.m3.2.2.1.2" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.3.m3.2b"><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1"><eq id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.2"></eq><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.2">𝛼</ci><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.3.3">′</ci></apply><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1"><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.2"></times><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3a.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3"><mtext id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.3">argmin</mtext></ci><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1"><plus id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.5.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.5"></plus><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1"><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.2"></times><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3"><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.3.3">𝐷</ci></apply><interval closure="open" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1"><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><ci id="S4.SS3.SSS1.p4.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">𝛼</ci></interval></apply><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4"><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.4.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.4"></times><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1"><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.2"></times><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1"><minus id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.2">1</cn><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.1.1.1.3">𝜆</ci></apply><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.2.1.3">𝐷</ci></apply><interval closure="open" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2"><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.2">𝛼</ci><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.1.1.3">′</ci></apply><apply id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2">superscript</csymbol><ci id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.2">𝛼</ci><times id="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.2.2.1.1.1.1.1.1.4.3.2.2.3"></times></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.3.m3.2c">\alpha^{\prime}=\text{argmin}\left(\lambda*D(\alpha^{\prime},\alpha)+\left(1-\lambda\right)*D(\alpha^{\prime},\alpha^{*})\right),</annotation></semantics></math>
where <math id="S4.SS3.SSS1.p4.4.m4.2" class="ltx_Math" alttext="D(P_{1},P_{2})" display="inline"><semantics id="S4.SS3.SSS1.p4.4.m4.2a"><mrow id="S4.SS3.SSS1.p4.4.m4.2.2" xref="S4.SS3.SSS1.p4.4.m4.2.2.cmml"><mi id="S4.SS3.SSS1.p4.4.m4.2.2.4" xref="S4.SS3.SSS1.p4.4.m4.2.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p4.4.m4.2.2.3" xref="S4.SS3.SSS1.p4.4.m4.2.2.3.cmml">​</mo><mrow id="S4.SS3.SSS1.p4.4.m4.2.2.2.2" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.3" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.2" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.2.cmml">P</mi><mn id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.3" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.4" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.2" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.2.cmml">P</mi><mn id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.3" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.5" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.4.m4.2b"><apply id="S4.SS3.SSS1.p4.4.m4.2.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2"><times id="S4.SS3.SSS1.p4.4.m4.2.2.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.3"></times><ci id="S4.SS3.SSS1.p4.4.m4.2.2.4.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.4">𝐷</ci><interval closure="open" id="S4.SS3.SSS1.p4.4.m4.2.2.2.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2"><apply id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.2">𝑃</ci><cn type="integer" id="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.2">𝑃</ci><cn type="integer" id="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.4.m4.2c">D(P_{1},P_{2})</annotation></semantics></math> measures the distance between two probability
distributions <math id="S4.SS3.SSS1.p4.5.m5.1" class="ltx_Math" alttext="P_{1}" display="inline"><semantics id="S4.SS3.SSS1.p4.5.m5.1a"><msub id="S4.SS3.SSS1.p4.5.m5.1.1" xref="S4.SS3.SSS1.p4.5.m5.1.1.cmml"><mi id="S4.SS3.SSS1.p4.5.m5.1.1.2" xref="S4.SS3.SSS1.p4.5.m5.1.1.2.cmml">P</mi><mn id="S4.SS3.SSS1.p4.5.m5.1.1.3" xref="S4.SS3.SSS1.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.5.m5.1b"><apply id="S4.SS3.SSS1.p4.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p4.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1.2">𝑃</ci><cn type="integer" id="S4.SS3.SSS1.p4.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.5.m5.1c">P_{1}</annotation></semantics></math> and <math id="S4.SS3.SSS1.p4.6.m6.1" class="ltx_Math" alttext="P_{2}" display="inline"><semantics id="S4.SS3.SSS1.p4.6.m6.1a"><msub id="S4.SS3.SSS1.p4.6.m6.1.1" xref="S4.SS3.SSS1.p4.6.m6.1.1.cmml"><mi id="S4.SS3.SSS1.p4.6.m6.1.1.2" xref="S4.SS3.SSS1.p4.6.m6.1.1.2.cmml">P</mi><mn id="S4.SS3.SSS1.p4.6.m6.1.1.3" xref="S4.SS3.SSS1.p4.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.6.m6.1b"><apply id="S4.SS3.SSS1.p4.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p4.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1.2">𝑃</ci><cn type="integer" id="S4.SS3.SSS1.p4.6.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.6.m6.1c">P_{2}</annotation></semantics></math>. When <math id="S4.SS3.SSS1.p4.7.m7.1" class="ltx_Math" alttext="D\equiv" display="inline"><semantics id="S4.SS3.SSS1.p4.7.m7.1a"><mrow id="S4.SS3.SSS1.p4.7.m7.1.1" xref="S4.SS3.SSS1.p4.7.m7.1.1.cmml"><mi id="S4.SS3.SSS1.p4.7.m7.1.1.2" xref="S4.SS3.SSS1.p4.7.m7.1.1.2.cmml">D</mi><mo id="S4.SS3.SSS1.p4.7.m7.1.1.1" xref="S4.SS3.SSS1.p4.7.m7.1.1.1.cmml">≡</mo><mi id="S4.SS3.SSS1.p4.7.m7.1.1.3" xref="S4.SS3.SSS1.p4.7.m7.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.7.m7.1b"><apply id="S4.SS3.SSS1.p4.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1"><equivalent id="S4.SS3.SSS1.p4.7.m7.1.1.1.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1.1"></equivalent><ci id="S4.SS3.SSS1.p4.7.m7.1.1.2.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1.2">𝐷</ci><csymbol cd="latexml" id="S4.SS3.SSS1.p4.7.m7.1.1.3.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.7.m7.1c">D\equiv</annotation></semantics></math> Euclidean distance,
it gives Eq. (<a href="#S4.E10" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) and when <math id="S4.SS3.SSS1.p4.8.m8.1" class="ltx_Math" alttext="D\equiv" display="inline"><semantics id="S4.SS3.SSS1.p4.8.m8.1a"><mrow id="S4.SS3.SSS1.p4.8.m8.1.1" xref="S4.SS3.SSS1.p4.8.m8.1.1.cmml"><mi id="S4.SS3.SSS1.p4.8.m8.1.1.2" xref="S4.SS3.SSS1.p4.8.m8.1.1.2.cmml">D</mi><mo id="S4.SS3.SSS1.p4.8.m8.1.1.1" xref="S4.SS3.SSS1.p4.8.m8.1.1.1.cmml">≡</mo><mi id="S4.SS3.SSS1.p4.8.m8.1.1.3" xref="S4.SS3.SSS1.p4.8.m8.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.8.m8.1b"><apply id="S4.SS3.SSS1.p4.8.m8.1.1.cmml" xref="S4.SS3.SSS1.p4.8.m8.1.1"><equivalent id="S4.SS3.SSS1.p4.8.m8.1.1.1.cmml" xref="S4.SS3.SSS1.p4.8.m8.1.1.1"></equivalent><ci id="S4.SS3.SSS1.p4.8.m8.1.1.2.cmml" xref="S4.SS3.SSS1.p4.8.m8.1.1.2">𝐷</ci><csymbol cd="latexml" id="S4.SS3.SSS1.p4.8.m8.1.1.3.cmml" xref="S4.SS3.SSS1.p4.8.m8.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.8.m8.1c">D\equiv</annotation></semantics></math> KL
divergence between the two distributions, it is Eq. (<a href="#S4.E11" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>)
<cite class="ltx_cite ltx_citemacro_citep">(Heskes, <a href="#bib.bib46" title="" class="ltx_ref">1998</a>)</cite> (See the Supplement for detailed proofs).
The same intuition applies for the calculation of <math id="S4.SS3.SSS1.p4.9.m9.1" class="ltx_Math" alttext="\beta^{\prime}" display="inline"><semantics id="S4.SS3.SSS1.p4.9.m9.1a"><msup id="S4.SS3.SSS1.p4.9.m9.1.1" xref="S4.SS3.SSS1.p4.9.m9.1.1.cmml"><mi id="S4.SS3.SSS1.p4.9.m9.1.1.2" xref="S4.SS3.SSS1.p4.9.m9.1.1.2.cmml">β</mi><mo id="S4.SS3.SSS1.p4.9.m9.1.1.3" xref="S4.SS3.SSS1.p4.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.9.m9.1b"><apply id="S4.SS3.SSS1.p4.9.m9.1.1.cmml" xref="S4.SS3.SSS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.9.m9.1.1.1.cmml" xref="S4.SS3.SSS1.p4.9.m9.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p4.9.m9.1.1.2.cmml" xref="S4.SS3.SSS1.p4.9.m9.1.1.2">𝛽</ci><ci id="S4.SS3.SSS1.p4.9.m9.1.1.3.cmml" xref="S4.SS3.SSS1.p4.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.9.m9.1c">\beta^{\prime}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.SSS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p5.5" class="ltx_p">The learnable gates for <math id="S4.SS3.SSS1.p5.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.SSS1.p5.1.m1.1a"><mi id="S4.SS3.SSS1.p5.1.m1.1.1" xref="S4.SS3.SSS1.p5.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.1.m1.1b"><ci id="S4.SS3.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p5.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.1.m1.1c">\lambda</annotation></semantics></math> and <math id="S4.SS3.SSS1.p5.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS1.p5.2.m2.1a"><mi id="S4.SS3.SSS1.p5.2.m2.1.1" xref="S4.SS3.SSS1.p5.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.2.m2.1b"><ci id="S4.SS3.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.2.m2.1c">\gamma</annotation></semantics></math> are implemented as
a neural function <math id="S4.SS3.SSS1.p5.3.m3.1" class="ltx_math_unparsed" alttext="h_{\theta}\left(.\right)" display="inline"><semantics id="S4.SS3.SSS1.p5.3.m3.1a"><mrow id="S4.SS3.SSS1.p5.3.m3.1b"><msub id="S4.SS3.SSS1.p5.3.m3.1.1"><mi id="S4.SS3.SSS1.p5.3.m3.1.1.2">h</mi><mi id="S4.SS3.SSS1.p5.3.m3.1.1.3">θ</mi></msub><mrow id="S4.SS3.SSS1.p5.3.m3.1.2"><mo id="S4.SS3.SSS1.p5.3.m3.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS3.SSS1.p5.3.m3.1.2.2">.</mo><mo id="S4.SS3.SSS1.p5.3.m3.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.3.m3.1c">h_{\theta}\left(.\right)</annotation></semantics></math> of visual regions <math id="S4.SS3.SSS1.p5.4.m4.1" class="ltx_Math" alttext="\bar{v}" display="inline"><semantics id="S4.SS3.SSS1.p5.4.m4.1a"><mover accent="true" id="S4.SS3.SSS1.p5.4.m4.1.1" xref="S4.SS3.SSS1.p5.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p5.4.m4.1.1.2" xref="S4.SS3.SSS1.p5.4.m4.1.1.2.cmml">v</mi><mo id="S4.SS3.SSS1.p5.4.m4.1.1.1" xref="S4.SS3.SSS1.p5.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.4.m4.1b"><apply id="S4.SS3.SSS1.p5.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p5.4.m4.1.1"><ci id="S4.SS3.SSS1.p5.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p5.4.m4.1.1.1">¯</ci><ci id="S4.SS3.SSS1.p5.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p5.4.m4.1.1.2">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.4.m4.1c">\bar{v}</annotation></semantics></math>
and the question <math id="S4.SS3.SSS1.p5.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS3.SSS1.p5.5.m5.1a"><mi id="S4.SS3.SSS1.p5.5.m5.1.1" xref="S4.SS3.SSS1.p5.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.5.m5.1b"><ci id="S4.SS3.SSS1.p5.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.5.m5.1c">q</annotation></semantics></math>:</p>
</div>
<div id="S4.SS3.SSS1.p6" class="ltx_para ltx_noindent">
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.3" class="ltx_Math" alttext="\lambda=h_{\theta}\left(\overline{v},q\right)." display="block"><semantics id="S4.E12.m1.3a"><mrow id="S4.E12.m1.3.3.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1" xref="S4.E12.m1.3.3.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.2" xref="S4.E12.m1.3.3.1.1.2.cmml">λ</mi><mo id="S4.E12.m1.3.3.1.1.1" xref="S4.E12.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E12.m1.3.3.1.1.3" xref="S4.E12.m1.3.3.1.1.3.cmml"><msub id="S4.E12.m1.3.3.1.1.3.2" xref="S4.E12.m1.3.3.1.1.3.2.cmml"><mi id="S4.E12.m1.3.3.1.1.3.2.2" xref="S4.E12.m1.3.3.1.1.3.2.2.cmml">h</mi><mi id="S4.E12.m1.3.3.1.1.3.2.3" xref="S4.E12.m1.3.3.1.1.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1.3.1" xref="S4.E12.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E12.m1.3.3.1.1.3.3.2" xref="S4.E12.m1.3.3.1.1.3.3.1.cmml"><mo id="S4.E12.m1.3.3.1.1.3.3.2.1" xref="S4.E12.m1.3.3.1.1.3.3.1.cmml">(</mo><mover accent="true" id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml"><mi id="S4.E12.m1.1.1.2" xref="S4.E12.m1.1.1.2.cmml">v</mi><mo id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.cmml">¯</mo></mover><mo id="S4.E12.m1.3.3.1.1.3.3.2.2" xref="S4.E12.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml">q</mi><mo id="S4.E12.m1.3.3.1.1.3.3.2.3" xref="S4.E12.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E12.m1.3.3.1.2" xref="S4.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.3b"><apply id="S4.E12.m1.3.3.1.1.cmml" xref="S4.E12.m1.3.3.1"><eq id="S4.E12.m1.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1"></eq><ci id="S4.E12.m1.3.3.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2">𝜆</ci><apply id="S4.E12.m1.3.3.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.3"><times id="S4.E12.m1.3.3.1.1.3.1.cmml" xref="S4.E12.m1.3.3.1.1.3.1"></times><apply id="S4.E12.m1.3.3.1.1.3.2.cmml" xref="S4.E12.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.1.1.3.2.1.cmml" xref="S4.E12.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S4.E12.m1.3.3.1.1.3.2.2.cmml" xref="S4.E12.m1.3.3.1.1.3.2.2">ℎ</ci><ci id="S4.E12.m1.3.3.1.1.3.2.3.cmml" xref="S4.E12.m1.3.3.1.1.3.2.3">𝜃</ci></apply><interval closure="open" id="S4.E12.m1.3.3.1.1.3.3.1.cmml" xref="S4.E12.m1.3.3.1.1.3.3.2"><apply id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1"><ci id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1.1">¯</ci><ci id="S4.E12.m1.1.1.2.cmml" xref="S4.E12.m1.1.1.2">𝑣</ci></apply><ci id="S4.E12.m1.2.2.cmml" xref="S4.E12.m1.2.2">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.3c">\lambda=h_{\theta}\left(\overline{v},q\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.SSS1.p6.2" class="ltx_p">For simplicity, <math id="S4.SS3.SSS1.p6.1.m1.1" class="ltx_Math" alttext="\overline{v}" display="inline"><semantics id="S4.SS3.SSS1.p6.1.m1.1a"><mover accent="true" id="S4.SS3.SSS1.p6.1.m1.1.1" xref="S4.SS3.SSS1.p6.1.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p6.1.m1.1.1.2" xref="S4.SS3.SSS1.p6.1.m1.1.1.2.cmml">v</mi><mo id="S4.SS3.SSS1.p6.1.m1.1.1.1" xref="S4.SS3.SSS1.p6.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p6.1.m1.1b"><apply id="S4.SS3.SSS1.p6.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p6.1.m1.1.1"><ci id="S4.SS3.SSS1.p6.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p6.1.m1.1.1.1">¯</ci><ci id="S4.SS3.SSS1.p6.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p6.1.m1.1.1.2">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.1.m1.1c">\overline{v}</annotation></semantics></math> is the arithmetic mean of regions
in <math id="S4.SS3.SSS1.p6.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS3.SSS1.p6.2.m2.1a"><mi id="S4.SS3.SSS1.p6.2.m2.1.1" xref="S4.SS3.SSS1.p6.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p6.2.m2.1b"><ci id="S4.SS3.SSS1.p6.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p6.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.2.m2.1c">V</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.SSS1.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p7.2" class="ltx_p">For multi-step reasoning, we apply Eqs. (<a href="#S4.E10" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>,
<a href="#S4.E11" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>) step-by-step. Since each reasoning step <math id="S4.SS3.SSS1.p7.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.SSS1.p7.1.m1.1a"><mi id="S4.SS3.SSS1.p7.1.m1.1.1" xref="S4.SS3.SSS1.p7.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.1.m1.1b"><ci id="S4.SS3.SSS1.p7.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p7.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.1.m1.1c">k</annotation></semantics></math>
is driven by an intermediate controlling signal <math id="S4.SS3.SSS1.p7.2.m2.1" class="ltx_Math" alttext="c_{k}" display="inline"><semantics id="S4.SS3.SSS1.p7.2.m2.1a"><msub id="S4.SS3.SSS1.p7.2.m2.1.1" xref="S4.SS3.SSS1.p7.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p7.2.m2.1.1.2" xref="S4.SS3.SSS1.p7.2.m2.1.1.2.cmml">c</mi><mi id="S4.SS3.SSS1.p7.2.m2.1.1.3" xref="S4.SS3.SSS1.p7.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p7.2.m2.1b"><apply id="S4.SS3.SSS1.p7.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p7.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p7.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p7.2.m2.1.1.2">𝑐</ci><ci id="S4.SS3.SSS1.p7.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p7.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p7.2.m2.1c">c_{k}</annotation></semantics></math> (Sec. <a href="#S3" title="3 Preliminaries ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>),
we adapt the gating functions to make use of that signal:</p>
</div>
<div id="S4.SS3.SSS1.p8" class="ltx_para ltx_noindent">
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.3" class="ltx_Math" alttext="\lambda_{k}=p_{\theta}\left(c_{k},h_{\theta}\left(\bar{v},q\right)\right)." display="block"><semantics id="S4.E13.m1.3a"><mrow id="S4.E13.m1.3.3.1" xref="S4.E13.m1.3.3.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1" xref="S4.E13.m1.3.3.1.1.cmml"><msub id="S4.E13.m1.3.3.1.1.4" xref="S4.E13.m1.3.3.1.1.4.cmml"><mi id="S4.E13.m1.3.3.1.1.4.2" xref="S4.E13.m1.3.3.1.1.4.2.cmml">λ</mi><mi id="S4.E13.m1.3.3.1.1.4.3" xref="S4.E13.m1.3.3.1.1.4.3.cmml">k</mi></msub><mo id="S4.E13.m1.3.3.1.1.3" xref="S4.E13.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E13.m1.3.3.1.1.2" xref="S4.E13.m1.3.3.1.1.2.cmml"><msub id="S4.E13.m1.3.3.1.1.2.4" xref="S4.E13.m1.3.3.1.1.2.4.cmml"><mi id="S4.E13.m1.3.3.1.1.2.4.2" xref="S4.E13.m1.3.3.1.1.2.4.2.cmml">p</mi><mi id="S4.E13.m1.3.3.1.1.2.4.3" xref="S4.E13.m1.3.3.1.1.2.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.3.3.1.1.2.3" xref="S4.E13.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S4.E13.m1.3.3.1.1.2.2.2" xref="S4.E13.m1.3.3.1.1.2.2.3.cmml"><mo id="S4.E13.m1.3.3.1.1.2.2.2.3" xref="S4.E13.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S4.E13.m1.3.3.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml">c</mi><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E13.m1.3.3.1.1.2.2.2.4" xref="S4.E13.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S4.E13.m1.3.3.1.1.2.2.2.2" xref="S4.E13.m1.3.3.1.1.2.2.2.2.cmml"><msub id="S4.E13.m1.3.3.1.1.2.2.2.2.2" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S4.E13.m1.3.3.1.1.2.2.2.2.2.2" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2.2.cmml">h</mi><mi id="S4.E13.m1.3.3.1.1.2.2.2.2.2.3" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.3.3.1.1.2.2.2.2.1" xref="S4.E13.m1.3.3.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S4.E13.m1.3.3.1.1.2.2.2.2.3.2" xref="S4.E13.m1.3.3.1.1.2.2.2.2.3.1.cmml"><mo id="S4.E13.m1.3.3.1.1.2.2.2.2.3.2.1" xref="S4.E13.m1.3.3.1.1.2.2.2.2.3.1.cmml">(</mo><mover accent="true" id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml"><mi id="S4.E13.m1.1.1.2" xref="S4.E13.m1.1.1.2.cmml">v</mi><mo id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml">¯</mo></mover><mo id="S4.E13.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S4.E13.m1.3.3.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml">q</mi><mo id="S4.E13.m1.3.3.1.1.2.2.2.2.3.2.3" xref="S4.E13.m1.3.3.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.3.3.1.1.2.2.2.5" xref="S4.E13.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E13.m1.3.3.1.2" xref="S4.E13.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.3b"><apply id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1"><eq id="S4.E13.m1.3.3.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.3"></eq><apply id="S4.E13.m1.3.3.1.1.4.cmml" xref="S4.E13.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.4.1.cmml" xref="S4.E13.m1.3.3.1.1.4">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.4.2.cmml" xref="S4.E13.m1.3.3.1.1.4.2">𝜆</ci><ci id="S4.E13.m1.3.3.1.1.4.3.cmml" xref="S4.E13.m1.3.3.1.1.4.3">𝑘</ci></apply><apply id="S4.E13.m1.3.3.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.2"><times id="S4.E13.m1.3.3.1.1.2.3.cmml" xref="S4.E13.m1.3.3.1.1.2.3"></times><apply id="S4.E13.m1.3.3.1.1.2.4.cmml" xref="S4.E13.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.2.4.1.cmml" xref="S4.E13.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.2.4.2.cmml" xref="S4.E13.m1.3.3.1.1.2.4.2">𝑝</ci><ci id="S4.E13.m1.3.3.1.1.2.4.3.cmml" xref="S4.E13.m1.3.3.1.1.2.4.3">𝜃</ci></apply><interval closure="open" id="S4.E13.m1.3.3.1.1.2.2.3.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2"><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E13.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2"><times id="S4.E13.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.1"></times><apply id="S4.E13.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2.2">ℎ</ci><ci id="S4.E13.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.2.3">𝜃</ci></apply><interval closure="open" id="S4.E13.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S4.E13.m1.3.3.1.1.2.2.2.2.3.2"><apply id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1"><ci id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1">¯</ci><ci id="S4.E13.m1.1.1.2.cmml" xref="S4.E13.m1.1.1.2">𝑣</ci></apply><ci id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2">𝑞</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.3c">\lambda_{k}=p_{\theta}\left(c_{k},h_{\theta}\left(\bar{v},q\right)\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Joint attention refinement</h5>

<div id="S4.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS2.p1.2" class="ltx_p">In joint attention VQA models, we can directly use matrix <math id="S4.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="A^{*}=\left(a_{ij}^{*}\right)\in\mathbb{R}^{T\times N}" display="inline"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><msup id="S4.SS3.SSS2.p1.1.m1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.3.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.2.cmml">A</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.3.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p1.1.m1.1.1.4" xref="S4.SS3.SSS2.p1.1.m1.1.1.4.cmml">=</mo><mrow id="S4.SS3.SSS2.p1.1.m1.1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.SSS2.p1.1.m1.1.1.5" xref="S4.SS3.SSS2.p1.1.m1.1.1.5.cmml">∈</mo><msup id="S4.SS3.SSS2.p1.1.m1.1.1.6" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.6.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS2.p1.1.m1.1.1.6.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.1.cmml">×</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><and id="S4.SS3.SSS2.p1.1.m1.1.1a.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"></and><apply id="S4.SS3.SSS2.p1.1.m1.1.1b.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><eq id="S4.SS3.SSS2.p1.1.m1.1.1.4.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.4"></eq><apply id="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.2">𝐴</ci><times id="S4.SS3.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.3"></times></apply><apply id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2">𝑎</ci><apply id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3"><times id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><times id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.3"></times></apply></apply><apply id="S4.SS3.SSS2.p1.1.m1.1.1c.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><in id="S4.SS3.SSS2.p1.1.m1.1.1.5.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.5"></in><share href="#S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" id="S4.SS3.SSS2.p1.1.m1.1.1d.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"></share><apply id="S4.SS3.SSS2.p1.1.m1.1.1.6.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.6.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6">superscript</csymbol><ci id="S4.SS3.SSS2.p1.1.m1.1.1.6.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.2">ℝ</ci><apply id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3"><times id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.1"></times><ci id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.2">𝑇</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.6.3.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.6.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">A^{*}=\left(a_{ij}^{*}\right)\in\mathbb{R}^{T\times N}</annotation></semantics></math>
without marginalization. With slight abuse of notation, we denote
the output the modulating gate for attention refinement as <math id="S4.SS3.SSS2.p1.2.m2.2" class="ltx_Math" alttext="\lambda\in(0,1)" display="inline"><semantics id="S4.SS3.SSS2.p1.2.m2.2a"><mrow id="S4.SS3.SSS2.p1.2.m2.2.3" xref="S4.SS3.SSS2.p1.2.m2.2.3.cmml"><mi id="S4.SS3.SSS2.p1.2.m2.2.3.2" xref="S4.SS3.SSS2.p1.2.m2.2.3.2.cmml">λ</mi><mo id="S4.SS3.SSS2.p1.2.m2.2.3.1" xref="S4.SS3.SSS2.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS3.SSS2.p1.2.m2.2.3.3.2" xref="S4.SS3.SSS2.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS2.p1.2.m2.2.3.3.2.1" xref="S4.SS3.SSS2.p1.2.m2.2.3.3.1.cmml">(</mo><mn id="S4.SS3.SSS2.p1.2.m2.1.1" xref="S4.SS3.SSS2.p1.2.m2.1.1.cmml">0</mn><mo id="S4.SS3.SSS2.p1.2.m2.2.3.3.2.2" xref="S4.SS3.SSS2.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS3.SSS2.p1.2.m2.2.2" xref="S4.SS3.SSS2.p1.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.SSS2.p1.2.m2.2.3.3.2.3" xref="S4.SS3.SSS2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.2.m2.2b"><apply id="S4.SS3.SSS2.p1.2.m2.2.3.cmml" xref="S4.SS3.SSS2.p1.2.m2.2.3"><in id="S4.SS3.SSS2.p1.2.m2.2.3.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.2.3.1"></in><ci id="S4.SS3.SSS2.p1.2.m2.2.3.2.cmml" xref="S4.SS3.SSS2.p1.2.m2.2.3.2">𝜆</ci><interval closure="open" id="S4.SS3.SSS2.p1.2.m2.2.3.3.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.2.3.3.2"><cn type="integer" id="S4.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1">0</cn><cn type="integer" id="S4.SS3.SSS2.p1.2.m2.2.2.cmml" xref="S4.SS3.SSS2.p1.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.2.m2.2c">\lambda\in(0,1)</annotation></semantics></math>
sharing similar role with the gating mechanism in Eq. (<a href="#S4.E12" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>):</p>
</div>
<div id="S4.SS3.SSS2.p2" class="ltx_para ltx_noindent">
<table id="A2.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E14.m1.1" class="ltx_Math" alttext="\displaystyle A^{\prime}" display="inline"><semantics id="S4.E14.m1.1a"><msup id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><mi id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2.cmml">A</mi><mo id="S4.E14.m1.1.1.3" xref="S4.E14.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.1.1">superscript</csymbol><ci id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2">𝐴</ci><ci id="S4.E14.m1.1.1.3.cmml" xref="S4.E14.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\displaystyle A^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E14.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}\lambda A+\left(1-\lambda\right)B^{*}&amp;\text{(add.)}\\
\textrm{norm}\left(\left(A\right)^{\lambda}\left(B^{*}\right)^{\left(1-\lambda\right)}\right)&amp;\text{(multi.)}\end{cases}" display="inline"><semantics id="S4.E14.m2.4a"><mrow id="S4.E14.m2.4.5" xref="S4.E14.m2.4.5.cmml"><mi id="S4.E14.m2.4.5.2" xref="S4.E14.m2.4.5.2.cmml"></mi><mo id="S4.E14.m2.4.5.1" xref="S4.E14.m2.4.5.1.cmml">=</mo><mrow id="S4.E14.m2.4.4a" xref="S4.E14.m2.4.5.3.1.cmml"><mo id="S4.E14.m2.4.4a.5" xref="S4.E14.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E14.m2.4.4.4a" xref="S4.E14.m2.4.5.3.1.cmml"><mtr id="S4.E14.m2.4.4.4aa" xref="S4.E14.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E14.m2.4.4.4ab" xref="S4.E14.m2.4.5.3.1.cmml"><mrow id="S4.E14.m2.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.cmml"><mrow id="S4.E14.m2.1.1.1.1.1.1.3" xref="S4.E14.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m2.1.1.1.1.1.1.3.2" xref="S4.E14.m2.1.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E14.m2.1.1.1.1.1.1.3.1" xref="S4.E14.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E14.m2.1.1.1.1.1.1.3.3" xref="S4.E14.m2.1.1.1.1.1.1.3.3.cmml">A</mi></mrow><mo id="S4.E14.m2.1.1.1.1.1.1.2" xref="S4.E14.m2.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E14.m2.1.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E14.m2.1.1.1.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m2.1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.E14.m2.1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E14.m2.1.1.1.1.1.1.1.2" xref="S4.E14.m2.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S4.E14.m2.1.1.1.1.1.1.1.3" xref="S4.E14.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m2.1.1.1.1.1.1.1.3.2" xref="S4.E14.m2.1.1.1.1.1.1.1.3.2.cmml">B</mi><mo id="S4.E14.m2.1.1.1.1.1.1.1.3.3" xref="S4.E14.m2.1.1.1.1.1.1.1.3.3.cmml">∗</mo></msup></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E14.m2.4.4.4ac" xref="S4.E14.m2.4.5.3.1.cmml"><mtext id="S4.E14.m2.2.2.2.2.2.1" xref="S4.E14.m2.2.2.2.2.2.1a.cmml">(add.)</mtext></mtd></mtr><mtr id="S4.E14.m2.4.4.4ad" xref="S4.E14.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E14.m2.4.4.4ae" xref="S4.E14.m2.4.5.3.1.cmml"><mrow id="S4.E14.m2.3.3.3.3.1.1" xref="S4.E14.m2.3.3.3.3.1.1.cmml"><mtext id="S4.E14.m2.3.3.3.3.1.1.5" xref="S4.E14.m2.3.3.3.3.1.1.5a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="S4.E14.m2.3.3.3.3.1.1.4" xref="S4.E14.m2.3.3.3.3.1.1.4.cmml">​</mo><mrow id="S4.E14.m2.3.3.3.3.1.1.3.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.cmml"><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.cmml">(</mo><mrow id="S4.E14.m2.3.3.3.3.1.1.3.1.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.cmml"><msup id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.cmml"><mrow id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.2.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.cmml"><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.2.2.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.cmml">(</mo><mi id="S4.E14.m2.3.3.3.3.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.2.cmml">A</mi><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.2.2.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.cmml">)</mo></mrow><mi id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.3" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.3.cmml">λ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E14.m2.3.3.3.3.1.1.3.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.2.cmml">​</mo><msup id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.cmml"><mrow id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.cmml"><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.cmml"><mi id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.2.cmml">B</mi><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.3" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.3" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E14.m2.3.3.3.3.1.1.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E14.m2.3.3.3.3.1.1.1.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.cmml"><mn id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.2" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.1" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.3" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.E14.m2.3.3.3.3.1.1.1.1.1.3" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S4.E14.m2.3.3.3.3.1.1.3.1.3" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E14.m2.4.4.4af" xref="S4.E14.m2.4.5.3.1.cmml"><mtext id="S4.E14.m2.4.4.4.4.2.1" xref="S4.E14.m2.4.4.4.4.2.1a.cmml">(multi.)</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m2.4b"><apply id="S4.E14.m2.4.5.cmml" xref="S4.E14.m2.4.5"><eq id="S4.E14.m2.4.5.1.cmml" xref="S4.E14.m2.4.5.1"></eq><csymbol cd="latexml" id="S4.E14.m2.4.5.2.cmml" xref="S4.E14.m2.4.5.2">absent</csymbol><apply id="S4.E14.m2.4.5.3.1.cmml" xref="S4.E14.m2.4.4a"><csymbol cd="latexml" id="S4.E14.m2.4.5.3.1.1.cmml" xref="S4.E14.m2.4.4a.5">cases</csymbol><apply id="S4.E14.m2.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1"><plus id="S4.E14.m2.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.2"></plus><apply id="S4.E14.m2.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.3"><times id="S4.E14.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1.3.1"></times><ci id="S4.E14.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.3.2">𝜆</ci><ci id="S4.E14.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.3.3">𝐴</ci></apply><apply id="S4.E14.m2.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1"><times id="S4.E14.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.2"></times><apply id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1"><minus id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="S4.E14.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E14.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.3.2">𝐵</ci><times id="S4.E14.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.1.3.3"></times></apply></apply></apply><ci id="S4.E14.m2.2.2.2.2.2.1a.cmml" xref="S4.E14.m2.2.2.2.2.2.1"><mtext id="S4.E14.m2.2.2.2.2.2.1.cmml" xref="S4.E14.m2.2.2.2.2.2.1">(add.)</mtext></ci><apply id="S4.E14.m2.3.3.3.3.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1"><times id="S4.E14.m2.3.3.3.3.1.1.4.cmml" xref="S4.E14.m2.3.3.3.3.1.1.4"></times><ci id="S4.E14.m2.3.3.3.3.1.1.5a.cmml" xref="S4.E14.m2.3.3.3.3.1.1.5"><mtext id="S4.E14.m2.3.3.3.3.1.1.5.cmml" xref="S4.E14.m2.3.3.3.3.1.1.5">norm</mtext></ci><apply id="S4.E14.m2.3.3.3.3.1.1.3.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1"><times id="S4.E14.m2.3.3.3.3.1.1.3.1.1.2.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.2"></times><apply id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3">superscript</csymbol><ci id="S4.E14.m2.3.3.3.3.1.1.2.cmml" xref="S4.E14.m2.3.3.3.3.1.1.2">𝐴</ci><ci id="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.3.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.3.3">𝜆</ci></apply><apply id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.2.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1">superscript</csymbol><apply id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.2">𝐵</ci><times id="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.3.3.3.3.1.1.3.1.1.1.1.1.1.3"></times></apply><apply id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1"><minus id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.2">1</cn><ci id="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.3.3.3.3.1.1.1.1.1.1.3">𝜆</ci></apply></apply></apply></apply><ci id="S4.E14.m2.4.4.4.4.2.1a.cmml" xref="S4.E14.m2.4.4.4.4.2.1"><mtext id="S4.E14.m2.4.4.4.4.2.1.cmml" xref="S4.E14.m2.4.4.4.4.2.1">(multi.)</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m2.4c">\displaystyle=\begin{cases}\lambda A+\left(1-\lambda\right)B^{*}&amp;\text{(add.)}\\
\textrm{norm}\left(\left(A\right)^{\lambda}\left(B^{*}\right)^{\left(1-\lambda\right)}\right)&amp;\text{(multi.)}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.SSS2.p2.1" class="ltx_p">where <math id="S4.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="B^{*}=\text{norm}_{ij}\left(a_{ij}^{*}\right)" display="inline"><semantics id="S4.SS3.SSS2.p2.1.m1.1a"><mrow id="S4.SS3.SSS2.p2.1.m1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.cmml"><msup id="S4.SS3.SSS2.p2.1.m1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">B</mi><mo id="S4.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p2.1.m1.1.1.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.cmml"><msub id="S4.SS3.SSS2.p2.1.m1.1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.cmml"><mtext id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2a.cmml">norm</mtext><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p2.1.m1.1.1.1.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.2" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow><mo id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.1.m1.1b"><apply id="S4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1"><eq id="S4.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.2"></eq><apply id="S4.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.2">𝐵</ci><times id="S4.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.3.3"></times></apply><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1"><times id="S4.SS3.SSS2.p2.1.m1.1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.2"></times><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2a.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2"><mtext id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.2">norm</mtext></ci><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3"><times id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.1"></times><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.2">𝑖</ci><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.2">𝑎</ci><apply id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3"><times id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><times id="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.1.m1.1c">B^{*}=\text{norm}_{ij}\left(a_{ij}^{*}\right)</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Two-stage Model Training </h4>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">We perform a two-step pre-training/fine-tuning procedure to train
models using the attention priors: (1) unsupervised pre-training VQA
without answer decoder with attention priors (Sec. <a href="#S4.SS2" title="4.2 Pre-training VQA Attention ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>),
and (2) fine-tune full VQA models with attention refinement using
answers, i.e. by minimizing the VQA loss <math id="S4.SS4.p1.1.m1.3" class="ltx_Math" alttext="-\log P(y\mid q,\mathcal{I})" display="inline"><semantics id="S4.SS4.p1.1.m1.3a"><mrow id="S4.SS4.p1.1.m1.3.3" xref="S4.SS4.p1.1.m1.3.3.cmml"><mo rspace="0.167em" id="S4.SS4.p1.1.m1.3.3a" xref="S4.SS4.p1.1.m1.3.3.cmml">−</mo><mrow id="S4.SS4.p1.1.m1.3.3.1" xref="S4.SS4.p1.1.m1.3.3.1.cmml"><mrow id="S4.SS4.p1.1.m1.3.3.1.3" xref="S4.SS4.p1.1.m1.3.3.1.3.cmml"><mi id="S4.SS4.p1.1.m1.3.3.1.3.1" xref="S4.SS4.p1.1.m1.3.3.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS4.p1.1.m1.3.3.1.3a" xref="S4.SS4.p1.1.m1.3.3.1.3.cmml">⁡</mo><mi id="S4.SS4.p1.1.m1.3.3.1.3.2" xref="S4.SS4.p1.1.m1.3.3.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.3.3.1.2" xref="S4.SS4.p1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S4.SS4.p1.1.m1.3.3.1.1.1" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p1.1.m1.3.3.1.1.1.2" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p1.1.m1.3.3.1.1.1.1" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.3.3.1.1.1.1.2" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.2.cmml">y</mi><mo id="S4.SS4.p1.1.m1.3.3.1.1.1.1.1" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.1.cmml">∣</mo><mrow id="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.2" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">q</mi><mo id="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.2.1" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.1.m1.2.2" xref="S4.SS4.p1.1.m1.2.2.cmml">ℐ</mi></mrow></mrow><mo stretchy="false" id="S4.SS4.p1.1.m1.3.3.1.1.1.3" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.3b"><apply id="S4.SS4.p1.1.m1.3.3.cmml" xref="S4.SS4.p1.1.m1.3.3"><minus id="S4.SS4.p1.1.m1.3.3.2.cmml" xref="S4.SS4.p1.1.m1.3.3"></minus><apply id="S4.SS4.p1.1.m1.3.3.1.cmml" xref="S4.SS4.p1.1.m1.3.3.1"><times id="S4.SS4.p1.1.m1.3.3.1.2.cmml" xref="S4.SS4.p1.1.m1.3.3.1.2"></times><apply id="S4.SS4.p1.1.m1.3.3.1.3.cmml" xref="S4.SS4.p1.1.m1.3.3.1.3"><log id="S4.SS4.p1.1.m1.3.3.1.3.1.cmml" xref="S4.SS4.p1.1.m1.3.3.1.3.1"></log><ci id="S4.SS4.p1.1.m1.3.3.1.3.2.cmml" xref="S4.SS4.p1.1.m1.3.3.1.3.2">𝑃</ci></apply><apply id="S4.SS4.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS4.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S4.SS4.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.2">𝑦</ci><list id="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.3.3.1.1.1.1.3.2"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑞</ci><ci id="S4.SS4.p1.1.m1.2.2.cmml" xref="S4.SS4.p1.1.m1.2.2">ℐ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.3c">-\log P(y\mid q,\mathcal{I})</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments </h3>

<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparison between GAP and other attention regularization
methods using UpDn baseline on VQA v2. Results of other methods are
taken from their respective papers. <sup id="S5.T1.6.1" class="ltx_sup"><span id="S5.T1.6.1.1" class="ltx_text ltx_font_italic">†</span></sup>Our reproduced results.</figcaption>
<table id="S5.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.3.1" class="ltx_tr">
<th id="S5.T1.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T1.3.1.2.1" class="ltx_text">Method</span></th>
<th id="S5.T1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">VQA v2 standard val<math id="S5.T1.3.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.3.1.1.m1.1a"><mo stretchy="false" id="S5.T1.3.1.1.m1.1.1" xref="S5.T1.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.m1.1b"><ci id="S5.T1.3.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.m1.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
<tr id="S5.T1.4.3.1" class="ltx_tr">
<th id="S5.T1.4.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">All</th>
<th id="S5.T1.4.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Yes/No</th>
<th id="S5.T1.4.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t">Num</th>
<th id="S5.T1.4.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt">Other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.4.4.1" class="ltx_tr">
<th id="S5.T1.4.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">UpDn+Attn. Align <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S5.T1.4.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.2</td>
<td id="S5.T1.4.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.0</td>
<td id="S5.T1.4.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.6</td>
<td id="S5.T1.4.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.2</td>
</tr>
<tr id="S5.T1.4.5.2" class="ltx_tr">
<th id="S5.T1.4.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+AdvReg <cite class="ltx_cite ltx_citemacro_citep">(Ramakrishnan et al., <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>
</th>
<td id="S5.T1.4.5.2.2" class="ltx_td ltx_align_center ltx_border_r">62.7</td>
<td id="S5.T1.4.5.2.3" class="ltx_td ltx_align_center ltx_border_r">79.8</td>
<td id="S5.T1.4.5.2.4" class="ltx_td ltx_align_center ltx_border_r">42.3</td>
<td id="S5.T1.4.5.2.5" class="ltx_td ltx_align_center ltx_border_r">55.2</td>
</tr>
<tr id="S5.T1.4.6.3" class="ltx_tr">
<th id="S5.T1.4.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+SCR (w. ext.) <cite class="ltx_cite ltx_citemacro_citep">(Wu and Mooney, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S5.T1.4.6.3.2" class="ltx_td ltx_align_center ltx_border_r">62.2</td>
<td id="S5.T1.4.6.3.3" class="ltx_td ltx_align_center ltx_border_r">78.8</td>
<td id="S5.T1.4.6.3.4" class="ltx_td ltx_align_center ltx_border_r">41.6</td>
<td id="S5.T1.4.6.3.5" class="ltx_td ltx_align_center ltx_border_r">54.5</td>
</tr>
<tr id="S5.T1.4.7.4" class="ltx_tr">
<th id="S5.T1.4.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+SCR (w/o ext.) <cite class="ltx_cite ltx_citemacro_citep">(Wu and Mooney, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S5.T1.4.7.4.2" class="ltx_td ltx_align_center ltx_border_r">62.3</td>
<td id="S5.T1.4.7.4.3" class="ltx_td ltx_align_center ltx_border_r">77.4</td>
<td id="S5.T1.4.7.4.4" class="ltx_td ltx_align_center ltx_border_r">40.9</td>
<td id="S5.T1.4.7.4.5" class="ltx_td ltx_align_center ltx_border_r">56.5</td>
</tr>
<tr id="S5.T1.4.8.5" class="ltx_tr">
<th id="S5.T1.4.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+DLR <cite class="ltx_cite ltx_citemacro_citep">(Jing et al., <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S5.T1.4.8.5.2" class="ltx_td ltx_align_center ltx_border_r">58.0</td>
<td id="S5.T1.4.8.5.3" class="ltx_td ltx_align_center ltx_border_r">76.8</td>
<td id="S5.T1.4.8.5.4" class="ltx_td ltx_align_center ltx_border_r">39.3</td>
<td id="S5.T1.4.8.5.5" class="ltx_td ltx_align_center ltx_border_r">48.5</td>
</tr>
<tr id="S5.T1.4.2" class="ltx_tr">
<th id="S5.T1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+RUBi<sup id="S5.T1.4.2.1.1" class="ltx_sup"><span id="S5.T1.4.2.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_citep">(Cadene et al., <a href="#bib.bib48" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S5.T1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">62.7</td>
<td id="S5.T1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">79.2</td>
<td id="S5.T1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">42.8</td>
<td id="S5.T1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">55.5</td>
</tr>
<tr id="S5.T1.4.9.6" class="ltx_tr">
<th id="S5.T1.4.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">UpDn+HINT <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S5.T1.4.9.6.2" class="ltx_td ltx_align_center ltx_border_r">63.4</td>
<td id="S5.T1.4.9.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.4.9.6.3.1" class="ltx_text ltx_font_bold">81.2</span></td>
<td id="S5.T1.4.9.6.4" class="ltx_td ltx_align_center ltx_border_r">43.0</td>
<td id="S5.T1.4.9.6.5" class="ltx_td ltx_align_center ltx_border_r">55.5</td>
</tr>
<tr id="S5.T1.4.10.7" class="ltx_tr">
<th id="S5.T1.4.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">UpDn+GAP</th>
<td id="S5.T1.4.10.7.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.4.10.7.2.1" class="ltx_text ltx_font_bold">64.3</span></td>
<td id="S5.T1.4.10.7.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.4.10.7.3.1" class="ltx_text ltx_font_bold">81.2</span></td>
<td id="S5.T1.4.10.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.4.10.7.4.1" class="ltx_text ltx_font_bold">44.1</span></td>
<td id="S5.T1.4.10.7.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T1.4.10.7.5.1" class="ltx_text ltx_font_bold">56.9</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We evaluate our approach (GAP) on two representative marginalized
VQA models: Bottom-Up Top-Down Attention (UpDn) <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>
for single-shot, MACNet <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite> for multi-step
compositional attention models; and a joint attention model of BAN
<cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>. Experiments are on two datasets: VQA v2
<cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a href="#bib.bib49" title="" class="ltx_ref">2017</a>)</cite> and GQA <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib50" title="" class="ltx_ref">2019a</a>)</cite>. Unless stated
otherwise, we choose the additive gating (Eq. (<a href="#S4.E10" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>)
) for experiments with UpDn and MACNet, and multiplicative forms (Eq. (<a href="#S4.E11" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>))
for BAN. Implementation details and extra results are provided in
the supplementary materials.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Results</h4>

<figure id="S5.SS1.1" class="ltx_figure ltx_minipage ltx_align_bottom" style="width:433.6pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:190.8pt;"><img src="/html/2205.12616/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="475" height="486" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>GAP’s universality across different baselines and datasets.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:225.5pt;"><img src="/html/2205.12616/assets/x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>GAP improves generalization capability with limited access to grouthtruth
answers.</figcaption>
</figure>
</div>
</div>
</figure>
<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Enhancing VQA performance </h6>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p1.1" class="ltx_p">We compare GAP against the VQA models based on the UpDn baseline that
utilize external priors and human annotation on VQA v2. Some of these
methods use internal regularization: <em id="S5.SS1.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">adversarial regularization</em>
(AdvReg) <cite class="ltx_cite ltx_citemacro_citep">(Ramakrishnan et al., <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>, <em id="S5.SS1.SSS0.Px1.p1.1.2" class="ltx_emph ltx_font_italic">attention
alignment</em> (Attn. Align) <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>; and some use
human attention as external supervision: <em id="S5.SS1.SSS0.Px1.p1.1.3" class="ltx_emph ltx_font_italic">self-critical reasoning</em>
(SCR) <cite class="ltx_cite ltx_citemacro_citep">(Wu and Mooney, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> and <em id="S5.SS1.SSS0.Px1.p1.1.4" class="ltx_emph ltx_font_italic">HINT</em> <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>.
While these methods mainly aim at designing regularization schemes
to exploit the underlying data generation process of VQA-CP datasets
<cite class="ltx_cite ltx_citemacro_citet">Agrawal et al. (<a href="#bib.bib51" title="" class="ltx_ref">2018</a>)</cite> where it deliberately builds the train and
test splits with different answer distributions. This potentially
leads to overfitting to the particular test splits and accuracy gains
do not correlate to the improvements of actual grounding <cite class="ltx_cite ltx_citemacro_citep">(Shrestha et al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite>.
On the contrary, GAP does not rely on those regularization schemes
but aims at directly improving the learning of attention inside any
attention-based VQA models to facilitate reasoning process. In other
words, GAP complements the effects of the aforementioned methods on
VQA-CP (See the supplemental materials).</p>
</div>
<div id="S5.SS1.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p2.1" class="ltx_p">Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows that our approach
<em id="S5.SS1.SSS0.Px1.p2.1.1" class="ltx_emph ltx_font_italic">(UpDn+GAP)</em> clearly has advantages over other methods in improving
the UpDn baseline. The favorable performance is consistent across
all question types, especially on “Other” question type, which
is the most important and challenging for open-ended answers <cite class="ltx_cite ltx_citemacro_citep">(Teney et al., <a href="#bib.bib53" title="" class="ltx_ref">2021</a>, <a href="#bib.bib54" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S5.SS1.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p3.1" class="ltx_p">Compared to methods using external attention annotations (<em id="S5.SS1.SSS0.Px1.p3.1.1" class="ltx_emph ltx_font_italic">UpDn+SCR</em>,
<em id="S5.SS1.SSS0.Px1.p3.1.2" class="ltx_emph ltx_font_italic">UpDn+HINT</em>), the results suggest that GAP is an effective way
to use of attention priors (in both learning and inference), especially
when our attention priors are extracted in an unsupervised manner
without the need for human annotation.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Universality across VQA models</h6>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p">GAP is theoretically applicable to any attention-based VQA models.
We evaluate the universality of GAP by trialing it on a wider range
of baseline models and datasets. Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.1 Experimental Results ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>
summarizes the effects of GAP on UpDn, MACNet and BAN on the large-scale
datasets VQA v2 and GQA.</p>
</div>
<div id="S5.SS1.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p2.1" class="ltx_p">It is clear that GAP consistently improves upon all baselines over
all datasets. GAP is beneficial not only for the simple model UpDn,
but also for the multi-step model (MACNet) on which the strongest
effect is when applied only in early reasoning steps where the attention
weights are still far from convergence.</p>
</div>
<div id="S5.SS1.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p3.1" class="ltx_p">Between datasets, the improvement is stronger on GQA than on VQA v2,
which is explained by the fact that GQA has a large portion of compositional
questions which our unsupervised grounding learning can benefit from.</p>
</div>
<div id="S5.SS1.SSS0.Px2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p4.1" class="ltx_p">The improvements are less significant with BAN which already has large
capacity model at the cost of data hunger and computational expensiveness.
In the next section, we show that GAP significantly reduces the amount
of supervision needed for these models compared to the baseline.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Grounding performance of the unsupervised RE-image grounding when
evaluated on out-of-distribution image-caption Flickr30K Entities
test set. <span id="S5.T2.11.1" class="ltx_text ltx_font_bold">R</span>ecall@<math id="S5.T2.4.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.T2.4.m1.1b"><mi id="S5.T2.4.m1.1.1" xref="S5.T2.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.T2.4.m1.1c"><ci id="S5.T2.4.m1.1.1.cmml" xref="S5.T2.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.m1.1d">k</annotation></semantics></math>: fraction of phrases with bounding
boxes that have IOU<math id="S5.T2.5.m2.1" class="ltx_Math" alttext="\geq" display="inline"><semantics id="S5.T2.5.m2.1b"><mo id="S5.T2.5.m2.1.1" xref="S5.T2.5.m2.1.1.cmml">≥</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.m2.1c"><geq id="S5.T2.5.m2.1.1.cmml" xref="S5.T2.5.m2.1.1"></geq></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.m2.1d">\geq</annotation></semantics></math>0.5 with top-<math id="S5.T2.6.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.T2.6.m3.1b"><mi id="S5.T2.6.m3.1.1" xref="S5.T2.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.T2.6.m3.1c"><ci id="S5.T2.6.m3.1.1.cmml" xref="S5.T2.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.m3.1d">k</annotation></semantics></math> predictions.</figcaption>
<table id="S5.T2.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.9.4.1" class="ltx_tr">
<th id="S5.T2.9.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Model</th>
<th id="S5.T2.9.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">R@1</th>
<th id="S5.T2.9.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">R@5</th>
<th id="S5.T2.9.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">R@10</th>
<th id="S5.T2.9.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Acc.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.7.1" class="ltx_tr">
<td id="S5.T2.7.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt">  Unsupervised RE-image grounding</td>
<td id="S5.T2.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">14.1</td>
<td id="S5.T2.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">35.6</td>
<td id="S5.T2.7.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">45.5</td>
<td id="S5.T2.7.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">45.4</td>
</tr>
<tr id="S5.T2.8.2" class="ltx_tr">
<td id="S5.T2.8.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">  Unsupervised grounding w/o REs</td>
<td id="S5.T2.8.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.8.2.2.1" class="ltx_text">12.0</span></td>
<td id="S5.T2.8.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">33.0</td>
<td id="S5.T2.8.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.9</td>
<td id="S5.T2.8.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.3</td>
</tr>
<tr id="S5.T2.9.3" class="ltx_tr">
<td id="S5.T2.9.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">  Random alignment score (10 runs)</td>
<td id="S5.T2.9.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">6.6</td>
<td id="S5.T2.9.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">28.4</td>
<td id="S5.T2.9.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">43.3</td>
<td id="S5.T2.9.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">40.7</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Sample efficient generalization</h6>

<div id="S5.SS1.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px3.p1.1" class="ltx_p">We examine the generalization of the baselines and our proposed methods
when analyzing sample efficiency with respect to the number of annotated
answers required. Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1 Experimental Results ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the
performance of the chosen baselines on the validation sets of VQA
v2 (left column) and GQA dataset (right column) when given different
fractions of the training data. In particular, when reducing the
number of training instances with groundtruth answers to under 50%
of the training set, GAP considerably outperforms all the baseline
models in accuracy across all datasets by large margins. For example,
when given only 10% of the training data, GAP performs better than
the strongest baseline BAN among the chosen ones by over 4.1 points
on VQA v2 (54.2% vs. 50.1%) and nearly 4.0 points on GQA (51.7%
vs. 47.9%). The benefits of GAP are even more significant for MACNet
baseline which easily got off the track in the early steps without
large data. The results strongly demonstrate the benefits of GAP in
reducing the reliance on supervised data of VQA models.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Model Analysis</h4>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Performance of unsupervised phrase-image grounding </h6>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p">To analyze the unsupervised grounding aspect of our model, (Sec. <a href="#S4.SS1" title="4.1 Structures for Linguistic-Visual Alignment ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>),
we test the grounding model trained with VQA v2 on a mock test set
from caption-image pairs on Flickr30K Entities. This out-of-distribution
evaluation setting will show whether our unsupervised grounding framework
can learn meaningful linguistic-visual alignments.</p>
</div>
<div id="S5.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p2.1" class="ltx_p">The performance of our new unsupervised linguistic-visual alignments
using the query grammatical structure is shown in the top row of Table <a href="#S5.T2" title="Table 2 ‣ Universality across VQA models ‣ 5.1 Experimental Results ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
This is compared against the alignment scores produced by the same
framework but without breaking the query into REs (Middle row) and
the random alignments (Bottom row). There is a 5 points gain compared
to the random scores and over 1 point better than the question-image
pairs without phrases, indicating our linguistic-visual alignments
is a reliable inductive prior for attention in VQA.</p>
</div>
<figure id="S5.SS2.SSS0.Px1.tab1" class="ltx_table">
<blockquote id="S5.SS2.SSS0.Px1.tab1.1" class="ltx_quote">
<div id="S5.SS2.SSS0.Px1.tab1.1.1" class="ltx_logical-block ltx_minipage ltx_align_top" style="width:433.6pt;">
<figure id="S5.T3" class="ltx_table ltx_minipage ltx_align_left ltx_align_top" style="width:173.4pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>VQA performance on VQA v2 validation split with different sources
of attention priors.</figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.5.6.1" class="ltx_tr">
<th id="S5.T3.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T3.5.6.1.1.1" class="ltx_text">No.</span></th>
<th id="S5.T3.5.6.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S5.T3.5.6.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.5.6.1.2.1.1" class="ltx_p" style="width:113.8pt;"><span id="S5.T3.5.6.1.2.1.1.1" class="ltx_text">Models</span></span>
</span>
</th>
<th id="S5.T3.5.6.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T3.5.6.1.3.1" class="ltx_text">Acc.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1" class="ltx_tr">
<td id="S5.T3.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">1</td>
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt">
<span id="S5.T3.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.1.1" class="ltx_p" style="width:113.8pt;">  UpDn baseline</span>
</span>
</td>
<td id="S5.T3.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">63.3</td>
</tr>
<tr id="S5.T3.2.2" class="ltx_tr">
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">2</td>
<td id="S5.T3.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T3.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.2.2.1.1.1" class="ltx_p" style="width:113.8pt;">  +GAP w/ uniform-values vector</span>
</span>
</td>
<td id="S5.T3.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.7</td>
</tr>
<tr id="S5.T3.3.3" class="ltx_tr">
<td id="S5.T3.3.3.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">3</td>
<td id="S5.T3.3.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.3.1.1.1" class="ltx_p" style="width:113.8pt;">  +GAP w/ random-values vector</span>
</span>
</td>
<td id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_r">63.6</td>
</tr>
<tr id="S5.T3.4.4" class="ltx_tr">
<td id="S5.T3.4.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">4</td>
<td id="S5.T3.4.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.4.4.1.1.1" class="ltx_p" style="width:113.8pt;">  +GAP w/ supervised grounding</span>
</span>
</td>
<td id="S5.T3.4.4.3" class="ltx_td ltx_align_center ltx_border_r">64.0</td>
</tr>
<tr id="S5.T3.5.5" class="ltx_tr">
<td id="S5.T3.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">5</td>
<td id="S5.T3.5.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S5.T3.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.5.5.1.1.1" class="ltx_p" style="width:113.8pt;">  +GAP w/ unsup. visual grounding</span>
</span>
</td>
<td id="S5.T3.5.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">64.3</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T4" class="ltx_table ltx_minipage ltx_align_right ltx_align_top" style="width:251.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablation studies with UpDn on VQA v2.</figcaption>
<table id="S5.T4.13" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.13.14.1" class="ltx_tr">
<th id="S5.T4.13.14.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Models</th>
<th id="S5.T4.13.14.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S5.T4.13.14.1.2.1" class="ltx_text">Acc.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.3.3" class="ltx_tr">
<td id="S5.T4.3.3.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt">1.  UpDn baseline, <math id="S5.T4.2.2.2.m2.1" class="ltx_Math" alttext="\beta^{\prime}\equiv\beta" display="inline"><semantics id="S5.T4.2.2.2.m2.1a"><mrow id="S5.T4.2.2.2.m2.1.1" xref="S5.T4.2.2.2.m2.1.1.cmml"><msup id="S5.T4.2.2.2.m2.1.1.2" xref="S5.T4.2.2.2.m2.1.1.2.cmml"><mi id="S5.T4.2.2.2.m2.1.1.2.2" xref="S5.T4.2.2.2.m2.1.1.2.2.cmml">β</mi><mo id="S5.T4.2.2.2.m2.1.1.2.3" xref="S5.T4.2.2.2.m2.1.1.2.3.cmml">′</mo></msup><mo id="S5.T4.2.2.2.m2.1.1.1" xref="S5.T4.2.2.2.m2.1.1.1.cmml">≡</mo><mi id="S5.T4.2.2.2.m2.1.1.3" xref="S5.T4.2.2.2.m2.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.m2.1b"><apply id="S5.T4.2.2.2.m2.1.1.cmml" xref="S5.T4.2.2.2.m2.1.1"><equivalent id="S5.T4.2.2.2.m2.1.1.1.cmml" xref="S5.T4.2.2.2.m2.1.1.1"></equivalent><apply id="S5.T4.2.2.2.m2.1.1.2.cmml" xref="S5.T4.2.2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.T4.2.2.2.m2.1.1.2.1.cmml" xref="S5.T4.2.2.2.m2.1.1.2">superscript</csymbol><ci id="S5.T4.2.2.2.m2.1.1.2.2.cmml" xref="S5.T4.2.2.2.m2.1.1.2.2">𝛽</ci><ci id="S5.T4.2.2.2.m2.1.1.2.3.cmml" xref="S5.T4.2.2.2.m2.1.1.2.3">′</ci></apply><ci id="S5.T4.2.2.2.m2.1.1.3.cmml" xref="S5.T4.2.2.2.m2.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.m2.1c">\beta^{\prime}\equiv\beta</annotation></semantics></math> (<math id="S5.T4.3.3.3.m3.1" class="ltx_Math" alttext="\gamma(\theta)\equiv 1.0" display="inline"><semantics id="S5.T4.3.3.3.m3.1a"><mrow id="S5.T4.3.3.3.m3.1.2" xref="S5.T4.3.3.3.m3.1.2.cmml"><mrow id="S5.T4.3.3.3.m3.1.2.2" xref="S5.T4.3.3.3.m3.1.2.2.cmml"><mi id="S5.T4.3.3.3.m3.1.2.2.2" xref="S5.T4.3.3.3.m3.1.2.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S5.T4.3.3.3.m3.1.2.2.1" xref="S5.T4.3.3.3.m3.1.2.2.1.cmml">​</mo><mrow id="S5.T4.3.3.3.m3.1.2.2.3.2" xref="S5.T4.3.3.3.m3.1.2.2.cmml"><mo stretchy="false" id="S5.T4.3.3.3.m3.1.2.2.3.2.1" xref="S5.T4.3.3.3.m3.1.2.2.cmml">(</mo><mi id="S5.T4.3.3.3.m3.1.1" xref="S5.T4.3.3.3.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S5.T4.3.3.3.m3.1.2.2.3.2.2" xref="S5.T4.3.3.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S5.T4.3.3.3.m3.1.2.1" xref="S5.T4.3.3.3.m3.1.2.1.cmml">≡</mo><mn id="S5.T4.3.3.3.m3.1.2.3" xref="S5.T4.3.3.3.m3.1.2.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.m3.1b"><apply id="S5.T4.3.3.3.m3.1.2.cmml" xref="S5.T4.3.3.3.m3.1.2"><equivalent id="S5.T4.3.3.3.m3.1.2.1.cmml" xref="S5.T4.3.3.3.m3.1.2.1"></equivalent><apply id="S5.T4.3.3.3.m3.1.2.2.cmml" xref="S5.T4.3.3.3.m3.1.2.2"><times id="S5.T4.3.3.3.m3.1.2.2.1.cmml" xref="S5.T4.3.3.3.m3.1.2.2.1"></times><ci id="S5.T4.3.3.3.m3.1.2.2.2.cmml" xref="S5.T4.3.3.3.m3.1.2.2.2">𝛾</ci><ci id="S5.T4.3.3.3.m3.1.1.cmml" xref="S5.T4.3.3.3.m3.1.1">𝜃</ci></apply><cn type="float" id="S5.T4.3.3.3.m3.1.2.3.cmml" xref="S5.T4.3.3.3.m3.1.2.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.m3.1c">\gamma(\theta)\equiv 1.0</annotation></semantics></math>)</td>
<td id="S5.T4.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">63.3</td>
</tr>
<tr id="S5.T4.13.15.1" class="ltx_tr">
<td id="S5.T4.13.15.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T4.13.15.1.1.1" class="ltx_text ltx_font_bold">Attention as priors</span></td>
<td id="S5.T4.13.15.1.2" class="ltx_td ltx_border_r ltx_border_t"></td>
</tr>
<tr id="S5.T4.6.6" class="ltx_tr">
<td id="S5.T4.6.6.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">2.  w/ <math id="S5.T4.5.5.2.m2.1" class="ltx_Math" alttext="\beta^{\prime}\equiv\text{$\beta^{*}$}" display="inline"><semantics id="S5.T4.5.5.2.m2.1a"><mrow id="S5.T4.5.5.2.m2.1.2" xref="S5.T4.5.5.2.m2.1.2.cmml"><msup id="S5.T4.5.5.2.m2.1.2.2" xref="S5.T4.5.5.2.m2.1.2.2.cmml"><mi id="S5.T4.5.5.2.m2.1.2.2.2" xref="S5.T4.5.5.2.m2.1.2.2.2.cmml">β</mi><mo id="S5.T4.5.5.2.m2.1.2.2.3" xref="S5.T4.5.5.2.m2.1.2.2.3.cmml">′</mo></msup><mo id="S5.T4.5.5.2.m2.1.2.1" xref="S5.T4.5.5.2.m2.1.2.1.cmml">≡</mo><msup id="S5.T4.5.5.2.m2.1.1.1" xref="S5.T4.5.5.2.m2.1.1.1.cmml"><mi id="S5.T4.5.5.2.m2.1.1.1.3" xref="S5.T4.5.5.2.m2.1.1.1.3.cmml">β</mi><mo id="S5.T4.5.5.2.m2.1.1.1.4" xref="S5.T4.5.5.2.m2.1.1.1.4.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.2.m2.1b"><apply id="S5.T4.5.5.2.m2.1.2.cmml" xref="S5.T4.5.5.2.m2.1.2"><equivalent id="S5.T4.5.5.2.m2.1.2.1.cmml" xref="S5.T4.5.5.2.m2.1.2.1"></equivalent><apply id="S5.T4.5.5.2.m2.1.2.2.cmml" xref="S5.T4.5.5.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.T4.5.5.2.m2.1.2.2.1.cmml" xref="S5.T4.5.5.2.m2.1.2.2">superscript</csymbol><ci id="S5.T4.5.5.2.m2.1.2.2.2.cmml" xref="S5.T4.5.5.2.m2.1.2.2.2">𝛽</ci><ci id="S5.T4.5.5.2.m2.1.2.2.3.cmml" xref="S5.T4.5.5.2.m2.1.2.2.3">′</ci></apply><apply id="S5.T4.5.5.2.m2.1.1.1.cmml" xref="S5.T4.5.5.2.m2.1.1.1"><csymbol cd="ambiguous" id="S5.T4.5.5.2.m2.1.1.1.2.cmml" xref="S5.T4.5.5.2.m2.1.1.1">superscript</csymbol><ci id="S5.T4.5.5.2.m2.1.1.1.3.cmml" xref="S5.T4.5.5.2.m2.1.1.1.3">𝛽</ci><times id="S5.T4.5.5.2.m2.1.1.1.4.cmml" xref="S5.T4.5.5.2.m2.1.1.1.4"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.2.m2.1c">\beta^{\prime}\equiv\text{$\beta^{*}$}</annotation></semantics></math>(<math id="S5.T4.6.6.3.m3.1" class="ltx_Math" alttext="\gamma(\theta)\equiv 0.0" display="inline"><semantics id="S5.T4.6.6.3.m3.1a"><mrow id="S5.T4.6.6.3.m3.1.2" xref="S5.T4.6.6.3.m3.1.2.cmml"><mrow id="S5.T4.6.6.3.m3.1.2.2" xref="S5.T4.6.6.3.m3.1.2.2.cmml"><mi id="S5.T4.6.6.3.m3.1.2.2.2" xref="S5.T4.6.6.3.m3.1.2.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S5.T4.6.6.3.m3.1.2.2.1" xref="S5.T4.6.6.3.m3.1.2.2.1.cmml">​</mo><mrow id="S5.T4.6.6.3.m3.1.2.2.3.2" xref="S5.T4.6.6.3.m3.1.2.2.cmml"><mo stretchy="false" id="S5.T4.6.6.3.m3.1.2.2.3.2.1" xref="S5.T4.6.6.3.m3.1.2.2.cmml">(</mo><mi id="S5.T4.6.6.3.m3.1.1" xref="S5.T4.6.6.3.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S5.T4.6.6.3.m3.1.2.2.3.2.2" xref="S5.T4.6.6.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S5.T4.6.6.3.m3.1.2.1" xref="S5.T4.6.6.3.m3.1.2.1.cmml">≡</mo><mn id="S5.T4.6.6.3.m3.1.2.3" xref="S5.T4.6.6.3.m3.1.2.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.3.m3.1b"><apply id="S5.T4.6.6.3.m3.1.2.cmml" xref="S5.T4.6.6.3.m3.1.2"><equivalent id="S5.T4.6.6.3.m3.1.2.1.cmml" xref="S5.T4.6.6.3.m3.1.2.1"></equivalent><apply id="S5.T4.6.6.3.m3.1.2.2.cmml" xref="S5.T4.6.6.3.m3.1.2.2"><times id="S5.T4.6.6.3.m3.1.2.2.1.cmml" xref="S5.T4.6.6.3.m3.1.2.2.1"></times><ci id="S5.T4.6.6.3.m3.1.2.2.2.cmml" xref="S5.T4.6.6.3.m3.1.2.2.2">𝛾</ci><ci id="S5.T4.6.6.3.m3.1.1.cmml" xref="S5.T4.6.6.3.m3.1.1">𝜃</ci></apply><cn type="float" id="S5.T4.6.6.3.m3.1.2.3.cmml" xref="S5.T4.6.6.3.m3.1.2.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.3.m3.1c">\gamma(\theta)\equiv 0.0</annotation></semantics></math>)</td>
<td id="S5.T4.6.6.4" class="ltx_td ltx_align_center ltx_border_r">60.0</td>
</tr>
<tr id="S5.T4.13.16.2" class="ltx_tr">
<td id="S5.T4.13.16.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S5.T4.13.16.2.1.1" class="ltx_text ltx_font_bold">Effects of the direct use of attention priors</span></td>
<td id="S5.T4.13.16.2.2" class="ltx_td ltx_border_r"></td>
</tr>
<tr id="S5.T4.7.7" class="ltx_tr">
<td id="S5.T4.7.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">3.  +GAP w/o 1st stage fine-tuning</td>
<td id="S5.T4.7.7.2" class="ltx_td ltx_align_center ltx_border_r">63.9</td>
</tr>
<tr id="S5.T4.8.8" class="ltx_tr">
<td id="S5.T4.8.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">4.  w/ 1st stage fine-tuning with attention priors</td>
<td id="S5.T4.8.8.2" class="ltx_td ltx_align_center ltx_border_r">64.0</td>
</tr>
<tr id="S5.T4.13.17.3" class="ltx_tr">
<td id="S5.T4.13.17.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S5.T4.13.17.3.1.1" class="ltx_text ltx_font_bold">Effects of the gating mechanisms</span></td>
<td id="S5.T4.13.17.3.2" class="ltx_td ltx_border_r"></td>
</tr>
<tr id="S5.T4.10.10" class="ltx_tr">
<td id="S5.T4.10.10.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">5.  +GAP, fixed <math id="S5.T4.10.10.2.m2.1" class="ltx_Math" alttext="\gamma(\theta)\equiv 0.5" display="inline"><semantics id="S5.T4.10.10.2.m2.1a"><mrow id="S5.T4.10.10.2.m2.1.2" xref="S5.T4.10.10.2.m2.1.2.cmml"><mrow id="S5.T4.10.10.2.m2.1.2.2" xref="S5.T4.10.10.2.m2.1.2.2.cmml"><mi id="S5.T4.10.10.2.m2.1.2.2.2" xref="S5.T4.10.10.2.m2.1.2.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S5.T4.10.10.2.m2.1.2.2.1" xref="S5.T4.10.10.2.m2.1.2.2.1.cmml">​</mo><mrow id="S5.T4.10.10.2.m2.1.2.2.3.2" xref="S5.T4.10.10.2.m2.1.2.2.cmml"><mo stretchy="false" id="S5.T4.10.10.2.m2.1.2.2.3.2.1" xref="S5.T4.10.10.2.m2.1.2.2.cmml">(</mo><mi id="S5.T4.10.10.2.m2.1.1" xref="S5.T4.10.10.2.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S5.T4.10.10.2.m2.1.2.2.3.2.2" xref="S5.T4.10.10.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S5.T4.10.10.2.m2.1.2.1" xref="S5.T4.10.10.2.m2.1.2.1.cmml">≡</mo><mn id="S5.T4.10.10.2.m2.1.2.3" xref="S5.T4.10.10.2.m2.1.2.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.10.10.2.m2.1b"><apply id="S5.T4.10.10.2.m2.1.2.cmml" xref="S5.T4.10.10.2.m2.1.2"><equivalent id="S5.T4.10.10.2.m2.1.2.1.cmml" xref="S5.T4.10.10.2.m2.1.2.1"></equivalent><apply id="S5.T4.10.10.2.m2.1.2.2.cmml" xref="S5.T4.10.10.2.m2.1.2.2"><times id="S5.T4.10.10.2.m2.1.2.2.1.cmml" xref="S5.T4.10.10.2.m2.1.2.2.1"></times><ci id="S5.T4.10.10.2.m2.1.2.2.2.cmml" xref="S5.T4.10.10.2.m2.1.2.2.2">𝛾</ci><ci id="S5.T4.10.10.2.m2.1.1.cmml" xref="S5.T4.10.10.2.m2.1.1">𝜃</ci></apply><cn type="float" id="S5.T4.10.10.2.m2.1.2.3.cmml" xref="S5.T4.10.10.2.m2.1.2.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.10.2.m2.1c">\gamma(\theta)\equiv 0.5</annotation></semantics></math>
</td>
<td id="S5.T4.10.10.3" class="ltx_td ltx_align_center ltx_border_r">64.0</td>
</tr>
<tr id="S5.T4.11.11" class="ltx_tr">
<td id="S5.T4.11.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">6.  +GAP (multiplicative gating)</td>
<td id="S5.T4.11.11.2" class="ltx_td ltx_align_center ltx_border_r">64.1</td>
</tr>
<tr id="S5.T4.13.18.4" class="ltx_tr">
<td id="S5.T4.13.18.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S5.T4.13.18.4.1.1" class="ltx_text ltx_font_bold">Effects of using visual-phrase associations</span></td>
<td id="S5.T4.13.18.4.2" class="ltx_td ltx_border_r"></td>
</tr>
<tr id="S5.T4.12.12" class="ltx_tr">
<td id="S5.T4.12.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">7.  +GAP (w/o extracted phrases from questions)</td>
<td id="S5.T4.12.12.2" class="ltx_td ltx_align_center ltx_border_r">63.9</td>
</tr>
<tr id="S5.T4.13.13" class="ltx_tr">
<td id="S5.T4.13.13.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">8.  +GAP (full model)</td>
<td id="S5.T4.13.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">64.3</td>
</tr>
</tbody>
</table>
</figure>
</div>
</blockquote>
</figure>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Effectiveness of unsupervised linguistic-visual alignments for VQA</h6>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p">We examine the effectiveness of our attention prior by comparing it
with different ways of generating values for visual attention prior
<math id="S5.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\beta^{*}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><msup id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">β</mi><mo id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝛽</ci><times id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">\beta^{*}</annotation></semantics></math> on VQA performance. They include: (1) UpDn baseline
(no use of attention prior) (2) uniform-values vector and (3) random-values
vector (normalized normal distribution), (4) supervised grounding
(pretrained MAttNet <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite> on RefCOCO <cite class="ltx_cite ltx_citemacro_citep">(Kazemzadeh et al., <a href="#bib.bib41" title="" class="ltx_ref">2014</a>)</cite>),
and (5) GAP. Table <a href="#S5.T3" title="Table 3 ‣ Performance of unsupervised phrase-image grounding ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows results
on UpDn baseline. GAP is significantly better than the baseline and
other attention priors (2-3-4). Especially our unsupervised grounding
gives better VQA performance than the supervised one (Row 5). This
surprising result suggests that pre-trained supervised model could
not generalize out of distribution, and is worse than underlying grounding
phrase-image pairs extracted unsupervisedly.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px3" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Ablation studies</h6>

<div id="S5.SS2.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p1.1" class="ltx_p">To provide more insights into our method, we conduct extensive ablation
studies on the VQA v2 dataset (see Table <a href="#S5.T4" title="Table 4 ‣ Performance of unsupervised phrase-image grounding ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
Throughout these experiments, we examine the role of each component
toward the optimal performance of the full model. Experiments (1,
2) in Table <a href="#S5.T4" title="Table 4 ‣ Performance of unsupervised phrase-image grounding ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show that UpDn model does
not perform well with either only its own attention or with the attention
prior itself. This supports our intuition that they complement each
other toward optimal reasoning. Rows 5,6 show that a soft combination
of the two terms is necessary.</p>
</div>
<div id="S5.SS2.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p2.1" class="ltx_p">Row 7 justifies the use of structured grounding. It shows that phrase-image
grounding gives better performance than question-image pairs only.
In particular, the extracted RE-image pairs improves performance
from 63.9% to 64.3%. This clearly demonstrates the significance
of the grammatical structure of questions as an inductive bias for
inter-modality matching which eventually benefits VQA.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Grounding scores of UpDn before and applying GAP on GQA validation
split.</figcaption>
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Model</th>
<th id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Top-1 attention</th>
<th id="S5.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Top-5 attention</th>
<th id="S5.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Top-10 attention</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.2.1" class="ltx_tr">
<th id="S5.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">UpDn baseline</th>
<td id="S5.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">14.50</td>
<td id="S5.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">27.31</td>
<td id="S5.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">35.35</td>
</tr>
<tr id="S5.T5.1.3.2" class="ltx_tr">
<th id="S5.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">UpDn + GAP</th>
<td id="S5.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S5.T5.1.3.2.2.1" class="ltx_text">16.76</span></td>
<td id="S5.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">29.32</td>
<td id="S5.T5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">36.53</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS2.SSS0.Px4" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Quantitative results</h6>

<div id="S5.SS2.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px4.p1.1" class="ltx_p">We quantify the visual attentions of the UpDn model before and after
applying GAP on the GQA validation set. In particular, we use the
grounding score proposed by <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib50" title="" class="ltx_ref">2019a</a>)</cite> to measure the
correctness of the model’s attentions weights comparing to the groundtruth
grounding provided. Results are shown in Table <a href="#S5.T5" title="Table 5 ‣ Ablation studies ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Our method improves the grounding scores of UpDn by 2.26 points (16.76
vs. 14.50) for top-1 attention, 2.01 points (29.32 vs. 27.31) for
top-5 attention and 1.18 points (36.53 vs. 35.35) for top-10 attention.
It is to note that while the grounding scores reported by <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib50" title="" class="ltx_ref">2019a</a>)</cite>
summing over all object regions, we report the grounding scores attributed
by top-<math id="S5.SS2.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS2.SSS0.Px4.p1.1.m1.1a"><mi id="S5.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px4.p1.1.m1.1b"><ci id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px4.p1.1.m1.1c">k</annotation></semantics></math> attentions to better emphasize how the attentions shift
towards most relevant objects. This analysis complements the VQA performance
in Table <a href="#S5.T3" title="Table 3 ‣ Performance of unsupervised phrase-image grounding ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in a more definitive
confirmation of the role of GAP in improving both reasoning attention
and VQA accuracy.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div id="S5.F6.2" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:398.9pt;">
<div id="S5.F6.1.1.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:208.1pt;">
<img src="/html/2205.12616/assets/x6.png" id="S5.F6.1.1.1.1.g1" class="ltx_graphics ltx_align_left ltx_img_square" width="466" height="395" alt="Refer to caption">
</div>
<p id="S5.F6.2.2.2" class="ltx_p ltx_align_center"><span class="ltx_rule" style="color:#0000FF;background:#0000FF;display:inline-block;"> </span> 
<span id="S5.F6.2.2.2.1" class="ltx_inline-block ltx_minipage ltx_align_top" style="width:208.1pt;"><img src="/html/2205.12616/assets/x7.png" id="S5.F6.2.2.2.1.1.g1" class="ltx_graphics ltx_align_right ltx_img_square" width="461" height="376" alt="Refer to caption">
</span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Qualitative analysis of GAP. (a) Region-word alignments of different
RE-image pairs learned by our unsupervised grounding framework. (b)
Visual attentions and prediction of UpDn model before (left) vs. after
applying GAP (right). GAP shifts the model’s highest visual attention
(green rectangle) to more appropriate regions while the original puts
attention on irrelevant parts.</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS0.Px5" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Qualitative results</h6>

<div id="S5.SS2.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px5.p1.1" class="ltx_p">We analyze the internal operation of GAP by visualizing grounding
results on a sample taken from the GQA validation set. The quality
of grounding is demonstrated in Fig. <a href="#S5.F6" title="Figure 6 ‣ Quantitative results ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(a)
with the word-region alignments found for several RE-image pairs.
With GAP, these good grounding eventually benefits VQA models by guiding
their visual attentions. Fig. <a href="#S5.F6" title="Figure 6 ‣ Quantitative results ‣ 5.2 Model Analysis ‣ 5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(b) shows
visual attention of the UpDn model before and after applying GAP.
The guided attentions were shifted towards more appropriate visual
regions than attentions by UpDn baseline.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion </h3>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We have presented a generic methodology to semantically enhance cross-modal
attention in VQA. We extracted the linguistic-vision associations
from query-image pairs and used it to guide VQA models’ attention
with Grounding-based Attention Prior (GAP). Through extensive experiments
across large VQA benchmarks, we demonstrated the effectiveness of
our approach in boosting attention-based VQA models’ performance and
mitigating their reliance on supervised data. We also showed qualitative
analysis to prove the benefits of leveraging grounding-based attention
priors in improving the interpretability and trustworthiness of attention-based
VQA models. Broadly, the capability to obtain the associations between
words and vision entities in the form of common knowledge is key towards
systematic generalization in joint visual and language reasoning.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h3 class="ltx_title ltx_title_bibliography">References</h3>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. [2018]</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 6077–6086, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning [2018]</span>
<span class="ltx_bibblock">
Drew A Hudson and Christopher D Manning.

</span>
<span class="ltx_bibblock">Compositional attention networks for machine reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2018]</span>
<span class="ltx_bibblock">
Jin-Hwa Kim, Jaehyun Jun, and Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Bilinear attention networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pages
1564–1574, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al. [2020]</span>
<span class="ltx_bibblock">
Thao Minh Le, Vuong Le, Svetha Venkatesh, and Truyen Tran.

</span>
<span class="ltx_bibblock">Dynamic language binding in relational visual reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twenty-Ninth International Joint
Conference on Artificial Intelligence, IJCAI-20</em>, pages 818–824, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2016]</span>
<span class="ltx_bibblock">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al. [2017]</span>
<span class="ltx_bibblock">
Abhishek Das, Harsh Agrawal, Larry Zitnick, Devi Parikh, and Dhruv Batra.

</span>
<span class="ltx_bibblock">Human attention in visual question answering: Do humans and deep
networks look at the same regions?

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Computer Vision and Image Understanding</em>, 163:90–100, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiao et al. [2018]</span>
<span class="ltx_bibblock">
Tingting Qiao, Jianfeng Dong, and Duanqing Xu.

</span>
<span class="ltx_bibblock">Exploring human-like attention supervision in visual question
answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, volume 32, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Selvaraju et al. [2019]</span>
<span class="ltx_bibblock">
Ramprasaath R Selvaraju, Stefan Lee, Yilin Shen, Hongxia Jin, Shalini Ghosh,
Larry Heck, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Taking a hint: Leveraging explanations to make vision and language
models more grounded.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>, pages 2591–2600, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Firestone [2020]</span>
<span class="ltx_bibblock">
Chaz Firestone.

</span>
<span class="ltx_bibblock">Performance vs. competence in human–machine comparisons.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the National Academy of Sciences</em>, 117(43):26562–26571, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fleuret et al. [2011]</span>
<span class="ltx_bibblock">
François Fleuret, Ting Li, Charles Dubout, Emma K Wampler, Steven Yantis,
and Donald Geman.

</span>
<span class="ltx_bibblock">Comparing machines and humans on a visual categorization test.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the National Academy of Sciences</em>, 108(43):17621–17625, 2011.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu and Mooney [2019]</span>
<span class="ltx_bibblock">
Jialin Wu and Raymond J Mooney.

</span>
<span class="ltx_bibblock">Self-critical reasoning for robust visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2016]</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, Jianfeng Gao, Li Deng, and Alex Smola.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, pages 21–29, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. [2016]</span>
<span class="ltx_bibblock">
Caiming Xiong, Stephen Merity, and Richard Socher.

</span>
<span class="ltx_bibblock">Dynamic memory networks for visual and textual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages
2397–2406, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu and Saenko [2016]</span>
<span class="ltx_bibblock">
Huijuan Xu and Kate Saenko.

</span>
<span class="ltx_bibblock">Ask, attend and answer: Exploring question-guided spatial attention
for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, pages 451–466. Springer, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2016]</span>
<span class="ltx_bibblock">
Lemao Liu, Masao Utiyama, Andrew Finch, and Eiichiro Sumita.

</span>
<span class="ltx_bibblock">Neural machine translation with supervised attention.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of COLING 2016, the 26th International
Conference on Computational Linguistics: Technical Papers</em>, Osaka, Japan,
December 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2017]</span>
<span class="ltx_bibblock">
Chenxi Liu, Junhua Mao, Fei Sha, and Alan Yuille.

</span>
<span class="ltx_bibblock">Attention correctness in neural image captioning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 31, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. [2020]</span>
<span class="ltx_bibblock">
Chih-Yao Ma, Yannis Kalantidis, Ghassan AlRegib, Peter Vajda, Marcus Rohrbach,
and Zsolt Kira.

</span>
<span class="ltx_bibblock">Learning to generate grounded visual captions without localization
supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</em>, volume 2. Springer, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2020]</span>
<span class="ltx_bibblock">
Yuanen Zhou, Meng Wang, Daqing Liu, Zhenzhen Hu, and Hanwang Zhang.

</span>
<span class="ltx_bibblock">More grounded image captioning by distilling image-text matching
model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pages 4777–4786, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramakrishnan et al. [2018]</span>
<span class="ltx_bibblock">
Sainandan Ramakrishnan, Aishwarya Agrawal, and Stefan Lee.

</span>
<span class="ltx_bibblock">Overcoming language priors in visual question answering with
adversarial regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Yibing Liu, Yangyang Guo, Jianhua Yin, Xuemeng Song, Weifeng Liu, and Liqiang
Nie.

</span>
<span class="ltx_bibblock">Answer questions with right image regions: A visual attention
regularization approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Multimedia Computing, Communications, and
Applications</em>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2018]</span>
<span class="ltx_bibblock">
Kuang-Huei Lee, Xi Chen, Gang Hua, Houdong Hu, and Xiaodong He.

</span>
<span class="ltx_bibblock">Stacked cross attention for image-text matching.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</em>, pages 201–216, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2018]</span>
<span class="ltx_bibblock">
Licheng Yu, Zhe Lin, Xiaohui Shen, Jimei Yang, Xin Lu, Mohit Bansal, and
Tamara L. Berg.

</span>
<span class="ltx_bibblock">Mattnet: Modular attention network for referring expression
comprehension, 2018.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2019]</span>
<span class="ltx_bibblock">
Jiasen Lu, Dhruv Batra, Devi Parikh, and Stefan Lee.

</span>
<span class="ltx_bibblock">Vilbert: Pretraining task-agnostic visiolinguistic representations
for vision-and-language tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. [2020]</span>
<span class="ltx_bibblock">
Weijie Su, Xizhou Zhu, Yue Cao, Bin Li, Lewei Lu, Furu Wei, and Jifeng Dai.

</span>
<span class="ltx_bibblock">Vl-bert: Pre-training of generic visual-linguistic representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpathy and Fei-Fei [2015]</span>
<span class="ltx_bibblock">
Andrej Karpathy and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Deep visual-semantic alignments for generating image descriptions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pages 3128–3137, 2015.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. [2020]</span>
<span class="ltx_bibblock">
Tanmay Gupta, Arash Vahdat, Gal Chechik, Xiaodong Yang, Jan Kautz, and Derek
Hoiem.

</span>
<span class="ltx_bibblock">Contrastive learning for weakly supervised phrase grounding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2020</em>, pages 752–768. Springer, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021a]</span>
<span class="ltx_bibblock">
Liwei Wang, Jing Huang, Yin Li, Kun Xu, Zhengyuan Yang, and Dong Yu.

</span>
<span class="ltx_bibblock">Improving weakly supervised visual grounding by contrastive knowledge
distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pages 14090–14100, 2021a.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al. [2015]</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.02531</em>, 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albanie et al. [2018]</span>
<span class="ltx_bibblock">
Samuel Albanie, Arsha Nagrani, Andrea Vedaldi, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Emotion recognition in speech using cross-modal transfer in the wild.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th ACM international conference on
Multimedia</em>, pages 292–301, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. [2016]</span>
<span class="ltx_bibblock">
Saurabh Gupta, Judy Hoffman, and Jitendra Malik.

</span>
<span class="ltx_bibblock">Cross modal distillation for supervision transfer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pages 2827–2836, 2016.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2018]</span>
<span class="ltx_bibblock">
Yongcheng Liu, Lu Sheng, Jing Shao, Junjie Yan, Shiming Xiang, and Chunhong
Pan.

</span>
<span class="ltx_bibblock">Multi-label image classification via knowledge distillation from
weakly-supervised detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th ACM international conference on
Multimedia</em>, pages 700–708, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021b]</span>
<span class="ltx_bibblock">
Liwei Wang, Jing Huang, Yin Li, Kun Xu, Zhengyuan Yang, and Dong Yu.

</span>
<span class="ltx_bibblock">Improving weakly supervised visual grounding by contrastive knowledge
distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pages 14090–14100, 2021b.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan and Bansal [2019]</span>
<span class="ltx_bibblock">
Hao Tan and Mohit Bansal.

</span>
<span class="ltx_bibblock">Lxmert: Learning cross-modality encoder representations from
transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing</em>, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
Xiujun Li, Xi Yin, Chunyuan Li, Pengchuan Zhang, Xiaowei Hu, Lei Zhang, Lijuan
Wang, Houdong Hu, Li Dong, Furu Wei, et al.

</span>
<span class="ltx_bibblock">Oscar: Object-semantics aligned pre-training for vision-language
tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pages 121–137.
Springer, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington et al. [2014]</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher D Manning.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, volume 14, pages 1532–1543, 2014.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. [2015]</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection with region proposal
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, pages 91–99, 2015.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2017]</span>
<span class="ltx_bibblock">
Jin-Hwa Kim, Kyoung-Woon On, Woosang Lim, Jeonghee Kim, Jung-Woo Ha, and
Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Hadamard product for low-rank bilinear pooling.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2019]</span>
<span class="ltx_bibblock">
Ronghang Hu, Anna Rohrbach, Trevor Darrell, and Kate Saenko.

</span>
<span class="ltx_bibblock">Language-conditioned graph networks for relational reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2019.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers and Gurevych [2019]</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych.

</span>
<span class="ltx_bibblock">Sentence-bert: Sentence embeddings using siamese bert-networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pages 3982–3992, 2019.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al. [2016]</span>
<span class="ltx_bibblock">
Junhua Mao, Jonathan Huang, Alexander Toshev, Oana Camburu, Alan L Yuille, and
Kevin Murphy.

</span>
<span class="ltx_bibblock">Generation and comprehension of unambiguous object descriptions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pages 11–20, 2016.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kazemzadeh et al. [2014]</span>
<span class="ltx_bibblock">
Sahar Kazemzadeh, Vicente Ordonez, Mark Matten, and Tamara Berg.

</span>
<span class="ltx_bibblock">Referitgame: Referring to objects in photographs of natural scenes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2014 conference on empirical methods in
natural language processing (EMNLP)</em>, pages 787–798, 2014.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cirik et al. [2018]</span>
<span class="ltx_bibblock">
Volkan Cirik, Taylor Berg-Kirkpatrick, and Louis-Philippe Morency.

</span>
<span class="ltx_bibblock">Using syntax to ground referring expressions in natural images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 32, 2018.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kitaev and Klein [2018]</span>
<span class="ltx_bibblock">
Nikita Kitaev and Dan Klein.

</span>
<span class="ltx_bibblock">Constituency parsing with a self-attentive encoder.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 56th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 2676–2686,
2018.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1706.03762, 2017.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al. [2018]</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.03748</em>, 2018.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heskes [1998]</span>
<span class="ltx_bibblock">
Tom Heskes.

</span>
<span class="ltx_bibblock">Selecting weighting factors in logarithmic opinion pools.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pages
266–272, 1998.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jing et al. [2020]</span>
<span class="ltx_bibblock">
Chenchen Jing, Yuwei Wu, Xiaoxun Zhang, Yunde Jia, and Qi Wu.

</span>
<span class="ltx_bibblock">Overcoming language priors in vqa via decomposed linguistic
representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 34, pages 11181–11188, 2020.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cadene et al. [2019]</span>
<span class="ltx_bibblock">
Remi Cadene, Corentin Dancette, Matthieu Cord, Devi Parikh, et al.

</span>
<span class="ltx_bibblock">Rubi: Reducing unimodal biases for visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. [2017]</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image
understanding in Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 6904–6913, 2017.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning [2019a]</span>
<span class="ltx_bibblock">
Drew A Hudson and Christopher D Manning.

</span>
<span class="ltx_bibblock">Gqa: A new dataset for real-world visual reasoning and compositional
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 6700–6709, 2019a.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. [2018]</span>
<span class="ltx_bibblock">
Aishwarya Agrawal, Dhruv Batra, Devi Parikh, and Aniruddha Kembhavi.

</span>
<span class="ltx_bibblock">Don’t just assume; look and answer: Overcoming priors for visual
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 4971–4980, 2018.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shrestha et al. [2020]</span>
<span class="ltx_bibblock">
Robik Shrestha, Kushal Kafle, and Christopher Kanan.

</span>
<span class="ltx_bibblock">A negative case analysis of visual grounding methods for vqa.

</span>
<span class="ltx_bibblock">pages 8172–8181, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney et al. [2021]</span>
<span class="ltx_bibblock">
Damien Teney, Ehsan Abbasnejad, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Unshuffling data for improved generalization in visual question
answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 1417–1427, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney et al. [2020]</span>
<span class="ltx_bibblock">
Damien Teney, Kushal Kafle, Robik Shrestha, Ehsan Abbasnejad, Christopher
Kanan, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">On the value of out-of-distribution testing: An example of goodhart’s
law.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 2020.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. [2018]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics</em>, pages 4171–4186,
2018.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krishna et al. [2017]</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, et al.

</span>
<span class="ltx_bibblock">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">IJCV</em>, 123(1):32–73, 2017.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2017]</span>
<span class="ltx_bibblock">
Licheng Yu, Hao Tan, Mohit Bansal, and Tamara L Berg.

</span>
<span class="ltx_bibblock">A joint speaker-listener-reinforcer model for referring expressions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 7282–7290, 2017.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et al. [2016]</span>
<span class="ltx_bibblock">
Djork-Arné Clevert, Thomas Unterthiner, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Fast and accurate deep network learning by exponential linear units
(elus).

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2016.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2014]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, pages 740–755. Springer, 2014.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney et al. [2018]</span>
<span class="ltx_bibblock">
Damien Teney, Peter Anderson, Xiaodong He, and Anton Van Den Hengel.

</span>
<span class="ltx_bibblock">Tips and tricks for visual question answering: Learnings from the
2017 challenge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 4223–4232, 2018.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol et al. [2015]</span>
<span class="ltx_bibblock">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 2425–2433, 2015.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning [2019b]</span>
<span class="ltx_bibblock">
Drew A Hudson and Christopher D Manning.

</span>
<span class="ltx_bibblock">Learning by abstraction: The neural state machine.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</em>,
2019b.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shevchenko et al. [2020]</span>
<span class="ltx_bibblock">
Violetta Shevchenko, Damien Teney, Anthony Dick, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Visual question answering with prior class semantics.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2005.01239</em>, 2020.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2018]</span>
<span class="ltx_bibblock">
Yan Zhang, Jonathon Hare, and Adam Prügel-Bennett.

</span>
<span class="ltx_bibblock">Learning to count objects in natural images for visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2018]</span>
<span class="ltx_bibblock">
Yu Jiang, Vivek Natarajan, Xinlei Chen, Marcus Rohrbach, Dhruv Batra, and Devi
Parikh.

</span>
<span class="ltx_bibblock">Pythia v0. 1: the winning entry to the vqa challenge 2018.

</span>
<span class="ltx_bibblock"><em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">VQA 2018 Challenge</em>, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ptx1" class="ltx_part">
<h2 class="ltx_title ltx_title_part">Supplementary material</h2>

<div id="Ptx1.p1" class="ltx_para ltx_noindent">
<p id="Ptx1.p1.1" class="ltx_p">In this supplementary material, we provide extra details on the proposed
Grounding as Attention Priors (GAP) method and analysis. They include:</p>
<ul id="A0.I1" class="ltx_itemize">
<li id="A0.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i1.p1" class="ltx_para">
<p id="A0.I1.i1.p1.1" class="ltx_p">Implementation details of the Language and visual embedding (Sec.
<a href="#S3" title="3 Preliminaries ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> main text)</p>
</div>
</li>
<li id="A0.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i2.p1" class="ltx_para">
<p id="A0.I1.i2.p1.1" class="ltx_p">Mathematical proof on the meaning of the attention refinement formulations
(Sec. <a href="#S4.SS3" title="4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> main text).</p>
</div>
</li>
<li id="A0.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i3.p1" class="ltx_para">
<p id="A0.I1.i3.p1.1" class="ltx_p">Implementation of the Neural gating functions (Eqs. <a href="#S4.E12" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>
and <a href="#S4.E13" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> main text).</p>
</div>
</li>
<li id="A0.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i4.p1" class="ltx_para">
<p id="A0.I1.i4.p1.1" class="ltx_p">Experiment details including datasets and baselines.</p>
</div>
</li>
<li id="A0.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i5.p1" class="ltx_para">
<p id="A0.I1.i5.p1.1" class="ltx_p">Additional experimental results.</p>
</div>
</li>
<li id="A0.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i6.p1" class="ltx_para ltx_noindent">
<p id="A0.I1.i6.p1.1" class="ltx_p">Additional qualitative analysis.</p>
</div>
</li>
</ul>
</div>
<section id="A1" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Method details</h3>

<section id="A1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Language and Visual Embedding</h4>

<section id="A1.SS1.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Textual embedding </h6>

<div id="A1.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.SSS0.Px1.p1.1" class="ltx_p">Given a length-<math id="A1.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A1.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="A1.SS1.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p1.1.m1.1c">T</annotation></semantics></math> question, we first tokenize it into a sequence
of words and further embed each word into the vector space of 300
dimensions. We initialize the word embeddings with the popular pre-trained
vector representations in GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington et al., <a href="#bib.bib35" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
<div id="A1.SS1.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.SSS0.Px1.p2.10" class="ltx_p">To model the sequential nature of the query, we use bidirectional
LSTMs (BiLSTMs) taking as input the word embedding vectors. The BiLSTMs
result in hidden states <math id="A1.SS1.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\overrightarrow{h_{i}}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.1.m1.1a"><mover accent="true" id="A1.SS1.SSS0.Px1.p2.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.1" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1"><ci id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.1">→</ci><apply id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.1.m1.1c">\overrightarrow{h_{i}}</annotation></semantics></math> and <math id="A1.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\overleftarrow{h_{i}}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.2.m2.1a"><mover accent="true" id="A1.SS1.SSS0.Px1.p2.2.m2.1.1" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.1" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml">←</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1"><ci id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.1">←</ci><apply id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.2.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.2.m2.1c">\overleftarrow{h_{i}}</annotation></semantics></math>
at a time step <math id="A1.SS1.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="A1.SS1.SSS0.Px1.p2.3.m3.1.1" xref="A1.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="A1.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.3.m3.1c">i</annotation></semantics></math> for the forward pass and backward pass, respectively.
We further combine every pair <math id="A1.SS1.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="\overrightarrow{h_{i}}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.4.m4.1a"><mover accent="true" id="A1.SS1.SSS0.Px1.p2.4.m4.1.1" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.1" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1"><ci id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.1">→</ci><apply id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.4.m4.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.4.m4.1c">\overrightarrow{h_{i}}</annotation></semantics></math> and <math id="A1.SS1.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="\overleftarrow{h_{i}}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.5.m5.1a"><mover accent="true" id="A1.SS1.SSS0.Px1.p2.5.m5.1.1" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.1" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml">←</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1"><ci id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.1">←</ci><apply id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.5.m5.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.5.m5.1c">\overleftarrow{h_{i}}</annotation></semantics></math>
into a single vector <math id="A1.SS1.SSS0.Px1.p2.6.m6.2" class="ltx_Math" alttext="l_{i}=\left[\overrightarrow{h_{i}};\overleftarrow{h_{i}}\right]" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.6.m6.2a"><mrow id="A1.SS1.SSS0.Px1.p2.6.m6.2.3" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.cmml"><msub id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.2.cmml">l</mi><mi id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.3" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.3.cmml">i</mi></msub><mo id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.1" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.1.cmml">=</mo><mrow id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.1.cmml"><mo id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.2.1" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.1.cmml">[</mo><mover accent="true" id="A1.SS1.SSS0.Px1.p2.6.m6.1.1" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.1" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml">→</mo></mover><mo id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.1.cmml">;</mo><mover accent="true" id="A1.SS1.SSS0.Px1.p2.6.m6.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.cmml"><msub id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.3" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.1" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.1.cmml">←</mo></mover><mo id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.2.3" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.6.m6.2b"><apply id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3"><eq id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.1"></eq><apply id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.2">𝑙</ci><ci id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.2.3">𝑖</ci></apply><list id="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.3.3.2"><apply id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1"><ci id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.1">→</ci><apply id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.1.1.2.3">𝑖</ci></apply></apply><apply id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2"><ci id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.1">←</ci><apply id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.6.m6.2.2.2.3">𝑖</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.6.m6.2c">l_{i}=\left[\overrightarrow{h_{i}};\overleftarrow{h_{i}}\right]</annotation></semantics></math>,
where <math id="A1.SS1.SSS0.Px1.p2.7.m7.1" class="ltx_math_unparsed" alttext="\left[;\right]" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.7.m7.1a"><mrow id="A1.SS1.SSS0.Px1.p2.7.m7.1b"><mo id="A1.SS1.SSS0.Px1.p2.7.m7.1.1">[</mo><mo id="A1.SS1.SSS0.Px1.p2.7.m7.1.2">;</mo><mo id="A1.SS1.SSS0.Px1.p2.7.m7.1.3">]</mo></mrow><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.7.m7.1c">\left[;\right]</annotation></semantics></math> indicates the vector concatenation operation.
The contextual words are then obtained by gathering these combined
vectors <math id="A1.SS1.SSS0.Px1.p2.8.m8.2" class="ltx_Math" alttext="L=\left\{l_{i}\mid l_{i}\in\mathbb{R}^{d}\right\}_{i=1}^{T}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.8.m8.2a"><mrow id="A1.SS1.SSS0.Px1.p2.8.m8.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.4" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.4.cmml">L</mi><mo id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.3.cmml">=</mo><msubsup id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.cmml"><mrow id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.cmml"><mo id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.1.cmml">{</mo><msub id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.4" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.1.cmml">∣</mo><mrow id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.cmml"><msub id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.2.cmml">l</mi><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.1" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.3.cmml">d</mi></msup></mrow><mo id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.5" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.cmml"><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.2" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.2.cmml">i</mi><mo id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.1" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.1.cmml">=</mo><mn id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.3" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.4" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.4.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.8.m8.2b"><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2"><eq id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.3"></eq><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.4.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.4">𝐿</ci><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2">superscript</csymbol><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2">subscript</csymbol><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2"><csymbol cd="latexml" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.2">𝑙</ci><ci id="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2"><in id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.1"></in><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.2">𝑙</ci><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.2">ℝ</ci><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></apply><apply id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4"><eq id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.1.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.1"></eq><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.2.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.3.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.2.4.3">1</cn></apply></apply><ci id="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.4.cmml" xref="A1.SS1.SSS0.Px1.p2.8.m8.2.2.2.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.8.m8.2c">L=\left\{l_{i}\mid l_{i}\in\mathbb{R}^{d}\right\}_{i=1}^{T}</annotation></semantics></math>.
The global representation <math id="A1.SS1.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.9.m9.1a"><mi id="A1.SS1.SSS0.Px1.p2.9.m9.1.1" xref="A1.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.9.m9.1b"><ci id="A1.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.9.m9.1c">q</annotation></semantics></math> of the query is a combination of the
ends of the LSTM passes <math id="A1.SS1.SSS0.Px1.p2.10.m10.2" class="ltx_Math" alttext="q=\left[\overrightarrow{h_{1}};\overleftarrow{h_{S}}\right]" display="inline"><semantics id="A1.SS1.SSS0.Px1.p2.10.m10.2a"><mrow id="A1.SS1.SSS0.Px1.p2.10.m10.2.3" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.cmml"><mi id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.2.cmml">q</mi><mo id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.1" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.1.cmml">=</mo><mrow id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.1.cmml"><mo id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.2.1" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.1.cmml">[</mo><mover accent="true" id="A1.SS1.SSS0.Px1.p2.10.m10.1.1" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.cmml"><msub id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.2.cmml">h</mi><mn id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.3" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.3.cmml">1</mn></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.1" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.1.cmml">→</mo></mover><mo id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.2.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.1.cmml">;</mo><mover accent="true" id="A1.SS1.SSS0.Px1.p2.10.m10.2.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.cmml"><msub id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.cmml"><mi id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.2" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.2.cmml">h</mi><mi id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.3" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.1" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.1.cmml">←</mo></mover><mo id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.2.3" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p2.10.m10.2b"><apply id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3"><eq id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.1"></eq><ci id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.2">𝑞</ci><list id="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.3.3.2"><apply id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1"><ci id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.1">→</ci><apply id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.2">ℎ</ci><cn type="integer" id="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.1.1.2.3">1</cn></apply></apply><apply id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2"><ci id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.1">←</ci><apply id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.2">ℎ</ci><ci id="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px1.p2.10.m10.2.2.2.3">𝑆</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p2.10.m10.2c">q=\left[\overrightarrow{h_{1}};\overleftarrow{h_{S}}\right]</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.SSS0.Px1.p3.1" class="ltx_p">For our grounding framework with contrastive learning, we use a contextualized
word representation extracted by a pre-trained BERT language model
<cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib55" title="" class="ltx_ref">2018</a>)</cite> for each word <math id="A1.SS1.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="A1.SS1.SSS0.Px1.p3.1.m1.1a"><msub id="A1.SS1.SSS0.Px1.p3.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.2" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml">w</mi><mi id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.3" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p3.1.m1.1b"><apply id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1.2">𝑤</ci><ci id="A1.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="A1.SS1.SSS0.Px1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p3.1.m1.1c">w_{i}</annotation></semantics></math> in an extracted RE.
These contextualized embeddings are found to be more effective for
phrase grounding <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Visual embedding </h6>

<div id="A1.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.SSS0.Px2.p1.7" class="ltx_p">Visual regions are extracted by the popular object detection Faster
R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a href="#bib.bib36" title="" class="ltx_ref">2015</a>)</cite> pre-trained on Visual Genome <cite class="ltx_cite ltx_citemacro_citep">(Krishna et al., <a href="#bib.bib56" title="" class="ltx_ref">2017</a>)</cite>.
We use public code<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/MILVLG/bottom-up-attention.pytorch</span></span></span>
making use of the Facebook Detectron2 v2.0.1 framework<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://github.com/facebookresearch/detectron2</span></span></span>
for this purpose. For each image, we extract a set of <math id="A1.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="A1.SS1.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.1.m1.1c">N</annotation></semantics></math> RoI pooling
features with bounding boxes <math id="A1.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\left\{\left(a_{j},b_{j}\right)\right\}_{j=1}^{N}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.2.m2.1a"><msubsup id="A1.SS1.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml"><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml">{</mo><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml"><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">(</mo><msub id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.4" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">,</mo><msub id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml">b</mi><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.5" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.2.cmml">j</mi><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.1.cmml">=</mo><mn id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><set id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1"><interval closure="open" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2"><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.2">𝑏</ci><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3"><eq id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.1"></eq><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.2">𝑗</ci><cn type="integer" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.2.m2.1c">\left\{\left(a_{j},b_{j}\right)\right\}_{j=1}^{N}</annotation></semantics></math>,
where <math id="A1.SS1.SSS0.Px2.p1.3.m3.2" class="ltx_Math" alttext="a_{j}\in\mathbb{R}^{2048},b_{j}\in\mathbb{R}^{4}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.3.m3.2a"><mrow id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml"><mrow id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.cmml"><msub id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.cmml">a</mi><mi id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.2.cmml">ℝ</mi><mn id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.3.cmml">2048</mn></msup></mrow><mo id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.cmml"><msub id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.cmml">b</mi><mi id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.1" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.2" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.2.cmml">ℝ</mi><mn id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.3" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.3.cmml">4</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.3.m3.2b"><apply id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.3a.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1"><in id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.1"></in><apply id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.2">𝑎</ci><ci id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.2.3">𝑗</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.2">ℝ</ci><cn type="integer" id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.3.3">2048</cn></apply></apply><apply id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2"><in id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.1"></in><apply id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.2">𝑏</ci><ci id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.2.3">𝑗</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.2">ℝ</ci><cn type="integer" id="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.3.m3.2c">a_{j}\in\mathbb{R}^{2048},b_{j}\in\mathbb{R}^{4}</annotation></semantics></math> are appearance
features of object regions and bounding box’s coordinators, respectively.
We follow <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib57" title="" class="ltx_ref">2017</a>)</cite> to encode the bounding box’s coordinators
into a spatial vector of 7 dimensions. We further combine the appearance
features with the encoded spatial features by using a sub-network
of two linear transformations to obtain a set of visual objects <math id="A1.SS1.SSS0.Px2.p1.4.m4.2" class="ltx_Math" alttext="V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d^{\prime}}\right\}_{j=1}^{N}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.4.m4.2a"><mrow id="A1.SS1.SSS0.Px2.p1.4.m4.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.4" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.4.cmml">V</mi><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.3.cmml">=</mo><msubsup id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.cmml"><mrow id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.cmml"><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.1.cmml">{</mo><msub id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo fence="true" lspace="0em" rspace="0em" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.4" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.1.cmml">∣</mo><mrow id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.cmml"><msub id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.1" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><msup id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.2.cmml">d</mi><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.3.cmml">′</mo></msup></msup></mrow><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.5" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.cmml"><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.2.cmml">j</mi><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.1" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.1.cmml">=</mo><mn id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.4" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.4.m4.2b"><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2"><eq id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.3"></eq><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.4.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.4">𝑉</ci><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2">superscript</csymbol><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2">subscript</csymbol><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2"><csymbol cd="latexml" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.2">𝑣</ci><ci id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2"><in id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.1"></in><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.2">ℝ</ci><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.2">𝑑</ci><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.2.2.2.3.3.3">′</ci></apply></apply></apply></apply><apply id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4"><eq id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.1"></eq><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.2">𝑗</ci><cn type="integer" id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.3.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.2.4.3">1</cn></apply></apply><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.4.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.2.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.4.m4.2c">V=\left\{v_{j}\mid v_{j}\in\mathbb{R}^{d^{\prime}}\right\}_{j=1}^{N}</annotation></semantics></math>,
where <math id="A1.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.5.m5.1a"><msup id="A1.SS1.SSS0.Px2.p1.5.m5.1.1" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">d</mi><mo id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑑</ci><ci id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.5.m5.1c">d^{\prime}</annotation></semantics></math> is the vector length of the joint features of
the appearance features and the spatial features. For ease of reading
and implementation, we choose the linguistic feature size <math id="A1.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.6.m6.1a"><mi id="A1.SS1.SSS0.Px2.p1.6.m6.1.1" xref="A1.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.6.m6.1b"><ci id="A1.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.6.m6.1c">d</annotation></semantics></math> and
the visual feature size <math id="A1.SS1.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.7.m7.1a"><msup id="A1.SS1.SSS0.Px2.p1.7.m7.1.1" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.2" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml">d</mi><mo id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.3" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.7.m7.1b"><apply id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.2">𝑑</ci><ci id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.7.m7.1c">d^{\prime}</annotation></semantics></math> to be the same.</p>
</div>
</section>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Meaning of Attention Refinement Mechanisms</h4>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">In this section, we will give a proof that our choices for attention
refinement in Eqs. (<a href="#S4.E10" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, <a href="#S4.E11" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>
and <a href="#S4.E14" title="In 4.3.2 Joint attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) in the main paper are the optimal
solutions with respect to some criteria for probability estimate aggregation.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.7" class="ltx_p">Let us consider the generic problem where a system has multiple estimates
<math id="A1.SS2.p2.1.m1.2" class="ltx_Math" alttext="\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}" display="inline"><semantics id="A1.SS2.p2.1.m1.2a"><msubsup id="A1.SS2.p2.1.m1.2.2" xref="A1.SS2.p2.1.m1.2.2.cmml"><mrow id="A1.SS2.p2.1.m1.2.2.1.1.1" xref="A1.SS2.p2.1.m1.2.2.1.1.2.cmml"><mo id="A1.SS2.p2.1.m1.2.2.1.1.1.2" xref="A1.SS2.p2.1.m1.2.2.1.1.2.cmml">{</mo><mrow id="A1.SS2.p2.1.m1.2.2.1.1.1.1" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.cmml"><msub id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml"><mi id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.2" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.2.cmml">P</mi><mi id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.3" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p2.1.m1.2.2.1.1.1.1.1" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="A1.SS2.p2.1.m1.2.2.1.1.1.1.3.2" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.cmml"><mo id="A1.SS2.p2.1.m1.2.2.1.1.1.1.3.2.1" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.cmml">(</mo><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">x</mi><mo id="A1.SS2.p2.1.m1.2.2.1.1.1.1.3.2.2" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.1.m1.2.2.1.1.1.3" xref="A1.SS2.p2.1.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p2.1.m1.2.2.1.3" xref="A1.SS2.p2.1.m1.2.2.1.3.cmml"><mi id="A1.SS2.p2.1.m1.2.2.1.3.2" xref="A1.SS2.p2.1.m1.2.2.1.3.2.cmml">i</mi><mo id="A1.SS2.p2.1.m1.2.2.1.3.1" xref="A1.SS2.p2.1.m1.2.2.1.3.1.cmml">=</mo><mn id="A1.SS2.p2.1.m1.2.2.1.3.3" xref="A1.SS2.p2.1.m1.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p2.1.m1.2.2.3" xref="A1.SS2.p2.1.m1.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.2b"><apply id="A1.SS2.p2.1.m1.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2">superscript</csymbol><apply id="A1.SS2.p2.1.m1.2.2.1.cmml" xref="A1.SS2.p2.1.m1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.1.2.cmml" xref="A1.SS2.p2.1.m1.2.2">subscript</csymbol><set id="A1.SS2.p2.1.m1.2.2.1.1.2.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1"><apply id="A1.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1"><times id="A1.SS2.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.1"></times><apply id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.2">𝑃</ci><ci id="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝑥</ci></apply></set><apply id="A1.SS2.p2.1.m1.2.2.1.3.cmml" xref="A1.SS2.p2.1.m1.2.2.1.3"><eq id="A1.SS2.p2.1.m1.2.2.1.3.1.cmml" xref="A1.SS2.p2.1.m1.2.2.1.3.1"></eq><ci id="A1.SS2.p2.1.m1.2.2.1.3.2.cmml" xref="A1.SS2.p2.1.m1.2.2.1.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p2.1.m1.2.2.1.3.3.cmml" xref="A1.SS2.p2.1.m1.2.2.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p2.1.m1.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.2c">\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}</annotation></semantics></math> of a true discrete
distribution <math id="A1.SS2.p2.2.m2.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p2.2.m2.1a"><mrow id="A1.SS2.p2.2.m2.1.2" xref="A1.SS2.p2.2.m2.1.2.cmml"><mi id="A1.SS2.p2.2.m2.1.2.2" xref="A1.SS2.p2.2.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p2.2.m2.1.2.1" xref="A1.SS2.p2.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p2.2.m2.1.2.3.2" xref="A1.SS2.p2.2.m2.1.2.cmml"><mo id="A1.SS2.p2.2.m2.1.2.3.2.1" xref="A1.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml">x</mi><mo id="A1.SS2.p2.2.m2.1.2.3.2.2" xref="A1.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.2.cmml" xref="A1.SS2.p2.2.m2.1.2"><times id="A1.SS2.p2.2.m2.1.2.1.cmml" xref="A1.SS2.p2.2.m2.1.2.1"></times><ci id="A1.SS2.p2.2.m2.1.2.2.cmml" xref="A1.SS2.p2.2.m2.1.2.2">𝑃</ci><ci id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">P\left(x\right)</annotation></semantics></math> from multiple mechanisms with corresponding
degrees of certainty <math id="A1.SS2.p2.3.m3.1" class="ltx_Math" alttext="\lambda=\left\{\lambda_{i}\right\}_{i=1}^{n}" display="inline"><semantics id="A1.SS2.p2.3.m3.1a"><mrow id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml"><mi id="A1.SS2.p2.3.m3.1.1.3" xref="A1.SS2.p2.3.m3.1.1.3.cmml">λ</mi><mo id="A1.SS2.p2.3.m3.1.1.2" xref="A1.SS2.p2.3.m3.1.1.2.cmml">=</mo><msubsup id="A1.SS2.p2.3.m3.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.cmml"><mrow id="A1.SS2.p2.3.m3.1.1.1.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.1.1.2.cmml"><mo id="A1.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="A1.SS2.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.2" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml">λ</mi><mi id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p2.3.m3.1.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.1.3.cmml"><mi id="A1.SS2.p2.3.m3.1.1.1.1.3.2" xref="A1.SS2.p2.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p2.3.m3.1.1.1.1.3.1" xref="A1.SS2.p2.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p2.3.m3.1.1.1.1.3.3" xref="A1.SS2.p2.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p2.3.m3.1.1.1.3" xref="A1.SS2.p2.3.m3.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><apply id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1"><eq id="A1.SS2.p2.3.m3.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.2"></eq><ci id="A1.SS2.p2.3.m3.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.3">𝜆</ci><apply id="A1.SS2.p2.3.m3.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1">superscript</csymbol><apply id="A1.SS2.p2.3.m3.1.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1">subscript</csymbol><set id="A1.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1"><apply id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.2">𝜆</ci><ci id="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS2.p2.3.m3.1.1.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.3"><eq id="A1.SS2.p2.3.m3.1.1.1.1.3.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.3.1"></eq><ci id="A1.SS2.p2.3.m3.1.1.1.1.3.2.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p2.3.m3.1.1.1.1.3.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p2.3.m3.1.1.1.3.cmml" xref="A1.SS2.p2.3.m3.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">\lambda=\left\{\lambda_{i}\right\}_{i=1}^{n}</annotation></semantics></math>.
We first normalize these certainty measures so that they sum to one:
<math id="A1.SS2.p2.4.m4.2" class="ltx_Math" alttext="\lambda_{i}\geq 0,\,\sum_{i}\lambda_{i}=1" display="inline"><semantics id="A1.SS2.p2.4.m4.2a"><mrow id="A1.SS2.p2.4.m4.2.2.2" xref="A1.SS2.p2.4.m4.2.2.3.cmml"><mrow id="A1.SS2.p2.4.m4.1.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.1.cmml"><msub id="A1.SS2.p2.4.m4.1.1.1.1.2" xref="A1.SS2.p2.4.m4.1.1.1.1.2.cmml"><mi id="A1.SS2.p2.4.m4.1.1.1.1.2.2" xref="A1.SS2.p2.4.m4.1.1.1.1.2.2.cmml">λ</mi><mi id="A1.SS2.p2.4.m4.1.1.1.1.2.3" xref="A1.SS2.p2.4.m4.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.p2.4.m4.1.1.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.1.1.cmml">≥</mo><mn id="A1.SS2.p2.4.m4.1.1.1.1.3" xref="A1.SS2.p2.4.m4.1.1.1.1.3.cmml">0</mn></mrow><mo id="A1.SS2.p2.4.m4.2.2.2.3" xref="A1.SS2.p2.4.m4.2.2.3a.cmml">,</mo><mrow id="A1.SS2.p2.4.m4.2.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.2.cmml"><mrow id="A1.SS2.p2.4.m4.2.2.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.2.2.cmml"><msub id="A1.SS2.p2.4.m4.2.2.2.2.2.1" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1.cmml"><mo id="A1.SS2.p2.4.m4.2.2.2.2.2.1.2" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1.2.cmml">∑</mo><mi id="A1.SS2.p2.4.m4.2.2.2.2.2.1.3" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1.3.cmml">i</mi></msub><msub id="A1.SS2.p2.4.m4.2.2.2.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p2.4.m4.2.2.2.2.2.2.2" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2.2.cmml">λ</mi><mi id="A1.SS2.p2.4.m4.2.2.2.2.2.2.3" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p2.4.m4.2.2.2.2.1" xref="A1.SS2.p2.4.m4.2.2.2.2.1.cmml">=</mo><mn id="A1.SS2.p2.4.m4.2.2.2.2.3" xref="A1.SS2.p2.4.m4.2.2.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.2b"><apply id="A1.SS2.p2.4.m4.2.2.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.2.2.3a.cmml" xref="A1.SS2.p2.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS2.p2.4.m4.1.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1"><geq id="A1.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.1"></geq><apply id="A1.SS2.p2.4.m4.1.1.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.1.1.1.1.2.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.4.m4.1.1.1.1.2.2.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.2.2">𝜆</ci><ci id="A1.SS2.p2.4.m4.1.1.1.1.2.3.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.SS2.p2.4.m4.1.1.1.1.3.cmml" xref="A1.SS2.p2.4.m4.1.1.1.1.3">0</cn></apply><apply id="A1.SS2.p2.4.m4.2.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2"><eq id="A1.SS2.p2.4.m4.2.2.2.2.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.1"></eq><apply id="A1.SS2.p2.4.m4.2.2.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2"><apply id="A1.SS2.p2.4.m4.2.2.2.2.2.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.2.2.2.2.2.1.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1">subscript</csymbol><sum id="A1.SS2.p2.4.m4.2.2.2.2.2.1.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1.2"></sum><ci id="A1.SS2.p2.4.m4.2.2.2.2.2.1.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.1.3">𝑖</ci></apply><apply id="A1.SS2.p2.4.m4.2.2.2.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p2.4.m4.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2.2">𝜆</ci><ci id="A1.SS2.p2.4.m4.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.2.2.3">𝑖</ci></apply></apply><cn type="integer" id="A1.SS2.p2.4.m4.2.2.2.2.3.cmml" xref="A1.SS2.p2.4.m4.2.2.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.2c">\lambda_{i}\geq 0,\,\sum_{i}\lambda_{i}=1</annotation></semantics></math>. We aim at finding a common
distribution <math id="A1.SS2.p2.5.m5.1" class="ltx_Math" alttext="P^{\prime}\left(x\right)" display="inline"><semantics id="A1.SS2.p2.5.m5.1a"><mrow id="A1.SS2.p2.5.m5.1.2" xref="A1.SS2.p2.5.m5.1.2.cmml"><msup id="A1.SS2.p2.5.m5.1.2.2" xref="A1.SS2.p2.5.m5.1.2.2.cmml"><mi id="A1.SS2.p2.5.m5.1.2.2.2" xref="A1.SS2.p2.5.m5.1.2.2.2.cmml">P</mi><mo id="A1.SS2.p2.5.m5.1.2.2.3" xref="A1.SS2.p2.5.m5.1.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.SS2.p2.5.m5.1.2.1" xref="A1.SS2.p2.5.m5.1.2.1.cmml">​</mo><mrow id="A1.SS2.p2.5.m5.1.2.3.2" xref="A1.SS2.p2.5.m5.1.2.cmml"><mo id="A1.SS2.p2.5.m5.1.2.3.2.1" xref="A1.SS2.p2.5.m5.1.2.cmml">(</mo><mi id="A1.SS2.p2.5.m5.1.1" xref="A1.SS2.p2.5.m5.1.1.cmml">x</mi><mo id="A1.SS2.p2.5.m5.1.2.3.2.2" xref="A1.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m5.1b"><apply id="A1.SS2.p2.5.m5.1.2.cmml" xref="A1.SS2.p2.5.m5.1.2"><times id="A1.SS2.p2.5.m5.1.2.1.cmml" xref="A1.SS2.p2.5.m5.1.2.1"></times><apply id="A1.SS2.p2.5.m5.1.2.2.cmml" xref="A1.SS2.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m5.1.2.2.1.cmml" xref="A1.SS2.p2.5.m5.1.2.2">superscript</csymbol><ci id="A1.SS2.p2.5.m5.1.2.2.2.cmml" xref="A1.SS2.p2.5.m5.1.2.2.2">𝑃</ci><ci id="A1.SS2.p2.5.m5.1.2.2.3.cmml" xref="A1.SS2.p2.5.m5.1.2.2.3">′</ci></apply><ci id="A1.SS2.p2.5.m5.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m5.1c">P^{\prime}\left(x\right)</annotation></semantics></math> aggregating the set of distributions
<math id="A1.SS2.p2.6.m6.2" class="ltx_Math" alttext="\left\{P_{i}\left(x\right)\right\}" display="inline"><semantics id="A1.SS2.p2.6.m6.2a"><mrow id="A1.SS2.p2.6.m6.2.2.1" xref="A1.SS2.p2.6.m6.2.2.2.cmml"><mo id="A1.SS2.p2.6.m6.2.2.1.2" xref="A1.SS2.p2.6.m6.2.2.2.cmml">{</mo><mrow id="A1.SS2.p2.6.m6.2.2.1.1" xref="A1.SS2.p2.6.m6.2.2.1.1.cmml"><msub id="A1.SS2.p2.6.m6.2.2.1.1.2" xref="A1.SS2.p2.6.m6.2.2.1.1.2.cmml"><mi id="A1.SS2.p2.6.m6.2.2.1.1.2.2" xref="A1.SS2.p2.6.m6.2.2.1.1.2.2.cmml">P</mi><mi id="A1.SS2.p2.6.m6.2.2.1.1.2.3" xref="A1.SS2.p2.6.m6.2.2.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p2.6.m6.2.2.1.1.1" xref="A1.SS2.p2.6.m6.2.2.1.1.1.cmml">​</mo><mrow id="A1.SS2.p2.6.m6.2.2.1.1.3.2" xref="A1.SS2.p2.6.m6.2.2.1.1.cmml"><mo id="A1.SS2.p2.6.m6.2.2.1.1.3.2.1" xref="A1.SS2.p2.6.m6.2.2.1.1.cmml">(</mo><mi id="A1.SS2.p2.6.m6.1.1" xref="A1.SS2.p2.6.m6.1.1.cmml">x</mi><mo id="A1.SS2.p2.6.m6.2.2.1.1.3.2.2" xref="A1.SS2.p2.6.m6.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.6.m6.2.2.1.3" xref="A1.SS2.p2.6.m6.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m6.2b"><set id="A1.SS2.p2.6.m6.2.2.2.cmml" xref="A1.SS2.p2.6.m6.2.2.1"><apply id="A1.SS2.p2.6.m6.2.2.1.1.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1"><times id="A1.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1.1"></times><apply id="A1.SS2.p2.6.m6.2.2.1.1.2.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.6.m6.2.2.1.1.2.1.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.6.m6.2.2.1.1.2.2.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1.2.2">𝑃</ci><ci id="A1.SS2.p2.6.m6.2.2.1.1.2.3.cmml" xref="A1.SS2.p2.6.m6.2.2.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.p2.6.m6.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1">𝑥</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m6.2c">\left\{P_{i}\left(x\right)\right\}</annotation></semantics></math> subject to a item-to-set distance
<math id="A1.SS2.p2.7.m7.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS2.p2.7.m7.1a"><mi id="A1.SS2.p2.7.m7.1.1" xref="A1.SS2.p2.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m7.1b"><ci id="A1.SS2.p2.7.m7.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m7.1c">D</annotation></semantics></math>:</p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<table id="A1.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E15.m1.5" class="ltx_Math" alttext="P^{\prime}\left(x\right)=\underset{P(x)}{\mathrm{argmin}}D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right)." display="block"><semantics id="A1.E15.m1.5a"><mrow id="A1.E15.m1.5.5.1" xref="A1.E15.m1.5.5.1.1.cmml"><mrow id="A1.E15.m1.5.5.1.1" xref="A1.E15.m1.5.5.1.1.cmml"><mrow id="A1.E15.m1.5.5.1.1.4" xref="A1.E15.m1.5.5.1.1.4.cmml"><msup id="A1.E15.m1.5.5.1.1.4.2" xref="A1.E15.m1.5.5.1.1.4.2.cmml"><mi id="A1.E15.m1.5.5.1.1.4.2.2" xref="A1.E15.m1.5.5.1.1.4.2.2.cmml">P</mi><mo id="A1.E15.m1.5.5.1.1.4.2.3" xref="A1.E15.m1.5.5.1.1.4.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.E15.m1.5.5.1.1.4.1" xref="A1.E15.m1.5.5.1.1.4.1.cmml">​</mo><mrow id="A1.E15.m1.5.5.1.1.4.3.2" xref="A1.E15.m1.5.5.1.1.4.cmml"><mo id="A1.E15.m1.5.5.1.1.4.3.2.1" xref="A1.E15.m1.5.5.1.1.4.cmml">(</mo><mi id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml">x</mi><mo id="A1.E15.m1.5.5.1.1.4.3.2.2" xref="A1.E15.m1.5.5.1.1.4.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.1.1.3" xref="A1.E15.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E15.m1.5.5.1.1.2" xref="A1.E15.m1.5.5.1.1.2.cmml"><munder accentunder="true" id="A1.E15.m1.1.1" xref="A1.E15.m1.1.1.cmml"><mi id="A1.E15.m1.1.1.2" xref="A1.E15.m1.1.1.2.cmml">argmin</mi><mrow id="A1.E15.m1.1.1.1" xref="A1.E15.m1.1.1.1.cmml"><mi id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.1.1.1.2" xref="A1.E15.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.1.1.1.4.2" xref="A1.E15.m1.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.1.1.1.4.2.1" xref="A1.E15.m1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="A1.E15.m1.1.1.1.4.2.2" xref="A1.E15.m1.1.1.1.cmml">)</mo></mrow></mrow></munder><mo lspace="0em" rspace="0em" id="A1.E15.m1.5.5.1.1.2.3" xref="A1.E15.m1.5.5.1.1.2.3.cmml">​</mo><msub id="A1.E15.m1.5.5.1.1.2.4" xref="A1.E15.m1.5.5.1.1.2.4.cmml"><mi id="A1.E15.m1.5.5.1.1.2.4.2" xref="A1.E15.m1.5.5.1.1.2.4.2.cmml">D</mi><mi id="A1.E15.m1.5.5.1.1.2.4.3" xref="A1.E15.m1.5.5.1.1.2.4.3.cmml">λ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.5.5.1.1.2.3a" xref="A1.E15.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="A1.E15.m1.5.5.1.1.2.2.2" xref="A1.E15.m1.5.5.1.1.2.2.3.cmml"><mo id="A1.E15.m1.5.5.1.1.2.2.2.3" xref="A1.E15.m1.5.5.1.1.2.2.3.cmml">(</mo><mrow id="A1.E15.m1.5.5.1.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.5.5.1.1.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E15.m1.5.5.1.1.1.1.1.1.3.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.1.1.1.1.3.2.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.3.3" xref="A1.E15.m1.3.3.cmml">x</mi><mo id="A1.E15.m1.5.5.1.1.1.1.1.1.3.2.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.1.1.2.2.2.4" xref="A1.E15.m1.5.5.1.1.2.2.3.cmml">;</mo><msubsup id="A1.E15.m1.5.5.1.1.2.2.2.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.cmml"><mrow id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.2.cmml"><mo id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.2.cmml">{</mo><mrow id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml"><msub id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.cmml"><mi id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2.cmml">P</mi><mi id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.1.cmml">​</mo><mrow id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2.1" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml">x</mi><mo id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.3" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.cmml"><mi id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.2" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.2.cmml">i</mi><mo id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.1" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.1.cmml">=</mo><mn id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.3" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.E15.m1.5.5.1.1.2.2.2.2.3" xref="A1.E15.m1.5.5.1.1.2.2.2.2.3.cmml">n</mi></msubsup><mo id="A1.E15.m1.5.5.1.1.2.2.2.5" xref="A1.E15.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A1.E15.m1.5.5.1.2" xref="A1.E15.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.5b"><apply id="A1.E15.m1.5.5.1.1.cmml" xref="A1.E15.m1.5.5.1"><eq id="A1.E15.m1.5.5.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.3"></eq><apply id="A1.E15.m1.5.5.1.1.4.cmml" xref="A1.E15.m1.5.5.1.1.4"><times id="A1.E15.m1.5.5.1.1.4.1.cmml" xref="A1.E15.m1.5.5.1.1.4.1"></times><apply id="A1.E15.m1.5.5.1.1.4.2.cmml" xref="A1.E15.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.4.2.1.cmml" xref="A1.E15.m1.5.5.1.1.4.2">superscript</csymbol><ci id="A1.E15.m1.5.5.1.1.4.2.2.cmml" xref="A1.E15.m1.5.5.1.1.4.2.2">𝑃</ci><ci id="A1.E15.m1.5.5.1.1.4.2.3.cmml" xref="A1.E15.m1.5.5.1.1.4.2.3">′</ci></apply><ci id="A1.E15.m1.2.2.cmml" xref="A1.E15.m1.2.2">𝑥</ci></apply><apply id="A1.E15.m1.5.5.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.2"><times id="A1.E15.m1.5.5.1.1.2.3.cmml" xref="A1.E15.m1.5.5.1.1.2.3"></times><apply id="A1.E15.m1.1.1.cmml" xref="A1.E15.m1.1.1"><apply id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1.1"><times id="A1.E15.m1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.2"></times><ci id="A1.E15.m1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.3">𝑃</ci><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝑥</ci></apply><ci id="A1.E15.m1.1.1.2.cmml" xref="A1.E15.m1.1.1.2">argmin</ci></apply><apply id="A1.E15.m1.5.5.1.1.2.4.cmml" xref="A1.E15.m1.5.5.1.1.2.4"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.2.4.1.cmml" xref="A1.E15.m1.5.5.1.1.2.4">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.2.4.2.cmml" xref="A1.E15.m1.5.5.1.1.2.4.2">𝐷</ci><ci id="A1.E15.m1.5.5.1.1.2.4.3.cmml" xref="A1.E15.m1.5.5.1.1.2.4.3">𝜆</ci></apply><list id="A1.E15.m1.5.5.1.1.2.2.3.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2"><apply id="A1.E15.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1"><times id="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.1"></times><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2">𝑃</ci><ci id="A1.E15.m1.3.3.cmml" xref="A1.E15.m1.3.3">𝑥</ci></apply><apply id="A1.E15.m1.5.5.1.1.2.2.2.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.2.2.2.2.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="A1.E15.m1.5.5.1.1.2.2.2.2.1.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.2.2.2.2.1.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2">subscript</csymbol><set id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1"><apply id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1"><times id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.1"></times><apply id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.1.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2">𝑃</ci><ci id="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4">𝑥</ci></apply></set><apply id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3"><eq id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.1.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.1"></eq><ci id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.2.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.3.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.1.3.3">1</cn></apply></apply><ci id="A1.E15.m1.5.5.1.1.2.2.2.2.3.cmml" xref="A1.E15.m1.5.5.1.1.2.2.2.2.3">𝑛</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.5c">P^{\prime}\left(x\right)=\underset{P(x)}{\mathrm{argmin}}D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p3.5" class="ltx_p">This problem can be solved for particular choices of the set-distance
function <math id="A1.SS2.p3.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">D</annotation></semantics></math> that measures the discrepancy between <math id="A1.SS2.p3.2.m2.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p3.2.m2.1a"><mrow id="A1.SS2.p3.2.m2.1.2" xref="A1.SS2.p3.2.m2.1.2.cmml"><mi id="A1.SS2.p3.2.m2.1.2.2" xref="A1.SS2.p3.2.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p3.2.m2.1.2.1" xref="A1.SS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p3.2.m2.1.2.3.2" xref="A1.SS2.p3.2.m2.1.2.cmml"><mo id="A1.SS2.p3.2.m2.1.2.3.2.1" xref="A1.SS2.p3.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">x</mi><mo id="A1.SS2.p3.2.m2.1.2.3.2.2" xref="A1.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.2.cmml" xref="A1.SS2.p3.2.m2.1.2"><times id="A1.SS2.p3.2.m2.1.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.1"></times><ci id="A1.SS2.p3.2.m2.1.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.2">𝑃</ci><ci id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">P\left(x\right)</annotation></semantics></math>
and the set <math id="A1.SS2.p3.3.m3.2" class="ltx_Math" alttext="\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}" display="inline"><semantics id="A1.SS2.p3.3.m3.2a"><msubsup id="A1.SS2.p3.3.m3.2.2" xref="A1.SS2.p3.3.m3.2.2.cmml"><mrow id="A1.SS2.p3.3.m3.2.2.1.1.1" xref="A1.SS2.p3.3.m3.2.2.1.1.2.cmml"><mo id="A1.SS2.p3.3.m3.2.2.1.1.1.2" xref="A1.SS2.p3.3.m3.2.2.1.1.2.cmml">{</mo><mrow id="A1.SS2.p3.3.m3.2.2.1.1.1.1" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.cmml"><msub id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.cmml"><mi id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.2" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.2.cmml">P</mi><mi id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.3" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p3.3.m3.2.2.1.1.1.1.1" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.1.cmml">​</mo><mrow id="A1.SS2.p3.3.m3.2.2.1.1.1.1.3.2" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.cmml"><mo id="A1.SS2.p3.3.m3.2.2.1.1.1.1.3.2.1" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.cmml">(</mo><mi id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml">x</mi><mo id="A1.SS2.p3.3.m3.2.2.1.1.1.1.3.2.2" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p3.3.m3.2.2.1.1.1.3" xref="A1.SS2.p3.3.m3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p3.3.m3.2.2.1.3" xref="A1.SS2.p3.3.m3.2.2.1.3.cmml"><mi id="A1.SS2.p3.3.m3.2.2.1.3.2" xref="A1.SS2.p3.3.m3.2.2.1.3.2.cmml">i</mi><mo id="A1.SS2.p3.3.m3.2.2.1.3.1" xref="A1.SS2.p3.3.m3.2.2.1.3.1.cmml">=</mo><mn id="A1.SS2.p3.3.m3.2.2.1.3.3" xref="A1.SS2.p3.3.m3.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p3.3.m3.2.2.3" xref="A1.SS2.p3.3.m3.2.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.2b"><apply id="A1.SS2.p3.3.m3.2.2.cmml" xref="A1.SS2.p3.3.m3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.2.2.2.cmml" xref="A1.SS2.p3.3.m3.2.2">superscript</csymbol><apply id="A1.SS2.p3.3.m3.2.2.1.cmml" xref="A1.SS2.p3.3.m3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.2.2.1.2.cmml" xref="A1.SS2.p3.3.m3.2.2">subscript</csymbol><set id="A1.SS2.p3.3.m3.2.2.1.1.2.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1"><apply id="A1.SS2.p3.3.m3.2.2.1.1.1.1.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1"><times id="A1.SS2.p3.3.m3.2.2.1.1.1.1.1.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.1"></times><apply id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.1.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.2.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.2">𝑃</ci><ci id="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.3.cmml" xref="A1.SS2.p3.3.m3.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1">𝑥</ci></apply></set><apply id="A1.SS2.p3.3.m3.2.2.1.3.cmml" xref="A1.SS2.p3.3.m3.2.2.1.3"><eq id="A1.SS2.p3.3.m3.2.2.1.3.1.cmml" xref="A1.SS2.p3.3.m3.2.2.1.3.1"></eq><ci id="A1.SS2.p3.3.m3.2.2.1.3.2.cmml" xref="A1.SS2.p3.3.m3.2.2.1.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p3.3.m3.2.2.1.3.3.cmml" xref="A1.SS2.p3.3.m3.2.2.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p3.3.m3.2.2.3.cmml" xref="A1.SS2.p3.3.m3.2.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.2c">\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}</annotation></semantics></math> under
the confidence weights <math id="A1.SS2.p3.4.m4.1" class="ltx_Math" alttext="\lambda=\left\{\lambda_{i}\right\}_{i=1}^{n}" display="inline"><semantics id="A1.SS2.p3.4.m4.1a"><mrow id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml"><mi id="A1.SS2.p3.4.m4.1.1.3" xref="A1.SS2.p3.4.m4.1.1.3.cmml">λ</mi><mo id="A1.SS2.p3.4.m4.1.1.2" xref="A1.SS2.p3.4.m4.1.1.2.cmml">=</mo><msubsup id="A1.SS2.p3.4.m4.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.cmml"><mrow id="A1.SS2.p3.4.m4.1.1.1.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.1.1.2.cmml"><mo id="A1.SS2.p3.4.m4.1.1.1.1.1.1.2" xref="A1.SS2.p3.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.2" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.2.cmml">λ</mi><mi id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.3" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p3.4.m4.1.1.1.1.1.1.3" xref="A1.SS2.p3.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p3.4.m4.1.1.1.1.3" xref="A1.SS2.p3.4.m4.1.1.1.1.3.cmml"><mi id="A1.SS2.p3.4.m4.1.1.1.1.3.2" xref="A1.SS2.p3.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p3.4.m4.1.1.1.1.3.1" xref="A1.SS2.p3.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p3.4.m4.1.1.1.1.3.3" xref="A1.SS2.p3.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p3.4.m4.1.1.1.3" xref="A1.SS2.p3.4.m4.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><apply id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1"><eq id="A1.SS2.p3.4.m4.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.2"></eq><ci id="A1.SS2.p3.4.m4.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.3">𝜆</ci><apply id="A1.SS2.p3.4.m4.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1">superscript</csymbol><apply id="A1.SS2.p3.4.m4.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1">subscript</csymbol><set id="A1.SS2.p3.4.m4.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1"><apply id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.2">𝜆</ci><ci id="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.3"><eq id="A1.SS2.p3.4.m4.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.3.1"></eq><ci id="A1.SS2.p3.4.m4.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p3.4.m4.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p3.4.m4.1.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">\lambda=\left\{\lambda_{i}\right\}_{i=1}^{n}</annotation></semantics></math>.
We consider several heuristic choices of the function <math id="A1.SS2.p3.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS2.p3.5.m5.1a"><mi id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><ci id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">D</annotation></semantics></math>:</p>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<p id="A1.SS2.p4.1" class="ltx_p"><span id="A1.SS2.p4.1.1" class="ltx_text ltx_font_bold">Additive form:</span></p>
</div>
<div id="A1.SS2.p5" class="ltx_para ltx_noindent">
<p id="A1.SS2.p5.3" class="ltx_p">If we define the distance to be Euclidean distance from <math id="A1.SS2.p5.1.m1.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p5.1.m1.1a"><mrow id="A1.SS2.p5.1.m1.1.2" xref="A1.SS2.p5.1.m1.1.2.cmml"><mi id="A1.SS2.p5.1.m1.1.2.2" xref="A1.SS2.p5.1.m1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.1.2.1" xref="A1.SS2.p5.1.m1.1.2.1.cmml">​</mo><mrow id="A1.SS2.p5.1.m1.1.2.3.2" xref="A1.SS2.p5.1.m1.1.2.cmml"><mo id="A1.SS2.p5.1.m1.1.2.3.2.1" xref="A1.SS2.p5.1.m1.1.2.cmml">(</mo><mi id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">x</mi><mo id="A1.SS2.p5.1.m1.1.2.3.2.2" xref="A1.SS2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><apply id="A1.SS2.p5.1.m1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.2"><times id="A1.SS2.p5.1.m1.1.2.1.cmml" xref="A1.SS2.p5.1.m1.1.2.1"></times><ci id="A1.SS2.p5.1.m1.1.2.2.cmml" xref="A1.SS2.p5.1.m1.1.2.2">𝑃</ci><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">P\left(x\right)</annotation></semantics></math>
to each member distribution <math id="A1.SS2.p5.2.m2.1" class="ltx_Math" alttext="P_{i}\left(x\right)" display="inline"><semantics id="A1.SS2.p5.2.m2.1a"><mrow id="A1.SS2.p5.2.m2.1.2" xref="A1.SS2.p5.2.m2.1.2.cmml"><msub id="A1.SS2.p5.2.m2.1.2.2" xref="A1.SS2.p5.2.m2.1.2.2.cmml"><mi id="A1.SS2.p5.2.m2.1.2.2.2" xref="A1.SS2.p5.2.m2.1.2.2.2.cmml">P</mi><mi id="A1.SS2.p5.2.m2.1.2.2.3" xref="A1.SS2.p5.2.m2.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p5.2.m2.1.2.1" xref="A1.SS2.p5.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p5.2.m2.1.2.3.2" xref="A1.SS2.p5.2.m2.1.2.cmml"><mo id="A1.SS2.p5.2.m2.1.2.3.2.1" xref="A1.SS2.p5.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">x</mi><mo id="A1.SS2.p5.2.m2.1.2.3.2.2" xref="A1.SS2.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><apply id="A1.SS2.p5.2.m2.1.2.cmml" xref="A1.SS2.p5.2.m2.1.2"><times id="A1.SS2.p5.2.m2.1.2.1.cmml" xref="A1.SS2.p5.2.m2.1.2.1"></times><apply id="A1.SS2.p5.2.m2.1.2.2.cmml" xref="A1.SS2.p5.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.1.2.2.1.cmml" xref="A1.SS2.p5.2.m2.1.2.2">subscript</csymbol><ci id="A1.SS2.p5.2.m2.1.2.2.2.cmml" xref="A1.SS2.p5.2.m2.1.2.2.2">𝑃</ci><ci id="A1.SS2.p5.2.m2.1.2.2.3.cmml" xref="A1.SS2.p5.2.m2.1.2.2.3">𝑖</ci></apply><ci id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">P_{i}\left(x\right)</annotation></semantics></math> of the set, then
the minimized term <math id="A1.SS2.p5.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS2.p5.3.m3.1a"><mi id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><ci id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">D</annotation></semantics></math> becomes</p>
</div>
<div id="A1.SS2.p6" class="ltx_para ltx_noindent">
<table id="A1.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E16.m1.5" class="ltx_Math" alttext="D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right)=\frac{1}{2}\sum_{i}\lambda_{i}\sum_{x}\left(P\left(x\right)-P_{i}\left(x\right)\right)^{2}." display="block"><semantics id="A1.E16.m1.5a"><mrow id="A1.E16.m1.5.5.1" xref="A1.E16.m1.5.5.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1" xref="A1.E16.m1.5.5.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1.2" xref="A1.E16.m1.5.5.1.1.2.cmml"><msub id="A1.E16.m1.5.5.1.1.2.4" xref="A1.E16.m1.5.5.1.1.2.4.cmml"><mi id="A1.E16.m1.5.5.1.1.2.4.2" xref="A1.E16.m1.5.5.1.1.2.4.2.cmml">D</mi><mi id="A1.E16.m1.5.5.1.1.2.4.3" xref="A1.E16.m1.5.5.1.1.2.4.3.cmml">λ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.2.3" xref="A1.E16.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.2.2.2" xref="A1.E16.m1.5.5.1.1.2.2.3.cmml"><mo id="A1.E16.m1.5.5.1.1.2.2.2.3" xref="A1.E16.m1.5.5.1.1.2.2.3.cmml">(</mo><mrow id="A1.E16.m1.5.5.1.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.5.5.1.1.1.1.1.1.2" xref="A1.E16.m1.5.5.1.1.1.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.1.1.1.1.3.2" xref="A1.E16.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.5.5.1.1.1.1.1.1.3.2.1" xref="A1.E16.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E16.m1.1.1" xref="A1.E16.m1.1.1.cmml">x</mi><mo id="A1.E16.m1.5.5.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.2.2.2.4" xref="A1.E16.m1.5.5.1.1.2.2.3.cmml">;</mo><msubsup id="A1.E16.m1.5.5.1.1.2.2.2.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.cmml"><mrow id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.2.cmml"><mo id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.2.cmml">{</mo><mrow id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml"><msub id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.cmml"><mi id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2.cmml">P</mi><mi id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.1.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml"><mo id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2.1" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml">(</mo><mi id="A1.E16.m1.2.2" xref="A1.E16.m1.2.2.cmml">x</mi><mo id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.3.2.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.3" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.cmml"><mi id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.2" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.2.cmml">i</mi><mo id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.1" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.1.cmml">=</mo><mn id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.3" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.E16.m1.5.5.1.1.2.2.2.2.3" xref="A1.E16.m1.5.5.1.1.2.2.2.2.3.cmml">n</mi></msubsup><mo id="A1.E16.m1.5.5.1.1.2.2.2.5" xref="A1.E16.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.4" xref="A1.E16.m1.5.5.1.1.4.cmml">=</mo><mrow id="A1.E16.m1.5.5.1.1.3" xref="A1.E16.m1.5.5.1.1.3.cmml"><mfrac id="A1.E16.m1.5.5.1.1.3.3" xref="A1.E16.m1.5.5.1.1.3.3.cmml"><mn id="A1.E16.m1.5.5.1.1.3.3.2" xref="A1.E16.m1.5.5.1.1.3.3.2.cmml">1</mn><mn id="A1.E16.m1.5.5.1.1.3.3.3" xref="A1.E16.m1.5.5.1.1.3.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.3.2" xref="A1.E16.m1.5.5.1.1.3.2.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.3.1" xref="A1.E16.m1.5.5.1.1.3.1.cmml"><munder id="A1.E16.m1.5.5.1.1.3.1.2" xref="A1.E16.m1.5.5.1.1.3.1.2.cmml"><mo movablelimits="false" id="A1.E16.m1.5.5.1.1.3.1.2.2" xref="A1.E16.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mi id="A1.E16.m1.5.5.1.1.3.1.2.3" xref="A1.E16.m1.5.5.1.1.3.1.2.3.cmml">i</mi></munder><mrow id="A1.E16.m1.5.5.1.1.3.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.cmml"><msub id="A1.E16.m1.5.5.1.1.3.1.1.3" xref="A1.E16.m1.5.5.1.1.3.1.1.3.cmml"><mi id="A1.E16.m1.5.5.1.1.3.1.1.3.2" xref="A1.E16.m1.5.5.1.1.3.1.1.3.2.cmml">λ</mi><mi id="A1.E16.m1.5.5.1.1.3.1.1.3.3" xref="A1.E16.m1.5.5.1.1.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.3.1.1.2" xref="A1.E16.m1.5.5.1.1.3.1.1.2.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.cmml"><munder id="A1.E16.m1.5.5.1.1.3.1.1.1.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E16.m1.5.5.1.1.3.1.1.1.2.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2.2.cmml">∑</mo><mi id="A1.E16.m1.5.5.1.1.3.1.1.1.2.3" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2.3.cmml">x</mi></munder><msup id="A1.E16.m1.5.5.1.1.3.1.1.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.2.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.m1.3.3" xref="A1.E16.m1.3.3.cmml">x</mi><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.2.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.3" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.3.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.3.2.1" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E16.m1.4.4" xref="A1.E16.m1.4.4.cmml">x</mi><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.3.2.2" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.3" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E16.m1.5.5.1.1.3.1.1.1.1.3" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E16.m1.5.5.1.2" xref="A1.E16.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.5b"><apply id="A1.E16.m1.5.5.1.1.cmml" xref="A1.E16.m1.5.5.1"><eq id="A1.E16.m1.5.5.1.1.4.cmml" xref="A1.E16.m1.5.5.1.1.4"></eq><apply id="A1.E16.m1.5.5.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.2"><times id="A1.E16.m1.5.5.1.1.2.3.cmml" xref="A1.E16.m1.5.5.1.1.2.3"></times><apply id="A1.E16.m1.5.5.1.1.2.4.cmml" xref="A1.E16.m1.5.5.1.1.2.4"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.2.4.1.cmml" xref="A1.E16.m1.5.5.1.1.2.4">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.2.4.2.cmml" xref="A1.E16.m1.5.5.1.1.2.4.2">𝐷</ci><ci id="A1.E16.m1.5.5.1.1.2.4.3.cmml" xref="A1.E16.m1.5.5.1.1.2.4.3">𝜆</ci></apply><list id="A1.E16.m1.5.5.1.1.2.2.3.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2"><apply id="A1.E16.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.1.1.1.1"><times id="A1.E16.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.1.1.1.1.1"></times><ci id="A1.E16.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.1.1.1.1.2">𝑃</ci><ci id="A1.E16.m1.1.1.cmml" xref="A1.E16.m1.1.1">𝑥</ci></apply><apply id="A1.E16.m1.5.5.1.1.2.2.2.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.2.2.2.2.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="A1.E16.m1.5.5.1.1.2.2.2.2.1.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.2.2.2.2.1.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2">subscript</csymbol><set id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1"><apply id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1"><times id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.1"></times><apply id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.1.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.2">𝑃</ci><ci id="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E16.m1.2.2.cmml" xref="A1.E16.m1.2.2">𝑥</ci></apply></set><apply id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3"><eq id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.1.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.1"></eq><ci id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.2.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.3.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.1.3.3">1</cn></apply></apply><ci id="A1.E16.m1.5.5.1.1.2.2.2.2.3.cmml" xref="A1.E16.m1.5.5.1.1.2.2.2.2.3">𝑛</ci></apply></list></apply><apply id="A1.E16.m1.5.5.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.3"><times id="A1.E16.m1.5.5.1.1.3.2.cmml" xref="A1.E16.m1.5.5.1.1.3.2"></times><apply id="A1.E16.m1.5.5.1.1.3.3.cmml" xref="A1.E16.m1.5.5.1.1.3.3"><divide id="A1.E16.m1.5.5.1.1.3.3.1.cmml" xref="A1.E16.m1.5.5.1.1.3.3"></divide><cn type="integer" id="A1.E16.m1.5.5.1.1.3.3.2.cmml" xref="A1.E16.m1.5.5.1.1.3.3.2">1</cn><cn type="integer" id="A1.E16.m1.5.5.1.1.3.3.3.cmml" xref="A1.E16.m1.5.5.1.1.3.3.3">2</cn></apply><apply id="A1.E16.m1.5.5.1.1.3.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1"><apply id="A1.E16.m1.5.5.1.1.3.1.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.3.1.2.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.2">subscript</csymbol><sum id="A1.E16.m1.5.5.1.1.3.1.2.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.2.2"></sum><ci id="A1.E16.m1.5.5.1.1.3.1.2.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.2.3">𝑖</ci></apply><apply id="A1.E16.m1.5.5.1.1.3.1.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1"><times id="A1.E16.m1.5.5.1.1.3.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.2"></times><apply id="A1.E16.m1.5.5.1.1.3.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.3.1.1.3.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.3">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.3.1.1.3.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.3.2">𝜆</ci><ci id="A1.E16.m1.5.5.1.1.3.1.1.3.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.3.3">𝑖</ci></apply><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1"><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.3.1.1.1.2.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2">subscript</csymbol><sum id="A1.E16.m1.5.5.1.1.3.1.1.1.2.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2.2"></sum><ci id="A1.E16.m1.5.5.1.1.3.1.1.1.2.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.2.3">𝑥</ci></apply><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.3.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1">superscript</csymbol><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1"><minus id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.1"></minus><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2"><times id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1"></times><ci id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="A1.E16.m1.3.3.cmml" xref="A1.E16.m1.3.3">𝑥</ci></apply><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3"><times id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E16.m1.4.4.cmml" xref="A1.E16.m1.4.4">𝑥</ci></apply></apply><cn type="integer" id="A1.E16.m1.5.5.1.1.3.1.1.1.1.3.cmml" xref="A1.E16.m1.5.5.1.1.3.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.5c">D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right)=\frac{1}{2}\sum_{i}\lambda_{i}\sum_{x}\left(P\left(x\right)-P_{i}\left(x\right)\right)^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p6.2" class="ltx_p">Here, we minimize <math id="A1.SS2.p6.1.m1.1" class="ltx_Math" alttext="D_{\lambda}" display="inline"><semantics id="A1.SS2.p6.1.m1.1a"><msub id="A1.SS2.p6.1.m1.1.1" xref="A1.SS2.p6.1.m1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.1.1.2" xref="A1.SS2.p6.1.m1.1.1.2.cmml">D</mi><mi id="A1.SS2.p6.1.m1.1.1.3" xref="A1.SS2.p6.1.m1.1.1.3.cmml">λ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.1.m1.1b"><apply id="A1.SS2.p6.1.m1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p6.1.m1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.1.1.2">𝐷</ci><ci id="A1.SS2.p6.1.m1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.1c">D_{\lambda}</annotation></semantics></math> w.r.t. <math id="A1.SS2.p6.2.m2.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p6.2.m2.1a"><mrow id="A1.SS2.p6.2.m2.1.2" xref="A1.SS2.p6.2.m2.1.2.cmml"><mi id="A1.SS2.p6.2.m2.1.2.2" xref="A1.SS2.p6.2.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.2.m2.1.2.1" xref="A1.SS2.p6.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p6.2.m2.1.2.3.2" xref="A1.SS2.p6.2.m2.1.2.cmml"><mo id="A1.SS2.p6.2.m2.1.2.3.2.1" xref="A1.SS2.p6.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p6.2.m2.1.1" xref="A1.SS2.p6.2.m2.1.1.cmml">x</mi><mo id="A1.SS2.p6.2.m2.1.2.3.2.2" xref="A1.SS2.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.1b"><apply id="A1.SS2.p6.2.m2.1.2.cmml" xref="A1.SS2.p6.2.m2.1.2"><times id="A1.SS2.p6.2.m2.1.2.1.cmml" xref="A1.SS2.p6.2.m2.1.2.1"></times><ci id="A1.SS2.p6.2.m2.1.2.2.cmml" xref="A1.SS2.p6.2.m2.1.2.2">𝑃</ci><ci id="A1.SS2.p6.2.m2.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.1c">P\left(x\right)</annotation></semantics></math>:</p>
</div>
<div id="A1.SS2.p7" class="ltx_para ltx_noindent">
<table id="A1.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex1.m1.3" class="ltx_Math" alttext="\partial_{P}D=\sum_{i}\lambda_{i}\left(P\left(x\right)-P_{i}\left(x\right)\right)." display="block"><semantics id="A1.Ex1.m1.3a"><mrow id="A1.Ex1.m1.3.3.1" xref="A1.Ex1.m1.3.3.1.1.cmml"><mrow id="A1.Ex1.m1.3.3.1.1" xref="A1.Ex1.m1.3.3.1.1.cmml"><mrow id="A1.Ex1.m1.3.3.1.1.3" xref="A1.Ex1.m1.3.3.1.1.3.cmml"><msub id="A1.Ex1.m1.3.3.1.1.3.1" xref="A1.Ex1.m1.3.3.1.1.3.1.cmml"><mo id="A1.Ex1.m1.3.3.1.1.3.1.2" xref="A1.Ex1.m1.3.3.1.1.3.1.2.cmml">∂</mo><mi id="A1.Ex1.m1.3.3.1.1.3.1.3" xref="A1.Ex1.m1.3.3.1.1.3.1.3.cmml">P</mi></msub><mi id="A1.Ex1.m1.3.3.1.1.3.2" xref="A1.Ex1.m1.3.3.1.1.3.2.cmml">D</mi></mrow><mo rspace="0.111em" id="A1.Ex1.m1.3.3.1.1.2" xref="A1.Ex1.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.Ex1.m1.3.3.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.cmml"><munder id="A1.Ex1.m1.3.3.1.1.1.2" xref="A1.Ex1.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="A1.Ex1.m1.3.3.1.1.1.2.2" xref="A1.Ex1.m1.3.3.1.1.1.2.2.cmml">∑</mo><mi id="A1.Ex1.m1.3.3.1.1.1.2.3" xref="A1.Ex1.m1.3.3.1.1.1.2.3.cmml">i</mi></munder><mrow id="A1.Ex1.m1.3.3.1.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.1.cmml"><msub id="A1.Ex1.m1.3.3.1.1.1.1.3" xref="A1.Ex1.m1.3.3.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.3.3.1.1.1.1.3.2" xref="A1.Ex1.m1.3.3.1.1.1.1.3.2.cmml">λ</mi><mi id="A1.Ex1.m1.3.3.1.1.1.1.3.3" xref="A1.Ex1.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.3.3.1.1.1.1.2" xref="A1.Ex1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.3.2.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml">x</mi><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.3.2.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><msub id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.Ex1.m1.2.2" xref="A1.Ex1.m1.2.2.cmml">x</mi><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex1.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.Ex1.m1.3.3.1.2" xref="A1.Ex1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.3b"><apply id="A1.Ex1.m1.3.3.1.1.cmml" xref="A1.Ex1.m1.3.3.1"><eq id="A1.Ex1.m1.3.3.1.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.2"></eq><apply id="A1.Ex1.m1.3.3.1.1.3.cmml" xref="A1.Ex1.m1.3.3.1.1.3"><apply id="A1.Ex1.m1.3.3.1.1.3.1.cmml" xref="A1.Ex1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.3.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.3.1">subscript</csymbol><partialdiff id="A1.Ex1.m1.3.3.1.1.3.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.3.1.2"></partialdiff><ci id="A1.Ex1.m1.3.3.1.1.3.1.3.cmml" xref="A1.Ex1.m1.3.3.1.1.3.1.3">𝑃</ci></apply><ci id="A1.Ex1.m1.3.3.1.1.3.2.cmml" xref="A1.Ex1.m1.3.3.1.1.3.2">𝐷</ci></apply><apply id="A1.Ex1.m1.3.3.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1"><apply id="A1.Ex1.m1.3.3.1.1.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.1.2.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2">subscript</csymbol><sum id="A1.Ex1.m1.3.3.1.1.1.2.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2.2"></sum><ci id="A1.Ex1.m1.3.3.1.1.1.2.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex1.m1.3.3.1.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1"><times id="A1.Ex1.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.2"></times><apply id="A1.Ex1.m1.3.3.1.1.1.1.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex1.m1.3.3.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.3.2">𝜆</ci><ci id="A1.Ex1.m1.3.3.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1"><minus id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2"><times id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1">𝑥</ci></apply><apply id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3"><times id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.1"></times><apply id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.Ex1.m1.2.2.cmml" xref="A1.Ex1.m1.2.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.3c">\partial_{P}D=\sum_{i}\lambda_{i}\left(P\left(x\right)-P_{i}\left(x\right)\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS2.p7.1" class="ltx_p">By setting this gradient to zero, we have <math id="A1.SS2.p7.1.m1.2" class="ltx_Math" alttext="P^{\prime}\left(x\right)=\sum_{i}\lambda_{i}P_{i}\left(x\right)" display="inline"><semantics id="A1.SS2.p7.1.m1.2a"><mrow id="A1.SS2.p7.1.m1.2.3" xref="A1.SS2.p7.1.m1.2.3.cmml"><mrow id="A1.SS2.p7.1.m1.2.3.2" xref="A1.SS2.p7.1.m1.2.3.2.cmml"><msup id="A1.SS2.p7.1.m1.2.3.2.2" xref="A1.SS2.p7.1.m1.2.3.2.2.cmml"><mi id="A1.SS2.p7.1.m1.2.3.2.2.2" xref="A1.SS2.p7.1.m1.2.3.2.2.2.cmml">P</mi><mo id="A1.SS2.p7.1.m1.2.3.2.2.3" xref="A1.SS2.p7.1.m1.2.3.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.2.3.2.1" xref="A1.SS2.p7.1.m1.2.3.2.1.cmml">​</mo><mrow id="A1.SS2.p7.1.m1.2.3.2.3.2" xref="A1.SS2.p7.1.m1.2.3.2.cmml"><mo id="A1.SS2.p7.1.m1.2.3.2.3.2.1" xref="A1.SS2.p7.1.m1.2.3.2.cmml">(</mo><mi id="A1.SS2.p7.1.m1.1.1" xref="A1.SS2.p7.1.m1.1.1.cmml">x</mi><mo id="A1.SS2.p7.1.m1.2.3.2.3.2.2" xref="A1.SS2.p7.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A1.SS2.p7.1.m1.2.3.1" xref="A1.SS2.p7.1.m1.2.3.1.cmml">=</mo><mrow id="A1.SS2.p7.1.m1.2.3.3" xref="A1.SS2.p7.1.m1.2.3.3.cmml"><msub id="A1.SS2.p7.1.m1.2.3.3.1" xref="A1.SS2.p7.1.m1.2.3.3.1.cmml"><mo id="A1.SS2.p7.1.m1.2.3.3.1.2" xref="A1.SS2.p7.1.m1.2.3.3.1.2.cmml">∑</mo><mi id="A1.SS2.p7.1.m1.2.3.3.1.3" xref="A1.SS2.p7.1.m1.2.3.3.1.3.cmml">i</mi></msub><mrow id="A1.SS2.p7.1.m1.2.3.3.2" xref="A1.SS2.p7.1.m1.2.3.3.2.cmml"><msub id="A1.SS2.p7.1.m1.2.3.3.2.2" xref="A1.SS2.p7.1.m1.2.3.3.2.2.cmml"><mi id="A1.SS2.p7.1.m1.2.3.3.2.2.2" xref="A1.SS2.p7.1.m1.2.3.3.2.2.2.cmml">λ</mi><mi id="A1.SS2.p7.1.m1.2.3.3.2.2.3" xref="A1.SS2.p7.1.m1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.2.3.3.2.1" xref="A1.SS2.p7.1.m1.2.3.3.2.1.cmml">​</mo><msub id="A1.SS2.p7.1.m1.2.3.3.2.3" xref="A1.SS2.p7.1.m1.2.3.3.2.3.cmml"><mi id="A1.SS2.p7.1.m1.2.3.3.2.3.2" xref="A1.SS2.p7.1.m1.2.3.3.2.3.2.cmml">P</mi><mi id="A1.SS2.p7.1.m1.2.3.3.2.3.3" xref="A1.SS2.p7.1.m1.2.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.2.3.3.2.1a" xref="A1.SS2.p7.1.m1.2.3.3.2.1.cmml">​</mo><mrow id="A1.SS2.p7.1.m1.2.3.3.2.4.2" xref="A1.SS2.p7.1.m1.2.3.3.2.cmml"><mo id="A1.SS2.p7.1.m1.2.3.3.2.4.2.1" xref="A1.SS2.p7.1.m1.2.3.3.2.cmml">(</mo><mi id="A1.SS2.p7.1.m1.2.2" xref="A1.SS2.p7.1.m1.2.2.cmml">x</mi><mo id="A1.SS2.p7.1.m1.2.3.3.2.4.2.2" xref="A1.SS2.p7.1.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.1.m1.2b"><apply id="A1.SS2.p7.1.m1.2.3.cmml" xref="A1.SS2.p7.1.m1.2.3"><eq id="A1.SS2.p7.1.m1.2.3.1.cmml" xref="A1.SS2.p7.1.m1.2.3.1"></eq><apply id="A1.SS2.p7.1.m1.2.3.2.cmml" xref="A1.SS2.p7.1.m1.2.3.2"><times id="A1.SS2.p7.1.m1.2.3.2.1.cmml" xref="A1.SS2.p7.1.m1.2.3.2.1"></times><apply id="A1.SS2.p7.1.m1.2.3.2.2.cmml" xref="A1.SS2.p7.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.2.3.2.2.1.cmml" xref="A1.SS2.p7.1.m1.2.3.2.2">superscript</csymbol><ci id="A1.SS2.p7.1.m1.2.3.2.2.2.cmml" xref="A1.SS2.p7.1.m1.2.3.2.2.2">𝑃</ci><ci id="A1.SS2.p7.1.m1.2.3.2.2.3.cmml" xref="A1.SS2.p7.1.m1.2.3.2.2.3">′</ci></apply><ci id="A1.SS2.p7.1.m1.1.1.cmml" xref="A1.SS2.p7.1.m1.1.1">𝑥</ci></apply><apply id="A1.SS2.p7.1.m1.2.3.3.cmml" xref="A1.SS2.p7.1.m1.2.3.3"><apply id="A1.SS2.p7.1.m1.2.3.3.1.cmml" xref="A1.SS2.p7.1.m1.2.3.3.1"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.2.3.3.1.1.cmml" xref="A1.SS2.p7.1.m1.2.3.3.1">subscript</csymbol><sum id="A1.SS2.p7.1.m1.2.3.3.1.2.cmml" xref="A1.SS2.p7.1.m1.2.3.3.1.2"></sum><ci id="A1.SS2.p7.1.m1.2.3.3.1.3.cmml" xref="A1.SS2.p7.1.m1.2.3.3.1.3">𝑖</ci></apply><apply id="A1.SS2.p7.1.m1.2.3.3.2.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2"><times id="A1.SS2.p7.1.m1.2.3.3.2.1.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.1"></times><apply id="A1.SS2.p7.1.m1.2.3.3.2.2.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.2.3.3.2.2.1.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.2">subscript</csymbol><ci id="A1.SS2.p7.1.m1.2.3.3.2.2.2.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.2.2">𝜆</ci><ci id="A1.SS2.p7.1.m1.2.3.3.2.2.3.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.2.3">𝑖</ci></apply><apply id="A1.SS2.p7.1.m1.2.3.3.2.3.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.2.3.3.2.3.1.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.3">subscript</csymbol><ci id="A1.SS2.p7.1.m1.2.3.3.2.3.2.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.3.2">𝑃</ci><ci id="A1.SS2.p7.1.m1.2.3.3.2.3.3.cmml" xref="A1.SS2.p7.1.m1.2.3.3.2.3.3">𝑖</ci></apply><ci id="A1.SS2.p7.1.m1.2.2.cmml" xref="A1.SS2.p7.1.m1.2.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.1.m1.2c">P^{\prime}\left(x\right)=\sum_{i}\lambda_{i}P_{i}\left(x\right)</annotation></semantics></math>.
This explains for the additive form of our attention refinement mechanism
in Eqs. (<a href="#S4.E10" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> and <a href="#S4.E14" title="In 4.3.2 Joint attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>
(upper part)) in the main paper where we seek a solution that best
agrees with the grounding prior and the model-induced probability
. 
<br class="ltx_break"></p>
</div>
<div id="A1.SS2.p8" class="ltx_para ltx_noindent">
<p id="A1.SS2.p8.1" class="ltx_p"><span id="A1.SS2.p8.1.1" class="ltx_text ltx_font_bold">Multiplicative form:</span></p>
</div>
<div id="A1.SS2.p9" class="ltx_para ltx_noindent">
<p id="A1.SS2.p9.3" class="ltx_p">If we define <math id="A1.SS2.p9.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS2.p9.1.m1.1a"><mi id="A1.SS2.p9.1.m1.1.1" xref="A1.SS2.p9.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.1.m1.1b"><ci id="A1.SS2.p9.1.m1.1.1.cmml" xref="A1.SS2.p9.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.1.m1.1c">D</annotation></semantics></math> as the weighted sum of the KL divergences between
<math id="A1.SS2.p9.2.m2.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p9.2.m2.1a"><mrow id="A1.SS2.p9.2.m2.1.2" xref="A1.SS2.p9.2.m2.1.2.cmml"><mi id="A1.SS2.p9.2.m2.1.2.2" xref="A1.SS2.p9.2.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p9.2.m2.1.2.1" xref="A1.SS2.p9.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p9.2.m2.1.2.3.2" xref="A1.SS2.p9.2.m2.1.2.cmml"><mo id="A1.SS2.p9.2.m2.1.2.3.2.1" xref="A1.SS2.p9.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p9.2.m2.1.1" xref="A1.SS2.p9.2.m2.1.1.cmml">x</mi><mo id="A1.SS2.p9.2.m2.1.2.3.2.2" xref="A1.SS2.p9.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.2.m2.1b"><apply id="A1.SS2.p9.2.m2.1.2.cmml" xref="A1.SS2.p9.2.m2.1.2"><times id="A1.SS2.p9.2.m2.1.2.1.cmml" xref="A1.SS2.p9.2.m2.1.2.1"></times><ci id="A1.SS2.p9.2.m2.1.2.2.cmml" xref="A1.SS2.p9.2.m2.1.2.2">𝑃</ci><ci id="A1.SS2.p9.2.m2.1.1.cmml" xref="A1.SS2.p9.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.2.m2.1c">P\left(x\right)</annotation></semantics></math> to each member distribution <math id="A1.SS2.p9.3.m3.1" class="ltx_Math" alttext="P_{i}\left(x\right)" display="inline"><semantics id="A1.SS2.p9.3.m3.1a"><mrow id="A1.SS2.p9.3.m3.1.2" xref="A1.SS2.p9.3.m3.1.2.cmml"><msub id="A1.SS2.p9.3.m3.1.2.2" xref="A1.SS2.p9.3.m3.1.2.2.cmml"><mi id="A1.SS2.p9.3.m3.1.2.2.2" xref="A1.SS2.p9.3.m3.1.2.2.2.cmml">P</mi><mi id="A1.SS2.p9.3.m3.1.2.2.3" xref="A1.SS2.p9.3.m3.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p9.3.m3.1.2.1" xref="A1.SS2.p9.3.m3.1.2.1.cmml">​</mo><mrow id="A1.SS2.p9.3.m3.1.2.3.2" xref="A1.SS2.p9.3.m3.1.2.cmml"><mo id="A1.SS2.p9.3.m3.1.2.3.2.1" xref="A1.SS2.p9.3.m3.1.2.cmml">(</mo><mi id="A1.SS2.p9.3.m3.1.1" xref="A1.SS2.p9.3.m3.1.1.cmml">x</mi><mo id="A1.SS2.p9.3.m3.1.2.3.2.2" xref="A1.SS2.p9.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.3.m3.1b"><apply id="A1.SS2.p9.3.m3.1.2.cmml" xref="A1.SS2.p9.3.m3.1.2"><times id="A1.SS2.p9.3.m3.1.2.1.cmml" xref="A1.SS2.p9.3.m3.1.2.1"></times><apply id="A1.SS2.p9.3.m3.1.2.2.cmml" xref="A1.SS2.p9.3.m3.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p9.3.m3.1.2.2.1.cmml" xref="A1.SS2.p9.3.m3.1.2.2">subscript</csymbol><ci id="A1.SS2.p9.3.m3.1.2.2.2.cmml" xref="A1.SS2.p9.3.m3.1.2.2.2">𝑃</ci><ci id="A1.SS2.p9.3.m3.1.2.2.3.cmml" xref="A1.SS2.p9.3.m3.1.2.2.3">𝑖</ci></apply><ci id="A1.SS2.p9.3.m3.1.1.cmml" xref="A1.SS2.p9.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.3.m3.1c">P_{i}\left(x\right)</annotation></semantics></math>
of the set:</p>
<table id="A2.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E17.m1.4" class="ltx_Math" alttext="\displaystyle D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right)" display="inline"><semantics id="A1.E17.m1.4a"><mrow id="A1.E17.m1.4.4" xref="A1.E17.m1.4.4.cmml"><msub id="A1.E17.m1.4.4.4" xref="A1.E17.m1.4.4.4.cmml"><mi id="A1.E17.m1.4.4.4.2" xref="A1.E17.m1.4.4.4.2.cmml">D</mi><mi id="A1.E17.m1.4.4.4.3" xref="A1.E17.m1.4.4.4.3.cmml">λ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E17.m1.4.4.3" xref="A1.E17.m1.4.4.3.cmml">​</mo><mrow id="A1.E17.m1.4.4.2.2" xref="A1.E17.m1.4.4.2.3.cmml"><mo id="A1.E17.m1.4.4.2.2.3" xref="A1.E17.m1.4.4.2.3.cmml">(</mo><mrow id="A1.E17.m1.3.3.1.1.1" xref="A1.E17.m1.3.3.1.1.1.cmml"><mi id="A1.E17.m1.3.3.1.1.1.2" xref="A1.E17.m1.3.3.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E17.m1.3.3.1.1.1.1" xref="A1.E17.m1.3.3.1.1.1.1.cmml">​</mo><mrow id="A1.E17.m1.3.3.1.1.1.3.2" xref="A1.E17.m1.3.3.1.1.1.cmml"><mo id="A1.E17.m1.3.3.1.1.1.3.2.1" xref="A1.E17.m1.3.3.1.1.1.cmml">(</mo><mi id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml">x</mi><mo id="A1.E17.m1.3.3.1.1.1.3.2.2" xref="A1.E17.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.4.4.2.2.4" xref="A1.E17.m1.4.4.2.3.cmml">;</mo><msubsup id="A1.E17.m1.4.4.2.2.2" xref="A1.E17.m1.4.4.2.2.2.cmml"><mrow id="A1.E17.m1.4.4.2.2.2.1.1.1" xref="A1.E17.m1.4.4.2.2.2.1.1.2.cmml"><mo id="A1.E17.m1.4.4.2.2.2.1.1.1.2" xref="A1.E17.m1.4.4.2.2.2.1.1.2.cmml">{</mo><mrow id="A1.E17.m1.4.4.2.2.2.1.1.1.1" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.cmml"><msub id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.cmml"><mi id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.2" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.2.cmml">P</mi><mi id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.3" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E17.m1.4.4.2.2.2.1.1.1.1.1" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.1.cmml">​</mo><mrow id="A1.E17.m1.4.4.2.2.2.1.1.1.1.3.2" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.cmml"><mo id="A1.E17.m1.4.4.2.2.2.1.1.1.1.3.2.1" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.cmml">(</mo><mi id="A1.E17.m1.2.2" xref="A1.E17.m1.2.2.cmml">x</mi><mo id="A1.E17.m1.4.4.2.2.2.1.1.1.1.3.2.2" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.4.4.2.2.2.1.1.1.3" xref="A1.E17.m1.4.4.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.E17.m1.4.4.2.2.2.1.3" xref="A1.E17.m1.4.4.2.2.2.1.3.cmml"><mi id="A1.E17.m1.4.4.2.2.2.1.3.2" xref="A1.E17.m1.4.4.2.2.2.1.3.2.cmml">i</mi><mo id="A1.E17.m1.4.4.2.2.2.1.3.1" xref="A1.E17.m1.4.4.2.2.2.1.3.1.cmml">=</mo><mn id="A1.E17.m1.4.4.2.2.2.1.3.3" xref="A1.E17.m1.4.4.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.E17.m1.4.4.2.2.2.3" xref="A1.E17.m1.4.4.2.2.2.3.cmml">n</mi></msubsup><mo id="A1.E17.m1.4.4.2.2.5" xref="A1.E17.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.4b"><apply id="A1.E17.m1.4.4.cmml" xref="A1.E17.m1.4.4"><times id="A1.E17.m1.4.4.3.cmml" xref="A1.E17.m1.4.4.3"></times><apply id="A1.E17.m1.4.4.4.cmml" xref="A1.E17.m1.4.4.4"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.4.1.cmml" xref="A1.E17.m1.4.4.4">subscript</csymbol><ci id="A1.E17.m1.4.4.4.2.cmml" xref="A1.E17.m1.4.4.4.2">𝐷</ci><ci id="A1.E17.m1.4.4.4.3.cmml" xref="A1.E17.m1.4.4.4.3">𝜆</ci></apply><list id="A1.E17.m1.4.4.2.3.cmml" xref="A1.E17.m1.4.4.2.2"><apply id="A1.E17.m1.3.3.1.1.1.cmml" xref="A1.E17.m1.3.3.1.1.1"><times id="A1.E17.m1.3.3.1.1.1.1.cmml" xref="A1.E17.m1.3.3.1.1.1.1"></times><ci id="A1.E17.m1.3.3.1.1.1.2.cmml" xref="A1.E17.m1.3.3.1.1.1.2">𝑃</ci><ci id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1">𝑥</ci></apply><apply id="A1.E17.m1.4.4.2.2.2.cmml" xref="A1.E17.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.2.2.2.2.cmml" xref="A1.E17.m1.4.4.2.2.2">superscript</csymbol><apply id="A1.E17.m1.4.4.2.2.2.1.cmml" xref="A1.E17.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.2.2.2.1.2.cmml" xref="A1.E17.m1.4.4.2.2.2">subscript</csymbol><set id="A1.E17.m1.4.4.2.2.2.1.1.2.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1"><apply id="A1.E17.m1.4.4.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1"><times id="A1.E17.m1.4.4.2.2.2.1.1.1.1.1.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.1"></times><apply id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.1.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.2.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.2">𝑃</ci><ci id="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.3.cmml" xref="A1.E17.m1.4.4.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E17.m1.2.2.cmml" xref="A1.E17.m1.2.2">𝑥</ci></apply></set><apply id="A1.E17.m1.4.4.2.2.2.1.3.cmml" xref="A1.E17.m1.4.4.2.2.2.1.3"><eq id="A1.E17.m1.4.4.2.2.2.1.3.1.cmml" xref="A1.E17.m1.4.4.2.2.2.1.3.1"></eq><ci id="A1.E17.m1.4.4.2.2.2.1.3.2.cmml" xref="A1.E17.m1.4.4.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="A1.E17.m1.4.4.2.2.2.1.3.3.cmml" xref="A1.E17.m1.4.4.2.2.2.1.3.3">1</cn></apply></apply><ci id="A1.E17.m1.4.4.2.2.2.3.cmml" xref="A1.E17.m1.4.4.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.4c">\displaystyle D_{\lambda}\left(P\left(x\right);\left\{P_{i}\left(x\right)\right\}_{i=1}^{n}\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E17.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i}\lambda_{i}\textrm{KL}\left(P\left(x\right)\parallel P_{i}\left(x\right)\right)" display="inline"><semantics id="A1.E17.m2.3a"><mrow id="A1.E17.m2.3.3" xref="A1.E17.m2.3.3.cmml"><mi id="A1.E17.m2.3.3.3" xref="A1.E17.m2.3.3.3.cmml"></mi><mo id="A1.E17.m2.3.3.2" xref="A1.E17.m2.3.3.2.cmml">=</mo><mrow id="A1.E17.m2.3.3.1" xref="A1.E17.m2.3.3.1.cmml"><mstyle displaystyle="true" id="A1.E17.m2.3.3.1.2" xref="A1.E17.m2.3.3.1.2.cmml"><munder id="A1.E17.m2.3.3.1.2a" xref="A1.E17.m2.3.3.1.2.cmml"><mo movablelimits="false" id="A1.E17.m2.3.3.1.2.2" xref="A1.E17.m2.3.3.1.2.2.cmml">∑</mo><mi id="A1.E17.m2.3.3.1.2.3" xref="A1.E17.m2.3.3.1.2.3.cmml">i</mi></munder></mstyle><mrow id="A1.E17.m2.3.3.1.1" xref="A1.E17.m2.3.3.1.1.cmml"><msub id="A1.E17.m2.3.3.1.1.3" xref="A1.E17.m2.3.3.1.1.3.cmml"><mi id="A1.E17.m2.3.3.1.1.3.2" xref="A1.E17.m2.3.3.1.1.3.2.cmml">λ</mi><mi id="A1.E17.m2.3.3.1.1.3.3" xref="A1.E17.m2.3.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E17.m2.3.3.1.1.2" xref="A1.E17.m2.3.3.1.1.2.cmml">​</mo><mtext id="A1.E17.m2.3.3.1.1.4" xref="A1.E17.m2.3.3.1.1.4a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="A1.E17.m2.3.3.1.1.2a" xref="A1.E17.m2.3.3.1.1.2.cmml">​</mo><mrow id="A1.E17.m2.3.3.1.1.1.1" xref="A1.E17.m2.3.3.1.1.1.1.1.cmml"><mo id="A1.E17.m2.3.3.1.1.1.1.2" xref="A1.E17.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m2.3.3.1.1.1.1.1" xref="A1.E17.m2.3.3.1.1.1.1.1.cmml"><mrow id="A1.E17.m2.3.3.1.1.1.1.1.2" xref="A1.E17.m2.3.3.1.1.1.1.1.2.cmml"><mi id="A1.E17.m2.3.3.1.1.1.1.1.2.2" xref="A1.E17.m2.3.3.1.1.1.1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E17.m2.3.3.1.1.1.1.1.2.1" xref="A1.E17.m2.3.3.1.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.E17.m2.3.3.1.1.1.1.1.2.3.2" xref="A1.E17.m2.3.3.1.1.1.1.1.2.cmml"><mo id="A1.E17.m2.3.3.1.1.1.1.1.2.3.2.1" xref="A1.E17.m2.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E17.m2.1.1" xref="A1.E17.m2.1.1.cmml">x</mi><mo id="A1.E17.m2.3.3.1.1.1.1.1.2.3.2.2" xref="A1.E17.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E17.m2.3.3.1.1.1.1.1.1" xref="A1.E17.m2.3.3.1.1.1.1.1.1.cmml">∥</mo><mrow id="A1.E17.m2.3.3.1.1.1.1.1.3" xref="A1.E17.m2.3.3.1.1.1.1.1.3.cmml"><msub id="A1.E17.m2.3.3.1.1.1.1.1.3.2" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2.cmml"><mi id="A1.E17.m2.3.3.1.1.1.1.1.3.2.2" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="A1.E17.m2.3.3.1.1.1.1.1.3.2.3" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E17.m2.3.3.1.1.1.1.1.3.1" xref="A1.E17.m2.3.3.1.1.1.1.1.3.1.cmml">​</mo><mrow id="A1.E17.m2.3.3.1.1.1.1.1.3.3.2" xref="A1.E17.m2.3.3.1.1.1.1.1.3.cmml"><mo id="A1.E17.m2.3.3.1.1.1.1.1.3.3.2.1" xref="A1.E17.m2.3.3.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E17.m2.2.2" xref="A1.E17.m2.2.2.cmml">x</mi><mo id="A1.E17.m2.3.3.1.1.1.1.1.3.3.2.2" xref="A1.E17.m2.3.3.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E17.m2.3.3.1.1.1.1.3" xref="A1.E17.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m2.3b"><apply id="A1.E17.m2.3.3.cmml" xref="A1.E17.m2.3.3"><eq id="A1.E17.m2.3.3.2.cmml" xref="A1.E17.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.E17.m2.3.3.3.cmml" xref="A1.E17.m2.3.3.3">absent</csymbol><apply id="A1.E17.m2.3.3.1.cmml" xref="A1.E17.m2.3.3.1"><apply id="A1.E17.m2.3.3.1.2.cmml" xref="A1.E17.m2.3.3.1.2"><csymbol cd="ambiguous" id="A1.E17.m2.3.3.1.2.1.cmml" xref="A1.E17.m2.3.3.1.2">subscript</csymbol><sum id="A1.E17.m2.3.3.1.2.2.cmml" xref="A1.E17.m2.3.3.1.2.2"></sum><ci id="A1.E17.m2.3.3.1.2.3.cmml" xref="A1.E17.m2.3.3.1.2.3">𝑖</ci></apply><apply id="A1.E17.m2.3.3.1.1.cmml" xref="A1.E17.m2.3.3.1.1"><times id="A1.E17.m2.3.3.1.1.2.cmml" xref="A1.E17.m2.3.3.1.1.2"></times><apply id="A1.E17.m2.3.3.1.1.3.cmml" xref="A1.E17.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m2.3.3.1.1.3.1.cmml" xref="A1.E17.m2.3.3.1.1.3">subscript</csymbol><ci id="A1.E17.m2.3.3.1.1.3.2.cmml" xref="A1.E17.m2.3.3.1.1.3.2">𝜆</ci><ci id="A1.E17.m2.3.3.1.1.3.3.cmml" xref="A1.E17.m2.3.3.1.1.3.3">𝑖</ci></apply><ci id="A1.E17.m2.3.3.1.1.4a.cmml" xref="A1.E17.m2.3.3.1.1.4"><mtext id="A1.E17.m2.3.3.1.1.4.cmml" xref="A1.E17.m2.3.3.1.1.4">KL</mtext></ci><apply id="A1.E17.m2.3.3.1.1.1.1.1.cmml" xref="A1.E17.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E17.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.2"><times id="A1.E17.m2.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.2.1"></times><ci id="A1.E17.m2.3.3.1.1.1.1.1.2.2.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.2.2">𝑃</ci><ci id="A1.E17.m2.1.1.cmml" xref="A1.E17.m2.1.1">𝑥</ci></apply><apply id="A1.E17.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3"><times id="A1.E17.m2.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3.1"></times><apply id="A1.E17.m2.3.3.1.1.1.1.1.3.2.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E17.m2.3.3.1.1.1.1.1.3.2.1.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E17.m2.3.3.1.1.1.1.1.3.2.2.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2.2">𝑃</ci><ci id="A1.E17.m2.3.3.1.1.1.1.1.3.2.3.cmml" xref="A1.E17.m2.3.3.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E17.m2.2.2.cmml" xref="A1.E17.m2.2.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m2.3c">\displaystyle=\sum_{i}\lambda_{i}\textrm{KL}\left(P\left(x\right)\parallel P_{i}\left(x\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
<tbody id="A1.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E18.m1.4" class="ltx_Math" alttext="\displaystyle=\sum_{i}\lambda_{i}\sum_{x}P\left(x\right)\textrm{log}\frac{P\left(x\right)}{P_{i}\left(x\right)}." display="inline"><semantics id="A1.E18.m1.4a"><mrow id="A1.E18.m1.4.4.1" xref="A1.E18.m1.4.4.1.1.cmml"><mrow id="A1.E18.m1.4.4.1.1" xref="A1.E18.m1.4.4.1.1.cmml"><mi id="A1.E18.m1.4.4.1.1.2" xref="A1.E18.m1.4.4.1.1.2.cmml"></mi><mo id="A1.E18.m1.4.4.1.1.1" xref="A1.E18.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E18.m1.4.4.1.1.3" xref="A1.E18.m1.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="A1.E18.m1.4.4.1.1.3.1" xref="A1.E18.m1.4.4.1.1.3.1.cmml"><munder id="A1.E18.m1.4.4.1.1.3.1a" xref="A1.E18.m1.4.4.1.1.3.1.cmml"><mo movablelimits="false" id="A1.E18.m1.4.4.1.1.3.1.2" xref="A1.E18.m1.4.4.1.1.3.1.2.cmml">∑</mo><mi id="A1.E18.m1.4.4.1.1.3.1.3" xref="A1.E18.m1.4.4.1.1.3.1.3.cmml">i</mi></munder></mstyle><mrow id="A1.E18.m1.4.4.1.1.3.2" xref="A1.E18.m1.4.4.1.1.3.2.cmml"><msub id="A1.E18.m1.4.4.1.1.3.2.2" xref="A1.E18.m1.4.4.1.1.3.2.2.cmml"><mi id="A1.E18.m1.4.4.1.1.3.2.2.2" xref="A1.E18.m1.4.4.1.1.3.2.2.2.cmml">λ</mi><mi id="A1.E18.m1.4.4.1.1.3.2.2.3" xref="A1.E18.m1.4.4.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E18.m1.4.4.1.1.3.2.1" xref="A1.E18.m1.4.4.1.1.3.2.1.cmml">​</mo><mrow id="A1.E18.m1.4.4.1.1.3.2.3" xref="A1.E18.m1.4.4.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="A1.E18.m1.4.4.1.1.3.2.3.1" xref="A1.E18.m1.4.4.1.1.3.2.3.1.cmml"><munder id="A1.E18.m1.4.4.1.1.3.2.3.1a" xref="A1.E18.m1.4.4.1.1.3.2.3.1.cmml"><mo movablelimits="false" id="A1.E18.m1.4.4.1.1.3.2.3.1.2" xref="A1.E18.m1.4.4.1.1.3.2.3.1.2.cmml">∑</mo><mi id="A1.E18.m1.4.4.1.1.3.2.3.1.3" xref="A1.E18.m1.4.4.1.1.3.2.3.1.3.cmml">x</mi></munder></mstyle><mrow id="A1.E18.m1.4.4.1.1.3.2.3.2" xref="A1.E18.m1.4.4.1.1.3.2.3.2.cmml"><mi id="A1.E18.m1.4.4.1.1.3.2.3.2.2" xref="A1.E18.m1.4.4.1.1.3.2.3.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.4.4.1.1.3.2.3.2.1" xref="A1.E18.m1.4.4.1.1.3.2.3.2.1.cmml">​</mo><mrow id="A1.E18.m1.4.4.1.1.3.2.3.2.3.2" xref="A1.E18.m1.4.4.1.1.3.2.3.2.cmml"><mo id="A1.E18.m1.4.4.1.1.3.2.3.2.3.2.1" xref="A1.E18.m1.4.4.1.1.3.2.3.2.cmml">(</mo><mi id="A1.E18.m1.3.3" xref="A1.E18.m1.3.3.cmml">x</mi><mo id="A1.E18.m1.4.4.1.1.3.2.3.2.3.2.2" xref="A1.E18.m1.4.4.1.1.3.2.3.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E18.m1.4.4.1.1.3.2.3.2.1a" xref="A1.E18.m1.4.4.1.1.3.2.3.2.1.cmml">​</mo><mtext id="A1.E18.m1.4.4.1.1.3.2.3.2.4" xref="A1.E18.m1.4.4.1.1.3.2.3.2.4a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E18.m1.4.4.1.1.3.2.3.2.1b" xref="A1.E18.m1.4.4.1.1.3.2.3.2.1.cmml">​</mo><mstyle displaystyle="true" id="A1.E18.m1.2.2" xref="A1.E18.m1.2.2.cmml"><mfrac id="A1.E18.m1.2.2a" xref="A1.E18.m1.2.2.cmml"><mrow id="A1.E18.m1.1.1.1" xref="A1.E18.m1.1.1.1.cmml"><mi id="A1.E18.m1.1.1.1.3" xref="A1.E18.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.2" xref="A1.E18.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E18.m1.1.1.1.4.2" xref="A1.E18.m1.1.1.1.cmml"><mo id="A1.E18.m1.1.1.1.4.2.1" xref="A1.E18.m1.1.1.1.cmml">(</mo><mi id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml">x</mi><mo id="A1.E18.m1.1.1.1.4.2.2" xref="A1.E18.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E18.m1.2.2.2" xref="A1.E18.m1.2.2.2.cmml"><msub id="A1.E18.m1.2.2.2.3" xref="A1.E18.m1.2.2.2.3.cmml"><mi id="A1.E18.m1.2.2.2.3.2" xref="A1.E18.m1.2.2.2.3.2.cmml">P</mi><mi id="A1.E18.m1.2.2.2.3.3" xref="A1.E18.m1.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E18.m1.2.2.2.2" xref="A1.E18.m1.2.2.2.2.cmml">​</mo><mrow id="A1.E18.m1.2.2.2.4.2" xref="A1.E18.m1.2.2.2.cmml"><mo id="A1.E18.m1.2.2.2.4.2.1" xref="A1.E18.m1.2.2.2.cmml">(</mo><mi id="A1.E18.m1.2.2.2.1" xref="A1.E18.m1.2.2.2.1.cmml">x</mi><mo id="A1.E18.m1.2.2.2.4.2.2" xref="A1.E18.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E18.m1.4.4.1.2" xref="A1.E18.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.4b"><apply id="A1.E18.m1.4.4.1.1.cmml" xref="A1.E18.m1.4.4.1"><eq id="A1.E18.m1.4.4.1.1.1.cmml" xref="A1.E18.m1.4.4.1.1.1"></eq><csymbol cd="latexml" id="A1.E18.m1.4.4.1.1.2.cmml" xref="A1.E18.m1.4.4.1.1.2">absent</csymbol><apply id="A1.E18.m1.4.4.1.1.3.cmml" xref="A1.E18.m1.4.4.1.1.3"><apply id="A1.E18.m1.4.4.1.1.3.1.cmml" xref="A1.E18.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="A1.E18.m1.4.4.1.1.3.1.1.cmml" xref="A1.E18.m1.4.4.1.1.3.1">subscript</csymbol><sum id="A1.E18.m1.4.4.1.1.3.1.2.cmml" xref="A1.E18.m1.4.4.1.1.3.1.2"></sum><ci id="A1.E18.m1.4.4.1.1.3.1.3.cmml" xref="A1.E18.m1.4.4.1.1.3.1.3">𝑖</ci></apply><apply id="A1.E18.m1.4.4.1.1.3.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2"><times id="A1.E18.m1.4.4.1.1.3.2.1.cmml" xref="A1.E18.m1.4.4.1.1.3.2.1"></times><apply id="A1.E18.m1.4.4.1.1.3.2.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E18.m1.4.4.1.1.3.2.2.1.cmml" xref="A1.E18.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="A1.E18.m1.4.4.1.1.3.2.2.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2.2.2">𝜆</ci><ci id="A1.E18.m1.4.4.1.1.3.2.2.3.cmml" xref="A1.E18.m1.4.4.1.1.3.2.2.3">𝑖</ci></apply><apply id="A1.E18.m1.4.4.1.1.3.2.3.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3"><apply id="A1.E18.m1.4.4.1.1.3.2.3.1.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.1"><csymbol cd="ambiguous" id="A1.E18.m1.4.4.1.1.3.2.3.1.1.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.1">subscript</csymbol><sum id="A1.E18.m1.4.4.1.1.3.2.3.1.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.1.2"></sum><ci id="A1.E18.m1.4.4.1.1.3.2.3.1.3.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.1.3">𝑥</ci></apply><apply id="A1.E18.m1.4.4.1.1.3.2.3.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.2"><times id="A1.E18.m1.4.4.1.1.3.2.3.2.1.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.2.1"></times><ci id="A1.E18.m1.4.4.1.1.3.2.3.2.2.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.2.2">𝑃</ci><ci id="A1.E18.m1.3.3.cmml" xref="A1.E18.m1.3.3">𝑥</ci><ci id="A1.E18.m1.4.4.1.1.3.2.3.2.4a.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.2.4"><mtext id="A1.E18.m1.4.4.1.1.3.2.3.2.4.cmml" xref="A1.E18.m1.4.4.1.1.3.2.3.2.4">log</mtext></ci><apply id="A1.E18.m1.2.2.cmml" xref="A1.E18.m1.2.2"><divide id="A1.E18.m1.2.2.3.cmml" xref="A1.E18.m1.2.2"></divide><apply id="A1.E18.m1.1.1.1.cmml" xref="A1.E18.m1.1.1.1"><times id="A1.E18.m1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.2"></times><ci id="A1.E18.m1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.3">𝑃</ci><ci id="A1.E18.m1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1">𝑥</ci></apply><apply id="A1.E18.m1.2.2.2.cmml" xref="A1.E18.m1.2.2.2"><times id="A1.E18.m1.2.2.2.2.cmml" xref="A1.E18.m1.2.2.2.2"></times><apply id="A1.E18.m1.2.2.2.3.cmml" xref="A1.E18.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.2.3.1.cmml" xref="A1.E18.m1.2.2.2.3">subscript</csymbol><ci id="A1.E18.m1.2.2.2.3.2.cmml" xref="A1.E18.m1.2.2.2.3.2">𝑃</ci><ci id="A1.E18.m1.2.2.2.3.3.cmml" xref="A1.E18.m1.2.2.2.3.3">𝑖</ci></apply><ci id="A1.E18.m1.2.2.2.1.cmml" xref="A1.E18.m1.2.2.2.1">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.4c">\displaystyle=\sum_{i}\lambda_{i}\sum_{x}P\left(x\right)\textrm{log}\frac{P\left(x\right)}{P_{i}\left(x\right)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p9.7" class="ltx_p">Here, we minimize a Lagrangian with the multiplier <math id="A1.SS2.p9.4.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="A1.SS2.p9.4.m1.1a"><mi id="A1.SS2.p9.4.m1.1.1" xref="A1.SS2.p9.4.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.4.m1.1b"><ci id="A1.SS2.p9.4.m1.1.1.cmml" xref="A1.SS2.p9.4.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.4.m1.1c">\eta</annotation></semantics></math> of <math id="A1.SS2.p9.5.m2.1" class="ltx_Math" alttext="D_{\lambda}" display="inline"><semantics id="A1.SS2.p9.5.m2.1a"><msub id="A1.SS2.p9.5.m2.1.1" xref="A1.SS2.p9.5.m2.1.1.cmml"><mi id="A1.SS2.p9.5.m2.1.1.2" xref="A1.SS2.p9.5.m2.1.1.2.cmml">D</mi><mi id="A1.SS2.p9.5.m2.1.1.3" xref="A1.SS2.p9.5.m2.1.1.3.cmml">λ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.5.m2.1b"><apply id="A1.SS2.p9.5.m2.1.1.cmml" xref="A1.SS2.p9.5.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p9.5.m2.1.1.1.cmml" xref="A1.SS2.p9.5.m2.1.1">subscript</csymbol><ci id="A1.SS2.p9.5.m2.1.1.2.cmml" xref="A1.SS2.p9.5.m2.1.1.2">𝐷</ci><ci id="A1.SS2.p9.5.m2.1.1.3.cmml" xref="A1.SS2.p9.5.m2.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.5.m2.1c">D_{\lambda}</annotation></semantics></math>
w.r.t. <math id="A1.SS2.p9.6.m3.1" class="ltx_Math" alttext="P\left(x\right)" display="inline"><semantics id="A1.SS2.p9.6.m3.1a"><mrow id="A1.SS2.p9.6.m3.1.2" xref="A1.SS2.p9.6.m3.1.2.cmml"><mi id="A1.SS2.p9.6.m3.1.2.2" xref="A1.SS2.p9.6.m3.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p9.6.m3.1.2.1" xref="A1.SS2.p9.6.m3.1.2.1.cmml">​</mo><mrow id="A1.SS2.p9.6.m3.1.2.3.2" xref="A1.SS2.p9.6.m3.1.2.cmml"><mo id="A1.SS2.p9.6.m3.1.2.3.2.1" xref="A1.SS2.p9.6.m3.1.2.cmml">(</mo><mi id="A1.SS2.p9.6.m3.1.1" xref="A1.SS2.p9.6.m3.1.1.cmml">x</mi><mo id="A1.SS2.p9.6.m3.1.2.3.2.2" xref="A1.SS2.p9.6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.6.m3.1b"><apply id="A1.SS2.p9.6.m3.1.2.cmml" xref="A1.SS2.p9.6.m3.1.2"><times id="A1.SS2.p9.6.m3.1.2.1.cmml" xref="A1.SS2.p9.6.m3.1.2.1"></times><ci id="A1.SS2.p9.6.m3.1.2.2.cmml" xref="A1.SS2.p9.6.m3.1.2.2">𝑃</ci><ci id="A1.SS2.p9.6.m3.1.1.cmml" xref="A1.SS2.p9.6.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.6.m3.1c">P\left(x\right)</annotation></semantics></math>, <math id="A1.SS2.p9.7.m4.2" class="ltx_Math" alttext="L=D+\eta\left(\sum_{x}P\left(x\right)-1\right):" display="inline"><semantics id="A1.SS2.p9.7.m4.2a"><mrow id="A1.SS2.p9.7.m4.2.2" xref="A1.SS2.p9.7.m4.2.2.cmml"><mrow id="A1.SS2.p9.7.m4.2.2.1" xref="A1.SS2.p9.7.m4.2.2.1.cmml"><mi id="A1.SS2.p9.7.m4.2.2.1.3" xref="A1.SS2.p9.7.m4.2.2.1.3.cmml">L</mi><mo id="A1.SS2.p9.7.m4.2.2.1.2" xref="A1.SS2.p9.7.m4.2.2.1.2.cmml">=</mo><mrow id="A1.SS2.p9.7.m4.2.2.1.1" xref="A1.SS2.p9.7.m4.2.2.1.1.cmml"><mi id="A1.SS2.p9.7.m4.2.2.1.1.3" xref="A1.SS2.p9.7.m4.2.2.1.1.3.cmml">D</mi><mo id="A1.SS2.p9.7.m4.2.2.1.1.2" xref="A1.SS2.p9.7.m4.2.2.1.1.2.cmml">+</mo><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.cmml"><mi id="A1.SS2.p9.7.m4.2.2.1.1.1.3" xref="A1.SS2.p9.7.m4.2.2.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p9.7.m4.2.2.1.1.1.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.cmml"><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.cmml"><msub id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.cmml"><mo lspace="0em" id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mi id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.3" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.3.cmml">x</mi></msub><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.1.cmml">​</mo><mrow id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.3.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.cmml"><mo id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.3.2.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="A1.SS2.p9.7.m4.1.1" xref="A1.SS2.p9.7.m4.1.1.cmml">x</mi><mo id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.3.2.2" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.1" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.3" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.278em" id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.3" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo rspace="0.278em" id="A1.SS2.p9.7.m4.2.2.2" xref="A1.SS2.p9.7.m4.2.2.2.cmml">:</mo><mi id="A1.SS2.p9.7.m4.2.2.3" xref="A1.SS2.p9.7.m4.2.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.7.m4.2b"><apply id="A1.SS2.p9.7.m4.2.2.cmml" xref="A1.SS2.p9.7.m4.2.2"><ci id="A1.SS2.p9.7.m4.2.2.2.cmml" xref="A1.SS2.p9.7.m4.2.2.2">:</ci><apply id="A1.SS2.p9.7.m4.2.2.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1"><eq id="A1.SS2.p9.7.m4.2.2.1.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.2"></eq><ci id="A1.SS2.p9.7.m4.2.2.1.3.cmml" xref="A1.SS2.p9.7.m4.2.2.1.3">𝐿</ci><apply id="A1.SS2.p9.7.m4.2.2.1.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1"><plus id="A1.SS2.p9.7.m4.2.2.1.1.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.2"></plus><ci id="A1.SS2.p9.7.m4.2.2.1.1.3.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.3">𝐷</ci><apply id="A1.SS2.p9.7.m4.2.2.1.1.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1"><times id="A1.SS2.p9.7.m4.2.2.1.1.1.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.2"></times><ci id="A1.SS2.p9.7.m4.2.2.1.1.1.3.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.3">𝜂</ci><apply id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1"><minus id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.1"></minus><apply id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2"><apply id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.2"></sum><ci id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.3.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.1.3">𝑥</ci></apply><apply id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2"><times id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.1"></times><ci id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.2.2.2">𝑃</ci><ci id="A1.SS2.p9.7.m4.1.1.cmml" xref="A1.SS2.p9.7.m4.1.1">𝑥</ci></apply></apply><cn type="integer" id="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p9.7.m4.2.2.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply><csymbol cd="latexml" id="A1.SS2.p9.7.m4.2.2.3.cmml" xref="A1.SS2.p9.7.m4.2.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.7.m4.2c">L=D+\eta\left(\sum_{x}P\left(x\right)-1\right):</annotation></semantics></math></p>
</div>
<div id="A1.SS2.p10" class="ltx_para ltx_noindent">
<table id="A2.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E19.m1.1" class="ltx_Math" alttext="\displaystyle\partial_{P}L" display="inline"><semantics id="A1.E19.m1.1a"><mrow id="A1.E19.m1.1.1" xref="A1.E19.m1.1.1.cmml"><msub id="A1.E19.m1.1.1.1" xref="A1.E19.m1.1.1.1.cmml"><mo id="A1.E19.m1.1.1.1.2" xref="A1.E19.m1.1.1.1.2.cmml">∂</mo><mi id="A1.E19.m1.1.1.1.3" xref="A1.E19.m1.1.1.1.3.cmml">P</mi></msub><mi id="A1.E19.m1.1.1.2" xref="A1.E19.m1.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.1b"><apply id="A1.E19.m1.1.1.cmml" xref="A1.E19.m1.1.1"><apply id="A1.E19.m1.1.1.1.cmml" xref="A1.E19.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1">subscript</csymbol><partialdiff id="A1.E19.m1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.2"></partialdiff><ci id="A1.E19.m1.1.1.1.3.cmml" xref="A1.E19.m1.1.1.1.3">𝑃</ci></apply><ci id="A1.E19.m1.1.1.2.cmml" xref="A1.E19.m1.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.1c">\displaystyle\partial_{P}L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E19.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i}\lambda_{i}\left(\text{log}\frac{P\left(x\right)}{P_{i}\left(x\right)}+1\right)+\eta" display="inline"><semantics id="A1.E19.m2.3a"><mrow id="A1.E19.m2.3.3" xref="A1.E19.m2.3.3.cmml"><mi id="A1.E19.m2.3.3.3" xref="A1.E19.m2.3.3.3.cmml"></mi><mo id="A1.E19.m2.3.3.2" xref="A1.E19.m2.3.3.2.cmml">=</mo><mrow id="A1.E19.m2.3.3.1" xref="A1.E19.m2.3.3.1.cmml"><mrow id="A1.E19.m2.3.3.1.1" xref="A1.E19.m2.3.3.1.1.cmml"><mstyle displaystyle="true" id="A1.E19.m2.3.3.1.1.2" xref="A1.E19.m2.3.3.1.1.2.cmml"><munder id="A1.E19.m2.3.3.1.1.2a" xref="A1.E19.m2.3.3.1.1.2.cmml"><mo movablelimits="false" id="A1.E19.m2.3.3.1.1.2.2" xref="A1.E19.m2.3.3.1.1.2.2.cmml">∑</mo><mi id="A1.E19.m2.3.3.1.1.2.3" xref="A1.E19.m2.3.3.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="A1.E19.m2.3.3.1.1.1" xref="A1.E19.m2.3.3.1.1.1.cmml"><msub id="A1.E19.m2.3.3.1.1.1.3" xref="A1.E19.m2.3.3.1.1.1.3.cmml"><mi id="A1.E19.m2.3.3.1.1.1.3.2" xref="A1.E19.m2.3.3.1.1.1.3.2.cmml">λ</mi><mi id="A1.E19.m2.3.3.1.1.1.3.3" xref="A1.E19.m2.3.3.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E19.m2.3.3.1.1.1.2" xref="A1.E19.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="A1.E19.m2.3.3.1.1.1.1.1" xref="A1.E19.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E19.m2.3.3.1.1.1.1.1.2" xref="A1.E19.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E19.m2.3.3.1.1.1.1.1.1" xref="A1.E19.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="A1.E19.m2.3.3.1.1.1.1.1.1.2" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.cmml"><mtext id="A1.E19.m2.3.3.1.1.1.1.1.1.2.2" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.2a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E19.m2.3.3.1.1.1.1.1.1.2.1" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.1.cmml">​</mo><mstyle displaystyle="true" id="A1.E19.m2.2.2" xref="A1.E19.m2.2.2.cmml"><mfrac id="A1.E19.m2.2.2a" xref="A1.E19.m2.2.2.cmml"><mrow id="A1.E19.m2.1.1.1" xref="A1.E19.m2.1.1.1.cmml"><mi id="A1.E19.m2.1.1.1.3" xref="A1.E19.m2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E19.m2.1.1.1.2" xref="A1.E19.m2.1.1.1.2.cmml">​</mo><mrow id="A1.E19.m2.1.1.1.4.2" xref="A1.E19.m2.1.1.1.cmml"><mo id="A1.E19.m2.1.1.1.4.2.1" xref="A1.E19.m2.1.1.1.cmml">(</mo><mi id="A1.E19.m2.1.1.1.1" xref="A1.E19.m2.1.1.1.1.cmml">x</mi><mo id="A1.E19.m2.1.1.1.4.2.2" xref="A1.E19.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E19.m2.2.2.2" xref="A1.E19.m2.2.2.2.cmml"><msub id="A1.E19.m2.2.2.2.3" xref="A1.E19.m2.2.2.2.3.cmml"><mi id="A1.E19.m2.2.2.2.3.2" xref="A1.E19.m2.2.2.2.3.2.cmml">P</mi><mi id="A1.E19.m2.2.2.2.3.3" xref="A1.E19.m2.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E19.m2.2.2.2.2" xref="A1.E19.m2.2.2.2.2.cmml">​</mo><mrow id="A1.E19.m2.2.2.2.4.2" xref="A1.E19.m2.2.2.2.cmml"><mo id="A1.E19.m2.2.2.2.4.2.1" xref="A1.E19.m2.2.2.2.cmml">(</mo><mi id="A1.E19.m2.2.2.2.1" xref="A1.E19.m2.2.2.2.1.cmml">x</mi><mo id="A1.E19.m2.2.2.2.4.2.2" xref="A1.E19.m2.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E19.m2.3.3.1.1.1.1.1.1.1" xref="A1.E19.m2.3.3.1.1.1.1.1.1.1.cmml">+</mo><mn id="A1.E19.m2.3.3.1.1.1.1.1.1.3" xref="A1.E19.m2.3.3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E19.m2.3.3.1.1.1.1.1.3" xref="A1.E19.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E19.m2.3.3.1.2" xref="A1.E19.m2.3.3.1.2.cmml">+</mo><mi id="A1.E19.m2.3.3.1.3" xref="A1.E19.m2.3.3.1.3.cmml">η</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m2.3b"><apply id="A1.E19.m2.3.3.cmml" xref="A1.E19.m2.3.3"><eq id="A1.E19.m2.3.3.2.cmml" xref="A1.E19.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.E19.m2.3.3.3.cmml" xref="A1.E19.m2.3.3.3">absent</csymbol><apply id="A1.E19.m2.3.3.1.cmml" xref="A1.E19.m2.3.3.1"><plus id="A1.E19.m2.3.3.1.2.cmml" xref="A1.E19.m2.3.3.1.2"></plus><apply id="A1.E19.m2.3.3.1.1.cmml" xref="A1.E19.m2.3.3.1.1"><apply id="A1.E19.m2.3.3.1.1.2.cmml" xref="A1.E19.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m2.3.3.1.1.2.1.cmml" xref="A1.E19.m2.3.3.1.1.2">subscript</csymbol><sum id="A1.E19.m2.3.3.1.1.2.2.cmml" xref="A1.E19.m2.3.3.1.1.2.2"></sum><ci id="A1.E19.m2.3.3.1.1.2.3.cmml" xref="A1.E19.m2.3.3.1.1.2.3">𝑖</ci></apply><apply id="A1.E19.m2.3.3.1.1.1.cmml" xref="A1.E19.m2.3.3.1.1.1"><times id="A1.E19.m2.3.3.1.1.1.2.cmml" xref="A1.E19.m2.3.3.1.1.1.2"></times><apply id="A1.E19.m2.3.3.1.1.1.3.cmml" xref="A1.E19.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E19.m2.3.3.1.1.1.3.1.cmml" xref="A1.E19.m2.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E19.m2.3.3.1.1.1.3.2.cmml" xref="A1.E19.m2.3.3.1.1.1.3.2">𝜆</ci><ci id="A1.E19.m2.3.3.1.1.1.3.3.cmml" xref="A1.E19.m2.3.3.1.1.1.3.3">𝑖</ci></apply><apply id="A1.E19.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1"><plus id="A1.E19.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.1"></plus><apply id="A1.E19.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2"><times id="A1.E19.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.1"></times><ci id="A1.E19.m2.3.3.1.1.1.1.1.1.2.2a.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.2"><mtext id="A1.E19.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.2.2">log</mtext></ci><apply id="A1.E19.m2.2.2.cmml" xref="A1.E19.m2.2.2"><divide id="A1.E19.m2.2.2.3.cmml" xref="A1.E19.m2.2.2"></divide><apply id="A1.E19.m2.1.1.1.cmml" xref="A1.E19.m2.1.1.1"><times id="A1.E19.m2.1.1.1.2.cmml" xref="A1.E19.m2.1.1.1.2"></times><ci id="A1.E19.m2.1.1.1.3.cmml" xref="A1.E19.m2.1.1.1.3">𝑃</ci><ci id="A1.E19.m2.1.1.1.1.cmml" xref="A1.E19.m2.1.1.1.1">𝑥</ci></apply><apply id="A1.E19.m2.2.2.2.cmml" xref="A1.E19.m2.2.2.2"><times id="A1.E19.m2.2.2.2.2.cmml" xref="A1.E19.m2.2.2.2.2"></times><apply id="A1.E19.m2.2.2.2.3.cmml" xref="A1.E19.m2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E19.m2.2.2.2.3.1.cmml" xref="A1.E19.m2.2.2.2.3">subscript</csymbol><ci id="A1.E19.m2.2.2.2.3.2.cmml" xref="A1.E19.m2.2.2.2.3.2">𝑃</ci><ci id="A1.E19.m2.2.2.2.3.3.cmml" xref="A1.E19.m2.2.2.2.3.3">𝑖</ci></apply><ci id="A1.E19.m2.2.2.2.1.cmml" xref="A1.E19.m2.2.2.2.1">𝑥</ci></apply></apply></apply><cn type="integer" id="A1.E19.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E19.m2.3.3.1.1.1.1.1.1.3">1</cn></apply></apply></apply><ci id="A1.E19.m2.3.3.1.3.cmml" xref="A1.E19.m2.3.3.1.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m2.3c">\displaystyle=\sum_{i}\lambda_{i}\left(\text{log}\frac{P\left(x\right)}{P_{i}\left(x\right)}+1\right)+\eta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="A1.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E20.m1.2" class="ltx_Math" alttext="\displaystyle=\text{log}P\left(x\right)-\sum_{i}\lambda_{i}\text{log}P_{i}\left(x\right)+1+\eta" display="inline"><semantics id="A1.E20.m1.2a"><mrow id="A1.E20.m1.2.3" xref="A1.E20.m1.2.3.cmml"><mi id="A1.E20.m1.2.3.2" xref="A1.E20.m1.2.3.2.cmml"></mi><mo id="A1.E20.m1.2.3.1" xref="A1.E20.m1.2.3.1.cmml">=</mo><mrow id="A1.E20.m1.2.3.3" xref="A1.E20.m1.2.3.3.cmml"><mrow id="A1.E20.m1.2.3.3.2" xref="A1.E20.m1.2.3.3.2.cmml"><mrow id="A1.E20.m1.2.3.3.2.2" xref="A1.E20.m1.2.3.3.2.2.cmml"><mtext id="A1.E20.m1.2.3.3.2.2.2" xref="A1.E20.m1.2.3.3.2.2.2a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E20.m1.2.3.3.2.2.1" xref="A1.E20.m1.2.3.3.2.2.1.cmml">​</mo><mi id="A1.E20.m1.2.3.3.2.2.3" xref="A1.E20.m1.2.3.3.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E20.m1.2.3.3.2.2.1a" xref="A1.E20.m1.2.3.3.2.2.1.cmml">​</mo><mrow id="A1.E20.m1.2.3.3.2.2.4.2" xref="A1.E20.m1.2.3.3.2.2.cmml"><mo id="A1.E20.m1.2.3.3.2.2.4.2.1" xref="A1.E20.m1.2.3.3.2.2.cmml">(</mo><mi id="A1.E20.m1.1.1" xref="A1.E20.m1.1.1.cmml">x</mi><mo id="A1.E20.m1.2.3.3.2.2.4.2.2" xref="A1.E20.m1.2.3.3.2.2.cmml">)</mo></mrow></mrow><mo id="A1.E20.m1.2.3.3.2.1" xref="A1.E20.m1.2.3.3.2.1.cmml">−</mo><mrow id="A1.E20.m1.2.3.3.2.3" xref="A1.E20.m1.2.3.3.2.3.cmml"><mstyle displaystyle="true" id="A1.E20.m1.2.3.3.2.3.1" xref="A1.E20.m1.2.3.3.2.3.1.cmml"><munder id="A1.E20.m1.2.3.3.2.3.1a" xref="A1.E20.m1.2.3.3.2.3.1.cmml"><mo movablelimits="false" id="A1.E20.m1.2.3.3.2.3.1.2" xref="A1.E20.m1.2.3.3.2.3.1.2.cmml">∑</mo><mi id="A1.E20.m1.2.3.3.2.3.1.3" xref="A1.E20.m1.2.3.3.2.3.1.3.cmml">i</mi></munder></mstyle><mrow id="A1.E20.m1.2.3.3.2.3.2" xref="A1.E20.m1.2.3.3.2.3.2.cmml"><msub id="A1.E20.m1.2.3.3.2.3.2.2" xref="A1.E20.m1.2.3.3.2.3.2.2.cmml"><mi id="A1.E20.m1.2.3.3.2.3.2.2.2" xref="A1.E20.m1.2.3.3.2.3.2.2.2.cmml">λ</mi><mi id="A1.E20.m1.2.3.3.2.3.2.2.3" xref="A1.E20.m1.2.3.3.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E20.m1.2.3.3.2.3.2.1" xref="A1.E20.m1.2.3.3.2.3.2.1.cmml">​</mo><mtext id="A1.E20.m1.2.3.3.2.3.2.3" xref="A1.E20.m1.2.3.3.2.3.2.3a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E20.m1.2.3.3.2.3.2.1a" xref="A1.E20.m1.2.3.3.2.3.2.1.cmml">​</mo><msub id="A1.E20.m1.2.3.3.2.3.2.4" xref="A1.E20.m1.2.3.3.2.3.2.4.cmml"><mi id="A1.E20.m1.2.3.3.2.3.2.4.2" xref="A1.E20.m1.2.3.3.2.3.2.4.2.cmml">P</mi><mi id="A1.E20.m1.2.3.3.2.3.2.4.3" xref="A1.E20.m1.2.3.3.2.3.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E20.m1.2.3.3.2.3.2.1b" xref="A1.E20.m1.2.3.3.2.3.2.1.cmml">​</mo><mrow id="A1.E20.m1.2.3.3.2.3.2.5.2" xref="A1.E20.m1.2.3.3.2.3.2.cmml"><mo id="A1.E20.m1.2.3.3.2.3.2.5.2.1" xref="A1.E20.m1.2.3.3.2.3.2.cmml">(</mo><mi id="A1.E20.m1.2.2" xref="A1.E20.m1.2.2.cmml">x</mi><mo id="A1.E20.m1.2.3.3.2.3.2.5.2.2" xref="A1.E20.m1.2.3.3.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E20.m1.2.3.3.1" xref="A1.E20.m1.2.3.3.1.cmml">+</mo><mn id="A1.E20.m1.2.3.3.3" xref="A1.E20.m1.2.3.3.3.cmml">1</mn><mo id="A1.E20.m1.2.3.3.1a" xref="A1.E20.m1.2.3.3.1.cmml">+</mo><mi id="A1.E20.m1.2.3.3.4" xref="A1.E20.m1.2.3.3.4.cmml">η</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m1.2b"><apply id="A1.E20.m1.2.3.cmml" xref="A1.E20.m1.2.3"><eq id="A1.E20.m1.2.3.1.cmml" xref="A1.E20.m1.2.3.1"></eq><csymbol cd="latexml" id="A1.E20.m1.2.3.2.cmml" xref="A1.E20.m1.2.3.2">absent</csymbol><apply id="A1.E20.m1.2.3.3.cmml" xref="A1.E20.m1.2.3.3"><plus id="A1.E20.m1.2.3.3.1.cmml" xref="A1.E20.m1.2.3.3.1"></plus><apply id="A1.E20.m1.2.3.3.2.cmml" xref="A1.E20.m1.2.3.3.2"><minus id="A1.E20.m1.2.3.3.2.1.cmml" xref="A1.E20.m1.2.3.3.2.1"></minus><apply id="A1.E20.m1.2.3.3.2.2.cmml" xref="A1.E20.m1.2.3.3.2.2"><times id="A1.E20.m1.2.3.3.2.2.1.cmml" xref="A1.E20.m1.2.3.3.2.2.1"></times><ci id="A1.E20.m1.2.3.3.2.2.2a.cmml" xref="A1.E20.m1.2.3.3.2.2.2"><mtext id="A1.E20.m1.2.3.3.2.2.2.cmml" xref="A1.E20.m1.2.3.3.2.2.2">log</mtext></ci><ci id="A1.E20.m1.2.3.3.2.2.3.cmml" xref="A1.E20.m1.2.3.3.2.2.3">𝑃</ci><ci id="A1.E20.m1.1.1.cmml" xref="A1.E20.m1.1.1">𝑥</ci></apply><apply id="A1.E20.m1.2.3.3.2.3.cmml" xref="A1.E20.m1.2.3.3.2.3"><apply id="A1.E20.m1.2.3.3.2.3.1.cmml" xref="A1.E20.m1.2.3.3.2.3.1"><csymbol cd="ambiguous" id="A1.E20.m1.2.3.3.2.3.1.1.cmml" xref="A1.E20.m1.2.3.3.2.3.1">subscript</csymbol><sum id="A1.E20.m1.2.3.3.2.3.1.2.cmml" xref="A1.E20.m1.2.3.3.2.3.1.2"></sum><ci id="A1.E20.m1.2.3.3.2.3.1.3.cmml" xref="A1.E20.m1.2.3.3.2.3.1.3">𝑖</ci></apply><apply id="A1.E20.m1.2.3.3.2.3.2.cmml" xref="A1.E20.m1.2.3.3.2.3.2"><times id="A1.E20.m1.2.3.3.2.3.2.1.cmml" xref="A1.E20.m1.2.3.3.2.3.2.1"></times><apply id="A1.E20.m1.2.3.3.2.3.2.2.cmml" xref="A1.E20.m1.2.3.3.2.3.2.2"><csymbol cd="ambiguous" id="A1.E20.m1.2.3.3.2.3.2.2.1.cmml" xref="A1.E20.m1.2.3.3.2.3.2.2">subscript</csymbol><ci id="A1.E20.m1.2.3.3.2.3.2.2.2.cmml" xref="A1.E20.m1.2.3.3.2.3.2.2.2">𝜆</ci><ci id="A1.E20.m1.2.3.3.2.3.2.2.3.cmml" xref="A1.E20.m1.2.3.3.2.3.2.2.3">𝑖</ci></apply><ci id="A1.E20.m1.2.3.3.2.3.2.3a.cmml" xref="A1.E20.m1.2.3.3.2.3.2.3"><mtext id="A1.E20.m1.2.3.3.2.3.2.3.cmml" xref="A1.E20.m1.2.3.3.2.3.2.3">log</mtext></ci><apply id="A1.E20.m1.2.3.3.2.3.2.4.cmml" xref="A1.E20.m1.2.3.3.2.3.2.4"><csymbol cd="ambiguous" id="A1.E20.m1.2.3.3.2.3.2.4.1.cmml" xref="A1.E20.m1.2.3.3.2.3.2.4">subscript</csymbol><ci id="A1.E20.m1.2.3.3.2.3.2.4.2.cmml" xref="A1.E20.m1.2.3.3.2.3.2.4.2">𝑃</ci><ci id="A1.E20.m1.2.3.3.2.3.2.4.3.cmml" xref="A1.E20.m1.2.3.3.2.3.2.4.3">𝑖</ci></apply><ci id="A1.E20.m1.2.2.cmml" xref="A1.E20.m1.2.2">𝑥</ci></apply></apply></apply><cn type="integer" id="A1.E20.m1.2.3.3.3.cmml" xref="A1.E20.m1.2.3.3.3">1</cn><ci id="A1.E20.m1.2.3.3.4.cmml" xref="A1.E20.m1.2.3.3.4">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.2c">\displaystyle=\text{log}P\left(x\right)-\sum_{i}\lambda_{i}\text{log}P_{i}\left(x\right)+1+\eta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="A1.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E21.m1.3" class="ltx_Math" alttext="\displaystyle=\text{log}P\left(x\right)-\text{log}\prod_{i}P_{i}\left(x\right)^{\lambda_{i}}+1+\eta." display="inline"><semantics id="A1.E21.m1.3a"><mrow id="A1.E21.m1.3.3.1" xref="A1.E21.m1.3.3.1.1.cmml"><mrow id="A1.E21.m1.3.3.1.1" xref="A1.E21.m1.3.3.1.1.cmml"><mi id="A1.E21.m1.3.3.1.1.2" xref="A1.E21.m1.3.3.1.1.2.cmml"></mi><mo id="A1.E21.m1.3.3.1.1.1" xref="A1.E21.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E21.m1.3.3.1.1.3" xref="A1.E21.m1.3.3.1.1.3.cmml"><mrow id="A1.E21.m1.3.3.1.1.3.2" xref="A1.E21.m1.3.3.1.1.3.2.cmml"><mrow id="A1.E21.m1.3.3.1.1.3.2.2" xref="A1.E21.m1.3.3.1.1.3.2.2.cmml"><mtext id="A1.E21.m1.3.3.1.1.3.2.2.2" xref="A1.E21.m1.3.3.1.1.3.2.2.2a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E21.m1.3.3.1.1.3.2.2.1" xref="A1.E21.m1.3.3.1.1.3.2.2.1.cmml">​</mo><mi id="A1.E21.m1.3.3.1.1.3.2.2.3" xref="A1.E21.m1.3.3.1.1.3.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.E21.m1.3.3.1.1.3.2.2.1a" xref="A1.E21.m1.3.3.1.1.3.2.2.1.cmml">​</mo><mrow id="A1.E21.m1.3.3.1.1.3.2.2.4.2" xref="A1.E21.m1.3.3.1.1.3.2.2.cmml"><mo id="A1.E21.m1.3.3.1.1.3.2.2.4.2.1" xref="A1.E21.m1.3.3.1.1.3.2.2.cmml">(</mo><mi id="A1.E21.m1.1.1" xref="A1.E21.m1.1.1.cmml">x</mi><mo id="A1.E21.m1.3.3.1.1.3.2.2.4.2.2" xref="A1.E21.m1.3.3.1.1.3.2.2.cmml">)</mo></mrow></mrow><mo id="A1.E21.m1.3.3.1.1.3.2.1" xref="A1.E21.m1.3.3.1.1.3.2.1.cmml">−</mo><mrow id="A1.E21.m1.3.3.1.1.3.2.3" xref="A1.E21.m1.3.3.1.1.3.2.3.cmml"><mtext id="A1.E21.m1.3.3.1.1.3.2.3.2" xref="A1.E21.m1.3.3.1.1.3.2.3.2a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="A1.E21.m1.3.3.1.1.3.2.3.1" xref="A1.E21.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mrow id="A1.E21.m1.3.3.1.1.3.2.3.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.cmml"><mstyle displaystyle="true" id="A1.E21.m1.3.3.1.1.3.2.3.3.1" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.cmml"><munder id="A1.E21.m1.3.3.1.1.3.2.3.3.1a" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.cmml"><mo movablelimits="false" id="A1.E21.m1.3.3.1.1.3.2.3.3.1.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.2.cmml">∏</mo><mi id="A1.E21.m1.3.3.1.1.3.2.3.3.1.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.3.cmml">i</mi></munder></mstyle><mrow id="A1.E21.m1.3.3.1.1.3.2.3.3.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.cmml"><msub id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.cmml"><mi id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.2.cmml">P</mi><mi id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E21.m1.3.3.1.1.3.2.3.3.2.1" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.1.cmml">​</mo><msup id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.cmml"><mrow id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.2.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.cmml"><mo id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.2.2.1" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.cmml">(</mo><mi id="A1.E21.m1.2.2" xref="A1.E21.m1.2.2.cmml">x</mi><mo id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.2.2.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.cmml">)</mo></mrow><msub id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.cmml"><mi id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.2" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.2.cmml">λ</mi><mi id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.3" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.3.cmml">i</mi></msub></msup></mrow></mrow></mrow></mrow><mo id="A1.E21.m1.3.3.1.1.3.1" xref="A1.E21.m1.3.3.1.1.3.1.cmml">+</mo><mn id="A1.E21.m1.3.3.1.1.3.3" xref="A1.E21.m1.3.3.1.1.3.3.cmml">1</mn><mo id="A1.E21.m1.3.3.1.1.3.1a" xref="A1.E21.m1.3.3.1.1.3.1.cmml">+</mo><mi id="A1.E21.m1.3.3.1.1.3.4" xref="A1.E21.m1.3.3.1.1.3.4.cmml">η</mi></mrow></mrow><mo lspace="0em" id="A1.E21.m1.3.3.1.2" xref="A1.E21.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E21.m1.3b"><apply id="A1.E21.m1.3.3.1.1.cmml" xref="A1.E21.m1.3.3.1"><eq id="A1.E21.m1.3.3.1.1.1.cmml" xref="A1.E21.m1.3.3.1.1.1"></eq><csymbol cd="latexml" id="A1.E21.m1.3.3.1.1.2.cmml" xref="A1.E21.m1.3.3.1.1.2">absent</csymbol><apply id="A1.E21.m1.3.3.1.1.3.cmml" xref="A1.E21.m1.3.3.1.1.3"><plus id="A1.E21.m1.3.3.1.1.3.1.cmml" xref="A1.E21.m1.3.3.1.1.3.1"></plus><apply id="A1.E21.m1.3.3.1.1.3.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2"><minus id="A1.E21.m1.3.3.1.1.3.2.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.1"></minus><apply id="A1.E21.m1.3.3.1.1.3.2.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.2"><times id="A1.E21.m1.3.3.1.1.3.2.2.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.2.1"></times><ci id="A1.E21.m1.3.3.1.1.3.2.2.2a.cmml" xref="A1.E21.m1.3.3.1.1.3.2.2.2"><mtext id="A1.E21.m1.3.3.1.1.3.2.2.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.2.2">log</mtext></ci><ci id="A1.E21.m1.3.3.1.1.3.2.2.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.2.3">𝑃</ci><ci id="A1.E21.m1.1.1.cmml" xref="A1.E21.m1.1.1">𝑥</ci></apply><apply id="A1.E21.m1.3.3.1.1.3.2.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3"><times id="A1.E21.m1.3.3.1.1.3.2.3.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.1"></times><ci id="A1.E21.m1.3.3.1.1.3.2.3.2a.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.2"><mtext id="A1.E21.m1.3.3.1.1.3.2.3.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.2">log</mtext></ci><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3"><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1"><csymbol cd="ambiguous" id="A1.E21.m1.3.3.1.1.3.2.3.3.1.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.E21.m1.3.3.1.1.3.2.3.3.1.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.2">product</csymbol><ci id="A1.E21.m1.3.3.1.1.3.2.3.3.1.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.1.3">𝑖</ci></apply><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2"><times id="A1.E21.m1.3.3.1.1.3.2.3.3.2.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.1"></times><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2"><csymbol cd="ambiguous" id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2">subscript</csymbol><ci id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.2">𝑃</ci><ci id="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.2.3">𝑖</ci></apply><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3">superscript</csymbol><ci id="A1.E21.m1.2.2.cmml" xref="A1.E21.m1.2.2">𝑥</ci><apply id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3"><csymbol cd="ambiguous" id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.1.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3">subscript</csymbol><ci id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.2.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.2">𝜆</ci><ci id="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.3.cmml" xref="A1.E21.m1.3.3.1.1.3.2.3.3.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><cn type="integer" id="A1.E21.m1.3.3.1.1.3.3.cmml" xref="A1.E21.m1.3.3.1.1.3.3">1</cn><ci id="A1.E21.m1.3.3.1.1.3.4.cmml" xref="A1.E21.m1.3.3.1.1.3.4">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m1.3c">\displaystyle=\text{log}P\left(x\right)-\text{log}\prod_{i}P_{i}\left(x\right)^{\lambda_{i}}+1+\eta.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p10.3" class="ltx_p">Setting this gradient to zero leads to:</p>
<table id="A1.E22" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E22.m1.3" class="ltx_Math" alttext="P^{\prime}\left(x\right)=C\prod_{i}P_{i}\left(x\right)^{\lambda_{i}}," display="block"><semantics id="A1.E22.m1.3a"><mrow id="A1.E22.m1.3.3.1" xref="A1.E22.m1.3.3.1.1.cmml"><mrow id="A1.E22.m1.3.3.1.1" xref="A1.E22.m1.3.3.1.1.cmml"><mrow id="A1.E22.m1.3.3.1.1.2" xref="A1.E22.m1.3.3.1.1.2.cmml"><msup id="A1.E22.m1.3.3.1.1.2.2" xref="A1.E22.m1.3.3.1.1.2.2.cmml"><mi id="A1.E22.m1.3.3.1.1.2.2.2" xref="A1.E22.m1.3.3.1.1.2.2.2.cmml">P</mi><mo id="A1.E22.m1.3.3.1.1.2.2.3" xref="A1.E22.m1.3.3.1.1.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.E22.m1.3.3.1.1.2.1" xref="A1.E22.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="A1.E22.m1.3.3.1.1.2.3.2" xref="A1.E22.m1.3.3.1.1.2.cmml"><mo id="A1.E22.m1.3.3.1.1.2.3.2.1" xref="A1.E22.m1.3.3.1.1.2.cmml">(</mo><mi id="A1.E22.m1.1.1" xref="A1.E22.m1.1.1.cmml">x</mi><mo id="A1.E22.m1.3.3.1.1.2.3.2.2" xref="A1.E22.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E22.m1.3.3.1.1.1" xref="A1.E22.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E22.m1.3.3.1.1.3" xref="A1.E22.m1.3.3.1.1.3.cmml"><mi id="A1.E22.m1.3.3.1.1.3.2" xref="A1.E22.m1.3.3.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A1.E22.m1.3.3.1.1.3.1" xref="A1.E22.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="A1.E22.m1.3.3.1.1.3.3" xref="A1.E22.m1.3.3.1.1.3.3.cmml"><munder id="A1.E22.m1.3.3.1.1.3.3.1" xref="A1.E22.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="A1.E22.m1.3.3.1.1.3.3.1.2" xref="A1.E22.m1.3.3.1.1.3.3.1.2.cmml">∏</mo><mi id="A1.E22.m1.3.3.1.1.3.3.1.3" xref="A1.E22.m1.3.3.1.1.3.3.1.3.cmml">i</mi></munder><mrow id="A1.E22.m1.3.3.1.1.3.3.2" xref="A1.E22.m1.3.3.1.1.3.3.2.cmml"><msub id="A1.E22.m1.3.3.1.1.3.3.2.2" xref="A1.E22.m1.3.3.1.1.3.3.2.2.cmml"><mi id="A1.E22.m1.3.3.1.1.3.3.2.2.2" xref="A1.E22.m1.3.3.1.1.3.3.2.2.2.cmml">P</mi><mi id="A1.E22.m1.3.3.1.1.3.3.2.2.3" xref="A1.E22.m1.3.3.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E22.m1.3.3.1.1.3.3.2.1" xref="A1.E22.m1.3.3.1.1.3.3.2.1.cmml">​</mo><msup id="A1.E22.m1.3.3.1.1.3.3.2.3" xref="A1.E22.m1.3.3.1.1.3.3.2.3.cmml"><mrow id="A1.E22.m1.3.3.1.1.3.3.2.3.2.2" xref="A1.E22.m1.3.3.1.1.3.3.2.3.cmml"><mo id="A1.E22.m1.3.3.1.1.3.3.2.3.2.2.1" xref="A1.E22.m1.3.3.1.1.3.3.2.3.cmml">(</mo><mi id="A1.E22.m1.2.2" xref="A1.E22.m1.2.2.cmml">x</mi><mo id="A1.E22.m1.3.3.1.1.3.3.2.3.2.2.2" xref="A1.E22.m1.3.3.1.1.3.3.2.3.cmml">)</mo></mrow><msub id="A1.E22.m1.3.3.1.1.3.3.2.3.3" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3.cmml"><mi id="A1.E22.m1.3.3.1.1.3.3.2.3.3.2" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3.2.cmml">λ</mi><mi id="A1.E22.m1.3.3.1.1.3.3.2.3.3.3" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3.3.cmml">i</mi></msub></msup></mrow></mrow></mrow></mrow><mo id="A1.E22.m1.3.3.1.2" xref="A1.E22.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m1.3b"><apply id="A1.E22.m1.3.3.1.1.cmml" xref="A1.E22.m1.3.3.1"><eq id="A1.E22.m1.3.3.1.1.1.cmml" xref="A1.E22.m1.3.3.1.1.1"></eq><apply id="A1.E22.m1.3.3.1.1.2.cmml" xref="A1.E22.m1.3.3.1.1.2"><times id="A1.E22.m1.3.3.1.1.2.1.cmml" xref="A1.E22.m1.3.3.1.1.2.1"></times><apply id="A1.E22.m1.3.3.1.1.2.2.cmml" xref="A1.E22.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.2.2.1.cmml" xref="A1.E22.m1.3.3.1.1.2.2">superscript</csymbol><ci id="A1.E22.m1.3.3.1.1.2.2.2.cmml" xref="A1.E22.m1.3.3.1.1.2.2.2">𝑃</ci><ci id="A1.E22.m1.3.3.1.1.2.2.3.cmml" xref="A1.E22.m1.3.3.1.1.2.2.3">′</ci></apply><ci id="A1.E22.m1.1.1.cmml" xref="A1.E22.m1.1.1">𝑥</ci></apply><apply id="A1.E22.m1.3.3.1.1.3.cmml" xref="A1.E22.m1.3.3.1.1.3"><times id="A1.E22.m1.3.3.1.1.3.1.cmml" xref="A1.E22.m1.3.3.1.1.3.1"></times><ci id="A1.E22.m1.3.3.1.1.3.2.cmml" xref="A1.E22.m1.3.3.1.1.3.2">𝐶</ci><apply id="A1.E22.m1.3.3.1.1.3.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3"><apply id="A1.E22.m1.3.3.1.1.3.3.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.3.3.1.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.E22.m1.3.3.1.1.3.3.1.2.cmml" xref="A1.E22.m1.3.3.1.1.3.3.1.2">product</csymbol><ci id="A1.E22.m1.3.3.1.1.3.3.1.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3.1.3">𝑖</ci></apply><apply id="A1.E22.m1.3.3.1.1.3.3.2.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2"><times id="A1.E22.m1.3.3.1.1.3.3.2.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.1"></times><apply id="A1.E22.m1.3.3.1.1.3.3.2.2.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.3.3.2.2.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.2">subscript</csymbol><ci id="A1.E22.m1.3.3.1.1.3.3.2.2.2.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.2.2">𝑃</ci><ci id="A1.E22.m1.3.3.1.1.3.3.2.2.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="A1.E22.m1.3.3.1.1.3.3.2.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.3.3.2.3.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3">superscript</csymbol><ci id="A1.E22.m1.2.2.cmml" xref="A1.E22.m1.2.2">𝑥</ci><apply id="A1.E22.m1.3.3.1.1.3.3.2.3.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.3.3.2.3.3.1.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3">subscript</csymbol><ci id="A1.E22.m1.3.3.1.1.3.3.2.3.3.2.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3.2">𝜆</ci><ci id="A1.E22.m1.3.3.1.1.3.3.2.3.3.3.cmml" xref="A1.E22.m1.3.3.1.1.3.3.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m1.3c">P^{\prime}\left(x\right)=C\prod_{i}P_{i}\left(x\right)^{\lambda_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p10.2" class="ltx_p">where <math id="A1.SS2.p10.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.SS2.p10.1.m1.1a"><mi id="A1.SS2.p10.1.m1.1.1" xref="A1.SS2.p10.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p10.1.m1.1b"><ci id="A1.SS2.p10.1.m1.1.1.cmml" xref="A1.SS2.p10.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p10.1.m1.1c">C</annotation></semantics></math> is a calculable constant to normalize <math id="A1.SS2.p10.2.m2.1" class="ltx_Math" alttext="P^{\prime}(x)" display="inline"><semantics id="A1.SS2.p10.2.m2.1a"><mrow id="A1.SS2.p10.2.m2.1.2" xref="A1.SS2.p10.2.m2.1.2.cmml"><msup id="A1.SS2.p10.2.m2.1.2.2" xref="A1.SS2.p10.2.m2.1.2.2.cmml"><mi id="A1.SS2.p10.2.m2.1.2.2.2" xref="A1.SS2.p10.2.m2.1.2.2.2.cmml">P</mi><mo id="A1.SS2.p10.2.m2.1.2.2.3" xref="A1.SS2.p10.2.m2.1.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.SS2.p10.2.m2.1.2.1" xref="A1.SS2.p10.2.m2.1.2.1.cmml">​</mo><mrow id="A1.SS2.p10.2.m2.1.2.3.2" xref="A1.SS2.p10.2.m2.1.2.cmml"><mo stretchy="false" id="A1.SS2.p10.2.m2.1.2.3.2.1" xref="A1.SS2.p10.2.m2.1.2.cmml">(</mo><mi id="A1.SS2.p10.2.m2.1.1" xref="A1.SS2.p10.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="A1.SS2.p10.2.m2.1.2.3.2.2" xref="A1.SS2.p10.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p10.2.m2.1b"><apply id="A1.SS2.p10.2.m2.1.2.cmml" xref="A1.SS2.p10.2.m2.1.2"><times id="A1.SS2.p10.2.m2.1.2.1.cmml" xref="A1.SS2.p10.2.m2.1.2.1"></times><apply id="A1.SS2.p10.2.m2.1.2.2.cmml" xref="A1.SS2.p10.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p10.2.m2.1.2.2.1.cmml" xref="A1.SS2.p10.2.m2.1.2.2">superscript</csymbol><ci id="A1.SS2.p10.2.m2.1.2.2.2.cmml" xref="A1.SS2.p10.2.m2.1.2.2.2">𝑃</ci><ci id="A1.SS2.p10.2.m2.1.2.2.3.cmml" xref="A1.SS2.p10.2.m2.1.2.2.3">′</ci></apply><ci id="A1.SS2.p10.2.m2.1.1.cmml" xref="A1.SS2.p10.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p10.2.m2.1c">P^{\prime}(x)</annotation></semantics></math>
such that its components sum to one. This explains for the multiplicative
form of our attention refinement mechanism in Eqs. (<a href="#S4.E11" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>
and <a href="#S4.E14" title="In 4.3.2 Joint attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a> (lower part)) in the main paper.</p>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Neural Gating Functions</h4>

<div id="A1.SS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.p1.2" class="ltx_p">Here we provide the details of implementation choices for the neural
gating functions in Eqs. (<a href="#S4.E12" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> and <a href="#S4.E13" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>).
In particular, we use element-wise product between embedded representations
of the input <math id="A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="\overline{v}\in\mathbb{R}^{d}" display="inline"><semantics id="A1.SS3.p1.1.m1.1a"><mrow id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="A1.SS3.p1.1.m1.1.1.2" xref="A1.SS3.p1.1.m1.1.1.2.cmml"><mi id="A1.SS3.p1.1.m1.1.1.2.2" xref="A1.SS3.p1.1.m1.1.1.2.2.cmml">v</mi><mo id="A1.SS3.p1.1.m1.1.1.2.1" xref="A1.SS3.p1.1.m1.1.1.2.1.cmml">¯</mo></mover><mo id="A1.SS3.p1.1.m1.1.1.1" xref="A1.SS3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS3.p1.1.m1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.3.cmml"><mi id="A1.SS3.p1.1.m1.1.1.3.2" xref="A1.SS3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS3.p1.1.m1.1.1.3.3" xref="A1.SS3.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><apply id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1"><in id="A1.SS3.p1.1.m1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1"></in><apply id="A1.SS3.p1.1.m1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1.2"><ci id="A1.SS3.p1.1.m1.1.1.2.1.cmml" xref="A1.SS3.p1.1.m1.1.1.2.1">¯</ci><ci id="A1.SS3.p1.1.m1.1.1.2.2.cmml" xref="A1.SS3.p1.1.m1.1.1.2.2">𝑣</ci></apply><apply id="A1.SS3.p1.1.m1.1.1.3.cmml" xref="A1.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.3.1.cmml" xref="A1.SS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS3.p1.1.m1.1.1.3.2.cmml" xref="A1.SS3.p1.1.m1.1.1.3.2">ℝ</ci><ci id="A1.SS3.p1.1.m1.1.1.3.3.cmml" xref="A1.SS3.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\overline{v}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="A1.SS3.p1.2.m2.1" class="ltx_Math" alttext="q\in\mathbb{R}^{d}" display="inline"><semantics id="A1.SS3.p1.2.m2.1a"><mrow id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml"><mi id="A1.SS3.p1.2.m2.1.1.2" xref="A1.SS3.p1.2.m2.1.1.2.cmml">q</mi><mo id="A1.SS3.p1.2.m2.1.1.1" xref="A1.SS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A1.SS3.p1.2.m2.1.1.3" xref="A1.SS3.p1.2.m2.1.1.3.cmml"><mi id="A1.SS3.p1.2.m2.1.1.3.2" xref="A1.SS3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS3.p1.2.m2.1.1.3.3" xref="A1.SS3.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><apply id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1"><in id="A1.SS3.p1.2.m2.1.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1.1"></in><ci id="A1.SS3.p1.2.m2.1.1.2.cmml" xref="A1.SS3.p1.2.m2.1.1.2">𝑞</ci><apply id="A1.SS3.p1.2.m2.1.1.3.cmml" xref="A1.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p1.2.m2.1.1.3.1.cmml" xref="A1.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS3.p1.2.m2.1.1.3.2.cmml" xref="A1.SS3.p1.2.m2.1.1.3.2">ℝ</ci><ci id="A1.SS3.p1.2.m2.1.1.3.3.cmml" xref="A1.SS3.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">q\in\mathbb{R}^{d}</annotation></semantics></math>
as following:</p>
</div>
<div id="A1.SS3.p2" class="ltx_para ltx_noindent">
<table id="A2.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E23.m1.1" class="ltx_Math" alttext="\displaystyle\lambda" display="inline"><semantics id="A1.E23.m1.1a"><mi id="A1.E23.m1.1.1" xref="A1.E23.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.E23.m1.1b"><ci id="A1.E23.m1.1.1.cmml" xref="A1.E23.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m1.1c">\displaystyle\lambda</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E23.m2.2" class="ltx_Math" alttext="\displaystyle=h_{\theta}\left(\overline{v},q\right)" display="inline"><semantics id="A1.E23.m2.2a"><mrow id="A1.E23.m2.2.3" xref="A1.E23.m2.2.3.cmml"><mi id="A1.E23.m2.2.3.2" xref="A1.E23.m2.2.3.2.cmml"></mi><mo id="A1.E23.m2.2.3.1" xref="A1.E23.m2.2.3.1.cmml">=</mo><mrow id="A1.E23.m2.2.3.3" xref="A1.E23.m2.2.3.3.cmml"><msub id="A1.E23.m2.2.3.3.2" xref="A1.E23.m2.2.3.3.2.cmml"><mi id="A1.E23.m2.2.3.3.2.2" xref="A1.E23.m2.2.3.3.2.2.cmml">h</mi><mi id="A1.E23.m2.2.3.3.2.3" xref="A1.E23.m2.2.3.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E23.m2.2.3.3.1" xref="A1.E23.m2.2.3.3.1.cmml">​</mo><mrow id="A1.E23.m2.2.3.3.3.2" xref="A1.E23.m2.2.3.3.3.1.cmml"><mo id="A1.E23.m2.2.3.3.3.2.1" xref="A1.E23.m2.2.3.3.3.1.cmml">(</mo><mover accent="true" id="A1.E23.m2.1.1" xref="A1.E23.m2.1.1.cmml"><mi id="A1.E23.m2.1.1.2" xref="A1.E23.m2.1.1.2.cmml">v</mi><mo id="A1.E23.m2.1.1.1" xref="A1.E23.m2.1.1.1.cmml">¯</mo></mover><mo id="A1.E23.m2.2.3.3.3.2.2" xref="A1.E23.m2.2.3.3.3.1.cmml">,</mo><mi id="A1.E23.m2.2.2" xref="A1.E23.m2.2.2.cmml">q</mi><mo id="A1.E23.m2.2.3.3.3.2.3" xref="A1.E23.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E23.m2.2b"><apply id="A1.E23.m2.2.3.cmml" xref="A1.E23.m2.2.3"><eq id="A1.E23.m2.2.3.1.cmml" xref="A1.E23.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E23.m2.2.3.2.cmml" xref="A1.E23.m2.2.3.2">absent</csymbol><apply id="A1.E23.m2.2.3.3.cmml" xref="A1.E23.m2.2.3.3"><times id="A1.E23.m2.2.3.3.1.cmml" xref="A1.E23.m2.2.3.3.1"></times><apply id="A1.E23.m2.2.3.3.2.cmml" xref="A1.E23.m2.2.3.3.2"><csymbol cd="ambiguous" id="A1.E23.m2.2.3.3.2.1.cmml" xref="A1.E23.m2.2.3.3.2">subscript</csymbol><ci id="A1.E23.m2.2.3.3.2.2.cmml" xref="A1.E23.m2.2.3.3.2.2">ℎ</ci><ci id="A1.E23.m2.2.3.3.2.3.cmml" xref="A1.E23.m2.2.3.3.2.3">𝜃</ci></apply><interval closure="open" id="A1.E23.m2.2.3.3.3.1.cmml" xref="A1.E23.m2.2.3.3.3.2"><apply id="A1.E23.m2.1.1.cmml" xref="A1.E23.m2.1.1"><ci id="A1.E23.m2.1.1.1.cmml" xref="A1.E23.m2.1.1.1">¯</ci><ci id="A1.E23.m2.1.1.2.cmml" xref="A1.E23.m2.1.1.2">𝑣</ci></apply><ci id="A1.E23.m2.2.2.cmml" xref="A1.E23.m2.2.2">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m2.2c">\displaystyle=h_{\theta}\left(\overline{v},q\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
<tbody id="A1.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E24.m1.1" class="ltx_Math" alttext="\displaystyle=\sigma\left(w_{\lambda}^{\top}\left(\text{ELU}\left(\left(W_{v}^{\top}\overline{v}+b_{v}\right)\varodot\left(W_{q}^{\top}q+b_{q}\right)\right)\right)\right)," display="inline"><semantics id="A1.E24.m1.1a"><mrow id="A1.E24.m1.1.1.1" xref="A1.E24.m1.1.1.1.1.cmml"><mrow id="A1.E24.m1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.cmml"><mi id="A1.E24.m1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.3.cmml"></mi><mo id="A1.E24.m1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E24.m1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.cmml"><mi id="A1.E24.m1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E24.m1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E24.m1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">λ</mi><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E24.m1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">ELU</mtext><mo lspace="0em" rspace="0em" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">v</mi><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mover accent="true" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">v</mi><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">¯</mo></mover></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">v</mi></msub></mrow><mo rspace="0.055em" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊙</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mrow id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><msubsup id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml">W</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml">q</mi><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml">​</mo><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml">q</mi></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">+</mo><msub id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml">b</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E24.m1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E24.m1.1b"><apply id="A1.E24.m1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1"><eq id="A1.E24.m1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A1.E24.m1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.3">absent</csymbol><apply id="A1.E24.m1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1"><times id="A1.E24.m1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.2"></times><ci id="A1.E24.m1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.3">𝜎</ci><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1"><times id="A1.E24.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.2.3">𝜆</ci></apply><csymbol cd="latexml" id="A1.E24.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.3.3">top</csymbol></apply><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.3">ELU</mtext></ci><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">⊙</ci><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑣</ci></apply><csymbol cd="latexml" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1">¯</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑣</ci></apply></apply><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1"><plus id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1"></plus><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2"><times id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1"></times><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2">superscript</csymbol><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2">𝑊</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3">𝑞</ci></apply><csymbol cd="latexml" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3">top</csymbol></apply><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3">𝑞</ci></apply><apply id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2">𝑏</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m1.1c">\displaystyle=\sigma\left(w_{\lambda}^{\top}\left(\text{ELU}\left(\left(W_{v}^{\top}\overline{v}+b_{v}\right)\varodot\left(W_{q}^{\top}q+b_{q}\right)\right)\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p id="A1.SS3.p2.4" class="ltx_p">where <math id="A1.SS3.p2.1.m1.2" class="ltx_Math" alttext="w_{\lambda}\in\mathbb{R}^{d},\,W_{v}\in\mathbb{R}^{d\times d},\,W_{q}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="A1.SS3.p2.1.m1.2a"><mrow id="A1.SS3.p2.1.m1.2.2.2" xref="A1.SS3.p2.1.m1.2.2.3.cmml"><mrow id="A1.SS3.p2.1.m1.1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.1.cmml"><msub id="A1.SS3.p2.1.m1.1.1.1.1.2" xref="A1.SS3.p2.1.m1.1.1.1.1.2.cmml"><mi id="A1.SS3.p2.1.m1.1.1.1.1.2.2" xref="A1.SS3.p2.1.m1.1.1.1.1.2.2.cmml">w</mi><mi id="A1.SS3.p2.1.m1.1.1.1.1.2.3" xref="A1.SS3.p2.1.m1.1.1.1.1.2.3.cmml">λ</mi></msub><mo id="A1.SS3.p2.1.m1.1.1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.1.1.cmml">∈</mo><msup id="A1.SS3.p2.1.m1.1.1.1.1.3" xref="A1.SS3.p2.1.m1.1.1.1.1.3.cmml"><mi id="A1.SS3.p2.1.m1.1.1.1.1.3.2" xref="A1.SS3.p2.1.m1.1.1.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS3.p2.1.m1.1.1.1.1.3.3" xref="A1.SS3.p2.1.m1.1.1.1.1.3.3.cmml">d</mi></msup></mrow><mo rspace="0.337em" id="A1.SS3.p2.1.m1.2.2.2.3" xref="A1.SS3.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="A1.SS3.p2.1.m1.2.2.2.2.2" xref="A1.SS3.p2.1.m1.2.2.2.2.3.cmml"><mrow id="A1.SS3.p2.1.m1.2.2.2.2.1.1" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.cmml"><msub id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.2" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.3" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.3.cmml">v</mi></msub><mo id="A1.SS3.p2.1.m1.2.2.2.2.1.1.1" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.2" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.2" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.1" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.1.cmml">×</mo><mi id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.3" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo rspace="0.337em" id="A1.SS3.p2.1.m1.2.2.2.2.2.3" xref="A1.SS3.p2.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A1.SS3.p2.1.m1.2.2.2.2.2.2" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.cmml"><msub id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.2" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.2.cmml">W</mi><mi id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.3" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.3.cmml">q</mi></msub><mo id="A1.SS3.p2.1.m1.2.2.2.2.2.2.1" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.2" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.2" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.1" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.1.cmml">×</mo><mi id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.3" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.3.cmml">d</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.2b"><apply id="A1.SS3.p2.1.m1.2.2.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.3a.cmml" xref="A1.SS3.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS3.p2.1.m1.1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1"><in id="A1.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.1"></in><apply id="A1.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.1.1.1.1.2.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS3.p2.1.m1.1.1.1.1.2.2.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.2.2">𝑤</ci><ci id="A1.SS3.p2.1.m1.1.1.1.1.2.3.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.2.3">𝜆</ci></apply><apply id="A1.SS3.p2.1.m1.1.1.1.1.3.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.1.1.1.1.3.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.3">superscript</csymbol><ci id="A1.SS3.p2.1.m1.1.1.1.1.3.2.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.3.2">ℝ</ci><ci id="A1.SS3.p2.1.m1.1.1.1.1.3.3.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="A1.SS3.p2.1.m1.2.2.2.2.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.2.2.3a.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS3.p2.1.m1.2.2.2.2.1.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1"><in id="A1.SS3.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.1"></in><apply id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.2">𝑊</ci><ci id="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.2.3">𝑣</ci></apply><apply id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3"><times id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.1"></times><ci id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.2">𝑑</ci><ci id="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A1.SS3.p2.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2"><in id="A1.SS3.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.1"></in><apply id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.2">𝑊</ci><ci id="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.2.3">𝑞</ci></apply><apply id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.2">ℝ</ci><apply id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3"><times id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.1"></times><ci id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.2">𝑑</ci><ci id="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A1.SS3.p2.1.m1.2.2.2.2.2.2.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.2c">w_{\lambda}\in\mathbb{R}^{d},\,W_{v}\in\mathbb{R}^{d\times d},\,W_{q}\in\mathbb{R}^{d\times d}</annotation></semantics></math>
are learnable weights, <math id="A1.SS3.p2.2.m2.2" class="ltx_Math" alttext="b_{v},b_{q}" display="inline"><semantics id="A1.SS3.p2.2.m2.2a"><mrow id="A1.SS3.p2.2.m2.2.2.2" xref="A1.SS3.p2.2.m2.2.2.3.cmml"><msub id="A1.SS3.p2.2.m2.1.1.1.1" xref="A1.SS3.p2.2.m2.1.1.1.1.cmml"><mi id="A1.SS3.p2.2.m2.1.1.1.1.2" xref="A1.SS3.p2.2.m2.1.1.1.1.2.cmml">b</mi><mi id="A1.SS3.p2.2.m2.1.1.1.1.3" xref="A1.SS3.p2.2.m2.1.1.1.1.3.cmml">v</mi></msub><mo id="A1.SS3.p2.2.m2.2.2.2.3" xref="A1.SS3.p2.2.m2.2.2.3.cmml">,</mo><msub id="A1.SS3.p2.2.m2.2.2.2.2" xref="A1.SS3.p2.2.m2.2.2.2.2.cmml"><mi id="A1.SS3.p2.2.m2.2.2.2.2.2" xref="A1.SS3.p2.2.m2.2.2.2.2.2.cmml">b</mi><mi id="A1.SS3.p2.2.m2.2.2.2.2.3" xref="A1.SS3.p2.2.m2.2.2.2.2.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.2.m2.2b"><list id="A1.SS3.p2.2.m2.2.2.3.cmml" xref="A1.SS3.p2.2.m2.2.2.2"><apply id="A1.SS3.p2.2.m2.1.1.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS3.p2.2.m2.1.1.1.1.2.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.2">𝑏</ci><ci id="A1.SS3.p2.2.m2.1.1.1.1.3.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.3">𝑣</ci></apply><apply id="A1.SS3.p2.2.m2.2.2.2.2.cmml" xref="A1.SS3.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p2.2.m2.2.2.2.2.1.cmml" xref="A1.SS3.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="A1.SS3.p2.2.m2.2.2.2.2.2.cmml" xref="A1.SS3.p2.2.m2.2.2.2.2.2">𝑏</ci><ci id="A1.SS3.p2.2.m2.2.2.2.2.3.cmml" xref="A1.SS3.p2.2.m2.2.2.2.2.3">𝑞</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.2.m2.2c">b_{v},b_{q}</annotation></semantics></math> are biases, <math id="A1.SS3.p2.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="A1.SS3.p2.3.m3.1a"><mi id="A1.SS3.p2.3.m3.1.1" xref="A1.SS3.p2.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.3.m3.1b"><ci id="A1.SS3.p2.3.m3.1.1.cmml" xref="A1.SS3.p2.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.3.m3.1c">\sigma</annotation></semantics></math> is the
sigmoid function and <math id="A1.SS3.p2.4.m4.1" class="ltx_Math" alttext="\varodot" display="inline"><semantics id="A1.SS3.p2.4.m4.1a"><mo id="A1.SS3.p2.4.m4.1.1" xref="A1.SS3.p2.4.m4.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.4.m4.1b"><ci id="A1.SS3.p2.4.m4.1.1.cmml" xref="A1.SS3.p2.4.m4.1.1">⊙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.4.m4.1c">\varodot</annotation></semantics></math> denotes the Hadamard product. ELU
<cite class="ltx_cite ltx_citemacro_citep">(Clevert et al., <a href="#bib.bib58" title="" class="ltx_ref">2016</a>)</cite> is a non-linear activation function.</p>
</div>
<div id="A1.SS3.p3" class="ltx_para ltx_noindent">
<p id="A1.SS3.p3.2" class="ltx_p">For multi-step reasoning, we additionally takes as input the intermediate
controlling signal <math id="A1.SS3.p3.1.m1.1" class="ltx_Math" alttext="c_{k}\in\mathbb{R}^{d}" display="inline"><semantics id="A1.SS3.p3.1.m1.1a"><mrow id="A1.SS3.p3.1.m1.1.1" xref="A1.SS3.p3.1.m1.1.1.cmml"><msub id="A1.SS3.p3.1.m1.1.1.2" xref="A1.SS3.p3.1.m1.1.1.2.cmml"><mi id="A1.SS3.p3.1.m1.1.1.2.2" xref="A1.SS3.p3.1.m1.1.1.2.2.cmml">c</mi><mi id="A1.SS3.p3.1.m1.1.1.2.3" xref="A1.SS3.p3.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="A1.SS3.p3.1.m1.1.1.1" xref="A1.SS3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS3.p3.1.m1.1.1.3" xref="A1.SS3.p3.1.m1.1.1.3.cmml"><mi id="A1.SS3.p3.1.m1.1.1.3.2" xref="A1.SS3.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS3.p3.1.m1.1.1.3.3" xref="A1.SS3.p3.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.1.m1.1b"><apply id="A1.SS3.p3.1.m1.1.1.cmml" xref="A1.SS3.p3.1.m1.1.1"><in id="A1.SS3.p3.1.m1.1.1.1.cmml" xref="A1.SS3.p3.1.m1.1.1.1"></in><apply id="A1.SS3.p3.1.m1.1.1.2.cmml" xref="A1.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.1.1.2.1.cmml" xref="A1.SS3.p3.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS3.p3.1.m1.1.1.2.2.cmml" xref="A1.SS3.p3.1.m1.1.1.2.2">𝑐</ci><ci id="A1.SS3.p3.1.m1.1.1.2.3.cmml" xref="A1.SS3.p3.1.m1.1.1.2.3">𝑘</ci></apply><apply id="A1.SS3.p3.1.m1.1.1.3.cmml" xref="A1.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.1.1.3.1.cmml" xref="A1.SS3.p3.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS3.p3.1.m1.1.1.3.2.cmml" xref="A1.SS3.p3.1.m1.1.1.3.2">ℝ</ci><ci id="A1.SS3.p3.1.m1.1.1.3.3.cmml" xref="A1.SS3.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.1.m1.1c">c_{k}\in\mathbb{R}^{d}</annotation></semantics></math> at reasoning step <math id="A1.SS3.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS3.p3.2.m2.1a"><mi id="A1.SS3.p3.2.m2.1.1" xref="A1.SS3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.2.m2.1b"><ci id="A1.SS3.p3.2.m2.1.1.cmml" xref="A1.SS3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.2.m2.1c">k</annotation></semantics></math>.
Output of the modulating gate in Eq. <a href="#S4.E13" title="In 4.3.1 Marginalized attention refinement ‣ 4.3 Attention Refinement with Attention Priors ‣ 4 Methods ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>
in the main paper is given by</p>
<table id="A1.E25" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E25.m1.3" class="ltx_Math" alttext="\lambda_{k}=p_{\theta}\left(c_{k},h_{\theta}\left(\overline{v},q\right)\right)," display="block"><semantics id="A1.E25.m1.3a"><mrow id="A1.E25.m1.3.3.1" xref="A1.E25.m1.3.3.1.1.cmml"><mrow id="A1.E25.m1.3.3.1.1" xref="A1.E25.m1.3.3.1.1.cmml"><msub id="A1.E25.m1.3.3.1.1.4" xref="A1.E25.m1.3.3.1.1.4.cmml"><mi id="A1.E25.m1.3.3.1.1.4.2" xref="A1.E25.m1.3.3.1.1.4.2.cmml">λ</mi><mi id="A1.E25.m1.3.3.1.1.4.3" xref="A1.E25.m1.3.3.1.1.4.3.cmml">k</mi></msub><mo id="A1.E25.m1.3.3.1.1.3" xref="A1.E25.m1.3.3.1.1.3.cmml">=</mo><mrow id="A1.E25.m1.3.3.1.1.2" xref="A1.E25.m1.3.3.1.1.2.cmml"><msub id="A1.E25.m1.3.3.1.1.2.4" xref="A1.E25.m1.3.3.1.1.2.4.cmml"><mi id="A1.E25.m1.3.3.1.1.2.4.2" xref="A1.E25.m1.3.3.1.1.2.4.2.cmml">p</mi><mi id="A1.E25.m1.3.3.1.1.2.4.3" xref="A1.E25.m1.3.3.1.1.2.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E25.m1.3.3.1.1.2.3" xref="A1.E25.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="A1.E25.m1.3.3.1.1.2.2.2" xref="A1.E25.m1.3.3.1.1.2.2.3.cmml"><mo id="A1.E25.m1.3.3.1.1.2.2.2.3" xref="A1.E25.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="A1.E25.m1.3.3.1.1.1.1.1.1" xref="A1.E25.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E25.m1.3.3.1.1.1.1.1.1.2" xref="A1.E25.m1.3.3.1.1.1.1.1.1.2.cmml">c</mi><mi id="A1.E25.m1.3.3.1.1.1.1.1.1.3" xref="A1.E25.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A1.E25.m1.3.3.1.1.2.2.2.4" xref="A1.E25.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="A1.E25.m1.3.3.1.1.2.2.2.2" xref="A1.E25.m1.3.3.1.1.2.2.2.2.cmml"><msub id="A1.E25.m1.3.3.1.1.2.2.2.2.2" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="A1.E25.m1.3.3.1.1.2.2.2.2.2.2" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2.2.cmml">h</mi><mi id="A1.E25.m1.3.3.1.1.2.2.2.2.2.3" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E25.m1.3.3.1.1.2.2.2.2.1" xref="A1.E25.m1.3.3.1.1.2.2.2.2.1.cmml">​</mo><mrow id="A1.E25.m1.3.3.1.1.2.2.2.2.3.2" xref="A1.E25.m1.3.3.1.1.2.2.2.2.3.1.cmml"><mo id="A1.E25.m1.3.3.1.1.2.2.2.2.3.2.1" xref="A1.E25.m1.3.3.1.1.2.2.2.2.3.1.cmml">(</mo><mover accent="true" id="A1.E25.m1.1.1" xref="A1.E25.m1.1.1.cmml"><mi id="A1.E25.m1.1.1.2" xref="A1.E25.m1.1.1.2.cmml">v</mi><mo id="A1.E25.m1.1.1.1" xref="A1.E25.m1.1.1.1.cmml">¯</mo></mover><mo id="A1.E25.m1.3.3.1.1.2.2.2.2.3.2.2" xref="A1.E25.m1.3.3.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="A1.E25.m1.2.2" xref="A1.E25.m1.2.2.cmml">q</mi><mo id="A1.E25.m1.3.3.1.1.2.2.2.2.3.2.3" xref="A1.E25.m1.3.3.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.3.3.1.1.2.2.2.5" xref="A1.E25.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E25.m1.3.3.1.2" xref="A1.E25.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E25.m1.3b"><apply id="A1.E25.m1.3.3.1.1.cmml" xref="A1.E25.m1.3.3.1"><eq id="A1.E25.m1.3.3.1.1.3.cmml" xref="A1.E25.m1.3.3.1.1.3"></eq><apply id="A1.E25.m1.3.3.1.1.4.cmml" xref="A1.E25.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.4.1.cmml" xref="A1.E25.m1.3.3.1.1.4">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.4.2.cmml" xref="A1.E25.m1.3.3.1.1.4.2">𝜆</ci><ci id="A1.E25.m1.3.3.1.1.4.3.cmml" xref="A1.E25.m1.3.3.1.1.4.3">𝑘</ci></apply><apply id="A1.E25.m1.3.3.1.1.2.cmml" xref="A1.E25.m1.3.3.1.1.2"><times id="A1.E25.m1.3.3.1.1.2.3.cmml" xref="A1.E25.m1.3.3.1.1.2.3"></times><apply id="A1.E25.m1.3.3.1.1.2.4.cmml" xref="A1.E25.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.2.4.1.cmml" xref="A1.E25.m1.3.3.1.1.2.4">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.2.4.2.cmml" xref="A1.E25.m1.3.3.1.1.2.4.2">𝑝</ci><ci id="A1.E25.m1.3.3.1.1.2.4.3.cmml" xref="A1.E25.m1.3.3.1.1.2.4.3">𝜃</ci></apply><interval closure="open" id="A1.E25.m1.3.3.1.1.2.2.3.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2"><apply id="A1.E25.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E25.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.3.3.1.1.1.1.1.1.2">𝑐</ci><ci id="A1.E25.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E25.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A1.E25.m1.3.3.1.1.2.2.2.2.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2"><times id="A1.E25.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.1"></times><apply id="A1.E25.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2.2">ℎ</ci><ci id="A1.E25.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.2.3">𝜃</ci></apply><interval closure="open" id="A1.E25.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2.2.3.2"><apply id="A1.E25.m1.1.1.cmml" xref="A1.E25.m1.1.1"><ci id="A1.E25.m1.1.1.1.cmml" xref="A1.E25.m1.1.1.1">¯</ci><ci id="A1.E25.m1.1.1.2.cmml" xref="A1.E25.m1.1.1.2">𝑣</ci></apply><ci id="A1.E25.m1.2.2.cmml" xref="A1.E25.m1.2.2">𝑞</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m1.3c">\lambda_{k}=p_{\theta}\left(c_{k},h_{\theta}\left(\overline{v},q\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p id="A1.SS3.p3.5" class="ltx_p">where</p>
<table id="A2.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E26.m1.2" class="ltx_Math" alttext="\displaystyle h_{\theta}\left(\overline{v},q\right)" display="inline"><semantics id="A1.E26.m1.2a"><mrow id="A1.E26.m1.2.3" xref="A1.E26.m1.2.3.cmml"><msub id="A1.E26.m1.2.3.2" xref="A1.E26.m1.2.3.2.cmml"><mi id="A1.E26.m1.2.3.2.2" xref="A1.E26.m1.2.3.2.2.cmml">h</mi><mi id="A1.E26.m1.2.3.2.3" xref="A1.E26.m1.2.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A1.E26.m1.2.3.1" xref="A1.E26.m1.2.3.1.cmml">​</mo><mrow id="A1.E26.m1.2.3.3.2" xref="A1.E26.m1.2.3.3.1.cmml"><mo id="A1.E26.m1.2.3.3.2.1" xref="A1.E26.m1.2.3.3.1.cmml">(</mo><mover accent="true" id="A1.E26.m1.1.1" xref="A1.E26.m1.1.1.cmml"><mi id="A1.E26.m1.1.1.2" xref="A1.E26.m1.1.1.2.cmml">v</mi><mo id="A1.E26.m1.1.1.1" xref="A1.E26.m1.1.1.1.cmml">¯</mo></mover><mo id="A1.E26.m1.2.3.3.2.2" xref="A1.E26.m1.2.3.3.1.cmml">,</mo><mi id="A1.E26.m1.2.2" xref="A1.E26.m1.2.2.cmml">q</mi><mo id="A1.E26.m1.2.3.3.2.3" xref="A1.E26.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E26.m1.2b"><apply id="A1.E26.m1.2.3.cmml" xref="A1.E26.m1.2.3"><times id="A1.E26.m1.2.3.1.cmml" xref="A1.E26.m1.2.3.1"></times><apply id="A1.E26.m1.2.3.2.cmml" xref="A1.E26.m1.2.3.2"><csymbol cd="ambiguous" id="A1.E26.m1.2.3.2.1.cmml" xref="A1.E26.m1.2.3.2">subscript</csymbol><ci id="A1.E26.m1.2.3.2.2.cmml" xref="A1.E26.m1.2.3.2.2">ℎ</ci><ci id="A1.E26.m1.2.3.2.3.cmml" xref="A1.E26.m1.2.3.2.3">𝜃</ci></apply><interval closure="open" id="A1.E26.m1.2.3.3.1.cmml" xref="A1.E26.m1.2.3.3.2"><apply id="A1.E26.m1.1.1.cmml" xref="A1.E26.m1.1.1"><ci id="A1.E26.m1.1.1.1.cmml" xref="A1.E26.m1.1.1.1">¯</ci><ci id="A1.E26.m1.1.1.2.cmml" xref="A1.E26.m1.1.1.2">𝑣</ci></apply><ci id="A1.E26.m1.2.2.cmml" xref="A1.E26.m1.2.2">𝑞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E26.m1.2c">\displaystyle h_{\theta}\left(\overline{v},q\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E26.m2.1" class="ltx_Math" alttext="\displaystyle=W_{h}^{\top}\left(\text{ELU}\left(\left(W_{v}^{\top}\overline{v}+b_{v}\right)\varodot\left(W_{q}^{\top}q+b_{q}\right)\right)\right)," display="inline"><semantics id="A1.E26.m2.1a"><mrow id="A1.E26.m2.1.1.1" xref="A1.E26.m2.1.1.1.1.cmml"><mrow id="A1.E26.m2.1.1.1.1" xref="A1.E26.m2.1.1.1.1.cmml"><mi id="A1.E26.m2.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.3.cmml"></mi><mo id="A1.E26.m2.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.2.cmml">=</mo><mrow id="A1.E26.m2.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.cmml"><msubsup id="A1.E26.m2.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.3.cmml"><mi id="A1.E26.m2.1.1.1.1.1.3.2.2" xref="A1.E26.m2.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="A1.E26.m2.1.1.1.1.1.3.2.3" xref="A1.E26.m2.1.1.1.1.1.3.2.3.cmml">h</mi><mo id="A1.E26.m2.1.1.1.1.1.3.3" xref="A1.E26.m2.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E26.m2.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E26.m2.1.1.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="A1.E26.m2.1.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.3a.cmml">ELU</mtext><mo lspace="0em" rspace="0em" id="A1.E26.m2.1.1.1.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">v</mi><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mover accent="true" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">v</mi><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">¯</mo></mover></mrow><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">v</mi></msub></mrow><mo rspace="0.055em" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊙</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mrow id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><msubsup id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml"><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml">W</mi><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml">q</mi><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml">​</mo><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml">q</mi></mrow><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">+</mo><msub id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml">b</mi><mi id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E26.m2.1.1.1.1.1.1.1.3" xref="A1.E26.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E26.m2.1.1.1.2" xref="A1.E26.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E26.m2.1b"><apply id="A1.E26.m2.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1"><eq id="A1.E26.m2.1.1.1.1.2.cmml" xref="A1.E26.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A1.E26.m2.1.1.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.3">absent</csymbol><apply id="A1.E26.m2.1.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1"><times id="A1.E26.m2.1.1.1.1.1.2.cmml" xref="A1.E26.m2.1.1.1.1.1.2"></times><apply id="A1.E26.m2.1.1.1.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.3.1.cmml" xref="A1.E26.m2.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E26.m2.1.1.1.1.1.3.2.cmml" xref="A1.E26.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.3.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E26.m2.1.1.1.1.1.3.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.3.2.2">𝑊</ci><ci id="A1.E26.m2.1.1.1.1.1.3.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.3.2.3">ℎ</ci></apply><csymbol cd="latexml" id="A1.E26.m2.1.1.1.1.1.3.3.cmml" xref="A1.E26.m2.1.1.1.1.1.3.3">top</csymbol></apply><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1"><times id="A1.E26.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.3"><mtext id="A1.E26.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.3">ELU</mtext></ci><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1"><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.3">⊙</ci><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑣</ci></apply><csymbol cd="latexml" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1">¯</ci><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑣</ci></apply></apply><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1"><plus id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1"></plus><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2"><times id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.1"></times><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2">superscript</csymbol><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2">subscript</csymbol><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.2">𝑊</ci><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.3">𝑞</ci></apply><csymbol cd="latexml" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.3">top</csymbol></apply><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.3">𝑞</ci></apply><apply id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.2">𝑏</ci><ci id="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="A1.E26.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E26.m2.1c">\displaystyle=W_{h}^{\top}\left(\text{ELU}\left(\left(W_{v}^{\top}\overline{v}+b_{v}\right)\varodot\left(W_{q}^{\top}q+b_{q}\right)\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
<tbody id="A1.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E27.m1.1" class="ltx_Math" alttext="\displaystyle p_{\theta}" display="inline"><semantics id="A1.E27.m1.1a"><msub id="A1.E27.m1.1.1" xref="A1.E27.m1.1.1.cmml"><mi id="A1.E27.m1.1.1.2" xref="A1.E27.m1.1.1.2.cmml">p</mi><mi id="A1.E27.m1.1.1.3" xref="A1.E27.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E27.m1.1b"><apply id="A1.E27.m1.1.1.cmml" xref="A1.E27.m1.1.1"><csymbol cd="ambiguous" id="A1.E27.m1.1.1.1.cmml" xref="A1.E27.m1.1.1">subscript</csymbol><ci id="A1.E27.m1.1.1.2.cmml" xref="A1.E27.m1.1.1.2">𝑝</ci><ci id="A1.E27.m1.1.1.3.cmml" xref="A1.E27.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E27.m1.1c">\displaystyle p_{\theta}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E27.m2.3" class="ltx_Math" alttext="\displaystyle=\sigma\left(w_{\lambda}^{\top}\left(\text{ELU}\left(c_{k}\varodot h_{\theta}\left(\overline{v},q\right)\right)\right)\right)." display="inline"><semantics id="A1.E27.m2.3a"><mrow id="A1.E27.m2.3.3.1" xref="A1.E27.m2.3.3.1.1.cmml"><mrow id="A1.E27.m2.3.3.1.1" xref="A1.E27.m2.3.3.1.1.cmml"><mi id="A1.E27.m2.3.3.1.1.3" xref="A1.E27.m2.3.3.1.1.3.cmml"></mi><mo id="A1.E27.m2.3.3.1.1.2" xref="A1.E27.m2.3.3.1.1.2.cmml">=</mo><mrow id="A1.E27.m2.3.3.1.1.1" xref="A1.E27.m2.3.3.1.1.1.cmml"><mi id="A1.E27.m2.3.3.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E27.m2.3.3.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E27.m2.3.3.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.cmml"><msubsup id="A1.E27.m2.3.3.1.1.1.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.cmml"><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.3.cmml">λ</mi><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.3.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E27.m2.3.3.1.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mtext id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3a.cmml">ELU</mtext><mo lspace="0em" rspace="0em" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⊙</mo><msub id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mover accent="true" id="A1.E27.m2.1.1" xref="A1.E27.m2.1.1.cmml"><mi id="A1.E27.m2.1.1.2" xref="A1.E27.m2.1.1.2.cmml">v</mi><mo id="A1.E27.m2.1.1.1" xref="A1.E27.m2.1.1.1.cmml">¯</mo></mover><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E27.m2.2.2" xref="A1.E27.m2.2.2.cmml">q</mi><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E27.m2.3.3.1.1.1.1.1.3" xref="A1.E27.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A1.E27.m2.3.3.1.2" xref="A1.E27.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E27.m2.3b"><apply id="A1.E27.m2.3.3.1.1.cmml" xref="A1.E27.m2.3.3.1"><eq id="A1.E27.m2.3.3.1.1.2.cmml" xref="A1.E27.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="A1.E27.m2.3.3.1.1.3.cmml" xref="A1.E27.m2.3.3.1.1.3">absent</csymbol><apply id="A1.E27.m2.3.3.1.1.1.cmml" xref="A1.E27.m2.3.3.1.1.1"><times id="A1.E27.m2.3.3.1.1.1.2.cmml" xref="A1.E27.m2.3.3.1.1.1.2"></times><ci id="A1.E27.m2.3.3.1.1.1.3.cmml" xref="A1.E27.m2.3.3.1.1.1.3">𝜎</ci><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1"><times id="A1.E27.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.2"></times><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E27.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.2.3">𝜆</ci></apply><csymbol cd="latexml" id="A1.E27.m2.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.3.3">top</csymbol></apply><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1"><times id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3a.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3"><mtext id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.3">ELU</mtext></ci><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1">⊙</ci><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝜃</ci></apply></apply><interval closure="open" id="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E27.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><apply id="A1.E27.m2.1.1.cmml" xref="A1.E27.m2.1.1"><ci id="A1.E27.m2.1.1.1.cmml" xref="A1.E27.m2.1.1.1">¯</ci><ci id="A1.E27.m2.1.1.2.cmml" xref="A1.E27.m2.1.1.2">𝑣</ci></apply><ci id="A1.E27.m2.2.2.cmml" xref="A1.E27.m2.2.2">𝑞</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E27.m2.3c">\displaystyle=\sigma\left(w_{\lambda}^{\top}\left(\text{ELU}\left(c_{k}\varodot h_{\theta}\left(\overline{v},q\right)\right)\right)\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
<p id="A1.SS3.p3.4" class="ltx_p">Here <math id="A1.SS3.p3.3.m1.2" class="ltx_Math" alttext="W_{h}\in\mathbb{R}^{d\times d},\,W_{v}\in\mathbb{R}^{d\times d},\,W_{q}\in\mathbb{R}^{d\times d},\,w_{\lambda}\in\mathbb{R}^{d}" display="inline"><semantics id="A1.SS3.p3.3.m1.2a"><mrow id="A1.SS3.p3.3.m1.2.2.2" xref="A1.SS3.p3.3.m1.2.2.3.cmml"><mrow id="A1.SS3.p3.3.m1.1.1.1.1" xref="A1.SS3.p3.3.m1.1.1.1.1.cmml"><msub id="A1.SS3.p3.3.m1.1.1.1.1.2" xref="A1.SS3.p3.3.m1.1.1.1.1.2.cmml"><mi id="A1.SS3.p3.3.m1.1.1.1.1.2.2" xref="A1.SS3.p3.3.m1.1.1.1.1.2.2.cmml">W</mi><mi id="A1.SS3.p3.3.m1.1.1.1.1.2.3" xref="A1.SS3.p3.3.m1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="A1.SS3.p3.3.m1.1.1.1.1.1" xref="A1.SS3.p3.3.m1.1.1.1.1.1.cmml">∈</mo><msup id="A1.SS3.p3.3.m1.1.1.1.1.3" xref="A1.SS3.p3.3.m1.1.1.1.1.3.cmml"><mi id="A1.SS3.p3.3.m1.1.1.1.1.3.2" xref="A1.SS3.p3.3.m1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS3.p3.3.m1.1.1.1.1.3.3" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.cmml"><mi id="A1.SS3.p3.3.m1.1.1.1.1.3.3.2" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS3.p3.3.m1.1.1.1.1.3.3.1" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS3.p3.3.m1.1.1.1.1.3.3.3" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo rspace="0.337em" id="A1.SS3.p3.3.m1.2.2.2.3" xref="A1.SS3.p3.3.m1.2.2.3a.cmml">,</mo><mrow id="A1.SS3.p3.3.m1.2.2.2.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.3.cmml"><mrow id="A1.SS3.p3.3.m1.2.2.2.2.1.1" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.cmml"><msub id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.3.cmml">v</mi></msub><mo id="A1.SS3.p3.3.m1.2.2.2.2.1.1.1" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.2" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.2" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.1" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.1.cmml">×</mo><mi id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.3" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo rspace="0.337em" id="A1.SS3.p3.3.m1.2.2.2.2.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.3.cmml"><mrow id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.cmml"><msub id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.3.cmml">q</mi></msub><mo id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.1" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.1.cmml">∈</mo><msup id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.1" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.1.cmml">×</mo><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo rspace="0.337em" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.cmml"><msub id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.3.cmml">λ</mi></msub><mo id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.1" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.cmml"><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.2" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.3" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.3.cmml">d</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.3.m1.2b"><apply id="A1.SS3.p3.3.m1.2.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.3a.cmml" xref="A1.SS3.p3.3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS3.p3.3.m1.1.1.1.1.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1"><in id="A1.SS3.p3.3.m1.1.1.1.1.1.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.1"></in><apply id="A1.SS3.p3.3.m1.1.1.1.1.2.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.1.1.1.1.2.1.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS3.p3.3.m1.1.1.1.1.2.2.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.2.2">𝑊</ci><ci id="A1.SS3.p3.3.m1.1.1.1.1.2.3.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.2.3">ℎ</ci></apply><apply id="A1.SS3.p3.3.m1.1.1.1.1.3.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.1.1.1.1.3.1.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3">superscript</csymbol><ci id="A1.SS3.p3.3.m1.1.1.1.1.3.2.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3.2">ℝ</ci><apply id="A1.SS3.p3.3.m1.1.1.1.1.3.3.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3"><times id="A1.SS3.p3.3.m1.1.1.1.1.3.3.1.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.1"></times><ci id="A1.SS3.p3.3.m1.1.1.1.1.3.3.2.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.2">𝑑</ci><ci id="A1.SS3.p3.3.m1.1.1.1.1.3.3.3.cmml" xref="A1.SS3.p3.3.m1.1.1.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.3a.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS3.p3.3.m1.2.2.2.2.1.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1"><in id="A1.SS3.p3.3.m1.2.2.2.2.1.1.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.1"></in><apply id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.2">𝑊</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.2.3">𝑣</ci></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3"><times id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.1"></times><ci id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.2">𝑑</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.3a.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1"><in id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.1"></in><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.2">𝑊</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.2.3">𝑞</ci></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3">superscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.2">ℝ</ci><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3"><times id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.1"></times><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.2">𝑑</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2"><in id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.1"></in><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.2">𝑤</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.2.3">𝜆</ci></apply><apply id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.2">ℝ</ci><ci id="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="A1.SS3.p3.3.m1.2.2.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.3.m1.2c">W_{h}\in\mathbb{R}^{d\times d},\,W_{v}\in\mathbb{R}^{d\times d},\,W_{q}\in\mathbb{R}^{d\times d},\,w_{\lambda}\in\mathbb{R}^{d}</annotation></semantics></math>
are learnable weights, and <math id="A1.SS3.p3.4.m2.2" class="ltx_Math" alttext="b_{v},b_{q}" display="inline"><semantics id="A1.SS3.p3.4.m2.2a"><mrow id="A1.SS3.p3.4.m2.2.2.2" xref="A1.SS3.p3.4.m2.2.2.3.cmml"><msub id="A1.SS3.p3.4.m2.1.1.1.1" xref="A1.SS3.p3.4.m2.1.1.1.1.cmml"><mi id="A1.SS3.p3.4.m2.1.1.1.1.2" xref="A1.SS3.p3.4.m2.1.1.1.1.2.cmml">b</mi><mi id="A1.SS3.p3.4.m2.1.1.1.1.3" xref="A1.SS3.p3.4.m2.1.1.1.1.3.cmml">v</mi></msub><mo id="A1.SS3.p3.4.m2.2.2.2.3" xref="A1.SS3.p3.4.m2.2.2.3.cmml">,</mo><msub id="A1.SS3.p3.4.m2.2.2.2.2" xref="A1.SS3.p3.4.m2.2.2.2.2.cmml"><mi id="A1.SS3.p3.4.m2.2.2.2.2.2" xref="A1.SS3.p3.4.m2.2.2.2.2.2.cmml">b</mi><mi id="A1.SS3.p3.4.m2.2.2.2.2.3" xref="A1.SS3.p3.4.m2.2.2.2.2.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.4.m2.2b"><list id="A1.SS3.p3.4.m2.2.2.3.cmml" xref="A1.SS3.p3.4.m2.2.2.2"><apply id="A1.SS3.p3.4.m2.1.1.1.1.cmml" xref="A1.SS3.p3.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p3.4.m2.1.1.1.1.1.cmml" xref="A1.SS3.p3.4.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS3.p3.4.m2.1.1.1.1.2.cmml" xref="A1.SS3.p3.4.m2.1.1.1.1.2">𝑏</ci><ci id="A1.SS3.p3.4.m2.1.1.1.1.3.cmml" xref="A1.SS3.p3.4.m2.1.1.1.1.3">𝑣</ci></apply><apply id="A1.SS3.p3.4.m2.2.2.2.2.cmml" xref="A1.SS3.p3.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.4.m2.2.2.2.2.1.cmml" xref="A1.SS3.p3.4.m2.2.2.2.2">subscript</csymbol><ci id="A1.SS3.p3.4.m2.2.2.2.2.2.cmml" xref="A1.SS3.p3.4.m2.2.2.2.2.2">𝑏</ci><ci id="A1.SS3.p3.4.m2.2.2.2.2.3.cmml" xref="A1.SS3.p3.4.m2.2.2.2.2.3">𝑞</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.4.m2.2c">b_{v},b_{q}</annotation></semantics></math> are biases.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h3 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experiment details</h3>

<section id="A2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Datasets</h4>

<section id="A2.SS1.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">VQA v2</h6>

<div id="A2.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.SSS0.Px1.p1.1" class="ltx_p">is a large scale VQA dataset entirely based on human annotation and
is the most popular benchmark for VQA models. It contains 1.1M questions
with more than 11M answers annotated from over 200K MSCOCO images
<cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib59" title="" class="ltx_ref">2014</a>)</cite>, of which 443,757 questions, 214,354 questions
and 447,793 questions in train, val and test split, respectively.</p>
</div>
<div id="A2.SS1.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="A2.SS1.SSS0.Px1.p2.1" class="ltx_p">We choose correct answers in the training split appearing more than
8 times, similar to prior works <cite class="ltx_cite ltx_citemacro_citep">(Teney et al., <a href="#bib.bib60" title="" class="ltx_ref">2018</a>; Anderson et al., <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>.
We report performance as accuracy calculated by standard VQA accuracy
metric: <math id="A2.SS1.SSS0.Px1.p2.1.m1.2" class="ltx_Math" alttext="\text{min}(\frac{\text{\#humans that provided that answer}}{3},1)" display="inline"><semantics id="A2.SS1.SSS0.Px1.p2.1.m1.2a"><mrow id="A2.SS1.SSS0.Px1.p2.1.m1.2.3" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.cmml"><mtext id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2a.cmml">min</mtext><mo lspace="0em" rspace="0em" id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.1" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml">​</mo><mrow id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.2" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.2.1" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.1.cmml">(</mo><mfrac id="A2.SS1.SSS0.Px1.p2.1.m1.1.1" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><mtext id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2a.cmml">#humans that provided that answer</mtext><mn id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.3" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml">3</mn></mfrac><mo id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.2.2" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="A2.SS1.SSS0.Px1.p2.1.m1.2.2" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.2.3" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS0.Px1.p2.1.m1.2b"><apply id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3"><times id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.1"></times><ci id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2a.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2"><mtext id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.2">min</mtext></ci><interval closure="open" id="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.1.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.3.3.2"><apply id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1"><divide id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1"></divide><ci id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2a.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2"><mtext mathsize="70%" id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.2">#humans that provided that answer</mtext></ci><cn type="integer" id="A2.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.1.1.3">3</cn></apply><cn type="integer" id="A2.SS1.SSS0.Px1.p2.1.m1.2.2.cmml" xref="A2.SS1.SSS0.Px1.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS0.Px1.p2.1.m1.2c">\text{min}(\frac{\text{\#humans that provided that answer}}{3},1)</annotation></semantics></math>
<cite class="ltx_cite ltx_citemacro_citep">(Antol et al., <a href="#bib.bib61" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
</section>
<section id="A2.SS1.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">GQA</h6>

<div id="A2.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.SSS0.Px2.p1.1" class="ltx_p">is currently the largest VQA dataset. The dataset contains over 22M
question-answer pairs and over 113K images covering various reasoning
skills and requiring multi-step inference, hence significantly reducing
biases as in previous VQA datasets. Each question is generated based
on an associated scene graph and pre-defined structural patterns.
GQA has served as a standard benchmark for most advanced compositional
visual reasoning models <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib50" title="" class="ltx_ref">2019a</a>; Hu et al., <a href="#bib.bib38" title="" class="ltx_ref">2019</a>; Hudson and Manning, <a href="#bib.bib62" title="" class="ltx_ref">2019b</a>; Shevchenko et al., <a href="#bib.bib63" title="" class="ltx_ref">2020</a>)</cite>.
We use the balanced splits of the dataset in our experiments.</p>
</div>
</section>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Baseline Models</h4>

<section id="A2.SS2.SSS0.Px1" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Bottom-Up Top-Down Attention (UpDn)</h6>

<div id="A2.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.SSS0.Px1.p1.2" class="ltx_p">UpDn is the first to introduce the use of bottom-up attention mechanism
to <span id="A2.SS2.SSS0.Px1.p1.2.1" class="ltx_text ltx_markedasmath">VQA</span> by utilizing image region features extracted by Faster
R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a href="#bib.bib36" title="" class="ltx_ref">2015</a>)</cite> pre-trained on Visual Genome dataset
<cite class="ltx_cite ltx_citemacro_citet">Krishna et al. (<a href="#bib.bib56" title="" class="ltx_ref">2017</a>)</cite>. A top-down attention network driven by
the question representation is used to summarize the image region
features to retrieve relevant information that can be decoded into
an answer. The UpDn model won the VQA Challenge in 2017 and became
a standard baseline <span id="A2.SS2.SSS0.Px1.p1.2.2" class="ltx_text ltx_markedasmath">VQA</span> model since then.</p>
</div>
</section>
<section id="A2.SS2.SSS0.Px2" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">MACNet</h6>

<div id="A2.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.SSS0.Px2.p1.2" class="ltx_p">MACNet is a multi-step co-attention based model to perform sequential
reasoning where they use <span id="A2.SS2.SSS0.Px2.p1.2.1" class="ltx_text ltx_markedasmath">VQA</span> as a testbed. Given a set of
contextual word embeddings and a set of visual region features, at
each time step, an MAC cell learns the interactions between the two
sets with the consideration of their past interaction at previous
time steps through a memory. In particular, an MAC cell uses a controller
to first compute a controlling signal by summarizing the contextual
embeddings of the query words using an attention mechanism. The controlling
signal is then coupled with the memory state of the previous reasoning
step to drive the computation of the intermediate visual attention
scores. At the end of a reasoning step, the retrieved visual feature
is finally used to update the memory state of the reasoning process.
The process is repeated over multiple steps, resembling the way humans
reason over a compositional query. In our experiments, we use a Pytorch
equivalent implementation<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://github.com/tohinz/pytorch-mac-network</span></span></span>
of MACNet instead of using the original Tensorflow-based implementation.
We choose the number of reasoning steps to be <math id="A2.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A2.SS2.SSS0.Px2.p1.2.m2.1a"><mn id="A2.SS2.SSS0.Px2.p1.2.m2.1.1" xref="A2.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px2.p1.2.m2.1b"><cn type="integer" id="A2.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A2.SS2.SSS0.Px2.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px2.p1.2.m2.1c">6</annotation></semantics></math> in all experiments.
For experiments with GAP, we only refine the attention weights inside
the controller (linguistic attention) and the read module (visual
attention) at the first reasoning step where the grounding prior shows
its best effect in accelerating the learning of attention weights,
hence leads to the best performance overall.</p>
</div>
</section>
<section id="A2.SS2.SSS0.Px3" class="ltx_paragraph">
<h6 class="ltx_title ltx_title_paragraph">Bilinear Attention Networks (BAN)</h6>

<div id="A2.SS2.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.SSS0.Px3.p1.1" class="ltx_p">BAN is one of the most advanced VQA models based on low-rank bilinear
pooling. Given two input channels (language and vision in the VQA
setting), BAN uses low-rank bilinear pooling to extract the pair-wise
cross interactions between the elements of the inputs. It then produces
an attention map to selectively attend to the pairs that are most
relevant to the answer. BAN also takes advantage of a multimodal residual
networks to improve its performance by repeatedly refining the retrieved
information over multiple attention maps. We use its official implementation<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://github.com/jnhwkim/ban-vqa</span></span></span>
in our experiments. In order to make the best judgments of the model’s
performance with our attention refinement with grounding priors, we
remove the plug-and-play counting module <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib64" title="" class="ltx_ref">2018</a>)</cite>
in the original implementation.</p>
</div>
<div id="A2.SS2.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<p id="A2.SS2.SSS0.Px3.p2.7" class="ltx_p">Regarding the choice of hyper-parameters, all the experiments regardless
of the baselines are with <math id="A2.SS2.SSS0.Px3.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.1.m1.1a"><mi id="A2.SS2.SSS0.Px3.p2.1.m1.1.1" xref="A2.SS2.SSS0.Px3.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.1.m1.1b"><ci id="A2.SS2.SSS0.Px3.p2.1.m1.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.1.m1.1c">d</annotation></semantics></math>=512. The number of visual objects <math id="A2.SS2.SSS0.Px3.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.2.m2.1a"><mi id="A2.SS2.SSS0.Px3.p2.2.m2.1.1" xref="A2.SS2.SSS0.Px3.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.2.m2.1b"><ci id="A2.SS2.SSS0.Px3.p2.2.m2.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.2.m2.1c">N</annotation></semantics></math>
for each image is <math id="A2.SS2.SSS0.Px3.p2.3.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.3.m3.1a"><mn id="A2.SS2.SSS0.Px3.p2.3.m3.1.1" xref="A2.SS2.SSS0.Px3.p2.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.3.m3.1b"><cn type="integer" id="A2.SS2.SSS0.Px3.p2.3.m3.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.3.m3.1c">100</annotation></semantics></math> and the maximum number of words <math id="A2.SS2.SSS0.Px3.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.4.m4.1a"><mi id="A2.SS2.SSS0.Px3.p2.4.m4.1.1" xref="A2.SS2.SSS0.Px3.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.4.m4.1b"><ci id="A2.SS2.SSS0.Px3.p2.4.m4.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.4.m4.1c">T</annotation></semantics></math> in a
query is set to be the length of the longest query in the respective
dataset. We train all the models using Adam optimizer with a batch
size of <math id="A2.SS2.SSS0.Px3.p2.5.m5.1" class="ltx_Math" alttext="64" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.5.m5.1a"><mn id="A2.SS2.SSS0.Px3.p2.5.m5.1.1" xref="A2.SS2.SSS0.Px3.p2.5.m5.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.5.m5.1b"><cn type="integer" id="A2.SS2.SSS0.Px3.p2.5.m5.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.5.m5.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.5.m5.1c">64</annotation></semantics></math>. The learning rate is initialized at <math id="A2.SS2.SSS0.Px3.p2.6.m6.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.6.m6.1a"><msup id="A2.SS2.SSS0.Px3.p2.6.m6.1.1" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.cmml"><mn id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.2" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.2.cmml">10</mn><mrow id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.cmml"><mo id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3a" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.cmml">−</mo><mn id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.2" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.6.m6.1b"><apply id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1">superscript</csymbol><cn type="integer" id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.2.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.2">10</cn><apply id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3"><minus id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.1.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3"></minus><cn type="integer" id="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.2.cmml" xref="A2.SS2.SSS0.Px3.p2.6.m6.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.6.m6.1c">10^{-4}</annotation></semantics></math> and
scheduled with the warm up strategy, similar to prior words in VQA
<cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib65" title="" class="ltx_ref">2018</a>)</cite>. Reported results are at the epoch that gives
the best accuracy on the validation sets after <math id="A2.SS2.SSS0.Px3.p2.7.m7.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A2.SS2.SSS0.Px3.p2.7.m7.1a"><mn id="A2.SS2.SSS0.Px3.p2.7.m7.1.1" xref="A2.SS2.SSS0.Px3.p2.7.m7.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS0.Px3.p2.7.m7.1b"><cn type="integer" id="A2.SS2.SSS0.Px3.p2.7.m7.1.1.cmml" xref="A2.SS2.SSS0.Px3.p2.7.m7.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS0.Px3.p2.7.m7.1c">25</annotation></semantics></math> training epochs.</p>
</div>
</section>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Additional Experimental Results</h4>

<div id="A2.SS3.p1" class="ltx_para ltx_noindent">
<p id="A2.SS3.p1.1" class="ltx_p">Apart from the experimental results in Sec. <a href="#S5" title="5 Experiments ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>
in the main paper, we provide additional results on VQA-CP2 dataset
<cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al., <a href="#bib.bib51" title="" class="ltx_ref">2018</a>)</cite> to support our claim that GAP complements
related works with regularization schemes. We choose RUBi <cite class="ltx_cite ltx_citemacro_citep">(Cadene et al., <a href="#bib.bib48" title="" class="ltx_ref">2019</a>)</cite>
as a representative bias reduction method for VQA with a general linguistic
debiasing technique and yet effective on VQA-CP2 dataset. Table <a href="#A2.T6" title="Table 6 ‣ B.3 Additional Experimental Results ‣ Appendix B Experiment details ‣ Supplementary material ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>
presents our experimental results with UpDn baseline. As clearly seen,
even though linguistic biases are not the main target, GAP still shows
consistent improvements on top of both UpDn baseline and UpDn+RUBi
baseline. It is to emphasize that applying the regularization by RUBi
for linguistic bias considerably hurts the performance on VQA v2 even
though RUBi largely improves performance on VQA-CP2 test split. GAP
brings the benefits of pre-computed attention priors and rejects the
damage caused by the regularization effects by RUBi to maintain its
excellent performance on VQA v2 while slightly improving the baseline’s
performance on VQA-CP2. Looking more closely at the results per question
type on VQA-CP2 (Row 1 vs. Row 2, and Row 3 vs. Row 4), GAP shows
its universal effect on all question types with the strongest effect
on “Other” question type which contains open-ended arbitrary questions.
On the other hand, RUBi (Row 3 vs. Row 1) shows its significant impact
only on binary questions “Yes/No” but considerably hurts “Number”
and especially “Other” question types. This reveals that the regularization
scheme in RUBi is overfitted to “Yes/No” questions specifically
due to the limitation of the data generation process behind this dataset.</p>
</div>
<div id="A2.SS3.p2" class="ltx_para ltx_noindent">
<p id="A2.SS3.p2.1" class="ltx_p">The analysis in this Section is consistent with our results in Figure
4 in the main paper and is clearly evident to GAP’s universal effects
in improving VQA performance. The additional results with RUBi shown
in this Section also state GAP’s complementary benefits upon the use
of the learning regularization methods targeting only a specific type
of data as such in VQA-CP2.</p>
</div>
<figure id="A2.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Performance on VQA v2 val split and VQA-CP2 test split with UpDn baseline.</figcaption>
<table id="A2.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T6.1.1.1" class="ltx_tr">
<th id="A2.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="A2.T6.1.1.1.1.1" class="ltx_text">Model</span></th>
<th id="A2.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">VQA-CP2 test</th>
<th id="A2.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">VQA v2 val</th>
</tr>
<tr id="A2.T6.1.2.2" class="ltx_tr">
<th id="A2.T6.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Overall</th>
<th id="A2.T6.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Yes/No</th>
<th id="A2.T6.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t">Number</th>
<th id="A2.T6.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt">Other</th>
<th id="A2.T6.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt ltx_border_t">Overall</th>
<th id="A2.T6.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt ltx_border_tt">Yes/No</th>
<th id="A2.T6.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt ltx_border_tt ltx_border_t">Number</th>
<th id="A2.T6.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_tt ltx_border_tt ltx_border_tt">Other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T6.1.3.1" class="ltx_tr">
<td id="A2.T6.1.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">UpDn baseline</td>
<td id="A2.T6.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">40.6</td>
<td id="A2.T6.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">41.2</td>
<td id="A2.T6.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">13.0</td>
<td id="A2.T6.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">48.1</td>
<td id="A2.T6.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">63.3</td>
<td id="A2.T6.1.3.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">79.7</td>
<td id="A2.T6.1.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">42.8</td>
<td id="A2.T6.1.3.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">56.4</td>
</tr>
<tr id="A2.T6.1.4.2" class="ltx_tr">
<td id="A2.T6.1.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">UpDn+GAP</td>
<td id="A2.T6.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">40.8</td>
<td id="A2.T6.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">41.2</td>
<td id="A2.T6.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">13.2</td>
<td id="A2.T6.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">48.3</td>
<td id="A2.T6.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">64.3</td>
<td id="A2.T6.1.4.2.7" class="ltx_td ltx_align_center ltx_border_r">81.2</td>
<td id="A2.T6.1.4.2.8" class="ltx_td ltx_align_center ltx_border_r">44.1</td>
<td id="A2.T6.1.4.2.9" class="ltx_td ltx_align_center ltx_border_r">56.9</td>
</tr>
<tr id="A2.T6.1.5.3" class="ltx_tr">
<td id="A2.T6.1.5.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">UpDn+RUBi</td>
<td id="A2.T6.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48.6</td>
<td id="A2.T6.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.1</td>
<td id="A2.T6.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">12.6</td>
<td id="A2.T6.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">46.1</td>
<td id="A2.T6.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.7</td>
<td id="A2.T6.1.5.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79.2</td>
<td id="A2.T6.1.5.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.8</td>
<td id="A2.T6.1.5.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.5</td>
</tr>
<tr id="A2.T6.1.6.4" class="ltx_tr">
<td id="A2.T6.1.6.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r">UpDn+RUBi+GAP</td>
<td id="A2.T6.1.6.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">48.9</td>
<td id="A2.T6.1.6.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">72.2</td>
<td id="A2.T6.1.6.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">12.8</td>
<td id="A2.T6.1.6.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">46.4</td>
<td id="A2.T6.1.6.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">64.2</td>
<td id="A2.T6.1.6.4.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">81.4</td>
<td id="A2.T6.1.6.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">44.3</td>
<td id="A2.T6.1.6.4.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">56.3</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A2.SS4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Additional Qualitative Analysis</h4>

<figure id="A2.F7" class="ltx_figure">
<div id="A2.F7.2" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:398.9pt;">
<div id="A2.F7.1.1.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:203.8pt;">
<img src="/html/2205.12616/assets/x8.png" id="A2.F7.1.1.1.1.g1" class="ltx_graphics ltx_align_left ltx_img_landscape" width="470" height="365" alt="Refer to caption">
</div>
<p id="A2.F7.2.2.2" class="ltx_p ltx_align_center"><span class="ltx_rule" style="color:#0000FF;background:#0000FF;display:inline-block;"> </span> 
<span id="A2.F7.2.2.2.1" class="ltx_inline-block ltx_minipage ltx_align_top" style="width:177.8pt;"><img src="/html/2205.12616/assets/x9.png" id="A2.F7.2.2.2.1.1.g1" class="ltx_graphics ltx_align_right ltx_img_square" width="456" height="374" alt="Refer to caption">
</span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Qualitative analysis of GAP with UpDn baseline. (a) Region-word alignments
of different RE-image pairs learned by our unsupervised grounding
framework. (b) Visual attentions and prediction of UpDn model before
(left) vs. after applying GAP (right). GAP shifts the model’s highest
visual attention (green rectangle) to more appropriate regions while
the original puts attention on irrelevant parts.</figcaption>
</figure>
<figure id="A2.F8" class="ltx_figure">
<div id="A2.F8.2" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:398.9pt;">
<div id="A2.F8.1.1.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_top" style="width:203.8pt;">
<img src="/html/2205.12616/assets/x10.png" id="A2.F8.1.1.1.1.g1" class="ltx_graphics ltx_align_left ltx_img_landscape" width="470" height="372" alt="Refer to caption">
</div>
<p id="A2.F8.2.2.2" class="ltx_p ltx_align_center"><span class="ltx_rule" style="color:#0000FF;background:#0000FF;display:inline-block;"> </span> 
<span id="A2.F8.2.2.2.1" class="ltx_inline-block ltx_minipage ltx_align_top" style="width:177.8pt;"><img src="/html/2205.12616/assets/x11.png" id="A2.F8.2.2.2.1.1.g1" class="ltx_graphics ltx_align_right ltx_img_square" width="392" height="443" alt="Refer to caption">
</span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Qualitative analysis of GAP with MACNet baseline. (a) Region-word
alignments of different RE-image pairs learned by our unsupervised
grounding framework. (b) Visual attentions and prediction of MACNet
model before (left) vs. after applying GAP (right). Visualized attention
weights are obtained at the last reasoning step of MACNet.</figcaption>
</figure>
<div id="A2.SS4.p1" class="ltx_para ltx_noindent">
<p id="A2.SS4.p1.1" class="ltx_p">Fig.6 in the main paper provides one case of visualization on the
internal operation of our proposed method GAP as well as its effect
on VQA models. We provide more examples here for UpDn baseline (Fig.
<a href="#A2.F7" title="Figure 7 ‣ B.4 Additional Qualitative Analysis ‣ Appendix B Experiment details ‣ Supplementary material ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and MACNet baseline (Fig. <a href="#A2.F8" title="Figure 8 ‣ B.4 Additional Qualitative Analysis ‣ Appendix B Experiment details ‣ Supplementary material ‣ A template for the arxiv style" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)
with the same convention and legends.</p>
</div>
<div id="A2.SS4.p2" class="ltx_para ltx_noindent">
<p id="A2.SS4.p2.1" class="ltx_p">In each figure, left subfigures present the linguistic-visual alignments
learned by our unsupervised grounding framework. Right subfigures
compare the visual attentions before and after applying GAP. In all
cases across two different baselines (UpDn and MACNet), GAP clearly
helps direct the models to pay attention to more appropriate visual
regions, partly explaining their answer predictions.</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
</section>
</section><div class="ltx_rdf" about="" property="dcterms:creator" content="David S. Hippocampus, Elias D. Striatum"></div>
<div class="ltx_rdf" about="" property="dcterms:subject" content="First keyword, Second keyword, More"></div>
<div class="ltx_rdf" about="" property="dcterms:subject" content="q-bio.NC, q-bio.QM"></div>
<div class="ltx_rdf" about="" property="dcterms:title" content="A template for the arxiv style"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.12615" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.12616" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.12616">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.12616" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.12617" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 04:36:46 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
